0001 H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas DL Internal contracts input today report')       *
0002 F********************************************************************
     F*                                                               *
     F*  Midas - Dealing Module                                       *
0004 F*                                                               *
0005 F*       DL2460  -  INTERNAL CONTRACTS INPUT TODAY REPORT        *
0006 F*                                                               *
      *  (c) Misys International Banking Systems Ltd. 2001            *
0008 F*                                                               *
      *  Last Amend No. CDL096             Date 22Sep14               *
      *  Prev Amend No. CDL094             Date 11Jun14               *
      *                 AR996895           Date 25Nov12               *
      *                 263666             Date 01Feb10               *
      *                 CER059             Date 19Jul10               *
      *                 CER016A            Date 19May08               *
      *                 CER043             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 246141             Date 26Mar07               *
      *                 164847             Date 30Nov06               *
      *                 BUG12990           Date 05Jan07               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 242286             Date 25Sep06               *
      *                 CSD031             Date 10Apr06               *
      *                 CDL049             Date 05Jul06               *
      *                 CSD027             Date 09Dec05               *
      *                 CDL038             Date 10May05               *
      *                 CIR013             Date 25Apr05               *
      *                 CDL028             Date 07Feb05               *
      *                 CGL029             Date 01Sep03               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.03 -----------------------------------------------*
      *                 CIR004             Date 20Jan00               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 163136             Date 07Jul99               *
      *                 121768             Date 19Feb98               *
 010 F*                 119341             DATE 11Dec97               *
     F*                 BD5071             DATE 20Mar97               *
     F*                 097885             DATE 31JAN97               *
     F*                 CAC001             DATE 01FEB96               *
 010 F*                 083281             DATE 21MAY95               *
     F*                 095244             DATE 01NOV95               *
     F*                 095238             DATE 31OCT95               *
     F*                      066550             DATE 04FEB94             *
 010 F*                      056433             DATE 26JAN94             *
 010 F*                      LN0662             DATE 01FEB91             *
 010 F*                      LN0298             DATE 30MAY90             *
 010 F*                      LN0166             DATE 11MAY90             *
 010 F*                      E293               DATE 29MAR90             *
 010 F*                      E134               DATE 07DEC89             *
 010 F*                      S01117             DATE 23OCT89             *
 010 F*                      S01194             DATE 23OCT89             *
 010 F*                      E12646             DATE 17JUL89             *
 010 F*                      E17693             DATE 28/03/89            *
 010 F*                      E17666             DATE 28/03/89            *
 010 F*                      E16669             DATE 17/01/89            *
 010 F*                      S01147             DATE 24/11/86            *
 010 F*                      E81264             DATE 19/11/86            *
0009 F*                      E81116             DATE 13/08/86            *
0009 F*                      E80945             DATE 26/06/86            *
0009 F*                      E49601             DATE 26/06/86            *
0010 F*                                                                  *
0011 F*------------------------------------------------------------------*
     F*                                                               *
      *  CDL096 - Business Day Conventions on MM Deals                *
      *           (Recompile)                                         *
      *  CDL094 - Enhance  Receive Settlement Instructions            *
      *           (Recompiled)                                        *
      *  AR996895 - Incorrect acrrual interest calculation            *
      *             (Child: AR996897) (Recompile)                     *
      *  263666 - Recompiled due to changes in ZINTDYZ2               *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  CER016A - German Interest Calculation: Upgarde of FGE059     *
      *            to Midas Plus (Recompile)                          *
      *  CER043 - German Features LF041-00 New Fields and Defaulting  *
      *           (Recompile)                                         *
      *  246141 - Recompiled due to changes in ZINTDYZ2               *
      *  164847 - Recompile over changes in /COPY ZINTDYZ2.           *
      *  BUG12990 - Recompiled due to changes in ZINTDYZ2/ZINTDYZ2LE  *
      *  242286 - Recompile over changes in /COPY ZINTDYZ2.           *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CDL049 - Addition of a Reference Rate field (recompile)      *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CDL038 - Extended Deal Sub Type (Recompile)                  *
      *  CIR013 - Additional Calculation Method for FRA/IRS/CCF       *
      *           Recompile over GLINTC and ZINTDY.                   *
      *  CDL028 - Automatic Rate Interpolations (Recompile)           *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  CIR004 - Dealing Calculation Method Change.                  *
      *         - Recompiled due to GLINTC and ZINTDY changes         *
     F*  163136 - Interest Calculation Method '6'  showing incorrect -*
     F*           ZERO - amount . Addition to Core #126017 which dealt*
     F*           with the issue. It introduced an additional  INT6DY *
     F*           field in s-routine ZINTDY in  /COPY ZSRSRC/ZINTDYZ2 *
     F*           which in turn is usually called from GLINTC s-routine
     F*           in /COPY  ZSRSRC/ GLINTCZ1 .  However, there are at *
     F*           least a dozen other pgms that use ZINTDY but do     *
     F*           GLINTC-processing within the pgms calculation specs *
     F*  121768 - Recompile over changed GLINTCZ1                     *
     F*  119341 - 'Total Cost at %' and 'Overall Cost' amounts are    *
     F*           incorrect for Internal Loans, although correct for  *
     F*           Internal Deposits. Reverse out incorrect fix 083281 *
     F*           which causes this problem.                          *
     F*  126017 - Correction to interest calculation for calculation  *
     F*           basis 6 in SR/GLINTC. Add SR/ZDAT10                 *
     F*  097885 - Recompiled for wrong calculation of number of day   *
     F*           interest (ZINTDYZ2).                                *
     F*  CAC001 - Profit Centre Accounting Development:               *
     F*           If Analytical Accounting is available, print the    *
     F*           renamed 'FX Profit Centre' and the new 'MM Profit   *
     F*           Centre' against each internal contract.             *
     F*  083281 - 'OVERALL COST' and 'TOTAL COST AT %' should be      *
     F*           printed directly from file.                         *
     F*  095244 - Recompiled for Calculation method 3                 *
     F*  095238 - Recompiled for Calculation method 3                 *
     F*    066550 - GLINTC has had historical problems and inaccuracies  *
     F*             and is now externaly descibed and changed to use     *
     F*             ZINTDYZ1. See document atached to error no on GEMS   *
     F*  056433 - Array CCYA not set-up properly causing CCY amount   *
     F*           to be printed with wrong decimal position.  Also    *
     F*           DATE not printed properly in DL2460P1.              *
     F*       LN0662 - CHANGES TO SDCURRL0 AND L1                        *
     F*       LN0298 - LINE UP TEXT FOR 'NO DETAILS TO REPORT'           *LN0298
     F*       LN0166 - PROCESSING OF BRANCH DETAILS SHOULD NOT OCCUR     *LN0166
     F*                BEFORE CHECK FOR INTERNAL CONTRACT                *LN0166
0011 F*       E293 - USE SEQ NO. TO PASS TO ZSFILE                       *
     F*       E134    - FIX TO USE CORRECT VALUE OF MULT/DIV INDICATOR   *
     F*       S01117 - MULTI-BRANCHING CHANGES                           *S01117
     F*       S01194 - NEW STANDING DATA CHANGES                         *S01194
0011 F*       E12646  -  PREVENT CCY RECORD 2 BEING BUILT IN CCY ARRAY   *E12646
0011 F*       E17693  -  PREVENT CHTP BEING LOST BY EXSR ZSYSTM          *E16669
0011 F*       E17666  -  CHECK SUBTYPE SUFFIX = D IF NOT = L             *E16669
0011 F*       E16669  -  TO APPLY FIX E48987 (S/36 FIX TO PREVENT        *E16669
0011 F*                  DIVIDE BY ZERO)                                 *E16669
     F*       S01147  -  RELEASE 22 (AMENDMENT TO GLINTC)                *S01147
     F*       E81116  -  RELEASE 11 VERSION OF SOURCE USED INSTEAD OF    *E81116
     F*                  RELEASE 20 - CHANGES APPLIED TO DTRIX FILE      *E81116
0011 F*       E80945  -  INDICATOR 98 SETTING IS SAVED AND RESTORED      *E80945
0011 F*                  WHEN S.R.GLINTC* IS PERFORMED.                  *E80945
     F*                  (*S.R. CALLED GLINTD IN THIS PROGRAM)           *E80945
0011 F*       E49601  -  INCORRECT INTEREST CALCULATION FOR CALCULATION  *E49601
0011 F*                  BASIS 3. FEBRUARY NOT TAKEN AS 30 DAY MONTH.    *E49601
     F*       E81264  -  DOES NOT PRINT INSTALLATION TITLE AND RUN       *E81264
     F*                  DATE IF RUNNING ON BLANK FILE                   *E81264
0009 F*                                                                  *
0011 F********************************************************************
     F*                                                               *
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
0012 F*TRIX   IP  F      40            DISK                               E81116
0012 F**DTRIXDD IP  F      40          DISK                        E81116 S01117
0012 FDTRSD1  IP  E           K        DISK                               S01117
0013 FDTRIXHH IS  F      40  1AI     1 DISK                               E81264
0013 F***DEALS   IF  F     400  6AI     2 DISK                            S01117
0013 F***DEALS***IF  F    1069  6AI     2 DISK                     S01117 CAC001
     F***DEALS***IF  F    1158  6AI     2 DISK                                         CAC001 CGL029
     FDEALS   IF  F    1363  6AI     2 DISK                                                   CGL029
0014 F***TABLE   IF  F      96 12AI     2 DISK                            S01194
0015 F***TABLED  IF  F      96 12AI     2 DISK                            S01194
0015 F*SDCURRL0IF  E                    DISK                       S01194 LN0662
0015 F***SDCURRL1IF**E                 DISK                        LN0662 056433
0015 FSDCURRPDIF  E                    DISK                               056433
0016 F**DL2460P1O   F   132     OF     PRINTER                    S01124  S01117
0016 FDL2460P1O   F     132     OF     PRINTER      KINFDS SPOOL      UC  S01117
0016 FDL2460AUO   F     132     OA     PRINTER      KINFDS SPOOLU         S01117
0017 F*
0018 F*               USE OF INDICATORS
0019 F**01************DTRIX HEADER                                        E81116
0020 F* 02            DTRIX DETAIL
0021 F* 03            DEALS FILE -INTERNAL CONTRACT 1ST LEG
0022 F* 04            DEALS FILE -INTERNAL CONTRACT 2ND LEG
     F*       16      DATE FORMAT INDICATOR SAVE / WORK INDICATOR
0023 F*       20      NOT FIRST CYCLE
0024 F*       21      UNDERLYING DEAL IS "LOAN"
0025 F*       22      EXRT IS DIVIDE
0026 F*       23      INSERT ON DTRIX FILE
0027 F*       24      WORK INDICATOR
0028 F*       25      SWAP BENEFIT
0029 F*       26      OVERALL BENEFIT
0030 F*       27      OUTPUT
0024 F*       28      UNDERLYING DEAL IS "DEPOSIT"                        E17666
0031 F*       29      DEALS FILE CHAIN FAIL
0032 F*       30      CURRENCY 1 - 0 DECIMAL PLACES
0033 F*       31                 - 1 DECIMAL PLACE
0034 F*       32                 - 2 DECIMAL PLACES
0035 F*       33                 - 3 DECIMAL PLACES
 031 F*       37      INPUT HAS BEEN DONE TODAY
0036 F*       40      CURRENCY 2 - 0 DECIMAL PLACES
0037 F*       31                 - 1 DECIMAL PLACE
0038 F*       32                 - 2 DECIMAL PLACES
0039 F*       33                 - 3 DECIMAL PLACES
     F*       50      MULT/DIV INDICATOR IS MULTIPLY
     F*       51      EXCHANGE RATE LESS THAN 1
     F*       52      RATIO CCY1/CCY2 SPOT RATES LESS THAN 1
     F********53***   VALID OUTPUT TO DL2460P1                            E240
     F*       55      DIVIDE BY ZETO ATTEMPTED                            E16669
     F*       60      Analytical Accounting is installed                  CAC001
0040 F*         U7U8  DATABASE ERROR
0041 F*          U8   FOOB
0042 F*          L1   CHANGE OF BRANCH NAME                               S01117
0043 F*
     E                    CPY@    1   1 80                                S01194
0044 E                    POW     1   7  7 3
0045 E                    CCYA      150  3
0046 E                    DPA       150  1 0
     E                    SPTA      150 13 8
     E*****               MDA       150  1 0                              E134
     E                    MDA       150  1                                E134
0047 E                    ZYDY    4   4  4 0             ZDATE1/2 SR.ARRAY
0048 E                    ZMDY   13  13  3 0             ZDATE1/2 SR.ARRAY
0049 E                    ZMNM   12  12  3               ZDATE2 SR. ARRAY
     E/COPY ZSRSRC,ZDATE9Z1                                               066550
0063 I*                                                                   E81264
0336 IDTRIXHH NS                                                          E81264
0064 I*    DEAL TRANSACTIONS INDEX FILE - HEADER RECORD.                  E81264
0065 I*                                                                   E81264
0050 I*TRIX***NS**01***1*CH                                               E81116
0051 I********                                1   1 RECI                  E81116
0052 I********                                2   2 RCDT                  E81116
0053 I********                                3   80DLNO                  E81116
0054 I********                            P   9  110NORE                  E81116
0055 I********                            P  12  140FLSZ                  E81116
0056 I********                            P  15  170RRLC                  E81116
0057 I********                            P  18  200RRNA                  E81116
0058 I********                            P  21  230RRLX                  E81116
0059 I********                            P  24  260RRXP                  E81116
0060 I********                            P  27  290NDLR                  E81116
0061 I********                            P  30  320NDAR                  E81116
0062 I********                               33  330STPI                  E81116
0063 I********                            P  35  370RRNT                  E81116
0064 I********                            P  38  400TNLU                  E81116
0065 I********NS**02***1*CD                                               E81116
0065 I**DTRIXDD NS  02   1 CD                                      E81116 S01117
0066 I*****                                   1   1 RECI                  S01117
0067 I*****                                   2   2 RCDT                  S01117
0068 I*****                                   3   80DLNO                  S01117
0069 I*****                                   9  130VDAT                  S01117
0070 I*****                                  14  160DASN                  S01117
0071 I*****                                  17  17 CHTP                  S01117
0072 I*****                                  18  18 CNRQ                  S01117
0073 I*****                                  19  19 CNPR                  S01117
0074 I*****                                  20  20 REPR                  S01117
0075 I*****                                  21  250RRLA                  S01117
0076 I*****                                  26  26 DADI                  S01117
0077 I*****                                  27  270PRI1                  S01117
0078 I*****                                  28  280PRI2                  S01117
0079 I*****                                  29  290PRI3                  S01117
0080 I*****                                  34  340ICIN        23        S01117
0081 I*****                               P  35  370RRNT                  S01117
0082 I*****                               P  38  400TNLU                  S01117
0083 I*****   NS                                                          S01117
     I*                                                                   S01117
     IDTRIXDF     02                                                      S01117
     I                                              BRCA  L1              S01117
     I                                              ICIN        23        S01117
     I*                                                                   S01117
0084 IDEALS   NS  03   1 CD 212 C1
0085 I       OR   04   1 CD 212 C2
0086 I                                        1   1 RECI
0087 I                                        2   70DLNO
0088 I                                        8   8 RCDT
0089 I                                        9  100RCDC
0090 I**********                             11  160CNUM                                      CSD027
0090 I                                       11  16 CNUM                                      CSD027
0091 I*****                                  17  190BRCD                  S01117
0091 I                                       17  19 BRCA                  S01117
0092 I                                       20  21 DTYP
0093 I                                       22  23 DLST
0094 I                                       23  23 COVER
0095 I                                    P  24  260DDAT
0096 I                                    P  27  290VDAT
0097 I                                    P  30  320OTDT
0098 I                                       35  38 BRKC
0099 I                                    P  39  450BAGE
0100 I                                       46  48 PUCY
0101 I                                    P  49  550PUAM
0102 I                                    P  56  628EXRT
0103 I                                       86  88 SLCY
0104 I                                    P  89  950SLAM
0105 I                                    P 117 1230BCEQ
0106 I                                    P 131 1378LCXR
0107 I                                      138 1390PCST
0108 I**********                            140 151 OPCA                                      CGL029
0108 I                                      140 151 QQOPCA                                    CGL029
0109 I                                      152 161 TSCN
0110 I                                      162 1630SCST
0111 I**********                            164 175 OSCA                                      CGL029
0111 I                                      164 175 QQOSCA                                    CGL029
0112 I                                      176 185 TPCN
0113 I                                    P 192 1980ORPA
0114 I                                    P 205 2110ORSA
0115 I                                      212 2120FSLI
0116 I                                    P 213 2190LITD
0117 I                                    P 220 2260LILA
0118 I                                    P 227 2330DITD
0119 I                                    P 234 2400DILA
0120 I                                    P 241 2470SPPD
0121 I                                    P 248 2540SPLA
0122 I                                      255 257 SPLC
0123 I                                      258 260 ILCY
0124 I                                    P 261 2670ILAM
0125 I                                      268 270 IDCY
0126 I                                    P 271 2770IDAM
0127 I                                    P 278 2840IDIA
0128 I                                      285 2900SODN
0129 I                                      300 309 FACO
0130 I                                      310 344 SPI
0131 I                                    P 347 3527ILIR
0132 I                                    P 353 3587IDIR
0133 I                                    P 360 3660ILIA
0134 I                                      370 370 DNSI
0135 I                                      371 371 DSTI
0136 I                                      372 372 CNFI
0137 I                                      373 373 ACEI
0138 I                                      374 374 TLXI
0139 I                                      382 3820ILCM
0140 I                                      383 3830IDCM
0141 I                                    P 391 3930ORED
0142 I                                    P 394 3960LCD
0143 I                                      397 397 CHTP
0144 I                                    P 398 4000TNLU
     I                                     10401043 PRFC                  CAC001
     I                                     11551158 ICPC                  CAC001
0111 I                                     12921309 OPCA                                      CGL029
0111 I                                     13101327 OSCA                                      CGL029
0145 I**
0146 I        NS
0147 I*
0148 I***TABLE   NS       2 C0   3 C1  12 C1                              S01194
0149 I*****        AND      13 C0                                         S01194
0150 I*****                                   1   1 RECI                  S01194
0151 I*****                                   2   30RECT                  S01194
0152 I*****                                  12  130RCDE                  S01194
0153 I*****                                  14  66 TITL                  S01194
0154 I*****                                  67  67 DATF                  S01194
0155 I*****                                  68  70 DFBR                  S01194
0156 I*****                                  74  74 MODI1                 S01194
0157 I*****                                  75  75 MODI2                 S01194
0158 I*****                                  76  76 MODI3                 S01194
0159 I*****                               P  77  790RUND                  S01194
0160 I*****                                  80  86 RUNA                  S01194
0161 I*****                                  87  870SFLG                  S01194
0162 I*****                               P  90  920LCD                   S01194
0163 I*****                                  93  93 CHTP                  S01194
0164 I*****                               P  94  960TNLU                  S01194
0165 I*****   NS                                                          S01194
0166 I*****                                                               S01194
0167 I***TABLED  NS       2 C2   3 C0  13 C1                              S01194
0168 I*****                                   1   1 RECIX                 S01194
0169 I*****                                   2   30RECTX                 S01194
0170 I*****                                  10  12 CCYX                  S01194
0171 I*****                                  13  130SRECX                 S01194
0172 I*****                                  14  27 CCNM                  S01194
0173 I*****                               P  28  348SPOT                  S01194
0174 I*****                                  38  380CDPX                  S01194
0175 I*****                                  39  390TNOT                  S01194
0176 I*****                                  40  40 DCCY                  S01194
0177 I*****                                  86  860MDIN                  S01194
0178 I*****   NS                                                          S01194
0179 I*****                                   1   1 RECIX                 S01194
0180 I*****                                   2   30RECTX                 S01194
     I*****                                  13  130SRECX          E12646 S01194
0181 I*
0182 I**   DATA STRUCTURES
      *
0183 I            DS
0184 I                                        1  40 INDET
0185 I                                        1   60DLNO
0186 I                                        7  120SODN
0187 I                                       13  170VDAT
0188 I                                       18  220OTDT
0189 I                                       23  270DDAT
0190 I                                       28  408EXRT
0191 I            DS
0192 I                                        1  40 COMMON
0193 I                                        1   60DLNO1
0194 I                                        7  120DLNO2
0195 I                                       13  170VDATE
0196 I                                       18  220MDATE
0197 I                                       23  270DDATE
0198 I                                       28  408SPRAT
0199 I            DS
0200 I                                        1  16 INDET1
0201 I                                        1   3 SLCY
0202 I                                        4  160SLAM
0203 I            DS
0204 I                                        1  16 INDET2
0205 I                                        1   3 PUCY
0206 I                                        4  160PUAM
0207 I            DS
0208 I                                        1  25 INDET3
0209 I                                        1   10IDCM
0210 I                                        2  127ILIR
0211 I                                       13  250ILIA
0212 I            DS
0213 I                                        1  25 INDET4
0214 I                                        1   10ILCM
0215 I                                        2  127IDIR
0216 I                                       13  250IDIA
0217 I            DS
0218 I                                        1  41 ODET1
0219 I                                        1   3 CCY1
0220 I                                        4  160AMT1
0221 I                                       17  170C2CM
0222 I                                       18  287IRATE
0223 I                                       29  410INTAMT
0224 I            DS
0225 I                                        1  16 ODET2
0226 I                                        1   3 CCY2
0227 I                                        4  160AMT2
0083 I*
     ISPOOL       DS                                                      S01117
     I** FILE INFORMATION DATA STRUCTURE                                  S01117
     I                                       83  92 SFILE                 S01117
     I                                    B 123 1240SFNUM                 S01117
     ISPOOLU      DS                                                      S01117
     I** FILE INFORMATION DATA STRUCTURE                                  S01117
     I                                       83  92 SFILEU                S01117
     I                                    B 123 1240SFNUMU                S01117
     I*
     I@BANK     E DSSDBANKPD                                              S01194
     I** EXTERNAL DS FOR BANK DETAILS                                     S01194
      *                                                                   S01194
     I@BRCH     E DSSDBRCHPD                                              S01194
     I** EXTERNAL DS FOR BRANCH DETAILS                                   S01194
      *                                                                   S01194
     I@MMOD     E DSSDMMODPD                                              CAC001
     I** External DS for Module Details                                   CAC001
      *                                                                   CAC001
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*                                                                   S01117
     I/COPY ZSRSRC,ZINTDYZ1                                               066550
     I/COPY ZSRSRC,ZDATE9Z2                                               066550
     I/COPY ZSRSRC,ZDAT10Z1                                               126017
0140 I/EJECT                                                              S01194
     I/COPY WNCPYSRC,DL2460I001
      *                                                                                       CGL029
     IDSSDY     E DSDSSDY                                                                     CGL029
      *                                                                                       CGL029
0141 C*
     C           *ENTRY    PLIST                                          E293
     C                     PARM           SEQ     5                       E293
     C/COPY WNCPYSRC,DL2460C001
     C************ENTRY    PLIST                                          E240
     C***********          PARM           SEQ     5                       E240
     C***********          PARM           BRNCH   3         BRANCH OR ALL E240
     C**                                                                  S01117
0228 C**   FIRST CYCLE CALCULATIONS
0229 C   20                GOTO NOTFC
0230 C                     SETON                     20
     C                     MOVEACPY@      BIS@   80                       S01194
0231 C*****READ*ICD*1*                                                    S01194
0246 C*****                MOVE CHTP      DCHTP   1                E17693 S01194
0232 C*****                EXSR ZSYSTM                                    S01194
0246 C*****                MOVE DCHTP     CHTP                     E17693 S01194
     C*                                                                   S01194
     C** CALL ACCESS PROGRAM FOR BANK DETAILS                             S01194
     C                     CALL 'AOBANKR0'                                S01194
     C                     PARM '*MSG    '@RTCD   7                       S01194
     C                     PARM '*FIRST  '@OPTN   7                       S01194
     C           @BANK     PARM @BANK     DSFDY                           S01194
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVEL'SDBANKPD'DBFILE 10         ************* S01194
     C                     MOVEL'01'      DBASE   3         *DBERROR 001* S01194
     C                     MOVEL@OPTN     DBOPTN  7         ************* S01194
     C                     SETON                     U7U8LR               S01194
     C                     EXSR *PSSR                                     S01194
     C                     GOTO END                                       S01194
     C                     END                                            S01194
0327 C*    CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.                    S01194
0328 C           BJDFIN    COMP 'M'                      98MMDDYY, 98 ON  S01194
      *                                                                   CAC001
      ** Call access program for Module Details                           CAC001
      *                                                                   CAC001
     C                     CALL 'AOMMODR0'                                CAC001
     C                     PARM '*MSG    '@RTCD                           CAC001
     C                     PARM '*FIRST  '@OPTN                           CAC001
     C           @MMOD     PARM @MMOD     DSFDY                           CAC001
      *                                                                   CAC001
     C           @RTCD     IFNE *BLANK                                    CAC001
     C                     MOVEL'SDMMODPD'DBFILE            ************* CAC001
     C                     MOVEL'03'      DBASE             *DBERROR 003* CAC001
     C                     MOVEL@OPTN     DBOPTN            ************* CAC001
     C                     SETON                     U7U8LR               CAC001
     C                     EXSR *PSSR                                     CAC001
     C                     GOTO END                                       CAC001
     C                     END                                            CAC001
      *                                                                   CAC001
      ** Check if Analytical Accounting is switched on.                   CAC001
      *                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C                     MOVE *ON       *IN60                           CAC001
     C                     ELSE                                           CAC001
     C                     MOVE *OFF      *IN60                           CAC001
     C                     ENDIF                                          CAC001
     C*                                                                   S01194
0233 C**   SET UP ARRAYS OF CCYS & DECIMAL PLACE
     C                     EXSR CCYAR1
0235 C**
0236 C           NOTFC     TAG                             ** NOTFC TAG **
     C*                                                                   S01117
     C***********                                                         LN0166
     C************INL1     IFEQ '1'                                S01117 LN0166
     C***********          CLOSEDL2460P1                           S01117 LN0166
     C***********BRNCH     IFEQ 'ALL'                                     E240
     C***********BRNCH     OREQ BRCA                                      E240
     C***********          SETON                     53    ALLOW OUTPUT   E240
     C***55******          SETOF                     55            S01117 LN0166
     C***********          OPEN DL2460P1                           S01117 LN0166
     C***********                                                  S01117 LN0166
     C**REPORT*SPOOL FILE GENERATION                               S01117 LN0166
     C***********          Z-ADDSFNUM     ZSNUM   60               S01117 LN0166
     C***********          CALL 'ZSFILE'                           S01117 LN0166
     C***********          PARM           SEQ                      E293   LN0166
     C**************       PARM           SEQ                             E240
     C***********          PARM *BLANKS   SEQ     5                S01117 LN0166
     C***********          PARM BRCA      @PARM   3                S01117 LN0166
     C***********          PARM           SFILE                    S01117 LN0166
     C***********          PARM           ZSNUM                    S01117 LN0166
     C***********          PARM *BLANK    ZSERR   1                S01117 LN0166
     C***********                                                  S01117 LN0166
     C***********ZSERR     IFEQ 'Y'                         B3     S01117 LN0166
     C**Error*during ZSFILE processing, return to calling program. S01117 LN0166
     C***********          SETON                     U7U8LR        S01117 LN0166
     C***********          RETRN                                   S01117 LN0166
     C***********          END                              E3     S01117 LN0166
     C***********                                                  S01117 LN0166
     C***********          Z-ADD0         PAGE                     S01117 LN0166
     C***********                                                  S01117 LN0166
     C***READ*BRANCH DETAILS VIA ACCESS PROGRAM FOR BRANCH NAME    S01117 LN0166
     C***********          CALL 'AOBRCHR0'                         S01117 LN0166
     C***********          PARM '*MSG   ' @RTCD                    S01117 LN0166
     C***********          PARM '*KEY   ' @OPTN                    S01117 LN0166
     C***********          PARM BRCA      @DSNB   3                S01117 LN0166
     C***********@BRCH     PARM @BRCH     DSFDY                    S01194 LN0166
     C***********@RTCD     IFNE *BLANK                             S01117 LN0166
     C***********          MOVEL'SDBRCHPD'DBFILE           ********S01117 LN0166
     C***********          MOVEL'02'      DBASE            * DBERR S01117 LN0166
     C***********          MOVEL@OPTN     DBOPTN           ********S01117 LN0166
     C***********          MOVELBRCA      DBKEY  29                S01117 LN0166
     C***********          SETON                     U7U8LR        S01117 LN0166
     C***********          EXSR *PSSR                              S01117 LN0166
     C***********          GOTO END                                S01117 LN0166
     C***********          END                                     S01117 LN0166
     C***********                                                  S01117 LN0166
     C***********                                                         LN0166
     C*****SET*ON INDICATOR TO SHOW AT LEAST ONE DETAIL FOR BRANCH S01117 LN0166
     C***********          SETON                     55            S01117 LN0166
     C***********          ELSE                                           E240
     C***********          SETOF                     53                   E240
     C***********          END                                            E240
     C***********          END                                     S01117 LN0166
     C**N53*******         GOTO END                                       E240
0260 C**                                                           S01117
0237 C                     SETOF                     27
0238 C*****KEEP*RECORD*COUNT                                              E81116
0239 C***01                                                               E81116
0240 C*R*02      NREC      ADD  1         NREC    50                      E81116
0241 C  N02                GOTO END
0242 C**   PROCESS ONLY INTERNAL CONTRACT INSERT
0243 C   23      CHTP      COMP 'I'                      23
0244 C  N23                GOTO END
0245 C**   ACCESS DEALS RECORD
0246 C                     MOVE DLNO      DLKEY   60
0247 C                     EXSR DLCHN
0248 C**   SKIP IF NOT LIVE FIRST LEG
0249 C  N03                GOTO END
     C*                                                                   LN0166
     C           BRCA      IFNE SAVBR                                     LN0166
     C                     CLOSEDL2460P1                                  LN0166
     C   55                SETOF                     55                   LN0166
     C                     OPEN DL2460P1                                  LN0166
     C*                                                                   LN0166
     C* REPORT SPOOL FILE GENERATION                                      LN0166
     C                     Z-ADDSFNUM     ZSNUM   60                      LN0166
     C                     CALL 'ZSFILE'                                  LN0166
     C                     PARM           SEQ                             LN0166
     C                     PARM BRCA      @PARM   3                       LN0166
     C                     PARM           SFILE                           LN0166
     C                     PARM           ZSNUM                           LN0166
     C                     PARM *BLANK    ZSERR   1                       LN0166
     C*                                                                   LN0166
     C           ZSERR     IFEQ 'Y'                         B3            LN0166
     C* Error during ZSFILE processing, return to calling program.        LN0166
     C                     SETON                     U7U8LR               LN0166
     C                     RETRN                                          LN0166
     C                     END                              E3            LN0166
     C*                                                                   LN0166
     C                     Z-ADD0         PAGE                            LN0166
     C*                                                                   LN0166
     C** READ BRANCH DETAILS VIA ACCESS PROGRAM FOR BRANCH NAME           LN0166
     C**********           CALL 'AOBRCHR0'                                LN0166              CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD                           LN0166
     C                     PARM '*KEY   ' @OPTN                           LN0166
     C                     PARM BRCA      @DSNB   3                       LN0166
     C********** @BRCH     PARM @BRCH     DSFDY                           LN0166              CGL029
     C           @BRCH     PARM @BRCH     DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANK                                    LN0166
     C                     MOVEL'SDBRCHPD'DBFILE           ************   LN0166
     C                     MOVEL'02'      DBASE            * DBERR 02 *   LN0166
     C                     MOVEL@OPTN     DBOPTN           ************   LN0166
     C                     MOVELBRCA      DBKEY  29                       LN0166
     C                     SETON                     U7U8LR               LN0166
     C                     EXSR *PSSR                                     LN0166
     C                     GOTO END                                       LN0166
     C                     END                                            LN0166
     C*                                                                   LN0166
     C*                                                                   LN0166
     C**   SET ON INDICATOR TO SHOW AT LEAST ONE DETAIL FOR BRANCH        LN0166
     C                     SETON                     55                   LN0166
     C                     MOVE BRCA      SAVBR   3                       LN0166
     C                     END                                            LN0166
0260 C**                                                                  LN0166
0250 C*****SET*OUTPUT*INDICATOR************************                   E17666
0251 C*********************SETON*********************27                   E17666
     C*********************SETON*********************37    *INPUT TODAY * E17666
0252 C**   CHECK COVER TYPE
0253 C           COVER     COMP 'L'                      21
0253 C  N21      COVER     COMP 'D'                      28               E17666
0249 C  N21N28             GOTO END                                       E17666
0250 C**   SET OUTPUT INDICATOR                                           E17666
0251 C                     SETON                     27                   E17666
     C                     SETON                     37    *INPUT TODAY * E17666
0254 C**   SAVE DETAILS
0255 C                     MOVE INDET     COMMON
0256 C   21                MOVELINDET1    ODET1
0257 C  N21                MOVELINDET2    ODET1
0258 C   21                MOVE INDET2    ODET2
0259 C  N21                MOVE INDET1    ODET2
0260 C**   ACCESS SECOND LEG
0261 C                     MOVE SODN      DLKEY
0262 C                     EXSR DLCHN
0263 C**   ERROR IF NOT FOUND
     C  N04                MOVEL'DEALS'   DBFILE           ************   S01194
     C  N04                MOVEL'02'      DBASE            * DBERR 02 *   S01194
     C  N04                MOVEL'KEY'     DBOPTN           ************   S01194
     C  N04                MOVELDLKEY     DBKEY  29                       S01194
     C  N04                EXSR *PSSR                                     S01194
0264 C  N04                GOTO ERROR
0265 C**   SAVE DETAILS
0266 C   21                MOVE INDET4    ODET1
0267 C  N21                MOVE INDET3    ODET1
0268 C**   OBTAIN CURRENCY DECIMAL PLACES
0269 C                     MOVE CCY1      XCCY
     C                     EXSR CCYDP1
0271 C           XDECP     COMP 1                      3031
0272 C           XDECP     COMP 2                    33  32
     C**   GET SPOT RATE IN 'MULTIPLY' STATE
     C*****      XMDIN     COMP 1                        50               E134
     C           XMDIN     COMP 'M'                      50               E134
     C  N50      1         DIV  XSPOT     SPOTC1 138H
     C   50                Z-ADDXSPOT     SPOTC1
     C                     Z-ADDXDECP     DP1     10
0274 C                     MOVE CCY2      XCCY
     C                     EXSR CCYDP1
0276 C           XDECP     COMP 1                      4041
0277 C           XDECP     COMP 2                    43  42
     C**   GET SPOT RATE IN 'MULTIPLY' STATE
0279 C****       XMDIN     COMP 1                        50               E134
0279 C           XMDIN     COMP 'M'                      50               E134
     C  N50      1         DIV  XSPOT     SPOTC2 138H
     C   50                Z-ADDXSPOT     SPOTC2
     C**   CALCULATE FORWARD COUNTER VALUE
     C**   IS EXCHANGE RATE < 1
     C           EXRT      COMP 1                      5151
     C**   IS RATIO CCY1 SPOT RATE/CCY2 SPOT RATE >1
     C           SPOTC1    DIV  SPOTC2    RESULT 159
     C           RESULT    COMP 1                      5252
0294 C**   CALCULATE SWAP PROFIT/ LOSS
     C**   USE SUBROUTINE CNVRT TO CALCULATE AMOUNT
     C                     Z-ADDAMT1      ZAMNT  150
     C**
     C                     EXSR CNVRT
     C**
     C                     Z-ADDZAMNT     AMT3   130
     C                     Z-ADDZXRAT     WKRAT  159
0295 C           AMT2      SUB  AMT3      SWPL   130 25
0296 C   21                Z-SUBSWPL      SWPL       25
0297 C**   CALCULATE SWAP PROFIT/ LOSS RATE
0298 C                     Z-ADDVDATE     ZIBEG
0299 C                     Z-ADDMDATE     ZIEND
0300 C                     MOVE C2CM      ZICALC
0301 C***********          EXSR GLINTD                                    066550
     C                     EXSR GLINTP                                    066550
0302 C           SWPL      MULT ZDYEAR    WK15   150
0303 C           WK15      DIV  AMT2      SWRAT  117
     C           ZDAYN1    COMP 0                        55               E16669
     C   55                Z-ADD0         SWRAT                           E16669
0304 C***********SWRAT*****DIV  ZDAYN1    SWRAT                           E16669
0304 C  N55      SWRAT     DIV  ZDAYN1    SWRAT                           E16669
0305 C**   CALCULATE INTEREST COUNTER VALUE
     C**
     C**   USE SUBROUTINE TO CALCULATE AMOUNT
     C                     Z-ADDINTAMT    ZAMNT
     C**
     C                     EXSR CNVRT
     C**
     C                     Z-ADDZAMNT     INTCVL 130
0309 C  N21                Z-ADDINTCVL    ICVLWK 130
0310 C   21                Z-SUBINTCVL    ICVLWK
0311 C**   CALCULATION OF THE EFFECT THAT COVERING
0312 C**   THE INTEREST HAS ON THE TRUE RATE
0313 C           ICVLWK    MULT ZDYEAR    WK15
0314 C           WK15      DIV  AMT2      TRURAT 117
     C           ZDAYN1    COMP 0                        55               E16669
     C   55                Z-ADD0         TRURAT                          E16669
0315 C  N55      TRURAT    DIV  ZDAYN1    TRURAT                          E16669
0315 C***********TRURAT****DIV  ZDAYN1    TRURAT                          E16669
0316 C**   CALCULATE OVERALL COST/ BENEFIT
0317 C           SWPL      SUB  ICVLWK    TOTBEN 130 26
0318 C**   CALCULATE TOTAL COST/YIELD
0319 C           SWRAT     SUB  TRURAT    TOTRAT 117
0320 C*
0321 C**   CONVERT DATES TO ALPHA FORMAT
0322 C                     Z-ADDVDATE     ZDAYNO
0323 C                     EXSR ZDATE2
0324 C                     MOVE ZADATE    VDATEA  7
0325 C                     Z-ADDMDATE     ZDAYNO
0326 C                     EXSR ZDATE2
0327 C                     MOVE ZADATE    MDATEA  7
0328 C                     Z-ADDDDATE     ZDAYNO
0329 C                     EXSR ZDATE2
0330 C                     MOVE ZADATE    DDATEA  7
0331 C                     GOTO END
0332 C**
0333 C           ERROR     TAG                             ** ERROR TAG **
0334 C                     SETON                     U7U8LR
0335 C**
0336 C           END       TAG                             ** END TAG **
0337 C*****CHECK*FILE*CONTROLS                                            E81116
0338 C*RNU7NU8***NORE******COMP*NREC                 U8U8                 E81116
0258 C*
     C** ENSURE TOTALS SPOOL FILE RECORDED BY RCF                         S01117
     CLR                   Z-ADDSFNUMU    ZSNUM   60                      S01117
     CLR                   CALL 'ZSFILE'                                  S01117
     C*R************       PARM           SEQ                             E240
     CLR                   PARM           SEQ                             E293
     C*R*******************PARM *BLANK    SEQ                             S01117
     CLR                   PARM *BLANK    @PARM                           S01117
     CLR                   PARM           SFILEU                          S01117
     CLR                   PARM           ZSNUM                           S01117
     CLR                   PARM *BLANK    ZSERR   1                       S01117
     C*                                                                   S01117
     CLR         ZSERR     IFEQ 'Y'                                       S01117
     C** Error during ZSFILE processing, return to calling program        S01117
     CLR                   SETON                     U7U8                 S01117
     CLR                   RETRN                                          S01117
     CLR                   END                                            S01117
0258 C*                                                                   S01117
0339 C********************************************************************
0340 C**   SR. TO CHAIN TO DEALS FILE
0341 C           DLCHN     BEGSR                           *** DLCHN ***
0342 C**
0343 C                     SETOF                     030429
0344 C           DLKEY     CHAINDEALS                29
0345 C**
0346 C                     ENDSR
0347 C**
0348 C********************************************************************
0349 C**   SR. TO SET UP AN ARRAY OF CURRENCIES AND AN ARRAY OF
0350 C**   DECIMAL PLACES FOR THOSE CURRENCIES.
     C**   AMENDED TO INCLUDE ARRAYS OF SPOT RATES AND MULT/DIV IND.
0351 C**
     C           CCYAR1    BEGSR                           *** CCYAR1  ***
0353 C**
0354 C**   SET ARRAY INDEX TO ZERO.
0355 C                     Z-ADD0         X       30 99
0356 C**
0357 C*****SET*UP*KEY*FOR*CURRENCY*TABLE.                                 S01194
0358 C*****                MOVEL'20      'XCYKEY 12                       S01194
0359 C*****                MOVE '    '    XCYKEY                          S01194
0360 C**
0361 C*****SET*LOWER*LIMIT*AND*READ*CURRENCY*TABLE*HEADER.                S01194
0361 C*    SET LOWER LIMIT AND READ CURRENCY FILE                         S01194
0362 C*****      XCYKEY    SETLLTABLED                                    S01194
0362 C***********1         SETLL@A6REA3                            S01194 056433
0362 C           1         SETLLSDCURRD0                                  056433
0363 C**
0364 C**   LOOP TO READ CURRENCY DETAIL RECORDS.
0365 C           XLOOP     TAG                             ** XLOOP TAG **
0366 C*****                READ TABLED                   99               S01194
0366 C***********          READ @A6REA3                  99        S01194 056433
0366 C                     READ SDCURRD0                 99               056433
0367 C**N99      RECTX     COMP 20                   9999                 S01194
0368 C**
0369 C**   END IF ALL CURRENCY RECORDS PROCESSED
0370 C   99                GOTO XEND
0371 C**
0372 C*****IGNORE*DELETED*RECORDS*AND*NON-SUB-RECORD*ONE.                 S01194
0373 C*****      RECIX     COMP 'D'                  9797                 S01194
0374 C***97                GOTO XLOOP                                     S01194
0375 C*****      SRECX     COMP 1                    9797                 S01194
0376 C***97                GOTO XLOOP                                     S01194
0377 C**
0378 C**   INCREMENT ARRAY INDEX.
0379 C           X         ADD  1         X
0380 C**
0381 C**   MOVE DATA INTO ARRAYS.
0382 C*****                MOVE CCYX      CCYA,X                          S01194
0382 C                     MOVE A6CYCD    CCYA,X                          S01194
0383 C*****                MOVE CDPX      DPA,X                           S01194
0383 C                     MOVE A6NBDP    DPA,X                           S01194
     C*****                MOVE SPOT      SPTA,X                          S01194
     C                     MOVE A6SPRT    SPTA,X                          S01194
     C*****                MOVE MDIN      MDA,X                           S01194
     C                     MOVE A6MDIN    MDA,X                           S01194
0384 C**
0385 C**   CHECK FOR FULL ARRAY.96 ON IF FULL.
0386 C           X         COMP 150                      96
0387 C**
0388 C**   GO TO READ NEXT RECORD.
0389 C  N96                GOTO XLOOP
0390 C**
     C**'Z-ADD POW,1     POW,1' IS A DUMMY LINE WHICH HAS BEEN INSERTED
     C** TO USE THE COMPILE-TIME ARRAY POW, WHICH IS NOW REDUNDANT.
     C                     GOTO XEND
     C                     Z-ADDPOW,1     POW,1
0391 C           XEND      TAG                             ** XEND TAG  **
0392 C                     ENDSR
0393 C**
0394 C********************************************************************
0395 C**
0396 C**   SR. TO OBTAIN NO. OF DECIMAL PLACES FOR A CURRENCY.
     C**   AMENDED TO GET SPOT RATE AND MULT/DIV INDICATOR.
0397 C**
     C           CCYDP1    BEGSR                           *** CCYDP1  ***
0399 C**
0400 C**   SET ARRAY INDEX TO ONE AND RESET ERROR INDICATOR.
0401 C                     Z-ADD1         X            99
0402 C**
0403 C**   INITIALIZE INPUT-OUTPUT FIELDS.
0404 C                     Z-ADD0         XDECP   10
     C                     Z-ADD1         XSPOT  138
     C******               Z-ADD0         XMDIN   10                      E134
     C                     MOVE *BLANK    XMDIN   1                       E134
0405 C                     MOVE XCCY      XCCY    3
0406 C**
0407 C**   LOOK UP NO. OF DECIMAL PLACES FOR CURRENCY.
0408 C**   99 SETON FOR INVALID CURRENCY.
0409 C           XCCY      LOKUPCCYA,X                   95
0410 C   95                MOVE DPA,X     XDECP
     C   95                MOVE SPTA,X    XSPOT
     C   95                MOVE MDA,X     XMDIN
0411 C  N95                SETON                     99
0412 C**
0413 C                     ENDSR
0414 C**
     C**
     C**   CNVRT - SUBR TO CALCULATE AN AMOUNT TO VALIDATE EXCHANGE RATW
     C**
     C           CNVRT     BEGSR                           ***  BEGSR  ***
     C**
     C**   SAVE INDICATOR SETTINGS
     C                     SETOF                     16
     C   98                SETON                     16
     C                     EXSR ZSAVE
     C                     SETOF                     96
     C   99                SETON                     96
     C**
     C**   SET UP WORK FIELDS
     C                     Z-ADDEXRT      ZXRAT  138
     C                     Z-ADDDP1       ZFCDP   10
     C                     Z-ADDXDECP     ZTCDP   10
     C**
     C                     MOVE ' '       ZXIND   1
     C   52 51
     CORN52N51             MOVE 'M'       ZXIND
     C   52N51
     CORN52 51             MOVE 'D'       ZXIND
     C*
     C*       ADJUST SPOT RATE TO GIVE CORRECT DECIMAL PLACES
     C*
     C                     SETOF                     909192
     C                     SETOF                     939495
     C                     SETOF                     979899
     C*
     C           ZXIND     COMP 'D'                      97
     C*
     C           ZFCDP     SUB  ZTCDP     ZXCDP   10 919290
     C*
     C   92                Z-SUBZXCDP     ZXCDP
     C*
     C           ZXCDP     COMP 2                    959394
     C*
     C   97 91             SETON                     98
     C   97 98             SETOF                     91
     C   97 92             SETON                     99
     C   97 99             SETOF                     92
     C   97 98             SETON                     92
     C   97 99             SETON                     91
     C*
     C   92 93   ZXRAT     MULT 10        ZXRAT
     C   92 94   ZXRAT     MULT 100       ZXRAT
     C   92 95   ZXRAT     MULT 1000      ZXRAT
     C*
     C   91 93   ZXRAT     DIV  10        ZXRAT     H
     C   91 94   ZXRAT     DIV  100       ZXRAT     H
     C   91 95   ZXRAT     DIV  1000      ZXRAT     H
     C*
     C*       CONVERT CURRENCY AMOUNT
     C*
     C   97      ZAMNT     DIV  ZXRAT     ZAMNT     H
     C  N97      ZAMNT     MULT ZXRAT     ZAMNT     H
     C*
     C**
     C                     SETOF                     9399
     C   96                SETON                     99
     C   16                SETON                     98
     C                     EXSR ZRSTOR
     C**
     C                     ENDSR
     C**
0415 C********************************************************************
0416 C*****                                                               S01194
0417 C*****ZSYSTM SR. TO CHAIN TO THE INSTALLATION CONTROL DATA RECORD.   S01194
0418 C*****                                                               S01194
0419 C*****      ZSYSTM    BEGSR                           *** ZSYSTM *** S01194
0420 C*****                                                               S01194
0421 C*****SET UP KEY FOR INSTALLATION CONTROL RECORD.                    S01194
0422 C*****                MOVEL'01      'ZTABKY 12                       S01194
0423 C*****                MOVE '  10'    ZTABKY                          S01194
0424 C*****                                                               S01194
0425 C*****      ZTABKY    CHAINTABLE                99    ON NOT THERE   S01194
0426 C**N99      RECI      COMP 'D'                  9999  ON, IS DELETED S01194
0427 C*****                                                               S01194
0428 C*****CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.                    S01194
0429 C*****      DATF      COMP 'M'                      98MMDDYY, 98 ON  S01194
0430 C*****                                                               S01194
0431 C*****                ENDSR                                          S01194
0432 C*****                                                               S01194
0433 C*****                                                               S01194
0434 C********************************************************************S01194
0435 C**
0436 C**   ZDATE2 SR. TO CONVERT A DAY NUMBER TO DATE FORMATS.
0437 C**
0438 C**   THE YEAR 2000, BEING DIVISIBLE BY 400, IS A LEAP YEAR.
0439 C**
0440 C           ZDATE2    BEGSR                           *** ZDATE2 ***
0441 C**
0442 C**   CLEAR DATE FIELDS.
0443 C                     Z-ADD0         ZDATE   60
0444 C                     MOVEL'       ' ZADATE  7
0445 C**
0446 C**   CALCULATION TO DEFINE INPUT DAY NUMBER.
0447 C                     Z-ADDZDAYNO    ZDAYNO  50
0448 C**
0449 C**   DETERMINE YEAR NUMBER.
0450 C**
0451 C**   ADJUST DAY NUMBER IN CASE LAST DAY OF YEAR.
0452 C           ZDAYNO    SUB  1         ZDAYN1  50   99
0453 C   99                GOTO ZDEND2
0454 C**
0455 C**   CALCULATE NUMBER OF 4 YEAR SPANS SINCE 31/12/1971.
0456 C           ZDAYN1    DIV  1461      ZLYR    20
0457 C                     MVR            ZDAYN1           SAVE REMAINING
0458 C**                                                   DAYS
0459 C**   CALCULATE NUMBER OF REMAINING YEARS.
0460 C                     Z-ADD1         ZWRK2   20
0461 C           ZDTAG1    TAG                             ** ZDTAG1 TAG *
0462 C           ZDAYN1    COMP ZYDY,ZWRK2             90
0463 C  N90      ZWRK2     ADD  1         ZWRK2
0464 C  N90                GOTO ZDTAG1
0465 C           ZWRK2     SUB  1         ZWRK2          91LEAP YR, 91 ON
0466 C**
0467 C**   DECREMENT DAY NO. BY DAYS IN REMAINING YEARS.
0468 C  N91      ZDAYN1    SUB  ZYDY,ZWRK2ZDAYN1
0469 C**
0470 C**   CALCULATE ACTUAL YEAR NUMBER.
0471 C           ZLYR      MULT 4         ZWRK3   30
0472 C           ZWRK3     ADD  72        ZWRK3            BASE IS 1972
0473 C                     Z-ADDZWRK3     ZYEAR   20
0474 C           ZYEAR     ADD  ZWRK2     ZYEAR            YEAR
0475 C**
0476 C**   DETERMINE MONTH NUMBER.
0477 C**
0478 C**   ADJUST DAY NO. IN CASE LAST DAY OF LEAP YEAR FEBRUARY.
0479 C                     SETOF                     9293
0480 C   91      ZDAYN1    COMP 59                     9293
0481 C   91N92   ZDAYN1    SUB  1         ZDAYN1
0482 C**
0483 C**   CALCULATE MONTH NUMBER.
0484 C                     Z-ADD2         ZWRK2
0485 C           ZDTAG2    TAG                             ** ZDTAG2 TAG *
0486 C           ZDAYN1    COMP ZMDY,ZWRK2             94
0487 C  N94      ZWRK2     ADD  1         ZWRK2
0488 C  N94                GOTO ZDTAG2
0489 C           ZWRK2     SUB  1         ZWRK2
0490 C**
0491 C                     Z-ADDZWRK2     ZMTH    20       MONTH
0492 C**
0493 C**   DETERMINE DAY OF MONTH.
0494 C**
0495 C**   ADD BACK LAST DAY OF YEAR ADJUSTMENT.
0496 C           ZDAYN1    ADD  1         ZDAYN1
0497 C**
0498 C**   CALCULATE DAY OF MONTH.
0499 C           ZDAYN1    SUB  ZMDY,ZWRK2ZDAY    20       DAY
0500 C**
0501 C**   ADD BACK LEAP YEAR 29TH FEBUARY ADJUSTMENT, IF REQUIRED.
0502 C   93      ZDAY      ADD  1         ZDAY
0503 C**
0504 C**   FORMAT DATE, DDMMYY OR MMDDYY.
0505 C  N98                MOVELZDAY      ZWRK4   40
0506 C   98                MOVE ZDAY      ZWRK4
0507 C  N98                MOVE ZMTH      ZWRK4
0508 C   98                MOVELZMTH      ZWRK4
0509 C                     MOVELZWRK4     ZDATE
0510 C                     MOVE ZYEAR     ZDATE
0511 C**
0512 C**   FORMAT ALPHA DATE, DDMMMYY.
0513 C           ZDAY      COMP 10                     95
0514 C                     MOVELZDAY      ZWRK5   5
0515 C   95                MOVEL' '       ZWRK5
0516 C                     MOVE ZMNM,ZMTH ZWRK5
0517 C                     MOVELZWRK5     ZADATE
0518 C                     MOVE ZYEAR     ZADATE
0519 C**
0520 C           ZDEND2    ENDSR                           * ZDEND2 ENDSR*
0521 C**
     C********************************************************************066550
     C**   CALC DAYS IN PERIOD & DAYS IN YEAR                             066550
     C**                                                                  066550
     C**   REQUIRES SUBRS. - ZINTDY                                       066550
     C**                                                                  066550
     C**                                                                  066550
     C           GLINTP    BEGSR                           ** GLINTP  **  066550
     C**   CALCULATIONS TO DEFINE INPUT FIELDS.                           066550
     C                     Z-ADDZIBEG     ZZBEG   50       STARTING DATE  066550
     C                     Z-ADDZIEND     ZZEND   50       FINISHING DATE 066550
     C                     MOVE ZICALC    ZZCALC  1        CALC. BASIS    066550
     C                     EXSR ZINTDY                                    066550
      *                                                                   163136
      * For calculation Method '6'  use new field INT6DY  introduced by   163136
      * core  #126017  in  ZINTDY .                                       163136
      *                                                                   163136
     C           ZZCALC    IFEQ '6'                                       163136
     C                     MOVE INT6DY    ZDAYN1                          163136
     C                     ELSE                                           163136
      *                                                                   163136
     C                     MOVE ZZINDY    ZDAYN1  50                      066550
     C                     END                                            163136
      *                                                                   163136
     C           ZZCALC    IFEQ '2'                                       066550
     C           ZZCALC    OREQ '3'                                       066550
     C           ZZCALC    OREQ '5'                                       066550
     C                     Z-ADD36000     ZDYEAR  50                      066550
     C                     END                                            066550
     C           ZZCALC    IFEQ '1'                                       066550
     C           ZZCALC    OREQ '4'                                       066550
     C                     Z-ADD36500     ZDYEAR                          066550
     C                     END                                            066550
     C           ZZCALC    IFEQ '6'                                       066550
     C                     Z-ADD36600     ZDYEAR                          066550
     C                     END                                            066550
     C                     ENDSR                                          066550
     C********************************************************************066550
0522 C********************************************************************066550
0523 C*****CALC*DAYS IN PERIOD & DAYS IN YEAR (BASED ON GLINTC)           066550
0524 C***********                                                         066550
0525 C*****CALCULATION METHODS ARE -                                      066550
0526 C*****1**ACTUAL/365                                                  066550
0527 C*****2**ACTUAL/360                                                  066550
0528 C*****3**360/360 (SOMETIMES CALLED 30/360)                           066550
0529 C*****4**365/365 (EXCLUDING 29/02)                                   066550
0530 C*****5**365/360 (EXCLUDING 29/02)                                   066550
0531 C*****6**ACTUAL/366                                                  066550
0532 C***********                                                         066550
0533 C*****REQUIRES SUBRS. - ZDATE2, ZSAVE, & ZRSTOR.                     066550
0534 C***********                                                         066550
0535 C***********                                                         066550
0536 C***********GLINTD    BEGSR                           ** GLINTC  **  066550
0537 C***********                                                         066550
0538 C*****CALCULATIONS TO DEFINE INPUT FIELDS.                           066550
0539 C***********          Z-ADDZIBEG     ZIBEG   50       STARTING DATE  066550
0540 C***********          Z-ADDZIEND     ZIEND   50       FINISHING DATE 066550
0541 C***********          Z-ADDZICALC    ZICALC  10       CALC. BASIS    066550
0542 C***********                                                         066550
0543 C****TO*DETERMINE NUMBER OF DAYS INTEREST TO BE CALCULATED           066550
0544 C***********ZIEND     SUB  ZIBEG     ZDAYN1  50                      066550
0545 C***********                                                         066550
0546 C****CHECK*FOR INTEREST CALCULATION BASIS                            066550
0547 C*****USE*OF INDICATRS                                               066550
0548 C*****1,92**2,90  3,91  4,97  5,96  6,95                             066550
0549 C***********          SETOF                     959697               066550
0550 C***********ZICALC    COMP 2                    919290               066550
0551 C**N91******          GOTO ZICAL                                     066550
0552 C***********ZICALC    COMP 5                    959796               066550
0553 C***97******ZICALC    COMP 3                    97  91               066550
0554 C***95******                                                         066550
0555 C*R*96******          SETOF                     91                   066550
0556 C**N91******          GOTO ZILPCK                                    066550
0557 C***********                                                         066550
0558 C*****THIS*CODING WILL CALCULATE THE NUMBER OF DAYS TO USE WHEN      066550
0559 C*****USING*THE 30/360 BASIS - METHOD 3.                             066550
0560 C***********          EXSR ZSAVE                                     066550
0561 C***********          Z-ADDZIBEG     ZDAYNO                          066550
0562 C***********          EXSR ZDATE2                                    066550
0563 C***********          MOVE ZDAY      ZISD    20                      066550
0564 C***********          MOVE ZMTH      ZISM    20                      066550
0565 C***********          MOVE ZYEAR     ZISY    20                      066550
0566 C***********          Z-ADDZIEND     ZDAYNO                          066550
0567 C***********          EXSR ZDATE2                                    066550
0568 C***********          MOVE ZDAY      ZIFD    20                      066550
0569 C***********          MOVE ZMTH      ZIFM    20                      066550
0570 C***********          MOVE ZYEAR     ZIFY    20                      066550
0571 C***********          EXSR ZRSTOR                                    066550
0572 C***********          SETOF                     93                   066550
0    C****IN*ORDER FOR THE FINISH YEAR TO BE LESS THAN THE START YEE49601 066550
     C****ZIEND*IS GREATER THAN ZIBEG,THEN THE DATE ZIEND MUST BE IE49601 066550
     C****DIFFERENT CENTURY TO ZIBEG.IF SO ADD 100 YEARS TO IT.    E49601 066550
     C***********ZIEND     COMP ZIBEG                93            E49601 066550
     C***93******ZIFY      COMP ZISY                   93          E49601 066550
     C***********          Z-ADDZISY      ZISY2   30               E49601 066550
     C**N93******          Z-ADDZIFY      ZIFY2   30               E49601 066550
     C***93******ZIFY      ADD  100       ZIFY2                    E49601 066550
     C***********                                                   E49601066550
     C*****DETERMINE*WHETHER*START*YEAR*IS*A*LEAP*YEAR*AND0T*E49601S01147 066550
     C*****MONTH*IS*FEBRUARY.********************************E49601S01147 066550
     C***********                                            E49601S01147 066550
     C**N98******          BITOF'0'       ZGLBIT  1          E80945S01147 066550
     C***98******          BITON'0'       ZGLBIT             E80945S01147 066550
     C***********ZISY2     ADD  1900      ZLYCHK  40         E49601S01147 066550
     C***********ZLYCHK    DIV  4         ZLYCHK             E49601S01147 066550
     C***********          MVR            ZLYREM  20         E49601S01147 066550
     C***********ZLYREM    COMP *ZERO                    98EAE49601S01147 066550
     C***********ZISM      COMP 2                        99RYE49601S01147 066550
2209 C**N99******30        SUB  ZISD      ZID1    50   93    E49601S01147 066550
2210 C**N99*93***          Z-ADD0         ZID1               E49601S01147 066550
     C***99N98***28        SUB  ZISD      ZID1               E49601S01147 066550
     C***99*98***29        SUB  ZISD      ZID1               E49601S01147 066550
2209 C***********30        SUB  ZISD      ZID1    50   93          S01147 066550
2210 C***93******          Z-ADD0         ZID1                     S01147 066550
2211 C***********ZISM      COMP 12                       93               066550
2212 C***93******          Z-ADD0         ZISM                            066550
2213 C***93******ZISY      ADD  1         ZISY                            066550
     C***93******ZISY2     ADD  1         ZISY2                     E49601066550
     C***********                                                   E49601066550
     C*****DETERMINE*WHETHER*END*YEAR*IS*A*LEAP*YEAR*AND*IF*NTE49601S01147066550
     C*****IS*FEBRUARY.***************************************E49601S01147066550
     C***********                                            E49601S01147 066550
     C***********ZIFY2     ADD  1900      ZLYCHK  40         E49601S01147 066550
     C***********ZLYCHK    DIV  4         ZLYCHK             E49601S01147 066550
     C***********          MVR            ZLYREM  20         E49601S01147 066550
     C***********ZLYREM    COMP *ZERO                    98*AE49601S01147 066550
     C***********ZIFM      COMP 2                        99*YE49601S01147 066550
2214 C**N99******ZIFD      COMP 31                       93  E49601S01147 066550
2214 C***99N98***ZIFD      COMP 28                       93  E49601S01147 066550
2214 C***99*98***ZIFD      COMP 29                       93   E49601S01147066550
     C***********          SETOF                     98       E80945S01147066550
     C***********          TESTB'0'       ZGLBIT         98   E80945S01147066550
2214 C***********ZIFD      COMP 31                       93         S01147066550
0579 C***93******ZID1      ADD  30        ZID1                            066550
0580 C**N93******ZID1      ADD  ZIFD      ZID1                            066550
0581 C***********ZIFM      SUB  1         ZIFM                            066550
1730 C***********ZIFM      COMP ZIFY                     93               E49601
     C***********ZISY      COMP ZIFY                     93         E49601066550
0583 C***93******ZIFM      SUB  ZISM      ZINOM   30                      066550
0584 C***93******          GOTO ZIOUT                                     066550
0585 C***********12        SUB  ZISM      ZIM1    20                      066550
0586 C***********          Z-ADD1         ZISM                            066550
     C*****USE*ENLARGED FIELDS THAT CAN HANDLE 1999 ONWARDS        E49601 066550
1735 C***********ZISY      ADD  1         ZISY                     E49601 066550
1736 C***********ZIFY      SUB  ZISY      ZIY1    20               E49601 066550
     C***********ZISY2     ADD  1         ZISY2                    E49601 066550
     C***********ZIFY2     SUB  ZISY2     ZIY1    20               E49601 066550
0589 C***********ZIY1      MULT 12        ZIM2    30                      066550
0590 C***********ZIM2      ADD  ZIFM      ZIM2                            066550
0591 C***********ZIM1      ADD  ZIM2      ZINOM                           066550
0592 C***********ZIOUT     TAG                             * ZIOUT TAG *  066550
0593 C***********ZINOM     MULT 30        ZID2    50                      066550
0594 C***********ZID2      ADD  ZID1      ZDAYN1                          066550
0595 C***********          SETOF                     93                   066550
0596 C***********ZILPCK    TAG                             * ZILPCK TAG * 066550
0597 C**N96N97***          GOTO ZICAL                                     066550
0598 C*****THE*FOLLOWING CODING APPLIES FOR METHODS 4 AND 5 ONLY.         066550
0599 C*****1*DAY*IS SUBTRACTED FROM ZDAYN1 FOR EACH OCCURANCE OF 29 FEB   066550
0600 C*****IN*THE INTEREST CALCULATION PERIOD INCLUSIVE OF ZIBEG, & ZIEND.066550
0601 C***********                                                         066550
0602 C*****FIND*NO OF 4 YEAR PERIODS BETWEEN DATES                        066550
0603 C***********ZDAYN1    DIV  1461      ZIMAN   20                      066550
0604 C***********          MVR            ZIREM   50                      066550
0605 C*****FIND*NEXT 29 FEB DAY NO. ON OR AFTER ZIBEG.                    066550
0606 C***********ZIBEG     SUB  60        ZIBW1   50                      066550
0607 C***********ZIBW1     DIV  1461      ZIDW1   20                      066550
0608 C***********          MVR            ZIDREM  50                      066550
0609 C***********ZIDREM    COMP 0                        94               066550
0610 C***94******          Z-ADDZIBEG     ZIDW2   50                      066550
0611 C***94******          GOTO ZILP1                                     066550
0612 C*****ROUND*UP RESULT                                                066550
0613 C***********ZIDW1     ADD  1         ZIDW2                           066550
0614 C*****CALCULATE NEXT 29 FEB.                                         066550
0615 C***********ZIDW2     MULT 1461      ZIDW2                           066550
0616 C***********ZIDW2     ADD  60        ZIDW2                           066550
0617 C***********ZILP1     TAG                             * ZILP1 TAG *  066550
0618 C*****IF*THIS NEXT 29 FEB. DAYNO - ZIBEG IS GR. TH. OR EQ. TO        066550
0619 C*****ZIREM*THEN ADD 1 TO ZIMAN.                                     066550
0620 C***********ZIDW2     SUB  ZIBEG     ZILPCP  50                      066550
0621 C***********ZIREM     COMP ZILPCP               94  94               066550
0622 C***94******ZIMAN     ADD  1         ZIMAN                           066550
0623 C*****SUBTRACT ZIMAN FROM ZDAYN1 TO GIVE VALUE OF ZDAYN1             066550
0624 C*****REQUIRED FOR THIS INTEREST CALCULATION.                        066550
0625 C***********ZDAYN1    SUB  ZIMAN     ZDAYN1                          066550
0626 C***********          SETOF                     94                   066550
0627 C***********ZICAL     TAG                             * ZICAL TAG *  066550
0628 C***********                                                         066550
0629 C***90******                                                         066550
0630 C*R*91******                                                         066550
0631 C*R*96******          Z-ADD36000     ZDYEAR  50                      066550
0632 C***92******                                                         066550
0633 C*R*97******          Z-ADD36500     ZDYEAR                          066550
0634 C***95******          Z-ADD36600     ZDYEAR                          066550
0635 C***********                                                         066550
0636 C***********          SETOF                     909192               066550
0637 C***********          SETOF                     959697               066550
0638 C***********          ENDSR                                          066550
0639 C***********                                                         066550
0640 C********************************************************************066550
0641 C**
0642 C           ZRSTOR    BEGSR                           *** ZRSTOR ***
0643 C**
0644 C                     TESTB'0'       ZBITS          90
0645 C                     TESTB'1'       ZBITS          91
0646 C                     TESTB'2'       ZBITS          92
0647 C                     TESTB'3'       ZBITS          93
0648 C                     TESTB'4'       ZBITS          94
0649 C                     TESTB'5'       ZBITS          95
0650 C                     TESTB'6'       ZBITS          96
0651 C                     TESTB'7'       ZBITS          97
0652 C**
0653 C                     ENDSR
0654 C**
0655 C**
0656 C********************************************************************
0657 C********************************************************************
0658 C**
0659 C**   ZSAVE SR. TO MEMORISE THE SETTINGS AND TO SET OFF INDICATORS
0660 C**              90 - 97 BEFORE EXECUTION OF A Z-SUBROUTINE.
0661 C**
0662 C**   THIS SR. IS REQUIRED ONLY IF INDICATORS
0663 C**   90 - 97 ARE USED ELSEWHERE IN A PROGRAM.
0664 C**
0665 C           ZSAVE     BEGSR                           *** ZSAVE ***
0666 C**
0667 C                     BITOF'01234567'ZBITS   1
0668 C   90                BITON'0'       ZBITS
0669 C   91                BITON'1'       ZBITS
0670 C   92                BITON'2'       ZBITS
0671 C   93                BITON'3'       ZBITS
0672 C   94                BITON'4'       ZBITS
0673 C   95                BITON'5'       ZBITS
0674 C   96                BITON'6'       ZBITS
0675 C   97                BITON'7'       ZBITS
0676 C**
0677 C                     SETOF                     909192
0678 C                     SETOF                     939495
0679 C                     SETOF                     9697
0680 C**
0681 C                     ENDSR
0490 C********************************************************************
0683 C**
0646 C********************************************************************S01194
     C*                                                                   S01194
     C           *PSSR     BEGSR                                          S01194
     C*                                                                   S01194
     C           @RUN      IFEQ *BLANK                                    S01194
     C                     MOVE 'Y'       @RUN    1                       S01194
     C                     DUMP                                           S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C                     ENDSR                                          S01194
0490 C********************************************************************
0682 C**
0684 C********************************************************************
      /EJECT                                                              066550
     C/COPY ZSRSRC,ZINTDYZ2                                               066550
      /EJECT                                                              066550
     C/COPY ZSRSRC,ZDATE9Z3                                               066550
      /EJECT                                                              066550
     C/COPY ZSRSRC,GLINTCZ1                                               066550
      /EJECT                                                              066550
     C/COPY ZSRSRC,ZDAT10Z2                                               126017
     C/EJECT                                                              126017
0685 O**DL2460P1D  203      27                                    S01124  S01117
0685 O*********DL2460P1D  203      27 53                                  E240
0685 ODL2460P1D  203      27                                              S01117
0686 O*****                              22 'REFERENCE DL2460'            S01117
0686 O                                   24 'REFERENCE DL2460P1'          S01117
0687 O*****                    TITL      89                               S01194
0687 O                         BJURPT    89                               S01194
0688 O                                  104 'DATE'                        S01194
0689 O*****                    RUNA     112                               S01194
0689 O*************************BJDFIN***112                        S01194 056433
0689 O                         BJMRDT   112                               056433
0690 O                                  123 'PAGE'
0691 O                         PAGE  Z  127
0692 O*****   D  1     27                                                 S01117
0692 O********D  1     27 53                                              E240
0692 O        D  1     27                                                 S01117
0693 O                                   77 'INTERNAL CONTRACT TRANSA'
0694 O                                   82 'CTION'
0695 O*****   D  2     27                                                 S01117
0695 O********D  2     27 53                                              E240
0695 O        D  2     27                                                 S01117
0696 O                                   77 '------------------------'
0697 O                                   82 '-----'
     O******* D  2     27 53                                              E240
     O*******OR        OF 53                                              E240
     O        D  2     27                                                 S01117
     O       OR        OF                                                 S01117
     O                                   12 'BRANCH'                      S01117
     O                         BRCA      16                               S01117
     O                         A8BRNM    48                               S01117
0698 O*****   D  210   27                                                 S01117
0698 O********D  210   27 53                                              E240
0698 O        D  210   27                                                 S01117
0699 O                                   29 'REFERENCE       /'
0700 O                         DLNO1     28
0701 O                         DLNO2     35
0702 O                                   49 'DEAL DATE'
0703 O                         DDATEA    57
0704 O*****   D  114   27                                                 S01117
0704 O********D  114   27 53                                              E240
0704 O        D  114   27                                                 S01117
0705 O                                   18 'MARKET'
0706 O*****   D  3     27                                                 S01117
0706 O********D  3     27 53                                              E240
0706 O        D  3     27                                                 S01117
0707 O                                   18 '------'
0708 O                 21                35 'LOAN PLACED'
0709 O                N21                35 'DEPOSIT RECEIVED'
0710 O                                   58 'AT %'
0711 O                                   69 'FROM'
0712 O                                   79 'TO'
0713 O                                  108 'INTEREST'
     O                 60               128 'MM PROFIT CENTRE'            CAC001
0714 O*****   D  3     27                                                 S01117
0714 O********D  3     27 53                                              E240
0714 O        D  3     27                                                 S01117
0715 O                 30      AMT1      35 ' ,   ,   ,   , 0 '
0716 O                 31      AMT1      35 '   ,   ,   , 0 . '
0717 O                 32      AMT1      35 '  ,   ,   , 0 .  '
0718 O                 33      AMT1      35 ' ,   ,   , 0 .   '
0719 O                         CCY1      40
0720 O                         IRATE     62 '  0 .       -'
0721 O                         VDATEA    70
0722 O                         MDATEA    81
0723 O                 30      INTAMT   109 ' ,   ,   ,   , 0 -'
0724 O                 31      INTAMT   109 '   ,   ,   , 0 . -'
0725 O                 32      INTAMT   109 '  ,   ,   , 0 .  -'
0726 O                 33      INTAMT   109 ' ,   ,   , 0 .   -'
     O                 60      ICPC     122                               CAC001
0727 O*****   D  125   27                                                 S01117
0727 O********D  125   27 53                                              E240
0727 O        D  125   27                                                 S01117
0728 O                                   20 'INTERNAL'
0729 O*****   D  2     27                                                 S01117
0729 O********D  2     27 53                                              E240
0729 O        D  2     27                                                 S01117
0730 O                                   20 '--------'
0731 O                                   35 'SPOT MOVEMENT'
0732 O                                   67 'EXCHANGE RATE'
0733 O                                  100 'COUNTER VALUE'
     O                 60               128 'FX PROFIT CENTRE'            CAC001
0734 O*****   D  3     27                                                 S01117
0734 O********D  3     27 53                                              E240
0734 O        D  3     27                                                 S01117
0735 O                 21                10 'SELL'
0736 O                N21                10 'BUY'
0737 O                 30      AMT1      35 ' ,   ,   ,   , 0 '
0738 O                 31      AMT1      35 '   ,   ,   , 0 . '
0739 O                 32      AMT1      35 '  ,   ,   , 0 .  '
0740 O                 33      AMT1      35 ' ,   ,   , 0 .   '
0741 O                         CCY1      40
0742 O                         SPRAT     65 '   0 .        '
0743 O                 21                75 'BUY'
0744 O                N21                75 'SELL'
0745 O                 40      AMT2     100 ' ,   ,   ,   , 0 '
0746 O                 41      AMT2     100 '   ,   ,   , 0 . '
0747 O                 42      AMT2     100 '  ,   ,   , 0 .  '
0748 O                 43      AMT2     100 ' ,   ,   , 0 .   '
0749 O                         CCY2     105
     O                 60      PRFC     122                               CAC001
0750 O*****   D  2     27                                                 S01117
0750 O********D  2     27 53                                              E240
0750 O        D  2     27                                                 S01117
0751 O                                   35 'FORWARD MOVEMENT'
0752 O                                   67 'EXCHANGE RATE'
0753 O                                  100 'COUNTER VALUE'
0754 O*****   D  3     27                                                 S01117
0754 O********D  3     27 53                                              E240
0754 O        D  3     27                                                 S01117
0755 O                 21                10 'BUY'
0756 O                N21                10 'SELL'
0757 O                 30      AMT1      35 ' ,   ,   ,   , 0 '
0758 O                 31      AMT1      35 '   ,   ,   , 0 . '
0759 O                 32      AMT1      35 '  ,   ,   , 0 .  '
0760 O                 33      AMT1      35 ' ,   ,   , 0 .   '
0761 O                         CCY1      40
0762 O                         EXRT      65 '   0 .        '
0763 O                 21                75 'SELL'
0764 O                N21                75 'BUY'
0765 O                 40      AMT3     100 ' ,   ,   ,   , 0 '
0766 O                 41      AMT3     100 '   ,   ,   , 0 . '
0767 O                 42      AMT3     100 '  ,   ,   , 0 .  '
0768 O                 43      AMT3     100 ' ,   ,   , 0 .   '
0769 O                         CCY2     105
0770 O*****   D  138   27                                                 S01117
0770 O********D  138   27 53                                              E240
0770 O        D  138   27                                                 S01117
0771 O                                   31 'ACTUAL COST/BENEFIT'
0772 O*****   D  2     27                                                 S01117
0772 O********D  2     27 53                                              E240
0772 O        D  2     27                                                 S01117
0773 O                                   31 '-------------------'
0774 O                 25                69 'SWAP BENEFIT AT %'
0775 O                N25                69 'SWAP COST AT %'
0776 O                 25               100 'SWAP BENEFIT'
0777 O                N25               100 'SWAP COST'
0778 O*****   D  3     27                                                 S01117
0778 O********D  3     27 53                                              E240
0778 O        D  3     27                                                 S01117
0779 O                         SWRAT     65 '  0 .       '
0780 O                 40      SWPL     100 ' ,   ,   ,   , 0 '
0781 O                 41      SWPL     100 '   ,   ,   , 0 . '
0782 O                 42      SWPL     100 '  ,   ,   , 0 .  '
0783 O                 43      SWPL     100 ' ,   ,   , 0 .   '
0784 O                         CCY2     105
0785 O*****   D  2     27                                                 S01117
0785 O********D  2     27 53                                              E240
0785 O        D  2     27                                                 S01117
0786 O                                   35 'INTEREST COVERED'
0787 O                                   67 'EXCHANGE RATE'
0788 O                                  100 'COUNTER VALUE'
0789 O*****   D  3     27                                                 S01117
0789 O********D  3     27 53                                              E240
0789 O        D  3     27                                                 S01117
0790 O                 30      INTAMT    36 ' ,   ,   ,   , 0 -'
0791 O                 31      INTAMT    36 '   ,   ,   , 0 . -'
0792 O                 32      INTAMT    36 '  ,   ,   , 0 .  -'
0793 O                 33      INTAMT    36 ' ,   ,   , 0 .   -'
0794 O                         CCY1      40
0795 O                         EXRT      65 '   0 .        '
0796 O                 40      INTCVL   101 ' ,   ,   ,   , 0 -'
0797 O                 41      INTCVL   101 '   ,   ,   , 0 . -'
0798 O                 42      INTCVL   101 '  ,   ,   , 0 .  -'
0799 O                 43      INTCVL   101 ' ,   ,   , 0 .   -'
0800 O                         CCY2     105
0801 O*****   D  2     27                                                 S01117
0801 O********D  2     27 53                                              E240
0801 O        D  2     27                                                 S01117
0802 O                 26                69 'TOTAL BENEFIT AT %'
0803 O                N26                69 'TOTAL COST AT %'
0804 O                 26               100 'OVERALL BENEFIT'
0805 O                N26               100 'OVERALL COST'
0806 O*****   D  3     27                                                 S01117
0806 O********D  3     27 53                                              E240
0806 O        D  3     27                                                 S01117
0807 O***********              TOTRAT    65 '  0 .       '                083281
0808 O***********      40      TOTBEN   100 ' ,   ,   ,   , 0 '           083281
0809 O***********      41      TOTBEN   100 '   ,   ,   , 0 . '           083281
0810 O***********      42      TOTBEN   100 '  ,   ,   , 0 .  '           083281
0811 O***********      43      TOTBEN   100 ' ,   ,   , 0 .   '           083281
0807 O                         TOTRAT    65 '  0 .       '                119341
0808 O                 40      TOTBEN   100 ' ,   ,   ,   , 0 '           119341
0809 O                 41      TOTBEN   100 '   ,   ,   , 0 . '           119341
0810 O                 42      TOTBEN   100 '  ,   ,   , 0 .  '           119341
0811 O                 43      TOTBEN   100 ' ,   ,   , 0 .   '           119341
0807 O*********                IDIR      65 '  0 .       '         083281 119341
0808 O*********        40      IDIA     100 ' ,   ,   ,   , 0 '    083281 119341
0809 O*********        41      IDIA     100 '   ,   ,   , 0 . '    083281 119341
0810 O*********        42      IDIA     100 '  ,   ,   , 0 .  '    083281 119341
0811 O*********        43      IDIA     100 ' ,   ,   , 0 .   '    083281 119341
0812 O                         CCY2     105
     O********T 3      L1 53 27                                           E240
     O        T 3      L1 27                                              S01117
     O                                   66 '*** END OF REPORT FOR'
     O                                   77 ' BRANCH ***'
     O*********                          71 '*** END OF BRANCH REPORT'    S01117
     O*********                          75 ' ***'                        S01117
0685 O***DL2460P1T  203   LRN37                                    S01124 S01117
0685 ODL2460AUT  203   LRN37                                              S01117
     O       OR        LR U7                                              S01117
0686 O*****                              22 'REFERENCE DL2460'            S01117
0686 O                                   24 'REFERENCE DL2460AU'          S01117
0687 O*****                    TITL      89                               S01194
0687 O                         BJURPT    89                               S01194
0688 O                                  104 'DATE'
0689 O*****                    RUNA     112                               S01194
0689 O                         BJMRDT   112                               S01194
0690 O                                  123 'PAGE'
0691 O*****                    PAGE  Z  127                               S01117
0691 O                         PAGE1 Z  127                               S01117
0692 O        T  1     LRN37
0693 O                                   77 'INTERNAL CONTRACT TRANSA'
0694 O                                   82 'CTION'
0695 O        T  3     LRN37
0696 O                                   77 '------------------------'
0697 O                                   82 '-----'
0695 O        T 3      LRN37
0712 O                                   75 '* NO INPUT TODAY *'
0813 O********T  203   LR                                                 E81116
0814 O********                           22 'REFERENCE DL2460'            E81116
0815 O********                 TITL      89                               E81116
0816 O********                          104 'DATE'                        E81116
0817 O********                 RUNA     112                               E81116
0818 O********                          123 'PAGE'                        E81116
0819 O********                 PAGE  Z  127                               E81116
0820 O********T  1     LR                                                 E81116
0821 O********                           54 'INTERNAL CONTRACT '          E81116
0822 O********                           71 'TRANSACTIONS FILE'           E81116
0823 O********                           86 ' CONTROL REPORT'             E81116
0824 O********T  2     LR                                                 E81116
0825 O********                           56 '---------------------'       E81116
0826 O********                           76 '---------------------'       E81116
0827 O********                           86 '-----------'                 E81116
0828 O********T  222   LR                                                 E81116
0829 O********                           44 'READ FROM S/DTRIX'           E81116
0830 O********                 NORE  Z   54                               E81116
0831 O********                           74 'CALCULATED'                  E81116
0832 O********                 NREC  Z   84                               E81116
0833 O*****   T  3     LR U7 U8                                           S01194
0834 O*****                              71 '*** DATABASE IN ERROR **'    S01194
0835 O*****                              72 '*'                           S01194
0836 O********T  2     LR U8NU7                                           E81116
0837 O********                           69 '*** DIFFERENCE ***'          E81116
0838 O*****   T 3      LR                                                 S01117
0839 O*****                              72 '** END OF REPORT **'         S01117
0638 O        T  3     LR U7 U8                                           S01194
     O                                   71 '*** PRINT TERMINATED ***'    S01194
     O        T 2      LR U7 U8                                           S01194
     O                                   57 'DATABASE ERROR'              S01194
     O                         DBASE     61                               S01194
     O                                   67 'FILE'                        S01194
     O                         DBFILE    78                               S01194
     O        T 13     LR U7 U8                                           S01194
     O                                   49 'OPTION'                      S01194
     O                         DBOPTN    57                               S01194
     O                                   66 'KEY'                         S01194
     O                         DBKEY     96                               S01194
     O        T   22   LRNU7N55                                           S01194
0742 O********                           59 '***   NO DETAILS TO '  S01194LN0298
0743 O********                           71 'REPORT   ***'          S01194LN0298
0742 O                                   70 '***   NO DETAILS TO '        LN0298
0743 O                                   82 'REPORT   ***'                LN0298
** CPY@   **      OBJECT COPYRIGHT
(c) Misys International Banking Systems Ltd. 2001
**   POW - POWERS OF 10
0000001
0000010
0000100
0001000
0010000
0100000
1000000
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
** @YD  USED BY SR. ZDATE9 - YEARS, IN DAYS, CUMULATIVE IN 4 YEAR SPAN
00366007310109601461
** @MD  USED BY SR. ZDATE9 - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
00000000310005900090001200015100181002120024300273003040033400365
