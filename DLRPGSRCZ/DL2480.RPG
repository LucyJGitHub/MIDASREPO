0001 H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas DL Deals by Customer Print')                     *
0002 F*****************************************************************
0004 F*                                                               *
0003 F*  Midas - Dealing Module                                   *
0004 F*                                                               *
0005 F*  DL2480  -  DEALS BY CUSTOMER PRINT                           *
0006 F*                                                               *
      *  (c) Finastra International Limited 2001                      *
0008 F*                                                               *
      *  Last Amend No. MD054957           Date 11Dec19               *
      *  Prev Amend No. 261960             Date 26Apr13               *
      *                 MD046248           Date 27Oct17               *
      *                 CDL099             Date 06Oct17               *
      *                 CGL165             Date 17Feb15               *
      *                 CDL096             Date 22Sep14               *
      *                 CDL094             Date 11Jun14               *
      *                 CER059             Date 19Jul10               *
      *                 CER054             Date 07Apr09               *
      *                 CER043             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD031             Date 10Apr06               *
      *                 117478             DATE 26May06               *
      *                 CDL049             Date 05Jul06               *
      *                 CSD027             Date 09Dec05               *
      *                 CDL038             Date 10May05               *
      *                 237063             Date 20Nov05               *
      *                 BUG7411            Date 01Jun05               *
      *                 CSW037A            Date 02May05               *
      *                 CDL028             Date 07Feb05               *
      *                 229544             Date 15Sep04               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CLE025             Date 20Oct03               *
      *                 CDL021             Date 03Feb04               *
      *                 CGL029             Date 01Sep03               *
      *                 222727             Date 05Nov03               *
      *                 CDL010             Date 02Aug02               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.04 -----------------------------------------------*
      *                 CSD007             Date 28Aug00               *
      * Midas DBA 3.03 -----------------------------------------------*
      *                 CIR005             Date 21Jan00               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 055006             Date 09FEB96               *
     F*                 068210             DATE 25OCT94               *
     F*                 S01444             DATE 16SEP93               *
     F*                 065625             DATE 18MAR94               *
     F*                 065877             DATE 15FEB94               *
     F*                 S01453             DATE 14DEC93               *
     F*                 048553             DATE 16MAR93               *
     F*                 S01378             DATE 15OCT92               *
     F*                 046779             DATE 06NOV92               *
     F*                 AUS015             DATE 24AUG92               *
     F*                 E27537             DATE 04SEP91               *
     F*                 S01319             DATE 19AUG91               *
     F*                 E26471             DATE 19JUL91               *
     F*                 E26358             DATE 17JUL91               *
     F*                 E26357             DATE 17JUL91               *
     F*                 E23597             DATE 16NOV90               *
     F*                 E20251             DATE 05JUL90               *
     F*                 BHF486             DATE 24AUG90               *
     F*                 E242               DATE 07MAR90               *
     F*                 S01194             DATE 12/10/89              *
     F*                 S01117             DATE 12/10/89              *
     F*                 S01157             DATE 19/01/89              *
     F*                 E14702             DATE 23/08/88              *
     F*                 E14630             DATE 22/08/88              *
     F*                 S01136             DATE 10/03/88              *
     F*                 E12036             DATE 10/03/88              *
     F*                                                               *
     F*---------------------------------------------------------------*
     F*                                                               *
      *  MD054957 - RBRU SP21 Compatibility Patch (Recompile)         *
      *  261960 - Use correct interest rate HKINTR instead of HKIIRT. *
      *  MD046248 - Finastra Rebranding                               *
      *  CDL099 - Split Value Date (Recompile)                        *
      *  CGL165 - Dual Withholding Tax (Recompile)                    *
      *  CDL096 - Business Day Conventions on MM Deals                *
      *           (Recompile)                                         *
      *  CDL094 - Enhance  Receive Settlement Instructions            *
      *           (Recompiled)                                        *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  CER054 - German Features - Church Tax (Recompile)            *
      *  CER043 - German Features LF041-00 New Fields and Defaulting  *
      *           (Recompile)                                         *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
     F*  117478 - Deal type CI(certificate of deposit issued) is      *
     F*           being reported against the internal customer.       *
     F*           It should be picked up via the counterparty         *
     F*           which on DEALSDC is held in field CHNA so new       *
     F*           format on DEALSDC needs handling.                   *
      *  CDL049 - Addition of a Reference Rate field (recompile)      *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CDL038 - Extended Deal Sub Type                              *
      *  237063 - EU Tax fixes upgrade to MP build 103 (Recompile).   *
      *  BUG7411- CDL028 fields missing from DLGHISPD (Recompile)     *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CDL028 - Automatic Rate Interpolations (Recompile)           *
      *  229544 - Recompiled due to inserted fields in DLCHISPD.      *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CDL021 - Reports by Deal Type                                *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  222727 - Release 5.0 errors  (Recompile)                     *
      *  CDL010 - Prevent last user that actioned the trade from      *
      *           authorising it.Recompile due to changes in FXDEALPP.*
      *           , MMDELDPP, MMDENBPP AND MMDENSPP .                 *
      *  CSD007 - Customer Closing                                    *
      *  CIR005 - FRA/IRS Business Day Conventions CACUSDLL recompile *
     F*  055006 - If a deal record for a customer on DEALSDG is       *
     F*           followed by a record for the same customer on       *
     F*           any of the DRS files, the FRA/IRS deal is printed   *
     F*           and the DRS deal is not printed. This is because    *
     F*           the DRS files do not have field DTYP so it is not   *
     F*           reset - fix is to initialise DTYP each cycle.       *
     F*  068210 - Field used for maturity not cleared correctly.      *
     F*  S01444 - The deals file amended to include all the           *
     F*           historic deals files.                               *
     F*  065625 - Erroneous characters appearing on 2nd line.         *
     F*  065877 - Remove conditioning of read of month names file     *
     F*           FDMNTHL0 on FD indicator, file is set up when       *
     F*           indicator off.                                      *
     F*  S01453 - MARGIN AND FX POSITIONS/POINTS AND BASE CURRENCY    *
     F*           POSITIONS/POINTS ADDED TO FX INPUT (RECOMPILED)     *
     F*  048553 - REMOVE AUS015 (AND 046779 AS WELL)                  *
     F*  S01378 - Facilitates the partial sale of a parcel            *
     F*           of negotiable instruments which have been           *
     F*           previously input to the system as a single          *
     F*           transaction (was MOF53). Include details            *
     F*           for parcelled trades.                               *
     F*  046779 - Correction to AUS015                                *
     F*  AUS015 - Customer FX/MM Deals Enquiry                        *
     F*  E27537 - FORMAT THE INTEREST RATE SPREAD IF THE BASE RATE    *
     F*           CODE IS EITHER BLANK OR '00' AS SOME DEALS EXIST    *
     F*           WITH '00' AS A BASE RATE CODE                       *
     F*  S01319 - Remove redundant processing                         *
     F*  E26471 - REPLACE CODING IN SUBROUTINES LINE01 AND LINE02     *
     F*           TAKEN OUT BY BHF486 AS NOSTRO TRANSFER DEALS GET    *
     F*           PRINTED WITHOUT ANY DETAILS OTHERWISE               *
     F*  E26358 - 'NO DETAILS' AND 'END OF REPORT' ARE THE WRONG WAY  *
     F*           ROUND                                               *
     F*  E26357 - IF THERE ARE NO DEALS FOR THE PARTICULAR CUSTOMER   *
     F*           THE REPORT IS FOR THEN SHOULD PRODUCE 'NO DETAILS'  *
     F*           INSTEAD OF DATABASE ERROR 05                        *
     F*  E23597 - Exclude Arbitrage record formats from new version   *
     F*           of CACUSDLL.                                        *
     F*  E20251 - Does not show deals 'N'. Change to CACUSDLL to      *
     F*           allow for selection of these records from the       *
     F*           MIDAS deals files. All reference to CUSDL           *
     F*           MMCUSDLL and FXCUSDLL deleted as all deals can be   *
     F*           viewed through the CACUSDLL FILE.                   *
     F*           Also Show Midas deal type from MM files not DRS     *
     F*           deal type.                                          *
     F*           (MOSTLY SUPERSEDED BY BHF486)                       *
     F*           Also Correct Overprinting on a database error.      *
     F*           (SUPERSEDED BY S01194)                              *
     F*  BHF486 - SPEED UP COB BY REMOVING REDUNDANT FILES. THIS WILL *
     F*           SPEED UP DLC0606B WHICH IS A COB BOTTLENECK DUE TO  *
     F*           DEPENDANCIES.                                       *
     F*  E242   - CHANGE RECORDS PER PAGE COUNT TO 13 AS NOT ENOUGH   *
     F*           SPACE FOR EXACTLY 14 RECORDS AND END MESSAGE.       *
     F*  S01117 - MULTI-BRANCHING CHANGES                             *
     F*  S01194 - NEW STANDING DATA CHANGES                           *
     F*  S01157 - FRA/IRS ENHANCEMENTS - ADD BUY/SELL IND. TO REPORT  *
     F*         - OUTPUT RELEVANT DETAILS                             *
     F*  E14702 - FD FILES ACCESSED IRRESPECTIVE OF WHETHER DRS IS    *
     F*           INSTALLED OR NOT, CAUSING DB ERROR.                 *
     F*  E14630 - TO ENSURE EDITED SALE AMOUNT PRINTED HAS THE SAME   *
     F*           NUMBER OF DECIMALS AS THE SALE CURRENCY             *
0011 F*  S01136 - DRS INCORPORATION - INCLUDE PROCESSING FOR FX/MM    *
     F*  E12036   WHEN 'CF 8' IS PRESSED ON THE 'OUTSTANDING DEALS    *
     F*           BY CUSTOMER' ENQUIRY SCREEN TO PRINT REPORT THE     *
     F*           WORD 'MATURED' WILL NOW BE PRINTED FOR MATURED MM   *
     F*           DEALS AS WELL AS FX DEALS.                          *
     F*                                                               *
0010 F*****************************************************************
0011 F/SPACE 3
0012 F********CUSDL   IF  E           K        DISK                       S01136
0012 F*****CUSDL   IF  E    K        DISK                     U  C  S01136BHF486
     F***CLINT   IF  F     256  7AI     2 DISK                            S01194
0014 F***TABLE   IF  F      96 12AI     2 DISK                            S01194
0015 F***DL2480P1O   F     132     OF     PRINTER                  S01124 S01117
0015 FDL2480P1O   F     132     OF     PRINTER      KINFDS SPOOL          S01117
     FCACUSDLLIF  E           K        DISK         KINFSR *PSSR      UC  S01136
     F            ABDEALP0                          KIGNORE               E23597
     F            ABDEALP1                          KIGNORE               E23597
     F            DLBHISD0                          KRENAMECACHIBD0       S01444
     F            DLCHISD0                          KRENAMECACHICD0       S01444
     F            DLDHISD0                          KRENAMECACHIDD0       S01444
     F            DLEHISD0                          KRENAMECACHIED0       S01444
     F            DLGHISD0                          KRENAMECACHIGD0       S01444
     F**********  DEALSDGF                          KRENAMECADLSDGF       S01136
     F                                              KINFDS INIDS          S01136
     F*****FXCUSDLLIF  E      K        DISK         KINFSR *PSSRUC  S01136BHF486
     F********    FXDEALP0                          KRENAMEFXDEALP1 S01136BHF486
     F********    DEALSDCF                          KRENAMEFXDLSDCF S01136BHF486
     F********    DEALSDDF                          KRENAMEFXDLSDDF S01136BHF486
     F********    DEALSDEF                          KRENAMEFXDLSDEF S01136BHF486
     F********    DEALSDGF                          KRENAMEFXDLSDGF S01136BHF486
     F********                                      KINFDS INGDS    S01136BHF486
     F*******MMCUSDLLIF  E   K        DISK         KINFSR *PSSRU C  S01136BHF486
     F********    DEALSDBF                          KRENAMEMMDLSDBF S01136BHF486
     F********    DEALSDGF                          KRENAMEMMDLSDGF S01136BHF486
     F********    MMDELDP0                          KRENAMEMMDELDP1 S01136BHF486
     F********    MMDENBP0                          KRENAMEMMDENBP1 S01136BHF486
     F********    MMDENSP0                          KRENAMEMMDENSP1 S01136BHF486
     F********                                      KINFDS INHDS    S01136BHF486
     F********** FXTB40LLIF  EK        DISK         KINFSR *PSSR          E14702
     F*FXTB40LLIF E           K        DISK         KINFSR *PSSRUC  E14702S01194
     F*FDCCYDLLIF E           K        DISK         KINFSR *PSSRUC  S01136S01194
     F********** FDPMNTLLIF  E         DISK         KINFSR *PSSR          E14702
     F*FDPMNTLLIF**E*******************DISK*********KINFSR**PSSRUC**E14702S01319
     FFDMNTHLLIF  E                    DISK         KINFSR *PSSR      UC  S01319
     F********** FDINSTLLIF  E         DISK         KINFSR *PSSR          E14702
     F*FDINSTLLIF**E*******************DISK*********KINFSR**PSSRUC**E14702S01319
     F/COPY WNCPYSRC,DLH00235
0016 F/SPACE 3
0017 F* ID F  C  H  L    FUNCTION OF INDICATORS
0025 F**01*****       CUSDL B RECORD - FX                                 BHF486
0026 F**02*****       CUSDL C RECORD - LOANS/DEPOSITS                     BHF486
0027 F**03*****       CUSDL D RECORD - NA PURCHASED                       BHF486
0028 F**04*****       CUSDL E RECORD - NA SOLD                            BHF486
     F*    23         MATURITY DATE ZERO
     F*       29      CUSDL RECORD NOT FOUND
     F*       30      CUSDL END OF FILE
     F*       31      LIVE RECORDS SELECTED
     F*       32      MATURED RECORDS SELECTED
     F*      N31N32   LIVE AND MATURED SELECTED
     F*       34      OPTION DEAL
     F*       35      NOSTRO TRANSFER
0025 F*       40      1ST CYCLE IND.
0027 F*       42      MATURED DEAL
     F*       43      TO ENABLE HEADINGS TO BE PRINTED IF DBERROR         S01194
0030 F*       44      NO DETAIL RECORDS
0031 F*       46      DEAL TYPE C1
0031 F*       54      DISPLAY BUY/SELL INDICATOR                          S01157
0058 F*       55      FEDERAL FUND DEAL
0059 F*       56      DEAL IN DOLLARS
1111 F*       57      FEDERAL FUND SALE
0061 F*       58      SALE IN DOLLARS
     F*       65      ONLY F.X. DEALS REQUESTED
     F*       67      ONLY M.M. DEALS REQUESTED
0043 F*       80      I/P CYCLE RUN
     F*          U7U8 DATABASE ERROR
     E                    CPY@    1   1 80
0045 E                    ZYDY    4   4  4 0             ZDATE1/2 SR.ARRAY
0046 E                    ZMDY   13  13  3 0             ZDATE1/2 SR.ARRAY
0047 E                    ZMNM   12  12  3               ZDATE2 SR. ARRAY
     E*
     E********************TXT     1   5 56               TEXT             S01378
     E********************TXT     1   6 56               TEXT      S01378 065625
     E                    TXT     1   6 60               TEXT             065625
     E**********          LIN       100  1               LINE02 SR ARRAY  S01378
     E                    LIN       111  1               LINE02 SR ARRAY  S01378
     E*    ARRAYS FOR EDITING AN AMOUNT ACCORDING TO NO. OF DPS.
     E                    ZEDT        5  4               EDITED AMOUNT
     E                    ZED2        6  3               AMT WITH NO COMMA
     E                    ZAMT        5  3               AMOUNT FIELD
     E                    Z3          3  1               DUMMY 3 CHAR FLD
     E                    ZCOM    1   4 20               EDT CHARS FOR AMT
     E                    RAT        11  1 0             EDITED AMOUNT
     E                    OUT        12  1               EDITED AMOUNT
     E*                                                                   S01136
     E**  ARRAY OF MONTH NAMES                                            S01136
     E                    @MN        12  3                                S01136
     E*                                                                   S01136
     E** ARRAY FOR ALLIGN AND VALIDATION                                  S01136
     E                    @A1        10  1                                S01136
     E                    @A2        10  1                                S01136
     E*                                                                   S01136
     E** ARRAYS USED IN SR.ZA0750                                         S01136
     E*                                                                   S01136
     E** ARRAY FOR AMOUNT INPUT                                           S01136
     E                    @D         15  1                                S01136
     E*                                                                   S01136
     E** ARRAY FOR DISPLAY AMOUNT                                         S01136
     E                    @E         21  1                                S01136
     E*                                                                   S01136
     E** WORK ARRAY                                                       S01136
     E                    @C         21  1                                S01136
     E*                                                                   S01136
     E** ARRAY USED BY STANDARD SR.MM1013                                 S01136
     E                    @W         13  1                                S01136
     E*                                                                   S01136
     E*                                                                   S01136
     E** TABLE FOR DEAL STATUS NARRATIVE                                  S01136
     E                    TABA    1   6  1   TABB    7                    S01136
     E*                                                                   S01378
     E** @IN, @OUT used to format parcel size (drop leading zeros)        S01378
     E                    @IN         5  1                                S01378
     E                    @OUT        5  1                                S01378
0051 E/EJECT
0053 I******DEALSDBF    01                                                BHF486
0109 I******                                        OTDT            23    BHF486
0054 I******                                                              BHF486
0055 I******DEALSDCF    02                                                BHF486
0109 I******                                        MDAT            23    BHF486
0074 I******                                                              BHF486
0075 I******DEALSDDF    03                                                BHF486
0109 I******                                        MDAT            23    BHF486
0084 I******                                                              BHF486
0085 I******DEALSDEF    04                                                BHF486
     I***SET*RECORD*ID*INDICATORS*FOR*MIDAS*FILES*WHEN*FX&MM*MODULE S01136E20251
0331 I**************************************************************S01136E20251
     I*****DETAIL*-*FRA/IRS**********************                  S01136 E20251
     I*******************************************                  S01136 E20251
     I******CADLSDGF****11**********************                    S01136BHF486
     I*DEALSDGF****11*************************                      BHF486E20251
     I****************************************      MDAT           S01136 E20251
     I****************************************                     S01136 E20251
     IDEALSDBF    01                                                      E26471
     I                                              OTDT            23    E26471
     ICACHIBD0    01                                                      S01444
     I                                              OTDT            23    S01444
     IDEALSDCF    02                                                      E26471
     I                                              MDAT            23    E26471
     ICACHICD0    02                                                      S01444
     I                                              MDAT            23    S01444
     IDLSDCFCI    02                                                      117478
     I                                              MDAT            23    117478
     IDEALSDDF    03                                                      E26471
     I                                              MDAT            23    E26471
     ICACHIDD0    03                                                      S01444
     I                                              MDAT            23    S01444
     IDEALSDEF    04                                                      E26471
     ICACHIED0    04                                                      S01444
     IDEALSDGF    11                                                      E26471
     I                                              MDAT            23    E26471
     ICACHIGD0    11                                                      S01444
     I                                              MDAT            23    S01444
     IFXDEALP0                                                            S01136
0099 I              FHDDLT                          DLREC                 S01136
0099 I              FHDSTS                          DLSTS                 S01136
     I*                                                                   S01136
     IMMDELDP0                                                            S01136
0099 I              HKDDLT                          DLREC                 S01136
0099 I              HKDSTS                          DLSTS                 S01136
     I*                                                                   S01136
     IMMDENBP0                                                            S01136
0099 I              HLDDLT                          DLREC                 S01136
0099 I              HLDSTS                          DLSTS                 S01136
     I*                                                                   S01136
     IMMDENSP0                                                            S01136
0099 I              HMDDLT                          DLREC                 S01136
0099 I              HMDSTS                          DLSTS                 S01136
     I/COPY WNCPYSRC,DLH00236
     I*******                                                       S01136BHF486
     I*******                                                       S01136BHF486
     I***SET*RECORD ID INDICATORS FOR MIDAS FILES WHEN MM MDULE ON  S01136BHF486
     I*****                                                         S01136BHF486
     I******MMDELDP1                                                S01136BHF486
0099 I*****         HKDDLT                          DLREC           S01136BHF486
0099 I*****         HKDSTS                          DLSTS           S01136BHF486
     I*****                                                         S01136BHF486
     I*******MMDENBP1                                               S01136BHF486
0099 I*****         HLDDLT                          DLREC           S01136BHF486
0099 I*****         HLDSTS                          DLSTS           S01136BHF486
     I*****                                                         S01136BHF486
     I*******MMDENSP1                                               S01136BHF486
0099 I*****         HMDDLT                          DLREC           S01136BHF486
0099 I*****         HMDSTS                          DLSTS           S01136BHF486
0089 I*****                                                         S01136BHF486
0093 I*****DETAIL RECORD - FX SWAPS/OUTRIGHTS.                      S01136BHF486
0094 I*****                                                         S01136BHF486
0095 I*******MMDLSDBF    01                                         S01136BHF486
0109 I*****                                         OTDT      23    S01136BHF486
0331 I*****                                                         S01136BHF486
     I*****DETAIL - FRA/IRS                                         S01136BHF486
     I*****                                                         S01136BHF486
     I*******MMDLSDGF    11                                         S01136BHF486
     I*****                                         MDAT      23    S01136BHF486
     I*****                                                         S01136BHF486
     I** SET RECORD ID INDICATORS FOR MIDAS FILES WHEN FX MODULE ON S01136BHF486
     I*****                                                         S01136BHF486
     I********FXDEALP1                                              S01136BHF486
0099 I*****         FHDDLT                          DLREC           S01136BHF486
0099 I*****         FHDSTS                          DLSTS           S01136BHF486
0144 I*****                                                         S01136BHF486
0145 I*****DETAIL - TAKINGS/PLACINGS/TIME DEPOSITS/LOANS.           S01136BHF486
0146 I*****                                                         S01136BHF486
0147 I*******FXDLSDCF    02                                         S01136BHF486
0161 I*****                                         MDAT      23    S01136BHF486
0219 I*****                                                         S01136BHF486
0220 I*****DETAIL RECORD - NEGOTIABLE ASSETS PURCHASED.             S01136BHF486
0221 I*****                                                         S01136BHF486
0222 I*******FXDLSDDF    03                                         S01136BHF486
0236 I*****                                         MDAT      23    S01136BHF486
0292 I*****                                                         S01136BHF486
0293 I*****DETAIL RECORD - NEGOTIABLE ASSETS SOLD.                  S01136BHF486
0294 I*****                                                         S01136BHF486
0295 I******FXDLSDEF    04                                          S01136BHF486
0331 I*****                                                         S01136BHF486
     I*****DETAIL - FRA/IRS                                         S01136BHF486
     I*****                                                         S01136BHF486
     I******FXDLSDGF    11                                          S01136BHF486
     I*****                                         MDAT      23    S01136BHF486
0088 I*
     I**** CLIENT FILE DETAIL                                             S01194
     I****                                                                S01194
     I****CLINT   NS  05   1 CD                                           S01194
     I****                                    2   70CNUM                  S01194
     I****                                   39  48 CSNM                  S01194
     I****                                    9  28 CRNM                  S01194
     I****                                   29  38 CTWN                  S01194
0089 I****                                                                S01194
0090 I**** TABLE FILE - INSTALLATION CONTROL DATA RECORD 1.               S01194
0091 I****                                                                S01194
0092 I***TABLE   NS       2 C0   3 C1  12 C1                              S01194
0093 I****   AND      13 C0                                               S01194
0094 I****                                    1   1 RECI                  S01194
0095 I****                                    2   30RECT                  S01194
0096 I****                                   12  130RCDE                  S01194
0097 I****                                   14  66 TITL                  S01194
0098 I****                                   67  67 DATF                  S01194
0099 I****                                   68  700DFBR                  S01194
0100 I****                                   74  74 MODI1                 S01194
0101 I****                                   75  75 MODI2                 S01194
0102 I****                                   76  76 MODI3                 S01194
0103 I****                                P  77  790RUND                  S01194
0104 I****                                   80  86 RUNA                  S01194
0105 I****                                   87  870SFLG                  S01194
0106 I****                                P  90  920LCD                   S01194
0107 I****                                   93  93 CHTP                  S01194
0108 I****                                P  94  960TNLU                  S01194
0090 I**** TABLE FILE - INSTALLATION CONTROL DATA RECORD 5.               S01194
0367 I****    NS       1 CD   2 C0   3 C1                                 S01194
0368 I****   AND      12 C4  13 C0                                        S01194
0369 I****                                    1   1 RECI                  S01194
0370 I****                                   47  49 USCY                  S01194
0109 I****                                                                S01194
0338 I**** TABLE FILE - CURRENCIES RECORD 1.                              S01194
0361 I****    NS       1 CD   2 C2   3 C0                                 S01194
0362 I****   AND      13 C1                                               S01194
0363 I****                                   38  380XDECP                 S01194
0109 I****                                                                S01194
0110 I**CATCHALL                                                          S01194
0111 I****    NS                                                          S01194
0112 I****                                    1   1 RECI                  S01194
     I*FDPMNTL1***********************************************************S01319
     IFDMNTHP0                                                            S01319
     I              MNNM1                           @MN,1
     I              MNNM2                           @MN,2
     I              MNNM3                           @MN,3
     I              MNNM4                           @MN,4
     I              MNNM5                           @MN,5
     I              MNNM6                           @MN,6
     I              MNNM7                           @MN,7
     I              MNNM8                           @MN,8
     I              MNNM9                           @MN,9
     I              MNNM10                          @MN,10
     I              MNNM11                          @MN,11
     I              MNNM12                          @MN,12
 542 I*
0383 I**** DATA STRUCTURE FOR KEY TO CURRENCY TABLE.                      S01194
0384 I****        DS                                                      S01194
0385 I****                                    1  12 XCYKEY                S01194
0386 I****                                    1   8 XCY1                  S01194
0387 I****                                    9  11 XXCCY                 S01194
0388 I****                                   12  12 XCY2                  S01194
     I*                                                                   S01136
     I** INFORMATION DATA STRUCTURE,FOR FORMAT ACCESSED                   S01136
     I*                                                                   S01136
     I*****INGDS       DS                                           S01136BHF486
     I******                               *RECORD  RECGMT          S01136BHF486
     I******                                                        S01136BHF486
     I***INHDS       DS                                             S01136BHF486
     I*******                              *RECORD  RECHMT          S01136BHF486
     I*                                                                   S01136
     IINIDS       DS                                                      S01136
     I                                     *RECORD  RECIMT                S01136
     I/COPY WNCPYSRC,DLH00237
     I*                                                                   S01136
     I** DATA STRUCTURE FOR MODULES PRESENT                               S01136
     IMMODS       DS                            256                       S01136
     I                                       11  11 MODFD                 E14702
     I********                               13  14 MODS            S01136BHF486
     I*                                                                   S01136
     I**  Used by ZA0660 - Date input in YYYYMMDD format                  S01136
     I            DS                                                      S01136
     I                                        1   80@@DTIN                S01136
     I                                        1   40@@YYYY                S01136
     I                                        5   60@@MTH                 S01136
     I                                        7   80@@DAY                 S01136
     I*                                                                   S01136
     I** DRS - DL VALUE DATE DATA STRUCTURE                               S01136
     I            DS                                                      S01136
     I                                        1   80@VDAT                 S01136
     I                                        1   40FHVDYY                S01136
     I                                        1   40HKVDYY                S01136
     I                                        1   40HLVDYY                S01136
     I                                        1   40HMVDYY                S01136
     I                                        5   60FHVDMM                S01136
     I                                        5   60HKVDMM                S01136
     I                                        5   60HLVDMM                S01136
     I                                        5   60HMVDMM                S01136
     I                                        7   80FHVDDD                S01136
     I                                        7   80HKVDDD                S01136
     I                                        7   80HLVDDD                S01136
     I                                        7   80HMVDDD                S01136
     I*                                                                   S01136
     I*                                                                   S01136
     I** DRS - DL OPTION END DATE DATA STRUCTURE.                         S01136
     I            DS                                                      S01136
     I                                        1   80@ODAT                 S01136
     I                                        1   40FHDOEY                S01136
     I                                        5   60FHDOEM                S01136
     I                                        7   80FHDOED                S01136
     I*                                                                   S01136
     I** DRS - DL DONE DATE DATA STRUCTURE.                               S01136
     I            DS                                                      S01136
     I                                        1   80@DDAT                 S01136
     I                                        1   40FHDDYY                S01136
     I                                        1   40HKDDYY                S01136
     I                                        1   40HLDDYY                S01136
     I                                        1   40HMDDYY                S01136
     I                                        5   60FHDDMM                S01136
     I                                        5   60HKDDMM                S01136
     I                                        5   60HLDDMM                S01136
     I                                        5   60HMDDMM                S01136
     I                                        7   80FHDDDD                S01136
     I                                        7   80HKDDDD                S01136
     I                                        7   80HLDDDD                S01136
     I                                        7   80HMDDDD                S01136
     I** DRS - DL MATURITY  DATE STRUCTURE.                               S01136
     I            DS                                                      S01136
     I                                        1   80@MDAT                 S01136
     I                                        1   40HKMDYY                S01136
     I                                        1   40HLMDYY                S01136
     I                                        1   40HMMDYY                S01136
     I                                        5   60HKMDMM                S01136
     I                                        5   60HLMDMM                S01136
     I                                        5   60HMMDMM                S01136
     I                                        7   80HKMDDD                S01136
     I                                        7   80HLMDDD                S01136
     I                                        7   80HMMDDD                S01136
     I*                                                                   S01136
     I* DATSTRUCTURE USED IN SUBROUTINE ZA0750                            S01136
     I* DATASTUCTURE TO CONVERT 7@IAMT DECIMAL FIELD TO ALPHA FIELD       S01136
     I*                                                                   S01136
     I@@AMDS      DS                             15                       S01136
     I                                        1  150@@IAMT                S01136
0383 I**   DATA STRUCTURE FOR RATE AMOUNT
0384 I            DS
     I                                        1  110RAT
     I                                        1  117ZRATE
 544 I*
0543 I** LOCAL DATA AREA TO IDENTIFY DATABASE ERRORS
0545 ILDA        UDS                            256
0279 I********************                  134 138 DBFILE                E14702
0280 I********************                  139 167 DBKEY                 E14702
0281 I********************                  168 175 DBPGM                 E14702
0282 I********************                  176 1770DBASE                 E14702
     I                                      134 141 DBFILE                E14702
     I                                      142 170 DBKEY                 E14702
     I                                      171 180 DBPGM                 E14702
     I                                      181 183 DBASE                 E14702
     ISPOOL       DS                                                      S01117
     I** FILE INFORMATION DATA STRUCTURE                                  S01117
     I                                       83  92 SFILE                 S01117
     I                                    B 123 1240SFNUM                 S01117
     I                                    B 243 2460SWRIT                 S01117
     I*                                                                   S01117
     I@BINRY      DS                                                      S01117
     I** DEFINE A BLANK BINARY FIELD FOR USE WITH SWRIT                   S01117
     I                                    B   1   40@BKBIN                S01117
     I*                                                                   S01194
     I@BANK     E DSSDBANKPD                                              S01194
     I** DUMMY RECORD FORMAT FOR BANK DETAILS                             S01194
     I*                                                                   S01194
     I@CURR     E DSSDCURRPD                                              S01194
     I** DUMMY RECORD FORMAT FOR CURRENCY DETAILS                         S01194
     I*                                                                   S01194
     I@CUST     E DSSDCUSTPD                                              S01194
     I** DUMMY RECORD FORMAT FOR CUSTOMER DETAILS                         S01194
     I*                                                                   S01194
     I@TRAD     E DSSDTRADPD                                              S01194
     I** DUMMY RECORD FORMAT FOR TRADING DATA DETAILS                     S01194
     I*                                                                   S01194
     ISDDEAL    E DSSDDEALPD                                              S01319
     I** EXTERNAL DS FOR DEALING DETAILS                                  S01319
     I              QQACCD                          QQACD1                                    CGL029
      *                                                                   CSD007
     ISCSARD    E DSSCSARDPD                                              CSD007
      ** External Data Structure for Switchable Features                  CSD007
      *                                                                   CSD007
     IDSFDY     E DSDSFDY                                                 S01319
     I*                                                                   S01117
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*                                                                   S01117
     IDSSDY     E DSDSSDY                                                 S01194
     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE                S01194
      *                                                                   CSD007
     IDSLDY     E DSDSLDY                                                 CSD007
      ** Third DS for access programs, very long data structure           CSD007
      *                                                                   CSD007
0113 I/EJECT
0114 C* 1 S T   C Y C L E   P R O C E S S I N G
     C*
     C           *ENTRY    PLIST
     C**********           PARM           TYPE    2                 AUS015048553
     C                     PARM           SEQ     5                       S01117
     C                     PARM           CUSTNO  6
     C                     PARM           LIVOPT  1
     C                     PARM           MATOPT  1
     C                     PARM           TYP1    2                       CDL021
     C                     PARM           TYP2    2                       CDL021
     C                     PARM           TYP3    4                       CDL038
     C*
0115 C   40                GOTO START
0116 C                     SETON                     4044
0117 C*****                EXSR ZSYSTM                                    S01194
0118 C***U7                SETON                     80                   S01194
0119 C*****                SETOF                     U7                   S01194
     C*****                                                               S01194
     C**********                                                    AUS015048553
     C** Initialize indicators for FX/MM 'split' reporting          AUS015048553
     C**********                                                    AUS015048553
     C**********           MOVE '0'       *IN65                     AUS015048553
     C**********           MOVE '0'       *IN67                     AUS015048553
     C*                                                             AUS015048553
     C********** TYPE      IFEQ 'FX'                                AUS015048553
     C**********           MOVE '1'       *IN65                     AUS015048553
     C**********           END                                      AUS015048553
     C********** TYPE      IFEQ 'MM'                                AUS015048553
     C**********           MOVE '1'       *IN67                     AUS015048553
     C**********           END                                      AUS015048553
     C*                                                             AUS015048553
     C** FOR DATABASE ERROR REFERENCE
     C**
     C                     MOVEACPY@      BIS@   80                       S01194
     C                     MOVE *BLANKS   DBPGM                           E20251
     C                     MOVE *BLANKS   DBFILE                          E20251
     C                     MOVE *BLANKS   DBASE                           E20251
     C                     MOVEL'DL2480'  DBPGM                           E20251
     C******************** MOVE 'DL2480  'DBPGM                           E20251
     C                     MOVE ' '       BLANKS 29
     C                     MOVE BLANKS    DBKEY
     C*
     C*****                EXSR ZSYSTM
     C** CALL ACCESS PROGRAM FOR BANK DETAILS                             S01194
     C                     CALL 'AOBANKR0'                                S01194
     C                     PARM '*MSG    '@RTCD   7                       S01194
     C                     PARM '*FIRST  '@OPTN   7                       S01194
     C           @BANK     PARM @BANK     DSFDY                           S01194
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVEL'SDBANKPD'DBFILE            ************* S01194
     C                     MOVEL'04'      DBASE             *DBERROR 004* S01194
     C                     MOVEL@OPTN     DBOPTN  7         ************* S01194
     C                     SETON                     U7U8LR               S01194
     C                     EXSR *PSSR                                     S01194
     C                     GOTO END                                       S01194
     C                     END                                            S01194
0381 C**   CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.                    S01194
0382 C           BJDFIN    COMP 'M'                      98MMDDYY, 98 ON  S01194
0402 C****                                                                S01194
0406 C*****TABCHN*TO*ACCESS*USCY*CURRENCY                                 S01194
     C****       *IN99     IFEQ '0'                                       S01194
0407 C****                 EXSR TABCHN                                    S01194
     C****                 END                                            S01194
     C****                                                                S01194
     C****  99 MEANS DATABASE ERROR....BYPASS PROCESSING                  S01194
     C***99                SETON                     LRU7U8               S01194
     C***99                MOVE '01'      DBASE                           S01194
     C***99                MOVELZTABKY    DBKEY                           S01194
     C***99                MOVE 'TABLE'   DBFILE                          S01194
     C***99                GOTO END                                       S01194
0402 C*****                                                               S01194
0403 C*****SET*UP*KEY*FOR*CURRENCY*TABLE.                                 S01194
0404 C*****                MOVEL'20      'XCY1                            S01194
0405 C*****                MOVE '1'       XCY2                            S01194
     C*                                                                   S01136
     C** INITIAL PROCESSING FOR DRS                                       S01136
     C                     EXSR #A                                        S01136
     C*                                                                   S01136
     C** IF DATABASE ERROR GOTO TO END                                    S01136
     C           *INU7     IFEQ '1'                        B1             S01136
     C                     MOVE '1'       *INLR            *1             S01136
     C                     GOTO END                        *1             S01136
     C                     END                             E1             S01136
     C*
0120 C/SPACE 2
0121 C* M A I N   P R O C E S S I N G
0122 C           START     TAG                             ** START TAG **
     C**
     C**    ACCESS DEALS FOR THE CUSTOMER NUMBER
     C**
     C**********           MOVE CUSTNO    CUSKEY  60                                          CSD027
     C                     MOVE CUSTNO    CUSKEY  6                                           CSD027
     C                     MOVEA'00'      *IN,31
     C**                                                                  S01136
0123 C***********CUSKEY    SETLLCUSDL                    29               S01136
     C*****                                                         S01136BHF486
     C** RESET THE POINTER IN THE DEALS FILE.                       S01136BHF486
     C*****      MODS      IFEQ 'NN'                       B1       S01136BHF486
     C*****      CUSKEY    SETLLCUSDL                    29*1       S01136BHF486
     C*****                END                             E1       S01136BHF486
     C*****                                                         S01136BHF486
     C*****      MODS      IFEQ 'NY'                       B1       S01136BHF486
     C*****      CUSKEY    SETLLMMCUSDLL                 29*1       S01136BHF486
     C*****                END                             E1       S01136BHF486
     C*****                                                         S01136BHF486
     C*****      MODS      IFEQ 'YN'                       B1       S01136BHF486
     C*****      CUSKEY    SETLLFXCUSDLL                 29*1       S01136BHF486
     C*****                END                             E1       S01136BHF486
     C*****                                                         S01136BHF486
     C*****      MODS      IFEQ 'YY'                       B1       S01136BHF486
     C/COPY WNCPYSRC,DLH00238
     C           CUSKEY    SETLLCACUSDLL                 29*1             S01136
     C/COPY WNCPYSRC,DLH00239
     C*****                END                             E1             S01136
     C**
     C**    IF NO RECORD FOUND - ERROR
     C************IN29     IFEQ '0'                                       E26357
     C******               MOVE '02'      DBASE            *************  S01194
     C***********          MOVE '05'      DBASE        *************S01194E26357
     C***********          MOVELCUSTNO    DBKEY            *DBERR 005*    E26357
     C***********          MOVE *BLANKS   DBOPTN       *************S01194E26357
     C*****      MODS      IFEQ 'NN'                       B1       S01136BHF486
     C*****                MOVE 'CUSDL'   DBFILE           *1       S01136BHF486
     C*****                END                             E1       S01136BHF486
     C*****                                                         S01136BHF486
     C*****      MODS      IFEQ 'NY'                       B1       S01136BHF486
     C*****                MOVE 'MMCUSDLL'DBFILE           *1       S01136BHF486
     C*****                END                             E1       S01136BHF486
     C*****                                                         S01136BHF486
     C*****      MODS      IFEQ 'YN'                       B1       S01136BHF486
     C*****                MOVE 'FXCUSDLL'DBFILE           *1       S01136BHF486
     C*****                END                             E1       S01136BHF486
     C*****                                                         S01136BHF486
     C*****      MODS      IFEQ 'YY'                       B1       S01136BHF486
     C***********          MOVE 'CACUSDLL'DBFILE           *1       S01136E26357
     C*****                END                             E1       S01136BHF486
     C***********                                                   S01136E26357
     C*********************MOVE 'CUSDL'   DBFILE                          S01136
     C***********          EXSR *PSSR                               S01194E26357
     C***********          SETON                     LRU7U8               E26357
     C***********          GOTO END                                       E26357
     C***********          END                                            E26357
     C**
     C**    SET INDICATORS FOR THE OPTION PARAMETERS PASSED
     C           LIVOPT    IFEQ 'Y'
     C           MATOPT    ANDEQ'Y'
     C                     GOTO HEADF
     C                     END
     C           LIVOPT    IFEQ 'Y'
     C                     MOVE '1'       *IN31
     C                     ELSE
     C                     MOVE '1'       *IN32
     C                     END
     C*
0122 C           HEADF     TAG                             ** HEADF TAG **
     C**
     C**   CLIENT DETAILS FOR REPORT HEADINGS
0401 C*****                MOVE 'A'       CLKEY   7
     C*****                MOVELCUSTNO    CLKEY
     C*****                EXSR CLCHN
     C*
     C** CALL ACCESS PROGRAM FOR CUSTOMER DETAILS                         S01194
     C***********          CALL 'AOCUSTR0'                         S01194 CSD007
     C                     CALL 'AOCUSTR2'                                CSD007
     C                     PARM '*MSG    '@RTCD                           S01194
     C                     PARM '*KEY    '@OPTN                           S01194
     C                     PARM CUSTNO    @AENB  10                       S01194
     C                     PARM *BLANKS   @KYST   7                       S01194
     C***********@CUST     PARM @CUST     DSSDY                    S01194 CSD007
     C           @CUST     PARM @CUST     DSLDY                           CSD007
     C*                                                                   S01194
      ** If CSD007 is on, allow processing of a closed record (return     CSD007
      ** code '*NRF' and date deleted equal to zero).                     CSD007
      *                                                                   CSD007
     C           CSD007    IFEQ 'Y'                                       CSD007
     C           @RTCD     ANDEQ'*NRF'                                    CSD007
     C           BBDTDL    ANDEQ*ZERO                                     CSD007
      *                                                                   CSD007
     C                     ELSE                                           CSD007
      *                                                                   CSD007
     C           @RTCD     IFNE *BLANK                                    S01194
      *
     C                     MOVEL'SDCUSTPD'DBFILE            ************* S01194
     C                     MOVEL'06'      DBASE             *DBERROR 006* S01194
     C                     MOVEL@OPTN     DBOPTN            ************* S01194
     C                     MOVELCUSTNO    DBKEY                           S01194
     C                     SETON                     U7U8LR               S01194
     C                     EXSR *PSSR                                     S01194
     C                     GOTO END                                       S01194
     C                     END                                            S01194
      *                                                                   CSD007
     C                     ENDIF                                          CSD007
      *                                                                   CSD007
     C           TYP1      IFNE *BLANKS                                   CDL021
     C           TYP1      ANDNE'**'                                      CDL021
     C                     MOVE '1'       *IN88                           CDL021
     C           TYP2      IFNE *BLANKS                                   CDL021
     C           TYP2      ANDNE'**'                                      CDL021
     C                     MOVE '1'       *IN88                           CDL021
     C                     MOVE '1'       *IN89                           CDL021
     C                     ENDIF                                          CDL021
     C                     ENDIF                                          CDL021
     C*
     C**    PRINT HEADINGS
     C*  SETON IN43 TO ENABLE HEADINGS BEING WRITTEN IF DATABASE ERROR
     C                     EXCPTHEAD
     C                     MOVE '1'       *IN43                           S01194
     C*
0122 C           READF     TAG                             ** READF TAG **
     C*
     C                     MOVEA'0000'    *IN,01
     C                     MOVE '0'       *IN42
     C                     MOVEA'0000000' *IN,70                          S01157
     C*                                                                   S01157
     C* RESET TEXT FIELD FOR FRA/IRS DEALS                                S01157
     C*                                                                   S01157
     C                     MOVE *BLANK    @TEXT                           S01157
     C*                                                                   E20251
     C*   Reset fields which are on DL files but not on FX/MM files       E20251
     C*  and on FX/MM files and not DL files otherwise the report         E20251
     C*  will never show correct details.                                 E20251
     C                     MOVE *BLANKS   HLTYPE                          CDL021
     C                     MOVE *BLANKS   HLMTYP                          CDL038
     C                     MOVE *BLANKS   HLSTYP                          CDL021
     C                     MOVE *BLANKS   HLCLAS                          CDL038
     C                     MOVE *BLANKS   HMTYPE                          CDL021
     C                     MOVE *BLANKS   HMMTYP                          CDL038
     C                     MOVE *BLANKS   HMSTYP                          CDL021
     C                     MOVE *BLANKS   HMCLAS                          CDL038
     C                     MOVE *BLANKS   HKTYPE                          CDL021
     C                     MOVE *BLANKS   HKMTYP                          CDL038
     C                     MOVE *BLANKS   HKSTYP                          CDL021
     C                     MOVE *BLANKS   HKCLAS                          CDL038
     C                     MOVE *BLANKS   FHTYPE                          CDL021
     C                     MOVE *BLANKS   FHSTYP                          CDL021
     C                     MOVE *BLANKS   FHCLAS                          CDL038
     C                     MOVE *BLANKS   RECI                            E20251
     C                     MOVE *BLANKS   DLSTS                           E20251
     C                     MOVE *BLANKS   DTYP                            055006
     C                     MOVE *BLANKS   DLST                            CDL038
     C                     MOVE *BLANKS   CLAS                            CDL038
     C***********                                                   AUS015048553
     C** Clear record type before reading                           AUS015048553
     C***********                                                   AUS015048553
     C***********          MOVE *BLANKS   RCDT                      AUS015048553
     C**
     C**    READ A RECORD
     C*                                                                   S01136
     C* ACCESS THE FILE DEPENDING UPON MMOD DATA AREA                     S01136
     C*****                                                         S01136BHF486
     C*****      MODS      IFEQ 'NN'                                S01136BHF486
     C*****      CUSKEY    READECUSDL                    30         S01136BHF486
     C*****                END                                      S01136BHF486
     C*****                                                         S01136BHF486
     C*****                                                         S01136BHF486
     C*****      MODS      IFEQ 'YN'                                S01136BHF486
     C*****      CUSKEY    READEFXCUSDLL                 30         S01136BHF486
     C*****                MOVE RECGMT    @INDS   8                 S01136BHF486
     C*****                END                                      S01136BHF486
     C*****                                                         S01136BHF486
     C*****                                                         S01136BHF486
     C*****      MODS      IFEQ 'NY'                                S01136BHF486
     C*****                                                         S01136BHF486
     C*****      CUSKEY    READEMMCUSDLL                 30         S01136BHF486
     C*****                MOVE RECHMT    @INDS                     S01136BHF486
     C*****                END                                      S01136BHF486
     C*****                                                         S01136BHF486
     C*****                                                         S01136BHF486
     C*****      MODS      IFEQ 'YY'                                S01136BHF486
     C*                                                                   S01136
     C/COPY WNCPYSRC,DLH00240
     C           CUSKEY    READECACUSDLL                 30               S01136
     C**********           MOVE RECIMT    @INDS                     S01136BHF486
     C                     MOVE RECIMT    @INDS   8                       BHF486
     C/COPY WNCPYSRC,DLH00241
     C*****                END                                      S01136BHF486
     C**                                                                  S01136
     C***********CUSKEY    READECUSDL                    30               S01136
     C           *IN30     IFEQ '1'
     C                     MOVE '1'       *INLR
     C                     EXCPT
     C                     GOTO END
     C                     END
     C**
     C******CHECK*OVERFLOW*I.E.*14*RECORDS*PRINTED                          E242
     C***********COUNT*****IFEQ 14                                          E242
     C**    CHECK OVERFLOW I.E. 13 RECORDS PRINTED                          E242
     C           COUNT     IFEQ 13                                          E242
     C                     MOVE '1'       *INOF
     C                     EXCPTHEAD
     C                     Z-ADD0         COUNT
     C                     MOVE '0'       *INOF
     C                     END
     C**
     C           TYP1      IFNE *BLANKS                                   CDL021
     C           TYP1      ANDNE'**'                                      CDL021
     C           TYP2      ANDNE*BLANKS                                   CDL021
     C           TYP2      ANDNE'**'                                      CDL021
     C           DTYP      IFEQ TYP1                                      CDL021
     C           DLST      ANDEQTYP2                                      CDL021
     C           CLAS      ANDEQTYP3                                      CDL038
     C           FHTYPE    OREQ TYP1                                      CDL021
     C           FHSTYP    ANDEQTYP2                                      CDL021
     C           FHCLAS    ANDEQTYP3                                      CDL038
     C***********HKTYPE    OREQ TYP1                               CDL021 CDL038
     C           HKMTYP    OREQ TYP1                                      CDL038
     C           HKSTYP    ANDEQTYP2                                      CDL021
     C           HKCLAS    ANDEQTYP3                                      CDL038
     C***********HLTYPE    OREQ TYP1                               CDL021 CDL038
     C           HLMTYP    OREQ TYP1                                      CDL038
     C           HLSTYP    ANDEQTYP2                                      CDL021
     C           HLCLAS    ANDEQTYP3                                      CDL038
     C***********HMTYPE    OREQ TYP1                               CDL021 CDL038
     C           HMMTYP    OREQ TYP1                                      CDL038
     C           HMSTYP    ANDEQTYP2                                      CDL021
     C           HMCLAS    ANDEQTYP3                                      CDL038
     C                     ELSE                                           CDL021
     C                     GOTO READF                                     CDL021
     C                     END                                            CDL021
     C                     END                                            CDL021
     C*                                                                   CDL021
     C           TYP1      IFNE *BLANKS                                   CDL021
     C           TYP1      ANDNE'**'                                      CDL021
     C           TYP2      ANDEQ'**'                                      CDL021
     C           DTYP      IFEQ TYP1                                      CDL021
     C           FHTYPE    OREQ TYP1                                      CDL021
     C***********HKTYPE    OREQ TYP1                               CDL021 CDL038
     C           HKMTYP    OREQ TYP1                                      CDL038
     C***********HLTYPE    OREQ TYP1                               CDL021 CDL038
     C           HLMTYP    OREQ TYP1                                      CDL038
     C***********HMTYPE    OREQ TYP1                               CDL021 CDL038
     C           HMMTYP    OREQ TYP1                                      CDL038
     C                     ELSE                                           CDL021
     C                     GOTO READF                                     CDL021
     C                     END                                            CDL021
     C                     END                                            CDL021
     C**    MATURED RECORD READ
     C           RECI      IFEQ 'M'
     C           RECI      OREQ 'N'
     C*                                                                   S01136
     C** CHECK FOR DRS DEAL STATUS                                        S01136
     C           DLSTS     OREQ 'M'                                       S01136
     C                     MOVE '1'       *IN42
     C           *IN32     IFEQ '1'
     C                     GOTO VALREC
     C                     END
     C           *IN31     IFEQ '1'
     C                     GOTO READF
     C                     END
     C                     END
     C           *IN32     IFEQ '1'
     C                     GOTO READF
     C                     END
     C*
0122 C           VALREC    TAG                             **VALREC TAG **
     C**********                                                    AUS015048553
     C** If FX deals are requested and record read is not an        AUS015048553
     C** FX deal, read next record                                  AUS015048553
     C**********                                                    AUS015048553
     C********** TYPE      IFEQ 'FX'                                AUS015048553
     C********** RCDT      ANDNE'B'                                 AUS015048553
     C********** @INDS     ANDNE'FXDEALP0'                          AUS015048553
     C**********           GOTO READF                               AUS015048553
     C**********           END                                      AUS015048553
     C**********                                                    AUS015048553
     C** If MM deals are requested and record read is not an        AUS015048553
     C** MM deal, read next record                                  AUS015048553
     C**********                                                    AUS015048553
     C********** TYPE      IFEQ 'MM'                                AUS015048553
     C********** RCDT      IFNE 'C'                                 AUS015048553
     C********** RCDT      ANDNE'D'                                 AUS015048553
     C********** RCDT      ANDNE'E'                                 AUS015048553
     C********** @INDS     ANDNE'MMDELDP0'                          AUS015048553
     C********** @INDS     ANDNE'MMDENBP0'                          AUS015048553
     C********** @INDS     ANDNE'MMDENSP0'                          AUS015048553
     C**********           GOTO READF                               AUS015048553
     C**********           END                                      AUS015048553
     C**********           END                                      AUS015048553
     C**
     C**   FORMAT DETAILS FOR OUTPUT
     C*                                                                   S01157
     C* FRA/IRS DETAILS                                                   S01157
     C*                                                                   S01157
     C           DTYP      IFEQ 'FR'                                      S01157
     C           DTYP      OREQ 'RR'                                      S01157
     C           DTYP      OREQ 'RP'                                      S01157
     C           DTYP      OREQ 'RF'                                      S01157
     C           DTYP      OREQ 'RS'                                      S01157
     C           DTYP      OREQ 'RX'                                      S01157
     C*                                                                   S01157
     C           DTYP      IFEQ 'RS'                                      S01157
     C           DTYP      OREQ 'RX'                                      S01157
     C                     EXSR #IRS                                      S01157
     C                     ELSE                                           S01157
     C                     EXSR #FRA                                      S01157
     C                     END                                            S01157
     C*                                                                   S01157
     C                     ADD  1         COUNT                           S01157
     C*                                                                   S01157
     C                     ELSE                                           S01157
     C*                                                                   S01157
     C                     EXSR LINE01
     C                     EXSR LINE02
     C                     ADD  1         COUNT   20
     C**
     C**   PRINT DETAILS
     C                     MOVE '0'       *IN44
     C                     EXCPTDETAIL
     C                     END                                            S01157
     C*                                                                   S01157
     C                     GOTO READF
0122 C           END       TAG                             ** END   TAG **
     C** TOTAL TIME CALCULATIONS                                          S01117
     C*                                                                   S01117
     C** ENSURE SPOOL FILE RECORDED BY RCF ONCE - ONLY IF P1 IS WRITTEN   S01117
     C** TO. SWRIT IS INCREMENTED FOR EVERY SUCCESSFUL WRITE TO THE       S01117
     C** FILE - IF IT IS BLANK (OR 0) THEN NOTHING HAS BEEN WRITTEN TO    S01117
     C** THE FILE. UNABLE TO COMPARE SWRIT TO *BLANKS SO USE @BKBIN -     S01117
     C** AN UNITIALISED BINARY FIELD.                                     S01117
     CLR         SWRIT     IFNE 0                                         S01117
     CLR         SWRIT     ANDNE@BKBIN                                    S01117
     CLR                   Z-ADDSFNUM     ZSNUM   60                      S01117
     CLR                   CALL 'ZSFILE'                                  S01117
     CLR                   PARM           SEQ     5                       S01117
     CLR                   PARM *BLANK    @PARM   3                       S01117
     CLR                   PARM           SFILE                           S01117
     CLR                   PARM           ZSNUM                           S01117
     CLR                   PARM           ZSERR   1                       S01117
     CLR                   END                                            S01117
     C*                                                                   S01117
     CLR         ZSERR     IFEQ 'Y'                                       S01117
     CLR                   SETON                     U7U8                 S01117
     CLR                   RETRN                                          S01117
     CLR                   END                                            S01117
0179 C/EJECT
     C********************************************************************
     C**
     C**    LINE01 SR TO FORMAT DETAILS OF DEAL FOR LINE 1 OF DETAIL
     C**
     C**    CALLED FROM    MAIN
     C**    CALLS          XCYCHN, ZDATE2
     C**
     C           LINE01    BEGSR                           *** DETAIL ***
     C*                                                                   S01136
     C** INITIALISE ALL REPORT FIELD                                      S01136
     C                     MOVE *BLANKS   DTYPW   5                       S01136
     C                     MOVE *BLANKS   CLASW   4                       CDL038
     C                     MOVE *BLANKS   STWK    3                       S01136
0614 C                     MOVEL*BLANKS   NARR1   8                       S01136
     C******************   MOVE *BLANK    FFIN                      S01136BHF486
     C                     MOVE *BLANK    FFIN    1                       BHF486
0614 C                     MOVEL*BLANKS   RDNO    6                       S01136
     C*                                                                   S01136
     C** FORMAT DRS DEALS ACCORDING TO FORMAT READ                        S01136
     C*                                                                   S01136
     C** CHECK RECORD IDENTIFIER FOR F-X OR MONEY MARKET.                 S01136
     C           @INDS     IFEQ 'FXDEALP0'                 B1             S01136
     C/COPY WNCPYSRC,DLH00242
     C***********@INDS     OREQ 'FXDEALP1'                 X1       S01136BHF486
     C                     EXSR #B                         *1             S01136
     C******************** GOTO ENDDET                     *1       S01136BHF486
     C                     GOTO ENDDET                     *1             E26471
     C                     END                             E1             S01136
     C*                                                                   S01136
     C** FORMAT NON - FX DRS DEALS ************************************   S01136
     C*                                                                   S01136
     C************ DRS DEPOSITS ***************************************   S01136
     C*                                                                   S01136
     C           @INDS     IFEQ 'MMDELDP0'                 B1             S01136
     C/COPY WNCPYSRC,DLH00243
     C***********@INDS     OREQ 'MMDELDP1'                 X1       S01136BHF486
     C*                                                                   S01136
     C** FORMAT FOR LOANS/DEPOSIT/CD ISSUE?                               S01136
     C                     EXSR #C                         *1             S01136
     C**********           GOTO ENDDET                     *1       S01136BHF486
     C                     GOTO ENDDET                     *1             E26471
     C                     END                             E1             S01136
     C*                                                                   S01136
     C************ NEGOTIABLE ASSETS BOUGHT.***************************   S01136
     C*                                                                   S01136
     C           @INDS     IFEQ 'MMDENBP0'                 B1             S01136
     C/COPY WNCPYSRC,DLH00244
     C***********@INDS     OREQ 'MMDENBP1'                 X1       S01136BHF486
     C                     EXSR #D                         *1             S01136
     C**********           GOTO ENDDET                     *1       S01136BHF486
     C                     GOTO ENDDET                     *1             E26471
     C                     END                             E1             S01136
     C*                                                                   S01136
     C************ NEGOTIABLE ASSETS SOLD.*****************************   S01136
     C*                                                                   S01136
     C           @INDS     IFEQ 'MMDENSP0'                 B1             S01136
     C/COPY WNCPYSRC,DLH00245
     C***********@INDS     OREQ 'MMDENSP1'                 X1       S01136BHF486
     C                     EXSR #E                         *1             S01136
     C********             GOTO ENDDET                     *1       S01136BHF486
     C                     GOTO ENDDET                     *1             E26471
     C                     END                             E1             S01136
     C*******                                                             BHF486
0563 C*******                                                             BHF486
     C*******                                                             BHF486
     C*****DEAL TYPE TEXT                                                 BHF486
     C*********************MOVE *BLANKS   DTYPW   5                 S01136BHF486
     C*****                MOVELDTYP      DTYPW                           BHF486
     C*********************MOVE *BLANKS   STWK    3                 S01136BHF486
     C*****                MOVEL'-'       STWK                            BHF486
     C*****                MOVE DLST      STWK                            BHF486
     C*****                MOVE STWK      DTYPW                           BHF486
     C*****                                                         S01157BHF486
     C** DETERMINE WHICH DEALS TO HAVE BUY/SELL INDICATOR DISPLAYED -     S01157
     C** ONLY CAPS, COLLARS, FLOORS AND FRAS                              S01157
     C*****                                                         S01157BHF486
     C*****                MOVE '0'       *IN54                     S01157BHF486
     C*****      DTYP      IFEQ 'RR'                                S01157BHF486
     C*****      DTYP      OREQ 'RP'                                S01157BHF486
     C*****      DTYP      OREQ 'RF'                                S01157BHF486
     C*****      DTYP      OREQ 'FR'                                S01157BHF486
     C*****                MOVE '1'       *IN54                     S01157BHF486
     C*****                END                                      S01157BHF486
     C*****                                                         S01157BHF486
0564 C*****FX - CHECK FOR OPTION.                                         BHF486
0565 C*****      DTYP      COMP 'OP'                     34               BHF486
0564 C*****FX - CHECK FOR NOSTRO TRANSFER                                 BHF486
0565 C*****      DTYP      COMP 'NX'                     35               BHF486
0566 C*****GET DEAL AMOUNT.                                               BHF486
0567 C***01**              Z-ADDPUAM      AMT1   130                      BHF486
0568 C***02**              Z-ADDPCPL      AMT1                            BHF486
0569 C***03**              Z-ADDFVAL      AMT1                            BHF486
0570 C***04**              Z-ADDSAPR      AMT1                            BHF486
0573 C**IS*DEAL FEDERAL FUND                                              BHF486
0574 C*****                SETOF                     5658                 BHF486
0575 C*****                SETON                     5557                 BHF486
0576 C**N01*     CCY       COMP USCY                     56               S01194
0576 C**N01***   CCY       COMP BLCYCD                   56         S01194BHF486
0577 C***01*     PUCY      COMP USCY                     56               S01194
0577 C***01***   PUCY      COMP BLCYCD                   56         S01194BHF486
0578 C***01N56   SLCY      COMP USCY                     58               S01194
0578 C***01N56   SLCY      COMP BLCYCD                   58         S01194BHF486
0579 C***56***             TESTB'2'       DSTI       55                   BHF486
0580 C***58***             TESTB'3'       DSTI       57                   BHF486
0581 C*****FOR C1 DO NOT SHOW YIELD                                       BHF486
0582 C*****      DTYP      COMP 'C1'                     46               BHF486
0583 C***46**              Z-ADD0         YRAT                            BHF486
0584 C*****                                                               BHF486
0585 C*****GET NO. OF DECIMAL PLACES.                                     BHF486
0586 C**N01**              GOTO CCY1                                      BHF486
0587 C*****                MOVE SLCY      XXCCY                           S01194
0588 C*****                EXSR XCYCHN                                    S01194
     C*****                                                               BHF486
     C***CALL*ACCESS PROGRAM                                        S01194BHF486
     C*****                CALL 'AOCURRR0'                          S01194BHF486
     C*****                PARM '*MSG    '@RTCD                     S01194BHF486
     C*****                PARM '*KEY    '@OPTN                     S01194BHF486
     C*****                PARM SLCY      @AJCD   3                 S01194BHF486
     C*****      @CURR     PARM @CURR     DSSDY                     S01194BHF486
     C*****                                                         S01194BHF486
     C*****      @RTCD     IFNE *BLANK                              S01194BHF486
     C*****                MOVEL'SDCURRPD'DBFILE           ******** S01194BHF486
     C*****                MOVEL'07'      DBASE             *DB007* S01194BHF486
     C*****                MOVEL@OPTN     DBOPTN            ******* S01194BHF486
     C*****                MOVELSLCY      DBKEY                     S01194BHF486
     C*****                SETON                     U7U8LR         S01194BHF486
     C*****                EXSR *PSSR                               S01194BHF486
     C*****                GOTO ENDDET                              S01194BHF486
     C*****                ELSE                                     S01194BHF486
0595 C*****                                                         S01194BHF486
     C*****                Z-ADDA6NBDP    XDECP   10                S01194BHF486
     C*****                END                                      S01194BHF486
     C*****                                                               BHF486
     C*****                                                         E14630BHF486
     C*****SAVE SALE CCY DECIMAL PLACES                             E14630BHF486
     C*****                                                         E14630BHF486
     C*****                Z-ADDXDECP     SCCDP   10                E14630BHF486
0596 C*****      CCY1      TAG                             ** CCY1 **     BHF486
0597 C***01                MOVE PUCY      XXCCY                           S01194
0597 C***01**              MOVE PUCY      XXCCY   3                 S01194BHF486
0598 C**N01**              MOVE CCY       XXCCY                           BHF486
0599 C******               EXSR XCYCHN                                    S01194
     C*****                                                               BHF486
     C** CALL ACCESS PROGRAM                                              S01194
     C*****                CALL 'AOCURRR0'                          S01194BHF486
     C*****                PARM '*MSG    '@RTCD                     S01194BHF486
     C*****                PARM '*KEY    '@OPTN                     S01194BHF486
     C*****                PARM XXCCY     @AJCD   3                 S01194BHF486
     C*****      @CURR     PARM @CURR     DSSDY                     S01194BHF486
     C*****                                                         S01194BHF486
     C*****      @RTCD     IFNE *BLANK                              S01194BHF486
     C*****                MOVEL'SDCURRPD'DBFILE           ******** S01194BHF486
     C*****                MOVEL'08'      DBASE            ROR 008* S01194BHF486
     C*****                MOVEL@OPTN     DBOPTN           ******** S01194BHF486
     C*****                MOVELXXCCY     DBKEY                     S01194BHF486
     C*****                SETON                     U7U8LR         S01194BHF486
     C*****                EXSR *PSSR                               S01194BHF486
     C*****                GOTO ENDDET                              S01194BHF486
0595 C*****                                                         S01194BHF486
     C*****                ELSE                                     S01194BHF486
     C*****                Z-ADDA6NBDP    XDECP                     S01194BHF486
     C*****                END                                      S01194BHF486
     C*****                                                               BHF486
0584 C*****                                                               BHF486
0585 C****EDIT AMOUNT                                                     BHF486
0587 C*****                Z-ADDAMT1      ZAMNT                           BHF486
0587 C*****                MOVE 'Y'       ZCOMMA                          BHF486
0587 C*****                MOVE 'N'       ZMINUS                          BHF486
0587 C*****                Z-ADDXDECP     ZCDP                            BHF486
     C*****                EXSR ZEDIT                                     BHF486
     C*****                MOVE ZAMNTA    AMT1W  17                       BHF486
0600 C*****FORMAT DATES.                                                  BHF486
0601 C*****                Z-ADDDDAT      ZDAYNO           DEAL DATE      BHF486
0602 C*****                EXSR ZDATE2                                    BHF486
0603 C*****                MOVE ZADATE    DDATE   7                       BHF486
0604 C*****                                                               BHF486
0605 C*****                Z-ADDVDAT      ZDAYNO           VALUE DATE     BHF486
0606 C*****                EXSR ZDATE2                                    BHF486
0607 C*****                MOVE ZADATE    VDATE   7                       BHF486
0608 C*****                                                               BHF486
0609 C***04**                                                             BHF486
0610 C*R*23**              GOTO NARDET                                    BHF486
0611 C*****                Z-ADDMDAT      ZDAYNO           MATURITY OR    BHF486
0612 C***01**              Z-ADDOTDT      ZDAYNO                          BHF486
0613 C*****                EXSR ZDATE2                     OPTION TO DATE BHF486
0614 C*****                MOVE ZADATE    MDATE   7                       BHF486
     C*****                                                               BHF486
     C*****      NARDET    TAG                             **NARDET TAGSR*BHF486
0615 C*****                                                               BHF486
0615 C****DETERMINE NARR1 FIELD                                           BHF486
0614 C*********************MOVEL*BLANKS   NARR1   8                 S01136BHF486
0614 C***01N35             MOVEL'PURCHASE'NARR1                           BHF486
0610 C***02**    MDAT      IFNE 0                                         BHF486
0614 C*****                MOVELMDATE     NARR1                           BHF486
0610 C*****                ELSE                                           BHF486
0614 C*****                MOVELNOTD      NARR1                           BHF486
0610 C*****                END                                            BHF486
0614 C***03**              MOVELMDATE     NARR1                           BHF486
0615 C*****                                                               BHF486
0615 C****DETERMINE CCY   FIELD                                           BHF486
0614 C***01**              MOVELPUCY      CCY                             BHF486
0615 C*****                                                               BHF486
0615 C****DETERMINE FFIN  FIELD                                           BHF486
     C**N55**              MOVE 'F'       FFIN    1                       BHF486
0615 C*****                                                               BHF486
0615 C****DETERMINE RDNO  FIELD                                           BHF486
0614 C*********************MOVEL*BLANKS   RDNO    6                 S01136BHF486
0610 C***01**    SODN      IFNE 0                                         BHF486
0614 C*****                MOVELSODN      RDNO                            BHF486
0610 C*****                END                                            BHF486
0610 C***02**    RODN      IFNE 0                                         BHF486
0614 C*****                MOVELRODN      RDNO                            BHF486
0610 C*****                END                                            BHF486
0610 C***02**    RBDN      IFNE 0                                         BHF486
0614 C*****                MOVELRBDN      RDNO                            BHF486
0610 C*****                END                                            BHF486
0610 C***03***   ASDN      IFNE 0                                         BHF486
0614 C*****                MOVELASDN      RDNO                            BHF486
0610 C*****                END                                            BHF486
0610 C***04**    RPDN      IFNE 0                                         BHF486
0614 C*****                MOVELRPDN      RDNO                            BHF486
0610 C*****                END                                            BHF486
     C*                                                                   E26471
     C**   DEAL TYPE TEXT                                                 E26471
     C                     MOVELDTYP      DTYPW                           E26471
     C                     MOVEL'-'       STWK                            E26471
     C                     MOVE DLST      STWK                            E26471
     C                     MOVE STWK      DTYPW                           E26471
     C                     MOVE CLAS      CLASW                           CDL038
     C*                                                                   E26471
     C** DETERMINE WHICH DEALS TO HAVE BUY/SELL INDICATOR DISPLAYED -     E26471
     C** ONLY CAPS, COLLARS, FLOORS AND FRAS                              E26471
     C*                                                                   E26471
     C                     MOVE '0'       *IN54                           E26471
     C           DTYP      IFEQ 'RR'                                      E26471
     C           DTYP      OREQ 'RP'                                      E26471
     C           DTYP      OREQ 'RF'                                      E26471
     C           DTYP      OREQ 'FR'                                      E26471
     C                     MOVE '1'       *IN54                           E26471
     C                     END                                            E26471
     C*                                                                   E26471
     C**   FX - CHECK FOR OPTION.                                         E26471
     C*                                                                   E26471
     C           DTYP      COMP 'OP'                     34               E26471
     C*                                                                   E26471
     C**   FX - CHECK FOR NOSTRO TRANSFER                                 E26471
     C*                                                                   E26471
     C           DTYP      COMP 'NX'                     35               E26471
     C*                                                                   E26471
     C**   GET DEAL AMOUNT.                                               E26471
     C*                                                                   E26471
     C   01                Z-ADDPUAM      AMT1   130                      E26471
     C   02                Z-ADDPCPL      AMT1                            E26471
     C   03                Z-ADDFVAL      AMT1                            E26471
     C   04                Z-ADDSAPR      AMT1                            E26471
     C*                                                                   E26471
     C** IS DEAL FEDERAL FUND                                             E26471
     C*                                                                   E26471
     C                     SETOF                     5658                 E26471
     C                     SETON                     5557                 E26471
     C  N01      CCY       COMP BLCYCD                   56               E26471
     C   01      PUCY      COMP BLCYCD                   56               E26471
     C   01N56   SLCY      COMP BLCYCD                   58               E26471
     C   56                TESTB'2'       DSTI       55                   E26471
     C   58                TESTB'3'       DSTI       57                   E26471
     C*                                                                   E26471
     C**   FOR C1 DO NOT SHOW YIELD                                       E26471
     C*                                                                   E26471
     C           DTYP      COMP 'C1'                     46               E26471
     C   46                Z-ADD0         YRAT                            E26471
     C*                                                                   E26471
     C**   GET NO. OF DECIMAL PLACES.                                     E26471
     C*                                                                   E26471
     C  N01                GOTO CCY1                                      E26471
     C                     MOVE SLCY      XXCCY                           E26471
     C*                                                                   E26471
     C** CALL ACCESS PROGRAM                                              E26471
     C*                                                                   E26471
     C                     CALL 'AOCURRR0'                                E26471
     C                     PARM '*MSG   ' @RTCD                           E26471
     C                     PARM '*KEY   ' @OPTN                           E26471
     C                     PARM SLCY      @AJCD   3                       E26471
     C           @CURR     PARM @CURR     DSSDY                           E26471
     C*                                                                   E26471
     C           @RTCD     IFNE *BLANK                                    E26471
     C                     MOVEL'SDCURRPD'DBFILE           ********       E26471
     C                     MOVEL'07'      DBASE             *DB007*       E26471
     C                     MOVELSLCY      DBKEY                           E26471
     C                     SETON                     U7U8LR               E26471
     C                     EXSR *PSSR                                     E26471
     C                     GOTO ENDDET                                    E26471
     C                     ELSE                                           E26471
     C*                                                                   E26471
     C                     Z-ADDA6NBDP    XDECP   10                      E26471
     C                     END                                            E26471
     C*                                                                   E26471
     C**   SAVE SALE CCY DECIMAL PLACES                                   E26471
     C*                                                                   E26471
     C                     Z-ADDXDECP     SCCDP   10                      E26471
     C           CCY1      TAG                             ** CCY1 **     E26471
     C   01                MOVE PUCY      XXCCY   3                       E26471
     C  N01                MOVE CCY       XXCCY                           E26471
     C*                                                                   E26471
     C** CALL ACCESS PROGRAM                                              E26471
     C*                                                                   E26471
     C                     CALL 'AOCURRR0'                                E26471
     C                     PARM '*MSG   ' @RTCD                           E26471
     C                     PARM '*KEY   ' @OPTN                           E26471
     C                     PARM XXCCY     @AJCD   3                       E26471
     C           @CURR     PARM @CURR     DSSDY                           E26471
     C*                                                                   E26471
     C           @RTCD     IFNE *BLANK                                    E26471
     C                     MOVEL'SDCURRPD'DBFILE           ********       E26471
     C                     MOVEL'08'      DBASE            ROR 008*       E26471
     C                     MOVELXXCCY     DBKEY                           E26471
     C                     SETON                     U7U8LR               E26471
     C                     EXSR *PSSR                                     E26471
     C                     GOTO ENDDET                                    E26471
     C*                                                                   E26471
     C                     ELSE                                           E26471
     C                     Z-ADDA6NBDP    XDECP                           E26471
     C                     END                                            E26471
     C*                                                                   E26471
     C**  EDIT AMOUNT                                                     E26471
     C*                                                                   E26471
     C                     Z-ADDAMT1      ZAMNT                           E26471
     C                     MOVE 'Y'       ZCOMMA                          E26471
     C                     MOVE 'N'       ZMINUS                          E26471
     C                     Z-ADDXDECP     ZCDP                            E26471
     C                     EXSR ZEDIT                                     E26471
     C                     MOVE ZAMNTA    AMT1W  17                       E26471
     C*                                                                   E26471
     C**   FORMAT DATES.                                                  E26471
     C*                                                                   E26471
     C                     Z-ADDDDAT      ZDAYNO           DEAL DATE      E26471
     C                     EXSR ZDATE2                                    E26471
     C                     MOVE ZADATE    DDATE   7                       E26471
     C*                                                                   E26471
     C                     Z-ADDVDAT      ZDAYNO           VALUE DATE     E26471
     C                     EXSR ZDATE2                                    E26471
     C                     MOVE ZADATE    VDATE   7                       E26471
     C*                                                                   E26471
     C   04                                                               E26471
     COR 23                GOTO NARDET                                    E26471
     C                     Z-ADDMDAT      ZDAYNO           MATURITY OR    E26471
     C   01                Z-ADDOTDT      ZDAYNO                          E26471
     C                     EXSR ZDATE2                     OPTION TO DATE E26471
     C                     MOVE ZADATE    MDATE   7                       E26471
     C*                                                                   E26471
     C           NARDET    TAG                             **NARDET TAGSR*E26471
     C*                                                                   E26471
     C**  DETERMINE NARR1 FIELD                                           E26471
     C*                                                                   E26471
     C   01N35             MOVEL'PURCHASE'NARR1                           E26471
     C   02      MDAT      IFNE 0                                         E26471
     C                     MOVELMDATE     NARR1                           E26471
     C                     ELSE                                           E26471
     C                     MOVELNOTD      NARR1                           E26471
     C                     END                                            E26471
     C   03                MOVELMDATE     NARR1                           E26471
     C*                                                                   E26471
     C**  DETERMINE CCY   FIELD                                           E26471
     C*                                                                   E26471
     C   01                MOVELPUCY      CCY                             E26471
     C*                                                                   E26471
     C**  DETERMINE FFIN  FIELD                                           E26471
     C*                                                                   E26471
     C  N55                MOVE 'F'       FFIN    1                       E26471
     C*                                                                   E26471
     C**  DETERMINE RDNO  FIELD                                           E26471
     C*                                                                   E26471
     C   01      SODN      IFNE 0                                         E26471
     C                     MOVELSODN      RDNO                            E26471
     C                     END                                            E26471
     C   02      RODN      IFNE 0                                         E26471
     C                     MOVELRODN      RDNO                            E26471
     C                     END                                            E26471
     C   02      RBDN      IFNE 0                                         E26471
     C                     MOVELRBDN      RDNO                            E26471
     C                     END                                            E26471
     C   03      ASDN      IFNE 0                                         E26471
     C                     MOVELASDN      RDNO                            E26471
     C                     END                                            E26471
     C   04      RPDN      IFNE 0                                         E26471
     C                     MOVELRPDN      RDNO                            E26471
     C                     END                                            E26471
     C*
     C           ENDDET    ENDSR                           **ENDDET ENDSR*
     C**
     C**
0721 C********************************************************************
0120 C/SPACE 2
0721 C********************************************************************
     C**
     C**
0722 C*    LINE02 SR TO FORMAT DEAL DETAILS FOR LINE 2 OF DETAIL
     C**   CALLED FROM   MAIN
     C**   CALLS SR  ZEDIT RTEDIT
0723 C           LINE02    BEGSR                           ** LIN2SR  ***
0725 C**********           MOVE *BLANKS   LINE2 100                       S01378
     C                     MOVE *BLANKS   LINE2 111                       S01378
0725 C                     MOVEA*BLANKS   LIN
     C******************   MOVE *BLANKS   TEXT                            BHF486
     C                     MOVE *BLANKS   TEXT    8                       BHF486
     C*                                                                   S01136
     C** FORMAT DRS DEALS FOR LINE02 ACCORDING TO FORMAT READ             S01136
     C*                                                                   S01136
     C** CHECK RECORD IDENTIFIER FOR F-X OR MONEY MARKET.                 S01136
     C           @INDS     IFEQ 'FXDEALP0'                 B1             S01136
     C/COPY WNCPYSRC,DLH00246
     C***********@INDS     OREQ 'FXDEALP1'                 X1       S01136BHF486
     C                     EXSR #F                         *1             S01136
     C                     GOTO ENDDT2                     *1             S01136
     C                     END                             E1             S01136
     C*                                                                   S01136
     C** FORMAT NON - FX DRS DEALS ************************************   S01136
     C*                                                                   S01136
     C************ DRS DEPOSITS ***************************************   S01136
     C*                                                                   S01136
     C           @INDS     IFEQ 'MMDELDP0'                 B1             S01136
     C/COPY WNCPYSRC,DLH00247
     C********** @INDS     OREQ 'MMDELDP1'                 X1       S01136BHF486
     C*                                                                   S01136
     C** FORMAT FOR LOANS/DEPOSIT/CD ISSUE?                               S01136
     C                     EXSR #G                         *1             S01136
     C                     GOTO ENDDT2                     *1             S01136
     C                     END                             E1             S01136
     C*                                                                   S01136
     C************ NEGOTIABLE ASSETS BOUGHT.***************************   S01136
     C*                                                                   S01136
     C           @INDS     IFEQ 'MMDENBP0'                 B1             S01136
     C/COPY WNCPYSRC,DLH00248
     C********** @INDS     OREQ 'MMDENBP1'                 X1       S01136BHF486
     C                     EXSR #H                         *1             S01136
     C                     GOTO ENDDT2                     *1             S01136
     C                     END                             E1             S01136
     C*                                                                   S01136
     C************ NEGOTIABLE ASSETS SOLD.*****************************   S01136
     C*                                                                   S01136
     C           @INDS     IFEQ 'MMDENSP0'                 B1             S01136
     C/COPY WNCPYSRC,DLH00249
     C********** @INDS     OREQ 'MMDENSP1'                 X1       S01136BHF486
     C                     EXSR #I                         *1             S01136
     C                     GOTO ENDDT2                     *1             S01136
     C                     END                             E1             S01136
0571 C*****IS DEAL REVERSED                                               BHF486
0572 C******     RECI      IFEQ 'R'                                       BHF486
     C******               MOVE 'REVERSED'TEXT                            BHF486
     C******               END                                            BHF486
     C*****OR MATURED                                                     BHF486
     C******     *IN42     IFEQ '1'                                       BHF486
     C******               MOVEL'MATURED' TEXT    8                       BHF486
     C******               END                                            BHF486
0726 C******     *IN01     IFEQ '1'                                       BHF486
0725 C******               MOVEATEXT      LIN,15                          BHF486
0584 C******                                                              BHF486
0585 C****EDIT AMOUNT                                                     BHF486
0587 C******               Z-ADDSLAM      ZAMNT                           BHF486
0587 C******               MOVE 'Y'       ZCOMMA                          BHF486
0587 C******               MOVE 'N'       ZMINUS                          BHF486
0587 C*********************Z-ADDXDECP     ZCDP                            E14630
0587 C******               Z-ADDSCCDP     ZCDP                      E14630BHF486
0602 C******               EXSR ZEDIT                                     BHF486
0603 C******               MOVE ZAMNTA    SLAMWF 17                       BHF486
0725 C***34******          MOVEATXT,1     LIN,27                          BHF486
0725 C**N35******          MOVEATXT,2     LIN,54                          BHF486
0725 C***34******          MOVEAMDATE     LIN,38                          BHF486
0725 C**N35******          MOVEASLCY      LIN,63                          BHF486
     C**N57***             MOVEA'F'       LIN,72                          BHF486
0725 C**N35******          MOVEASLAMWF    LIN,82                          BHF486
0728 C******               ELSE                                           BHF486
0726 C******     *IN02     IFEQ '1'                                       BHF486
0725 C******               MOVEATEXT      LIN,15                    E12036BHF486
     C******               Z-ADDRTSP      ZRATE                           BHF486
     C******               EXSR RTEDIT                                    BHF486
     C******               MOVE ZRATEA    RTSPXX                          BHF486
0725 C******               MOVEATXT,3     LIN,27                          BHF486
0725 C******               MOVEATXT,4     LIN,52                          BHF486
     C******               MOVE BRTT      BRTTWF  2                       BHF486
0725 C******               MOVEABRTTWF    LIN,39                          BHF486
0725 C******               MOVEARTSPXX    LIN,87                          BHF486
0728 C******               ELSE                                           BHF486
0726 C******     *IN03     IFEQ '1'                                       BHF486
0725 C******               MOVEATEXT      LIN,15                    E12036BHF486
     C******               Z-ADDRTSP      ZRATE                           BHF486
     C******               EXSR RTEDIT                                    BHF486
     C******               MOVE ZRATEA    RTSPXX 12                       BHF486
     C******               Z-ADDYRAT      ZRATE                           BHF486
     C******               EXSR RTEDIT                                    BHF486
     C******               MOVE ZRATEA    YRATXX 12                       BHF486
0725 C******               MOVEATXT,5     LIN,27                          BHF486
0725 C******               MOVEATXT,4     LIN,52                          BHF486
0725 C******               MOVEAYRATXX    LIN,33                          BHF486
0725 C******               MOVEARTSPXX    LIN,87                          BHF486
0728 C******               ELSE                                           BHF486
0726 C******     *IN04     IFEQ '1'                                       BHF486
0725 C******               MOVEATEXT      LIN,15                    E12036BHF486
     C******               Z-ADDYRAT      ZRATE                           BHF486
     C******               EXSR RTEDIT                                    BHF486
     C******               MOVE ZRATEA    YRATXX 12                       BHF486
0725 C******               MOVEATXT,5     LIN,27                          BHF486
0725 C******               MOVEAYRATXX    LIN,33                          BHF486
0728 C******               END                                            BHF486
0728 C******               END                                            BHF486
0728 C******               END                                            BHF486
0728 C******               END                                            BHF486
0727 C******                                                        S01136BHF486
     C**   IS DEAL REVERSED                                               E26471
     C           RECI      IFEQ 'R'                                       E26471
     C                     MOVE 'REVERSED'TEXT                            E26471
     C                     END                                            E26471
     C**   OR MATURED                                                     E26471
     C           *IN42     IFEQ '1'                                       E26471
     C                     MOVEL'MATURED' TEXT    8                       E26471
     C                     END                                            E26471
     C           *IN01     IFEQ '1'                                       E26471
      *  Foreign exchange trades (*IN01)                                  S01378
     C                     MOVEATEXT      LIN,15                          E26471
     C*                                                                   E26471
     C**  EDIT AMOUNT                                                     E26471
     C                     Z-ADDSLAM      ZAMNT                           E26471
     C                     MOVE 'Y'       ZCOMMA                          E26471
     C                     MOVE 'N'       ZMINUS                          E26471
     C                     Z-ADDSCCDP     ZCDP                            E26471
     C                     EXSR ZEDIT                                     E26471
     C                     MOVE ZAMNTA    SLAMWF 17                       E26471
     C   34                MOVEATXT,1     LIN,27                          E26471
     C  N35                MOVEATXT,2     LIN,54                          E26471
     C   34                MOVEAMDATE     LIN,38                          E26471
     C  N35                MOVEASLCY      LIN,63                          E26471
     C  N57                MOVEA'F'       LIN,72                          E26471
     C  N35                MOVEASLAMWF    LIN,82                          E26471
     C                     ELSE                                           E26471
      * loans/deposits (*IN02)                                            S01378
     C           *IN02     IFEQ '1'                                       E26471
     C                     MOVEATEXT      LIN,15                          E26471
     C                     Z-ADDRTSP      ZRATE                           E26471
     C                     EXSR RTEDIT                                    E26471
     C                     MOVE ZRATEA    RTSPXX                          E26471
     C                     MOVEATXT,3     LIN,27                          E26471
     C                     MOVEATXT,4     LIN,52                          E26471
     C                     MOVE BRTT      BRTTWF  2                       E26471
     C                     MOVEABRTTWF    LIN,39                          E26471
     C                     MOVEARTSPXX    LIN,87                          E26471
     C                     ELSE                                           E26471
      * NA's purchased (*IN03)                                            S01378
     C           *IN03     IFEQ '1'                                       E26471
     C                     MOVEATEXT      LIN,15                          E26471
     C                     Z-ADDRTSP      ZRATE                           E26471
     C                     EXSR RTEDIT                                    E26471
     C                     MOVE ZRATEA    RTSPXX 12                       E26471
     C                     Z-ADDYRAT      ZRATE                           E26471
     C                     EXSR RTEDIT                                    E26471
     C                     MOVE ZRATEA    YRATXX 12                       E26471
     C                     MOVEATXT,5     LIN,27                          E26471
     C                     MOVEATXT,4     LIN,52                          E26471
     C                     MOVEAYRATXX    LIN,33                          E26471
     C                     MOVEARTSPXX    LIN,87                          E26471
     C*                                                                   S01378
     C** If parcelled NA set up parcel details (remove leading 0's)       S01378
     C           PCLI      IFEQ 'P'                                       S01378
     C                     Z-ADD102       I                               S01378
     C                     MOVEATXT,6     LIN,I                           S01378
     C                     Z-ADDPSZE      @INNUM                          S01378
     C                     EXSR PFMT                                      S01378
     C                     Z-ADD107       I                               S01378
     C                     MOVEA@OUTCR    LIN,I                           S01378
     C*                                                                   S01378
     C** If not parcelled must blank out parcelling bit of LIN            S01378
     C                     ELSE                                           S01378
     C                     Z-ADD108       I                               S01378
     C                     MOVEA*BLANKS   LIN,I                           S01378
     C                     END                                            S01378
     C                     ELSE                                           E26471
      * NA's sold (*IN04)                                                 S01378
     C           *IN04     IFEQ '1'                                       E26471
     C                     MOVEATEXT      LIN,15                          E26471
     C                     Z-ADDYRAT      ZRATE                           E26471
     C                     EXSR RTEDIT                                    E26471
     C                     MOVE ZRATEA    YRATXX 12                       E26471
     C                     MOVEATXT,5     LIN,27                          E26471
     C                     MOVEAYRATXX    LIN,33                          E26471
     C*                                                                   S01378
     C** If parcelled NA set up parcel details                            S01378
     C           PCLI      IFEQ 'P'                                       S01378
     C                     Z-ADD102       I       30                      S01378
     C                     MOVEATXT,6     LIN,I                           S01378
     C                     Z-ADDPSZE      @INNUM                          S01378
     C                     EXSR PFMT                                      S01378
     C                     Z-ADD107       I                               S01378
     C                     MOVEA@OUTCR    LIN,I                           S01378
     C*                                                                   S01378
     C** If not parcelled must blank out parcelling bit of LIN            S01378
     C                     ELSE                                           S01378
     C                     Z-ADD108       I                               S01378
     C                     MOVEA*BLANKS   LIN,I                           S01378
     C                     END                                            S01378
     C*                                                                   S01378
     C                     END                                            E26471
     C                     END                                            E26471
     C                     END                                            E26471
     C                     END                                            E26471
     C*                                                                   E26471
     C           ENDDT2    TAG                             **ENDDT2       E26471
0727 C*                                                                   S01136
0725 C                     MOVEALIN       LINE2
0727 C*
0728 C                     ENDSR
     C**
0721 C********************************************************************
0120 C/SPACE 2
0730 C********************************************************************
0731 C****                                                                S01194
0731 C****SR. TO CHAIN TO CURRENCY TABLE.                                 S01194
0732 C****       XCYCHN    BEGSR                           *** XCYCHN *** S01194
0733 C****       XCYKEY    CHAINTABLE                99                   S01194
     C****                                                                S01194
0737 C****                 ENDSR                                          S01194
0721 C********************************************************************S01194
0120 C/SPACE 2                                                            S01194
0956 C********************************************************************
0957 C*****                                                               S01194
0958 C*****TABCHN SR. TO CHAIN TO INSTALLATION CONTROL DATA RECORD 5      S01194
0959 C*****                                                               S01194
0960 C*****      TABCHN    BEGSR                           *** TABCHN *** S01194
0961 C*****                                                               S01194
0962 C*****SET UP KEY FOR INSTALLATION CONTROL RECORD.                    S01194
0963 C*****                MOVEL'01      'ZTABKY 12                       S01194
0964 C*****                MOVE '  40'    ZTABKY                          S01194
0965 C*****                                                               S01194
0966 C*****      ZTABKY    CHAINTABLE                99    ON NOT THERE   S01194
0967 C**N99      RECI      COMP 'D'                  9999  ON, IS DELETED S01194
0968 C*****                                                               S01194
0969 C*****                ENDSR                                          S01194
0721 C********************************************************************
0120 C/SPACE 2
0721 C********************************************************************
     C*****                                                               S01194
0722 C*****SR. TO CHAIN TO CLIENT FILE.                                   S01194
0723 C*****      CLCHN     BEGSR                           *** CLCHN  *** S01194
0724 C*****                                                               S01194
0725 C*****                SETOF                     05                   S01194
0726 C*****      CLKEY     CHAINCLINT                40                   S01194
0727 C*****                                                               S01194
0728 C*****                ENDSR                                          S01194
0729 C*****                                                               S01194
0721 C********************************************************************
0120 C/SPACE 2
0746 C********************************************************************
0846 C**
0846 C**
     C*  RTEDIT SR SUBROUTINE TO EDIT A RATE FIELD FOR OUTPUT
     C*
     C*  CALLED BY: LINE02
     C*
     C*  THIS SUBROUTINE CONTERTS AN 11,7 RATE FIELD INTO A 12 ALPHAMERIC
     C*  FIELD WITH LEADING AND TRAILING ZEROS DELETED. IF THE RATE IS
     C*  LESS THAN 1 THEN A ZERO IS PLACED BEFORE THE DECIMAL POINT.
     C*
     C*
     C*  INPUT FIELDS:
     C*                    ZRATE  11 7    AMOUNT FIELD TO BE EDITED
     C*
     C*  OUTPUT FIELDS:
     C*                    ZRATEA 12 A    EDITED AMOUNT FIELD
     C*
     C*  INDICATOR USED:
     C*                    *IN94          SETON IF NON-ZERO CHARACTER
     C*                                   FOUND IN THE AMOUNT
     C*
     C           RTEDIT    BEGSR                           ***  RTEDIT ***
     C*
     C                     Z-ADDZRATE     ZRATE  117       I/P FIELD
     C                     MOVE *BLANK    ZRATEA 12        O/P FIELD
     C                     MOVE '0'       *IN94
     C*
     C                     MOVEA*BLANKS   OUT
     C                     Z-ADD1         J       20
     C*
     C*  CLEAR LEADING ZEROS
     C           J         DOWLE4
     C           *IN94     IFEQ '0'
     C           RAT,J     IFEQ 0
     C                     MOVE ' '       OUT,J
     C                     ELSE
     C                     MOVE RAT,J     OUT,J
     C                     SETON                     94
     C                     END
     C                     ELSE
     C                     MOVE RAT,J     OUT,J
     C                     END
     C                     ADD  1         J
     C                     END
     C*
     C*  MOVE IN DECIMAL POINT
     C           J         IFEQ 5
     C           *IN94     IFEQ '0'
     C                     MOVE '0'       OUT,4
     C                     END
     C                     MOVE '.'       OUT,J
     C                     END
     C*
     C*  POSITION DECIMALS,ADD TRAILING ZEROS
     C                     MOVE '0'       *IN94
     C                     Z-ADD11        J
     C                     Z-ADD12        K       20
     C           J         DOWGE5
     C           *IN94     IFEQ '0'
     C           RAT,J     IFEQ 0
     C                     MOVE '0'       OUT,K
     C                     ELSE
     C                     MOVE RAT,J     OUT,K
     C                     SETON                     94
     C                     END
     C                     ELSE
     C                     MOVE RAT,J     OUT,K
     C                     END
     C                     SUB  1         J
     C                     SUB  1         K
     C                     END
     C*
     C*  FINALLY MOVE  EDITED FIELD INTO O/P FIELD
     C                     MOVEAOUT       ZRATEA
     C*
     C****
     C                     ENDSR
0846 C**
0846 C**
0721 C********************************************************************
0120 C/SPACE 2
0746 C********************************************************************S01157
     C*                                                                   S01157
     C*    #FRA - DEAL TYPES FR;RR;RP;RF                                  S01157
     C*                                                                   S01157
     C*****************************************************************   S01157
     C*                                                                   S01157
     C           #FRA      BEGSR                                          S01157
     C*                                                                   S01157
     C* FORMAT DEAL DATE , VALUE DATE , MATURITY DATE                     S01157
     C*                                                                   S01157
     C                     Z-ADDDDAT      ZDAYNO                          S01157
     C                     EXSR ZDATE2                                    S01157
     C                     MOVE ZADATE    @DLDAT  8                       S01157
     C*                                                                   S01157
     C                     Z-ADDVDAT      ZDAYNO                          S01157
     C                     EXSR ZDATE2                                    S01157
     C                     MOVE ZADATE    @VLDAT  8                       S01157
     C*                                                                   S01157
     C                     Z-ADDMDAT      ZDAYNO                          S01157
     C                     EXSR ZDATE2                                    S01157
     C                     MOVE ZADATE    @MTDAT  8                       S01157
     C*                                                                   S01157
     C* FORMAT REL DEAL NO.                                               S01157
     C*                                                                   S01157
     C           LNKDN     IFEQ 0                                         S01157
     C                     MOVE *BLANK    @LNKDN  6                       S01157
     C                     ELSE                                           S01157
     C                     MOVE LNKDN     @LNKDN                          S01157
     C                     END                                            S01157
     C*                                                                   S01157
     C* SET CONDITIONING INDICATOR FOR BUY/SELL FIELD                     S01157
     C*                                                                   S01157
     C                     MOVE '1'       *IN70                           S01157
     C*                                                                   S01157
     C* SET FED FUNDS INDICATOR                                           S01157
     C*                                                                   S01157
     C           UCUCY     IFEQ 'USD'                                     S01157
     C                     MOVE '1'       *IN74                           S01157
     C*                                                                   S01157
     C                     TESTB'2'       UDSTI          76               S01157
     C           *IN76     IFEQ '1'                                       S01157
     C                     MOVE 'Y'       @FEDF   1                       S01157
     C                     ELSE                                           S01157
     C                     MOVE *BLANK    @FEDF                           S01157
     C                     END                                            S01157
     C*                                                                   S01157
     C                     END                                            S01157
     C*                                                                   S01157
     C* RETRIEVE  NO. DEC PLACES                                          S01157
     C*                                                                   S01157
     C****************     MOVE UCUCY     XXCCY                     S01157BHF486
     C                     MOVE UCUCY     XXCCY   3                       BHF486
     C******               EXSR XCYCHN                             S01157 S01194
     C*
     C** CALL ACCESS PROGRAM                                              S01194
     C                     CALL 'AOCURRR0'                                S01194
     C                     PARM '*MSG    '@RTCD                           S01194
     C                     PARM '*KEY    '@OPTN                           S01194
     C                     PARM XXCCY     @AJCD   3                       S01194
     C           @CURR     PARM @CURR     DSSDY                           S01194
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVEL'SDCURRPD'DBFILE            ************* S01194
     C                     MOVEL'09'      DBASE             *DBERROR 009* S01194
     C                     MOVEL@OPTN     DBOPTN            ************* S01194
     C                     MOVELXXCCY     DBKEY                           S01194
     C                     SETON                     U7U8LR               S01194
     C                     EXSR *PSSR                                     S01194
     C                     GOTO #FRA9                                     S01194
0595 C*                                                                   S01194
     C                     ELSE                                           S01194
     C*****************    Z-ADDA6NBDP    XDECP                     S01194BHF486
     C                     Z-ADDA6NBDP    XDECP   10                      BHF486
     C                     END                                            S01194
     C*
     C*                                                                   S01157
     C* FORMAT DEAL AMOUNT                                                S01157
     C*                                                                   S01157
     C                     Z-ADDUPAMT     ZAMNT                           S01157
     C                     Z-ADDXDECP     ZCDP                            S01157
     C                     MOVE 'Y'       ZCOMMA                          S01157
     C                     MOVE 'N'       ZMINUS                          S01157
     C                     EXSR ZEDIT                                     S01157
     C                     MOVE ZAMNTA    @DLAMT 17                       S01157
     C*                                                                   S01157
     C* IF DEAL REVERSED                                                  S01157
     C*                                                                   S01157
     C           RECI      IFEQ 'R'                                       S01157
     C                     MOVE 'REVERSED'@TEXT   8                       S01157
     C                     END                                            S01157
     C*                                                                   S01157
     C* MATURED                                                           S01157
     C*                                                                   S01157
     C           *IN42     IFEQ '1'                                       S01157
     C                     MOVEL'MATURED' @TEXT                           S01157
     C                     END                                            S01157
     C*                                                                   S01157
     C* DEAL TYPE RF/RR FORMAT FLOOR RATE                                 S01157
     C*                                                                   S01157
     C           DTYP      IFEQ 'RF'                                      S01157
     C           DTYP      OREQ 'RR'                                      S01157
     C*                                                                   S01157
     C                     Z-ADDFLRAT     ZRATE                           S01157
     C                     EXSR RTEDIT                                    S01157
     C                     MOVE ZRATEA    @CLRAT 12                       S01157
     C                     MOVE ZRATEA    @FLRAT 12                       S01157
     C                     END                                            S01157
     C*                                                                   S01157
     C* DEAL TYPE RP/RR FORMAT CEILING RATE                               S01157
     C*                                                                   S01157
     C           DTYP      IFEQ 'RP'                                      S01157
     C           DTYP      OREQ 'RR'                                      S01157
     C*                                                                   S01157
     C                     Z-ADDCLRAT     ZRATE                           S01157
     C                     EXSR RTEDIT                                    S01157
     C                     MOVE ZRATEA    @CLRAT                          S01157
     C                     MOVE '1'       *IN71                           S01157
     C                     END                                            S01157
     C*                                                                   S01157
     C* SET FLOOR RATE TEXT FOR RR DEALS                                  S01157
     C*                                                                   S01157
     C           DTYP      IFEQ 'RR'                                      S01157
     C                     MOVE '1'       *IN72                           S01157
     C                     END                                            S01157
     C*                                                                   S01157
     C* SETUP BASE RATE & INTEREST/SPREAD RATE , SPREAD IND               S01157
     C*  1. FOR RR RP RF - IE NOT FR                                      S01157
     C*                                                                   S01157
     C           DTYP      IFNE 'FR'                                      S01157
     C*                                                                   S01157
     C           DTYP      IFEQ 'RP'                                      S01157
     C           BYSL      ANDEQ'B'                                       S01157
     C           DTYP      OREQ 'RR'                                      S01157
     C           BYSL      ANDEQ'B'                                       S01157
     C           DTYP      OREQ 'RF'                                      S01157
     C           BYSL      ANDEQ'S'                                       S01157
     C*                                                                   S01157
     C                     MOVE TSPIN     @SPIN   2                       S01157
     C                     MOVE TBRTT     @BTYP   2                       S01157
     C                     Z-ADDTRTSP     ZRATE                           S01157
     C*                                                                   S01157
     C                     ELSE                                           S01157
     C*                                                                   S01157
     C                     MOVE USPIN     @SPIN                           S01157
     C                     MOVE UBRTT     @BTYP                           S01157
     C                     Z-ADDURTSP     ZRATE                           S01157
     C*                                                                   S01157
     C                     END                                            S01157
     C*                                                                   S01157
     C* ELSE -  2. DTYP IS FR                                             S01157
     C*                                                                   S01157
     C                     ELSE                                           S01157
     C*                                                                   S01157
     C           BYSL      IFEQ 'B'                                       S01157
     C*                                                                   S01157
     C                     MOVE TBRTT     @BTYP                           S01157
     C                     Z-ADDURTSP     ZRATE                           S01157
     C*                                                                   S01157
     C* ELSE FR IS SOLD                                                   S01157
     C*                                                                   S01157
     C                     ELSE                                           S01157
     C*                                                                   S01157
     C                     MOVE UBRTT     @BTYP                           S01157
     C                     Z-ADDTRTSP     ZRATE                           S01157
     C*                                                                   S01157
     C                     END                                            S01157
     C*                                                                   S01157
     C                     END                                            S01157
     C*                                                                   S01157
     C* FORMAT SPREAD/INTEREST RATE , AKA CONTRACT RATE                   S01157
     C*                                                                   S01157
     C           ZRATE     IFEQ 0                                         S01157
     C                     MOVE *BLANK    @RATE                           S01157
     C                     ELSE                                           S01157
     C                     EXSR RTEDIT                                    S01157
     C                     MOVE ZRATEA    @RATE  12                       S01157
     C                     END                                            S01157
     C*                                                                   S01157
     C* PRINT DETAILS                                                     S01157
     C*                                                                   S01157
     C                     MOVE '0'       *IN44                           S01157
     C                     EXCPTCOMMON                                    S01157
     C*                                                                   S01157
     C           DTYP      IFEQ 'FR'                                      S01157
     C                     EXCPTFRDET                                     S01157
     C                     ELSE                                           S01157
     C                     EXCPTRRDET                                     S01157
     C                     END                                            S01157
     C*                                                                   S01157
     C           #FRA9     ENDSR                                          S01157
     C*                                                                   S01157
0746 C********************************************************************S01157
0120 C/SPACE 2                                                            S01157
0746 C********************************************************************S01157
     C*                                                                   S01157
     C*    #IRS - DEAL TYPES RS/RX                                        S01157
     C*                                                                   S01157
0746 C********************************************************************S01157
     C*                                                                   S01157
     C           #IRS      BEGSR                                          S01157
     C*                                                                   S01157
     C*                                                                   S01157
     C* FORMAT DEAL DATE , VALUE DATE , MATURITY DATE                     S01157
     C*                                                                   S01157
     C                     Z-ADDDDAT      ZDAYNO                          S01157
     C                     EXSR ZDATE2                                    S01157
     C                     MOVE ZADATE    @DLDAT                          S01157
     C*                                                                   S01157
     C                     Z-ADDVDAT      ZDAYNO                          S01157
     C                     EXSR ZDATE2                                    S01157
     C                     MOVE ZADATE    @VLDAT                          S01157
     C*                                                                   S01157
     C                     Z-ADDMDAT      ZDAYNO                          S01157
     C                     EXSR ZDATE2                                    S01157
     C                     MOVE ZADATE    @MTDAT                          S01157
     C*                                                                   S01157
     C* FORMAT OUR/THEIR BASE RATE                                        S01157
     C*                                                                   S01157
     C           UBRTT     IFEQ 0                                         S01157
     C                     MOVE *BLANK    @UBRTT  2                       S01157
     C                     ELSE                                           S01157
     C                     MOVE UBRTT     @UBRTT                          S01157
     C                     END                                            S01157
     C*                                                                   S01157
     C           TBRTT     IFEQ 0                                         S01157
     C                     MOVE *BLANK    @TBRTT  2                       S01157
     C                     ELSE                                           S01157
     C                     MOVE TBRTT     @TBRTT                          S01157
     C                     END                                            S01157
     C*                                                                   S01157
     C* SET FED FUNDS INDICATOR                                           S01157
     C*                                                                   S01157
     C           UCUCY     IFEQ 'USD'                                     S01157
     C                     MOVE '1'       *IN74                           S01157
     C*                                                                   S01157
     C                     TESTB'2'       UDSTI          76               S01157
     C           *IN76     IFEQ '1'                                       S01157
     C                     MOVE 'Y'       @FEDF   1                       S01157
     C                     ELSE                                           S01157
     C                     MOVE *BLANK    @FEDF                           S01157
     C                     END                                            S01157
     C*                                                                   S01157
     C                     END                                            S01157
     C*                                                                   S01157
     C* RETRIEVE  NO. DEC PLACES FOR OUR SIDE                             S01157
     C*                                                                   S01157
     C                     MOVE UCUCY     XXCCY                           S01157
     C*****                EXSR XCYCHN                            S01157  S01194
     C*
     C** CALL ACCESS PROGRAM                                              S01194
     C                     CALL 'AOCURRR0'                                S01194
     C                     PARM '*MSG    '@RTCD                           S01194
     C                     PARM '*KEY    '@OPTN                           S01194
     C                     PARM XXCCY     @AJCD   3                       S01194
     C           @CURR     PARM @CURR     DSSDY                           S01194
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVEL'SDCURRPD'DBFILE            ************* S01194
     C                     MOVEL'10'      DBASE             *DBERROR 010* S01194
     C                     MOVEL@OPTN     DBOPTN            ************* S01194
     C                     MOVELXXCCY     DBKEY                           S01194
     C                     SETON                     U7U8LR               S01194
     C                     EXSR *PSSR                                     S01194
     C                     GOTO #IRS9                                     S01194
0595 C*                                                                   S01194
     C                     ELSE                                           S01194
     C                     Z-ADDA6NBDP    XDECP                           S01194
     C                     END                                            S01194
     C*
     C*                                                                   S01157
     C* FORMAT OUR SIDE DEAL AMOUNT                                       S01157
     C*                                                                   S01157
     C                     Z-ADDUPAMT     ZAMNT                           S01157
     C                     Z-ADDXDECP     ZCDP                            S01157
     C                     MOVE 'Y'       ZCOMMA                          S01157
     C                     MOVE 'N'       ZMINUS                          S01157
     C                     EXSR ZEDIT                                     S01157
     C                     MOVE ZAMNTA    @DLAMT 17                       S01157
     C*                                                                   S01157
     C* IF DEAL REVERSED                                                  S01157
     C*                                                                   S01157
     C           RECI      IFEQ 'R'                                       S01157
     C                     MOVE 'REVERSED'@TEXT   8                       S01157
     C                     END                                            S01157
     C*                                                                   S01157
     C* MATURED                                                           S01157
     C*                                                                   S01157
     C           *IN42     IFEQ '1'                                       S01157
     C                     MOVEL'MATURED' @TEXT                           S01157
     C                     END                                            S01157
     C*                                                                   S01157
     C* IF DEAL IS RX - FORMAT THEIR AMOUNT & OUTPUT THEIR CCY            S01157
     C*                                                                   S01157
     C           DTYP      IFEQ 'RX'                                      S01157
     C*                                                                   S01157
     C                     MOVE '1'       *IN73                           S01157
     C*                                                                   S01157
     C* SET FED FUNDS INDICATOR                                           S01157
     C*                                                                   S01157
     C           TCUCY     IFEQ 'USD'                                     S01157
     C                     MOVE '1'       *IN75                           S01157
     C*                                                                   S01157
     C                     TESTB'2'       TDSTI          76               S01157
     C           *IN76     IFEQ '1'                                       S01157
     C                     MOVE 'Y'       @FEDF   1                       S01157
     C                     ELSE                                           S01157
     C                     MOVE *BLANK    @FEDF                           S01157
     C                     END                                            S01157
     C*                                                                   S01157
     C                     END                                            S01157
     C*                                                                   S01157
     C* THEIR AMT                                                         S01157
     C*                                                                   S01157
     C*                                                                   S01157
     C* RETRIEVE  NO. DEC PLACES FOR THEIR SIDE                           S01157
     C*                                                                   S01157
     C                     MOVE TCUCY     XXCCY                           S01157
     C*****                EXSR XCYCHN                            S01157  S01194
     C*
     C** CALL ACCESS PROGRAM                                              S01194
     C                     CALL 'AOCURRR0'                                S01194
     C                     PARM '*MSG    '@RTCD                           S01194
     C                     PARM '*KEY    '@OPTN                           S01194
     C                     PARM XXCCY     @AJCD   3                       S01194
     C           @CURR     PARM @CURR     DSSDY                           S01194
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVEL'SDCURRPD'DBFILE            ************* S01194
     C                     MOVEL'11'      DBASE             *DBERROR 011* S01194
     C                     MOVEL@OPTN     DBOPTN            ************* S01194
     C                     MOVELXXCCY     DBKEY                           S01194
     C                     SETON                     U7U8LR               S01194
     C                     EXSR *PSSR                                     S01194
     C                     GOTO #IRS9                                     S01194
     C                     ELSE                                           S01194
     C                     Z-ADDA6NBDP    XDECP                           S01194
     C                     END                                            S01194
     C*
     C*                                                                   S01157
     C* FORMAT THEIR SIDE DEAL AMOUNT                                     S01157
     C*                                                                   S01157
     C                     Z-ADDTPAMT     ZAMNT                           S01157
     C                     Z-ADDXDECP     ZCDP                            S01157
     C                     MOVE 'Y'       ZCOMMA                          S01157
     C                     MOVE 'N'       ZMINUS                          S01157
     C                     EXSR ZEDIT                                     S01157
     C                     MOVE ZAMNTA    @RXAMT 17                       S01157
     C*                                                                   S01157
     C                     END                                            S01157
     C*                                                                   S01157
     C* FORMAT OUR & THEIR INTEREST/SPREAD                                S01157
     C*                                                                   S01157
     C           URTSP     IFEQ 0                                         S01157
     C                     MOVE *BLANK    @ORATE                          S01157
     C                     ELSE                                           S01157
     C                     Z-ADDURTSP     ZRATE                           S01157
     C                     EXSR RTEDIT                                    S01157
     C                     MOVE ZRATEA    @ORATE 12                       S01157
     C                     END                                            S01157
     C*                                                                   S01157
     C           TRTSP     IFEQ 0                                         S01157
     C                     MOVE *BLANK    @TRATE                          S01157
     C                     ELSE                                           S01157
     C                     Z-ADDTRTSP     ZRATE                           S01157
     C                     EXSR RTEDIT                                    S01157
     C                     MOVE ZRATEA    @TRATE 12                       S01157
     C                     END                                            S01157
     C*                                                                   S01157
     C* PRINT DETAILS                                                     S01157
     C*                                                                   S01157
     C                     MOVE '0'       *IN44                           S01157
     C                     EXCPTCOMMON                                    S01157
     C                     EXCPTRXDET                                     S01157
     C*                                                                   S01157
     C           #IRS9     ENDSR                                          S01157
     C*                                                                   S01157
0746 C********************************************************************S01157
0120 C/SPACE 2                                                            S01157
0746 C********************************************************************
0846 C**
     C*
     C*  ZEDIT SR. SUBROUTINE TO EDIT AN AMOUNT FIELD FOR OUTPUT
     C*
     C*  CALLED BY: BASFMT, ENQFMT
     C*
     C*  INPUT FIELDS:
     C*                    ZAMNT  15 0    AMOUNT FIELD TO BE EDITED
     C*                    ZCDP    1,0    NO. OF DECIMAL PLACES
     C*                    ZCOMMA  1 A    COMMAS WANTED ('Y' OR 'N')
     C*                    ZMINUS  1 A    MINUS SIGN WANTED ('Y' OR 'N')
     C*
     C*  OUTPUT FIELDS:
     C*                    ZAMNTA 21 A    EDITED AMOUNT FIELD
     C*
     C*  INDICATOR USED:
     C*                    *IN94          SETON IF NON-ZERO CHARACTER
     C*                                   FOUND IN THE AMOUNT
     C*
     C           ZEDIT     BEGSR                           ***  ZEDIT  ***
     C*
     C                     Z-ADDZAMNT     ZAMNT  150       I/P FIELD
     C                     MOVE ZCOMMA    ZCOMMA  1        VALUE Y OR N
     C                     MOVE ZMINUS    ZMINUS  1        VALUE Y OR N
     C                     Z-ADDZCDP      ZCDP    10       NO. OF DPs.
     C                     MOVE *BLANK    ZAMNTA 21        O/P FIELD
     C                     MOVE '0'       *IN94
     C*
     C                     MOVE *BLANK    ZAMNTB 16        NON-COMMA EDIT
     C                     MOVE *BLANK    ZAMNTC 20        NON-COMMA EDIT
     C                     MOVE *BLANK    ZAMNTD 17        NON-COMMA EDIT
     C                     MOVE *BLANK    ZFLD3  16        NON-COMMA EDIT
     C                     MOVE '00000000'ZFLD1  15
     C                     MOVEL'0000000' ZFLD1
     C                     MOVE *BLANK    ZFLD2  20
     C                     MOVE ' '       ZMINS   1        MINUS CHARCTER
     C                     MOVEA*BLANK    ZEDT
     C                     MOVEA*BLANK    ZED2
     C                     MOVEA*BLANK    ZAMT
     C                     MOVEA*BLANK    Z3
     C*
     C*  INCLUDE MINUS SIGN IF NEEDED
     C*  PROCESS AMOUNT AS A POSTIVE NUMBER EVEN IF NEGATIVE
     C           ZMINUS    IFEQ 'Y'                        **** B1
     C           ZAMNT     IFLT 0                          **** B2
     C                     MOVE '-'       ZMINS
     C                     Z-SUBZAMNT     ZAMNT
     C                     ELSE                            **** X2
     C                     MOVE ' '       ZMINS
     C                     END                             **** E2
     C                     ELSE                            **** X2
     C           ZAMNT     IFLT 0                          **** B2
     C                     Z-SUBZAMNT     ZAMNT
     C                     END                             **** E2
     C                     END                             **** E1
     C*
     C*  SEPARATE INTEGER AND DECIMAL PARTS OF AMOUNT
     C*  - ZERO DECIMAL PLACES
     C           ZCDP      IFEQ 0                          **** B1
     C                     MOVE ZAMNT     ZFLD1
     C                     ELSE
     C*
     C*  - ONE DECIMAL PLACE
     C           ZCDP      IFEQ 1                          **** B2
     C                     MOVE ZAMNT     ZDEC1   1
     C                     MOVELZAMNT     ZAMT1  14
     C                     MOVE ZAMT1     ZFLD1
     C                     ELSE
     C*
     C*  - TWO DECIMAL PLACES
     C           ZCDP      IFEQ 2                          **** B3
     C                     MOVE ZAMNT     ZDEC2   2
     C                     MOVELZAMNT     ZAMT2  13
     C                     MOVE ZAMT2     ZFLD1
     C                     ELSE
     C*
     C*  - THREE DECIMAL PLACES
     C           ZCDP      IFEQ 3                          **** B4
     C                     MOVE ZAMNT     ZDEC3   3
     C                     MOVELZAMNT     ZAMT3  12
     C                     MOVE ZAMT3     ZFLD1
     C                     ELSE
     C*
     C*  - EIGHT DECIMAL PLACES
     C           ZCDP      IFEQ 8                          **** B5
     C                     MOVE ZAMNT     ZDEC8   8
     C                     MOVELZAMNT     ZAMT8   7
     C                     MOVE ZAMT8     ZFLD1
     C                     END                             **** E5
     C                     END                             **** E4
     C                     END                             **** E3
     C                     END                             **** E2
     C                     END                             **** E1
     C*
     C*  MOVE THE INTEGER FIELD INTO A 5X3 ARRAY FOR EDITING
     C                     MOVEAZFLD1     ZAMT
     C*
     C/SPACE 3
     C*
     C****
     C*
     C*  CHECK IF COMMAS ARE NEEDED OR NOT
     C*
     C****
     C           ZCOMMA    IFEQ 'Y'                        **** E1
     C****
     C*
     C*  IF ZCOMMA  IS 'Y' MOVE COMMAS ETC. INTO A 5X4 EDITED ARRAY
     C*  (FOR ZERO DECIMAL PLACES DO NOT WANT A DECIMAL POINT)
     C*
     C           ZCDP      IFEQ 0                          **** B2
     C                     MOVEAZCOM,1    ZEDT
     C                     ELSE
     C                     MOVEAZCOM,2    ZEDT
     C                     END                             **** E2
     C*
     C*
     C*  READ THROUGH AMOUNT ARRAY SO AS TO PLACE EDITED DIGITS
     C*  INTO ZEDT. THE ARRAY IS READ 3 CHARACTERS AT A TIME.
     C*  ALL LEADING ZEROES ARE SUPPRESSED.
     C                     DO   5         Z       10       **** B2
     C*
     C           *IN94     IFEQ '1'                        **** B3
     C                     MOVELZAMT,Z    ZEDT,Z
     C                     ELSE
     C*
     C*  BLANK OUT EDITED FIELD IF ZEROES ARE FOUND
     C           ZAMT,Z    IFEQ '000'                      **** B4
     C           Z         IFNE 5                          **** B5
     C                     MOVE '    '    ZEDT,Z
     C                     END                             **** E5
     C                     ELSE
     C*
     C*  WHEN FIRST NON ZERO CHARACTERS ARE REACHED REMOVE LEADING
     C*  ZEROES. READ ARRAY ELEMENT 1 CHARACTER AT A TIME.
     C                     MOVE '1'       *IN94
     C                     Z-ADD1         ZN      10
     C                     MOVEAZAMT,Z    Z3
     C           Z3,ZN     DOWEQ'0'                        **** B5
     C                     MOVE ' '       Z3,ZN
     C                     ADD  1         ZN
     C                     END                             **** E5
     C                     MOVEAZ3        ZEDT,Z
     C                     END                             **** E4
     C                     END                             **** E3
     C                     END                             **** E2
     C*
     C*  PLACE EDITED ARRAY INTO ALPHA FIELD TO INCLUDE DECIMALS.
     C                     MOVEAZEDT      ZFLD2
     C*
     C*  - ZERO DECIMAL PLACES
     C           ZCDP      IFEQ 0                          **** B2
     C                     MOVELZFLD2     ZAMT0  19
     C                     MOVE ZAMT0     ZAMNTC
     C                     ELSE
     C*
     C*  - ONE DECIMAL PLACE
     C           ZCDP      IFEQ 1                          **** B3
     C                     MOVE ZFLD2     ZAMT1A 19
     C                     MOVELZAMT1A    ZAMNTC
     C                     MOVE ZDEC1     ZAMNTC
     C                     ELSE
     C*
     C*  - TWO DECIMAL PLACES
     C           ZCDP      IFEQ 2                          **** B4
     C                     MOVE ZFLD2     ZAMT2A 18
     C                     MOVELZAMT2A    ZAMNTC
     C                     MOVE ZDEC2     ZAMNTC
     C                     ELSE
     C*
     C*  - THREE DECIMAL PLACES
     C           ZCDP      IFEQ 3                          **** B5
     C                     MOVE ZFLD2     ZAMT3A 17
     C                     MOVELZAMT3A    ZAMNTC
     C                     MOVE ZDEC3     ZAMNTC
     C                     ELSE
     C*
     C*  - EIGHT DECIMAL PLACES
     C           ZCDP      IFEQ 8                          **** B6
     C                     MOVE ZFLD2     ZAMT8A 12
     C                     MOVELZAMT8A    ZAMNTC
     C                     MOVE ZDEC8     ZAMNTC
     C                     END                             **** E6
     C                     END                             **** E5
     C                     END                             **** E4
     C                     END                             **** E3
     C                     END                             **** E2
     C*
     C*  INCLUDE MINUS SIGN IF NEEDED
     C           ZMINUS    IFEQ 'Y'                        **** B2
     C                     MOVELZAMNTC    ZAMNTA
     C                     MOVE ZMINS     ZAMNTA
     C                     ELSE                            **** X2
     C                     MOVE ZAMNTC    ZAMNTA
     C                     END                             **** E2
     C*
     C****                                                 ****
     C*
     C                     ELSE                            **** X1
     C*
     C****                                                 ****
     C*
     C*  ELSE IF ZCOMMA EQUAL 'N':
     C*  MOVE FORMAT LEFT INTO A 6X3 ARRAY - 6TH ELEMENT CONTAINS D.P.
     C*  (FOR ZERO DECIMAL PLACES DO NOT WANT A DECIMAL POINT)
     C           ZCDP      IFEQ 0                          **** B2
     C                     MOVEAZCOM,3    ZED2
     C                     ELSE
     C                     MOVEAZCOM,4    ZED2
     C                     END                             **** E2
     C*
     C*
     C*  READ THROUGH AMOUNT ARRAY SO AS TO PLACE EDITED DIGITS
     C*  INTO ZED2. THE ARRAY IS READ 3 CHARACTERS AT A TIME.
     C*  ALL LEADING ZEROES ARE SUPPRESSED.
     C                     DO   5         Z       10       **** B2
     C*
     C           *IN94     IFEQ '1'                        **** B3
     C                     MOVELZAMT,Z    ZED2,Z
     C                     ELSE
     C*
     C*  SEARCH FOR FIRST NONE-ZERO CHARACTERS
     C           ZAMT,Z    IFNE '000'                      **** B4
     C*
     C*  WHEN FIRST NON ZERO CHARACTERS ARE REACHED REMOVE LEADING
     C*  ZEROES. READ ARRAY ELEMENT 1 CHARACTER AT A TIME.
     C                     MOVE '1'       *IN94
     C                     Z-ADD1         ZN      10
     C                     MOVEAZAMT,Z    Z3
     C           Z3,ZN     DOWEQ'0'                        **** B5
     C                     MOVE ' '       Z3,ZN
     C                     ADD  1         ZN
     C                     END                             **** E5
     C                     MOVEAZ3        ZED2,Z
     C                     END                             **** E4
     C                     END                             **** E3
     C                     END                             **** E2
     C*
     C*  PLACE EDITED ARRAY INTO ALPHA FIELD TO INCLUDE DECIMALS.
     C                     MOVEAZED2      ZFLD3
     C*
     C*  - ZERO DECIMAL PLACES
     C           ZCDP      IFEQ 0                          **** B2
     C                     MOVELZFLD3     ZAMT0B 15
     C                     MOVE ZAMT0B    ZAMNTB
     C                     ELSE
     C*
     C*  - ONE DECIMAL PLACE
     C           ZCDP      IFEQ 1                          **** B3
     C                     MOVE ZFLD3     ZAMT1B 15
     C                     MOVELZAMT1B    ZAMNTB
     C                     MOVE ZDEC1     ZAMNTB
     C                     ELSE
     C*
     C*  - TWO DECIMAL PLACES
     C           ZCDP      IFEQ 2                          **** B4
     C                     MOVE ZFLD3     ZAMT2B 14
     C                     MOVELZAMT2B    ZAMNTB
     C                     MOVE ZDEC2     ZAMNTB
     C                     ELSE
     C*
     C*  - THREE DECIMAL PLACES
     C           ZCDP      IFEQ 3                          **** B5
     C                     MOVE ZFLD3     ZAMT3B 13
     C                     MOVELZAMT3B    ZAMNTB
     C                     MOVE ZDEC3     ZAMNTB
     C                     ELSE
     C*
     C*  - EIGHT DECIMAL PLACES
     C           ZCDP      IFEQ 8                          **** B6
     C                     MOVE ZFLD3     ZAMT8B  8
     C                     MOVELZAMT8B    ZAMNTB
     C                     MOVE ZDEC8     ZAMNTB
     C                     END                             **** E6
     C                     END                             **** E5
     C                     END                             **** E4
     C                     END                             **** E3
     C                     END                             **** E2
     C*
     C*  INCLUDE MINUS SIGN IF NEEDED
     C           ZMINUS    IFEQ 'Y'                        **** B2
     C                     MOVELZAMNTB    ZAMNTD
     C                     MOVE ZMINS     ZAMNTD
     C                     ELSE                            **** X2
     C                     MOVE ZAMNTB    ZAMNTD
     C                     END                             **** E2
     C*
     C*  FINALLY MOVE NON-COMMA EDITED FIELD INTO O/P FIELD
     C                     MOVE ZAMNTD    ZAMNTA
     C*
     C****
     C                     END                             **** E1
     C****
     C                     ENDSR
     C*
0721 C********************************************************************
0120 C/SPACE 2
0180 C********************************************************************
0181 C**
0182 C**   ZDATE2 SR. TO CONVERT A DAY NUMBER TO DATE FORMATS.
0183 C**
0184 C**   THE YEAR 2000, BEING DIVISIBLE BY 400, IS A LEAP YEAR.
0185 C**
0186 C           ZDATE2    BEGSR                           *** ZDATE2 ***
0187 C**
0188 C**   CLEAR DATE FIELDS.
0189 C                     Z-ADD0         ZDATE   60
0190 C                     MOVEL'       ' ZADATE  7
0191 C**
0192 C**   CALCULATION TO DEFINE INPUT DAY NUMBER.
0193 C                     Z-ADDZDAYNO    ZDAYNO  50
0194 C**
0195 C**   DETERMINE YEAR NUMBER.
0196 C**
0197 C**   ADJUST DAY NUMBER IN CASE LAST DAY OF YEAR.
0198 C           ZDAYNO    SUB  1         ZDAYN1  50   99
0199 C   99                GOTO ZDEND2
0200 C**
0201 C**   CALCULATE NUMBER OF 4 YEAR SPANS SINCE 31/12/1971.
0202 C           ZDAYN1    DIV  1461      ZLYR    20
0203 C                     MVR            ZDAYN1           SAVE REMAINING
0204 C**                                                   DAYS
0205 C**   CALCULATE NUMBER OF REMAINING YEARS.
0206 C                     Z-ADD1         ZWRK2   20
0207 C           ZDTAG1    TAG                             ** ZDTAG1 TAG *
0208 C           ZDAYN1    COMP ZYDY,ZWRK2             90
0209 C  N90      ZWRK2     ADD  1         ZWRK2
0210 C  N90                GOTO ZDTAG1
0211 C           ZWRK2     SUB  1         ZWRK2          91LEAP YR, 91 ON
0212 C**
0213 C**   DECREMENT DAY NO. BY DAYS IN REMAINING YEARS.
0214 C  N91      ZDAYN1    SUB  ZYDY,ZWRK2ZDAYN1
0215 C**
0216 C**   CALCULATE ACTUAL YEAR NUMBER.
0217 C           ZLYR      MULT 4         ZWRK3   30
0218 C           ZWRK3     ADD  72        ZWRK3            BASE IS 1972
0219 C                     Z-ADDZWRK3     ZYEAR   20
0220 C           ZYEAR     ADD  ZWRK2     ZYEAR            YEAR
0221 C**
0222 C**   DETERMINE MONTH NUMBER.
0223 C**
0224 C**   ADJUST DAY NO. IN CASE LAST DAY OF LEAP YEAR FEBRUARY.
0225 C                     SETOF                     9293
0226 C   91      ZDAYN1    COMP 59                     9293
0227 C   91N92   ZDAYN1    SUB  1         ZDAYN1
0228 C**
0229 C**   CALCULATE MONTH NUMBER.
0230 C                     Z-ADD2         ZWRK2
0231 C           ZDTAG2    TAG                             ** ZDTAG2 TAG *
0232 C           ZDAYN1    COMP ZMDY,ZWRK2             94
0233 C  N94      ZWRK2     ADD  1         ZWRK2
0234 C  N94                GOTO ZDTAG2
0235 C           ZWRK2     SUB  1         ZWRK2
0236 C**
0237 C                     Z-ADDZWRK2     ZMTH    20       MONTH
0238 C**
0239 C**   DETERMINE DAY OF MONTH.
0240 C**
0241 C**   ADD BACK LAST DAY OF YEAR ADJUSTMENT.
0242 C           ZDAYN1    ADD  1         ZDAYN1
0243 C**
0244 C**   CALCULATE DAY OF MONTH.
0245 C           ZDAYN1    SUB  ZMDY,ZWRK2ZDAY    20       DAY
0246 C**
0247 C**   ADD BACK LEAP YEAR 29TH FEBUARY ADJUSTMENT, IF REQUIRED.
0248 C   93      ZDAY      ADD  1         ZDAY
0249 C**
0250 C**   FORMAT DATE, DDMMYY OR MMDDYY.
0251 C  N98                MOVELZDAY      ZWRK4   40
0252 C   98                MOVE ZDAY      ZWRK4
0253 C  N98                MOVE ZMTH      ZWRK4
0254 C   98                MOVELZMTH      ZWRK4
0255 C                     MOVELZWRK4     ZDATE
0256 C                     MOVE ZYEAR     ZDATE
0257 C**
0258 C**   FORMAT ALPHA DATE, DDMMMYY.
0259 C           ZDAY      COMP 10                     95
0260 C                     MOVELZDAY      ZWRK5   5
0261 C   95                MOVEL' '       ZWRK5
0262 C                     MOVE ZMNM,ZMTH ZWRK5
0263 C                     MOVELZWRK5     ZADATE
0264 C                     MOVE ZYEAR     ZADATE
0265 C**
0266 C           ZDEND2    ENDSR                           * ZDEND2 ENDSR*
0267 C**
0268 C**
0269 C********************************************************************
0270 C/SPACE 2
0482 C********************************************************************
0483 C*****                                                               S01194
0484 C*****ZSYSTM SR. TO CHAIN TO THE INSTALLATION CONTROL DATA RECORD.   S01194
0485 C*****                                                               S01194
0486 C*****      ZSYSTM    BEGSR                           *** ZSYSTM *** S01194
0487 C*****                                                               S01194
0488 C*****SET UP KEY FOR INSTALLATION CONTROL RECORD.                    S01194
0489 C*****                MOVEL'01      'ZTABKY 12                       S01194
0490 C*****                MOVE '  10'    ZTABKY                          S01194
0491 C*****                                                               S01194
0492 C*****      ZTABKY    CHAINTABLE                99    ON NOT THERE   S01194
0493 C**N99      RECI      COMP 'D'                  9999  ON, IS DELETED S01194
0494 C*****                                                               S01194
0495 C*****CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.                    S01194
0496 C*****      DATF      COMP 'M'                      98MMDDYY, 98 ON  S01194
0497 C*****                                                               S01194
0498 C*****                ENDSR                                          S01194
0499 C*****                                                               S01194
0500 C********************************************************************
     C/EJECT
     C***************************************************************     S01136
     C*                                                                   S01136
     C* #A        -  DRS INITIAL PROCESSING                               S01136
     C*                                                                   S01136
     C* CALLS       -                                                     S01136
     C*                                                                   S01136
     C* CALLED BY   - MAIN PROGRAM                                        S01136
     C*                                                                   S01136
     C* FLDS USED   -                                                     S01136
     C*                                                                   S01136
     C***************************************************************     S01136
     C           #A        BEGSR                                          S01136
     C*                                                                   S01136
     C** SET UP PROGRAM NAME                                              S01136
     C                     MOVEL'DL2480'  DBPGM                           S01136
     C*                                                                   S01136
     C** RETRIEVE THE EXTERNAL DATAAREA MMOD                              E14702
     C           *NAMVAR   DEFN MMOD      MMODS                           E14702
     C                     IN   MMODS                                     E14702
     C*                                                                   E14702
     C***********MODFD     IFEQ 'Y'                        B1      E14702 065877
     C*********************OPEN*FDPMNTLL********************1*******E14702S01319
     C                     OPEN FDMNTHLL                   *1             S01319
     C*********************OPEN*FDINSTLL********************1*******E14702S01319
     C*****                OPEN FDCCYDLL                   *1      E14702 S01194
     C*****                OPEN FXTB40LL                   *1      E14702 S01194
     C*                                                                   S01136
     C***ACCESS*DRS*INSTALLATION*CONTROL*DATA***********************S01136S01319
     C***********1*********SETLLFDINSTLL********************1*******S01136S01319
     C*********************READ*FDINSTLL*****************61*1*******S01136S01319
     C**************************************************************S01136S01319
     C***IF*RECORD*NOT*FOUND*DATABASE*ERROR*************************S01136S01319
     C************IN61*****IFEQ*'1'************************B*2******S01136S01319
     C***********IDDLTF****OREQ*'*'**************************2******S01136S01319
     C                     CALL 'AODEALR0'                                S01319
     C                     PARM '*MSG   ' @RTCD   7                       S01319
     C                     PARM '*FIRST ' @OPTN   7                       S01319
     C           SDDEAL    PARM SDDEAL    DSFDY                           S01319
     C           @RTCD     IFNE *BLANKS                    B1             S01319
     C                     MOVE '001'     DBASE            ***************S01136
     C*********************MOVEL'FDINSTLL'DBFILE********************S01136S01319
     C                     MOVEL'SDDEALPD'DBFILE           *             *S01319
     C                     MOVE *BLANKS   DBKEY            * DBERROR 001 *S01136
     C                     MOVE '1'       *INU7            *             *S01136
     C                     MOVE '1'       *INU8            ***************S01136
     C                     EXSR *PSSR                                     S01194
     C                     GOTO #A9                        **2            S01136
     C                     END                             E*2            S01136
     C*                                                                   S01136
     C** ACCESS MONTH NAME FILE                                           S01136
     C***********1*********SETLLFDPMNTLL********************1*******S01136S01319
     C*********************READ*FDPMNTLL*****************61*1*******S01136S01319
     C           1         SETLLFDMNTHLL                   *1             S01319
     C                     READ FDMNTHLL                 61*1             S01319
     C*                                                                   S01136
     C** IF RECORD NOT FOUND DATABASE ERROR                               S01136
     C           *IN61     IFEQ '1'                        B*2            S01136
     C***********IDDLTF****OREQ*'*'**************************2******S01136S01319
     C                     MOVE '002'     DBASE            ***************S01136
     C*********************MOVEL'FDPMNTLL'DBFILE********************S01136S01319
     C                     MOVEL'FDMNTHLL'DBFILE           *             *S01319
     C                     MOVE *BLANKS   DBKEY            * DBERROR 002 *S01136
     C                     MOVE '1'       *INU7            *             *S01136
     C                     MOVE '1'       *INU8            ***************S01136
     C                     EXSR *PSSR                                     S01194
     C                     GOTO #A9                        **2            S01136
     C                     END                             E*2            S01136
     C*                                                                   S01136
     C***ACCESS*TABLE*FILE*                                        S01136 S01194
     C*****      *LOVAL    SETLLFXTB40LL                   *1      S01136 S01194
     C*****                READ FXTB40LL                 61*1      S01136 S01194
     C*                                                                   S01136
0757 C*
     C** CALL ACCESS PROGRAM FOR TRADING DATA DETAILS                     S01194
     C                     CALL 'AOTRADR0'                                S01194
     C                     PARM '*MSG    '@RTCD                           S01194
     C                     PARM '*FIRST  '@OPTN                           S01194
     C           @TRAD     PARM @TRAD     DSFDY                           S01194
     C*                                                                   S01194
     C** IF RECORD NOT FOUND DATABASE ERROR                               S01136
     C******     *IN61     IFEQ '1'                        B*2     S01136 S01194
     C*****                MOVEL'FXTB40LL'DBFILE           *      S01136  S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVEL'SDTRADPD'DBFILE                          S01194
     C                     MOVEL@OPTN     DBOPTN                          S01194
     C                     MOVE '003'     DBASE            ***************S01136
     C                     MOVE *BLANKS   DBKEY            * DBERROR 003 *S01136
     C                     MOVE '1'       *INU7            *             *S01136
     C                     MOVE '1'       *INU8            ***************S01136
     C                     EXSR *PSSR                                     S01194
     C                     GOTO #A9                        **2            S01136
     C                     END                             E*2            S01136
     C*                                                                   S01136
     C***********          END                             E1      E14702 065877
     C*                                                                   S01136
     C***RETRIEVE THE EXTERNAL DATAAREA MMOD                       S01136 E14702
     C********** *NAMVAR   DEFN MMOD      MMODS                    S01136 E14702
     C**********           IN   MMODS                              S01136 E14702
     C********                                                      S01136BHF486
     C***OPEN*APPROPRIATE DEALS FILE DEPENDING ON MMOD              S01136BHF486
     C*******    MODS      IFEQ 'YN'                       B1       S01136BHF486
     C*******              OPEN FXCUSDLL                   *1       S01136BHF486
     C*******              END                             E1       S01136BHF486
     C*******                                                       S01136BHF486
     C*******    MODS      IFEQ 'NY'                       B1       S01136BHF486
     C*******              OPEN MMCUSDLL                   *1       S01136BHF486
     C*******              END                             E1       S01136BHF486
     C*******                                                       S01136BHF486
     C*******    MODS      IFEQ 'YY'                       B1       S01136BHF486
     C                     OPEN CACUSDLL                   *1             S01136
     C*******              END                             E1       S01136BHF486
     C*******                                                       S01136BHF486
     C***OPEN*MIDAS DEALS                                           S01136BHF486
     C*******    MODS      IFEQ 'NN'                       B1       S01136BHF486
     C*******              OPEN CUSDL                      *1       S01136BHF486
     C*******              END                             E1       S01136BHF486
     C*                                                                   S01136
     C**********           OPEN FDCCYDLL                           S01136 E14702
     C*                                                                   S01136
      ** Access Switchable Features file and check if CSD007              CSD007
      ** is switched on or not.                                           CSD007
      *                                                                   CSD007
     C                     CALL 'AOSARDR0'                                CSD007
     C                     PARM *BLANKS   @RTCD   7                       CSD007
     C                     PARM '*VERIFY' @OPTN   7                       CSD007
     C                     PARM 'CSD007'  @SARD   6                       CSD007
     C           SCSARD    PARM SCSARD    DSFDY                           CSD007
      *                                                                   CSD007
     C           @RTCD     IFEQ *BLANKS                                   CSD007
     C                     MOVE 'Y'       CSD007  1                       CSD007
      *                                                                   CSD007
     C                     ELSE                                           CSD007
     C                     MOVE 'N'       CSD007                          CSD007
      *                                                                   CSD007
      ** Database Error, if Return Code is not blanks or *NRF             CSD007
      *                                                                   CSD007
     C           @RTCD     IFNE '*NRF   '                                 CSD007
     C                     MOVEL'SCSARDPD'DBFILE                          CSD007
     C                     MOVEL'007'     DBASE                           CSD007
     C                     MOVEL'CSD007  'DBKEY                           CSD007
     C                     MOVE *ON       *INU7                           CSD007
     C                     MOVE *ON       *INU8                           CSD007
     C                     MOVE *ON       *INLR                           CSD007
     C                     EXSR *PSSR                                     CSD007
     C                     GOTO END                                       CSD007
     C                     ENDIF                                          CSD007
     C                     ENDIF                                          CSD007
      *                                                                   CSD007
     C/COPY WNCPYSRC,DLH00250
     C           #A9       ENDSR                                          S01136
     C*****************************************************************   S01136
     C/EJECT                                                              S01136
     C*****************************************************************   S01136
     C*                                                               *   S01136
     C**#B**********-**FORMAT*FXDEALP0*OR*FXDEALP1*FOR*LINE01******S01136 E20251
     C* #B          -  FORMAT FXDEALP0 FOR LINE01                     *   E20251
     C*                                                               *   S01136
     C* CALLS                                                         *   S01136
     C*                                                               *   S01136
     C* CALLED BY   -                                                 *   S01136
     C*                                                               *   S01136
     C* FLDS USED                                                     *   S01136
     C*                                                               *   S01136
     C*****************************************************************   S01136
     C           #B        BEGSR                                          S01136
     C*                                                                   S01136
     C**   DEAL TYPE TEXT                                                 S01136
     C                     MOVELFHTYPE    DTYPW                           S01136
     C                     MOVEL'-'       STWK                            S01136
     C                     MOVE FHSTYP    STWK                            S01136
     C                     MOVE STWK      DTYPW                           S01136
     C                     MOVE FHCLAS    CLASW                           CDL038
     C*                                                                   S01136
     C                     MOVE FHDN38    DLNO                            S01136
     C*                                                                   S01136
     C** FORMAT REMAINING F-X FIELDS.                                     S01136
     C*                                                                   S01136
     C** FORMAT DEAL VALUE AND DEAL DONE DATE.                            S01136
     C                     EXSR #K                                        S01136
     C*                                                                   S01136
     C** SET UP NARRATIVE                                                 S01136
     C                     MOVEL'PURCHASE'NARR1                           S01136
     C*                                                                   S01136
     C** OBTAIN BUY/SELL CURRENCY AND AMOUNT.                             S01136
     C                     EXSR ZA0670                                    S01136
     C*                                                                   S01136
     C** ACCESS*CURRENCY*TABLE*                                           S01136
      * ACCESS CURRENCY DETAILS VIA ACCESS PGM
     C                     MOVE @@DBCC    SSCCY   3                       S01136
     C******               EXSR ZA0300                                    S01136
     C*                                                                   S01136
     C                     CALL 'AOCURRR0'                                S01194
     C                     PARM '*MSG    '@RTCD                           S01194
     C                     PARM '*KEY    '@OPTN                           S01194
     C                     PARM SSCCY     @AJCD   3                       S01194
     C           @CURR     PARM @CURR     DSSDY                           S01194
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVEL'SDCURRPD'DBFILE            ************* S01194
     C                     MOVEL@OPTN     DBOPTN            * DBERR 012*  S01194
     C                     MOVELSSCCY     DBKEY             ************* S01194
     C                     MOVEL'012'     DBASE                           S01194
     C                     EXSR *PSSR                                     S01194
     C                     SETON                     U7U8LR               S01194
     C                     GOTO #B9                                       S01194
     C                     END                                            S01194
     C*                                                                   S01136
     C*****      *INU7     CABEQ'1'       #B9                      S01136 S01194
     C*                                                                   S01136
     C** IF FEDERAL FUNDS INDICATOR ON AND CURRENCY EQUAL US CURRENCY     S01136
     C           FHFEDF    IFEQ 'Y'                        B1             S01136
     C*****      @@DBCC    IFEQ USCY                       B*2     S01136 S01194
     C           @@DBCC    IFEQ BLCYCD                     B*2            S01194
     C                     MOVE 'F'       FFIN             **2            S01136
     C                     END                             E*2            S01136
     C                     END                             E1             S01136
     C*                                                                   S01136
     C*                                                                   S01136
     C** FORMAT THE PURCHASE AMOUNT                                       S01136
     C                     MOVE @@DBCC    @@CCY                           S01136
     C*****                Z-ADDCDP       @@CDP                    S01136 S01194
     C                     Z-ADDA6NBDP    @@CDP                           S01194
     C                     Z-ADD@@DBAM    @@IAMT                          S01136
     C                     Z-ADD16        @@CRET                          S01136
     C                     EXSR ZA0750                                    S01136
     C**********           MOVE @@ADSP    AMT1W                     S01136BHF486
     C                     MOVE @@ADSP    AMT1W  17                       BHF486
     C*                                                                   S01136
     C                     MOVE FHDADN    RDNO                            S01136
     C*                                                                   S01136
     C           #B9       ENDSR                                          S01136
     C*****************************************************************   S01136
     C/EJECT                                                              S01136
     C*****************************************************************   S01136
     C*                                                               *   S01136
     C**#C**********-**FORMAT*MMDELDP0*OR*MMDELDP1*FOR*LINE01******S01136 E20251
     C* #C          -  FORMAT MMDELDP0 OR FOR LINE01                  *   E20251
     C*                                                               *   S01136
     C* CALLS                                                         *   S01136
     C*                                                               *   S01136
     C* CALLED BY   -                                                 *   S01136
     C*                                                               *   S01136
     C* FLDS USED                                                     *   S01136
     C*                                                               *   S01136
     C*****************************************************************   S01136
     C           #C        BEGSR                                          S01136
     C*                                                                   S01136
     C** FORMAT FOR LOANS/DEPOSIT/CD ISSUE?                               S01136
     C*                                                                   S01136
     C**   DEAL TYPE TEXT                                                 S01136
     C******************** MOVELHKTYPE    DTYPW                    S01136 E20251
     C                     MOVELHKMTYP    DTYPW                           E20251
     C                     MOVEL'-'       STWK                            S01136
     C                     MOVE HKSTYP    STWK                            S01136
     C                     MOVE STWK      DTYPW                           S01136
     C                     MOVE HKCLAS    CLASW                           CDL038
     C                     MOVE HKDN38    DLNO                            S01136
     C*                                                                   S01136
     C** FORMAT THE DATES                                                 S01136
     C                     EXSR #K                                        S01136
     C                     MOVEL@MDT      NARR1                           S01136
     C                     MOVE HKCCY     CCY                             S01136
     C*                                                                   S01136
     C** IF FEDERAL FUNDS INDICATOR ON AND CURRENCY EQUAL US CURRENCY     S01136
     C           HKFEDF    IFEQ 'Y'                        B1             S01136
     C*****      CCY       IFEQ USCY                       B*2     S01136 S01194
     C           CCY       IFEQ BLCYCD                     B*2            S01194
     C                     MOVE 'F'       FFIN             **2            S01136
     C                     END                             E*2            S01136
     C                     END                             E1             S01136
     C*                                                                   S01136
     C** TAKE LDI AMOUNT AND EDIT.                                        S01136
     C                     Z-ADDHKAMNP    @@IAMT 150                      S01136
     C                     MOVE HKCCY     @@CCY   3                       S01136
     C                     Z-ADD16        @@CRET  20                      S01136
     C                     Z-ADDHKCYDP    @@CDP   10                      S01136
     C                     EXSR ZA0750                                    S01136
     C                     MOVE @@ADSP    AMT1W                           S01136
     C*                                                                   S01136
     C** SET ASSOCIATED DEAL NUMBER                                       S01136
     C                     MOVELHKDADN    RDNO                            S01136
     C*                                                                   S01136
     C*                                                                   S01136
     C           #C9       ENDSR                                          S01136
     C*****************************************************************   S01136
     C/EJECT                                                              S01136
     C*****************************************************************   S01136
     C*                                                               *   S01136
     C**#D**********-**FORMAT*MMDENBP0*OR*MMDENBP1*FOR*LINE01******S01136 E20251
     C* #D          -  FORMAT MMDENBP0 FOR LINE01                     *   E20251
     C*                                                               *   S01136
     C* CALLS                                                         *   S01136
     C*                                                               *   S01136
     C* CALLED BY   -                                                 *   S01136
     C*                                                               *   S01136
     C* FLDS USED                                                     *   S01136
     C*                                                               *   S01136
     C*****************************************************************   S01136
     C           #D        BEGSR                                          S01136
     C*                                                                   S01136
     C**   DEAL TYPE TEXT                                                 S01136
     C******************** MOVELHLTYPE    DTYPW                    S01136 E20251
     C                     MOVELHLMTYP    DTYPW                           E20251
     C                     MOVEL'-'       STWK                            S01136
     C                     MOVE HLSTYP    STWK                            S01136
     C                     MOVE STWK      DTYPW                           S01136
     C                     MOVE HLCLAS    CLASW                           CDL038
     C                     MOVE HLDN38    DLNO                            S01136
     C*                                                                   S01136
     C** FORMAT ASSOCIATED DATES                                          S01136
     C                     EXSR #K                                        S01136
     C                     MOVEL@MDT      NARR1                           S01136
     C                     MOVE HLCCY     CCY                             S01136
     C*                                                                   S01136
     C** IF FEDERAL FUNDS INDICATOR ON AND CURRENCY EQUAL US CURRENCY     S01136
     C           HLFEDF    IFEQ 'Y'                        B1             S01136
     C*****      CCY       IFEQ USCY                       B*2     S01136 S01194
     C           CCY       IFEQ BLCYCD                     B*2            S01194
     C                     MOVE 'F'       FFIN             **2            S01136
     C                     END                             E*2            S01136
     C                     END                             E1             S01136
     C*                                                                   S01136
     C** TAKE NAB AMOUNT AND EDIT.                                        S01136
     C                     MOVE HLAMNP    @@IAMT 150                      S01136
     C                     MOVE HLCCY     @@CCY   3                       S01136
     C                     Z-ADD16        @@CRET  20                      S01136
     C                     MOVE HLCYDP    @@CDP   10                      S01136
     C                     EXSR ZA0750                                    S01136
     C                     MOVE @@ADSP    AMT1W                           S01136
     C*                                                                   S01136
     C** SET ASSOCIATED DEAL NUMBER                                       S01136
     C                     MOVELHLDADN    RDNO                            S01136
     C*                                                                   S01136
     C           #D9       ENDSR                                          S01136
     C*****************************************************************   S01136
     C/EJECT                                                              S01136
     C*****************************************************************   S01136
     C*                                                               *   S01136
     C**#E**********-**FORMAT*MMDENSP0*OR*MMDENSP1*FOR*LINE01******S01136 E20251
     C* #E          -  FORMAT MMDENSP0 OR FOR LINE01                  *   E20251
     C*                                                               *   S01136
     C* CALLS                                                         *   S01136
     C*                                                               *   S01136
     C* CALLED BY   -  LINE01                                         *   S01136
     C*                                                               *   S01136
     C* FLDS USED                                                     *   S01136
     C*                                                               *   S01136
     C*****************************************************************   S01136
     C           #E        BEGSR                                          S01136
     C*                                                                   S01136
     C**   DEAL TYPE TEXT                                                 S01136
     C******************** MOVELHMTYPE    DTYPW                    S01136 E20251
     C                     MOVELHMMTYP    DTYPW                           E20251
     C                     MOVEL'-'       STWK                            S01136
     C                     MOVE HMSTYP    STWK                            S01136
     C                     MOVE STWK      DTYPW                           S01136
     C                     MOVE HMCLAS    CLASW                           CDL038
     C                     MOVE HMDN38    DLNO                            S01136
     C*                                                                   S01136
     C** FORMAT ASSOCIATED DATES                                          S01136
     C                     EXSR #K                                        S01136
     C                     MOVEL@MDT      NARR1                           S01136
     C                     MOVE HMCCY     CCY                             S01136
     C*                                                                   S01136
     C** IF FEDERAL FUNDS INDICATOR ON AND CURRENCY EQUAL US CURRENCY     S01136
     C           HMFEDF    IFEQ 'Y'                        B1             S01136
     C*****      CCY       IFEQ USCY                       B*2     S01136 S01194
     C           CCY       IFEQ BLCYCD                     B*2            S01194
     C                     MOVE 'F'       FFIN             **2            S01136
     C                     END                             E*2            S01136
     C                     END                             E1             S01136
     C*                                                                   S01136
     C** TAKE NAS AMOUNT AND EDIT.                                        S01136
     C                     Z-ADDHMAMNP    @@IAMT                          S01136
     C                     MOVE HMCCY     @@CCY                           S01136
     C                     Z-ADD16        @@CRET                          S01136
     C                     Z-ADDHMCYDP    @@CDP                           S01136
     C                     EXSR ZA0750                                    S01136
     C                     MOVE @@ADSP    AMT1W                           S01136
     C*                                                                   S01136
     C** SET ASSOCIATED DEAL NUMBER                                       S01136
     C                     MOVE HMDADN    RDNO                            S01136
     C*                                                                   S01136
     C           #E9       ENDSR                                          S01136
     C*****************************************************************   S01136
     C/EJECT                                                              S01136
     C*****************************************************************   S01136
     C*                                                               *   S01136
     C**#F**********-**FORMAT*FXDEALP0*OR*FXDEALP1**FOR*LINE02*****S01136 E20251
     C* #F          -  FORMAT FXDEALP0 OR FOR LINE02                  *   E20251
     C*                                                               *   S01136
     C* CALLS                                                         *   S01136
     C*                                                               *   S01136
     C* CALLED BY   -                                                 *   S01136
     C*                                                               *   S01136
     C* FLDS USED                                                     *   S01136
     C*                                                               *   S01136
     C*****************************************************************   S01136
     C           #F        BEGSR                                          S01136
     C*                                                                   S01136
     C** SET UP DEAL STATUS INDICATORS                                    S01136
     C                     EXSR #J                                        S01136
     C*                                                                   S01136
     C** CHECK DEAL TYPE FOR F-X.IS IT AN OPTION...?                      S01136
     C           FHTYPE    IFEQ 'OP'                       B1             S01136
     C                     MOVEATXT,1     LIN,27           *1             S01136
     C*                                                                   S01136
     C** FORMAT OPTION TO DATE                                            S01136
     C                     Z-ADD@ODAT     @@DTIN           *1             S01136
     C                     EXSR ZA0660                     *1             S01136
     C                     MOVEA@@DATE    LIN,38           *1             S01136
     C*                                                                   S01136
     C                     END                             E1             S01136
     C*                                                                   S01136
     C** SET UP FIELD FOR THE DISPLAY.                                    S01136
     C                     MOVEATXT,2     LIN,54                          S01136
     C                     MOVEA@@DSCC    LIN,63                          S01136
     C*                                                                   S01136
     C** IF FEDERAL FUNDS INDICATOR ON AND CURRENCY EQUAL US CURRENCY     S01136
     C           FHFEDF    IFEQ 'Y'                        B1             S01136
     C*****      @@DSCC    IFEQ USCY                       B*2     S01136 S01194
     C           @@DSCC    IFEQ BLCYCD                     B*2            S01194
     C                     MOVEA'F'       LIN,72           **2            S01136
     C                     END                             E*2            S01136
     C                     END                             E1             S01136
     C*                                                                   S01136
     C***ACCESS*CURRENCY*TABLE                                            S01136
     C                     MOVE @@DSCC    SSCCY   3                       S01136
     C*****                EXSR ZA0300                             S01136 S01194
     C*                                                                   S01136
      * ACCESS CURRENCY DETAILS VIA ACCESS PGM
     C*                                                                   S01136
     C                     CALL 'AOCURRR0'                                S01194
     C                     PARM '*MSG    '@RTCD                           S01194
     C                     PARM '*KEY    '@OPTN                           S01194
     C                     PARM SSCCY     @AJCD   3                       S01194
     C           @CURR     PARM @CURR     DSSDY                           S01194
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVEL'SDCURRPD'DBFILE            ************* S01194
     C                     MOVEL@OPTN     DBOPTN            * DBERR 016   S01194
     C                     MOVELSSCCY     DBKEY             ************* S01194
     C                     MOVEL'016'     DBASE                           S01194
     C                     EXSR *PSSR                                     S01194
     C                     SETON                     U7U8LR               S01194
     C                     GOTO #F9                                       S01194
     C                     END                                            S01194
     C*                                                                   S01136
     C*****      *INU7     CABEQ'1'       #F9                      S01136 S01194
     C*                                                                   S01136
     C*                                                                   S01136
     C*                                                                   S01136
     C** FORMAT THE PURCHASE AMOUNT                                       S01136
     C                     MOVE @@DSCC    @@CCY                           S01136
     C*****                Z-ADDCDP       @@CDP                    S01136 S01194
     C                     Z-ADDA6NBDP    @@CDP                           S01194
     C                     Z-ADD@@DSAM    @@IAMT                          S01136
     C                     Z-ADD16        @@CRET                          S01136
     C                     EXSR ZA0750                                    S01136
     C*                                                                   S01136
     C** @@ADSP  21A FIELD IS MOVED IN TO  SLAMWF 17A FIELD               S01136
     C** AS SALE AMOUNT DOESN'T ALIGN WITH PURCHASE AMOUNT                S01136
0725 C*****************    MOVE @@ADSP    SLAMWF                    S01136BHF486
     C                     MOVE @@ADSP    SLAMWF 17                       BHF486
     C                     MOVEASLAMWF    LIN,82                          S01136
     C*                                                                   S01136
     C** MOVE PURCHASE CURRENCY IN TO PRINT FIELD                         S01136
     C************         MOVE @@DBCC    CCY                       S01136BHF486
     C                     MOVE @@DBCC    CCY     3                       BHF486
     C*                                                                   S01136
     C           #F9       ENDSR                                          S01136
     C*****************************************************************   S01136
     C/EJECT                                                              S01136
     C*****************************************************************   S01136
     C*                                                               *   S01136
     C**#G**********-**FORMAT*MMDELDP0*OR*MMDELDP1*FOR*LINE02******S01136 E20251
     C* #G          -  FORMAT MMDELDP0 FOR LINE02                     *   E20251
     C*                                                               *   S01136
     C* CALLS                                                         *   S01136
     C*                                                               *   S01136
     C* CALLED BY   -                                                 *   S01136
     C*                                                               *   S01136
     C* FLDS USED                                                     *   S01136
     C*                                                               *   S01136
     C*****************************************************************   S01136
     C           #G        BEGSR                                          S01136
     C*                                                                   S01136
     C** FORMAT FOR LOANS/DEPOSIT/CD ISSUE?                               S01136
     C*                                                                   S01136
     C** SET UP DEAL STATUS INDICATORS
     C                     EXSR #J                                        S01136
     C*                                                                   S01136
     C** FORMAT BASE RATE FIELD                                           S01136
     C                     MOVEATXT,3     LIN,27                          S01136
     C*                                                                   S01136
     C** FORMAT THE INTEREST RATE/SPREAD                                  S01136
     C                     MOVEATXT,4     LIN,52                          S01136
     C           HKBSRC    IFEQ *BLANKS                    B1             S01136
     C           HKBSRC    OREQ '00'                       *1             E27537
     C                     MOVEA'00'      LIN,39           *1             S01136
     C**********           MOVE HKIIRT    @@INPR           *1                          S01136 261960
     C                     MOVE HKINTR    @@INPR           *1                                 261960
     C                     EXSR MM1013                     *1             S01136
     C                     MOVEA@@OUTR    LIN,87           *1             S01136
     C*                                                                   S01136
     C                     ELSE                            X1             S01136
     C                     MOVEAHKBSRC    LIN,39           *1             S01136
     C                     MOVE HKSPRD    @@INPR           *1             S01136
     C                     EXSR MM1013                     *1             S01136
     C                     MOVEA@@OUTR    LIN,87           *1             S01136
     C                     END                             E1             S01136
     C*                                                                   S01136
     C           #G9       ENDSR                                          S01136
     C*****************************************************************   S01136
     C/EJECT                                                              S01378
     C*****************************************************************   S01378
     C*                                                               *   S01378
     C* PFMT        -  Format 5,0 field to a 5A field with            *   S01378
     C*                leading zeros suppressed                       *   S01378
     C* CALLS                                                         *   S01378
     C*                                                               *   S01378
     C* CALLED BY   -                                                 *   S01378
     C*                                                               *   S01378
     C* FLDS USED                                                     *   S01378
     C*                                                               *   S01378
     C*****************************************************************   S01378
     C           PFMT      BEGSR                                          S01378
      *                                                                   S01378
      ** reset work fields                                                S01378
     C                     MOVE *BLANKS   @OUT                            S01378
     C                     Z-ADD*ZERO     J                               S01378
      *                                                                   S01378
      ** transfer numeric input field to character array                  S01378
     C           *LIKE     DEFN PSZE      @INNUM                          S01378
     C                     MOVE @INNUM    @INCHR  5                       S01378
     C                     MOVEA@INCHR    @IN                             S01378
      *                                                                   S01378
      ** work through field looking for first non zero character          S01378
     C           J         DOUEQ5                          B1             S01378
     C                     ADD  1         J                *1             S01378
      *                                                                   S01378
      ** once first non zero character is found fill up @OUT and exit     S01378
     C           @IN,J     IFNE '0'                        B*2            S01378
     C                     MOVEA@IN,J     @OUT,J           **2            S01378
     C                     Z-ADD5         J                **2            S01378
     C                     END                             E*2            S01378
     C                     END                             E1             S01378
     C                     MOVEA@OUT      @OUTCR  5                       S01378
      *                                                                   S01378
     C                     ENDSR                                          S01378
     C*****************************************************************   S01378
     C/EJECT                                                              S01136
     C*****************************************************************   S01136
     C*                                                               *   S01136
     C**#H**********-**FORMAT*MMDENBP0*OR*MMDENBP1*LINE*02*********S01136 E20251
     C* #H          -  FORMAT MMDENBP0 LINE 02                        *   E20251
     C*                                                               *   S01136
     C* CALLS                                                         *   S01136
     C*                                                               *   S01136
     C* CALLED BY   -                                                 *   S01136
     C*                                                               *   S01136
     C* FLDS USED                                                     *   S01136
     C*                                                               *   S01136
     C*****************************************************************   S01136
     C           #H        BEGSR                                          S01136
     C*                                                                   S01136
     C** SET UP DEAL STATUS INDICATORS          .                         S01136
     C                     EXSR #J                                        S01136
     C*                                                                   S01136
     C** FORMAT THE YIELD.                                                S01136
     C                     MOVEATXT,5     LIN,27                          S01136
     C                     MOVE HLINTR    @@INPR                          S01136
     C                     EXSR MM1013                                    S01136
     C                     MOVEA@@OUTR    LIN,33                          S01136
     C*                                                                   S01136
     C** FORMAT THE INTEREST RATE/SPREAD.                                 S01136
     C                     MOVEATXT,4     LIN,52                          S01136
     C                     MOVE HLFRAT    @@INPR                          S01136
     C                     EXSR MM1013                                    S01136
     C                     MOVEA@@OUTR    LIN,87                          S01136
     C*                                                                   S01378
     C** If parcelled NA set up parcel fields                             S01378
     C           HLPCLI    IFEQ 'P'                                       S01378
     C                     Z-ADD102       I                               S01378
     C                     MOVEATXT,6     LIN,I                           S01378
     C                     Z-ADDHLPSZE    @INNUM                          S01378
     C                     EXSR PFMT                                      S01378
     C                     Z-ADD107       I                               S01378
     C                     MOVEA@OUTCR    LIN,I                           S01378
     C*                                                                   S01378
     C** If not parcelled must blank out parcelling bit of LIN            S01378
     C                     ELSE                                           S01378
     C                     Z-ADD108       I                               S01378
     C                     MOVEA*BLANKS   LIN,I                           S01378
     C                     END                                            S01378
     C*                                                                   S01136
     C           #H9       ENDSR                                          S01136
     C*****************************************************************   S01136
     C/EJECT                                                              S01136
     C*****************************************************************   S01136
     C*                                                               *   S01136
     C**#I**********-**FORMAT*MMDENSP0*OR*MMDENSP1*****************S01136 E20251
     C* #I          -  FORMAT MMDENSP0                                *   E20251
     C*                                                               *   S01136
     C* CALLS                                                         *   S01136
     C*                                                               *   S01136
     C* CALLED BY   -  LINE01                                         *   S01136
     C*                                                               *   S01136
     C* FLDS USED                                                     *   S01136
     C*                                                               *   S01136
     C*****************************************************************   S01136
     C           #I        BEGSR                                          S01136
     C*                                                                   S01136
     C** SET UP DEAL STATUS INDICATORS                                    S01136
     C                     EXSR #J                                        S01136
     C*                                                                   S01136
     C** FORMAT THE YIELD.                                                S01136
     C                     MOVEATXT,5     LIN,27                          S01136
     C                     MOVE HMINTR    @@INPR                          S01136
     C                     EXSR MM1013                                    S01136
     C                     MOVEA@@OUTR    LIN,33                          S01136
     C*                                                                   S01378
     C** If parcelled NA set up parcelling fields                         S01378
     C           HMPCLI    IFEQ 'P'                                       S01378
     C                     Z-ADD102       I                               S01378
     C                     MOVEATXT,6     LIN,I                           S01378
     C                     Z-ADDHMPSZE    @INNUM                          S01378
     C                     EXSR PFMT                                      S01378
     C                     Z-ADD107       I                               S01378
     C                     MOVEA@OUTCR    LIN,I                           S01378
     C*                                                                   S01378
     C** If not parcelled must blank out parcelling bit of LIN            S01378
     C                     ELSE                                           S01378
     C                     Z-ADD108       I                               S01378
     C                     MOVEA*BLANKS   LIN,I                           S01378
     C                     END                                            S01378
     C*                                                                   S01136
     C           #I9       ENDSR                                          S01136
     C*****************************************************************   S01136
     C/EJECT                                                              S01136
     C*****************************************************************   S01136
     C*                                                               *   S01136
     C* #K          - FORMATING OF DEAL DONE AND VALUE DATE           *   S01136
     C*                                                               *   S01136
     C* CALLS       - ZA0660                                          *   S01136
     C*                                                               *   S01136
     C* CALLED BY   - #B                                              *   S01136
     C*             - #C                                              *   S01136
     C*             - #D                                              *   S01136
     C*             - #E                                              *   S01136
     C*                                                               *   S01136
     C* FLDS USED   @VDAT   - VALUE DATE                              *   S01136
     C*             @DDAT   - DEAL DONE DATE                          *   S01136
     C*             @MDAT   - MATURITY DATE                           *   S01136
     C*             @@DTIN  - INPUT DATE TO ZA0660                    *   S01136
     C*             @@DATE  - OUTPUT DATE FROM ZA0660                 *   S01136
     C*             DDATE   - DEAL DONE DATE                          *   S01136
     C*             VDATE   - VALUE DATE                              *   S01136
     C*             ODATE   - OPTION TO DATE                          *   S01136
     C*                                                               *   S01136
     C*****************************************************************   S01136
     C           #K        BEGSR                                          S01136
     C*                                                                   S01136
     C** FORMAT DEAL VALUE AND DEAL DONE DATE.                            S01136
     C                     MOVE @VDAT     @@DTIN                          S01136
     C                     EXSR ZA0660                                    S01136
     C*****************    MOVE @@DATE    VDATE                     S01136BHF486
     C                     MOVE @@DATE    VDATE   7                       BHF486
     C*                                                                   S01136
     C                     MOVE @DDAT     @@DTIN                          S01136
     C                     EXSR ZA0660                                    S01136
     C**************       MOVE @@DATE    DDATE                     S01136BHF486
     C                     MOVE @@DATE    DDATE   7                       BHF486
     C*                                                                   S01136
     C           @INDS     IFEQ 'MMDELDP0'                 B1             S01136
     C/COPY WNCPYSRC,DLH00251
     C           @INDS     OREQ 'MMDENBP0'                 X1             S01136
     C/COPY WNCPYSRC,DLH00252
     C*********  @INDS     OREQ 'MMDELDP1'                 X1       S01136BHF486
     C*********  @INDS     OREQ 'MMDENBP1'                 X1       S01136BHF486
     C*                                                                   S01136
     C           @MDAT     IFNE *ZEROS                     B*2            S01136
     C                     MOVE @MDAT     @@DTIN           **2            S01136
     C                     EXSR ZA0660                     **2            S01136
     C                     MOVE @@DATE    @MDT    7        **2            S01136
     C                     ELSE                            X*2            S01136
     C*                                                                   S01136
     C           @INDS     IFEQ 'MMDELDP0'                 B**3           S01136
     C/COPY WNCPYSRC,DLH00253
     C********** @INDS     OREQ 'MMDELDP1'                 X**3     S01136BHF486
     C*                                                                   S01136
     C           HKNTCE    IFEQ 000                        B***4          S01136
     C                     MOVE ' CALL  ' @MDT             ****4          S01136
     C                     ELSE                            X***4          S01136
     C                     MOVE *BLANKS   @MDT                            068210
     C                     MOVE HKNTCE    @MDT             ****4          S01136
     C                     END                             E***4          S01136
     C*                                                                   S01136
     C                     ELSE                            X**3           S01136
     C*                                                                   S01136
     C                     MOVE ' CALL  ' @MDT             ***3           S01136
     C*                                                                   S01136
     C                     END                             E**3           S01136
     C*                                                                   S01136
     C                     END                             E*2            S01136
     C*                                                                   S01136
     C                     END                             E1             S01136
     C*                                                                   S01136
     C           #K9       ENDSR                                          S01136
     C****************************************************************    S01136
     C/EJECT                                                              S01136
     C*****************************************************************   S01136
     C*                                                               *   S01136
     C* #J          - SET UP DEAL STATUS                              *   S01136
     C*                                                               *   S01136
     C* CALLS       -                                                 *   S01136
     C*                                                               *   S01136
     C* CALLED BY   - #F                                              *   S01136
     C*             - #G                                              *   S01136
     C*             - #H                                              *   S01136
     C*             - #I                                              *   S01136
     C*                                                               *   S01136
     C* FLDS USED   TEXT    - DISPLAY FIELD                           *   S01136
     C*             @FEDF   - FEDERAL FUND WORK FIELD                 *   S01136
     C*                                                               *   S01136
     C*****************************************************************   S01136
     C           #J        BEGSR                                          S01136
     C*                                                                   S01136
     C** CHECK IF DEAL HAS BEEN DELETED                                   S01136
     C           DLREC     IFEQ 'D'                        B1             S01136
     C                     MOVE 'DELETED 'TEXT             *1             S01136
     C                     ELSE                            X1             S01136
     C*                                                                   S01136
     C** SET UP DEAL STATUS INDICATORS                                    S01136
     C           DLSTS     LOKUPTABA      TABB           56               S01136
     C           *IN56     IFEQ '1'                        B1             S01136
     C                     MOVE TABB      TEXT             *1             S01136
     C                     END                             E*2            S01136
     C                     END                             E1             S01136
     C*                                                                   S01136
     C                     MOVEATEXT      LIN,15                          S01136
     C*                                                                   S01136
     C           #J9       ENDSR                                          S01136
     C*****************************************************************   S01136
     C/EJECT                                                              S01136
     C*****************************************************************   S01136
     C*                                                               *   S01136
     C*       SUBROUTINE ZA0670 - THIS SUBROUTINE IS USED TO FIND     *   S01136
     C*       WHICH CCY AND WHICH AMOUNT IS BUY AND WHICH IS SELL.    *   S01136
     C*                                                               *   S01136
     C*       IF DEAL FIRST AMOUNT IS >0 THEN FIRST IS BUY            *   S01136
     C*       ELSE FIRST IS SELL.                                     *   S01136
     C*                                                               *   S01136
     C*                                                               *   S01136
     C*       CALLED BY: #B                                           *   S01136
     C*                : #C                                           *   S01136
     C*                : #D                                           *   S01136
     C*                : #E                                           *   S01136
     C*                                                               *   S01136
     C*       CALLS:                                                  *   S01136
     C*       INPUT: FHDAM1 - DEAL FIRST AMOUNT                       *   S01136
     C*              FHDAM2 - DEAL SECOND AMOUNT                      *   S01136
     C*              FHCCY1 - DEAL FIRST CURRENCY                     *   S01136
     C*              FHCCY2 - DEAL SECOND CURRENCY                    *   S01136
     C*      OUTPUT: @@DBAM - DEAL BUY AMOUNT                         *   S01136
     C*              @@DSAM - DEAL SELL AMOUNT                        *   S01136
     C*              @@DBCC - DEAL BUY CURRENCY                       *   S01136
     C*              @@DSCC - DEAL SELL CURRENCY                      *   S01136
     C*        USES:                                                  *   S01136
     C*                                                               *   S01136
     C*****************************************************************   S01136
     C*                                                                   S01136
     C*                                                                   S01136
     C           ZA0670    BEGSR                                          S01136
     C           FHDAM1    IFGT 0                                         S01136
     C                     Z-ADDFHDAM1    @@DBAM 150                      S01136
     C                     MOVE FHCCY1    @@DBCC  3                       S01136
     C                     Z-SUBFHDAM2    @@DSAM 150                      S01136
     C                     MOVE FHCCY2    @@DSCC  3                       S01136
     C                     ELSE                                           S01136
     C                     Z-SUBFHDAM1    @@DSAM                          S01136
     C                     MOVE FHCCY1    @@DSCC                          S01136
     C                     Z-ADDFHDAM2    @@DBAM                          S01136
     C                     MOVE FHCCY2    @@DBCC                          S01136
     C                     END                                            S01136
     C*                                                                   S01136
     C           ZA0679    ENDSR                                          S01136
     C*****************************************************************   S01136
     C/EJECT                                                              S01136
     C****************************************************************    S01136
     C*                                                              *    S01136
     C*                                                              *    S01136
     C*     MIDAS/DRS - STANDING DATA MODULE                         *    S01136
     C*                                                              *    S01136
     C*     ZA0750 -  CONVERT AMOUNT TO DISPLAY -38                  *    S01136
     C*                                                              *    S01136
     C*     AMEND NO. 000001                  DATE   04/07/86        *    S01136
     C*                                                              *    S01136
     C*       CALLED BY: #B                                          *    S01136
     C*                : #C                                           *   S01136
     C*                : #D                                           *   S01136
     C*                : #E                                           *   S01136
     C*                                                              *    S01136
     C*       CALLS:                                                 *    S01136
     C*                                                              *    S01136
     C*       INPUT: @@IAMT 15,0 (INPUT AMOUNT)                      *    S01136
     C*              @@CCY  3A   (INPUT CURRENCY)                    *    S01136
     C*              @@CRET 2,0  (NUMBER OF CHARACTERS TO RETURN)    *    S01136
     C*              @@CDP  1,0  (CURRENCY DECIMAL PLACES)           *    S01136
     C*                                                              *    S01136
     C*      OUTPUT: @@ADSP 21A    (AMOUNT TO DISPLAY)               *    S01136
     C*                                                              *    S01136
     C*        USES:                                                 *    S01136
     C*                                                              *    S01136
     C****************************************************************    S01136
     C*                                                                   S01136
     C           ZA0750    BEGSR                                          S01136
     C*                                                                   S01136
     C*          INITIALISE ARRAYS                                        S01136
     C*                                                                   S01136
     C                     MOVEA*BLANKS   @E                              S01136
     C                     MOVEA*BLANKS   @C                              S01136
     C*                                                                   S01136
     C*          MOVE SIGN TO DISPLAY AMOUNT                              S01136
     C*                                                                   S01136
     C           @@IAMT    IFGT 0                          B1             S01136
     C                     MOVE '+'       @E,21            *1             S01136
     C                     END                             E1             S01136
     C*                                                                   S01136
     C*          AFTER '-' SIGN PLACED IN  @E CHANGE @@IAMT TO +VE        S01136
     C*                                                                   S01136
     C           @@IAMT    IFLT 0                          B1             S01136
     C                     MOVE '-'       @E,21            *1             S01136
     C                     Z-SUB@@IAMT    @@IAMT           *1             S01136
     C                     END                             E1             S01136
     C*                                                                   S01136
     C           @@IAMT    IFEQ 0                          B1             S01136
     C                     MOVE ' '       @E,21            *1             S01136
     C                     END                             E1             S01136
     C*                                                                   S01136
     C*          MOVE INPUT AMOUNT TO @D                                  S01136
     C*                                                                   S01136
     C                     MOVEA@@AMDS    @D                              S01136
     C*                                                                   S01136
     C*          MOVE DECIMAL PORTION OF AMOUNT TO @E                     S01136
     C*                                                                   S01136
     C                     Z-ADD15        @@C     20                      S01136
     C                     Z-ADD20        @@D     20                      S01136
     C*                                                                   S01136
     C           20        SUB  @@CDP     @@MAX   20                      S01136
     C           @@D       DOWGT@@MAX                      B1             S01136
     C                     MOVE @D,@@C    @E,@@D           *1             S01136
     C                     SUB  1         @@C              *1             S01136
     C                     SUB  1         @@D              *1             S01136
     C                     END                             E1             S01136
     C*                                                                   S01136
     C*          MOVE DECIMAL SEPARATOR TO @E                             S01136
     C*                                                                   S01136
     C           @@CDP     IFNE 0                          B1             S01136
     C*********************MOVE*IDDCSP****@E,@@D************1*******S01136S01319
     C                     MOVE BNDCSP    @E,@@D           *1             S01319
     C                     SUB  1         @@D              *1             S01136
     C                     END                             E1             S01136
     C*                                                                   S01136
     C*          FIND POSITION OF LAST CHARACTER TO BE MOVED              S01136
     C*                                                                   S01136
     C                     Z-ADD1         @@E     20                      S01136
     C*                                                                   S01136
     C           @@E       DOWLT15                         B1             S01136
     C           @D,@@E    ANDEQ'0'                        *1             S01136
     C                     ADD  1         @@E              *1             S01136
     C                     END                             E1             S01136
     C*                                                                   S01136
     C*          MOVE INTEGER PORTION OF AMOUNT TO @E                     S01136
     C*                                                                   S01136
     C                     Z-ADD0         @@CNT1  20                      S01136
     C                     Z-ADD0         @@CNT2  20                      S01136
     C*                                                                   S01136
     C           @@C       DOWGT@@E                        B1             S01136
     C                     MOVE @D,@@C    @E,@@D           *1             S01136
     C                     ADD  1         @@CNT1           *1             S01136
     C                     SUB  1         @@C              *1             S01136
     C                     SUB  1         @@D              *1             S01136
     C*                                                                   S01136
     C*          INSERT THOUSAND SEPARATORS                               S01136
     C*                                                                   S01136
     C           @@CNT1    DIV  3         @@RES   20       *1             S01136
     C                     MVR            @@REMD  10       *1             S01136
     C           @@REMD    IFEQ 0                          B*2            S01136
     C           @@CNT2    ANDLT5                          **2            S01136
     C*********************MOVE*IDTHSP****@E,@@D*************2******S01136S01319
     C                     MOVE BNTHSP    @E,@@D           **2            S01319
     C                     ADD  1         @@CNT2           **2            S01136
     C                     Z-ADD@@D       @@F     20       **2            S01136
     C                     SUB  1         @@D              **2            S01136
     C                     END                             E*2            S01136
     C                     END                             E1             S01136
     C*                                                                   S01136
     C*          MOVE LAST CHARACTER                                      S01136
     C*                                                                   S01136
     C                     MOVE @D,@@C    @E,@@D                          S01136
     C*                                                                   S01136
     C*          IF NUMBER OF CHARACTERS MOVED IS GREATER THAN NUMBER     S01136
     C*        TO BE RETURNED DROP THOUSAND SEPARATORS TILL SATISFIED     S01136
     C*                                                                   S01136
     C           22        SUB  @@D       @@CMOV  20                      S01136
     C           @@CMOV    SUB  @@CRET    @@DIFF  20                      S01136
     C           @@DIFF    IFGT 0                          B1             S01136
     C                     DO   @@DIFF                     B*2            S01136
     C                     Z-ADD1         @@G     20       **2            S01136
     C                     Z-ADD2         @@H     20       **2            S01136
     C           @@G       DOWLE21                         B**3           S01136
     C                     MOVE @E,@@G    @C,@@H           ***3           S01136
     C                     ADD  1         @@G              ***3           S01136
     C                     ADD  1         @@H              ***3           S01136
     C           @@G       IFEQ @@F                        B***4          S01136
     C                     ADD  1         @@G              ****4          S01136
     C                     END                             E***4          S01136
     C                     END                             E**3           S01136
     C                     MOVEA@C        @E               **2            S01136
     C                     ADD  4         @@F              **2            S01136
     C                     END                             E*2            S01136
     C                     END                             E1             S01136
     C*                                                                   S01136
     C*          MOVE @E TO DISPLAY FIELD                                 S01136
     C*                                                                   S01136
     C                     MOVEA@E        @@ADSP 21                       S01136
     C           ZA0759    ENDSR                                          S01136
     C*****************************************************************   S01136
     C/EJECT                                                              S01136
     C*****************************************************************   S01136
     C*****                                                        S01136 S01194
     C*****   SUBROUTINE ZA0300 - THIS SUBROUTINE CHAINS THE       S01136 S01194
     C*****   CURRENCIES TABLE FILE LF/FDCCYDLL FOR CURRENCY DETAILS01136 S01194
     C*****   INDICATOR 80 IS SET ON IF THE RECORD IS NOT PRESENT OS01136 S01194
     C*****   IS FLAGGED FOR DELETION.                             S01136 S01194
     C*****   IF INDICATOR IS SET ON INFORMATION ABOUT THE NATURE  S01136 S01194
     C*****   OF THE ATTEMPTED FILE ACCESS WILL BE PLACED IN THE LDS01136 S01194
     C*****                                                        S01136 S01194
     C*****   CALLS       -                                        S01136 S01194
     C*****                                                        S01136 S01194
     C*****   CALLED BY   - #A                                     S01136 S01194
     C*****                                                        S01136 S01194
     C*****   FIELDS USED : SS0300 - KEY USED TO ACCESS LF/FDCCYDLLS01136 S01194
     C*****                 SS0301 - FIELD USED IN SETTING UP KEY  S01136 S01194
     C*****                                                        S01136 S01194
     C*************************************************************S01136 S01194
     C*****                                                        S01136 S01194
     C*****      ZA0300    BEGSR                                   S01136 S01194
     C*****                                                        S01136 S01194
     C***SET*OF*CHAIN*FAIL*INDICATOR                               S01136 S01194
     C******               SETOF                     60            S01136 S01194
     C*****                                                        S01136 S01194
     C****SET*UP*KEY*TO*BE*USED*IN*CHAIN                           S01136 S01194
     C*****                MOVE '0'       *IN60                    S01136 S01194
     C*****                MOVEL'20      'SS0300 12                S01136 S01194
     C*****                MOVE '1'       SS0301  4                S01136 S01194
     C*****                MOVELSSCCY     SS0301                   S01136 S01194
     C*****                MOVE SS0301    SS0300                   S01136 S01194
     C*****                                                               S01136
     C******     SS0300    CHAINFDCCYDLL             60             S01136S01194
     C*****                                                               S01136
     C****CHECK*LOGICAL*DELETE*FLAG*BLANK                          S01136 S01194
     C****       RECI      IFEQ '*'                        B1      S01136 S01194
     C****                 MOVE '1'       *IN60            *1      S01136 S01194
     C*****                END                             E1      S01136 S01194
     C***DEAL WITH DATA BASE ERROR                                        S01136
     C*****      *IN60     IFEQ '1'                        ********S01136 S01194
     C*****                MOVEL'FDCCYDLL'DBFILE           *      *S01136 S01194
     C*****                MOVELSS0300    DBKEY            * DBERR*S01136 S01194
     C*****                MOVEL'908'     DBASE            *      *S01136 S01194
     C*****                END                             ********S01136 S01194
     C*****                                                        S01136 S01194
     C*****      ZA0309    ENDSR                                   S01136 S01194
     C*****************************************************************   S01136
     C/EJECT                                                              S01136
     C*****************************************************************   S01136
     C*                                                               *   S01136
     C* MM1013 - Subroutine to convert a rate to display, with sign   *   S01136
     C*                                                               *   S01136
     C* CALLED BY: #B                                                 *   S01136
     C*          : #C                                                 *   S01136
     C*          : #D                                                 *   S01136
     C*          : #E                                                 *   S01136
     C*                                                               *   S01136
     C* CALLS :                                                       *   S01136
     C*                                                               *   S01136
     C* INPUT  : @@INPR Rate to be edited.                            *   S01136
     C*                                                               *   S01136
     C* OUTPUT : @@OUTR Edited output rate.                           *   S01136
     C*                                                               *   S01136
     C* USES :   @@INPR Rate to be edited.                            *   S01136
     C*          @@OUTR Edited output rate.                           *   S01136
     C*          @@DECS Field to hold decimal digits for input rate.  *   S01136
     C*          @@INTS Field to hold integers for input rate.        *   S01136
     C*          @@N    Counter field.                                *   S01136
     C*          @@Q    Second counter field.                         *   S01136
     C*          @@STRP Rate start position after zero suppression.   *   S01136
     C*          @W     Work array.                                   *   S01136
     C*                                                               *   S01136
     C*****************************************************************   S01136
     C           MM1013    BEGSR                                          S01136
     C*                                                                   S01136
     C**  Define fields used.                                             S01136
     C                     Z-ADD@@INPR    @@INPR 117                      S01136
     C                     MOVE *BLANKS   @@OUTR 13                       S01136
     C                     MOVE *BLANKS   @@DECS  7                       S01136
     C                     MOVE *BLANKS   @@INTS  4                       S01136
     C                     Z-ADD0         @@N     20                      S01136
     C                     Z-ADD0         @@Q     20                      S01136
     C                     Z-ADD0         @@STRP  20                      S01136
     C*                                                                   S01136
     C**  Initialise work array.                                          S01136
     C                     MOVEA*BLANKS   @W                              S01136
     C*                                                                   S01136
     C**  If the rate is negative the sign must be printed.               S01136
     C           @@INPR    IFLT 0                          B1             S01136
     C                     MOVE '-'       @W,13            *1             S01136
     C                     Z-SUB@@INPR    @@INPR           *1             S01136
     C                     END                             E1             S01136
     C*                                                                   S01136
     C**  Seperate integers and decimal digits into two fields.           S01136
     C                     MOVE @@INPR    @@DECS                          S01136
     C                     MOVEL@@INPR    @@INTS                          S01136
     C*                                                                   S01136
     C**  Move integers, decimal seperator and decimal digits into        S01136
     C**  work array.                                                     S01136
     C                     MOVEA@@INTS    @W                              S01136
     C*********************MOVE*IDDCSP****@W,5**********************S01136S01319
     C                     MOVE BNDCSP    @W,5                            S01319
     C                     MOVEA@@DECS    @W,6                            S01136
     C*                                                                   S01136
     C**  Remove leading zeros from the rate and replace with blanks.     S01136
     C                     Z-ADD1         @@N                             S01136
     C           @@N       DOWLE3                          B1             S01136
     C           @W,@@N    ANDEQ'0'                        X1             S01136
     C                     MOVE *BLANK    @W,@@N           *1             S01136
     C                     ADD  1         @@N              *1             S01136
     C                     END                             E1             S01136
     C*                                                                   S01136
     C                     Z-ADD@@N       @@STRP                          S01136
     C*                                                                   S01136
     C**  Truncate trailing zeros and replace with blanks. If rate is     S01136
     C**  an integer a single zero after the decimal place should be      S01136
     C**  displayed.                                                      S01136
     C                     Z-ADD12        @@N                             S01136
     C           @@N       DOWGE7                          B1             S01136
     C           @W,@@N    ANDEQ'0'                        X1             S01136
     C                     MOVE *BLANK    @W,@@N           *1             S01136
     C                     SUB  1         @@N              *1             S01136
     C                     END                             E1             S01136
     C*                                                                   S01136
     C**  Right justify the array.                                        S01136
     C                     Z-ADD12        @@Q                             S01136
     C           @@N       IFNE @@Q                        B1             S01136
     C           @@N       DOWGE@@STRP                       B2           S01136
     C                     MOVE @W,@@N    @W,@@Q             *2           S01136
     C                     MOVE *BLANK    @W,@@N             *2           S01136
     C                     SUB  1         @@N                *2           S01136
     C                     SUB  1         @@Q                *2           S01136
     C                     END                               E1           S01136
     C                     END                             E2             S01136
     C*                                                                   S01136
     C**  Move the final array into the output field.                     S01136
     C                     MOVEA@W        @@OUTR                          S01136
     C*                                                                   S01136
     C           M10139    ENDSR                           **M10139**     S01136
     C*****************************************************************   S01136
     C/EJECT                                                              S01136
     C*****************************************************************   S01136
     C*                                                               *   S01136
     C* ZA0660 - THIS SUBROUTINE CONVERTS DATE FORMAT YYYYMMDD TO     *   S01136
     C*          DDMMMYY FORMAT                                       *   S01136
     C*                                                               *   S01136
     C* CALLED BY :                                                   *   S01136
     C*                                                               *   S01136
     C* CALLS :                                                       *   S01136
     C*                                                               *   S01136
     C* INPUT  : @@DTIN DATE INPUT (YYYYMMDD)  - IN DATA STRUCTURE    *   S01136
     C*                                                               *   S01136
     C* OUTPUT : @@DATE DATE OUTPUT (DDMMMYY)                         *   S01136
     C*                                                               *   S01136
     C* USES :   @@MTH  MONTH NUMBER                                  *   S01136
     C*          @@MNM  MONTH SHORTNAME                               *   S01136
     C*          @@DAY  DAY NUMBER                                    *   S01136
     C*          @@YYYY YEAR (4 CHARACTER)                            *   S01136
     C*          @@DAT5 5A WORKFIELD                                  *   S01136
     C*          @MN    ARRAY OF MONTH SHORTNAMES                     *   S01136
     C*                                                               *   S01136
     C*     LAST AMEND NO. ME1257              DATE 02/04/87          *   S01136
     C*     When date input is zero set output date to blanks         *   S01136
     C*                                                               *   S01136
     C*****************************************************************   S01136
     C           ZA0660    BEGSR                                          S01136
     C*                                                                   S01136
     C           @@DTIN    IFNE 0                          B1             S01136
     C                     MOVE @@YYYY    @@DATE  7        *1             S01136
     C                     MOVE @MN,@@MTH @@DAT5  5        *1             S01136
     C                     MOVEL@@DAY     @@DAT5           *1             S01136
     C                     MOVEL@@DAT5    @@DATE           *1             S01136
     C                     ELSE                            X1             S01136
     C                     MOVE *BLANKS   @@DATE           *1             S01136
     C                     END                             E1             S01136
     C*                                                                   S01136
     C           ZA0669    ENDSR                           **ZA0669 TAG **S01136
     C/EJECT                                                              S01136
     C*****************************************************************   S01136
     C*                                                                   S01136
     C* *PSSR    -   ROUTINE CALLED ON FILE / PROGRAM ERROR               S01136
     C*                                                                   S01136
     C* CALLS           -                                                 S01136
     C*                                                                   S01136
     C* CALLED BY       -                                                 S01136
     C*                                                                   S01136
     C* FLDS USED       -                                                 S01136
     C*                                                                   S01136
     C*****************************************************************   S01136
     C           *PSSR     BEGSR                                          S01136
     C*                                                                   S01136
     C           @RUN      IFEQ *BLANK                                    S01194
     C                     MOVE 'Y'       @RUN    1                       S01194
     C                     DUMP                                           S01136
     C                     END                                            S01194
     C*                                                                   S01136
     C                     ENDSR                                          S01136
     C*                                                                   S01136
     C*****************************************************************   S01136
0501 C/EJECT
0502 ODL2480P1E  203           HEAD                                       S01124
0503 O*****                              22 'REFERENCE DL2480'            S01117
0503 O                                   24 'REFERENCE DL2480P1'          S01117
0504 O******                   TITL      89                               S01194
0504 O                         BJURPT    89                               S01194
0505 O                                  122 'DATE              PAGE'
0506 O*****                    RUNA     112                               S01194
0506 O                         BJMRDT   112                               S01194
0507 O                         PAGE  Z  127
0508 O        E  1             HEAD
0510 O***********************************65 'DEALS BY CUSTOMER'           AUS015
0510 O**********      N65N67             65 'DEALS BY CUSTOMER'     AUS015048553
0510 O**********       65N67             65 'F.X. DEALS BY CUSTOMER AUS015048553
0510 O**********      N65 67             65 'M.M. DEALS BY CUSTOMER AUS015048553
0510 O                                   65 'DEALS BY CUSTOMER'           048553
     O                 88                73 '- TYPE '                     CDL021
     O                 88      TYP1      76                               CDL021
     O                 88 89   TYP2      79                               CDL021
     O                 88 89   TYP3      83                               CDL038
0512 O        E  2             HEAD
0514 O***********************************65 '-----------------'           046779
0510 O**********      N65N67             65 '-----------------'     046779048553
0510 O**********       65N67             65 '----------------------'046779048553
0510 O**********      N65 67             65 '----------------------'046779048553
0514 O                                   65 '-----------------'           048553
1445 O        E  2             HEAD                                       S01117
     O                                   18 'CONSOLIDATED'                S01117
0508 O        E  1             HEAD
     O                                   12 'CUSTOMER'
     O******                   CNUM      20                               S01194
     O                         BBCUST    20                               S01194
     O******                   CRNM      44                               S01194
     O                         BBCRNM    44                               S01194
     O******                   CSNM      58                               S01194
     O                         BBCSSN    58                               S01194
0512 O        E  2             HEAD
     O******                   CTWN      34                               S01194
     O                         BBCRTN    34                               S01194
0508 O        E  1             HEAD
     O                                  111 'RELATED'
0516 O        E  3             HEAD
0517 O                                   22 'TYPE      DEAL NO.'
0518 O                                   44 'DEAL       VALUE'
0519 O                                   74 'MATURITY    CCY      F/F'
0520 O                                  112 'AMOUNT        DEAL NO.'
0521 O        E  1             DETAIL
     O                         DTYPW      9
     O                         CLASW     13                               CDL038
     O**************   54      BYSL      10                         S01157BHF486
     O                         DLNO      21
     O                         DDATE     33
     O                         VDATE     44
     O                         NARR1     57
     O                         CCY       65
     O                         FFIN      73
     O                         AMT1W     98
     O                         RDNO     110
     O        E  2             DETAIL
     O**********               LINE2    100                               S01378
     O                         LINE2    111                               S01378
0527 O*
     O*                                                                   S01157
     O*FRA/IRS FIELDS                                                     S01157
     O*                                                                   S01157
     O        E  1             COMMON                                     S01157
     O                         DTYP       6                               S01157
     O                                    7 '-'                           S01157
     O                         DLST       9                               S01157
     O                         CLAS      13                               CDL038
     O                 70      BYSL      14                               CDL038
     O*****************70******BYSL      10                        S01157 CDL038
     O                         DLNO      21                               S01157
     O                         @DLDAT    33                               S01157
     O                         @VLDAT    44                               S01157
     O                         @MTDAT    57                               S01157
     O                         UCUCY     65                               S01157
     O                 74      @FEDF     73                               S01157
     O                         @DLAMT    98                               S01157
     O                         @LNKDN   110                               S01157
     O*                                                                   S01157
     O* FR TYPE DEALS                                                     S01157
     O*                                                                   S01157
     O        E  1             FRDET                                      S01157
     O                         @TEXT     16                               S01157
     O                                   35 'REFERENCE RATE'              S01157
     O                         @BTYP     38                               S01157
     O                                   75 'CONTRACT RATE'               S01157
     O                         @RATE     88                               S01157
     O*                                                                   S01157
     O* CAPS COLLARS & FLOORS                                             S01157
     O*                                                                   S01157
     O        E  1             RRDET                                      S01157
     O                 71                75 'CEILING RATE'                S01157
     O                N71                75 'FLOOR RATE'                  S01157
     O                         @CLRAT    88                               S01157
     O        E  1             RRDET                                      S01157
     O                         @TEXT     16                               S01157
     O                                   35 'BASE RATE'                   S01157
     O                         @BTYP     38                               S01157
     O                                   75 'INTEREST/SPREAD'             S01157
     O                         @RATE     88                               S01157
     O                         @SPIN     98                               S01157
     O        E  1     72      RRDET                                      S01157
     O                                   75 'FLOOR RATE'                  S01157
     O                         @FLRAT    88                               S01157
     O*                                                                   S01157
     O* SINGLE CCY & CROSS CCY (RS & RX)                                  S01157
     O*                                                                   S01157
     O        E  1             RXDET                                      S01157
     O                         @TEXT     16                               S01157
     O                                   35 'OUR BASE RATE'               S01157
     O                         @UBRTT    38                               S01157
     O                                   75 'INTEREST/SPREAD'             S01157
     O                         @ORATE    88                               S01157
     O        E  1     73      RXDET                                      S01157
     O                         TCUCY     65                               S01157
     O                 75      @FEDF     73                               S01157
     O                         @RXAMT    98                               S01157
     O*                                                                   S01157
     O        E  1             RXDET                                      S01157
     O                                   35 'THEIR BASE RATE'             S01157
     O                         @TBRTT    38                               S01157
     O                                   75 'INTEREST/SPREAD'             S01157
     O                         @TRATE    88                               S01157
     O*                                                                   S01157
     O        E 3      LR 44NU7                                           E26358
     O                                   63 '***   NO DETAILS TO REPO'    E26358
     O                                   71 'RT   ***'                    E26358
     O*                                                                   S01157
     O        E   57   LR
0318 O                                   67 '*** END OF REPORT ***'
0562 O*
0739 O*****   T 33     LR U7 U8                                           S01194
3853 O*****                              42 '*** REFERENCE'               S01194
3854 O*****                    DBPGM     51                               S01194
3855 O*****                              71 '-  DATABASE ERROR AT'        S01194
3856 O*****                    DBASE     74                               S01194
3857 O*****   T  3     LR U7 U8                                           S01194
3858 O*****                              37 'FILE NAME'                   S01194
3859 O*****                    DBFILE    43                               S01194
3860 O*****                              48 'KEY'                         S01194
3861 O*****                    DBKEY     78                               S01194
0638 O        T  203   LR U7 U8                                           S01194
     O       AND      N43                                                 S01194
0503 O                                   24 'REFERENCE DL2480P1'          S01194
0505 O                                  122 'DATE              PAGE'      S01194
0506 O                         BJMRDT   112                               S01194
0507 O                         PAGE  Z  127                               S01194
0638 O        T  3     LR U7 U8                                           S01194
     O                                   71 '*** PRINT TERMINATED ***'    S01194
     O        T 2      LR U7 U8                                           S01194
     O                                   57 'DATABASE ERROR'              S01194
     O                         DBASE     61                               S01194
     O                                   67 'FILE'                        S01194
     O                         DBFILE    78                               S01194
     O        T 13     LR U7 U8                                           S01194
     O                                   49 'OPTION'                      S01194
     O                         DBOPTN    57                               S01194
     O                                   66 'KEY'                         S01194
     O                         DBKEY     96                               S01194
0563 O****    T 3      LR 44                                              S01194
0563 O********T*3      LR 44NU7                                           E26357
0564 O***********                        63 '***   NO DETAILS TO REPO'    E26357
0565 O***********                        71 'RT   ***'                    E26357
0566 O*
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
** TXT
OPTION TO
SALE
BASE RATE
INTEREST/SPREAD
YIELD
P'SZ                                                                      S01378
** ZCOM - EDIT FORMAT FOR AMOUNT FIELD
   ,   ,   ,   ,  0
   ,   ,   ,   ,  0.
              0
              0.
** TABLE TABA & TABB FOR DEAL STATUS NARRATIVES                           S01136
IINCOMP                                                                   S01136
CCOMP                                                                     S01136
AAUTH                                                                     S01136
RREAUTH                                                                   S01136
EEXPIRED                                                                  S01136
MMATURED                                                                  S01136
