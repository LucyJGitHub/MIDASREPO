     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas DL Input cycle confirmations msg extraction')    *
     F*****************************************************************
     F*                                                               *
     F*  Midas - DEALING MODULE                                       *
     F*                                                               *
     F*  DL6305 - I/C CONFIRMATION MESSAGE EXTRACTION                 *
     F*                                                               *
      *  (c) Finastra International Limited 2001                      *
      *                                                               *
      *  Last Amend No. CSD103             Date 10Aug20               *
      *  Prev Amend No. 251883             Date 13Nov19               *
      *                 MD050419           Date 11May18               *
      *                 MD050139           Date 23Mar18               *
      *                 MD046248           Date 27Oct17               *
      *                 CDL099             Date 06Oct17               *
      *                 MD045010           Date 05Apr17               *
      *                 CGL184             Date 07Dec16               *
      *                 CSW216             Date 14Mar16               *
      *                 AR916361           Date 25May16               *
      *                 MD034496           Date 25May15               *
      *                 MD030954           Date 09Oct14               *
      *                 CGL165             Date 17Feb15               *
      *                 MD030880           Date 25Nov14               *
      *                 MD028236           Date 25Nov14               *
      *                 MD023231           Date 25Nov14               *
      *                 MD027940           Date 25Nov14               *
      *                 CSW214             Date 25Nov14               *
      *                 CDL096             Date 22Sep14               *
      *                 CDL094             Date 30May14               *
      *                 CIR017             Date 10Apr14               *
      *                 CSD095             Date 08Apr14               *
      *                 MD022979           Date 23Oct13               *
      *                 MD023402           Date 18Nov13               *
      *                 MD022751           Date 11Oct13               *
      *                 MD022579           Date 02Oct13               *
      *                 MD022633           Date 03Oct13               *
      *                 MD022052           Date 09Sep13               *
      *                 MD022048           Date 02Sep13               *
      *                 MD022034           Date 09Sep13               *
      *                 CSW213             Date 03Jun13               *
      *                 AR916823           Date 12Jun13               *
      *                 AR1054657          Date 08Nov12               *
      *                 CMG003             Date 04Oct12               *
      *                 AR582922           Date 30Aug12               *
      *                 CLE148             Date 23Jul12               *
      *                 CSW212             Date 03May12               *
      *                 AR784699           Date 06Jun11               *
      *                 CLE064             Date 06Dec10               *
      *                 AR745096           Date 15Apr11               *
      *                 CER059             Date 19Jul10               *
      *                 BUG26839           Date 05Jan10               *
      *                 CER054             Date 07Apr09               *
      *                 BUG22911           Date 17Feb09               *
      *                 CER048             Date 19May08               *
      *                 CER043             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      *                 260339A            Date 08Jun09               *
      *                 255986             Date 26Aug08               *
      *                 257464             Date 12Nov08               *
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 BUG20927           Date 11Sep08               *
      *                 CSW208             Date 15Apr08               *
      *                 246801             Date 14May07               *
      *                 247840             Date 23May07               *
      *                 CSW050             Date 05Dec06               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 242622             Date 06Oct06               *
      *                 238445             Date 27Sep06               *
      *                 242587             Date 29Sep06               *
      *                 240603             Date 04Sep06               *
      *                 BUG7911            Date 01Nov05               *
      *                 185667             DATE 16NOV00               *
      *                 199214             Date 06Jun06               *
      *                 CDL049             Date 05Jul06               *
      *                 CIR014             Date 11May06               *
      *                 CSD031             Date 10Apr06               *
      *                 229061             Date 26Jan05               *
      *                 199214             Date 02May06               *
      *                 224586             Date 26Apr06               *
      *                 BUG11282           Date 23Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 BUG7980            Date 20Sep05               *
      *                 BUG7977            Date 16Aug05               *
      *                 BUG7882            Date 15Jul05               *
      *                 234068             Date 17Jun05               *
      *                 BUG7333            Date 26May05               *
      *                 CDL038             Date 10May05               *
      *                 LSC204A            Date 03May05               *
      *                 CIR013             Date 28Apr05               *
      *                 CGL035             Date 01Mar05               *
      *                 CDL028             Date 07Feb05               *
      *                 LHX010             Date 22Feb05               *
      *                 199392             Date 25Oct01               *
      *                 BUG8653            Date 22Oct05               *
      *                 BUG7698            Date 22Jun05               *
      *                 BUG7411            Date 01Jun05               *
      *                 BUG7354            Date 08Jun05               *
      *                 BUG7539            Date 15Jun05               *
      *                 233056             Date 13Apr05               *
      *                 233003             Date 08Apr05               *
      *                 CSW037A            Date 02May05               *
      *                 BUG6796            Date 26Apr05               *
      *                 BUG6795            Date 29Apr05               *
      *                 232540             Date 09Mar05               *
      *                 BUG6599            Date 14Apr05               *
      *                 BUG6675            Date 15Apr05               *
      *                 BUG5646            Date 23Feb05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CLE025             Date 20Oct03               *
      *                 CDL020             Date 03Feb04               *
      *                 CDL019             Date 03Feb04               *
      *                 CDL018             Date 03Feb04               *
      *                 CDL017             Date 03Feb04               *
      *                 CDL016             Date 03Feb04               *
      *                 CGL029             Date 01Sep03               *
      *                 222727             Date 05Nov03               *
      *                 222373             Date 03Nov03               *
      *                 217684             Date 12May03               *
      *                 208624             Date 26Jun03               *
      *                 CDL010             Date 02Aug02               *
      *                 198942             Date 25Mar02               *
      * Midas Release 4.01.03 ----------------------------------------*
      *                 210926             Date 24Oct02               *
      * Midas Release 4.01.02 ----------------------------------------*
      *                 209250             Date 25Oct02               *
      * Midas Release 4.01 -------------------------------------------*
      *                 CSW025             Date 26Mar02               *
      *                 CAP056             Date 13Mar02               *
      *                 CIR008             Date 13Mar02               *
      *                 179848             Date 16Aug01               *
      *                 179816             Date 16Aug01               *
      * Midas Release 4 --------------- Base -------------------------*
      *                 CSW201             Date 02May01               *
      *                 193704             Date 23May01               *
      *                 131541             Date 17Jul01               *
      *                 169025             Date 05Jun01               *
      *                 192081             Date 10Apr01               *
      * Midas DBA 3.05 -----------------------------------------------*
      *                 190545             Date 28Feb01               *
      *                 185707             Date 06Feb01               *
      *                 CIR006             Date 13Sep00               *
      * Midas DBA 3.04 -----------------------------------------------*
      *                 183212             Date 23Nov00               *
      *                 178970             Date 28Nov00               *
      *                 184003             Date 02Oct00               *
      *                 165933             Date 01Nov00               *
      *                 181906             Date 31Oct00               *
      *                 CDL008             Date 02May00               *
      *                 181719             Date 11Aug00               *
      * Midas DBA 3.03 -----------------------------------------------*
      *                 CSW200             Date 21Aug00               *
      *                 180466             Date 27Jun00               *
      *                 178583             Date 22May00               *
      *                 176772             Date 31Mar00               *
      *                 176294             Date 15Mar00               *
      *                 182091             Date 28Jul00               *
      *                 CIR005             Date 21Jan00               *
      *                 CIR004             Date 20Jan00               *
     F*                 172657             Date 02Feb00               *
      *                 148702             Date 18Nov98               *
      * Midas DBA 3.02 -----------------------------------------------*
      *                 171312             Date 02Dec99               *
     F*                 167426             Date 13Sep99               *
      * Midas DBA 3.01 -----------------------------------------------*
      *                 CDL006             Date 26Apr99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 157756             Date 14Jul99               *
      *                 CSW097             Date 22Jul97               *
     F*                 134246             DATE 27Apr99               *
     F*                 160794             Date 14May99               *
     F*                 148209             Date  7Jan99               *
     F*                 143362             Date 05Oct98               *
     F*                 CEU015             Date 19Jun98               *
     F*                 137909             Date 17Jul98               *
     F*                 CEU003             Date 28Mar98               *
     F*                 132679             DATE 26MAR98               *
     F*                 102717             DATE 09APR97               *
     F*                 041713             DATE 29OCT97               *
     F*                 109795             DATE 23SEP97               *
     F*                 119626             DATE 17SEP97               *
     F*                 CSW012             DATE 26May97               *
     F*                 CSW097             DATE 26May97               *
     F*                 CSW011             DATE 21Mar97               *
     F*                 S01408             DATE 16Aug96               *
     F*                 CSW005             DATE 01AUG96               *
     F*                 CSW096             DATE 02AUG96               *
     F*                 102286             DATE 13JUN96               *
     F*                 088043             DATE 14JUN95               *
     F*                 087195             DATE 16JUN95               *
     F*                 S01408             DATE 21APR95               *
     F*                 086518             DATE 20APR95               *
     F*                 081482             DATE 10MAR95               *
     F*                 079771             DATE 20DEC94               *
     F*                 077898             DATE 20DEC94               *
     F*                 079135             DATE 20DEC94               *
     F*                 077558             DATE 13OCT94               *
     F*                 056739             DATE 12JAN94               *
     F*                 S01453             DATE 14DEC93               *
     F*                 059258             DATE 24NOV93               *
     F*                 042844             DATE 11OCT93               *
     F*                 E32797             DATE 03DEC91               *
     F*                 E32363             DATE 02DEC91               *
     F*                 E31801             DATE 25OCT91               *
     F*                 E29588             DATE 17OCT91               *
     F*                                                               *
     F*---------------------------------------------------------------*
      *                                                               *
      *  CSD103 - LIBOR Deregulation - Common Layer/Standing Data     *
      *  251883   - MT360 message generated in Midas only last payment*
      *           - Applied fix for MD-54609                          *
      *  MD050419 - Incorrect Interest amount and Interest rate in    *
      *             MT320                                             *
      *           - Interest amount and interest rate should not be   *
      *             zero out if CDL019 is switched on                 *
      *  MD050139- AOSARDR0 called every time causing performance     *
      *            issue. Recompile due to changes in /COPY           *
      *            ZFREQ/ZFRQ*.                                       *
      *  MD046248 - Finastra Rebranding                               *
      *  CDL099 - Split Value Date (Recompile)                        *
      *  MD045010 - Component LEC06A 10008 looping during COB caused  *
      *             by CGL184. Recompile due to changes in ZFRQB3.    *
      *  CGL184 - New Frequencies for Account Statements (Recompile)  *
      *  CSW216 - SWIFT Changes 2016 (Recompile)                      *
      *  AR916361 - Add Fix base rate checking on CDL019 before       *
      *             clearing MGINTR and MGTOTI field of MGF320PD.     *
      *             (Child: AR916362)                                 *
      *           - Appled for MD038215.                              *
      *  MD034496 - Maintainability of program for CIRS MT seq. H to O*
      *             changed to I to P                                 *
      *  MD030954 - Changing Trade Repository must output NEWT-CANC   *
      *  CGL165 - Dual Withholding Tax (Recompile)                    *
      *  MD030880 - Field 81J is generated in MT600 if the transaction*
      *             was inserted via interface                        *
      *  MD028236 - Incomplete tags for MT360 trade repository after  *
      *             updating SIRS with RPIF details                   *
      *  MD023231 - MT300 not generated when Trade Repo ID is changed *
      *  MD027940 - Additional fix for change type                    *
      *  CSW214 - SWIFT Changes 2014                                  *
      *  CDL096 - Business Day Conventions on MM Deals                *
      *           (Recompile)                                         *
      *  CDL094 - Enhance  Receive Settlement Instructions            *
      *  CIR017 - SIRS Business Day Conventions for both legs         *
      *  CSD095 - Allow Deal Sub-Type and Branch for MM and FX SSIs   *
      *           (Recompile)                                         *
      *  MD022979 - No MT300 generated when CSW213 is off             *
      *  MD023402 - Missing MT300 CANC for previous trade repository  *
      *  MD022751 - Paper Confirmation generated for trade repository *
      *             ID entered that has no Swift id                   *
      *  MD022579 - MT300 not generated when Trade Repo ID is changed *
      *  MD022633 - Allow reporting details with '0' Transaction      *
      *             Identifier type for different reporting           *
      *             jurisdiction and reporting party ID combinations. *
      *  MD022052 - Action amend_Amend maturity date where trade repo *
      *             has SWIFT Id_MT360 for trade repo is not generated*
      *  MD022048 - Destination of the MT360 of trade repository is   *
      *             incorrect.                                        *
      *  MD022034 - Action amend field tag 22A of Counterparty        *
      *             confirmation MT340 must be AMND instead of NEWT   *
      *             and also field tag 21 related ref is erroneous    *
      *             and New Seq G is missing                          *
      *  CSW213 - SWIFT Changes 2013                                  *
      *  AR916823 - MT202 was not generated after an Interest         *
      *             Adjustment. Generate necessary cancellation       *
      *             message for Interest Adjustment.                  *
      *             (Child: AR916824)                                 *
      *  AR1054657 - No MT600 must be generated if CLS Settlement     *
      *              is set to Y                                      *
      *  CMG003 - SWIFT MT600 Message Generation                      *
      *  AR582922 - DL: MMM payments was not generated after          *
      *             settlement account. Generate pay/receive messages *
      *             when Maturity Date is amended and it is within    *
      *             telex notice days. (Child: AR582923)              *
      *  CLE148 - Alpha Loan Reference                                *
      *  CSW212 - SWIFT 2012 Changes                                  *
      *  AR784699 - In the generated MT320 field 34E value is         *
      *             incorrect. Tax was not considered.                *
      *  CLE064 - Enhancement of Lending Frequencies (Recompile)      *
      *  AR745096 - 2nd and 3rd tax were not considered for a customer*
      *           with SWIFT msg (Child: AR745097)                    *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  BUG26839 - JA1_Threshold limit of the main joint customer was*
      *             utilized by the member                            *
      *  CER054 - German Features - Church Tax (Recompile)            *
      *  BUG22911 - Changes for Correct Tax Calculation               *
      *  CER048 - German Features - Taxes                             *
      *  CER043 - German Features LF041-00 New Fields and Defaulting  *
      *           (Recompile)                                         *
      *  260339A - Suppress DBASE error introduced by fix CSW205 if   *
      *            old deal not found, could have been purged.        *
      *            Applied R4 fix 234058.                             *
      *  255986 - Field 72 to be included in MT300/320/321/330        *
      *  257464 - Correctly show /FLTR/ for Swift2008                 *
      *  BUG20927 - Wrong value of field 18A in MT320                 *
      *  CSW208 - SWIFT 2008 Changes                                  *
      *  246801 - When CSW050 is on (i.e. Multiple Messages which     *
      *           also implies MT292's are generated in Midas)        *
      *           execute cancellation routine as MT292's were not    *
      *           being generated when original message was an MT202  *
      *           rather than an MT203.                               *
      *  247840 - Ensure that interest settlement details are not     *
      *           lost after chain to RBDN.                           *
      *  CSW050 - Generate Multiple Messages in MidasPlus.            *
      *           Ensure MT292 is generated for Pay/Rec that were     *
      *           previously part of a multiple.                      *
      *           Fix applied by 242622.                              *
      *  242622 - Generate Multiple Messages in MidasPlus.            *
      *           Ensure MT292 is generated for Pay/Rec that were     *
      *           previously part of a multiple.                      *
      *  238445 - Cancel message when Settlement method is changed    *
      *           from SWIFT (08) to Non-SWIFT (01).                  *
      *  242587 - Cancel MT340, MT360 and MT361 messages when FRA is  *
      *           amended.                                            *
      *  240603 - Delete gross message when Buy/Sell Net Indicator is *
      *           amended to 'Y'                                      *
      *  BUG7911 - If BOVD is not zero for RS/RX deal, use this as    *
      *            the Termination Date in MT360/MT361.               *
      *  185667 - MT340s are not generated when CSW200 is switched on.*
      *           Occurs because AGTY (used for CSW005) is blank if   *
      *           only CSW011 is switched on.                         *
      *  199214 - Clear work variables                                *
      *  CDL049 - Addition of a Reference Rate field (recompile)      *
      *  CIR014 - Mark to Market Cross-currency Interest Rate Swaps   *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  229061 - Field tag :30T: for MT340 should always show the    *
      *           Deal Date even after deal amendment.                *
      *  199214 - Clear work variables                                *
      *  224586 - Initialise work variables YY, MM and, DD before     *
      *           processing subrouting SDAGDT.  Also apply 210926 as *
      *           a preventative fix.                                 *
      *  BUG11282 - 14D field of FRA deal is blank. 14D field is      *
      *             Mandatory for SWIFT.                              *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  BUG7980- Incorrect field 32M on sequence J and K of MT361    *
      *           for Cross Currency IRS deals.                       *
      *  BUG7977- Add processing for Stub periods.                    *
      *  BUG7882- Do not do a further READPE once old principal       *
      *           amount has been found .                             *
      *  234068 - EU Tax Amount not considered in Total Interest      *
      *           (field 34E). Fix is to calculate EU Tax Amount and  *
      *           consider in calculation.                            *
      *  BUG7333- Remove fix 199392 as it conflicts with BUG5646.     *
      *  CDL038 - Extended Deal Sub Type (Recompile)                  *
      *  CDL028 - Automatic Rate Interpolations (Recompile)           *
      *  LSC204A- Amend FRA/IRS Pay/Rec Extract.                      *
      *           Change Request 1 - Expand to change Module Id       *
      *           of SWIFT msgs for FRA/IRS from FI to DL.            *
      *           Used Hooks DL6305C078, DL6305C079, DL6305C080       *
      *  CIR013 - Additional Calculation Method for FRA/IRS/CCF       *
      *           Method 9 - actual/365, 366 for Feb 29 period.       *
      *           Output calc. basis so will be reported as 'OTHER'   *
      *           in SWIFT field (ACT/366 not allowed).               *
      *  CGL035 - EUSD Upgrade to Midasplus                           *
      *  LHX010 - IR Interest Calculation Method 8                    *
      *           Added Hooks DL6305C072, DL6305C073, DL6305C074      *
      *           DL6305C075, DL6305C076, DL6305C077                  *
      *  199392 - If confirmation is for a Money Market Deal, do not  *
      *           execute the Cancel routine as Pay/Receive messages  *
      *           were being cancelled for no reason. Let the         *
      *           Pay/Receive job do the cancellation if necessary.   *
      *           If Cancellation of Deal - allow Deletion routine    *
      *           to run in order to Create MT320 'Deletion' message. *
      *           This problem did not occur at 10.6 as CONEXCY       *
      *           records were not produced for Money Market Deals.   *
      *           See fix 134006 in CG4000.                           *
      *  BUG8653 - DBASE 53 because CSW005 ON and Nostro short names  *
      *            has not been amended to point to a location code   *
      *            on SDLOCNPD. Interim solution - change from DBASE  *
      *            to setting W#ISFC and W#LOCN = *BLANKS.            *
      *            Applied fix 235722.                                *
      *  BUG7698- Setup change type for MT361 messages                *
      *  BUG7411- CDL028 fields missing from DLGHISPD (Recompile)     *
      *  BUG7354 - Check FRA/IRS flag to avoid database error         *
      *  BUG7539- Change type is set to 'I' for amendments            *
      *  233056 - Remove fix 232540 ie., 32H should be 0 if principals*
      *           have not changed in a rollover.                     *
      *  233003 - SWIFT2005 changes for MT320 does not work when      *
      *           S01434 is off                                       *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  BUG6796- Field 22B references the rate fixing currencies it  *
      *           should reference the payment convention currencies  *
      *  BUG6795- Amount Convention and Payment Date Convention is    *
      *           not outputted for RS deals                          *
      *  232540 - If rollover amount and principal are equal, 32H     *
      *           should be = interest if settled in the same         *
      *           cash flow.                                          *
      *  BUG6599 - OISD Settlement days should be added to Field 30F. *
      *           when deal is OISD.                                  *
      *  BUG6675- Amended program such that the correct interest      *
      *           payment dates would be shown on the MT360 message   *
      *  BUG5646- Cancellation not done in MMM when deal is amended   *
      *           to non Swift settlement.                            *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CDL020 - Apply Base Rate at Value Date (Recompile)           *
      *  CDL019 - Allow Base Rate Changes on Fixed Deposits/Loans     *
      *           (Recompile)                                         *
      *  CDL018 - Multiple Settlement Accounts on Loans/Deposits      *
      *           (Recompile)                                         *
      *  CDL017 - Penalty Fee & Early Maturity of Fixed Term Loan/Dep *
      *           (Recompile)                                         *
      *  CDL016 - Automatic rollover of Fixed Term Loans/Deposits     *
      *           (Recompile)                                         *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  222727 - Release 5.0 errors  (Recompile)                     *
      *  222373 - Correct parameters on program calls                 *
      *  217684 - Authorisation User Malfunction (Recompile)          *
      *  208624 - Field 14A (Business Day Convention) of MT360 always *
      *           defaults to 'FOLLOWING'. In SR/F360RS, when SAR     *
      *           CIR005 is switched ON, check L1PDCN before moving a *
      *           value to MGBDAC so as to make sure that field 14A   *
      *           of MT360 will contain a correct value. Fix was      *
      *           patterned after 186413.                             *
      *  CDL010 - Prevent last user that actioned the trade from      *
      *           authorising it.Recompile due to changes in FXDEALPP.*
      *           , MMDELDPP , MMDENBPP AND MMDENSPP .                *
      *  198942 - The interest from the original deal is not included *
      *           in field "33P:" on the MT320 rollover confirmation. *
      *           Partially reversed core fix 181719 to reinstate     *
      *           part of fixes 077898 and 102717.                    *
      *  210926 - Agreement date on MT340 sometimes wrong.            *
      *           Initialise work field DDMMYY so CAT works.          *
      *  209250 - Deletions not sending cancellation to MMM           *
      *  CSW025 - Midas Message Manager                               *
      *           - Pass original change type                         *
      *  CAP056 - Automatic Authorisation of Interface deals          *
      *           (Recompile)                                         *
      *  CIR008 - FRA/IRS Deals Authorisation (Recompile)             *
      *  179848 - Field 34 has a wrong interest amount.  Correct the  *
      *           calculation of interest by subracting ICTD and      *
      *           adding AIAN and AIAP to the interest.               *
      *  179816 - Maturing CL should produce MT330.                   *
      *  CSW201 - SWIFT 2001 Standards Update (Recompiled)            *
      *  193704 - Currency file is being accessed though rate fixing  *
      *           currency is blank.                                  *
      *  131541 - For deal type "CI" system should take "Current      *
      *           holder of CD" (CHNA) for the destination and not    *
      *           the CNUM as it is the BICN.                         *
      *  169025 - Remove fix 157756 as it is causing problems under   *
      *           the dealing module.                                 *
      *  192081 - Database error in DLPCSCPD and MGF341PD, at 035.    *
      *  190545 - Reinstate code for CSW200 from patch DB3.02A        *
      *  185707 - Deals with CHTP = 'R' and RCDT = 'R' should have    *
      *           a MT320 with field 22A = CANC and 22B = ROLL.       *
      *  CIR006 - Amortisation of Caps/Collars/Floors and Individual  *
      *           Compounding Swaps.                                  *
      *  183212 - The value of field 14D should be "360/360" for      *
      *           calc. method 3 and "30E/360" for calc. method 7     *
      *           as stated in the Swift manual.                      *
      *  178970 - 'OTHR' to be used in ISDA Financial centre          *
      *  184003 - 30F should contain unadjusted dates                 *
      *  165933 - DB ERROR IN DEALS2   FOR ROLLOVER DEALS             *
      *         - Stop looping problem of DLC0400.                    *
      *  181906 - Wrong date being set up for interest period         *
      *  CDL008 - Continuous Linked Settlement                        *
     F*  181719 - Dbase 001 NOT UNIQUE                                *
     F*         - ROLLOVER DEALS ARE ALREADY MATURED CAUSING DBASE ERR*
     F*                                                               *
     F*  CSW200 - Swift 2000 Changes                                  *
      *  180466 - Change in program DLZFRQ. Additional parameter      *
      *           ZFRZBD inserted for DLZFRQ.                         *
      *  178583 - If settlement method not defined '00', the system   *
      *           is not able to generate field 22B in MT361.         *
      *  176772 - Field :22B: is missing in MT360. Due to use of      *
      *           settlement method 06 used.                          *
      *           For setl. method 06 set ISFC in the same way as     *
      *           for setl. method 02,12.                             *
      *  176294 - Spread signed not output anymore.                   *
      *           Reinstate coding removed by CSW097.                 *
      *  182091 - Wrong nostro number being passed to AONOSTR0        *
      *  CIR005 - FRA/IRS Business Day Conventions                    *
      *  CIR004 - Dealing Calculation Method Change                   *
     F*  172657 - Maturity confirmation field errors.  Applied fix    *
     F*           147657.                                             *
     F*  148702 - Additional logic for cover message confirmations.   *
     F*           for MT300 and MT320's - delivery agent (Field 53A)  *
     F*           for a cover message should hold the details of the  *
     F*           pay nostro a/c, and not the recipient of pay instr. *
     F*  171312 - Reinstate codes removed by 167426.                  *
     F*  167426 - Reverse parameter mismatch caused by fix CSW097     *
      *  CDL006 - Dealing Fiduciary.                                  *
     F*  157756 - Additional parameter to match parameters in         *
     F*           deletion/cancellation control program MG9200.       *
     F*  CSW097 - MT340s and MT360s Message Generation.               *
     F*           Amended to output an MT360 for an "FR" deal with    *
     F*           the Type of ISDA Agreement as either "ISDA" or "AFB"*
     F*           In addition, all deals that will generate an MT360  *
     F*           and MT361 will now output to several new detail file*
     F*  134246 - No MT320 is produced when rolling over an IP deal.  *
     F*           Applied Fix: 135529                                 *
     F*  160794 - For the interest amount, only do the currency       *
     F*           conversion if there is a from currency.             *
     F*         - Additions to 148209.                                *
     F*  148209 - Convert interest to new ccy on rollover             *
     F*  143362 - Do not condition CEU003 access by CSW005 or CSW011. *
     F*  CEU015 - EMU - Enhanced MM Deal Rollover                     *
     F*  137909 - New settlement currency fields added to confirmation*
     F*           messages. Only use if CEU003 is on.                 *
     F*  CEU003 - EMU - Settlement Currency Conversion                *
     F*           No changes required in this program at DBA2 because *
     F*           error fix 041713 has made this unnecessary. However,*
     F*           if this fix is changed, reversed for any reason,    *
     F*           then please check to see whether it is required to  *
     F*           re-apply code for CEU003. This may be upgraded from *
     F*           R10.6, PTF17.                                       *
     F*  132679 - Reverse out change 087195 as it clashes with        *
     F*           change 103387 in MG0320.                            *
     F*  102717 - Due to an amendment of a roll-over deal, pgm could  *
     F*           not access rolled-over deal as it had matured and   *
     F*           was on the history file. DEALALL changed for        *
     F*           DEALSALL which includes historic deals files and    *
     F*           KCOMIT removed as historic files are not journalled *
     F*           and no updates to this file anyway.                 *
     F*  041713 - If Account With Institution field is blank, SWIFT   *
     F*           message should say UNKNOWN - change program to not  *
     F*           default Pay Nostro in this case. Remove fix E32363  *
     F*           originally done for BHF New York and later removed  *
     F*           by them.                                            *
     F*  109795 - If loan has front-up interest, Next Interest Date   *
     F*           field should contain value date, not maturity date  *
     F*  119626 - Apply fix 110016                                    *
     F*           Only execute routine 'DELT' if the conexcy record   *
     F*           is for ISO conf generation (ie. RCDT = 'D').        *
     F*           If RCDT = 'X' then execute routine DELT2 which calls*
     F*           the cancellation pgm MG9200 with a program type     *
     F*           parameter of 'PR'.                                  *
     F*  CSW012 - Extract Contact person details for MT300.           *
     F*  CSW097 - Swift changes 1997.                                 *
     F*  CSW011 - FRA MT34n only Message Generation                   *
     F*  S01408 - Core hook DL6305CCP4 added                          *
     F*         - Core hook DL6305CCP3 added                          *
     F*  CSW005 - FRA/IRS MG34n and MG36n Msg Generation.             *
     F*  CSW096 - Swift changes 1996.
     F*  102286 - Reversal of a rollover deal causes DL6305 to fail   *
     F*           with d/b error at 001 in DEALS2 at 001, caused by   *
     F*           rollover deal number being zeroized on reversal.    *
     F*           Fix is to stop removal of RDNO in MM0081, and       *
     F*           ignore reversed deals in DL0110 and DL6305.         *
     F*  088043 - Add Beneficiary Account Line to MGF3XXPD files.     *
     F*  087195 - Change DIRECT to /DIRECT for SWIFT                  *
     F*  S01408 - Core hook DL6305CCP1 added                          *
     F*           Core hook DL6305CCP2 added                          *
     F*  086518 - Reversal of fix 081482                              *
     F*           - This fix duplicates 077558 and in doing so        *
     F*             causes a new error.                               *
     F*  081482 - MT300 is being produced twice for a deal.           *
     F*  079771 - Keyword correction for rollovers                    *
     F*  077898 - A principal increase rollover should say ROLINC     *
     F*  079135 - Confirmation does not need to be regenerated for    *
     F*           rollovers                                           *
     F*  077558 - MULTIPLE CONFIRMATIONS BEING GENERATED FOR ROLLOVER *
     F*  056739 - Add account line for fields :56: and :57:           *
     F*  S01453 - MARGIN AND FX POSITIONS/POINTS AND BASE CURRENCY    *
     F*           POSITIONS/POINTS ADDED TO FX INPUT (RECOMPILED)     *
     F*  059258 - If Swift confirmation is amended, place deal date   *
     F*           into field 30 of the message instead of run date.   *
     F*  042844 - The system produced a payment message for the       *
     F*           principal amount of a new, rollover loan. It        *
     F*           should have produced an MT210 for the interest      *
     F*           only. A CONEXCY record with record type 'R' will    *
     F*           produce value date confirmations for the rollover   *
     F*           deal and cancel the maturity date confirmations     *
     F*           for the rolled over deal.                           *
     F*  E32797 - CURRENCY CODE MISSING.                              *
     F*  E32363 - IF A/C WITH INST. BLANK, DEFAULT FIELD 57           *
     F*           TO THE NOSTRO ACCOUNT.                              *
     F*  E31801 - 'CANCEL' CONFIRMATION GENERATED FOR UNSENT MSGS     *
     F*  E29588 - POST COLLECTION SWIFT RATIONALISATION FIXES         *
     F*                                                               *
     F*****************************************************************
     FCONEXCY IF  E           K        DISK
     FDEALS   IF  E           K        DISK
     F            DEALSDAF                          KIGNORE
     F            DEALSDFF                          KIGNORE
     F************DEALSDGF                          KIGNORE               CSW005
     F                                              KCOMIT
     F*EALALL IF  E           K        DISK                         077898102717
     F*DEALSALLIF**E***********K        DISK                       102717 181719
     F************DEALSDBF                          KIGNORE        077898 181719
     F************DEALSDCF                          KRENAMEDEALALLF077898 181719
     F************DEALSDDF                          KIGNORE        077898 181719
     F************DEALSDEF                          KIGNORE        077898 181719
     F************DEALSDGF                          KIGNORE        077898 181719
     F************                                  KCOMIT          077898102717
     F************MMDELDP0                          KIGNORE        102717 181719
     F************MMDENBP0                          KIGNORE        102717 181719
     F************MMDENSP0                          KIGNORE        102717 181719
     F************FXDEALP0                          KIGNORE        102717 181719
     F************DLBHISD0                          KIGNORE        102717 181719
     F************DLDHISD0                          KIGNORE        102717 181719
     F************DLEHISD0                          KIGNORE        102717 181719
     F************DLGHISD0                          KIGNORE        102717 181719
     FDEALSALLIF  E           K        DISK                                                   198942
     F            DEALSDBF                          KIGNORE                                   198942
     F            DEALSDCF                          KRENAMEDEALALLF                           198942
     F            DEALSDDF                          KIGNORE                                   198942
     F            DEALSDEF                          KIGNORE                                   198942
     F            DEALSDGF                          KIGNORE                                   198942
     F            MMDELDP0                          KIGNORE                                   198942
     F            MMDENBP0                          KIGNORE                                   198942
     F            MMDENSP0                          KIGNORE                                   198942
     F            FXDEALP0                          KIGNORE                                   198942
     F            DLBHISD0                          KIGNORE                                   198942
     F            DLDHISD0                          KIGNORE                                   198942
     F            DLEHISD0                          KIGNORE                                   198942
     F            DLGHISD0                          KIGNORE                                   198942
     FMGOREFMMIF  E           K        DISK                                                  BUG5646
     FMGOREFRAIF  E           K        DISK                                                   242587
     F            MGOREFD0                          KRENAMEMGOREFD1                           242587
     FMGOREFLBIF  E           K        DISK                                                   242622
     F            MGOREFD0                          KRENAMEMGOREFD2                           242622
     FMGOREFLAIF  E           K        DISK                                                 AR582922
     F            MGOREFD0                          KRENAMEMGOREFD3                         AR582922
     FDLDTSCPDIF  E           K        DISK                           UC  CSW005
     FDLCFSCPDIF  E           K        DISK                           UC  CSW005
     FDLPCSCPDIF  E           K        DISK                           UC  CSW005
     FMGY36NL0IF  E           K        DISK                           UC  CSW097
     F            MGY36ND0                          KRENAMEMGY36NDL       CSW097
     FDLPCSCL0IF  E           K        DISK                           UC  CSW097
     F            DLPCSCD0                          KRENAMEDLPCSCDL       CSW097
     FSDJACCLBIF  E           K        DISK                                                   234068
     FDTRIXL7 IF  E           K        DISK                                                 AR916823
     FMGF300PDO   E                    DISK
     F                                              KCOMIT
     FMGF320PDO   E                    DISK
     F                                              KCOMIT
     FMGF330PDO   E                    DISK
     F                                              KCOMIT
     FMGF321PDO   E                    DISK
     F                                              KCOMIT
     FMGF340PDO   E                    DISK                           UC  CSW005
     F                                              KCOMIT                CSW005
     FMGU340PDO   E                    DISK                           UC  CSW200
     F                                              KCOMIT                CSW200
     FMGX360PDO   E                    DISK                           UC  CSW005
     F                                              KCOMIT                CSW005
     FMGX361PDO   E                    DISK                           UC  CSW005
     F                                              KCOMIT                                    CSW005
     F*MGU36NPDO**E****                DISK                                            CSW097 CIR005
     FMGU36NPDUF  E           K        DISK                      A    UC                      CIR005
     F                                              KCOMIT                CSW097
     FMGV36NPDUF  E           K        DISK                      A    UC  CSW097
     F                                              KCOMIT                CSW097
     FMGW36NPDO   E                    DISK                           UC  CSW097
     F                                              KCOMIT                CSW097
     FMGX36NPDO   E                    DISK                           UC  CSW097
     F                                              KCOMIT                CSW097
     FMGY36NPDO   E                    DISK                           UC  CSW005
     F                                              KCOMIT                CSW005
     FMGZ36NPDO   E                    DISK                           UC  CSW005
     F                                              KCOMIT                CSW005
     FDLRPIFL1IF  E           K        DISK                                                   CSW213
     FMGHISTL5IF  E           K        DISK                                                 MD022579
     FMGX320PDO   E                    DISK                           UC                      CSW208
     F                                              KCOMIT                                    CSW208
     FMGF600PDO   E                    DISK                                                   CMG003
     F                                              KCOMIT                                    CMG003
     FDLFHSTL0IF  E           K        DISK                                                   CSW208
     FDLFEEDLIIF  E           K        DISK                                                   CSW208
     FDLDLDGLMIF  E           K        DISK                                                   CIR014
     FDL6305AUO   E                    PRINTER                        UC
     F/COPY WNCPYSRC,DL6305F001
      *
      *    Function of indicators
      *
      *    10    EOF CONEXCY
      *    11    EOF DEALS
      *    15    CALL TO ZM0060 ENDED IN ERROR
      *    20    CHAIN TO DEALS FOR PURCHASE SIDE OF MT321
      *    21    RESTORE ORIGINAL DEAL AFTER ABOVE
      *    30    CANCELLATION PROGRAM RETURNED IN ERROR
      *    31    MESSAGE TYPE NOT GENERATED FOR CUSTOMER
      *    32    CONFIRMATIONS NOT GENERATED FOR CUSTOMER
      *    33    CONFIRMATIONS NOT GENERATED FOR CUSTOMER
      *    40    ERROR ON WRITE TO GENERATION DRIVER FILE
      *    70    EOF in DLDTSCPD, DLCFSCPD or DLPCSCPD                    CSW005
      *    71    Error in accessing DLDTSCPD, DLCFSCPD or DLPCSCPD        CSW005
      *    U7U8LR        DB ERROR
      *
     E                    CPY@    1   1 80
      *                                                                   CSW005
      **  Array of text to format MG34n and MG36n messages                CSW005
     E***********         TX#     1  15 70                         CSW005 183212
     E                    TX#     1  16 70                                183212
     E***/COPY*ZSRSRC,ZDATE1Z1                                     CSW097 CIR005
     E/COPY ZSRSRC,ZDATE2Z1                                               CIR005
     E/COPY ZSRSRC,ZDATE9Z1                                               CSW097
      *
      **  ARRAY OF MESSAGE TYPES NOT GENERATED FOR CUSTOMER
      *
     E                    NGN        15  3
      *                                                                   CSW097
      **  Array of message seq to be output for Financial Centre          CSW097
      *                                                                   CSW097
     E                    MSEQ       10  1                                CSW097
      *                                                                   CIR005
      ** Currencies Array                                                 CIR005
      *                                                                   CIR005
     E                    WRFCY      10  3                                CIR005
      *
      **  Rename conflicting CONEX fields
      *
     E/COPY ZSRSRC,ZHOLE                                                  CSW005
     E/COPY ZSRSRC,ZFRQB2Z1                                               CIR005
     E                    TSTAM   1   1 26                                                    CSW213
     ICONEXCYF
     I              RECI                            CRECI
     I              RCDT                            CRCDT
     I              DLNO                            CDLNO
     I              VDAT                            CVDAT
     I              BRCA                            CBRCA
     I/COPY WNCPYSRC,DL6305I002
      *
      **  Rename conflicting DEALS fields
      *
     IDEALSDBF
     I              RECI                            DRECI
     I              DLNO                            DDLNO
     I              RCDT                            DRCDT
     I              VDAT                            DVDAT
     I              BRCA                            DBRCA
      *
     IDEALSDCF
     I              RECI                            DRECI
     I              DLNO                            DDLNO
     I              RCDT                            DRCDT
     I              VDAT                            DVDAT
     I              BRCA                            DBRCA
      *
     IDEALSDDF
     I              RECI                            DRECI
     I              DLNO                            DDLNO
     I              RCDT                            DRCDT
     I              VDAT                            DVDAT
     I              BRCA                            DBRCA
      *
     IDEALSDEF
     I              RECI                            DRECI
     I              DLNO                            DDLNO
     I              RCDT                            DRCDT
     I              VDAT                            DVDAT
     I              BRCA                            DBRCA
     I              SCUS                            CNUM
      *                                                                   CSW005
     IDEALSDGF                                                            CSW005
     I              RECI                            DRECI                 CSW005
     I              DLNO                            DDLNO                 CSW005
     I              RCDT                            DRCDT                 CSW005
     I              VDAT                            DVDAT                 CSW005
     I              BRCA                            DBRCA                 CSW005
     I              SETF                            DSETF                 CSW005
     I*                                                                   077898
     I*DEALALLF*****                                               077898 181719
     I**************RECI                            DRECI          077898 181719
     I**************DLNO                            DDLNO          077898 181719
     I**************RCDT                            DRCDT          077898 181719
     I**************VDAT                            DVDAT          077898 181719
     I**************BRCA                            DBRCA          077898 181719
     I*                                                            102717 181719
     I*DLCHISD0*****                                               102717 181719
     I**************RECI                            DRECI          102717 181719
     I**************DLNO                            DDLNO          102717 181719
     I**************RCDT                            DRCDT          102717 181719
     I**************VDAT                            DVDAT          102717 181719
     I**************BRCA                            DBRCA          102717 181719
      *                                                                                       198942
     IDEALALLF                                                                                198942
     I              RECI                            DRECI                                     198942
     I              DLNO                            DDLNO                                     198942
     I              RCDT                            DRCDT                                     198942
     I              VDAT                            DVDAT                                     198942
     I              BRCA                            DBRCA                                     198942
      *                                                                                       198942
     IDLCHISD0                                                                                198942
     I              RECI                            DRECI                                     198942
     I              DLNO                            DDLNO                                     198942
     I              RCDT                            DRCDT                                     198942
     I              VDAT                            DVDAT                                     198942
     I              BRCA                            DBRCA                                     198942
      *                                                                                       198942
     IDLPCSCDL                                                            CSW097
     I              DLNO                            LDLNO                 CSW097
     I              OTIN                            LOTIN                 CSW097
     I              PRDT                            LPRDT                 CSW097
     I              PAMT                            LPAMT                 CSW097
     I              COHO                            LCOHO                 CSW097
     I              DTPR                            LDTPR                 CSW097
      *                                                                   178970
     IMGU36ND0                                                            178970
     I              MGLOCN                          LOCN36                178970
     IDTRIXDF                                                                               AR916823
     I              RECI                            D3RECI                                  AR916823
     I              RCDT                            D3RCDT                                  AR916823
     I              DLNO                            D3DLNO                                  AR916823
     I              VDAT                            D3VDAT                                  AR916823
     I              CHTP                            D3CHTP                                  AR916823
     I              BRCA                            D3BRCA                                  AR916823
      *                                                                   CIR005
      ** Leg 1 Rate Fixing Currencies                                     CIR005
      *                                                                   CIR005
     IWCCYD1      DS                                                      CIR005
     I                                        1   3 L1CYR1                CIR005
     I                                        4   6 L1CYR2                CIR005
     I                                        7   9 L1CYR3                CIR005
     I                                       10  12 L1CYR4                CIR005
     I                                       13  15 L1CYR5                CIR005
     I                                       16  18 L1CYR6                CIR005
     I                                       19  21 L1CYR7                CIR005
     I                                       22  24 L1CYR8                CIR005
     I                                       25  27 L1CYR9                CIR005
     I                                       28  30 L1CYR0                CIR005
      *                                                                   CIR005
     IWCCYD2      DS                                                      CIR005
     I                                        1   3 WCYP1                 CIR005
     I                                        4   6 WCYP2                 CIR005
     I                                        7   9 WCYP3                 CIR005
     I                                       10  12 WCYP4                 CIR005
     I                                       13  15 WCYP5                 CIR005
     I                                       16  18 WCYP6                 CIR005
     I                                       19  21 WCYP7                 CIR005
     I                                       22  24 WCYP8                 CIR005
     I                                       25  27 WCYP9                 CIR005
     I                                       28  30 WCYP0                 CIR005
      *                                                                   CIR005
      ** Leg 2 Rate Fixing Currencies                                     CIR005
      *                                                                   CIR005
     IWCCYD3      DS                                                      CIR005
     I                                        1   3 L2CYR1                CIR005
     I                                        4   6 L2CYR2                CIR005
     I                                        7   9 L2CYR3                CIR005
     I                                       10  12 L2CYR4                CIR005
     I                                       13  15 L2CYR5                CIR005
     I                                       16  18 L2CYR6                CIR005
     I                                       19  21 L2CYR7                CIR005
     I                                       22  24 L2CYR8                CIR005
     I                                       25  27 L2CYR9                CIR005
     I                                       28  30 L2CYR0                CIR005
      *                                                                                      BUG6796
      ** Leg 1 Payment and Rate Change Currencies                                            BUG6796
      *                                                                                      BUG6796
     IWCCYD4      DS                                                                         BUG6796
     I                                        1   3 L1CYP1                                   BUG6796
     I                                        4   6 L1CYP2                                   BUG6796
     I                                        7   9 L1CYP3                                   BUG6796
     I                                       10  12 L1CYP4                                   BUG6796
     I                                       13  15 L1CYP5                                   BUG6796
     I                                       16  18 L1CYP6                                   BUG6796
     I                                       19  21 L1CYP7                                   BUG6796
     I                                       22  24 L1CYP8                                   BUG6796
     I                                       25  27 L1CYP9                                   BUG6796
     I                                       28  30 L1CYP0                                   BUG6796
      *                                                                                      BUG6796
      ** Leg 2 Payment and Rate Change Currencies                                            BUG6796
      *                                                                                      BUG6796
     IWCCYD5      DS                                                                         BUG6796
     I                                        1   3 L2CYP1                                   BUG6796
     I                                        4   6 L2CYP2                                   BUG6796
     I                                        7   9 L2CYP3                                   BUG6796
     I                                       10  12 L2CYP4                                   BUG6796
     I                                       13  15 L2CYP5                                   BUG6796
     I                                       16  18 L2CYP6                                   BUG6796
     I                                       19  21 L2CYP7                                   BUG6796
     I                                       22  24 L2CYP8                                   BUG6796
     I                                       25  27 L2CYP9                                   BUG6796
     I                                       28  30 L2CYP0                                   BUG6796
      *                                                                                       CSW208
      **  System Values Constant                                                              CSW208
      *                                                                                       CSW208
     I              'DLFSWIFTConf'        C         P@DL                                      CSW208
      *
      **  RUNDAT data area
      *
     IDSRUN       DS                             13
     I                                        1   7 RUNA
     I                                       13  13 MBIN
      *                                                                                     AR582922
     IDYMYR       DS                              6                                         AR582922
     I                                        1   2 DY1                                     AR582922
     I                                        3   4 MT1                                     AR582922
     I                                        5   6 YR1                                     AR582922
      *
      **  Data structure for bank file
      *
     ISDBANK    E DSSDBANKPD
      *
      **  Data structure for customer file
      *
     ISDCUST    E DSSDCUSTPD
      *
      **  Data structure for MIDAS modules
      *
     ISDMMOD    E DSSDMMODPD
      *
     I*DNOST****E*DSSDNOSTPD***                                     E32363041713
      ****Data*structure*for*nostro*file***                         E32363041713
      *                                                                   E32363
     ISDNOST    E DSSDNOSTPD                                              CSW097
      **  Data structure for nostro file                                  CSW097
      *                                                                   CSW097
     ISCSARD    E DSSCSARDPD                                              077898
      **  Data structure for Switchable Features file                     077898
      *                                                                   077898
     ISDACOF    E DSSDACOFPD                                              CSW005
      **  Data structure for Account Officer Details file                 CSW005
      *                                                                   CSW005
     ISDBSRT    E DSSDBSRTPD                                              CSW005
      **  Data structure for Base Rate Code Details file                  CSW005
      *                                                                   CSW005
     ISDCURR    E DSSDCURRPD                                              CSW005
      **  Data structure for Currency Details file.                       CSW005
      *                                                                   CSW005
     ISDGELR    E DSSDGELRPD                                              CSW005
      **  Data structure for General Ledger Details file                  CSW005
      *                                                                   CSW005
     I              QQACCD                          QQACC1                                    CGL029
     ISDFAIS    E DSSDFAISPD                                              CSW005
      **  Data structure for FRAIRS ICD details                           CSW005
      *                                                                   CSW005
     ISDEXST    E DSSDEXSTPD                                              CSW005
      **  Data structure for FRAIRS ICD details                           CSW005
      *                                                                   CSW005
     ISDTRAD    E DSSDTRADPD                                              CSW005
      **  Data structure for Trading details                              CSW005
      *                                                                   CSW005
     I              QQACCD                          QQACC2                                    CGL029
     ISDDEPT    E DSSDDEPTPD                                              CSW097
      **  Data structure for Department Codes                             CSW097
      *                                                                   CSW097
     ISDLOCN    E DSSDLOCNPD                                              CSW097
      **  Data structure for Location Codes                               CSW097
      *                                                                   CSW097
     ISDCTTX    E DSSDCTTXPD                                                                  234068
      ** Data Structure for Country of Tax Code Details                                       234068
      *                                                                                       234068
     ISDBRCH    E DSSDBRCHPD                                                                  234068
     I              QQDFAC                          QQDFA1                                    CGL035
      ** Data Structure for Branch Details                                                    234068
     I/COPY WNCPYSRC,DLH00435
      *                                                                                       234068
      **  Short data structure for access programs
      *
     IDSFDY     E DSDSFDY
      *
      **  Long data structure for access programs
      *
     IDSSDY     E DSDSSDY
      *
     IDS1DY     E DSDS2000DY                                              CSW005
      *                                                                   CSW005
     IDSLDY     E DSDSLDY                                                                   MD022751
      *                                                                                     MD022751
     ISDTXPA    E DSSDTXPAPD                                                                BUG22911
      ** Data structure for Tax Parameter File                                              BUG22911
      *                                                                                     BUG22911
      **  Local data area
      *
     ILDA         DS                            256
     I                                      134 141 DBFILE
     I                                      142 170 DBKEY
     I                                      171 180 DBPGM
     I                                      181 1830DBASE
     I*AWBA*****  DS                                                087195132679
     I**********                              1   6 WWAWBA          087195132679
     I**********                              7  35 WWAWBB          087195132679
     I/COPY WNCPYSRC,DL6305I001
      *                                                                   CSW005
      **  IRC keys for dbase error                                        CSW005
      *                                                                   CSW005
     I@IRCK1      DS                                                      CSW005
     I                                        1   6 @K1DL                 CSW005
     I                                        7   7 @K1OT                 CSW005
     I                                        8  12 @K1PR                 CSW005
     I@IRCK2      DS                                                      CSW005
     I                                        1   6 @K2DL                 CSW005
     I                                        7   7 @K2OT                 CSW005
     I                                        8   8 @K2RC                 CSW005
     I                                        9  13 @K2PR                 CSW005
      *                                                                   CSW097
     I              'FRABUYER'            C         @BUY                  CSW097
     I              'FRASELLER'           C         @SEL                  CSW097
     I              'FOLLOWING'           C         @BDAC                 CSW097
     I              'PRECEDING'           C         WBDCP                 CIR005
     I              'MODIFIEDF'           C         WBDCM                 CIR005
     I              'OTHER    '           C         WBDCO                 CIR005
     I/COPY ZSRSRC,ZHOLI                                                  CSW005
     I/COPY ZSRSRC,ZDATE9Z2                                               CSW005
      *
     C/EJECT
      *****************************************************************
      *                   Index to subroutines                        *
      *   main process                                                *
      *   INIT  - initial process                                     *
      *   SETF  - set up GDF files                                    *
      *   MSG   - produce message                                     *   042844
      *   TYPE  - determine message type                              *
      *   DEST  - determine destination customer address              *
      *   DELT  - deletion program processing                         *
      *   VALD  - generate message type for destination customer ?    *
      *   COMM  - format common fields                                *
      *   F300  - format message specific fields for MT300            *
      *   F320  - format message specific fields for MT320            *
      *   X320  - format message specific fields for MT320            *                       CSW208
      *   X320H - format message specific fields for MT320            *                       CSW208
      *   X320L - format message specific fields for MT320            *                       CSW208
      *   X320L2- format message specific fields for MT320            *                       CSW208
      *   F330  - format message specific fields for MT330            *
      *   F321  - format message specific fields for MT321            *
      *   F340  - format message specific fields for MT340            *   CSW005
      *   F360  - format message specific fields for MT360            *   CSW005
      *   F361  - format message specific fields for MT361            *   CSW005
      *   Y36N  - format iterative records for MT360 and MT361        *   CSW005
      *   COMFRA- format common FRA/IRS fields                        *   CSW005
      *   LORD  - Set up loan or deposit flag field                   *
      *   STCY1 - Set up settlement currencies for MT300              *   137909
      *   STCY2 - Set up settlement currency for MT320/21/30          *   137909
      *   STCY3 - Set up settlement currency for MT340                *   137909
      *   SRAGDT- Convert Agreement Date (AGDT) to YYYYMMDD format.   *   CSW097
      *   *PSSR - error handling                                      *
      *
      *****************************************************************
     C/EJECT
      *****************************************************************
      *   main process                                                *
      *   Calls - INIT initial process                                *
      *           SETF set up GDF files                               *
      *           MSG  produce message                                *   042844
      ************TYPE*determine*message*type**************************   042844
      ************DEST*determine*destination*customer******************   042844
      ************DELT*deletion*program*processing*********************   042844
      ************VALD*generate*message*for*destination*customer*?*****   042844
      *****************************************************************
      *
      **  Perform initial process
      *
     C                     EXSR INIT
      *                                                                                       CSW213
      ** Set WPRID = 'N'                                                                      CSW213
      *                                                                                       CSW213
     C                     MOVE 'N'       WPRID   1                                           CSW213
      *
      **  Read first confirmation extract record
      *
     C                     READ CONEXCY                  10
     C/COPY WNCPYSRC,DL6305C017
      *
      **  Do until EOF
      *
     C           *IN10     DOWEQ'0'
     C/COPY WNCPYSRC,DL6305C018
      *
      **  Set up generation driver file fields
      *
     C                     EXSR SETF
      *
      **  Access corresponding deal record
      *
     C           CDLNO     CHAINDEALS                11
     C                     MOVE CHTP      @CHG    1                                       CSW025
     C/COPY WNCPYSRC,DLH00436
      *
     C           *IN11     IFEQ '1'
     C           DRECI     ORNE 'D'
     C           DRECI     ANDNE'R'
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL6305CCP3                                           S01408
     C*                                                                   S01408
     C           *LOCK     IN   LDA
     C*********************MOVE '001'     DBASE            * * * * * * * *181719
     C*********************MOVELCDLNO     DBKEY            * DB ERROR 01 *181719
     C                     MOVE '991'     DBASE            * * * * * * * *181719
     C                     MOVELCDLNO     DBKEY            * DB ERROR 991*181719
     C                     MOVEL'DEALS'   DBFILE           * * * * * * * *
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END
     C/COPY WNCPYSRC,DL6305C001
      ********************************************************************081482
      ************************************************************* 081482086518
      **This*part*is*redundant*as*it*is*already*being*done*in*SR/MSG081482086518
      **************************************************************081482086518
      ********************************************************************081482
      ****Determine*message type                                          081482
      ***********                                                         081482
     C***********          EXSR TYPE                                      081482
      ***********                                                         081482
      ****Determine*destination*customer*address                          081482
      ***********                                                         081482
     C***********          EXSR DEST                                      081482
      ***********                                                         081482
      ****Generate*cancelation*message*for*reversals*and*amendments       081482
      ***********                                                         081482
     C***********CHTP      IFEQ 'R'                                       081482
     C***********CHTP      OREQ 'A'                                E29588 081482
     C***********          EXSR DELT                                      081482
     C***********          END                                            081482
      ***********                                                         081482
      ****Write*message*if*message*type*required*for*customer             081482
      ****or*a*reversed*deal*requiring a*'CANCEL'*confirmation            081482
      ***********                                                         081482
     C***********CHTP      IFNE 'R'                                       081482
     C***********MGCHTP    OREQ 'C'                                       081482
     C***********          EXSR VALD                                      081482
     C***********          END                                            081482
     C********************************************************************081482
      *   If Confirmation Matching is on, ensure that FRAs are only       CSW200
      *   processed when ISDA agreement type is set up                    CSW200
      *                                                                   CSW200
     C********** RPTI      IFEQ 'Y'                                                  CSW213 MD022052
      *                                                                                       CSW213
     C                     MOVELDTYP      KDTYP   2                                           CSW213
     C                     MOVELCDLNO     KDLNO  16                                           CSW213
      *                                                                                       CSW213
     C           RPIFKY    CHAINDLRPIFL1             13                                       CSW213
      *                                                                                       CSW213
     C           *IN13     IFEQ '0'                                                           CSW213
     C********** RPTI      ANDEQ'Y'                                                MD022052 MD023402
     C           RPTI      ANDNE' '                                                         MD023402
     C                     MOVE 'Y'       MGACMI                                              CSW213
     C**********           MOVE CNUM      MGPTYA                                     CSW213 MD022048
      *                                                                                       CSW213
     C********** WPRID     IFEQ 'N'                                                  CSW213 MD023402
     C           RPTI      IFEQ 'A'                                                         MD023402
     C                     MOVE RITRID    CNUM                                                CSW213
     C           RIPRED    IFNE *BLANKS                                                     MD023231
     C                     MOVEL'I'       RICHTP                                            MD023231
     C                     ENDIF                                                            MD023231
     C                     ELSE                                                               CSW213
     C           RPTI      IFEQ 'B'                                                         MD023402
     C                     MOVE RIPRED    CNUM                                                CSW213
     C                     MOVE 'R'       CHTP                                                CSW213
     C                     MOVELCDLNO     WDLNO   6                                         MD022579
     C                     MOVEL'C'       RICHTP                                            MD023231
     C                     MOVELRICHTP    MGCHTP                                            MD023231
     C           HSTKEY    KLIST                                                            MD022579
     C                     KFLD           WDLNO                                             MD022579
     C                     KFLD           RIPRED                                            MD022579
     C                     KFLD           SEQ     3                                         MD022579
     C                     MOVEL'999'     SEQ                                               MD022579
     C           HSTKEY    SETLLMGHISTL5                                                    MD022579
     C                     READPMGHISTL5                 14                                 MD022579
     C           *IN14     IFEQ '0'                                                         MD022579
     C                     MOVELHSSEQ     RICFNR                                            MD022579
     C                     ENDIF                                                            MD022579
     C                     ENDIF                                                              CSW213
     C                     ENDIF                                                            MD023402
      *                                                                                     MD022048
     C                     MOVE CNUM      MGPTYA                                            MD022048
      *                                                                                       CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
     C**********           ENDIF                                                     CSW213 MD022052
      *                                                                                       CSW213
     C           BGCFMT    IFEQ 'Y'                                       CSW200
     C           DTYP      ANDEQ'FR'                                      CSW200
     C           AGTY      ANDNE'ISDA'                                    CSW200
     C           AGTY      ANDNE'AFB'                                     CSW200
     C           AGTY      ANDNE'FRABBA'                                  CSW200
     C           AGTY      ANDNE'DERV'                                    CSW200
     C           AGTY      ANDNE'ISDACN'                                                      CSW214
     C           AGTY      ANDNE'    '                                    185667
     C                     MOVE 'Y'       WKSKIP  1                       CSW200
     C                     ELSE                                           CSW200
     C                     MOVE 'N'       WKSKIP  1                       CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
     C           WKSKIP    IFEQ 'N'                                       CSW200
      *                                                                   CSW200
      *   Determine message type                                          086518
      *                                                                   086518
     C                     EXSR TYPE                                      086518
      *                                                                   CDL008
      ** CLS Settlement                                                   CDL008
      *                                                                   CDL008
     C           CDL008    IFEQ 'Y'                                       CDL008
     C           @TYP      ANDEQ'300'                                     CDL008
     C                     MOVE CLSS      @CLSS   1                       CDL008
     C                     ELSE                                           CDL008
     C                     MOVE *BLANKS   @CLSS                           CDL008
     C                     ENDIF                                          CDL008
      *                                                                   086518
      *   Determine destination customer address                          086518
      *                                                                   086518
     C                     EXSR DEST                                      086518
      *                                                                   086518
      *   Generate cancelation message for reversals and amendments       086518
      *   Only for ISO Conf generation confirmation type (RCDT='D').      119626
      ****Do*not*execute*Cancellation*processing*if*Deal*is*MM.*DRCDT=C               199392 BUG7333
     C***********CHTP      IFEQ 'R'                                086518 119626
     C***********CHTP      OREQ 'A'                                086518 119626
     C           CHTP      IFEQ 'R'                                       119626
     C           CRCDT     ANDEQ'D'                                       119626
     C           CHTP      OREQ 'R'                                       185707
     C           CRCDT     ANDEQ'R'                                       185707
     C           CHTP      OREQ 'A'                                       119626
     C           CRCDT     ANDEQ'D'                                       119626
     C********** DRCDT     ANDNE'C'                                                   199392 BUG7333
     C           CSW025    IFNE 'Y'                                                           CSW025
     C           CHTP      OREQ 'R'                                                           209250
     C           CHTP      OREQ 'A'                                                         MD022034
     C                     EXSR DELT                                      086518
     C                     ENDIF                                                              CSW025
     C                     END                                            086518
      **************************************************************      CSW097             BUG7539
      ***If*the*deal*has*been*amended*and*the*previous*message*is***      CSW097             BUG7539
      ***not*yet*cancelled/acknowledged*(MGSG*is*neither*"2"*or*"3")      CSW097             BUG7539
      ***OR*if*this*is*a*newly*inserted*deal,*set*Last*Change*Type**      CSW097             BUG7539
      ***(MGCHTP)*on*extract*file*to*"I".***************************      CSW097             BUG7539
     C********** CSW005    IFEQ 'Y'                                       CSW097             BUG7539
     C********** DTYP      IFEQ 'FR'                                      CSW097             BUG7539
     C********** DTYP      OREQ 'RS'                                      CSW097             BUG7539
     C********** DTYP      OREQ 'RX'                                      CSW097             BUG7539
     C********** CHTP      IFEQ 'A'                                       CSW097             BUG7539
     C********** CRCDT     ANDEQ'D'                                       CSW097             BUG7539
     C********** MGCHTP    ANDEQ*BLANK                                    CSW097             BUG7539
     C********** CHTP      OREQ 'I'                                       CSW097             BUG7539
     C********** CRCDT     ANDEQ'D'                                       CSW097             BUG7539
     C**********           MOVE 'I'       MGCHTP                          CSW097             BUG7539
     C**********           ENDIF                                          CSW097             BUG7539
     C**********           ENDIF                                          CSW097             BUG7539
     C**********           ENDIF                                          CSW097             BUG7539
      *                                                                   086518
      *   Write message if message type required for customer             086518
      *   or a reversed deal requiring a 'CANCEL' confirmation            086518
      *                                                                   086518
     C***********CHTP      IFNE 'R'                                086518 119626
     C***********MGCHTP    OREQ 'C'                                086518 119626
     C           CHTP      IFNE 'R'                                       119626
     C           CRCDT     ANDEQ'D'                                       119626
     C           CHTP      ORNE 'R'                                       134246
     C           CRCDT     ANDEQ'R'                                       134246
     C           MGCHTP    OREQ 'C'                                       185707
     C           CRCDT     ANDEQ'R'                                       185707
     C           MGCHTP    OREQ 'C'                                       119626
     C           CRCDT     ANDEQ'D'                                       119626
     C                     EXSR VALD                                      086518
     C                     END                                            086518
      *                                                                                      BUG5646
      ** If MMM switched ON and settlement is changed from SWIFT to                          BUG5646
      ** non-SWIFT check if there are pay/rec previously generated.                          BUG5646
      *                                                                                      BUG5646
     C                     MOVE 'N'       PRXST                                              BUG5646
     C                     MOVE 'N'       PRMNI   1                                         AR582922
     C                     MOVE 'N'       PRMUL   1                                           242622
     C           CSW025    IFEQ 'Y'                                                          BUG5646
     C           CHTP      ANDEQ'A'                                                          BUG5646
     C           DRCDT     IFEQ 'B'                                                          BUG5646
     C           DRCDT     OREQ 'C'                                                          BUG5646
     C           DRCDT     OREQ 'D'                                                          BUG5646
     C           DRCDT     OREQ 'E'                                                          BUG5646
     C                     EXSR CHKNSW                                                       BUG5646
      *                                                                                     AR582922
     C           CSW025    IFEQ 'Y'                                                         AR582922
     C           CHTP      ANDEQ'A'                                                         AR582922
     C           DRCDT     ANDEQ'C'                                                         AR582922
     C                     EXSR CHKMNI                                                      AR582922
     C                     ENDIF                                                            AR582922
      *                                                                                       242622
     C           CSW050    IFEQ 'Y'                                                           242622
     C                     EXSR CHKMUL                                                        242622
     C                     ENDIF                                                              242622
      *                                                                                       242622
     C                     ENDIF                                                             BUG5646
     C                     ENDIF                                                             BUG5646
      *                                                                                     AR916823
      ** Check if a new Pay/Rec message will be produced and                                AR916823
      ** if there are pay/rec previously generated that needs                               AR916823
      ** to be Cancelled/Deleted                                                            AR916823
      *                                                                                     AR916823
     C           CSW025    IFEQ 'Y'                                                         AR916823
     C           DRCDT     ANDEQ'C'                                                         AR916823
     C           PRXST     ANDNE'Y'                                                         AR916823
     C           PRMNI     ANDNE'Y'                                                         AR916823
     C           PRMUL     ANDNE'Y'                                                         AR916823
     C                     EXSR CHKMSG                                                      AR916823
     C                     ENDIF                                                            AR916823
      *                                                                                       240603
      ** If record type is 'B' and Buy or Net Indicators are 'Y',                             240603
      ** check messages for cancellation                                                      240603
      *                                                                                       240603
     C           NETBY     IFEQ 'Y'                                                           240603
     C           NETSL     OREQ 'Y'                                                           240603
     C                     EXSR CHKNET                                                        240603
     C                     END                                                                240603
      *                                                                                       242587
      ** If FRA record is amended, cancel the previous message                                242587
      *                                                                                       242587
     C           CSW005    IFEQ 'Y'                                                           242587
     C           CHTP      ANDEQ'A'                                                           242587
     C           CRCDT     ANDEQ'D'                                                           242587
     C           CSW025    ANDEQ'Y'                                                           242587
     C                     EXSR CHKFRA                                                        242587
     C                     END                                                                242587
     C*                                                                   119626
     C* Process CONEXCY record for cancellation/deletion required         119626
     C* for all other type of confirmations.                              119626
     C**Do*not*execute*Cancellation*processing*if*Deal*is*MM.*DRCDT=C                 199392 BUG7333
     C*********  DRCDT     IFNE 'C'                                                   199392 BUG7333
     C           CRCDT     IFEQ 'X'                                       119626
     C           CSW025    OREQ 'Y'                                                          BUG5646
     C           CSW025    IFNE 'Y'                                                           CSW025
     C           CHTP      OREQ 'R'                                                           209250
     C           CSW025    OREQ 'Y'                                                          BUG5646
     C           PRXST     ANDEQ'Y'                                                          BUG5646
     C           CHTP      ANDEQ'A'                                                          BUG5646
     C           CSW025    OREQ 'Y'                                                         AR582922
     C           PRMNI     ANDEQ'Y'                                                         AR582922
     C           CHTP      ANDEQ'A'                                                         AR582922
     C           CSW025    OREQ 'Y'                                                           242622
     C********** PRMUL     ANDEQ'Y'                                                    242622 246801
     C           CSW050    ANDEQ'Y'                                                           246801
     C           CHTP      ANDEQ'A'                                                           242622
     C           CSW025    OREQ 'Y'                                                         AR916823
     C           WMSG      ANDEQ'Y'                                                         AR916823
     C                     EXSR DELT2                                     119626
     C                     ENDIF                                                              CSW025
     C                     END                                            119626
     C**********           ENDIF                                                      199392 BUG7333
     C*                                                                   086518
     C***********                                                   042844077558
     C***Produce*message*for*deal*on*extract*record*****************042844077558
     C***********                                                   042844077558
     C***********          EXSR MSG                                 042844077558
     C***********                                                   042844079135
     C***System*should*cancel*messages*for*the*rolled*over*deal.****042844079135
     C***********                                                   042844079135
     C***********CRCDT     IFEQ 'R'                                 042844079135
     C***********                                                   042844079135
     C***********          MOVE RODN      CDLNO                     042844079135
     C***********                                                   042844079135
     C****Access*corresponding*deal*record**************************042844079135
     C***********                                                   042844079135
     C***********CDLNO     CHAINDEALS                11             042844079135
     C***********                                                   042844079135
     C************IN11     IFEQ '1'                                 042844079135
     C***********DRECI     ORNE 'D'                                 042844079135
     C***********DRECI     ANDNE'R'                                 042844079135
     C************LOCK     IN   LDA                                 042844079135
     C***********          MOVE '001'     DBASE      * * * * * * * *042844079135
     C***********          MOVELCDLNO     DBKEY      * DB ERROR 01 *042844079135
     C***********          MOVEL'DEALS'   DBFILE     * * * * * * * *042844079135
     C***********          OUT  LDA                                 042844079135
     C***********          EXSR *PSSR                               042844079135
     C***********          END                                      042844079135
     C***********                                                   042844079135
     C***Produce*message*for*rolled*over*deal***********************042844079135
     C***********                                                   042844079135
     C***********          EXSR MSG                                 042844079135
     C***********                                                   042844079135
     C***********          END                                      042844079135
     C/COPY WNCPYSRC,DL6305C019
      *
     C                     ENDIF                                          CSW200
      *                                                                                       CSW213
     C********** RPTI      IFEQ 'Y'                                                  CSW213 MD023402
     C********** RIPRED    ANDNE*BLANKS                                              CSW213 MD023402
     C********** WPRID     ANDEQ'N'                                                  CSW213 MD023402
      **********                                                                     CSW213 MD023402
     C**********                                                                   MD022751 MD023402
     C**********           MOVEL*BLANKS   REPOID 10                                MD022751 MD023402
     C**********           MOVELRIPRED    REPOID                                   MD022751 MD023402
     C**********           CALL 'AOCSSWR0'                                         MD022751 MD023402
     C**********           PARM *BLANKS   PRTCD   7                                MD022751 MD023402
     C**********           PARM '*KEY   ' POPTN   7                                MD022751 MD023402
     C**********           PARM REPOID    PKEY1  10                                MD022751 MD023402
     C**********           PARM *BLANKS   PKYST   7                                MD022751 MD023402
     C********** SDCUST    PARM SDCUST    DSLDY                                    MD022751 MD023402
     C********** BBCSID    IFNE *BLANKS                                            MD022751 MD023402
     C**********           MOVE 'Y'       WPRID                                      CSW213 MD023402
     C**********           ITER                                                      CSW213 MD023402
     C**********           ENDIF                                                   MD022751 MD023402
      **********                                                                     CSW213 MD023402
     C**********           ENDIF                                                     CSW213 MD023402
      *                                                                   CSW200
      **  Read next confirmation extract record
      *
     C                     READ CONEXCY                  10
      *                                                                                       CSW213
     C**********           MOVE 'N'       WPRID                                      CSW213 MD023402
      *
     C                     END
     C/COPY WNCPYSRC,DL6305C020
      *
      **  Terminate program
      *
     C                     SETON                     LR
      *
     C/EJECT                                                              042844
     C*****************************************************************   042844
     C*   MSG  - produce message subroutine                           *   042844
     C*   Called by - main process                                    *   042844
     C*   Calls   TYPE determine message type                         *   042844
     C*           DEST determine destination customer                 *   042844
     C*           DELT deletion program processing                    *   042844
     C*           VALD generate message for destination*customer ?    *   042844
     C*****************************************************************   042844
     C*                                                                   042844
     C           MSG       BEGSR                                          042844
     C*                                                                   042844
     C**  Determine message type                                          042844
     C*                                                                   042844
     C                     EXSR TYPE                                      042844
     C*                                                                   042844
     C**  Determine destination customer address                          042844
     C*                                                                   042844
     C                     EXSR DEST                                      042844
     C*                                                                   042844
     C**  Generate cancelation message for reversals and amendments       042844
     C*                                                                   042844
     C***********CHTP      IFEQ 'R'                                 042844077558
     C***********CHTP      OREQ 'A'                                 042844077558
     C***********CRCDT     OREQ 'R'                                 042844077558
     C           CSW025    IFNE 'Y'                                                           CSW025
     C           CHTP      OREQ 'R'                                                           209250
     C                     EXSR DELT                                      042844
     C                     ENDIF                                                              CSW025
     C***********          END                                      042844077558
     C*                                                                   042844
     C**  Write message if message type required for customer             042844
     C**  or a reversed deal requiring a 'CANCEL' confirmation            042844
     C*                                                                   042844
     C***********CHTP      IFNE 'R'                                 042844077558
     C***********MGCHTP    OREQ 'C'                                 042844077558
     C***********CRCDT     OREQ 'R'                                 042844077558
     C           @RTNC     IFNE 'C'                                       077558
     C                     EXSR VALD                                      042844
     C                     END                                            042844
     C*                                                                   042844
     C                     ENDSR                                          042844
     C*****************************************************************   042844
     C/EJECT
      *****************************************************************
      *   INIT - inital process                                       *
      *   Called by - main process                                    *
      *****************************************************************
      *
     C           INIT      BEGSR
      *
     C                     MOVEACPY@      BIS@   80
      *
      **  Set up LDA
      *
     C           *NAMVAR   DEFN           LDA
     C           *LOCK     IN   LDA
     C                     MOVE *BLANKS   DBFILE
     C                     MOVE *BLANKS   DBKEY
     C                     MOVE *BLANKS   DBPGM
     C                     MOVEL'DL6305'  DBPGM
     C                     MOVE *BLANKS   DBASE
     C                     OUT  LDA
      *
      **  Access SDBANKPD for report title
      *
     C                     CALL 'AOBANKR0'
     C                     PARM '*MSG   ' @RTCD   7
     C                     PARM '*FIRST ' @OPTN   7
     C           SDBANK    PARM SDBANK    DSFDY
     C*
     C           @RTCD     IFNE *BLANKS
     C           *LOCK     IN   LDA
     C                     MOVE '002'     DBASE            * * * * * * * *
     C                     MOVEL'FIRST'   DBKEY            * DB ERROR 02 *
     C                     MOVEL'SDBANKPD'DBFILE           * * * * * * * *
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END
      *
      **  Access RUNDAT to find run date & multibranching indicator
      *
     C           *NAMVAR   DEFN RUNDAT    DSRUN
     C           *LOCK     IN   DSRUN
     C                     OUT  DSRUN
      *
      **  Access MIDAS modules file
      *
     C                     CALL 'AOMMODR0'
     C                     PARM '*MSG   ' @RTCD   7
     C                     PARM '*FIRST ' @OPTN   7
     C           SDMMOD    PARM SDMMOD    DSFDY
     C*
     C           @RTCD     IFNE *BLANKS
     C           *LOCK     IN   LDA
     C                     MOVE '012'     DBASE            * * * * * * * *
     C                     MOVEL'CONFS'   DBKEY            * DB ERROR 12 *
     C                     MOVEL'SDMMODPD'DBFILE           * * * * * * * *
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END
      *
     C**  Access Switchable Features file for Enhanced Rollovers          077898
     C*                                                                   077898
     C                     CALL 'AOSARDR0'                                077898
     C                     PARM *BLANKS   @RTCD                           077898
     C                     PARM '*VERIFY' @OPTN                           077898
     C                     PARM 'S01434'  @SARD   6                       077898
     C           SCSARD    PARM SCSARD    DSFDY                           077898
     C*                                                                   077898
     C           @RTCD     IFEQ *BLANKS                                   077898
     C                     MOVEL'Y'       S01434  1                       077898
     C                     ELSE                                           077898
     C                     MOVEL'N'       S01434  1                       077898
     C                     END                                            077898
     C/COPY WNCPYSRC,DL6305C002
      *                                                                   CSW005
      **  Access Switchable Features file for FRA/IRS Msg Generation.     CSW005
      *                                                                   CSW005
     C                     CALL 'AOSARDR0'                                CSW005
     C                     PARM *BLANKS   @RTCD                           CSW005
     C                     PARM '*VERIFY' @OPTN                           CSW005
     C                     PARM 'CSW005'  @SARD                           CSW005
     C           SCSARD    PARM SCSARD    DSFDY                           CSW005
      *                                                                   CSW005
     C           @RTCD     IFEQ *BLANKS                                   CSW005
     C                     MOVEL'Y'       CSW005  1                       CSW005
     C                     ELSE                                           CSW005
     C           @RTCD     IFEQ '*NRF   '                                 CSW005
     C                     MOVEL'N'       CSW005                          CSW005
     C                     ELSE                                           CSW005
     C           *LOCK     IN   LDA                                       CSW005
     C                     MOVE '014'     DBASE            * * * * * * * *CSW005
     C                     MOVEL@SARD     DBKEY            * DB ERROR 14 *CSW005
     C                     MOVEL'SCSARDPD'DBFILE           * * * * * * * *CSW005
     C                     OUT  LDA                                       CSW005
     C                     EXSR *PSSR                                     CSW005
     C                     ENDIF                                          CSW005
     C                     ENDIF                                          CSW005
      *                                                                   CSW011
      **  Access Switchable Features file for CSW011                      CSW011
      *                                                                   CSW011
     C                     CALL 'AOSARDR0'                                CSW011
     C                     PARM *BLANKS   @RTCD                           CSW011
     C                     PARM '*VERIFY' @OPTN                           CSW011
     C                     PARM 'CSW011'  @SARD                           CSW011
     C           @RTCD     IFEQ *BLANKS                                   CSW011
     C                     MOVEL'Y'       CSW011  1                       CSW011
     C                     ELSE                                           CSW011
     C                     MOVEL'N'       CSW011                          CSW011
     C                     ENDIF                                          CSW011
      *                                                                   CSW012
      **  Access Switchable Features file for CSW012                      CSW012
      *                                                                   CSW012
     C                     CALL 'AOSARDR0'                                CSW012
     C                     PARM *BLANKS   @RTCD                           CSW012
     C                     PARM '*VERIFY' @OPTN                           CSW012
     C                     PARM 'CSW012'  @SARD                           CSW012
     C           @RTCD     IFEQ *BLANKS                                   CSW012
     C                     MOVEL'Y'       CSW012  1                       CSW012
     C                     ELSE                                           CSW012
     C                     MOVEL'N'       CSW012                          CSW012
     C                     ENDIF                                          CSW012
      *                                                                   CSW005
      **  Open files for CSW005 if *ON.                                   CSW005
      *                                                                   CSW005
     C           CSW005    IFEQ 'Y'                                       CSW005
     C           CSW011    OREQ 'Y'                                       CSW011
      *                                                                   CSW011
     C                     OPEN MGF340PD                                  CSW005
     C           CSW005    IFEQ 'Y'                                       CSW011
     C                     OPEN MGX360PD                                  CSW005
     C                     OPEN MGX361PD                                  CSW005
     C                     OPEN MGU36NPD                                  CSW097
     C                     OPEN MGV36NPD                                  CSW097
     C                     OPEN MGW36NPD                                  CSW097
     C                     OPEN MGY36NPD                                  CSW005
     C                     OPEN MGZ36NPD                                  CSW005
     C                     OPEN MGX36NPD                                  CSW097
     C                     OPEN MGY36NL0                                  CSW097
      *                                                                   CSW097
      **  Declare KLIST to access LF/MGY36NL0                             CSW097
     C           MGYKY     KLIST                                          CSW097
     C                     KFLD           MGSEQN                          CSW097
     C                     KFLD           MGMSSQ                          CSW097
     C                     KFLD           MGCDAT                          CSW097
      *                                                                   CSW097
      **  Declare KLIST to access PF/MGV36NPD                             CSW097
     C           MGVKY     KLIST                                          CSW097
     C                     KFLD           MGSEQN                          CSW097
     C                     KFLD           MGMSSQ                          CSW097
     C                     KFLD           K@VDAT  50                      CSW097
      *                                                                   CSW005
      **  Access Switchable Features file for Interest Rate Calendar.     CSW005
      *                                                                   CSW005
     C                     CALL 'AOSARDR0'                                CSW005
     C                     PARM *BLANKS   @RTCD                           CSW005
     C                     PARM '*VERIFY' @OPTN                           CSW005
     C                     PARM 'CIR001'  @SARD                           CSW005
     C           SCSARD    PARM SCSARD    DSFDY                           CSW005
      *                                                                   CSW005
     C           @RTCD     IFEQ *BLANKS                                   CSW005
     C                     MOVEL'Y'       CIR001  1                       CSW005
     C                     ELSE                                           CSW005
     C           @RTCD     IFEQ '*NRF   '                                 CSW005
     C                     MOVEL'N'       CIR001                          CSW005
     C                     ELSE                                           CSW005
     C           *LOCK     IN   LDA                                       CSW005
     C                     MOVE '015'     DBASE            * * * * * * * *CSW005
     C                     MOVEL@SARD     DBKEY            * DB ERROR 15 *CSW005
     C                     MOVEL'SCSARDPD'DBFILE           * * * * * * * *CSW005
     C                     OUT  LDA                                       CSW005
     C                     EXSR *PSSR                                     CSW005
     C                     ENDIF                                          CSW005
     C                     ENDIF                                          CSW005
      *                                                                   CSW005
      **  Access Switchable Features file for Interest Compounding        CSW005
      *                                                                   CSW005
     C                     CALL 'AOSARDR0'                                CSW005
     C                     PARM *BLANKS   @RTCD                           CSW005
     C                     PARM '*VERIFY' @OPTN                           CSW005
     C                     PARM 'CIR002'  @SARD                           CSW005
     C           SCSARD    PARM SCSARD    DSFDY                           CSW005
      *                                                                   CSW005
     C           @RTCD     IFEQ *BLANKS                                   CSW005
     C                     MOVEL'Y'       CIR002  1                       CSW005
     C                     ENDIF                                          CSW005
     C/COPY WNCPYSRC,DL6305C033
      *                                                                   CDL006
      ** Access Switchable Features file to check if Dealing Fiducia      CDL006
      ** ry is installed.                                                 CDL006
      *                                                                   CDL006
     C                     MOVE 'N'       CDL006  1                       CDL006
     C                     CALL 'AOSARDR0'                                CDL006
     C                     PARM *BLANKS   WRTCD   7                       CDL006
     C                     PARM '*VERIFY' WOPTN   7                       CDL006
     C                     PARM 'CDL006'  WSARD   6                       CDL006
     C           SCSARD    PARM SCSARD    DSFDY                           CDL006
      *                                                                   CDL006
     C           WRTCD     IFNE *BLANKS                                   CDL006
     C           WRTCD     ANDNE'*NRF   '                                 CDL006
     C           *LOCK     IN   LDA                                       CDL006
     C                     Z-ADD043       DBASE             ************* CDL006
     C                     MOVEL'SCSARDPD'DBFILE            * DBERR 043 * CDL006
     C                     MOVELWRTCD     DBKEY             ************* CDL006
     C                     OUT  LDA                                       CDL006
     C                     EXSR *PSSR                                     CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
     C           WRTCD     IFEQ *BLANK                                    CDL006
     C                     MOVEL'Y'       CDL006                          CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CSW005
     C********** CIR001    IFEQ 'Y'                                CSW005 192081
      *                                                                   CSW005
     C                     OPEN DLDTSCPD                                  CSW005
     C                     OPEN DLCFSCPD                                  CSW005
     C                     OPEN DLPCSCPD                                  CSW005
     C                     OPEN DLPCSCL0                                  CSW097
      *                                                                   192081
     C           CIR001    IFEQ 'Y'                                       192081
      *                                                                   CSW005
      **  Declare keylists for these files                                CSW005
     C           IRCKY1    KLIST                                          CSW005
     C                     KFLD           DDLNO                           CSW005
     C                     KFLD           @OTIN   1                       CSW005
     C                     KFLD           @PRDT   50                      CSW005
     C           IRCKY2    KLIST                                          CSW005
     C                     KFLD           DDLNO                           CSW005
     C                     KFLD           @OTIN                           CSW005
     C                     KFLD           @RCIP   1                       CSW005
     C                     KFLD           @PRDT                           CSW005
     C           AMRKY     KLIST                                          CSW005
     C                     KFLD           DDLNO                           CSW005
     C                     KFLD           WOTIN   1                       CSW005
      *                                                                   CSW005
     C                     ENDIF                                          CSW005
     C                     ENDIF                                          CSW011
      *                                                                   CSW005
      **  Initialise Sequence Number for MT360 and MT361.                 CSW005
      *                                                                   CSW005
     C                     Z-ADD0         MGSEQN                          CSW005
      *                                                                   CSW005
      **  Access General Ledger Details.                                  CSW005
      *                                                                   CSW005
     C**********           CALL 'AOGELRR0'                                             CSW005 CGL029
     C                     CALL 'AOGELRR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD                           CSW005
     C                     PARM '*FIRST ' @OPTN                           CSW005
     C********** SDGELR    PARM SDGELR    DSFDY                                        CSW005 CGL029
     C           SDGELR    PARM SDGELR    DSSDY                                               CGL029
     C*                                                                   CSW005
     C           @RTCD     IFNE *BLANKS                                   CSW005
     C           *LOCK     IN   LDA                                       CSW005
     C                     MOVE '016'     DBASE            * * * * * * * *CSW005
     C                     MOVEL@OPTN     DBKEY            * DB ERROR 16 *CSW005
     C                     MOVEL'SDGELRPD'DBFILE           * * * * * * * *CSW005
     C                     OUT  LDA                                       CSW005
     C                     EXSR *PSSR                                     CSW005
     C                     ENDIF                                          CSW005
      *                                                                                      BUG7354
      ** Check FRA/IRS Module indicator in SDMMODPD file                                     BUG7354
      *                                                                                      BUG7354
     C           BGFIIN    IFEQ 'Y'                                                          BUG7354
      *                                                                   CSW005
      ** Call Access Program for FRA/IRS I.C.D. details                   CSW005
      *                                                                   CSW005
     C                     CALL 'AOFAISR0'                                CSW005
     C                     PARM '*MSG   ' @RTCD                           CSW005
     C                     PARM '*FIRST ' @OPTN                           CSW005
     C           SDFAIS    PARM SDFAIS    DSFDY                           CSW005
     C*                                                                   CSW005
     C           @RTCD     IFNE *BLANKS                                   CSW005
     C           *LOCK     IN   LDA                                       CSW005
     C                     MOVE '037'     DBASE            * * * * * * * *CSW005
     C                     MOVEL@OPTN     DBKEY            * DB ERROR 37 *CSW005
     C                     MOVEL'SDFAISPD'DBFILE           * * * * * * * *CSW005
     C                     OUT  LDA                                       CSW005
     C                     EXSR *PSSR                                     CSW005
     C                     ENDIF                                          CSW005
      *                                                                                      BUG7354
     C                     ENDIF                                                             BUG7354
      *                                                                   CSW005
      ** Call Access Program for Trading details                          CSW005
      *                                                                   CSW005
     C                     CALL 'AOTRADR0'                                CSW005
     C                     PARM '*MSG   ' @RTCD                           CSW005
     C                     PARM '*FIRST ' @OPTN                           CSW005
     C           SDTRAD    PARM SDTRAD    DSFDY                           CSW005
     C*                                                                   CSW005
     C           @RTCD     IFNE *BLANKS                                   CSW005
     C           *LOCK     IN   LDA                                       CSW005
     C                     MOVE '038'     DBASE            * * * * * * * *CSW005
     C                     MOVEL@OPTN     DBKEY            * DB ERROR 38 *CSW005
     C                     MOVEL'SDTRADPD'DBFILE           * * * * * * * *CSW005
     C                     OUT  LDA                                       CSW005
     C                     EXSR *PSSR                                     CSW005
     C                     ENDIF                                          CSW005
      ***********                                                  137909 143362
      ****Access Switchable Features file for CEU003               137909 143362
      ***********                                                  137909 143362
     C***********          CALL 'AOSARDR0'                         137909 143362
     C***********          PARM *BLANKS   @RTCD                    137909 143362
     C***********          PARM '*VERIFY' @OPTN                    137909 143362
     C***********          PARM 'CEU003'  @SARD   6                137909 143362
     C***********@RTCD     IFEQ *BLANKS                            137909 143362
     C***********          MOVEL'Y'       CEU003  1                137909 143362
     C***********          ELSE                                    137909 143362
     C***********          MOVEL'N'       CEU003                   137909 143362
     C***********          ENDIF                                   137909 143362
      *                                                                   CSW005
     C                     ENDIF                                          CSW005
      *                                                                   143362
      **  Access Switchable Features file for CEU003                      143362
      *                                                                   143362
     C                     CALL 'AOSARDR0'                                143362
     C                     PARM *BLANKS   @RTCD                           143362
     C                     PARM '*VERIFY' @OPTN                           143362
     C                     PARM 'CEU003'  @SARD   6                       143362
     C           @RTCD     IFEQ *BLANKS                                   143362
     C                     MOVEL'Y'       CEU003  1                       143362
     C                     ELSE                                           143362
     C                     MOVEL'N'       CEU003                          143362
     C                     ENDIF                                          143362
      *                                                                   CEU015
      **  Access SAR details file to see if CEU015 SAR is installed.      CEU015
      *                                                                   CEU015
     C                     CALL 'AOSARDR0'                                CEU015
     C                     PARM *BLANKS   @RTCD   7                       CEU015
     C                     PARM '*VERIFY' @OPTN   7                       CEU015
     C                     PARM 'CEU015'  @SARD   6                       CEU015
     C*                                                                   CEU015
     C           @RTCD     IFEQ *BLANK                                    CEU015
     C                     MOVE 'Y'       CEU015  1                       CEU015
     C                     ELSE                                           CEU015
     C                     MOVE 'N'       CEU015                          CEU015
     C                     ENDIF                                          CEU015
      *                                                                   CDL008
      ** Check if CDL008 (Continuous Linked Settlement) is installed.     CDL008
      *                                                                   CDL008
     C                     MOVE 'N'       CDL008  1                       CDL008
     C                     CALL 'AOSARDR0'                                CDL008
     C                     PARM *BLANKS   WRTCD                           CDL008
     C                     PARM '*VERIFY' WOPTN                           CDL008
     C                     PARM 'CDL008'  WSARD                           CDL008
     C           SCSARD    PARM SCSARD    DSFDY                           CDL008
      *                                                                   CDL008
     C           WRTCD     IFNE *BLANKS                                   CDL008
     C           WRTCD     ANDNE'*NRF   '                                 CDL008
     C           *LOCK     IN   LDA                                       CDL008
     C                     Z-ADD044       DBASE             ************* CDL008
     C                     MOVEL'SCSARDPD'DBFILE            * DBERR 044 * CDL008
     C                     MOVELWSARD     DBKEY             ************* CDL008
     C                     OUT  LDA                                       CDL008
     C                     EXSR *PSSR                                     CDL008
     C                     ENDIF                                          CDL008
     C           WRTCD     IFEQ *BLANK                                    CDL008
     C                     MOVEL'Y'       CDL008                          CDL008
     C                     ENDIF                                          CDL008
     C**                                                                                      CIR017
      ** Check if CIR017 - Separate Business Day Convention for SIRS                          CIR017
     C                     CALL 'AOSARDR0'                                                    CIR017
     C                     PARM *BLANKS   PRTCD                                               CIR017
     C                     PARM '*VERIFY' POPTN                                               CIR017
     C                     PARM 'CIR017'  PSARD                                               CIR017
     C           SCSARD    PARM SCSARD    DSFDY                                               CIR017
      **                                                                                      CIR017
     C           PRTCD     IFEQ *BLANKS                                                       CIR017
     C                     MOVE 'Y'       CIR017  1                                           CIR017
     C                     ELSE                                                               CIR017
     C                     MOVE 'N'       CIR017                                              CIR017
     C                     ENDIF                                                              CIR017
      *                                                                                       CIR017
      *                                                                   CIR004
      ** Access Switchable Features file to check if Dealing Calcula      CIR004
      ** tion Method Change enhancement is installed.                     CIR004
      *                                                                   CIR004
     C                     MOVE 'N'       CIR004  1                       CIR004
     C                     CALL 'AOSARDR0'                                CIR004
     C                     PARM *BLANKS   WRTCD                           CIR004
     C                     PARM '*VERIFY' WOPTN                           CIR004
     C                     PARM 'CIR004'  WSARD                           CIR004
     C           SCSARD    PARM SCSARD    DSFDY                           CIR004
      *                                                                   CIR004
     C           WRTCD     IFNE *BLANKS                                   CIR004
     C           WRTCD     ANDNE'*NRF   '                                 CIR004
     C           *LOCK     IN   LDA                                       CIR004
     C                     Z-ADD058       DBASE             ************* CIR004
     C                     MOVEL'SCSARDPD'DBFILE            * DBERR 058 * CIR004
     C                     MOVEL'CIR004'  DBKEY             ************* CIR004
     C                     OUT  LDA                                       CIR004
     C                     EXSR *PSSR                                     CIR004
     C                     ENDIF                                          CIR004
      *                                                                   CIR004
     C           WRTCD     IFEQ *BLANK                                    CIR004
     C                     MOVEL'Y'       CIR004                          CIR004
     C                     ENDIF                                          CIR004
      *                                                                   CIR005
      **  Access Switchable Features file for CIR005                      CIR005
      *                                                                   CIR005
     C                     CALL 'AOSARDR0'                                CIR005
     C                     PARM *BLANKS   PRTCD   7                       CIR005
     C                     PARM '*VERIFY' POPTN   7                       CIR005
     C                     PARM 'CIR005'  PSARD   6                       CIR005
      *                                                                   CIR005
     C           PRTCD     IFNE *BLANKS                                   CIR005
     C           PRTCD     ANDNE'*NRF   '                                 CIR005
     C           *LOCK     IN   LDA                                       CIR005
     C                     MOVEL'SCSARDPD'DBFILE           ***************CIR005
     C                     MOVEL'020'     DBASE            * DB ERROR 20 *CIR005
     C                     MOVEL'CIR005'  DBKEY            ***************CIR005
     C                     EXSR *PSSR                                     CIR005
     C                     OUT  LDA                                       CIR005
     C                     ENDIF                                          CIR005
      *                                                                   CIR005
     C           PRTCD     IFEQ *BLANKS                                   CIR005
     C                     MOVEL'Y'       CIR005  1                       CIR005
     C                     ELSE                                           CIR005
     C                     MOVEL'N'       CIR005                          CIR005
     C                     ENDIF                                          CIR005
      *                                                                   CIR006
      ** Check if switchable feature CIR006 is switched on                CIR006
      *                                                                   CIR006
     C                     CALL 'AOSARDR0'                                CIR006
     C                     PARM *BLANKS   @RTCD                           CIR006
     C                     PARM '*VERIFY' @OPTN                           CIR006
     C                     PARM 'CIR006'  @SARD   6                       CIR006
     C           SCSARD    PARM SCSARD    DSFDY                           CIR006
     C*                                                                   CIR006
     C           @RTCD     IFNE *BLANK                                    CIR006
     C           @RTCD     ANDNE'*NRF   '                                 CIR006
     C                     MOVEL'SCSARDPD'DBFILE           ***************CIR006
     C                     MOVEL'61'      DBASE            * DB ERROR 61 *CIR006
     C                     MOVEL'CIR006'  DBKEY            ***************CIR006
     C                     EXSR *PSSR                                     CIR006
     C                     ENDIF                                          CIR006
      *                                                                   CIR006
     C           @RTCD     IFEQ *BLANKS                                   CIR006
     C                     MOVE 'Y'       CIR006  1                       CIR006
     C                     ELSE                                           CIR006
     C                     MOVE 'N'       CIR006                          CIR006
     C                     ENDIF                                          CIR006
      *                                                                   CIR005
      ** Is CSW025 installed?                                                                 CSW025
      *                                                                                       CSW025
     C                     CALL 'AOSARDR0'                                                    CSW025
     C                     PARM '       ' @RTCD                                               CSW025
     C                     PARM '*VERIFY' @OPTN                                               CSW025
     C                     PARM 'CSW025'  @SARD                                               CSW025
     C           @RTCD     IFNE *BLANK                                                        CSW025
     C           @RTCD     ANDNE'*NRF   '                                                     CSW025
     C                     MOVEL'SCSARDPD'DBFILE                                              CSW025
     C                     MOVEL'020'     DBASE                                               CSW025
     C                     MOVEL@RTCD     DBKEY                                               CSW025
     C                     MOVE *ON       *INU7                                               CSW025
     C                     MOVE *ON       *INU8                                               CSW025
     C                     EXSR *PSSR                                                         CSW025
     C                     ENDIF                                                              CSW025
     C           @RTCD     IFEQ *BLANK                                                        CSW025
     C                     MOVE 'Y'       CSW025  1                                           CSW025
     C                     ENDIF                                                              CSW025
      *                                                                                       CSW025
      ** Is CSW050 installed?                                                                 242622
      *                                                                                       242622
     C                     CALL 'AOSARDR0'                                                    242622
     C                     PARM '       ' @RTCD                                               242622
     C                     PARM '*VERIFY' @OPTN                                               242622
     C                     PARM 'CSW050'  @SARD                                               242622
     C           @RTCD     IFNE *BLANK                                                        242622
     C           @RTCD     ANDNE'*NRF   '                                                     242622
     C                     MOVEL'SCSARDPD'DBFILE                                              242622
     C                     MOVEL'021'     DBASE                                               242622
     C                     MOVEL@RTCD     DBKEY                                               242622
     C                     MOVE *ON       *INU7                                               242622
     C                     MOVE *ON       *INU8                                               242622
     C                     EXSR *PSSR                                                         242622
     C                     ENDIF                                                              242622
     C           @RTCD     IFEQ *BLANK                                                        242622
     C                     MOVE 'Y'       CSW050  1                                           242622
     C                     ENDIF                                                              242622
      *                                                                                       242622
      ** Access Switchable Feature file for CGL031.                                           234068
      *                                                                                       234068
     C                     CALL 'AOSARDR0'                                                    234068
     C                     PARM *BLANKS   PRTCD   7                                           234068
     C                     PARM '*VERIFY' POPTN   7                                           234068
     C                     PARM 'CGL031'  PSARD   6                                           234068
      *                                                                                       234068
     C           PRTCD     IFNE *BLANKS                                                       234068
     C           PRTCD     ANDNE'*NRF   '                                                     234068
     C           *LOCK     IN   LDA                                                           234068
     C                     MOVEL'SCSARDPD'DBFILE           ***************                    234068
     C                     MOVEL'020'     DBASE            * DB ERROR 20 *                    234068
     C                     MOVEL'CGL031'  DBKEY            ***************                    234068
     C                     EXSR *PSSR                                                         234068
     C                     OUT  LDA                                                           234068
     C                     ENDIF                                                              234068
      *                                                                                       234068
     C           PRTCD     IFEQ *BLANKS                                                       234068
     C                     MOVEL'Y'       CGL031  1                                           234068
     C                     ELSE                                                               234068
     C                     MOVEL'N'       CGL031                                              234068
     C                     ENDIF                                                              234068
      *                                                                                       234068
      ** Check if switchable feature CIR014 is ON                                             CIR014
      *                                                                                       CIR014
     C                     CALL 'AOSARDR0'                                                    CIR014
     C                     PARM '       ' @RTCD                                               CIR014
     C                     PARM '*VERIFY' @OPTN                                               CIR014
     C                     PARM 'CIR014'  @SARD                                               CIR014
     C           @RTCD     IFNE *BLANK                                                        CIR014
     C           @RTCD     ANDNE'*NRF   '                                                     CIR014
     C                     MOVEL'SCSARDPD'DBFILE                                              CIR014
     C                     MOVEL'021'     DBASE                                               CIR014
     C                     MOVEL@RTCD     DBKEY                                               CIR014
     C                     MOVE *ON       *INU7                                               CIR014
     C                     MOVE *ON       *INU8                                               CIR014
     C                     EXSR *PSSR                                                         CIR014
     C                     ENDIF                                                              CIR014
     C           @RTCD     IFEQ *BLANK                                                        CIR014
     C                     MOVE 'Y'       CIR014  1                                           CIR014
     C                     ENDIF                                                              CIR014
     C/COPY WNCPYSRC,DLH00429
      **  Declare KLIST to access LF/MGU36NPD                             CIR005
     C           WMGUKY    KLIST                                          CIR005
     C                     KFLD           MGSEQN                          CIR005
     C                     KFLD           MGMSSQ                          CIR005
     C                     KFLD           MGISFC                          CIR005
      *                                                                   CEU015
      ** Setup RODA-equivalent-workfield                                  CEU015
     C           *LIKE     DEFN RODA      WRODA                           CEU015
     C*                                                                   CEU015
      ** Check if Swift 2000 Changes is switched on.                      CSW200
      *                                                                   CSW200
      *                                                                   CSW200
     C                     CALL 'SWIF2000'                                CSW200
     C                     PARM *BLANKS   @RTCD                           CSW200
      *                                                                   CSW200
     C           @RTCD     IFEQ 'CSW200'                                  CSW200
     C                     MOVE 'Y'       CSW200  1                       CSW200
     C           CSW005    IFEQ 'Y'                                       CSW200
     C           CSW011    OREQ 'Y'                                       CSW200
     C                     OPEN MGU340PD                                  CSW200
     C                     END                                            CSW200
     C                     END                                            CSW200
      *                                                                   CSW200
      ** ACCESS SAR DETAILS TO SEE IF CAS009 IS ENABLED.                                      CSW208
      *                                                                                       CSW208
     C                     MOVE 'N'       CAS009  1                                           CSW208
     C                     CALL 'AOSARDR0'                                                    CSW208
     C                     PARM *BLANKS   @RTCD                                               CSW208
     C                     PARM '*VERIFY' @OPTN                                               CSW208
     C                     PARM 'CAS009'  @SARD                                               CSW208
     C           SCSARD    PARM SCSARD    DSFDY                                               CSW208
      *                                                                                       CSW208
     C           @RTCD     IFEQ *BLANKS                                                       CSW208
     C                     MOVE 'Y'       CAS009                                              CSW208
     C                     ENDIF                                                              CSW208
      *                                                                                       CSW208
      ** ACCESS SAR DETAILS TO SEE IF CDL019 IS ENABLED.                                      CSW208
      *                                                                                       CSW208
     C                     MOVE 'N'       CDL019  1                                           CSW208
     C                     CALL 'AOSARDR0'                                                    CSW208
     C                     PARM *BLANKS   @RTCD                                               CSW208
     C                     PARM '*VERIFY' @OPTN                                               CSW208
     C                     PARM 'CDL019'  @SARD                                               CSW208
     C           SCSARD    PARM SCSARD    DSFDY                                               CSW208
      *                                                                                       CSW208
     C           @RTCD     IFEQ *BLANKS                                                       CSW208
     C                     MOVE 'Y'       CDL019                                              CSW208
     C                     ENDIF                                                              CSW208
      *                                                                                       CSW208
     C                     MOVE 'N'       DLSWCF  1                                           CSW208
     C                     Z-ADD*ZEROS    WSEQN   50                                          CSW208
     C**********           Z-ADD*ZEROS    WFECNT  50                                 CSW208 BUG20927
      *                                                                                       CSW208
      ** Access Switchable Features file for CSW208                                           CSW208
      *                                                                                       CSW208
     C                     MOVE 'N'       CSW208  1                                           CSW208
     C                     CALL 'SWIF2008'                                                    CSW208
     C                     PARM *BLANKS   @RTCD                                               CSW208
      *                                                                                       CSW208
     C           @RTCD     IFEQ 'CSW2008'                                                     CSW208
     C                     MOVE 'Y'       CSW208                                              CSW208
      *                                                                                       CSW208
     C                     OPEN MGX320PD                                                      CSW208
      *                                                                                       CSW208
     C                     CALL 'AOSVALR0'                                                    CSW208
     C                     PARM *BLANKS   P@RTCD  7                                           CSW208
     C                     PARM P@DL      P@OP01 20                                           CSW208
     C                     PARM           P@VL01200                                           CSW208
     C                     PARM           P@OP02 20                                           CSW208
     C                     PARM           P@VL02200                                           CSW208
     C                     PARM           P@OP03 20                                           CSW208
     C                     PARM           P@VL03200                                           CSW208
     C                     PARM           P@OP04 20                                           CSW208
     C                     PARM           P@VL04200                                           CSW208
     C                     PARM           P@OP05 20                                           CSW208
     C                     PARM           P@VL05200                                           CSW208
     C                     PARM           P@OP06 20                                           CSW208
     C                     PARM           P@VL06200                                           CSW208
     C                     PARM           P@OP07 20                                           CSW208
     C                     PARM           P@VL07200                                           CSW208
     C                     PARM           P@OP08 20                                           CSW208
     C                     PARM           P@VL08200                                           CSW208
     C                     PARM           P@OP09 20                                           CSW208
     C                     PARM           P@VL09200                                           CSW208
     C                     PARM           P@OP10 20                                           CSW208
     C                     PARM           P@VL10200                                           CSW208
      *                                                                                       CSW208
     C           P@RTCD    IFEQ *BLANKS                                                       CSW208
     C           P@VL01    ANDEQ'Y'                                                           CSW208
     C           CAS009    ANDEQ'Y'                                                           CSW208
      *                                                                                       CSW208
      ** Add records to MGX320PD if Current setup is Y and CAS009 is ON                       CSW208
      *                                                                                       CSW208
     C                     MOVE 'Y'       DLSWCF                                              CSW208
     C                     ENDIF                                                              CSW208
      *                                                                                       CSW208
     C                     ENDIF                                                              CSW208
      *                                                                                     AR745096
      ** Check if switchable feature CER048 is ON                                           AR745096
      *                                                                                     AR745096
     C                     CALL 'AOSARDR0'                                                  AR745096
     C                     PARM *BLANKS   @RTCD                                             AR745096
     C                     PARM '*VERIFY' @OPTN                                             AR745096
     C                     PARM 'CER048'  @SARD                                             AR745096
     C           SCSARD    PARM SCSARD    DSFDY                                             AR745096
      *                                                                                     AR745096
     C           @RTCD     IFNE *BLANK                                                      AR745096
     C           @RTCD     ANDNE'*NRF   '                                                   AR745096
     C                     MOVEL'SCSARDPD'DBFILE                                            AR745096
     C                     MOVEL'031'     DBASE                                             AR745096
     C                     MOVEL@RTCD     DBKEY                                             AR745096
     C                     MOVE *ON       *INU7                                             AR745096
     C                     MOVE *ON       *INU8                                             AR745096
     C                     EXSR *PSSR                                                       AR745096
     C                     ENDIF                                                            AR745096
     C           @RTCD     IFEQ *BLANK                                                      AR745096
     C                     MOVE 'Y'       CER048  1                                         AR745096
     C                     ENDIF                                                            AR745096
      *                                                                                     AR745096
      ** Check if switchable feature CER054 is ON                                           AR745096
      *                                                                                     AR745096
     C                     CALL 'AOSARDR0'                                                  AR745096
     C                     PARM *BLANKS   @RTCD                                             AR745096
     C                     PARM '*VERIFY' @OPTN                                             AR745096
     C                     PARM 'CER054'  @SARD                                             AR745096
     C           SCSARD    PARM SCSARD    DSFDY                                             AR745096
      *                                                                                     AR745096
     C           @RTCD     IFNE *BLANK                                                      AR745096
     C           @RTCD     ANDNE'*NRF   '                                                   AR745096
     C                     MOVEL'SCSARDPD'DBFILE                                            AR745096
     C                     MOVEL'032'     DBASE                                             AR745096
     C                     MOVEL@RTCD     DBKEY                                             AR745096
     C                     MOVE *ON       *INU7                                             AR745096
     C                     MOVE *ON       *INU8                                             AR745096
     C                     EXSR *PSSR                                                       AR745096
     C                     ENDIF                                                            AR745096
     C           @RTCD     IFEQ *BLANK                                                      AR745096
     C                     MOVE 'Y'       CER054  1                                         AR745096
     C                     ENDIF                                                            AR745096
      *                                                                                       CSW212
      ** Check if SWIFT Changes 2012 (CSW212) is installed                                    CSW212
      *                                                                                       CSW212
     C                     CALL 'SWIF2012'                                                    CSW212
     C                     PARM *BLANKS   @RTCD                                               CSW212
      *                                                                                       CSW212
     C           @RTCD     IFEQ 'CSW2012'                                                     CSW212
     C                     MOVE 'Y'       CSW212  1                                           CSW212
     C                     ELSE                                                               CSW212
     C                     MOVE 'N'       CSW212                                              CSW212
     C                     ENDIF                                                              CSW212
      *                                                                                       CSW213
      ** Check if Swift 2013 Changes is installed.                                            CSW213
      *                                                                                       CSW213
     C                     CALL 'SWIF2013'                                                    CSW213
     C                     PARM *BLANKS   @RTCD                                               CSW213
      *                                                                                       CSW213
     C           @RTCD     IFEQ 'CSW2013'                                                     CSW213
     C                     MOVE 'Y'       CSW213  1                                           CSW213
     C                     ELSE                                                               CSW213
     C                     MOVE 'N'       CSW213                                              CSW213
     C                     END                                                                CSW213
      *                                                                                       CSW214
      ** Check if Swift 2014 Changes is installed.                                            CSW214
      *                                                                                       CSW214
     C                     CALL 'SWIF2014'                                                    CSW214
     C                     PARM *BLANKS   PRTCD                                               CSW214
      *                                                                                       CSW214
     C           PRTCD     IFEQ 'CSW2014'                                                     CSW214
     C                     MOVE 'Y'       CSW214  1                                           CSW214
     C                     ELSE                                                               CSW214
     C                     MOVE 'N'       CSW214                                              CSW214
     C                     ENDIF                                                              CSW214
      *                                                                                     MD034496
      ** Check if Swift 2015 Changes is installed.                                          MD034496
      *                                                                                     MD034496
     C                     CALL 'SWIF2015'                                                  MD034496
     C                     PARM *BLANKS   PRTCD                                             MD034496
      *                                                                                     MD034496
     C           PRTCD     IFEQ 'CSW2015'                                                   MD034496
     C                     MOVE 'Y'       CSW215  1                                         MD034496
     C                     ELSE                                                             MD034496
     C                     MOVE 'N'       CSW215                                            MD034496
     C                     ENDIF                                                            MD034496
      *                                                                                       CSW213
      ** Setup Key Field for DLRPIFPD                                                         CSW213
      *                                                                                       CSW213
     C           RPIFKY    KLIST                                                              CSW213
     C                     KFLD           KDTYP                                               CSW213
     C                     KFLD           KDLNO                                               CSW213
      *                                                                                       CLE148
     C                     Z-ADDTRNUM     TRNUM   60                                          CLE148
     C/COPY WNCPYSRC,DLH00437
      *                                                                                       CMG003
      ** Check if SWIFT MT600 Message Generation is installed                                 CMG003
      *                                                                                       CMG003
     C                     MOVE 'N'       CMG003  1                                           CMG003
     C                     CALL 'AOSARDR0'                                                    CMG003
     C                     PARM *BLANKS   @RTCD                                               CMG003
     C                     PARM '*VERIFY' @OPTN                                               CMG003
     C                     PARM 'CMG003'  @SARD                                               CMG003
     C           SCSARD    PARM SCSARD    DSFDY                                               CMG003
      *                                                                                       CMG003
     C           @RTCD     IFEQ *BLANKS                                                       CMG003
     C                     MOVE 'Y'       CMG003                                              CMG003
     C                     ENDIF                                                              CMG003
      *
      ** Check if Enhance Receive Settlement Instructions is On                               CDL094
      *                                                                                       CDL094
     C                     MOVE 'N'       CDL094  1                                           CDL094
     C                     CALL 'AOSARDR0'                                                    CDL094
     C                     PARM *BLANKS   @RTCD                                               CDL094
     C                     PARM '*VERIFY' @OPTN                                               CDL094
     C                     PARM 'CDL094'  @SARD                                               CDL094
     C           SCSARD    PARM SCSARD    DSFDY                                               CDL094
      *                                                                                       CDL094
     C           @RTCD     IFEQ *BLANKS                                                       CDL094
     C                     MOVE 'Y'       CDL094                                              CDL094
     C                     ENDIF                                                              CDL094
      *                                                                                       CDL094
     C                     ENDSR
      *****************************************************************
     C/COPY WNCPYSRC,DL6305C021
     C/EJECT
      *****************************************************************
      *    SETF - Set up GDF fields                                   *
      *    Called by - main process                                   *
      *****************************************************************
      *
     C           SETF      BEGSR
      *
      **  Clear generation driver file fields
      *
     C                     MOVE *BLANKS   MGBRCA
     C                     MOVE *BLANKS   MGCNUM
     C                     MOVE *BLANKS   MGMODI
     C                     MOVE *BLANKS   MGTNUM
     C                     Z-ADD0         MGTDAT
     C                     Z-ADD0         MGEXRT
     C/COPY WNCPYSRC,DL6305C035
     C                     MOVE *BLANKS   MGBRKC
     C                     Z-ADD0         MGMDAT
     C                     Z-ADD0         MGVDAT
     C                     Z-ADD0         MGOTDT
     C                     MOVE *BLANKS   MGPUCY
     C                     Z-ADD0         MGPAMT
     C                     Z-ADD0         MGPCPL
     C                     MOVE *BLANKS   MGRIBN
     C                     MOVE *BLANKS   MGRIBA                          056739
     C                     MOVE *BLANKS   MGRONS
     C                     MOVE *BLANKS   MGSLCY
     C                     Z-ADD0         MGSAMT
     C                     MOVE *BLANKS   MGPONS
     C                     MOVE *BLANKS   MGPIBN
     C                     MOVE *BLANKS   MGPIBA                          056739
     C**********           Z-ADD0         MGPOBN                                       CSW097 CSD027
     C**********           Z-ADD0         MGPOCN                                       CSW097 CSD027
     C                     MOVE *BLANKS   MGPOBN                                              CSD027
     C                     MOVE *BLANKS   MGPOCN                                              CSD027
     C                     MOVE *BLANKS   MGAWBN
     C                     MOVE *BLANKS   MGAWBA
     C                     MOVE *BLANKS   MGRVNO
     C                     MOVE *BLANKS   MGBENN
     C                     MOVE *BLANKS   MGBENA                          088043
     C                     MOVE *BLANKS   MGTTYP
     C                     MOVE *BLANKS   MGTSTP
     C                     MOVE *BLANKS   MGPOBR
     C                     MOVE *BLANKS   MGEVTP
     C                     MOVE *BLANKS   MGCHTP
     C                     MOVE *BLANKS   MGROBR
     C                     Z-ADD0         MGRSTM
     C                     Z-ADD0         MGPSTM
      *
     C                     Z-ADD0         MGROTN
     C                     MOVE *BLANKS   MGCCY
     C                     Z-ADD0         MGROTA
     C                     Z-ADD0         MGINTR
     C                     Z-ADD0         MGNIDT
     C                     Z-ADD0         MGSLID
     C                     MOVE *BLANKS   MGICBS
     C                     Z-ADD0         MGTOTI
     C                     MOVE *BLANKS   MGIPFR
     C                     MOVE *BLANKS   MGLORD
      *
     C                     MOVE *BLANKS   MGPORS
     C                     Z-ADD0         MGYRAT
      *
     C                     Z-ADD0         MGNAMT
     C                     Z-ADD0         MGNOTD
     C                     Z-ADD0         MGAVDT                          E29588
     C                     Z-ADD0         MGASEQ                          E29588
      *                                                                   CSW005
      **  Initialise fields for FRA/IRS MG files if feature is *ON.       CSW005
      *                                                                   CSW005
     C           CSW005    IFEQ 'Y'                                       CSW005
     C           CSW011    OREQ 'Y'                                       CSW011
      *                                                                   CSW005
     C                     Z-ADD0         MGFDAT                          CSW005
     C                     Z-ADD0         MGSDAT                          CSW005
     C                     Z-ADD0         MGNOAM                          CSW005
     C                     MOVE *BLANKS   MGPORR                          CSW005
     C                     Z-ADD0         MGCPER                          CSW005
     C                     MOVE *BLANKS   MGCON1                          CSW005
     C                     MOVE *BLANKS   MGCON2                          CSW005
     C                     MOVE *BLANKS   MGCON3                          CSW005
     C                     MOVE *BLANKS   MGCON4                          CSW005
     C                     MOVE *BLANKS   MGCON5                          CSW005
     C                     MOVE *BLANKS   MGCON6                          CSW005
     C                     MOVE *BLANKS   MGS2R1                          CSW005
     C                     MOVE *BLANKS   MGS2R2                          CSW005
     C                     MOVE *BLANKS   MGS2R3                          CSW005
     C                     MOVE *BLANKS   MGS2R4                          CSW005
     C                     MOVE *BLANKS   MGS2R5                          CSW005
     C                     MOVE *BLANKS   MGS2R6                          CSW005
      *                                                                   CSW005
     C                     MOVE *BLANKS   MGFUID                          CSW005
     C                     Z-ADD0         MGADAT                          CSW005
     C                     MOVE *BLANKS   MGBDAC                          CSW005
     C***********          MOVE *BLANKS   MGAMRT                   CSW005 CSW097
     C                     Z-ADD0         MGISDA                          CSW005
     C                     MOVE *BLANKS   MGAGTY                          CSW005
     C                     Z-ADD0         MGAGDT                          CSW005
     C                     Z-ADD0         MGAGVV                          CSW005
     C                     Z-ADD0         MGNOTA                          CSW005
     C***********          MOVE *BLANKS   MGCTC1                   CSW005 CSW097
     C***********          MOVE *BLANKS   MGCTC2                   CSW005 CSW097
     C***********          MOVE *BLANKS   MGCTC3                   CSW005 CSW097
     C***********          MOVE *BLANKS   MGCTC4                   CSW005 CSW097
     C                     MOVE *BLANKS   WACOC   2                       CSW012
     C                     Z-ADD0         MGBFXR                          CSW005
     C                     MOVE *BLANKS   MGTDCF                          CSW005
     C***********          MOVE *BLANKS   MGTBSD                   CSW005 CSW097
     C                     MOVE *BLANKS   MGTFLO                          CSW005
     C***********          Z-ADD0         MGTBSV                   CSW005 CSW097
     C                     Z-ADD0         MGTSPD                          CSW005
     C                     MOVE *BLANKS   MGTDSM                          CSW005
     C***********          MOVE *BLANKS   MGTCPA                   CSW005 CSW097
     C                     MOVE *BLANKS   MGTCMP                          CSW005
     C                     MOVE *BLANKS   MGTIPF                          CSW005
     C                     MOVE *BLANKS   MGTRCF                          CSW005
     C                     Z-ADD0         MGEFXR                          CSW005
     C                     MOVE *BLANKS   MGODCF                          CSW005
     C***********          MOVE *BLANKS   MGOBSD                   CSW005 CSW097
     C                     MOVE *BLANKS   MGOFLO                          CSW005
     C***********          Z-ADD0         MGOBSV                   CSW005 CSW097
     C                     Z-ADD0         MGOSPD                          CSW005
     C                     MOVE *BLANKS   MGODSM                          CSW005
     C***********          MOVE *BLANKS   MGOCPA                   CSW005 CSW097
     C                     MOVE *BLANKS   MGOCMP                          CSW005
     C                     MOVE *BLANKS   MGOIPF                          CSW005
     C                     MOVE *BLANKS   MGORCF                          CSW005
     C                     Z-ADD0         MGTUFF                          CSW005
     C                     Z-ADD0         MGOUFF                          CSW005
     C                     Z-ADD0         MGUPVD                          CSW005
      *                                                                   CSW005
     C                     MOVE *BLANKS   MGOCCY                          CSW005
     C                     MOVE *BLANKS   MGTCCY                          CSW005
     C                     Z-ADD0         MGONAM                          CSW005
     C                     Z-ADD0         MGTNAM                          CSW005
     C***********          Z-ADD0         MGTIPA                   CSW005 CSW097
     C***********          Z-ADD0         MGOIPA                   CSW005 CSW097
     C***********          Z-ADD0         MGTFPA                   CSW005 CSW097
     C***********          Z-ADD0         MGOFPA                   CSW005 CSW097
      *                                                                   CSW005
     C                     MOVE *BLANKS   MGMSSQ                          CSW005
     C                     Z-ADD0         MGPDAT                          CSW005
      *                                                                   CSW005
     C                     Z-ADD0         MGCSDT                          CSW005
     C                     Z-ADD0         MGCEDT                          CSW005
     C                     Z-ADD0         MGOSNA                          CSW005
     C                     Z-ADD0         MGOSNA                          CSW005
      *                                                                   CSW200
     C           CSW200    IFEQ 'Y'                                       CSW200
     C                     MOVE *BLANKS   MGCALC                          CSW200
     C                     MOVE *BLANKS   MGFLOR                          CSW200
     C                     MOVE *BLANKS   MGDSMT                          CSW200
     C                     MOVE *BLANKS   MGODM1                          CSW200
     C                     MOVE *BLANKS   MGODM2                          CSW200
     C                     MOVE *BLANKS   MGCTC1                          CSW200
     C                     MOVE *BLANKS   MGCTC2                          CSW200
     C                     MOVE *BLANKS   MGCTC3                          CSW200
     C                     MOVE *BLANKS   MGCTC4                          CSW200
     C                     ENDIF                                          CSW200
     C***********          MOVEL*BLANKS   MGTPRA                   CSW005 CSW097
     C***********          MOVEL*BLANKS   MGOPRA                   CSW005 CSW097
      *                                                                   CSW097
     C           CSW005    IFEQ 'Y'                                       CSW097
     C                     MOVE *BLANKS   MGCAIN                          CSW097
     C                     MOVE *BLANKS   MGTOM1                          CSW097
     C                     MOVE *BLANKS   MGTOM2                          CSW097
     C                     MOVE *BLANKS   MGOOM1                          CSW097
     C                     MOVE *BLANKS   MGOOM2                          CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW005
     C                     ENDIF                                          CSW005
      *                                                                   CDL008
      ** Initialise fields for CLS if feature is installed.               CDL008
      *                                                                   CDL008
     C           CDL008    IFEQ 'Y'                                       CDL008
     C                     MOVE *BLANKS   MGCLSS                          CDL008
     C                     ENDIF                                          CDL008
     C                     Z-ADD0         MGAITC                          179816
     C                     Z-ADD0         MGIPRD                          179816
     C                     Z-ADD0         MGICTD                          179848
     C                     Z-ADD0         MGAIAN                          179848
     C                     Z-ADD0         MGAIAP                          179848
     C/COPY WNCPYSRC,DLH00438
      *
     C                     MOVE *BLANKS   @RTNC                           199214
     C                     MOVE *BLANKS   PTRAN                           199214
     C                     MOVE *BLANKS   MGRREF                          199214
      *                                                                   199214
     C                     MOVE *BLANKS   @RTNC                           199214
     C                     MOVE *BLANKS   PTRAN                           199214
     C                     MOVE *BLANKS   MGRREF                          199214
      *                                                                   199214
      ** Initialise fields for CSW212 if feature is installed                                 CSW212
      *                                                                                       CSW212
     C           CSW212    IFEQ 'Y'                                                           CSW212
     C                     MOVE *BLANKS   MGCON1                                              CSW212
     C                     MOVE *BLANKS   MGCON2                                              CSW212
     C                     MOVE *BLANKS   MGCON3                                              CSW212
     C                     MOVE *BLANKS   MGCON4                                              CSW212
     C                     MOVE *BLANKS   MGCON5                                              CSW212
     C                     MOVE *BLANKS   MGCON6                                              CSW212
     C                     MOVE *BLANKS   MGAGTY                                              CSW212
     C                     MOVE *BLANKS   MGPMBC                                              CSW212
     C                     MOVE *BLANKS   MGPMSC                                              CSW212
     C                     Z-ADD0         MGISDA                                              CSW212
     C                     Z-ADD0         MGAGDT                                              CSW212
     C                     Z-ADD0         MGAGVV                                              CSW212
     C                     ENDIF                                                              CSW212
      *                                                                                       CSW213
      ** Reset new of fields to blanks if CSW213 is switch on                                 CSW213
      *                                                                                       CSW213
     C           CSW213    IFEQ 'Y'                                                           CSW213
      *                                                                                       CSW213
     C                     MOVE *BLANKS   MGAPID                                              CSW213
     C                     MOVE *BLANKS   MGTRRF                                              CSW213
     C                     MOVE *BLANKS   MGLNRF                                              CSW213
     C                     MOVE *BLANKS   MGCPID                                              CSW213
     C                     MOVE *BLANKS   MGDTYP                                              CSW213
     C                     MOVE *BLANKS   MGDLST                                              CSW213
     C                     MOVE *BLANKS   MGTRID                                              CSW213
     C                     MOVE *BLANKS   MGCCPI                                              CSW213
     C                     MOVE *BLANKS   MGCCPA                                              CSW213
     C                     MOVE *BLANKS   MGCEPI                                              CSW213
     C                     MOVE *BLANKS   MGCEPA                                              CSW213
     C                     MOVE *BLANKS   MGCBCI                                              CSW213
     C                     MOVE *BLANKS   MGCBPI                                              CSW213
     C                     MOVE *BLANKS   MGPRID                                              CSW213
     C                     MOVE *BLANKS   MGEXVE                                              CSW213
     C                     MOVE *BLANKS   MGUPID                                              CSW213
     C                     MOVE *BLANKS   MGRJ01                                              CSW213
     C                     MOVE *BLANKS   MGRJ02                                              CSW213
     C                     MOVE *BLANKS   MGRJ03                                              CSW213
     C                     MOVE *BLANKS   MGRJ04                                              CSW213
     C                     MOVE *BLANKS   MGRP01                                              CSW213
     C                     MOVE *BLANKS   MGRP02                                              CSW213
     C                     MOVE *BLANKS   MGRP03                                              CSW213
     C                     MOVE *BLANKS   MGRP04                                              CSW213
     C                     MOVE *BLANKS   MGRA01                                              CSW213
     C                     MOVE *BLANKS   MGRA02                                              CSW213
     C                     MOVE *BLANKS   MGRA03                                              CSW213
     C                     MOVE *BLANKS   MGRA04                                              CSW213
     C                     MOVE *BLANKS   MGRN01                                              CSW213
     C                     MOVE *BLANKS   MGRN02                                              CSW213
     C                     MOVE *BLANKS   MGRN03                                              CSW213
     C                     MOVE *BLANKS   MGRN04                                              CSW213
     C                     MOVE *BLANKS   MGRC01                                              CSW213
     C                     MOVE *BLANKS   MGRC02                                              CSW213
     C                     MOVE *BLANKS   MGRC03                                              CSW213
     C                     MOVE *BLANKS   MGRC04                                              CSW213
     C                     MOVE *BLANKS   MGRS01                                              CSW213
     C                     MOVE *BLANKS   MGRS02                                              CSW213
     C                     MOVE *BLANKS   MGRS03                                              CSW213
     C                     MOVE *BLANKS   MGRS04                                              CSW213
     C                     MOVE *BLANKS   MGRL01                                              CSW213
     C                     MOVE *BLANKS   MGRL02                                              CSW213
     C                     MOVE *BLANKS   MGRL03                                              CSW213
     C                     MOVE *BLANKS   MGRL04                                              CSW213
     C                     MOVE *BLANKS   MGUT01                                              CSW213
     C                     MOVE *BLANKS   MGUT02                                              CSW213
     C                     MOVE *BLANKS   MGUT03                                              CSW213
     C                     MOVE *BLANKS   MGUT04                                              CSW213
     C                     MOVE *BLANKS   MGTN01                                              CSW213
     C                     MOVE *BLANKS   MGTN02                                              CSW213
     C                     MOVE *BLANKS   MGTN03                                              CSW213
     C                     MOVE *BLANKS   MGTN04                                              CSW213
     C                     MOVE *BLANKS   MGTI01                                              CSW213
     C                     MOVE *BLANKS   MGTI02                                              CSW213
     C                     MOVE *BLANKS   MGTI03                                              CSW213
     C                     MOVE *BLANKS   MGTI04                                              CSW213
     C                     MOVE *BLANKS   MGET01                                              CSW213
     C                     MOVE *BLANKS   MGET02                                              CSW213
     C                     MOVE *BLANKS   MGET03                                              CSW213
     C                     MOVE *BLANKS   MGET04                                              CSW213
     C                     MOVE *BLANKS   MGCGTI                                              CSW213
     C                     MOVE *BLANKS   MGALLI                                              CSW213
     C                     MOVE *BLANKS   MGCLLI                                              CSW213
     C                     MOVE *BLANKS   MGNORS                                              CSW213
     C                     MOVE *BLANKS   MGUSGN                                              CSW213
     C                     MOVE *BLANKS   MGLSID                                              CSW213
     C                     MOVE *BLANKS   MGAR01                                              CSW213
     C                     MOVE *BLANKS   MGAR02                                              CSW213
     C                     MOVE *BLANKS   MGAR03                                              CSW213
     C                     MOVE *BLANKS   MGAR04                                              CSW213
     C                     MOVE *BLANKS   MGAR05                                              CSW213
     C                     MOVE *BLANKS   MGAR06                                              CSW213
     C                     MOVE *BLANKS   MGAR07                                              CSW213
     C                     MOVE *BLANKS   MGAR08                                              CSW213
     C                     MOVE *BLANKS   MGAR09                                              CSW213
     C                     MOVE *BLANKS   MGAR10                                              CSW213
     C                     MOVE *BLANKS   MGAR11                                              CSW213
     C                     MOVE *BLANKS   MGAR12                                              CSW213
     C                     MOVE *BLANKS   MGAR13                                              CSW213
     C                     MOVE *BLANKS   MGAR14                                              CSW213
     C                     MOVE *BLANKS   MGAR15                                              CSW213
     C                     MOVE *BLANKS   MGAR16                                              CSW213
     C                     MOVE *BLANKS   MGAR17                                              CSW213
     C                     MOVE *BLANKS   MGAR18                                              CSW213
     C                     MOVE *BLANKS   MGAR19                                              CSW213
     C                     MOVE *BLANKS   MGAR20                                              CSW213
     C                     MOVE *BLANKS   MGFOID                                              CSW213
     C                     MOVE *BLANKS   MGAFOI                                              CSW213
     C                     MOVE *BLANKS   MGCFRQ                                              CSW213
     C                     MOVE *BLANKS   MGCFGN                                              CSW213
     C                     MOVE *BLANKS   MGPRID                                              CSW213
     C                     MOVE *BLANKS   MGBCCY                                              CSW213
     C                     MOVE *BLANKS   MGBPMI                                              CSW213
     C                     MOVE *BLANKS   MGSCCY                                              CSW213
     C                     MOVE *BLANKS   MGSPMI                                              CSW213
     C                     MOVE *BLANKS   MGCHTP                                              CSW213
     C**********           MOVEATSTAM     MGTMST                                     CSW213 MD022979
     C                     MOVE *BLANKS   MGACMI                                              CSW213
     C                     MOVE *BLANKS   MGPTYA                                              CSW213
      *                                                                                       CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
     C                     MOVEATSTAM     MGTMST                                            MD022979
      *                                                                                       CSW214
      ** Initialize the newly-added MG fields to blanks                                       CSW214
      *                                                                                       CSW214
     C           CSW214    IFEQ 'Y'                                                           CSW214
     C                     MOVE *BLANKS   MGCBRI                                              CSW214
     C                     MOVE *BLANKS   MGCBRA                                              CSW214
     C                     MOVE *BLANKS   MGFNCI                                              CSW214
     C                     MOVE *BLANKS   MGCOPI                                              CSW214
     C                     MOVE *BLANKS   MGCOPC                                              CSW214
     C                     MOVE *BLANKS   MGPOCI                                              CSW214
     C                     MOVE *BLANKS   MGCOSI                                              CSW214
     C                     MOVE *BLANKS   MGTNEI                                              CSW214
     C                     MOVE *BLANKS   MGIGTI                                              CSW214
     C                     MOVE *BLANKS   MGCTFI                                              CSW214
     C                     ENDIF                                                              CSW214
      *                                                                                       CSW214
      *                                                                                       CSW212
     C                     ENDSR
      *****************************************************************
     C/EJECT
      *****************************************************************
      *   TYPE - determine message type                               *
      ****Called*by*-*main*process*************************************   042844
      *   Called by - MSG  Produce message                            *   042844
      *****************************************************************
      *
     C           TYPE      BEGSR
      *
     C                     MOVE *BLANK    @TYP                            CSW097
      *
      ** FX deals and nostro transfers - MT300
      *
     C           DRCDT     IFEQ 'B'
     C                     MOVE '300'     @TYP    3
     C                     END
      *
      ** Takings/placings time/deposits loans - MT320/330
      *
     C           DRCDT     IFEQ 'C'
      *
      ** Check notice days
      *
     C           NOTD      IFLT 0
     C           DTYP      IFNE 'CD'                                      172657
     C           DTYP      ANDNE'CL'                                      172657
     C           DTYP      ANDNE'DL'                                      190545
     C                     MOVE '320'     @TYP
     C                     ELSE                                           172657
     C                     MOVE '330'     @TYP                            172657
     C                     END                                            172657
     C                     ELSE
     C                     MOVE '330'     @TYP
     C                     END
      *
     C                     END
      *
      ** Negotiable assets purchased or sold - MT321
     C/COPY WNCPYSRC,DL6305C022
      *
     C           DRCDT     IFEQ 'D'
     C           DRCDT     OREQ 'E'
     C                     MOVE '321'     @TYP
     C                     END
     C/COPY WNCPYSRC,DL6305C023
      *                                                                   CSW005
      **  FRA/IRS - MT340, MT360, or MT361 if feature is *ON.             CSW005
      *                                                                   CSW005
     C           CSW005    IFEQ 'Y'                                       CSW005
     C           DRCDT     ANDEQ'G'                                       CSW005
     C           CSW011    OREQ 'Y'                                       CSW011
     C           DRCDT     ANDEQ'G'                                       CSW011
      *                                                                   CSW005
     C***********          SELEC                                   CSW005 CSW097
     C***********DTYP      WHEQ 'FR'                               CSW005 CSW097
     C***********          MOVE '340'     @TYP                     CSW005 CSW097
     C***********DTYP      WHEQ 'RS'                               CSW005 CSW097
     C***********CSW005    ANDEQ'Y'                                CSW011 CSW097
     C***********          MOVE '360'     @TYP                     CSW005 CSW097
     C***********DTYP      WHEQ 'RX'                               CSW005 CSW097
     C***********CSW005    ANDEQ'Y'                                CSW011 CSW097
     C***********          MOVE '361'     @TYP                     CSW005 CSW097
     C***********          ENDSL                                   CSW005 CSW097
      *                                                                   CSW097
     C           DTYP      IFEQ 'FR'                                      CSW097
      *                                                                   CSW097
     C           CSW011    IFEQ 'Y'                                       CSW097
     C           CSW005    OREQ 'Y'                                       CSW097
     C           AGTY      ANDNE'ISDA  '                                  CSW097
     C           AGTY      ANDNE'AFB   '                                  CSW097
     C           CSW200    ANDNE'Y'                                       CSW200
     C           CSW005    OREQ 'Y'                                       CSW200
     C           CSW200    ANDEQ'Y'                                       CSW200
     C                     MOVE '340'     @TYP                            CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
     C           CSW005    IFEQ 'Y'                                       CSW097
     C           AGTY      ANDEQ'ISDA  '                                  CSW097
     C           CSW200    ANDNE'Y'                                       CSW200
     C           CSW005    OREQ 'Y'                                       CSW097
     C           AGTY      ANDEQ'AFB   '                                  CSW097
     C           CSW200    ANDNE'Y'                                       CSW200
     C                     MOVE '360'     @TYP                            CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
     C           CSW005    IFEQ 'Y'                                       CSW097
      *                                                                   CSW097
     C           DTYP      IFEQ 'RS'                                      CSW097
     C                     MOVE '360'     @TYP                            CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
     C           DTYP      IFEQ 'RX'                                      CSW097
     C                     MOVE '361'     @TYP                            CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW005
     C                     ENDIF                                          CSW005
      *
     C                     ENDSR
      *****************************************************************
     C/EJECT
      *****************************************************************
      *   DEST - get destination customer details                     *
      ****Called*by*-*main*process*************************************   042844
      *   Called by - MSG  Produce message                            *   042844
      *****************************************************************
      *
     C           DEST      BEGSR
      *
      **  Using customer no. of deal
      *
      *                                                                   131541
      **  For deal type "CI" use 'CHNA' instead of 'CNUM'                 131541
      *   as CNUM is the BICN for deal type "CI".                         131541
      *                                                                   131541
     C           DTYP      IFEQ 'CI'                                      131541
     C                     MOVELCHNA      @DEST                           131541
     C                     ELSE                                           131541
     C                     MOVELCNUM      @DEST   8
     C                     END                                            131541
      *
      **  Access SDCUSTPD with access object
      *
     C                     MOVE *BLANKS   @KEY1  10
     C                     MOVE *BLANKS   @KYST   7
      *
     C                     CALL 'AOCUSTR0'
     C                     PARM '*MSG   ' @RTCD
     C                     PARM '*KEY   ' @OPTN
     C                     PARM @DEST     @KEY1
     C                     PARM *BLANKS   @KYST
     C           SDCUST    PARM SDCUST    DSSDY
      *
     C           @RTCD     IFNE *BLANKS
     C           *LOCK     IN   LDA
     C                     MOVE '003'     DBASE            * * * * * * * *
     C                     MOVEL@DEST     DBKEY            * DB ERROR 03 *
     C                     MOVEL'SDCUSTPD'DBFILE           * * * * * * * *
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END
      *
      ** Load array with fields containing message types not to be
      ** generated for this customer
      *
     C                     MOVE BBNG01    NGN,1
     C                     MOVE BBNG02    NGN,2
     C                     MOVE BBNG03    NGN,3
     C                     MOVE BBNG04    NGN,4
     C                     MOVE BBNG05    NGN,5
     C                     MOVE BBNG06    NGN,6
     C                     MOVE BBNG07    NGN,7
     C                     MOVE BBNG08    NGN,8
     C                     MOVE BBNG09    NGN,9
     C                     MOVE BBNG10    NGN,10
     C                     MOVE BBNG11    NGN,11
     C                     MOVE BBNG12    NGN,12
     C                     MOVE BBNG13    NGN,13
     C                     MOVE BBNG14    NGN,14
     C                     MOVE BBNG15    NGN,15
      *
      **  Store A/c Officer Code to use later in SR/F300                  CSW012
      **  to access A/c officer details                                   CSW012
      *
     C           CSW012    IFEQ 'Y'                                       CSW012
     C           CSW200    OREQ 'Y'                                       CSW200
     C           @TYP      ANDEQ'340'                                     CSW200
     C                     MOVELBBACOC    WACOC                           CSW012
     C                     ENDIF                                          CSW012
      *
     C                     ENDSR
      *****************************************************************
     C/EJECT
      *****************************************************************
      *   VALD - generate message type for destination customer ?     *
      ****Called*by*-*main*process*************************************   042844
      *   Called by - MSG  Produce message                            *   042844
      *   Calls - COMM format common fields                           *
      *         - F300 format message specific fields for MT300       *
      *         - F320 format message specific fields for MT320       *
      *         - F330 format message specific fields for MT330       *
      *         - F321 format message specific fields for MT321       *
      *****************************************************************
      *
     C           VALD      BEGSR
      *
      **  If message type to be generated for destination customer
      *
     C           @TYP      LOKUPNGN                      31
     C           '3**'     LOKUPNGN                      32
     C                     MOVE @TYP      GROUP   3
     C                     MOVE '*'       GROUP
     C           GROUP     LOKUPNGN                      33
      *
     C           *IN31     IFNE '1'
     C           *IN32     ANDNE'1'
     C           *IN33     ANDNE'1'
      *
      **  Format common fields
      *
     C                     EXSR COMM
      *
      **  Format message specific fields
      *
     C           @TYP      CASEQ'300'     F300
     C           @TYP      CASEQ'320'     F320
     C           @TYP      CASEQ'330'     F330
     C           @TYP      CASEQ'321'     F321
     C                     END
      *                                                                   CSW005
      **  Format FRA/IRS messages if feature is *ON.                      CSW005
      *                                                                   CSW005
     C           CSW005    IFEQ 'Y'                                       CSW005
     C           CSW011    OREQ 'Y'                                       CSW011
      *                                                                   CSW005
      **  Format common fields                                            CSW005
      *                                                                   CSW005
     C                     EXSR COMFRA                                    CSW005
      *                                                                   CSW005
      **  Format message specific fields                                  CSW005
      *                                                                   CSW005
     C           @TYP      CASEQ'340'     F340                            CSW005
     C***********@TYP      CASEQ'360'     F360                     CSW005 CSW097
     C           @TYP      CASEQ'361'     F361                            CSW005
     C                     ENDCS                                          CSW005
      *                                                                   CSW097
     C           @TYP      IFEQ '360'                                     CSW097
      *                                                                   CSW097
     C           DTYP      IFEQ 'FR'                                      CSW097
     C           CSW200    ANDNE'Y'                                       CSW200
     C                     EXSR F360FR                                    CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
     C           DTYP      IFEQ 'RS'                                      CSW097
     C                     EXSR F360RS                                    CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW005
     C                     ENDIF                                          CSW005
      *
     C                     COMIT
     C                     END
      *
     C                     ENDSR
      *****************************************************************
     C/EJECT
      *****************************************************************
      *   COMM - format common fields                                 *
      *   Called by - VALD generate message for destination customer ?*
      *****************************************************************
      *
     C           COMM      BEGSR
      *
      ** Module ID
      *
     C           CSW005    IFEQ 'Y'                                       CSW005
     C           DTYP      ANDEQ'FR'                                      CSW005
     C           CSW011    OREQ 'Y'                                       CSW011
     C           DTYP      ANDEQ'FR'                                      CSW011
     C           CSW005    OREQ 'Y'                                       CSW005
     C           DTYP      ANDEQ'RS'                                      CSW005
     C           CSW005    OREQ 'Y'                                       CSW005
     C           DTYP      ANDEQ'RX'                                      CSW005
     C                     MOVEL'FI'      MGMODI                          CSW005
     C/COPY WNCPYSRC,DL6305C078                                                              LSC204A
     C                     ELSE                                           CSW005
     C                     MOVEL'DL'      MGMODI
     C                     ENDIF                                          CSW005
      *
      ** Confirmation branches
      *
     C                     MOVELPOBR      MGPOBR
     C                     MOVELROBR      MGROBR
      *
      ** Confirmation settlement methods
      *
     C                     Z-ADDPSTM      MGPSTM
     C                     Z-ADDRSTM      MGRSTM
      *
      ** Deal details
      *
     C                     MOVEL@DEST     MGCNUM
     C                     MOVELCDLNO     MGTNUM
     C                     MOVELDBRCA     MGBRCA
     C***********                                                         059258
     C****If*an*insert*use*the*deal*date.******************************   059258
     C***********CHTP      IFEQ 'I'                                       059258
     C                     Z-ADDDDAT      MGTDAT
     C***********                                                         059258
     C***If*deal*amended,*use*the*run*date*as*the*new*contract*date****   059258
     C***********          ELSE                                           059258
     C***********          MOVE BJRDNB    MGTDAT                          059258
     C***********          END                                            059258
      *                                                                   172657
      ** Set-up MGVDAT for CD/CL to be used to set-up field 32P           172657
      ** in MT330 when maturity date is inserted.                         172657
      *                                                                   172657
     C           DTYP      IFEQ 'CD'                                      172657
     C           MDAT      ANDNE0                                         172657
     C           DTYP      OREQ 'CL'                                      172657
     C           MDAT      ANDNE0                                         172657
     C                     Z-ADDMDAT      MGVDAT                          172657
     C           IACD      IFGE SLID                                      179816
     C                     Z-ADDIACD      MGSLID                          179816
     C                     Z-ADDMDAT      MGNIDT                          179816
     C                     Z-ADDAITC      MGAITC                          179816
     C                     Z-ADDIPRD      MGIPRD                          179816
     C                     Z-ADDICTD      MGICTD                          179848
     C                     Z-ADDAIAN      MGAIAN                          179848
     C                     Z-ADDAIAP      MGAIAP                          179848
     C                     END                                            179816
     C                     ELSE                                           172657
     C                     Z-ADDDVDAT     MGVDAT
     C                     END                                            172657
     C                     Z-ADDMDAT      MGMDAT
     C                     MOVELCCY       MGCCY
     C                     MOVELBRKC      MGBRKC
     C                     MOVELDTYP      MGTTYP
     C                     MOVELDLST      MGTSTP
      *                                                                   E32363
      ***Default*A/C with Institution to the Pay Nostro customer    E32363041713
      ***if*the*A/C with Inst. is not entered on the settlements scrE32363041713
      ***Check*'PONS' is a nostro and settlement is via nostro      E32363041713
      ************                                                  E32363041713
     C************         MOVE PONS      BLANK  10                 E32363041713
     C************         MOVE *BLANKS   AWBA6   6                 088043041713
     C************         MOVELAWBA      AWBA6   6                 088043041713
     C***********AWBN      IFEQ *BLANKS                             E32363041713
     C***********AWBA6     ANDNE'DIRECT'                            088043041713
     C***********BLANK     ANDEQ*BLANKS                             E32363041713
      ************                                                  E32363041713
      ***Check*settlement via nostro                                E32363041713
     C***********PSTM      IFEQ 01                                  E32363041713
     C***********PSTM      OREQ 02                                  E32363041713
     C***********PSTM      OREQ 07                                  E32363041713
     C***********PSTM      OREQ 08                                  E32363041713
     C***********PSTM      OREQ 12                                  E32363041713
      ************                                                  E32363041713
      ***Retrieve*Pay Nostro customer                               E32363041713
     C************         MOVELPONS      P@NONB                    E32363041713
      ************                                                  E32797041713
      ***Retrieve*currency code (dependent on deal)                 E32797041713
     C***********DRCDT     IFEQ 'B'                                 E32797041713
     C************         MOVELSLCY      P@CYCD                    E32797041713
     C************         ELSE                                     E32797041713
     C************         MOVELCCY       P@CYCD                    E32797041713
     C************         END                                      E32797041713
      ************                                                  CSW005041713
      ****Retrieve FRA/IRS pay currency from Our CCY if feature is *CSW005041713
      ************                                                  CSW005041713
     C***********CSW005    IFEQ 'Y'                                 CSW005041713
     C***********DRCDT     ANDEQ'G'                                 CSW005041713
     C***********CSW011    OREQ 'Y'                                 CSW011041713
     C***********DRCDT     ANDEQ'G'                                 CSW011041713
     C************         MOVELUCUCY     P@CYCD                    CSW005041713
     C************         ENDIF                                    CSW005041713
      ************                                                  E32797041713
     C************         CALL 'AONOSTR0'                          E32363041713
     C************         PARM '*MSG   ' @RTCD   7                 E32797041713
     C************         PARM '*KEY   ' @OPTN   7                 E32797041713
     C************         PARM *BLANKS   P@CUST  6                 E32797041713
     C************         PARM           P@CYCD  3                 E32797041713
     C************         PARM *BLANKS   P@ACCD  4                 E32797041713
     C************         PARM *BLANKS   P@ACSN  2                 E32797041713
     C************         PARM           P@NONB  2                 E32797041713
     C************         PARM *BLANKS   P@BRCD  3                 E32797041713
     C************         PARM *BLANKS   P@CSSN 10                 E32797041713
     C************         PARM *BLANKS   P@PNOI  1                 E32797041713
     C***********SDNOST    PARM SDNOST    DSFDY                     E32363041713
      ************                                                  E32363041713
      ***Error****                                                  E32363041713
     C***********@RTCD     IFNE *BLANKS                             E32363041713
     C************LOCK     IN   LDA                                 E32363041713
     C************         MOVE '013'     DBASE                     E32363041713
     C************         MOVE P@CYCD    @WK5    5                 E32363041713
     C************         MOVELPONS      @WK5             * * * * *E32363041713
     C************         MOVEL@WK5      DBKEY            *  DBERR E32363041713
     C************         MOVEL'SDNOSTPD'DBFILE           * * * * *E32363041713
     C************         OUT  LDA                                 E32363041713
     C************         EXSR *PSSR                               E32363041713
     C************         END                                      E32363041713
      ************                                                  E32363041713
      ***A/C*with*Institution is equal to the pay nostro customer   E32363041713
     C************         MOVELA7CUST    AWBN                      E32363041713
     C************         END                                      E32363041713
     C************         END                                      E32363041713
     C/COPY WNCPYSRC,DL6305C016
      *                                                                                       255986
      ** Bank to Bank Information fields                                                      255986
      *                                                                                       255986
     C           CSW212    IFNE 'Y'                                                           CSW212
     C           @TYP      ORNE '300'                                                         CSW212
     C                     MOVELBTB1      MGBTB1                                              255986
     C                     MOVELBTB2      MGBTB2                                              255986
     C                     MOVELBTB3      MGBTB3                                              255986
     C                     MOVELBTB4      MGBTB4                                              255986
     C                     MOVELBTB5      MGBTB5                                              255986
     C                     MOVELBTB6      MGBTB6                                              255986
     C                     ENDIF                                                              CSW212
      *
      * If Enhanced Receive Settlement Instructions feature is On output                      CDL094
      * receive bank to bank info                                                             CDL094
     C           CDL094    IFEQ 'Y'                                                           CDL094
     C           @TYP      IFEQ '320'                                                         CDL094
     C           @TYP      OREQ '330'                                                         CDL094
     C           RBTB1     IFNE *BLANKS                                                       CDL094
     C                     MOVELRBTB1     MGBTB1                                              CDL094
     C                     MOVELRBTB2     MGBTB2                                              CDL094
     C                     MOVELRBTB3     MGBTB3                                              CDL094
     C                     MOVELRBTB4     MGBTB4                                              CDL094
     C                     MOVELRBTB5     MGBTB5                                              CDL094
     C                     MOVELRBTB6     MGBTB6                                              CDL094
     C                     ENDIF                                                              CDL094
     C                     ENDIF                                                              CDL094
     C                     ENDIF                                                              CDL094
      *                                                                                       CDL094
     C                     ENDSR
      *****************************************************************
     C/EJECT
      *****************************************************************
      *   F300 - FORMAT MESSAGE SPECIFIC FIELDS FOR MT300             *
      *   Called by - VALD                                            *
      *****************************************************************
      *
     C           F300      BEGSR
      *
      **  Format fields for MT300
     C/COPY WNCPYSRC,DL6305C036
      *
     C                     Z-ADDEXRT      MGEXRT
     C/COPY WNCPYSRC,DL6305C037
     C                     MOVELPUCY      MGPUCY
      *
      ** If the deal is an option use original pay/sell amount
      *
     C           DTYP      IFEQ 'OP'
     C/COPY WNCPYSRC,DL6305C038
     C                     Z-ADDORPA      MGPAMT
     C/COPY WNCPYSRC,DL6305C039
     C                     Z-ADDOTDT      MGOTDT
     C/COPY WNCPYSRC,DL6305C040
     C                     Z-ADDORSA      MGSAMT
     C/COPY WNCPYSRC,DL6305C041
     C                     ELSE
     C/COPY WNCPYSRC,DL6305C042
     C                     Z-ADDPUAM      MGPAMT
     C                     Z-ADDSLAM      MGSAMT
     C/COPY WNCPYSRC,DL6305C043
     C                     END
      *
     C                     MOVELRIBN      MGRIBN
     C                     MOVELRIBA      MGRIBA                          056739
      *                                                                   CSW097
     C**********           Z-ADDPOBN      MGPOBN                                       CSW097 CSD027
     C**********           Z-ADDPOCN      MGPOCN                                       CSW097 CSD027
     C                     MOVE POBN      MGPOBN                                              CSD027
     C                     MOVE POCN      MGPOCN                                              CSD027
      *                                                                   CSW097
     C                     MOVELPIBN      MGPIBN
     C                     MOVELPIBA      MGPIBA                          056739
     C                     MOVELSLCY      MGSLCY
     C                     MOVELRONS      MGRONS
     C                     MOVELPONS      MGPONS
     C/COPY WNCPYSRC,DL6305C003
     C                     MOVELAWBN      MGAWBN
     C                     MOVELAWBA      MGAWBA
     C********** WWAWBA    IFEQ 'DIRECT'                            087195132679
     C********** WWAWBB    ANDEQ*BLANKS                             087195132679
     C**********           MOVEL'/DIRECT' MGAWBA    P               087195132679
     C**********           END                                      087195132679
     C/COPY WNCPYSRC,DL6305C004
     C                     MOVELRVNO      MGRVNO
     C                     MOVELBENN      MGBENN
     C                     MOVELBENA      MGBENA                          088043
      *                                                                   148702
     C           CVMR      IFEQ 'Y'                                       148702
     C           AWBN      ANDEQ*BLANKS                                   148702
     C                     MOVELRVNO      MGAWBN                          148702
     C                     MOVE *BLANKS   MGRVNO                          148702
     C                     ENDIF                                          148702
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL6305CCP1                                           S01408
     C*                                                                   S01408
      *                                                                   CSW012
     C           CSW012    IFEQ 'Y'                                       CSW012
     C           WACOC     ANDNE*BLANKS                                   CSW012
      *                                                                   CSW012
     C                     MOVEL*BLANKS   WDPNM  30                       CSW012
      *                                                                   CSW012
      **  Access Account Officer Details                                  CSW012
     C                     CALL 'AOACOFR0'                                CSW012
     C                     PARM *BLANKS   @RTCD                           CSW012
     C                     PARM '*KEY   ' @OPTN                           CSW012
     C                     PARM WACOC     @KEY2   2                       CSW012
     C           SDACOF    PARM SDACOF    DSSDY                           CSW012
      *                                                                   CSW012
     C           @RTCD     IFNE *BLANKS                                   CSW012
     C           *LOCK     IN   LDA                                       CSW012
     C                     MOVE '040'     DBASE            * * * * * * * *CSW012
     C                     MOVELWACOC     DBKEY            * DB ERROR 40 *CSW012
     C                     MOVEL'SDACOFPD'DBFILE           * * * * * * * *CSW012
     C                     OUT  LDA                                       CSW012
     C                     EXSR *PSSR                                     CSW012
     C                     ENDIF                                          CSW012
      *                                                                   CSW012
     C           @RTCD     IFEQ *BLANKS                                   CSW012
      *                                                                   CSW012
     C           AZDPCD    IFNE *BLANKS                                   CSW012
     C                     CALL 'AODEPTR0'                                CSW012
     C                     PARM *BLANKS   @RTCD                           CSW012
     C                     PARM '*KEY   ' @OPTN                           CSW012
     C                     PARM           AZDPCD                          CSW012
     C           SDDEPT    PARM SDDEPT    DSFDY                           CSW012
      *                                                                   CSW012
     C           @RTCD     IFNE *BLANKS                                   CSW012
     C           *LOCK     IN   LDA                                       CSW012
     C                     MOVE '041'     DBASE            * * * * * * * *CSW012
     C                     MOVELAZDPCD    DBKEY            * DB ERROR 41 *CSW012
     C                     MOVEL'SDDEPTPD'DBFILE           * * * * * * * *CSW012
     C                     OUT  LDA                                       CSW012
     C                     EXSR *PSSR                                     CSW012
     C                     ENDIF                                          CSW012
     C                     MOVELAEDPNM    WDPNM                           CSW012
     C                     ENDIF                                          CSW012
      *                                                                   CSW012
     C           '/NAME/'  CAT  AZACON:0  MGCTC1                          CSW012
     C           '/DEPT/'  CAT  WDPNM:0   MGCTC2                          CSW012
     C           AZAPHN    IFNE *BLANKS                                   CSW012
     C           '/PHON/'  CAT  AZAPHN:0  MGCTC3                          CSW012
     C                     ENDIF                                          CSW012
     C           AZAEXT    IFNE *BLANKS                                   CSW012
     C           MGCTC3    CAT  'EXT':1   MGCTC3                          CSW012
     C           MGCTC3    CAT  AZAEXT:1  MGCTC3                          CSW012
     C                     ENDIF                                          CSW012
     C                     ENDIF                                          CSW012
      *                                                                   CSW012
     C                     ENDIF                                          CSW012
      *                                                                   137909
      ** Move settlement currencies.                                      137909
     C           CEU003    IFEQ 'Y'                                       137909
     C                     EXSR STCY1                                     137909
     C                     ENDIF                                          137909
      *                                                                   CDL008
      ** CLS Settlement                                                   CDL008
      *                                                                   CDL008
     C           CDL008    IFEQ 'Y'                                       CDL008
     C                     MOVE CLSS      MGCLSS                          CDL008
     C                     ENDIF                                          CDL008
      *                                                                   CDL008
     C/COPY WNCPYSRC,DL6305C024
      *
     C           MGCHTP    IFEQ *BLANK                                                        CSW025
     C                     MOVE @CHG      MGCHTP                                              CSW025
     C                     ENDIF                                                              CSW025
      *                                                                                       CSW212
      ** Condition lines                                                                      CSW212
      *                                                                                       CSW212
     C                     MOVELCND1      MGCON1                                              CSW212
     C                     MOVELCND2      MGCON2                                              CSW212
     C                     MOVELCND3      MGCON3                                              CSW212
     C                     MOVELCND4      MGCON4                                              CSW212
     C                     MOVELCND5      MGCON5                                              CSW212
     C                     MOVELCND6      MGCON6                                              CSW212
      *                                                                                       CSW212
     C           CSW212    IFEQ 'Y'                                                           CSW212
      *                                                                                       CSW212
      ** Bank to Bank Information and ISDA fields                                             CSW212
      *                                                                                       CSW212
      * Use Receive Bank to Bank details if CDL094 is On                                      CDL094
     C           CDL094    IFEQ 'Y'                                                           CDL094
     C           RBTB1     ANDNE*BLANKS                                                       CDL094
     C                     MOVELRBTB1     MGBTB1                                              CDL094
     C                     MOVELRBTB2     MGBTB2                                              CDL094
     C                     MOVELRBTB3     MGBTB3                                              CDL094
     C                     MOVELRBTB4     MGBTB4                                              CDL094
     C                     MOVELRBTB5     MGBTB5                                              CDL094
     C                     MOVELRBTB6     MGBTB6                                              CDL094
     C                     ELSE                                                               CDL094
     C                     MOVELSSR1      MGBTB1                                              CSW212
     C                     MOVELSSR2      MGBTB2                                              CSW212
     C                     MOVELSSR3      MGBTB3                                              CSW212
     C                     MOVELSSR4      MGBTB4                                              CSW212
     C                     MOVELSSR5      MGBTB5                                              CSW212
     C                     MOVELSSR6      MGBTB6                                              CSW212
     C                     ENDIF                                                              CDL094
      *                                                                                       CSW212
      ** ISDA fields                                                                          CSW212
      *                                                                                       CSW212
     C                     MOVELAGTY      MGAGTY                                              CSW212
     C                     MOVELISDA      MGISDA                                              CSW212
     C                     MOVE AGDT      ZAGDT                                               CSW212
     C                     EXSR SRAGDT                                                        CSW212
     C                     MOVEL@@VDT     MGAGDT                                              CSW212
     C                     MOVEL*BLANKS   WAGVV   4                                           CSW212
     C                     MOVELAGVC      WAGVV                                               CSW212
     C                     MOVE AGVV      WAGVV                                               CSW212
     C                     MOVELWAGVV     MGAGVV                                              CSW212
      *                                                                                       CSW212
      ** Precious Metal Buy and Sell Indicators                                               CSW212
      *                                                                                       CSW212
     C                     MOVELMGPUCY    W#CYCD                                              CSW212
     C                     EXSR SRUCCY                                                        CSW212
     C                     MOVELA6PMRT    MGPMBC                                              CSW212
      *                                                                                       CSW212
     C                     MOVELMGSLCY    W#CYCD                                              CSW212
     C                     EXSR SRUCCY                                                        CSW212
     C                     MOVELA6PMRT    MGPMSC                                              CSW212
      *                                                                                       CMG003
     C                     MOVEL'N'       MT600   1                                           CMG003
     C           CMG003    IFEQ 'Y'                                                           CMG003
     C           MGCLSS    ANDNE'Y'                                                        AR1054657
     C           MGPMBC    IFEQ 'Y'                                                           CMG003
     C           MGPMSC    ANDEQ'N'                                                           CMG003
     C           MGPMBC    OREQ 'N'                                                           CMG003
     C           MGPMSC    ANDEQ'Y'                                                           CMG003
     C                     MOVEL'Y'       MT600                                               CMG003
     C                     ENDIF                                                              CMG003
     C                     ENDIF                                                              CMG003
     C                     ENDIF                                                              CSW212
      *                                                                                       CSW212
     C                     EXSR SRREPI                                                        CSW213
      *                                                                                       CSW213
     C           MT600     IFEQ 'Y'                                                           CMG003
     C                     WRITEMGF600D0               40                                     CMG003
     C                     MOVEL'MGF600PD'DBFILE                                              CMG003
     C                     ELSE                                                               CMG003
     C                     WRITEMGF300D0               40
     C                     MOVEL'MGF300PD'DBFILE                                              CMG003
     C                     ENDIF                                                              CMG003
      *                                                                                       CMG003
     C/COPY WNCPYSRC,DL6305C025
      *
     C           *IN40     IFEQ '1'
     C           *LOCK     IN   LDA
     C                     MOVE '005'     DBASE            * * * * * * * *
     C                     MOVEL@TYP      DBKEY            * DB ERROR 05 *
     C/COPY WNCPYSRC,DL6305C026
     C**********           MOVEL'MGF300PD'DBFILE           * * * * * * * *                    CMG003
     C/COPY WNCPYSRC,DL6305C027
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END
      *
     C                     ENDSR
      *****************************************************************
     C/EJECT
      *****************************************************************
      *   F320 - FORMAT MESSAGE SPECIFIC FIELDS FOR MT320             *
      *   Called by - VALD                                            *
      *   Calls - LORD                                                *
      *****************************************************************
      *
     C           F320      BEGSR
     C/COPY WNCPYSRC,DL6305C070
      *
      **  Format fields for MT320
      *
      **  Check for negative interest
      *
     C                     TESTB'1'       DSTI           20
      *                                                                                       234068
     C                     MOVE 'N'       WTXDT   1                                           234068
     C                     Z-ADD*ZEROS    WNTAMT                                              234068
     C           CGL031    IFEQ 'Y'                                                           234068
      *                                                                                       234068
      ** Check if deal type if liable for tax                                                 234068
      *                                                                                       234068
     C           DTYP      IFEQ 'IT'                                                          234068
     C           DTYP      OREQ 'CD'                                                          234068
     C           DTYP      OREQ 'TD'                                                          234068
     C           DTYP      OREQ 'DT'                                                          234068
     C           CDL006    ANDEQ'Y'                                                           234068
     C           DTYP      OREQ 'LT'                                                          234068
     C           CDL006    ANDEQ'Y'                                                           234068
     C           DTYP      OREQ 'FT'                                                          234068
     C           CDL006    ANDEQ'Y'                                                           234068
     C                     MOVE 'Y'       WTXDT   1                                           234068
     C                     ENDIF                                                              234068
      *                                                                                       234068
      ** Call Deposits                                                                        234068
      *                                                                                       234068
     C           DTYP      IFEQ 'CD'                                                          234068
     C           MDAT      ANDEQ0                                                             234068
     C           DTYP      OREQ 'DT'                                                          234068
     C           CDL006    ANDEQ'Y'                                                           234068
     C           MDAT      ANDEQ0                                                             234068
     C           DTYP      OREQ 'LT'                                                          234068
     C           CDL006    ANDEQ'Y'                                                           234068
     C           MDAT      ANDEQ0                                                             234068
      *                                                                                       234068
     C           DVDAT     IFGE BJRDNB                                                        234068
     C           NOTD      IFEQ 0                                                             234068
     C           DVDAT     ADD  1         WKMDAT  50                                          234068
     C                     ELSE                                                               234068
     C           NOTD      ADD  DVDAT     WKMDAT                                              234068
     C                     ENDIF                                                              234068
     C                     ENDIF                                                              234068
      *                                                                                       234068
     C           DVDAT     IFLT BJRDNB                                                        234068
     C           NOTD      IFEQ 0                                                             234068
     C           BJRDNB    ADD  1         WKMDAT                                              234068
     C                     ELSE                                                               234068
     C           NOTD      ADD  BJRDNB    WKMDAT                                              234068
     C                     ENDIF                                                              234068
     C                     ENDIF                                                              234068
      *                                                                                       234068
      ** Else, Fixed Term Deposits                                                            234068
      *                                                                                       234068
     C                     ELSE                                                               234068
     C                     Z-ADDMDAT      WKMDAT                                              234068
     C                     ENDIF                                                              234068
      *                                                                                       234068
     C           WTXDT     IFEQ 'Y'                                                           234068
     C                     MOVE DLNO      WDLNO   6                                           234068
     C                     MOVE CNUM      WCNUM   6                                           234068
     C                     EXSR SRCHKD                                                        234068
     C           WSKIP     IFEQ 'N'                                                           234068
     C                     EXSR SRCEUT                                                        234068
     C                     ELSE                                                               234068
     C                     Z-ADD*ZEROS    WNTAMT                                              234068
     C                     ENDIF                                                              234068
     C                     ENDIF                                                              234068
     C                     ENDIF                                                              234068
     C/COPY WNCPYSRC,DL6305C044
     C           *IN20     IFEQ '1'
     C/COPY WNCPYSRC,DL6305C045
     C                     Z-SUBTOTI      MGTOTI
     C                     ELSE
     C                     Z-ADDTOTI      MGTOTI
     C/COPY WNCPYSRC,DL6305C046
     C                     END
     C/COPY WNCPYSRC,DL6305C047
     C                     SUB  WNTAMT    MGTOTI                                              234068
      *
     C                     Z-ADDPCPL      MGPCPL
     C/COPY WNCPYSRC,DL6305C048
     C                     Z-ADDRODN      MGROTN
      *                                                                   CEU015
     C                     Z-ADDRODA      WRODA                           CEU015
     C                     Z-ADD0         P@OUTA                          CEU015
     C           CEU015    IFEQ 'Y'                                       CEU015
     C           RTFC      ANDNE*BLANKS                                   CEU015
     C           RODA      ANDNE0                                         CEU015
     C                     Z-ADDRODA      P@FRAM                          CEU015
     C                     MOVELRTFC      P@FRCY                          CEU015
     C                     MOVELCCY       P@TOCY                          CEU015
      *                                                                   CEU015
      ** Convert RBDA to deal currency equivalent via call to EU0200      CEU015
      *                                                                   CEU015
     C                     CALL 'EU0200'                                  CEU015
     C                     PARM *BLANKS   P@RTCD  7                       CEU015
     C                     PARM           P@FRAM 183                      CEU015
     C                     PARM           P@FRCY  3                       CEU015
     C                     PARM           P@TOCY  3                       CEU015
     C                     PARM           P@OUTA 150                      CEU015
     C                     PARM           P@INTA 183                      CEU015
     C                     PARM           P@EXRT 159                      CEU015
     C                     PARM           P@MDIN  1                       CEU015
     C*                                                                   CEU015
     C** Database error processing if P@RTCD = *ERROR                     CEU015
     C*                                                                   CEU015
     C           P@RTCD    IFEQ '*ERROR*'                                 CEU015
     C           *LOCK     IN   LDA                                       CEU015
     C                     MOVEL'EU0200  'DBFILE           ************** CEU015
     C                     MOVEL' 17'     DBASE            ** DBERROR 17  CEU015
     C                     MOVE *BLANKS   DBKEY            ************** CEU015
     C                     OUT  LDA                                       CEU015
     C                     EXSR *PSSR                                     CEU015
     C                     ENDIF                                          CEU015
     C                     Z-ADDP@OUTA    WRODA                           CEU015
     C                     ENDIF                                          CEU015
      *
     C***********RODA      IFLT 0                                         CEU015
     C***********          Z-SUBRODA      MGROTA                          CEU015
     C***********          ELSE                                           CEU015
     C***********          Z-ADDRODA      MGROTA                          CEU015
     C***********          END                                            CEU015
     C/COPY WNCPYSRC,DL6305C049
      *                                                                   CEU015
     C           WRODA     IFLT 0                                         CEU015
     C/COPY WNCPYSRC,DL6305C050
     C                     Z-SUBWRODA     MGROTA                          CEU015
     C                     ELSE                                           CEU015
     C                     Z-ADDWRODA     MGROTA                          CEU015
     C/COPY WNCPYSRC,DL6305C051
     C                     END                                            CEU015
      *
     C                     Z-ADDINTR      MGINTR
      *                                                                   109795
      **  If Front-up interest, next interest date is value date          109795
      *                                                                   109795
     C           FUID      IFEQ 'Y'                                       109795
     C                     Z-ADDDVDAT     MGNIDT                          109795
     C                     ELSE                                           109795
     C                     Z-ADDNIDT      MGNIDT
     C                     END                                            109795
     C                     Z-ADDSLID      MGSLID
     C                     MOVELICBS      MGICBS
     C                     MOVELIPFR      MGIPFR
      *
     C                     MOVELPONS      MGPONS
     C                     MOVELRONS      MGRONS
     C                     MOVELPIBN      MGPIBN
     C                     MOVELPIBA      MGPIBA                          056739
     C                     MOVELRIBN      MGRIBN
     C                     MOVELRIBA      MGRIBA                          056739
     C/COPY WNCPYSRC,DL6305C005
     C                     MOVELAWBN      MGAWBN
     C                     MOVELAWBA      MGAWBA
     C********** WWAWBA    IFEQ 'DIRECT'                            087195132679
     C********** WWAWBB    ANDEQ*BLANKS                             087195132679
     C**********           MOVEL'/DIRECT' MGAWBA    P               087195132679
     C**********           END                                      087195132679
     C/COPY WNCPYSRC,DL6305C006
     C                     MOVELRVNO      MGRVNO
     C                     MOVELBENN      MGBENN
     C                     MOVELBENA      MGBENA                          088043
      *                                                                                       CSW213
     C                     MOVE POBN      MGPOBN                                              CSW213
     C                     MOVE POCN      MGPOCN                                              CSW213
      *                                                                   148702
     C           CVMR      IFEQ 'Y'                                       148702
     C           AWBN      ANDEQ*BLANKS                                   148702
     C                     MOVELRVNO      MGAWBN                          148702
     C                     MOVE *BLANKS   MGRVNO                          148702
     C                     ENDIF                                          148702
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL6305CCP2                                           S01408
     C*                                                                   S01408
     C*                                                                   077898
     C**  Access corresponding deal record                                077898
     C*                                                                   077898
     C***********RODA      IFNE 0                                   077898CEU015
     C           WRODA     IFNE 0                                         CEU015
     C********** S01434    ANDEQ'Y'                                                    077898 233003
     C***********PCPL      ANDNERODA                                079771CEU015
     C***********PCPL      ANDNEWRODA                                                  CEU015 232540
     C           PCPL      ANDNEWRODA                                                         233056
     C           DRECI     ANDNE'R'                                       102286
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL6305CCP4                                           S01408
     C*                                                                   S01408
     C***********RODN      CHAINDEALALL              11             077898102717
     C***********RODN      CHAINDEALSALL             11             102717181719
     C************IN11     IFEQ '1'                                 077898181719
     C************LOCK     IN   LDA                                 077898181719
     C***********          MOVE '001'     DBASE            * * * * *077898181719
     C***********          MOVELRODN      DBKEY            * DB ERROR 0198181719
     C*********************MOVEL'DEALALL' DBFILE           * * * * *077898102717
     C***********          MOVEL'DEALSALL'DBFILE           * * * * *102717181719
     C***********          OUT  LDA                                 077898181719
     C***********          EXSR *PSSR                               077898181719
     C***********          END                                      077898181719
      *                                                                                       198942
     C           RODN      CHAINDEALSALL             11                                       198942
      *                                                                                       198942
     C           *IN11     IFEQ '1'                                                           198942
     C********** *LOCK     IN   LDA                                                   198942 260339A
     C**********           MOVE '001'     DBASE            ****************           198942 260339A
     C**********           MOVELRODN      DBKEY            * DB ERROR 001 *           198942 260339A
     C**********           MOVEL'DEALSALL'DBFILE           ****************           198942 260339A
     C**********           OUT  LDA                                                   198942 260339A
     C**********           EXSR *PSSR                                                 198942 260339A
      *                                                                                      260339A
      ** If old deal already purged from the system, suppres DBASE error                     260339A
      ** and reset MGROTN field to zero.                                                     260339A
      *                                                                                      260339A
     C                     Z-ADD0         MGROTN                                             260339A
      *                                                                                      260339A
     C**********           ENDIF                                                      198942 260339A
      *                                                                                      260339A
      ** If RODN found....                                                                   260339A
      *                                                                                      260339A
     C                     ELSE                                                              260339A
      *                                                                                       198942
     C           CEU015    IFEQ 'Y'                                       148209
     C           RTFC      ANDNE*BLANKS                                   160794
     C                     Z-ADDTOTI      P@FRAM                          148209
     C                     MOVELCCY       P@FRCY                          148209
      *                                                                   148209
      ** Convert RBDA to deal currency equivalent via call to EU0200      148209
     C                     CALL 'EU0200'                                  148209
     C                     PARM *BLANKS   P@RTCD  7                       148209
     C                     PARM           P@FRAM 183                      148209
     C                     PARM           P@FRCY  3                       148209
     C                     PARM           P@TOCY  3                       148209
     C                     PARM           P@OUTA 150                      148209
     C                     PARM           P@INTA 183                      148209
     C                     PARM           P@EXRT 159                      148209
     C                     PARM           P@MDIN  1                       148209
     C*                                                                   148209
     C** Database error processing if P@RTCD = *ERROR                     148209
     C           P@RTCD    IFEQ '*ERROR*'                                 148209
     C           *LOCK     IN   LDA                                       148209
     C                     MOVEL'EU0200  'DBFILE           ************** 148209
     C                     MOVEL' 42'     DBASE            ** DBERROR 42  148209
     C                     MOVE *BLANKS   DBKEY            ************** 148209
     C                     OUT  LDA                                       148209
     C                     EXSR *PSSR                                     148209
     C                     ENDIF                                          148209
     C                     Z-ADDP@OUTA    MGTTLI                          148209
     C                     ELSE                                           148209
     C/COPY WNCPYSRC,DL6305C052
     C***********          Z-ADDTOTI      MGTTLI                    077898181719
     C                     Z-ADDTOTI      MGTTLI                                              198942
     C/COPY WNCPYSRC,DL6305C053
     C                     END                                            148209
     C/COPY WNCPYSRC,DL6305C011
     C***********          MOVELIPDS      MGIPDS                    077898181719
     C           S01434    IFEQ 'Y'                                                           233003
     C                     MOVELIPDS      MGIPDS                                              198942
     C                     ELSE                                                               233003
     C                     MOVEL'N'       MGIPDS                                              233003
     C                     ENDIF                                                              233003
      *                                                                                      260339A
     C                     ENDIF                                                             260339A
      *                                                                                      260339A
     C/COPY WNCPYSRC,DL6305C012
     C*                                                                   077898
      *                                                                   CSW200
      * Set up fields for Swift 2000 Changes                              CSW200
      *                                                                   CSW200
     C           CSW200    IFEQ 'Y'                                       CSW200
     C                     MOVELINSA      MGINSA                          CSW200
     C                     MOVELIMET      MGIMET                          CSW200
     C                     MOVELINOS      MGINOS                          CSW200
     C                     MOVELISCY      MGISCY                          CSW200
     C                     ENDIF                                          CSW200
     C           RBDN      IFNE 0                                         165933
      *                                                                   CSW200
     C           RBDN      CHAINDEALS                11                   077898
     C*                                                                   077898
     C           *IN11     IFEQ '1'                                       077898
     C           DRECI     ORNE 'D'                                       077898
     C           *LOCK     IN   LDA                                       077898
     C*********************MOVE '001'     DBASE            * * * * 077898 181719
     C*********************MOVELRBDN      DBKEY     * DB ERROR 01 *077898 181719
     C                     MOVE '993'     DBASE            * * * * * * * *181719
     C                     MOVELRBDN      DBKEY            * DB ERROR 993*181719
     C*********************MOVEL'DEALS'   DBFILE           * * * * *077898077898
     C                     MOVEL'DEALS2'  DBFILE           * * * * * * * *077898
     C                     OUT  LDA                                       077898
     C                     EXSR *PSSR                                     077898
     C                     ELSE                                                               247840
      *                                                                                       247840
      * Set up fields for Swift 2000 Changes                                                  247840
      *                                                                                       247840
     C           CSW200    IFEQ 'Y'                                                           247840
     C                     MOVELIPDS      MGIPDS                                              247840
     C                     MOVELINSA      MGINSA                                              247840
     C                     MOVELIMET      MGIMET                                              247840
     C                     MOVELINOS      MGINOS                                              247840
     C                     MOVELISCY      MGISCY                                              247840
     C                     ENDIF                                                              247840
      *                                                                                       247840
     C                     END                                            077898
     C                     ENDIF                                          165933
     C*                                                                   077898
     C                     ELSE                                           077898
     C                     Z-ADD0         MGTTLI                          077898
     C/COPY WNCPYSRC,DL6305C013
     C                     MOVEL'N'       MGIPDS                          077898
      *                                                                   CSW200
      * Set up fields for Swift 2000 Changes                              CSW200
      *                                                                   CSW200
     C           CSW200    IFEQ 'Y'                                       CSW200
     C                     MOVELIPDS      MGIPDS                          CSW200
     C                     MOVELINSA      MGINSA                          CSW200
     C                     MOVELIMET      MGIMET                          CSW200
     C                     MOVELINOS      MGINOS                          CSW200
     C                     MOVELISCY      MGISCY                          CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
     C/COPY WNCPYSRC,DL6305C014
     C                     END                                            077898
     C/COPY WNCPYSRC,DL6305C015
      *
      ** Check for loan or deposit
      *
     C                     EXSR LORD
      *
      ** Move settlement currencies.                                      137909
     C           CEU003    IFEQ 'Y'                                       137909
     C                     EXSR STCY2                                     137909
     C                     ENDIF                                          137909
     C/COPY WNCPYSRC,DL6305C028
      *                                                                   137909
      *                                                                   CSW200
      * Set up fields for Swift 2000 Changes                              CSW200
      *                                                                   CSW200
     C           CSW200    IFEQ 'Y'                                       CSW200
     C                     MOVEL*BLANKS   MGMATU                          CSW200
     C                     MOVEL*ZEROS    MGAMTT                          CSW200
     C                     MOVEL*ZEROS    MGINTA                          CSW200
      *                                                                   CSW200
      * Test bit 1 of the confirmation indicator                          CSW200
      * ( If on, this means that a maturity confirmation has been producedCSW200
      *  so the MT320 prduced should be an amended or cancelled mat. conf)CSW200
     C                     TESTB'1'       CNFI           20               CSW200
     C           *IN20     IFEQ '1'                                       CSW200
     C                     MOVEL'I'       MGMATU                          CSW200
     C           PCPL      ADD  INTA      MGAMTT                          CSW200
     C                     SUB  RBDA      MGAMTT                          CSW200
     C           INTA      IFLT *ZERO                                     CSW200
     C                     Z-SUBINTA      MGINTA                          CSW200
     C                     ELSE                                           CSW200
     C                     Z-ADDINTA      MGINTA                          CSW200
     C                     ENDIF                                          CSW200
     C*                    SUB  WNTAMT    MGINTA                                            AR784699
     C                     ENDIF                                          CSW200
     C                     ENDIF                                          CSW200
     C/COPY WNCPYSRC,DL6305C068
      *                                                                   CSW200
     C           MGCHTP    IFEQ *BLANK                                                        CSW025
     C                     MOVE @CHG      MGCHTP                                              CSW025
     C                     ENDIF                                                              CSW025
     C/COPY WNCPYSRC,DLH00433
      *                                                                                       CSW208
     C           DLSWCF    IFEQ 'Y'                                                           CSW208
     C                     ADD  1         WSEQN                                               CSW208
     C                     EXSR X320                                                          CSW208
     C                     Z-ADDWSEQN     MGSEQN                                              CSW208
     C                     Z-ADDWFECNT    MGFTOT                                              CSW208
     C                     ENDIF                                                              257464
     C/COPY WNCPYSRC,DLH00434
      *                                                                                       257464
     C                     MOVE 'N'       MGFLTR                                              CSW208
      *                                                                                       CSW208
     C           CDL019    IFEQ 'Y'                                                           CSW208
     C********** BRTT      ANDNE*ZEROS                                                 CSW208 CSD103
     C           BRTT      ANDNE*BLANKS                                                       CSD103
     C           FSFBRT    ANDNE'Y'                                                         AR916361
     C                     MOVE 'Y'       MGFLTR                                              CSW208
     C**********           Z-ADD*ZEROS    MGINTR                                     CSW208 MD050419
     C**********           Z-ADD*ZEROS    MGTOTI                                     CSW208 MD050419
     C                     ENDIF                                                              CSW208
      *                                                                                       CSW208
     C**********           ENDIF                                                       CSW208 257464
      *                                                                                       CSW208
     C                     WRITEMGF320D0               40
     C/COPY WNCPYSRC,DL6305C029
      *
     C           *IN40     IFEQ '1'
     C           *LOCK     IN   LDA
     C                     MOVE '006'     DBASE            * * * * * * * *
     C                     MOVEL@TYP      DBKEY            * DB ERROR 06 *
     C                     MOVEL'MGF320PD'DBFILE           * * * * * * * *
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END
     C/COPY WNCPYSRC,DL6305C071
      *
     C                     ENDSR
      *****************************************************************
     C/EJECT
      *****************************************************************                       CSW208
      *   X320 - Format message specific fields for MT320             *                       CSW208
      *   Called by - F320                                            *                       CSW208
      *   Calls - X320H, X320L                                        *                       CSW208
      *****************************************************************                       CSW208
      *                                                                                       CSW208
     C           X320      BEGSR                                                              CSW208
      *                                                                                       CSW208
     C           KFEED     KLIST                                                              CSW208
     C                     KFLD           CDLNO                                               CSW208
      *                                                                                       CSW208
     C                     Z-ADD*ZEROS    WFECNT  50                                        BUG20927
     C           KFEED     SETLLDLFHSTL0                                                      CSW208
     C           KFEED     READEDLFHSTL0                 99                                   CSW208
      *                                                                                       CSW208
     C           *IN99     DOWEQ'0'                                                           CSW208
     C                     EXSR X320H                                                         CSW208
      *                                                                                       CSW208
     C           KFEED     READEDLFHSTL0                 99                                   CSW208
     C                     ENDDO                                                              CSW208
      *                                                                                       CSW208
     C           KFEED     SETLLDLFEEDLI                                                      CSW208
     C           KFEED     READEDLFEEDLI                 99                                   CSW208
      *                                                                                       CSW208
     C           *IN99     DOWEQ'0'                                                           CSW208
     C                     EXSR X320L                                                         CSW208
      *                                                                                       CSW208
     C           KFEED     READEDLFEEDLI                 99                                   CSW208
     C                     ENDDO                                                              CSW208
      *                                                                                       CSW208
     C                     ENDSR                                                              CSW208
      *****************************************************************                       CSW208
     C/EJECT                                                                                  CSW208
      *****************************************************************                       CSW208
      *   X320H - Format message specific fields for MT320            *                       CSW208
      *   Called by - X320                                            *                       CSW208
      *   Calls - None                                                *                       CSW208
      *****************************************************************                       CSW208
      *                                                                                       CSW208
     C           X320H     BEGSR                                                              CSW208
      *                                                                                       CSW208
     C                     ADD  1         WFECNT                                              CSW208
      *                                                                                       CSW208
     C                     Z-ADDWSEQN     MFSEQN                                              CSW208
     C                     Z-ADDWFECNT    MFSEQO                                              CSW208
     C                     Z-ADDHIHDAT    MFPDAT                                              CSW208
     C                     MOVELHIFCCY    MFPCCY                                              CSW208
     C                     Z-ADDHIAMTS    MFPAMT                                              CSW208
     C                     MOVELHIPONS    MFPONS                                              CSW208
     C                     MOVELHIRVNO    MFRVNO                                              CSW208
     C                     MOVELHIPIBN    MFPIBN                                              CSW208
     C                     MOVELHIPIBA    MFPIBA                                              CSW208
     C                     MOVELHIAWBN    MFAWBN                                              CSW208
     C                     MOVELHIAWBA    MFAWBA                                              CSW208
     C                     MOVELHIRONS    MFRONS                                              CSW208
     C                     MOVELHIRIBN    MFRIBN                                              CSW208
     C                     MOVELHIRIBA    MFRIBA                                              CSW208
     C                     MOVELHIBENN    MFBENN                                              CSW208
     C                     MOVELHIBENA    MFBENA                                              CSW208
     C                     MOVELHIOMDB    MFPOBR                                              CSW208
     C                     MOVELHIOSDB    MFROBR                                              CSW208
     C                     Z-ADDHIPSTM    MFPSTM                                              CSW208
     C                     Z-ADDHIRSTM    MFRSTM                                              CSW208
     C                     MOVELHISCCY    MFSTCY                                              CSW208
     C                     MOVELHISCCY    MFPSCY                                              CSW208
     C                     MOVEL'H'       MFHIST                                              CSW208
     C                     WRITEMGX320D0                                                      CSW208
      *                                                                                       CSW208
     C                     ENDSR                                                              CSW208
      *****************************************************************                       CSW208
     C/EJECT                                                                                  CSW208
      *****************************************************************                       CSW208
      *   X320L - Format message specific fields for MT320            *                       CSW208
      *   Called by - X320, ZFREQB                                    *                       CSW208
      *   Calls - X320L2                                              *                       CSW208
      *****************************************************************                       CSW208
      *                                                                                       CSW208
     C           X320L     BEGSR                                                              CSW208
      *                                                                                       CSW208
     C           DFPYON    IFEQ ' '                                                           CSW208
     C           DFPYON    OREQ 'S'                                                           CSW208
     C                     Z-ADDDFPSTD    MFPDAT                                              CSW208
     C                     EXSR X320L2                                                        CSW208
     C                     ENDIF                                                              CSW208
      *                                                                                       CSW208
     C           DFPYON    IFEQ 'E'                                                           CSW208
     C                     Z-ADDDFPEND    MFPDAT                                              CSW208
     C                     EXSR X320L2                                                        CSW208
     C                     ENDIF                                                              CSW208
      *                                                                                       CSW208
     C           DFPYON    IFEQ 'N'                                                           CSW208
      *                                                                                       CSW208
     C           DFNPYD    IFEQ *ZEROS                                                        CSW208
     C                     Z-ADDDFPEND    MFPDAT                                              CSW208
     C                     ELSE                                                               CSW208
     C                     Z-ADDDFNPYD    MFPDAT                                              CSW208
     C                     ENDIF                                                              CSW208
      *                                                                                       CSW208
     C                     EXSR X320L2                                                        CSW208
      *                                                                                       CSW208
     C                     Z-ADDMFPDAT    NWNPYD  50                                          CSW208
      *                                                                                       CSW208
     C           NWNPYD    DOWLTDFPEND                                                        CSW208
      *                                                                                       CSW208
      ** If frequency not blank, calculate next payment date                                  CSW208
      *                                                                                       CSW208
     C           DFFREQ    IFNE *BLANKS                                                       CSW208
     C                     MOVE DFFREQ    ZFREQ   1                                           CSW208
     C                     Z-ADDNWNPYD    ZDAYNO  50                                          CSW208
     C                     Z-ADDDFDYIM    ZMDAY   20                                          CSW208
     C                     MOVE BJLCCY    ZCCY    3                                           CSW208
     C                     MOVE *BLANK    ZZERR@  7                                           CSW208
      *                                                                                       CSW208
     C                     EXSR ZFREQB                                                        CSW208
      *                                                                                       CSW208
     C           ZZERR@    IFNE *BLANKS                                                       CSW208
     C                     MOVE '003'     DBASE            * * * * * * * *                    CSW208
     C                     MOVELDFNPYD    DBKEY            * DB ERROR 03 *                    CSW208
     C                     MOVEL'ZFREQB'  DBFILE           * * * * * * * *                    CSW208
     C                     EXSR *PSSR                                                         CSW208
     C                     ENDIF                                                              CSW208
      *                                                                                       CSW208
     C           ZDAYNO    IFGT DFPEND                                                        CSW208
     C                     Z-ADDDFPEND    NWNPYD                                              CSW208
     C                     ELSE                                                               CSW208
     C                     Z-ADDZDAYNO    NWNPYD                                              CSW208
     C                     ENDIF                                                              CSW208
      *                                                                                       CSW208
     C                     ELSE                                                               CSW208
     C                     Z-ADDDFPEND    NWNPYD                                              CSW208
     C                     ENDIF                                                              CSW208
      *                                                                                       CSW208
     C                     ADD  1         WFECNT                                              CSW208
     C                     Z-ADDWFECNT    MFSEQO                                              CSW208
     C                     Z-ADDNWNPYD    MFPDAT                                              CSW208
     C                     WRITEMGX320D0                                                      CSW208
      *                                                                                       CSW208
     C                     ENDDO                                                              CSW208
      *                                                                                       CSW208
     C                     ENDIF                                                              CSW208
      *                                                                                       CSW208
     C                     ENDSR                                                              CSW208
      *****************************************************************                       CSW208
     C/EJECT                                                                                  CSW208
      *****************************************************************                       CSW208
      *   X320L2 - Format message specific fields for MT320           *                       CSW208
      *   Called by - X320L                                           *                       CSW208
      *   Calls - None                                                *                       CSW208
      *****************************************************************                       CSW208
      *                                                                                       CSW208
     C           X320L2    BEGSR                                                              CSW208
      *                                                                                       CSW208
     C                     ADD  1         WFECNT                                              CSW208
      *                                                                                       CSW208
     C                     Z-ADDWSEQN     MFSEQN                                              CSW208
     C                     Z-ADDWFECNT    MFSEQO                                              CSW208
     C                     MOVELDFFCCY    MFPCCY                                              CSW208
     C                     Z-ADDDFFAMT    MFPAMT                                              CSW208
     C                     MOVELDFPONS    MFPONS                                              CSW208
     C                     MOVELDFRVNO    MFRVNO                                              CSW208
     C                     MOVELDFPIBN    MFPIBN                                              CSW208
     C                     MOVELDFPIBA    MFPIBA                                              CSW208
     C                     MOVELDFAWBN    MFAWBN                                              CSW208
     C                     MOVELDFAWBA    MFAWBA                                              CSW208
     C                     MOVELDFRONS    MFRONS                                              CSW208
     C                     MOVELDFRIBN    MFRIBN                                              CSW208
     C                     MOVELDFRIBA    MFRIBA                                              CSW208
     C                     MOVELDFBENN    MFBENN                                              CSW208
     C                     MOVELDFBENA    MFBENA                                              CSW208
     C                     MOVELDFOMDB    MFPOBR                                              CSW208
     C                     MOVELDFOSDB    MFROBR                                              CSW208
     C                     Z-ADDDFPSTM    MFPSTM                                              CSW208
     C                     Z-ADDDFRSTM    MFRSTM                                              CSW208
     C                     MOVELDFSCCY    MFSTCY                                              CSW208
     C                     MOVELDFSCCY    MFPSCY                                              CSW208
     C                     MOVEL'L'       MFHIST                                              CSW208
     C                     WRITEMGX320D0                                                      CSW208
      *                                                                                       CSW208
     C                     ENDSR                                                              CSW208
      *****************************************************************                       CSW208
     C/EJECT                                                                                  CSW208
      *****************************************************************                       CSW208
      *   Standard Midas Subroutine                                   *                       CSW208
      *   Called by - X320L                                           *                       CSW208
      *   Calls - ZFREQB                                              *                       CSW208
      *****************************************************************                       CSW208
     C/COPY ZSRSRC,ZFREQBZ2                                                                   CSW208
      *****************************************************************                       CSW208
     C/EJECT                                                                                  CSW208
      *****************************************************************
      *   F330 - FORMAT MESSAGE SPECIFIC FIELDS FOR MT330             *
      *   Called by - VALD  Calls - LORD                              *
      *****************************************************************
      *
     C           F330      BEGSR
      *
      **  Format fields for MT330
     C/COPY WNCPYSRC,DL6305C054
      *
     C                     Z-ADDPCPL      MGPCPL
     C/COPY WNCPYSRC,DL6305C055
      *                                                                   179816
      ** Don't setup MGNAMT if insert of mdat for CD/CL                   179816
      ** ( assuming 330 is only for CD/CL )                               179816
      *                                                                   179816
     C           NOTD      IFLT 0                                         172657
     C                     Z-ADD0         MGNAMT                          172657
     C                     ELSE                                           172657
     C/COPY WNCPYSRC,DL6305C056
     C                     Z-ADDPCPL      MGNAMT                          E29588
     C/COPY WNCPYSRC,DL6305C057
     C                     END                                            172657
     C                     Z-ADDINTR      MGINTR
     C                     Z-ADDNIDT      MGNIDT
     C           DTYP      IFEQ 'CD'                                      179816
     C           MDAT      ANDNE0                                         179816
     C           DTYP      OREQ 'CL'                                      179816
     C           MDAT      ANDNE0                                         179816
     C           IACD      IFGE SLID                                      179816
     C                     Z-ADDIACD      MGSLID                          179816
     C           NIDT      IFEQ 0                                         179848
     C                     Z-ADDMDAT      MGNIDT                          179816
     C                     ENDIF                                          179848
     C                     END                                            179816
     C                     END                                            179816
     C                     MOVE ICBS      MGICBS
     C/COPY WNCPYSRC,DL6305C058
     C                     Z-ADDTOTI      MGTOTI
     C/COPY WNCPYSRC,DL6305C059
     C                     MOVELIPFR      MGIPFR
     C                     MOVELNOTD      MGNOTD
     C                     MOVELPONS      MGPONS
     C                     MOVELPIBN      MGPIBN
     C                     MOVELPIBA      MGPIBA                          056739
     C/COPY WNCPYSRC,DL6305C007
     C                     MOVELAWBN      MGAWBN
     C                     MOVELAWBA      MGAWBA
     C********** WWAWBA    IFEQ 'DIRECT'                            087195132679
     C********** WWAWBB    ANDEQ*BLANKS                             087195132679
     C**********           MOVEL'/DIRECT' MGAWBA    P               087195132679
     C**********           END                                      087195132679
     C/COPY WNCPYSRC,DL6305C008
     C                     MOVELRVNO      MGRVNO
     C                     MOVELRONS      MGRONS
     C                     MOVELRIBN      MGRIBN
     C                     MOVELRIBA      MGRIBA                          056739
     C                     MOVELBENN      MGBENN
     C                     MOVELBENA      MGBENA                          088043
      *                                                                                       CSW213
     C                     MOVE POBN      MGPOBN                                              CSW213
     C                     MOVE POCN      MGPOCN                                              CSW213
      *
      ** Check for loan or deposit
      *
     C                     EXSR LORD
      *
      ** Move settlement currencies.                                      137909
     C           CEU003    IFEQ 'Y'                                       137909
     C                     EXSR STCY2                                     137909
     C                     ENDIF                                          137909
     C/COPY WNCPYSRC,DL6305C030
      *                                                                   137909
      *                                                                   CSW200
      * Set up fields for Swift 2000 Changes                              CSW200
      *                                                                   CSW200
     C           CSW200    IFEQ 'Y'                                       CSW200
     C                     MOVELIPDS      MGIPDS                          CSW200
     C                     MOVELINSA      MGINSA                          CSW200
     C                     MOVELIMET      MGIMET                          CSW200
     C                     MOVELINOS      MGINOS                          CSW200
     C                     MOVELISCY      MGISCY                          CSW200
     C                     ENDIF                                          CSW200
     C/COPY WNCPYSRC,DL6305C069
      *                                                                   CSW200
     C           MGCHTP    IFEQ *BLANK                                                        CSW025
     C                     MOVE @CHG      MGCHTP                                              CSW025
     C                     ENDIF                                                              CSW025
     C/COPY WNCPYSRC,DLH00439
     C                     WRITEMGF330D0               40
     C/COPY WNCPYSRC,DL6305C031
      *
     C           *IN40     IFEQ '1'
     C           *LOCK     IN   LDA
     C                     MOVE '007'     DBASE            * * * * * * * *
     C                     MOVEL@TYP      DBKEY            * DB ERROR 07 *
     C                     MOVEL'MGF330PD'DBFILE           * * * * * * * *
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END
      *
     C                     ENDSR
      *****************************************************************
     C/EJECT
      *****************************************************************
      *   F321 - FORMAT MESSAGE SPECIFIC FIELDS FOR MT321             *
      *   Called by - VALD                                            *
      *****************************************************************
      *
     C           F321      BEGSR
      *
      **  Format fields for MT321
      *
     C                     Z-ADDYRAT      MGYRAT
     C                     Z-ADDINTR      MGINTR
     C                     Z-ADDNIDT      MGNIDT
     C                     MOVE ICBS      MGICBS
      **  Negotiable assets purchased
      *
     C           DRCDT     IFEQ 'D'
     C/COPY WNCPYSRC,DL6305C060
     C                     Z-ADDPUPR      MGCAMT
     C/COPY WNCPYSRC,DL6305C061
     C                     MOVE 'P'       MGPORS
     C/COPY WNCPYSRC,DL6305C009
     C                     MOVELAWBN      MGAWBN
     C                     MOVELAWBA      MGAWBA
     C********** WWAWBA    IFEQ 'DIRECT'                            087195132679
     C********** WWAWBB    ANDEQ*BLANKS                             087195132679
     C**********           MOVEL'/DIRECT' MGAWBA    P               087195132679
     C**********           END                                      087195132679
     C/COPY WNCPYSRC,DL6305C010
     C                     MOVELRVNO      MGRVNO
     C                     MOVELPONS      MGPONS
     C/COPY WNCPYSRC,DL6305C062
     C                     Z-ADDTOTI      MGTOTI
     C/COPY WNCPYSRC,DL6305C063
     C                     ELSE
      *
      **  Negotiable assets sold
     C/COPY WNCPYSRC,DL6305C064
      *
     C                     Z-ADDSAPR      MGCAMT
     C/COPY WNCPYSRC,DL6305C065
     C                     MOVEL'S'       MGPORS
     C                     MOVELRONS      MGRONS
      *
      **  Chain to purchase side of deal for maturity date and
      **  total interest
      *
     C           RPDN      CHAINDEALS                20
      *
     C           *IN20     IFEQ '1'
     C           DRECI     ORNE 'D'
     C           DRECI     ANDNE'R'
     C           *LOCK     IN   LDA
     C                     MOVE '008'     DBASE            * * * * * * * *
     C                     MOVELRPDN      DBKEY            * DB ERROR 08 *
     C                     MOVEL'DEALS'   DBFILE           * * * * * * * *
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     ELSE
      *
     C                     Z-ADDMDAT      MGMDAT
     C/COPY WNCPYSRC,DL6305C066
     C                     Z-ADDTOTI      MGTOTI
     C/COPY WNCPYSRC,DL6305C067
     C                     Z-ADDNIDT      MGNIDT
     C                     MOVE ICBS      MGICBS
     C                     END
      *
      *  Restore sale side for later update of sequence numbers
      *
     C           CDLNO     CHAINDEALS                21
      *
     C           *IN21     IFEQ '1'
     C           DRECI     ORNE 'D'
     C           DRECI     ANDNE'R'
     C           *LOCK     IN   LDA
     C                     MOVE '009'     DBASE            * * * * * * * *
     C                     MOVELCDLNO     DBKEY            * DB ERROR 09 *
     C                     MOVEL'DEALS'   DBFILE           * * * * * * * *
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END
     C                     END
      *
      ** Move settlement currencies.                                      137909
     C           CEU003    IFEQ 'Y'                                       137909
     C                     EXSR STCY2                                     137909
     C                     ENDIF                                          137909
      *                                                                   137909
     C           MGCHTP    IFEQ *BLANK                                                        CSW025
     C                     MOVE @CHG      MGCHTP                                              CSW025
     C                     ENDIF                                                              CSW025
     C                     WRITEMGF321D0               40
      *
     C           *IN40     IFEQ '1'
     C           *LOCK     IN   LDA
     C                     MOVE '010'     DBASE            * * * * * * * *
     C                     MOVEL@TYP      DBKEY            * DB ERROR 10 *
     C                     MOVEL'MGF321PD'DBFILE           * * * * * * * *
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END
      *
     C                     ENDSR
      *****************************************************************
     C/EJECT                                                              CSW005
      *****************************************************************   CSW005
      *   COMFRA - Format common fields for FRA/IRS                   *   CSW005
      *   Called by - VALD generate message for destination customer  *   CSW005
      *****************************************************************   CSW005
      *                                                                   CSW005
     C           COMFRA    BEGSR                                          CSW005
      *                                                                   CSW005
      **  Pay - Our Nostro                                                CSW005
     C                     MOVELPONS      MGPONS                          CSW005
      *                                                                   CSW005
      **  Receiver Number                                                 CSW005
     C                     MOVELRVNO      MGRVNO                          CSW005
      *                                                                   CSW005
      **  Pay - Intermediary Bank and account line                        CSW005
     C                     MOVELPIBN      MGPIBN                          CSW005
     C                     MOVELPIBA      MGPIBA                          CSW005
      *                                                                   CSW005
      **  Account with Bank and account line                              CSW005
     C                     MOVELAWBN      MGAWBN                          CSW005
     C                     MOVELAWBA      MGAWBA                          CSW005
     C********** WWAWBA    IFEQ 'DIRECT'                            CSW005132679
     C********** WWAWBB    ANDEQ*BLANKS                             CSW005132679
     C**********           MOVEL'/DIRECT' MGAWBA    P               CSW005132679
     C**********           END                                      CSW005132679
      *                                                                   CSW005
      **  Receive - Our Nostro                                            CSW005
     C                     MOVELRONS      MGRONS                          CSW005
      *                                                                   CSW005
      **  Receive - Intermediary Bank and account line                    CSW005
     C                     MOVELRIBN      MGRIBN                          CSW005
     C                     MOVELRIBA      MGRIBA                          CSW005
      *                                                                   CSW005
      **  Beneficiary Number                                              CSW005
     C                     MOVELBENN      MGBENN                          CSW005
     C                     MOVELBENA      MGBENA                          CSW005
      *                                                                   CSW005
     C                     ENDSR                                          CSW005
      *****************************************************************   CSW005
     C/EJECT                                                              CSW005
      *****************************************************************   CSW005
      *   F340 - Format Message Specific fields for MT340             *   CSW005
      *   Called by - VALD                                            *   CSW005
      *   Calls - SRU340                                              *   CSW200
      *****************************************************************   CSW005
      *                                                                   CSW005
     C           F340      BEGSR                                          CSW005
      *                                                                   CSW005
      **  Format Related reference                                        CSW005
      *                                                                   CSW005
     C           @RTNC     IFEQ 'C'                                       CSW005
     C                     MOVELPTRAN     MGRREF                          CSW005
     C                     ELSE                                           CSW005
     C                     MOVEL*BLANKS   MGRREF                          CSW005
     C                     ENDIF                                          CSW005
      *                                                                   CSW005
      **  Transaction Date                                                CSW005
     C********** CHTP      IFEQ 'I'                                                    CSW005 229061
     C                     Z-ADDDDAT      MGTDAT                          CSW005
     C**********           ELSE                                                        CSW005 229061
     C**********           Z-ADDLCD       MGTDAT                                       CSW005 229061
     C**********           ENDIF                                                       CSW005 229061
      *                                                                   CSW005
      **  Fixing Date                                                     CSW005
      *                                                                   CSW005
      *                                                                   CSW005
     C           BYSL      IFEQ 'S'                                       CSW005
     C                     Z-ADDUFRFD     ZRFDY                           CSW005
     C                     ELSE                                           CSW005
     C                     Z-ADDTFRFD     ZRFDY                           CSW005
     C                     ENDIF                                          CSW005
      *                                                                   CSW005
      **    If 'currency for rate fix holiday' flag from FRA/IRS I.C.D.   CSW005
      **    is 'F', 'L' or 'D', set currency code to 'sterling code',     CSW005
      **    'local currency code' or 'screen currency code' respectively  CSW005
      *                                                                   CSW005
     C                     SELEC                                          CSW005
     C           BQCRFH    WHEQ 'F'                                       CSW005
     C                     MOVE BLCYCD    ZCCY                            CSW005
     C           BQCRFH    WHEQ 'L'                                       CSW005
     C                     MOVE BJLCCY    ZCCY                            CSW005
     C           BQCRFH    WHEQ 'D'                                       CSW005
     C           BQCRFH    OREQ ' '                                       CSW005
     C                     MOVE UCUCY     ZCCY                            CSW005
     C                     ENDSL                                          CSW005
     C*                                                                   CSW005
     C**     Initialise Work Field                                        CSW005
     C                     Z-ADD0         WFDAT   50                      CSW005
     C                     MOVE *BLANKS   ZLOC                            CSW005
     C                     Z-ADDZRFDY     ZRFDY   50                      CSW005
     C                     MOVE ZCCY      ZCCY    3                       CSW005
     C                     Z-ADD0         ZWKFLD  50                      CSW005
     C                     MOVE '0'       *IN99                           CSW005
     C*                                                                   CSW005
     C**     Set Rate Fix Date equal to Deal Value Date                   CSW005
     C                     Z-ADDDVDAT     WFDAT                           CSW005
      *                                                                   CIR005
      ** Get rate fixing date                                             CIR005
      *                                                                   CIR005
     C           CIR005    IFEQ 'Y'                                       CIR005
     C           L1CYR1    ANDNE*BLANKS                                   CIR005
     C                     MOVEL'IRRTFX'  WCALL   9                       CIR005
     C                     MOVE 'CNV'     WCALL                           CIR005
     C                     CALL WCALL                                     CIR005
     C                     PARM WFDAT     PFDAT   50                      CIR005
     C                     PARM ZRFDY     PRFDY   20                      CIR005
     C                     PARM ZLOC      PLOCN   3                       CIR005
     C                     PARM WCCYD1    PCURR  30                       CIR005
     C                     PARM *ZEROS    PFXDT   50                      CIR005
      *                                                                   CIR005
     C                     Z-ADDPFXDT     WFDAT                           CIR005
      *                                                                   CIR005
     C                     ELSE                                           CIR005
     C*                                                                   CSW005
     C**     Perform the following processing until the work field is     CSW005
     C**     greater than or equal to the Rate Fix Days                   CSW005
     C           ZWKFLD    DOUGEZRFDY                                     CSW005
     C*                                                                   CSW005
     C**     If the Rate Fix Days are not equal to zero subtract 1        CSW005
     C**     from the Rate Fix Date                                       CSW005
     C           ZRFDY     IFNE 0                                         CSW005
     C                     SUB  1         WFDAT                           CSW005
     C                     END                                            CSW005
      *                                                                   CSW005
      **     The following is repeated until the resultant date is        CSW005
      **         proved to be a working day in the relevant currency      CSW005
      **         and the relevent location.                               CSW005
      **     ZCHKH checks the Rate Fix Date for a holiday.                CSW005
      *                                                                   CSW005
     C           ZIND      DOUEQ'W'                                       CSW005
     C                     Z-ADDWFDAT     ZDAYNO                          CSW005
     C                     EXSR ZCHKH                                     CSW005
      *                                                                   CSW005
      **     If the date is a holiday, subtract 1 from the Rate Fix Date  CSW005
     C           ZIND      IFEQ 'H'                                       CSW005
     C                     SUB  1         WFDAT                           CSW005
     C                     END                                            CSW005
     C                     ENDDO                                          CSW005
     C*                                                                   CSW005
     C**     When a working day has been found, add 1 to the Work Field   CSW005
     C                     ADD  1         ZWKFLD                          CSW005
     C                     ENDDO                                          CSW005
      *                                                                   CSW005
     C                     ENDIF                                          CIR005
     C                     Z-ADDWFDAT     MGFDAT                          CSW005
      *                                                                   CSW005
      **  Pay/Receive Indicator and Interest Rate                         CSW005
     C           BYSL      IFEQ 'S'                                       CSW005
     C                     MOVE 'P'       MGPORR                          CSW005
     C                     Z-ADDTRTSP     MGINTR                          CSW005
     C                     ELSE                                           CSW005
     C                     MOVE 'R'       MGPORR                          CSW005
     C                     Z-ADDURTSP     MGINTR                          CSW005
     C                     ENDIF                                          CSW005
      *                                                                   CSW005
      **  Settlement Date                                                 CSW005
     C                     Z-ADDDVDAT     MGSDAT                          CSW005
      *                                                                   CSW005
      **  Currency                                                        CSW005
     C                     MOVE UCUCY     MGCCY                           CSW005
      *                                                                   CSW005
      **  Notional Amount                                                 CSW005
     C                     Z-ADDUPAMT     MGNOAM                          CSW005
      *                                                                   CSW005
      **  Contract Period                                                 CSW005
     C           MDAT      SUB  DVDAT     MGCPER                          CSW005
      *                                                                   CSW005
      **  Condition Lines                                                 CSW005
     C                     MOVELCND1      MGCON1                          CSW005
     C                     MOVELCND2      MGCON2                          CSW005
     C                     MOVELCND3      MGCON3                          CSW005
     C                     MOVELCND4      MGCON4                          CSW005
     C                     MOVELCND5      MGCON5                          CSW005
     C                     MOVELCND6      MGCON6                          CSW005
      *                                                                   CSW005
      **  Sender-to-Receiver Information Lines                            CSW005
     C                     MOVELDSR1      MGS2R1                          CSW005
     C                     MOVELDSR2      MGS2R2                          CSW005
     C                     MOVELDSR3      MGS2R3                          CSW005
     C                     MOVELDSR4      MGS2R4                          CSW005
     C                     MOVELDSR5      MGS2R5                          CSW005
     C                     MOVELDSR6      MGS2R6                          CSW005
      *                                                                   CSW005
     C           CEU003    IFEQ 'Y'                                       137909
     C                     EXSR STCY3                                     137909
     C                     ENDIF                                          137909
      *                                                                   137909
      *                                                                   CSW200
      * Swift 2000 Changes                                                CSW200
      *                                                                   CSW200
     C           CSW200    IFEQ 'Y'                                       CSW200
     C                     ADD  1         MGSEQN                          CSW200
      *                                                                   CSW200
      * If ISDA fields are blank, default from FRA ICD or                 CSW200
      * extended settlements                                              CSW200
      *                                                                   CSW200
     C           ISDA      IFEQ *ZEROS                                    CSW200
     C           AGTY      ANDEQ*BLANKS                                   CSW200
     C           AGDT      ANDEQ*ZEROS                                    CSW200
     C           AGVV      ANDEQ*ZEROS                                    CSW200
     C           AGVC      ANDEQ*ZEROS                                    CSW200
      *                                                                   CSW200
     C                     EXSR ISDAD                                     CSW200
      *                                                                   CSW200
     C                     ELSE                                           CSW200
      *                                                                   CSW200
     C                     MOVELISDA      MGISDA                          CSW200
     C                     MOVELAGTY      MGAGTY                          CSW200
     C                     MOVE AGDT      ZAGDT                           CSW200
     C                     EXSR SRAGDT                                    CSW200
     C                     MOVEL@@VDT     MGAGDT                          CSW200
     C                     MOVEL*BLANKS   ZZ0004                          CSW200
     C                     MOVELAGVC      ZZ0004                          CSW200
     C                     MOVE AGVV      ZZ0004                          CSW200
     C                     MOVELZZ0004    MGAGVV                          CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
      * Buy - use their details                                           CSW200
      *                                                                   CSW200
     C           BYSL      IFEQ 'B'                                       CSW200
      *                                                                   CSW200
     C                     SELEC                                          CSW200
      **                                                                                    BUG11282
     C           TICBS     WHEQ 0                                                           BUG11282
     C                     SELEC                                                            BUG11282
     C           DSETF     WHEQ 'A'                                                         BUG11282
     C                     MOVELTX#,9     MGCALC                                            BUG11282
     C           DSETF     WHEQ 'U'                                                         BUG11282
     C                     MOVELTX#,7     MGCALC                                            BUG11282
     C                     ENDSL                                                            BUG11282
      **                                                                                    BUG11282
     C           TICBS     WHEQ 1                                         CSW200
     C                     MOVELTX#,6     MGCALC                          CSW200
     C           TICBS     WHEQ 2                                         CSW200
     C                     MOVELTX#,7     MGCALC                          CSW200
     C           TICBS     WHEQ 3                                         CSW200
     C                     MOVELTX#,8     MGCALC                          CSW200
     C           TICBS     WHEQ 7                                         CSW200
     C           CIR004    ANDEQ'Y'                                       CSW200
     C                     MOVELTX#,8     MGCALC                          CSW200
     C           TICBS     WHEQ 4                                         CSW200
     C           TICBS     OREQ 5                                         CSW200
     C           TICBS     OREQ 9                                         CIR013
     C                     MOVELTICBS     MGCALC                          CSW200
     C           TICBS     WHEQ 6                                         CSW200
     C                     MOVELTX#,9     MGCALC                          CSW200
     C                     ENDSL                                          CSW200
      *                                                                   CSW200
     C********** TBRTT     IFNE *ZEROS                                    CSW200              CSD103
     C           TBRTT     IFNE *BLANKS                                                       CSD103
     C                     MOVE *BLANKS   @KEY2                           CSW200
     C                     MOVE TBRTT     @KEY2                           CSW200
      *                                                                   CSW200
     C                     CALL 'AOBSRTR0'                                CSW200
     C                     PARM '*MSG   ' @RTCD                           CSW200
     C                     PARM '*KEY   ' @OPTN                           CSW200
     C                     PARM TCUCY     @KEY3                           CSW200
     C                     PARM           @KEY2                           CSW200
     C           SDBSRT    PARM SDBSRT    DSSDY                           CSW200
      *                                                                   CSW200
     C                     MOVELBASCDD    MGFLOR                          CSW200
     C                     MOVELBADGMA    MGDSMT                          CSW200
     C                     MOVELBAOMD1    MGODM1                          CSW200
     C                     MOVELBAOMD2    MGODM2                          CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
      * Sell - use our details                                            CSW200
      *                                                                   CSW200
     C                     ELSE                                           CSW200
      *                                                                   CSW200
     C                     SELEC                                          CSW200
      **                                                                                    BUG11282
     C           UICBS     WHEQ 0                                                           BUG11282
     C                     SELEC                                                            BUG11282
     C           DSETF     WHEQ 'A'                                                         BUG11282
     C                     MOVELTX#,9     MGCALC                                            BUG11282
     C           DSETF     WHEQ 'U'                                                         BUG11282
     C                     MOVELTX#,7     MGCALC                                            BUG11282
     C                     ENDSL                                                            BUG11282
      **                                                                                    BUG11282
     C           UICBS     WHEQ 1                                         CSW200
     C                     MOVELTX#,6     MGCALC                          CSW200
     C           UICBS     WHEQ 2                                         CSW200
     C                     MOVELTX#,7     MGCALC                          CSW200
     C           UICBS     WHEQ 3                                         CSW200
     C                     MOVELTX#,8     MGCALC                          CSW200
     C           UICBS     WHEQ 7                                         CSW200
     C           CIR004    ANDEQ'Y'                                       CSW200
     C                     MOVELTX#,8     MGCALC                          CSW200
     C           UICBS     WHEQ 4                                         CSW200
     C           UICBS     OREQ 5                                         CSW200
     C           UICBS     OREQ 9                                         CIR013
     C                     MOVELUICBS     MGCALC                          CSW200
     C           UICBS     WHEQ 6                                         CSW200
     C                     MOVELTX#,9     MGCALC                          CSW200
     C                     ENDSL                                          CSW200
      *                                                                   CSW200
     C********** UBRTT     IFNE *ZEROS                                    CSW200              CSD103
     C           UBRTT     IFNE *BLANKS                                                       CSD103
     C                     MOVE *BLANKS   @KEY2                           CSW200
     C                     MOVE UBRTT     @KEY2                           CSW200
      *                                                                   CSW200
     C                     CALL 'AOBSRTR0'                                CSW200
     C                     PARM '*MSG   ' @RTCD                           CSW200
     C                     PARM '*KEY   ' @OPTN                           CSW200
     C                     PARM UCUCY     @KEY3                           CSW200
     C                     PARM           @KEY2                           CSW200
     C           SDBSRT    PARM SDBSRT    DSSDY                           CSW200
      *                                                                   CSW200
     C                     MOVELBASCDD    MGFLOR                          CSW200
     C                     MOVELBADGMA    MGDSMT                          CSW200
     C                     MOVELBAOMD1    MGODM1                          CSW200
     C                     MOVELBAOMD2    MGODM2                          CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
     C           WACOC     IFNE *BLANKS                                   CSW200
      *                                                                   CSW200
     C                     MOVE *BLANKS   WDPNM                           CSW200
      **  Access Account Officer Details                                  CSW200
     C                     CALL 'AOACOFR0'                                CSW200
     C                     PARM *BLANKS   @RTCD                           CSW200
     C                     PARM '*KEY   ' @OPTN                           CSW200
     C                     PARM WACOC     @KEY2   2                       CSW200
     C           SDACOF    PARM SDACOF    DSSDY                           CSW200
      *                                                                   CSW200
     C           @RTCD     IFNE *BLANKS                                   CSW200
     C           *LOCK     IN   LDA                                       CSW200
     C                     MOVE '044'     DBASE            * * * * * * * *CSW200
     C                     MOVELWACOC     DBKEY            * DB ERROR 44 *CSW200
     C                     MOVEL'SDACOFPD'DBFILE           * * * * * * * *CSW200
     C                     OUT  LDA                                       CSW200
     C                     EXSR *PSSR                                     CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
     C           @RTCD     IFEQ *BLANKS                                   CSW200
      *                                                                   CSW200
     C           AZDPCD    IFNE *BLANKS                                   CSW200
     C                     CALL 'AODEPTR0'                                CSW200
     C                     PARM *BLANKS   @RTCD                           CSW200
     C                     PARM '*KEY   ' @OPTN                           CSW200
     C                     PARM           AZDPCD                          CSW200
     C           SDDEPT    PARM SDDEPT    DSFDY                           CSW200
     C           @RTCD     IFNE *BLANKS                                   CSW200
     C           *LOCK     IN   LDA                                       CSW200
     C                     MOVE '045'     DBASE            * * * * * * * *CSW200
     C                     MOVELAZDPCD    DBKEY            * DB ERROR 45 *CSW200
     C                     MOVEL'SDDEPTPD'DBFILE           * * * * * * * *CSW200
     C                     OUT  LDA                                       CSW200
     C                     EXSR *PSSR                                     CSW200
     C                     ENDIF                                          CSW200
     C                     MOVELAEDPNM    WDPNM                           CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
     C           '/NAME/'  CAT  AZACON:0  MGCTC1                          CSW200
     C                     MOVE *BLANKS   WRK35  35                       CSW200
     C           AZAPHN    IFNE *BLANKS                                   CSW200
     C           '/PHON/'  CAT  AZAPHN:0  WRK35                           CSW200
     C                     ENDIF                                          CSW200
     C           AZAEXT    IFNE *BLANKS                                   CSW200
     C                     CAT  'EXT':1   WRK35                           CSW200
     C                     CAT  AZAEXT:1  WRK35                           CSW200
     C                     ENDIF                                          CSW200
     C           WDPNM     IFNE *BLANKS                                   CSW200
     C           '/DEPT/'  CAT  WDPNM     MGCTC2                          CSW200
     C                     MOVELWRK35     MGCTC3                          CSW200
     C                     ELSE                                           CSW200
     C                     MOVELWRK35     MGCTC2                          CSW200
     C                     ENDIF                                          CSW200
     C                     ENDIF                                          CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
      * Format FRA Finanancial Centre Details                             CSW200
      *                                                                   CSW200
     C                     EXSR SRU340                                    CSW200
      *                                                                   CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
      **  Write record                                                    CSW005
     C           MGCHTP    IFEQ *BLANK                                                        CSW025
     C                     MOVE @CHG      MGCHTP                                              CSW025
     C                     ENDIF                                                              CSW025
      *                                                                                       CSW213
     C                     EXSR SRREPI                                                        CSW213
      *                                                                                       CSW213
     C                     WRITEMGF340D0                                  CSW005
      *                                                                   CSW005
     C                     ENDSR                                          CSW005
      *****************************************************************   CSW005
     C/EJECT                                                              CSW005
      *****************************************************************   CSW200
      *   SRU340 - Format FRA Financial Centre Details                *   CSW200
      *   Called by - F340                                            *   CSW200
      *   Calls - SRUISF, SRUNST                                      *   CSW200
      *****************************************************************   CSW200
      *                                                                   CSW200
     C           SRU340    BEGSR                                          CSW200
      *                                                                   CSW200
      * If FRA/IRS Business Day Conventions is on                         CSW200
      *                                                                   CSW200
     C                     Z-ADD0         COUNT   10                      CSW200
     C           CIR005    IFEQ 'Y'                                       CSW200
     C                     MOVE L1CYR1    W#CYCD                          CSW200
     C                     EXSR SRUISF                                    CSW200
     C                     MOVE L1CYR2    W#CYCD                          CSW200
     C                     EXSR SRUISF                                    CSW200
     C                     MOVE L1CYR3    W#CYCD                          CSW200
     C                     EXSR SRUISF                                    CSW200
     C                     MOVE L1CYR4    W#CYCD                          CSW200
     C                     EXSR SRUISF                                    CSW200
     C                     MOVE L1CYR5    W#CYCD                          CSW200
     C                     EXSR SRUISF                                    CSW200
     C                     MOVE L1CYR6    W#CYCD                          CSW200
     C                     EXSR SRUISF                                    CSW200
     C                     MOVE L1CYR7    W#CYCD                          CSW200
     C                     EXSR SRUISF                                    CSW200
     C                     MOVE L1CYR8    W#CYCD                          CSW200
     C                     EXSR SRUISF                                    CSW200
     C                     MOVE L1CYR9    W#CYCD                          CSW200
     C                     EXSR SRUISF                                    CSW200
     C                     MOVE L1CYR0    W#CYCD                          CSW200
     C                     EXSR SRUISF                                    CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
      * If FRA/IRS Business Day Conventions is off                        CSW200
      *                                                                   CSW200
     C           CIR005    IFEQ 'N'                                       CSW200
     C           CIR005    OREQ 'Y'                                       CSW200
     C           COUNT     ANDEQ0                                         CSW200
      *                                                                   CSW200
      * Currency for Rate Fix Holiday is Sterling                         CSW200
      *                                                                   CSW200
     C           BQCRFH    IFEQ 'F'                                       CSW200
     C                     MOVELBLCYCD    W#CYCD                          CSW200
     C                     EXSR SRUISF                                    CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
      * Currency for Rate Fix Holiday is Local Currency                   CSW200
      *                                                                   CSW200
     C           BQCRFH    IFEQ 'L'                                       CSW200
     C                     MOVELBJLCCY    W#CYCD                          CSW200
     C                     EXSR SRUISF                                    CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
      * Currency for Rate Fix Holiday is Deal Currency                    CSW200
      *                                                                   CSW200
     C           BQCRFH    IFEQ 'D'                                       CSW200
      *                                                                   CSW200
     C           PSCY      IFNE *BLANKS                                   CSW200
     C                     MOVELPSCY      W#CYCD                          CSW200
      *                                                                   CSW200
     C                     ELSE                                           CSW200
     C                     MOVELUCUCY     W#CYCD                          CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
      * Set up receive or pay details                                     CSW200
      *                                                                   CSW200
     C           BYSL      IFEQ 'B'                                       CSW200
     C                     MOVELPSTM      W#SETM                          CSW200
     C                     MOVELPONS      W#NOSN                          CSW200
      *                                                                   CSW200
     C                     ELSE                                           CSW200
     C                     MOVELRSTM      W#SETM                          CSW200
     C                     MOVELRONS      W#NOSN                          CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
      * Retrieve Nostro                                                   CSW200
     C                     EXSR SRUNST                                    CSW200
      *                                                                   CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
     C                     ENDSR                                          CSW200
      *****************************************************************   CSW200
     C/EJECT                                                              CSW200
      *****************************************************************   CSW200
      *   SRUISF - Retrieve ISDA Financial Centre                     *   CSW200
      *   Called by -  SRU340                                         *   CSW200
      *   Calls - None                                                *   CSW200
      *****************************************************************   CSW200
      *                                                                   CSW200
     C           SRUISF    BEGSR                                          CSW200
      *                                                                   CSW200
     C           W#CYCD    IFNE *BLANKS                                   193704
     C                     EXSR SRUCCY                                    CSW200
     C                     EXSR SRULOC                                    CSW200
      *                                                                   CSW200
     C           W#ISFC    IFNE *BLANKS                                   CSW200
     C                     MOVELW#ISFC    MGISFC                          CSW200
     C                     MOVELW#NLCD    MGLOCN                          CSW200
      *                                                                   CSW200
     C                     WRITEMGU340D0                                  CSW200
      *                                                                   CSW200
     C                     ADD  1         COUNT                           CSW200
     C                     ENDIF                                          CSW200
     C                     ENDIF                                          193704
      *                                                                   CSW200
     C                     ENDSR                                          CSW200
      *****************************************************************   CSW200
     C/EJECT                                                              CSW200
      *****************************************************************   CSW200
      *   SRUCCY - Retrieve Currency                                  *   CSW200
      *   Called by -  RU340                                          *   CSW200
      *   Calls - None                                                *   CSW200
      *****************************************************************   CSW200
      *                                                                   CSW200
     C           SRUCCY    BEGSR                                          CSW200
      *                                                                   CSW200
     C                     CALL 'AOCURRR0'                                CSW200
     C                     PARM '*MSG   ' @RTCD                           CSW200
     C                     PARM '*KEY   ' @OPTN                           CSW200
     C                     PARM W#CYCD    @KEY3                           CSW200
     C           SDCURR    PARM SDCURR    DSSDY                           CSW200
      *                                                                   CSW200
      * Store Location Code                                               CSW200
      *                                                                   CSW200
     C                     MOVELA6DLOC    W#NLCD                          CSW200
      *                                                                   CSW200
     C                     ENDSR                                          CSW200
      *****************************************************************   CSW200
     C/EJECT                                                              CSW200
      *****************************************************************   CSW200
      *   SRULOC - Retrieve Location                                  *   CSW200
      *   Called by - SRU340                                          *   CSW200
      *   Calls - None                                                *   CSW200
      *****************************************************************   CSW200
      *                                                                   CSW200
     C           SRULOC    BEGSR                                          CSW200
      *                                                                   CSW200
     C                     CALL 'AOLOCNR0'                                CSW200
     C                     PARM           P@RTCD                          CSW200
     C                     PARM '*KEY    'P@OPTN                          CSW200
     C                     PARM W#NLCD    P@LCCD                          CSW200
     C           SDLOCN    PARM SDLOCN    DSFDY                           CSW200
      *                                                                   CSW200
      * Store ISDA Finanical Centre                                       CSW200
      *                                                                   CSW200
     C                     MOVELDVISFC    W#ISFC                          CSW200
      *                                                                   CSW200
     C                     ENDSR                                          CSW200
      *****************************************************************   CSW200
     C/EJECT                                                              CSW200
      *****************************************************************   CSW200
      *   SRUNST - Retrieve Nostro                                    *   CSW200
      *   Called by - SRU340                                          *   CSW200
      *   Calls - None                                                *   CSW200
      *****************************************************************   CSW200
      *                                                                   CSW200
     C           SRUNST    BEGSR                                          CSW200
      *                                                                   CSW200
      * For a Nostro Settlement                                           CSW200
      *                                                                   CSW200
     C           W#SETM    IFEQ '01'                                      CSW200
     C           W#SETM    OREQ '07'                                      CSW200
     C           W#SETM    OREQ '08'                                      CSW200
      *                                                                   CSW200
     C                     CALL 'AONOSTR0'                                CSW200
     C                     PARM '*MSG   ' @RTCD                           CSW200
     C                     PARM '*KEY   ' @OPTN                           CSW200
     C                     PARM *BLANKS   P@CUST                          CSW200
     C                     PARM W#CYCD    P@CYCD                          CSW200
     C                     PARM *BLANKS   P@ACCD                          CSW200
     C                     PARM *BLANKS   P@ACSN                          CSW200
     C                     PARM W#NOSN    P@NONB                          CSW200
     C                     PARM *BLANKS   P@BRCD                          CSW200
     C                     PARM *BLANKS   P@CSSN                          CSW200
     C                     PARM *BLANKS   P@PNOI                          CSW200
     C           SDNOST    PARM SDNOST    DSFDY                           CSW200
      *                                                                   CSW200
     C                     MOVE A7NOSN    W#NLCD                          CSW200
      *                                                                   CSW200
     C           W#NLCD    IFEQ *BLANKS                                   CSW200
     C                     EXSR SRUCCY                                    CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
      * Not Nostro Settlement                                             CSW200
      *                                                                   CSW200
     C                     ELSE                                           CSW200
      *                                                                   CSW200
      * Settlement by Cheque                                              CSW200
      *                                                                   CSW200
     C           W#SETM    IFEQ '00'                                      CSW200
     C           W#SETM    OREQ '02'                                      CSW200
     C           W#SETM    OREQ '06'                                      CSW200
     C           W#SETM    OREQ '12'                                      CSW200
     C                     EXSR SRUCCY                                    CSW200
      *                                                                   CSW200
      * Other Settlements                                                 CSW200
      *                                                                   CSW200
     C                     ELSE                                           CSW200
     C                     MOVE BJSLCD    W#NLCD                          CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
     C                     EXSR SRULOC                                    CSW200
      *                                                                   CSW200
      * If ISDA Financial Centre is set up on Location Codes File         CSW200
      *                                                                   CSW200
     C           W#ISFC    IFNE *BLANKS                                   CSW200
     C                     MOVE W#ISFC    MGISFC                          CSW200
     C                     MOVE W#NLCD    MGLOCN                          CSW200
      *                                                                   CSW200
     C                     WRITEMGU340D0                                  CSW200
      *                                                                   CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
     C                     ENDSR                                          CSW200
      *****************************************************************   CSW200
     C/EJECT                                                              CSW200
      *****************************************************************   CSW097
      *   F360FR - Format Message Specific fields for MT360 - "FR"    *   CSW097
      *   Called by - VALD                                            *   CSW097
      *   Calls - SRY36N, SRU36N, SRX36N                              *   CSW097
      *****************************************************************   CSW097
      *                                                                   CSW097
     C           F360FR    BEGSR                                          CSW097
      *                                                                   CSW097
      **  Sequence Number                                                 CSW097
     C                     ADD  1         MGSEQN                          CSW097
      *                                                                   CSW097
      **  Related Reference                                               CSW097
      *                                                                   CSW097
     C           @RTNC     IFEQ 'C'                                       CSW097
     C                     MOVELPTRAN     MGRREF                          CSW097
     C                     ELSE                                           CSW097
     C                     MOVEL*BLANKS   MGRREF                          CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
      **  Further Identification                                          CSW097
      *                                                                   CSW097
     C           BYSL      IFEQ 'B'                                       CSW097
     C                     MOVEL@BUY      MGFUID                          CSW097
     C                     ELSE                                           CSW097
     C           BYSL      IFEQ 'S'                                       CSW097
     C                     MOVEL@SEL      MGFUID                          CSW097
     C                     ENDIF                                          CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
      **  Effective Date of Assignment                                    CSW097
     C                     Z-ADDDVDAT     MGADAT                          CSW097
      *                                                                   CSW097
      **  Business Day Convention                                         CSW097
     C           CIR005    IFEQ 'Y'                                       CIR005
     C                     SELEC                                          CIR005
     C           L1PDCN    WHEQ 'F'                                       CIR005
     C                     MOVEL@BDAC     MGBDAC                          CIR005
     C           L1PDCN    WHEQ 'P'                                       CIR005
     C                     MOVELWBDCP     MGBDAC                          CIR005
     C           L1PDCN    WHEQ 'MF'                                      CIR005
     C                     MOVELWBDCM     MGBDAC                          CIR005
     C                     OTHER                                          CIR005
     C                     MOVELWBDCO     MGBDAC                          CIR005
     C                     ENDSL                                          CIR005
     C                     ELSE                                           CIR005
     C                     MOVEL@BDAC     MGBDAC                          CSW097
     C                     ENDIF                                          CIR005
      *                                                                   CSW097
      **  Currency                                                        CSW097
     C                     MOVE UCUCY     MGCCY                           CSW097
      *                                                                   CSW097
      **  If ISDA fields are zeros or blanks, this must be a deal         CSW097
      **  entered before CSW005 was on and has not been updated with      CSW097
      **  these essential details for MT360, so try to default.           CSW097
      *                                                                   CSW097
     C           ISDA      IFEQ *ZEROS                                    CSW097
     C           AGTY      ANDEQ*BLANK                                    CSW097
     C           AGDT      ANDEQ*ZEROS                                    CSW097
     C           AGVV      ANDEQ*ZEROS                                    CSW097
     C           AGVC      ANDEQ*ZEROS                                    CSW097
     C                     EXSR ISDAD                                     CSW097
     C                     ELSE                                           CSW097
      *                                                                   CSW097
      **  ISDA rules version                                              CSW097
     C                     Z-ADDISDA      MGISDA                          CSW097
      *                                                                   CSW097
      **  Type of ISDA Agreement                                          CSW097
     C                     MOVELAGTY      MGAGTY                          CSW097
      *                                                                   CSW097
      **  Date of ISDA Agreement                                          CSW097
     C                     MOVE AGDT      ZAGDT   6                       CSW097
     C                     EXSR SRAGDT                                    CSW097
     C                     Z-ADD@@VDT     MGAGDT                          CSW097
      *                                                                   CSW097
      **  Version of ISDA Agreement                                       CSW097
     C                     MOVE AGVV      ZZ0004  4                       CSW097
     C                     MOVELAGVC      ZZ0004                          CSW097
     C                     MOVE ZZ0004    MGAGVV                          CSW097
      *                                                                   CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
      **  Notional Amount                                                 CSW097
     C                     Z-ADDUPAMT     MGNOTA                          CSW097
      *                                                                   CSW097
      **  Condition lines                                                 CSW097
     C                     MOVELCND1      MGCON1                          CSW097
     C                     MOVELCND2      MGCON2                          CSW097
     C                     MOVELCND3      MGCON3                          CSW097
     C                     MOVELCND4      MGCON4                          CSW097
     C                     MOVELCND5      MGCON5                          CSW097
     C                     MOVELCND6      MGCON6                          CSW097
      *                                                                   CSW097
      **  Sender-to-Receiver Information lines                            CSW097
     C                     MOVELDSR1      MGS2R1                          CSW097
     C                     MOVELDSR2      MGS2R2                          CSW097
     C                     MOVELDSR3      MGS2R3                          CSW097
     C                     MOVELDSR4      MGS2R4                          CSW097
     C                     MOVELDSR5      MGS2R5                          CSW097
     C                     MOVELDSR6      MGS2R6                          CSW097
      *                                                                   CSW097
      **  Collateral Agreement Indicator                                  CSW097
     C                     MOVELCAIN      MGCAIN                          CSW097
      *                                                                   CSW097
      **  Their Fixed Rate                                                CSW097
     C           BYSL      IFEQ 'S'                                       CSW097
     C                     Z-ADDTEINR     MGBFXR                          CSW097
     C                     ELSE                                           CSW097
     C                     Z-ADD*ZERO     MGBFXR                          CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
      **  Their interest calculation method narrative.                    CSW097
     C                     SELEC                                          CSW097
     C           TICBS     WHEQ 1                                         CSW097
     C                     MOVEATX#,6     MGTDCF                          CSW097
     C           TICBS     WHEQ 2                                         CSW097
     C                     MOVEATX#,7     MGTDCF                          CSW097
     C           TICBS     WHEQ 3                                         CSW097
     C/COPY WNCPYSRC,DL6305C072                                           LHX010
     C                     MOVEATX#,16    MGTDCF                          183212
     C***********TICBS     OREQ 7                                  CIR004 183212
     C           TICBS     WHEQ 7                                         183212
     C           CIR004    ANDEQ'Y'                                       CIR004
     C                     MOVEATX#,8     MGTDCF                          CSW097
     C           TICBS     WHEQ 4                                         CSW097
     C           TICBS     OREQ 5                                         CSW097
     C           TICBS     OREQ 9                                         CIR013
     C                     MOVE TICBS     W@TDCF  1                       CSW097
     C                     MOVELW@TDCF    MGTDCF                          CSW097
     C           TICBS     WHEQ 6                                         CSW097
     C                     MOVEATX#,9     MGTDCF                          CSW097
     C                     ENDSL                                          CSW097
      *                                                                   CSW097
     C********** TBRTT     IFNE *ZERO                                     CSW097              CSD103
     C           TBRTT     IFNE *BLANKS                                                       CSD103
      *                                                                   CSW097
      **  Access Base Rate Code Details                                   CSW097
     C                     MOVE TBRTT     @KEY2                           CSW097
     C                     CALL 'AOBSRTR0'                                CSW097
     C                     PARM '*MSG   ' @RTCD                           CSW097
     C                     PARM '*KEY   ' @OPTN                           CSW097
     C                     PARM TCUCY     @KEY3                           CSW097
     C                     PARM           @KEY2                           CSW097
     C           SDBSRT    PARM SDBSRT    DSSDY                           CSW097
      *                                                                   CSW097
     C           @RTCD     IFEQ *BLANKS                                   CSW097
      *                                                                   CSW097
      **  Their Floating Rate, Designated Maturity, and                   CSW097
      **  Floating Rate Desc 1 - 2                                        CSW097
     C           BYSL      IFEQ 'B'                                       CSW097
     C                     MOVELBASCDD    MGTFLO                          CSW097
     C                     MOVELBADGMA    MGTDSM                          CSW097
     C                     MOVELBAOMD1    MGTOM1                          CSW097
     C                     MOVELBAOMD2    MGTOM2                          CSW097
     C                     ELSE                                           CSW097
     C                     MOVE *BLANK    MGTFLO                          CSW097
     C                     MOVE *BLANK    MGTDSM                          CSW097
     C                     MOVE *BLANK    MGTOM1                          CSW097
     C                     MOVE *BLANK    MGTOM2                          CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
     C                     ENDIF                                          CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
      **  Their Spread Rate                                               CSW097
     C           BYSL      IFEQ 'B'                                       CSW097
     C                     Z-ADDTRTSP     MGTSPD                          CSW097
     C                     ELSE                                           CSW097
     C                     Z-ADD*ZERO     MGTSPD                          CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
      **  Their Interest Processing Method                                CSW097
     C                     MOVE TINPM     MGTCMP                          CSW097
      *                                                                   CSW097
      **  Their Interest Payment Frequency Code                           CSW097
     C                     MOVE *BLANK    MGTIPF                          CSW097
      *                                                                   CSW097
      **  Their Rate Change Frequency Code                                CSW097
     C           BYSL      IFEQ 'B'                                       CSW097
     C                     MOVELTICFR     MGTRCF                          CSW097
     C                     ELSE                                           CSW097
     C                     MOVE *BLANK    MGTRCF                          CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
      **  Our Fixed Rate                                                  CSW097
     C           BYSL      IFEQ 'B'                                       CSW097
     C                     Z-ADDUEINR     MGEFXR                          CSW097
     C                     ELSE                                           CSW097
     C                     Z-ADD*ZERO     MGEFXR                          CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
      **  Our interest calculation method narrative.                      CSW097
     C                     SELEC                                          CSW097
     C           UICBS     WHEQ 1                                         CSW097
     C                     MOVEATX#,6     MGODCF                          CSW097
     C           UICBS     WHEQ 2                                         CSW097
     C                     MOVEATX#,7     MGODCF                          CSW097
     C           UICBS     WHEQ 3                                         CSW097
     C/COPY WNCPYSRC,DL6305C073                                           LHX010
     C                     MOVEATX#,16    MGODCF                          183212
     C***********UICBS     OREQ 7                                  CIR004 183212
     C           UICBS     WHEQ 7                                         183212
     C           CIR004    ANDEQ'Y'                                       CIR004
     C                     MOVEATX#,8     MGODCF                          CSW097
     C           UICBS     WHEQ 4                                         CSW097
     C           UICBS     OREQ 5                                         CSW097
     C           UICBS     OREQ 9                                         CIR013
     C                     MOVE UICBS     W@ODCF  1                       CSW097
     C                     MOVELW@ODCF    MGODCF                          CSW097
     C           UICBS     WHEQ 6                                         CSW097
     C                     MOVEATX#,9     MGODCF                          CSW097
     C                     ENDSL                                          CSW097
      *                                                                   CSW097
     C********** UBRTT     IFNE *ZERO                                     CSW097              CSD103
     C           UBRTT     IFNE *BLANKS                                                       CSD103
      *                                                                   CSW097
      **  Access Base Rate Code Details                                   CSW097
     C                     MOVE UBRTT     @KEY2                           CSW097
     C                     CALL 'AOBSRTR0'                                CSW097
     C                     PARM '*MSG   ' @RTCD                           CSW097
     C                     PARM '*KEY   ' @OPTN                           CSW097
     C                     PARM UCUCY     @KEY3                           CSW097
     C                     PARM           @KEY2                           CSW097
     C           SDBSRT    PARM SDBSRT    DSSDY                           CSW097
      *                                                                   CSW097
     C           @RTCD     IFEQ *BLANKS                                   CSW097
      *                                                                   CSW097
      **  Our Floating Rate, Designated Maturity, and                     CSW097
      **  Floating Rate Desc 1 - 2                                        CSW097
     C           BYSL      IFEQ 'S'                                       CSW097
     C                     MOVELBASCDD    MGOFLO                          CSW097
     C                     MOVELBADGMA    MGODSM                          CSW097
     C                     MOVELBAOMD1    MGOOM1                          CSW097
     C                     MOVELBAOMD2    MGOOM2                          CSW097
     C                     ELSE                                           CSW097
     C                     MOVE *BLANK    MGOFLO                          CSW097
     C                     MOVE *BLANK    MGODSM                          CSW097
     C                     MOVE *BLANK    MGOOM1                          CSW097
     C                     MOVE *BLANK    MGOOM2                          CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
     C                     ENDIF                                          CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
      ** Our Spread Rate                                                  CSW097
     C           BYSL      IFEQ 'S'                                       CSW097
     C                     Z-ADDURTSP     MGOSPD                          CSW097
     C                     ELSE                                           CSW097
     C                     Z-ADD*ZERO     MGOSPD                          CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
      ** Our Interest Processing Method                                   CSW097
     C                     MOVE UINPM     MGOCMP                          CSW097
      *                                                                   CSW097
      ** Our Interest Payment Frequency Code                              CSW097
     C                     MOVE *BLANK    MGOIPF                          CSW097
      *                                                                   CSW097
      ** Our Rate Change Frequency Code                                   CSW097
     C           BYSL      IFEQ 'S'                                       CSW097
     C                     MOVE UICFR     MGORCF                          CSW097
     C                     ELSE                                           CSW097
     C                     MOVE *BLANK    MGORCF                          CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
      ** Up-Front Value Date                                              CSW097
     C                     MOVE *ZERO     MGUPVD                          CSW097
      *                                                                   CSW097
      ** Their Up-Front Fee                                               CSW097
     C                     MOVE *ZERO     MGTUFF                          CSW097
      *                                                                   CSW097
      ** Our Up-Front Fee                                                 CSW097
     C                     MOVE *ZERO     MGOUFF                          CSW097
      *                                                                   CSW097
      ** Event Type                                                       CSW097
     C                     MOVE *BLANK    MGEVTP                          CSW097
      *                                                                                      BUG7911
      ** Termination Date/Maturity Date                                                      BUG7911
      *                                                                                      BUG7911
     C           MGMDAT    IFEQ MDAT                                                         BUG7911
     C           BOVD      ANDNE0                                                            BUG7911
     C                     Z-ADDBOVD      MGMDAT                                             BUG7911
     C                     Z-ADDBOVD      W#MDAT  50                                         BUG7911
     C                     ELSE                                                              BUG7911
     C                     Z-ADDMDAT      W#MDAT                                             BUG7911
     C                     ENDIF                                                             BUG7911
     C                     MOVE *BLANKS   MGOPDC                          CIR005
      **                                                                                      CIR017
     C                     MOVE *BLANKS   MGTPDC                                              CIR017
     C                     MOVE *BLANKS   MGOACN                                              CIR017
     C                     MOVE *BLANKS   MGTACN                                              CIR017
      *                                                                   CIR005
      ** Our Payment Date Convention                                      CIR005
      ** and amount convention                                            184003
      *                                                                   CIR005
     C           CIR005    IFEQ 'Y'                                       CIR005
     C                     MOVELL1PDCN    MGOPDC                          CIR005
     C                     MOVELL1AMCN    MGOACN                          184003
      **                                                                                      CIR017
      ** and Their Payment Date and Amount Convention                                         CIR017
      *                                                                                       CIR017
     C           CIR017    IFEQ 'Y'                                                           CIR017
     C                     MOVELL2PDCN    MGTPDC                                              CIR017
     C                     MOVELL2AMCN    MGTACN                                              CIR017
     C                     ENDIF                                                              CIR017
      *                                                                                       CIR017
     C                     ENDIF                                          CIR005
      *                                                                                       CSW213
     C                     EXSR SRREPI                                                        CSW213
      *                                                                   CSW097
      ** Write New Record                                                 CSW097
     C                     WRITEMGX360D0                                  CSW005
      *                                                                   CSW097
      ** Output Payment Details                                           CSW097
     C                     EXSR SRY36N                                    CSW097
      *                                                                   CSW097
      ** Output Financial Centre Details                                  CSW097
     C                     EXSR SRU36N                                    CSW097
      *                                                                   CSW097
      ** Output Settlement Details                                        CSW097
     C                     EXSR SRX36N                                    CSW097
      *                                                                   CSW097
     C                     ENDSR                                          CSW097
      *****************************************************************   CSW097
     C/EJECT                                                              CSW097
      *****************************************************************   CSW097
      *   F360RS - Format Message Specific fields for MT360 - "RS"    *   CSW097
      *   Called by - VALD                                            *   CSW097
      *   Calls - SRY36N, SRZ36N, SRU36N, SRV36N, SRX36N              *   CSW097
      *****************************************************************   CSW097
      *                                                                   CSW097
     C           F360RS    BEGSR                                          CSW097
      *                                                                   CSW097
      **  Sequence Number                                                 CSW097
     C                     ADD  1         MGSEQN                          CSW097
      *                                                                   CSW097
      **  Related Reference                                               CSW097
      *                                                                   CSW097
     C           @RTNC     IFEQ 'C'                                       CSW097
     C                     MOVELPTRAN     MGRREF                          CSW097
     C                     ELSE                                           CSW097
     C                     MOVEL*BLANKS   MGRREF                          CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
      **  Further Identification                                          CSW097
     C                     SELEC                                          CSW097
     C********** UBRTT     WHEQ 00                                        CSW097              CSD103
     C********** TBRTT     ANDEQ00                                        CSW097              CSD103
     C           UBRTT     WHEQ *BLANKS                                                       CSD103
     C           TBRTT     ANDEQ*BLANKS                                                       CSD103
     C           10        SUBSTTX#,1:1   MGFUID                          CSW097
     C********** UBRTT     WHEQ 00                                        CSW097              CSD103
     C********** TBRTT     ANDNE00                                        CSW097              CSD103
     C           UBRTT     WHEQ *BLANKS                                                       CSD103
     C           TBRTT     ANDNE*BLANKS                                                       CSD103
     C           10        SUBSTTX#,2:1   MGFUID                          CSW097
     C********** UBRTT     WHNE 00                                        CSW097              CSD103
     C********** TBRTT     ANDEQ00                                        CSW097              CSD103
     C           UBRTT     WHNE *BLANKS                                                       CSD103
     C           TBRTT     ANDEQ*BLANKS                                                       CSD103
     C           10        SUBSTTX#,3:1   MGFUID                          CSW097
     C********** UBRTT     WHNE 00                                        CSW097              CSD103
     C********** TBRTT     ANDNE00                                        CSW097              CSD103
     C           UBRTT     WHNE *BLANKS                                                       CSD103
     C           TBRTT     ANDNE*BLANKS                                                       CSD103
     C           10        SUBSTTX#,4:1   MGFUID                          CSW097
     C                     ENDSL                                          CSW097
      *                                                                   CSW097
      **  Effective Date of Assignment                                    CSW097
     C                     Z-ADDDVDAT     MGADAT                          CSW097
      *                                                                   CSW097
      **  Business Day Convention                                         CSW097
      *                                                                                       208624
     C           CIR005    IFEQ 'Y'                                                           208624
     C                     SELEC                                                              208624
     C           L1PDCN    WHEQ 'F'                                                           208624
     C                     MOVEL@BDAC     MGBDAC                                              208624
     C           L1PDCN    WHEQ 'P'                                                           208624
     C                     MOVELWBDCP     MGBDAC                                              208624
     C           L1PDCN    WHEQ 'MF'                                                          208624
     C                     MOVELWBDCM     MGBDAC                                              208624
     C                     OTHER                                                              208624
     C                     MOVELWBDCO     MGBDAC                                              208624
     C                     ENDSL                                                              208624
      *                                                                                       208624
     C                     ELSE                                                               208624
      *                                                                                       208624
     C           CIR005    IFNE 'Y'                                                           CIR017
     C           CIR017    ORNE 'Y'                                                           CIR017
     C                     MOVEL@BDAC     MGBDAC                          CSW097
     C                     ELSE                                                               CIR017
      ** Leg 1                                                                                CIR017
     C                     SELEC                                                              CIR017
     C           L1PDCN    WHEQ 'F'                                                           CIR017
     C                     MOVEL@BDAC     MGBDAC                                              CIR017
     C           L1PDCN    WHEQ 'P'                                                           CIR017
     C                     MOVELWBDCP     MGBDAC                                              CIR017
     C           L1PDCN    WHEQ 'MF'                                                          CIR017
     C                     MOVELWBDCM     MGBDAC                                              CIR017
     C                     OTHER                                                              CIR017
     C                     MOVELWBDCO     MGBDAC                                              CIR017
     C                     ENDSL                                                              CIR017
      ** Leg 2                                                                                CIR017
     C                     SELEC                                                              CIR017
     C           L2PDCN    WHEQ 'F'                                                           CIR017
     C                     MOVEL@BDAC     MGBDL2                                              CIR017
     C           L2PDCN    WHEQ 'P'                                                           CIR017
     C                     MOVELWBDCP     MGBDL2                                              CIR017
     C           L2PDCN    WHEQ 'MF'                                                          CIR017
     C                     MOVELWBDCM     MGBDL2                                              CIR017
     C                     OTHER                                                              CIR017
     C                     MOVELWBDCO     MGBDL2                                              CIR017
     C                     ENDSL                                                              CIR017
      *                                                                                       CIR017
     C                     ENDIF                                                              CIR017
      *                                                                                       CIR017
      *                                                                                       208624
     C                     ENDIF                                                              208624
      *                                                                   CSW097
      **  Currency                                                        CSW097
     C                     MOVE UCUCY     MGCCY                           CSW097
      *                                                                   CSW097
      **  If version of ISDA is blank, this must be a deal entered        CSW097
      **  before CSW005 was on and has not been updated with these        CSW097
      **  essential details for MT360, so try to default                  CSW097
      *                                                                   CSW097
     C           ISDA      IFEQ *ZEROS                                    CSW097
     C           AGTY      ANDEQ*BLANK                                    CSW097
     C           AGDT      ANDEQ*ZEROS                                    CSW097
     C           AGVV      ANDEQ*ZEROS                                    CSW097
     C           AGVC      ANDEQ*ZEROS                                    CSW097
     C                     EXSR ISDAD                                     CSW097
     C                     ELSE                                           CSW097
      *                                                                   CSW097
      *   ISDA rules version                                              CSW097
     C                     Z-ADDISDA      MGISDA                          CSW097
      *                                                                   CSW097
      **  Type of ISDA agreement                                          CSW097
     C                     MOVELAGTY      MGAGTY                          CSW097
      *                                                                   CSW097
      **  Date of ISDA agreement                                          CSW097
     C                     MOVE AGDT      ZAGDT                           CSW097
     C                     EXSR SRAGDT                                    CSW097
     C                     Z-ADD@@VDT     MGAGDT                          CSW097
      *                                                                   CSW097
      **  Version of ISDA agreement                                       CSW097
     C                     MOVE AGVV      ZZ0004                          CSW097
     C                     MOVELAGVC      ZZ0004                          CSW097
     C                     MOVE ZZ0004    MGAGVV                          CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
      **  Notional Amount                                                 CSW097
     C                     Z-ADDUOPAM     MGNOTA                          CSW097
      *                                                                   CSW097
      **  Condition lines                                                 CSW097
     C                     MOVELCND1      MGCON1                          CSW097
     C                     MOVELCND2      MGCON2                          CSW097
     C                     MOVELCND3      MGCON3                          CSW097
     C                     MOVELCND4      MGCON4                          CSW097
     C                     MOVELCND5      MGCON5                          CSW097
     C                     MOVELCND6      MGCON6                          CSW097
      *                                                                   CSW097
      **  Sender-to-Receiver Information lines                            CSW097
     C                     MOVELDSR1      MGS2R1                          CSW097
     C                     MOVELDSR2      MGS2R2                          CSW097
     C                     MOVELDSR3      MGS2R3                          CSW097
     C                     MOVELDSR4      MGS2R4                          CSW097
     C                     MOVELDSR5      MGS2R5                          CSW097
     C                     MOVELDSR6      MGS2R6                          CSW097
      *                                                                   CSW097
      **  Collateral Agreement Indicator                                  CSW097
     C                     MOVELCAIN      MGCAIN                          CSW097
      *                                                                   CSW097
      **  Their Fixed Rate                                                CSW097
     C********** TBRTT     IFEQ 00                                        CSW097              CSD103
     C           TBRTT     IFEQ *BLANKS                                                       CSD103
     C                     Z-ADDTEINR     MGBFXR                          CSW097
     C                     ELSE                                           CSW097
     C                     Z-ADD*ZERO     MGBFXR                          CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
      **  Their interest calculation method narrative.                    CSW097
     C                     SELEC                                          CSW097
     C           TICBS     WHEQ 1                                         CSW097
     C                     MOVEATX#,6     MGTDCF                          CSW097
     C           TICBS     WHEQ 2                                         CSW097
     C                     MOVEATX#,7     MGTDCF                          CSW097
     C           TICBS     WHEQ 3                                         CSW097
     C/COPY WNCPYSRC,DL6305C074                                           LHX010
     C                     MOVEATX#,16    MGTDCF                          183212
     C***********TICBS     OREQ 7                                  CIR004 183212
     C           TICBS     WHEQ 7                                         183212
     C           CIR004    ANDEQ'Y'                                       CIR004
     C                     MOVEATX#,8     MGTDCF                          CSW097
     C           TICBS     WHEQ 4                                         CSW097
     C           TICBS     OREQ 5                                         CSW097
     C           TICBS     OREQ 9                                         CIR013
     C                     MOVE TICBS     W@TDCF                          CSW097
     C                     MOVELW@TDCF    MGTDCF                          CSW097
     C           TICBS     WHEQ 6                                         CSW097
     C                     MOVEATX#,9     MGTDCF                          CSW097
     C                     ENDSL                                          CSW097
      *                                                                   CSW097
      **  Their Floating Rate, Designated Maturity, and                   CSW097
      **  Floating Rate Desc 1 - 2                                        CSW097
     C********** TBRTT     IFNE 00                                        CSW097              CSD103
     C           TBRTT     IFNE *BLANKS                                                       CSD103
      *                                                                   CSW097
      **  Access Base Rate Code Details                                   CSW097
     C                     MOVE TBRTT     @KEY2                           CSW097
     C                     CALL 'AOBSRTR0'                                CSW097
     C                     PARM '*MSG   ' @RTCD                           CSW097
     C                     PARM '*KEY   ' @OPTN                           CSW097
     C                     PARM TCUCY     @KEY3                           CSW097
     C                     PARM           @KEY2                           CSW097
     C           SDBSRT    PARM SDBSRT    DSSDY                           CSW097
      *                                                                   CSW097
     C           @RTCD     IFEQ *BLANKS                                   CSW097
     C                     MOVELBASCDD    MGTFLO                          CSW097
     C                     MOVELBADGMA    MGTDSM                          CSW097
     C                     MOVELBAOMD1    MGTOM1                          CSW097
     C                     MOVELBAOMD2    MGTOM2                          CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
     C                     ELSE                                           CSW097
     C                     MOVE *BLANK    MGTFLO                          CSW097
     C                     MOVE *BLANK    MGTDSM                          CSW097
     C                     MOVE *BLANK    MGTOM1                          CSW097
     C                     MOVE *BLANK    MGTOM2                          CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
      **  Their Spread Rate                                               CSW097
     C********** TBRTT     IFNE 00                                        CSW097              CSD103
     C           TBRTT     IFNE *BLANKS                                                       CSD103
     C                     Z-ADDTRTSP     MGTSPD                          CSW097
     C                     ELSE                                           CSW097
     C                     Z-ADD*ZERO     MGTSPD                          CSW097
     C                     ENDIF                                          CSW097
      *                                                                   176294
     C                     SELEC                                          176294
     C           TSPIN     WHEQ 'A'                                       176294
     C                     Z-ADDTRTSP     MGTSPD                          176294
     C           TSPIN     WHEQ 'S'                                       176294
     C                     Z-SUBTRTSP     MGTSPD                          176294
     C           TSPIN     WHEQ 'P'                                       176294
     C           TOBRT     DIV  100       WWRK   139                      176294
     C           WWRK      MULT TRTSP     MGTSPD                          176294
     C                     ENDSL                                          176294
      *                                                                   CSW097
      **  Their Interest Processing Method                                CSW097
     C                     MOVE TINPM     MGTCMP                          CSW097
      *                                                                   CSW097
      **  Their Interest Payment Frequency Code                           CSW097
     C                     MOVE TIPFR     MGTIPF                          CSW097
      *                                                                   CSW097
      **  Their Rate Change Frequency Code                                CSW097
     C********** TBRTT     IFNE 00                                        CSW097              CSD103
     C           TBRTT     IFNE *BLANKS                                                       CSD103
     C                     MOVELTICFR     MGTRCF                          CSW097
     C                     ELSE                                           CSW097
     C                     MOVE *BLANK    MGTRCF                          CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
      **  Our Fixed Rate                                                  CSW097
     C********** UBRTT     IFEQ 00                                        CSW097              CSD103
     C           UBRTT     IFEQ *BLANKS                                                       CSD103
     C                     Z-ADDUEINR     MGEFXR                          CSW097
     C                     ELSE                                           CSW097
     C                     Z-ADD*ZERO     MGEFXR                          CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
      **  Our interest calculation method narrative.                      CSW097
     C                     SELEC                                          CSW097
     C           UICBS     WHEQ 1                                         CSW097
     C                     MOVEATX#,6     MGODCF                          CSW097
     C           UICBS     WHEQ 2                                         CSW097
     C                     MOVEATX#,7     MGODCF                          CSW097
     C           UICBS     WHEQ 3                                         CSW097
     C/COPY WNCPYSRC,DL6305C075                                           LHX010
     C                     MOVEATX#,16    MGODCF                          183212
     C***********UICBS     OREQ 7                                  CIR004 183212
     C           UICBS     WHEQ 7                                         183212
     C           CIR004    ANDEQ'Y'                                       CIR004
     C                     MOVEATX#,8     MGODCF                          CSW097
     C           UICBS     WHEQ 4                                         CSW097
     C           UICBS     OREQ 5                                         CSW097
     C           UICBS     OREQ 9                                         CIR013
     C                     MOVE UICBS     W@ODCF                          CSW097
     C                     MOVELW@ODCF    MGODCF                          CSW097
     C           UICBS     WHEQ 6                                         CSW097
     C                     MOVEATX#,9     MGODCF                          CSW097
     C                     ENDSL                                          CSW097
      *                                                                   CSW097
      **  Our Floating Rate, Designated Maturity, and                     CSW097
      **  Floating Rate Desc 1 - 2                                        CSW097
     C********** UBRTT     IFNE 00                                        CSW097              CSD103
     C           UBRTT     IFNE *BLANKS                                                       CSD103
      *                                                                   CSW097
      **  Access Base Rate Code Details                                   CSW097
     C                     MOVE UBRTT     @KEY2                           CSW097
     C                     CALL 'AOBSRTR0'                                CSW097
     C                     PARM '*MSG   ' @RTCD                           CSW097
     C                     PARM '*KEY   ' @OPTN                           CSW097
     C                     PARM UCUCY     @KEY3                           CSW097
     C                     PARM           @KEY2                           CSW097
     C           SDBSRT    PARM SDBSRT    DSSDY                           CSW097
      *                                                                   CSW097
     C           @RTCD     IFEQ *BLANKS                                   CSW097
     C                     MOVELBASCDD    MGOFLO                          CSW097
     C                     MOVELBADGMA    MGODSM                          CSW097
     C                     MOVELBAOMD1    MGOOM1                          CSW097
     C                     MOVELBAOMD2    MGOOM2                          CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
     C                     ELSE                                           CSW097
     C                     MOVE *BLANK    MGOFLO                          CSW097
     C                     MOVE *BLANK    MGODSM                          CSW097
     C                     MOVE *BLANK    MGOOM1                          CSW097
     C                     MOVE *BLANK    MGOOM2                          CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
      **  Their Spread                                                    CSW097
     C********** UBRTT     IFNE 00                                        CSW097              CSD103
     C           UBRTT     IFNE *BLANKS                                                       CSD103
     C                     Z-ADDURTSP     MGOSPD                          CSW097
     C                     ELSE                                           CSW097
     C                     Z-ADD*ZERO     MGOSPD                          CSW097
     C                     ENDIF                                          CSW097
      *                                                                   176294
     C                     SELEC                                          176294
     C           USPIN     WHEQ 'A'                                       176294
     C                     Z-ADDURTSP     MGOSPD                          176294
     C           USPIN     WHEQ 'S'                                       176294
     C                     Z-SUBURTSP     MGOSPD                          176294
     C           USPIN     WHEQ 'P'                                       176294
     C           UOBRT     DIV  100       WWRK   139                      176294
     C           WWRK      MULT URTSP     MGOSPD                          176294
     C                     ENDSL                                          176294
      *                                                                   CSW097
      **  Our Interest Processing Method                                  CSW097
     C                     MOVE UINPM     MGOCMP                          CSW097
      *                                                                   CSW097
      **  Our Interest Payment Frequency Code                             CSW097
     C                     MOVE UIPFR     MGOIPF                          CSW097
      *                                                                   CSW097
      **  Their Rate Change Frequency Code                                CSW097
     C********** UBRTT     IFNE 00                                        CSW097              CSD103
     C           UBRTT     IFNE *BLANKS                                                       CSD103
     C                     MOVELUICFR     MGORCF                          CSW097
     C                     ELSE                                           CSW097
     C                     MOVE *BLANK    MGORCF                          CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
      ** Up-Front Fee Value Date                                          CSW097
     C           UPVD      IFNE *ZERO                                     CSW097
     C                     Z-ADDUPVD      MGUPVD                          CSW097
     C                     ELSE                                           CSW097
     C                     Z-ADD*ZERO     MGUPVD                          CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
      ** Their Up-Front Fee                                               CSW097
     C           UPPR      IFEQ 'R'                                       CSW097
     C                     Z-ADDUPFE      MGTUFF                          CSW097
     C                     ELSE                                           CSW097
     C                     Z-ADD*ZERO     MGTUFF                          CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
      ** Our Up-Front Fee                                                 CSW097
     C           UPPR      IFEQ 'P'                                       CSW097
     C                     Z-ADDUPFE      MGOUFF                          CSW097
     C                     ELSE                                           CSW097
     C                     MOVE *ZERO     MGOUFF                          CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
      ** Event Type                                                       CSW097
     C                     MOVE *BLANK    MGEVTP                          CSW097
      *                                                                                       251883
      ** Termination Date/Maturity Date                                                       251883
      *                                                                                       251883
     C           MGMDAT    IFEQ MDAT                                                          251883
     C           BOVD      ANDNE0                                                             251883
     C                     Z-ADDBOVD      MGMDAT                                              251883
     C                     Z-ADDBOVD      W#MDAT                                              251883
     C                     ELSE                                                               251883
     C                     Z-ADDMDAT      W#MDAT                                              251883
     C                     ENDIF                                                              251883
     C                     MOVE *BLANKS   MGOPDC                                              251883
      *                                                                                      BUG6795
      ** Our Payment Date Convention                                                         BUG6795
      ** and amount convention                                                               BUG6795
      *                                                                                      BUG6795
     C           CIR005    IFEQ 'Y'                                                          BUG6795
     C                     MOVELL1PDCN    MGOPDC                                             BUG6795
     C                     MOVELL1AMCN    MGOACN                                             BUG6795
     C                     ENDIF                                                             BUG6795
      *                                                                                      BUG7539
      ** Change type                                                                         BUG7539
      *                                                                                      BUG7539
     C           MGCHTP    IFEQ *BLANK                                                       BUG7539
     C                     MOVE @CHG      MGCHTP                                             BUG7539
     C                     ENDIF                                                             BUG7539
      *                                                                                      BUG7977
      ** Stub details - Ours                                                                 BUG7977
      *                                                                                      BUG7977
      *  Ours 38G (From First)                                                               BUG7977
      **  Access Base Rate Code Details - Ours                                               BUG7977
     C                     CLEARMGOS1B                                                       BUG7977
     C********** FSOS1B    IFNE 0                                                     BUG7977 CSD103
     C           FSOS1B    IFNE *BLANKS                                                       CSD103
     C                     MOVE FSOS1B    @KEY2                                              BUG7977
     C                     CALL 'AOBSRTR0'                                                   BUG7977
     C                     PARM '*MSG   ' @RTCD                                              BUG7977
     C                     PARM '*KEY   ' @OPTN                                              BUG7977
     C                     PARM UCUCY     @KEY3                                              BUG7977
     C                     PARM           @KEY2                                              BUG7977
     C           SDBSRT    PARM SDBSRT    DSSDY                                              BUG7977
     C           @RTCD     IFEQ *BLANKS                                                      BUG7977
     C                     MOVELBADGMA    MGOS1B                                             BUG7977
     C                     ENDIF                                                             BUG7977
     C                     ENDIF                                                             BUG7977
      *  Ours 38G (To First) 11                                                              BUG7977
      **  Access Base Rate Code Details - Ours                                               BUG7977
     C                     CLEARMGOE1B                                                       BUG7977
     C********** FSOE1B    IFNE 0                                                     BUG7977 CSD103
     C           FSOE1B    IFNE *BLANKS                                                       CSD103
     C                     MOVE FSOE1B    @KEY2                                              BUG7977
     C                     CALL 'AOBSRTR0'                                                   BUG7977
     C                     PARM '*MSG   ' @RTCD                                              BUG7977
     C                     PARM '*KEY   ' @OPTN                                              BUG7977
     C                     PARM UCUCY     @KEY3                                              BUG7977
     C                     PARM           @KEY2                                              BUG7977
     C           SDBSRT    PARM SDBSRT    DSSDY                                              BUG7977
     C           @RTCD     IFEQ *BLANKS                                                      BUG7977
     C                     MOVELBADGMA    MGOE1B                                             BUG7977
     C                     ENDIF                                                             BUG7977
     C                     ENDIF                                                             BUG7977
      *  Ours 38H (From Last)                                                                BUG7977
      **  Access Base Rate Code Details - Ours                                               BUG7977
     C                     CLEARMGOS2B                                                       BUG7977
     C********** FSOS2B    IFNE 0                                                     BUG7977 CSD103
     C           FSOS2B    IFNE *BLANKS                                                       CSD103
     C                     MOVE FSOS2B    @KEY2                                              BUG7977
     C                     CALL 'AOBSRTR0'                                                   BUG7977
     C                     PARM '*MSG   ' @RTCD                                              BUG7977
     C                     PARM '*KEY   ' @OPTN                                              BUG7977
     C                     PARM UCUCY     @KEY3                                              BUG7977
     C                     PARM           @KEY2                                              BUG7977
     C           SDBSRT    PARM SDBSRT    DSSDY                                              BUG7977
     C           @RTCD     IFEQ *BLANKS                                                      BUG7977
     C                     MOVELBADGMA    MGOS2B                                             BUG7977
     C                     ENDIF                                                             BUG7977
     C                     ENDIF                                                             BUG7977
      *  Ours 38H (To Last)                                                                  BUG7977
      **  Access Base Rate Code Details - Ours                                               BUG7977
     C                     CLEARMGOE2B                                                       BUG7977
     C********** FSOE2B    IFNE 0                                                     BUG7977 CSD103
     C           FSOE2B    IFNE *BLANKS                                                       CSD103
     C                     MOVE FSOE2B    @KEY2                                              BUG7977
     C                     CALL 'AOBSRTR0'                                                   BUG7977
     C                     PARM '*MSG   ' @RTCD                                              BUG7977
     C                     PARM '*KEY   ' @OPTN                                              BUG7977
     C                     PARM UCUCY     @KEY3                                              BUG7977
     C                     PARM           @KEY2                                              BUG7977
     C           SDBSRT    PARM SDBSRT    DSSDY                                              BUG7977
     C           @RTCD     IFEQ *BLANKS                                                      BUG7977
     C                     MOVELBADGMA    MGOE2B                                             BUG7977
     C                     ENDIF                                                             BUG7977
     C                     ENDIF                                                             BUG7977
      *                                                                                      BUG7977
      ** Stub details - Theirs                                                               BUG7977
      *                                                                                      BUG7977
      *  Theirs 38G (From First)                                                             BUG7977
      **  Access Base Rate Code Details - Theirs                                             BUG7977
     C                     CLEARMGTS1B                                                       BUG7977
     C********** FSTS1B    IFNE 0                                                     BUG7977 CSD103
     C           FSTS1B    IFNE *BLANKS                                                       CSD103
     C                     MOVE FSTS1B    @KEY2                                              BUG7977
     C                     CALL 'AOBSRTR0'                                                   BUG7977
     C                     PARM '*MSG   ' @RTCD                                              BUG7977
     C                     PARM '*KEY   ' @OPTN                                              BUG7977
     C                     PARM TCUCY     @KEY3                                              BUG7977
     C                     PARM           @KEY2                                              BUG7977
     C           SDBSRT    PARM SDBSRT    DSSDY                                              BUG7977
     C           @RTCD     IFEQ *BLANKS                                                      BUG7977
     C                     MOVELBADGMA    MGTS1B                                             BUG7977
     C                     ENDIF                                                             BUG7977
     C                     ENDIF                                                             BUG7977
      *  Theirs 38G (To First)                                                               BUG7977
      **  Access Base Rate Code Details - Theirs                                             BUG7977
     C                     CLEARMGTE1B                                                       BUG7977
     C********** FSTE1B    IFNE 0                                                     BUG7977 CSD103
     C           FSTE1B    IFNE *BLANKS                                                       CSD103
     C                     MOVE FSTE1B    @KEY2                                              BUG7977
     C                     CALL 'AOBSRTR0'                                                   BUG7977
     C                     PARM '*MSG   ' @RTCD                                              BUG7977
     C                     PARM '*KEY   ' @OPTN                                              BUG7977
     C                     PARM TCUCY     @KEY3                                              BUG7977
     C                     PARM           @KEY2                                              BUG7977
     C           SDBSRT    PARM SDBSRT    DSSDY                                              BUG7977
     C           @RTCD     IFEQ *BLANKS                                                      BUG7977
     C                     MOVELBADGMA    MGTE1B                                             BUG7977
     C                     ENDIF                                                             BUG7977
     C                     ENDIF                                                             BUG7977
      *  Theirs 38H (From Last)                                                              BUG7977
      **  Access Base Rate Code Details - Theirs                                             BUG7977
     C                     CLEARMGTS2B                                                       BUG7977
     C********** FSTS2B    IFNE 0                                                     BUG7977 CSD103
     C           FSTS2B    IFNE *BLANKS                                                       CSD103
     C                     MOVE FSTS2B    @KEY2                                              BUG7977
     C                     CALL 'AOBSRTR0'                                                   BUG7977
     C                     PARM '*MSG   ' @RTCD                                              BUG7977
     C                     PARM '*KEY   ' @OPTN                                              BUG7977
     C                     PARM TCUCY     @KEY3                                              BUG7977
     C                     PARM           @KEY2                                              BUG7977
     C           SDBSRT    PARM SDBSRT    DSSDY                                              BUG7977
     C           @RTCD     IFEQ *BLANKS                                                      BUG7977
     C                     MOVELBADGMA    MGTS2B                                             BUG7977
     C                     ENDIF                                                             BUG7977
     C                     ENDIF                                                             BUG7977
      *  Theirs  38H (To Last)                                                               BUG7977
      **  Access Base Rate Code Details - Theirs                                             BUG7977
     C                     CLEARMGTE2B                                                       BUG7977
     C********** FSTE2B    IFNE 0                                                     BUG7977 CSD103
     C           FSTE2B    IFNE *BLANKS                                                       CSD103
     C                     MOVE FSTE2B    @KEY2                                              BUG7977
     C                     CALL 'AOBSRTR0'                                                   BUG7977
     C                     PARM '*MSG   ' @RTCD                                              BUG7977
     C                     PARM '*KEY   ' @OPTN                                              BUG7977
     C                     PARM TCUCY     @KEY3                                              BUG7977
     C                     PARM           @KEY2                                              BUG7977
     C           SDBSRT    PARM SDBSRT    DSSDY                                              BUG7977
     C           @RTCD     IFEQ *BLANKS                                                      BUG7977
     C                     MOVELBADGMA    MGTE2B                                             BUG7977
     C                     ENDIF                                                             BUG7977
     C                     ENDIF                                                             BUG7977
      *                                                                                      BUG7977
     C                     EXSR SRREPI                                                        CSW213
      *                                                                   CSW097
      ** Write New Record                                                 CSW097
     C                     WRITEMGX360D0                                  CSW097
      *                                                                   CSW097
      ** Output Payment Details                                           CSW097
     C                     EXSR SRY36N                                    CSW097
      *                                                                   CSW097
      ** Output Principal Repayment Details                               CSW097
     C                     MOVE *BLANK    WOTIN                           CSW097
     C                     EXSR SRZ36N                                    CSW097
      *                                                                   CSW097
      ** Output Financial Centre Details                                  CSW097
     C                     EXSR SRU36N                                    CSW097
      *                                                                   CSW097
      ** Output Compounding Interest Details                              CSW097
     C                     EXSR SRV36N                                    CSW097
      *                                                                   CSW097
      ** Output Settlement Details                                        CSW097
     C                     EXSR SRX36N                                    CSW097
      *                                                                   CSW097
     C                     ENDSR                                          CSW097
      *****************************************************************   CSW097
     C/EJECT                                                              CSW097
      *************************************************************CSW005 CSW097
      ****F360*-*Format*Message*Specific*fields*for*MT360**********CSW005 CSW097
      ****Called*by*-*VALD*****************************************CSW005 CSW097
      ****Calls*-**************************************************CSW005 CSW097
      *************************************************************CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C***********F360      BEGSR                                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Format*fields*for*MT360**********************************CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Sequence*Number******************************************CSW005 CSW097
     C***********          ADD  1         MGSEQN                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Format*Related*reference*********************************CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C***********@RTNC     IFEQ 'C'                                CSW005 CSW097
     C***********          MOVELPTRAN     MGRREF                   CSW005 CSW097
     C***********          ELSE                                    CSW005 CSW097
     C***********          MOVEL*BLANKS   MGRREF                   CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Further*Identification***********************************CSW005 CSW097
     C***********          SELEC                                   CSW005 CSW097
     C***********UBRTT     WHEQ 00                                 CSW005 CSW097
     C***********TBRTT     ANDEQ00                                 CSW005 CSW097
     C***********          MOVEATX#,1     MGFUID                   CSW005 CSW097
     C***********UBRTT     WHEQ 00                                 CSW005 CSW097
     C***********TBRTT     ANDGT00                                 CSW005 CSW097
     C***********          MOVEATX#,2     MGFUID                   CSW005 CSW097
     C***********UBRTT     WHGT 00                                 CSW005 CSW097
     C***********TBRTT     ANDEQ00                                 CSW005 CSW097
     C***********          MOVEATX#,3     MGFUID                   CSW005 CSW097
     C***********UBRTT     WHGT 00                                 CSW005 CSW097
     C***********TBRTT     ANDGT00                                 CSW005 CSW097
     C***********          MOVEATX#,4     MGFUID                   CSW005 CSW097
     C***********          ENDSL                                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Transaction*Date*****************************************CSW005 CSW097
     C***********          Z-ADDDDAT      MGTDAT                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Effective*Date*of*Assignment*****************************CSW005 CSW097
     C***********          Z-ADDDVDAT     MGADAT                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Business*Day*Convention**********************************CSW005 CSW097
     C***********          MOVEATX#,5     MGBDAC                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Currency*************************************************CSW005 CSW097
     C***********          MOVE UCUCY     MGCCY                    CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Amortising*Indicator*-*Only*if*Interest*Rate*Calendar*is*CSW005 CSW097
      ****and*a*record*exists*in*the*Principal*Change*Calendar*fileCSW005 CSW097
     C***********          MOVE 'N'       MGAMRT                   CSW005 CSW097
     C***********CIR001    IFEQ 'Y'                                CSW005 CSW097
     C***********DDLNO     CHAINDLPCSCD0             70            CSW005 CSW097
     C************IN70     IFEQ '0'                                CSW005 CSW097
     C***********          MOVE 'Y'       MGAMRT                   CSW005 CSW097
     C***********          MOVELPDEI      MGTPRA                   CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****If*version*of*ISDA*is*blank,*this*must*be*a*deal*entered*CSW005 CSW097
      ****before*CSW005*was*on*and*has*not*been*updated*with*these*CSW005 CSW097
      ****essential*details*for*MT360,*so*try*to*default***********CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C***********ISDA      IFEQ *ZEROS                             CSW005 CSW097
     C***********          EXSR ISDAD                              CSW005 CSW097
     C***********          ELSE                                    CSW005 CSW097
      ****ISDA*rules*version***************************************CSW005 CSW097
     C***********          Z-ADDISDA      MGISDA                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Type*of*ISDA*agreement***********************************CSW005 CSW097
     C***********          MOVELAGTY      MGAGTY                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Date*of*ISDA*agreement***********************************CSW005 CSW097
     C***********          Z-ADDAGDT      MGAGDT                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Version*of*ISDA*agreement********************************CSW005 CSW097
     C***********          Z-ADDAGVV      MGAGVV                   CSW005 CSW097
     C***********          END                                     CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Notional*Amount******************************************CSW005 CSW097
     C***********          Z-ADDUOPAM     MGNOTA                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Condition*lines******************************************CSW005 CSW097
     C***********          MOVELCND1      MGCON1                   CSW005 CSW097
     C***********          MOVELCND2      MGCON2                   CSW005 CSW097
     C***********          MOVELCND3      MGCON3                   CSW005 CSW097
     C***********          MOVELCND4      MGCON4                   CSW005 CSW097
     C***********          MOVELCND5      MGCON5                   CSW005 CSW097
     C***********          MOVELCND6      MGCON6                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Contact*name*and*telephone*no.*from*Customer*Details.****CSW005 CSW097
      ****If*it*has*no*Account*Officer*details,*fields*are*blanks**CSW005 CSW097
      ****because*they*are*initialised*in*SR/SETF.*****************CSW005 CSW097
     C***********          MOVELCNUM      W#CNUM  8                CSW005 CSW097
     C***********          MOVE *BLANKS   @KEY1                    CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C***********          CALL 'AOCUSTR0'                         CSW005 CSW097
     C***********          PARM '*MSG   ' @RTCD                    CSW005 CSW097
     C***********          PARM '*KEY   ' @OPTN                    CSW005 CSW097
     C***********          PARM W#CNUM    @KEY1                    CSW005 CSW097
     C***********          PARM *BLANKS   @KYST                    CSW005 CSW097
     C***********SDCUST    PARM SDCUST    DSSDY                    CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C***********@RTCD     IFNE *BLANKS                            CSW005 CSW097
     C************LOCK     IN   LDA                                CSW005 CSW097
     C***********          MOVE '017'     DBASE     * * * * * * * *CSW005 CSW097
     C***********          MOVELW#CNUM    DBKEY     * DB ERROR 17 *CSW005 CSW097
     C***********          MOVEL'SDCUSTPD'DBFILE    * * * * * * * *CSW005 CSW097
     C***********          OUT  LDA                                CSW005 CSW097
     C***********          EXSR *PSSR                              CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C***********@RTCD     IFEQ *BLANKS                            CSW005 CSW097
     C***********BBACOC    ANDNE*BLANKS                            CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Access*Account*Officer*Details***************************CSW005 CSW097
     C***********          CALL 'AOACOFR0'                         CSW005 CSW097
     C***********          PARM '*MSG   ' @RTCD                    CSW005 CSW097
     C***********          PARM '*KEY   ' @OPTN                    CSW005 CSW097
     C***********          PARM BBACOC    @KEY2   2                CSW005 CSW097
     C***********SDACOF    PARM SDACOF    DSSDY                    CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C***********@RTCD     IFNE *BLANKS                            CSW005 CSW097
     C************LOCK     IN   LDA                                CSW005 CSW097
     C***********          MOVE '035'     DBASE     * * * * * * * *CSW005 CSW097
     C***********          MOVELBBACOC    DBKEY     * DB ERROR 35 *CSW005 CSW097
     C***********          MOVEL'SDACOFPD'DBFILE    * * * * * * * *CSW005 CSW097
     C***********          OUT  LDA                                CSW005 CSW097
     C***********          EXSR *PSSR                              CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C***********@RTCD     IFEQ *BLANKS                            CSW005 CSW097
     C***********          MOVELAZACON    MGCTC1                   CSW005 CSW097
     C***********          MOVELAZAPHN    MGCTC2                   CSW005 CSW097
     C***********          MOVELAZAEXT    MGCTC3                   CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Sender-to-Receiver*Information*lines*********************CSW005 CSW097
     C***********          MOVELSSR1      MGS2R1                   CSW005 CSW097
     C***********          MOVELSSR2      MGS2R2                   CSW005 CSW097
     C***********          MOVELSSR3      MGS2R3                   CSW005 CSW097
     C***********          MOVELSSR4      MGS2R4                   CSW005 CSW097
     C***********          MOVELSSR5      MGS2R5                   CSW005 CSW097
     C***********          MOVELSSR6      MGS2R6                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Sequence*B*-*Their*fixed*rate.***************************CSW005 CSW097
     C***********TIPFR     IFEQ 'C'                                CSW005 CSW097
     C***********          Z-ADD*ZERO     MGBFXR                   CSW005 CSW097
     C***********          ELSE                                    CSW005 CSW097
     C***********TBRTT     IFEQ 00                                 CSW005 CSW097
     C***********          Z-ADDTRTSP     MGBFXR                   CSW005 CSW097
     C***********          ELSE                                    CSW005 CSW097
     C***********          Z-ADD*ZERO     MGBFXR                   CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Their*interest*calculation*method*narrative.*************CSW005 CSW097
     C***********          SELEC                                   CSW005 CSW097
     C***********TICBS     WHEQ 1                                  CSW005 CSW097
     C***********          MOVEATX#,6     MGTDCF                   CSW005 CSW097
     C***********TICBS     WHEQ 2                                  CSW005 CSW097
     C***********          MOVEATX#,7     MGTDCF                   CSW005 CSW097
     C***********TICBS     WHEQ 3                                  CSW005 CSW097
     C***********          MOVEATX#,8     MGTDCF                   CSW005 CSW097
     C***********TICBS     WHEQ 4                                  CSW005 CSW097
     C***********          MOVEL'4'       MGTDCF    P              CSW005 CSW097
     C***********TICBS     WHEQ 5                                  CSW005 CSW097
     C***********          MOVEL'5'       MGTDCF    P              CSW005 CSW097
     C***********TICBS     WHEQ 6                                  CSW005 CSW097
     C***********          MOVEATX#,9     MGTDCF                   CSW005 CSW097
     C***********          ENDSL                                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Sequence*C*-*Their*floating*rate*and*designated*maturity*CSW005 CSW097
      ****if*Their*Base*Rate*Type*is*not*zero.*********************CSW005 CSW097
      ****MGTFLO*and*MGTDSM*were*initialised*to*blanks.************CSW005 CSW097
     C***********TBRTT     IFGT 00                                 CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Access*Base*Rate*Code*Details****************************CSW005 CSW097
     C***********          MOVE TBRTT     @KEY2                    CSW005 CSW097
     C***********          CALL 'AOBSRTR0'                         CSW005 CSW097
     C***********          PARM '*MSG   ' @RTCD                    CSW005 CSW097
     C***********          PARM '*KEY   ' @OPTN                    CSW005 CSW097
     C***********          PARM TCUCY     @KEY3                    CSW005 CSW097
     C***********          PARM           @KEY2                    CSW005 CSW097
     C***********SDBSRT    PARM SDBSRT    DSSDY                    CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C***********@RTCD     IFEQ *BLANKS                            CSW005 CSW097
     C***********          MOVELBASCDD    MGTFLO                   CSW005 CSW097
     C***********          MOVELBADGMA    MGTDSM                   CSW005 CSW097
     C***********          ELSE                                    CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C***********          MOVEL@KEY3     @KEY5   5                CSW005 CSW097
     C***********          MOVE @KEY2     @KEY5                    CSW005 CSW097
     C************LOCK     IN   LDA                                CSW005 CSW097
     C***********          MOVE '018'     DBASE     * * * * * * * *CSW005 CSW097
     C***********          MOVEL@KEY5     DBKEY     * DB ERROR 18 *CSW005 CSW097
     C***********          MOVEL'SDBSRTPD'DBFILE    * * * * * * * *CSW005 CSW097
     C***********          OUT  LDA                                CSW005 CSW097
     C***********          EXSR *PSSR                              CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Their*business*day;*ISDA*financial*centre****************CSW005 CSW097
     C***********          MOVELMGTFLO    WTFLO9  9                CSW005 CSW097
     C***********          MOVELMGOFLO    WOFLO9  9                CSW005 CSW097
     C***********          MOVEATX#,10    W#STR9  9                CSW005 CSW097
     C***********WTFLO9    IFEQ W#STR9                             CSW005 CSW097
     C***********WOFLO9    OREQ W#STR9                             CSW005 CSW097
     C***********          MOVEATX#,11    MGTBSD                   CSW005 CSW097
     C***********          ELSE                                    CSW005 CSW097
     C***********TCUCY     IFEQ 'ECU'                              CSW005 CSW097
     C***********          MOVEL'ECU'     MGTBSD                   CSW005 CSW097
     C***********          ELSE                                    CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Access*Currency*Details**********************************CSW005 CSW097
     C***********          CALL 'AOCURRR0'                         CSW005 CSW097
     C***********          PARM '*MSG   ' @RTCD                    CSW005 CSW097
     C***********          PARM '*KEY   ' @OPTN                    CSW005 CSW097
     C***********          PARM TCUCY     @KEY3   3                CSW005 CSW097
     C***********SDCURR    PARM SDCURR    DSSDY                    CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C***********@RTCD     IFEQ *BLANKS                            CSW005 CSW097
     C***********          MOVELA6ISFC    MGTBSD                   CSW005 CSW097
     C***********          ELSE                                    CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C************LOCK     IN   LDA                                CSW005 CSW097
     C***********          MOVE '019'     DBASE     * * * * * * * *CSW005 CSW097
     C***********          MOVEL@KEY3     DBKEY     * DB ERROR 19 *CSW005 CSW097
     C***********          MOVEL'SDCURRPD'DBFILE    * * * * * * * *CSW005 CSW097
     C***********          OUT  LDA                                CSW005 CSW097
     C***********          EXSR *PSSR                              CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Their*initial*floating*rate,*spread,*initial*processing*mCSW005 CSW097
      ****initial*payment*frequency*code*and*rate*change*frequency*CSW005 CSW097
     C***********          Z-ADDTOBRT     MGTBSV                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C***********          SELEC                                   CSW005 CSW097
     C***********TSPIN     WHEQ 'A'                                CSW005 CSW097
     C***********          Z-ADDTRTSP     MGTSPD                   CSW005 CSW097
     C***********TSPIN     WHEQ 'S'                                CSW005 CSW097
     C***********          Z-SUBTRTSP     MGTSPD                   CSW005 CSW097
     C***********TSPIN     WHEQ 'P'                                CSW005 CSW097
     C***********TOBRT     DIV  100       WWRK   139               CSW005 CSW097
     C***********WWRK      MULT TRTSP     MGTSPD                   CSW005 CSW097
     C***********          ENDSL                                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C***********          MOVE TINPM     MGTCMP                   CSW005 CSW097
     C***********          MOVE TIPFR     MGTIPF                   CSW005 CSW097
     C***********          MOVE TICFR     MGTRCF                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Set*up*Our*compounding*indicator*************************CSW005 CSW097
     C***********CIR002    IFEQ 'Y'                                CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C***********TICFR     IFEQ 'M'                                CSW005 CSW097
     C***********TIPFR     IFEQ 'Q'                                CSW005 CSW097
     C***********TIPFR     OREQ 'X'                                CSW005 CSW097
     C***********TIPFR     OREQ 'Y'                                CSW005 CSW097
     C***********TIPFR     OREQ 'Z'                                CSW005 CSW097
     C***********TIPFR     OREQ 'M'                                CSW005 CSW097
     C***********TNICD     ANDNETNIPD                              CSW005 CSW097
     C***********          MOVE 'N'       MGTCPA                   CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
     C***********TICFR     IFEQ 'Q'                                CSW005 CSW097
     C***********TIPFR     IFEQ 'X'                                CSW005 CSW097
     C***********TIPFR     OREQ 'Y'                                CSW005 CSW097
     C***********TIPFR     OREQ 'Z'                                CSW005 CSW097
     C***********TIPFR     OREQ 'Q'                                CSW005 CSW097
     C***********TNICD     ANDNETNIPD                              CSW005 CSW097
     C***********          MOVE 'N'       MGTCPA                   CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
     C***********TICFR     IFEQ 'X'                                CSW005 CSW097
     C***********TIPFR     IFEQ 'Y'                                CSW005 CSW097
     C***********TIPFR     OREQ 'Z'                                CSW005 CSW097
     C***********TIPFR     OREQ 'X'                                CSW005 CSW097
     C***********TNICD     ANDNETNIPD                              CSW005 CSW097
     C***********          MOVE 'N'       MGTCPA                   CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
     C***********TICFR     IFEQ 'Y'                                CSW005 CSW097
     C***********TIPFR     IFEQ 'Z'                                CSW005 CSW097
     C***********TIPFR     OREQ 'Y'                                CSW005 CSW097
     C***********TNICD     ANDNETNIPD                              CSW005 CSW097
     C***********          MOVE 'N'       MGTCPA                   CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
     C***********TICFR     IFEQ 'Z'                                CSW005 CSW097
     C***********TIPFR     IFNE 'Z'                                CSW005 CSW097
     C***********          MOVE 'N'       MGTCPA                   CSW005 CSW097
     C***********          ELSE                                    CSW005 CSW097
      ****Partial*keys.**Note:**DDLNO*is*used*here.****************CSW005 CSW097
     C***********          MOVE 'T'       @OTIN                    CSW005 CSW097
     C***********          MOVE 'R'       @RCIP                    CSW005 CSW097
     C***********          Z-ADD*LOVAL    @PRDT                    CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C***********IRCKY2    SETLLDLDTSCD0               71          CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C************IN71     IFEQ '0'                                CSW005 CSW097
     C***********          READ DLDTSCD0               7170        CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Check*for*a*match*on*payment*date*for*each*rate*change*daCSW005 CSW097
     C************IN70     DOWEQ'0'                                CSW005 CSW097
     C************IN71     ANDEQ'0'                                CSW005 CSW097
     C***********DDLNO     ANDEQDLNO                               CSW005 CSW097
     C***********@OTIN     ANDEQOTIN                               CSW005 CSW097
     C***********@RCIP     ANDEQRCIP                               CSW005 CSW097
     C***********          MOVE 'P'       @RCIP                    CSW005 CSW097
     C***********          Z-ADDPRDT      @PRDT                    CSW005 CSW097
     C***********IRCKY2    CHAINDLDTSCD0             70            CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C************IN70     IFEQ '1'                                CSW005 CSW097
     C***********          MOVE 'N'       MGTCPA                   CSW005 CSW097
     C***********          ELSE                                    CSW005 CSW097
     C***********          MOVE 'R'       @RCIP                    CSW005 CSW097
     C***********          Z-ADDPRDT      @PRDT                    CSW005 CSW097
     C***********IRCKY2    SETGTDLDTSCD0                           CSW005 CSW097
     C***********          READ DLDTSCD0               7170        CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C***********          ENDDO                                   CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Sequence*E*-*Our*fixed*rate.**Note*MGEFXR*is*initially*zeCSW005 CSW097
     C***********UIPFR     IFEQ 'C'                                CSW005 CSW097
     C***********          Z-ADD*ZERO     MGEFXR                   CSW005 CSW097
     C***********          ELSE                                    CSW005 CSW097
     C***********UBRTT     IFEQ 00                                 CSW005 CSW097
     C***********          Z-ADDUEINR     MGEFXR                   CSW005 CSW097
     C***********          ELSE                                    CSW005 CSW097
     C***********          Z-ADD*ZERO     MGEFXR                   CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Our*interest*calculation*method*narrative.***************CSW005 CSW097
     C***********          SELEC                                   CSW005 CSW097
     C***********UICBS     WHEQ 1                                  CSW005 CSW097
     C***********          MOVEATX#,6     MGODCF                   CSW005 CSW097
     C***********UICBS     WHEQ 2                                  CSW005 CSW097
     C***********          MOVEATX#,7     MGODCF                   CSW005 CSW097
     C***********UICBS     WHEQ 3                                  CSW005 CSW097
     C***********          MOVEATX#,8     MGODCF                   CSW005 CSW097
     C***********UICBS     WHEQ 4                                  CSW005 CSW097
     C***********          MOVEL'4'       MGODCF    P              CSW005 CSW097
     C***********UICBS     WHEQ 5                                  CSW005 CSW097
     C***********          MOVEL'5'       MGODCF    P              CSW005 CSW097
     C***********UICBS     WHEQ 6                                  CSW005 CSW097
     C***********          MOVEATX#,9     MGODCF                   CSW005 CSW097
     C***********          ENDSL                                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Sequence*F*-*Our*floating*rate*and*designated*maturity***CSW005 CSW097
      ****if*Our*Base*Rate*Type*is*not*zero.***********************CSW005 CSW097
      ****MGOFLO*and*MGODSM*were*initialised*to*blanks.************CSW005 CSW097
     C***********UBRTT     IFGT 00                                 CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Access*Base*Rate*Code*Details****************************CSW005 CSW097
     C***********          MOVELUBRTT     @KEY2                    CSW005 CSW097
     C***********          CALL 'AOBSRTR0'                         CSW005 CSW097
     C***********          PARM '*MSG   ' @RTCD                    CSW005 CSW097
     C***********          PARM '*KEY   ' @OPTN                    CSW005 CSW097
     C***********          PARM UCUCY     @KEY3                    CSW005 CSW097
     C***********          PARM           @KEY2                    CSW005 CSW097
     C***********SDBSRT    PARM SDBSRT    DSSDY                    CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C***********@RTCD     IFEQ *BLANKS                            CSW005 CSW097
     C***********          MOVELBASCDD    MGOFLO                   CSW005 CSW097
     C***********          MOVELBADGMA    MGODSM                   CSW005 CSW097
     C***********          ELSE                                    CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C***********          MOVEL@KEY3     @KEY5   5                CSW005 CSW097
     C***********          MOVE @KEY2     @KEY5                    CSW005 CSW097
     C************LOCK     IN   LDA                                CSW005 CSW097
     C***********          MOVE '020'     DBASE     * * * * * * * *CSW005 CSW097
     C***********          MOVEL@KEY5     DBKEY     * DB ERROR 20 *CSW005 CSW097
     C***********          MOVEL'SDBSRTPD'DBFILE    * * * * * * * *CSW005 CSW097
     C***********          OUT  LDA                                CSW005 CSW097
     C***********          EXSR *PSSR                              CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Our*business*days.***************************************CSW005 CSW097
     C***********WOFLO9    IFEQ W#STR9                             CSW005 CSW097
     C***********WTFLO9    OREQ W#STR9                             CSW005 CSW097
     C***********          MOVEATX#,11    MGOBSD                   CSW005 CSW097
     C***********          ELSE                                    CSW005 CSW097
     C***********UCUCY     IFEQ 'ECU'                              CSW005 CSW097
     C***********          MOVEL'ECU'     MGOBSD                   CSW005 CSW097
     C***********          ELSE                                    CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Access*Currency*Details**********************************CSW005 CSW097
     C***********          CALL 'AOCURRR0'                         CSW005 CSW097
     C***********          PARM '*MSG   ' @RTCD                    CSW005 CSW097
     C***********          PARM '*KEY   ' @OPTN                    CSW005 CSW097
     C***********          PARM UCUCY     @KEY3                    CSW005 CSW097
     C***********SDCURR    PARM SDCURR    DSSDY                    CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C***********@RTCD     IFEQ *BLANKS                            CSW005 CSW097
     C***********          MOVELA6ISFC    MGOBSD                   CSW005 CSW097
     C***********          ELSE                                    CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C************LOCK     IN   LDA                                CSW005 CSW097
     C***********          MOVE '021'     DBASE     * * * * * * * *CSW005 CSW097
     C***********          MOVEL@KEY3     DBKEY     * DB ERROR 21 *CSW005 CSW097
     C***********          MOVEL'SDCURRPD'DBFILE    * * * * * * * *CSW005 CSW097
     C***********          OUT  LDA                                CSW005 CSW097
     C***********          EXSR *PSSR                              CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Our*initial*floating*rate,*spread,*initial*processing*metCSW005 CSW097
      ****initial*payment*frequency*code*and*rate*change*frequency*CSW005 CSW097
     C***********          Z-ADDUOBRT     MGOBSV                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C***********          SELEC                                   CSW005 CSW097
     C***********USPIN     WHEQ 'A'                                CSW005 CSW097
     C***********          Z-ADDURTSP     MGOSPD                   CSW005 CSW097
     C***********USPIN     WHEQ 'S'                                CSW005 CSW097
     C***********          Z-SUBURTSP     MGOSPD                   CSW005 CSW097
     C***********USPIN     WHEQ 'P'                                CSW005 CSW097
     C***********UOBRT     DIV  100       WWRK                     CSW005 CSW097
     C***********WWRK      MULT URTSP     MGOSPD                   CSW005 CSW097
     C***********          ENDSL                                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C***********          MOVE UINPM     MGOCMP                   CSW005 CSW097
     C***********          MOVE UIPFR     MGOIPF                   CSW005 CSW097
     C***********          MOVE UICFR     MGORCF                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Set*up*Our*compounding*indicator*************************CSW005 CSW097
     C***********CIR002    IFEQ 'Y'                                CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C***********UICFR     IFEQ 'M'                                CSW005 CSW097
     C***********UIPFR     IFEQ 'Q'                                CSW005 CSW097
     C***********UIPFR     OREQ 'X'                                CSW005 CSW097
     C***********UIPFR     OREQ 'Y'                                CSW005 CSW097
     C***********UIPFR     OREQ 'Z'                                CSW005 CSW097
     C***********UIPFR     OREQ 'M'                                CSW005 CSW097
     C***********UNICD     ANDNEUNIPD                              CSW005 CSW097
     C***********          MOVE 'N'       MGOCPA                   CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
     C***********UICFR     IFEQ 'Q'                                CSW005 CSW097
     C***********UIPFR     IFEQ 'X'                                CSW005 CSW097
     C***********UIPFR     OREQ 'Y'                                CSW005 CSW097
     C***********UIPFR     OREQ 'Z'                                CSW005 CSW097
     C***********UIPFR     OREQ 'Q'                                CSW005 CSW097
     C***********UNICD     ANDNEUNIPD                              CSW005 CSW097
     C***********          MOVE 'N'       MGOCPA                   CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
     C***********UICFR     IFEQ 'X'                                CSW005 CSW097
     C***********UIPFR     IFEQ 'Y'                                CSW005 CSW097
     C***********UIPFR     OREQ 'Z'                                CSW005 CSW097
     C***********UIPFR     OREQ 'X'                                CSW005 CSW097
     C***********UNICD     ANDNEUNIPD                              CSW005 CSW097
     C***********          MOVE 'N'       MGOCPA                   CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
     C***********UICFR     IFEQ 'Y'                                CSW005 CSW097
     C***********UIPFR     IFEQ 'Z'                                CSW005 CSW097
     C***********UIPFR     OREQ 'Y'                                CSW005 CSW097
     C***********UNICD     ANDNEUNIPD                              CSW005 CSW097
     C***********          MOVE 'N'       MGOCPA                   CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
     C***********UICFR     IFEQ 'Z'                                CSW005 CSW097
     C***********UIPFR     IFNE 'Z'                                CSW005 CSW097
     C***********          MOVE 'N'       MGOCPA                   CSW005 CSW097
     C***********          ELSE                                    CSW005 CSW097
      ****Partial*keys.**Note:**DDLNO*is*used*here.****************CSW005 CSW097
     C***********          MOVE 'U'       @OTIN                    CSW005 CSW097
     C***********          MOVE 'R'       @RCIP                    CSW005 CSW097
     C***********          Z-ADD*LOVAL    @PRDT                    CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C***********IRCKY2    SETLLDLDTSCD0               71          CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C************IN71     IFEQ '0'                                CSW005 CSW097
     C***********          READ DLDTSCD0               7170        CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Check*for*a*match*on*payment*date*for*each*rate*change*daCSW005 CSW097
     C************IN70     DOWEQ'0'                                CSW005 CSW097
     C************IN71     ANDEQ'0'                                CSW005 CSW097
     C***********DDLNO     ANDEQDLNO                               CSW005 CSW097
     C***********@OTIN     ANDEQOTIN                               CSW005 CSW097
     C***********@RCIP     ANDEQRCIP                               CSW005 CSW097
     C***********          MOVE 'P'       @RCIP                    CSW005 CSW097
     C***********          Z-ADDPRDT      @PRDT                    CSW005 CSW097
     C***********IRCKY2    CHAINDLDTSCD0             70            CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C************IN70     IFEQ '1'                                CSW005 CSW097
     C***********          MOVE 'N'       MGOCPA                   CSW005 CSW097
     C***********          ELSE                                    CSW005 CSW097
     C***********          MOVE 'R'       @RCIP                    CSW005 CSW097
     C***********          Z-ADDPRDT      @PRDT                    CSW005 CSW097
     C***********IRCKY2    SETGTDLDTSCD0                           CSW005 CSW097
     C***********          READ DLDTSCD0               7170        CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C***********          ENDDO                                   CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Sequence*N*-*Their*up-front*fee*amount*******************CSW005 CSW097
     C***********UPPR      IFEQ 'R'                                CSW005 CSW097
     C***********          Z-ADDUPFE      MGTUFF                   CSW005 CSW097
     C***********          ELSE                                    CSW005 CSW097
     C***********          Z-ADD*ZERO     MGTUFF                   CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Sequence*O*-*Their*up-front*fee*amount*******************CSW005 CSW097
     C***********UPPR      IFEQ 'P'                                CSW005 CSW097
     C***********          Z-ADDUPFE      MGOUFF                   CSW005 CSW097
     C***********          ELSE                                    CSW005 CSW097
     C***********          Z-ADD*ZERO     MGOUFF                   CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Up-front*value*date**************************************CSW005 CSW097
     C***********          Z-ADDUPVD      MGUPVD                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Write*record*********************************************CSW005 CSW097
     C***********          WRITEMGX360D0                           CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Create*iterative*sequence*to*MGY36NPD.*******************CSW005 CSW097
     C***********          EXSR Y36N                               CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Create*iterative*sequence*to*MGZ36NPD*(Sequence*H)*******CSW005 CSW097
     C***********          MOVEL*BLANKS   WOTIN                    CSW005 CSW097
     C***********          EXSR Z36N                               CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C***********          ENDSR                                   CSW005 CSW097
      *************************************************************CSW005 CSW097
     C/EJECT                                                              CSW097
      *****************************************************************   CSW097
      *   SRU36N - Format FRAIRS Financial Centre Details             *   CSW097
      *   Called by - F360FR, F360RS, F361                            *   CSW097
      *   Calls -                                                     *   CSW097
      *****************************************************************   CSW097
      *                                                                   CSW097
     C           SRU36N    BEGSR                                          CSW097
      *                                                                   CSW097
      ** Initialise array MSEQ and array index (X)                        CSW097
     C                     Z-ADD1         X                               CSW097
     C                     MOVE *BLANKS   MSEQ                            CSW097
      *                                                                   CSW097
      ** For FR deals, two records will always be output. The sequence    CSW097
      ** in the MT360 message in which they will appear depend on         CSW097
      ** wether the FRA is bought or sold as follows:                     CSW097
      **    o Bought FRA - Sequences C and E                              CSW097
      **    o Sell FRA   - Sequences B and F                              CSW097
     C           DTYP      IFEQ 'FR'                                      CSW097
     C           BYSL      IFEQ 'B'                                       CSW097
     C                     MOVEA'CE'      MSEQ,X                          CSW097
     C                     ELSE                                           CSW097
     C                     MOVEA'BF'      MSEQ,X                          CSW097
     C                     ENDIF                                          CSW097
     C                     ENDIF                                          CSW097
      ** For RS Deal                                                      CSW097
      **    o Their side is fixed     - Sequence B                        CSW097
      **    o Their side is floating  - Sequence C                        CSW097
      **    o Our side is fixed       - Sequence E                        CSW097
      **    o Our side is floating    - Sequence F                        CSW097
      **    o Prin Change Schedule exists - Sequence H                    CSW097
      **      (if Our and  Their ISDA Financial Centre are different,     CSW097
      **       2 records will be output to MGU36NPD)                      CSW097
      **    o Up-front Fee is receivable  - Sequence L                    CSW097
      **    o Up-front Fee is payable     - Sequence M                    CSW097
      *                                                                   CSW097
     C           DTYP      IFEQ 'RS'                                      CSW097
      *                                                                   CSW097
     C********** TBRTT     IFEQ 00                                        CSW097              CSD103
     C           TBRTT     IFEQ *BLANKS                                                       CSD103
     C                     MOVE 'B'       MSEQ,X                          CSW097
     C                     ADD  1         X                               CSW097
     C                     ELSE                                           CSW097
     C                     MOVE 'C'       MSEQ,X                          CSW097
     C                     ADD  1         X                               CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
     C********** UBRTT     IFEQ 00                                        CSW097              CSD103
     C           UBRTT     IFEQ *BLANKS                                                       CSD103
     C                     MOVE 'E'       MSEQ,X                          CSW097
     C                     ADD  1         X                               CSW097
     C                     ELSE                                           CSW097
     C                     MOVE 'F'       MSEQ,X                          CSW097
     C                     ADD  1         X                               CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
     C                     MOVE ' '       WOTIN                           CSW097
     C           AMRKY     CHAINDLPCSCPD             70                   CSW097
     C           *IN70     IFEQ '0'                                       CSW097
     C                     MOVE 'H'       MSEQ,X                          CSW097
     C                     ADD  1         X                               CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
     C           UPPR      IFEQ 'R'                                       CSW097
     C                     MOVE 'L'       MSEQ,X                          CSW097
     C                     ADD  1         X                               CSW097
     C                     ELSE                                           CSW097
     C           UPPR      IFEQ 'P'                                       CSW097
     C                     MOVE 'M'       MSEQ,X                          CSW097
     C                     ADD  1         X                               CSW097
     C                     ENDIF                                          CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
     C                     ENDIF                                          CSW097
      ** For RX Deal                                                      CSW097
      **    o Their side is fixed     - Sequence B                        CSW097
      **    o Their side is floating  - Sequence C                        CSW097
      **    o Our side is fixed       - Sequence E                        CSW097
      **    o Our side is floating    - Sequence F                        CSW097
      **    o Their Prin Change Schedule exists - Sequence H              CSW097
      **    o Our Prin Change Schedule exists - Sequence I                CSW097
      **    o Their Prin Exchange Schedule exists - Sequence J            CSW097
      **    o Our Prin Exchange Schedule exists - Sequence K              CSW097
      **    o Up-front Fee is receivable  - Sequence L                    CSW097
      **    o Up-front Fee is payable     - Sequence M                    CSW097
     C           DTYP      IFEQ 'RX'                                      CSW097
      *                                                                   CSW097
     C********** TBRTT     IFEQ 00                                        CSW097              CSD103
     C           TBRTT     IFEQ *BLANKS                                                       CSD103
     C                     MOVE 'B'       MSEQ,X                          CSW097
     C                     ADD  1         X                               CSW097
     C                     ELSE                                           CSW097
     C                     MOVE 'C'       MSEQ,X                          CSW097
     C                     ADD  1         X                               CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
     C********** UBRTT     IFEQ 00                                        CSW097              CSD103
     C           UBRTT     IFEQ *BLANKS                                                       CSD103
     C                     MOVE 'E'       MSEQ,X                          CSW097
     C                     ADD  1         X                               CSW097
     C                     ELSE                                           CSW097
     C                     MOVE 'F'       MSEQ,X                          CSW097
     C                     ADD  1         X                               CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
     C                     MOVE 'T'       WOTIN                           CSW097
     C           AMRKY     CHAINDLPCSCPD             70                   CSW097
     C           *IN70     IFEQ '0'                                       CSW097
      *                                                                                     MD034496
      ** SWIFT 2015 Change: Re-label sequences H-O to I-P for MT361                         MD034496
      *                                                                                     MD034496
     C           CSW215    IFEQ 'Y'                                                         MD034496
     C           @TYP      ANDEQ'361'                                                       MD034496
     C                     MOVE 'I'       MSEQ,X                                            MD034496
     C                     ELSE                                                             MD034496
     C                     MOVE 'H'       MSEQ,X                          CSW097
     C                     ENDIF                                                            MD034496
     C                     ADD  1         X                               CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
     C                     MOVE 'U'       WOTIN                           CSW097
     C           AMRKY     CHAINDLPCSCPD             70                   CSW097
     C           *IN70     IFEQ '0'                                       CSW097
      *                                                                                     MD034496
      ** SWIFT 2015 Change: Re-label sequences H-O to I-P for MT361                         MD034496
      *                                                                                     MD034496
     C           CSW215    IFEQ 'Y'                                                         MD034496
     C           @TYP      ANDEQ'361'                                                       MD034496
     C                     MOVE 'J'       MSEQ,X                                            MD034496
     C                     ELSE                                                             MD034496
     C                     MOVE 'I'       MSEQ,X                          CSW097
     C                     ENDIF                                                            MD034496
     C                     ADD  1         X                               CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
     C           VDEI      IFEQ 'Y'                                       CSW097
     C           MDEI      OREQ 'Y'                                       CSW097
      *                                                                                     MD034496
      ** SWIFT 2015 Change: Re-label sequences H-O to I-P for MT361                         MD034496
      *                                                                                     MD034496
     C           CSW215    IFEQ 'Y'                                                         MD034496
     C           @TYP      ANDEQ'361'                                                       MD034496
     C                     MOVEA'KL'      MSEQ,X                                            MD034496
     C                     ELSE                                                             MD034496
     C                     MOVEA'JK'      MSEQ,X                          CSW097
     C                     ENDIF                                                            MD034496
     C                     ADD  2         X                               CSW097
     C                     ELSE                                           CSW097
      *                                                                   CSW097
     C           VDEI      IFNE 'Y'                                       CSW097
     C           MDEI      ANDNE'Y'                                       CSW097
     C           PDEI      ANDEQ'Y'                                       CSW097
     C                     MOVE 'T'       WOTIN                           CSW097
     C           AMRKY     CHAINDLPCSCPD             70                   CSW097
     C           *IN70     IFEQ '0'                                       CSW097
      *                                                                                     MD034496
      ** SWIFT 2015 Change: Re-label sequences H-O to I-P for MT361                         MD034496
      *                                                                                     MD034496
     C           CSW215    IFEQ 'Y'                                                         MD034496
     C           @TYP      ANDEQ'361'                                                       MD034496
     C                     MOVE 'K'       MSEQ,X                                            MD034496
     C                     ELSE                                                             MD034496
     C                     MOVE 'J'       MSEQ,X                          CSW097
     C                     ENDIF                                                            MD034496
     C                     ADD  1         X                               CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
     C                     MOVE 'U'       WOTIN                           CSW097
     C           AMRKY     CHAINDLPCSCPD             70                   CSW097
     C           *IN70     IFEQ '0'                                       CSW097
      *                                                                                     MD034496
      ** SWIFT 2015 Change: Re-label sequences H-O to I-P for MT361                         MD034496
      *                                                                                     MD034496
     C           CSW215    IFEQ 'Y'                                                         MD034496
     C           @TYP      ANDEQ'361'                                                       MD034496
     C                     MOVE 'L'       MSEQ,X                                            MD034496
     C                     ELSE                                                             MD034496
     C                     MOVE 'K'       MSEQ,X                          CSW097
     C                     ENDIF                                                            MD034496
     C                     ADD  1         X                               CSW097
     C                     ENDIF                                          CSW097
     C                     ENDIF                                          CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
     C           UPPR      IFEQ 'R'                                       CSW097
      *                                                                                     MD034496
      ** SWIFT 2015 Change: Re-label sequences H-O to I-P for MT361                         MD034496
      *                                                                                     MD034496
     C           CSW215    IFEQ 'Y'                                                         MD034496
     C           @TYP      ANDEQ'361'                                                       MD034496
     C                     MOVE 'M'       MSEQ,X                                            MD034496
     C                     ELSE                                                             MD034496
     C                     MOVE 'L'       MSEQ,X                          CSW097
     C                     ENDIF                                                            MD034496
     C                     ADD  1         X                               CSW097
     C                     ELSE                                           CSW097
     C           UPPR      IFEQ 'P'                                       CSW097
      *                                                                                     MD034496
      ** SWIFT 2015 Change: Re-label sequences H-O to I-P for MT361                         MD034496
      *                                                                                     MD034496
     C           CSW215    IFEQ 'Y'                                                         MD034496
     C           @TYP      ANDEQ'361'                                                       MD034496
     C                     MOVE 'N'       MSEQ,X                                            MD034496
     C                     ELSE                                                             MD034496
     C                     MOVE 'M'       MSEQ,X                          CSW097
     C                     ENDIF                                                            MD034496
     C                     ADD  1         X                               CSW097
     C                     ENDIF                                          CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
     C                     Z-ADD1         X       20                      CSW097
     C           MSEQ,X    DOWNE*BLANK                                    CSW097
     C           X         ANDLE10                                        CSW097
      *                                                                   CSW097
     C                     MOVE *BLANK    W#CYCD  3                       CSW097
     C                     MOVE *BLANK    W#SETM  2                       CSW097
     C                     MOVE *BLANK    W#NOSN  2                       CSW097
      *                                                                   CSW097
     C           DTYP      IFEQ 'RX'                                      CSW097
      *                                                                   CSW097
      ** Our Side                                                         CSW097
      ** SWIFT 2015 Change: Re-label sequences I,K,M to J,L,N                               MD034496
      *                                                                                     MD034496
     C           MSEQ,X    IFEQ 'E'                                       CSW097
     C           MSEQ,X    OREQ 'F'                                       CSW097
     C           MSEQ,X    OREQ 'I'                                       CSW097
     C           CSW215    ANDEQ'N'                                                         MD034496
     C           MSEQ,X    OREQ 'J'                                                         MD034496
     C           CSW215    ANDEQ'Y'                                                         MD034496
     C           MSEQ,X    OREQ 'K'                                       CSW097
     C           CSW215    ANDEQ'N'                                                         MD034496
     C           MSEQ,X    OREQ 'L'                                                         MD034496
     C           CSW215    ANDEQ'Y'                                                         MD034496
     C           MSEQ,X    OREQ 'M'                                       CSW097
     C           CSW215    ANDEQ'N'                                                         MD034496
     C           MSEQ,X    OREQ 'N'                                                         MD034496
     C           CSW215    ANDEQ'Y'                                                         MD034496
      *                                                                   CSW097
     C           PSCY      IFNE *BLANK                                    CSW097
     C                     MOVE PSCY      W#CYCD                          CSW097
     C                     ELSE                                           CSW097
     C                     MOVE UCUCY     W#CYCD                          CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
      ** Their Side                                                       CSW097
     C                     ELSE                                           CSW097
      *                                                                   CSW097
     C           RSCY      IFNE *BLANK                                    CSW097
     C                     MOVE RSCY      W#CYCD                          CSW097
     C                     ELSE                                           CSW097
     C                     MOVE TCUCY     W#CYCD                          CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
     C                     ENDIF                                          CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
     C           DTYP      IFEQ 'FR'                                      CSW097
     C           DTYP      OREQ 'RS'                                      CSW097
     C           PSCY      IFNE *BLANK                                    CSW097
     C                     MOVE PSCY      W#CYCD                          CSW097
     C                     ELSE                                           CSW097
     C                     MOVE UCUCY     W#CYCD                          CSW097
     C                     ENDIF                                          CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
      ** SWIFT 2015 Change: Re-label sequences I,K,M to J,L,N for MT361                     MD034496
      *                                                                                     MD034496
     C           MSEQ,X    IFEQ 'E'                                       CSW097
     C           MSEQ,X    OREQ 'F'                                       CSW097
     C           MSEQ,X    OREQ 'I'                                       CSW097
     C           @TYP      ANDEQ'360'                                                       MD034496
     C           MSEQ,X    OREQ 'I'                                                         MD034496
     C           CSW215    ANDEQ'N'                                                         MD034496
     C           MSEQ,X    OREQ 'J'                                                         MD034496
     C           CSW215    ANDEQ'Y'                                                         MD034496
     C           MSEQ,X    OREQ 'K'                                       CSW097
     C           @TYP      ANDEQ'360'                                                       MD034496
     C           MSEQ,X    OREQ 'K'                                                         MD034496
     C           CSW215    ANDEQ'N'                                                         MD034496
     C           MSEQ,X    OREQ 'L'                                                         MD034496
     C           CSW215    ANDEQ'Y'                                                         MD034496
     C           MSEQ,X    OREQ 'M'                                       CSW097
     C           @TYP      ANDEQ'360'                                                       MD034496
     C           MSEQ,X    OREQ 'M'                                                         MD034496
     C           CSW215    ANDEQ'N'                                                         MD034496
     C           MSEQ,X    OREQ 'N'                                                         MD034496
     C           CSW215    ANDEQ'Y'                                                         MD034496
     C***********          MOVE RSTM      W#SETM                   CSW097 182091
     C***********          MOVELRONS      W#NOSN                   CSW097 182091
     C                     MOVE PSTM      W#SETM                          182091
     C                     MOVELPONS      W#NOSN                          182091
     C                     ELSE                                           CSW097
     C***********          MOVE PSTM      W#SETM                   CSW097 182091
     C***********          MOVELPONS      W#NOSN                   CSW097 182091
     C                     MOVE RSTM      W#SETM                          182091
     C                     MOVELRONS      W#NOSN                          182091
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
     C                     EXSR SRFCTR                                    CSW097
      *                                                                   CSW097
     C                     ADD  1         X                               CSW097
     C                     ENDDO                                          CSW097
      *                                                                   CSW097
     C                     ENDSR                                          CSW097
      *****************************************************************   CSW097
     C/EJECT                                                              CSW097
      *****************************************************************   CSW097
      *   SRV36N - Format FRAIRS Compounding Details                  *   CSW097
      *   Called by - F360S, F361                                     *   CSW097
      *   Calls - SRCMPD                                              *   CSW097
      *****************************************************************   CSW097
      *                                                                   CSW097
     C           SRV36N    BEGSR                                          CSW097
      *                                                                   CSW097
     C********** TBRTT     IFNE 00                                        CSW097              CSD103
     C           TBRTT     IFNE *BLANKS                                                       CSD103
     C                     MOVE 'C'       MGMSSQ                          CSW097
      *                                                                   CSW097
     C                     MOVE TCUCY     W#CUCY  3                       CSW097
     C                     MOVE RSCY      W#STCY  3                       CSW097
      *                                                                   CSW097
     C                     MOVELURACC     W#NOSN  2                       CSW097
     C                     MOVE RSETM     W#SETM  2                       CSW097
     C                     MOVE TINPM     W#INPM  1                       CSW097
     C                     MOVE TIPFR     W#IPFR  1                       CSW097
     C                     Z-ADDTIPFD     W#IPFD  20                      CSW097
     C                     MOVE TICFR     W#ICFR  1                       CSW097
     C                     Z-ADDTICFD     W#ICFD  20                      CSW097
     C                     Z-ADDTNIPD     W#NIPD  50                      CSW097
     C                     Z-ADDTNICD     W#NICD  50                      CSW097
     C                     EXSR SRCMPD                                    CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
     C********** UBRTT     IFNE 00                                        CSW097              CSD103
     C           UBRTT     IFNE *BLANKS                                                       CSD103
     C                     MOVE 'F'       MGMSSQ                          CSW097
      *                                                                   CSW097
     C                     MOVE UCUCY     W#CUCY                          CSW097
     C                     MOVE PSCY      W#STCY                          CSW097
      *                                                                   CSW097
     C                     MOVELUPACC     W#NOSN                          CSW097
     C                     MOVE PSETM     W#SETM                          CSW097
     C                     MOVE UINPM     W#INPM                          CSW097
     C                     MOVE UIPFR     W#IPFR                          CSW097
     C                     Z-ADDUIPFD     W#IPFD                          CSW097
     C                     MOVE UICFR     W#ICFR                          CSW097
     C                     Z-ADDUICFD     W#ICFD                          CSW097
     C                     Z-ADDUNIPD     W#NIPD                          CSW097
     C                     Z-ADDUNICD     W#NICD                          CSW097
     C                     EXSR SRCMPD                                    CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
     C                     ENDSR                                          CSW097
      *****************************************************************   CSW097
     C/EJECT                                                              CSW097
      *****************************************************************   CSW097
      *   SRW36N - Format FRAIRS Principal Exchange Details           *   CSW097
      *   Called by - F361                                            *   CSW097
      *   Calls -                                                     *   CSW097
      *****************************************************************   CSW097
      *                                                                   CSW097
     C           SRW36N    BEGSR                                          CSW097
      *                                                                   CSW097
     C                     Z-ADD0         M@UAMT 150                      CSW097
     C                     Z-ADD0         M@TAMT 150                      CSW097
      *                                                                   CSW097
      ** Value Date Principal Exchange                                    CSW097
      *                                                                   CSW097
     C           VDEI      IFEQ 'Y'                                       CSW097
      *                                                                                     MD034496
      ** SWIFT 2015 Change: Re-label sequences H-O to I-P for MT361                         MD034496
      *                                                                                     MD034496
     C           CSW215    IFEQ 'Y'                                                         MD034496
     C           @TYP      ANDEQ'361'                                                       MD034496
     C                     MOVE 'K'       MGMSSQ                                            MD034496
     C                     ELSE                                                             MD034496
     C                     MOVE 'J'       MGMSSQ                          CSW097
     C                     ENDIF                                                            MD034496
      *                                                                                     MD034496
     C                     MOVE 'V'       MGTPEX                          CSW097
     C                     MOVE *BLANK    MGSTYP                          CSW097
     C                     Z-ADDDVDAT     MGPDAT                          CSW097
     C                     Z-ADDUPAMT     MGPAMT                          CSW097
     C                     MOVE UCUCY     MGXCCY                          CSW097
     C                     WRITEMGW36ND0                                  CSW097
      *                                                                   CSW097
     C           CSW215    IFEQ 'Y'                                                         MD003496
     C           @TYP      ANDEQ'361'                                                       MD003496
     C                     MOVE 'L'       MGMSSQ                                            MD034496
     C                     ELSE                                                             MD034496
     C                     MOVE 'K'       MGMSSQ                          CSW097
     C                     ENDIF                                                            MD034496
      *                                                                                     MD034496
     C                     MOVE 'V'       MGTPEX                          CSW097
     C                     MOVE *BLANK    MGSTYP                          CSW097
     C                     Z-ADDDVDAT     MGPDAT                          CSW097
     C                     Z-ADDTPAMT     MGPAMT                          CSW097
     C                     MOVE TCUCY     MGXCCY                          CSW097
     C                     WRITEMGW36ND0                                  CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
      ** Principal Change Schedule                                        CSW097
      *                                                                   CSW097
     C           PDEI      IFEQ 'Y'                                       CSW097
     C           PDEI      OREQ 'N'                                                          BUG7980
     C           MDEI      ANDEQ'Y'                                                          BUG7980
      *                                                                   CSW097
     C           DDLNO     SETLLDLPCSCPD                                  CSW097
     C           DDLNO     READEDLPCSCPD                 70               CSW097
     C           *IN70     DOWEQ'0'                                       CSW097
      *                                                                   CSW097
     C           PRDT      IFLT W#MDAT                                                       BUG7911
     C           OTIN      IFEQ 'U'                                       CSW097
     C                     Z-ADDPAMT      M@UAMT                          CSW097
     C                     ELSE                                           CSW097
     C                     Z-ADDPAMT      M@TAMT                          CSW097
     C                     ENDIF                                          CSW097
     C                     ENDIF                                                             BUG7911
      *                                                                   CSW097
      ** Get the previous/old principal
     C                     MOVE OTIN      @OTIN                           CSW097
     C                     MOVE OTIN      WOTIN                           CSW097
     C                     Z-ADDPRDT      @PRDT                           CSW097
     C                     MOVE 'N'       WFOUND  1                       CSW097
     C           IRCKY1    SETGTDLPCSCL0                                  CSW097
     C           AMRKY     REDPEDLPCSCL0                 72               CSW097
     C           *IN72     DOWEQ'0'                                       CSW097
     C           WFOUND    ANDEQ'N'                                       CSW097
     C           LPRDT     IFLT PRDT                                      CSW097
     C                     MOVE 'Y'       WFOUND                          CSW097
     C**********           ENDIF                                                      CSW097 BUG7882
     C                     ELSE                                                              BUG7882
     C           AMRKY     REDPEDLPCSCL0                 72               CSW097
     C                     ENDIF                                                             BUG7882
     C                     ENDDO                                          CSW097
      *                                                                   CSW097
      ** Get the difference between the current and old principal         CSW097
     C           WFOUND    IFEQ 'Y'                                       CSW097
     C           PAMT      SUB  LPAMT     W@DIFF 150                      CSW097
     C                     ELSE                                           CSW097
     C           OTIN      IFEQ 'U'                                       CSW097
     C           PAMT      SUB  UPAMT     W@DIFF                          CSW097
     C                     ELSE                                           CSW097
     C           PAMT      SUB  TPAMT     W@DIFF                          CSW097
     C                     ENDIF                                          CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
     C           W@DIFF    IFNE *ZERO                                     CSW097
      *                                                                   CSW097
     C           OTIN      IFEQ 'U'                                       CSW097
      *                                                                   CSW097
     C                     MOVE UCUCY     MGXCCY                          CSW097
     C           W@DIFF    IFGT *ZERO                                     CSW097
      *                                                                                     MD034496
      ** SWIFT 2015 Change: Re-label sequences H-O to I-P for MT361                         MD034496
      *                                                                                     MD034496
     C           CSW215    IFEQ 'Y'                                                         MD034496
     C           @TYP      ANDEQ'361'                                                       MD034496
     C                     MOVE 'K'       MGMSSQ                                            MD034496
     C                     ELSE                                                             MD034496
     C                     MOVE 'J'       MGMSSQ                          CSW097
     C                     ENDIF                                                            MD034496
      *                                                                                     MD034496
     C                     ELSE                                           CSW097
      *                                                                                     MD034496
     C           CSW215    IFEQ 'Y'                                                         MD034496
     C           @TYP      ANDEQ'361'                                                       MD034496
     C                     MOVE 'L'       MGMSSQ                                            MD034496
     C                     ELSE                                                             MD034496
     C                     MOVE 'K'       MGMSSQ                          CSW097
     C                     ENDIF                                                            MD034496
      *                                                                                     MD034496
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
     C                     ELSE                                           CSW097
      *                                                                   CSW097
     C                     MOVE TCUCY     MGXCCY                          CSW097
     C           W@DIFF    IFGT *ZERO                                     CSW097
      *                                                                                     MD034496
      ** SWIFT 2015 Change: Re-label sequences H-O to I-P for MT361                         MD034496
      *                                                                                     MD034496
     C           CSW215    IFEQ 'Y'                                                         MD034496
     C           @TYP      ANDEQ'361'                                                       MD034496
     C                     MOVE 'L'       MGMSSQ                                            MD034496
     C                     ELSE                                                             MD034496
     C                     MOVE 'K'       MGMSSQ                          CSW097
     C                     ENDIF                                                            MD034496
      *                                                                                     MD034496
     C                     ELSE                                           CSW097
      *                                                                                     MD034496
     C           CSW215    IFEQ 'Y'                                                         MD034496
     C           @TYP      ANDEQ'361'                                                       MD034496
     C                     MOVE 'K'       MGMSSQ                                            MD034496
     C                     ELSE                                                             MD034496
     C                     MOVE 'J'       MGMSSQ                          CSW097
     C                     ENDIF                                                            MD034496
      *                                                                                     MD034496
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
     C                     MOVE 'P'       MGTPEX                          CSW097
     C                     MOVE *BLANK    MGSTYP                          CSW097
     C                     Z-ADDPRDT      MGPDAT                          CSW097
     C                     Z-ADDW@DIFF    MGPAMT                          CSW097
      *                                                                                      BUG7911
     C           PRDT      IFLT W#MDAT                                                       BUG7911
      *                                                                                      BUG7980
     C           PDEI      IFEQ 'Y'                                                          BUG7980
     C                     WRITEMGW36ND0                                  CSW097
     C                     ENDIF                                                             BUG7980
     C                     ENDIF                                                             BUG7911
      *                                                                   CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
     C           DDLNO     READEDLPCSCPD                 70               CSW097
     C                     ENDDO                                          CSW097
      *                                                                   CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
      ** Maturity Date Principal Exchange                                 CSW097
      *                                                                   CSW097
     C           MDEI      IFEQ 'Y'                                       CSW097
      *                                                                                     MD034496
      ** SWIFT 2015 Change: Re-label sequences H-O to I-P for MT361                         MD034496
      *                                                                                     MD034496
     C           CSW215    IFEQ 'Y'                                                         MD034496
     C           @TYP      ANDEQ'361'                                                       MD034496
     C                     MOVE 'K'       MGMSSQ                                            MD034496
     C                     ELSE                                                             MD034496
     C                     MOVE 'J'       MGMSSQ                          CSW097
     C                     ENDIF                                                            MD034496
     C                     MOVE 'M'       MGTPEX                          CSW097
     C                     MOVE *BLANK    MGSTYP                          CSW097
     C**********           Z-ADDMDAT      MGPDAT                                      CSW097 BUG7911
     C                     Z-ADDW#MDAT    MGPDAT                                             BUG7911
     C           M@TAMT    IFNE *ZERO                                     CSW097
     C                     Z-ADDM@TAMT    MGPAMT                          CSW097
     C                     ELSE                                           CSW097
     C                     Z-ADDTPAMT     MGPAMT                          CSW097
     C                     ENDIF                                          CSW097
     C                     MOVE TCUCY     MGXCCY                          CSW097
     C                     WRITEMGW36ND0                                  CSW097
      *                                                                   CSW097
     C           CSW215    IFEQ 'Y'                                                         MD034496
     C           @TYP      ANDEQ'361'                                                       MD034496
     C                     MOVE 'L'       MGMSSQ                                            MD034496
     C                     ELSE                                                             MD034496
     C                     MOVE 'K'       MGMSSQ                          CSW097
     C                     ENDIF                                                            MD034496
     C                     MOVE 'M'       MGTPEX                          CSW097
     C                     MOVE *BLANK    MGSTYP                          CSW097
     C**********           Z-ADDMDAT      MGPDAT                                      CSW097 BUG7911
     C                     Z-ADDW#MDAT    MGPDAT                                             BUG7911
     C           M@UAMT    IFNE *ZERO                                     CSW097
     C                     Z-ADDM@UAMT    MGPAMT                          CSW097
     C                     ELSE                                           CSW097
     C                     Z-ADDUPAMT     MGPAMT                          CSW097
     C                     ENDIF                                          CSW097
     C                     MOVE UCUCY     MGXCCY                          CSW097
     C                     WRITEMGW36ND0                                  CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
     C                     ENDSR                                          CSW097
      *****************************************************************   CSW097
     C/EJECT                                                              CSW097
      *****************************************************************   CSW097
      *   SRX36N - Format FRAIRS Settlement Details                   *   CSW097
      *   Called by - F360FR, F360RS F361                             *   CSW097
      *   Calls -                                                     *   CSW097
      *****************************************************************   CSW097
      *                                                                   CSW097
     C           SRX36N    BEGSR                                          CSW097
      *                                                                   CSW097
      ** Note: Fields in MGX36NPD that are not present                    CSW097
      **       here are being set up in SR/COMFRA.                        CSW097
     C                     MOVE *BLANK    MGSTYP                          CSW097
     C                     MOVE POBR      MGPOBR                          CSW097
     C                     MOVE ROBR      MGROBR                          CSW097
     C                     MOVE PSTM      MGPSTM                          CSW097
     C                     MOVE RSTM      MGRSTM                          CSW097
      *                                                                   CSW097
     C           PSCY      IFNE *BLANK                                    CSW097
      *                                                                   CSW097
     C                     MOVE PSCY      MGPSCY                          CSW097
     C           DTYP      IFNE 'RX'                                      CSW097
     C                     MOVE PSCY      MGRSCY                          CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
     C                     ELSE                                           CSW097
     C                     MOVE UCUCY     MGPSCY                          CSW097
     C           DTYP      IFNE 'RX'                                      CSW097
     C                     MOVE UCUCY     MGRSCY                          CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
     C           DTYP      IFEQ 'RX'                                      CSW097
     C           RSCY      IFNE *BLANK                                    CSW097
     C                     MOVE RSCY      MGRSCY                          CSW097
     C                     ELSE                                           CSW097
     C                     MOVE TCUCY     MGRSCY                          CSW097
     C                     ENDIF                                          CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
     C                     WRITEMGX36ND0                                  CSW097
      *                                                                   CSW097
     C                     ENDSR                                          CSW097
      *****************************************************************   CSW097
      *                                                                   CSW097
     C/EJECT                                                              CSW097
      *                                                                   CSW097
      *****************************************************************   CSW005
      *   F361 - Format Message Specific fields for MT361             *   CSW005
      *   Called by - VALD                                            *   CSW005
      *   Calls -                                                     *   CSW005
      *****************************************************************   CSW005
      *                                                                   CSW005
     C           F361      BEGSR                                          CSW005
      *                                                                   CSW005
      **  Format fields for MT361                                         CSW005
      *                                                                   CSW005
      *                                                                   CSW005
      **  Sequence Number                                                 CSW005
     C                     ADD  1         MGSEQN                          CSW005
      *                                                                   CSW005
      **  Format Related reference                                        CSW005
      *                                                                   CSW005
     C           @RTNC     IFEQ 'C'                                       CSW005
     C                     MOVELPTRAN     MGRREF                          CSW005
     C                     ELSE                                           CSW005
     C                     MOVEL*BLANKS   MGRREF                          CSW005
     C                     ENDIF                                          CSW005
      *                                                                   CSW005
      **  Further Identification                                          CSW005
     C                     SELEC                                          CSW005
     C********** UBRTT     WHEQ 00                                        CSW005              CSD103
     C********** TBRTT     ANDEQ00                                        CSW005              CSD103
     C           UBRTT     WHEQ *BLANKS                                                       CSD103
     C           TBRTT     ANDEQ*BLANKS                                                       CSD103
     C***********          MOVEATX#,12    MGFUID                   CSW005 CSW097
     C           10        SUBSTTX#,12:1  MGFUID                          CSW097
     C********** UBRTT     WHEQ 00                                        CSW005              CSD103
     C********** TBRTT     ANDGT00                                        CSW005              CSD103
     C           UBRTT     WHEQ *BLANKS                                                       CSD103
     C           TBRTT     ANDNE*BLANKS                                                       CSD103
     C***********          MOVEATX#,13    MGFUID                   CSW005 CSW097
     C           10        SUBSTTX#,13:1  MGFUID                          CSW097
     C********** UBRTT     WHGT 00                                        CSW005              CSD103
     C********** TBRTT     ANDEQ00                                        CSW005              CSD103
     C           UBRTT     WHNE *BLANKS                                                       CSD103
     C           TBRTT     ANDEQ*BLANKS                                                       CSD103
     C***********          MOVEATX#,14    MGFUID                   CSW005 CSW097
     C           10        SUBSTTX#,14:1  MGFUID                          CSW097
     C********** UBRTT     WHGT 00                                        CSW005              CSD103
     C********** TBRTT     ANDGT00                                        CSW005              CSD103
     C           UBRTT     WHNE *BLANKS                                                       CSD103
     C           TBRTT     ANDNE*BLANKS                                                       CSD103
     C***********          MOVEATX#,15    MGFUID                   CSW005 CSW097
     C           10        SUBSTTX#,15:1  MGFUID                          CSW097
     C                     ENDSL                                          CSW005
      *                                                                   CSW005
      **  Transaction Date                                                CSW005
     C                     Z-ADDDDAT      MGTDAT                          CSW005
      *                                                                   CSW005
      **  Effective Date of Assignment                                    CSW005
     C                     Z-ADDDVDAT     MGADAT                          CSW005
      *                                                                   CSW005
      **  Business Day Convention                                         CSW005
     C***********          MOVEATX#,5     MGBDAC                   CSW005 CSW097
      *                                                                   CIR005
     C           CIR005    IFEQ 'Y'                                       CIR005
      *                                                                   CIR005
      ** Leg 1                                                            CIR005
      *                                                                   CIR005
     C                     SELEC                                          CIR005
     C           L1PDCN    WHEQ 'F'                                       CIR005
     C                     MOVEL@BDAC     MGBDAC                          CIR005
     C           L1PDCN    WHEQ 'P'                                       CIR005
     C                     MOVELWBDCP     MGBDAC                          CIR005
     C           L1PDCN    WHEQ 'MF'                                      CIR005
     C                     MOVELWBDCM     MGBDAC                          CIR005
     C                     OTHER                                          CIR005
     C                     MOVELWBDCO     MGBDAC                          CIR005
     C                     ENDSL                                          CIR005
      *                                                                   CIR005
      ** Leg 2                                                            CIR005
     C                     SELEC                                          CIR005
     C           L2PDCN    WHEQ 'F'                                       CIR005
     C                     MOVEL@BDAC     MGBDL2                          CIR005
     C           L2PDCN    WHEQ 'P'                                       CIR005
     C                     MOVELWBDCP     MGBDL2                          CIR005
     C           L2PDCN    WHEQ 'MF'                                      CIR005
     C                     MOVELWBDCM     MGBDL2                          CIR005
     C                     OTHER                                          CIR005
     C                     MOVELWBDCO     MGBDL2                          CIR005
     C                     ENDSL                                          CIR005
      *                                                                   CIR005
     C                     ELSE                                           CIR005
     C                     MOVEL@BDAC     MGBDAC                          CSW097
     C                     ENDIF                                          CIR005
      *                                                                   CSW005
      **  Our and Their currencies                                        CSW005
     C                     MOVELUCUCY     MGOCCY                          CSW005
     C                     MOVELTCUCY     MGTCCY                          CSW005
      *                                                                   CSW005
      ****Our/Their*Principal*Repayment*Applicable*Indicators**and CSW005 CSW097
      ****Amortising*Indicator*-*Only*if*Interest*Rate*Calendar*is CSW005 CSW097
      ****and*a*record*exists*in*the*Principal*Change*Calendar*fil CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C***********          MOVE 'N'       MGAMRT                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C***********CIR001    IFEQ 'Y'                                CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C***********          MOVEL'U'       WOTIN                    CSW005 CSW097
     C***********AMRKY     CHAINDLPCSCD0             70            CSW005 CSW097
     C************IN70     IFEQ *OFF                               CSW005 CSW097
     C***********          MOVELPDEI      MGOPRA                   CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C***********          MOVEL'T'       WOTIN                    CSW005 CSW097
     C***********AMRKY     CHAINDLPCSCD0             71            CSW005 CSW097
     C************IN71     IFEQ *OFF                               CSW005 CSW097
     C***********          MOVELPDEI      MGTPRA                   CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
      *                                                                   CSW005
      ***If*at*least*a*record*for*both*sides*exists,*set*AmortisingCSW005 CSW097
      ***indicator*to*'Y'.*                                        CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C************IN70     IFEQ *OFF                               CSW005 CSW097
     C************IN71     ANDEQ*OFF                               CSW005 CSW097
     C***********          MOVEL'Y'       MGAMRT                   CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
      *                                                                   CSW005
     C***********          ENDIF                                          CSW005
      *                                                                   CSW005
     C           ISDA      IFEQ *ZEROS                                    CSW005
     C           AGTY      ANDEQ*BLANK                             CSW005 CSW097
     C           AGDT      ANDEQ*ZEROS                             CSW005 CSW097
     C           AGVV      ANDEQ*ZEROS                             CSW005 CSW097
     C           AGVC      ANDEQ*ZEROS                             CSW005 CSW097
     C                     EXSR ISDAD                                     CSW005
     C                     ELSE                                           CSW005
      **  Version of ISDA                                                 CSW005
     C                     Z-ADDISDA      MGISDA                          CSW005
      *                                                                   CSW005
      **  Type of ISDA agreement                                          CSW005
     C                     MOVELAGTY      MGAGTY                          CSW005
      *                                                                   CSW005
      **  Date of ISDA agreement                                          CSW005
     C***********          Z-ADDAGDT      MGAGDT                   CSW005 CSW097
     C                     MOVE AGDT      ZAGDT                           CSW097
     C                     EXSR SRAGDT                                    CSW097
     C                     Z-ADD@@VDT     MGAGDT                          CSW097
      *                                                                   CSW005
      **  Version of ISDA agreement                                       CSW005
     C******               Z-ADDAGVV      MGAGVV                   CSW005 CSW097
     C                     MOVE AGVV      ZZ0004                          CSW097
     C                     MOVELAGVC      ZZ0004                          CSW097
     C                     MOVE ZZ0004    MGAGVV                          CSW097
     C                     ENDIF                                          CSW005
      *                                                                   CSW005
      **  Our and Their Notional Amounts                                  CSW005
     C                     Z-ADDUOPAM     MGONAM                          CSW005
     C                     Z-ADDTOPAM     MGTNAM                          CSW005
      *                                                                   CSW005
      **  Condition lines                                                 CSW005
     C                     MOVELCND1      MGCON1                          CSW005
     C                     MOVELCND2      MGCON2                          CSW005
     C                     MOVELCND3      MGCON3                          CSW005
     C                     MOVELCND4      MGCON4                          CSW005
     C                     MOVELCND5      MGCON5                          CSW005
     C                     MOVELCND6      MGCON6                          CSW005
      *                                                                   CSW005
     C           CIR014    IFEQ 'Y'                                                           CIR014
     C                     MOVE DDLNO     KDDLNO  6                                           CIR014
     C           KDDLNO    CHAINDLDLDGLM             55                                       CIR014
     C           *IN55     IFEQ *OFF                                                          CIR014
     C           F1PRVI    IFEQ 'O'                                                           CIR014
     C                     Z-ADDF1NPRI    MGONAM                                              CIR014
     C                     ENDIF                                                              CIR014
     C           F1PRVI    IFEQ 'T'                                                           CIR014
     C                     Z-ADDF1NPRI    MGTNAM                                              CIR014
     C                     ENDIF                                                              CIR014
     C                     ENDIF                                                              CIR014
     C                     ENDIF                                                              CIR014
      ****Contact*name*and*telephone*no.*from*Customer*Details.**  CSW005 CSW097
      ****If*it*has*no*Account*Officer*details,*fields*are*blanks  CSW005 CSW097
      ****because*they*are*initialised*in*SR/SETF.***************  CSW005 CSW097
     C***********          MOVELCNUM      W#CNUM                   CSW005 CSW097
     C***********          MOVE *BLANKS   @KEY1                    CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C***********          CALL 'AOCUSTR0'                         CSW005 CSW097
     C***********          PARM '*MSG   ' @RTCD                    CSW005 CSW097
     C***********          PARM '*KEY   ' @OPTN                    CSW005 CSW097
     C***********          PARM W#CNUM    @KEY1                    CSW005 CSW097
     C***********          PARM *BLANKS   @KYST                    CSW005 CSW097
     C***********SDCUST    PARM SDCUST    DSSDY                    CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C***********@RTCD     IFNE *BLANKS                            CSW005 CSW097
     C************LOCK     IN   LDA                                CSW005 CSW097
     C***********          MOVE '022'     DBASE     * * * * * * * *CSW005 CSW097
     C***********          MOVELW#CNUM    DBKEY     * DB ERROR 22 *CSW005 CSW097
     C***********          MOVEL'SDCUSTPD'DBFILE    * * * * * * * *CSW005 CSW097
     C***********          OUT  LDA                                CSW005 CSW097
     C***********          EXSR *PSSR                              CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C***********@RTCD     IFEQ *BLANKS                            CSW005 CSW097
     C***********BBACOC    ANDNE*BLANKS                            CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Access*Account*Officer*Details                           CSW005 CSW097
     C***********          CALL 'AOACOFR0'                         CSW005 CSW097
     C***********          PARM '*MSG   ' @RTCD                    CSW005 CSW097
     C***********          PARM '*KEY   ' @OPTN                    CSW005 CSW097
     C***********          PARM BBACOC    @KEY2                    CSW005 CSW097
     C***********SDACOF    PARM SDACOF    DSSDY                    CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C***********@RTCD     IFNE *BLANKS                            CSW005 CSW097
     C************LOCK     IN   LDA                                CSW005 CSW097
     C***********          MOVE '036'     DBASE     * * * * * * * *CSW005 CSW097
     C***********          MOVELBBACOC    DBKEY     * DB ERROR 36 *CSW005 CSW097
     C***********          MOVEL'SDACOFPD'DBFILE    * * * * * * * *CSW005 CSW097
     C***********          OUT  LDA                                CSW005 CSW097
     C***********          EXSR *PSSR                              CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C***********@RTCD     IFEQ *BLANKS                            CSW005 CSW097
     C***********          MOVELAZACON    MGCTC1                   CSW005 CSW097
     C***********          MOVELAZAPHN    MGCTC2                   CSW005 CSW097
     C***********          MOVELAZAEXT    MGCTC3                   CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
      *                                                                   CSW097
      **  Collateral Agreement Indicator                                  CSW097
     C                     MOVELCAIN      MGCAIN                          CSW097
      *                                                                   CSW005
      **  Sender-to-Receiver Information lines                            CSW005
     C                     MOVELDSR1      MGS2R1                          CSW005
     C                     MOVELDSR2      MGS2R2                          CSW005
     C                     MOVELDSR3      MGS2R3                          CSW005
     C                     MOVELDSR4      MGS2R4                          CSW005
     C                     MOVELDSR5      MGS2R5                          CSW005
     C                     MOVELDSR6      MGS2R6                          CSW005
      *                                                                   CSW005
      **  Sequence B - Their fixed rate.                                  CSW005
     C***********TIPFR     IFEQ 'C'                                CSW005 CSW097
     C***********          Z-ADD*ZERO     MGBFXR                   CSW005 CSW097
     C***********          ELSE                                    CSW005 CSW097
     C********** TBRTT     IFEQ 00                                        CSW005              CSD103
     C           TBRTT     IFEQ *BLANKS                                                       CSD103
     C                     Z-ADDTEINR     MGBFXR                          CSW005
     C                     ELSE                                           CSW005
     C                     Z-ADD*ZERO     MGBFXR                          CSW005
     C                     ENDIF                                          CSW005
     C***********          ENDIF                                   CSW005 CSW097
      *                                                                   CSW005
      **  Their interest calculation method narrative.                    CSW005
     C                     SELEC                                          CSW005
     C           TICBS     WHEQ 1                                         CSW005
     C                     MOVEATX#,6     MGTDCF                          CSW005
     C           TICBS     WHEQ 2                                         CSW005
     C                     MOVEATX#,7     MGTDCF                          CSW005
     C           TICBS     WHEQ 3                                         CSW005
     C/COPY WNCPYSRC,DL6305C076                                           LHX010
     C                     MOVEATX#,16    MGTDCF                          183212
     C***********TICBS     OREQ 7                                  CIR004 183212
     C           TICBS     WHEQ 7                                         183212
     C           CIR004    ANDEQ'Y'                                       CIR004
     C                     MOVEATX#,8     MGTDCF                          CSW005
     C           TICBS     WHEQ 4                                         CSW005
     C           TICBS     OREQ 5                                         CSW005
     C           TICBS     OREQ 9                                         CIR013
     C***********          MOVEL'4'       MGTDCF    P              CSW005 CSW097
     C                     MOVE TICBS     W@TDCF                          CSW097
     C                     MOVELW@TDCF    MGTDCF                          CSW097
     C***********TICBS     WHEQ 5                                  CSW005 CSW097
     C***********          MOVEL'5'       MGTDCF    P              CSW005 CSW097
     C           TICBS     WHEQ 6                                         CSW005
     C                     MOVEATX#,9     MGTDCF                          CSW005
     C                     ENDSL                                          CSW005
      *                                                                   CSW005
      **  Sequence C - Their floating rate and designated maturity        CSW005
      **  if Their Base Rate Type is not zero.                            CSW005
      **  MGTFLO and MGTDSM were initialised to blanks.                   CSW005
     C********** TBRTT     IFGT 00                                        CSW005              CSD103
     C           TBRTT     IFNE *BLANKS                                                       CSD103
      *                                                                   CSW005
      **  Access Base Rate Code Details                                   CSW005
     C                     MOVELTBRTT     @KEY2                           CSW005
     C                     CALL 'AOBSRTR0'                                CSW005
     C                     PARM '*MSG   ' @RTCD                           CSW005
     C                     PARM '*KEY   ' @OPTN                           CSW005
     C                     PARM TCUCY     @KEY3                           CSW005
     C                     PARM           @KEY2                           CSW005
     C           SDBSRT    PARM SDBSRT    DSSDY                           CSW005
      *                                                                   CSW005
     C           @RTCD     IFEQ *BLANKS                                   CSW005
     C                     MOVELBASCDD    MGTFLO                          CSW005
     C                     MOVELBADGMA    MGTDSM                          CSW005
     C                     ELSE                                           CSW005
      *                                                                   CSW005
     C                     MOVEL@KEY3     @KEY5                           CSW005
     C                     MOVE @KEY2     @KEY5                           CSW005
     C           *LOCK     IN   LDA                                       CSW005
     C                     MOVE '023'     DBASE            * * * * * * * *CSW005
     C                     MOVEL@KEY5     DBKEY            * DB ERROR 23 *CSW005
     C                     MOVEL'SDBSRTPD'DBFILE           * * * * * * * *CSW005
     C                     OUT  LDA                                       CSW005
     C                     EXSR *PSSR                                     CSW005
     C                     ENDIF                                          CSW005
     C                     ENDIF                                          CSW005
      *                                                                   CSW005
      ****Their*business*day;*ISDA*financial*centre*               CSW005 CSW097
     C***********          MOVELMGTFLO    WTFLO9                   CSW005 CSW097
     C***********          MOVELMGOFLO    WOFLO9                   CSW005 CSW097
     C***********          MOVEATX#,10    W#STR9                   CSW005 CSW097
     C***********WTFLO9    IFEQ W#STR9                             CSW005 CSW097
     C***********WOFLO9    OREQ W#STR9                             CSW005 CSW097
     C***********          MOVEATX#,11    MGTBSD                   CSW005 CSW097
     C***********          ELSE                                    CSW005 CSW097
     C***********TCUCY     IFEQ 'ECU'                              CSW005 CSW097
     C***********          MOVEL'ECU'     MGTBSD                   CSW005 CSW097
     C***********          ELSE                                    CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Access*Currency*Details                                  CSW005 CSW097
     C***********          CALL 'AOCURRR0'                         CSW005 CSW097
     C***********          PARM '*MSG   ' @RTCD                    CSW005 CSW097
     C***********          PARM '*KEY   ' @OPTN                    CSW005 CSW097
     C***********          PARM TCUCY     @KEY3                    CSW005 CSW097
     C***********SDCURR    PARM SDCURR    DSSDY                    CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C***********@RTCD     IFEQ *BLANKS                            CSW005 CSW097
     C***********          MOVELA6ISFC    MGTBSD                   CSW005 CSW097
     C***********          ELSE                                    CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C************LOCK     IN   LDA                                CSW005 CSW097
     C***********          MOVE '024'     DBASE     * * * * * * * *CSW005 CSW097
     C***********          MOVEL@KEY3     DBKEY     * DB ERROR 24 *CSW005 CSW097
     C***********          MOVEL'SDCURRPD'DBFILE    * * * * * * * *CSW005 CSW097
     C***********          OUT  LDA                                CSW005 CSW097
     C***********          EXSR *PSSR                              CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
      *                                                                   CSW005
      **  Their initial floating rate, spread, initial processing method  CSW005
      **  initial payment frequency code and rate change frequency code   CSW005
     C***********          Z-ADDTOBRT     MGTBSV                   CSW005 CSW097
      *                                                                   CSW005
     C                     SELEC                                          CSW005
     C           TSPIN     WHEQ 'A'                                       CSW005
     C                     Z-ADDTRTSP     MGTSPD                          CSW005
     C           TSPIN     WHEQ 'S'                                       CSW005
     C                     Z-SUBTRTSP     MGTSPD                          CSW005
     C           TSPIN     WHEQ 'P'                                       CSW005
     C           TOBRT     DIV  100       WWRK   139                      CSW005
     C           WWRK      MULT TRTSP     MGTSPD                          CSW005
     C                     ENDSL                                          CSW005
     C*                                                                   CSW005
     C                     MOVE TINPM     MGTCMP                          CSW005
     C                     MOVE TIPFR     MGTIPF                          CSW005
     C                     MOVE TICFR     MGTRCF                          CSW005
      *                                                                   CSW097
      **  Their Floating Rate Other Maturity Desc 1 - 2                   CSW097
     C********** TBRTT     IFNE 00                                        CSW097              CSD103
     C           TBRTT     IFNE *BLANKS                                                       CSD103
     C                     MOVE TBRTT     @KEY2                           CSW097
     C                     CALL 'AOBSRTR0'                                CSW097
     C                     PARM '*MSG   ' @RTCD                           CSW097
     C                     PARM '*KEY   ' @OPTN                           CSW097
     C                     PARM TCUCY     @KEY3                           CSW097
     C                     PARM           @KEY2                           CSW097
     C           SDBSRT    PARM SDBSRT    DSSDY                           CSW097
      *                                                                   CSW097
     C           @RTCD     IFEQ *BLANKS                                   CSW097
     C                     MOVELBAOMD1    MGTOM1                          CSW097
     C                     MOVELBAOMD2    MGTOM2                          CSW097
     C                     ENDIF                                          CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW005
      ****Set*up*Our*compounding*indicator*                        CSW005 CSW097
     C***********CIR002    IFEQ 'Y'                                CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C***********TICFR     IFEQ 'M'                                CSW005 CSW097
     C***********TIPFR     IFEQ 'Q'                                CSW005 CSW097
     C***********TIPFR     OREQ 'X'                                CSW005 CSW097
     C***********TIPFR     OREQ 'Y'                                CSW005 CSW097
     C***********TIPFR     OREQ 'Z'                                CSW005 CSW097
     C***********TIPFR     OREQ 'M'                                CSW005 CSW097
     C***********TNICD     ANDNETNIPD                              CSW005 CSW097
     C***********          MOVE 'N'       MGTCPA                   CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
     C***********TICFR     IFEQ 'Q'                                CSW005 CSW097
     C***********TIPFR     IFEQ 'X'                                CSW005 CSW097
     C***********TIPFR     OREQ 'Y'                                CSW005 CSW097
     C***********TIPFR     OREQ 'Z'                                CSW005 CSW097
     C***********TIPFR     OREQ 'Q'                                CSW005 CSW097
     C***********TNICD     ANDNETNIPD                              CSW005 CSW097
     C***********          MOVE 'N'       MGTCPA                   CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
     C***********TICFR     IFEQ 'X'                                CSW005 CSW097
     C***********TIPFR     IFEQ 'Y'                                CSW005 CSW097
     C***********TIPFR     OREQ 'Z'                                CSW005 CSW097
     C***********TIPFR     OREQ 'X'                                CSW005 CSW097
     C***********TNICD     ANDNETNIPD                              CSW005 CSW097
     C***********          MOVE 'N'       MGTCPA                   CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
     C***********TICFR     IFEQ 'Y'                                CSW005 CSW097
     C***********TIPFR     IFEQ 'Z'                                CSW005 CSW097
     C***********TIPFR     OREQ 'Y'                                CSW005 CSW097
     C***********TNICD     ANDNETNIPD                              CSW005 CSW097
     C***********          MOVE 'N'       MGTCPA                   CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
     C***********TICFR     IFEQ 'Z'                                CSW005 CSW097
     C***********TIPFR     IFNE 'Z'                                CSW005 CSW097
     C***********          MOVE 'N'       MGTCPA                   CSW005 CSW097
     C***********          ELSE                                    CSW005 CSW097
      ****Partial*keys.**Note:**DDLNO*is*used*here.                CSW005 CSW097
     C***********          MOVE 'T'       @OTIN                    CSW005 CSW097
     C***********          MOVE 'R'       @RCIP                    CSW005 CSW097
     C***********          Z-ADD*LOVAL    @PRDT                    CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C***********IRCKY2    SETLLDLDTSCD0               71          CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C************IN71     IFEQ '0'                                CSW005 CSW097
     C***********          READ DLDTSCD0               7170        CSW005 CSW097
      *                                                            CSW005 CSW097
      ****Check*for*a*match*on*payment*date*for*each*rate*change*daCSW005 CSW097
     C************IN70     DOWEQ'0'                                CSW005 CSW097
     C************IN71     ANDEQ'0'                                CSW005 CSW097
     C***********DDLNO     ANDEQDLNO                               CSW005 CSW097
     C***********@OTIN     ANDEQOTIN                               CSW005 CSW097
     C***********@RCIP     ANDEQRCIP                               CSW005 CSW097
     C***********          MOVE 'P'       @RCIP                    CSW005 CSW097
     C***********          Z-ADDPRDT      @PRDT                    CSW005 CSW097
     C***********IRCKY2    CHAINDLDTSCD0             70            CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C************IN70     IFEQ '1'                                CSW005 CSW097
     C***********          MOVE 'N'       MGTCPA                   CSW005 CSW097
     C***********          ELSE                                    CSW005 CSW097
     C***********          MOVE 'R'       @RCIP                    CSW005 CSW097
     C***********          Z-ADDPRDT      @PRDT                    CSW005 CSW097
     C***********IRCKY2    SETGTDLDTSCD0                           CSW005 CSW097
     C***********          READ DLDTSCD0               7170        CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C***********          ENDDO                                   CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
      *                                                                   CSW005
      **  Sequence E - Our fixed rate.  Note MGEFXR is initially zero.    CSW005
     C***********UIPFR     IFEQ 'C'                                CSW005 CSW097
     C***********          Z-ADD*ZERO     MGEFXR                   CSW005 CSW097
     C***********          ELSE                                    CSW005 CSW097
     C********** UBRTT     IFEQ 00                                        CSW005              CSD103
     C           UBRTT     IFEQ *BLANKS                                                       CSD103
     C                     Z-ADDUEINR     MGEFXR                          CSW005
     C                     ELSE                                           CSW005
     C                     Z-ADD*ZERO     MGEFXR                          CSW005
     C                     ENDIF                                          CSW005
     C***********          ENDIF                                   CSW005 CSW097
      *                                                                   CSW005
      **  Our interest calculation method narrative.                      CSW005
     C                     SELEC                                          CSW005
     C           UICBS     WHEQ 1                                         CSW005
     C                     MOVEATX#,6     MGODCF                          CSW005
     C           UICBS     WHEQ 2                                         CSW005
     C                     MOVEATX#,7     MGODCF                          CSW005
     C           UICBS     WHEQ 3                                         CSW005
     C/COPY WNCPYSRC,DL6305C077                                           LHX010
     C                     MOVEATX#,16    MGODCF                          183212
     C***********UICBS     OREQ 7                                  CIR004 183212
     C           UICBS     WHEQ 7                                         183212
     C           CIR004    ANDEQ'Y'                                       CIR004
     C                     MOVEATX#,8     MGODCF                          CSW005
     C           UICBS     WHEQ 4                                         CSW005
     C           UICBS     OREQ 5                                  CSW005 CSW097
     C           UICBS     OREQ 9                                         CIR013
     C***********          MOVEL'4'       MGODCF    P              CSW005 CSW097
     C                     MOVE UICBS     W@ODCF                          CSW097
     C                     MOVELW@ODCF    MGODCF                          CSW097
     C***********UICBS     WHEQ 5                                  CSW005 CSW097
     C***********          MOVEL'5'       MGODCF    P              CSW005 CSW097
     C           UICBS     WHEQ 6                                         CSW005
     C                     MOVEATX#,9     MGODCF                          CSW005
     C                     ENDSL                                          CSW005
      *                                                                   CSW005
      **  Sequence F - Our floating rate and designated maturity          CSW005
      **  if Our Base Rate Type is not zero.                              CSW005
      **  MGOFLO and MGODSM were initialised to blanks.                   CSW005
     C********** UBRTT     IFGT 00                                        CSW005              CSD103
     C           UBRTT     IFNE *BLANKS                                                       CSD103
      *                                                                   CSW005
      **  Access Base Rate Code Details                                   CSW005
     C                     MOVELUBRTT     @KEY2                           CSW005
     C                     CALL 'AOBSRTR0'                                CSW005
     C                     PARM '*MSG   ' @RTCD                           CSW005
     C                     PARM '*KEY   ' @OPTN                           CSW005
     C                     PARM UCUCY     @KEY3                           CSW005
     C                     PARM           @KEY2                           CSW005
     C           SDBSRT    PARM SDBSRT    DSSDY                           CSW005
      *                                                                   CSW005
     C           @RTCD     IFEQ *BLANKS                                   CSW005
     C                     MOVELBASCDD    MGOFLO                          CSW005
     C                     MOVELBADGMA    MGODSM                          CSW005
     C                     ELSE                                           CSW005
      *                                                                   CSW005
     C                     MOVEL@KEY3     @KEY5   5                       CSW005
     C                     MOVE @KEY2     @KEY5                           CSW005
     C           *LOCK     IN   LDA                                       CSW005
     C                     MOVE '025'     DBASE            * * * * * * * *CSW005
     C                     MOVEL@KEY5     DBKEY            * DB ERROR 25 *CSW005
     C                     MOVEL'SDBSRTPD'DBFILE           * * * * * * * *CSW005
     C                     OUT  LDA                                       CSW005
     C                     EXSR *PSSR                                     CSW005
     C                     ENDIF                                          CSW005
     C                     ENDIF                                          CSW005
      *                                                                   CSW005
      ****Our*business*days.                                       CSW005 CSW097
     C***********WOFLO9    IFEQ W#STR9                             CSW005 CSW097
     C***********WTFLO9    OREQ W#STR9                             CSW005 CSW097
     C***********          MOVEATX#,11    MGOBSD                   CSW005 CSW097
     C***********          ELSE                                    CSW005 CSW097
     C***********UCUCY     IFEQ 'ECU'                              CSW005 CSW097
     C***********          MOVEL'ECU'     MGOBSD                   CSW005 CSW097
     C***********          ELSE                                    CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Access*Currency*Details*                                 CSW005 CSW097
     C***********          CALL 'AOCURRR0'                         CSW005 CSW097
     C***********          PARM '*MSG   ' @RTCD                    CSW005 CSW097
     C***********          PARM '*KEY   ' @OPTN                    CSW005 CSW097
     C***********          PARM UCUCY     @KEY3                    CSW005 CSW097
     C***********SDCURR    PARM SDCURR    DSSDY                    CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C***********@RTCD     IFEQ *BLANKS                            CSW005 CSW097
     C***********          MOVELA6ISFC    MGOBSD                   CSW005 CSW097
     C***********          ELSE                                    CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C************LOCK     IN   LDA                                CSW005 CSW097
     C***********          MOVE '026'     DBASE     * * * * * * * *CSW005 CSW097
     C***********          MOVEL@KEY3     DBKEY     * DB ERROR 26 *CSW005 CSW097
     C***********          MOVEL'SDCURRPD'DBFILE    * * * * * * * *CSW005 CSW097
     C***********          OUT  LDA                                CSW005 CSW097
     C***********          EXSR *PSSR                              CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
      *                                                                   CSW005
      **  Our initial floating rate, spread, initial processing method    CSW005
      **  initial payment frequency code and rate change frequency code   CSW005
     C***********          Z-ADDUOBRT     MGOBSV                   CSW005 CSW097
      *                                                                   CSW005
     C                     SELEC                                          CSW005
     C           USPIN     WHEQ 'A'                                       CSW005
     C                     Z-ADDURTSP     MGOSPD                          CSW005
     C           USPIN     WHEQ 'S'                                       CSW005
     C                     Z-SUBURTSP     MGOSPD                          CSW005
     C           USPIN     WHEQ 'P'                                       CSW005
     C           UOBRT     DIV  100       WWRK                            CSW005
     C           WWRK      MULT URTSP     MGOSPD                          CSW005
     C                     ENDSL                                          CSW005
      *                                                                   CSW005
     C                     MOVE UINPM     MGOCMP                          CSW005
     C                     MOVE UIPFR     MGOIPF                          CSW005
     C                     MOVE UICFR     MGORCF                          CSW005
      *                                                                   CSW005
      ****Set*up*Our*compounding*indicator*                        CSW005 CSW097
     C***********CIR002    IFEQ 'Y'                                CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C***********UICFR     IFEQ 'M'                                CSW005 CSW097
     C***********UIPFR     IFEQ 'Q'                                CSW005 CSW097
     C***********UIPFR     OREQ 'X'                                CSW005 CSW097
     C***********UIPFR     OREQ 'Y'                                CSW005 CSW097
     C***********UIPFR     OREQ 'Z'                                CSW005 CSW097
     C***********UIPFR     OREQ 'M'                                CSW005 CSW097
     C***********UNICD     ANDNEUNIPD                              CSW005 CSW097
     C***********          MOVE 'N'       MGOCPA                   CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
     C***********UICFR     IFEQ 'Q'                                CSW005 CSW097
     C***********UIPFR     IFEQ 'X'                                CSW005 CSW097
     C***********UIPFR     OREQ 'Y'                                CSW005 CSW097
     C***********UIPFR     OREQ 'Z'                                CSW005 CSW097
     C***********UIPFR     OREQ 'Q'                                CSW005 CSW097
     C***********UNICD     ANDNEUNIPD                              CSW005 CSW097
     C***********          MOVE 'N'       MGOCPA                   CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
     C***********UICFR     IFEQ 'X'                                CSW005 CSW097
     C***********UIPFR     IFEQ 'Y'                                CSW005 CSW097
     C***********UIPFR     OREQ 'Z'                                CSW005 CSW097
     C***********UIPFR     OREQ 'X'                                CSW005 CSW097
     C***********UNICD     ANDNEUNIPD                              CSW005 CSW097
     C***********          MOVE 'N'       MGOCPA                   CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
     C***********UICFR     IFEQ 'Y'                                CSW005 CSW097
     C***********UIPFR     IFEQ 'Z'                                CSW005 CSW097
     C***********UIPFR     OREQ 'Y'                                CSW005 CSW097
     C***********UNICD     ANDNEUNIPD                              CSW005 CSW097
     C***********          MOVE 'N'       MGOCPA                   CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
     C***********UICFR     IFEQ 'Z'                                CSW005 CSW097
     C***********UIPFR     IFNE 'Z'                                CSW005 CSW097
     C***********          MOVE 'N'       MGOCPA                   CSW005 CSW097
     C***********          ELSE                                    CSW005 CSW097
      ****Partial*keys.**Note:**DDLNO*is*used*here.                CSW005 CSW097
     C***********          MOVE 'U'       @OTIN                    CSW005 CSW097
     C***********          MOVE 'R'       @RCIP                    CSW005 CSW097
     C***********          Z-ADD*LOVAL    @PRDT                    CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C***********IRCKY2    SETLLDLDTSCD0               71          CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C************IN71     IFEQ '0'                                CSW005 CSW097
     C***********          READ DLDTSCD0               7170        CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Check*for*a*match*on*payment*date*for*each*rate*change*daCSW005 CSW097
     C************IN70     DOWEQ'0'                                CSW005 CSW097
     C************IN71     ANDEQ'0'                                CSW005 CSW097
     C***********DDLNO     ANDEQDLNO                               CSW005 CSW097
     C***********@OTIN     ANDEQOTIN                               CSW005 CSW097
     C***********@RCIP     ANDEQRCIP                               CSW005 CSW097
     C***********          MOVE 'P'       @RCIP                    CSW005 CSW097
     C***********          Z-ADDPRDT      @PRDT                    CSW005 CSW097
     C***********IRCKY2    CHAINDLDTSCD0             70            CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C************IN70     IFEQ '1'                                CSW005 CSW097
     C***********          MOVE 'N'       MGOCPA                   CSW005 CSW097
     C***********          ELSE                                    CSW005 CSW097
     C***********          MOVE 'R'       @RCIP                    CSW005 CSW097
     C***********          Z-ADDPRDT      @PRDT                    CSW005 CSW097
     C***********IRCKY2    SETGTDLDTSCD0                           CSW005 CSW097
     C***********          READ DLDTSCD0               7170        CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C***********          ENDDO                                   CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Sequence*J*and*K*-*Their*and*Our*init*exchange*amounts   CSW005 CSW097
     C***********VDEI      IFEQ 'Y'                                CSW005 CSW097
     C***********          Z-ADDTOPAM     MGTIPA                   CSW005 CSW097
     C***********          Z-ADDUOPAM     MGOIPA                   CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Sequence*L*-*Their*final*exchange*amount                 CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****IRC*feature*is**ON*AND*Maturity*Date*Exchange*In*is*"Y"  CSW005 CSW097
      ****Get*latest*Cashflow*amount                               CSW005 CSW097
     C***********CIR001    IFEQ 'Y'                                CSW005 CSW097
     C***********MDEI      ANDEQ'Y'                                CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Partial*keys.**Note:**DDLNO*is*used*here.                CSW005 CSW097
     C***********          MOVE 'T'       @OTIN                    CSW005 CSW097
     C***********          Z-ADD*HIVAL    @PRDT                    CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C***********IRCKY1    SETGTDLPCSCD0               71          CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C************IN71     IFEQ '0'                                CSW005 CSW097
     C***********          READPDLPCSCD0               7170        CSW005 CSW097
     C************IN70     IFEQ '0'                                CSW005 CSW097
     C***********DDLNO     ANDEQDLNO                               CSW005 CSW097
     C***********@OTIN     ANDEQOTIN                               CSW005 CSW097
     C***********          Z-ADDPAMT      MGTFPA                   CSW005 CSW097
     C***********          ELSE                                    CSW005 CSW097
     C***********          Z-ADDTOPAM     MGTFPA                   CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Error*in*accessing*DLPCSCPD                              CSW005 CSW097
     C************IN71     IFEQ '1'                                CSW005 CSW097
     C***********          MOVELDDLNO     @K1DL                    CSW005 CSW097
     C***********          MOVE @OTIN     @K1OT                    CSW005 CSW097
     C***********          MOVE *BLANKS   @K1PR                    CSW005 CSW097
     C************LOCK     IN   LDA                                CSW005 CSW097
     C***********          MOVE '027'     DBASE     * * * * * * * *CSW005 CSW097
     C***********          MOVEL@IRCK1    DBKEY     * DB ERROR 27 *CSW005 CSW097
     C***********          MOVEL'DLPCSCPD'DBFILE    * * * * * * * *CSW005 CSW097
     C***********          OUT  LDA                                CSW005 CSW097
     C***********          EXSR *PSSR                              CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****IRC*feature*is**OFF                                      CSW005 CSW097
      ****Use*Their*original*principal*amount                      CSW005 CSW097
     C***********          ELSE                                    CSW005 CSW097
     C***********MDEI      IFEQ 'Y'                                CSW005 CSW097
     C***********          Z-ADDTOPAM     MGTFPA                   CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Sequence*M*-*Our*final*exchange*amount*                  CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****IRC*feature*is**ON*AND*Maturity*Date*Exchange*In*is*"Y"* CSW005 CSW097
      ****Get*latest*Cashflow*amount                               CSW005 CSW097
     C***********CIR001    IFEQ 'Y'                                CSW005 CSW097
     C***********MDEI      ANDEQ'Y'                                CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Partial*keys.**Note:**DDLNO*is*used*here.*               CSW005 CSW097
     C***********          MOVE 'U'       @OTIN                    CSW005 CSW097
     C***********          Z-ADD*HIVAL    @PRDT                    CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C***********IRCKY1    SETGTDLPCSCD0               71          CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C************IN71     IFEQ '0'                                CSW005 CSW097
     C***********          READPDLPCSCD0               7170        CSW005 CSW097
     C************IN70     IFEQ '0'                                CSW005 CSW097
     C***********DDLNO     ANDEQDLNO                               CSW005 CSW097
     C***********@OTIN     ANDEQOTIN                               CSW005 CSW097
     C***********          Z-ADDPAMT      MGOFPA                   CSW005 CSW097
     C***********          ELSE                                    CSW005 CSW097
     C***********          Z-ADDUOPAM     MGOFPA                   CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Error*in*accessing*DLPCSCPD*                             CSW005 CSW097
     C************IN71     IFEQ '1'                                CSW005 CSW097
     C***********          MOVELDDLNO     @K1DL                    CSW005 CSW097
     C***********          MOVE @OTIN     @K1OT                    CSW005 CSW097
     C***********          MOVE *BLANKS   @K1PR                    CSW005 CSW097
     C************LOCK     IN   LDA                                CSW005 CSW097
     C***********          MOVE '028'     DBASE     * * * * * * * *CSW005 CSW097
     C***********          MOVEL@IRCK1    DBKEY     * DB ERROR 28 *CSW005 CSW097
     C***********          MOVEL'DLPCSCPD'DBFILE    * * * * * * * *CSW005 CSW097
     C***********          OUT  LDA                                CSW005 CSW097
     C***********          EXSR *PSSR                              CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****IRC*feature*is**OFF                                      CSW005 CSW097
      ****Use*Our*original*principal*amount                        CSW005 CSW097
     C***********          ELSE                                    CSW005 CSW097
     C***********MDEI      IFEQ 'Y'                                CSW005 CSW097
     C***********          Z-ADDUOPAM     MGOFPA                   CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
      *                                                                   CSW097
      **  Our Floating Rate - Other Maturity Desc 1 - 2                   CSW097
     C********** UBRTT     IFNE 00                                        CSW097              CSD103
     C           UBRTT     IFNE *BLANKS                                                       CSD103
     C                     MOVE UBRTT     @KEY2                           CSW097
     C                     CALL 'AOBSRTR0'                                CSW097
     C                     PARM '*MSG   ' @RTCD                           CSW097
     C                     PARM '*KEY   ' @OPTN                           CSW097
     C                     PARM UCUCY     @KEY3                           CSW097
     C                     PARM           @KEY2                           CSW097
     C           SDBSRT    PARM SDBSRT    DSSDY                           CSW097
      *                                                                   CSW097
     C           @RTCD     IFEQ *BLANKS                                   CSW097
     C                     MOVELBAOMD1    MGOOM1                          CSW097
     C                     MOVELBAOMD2    MGOOM2                          CSW097
     C                     ENDIF                                          CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
      ** Event Type                                                       CSW097
     C                     MOVE *BLANK    MGEVTP                          CSW097
      *                                                                   CSW005
      **  Sequence N - Their up-front fee amount                          CSW005
     C           UPPR      IFEQ 'R'                                       CSW005
     C                     Z-ADDUPFE      MGTUFF                          CSW005
     C                     ELSE                                           CSW005
     C                     Z-ADD*ZERO     MGTUFF                          CSW005
     C                     ENDIF                                          CSW005
      *                                                                   CSW005
      **  Sequence O - Their up-front fee amount                          CSW005
     C           UPPR      IFEQ 'P'                                       CSW005
     C                     Z-ADDUPFE      MGOUFF                          CSW005
     C                     ELSE                                           CSW005
     C                     Z-ADD*ZERO     MGOUFF                          CSW005
     C                     ENDIF                                          CSW005
      *                                                                   CSW005
      **  Up-front value date                                             CSW005
     C                     Z-ADDUPVD      MGUPVD                          CSW005
     C                     MOVE *BLANKS   MGOPDC                          CIR005
     C                     MOVE *BLANKS   MGTPDC                          CIR005
      *                                                                   CIR005
      ** Payment Date Convention                                          CIR005
      *                                                                   CIR005
     C           CIR005    IFEQ 'Y'                                       CIR005
     C                     MOVELL1PDCN    MGOPDC                          CIR005
     C                     MOVELL2PDCN    MGTPDC                          CIR005
     C                     MOVELL1AMCN    MGOACN                          184003
     C                     MOVELL2AMCN    MGTACN                          184003
     C                     ENDIF                                          CIR005
      *                                                                                      BUG7911
      ** Termination Date/Maturity Date                                                      BUG7911
      *                                                                                      BUG7911
     C           MGMDAT    IFEQ MDAT                                                         BUG7911
     C           BOVD      ANDNE0                                                            BUG7911
     C                     Z-ADDBOVD      MGMDAT                                             BUG7911
     C                     Z-ADDBOVD      W#MDAT                                             BUG7911
     C                     ELSE                                                              BUG7911
     C                     Z-ADDMDAT      W#MDAT                                             BUG7911
     C                     ENDIF                                                             BUG7911
      * Change Type                                                                          BUG7698
     C           MGCHTP    IFEQ *BLANK                                                       BUG7698
     C                     MOVE @CHG      MGCHTP                                             BUG7698
     C                     ENDIF                                                             BUG7698
      *                                                                                      BUG7977
      ** Stub details - Ours                                                                 BUG7977
      *                                                                                      BUG7977
      *  Ours 38G (From First)                                                               BUG7977
      **  Access Base Rate Code Details - Ours                                               BUG7977
     C                     CLEARMGOS1B                                                       BUG7977
     C********** FSOS1B    IFNE 0                                                     BUG7977 CSD103
     C           FSOS1B    IFNE *BLANKS                                                       CSD103
     C                     MOVE FSOS1B    @KEY2                                              BUG7977
     C                     CALL 'AOBSRTR0'                                                   BUG7977
     C                     PARM '*MSG   ' @RTCD                                              BUG7977
     C                     PARM '*KEY   ' @OPTN                                              BUG7977
     C                     PARM UCUCY     @KEY3                                              BUG7977
     C                     PARM           @KEY2                                              BUG7977
     C           SDBSRT    PARM SDBSRT    DSSDY                                              BUG7977
     C           @RTCD     IFEQ *BLANKS                                                      BUG7977
     C                     MOVELBADGMA    MGOS1B                                             BUG7977
     C                     ENDIF                                                             BUG7977
     C                     ENDIF                                                             BUG7977
      *  Ours 38G (To First) 11                                                              BUG7977
      **  Access Base Rate Code Details - Ours                                               BUG7977
     C                     CLEARMGOE1B                                                       BUG7977
     C********** FSOE1B    IFNE 0                                                     BUG7977 CSD103
     C           FSOE1B    IFNE *BLANKS                                                       CSD103
     C                     MOVE FSOE1B    @KEY2                                              BUG7977
     C                     CALL 'AOBSRTR0'                                                   BUG7977
     C                     PARM '*MSG   ' @RTCD                                              BUG7977
     C                     PARM '*KEY   ' @OPTN                                              BUG7977
     C                     PARM UCUCY     @KEY3                                              BUG7977
     C                     PARM           @KEY2                                              BUG7977
     C           SDBSRT    PARM SDBSRT    DSSDY                                              BUG7977
     C           @RTCD     IFEQ *BLANKS                                                      BUG7977
     C                     MOVELBADGMA    MGOE1B                                             BUG7977
     C                     ENDIF                                                             BUG7977
     C                     ENDIF                                                             BUG7977
      *  Ours 38H (From Last)                                                                BUG7977
      **  Access Base Rate Code Details - Ours                                               BUG7977
     C                     CLEARMGOS2B                                                       BUG7977
     C********** FSOS2B    IFNE 0                                                     BUG7977 CSD103
     C           FSOS2B    IFNE *BLANKS                                                       CSD103
     C                     MOVE FSOS2B    @KEY2                                              BUG7977
     C                     CALL 'AOBSRTR0'                                                   BUG7977
     C                     PARM '*MSG   ' @RTCD                                              BUG7977
     C                     PARM '*KEY   ' @OPTN                                              BUG7977
     C                     PARM UCUCY     @KEY3                                              BUG7977
     C                     PARM           @KEY2                                              BUG7977
     C           SDBSRT    PARM SDBSRT    DSSDY                                              BUG7977
     C           @RTCD     IFEQ *BLANKS                                                      BUG7977
     C                     MOVELBADGMA    MGOS2B                                             BUG7977
     C                     ENDIF                                                             BUG7977
     C                     ENDIF                                                             BUG7977
      *  Ours 38H (To Last)                                                                  BUG7977
      **  Access Base Rate Code Details - Ours                                               BUG7977
     C                     CLEARMGOE2B                                                       BUG7977
     C********** FSOE2B    IFNE 0                                                     BUG7977 CSD103
     C           FSOE2B    IFNE *BLANKS                                                       CSD103
     C                     MOVE FSOE2B    @KEY2                                              BUG7977
     C                     CALL 'AOBSRTR0'                                                   BUG7977
     C                     PARM '*MSG   ' @RTCD                                              BUG7977
     C                     PARM '*KEY   ' @OPTN                                              BUG7977
     C                     PARM UCUCY     @KEY3                                              BUG7977
     C                     PARM           @KEY2                                              BUG7977
     C           SDBSRT    PARM SDBSRT    DSSDY                                              BUG7977
     C           @RTCD     IFEQ *BLANKS                                                      BUG7977
     C                     MOVELBADGMA    MGOE2B                                             BUG7977
     C                     ENDIF                                                             BUG7977
     C                     ENDIF                                                             BUG7977
      *                                                                                      BUG7977
      ** Stub details - Theirs                                                               BUG7977
      *                                                                                      BUG7977
      *  Theirs 38G (From Frst)                                                              BUG7977
      **  Access Base Rate Code Details - Theirs                                             BUG7977
     C                     CLEARMGTS1B                                                       BUG7977
     C********** FSTS1B    IFNE 0                                                     BUG7977 CSD103
     C           FSTS1B    IFNE *BLANKS                                                       CSD103
     C                     MOVE FSTS1B    @KEY2                                              BUG7977
     C                     CALL 'AOBSRTR0'                                                   BUG7977
     C                     PARM '*MSG   ' @RTCD                                              BUG7977
     C                     PARM '*KEY   ' @OPTN                                              BUG7977
     C                     PARM TCUCY     @KEY3                                              BUG7977
     C                     PARM           @KEY2                                              BUG7977
     C           SDBSRT    PARM SDBSRT    DSSDY                                              BUG7977
     C           @RTCD     IFEQ *BLANKS                                                      BUG7977
     C                     MOVELBADGMA    MGTS1B                                             BUG7977
     C                     ENDIF                                                             BUG7977
     C                     ENDIF                                                             BUG7977
      *  Theirs 38G (To First)                                                               BUG7977
      **  Access Base Rate Code Details - Theirs                                             BUG7977
     C                     CLEARMGTE1B                                                       BUG7977
     C********** FSTE1B    IFNE 0                                                     BUG7977 CSD103
     C           FSTE1B    IFNE *BLANKS                                                       CSD103
     C                     MOVE FSTE1B    @KEY2                                              BUG7977
     C                     CALL 'AOBSRTR0'                                                   BUG7977
     C                     PARM '*MSG   ' @RTCD                                              BUG7977
     C                     PARM '*KEY   ' @OPTN                                              BUG7977
     C                     PARM TCUCY     @KEY3                                              BUG7977
     C                     PARM           @KEY2                                              BUG7977
     C           SDBSRT    PARM SDBSRT    DSSDY                                              BUG7977
     C           @RTCD     IFEQ *BLANKS                                                      BUG7977
     C                     MOVELBADGMA    MGTE1B                                             BUG7977
     C                     ENDIF                                                             BUG7977
     C                     ENDIF                                                             BUG7977
      *  Theirs 38H (From Last)                                                              BUG7977
      **  Access Base Rate Code Details - Theirs                                             BUG7977
     C                     CLEARMGTS2B                                                       BUG7977
     C********** FSTS2B    IFNE 0                                                     BUG7977 CSD103
     C           FSTS2B    IFNE *BLANKS                                                       CSD103
     C                     MOVE FSTS2B    @KEY2                                              BUG7977
     C                     CALL 'AOBSRTR0'                                                   BUG7977
     C                     PARM '*MSG   ' @RTCD                                              BUG7977
     C                     PARM '*KEY   ' @OPTN                                              BUG7977
     C                     PARM TCUCY     @KEY3                                              BUG7977
     C                     PARM           @KEY2                                              BUG7977
     C           SDBSRT    PARM SDBSRT    DSSDY                                              BUG7977
     C           @RTCD     IFEQ *BLANKS                                                      BUG7977
     C                     MOVELBADGMA    MGTS2B                                             BUG7977
     C                     ENDIF                                                             BUG7977
     C                     ENDIF                                                             BUG7977
      *  Theirs 38H (To Last)                                                                BUG7977
      **  Access Base Rate Code Details - Theirs                                             BUG7977
     C                     CLEARMGTE2B                                                       BUG7977
     C********** FSTE2B    IFNE 0                                                     BUG7977 CSD103
     C           FSTE2B    IFNE *BLANKS                                                       CSD103
     C                     MOVE FSTE2B    @KEY2                                              BUG7977
     C                     CALL 'AOBSRTR0'                                                   BUG7977
     C                     PARM '*MSG   ' @RTCD                                              BUG7977
     C                     PARM '*KEY   ' @OPTN                                              BUG7977
     C                     PARM TCUCY     @KEY3                                              BUG7977
     C                     PARM           @KEY2                                              BUG7977
     C           SDBSRT    PARM SDBSRT    DSSDY                                              BUG7977
     C           @RTCD     IFEQ *BLANKS                                                      BUG7977
     C                     MOVELBADGMA    MGTE2B                                             BUG7977
     C                     ENDIF                                                             BUG7977
     C                     ENDIF                                                             BUG7977
      *                                                                                      BUG7977
      *                                                                                       CSW213
     C                     EXSR SRREPI                                                        CSW213
      *                                                                   CSW005
      **  Write record                                                    CSW005
     C                     WRITEMGX361D0                                  CSW005
      *                                                                   CSW005
      ****Create*iterative*sequence*to*MGY36NPD.*                  CSW005 CSW097
     C***********          EXSR Y36N                               CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Create*iterative*sequence*to*MGZ36NPD*(Sequence*H)*      CSW005 CSW097
     C***********          MOVEL'T'       WOTIN                    CSW005 CSW097
     C***********          EXSR Z36N                               CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Create*iterative*sequence*to*MGZ36NPD*(Sequence*I)*      CSW005 CSW097
     C***********          MOVEL'U'       WOTIN                    CSW005 CSW097
     C***********          EXSR Z36N                               CSW005 CSW097
      *                                                                   CSW097
      ** Output Payment Details                                           CSW097
     C                     EXSR SRY36N                                    CSW097
      *                                                                   CSW097
      ** Output Principal Repayment Details - Their Side                  CSW097
     C                     MOVEL'T'       WOTIN                           CSW097
     C                     EXSR SRZ36N                                    CSW097
      *                                                                   CSW097
      ** Output Principal Repayment Details - Our Side                    CSW097
     C                     MOVEL'U'       WOTIN                           CSW097
     C                     EXSR SRZ36N                                    CSW097
      *                                                                   CSW097
      ** Output Financial Centre Details                                  CSW097
     C                     EXSR SRU36N                                    CSW097
      *                                                                   CSW097
      ** Output Compounding Details                                       CSW097
     C                     EXSR SRV36N                                    CSW097
      *                                                                   CSW097
      ** Output Principal Exchange Details                                CSW097
     C                     EXSR SRW36N                                    CSW097
      *                                                                   CSW097
      ** Output Settlements Details                                       CSW097
     C                     EXSR SRX36N                                    CSW097
      *                                                                   CSW005
     C                     ENDSR                                          CSW005
      *****************************************************************   CSW005
     C/EJECT                                                              CSW005
      *************************************************************CSW005 CSW097
      ****Y36N*-*Set*up*Iterative*Details*for*MT360*and*MT361.*****CSW005 CSW097
      ****Called*by*-*F360,*F361***********************************CSW005 CSW097
      *************************************************************CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C***********Y36N      BEGSR                                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Set*up*MGY36NPD*record.**********************************CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Sequence*B                                               CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Cashflow*is*used*and*Interest*Rates*Calendar*feature*is**CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C***********TIPFR     IFEQ 'C'                                CSW005 CSW097
     C***********CIR001    ANDEQ'Y'                                CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Sequence*details                                         CSW005 CSW097
     C***********          Z-ADDMGSEQN    MGSEQN                   CSW005 CSW097
     C***********          MOVE 'B'       MGMSSQ                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****IRC*Cashflow*Calendar*details                            CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Partial*keys.**Note:**DDLNO*is*used*here.****************CSW005 CSW097
     C***********          MOVE 'T'       @OTIN                    CSW005 CSW097
     C***********          Z-ADD*LOVAL    @PRDT                    CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C***********IRCKY1    SETLLDLCFSCD0               71          CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C************IN71     IFEQ '0'                                CSW005 CSW097
     C***********          READ DLCFSCD0               7170        CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Write*to*MGY36NPD*for*every*partial*matched*DLCFSCPD*recoCSW005 CSW097
     C************IN70     DOWEQ'0'                                CSW005 CSW097
     C************IN71     ANDEQ'0'                                CSW005 CSW097
     C***********DDLNO     ANDEQDLNO                               CSW005 CSW097
     C***********@OTIN     ANDEQOTIN                               CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Payment/repayment*date*and*amount************************CSW005 CSW097
     C***********          Z-ADDPRDT      MGPDAT                   CSW005 CSW097
     C***********          Z-ADDCFLA      MGPAMT                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Output*MGY36NPD*record***********************************CSW005 CSW097
     C***********          WRITEMGY36ND0                           CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Next*record**********************************************CSW005 CSW097
     C***********          READ DLCFSCD0               7170        CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C***********          ENDDO                                   CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Error*in*accessing*DLPCSCPD******************************CSW005 CSW097
     C************IN71     IFEQ '1'                                CSW005 CSW097
     C***********          MOVELDDLNO     @K1DL                    CSW005 CSW097
     C***********          MOVE @OTIN     @K1OT                    CSW005 CSW097
     C***********          MOVE *BLANKS   @K1PR                    CSW005 CSW097
     C************LOCK     IN   LDA                                CSW005 CSW097
     C***********          MOVE '029'     DBASE     * * * * * * * *CSW005 CSW097
     C***********          MOVEL@IRCK1    DBKEY     * DB ERROR 29 *CSW005 CSW097
     C***********          MOVEL'DLPCSCPD'DBFILE    * * * * * * * *CSW005 CSW097
     C***********          OUT  LDA                                CSW005 CSW097
     C***********          EXSR *PSSR                              CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Sequence*B*or*C******************************************CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Cashflow*not*used*and*Their*Rate*is*fixed****************CSW005 CSW097
      ****OR*Floating*Rate*is*used.********************************CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C***********TIPFR     IFNE 'C'                                CSW005 CSW097
     C***********TBRTT     ANDEQ00                                 CSW005 CSW097
     C***********TBRTT     ORGT 00                                 CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Sequence*details*****************************************CSW005 CSW097
     C***********          Z-ADDMGSEQN    MGSEQN                   CSW005 CSW097
     C***********TBRTT     IFEQ 00                                 CSW005 CSW097
     C***********          MOVE 'B'       MGMSSQ                   CSW005 CSW097
     C***********          ELSE                                    CSW005 CSW097
     C***********          MOVE 'C'       MGMSSQ                   CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Payment*amount*set*to*zero*******************************CSW005 CSW097
     C***********          Z-ADD*ZEROS    MGPAMT                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****If*payment*frequency*is*'Z'*i.e.*irregular*schedule******CSW005 CSW097
     C***********TIPFR     IFEQ 'Z'                                CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Partial*keys.**Note:**DDLNO*is*used*here.****************CSW005 CSW097
     C***********          MOVE 'T'       @OTIN                    CSW005 CSW097
     C***********          MOVE 'P'       @RCIP                    CSW005 CSW097
     C***********          Z-ADD*LOVAL    @PRDT                    CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****If*interest*is*paid*up-front,*first*payment*date*is*valueCSW005 CSW097
     C***********TINPM     IFEQ 'D'                                CSW005 CSW097
     C***********TINPM     OREQ 'Y'                                CSW005 CSW097
     C***********          Z-ADDDVDAT     MGPDAT                   CSW005 CSW097
     C***********          WRITEMGY36ND0                           CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C***********IRCKY2    SETLLDLDTSCD0               71          CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C************IN71     IFEQ '0'                                CSW005 CSW097
     C***********          READ DLDTSCD0               7170        CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Write*to*MGY36NPD*for*every*partial*matched*DLDTSCPD*recoCSW005 CSW097
     C************IN70     DOWEQ'0'                                CSW005 CSW097
     C************IN71     ANDEQ'0'                                CSW005 CSW097
     C***********DDLNO     ANDEQDLNO                               CSW005 CSW097
     C***********@OTIN     ANDEQOTIN                               CSW005 CSW097
     C***********@RCIP     ANDEQRCIP                               CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Payment/repayment*date*and*amount************************CSW005 CSW097
     C***********          Z-ADDPRDT      MGPDAT                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Output*MGY36NPD*record***********************************CSW005 CSW097
     C***********          WRITEMGY36ND0                           CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Next*record**********************************************CSW005 CSW097
     C***********          READ DLDTSCD0               7170        CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C***********          ENDDO                                   CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Error*in*accessing*DLDTSCPD******************************CSW005 CSW097
     C************IN71     IFEQ '1'                                CSW005 CSW097
     C***********          MOVELDDLNO     @K2DL                    CSW005 CSW097
     C***********          MOVE @OTIN     @K2OT                    CSW005 CSW097
     C***********          MOVE @RCIP     @K2RC                    CSW005 CSW097
     C***********          MOVE *BLANKS   @K2PR                    CSW005 CSW097
     C************LOCK     IN   LDA                                CSW005 CSW097
     C***********          MOVE '030'     DBASE     * * * * * * * *CSW005 CSW097
     C***********          MOVEL@IRCK2    DBKEY     * DB ERROR 30 *CSW005 CSW097
     C***********          MOVEL'DLDTSCPD'DBFILE    * * * * * * * *CSW005 CSW097
     C***********          OUT  LDA                                CSW005 CSW097
     C***********          EXSR *PSSR                              CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****not*frequency*'Z',*get*repayment*details*****************CSW005 CSW097
      ****by*payment*frequency.************************************CSW005 CSW097
     C***********          ELSE                                    CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Should*have*Next*Interest*Date***************************CSW005 CSW097
     C***********TNIPD     IFGT *ZERO                              CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Set*workfield*for*Their*next*int*payment*date************CSW005 CSW097
     C***********          Z-ADDTNIPD     W#NIPD  50               CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Write*to*MGY36NPD*for*every*int*date*before*maturity.****CSW005 CSW097
     C***********W#NIPD    DOWLTMDAT                               CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Payment/repayment*date***********************************CSW005 CSW097
     C***********          Z-ADDW#NIPD    MGPDAT                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Output*MGY36NPD*record***********************************CSW005 CSW097
     C***********          WRITEMGY36ND0                           CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Determine*next*interest*payment*according*to*frequency***CSW005 CSW097
     C***********          CALL 'DLZFRQ'                           CSW005 CSW097
     C***********          PARM *BLANK    ZFRRTC  5                CSW005 CSW097
     C***********          PARM W#NIPD    ZFRDAT  50    * DATE     CSW005 CSW097
     C***********          PARM TIPFR     ZFRFRQ  1     * FREQUENCYCSW005 CSW097
     C***********          PARM TIPFD     ZFRBAS  20    * BASE DAY CSW005 CSW097
     C***********          PARM RSETM     ZFRSET  20    * SETT.METHCSW005 CSW097
     C***********          PARM TCUCY     ZFRCCY  3     * CURRENCY CSW005 CSW097
     C***********          PARM URACC     ZFRNOS  2     * NOSTRO   CSW005 CSW097
     C***********          PARM MDAT      ZFRMDT  50    * MAT.DATE CSW005 CSW097
     C***********          PARM           BKAPDT                   CSW005 CSW097
     C***********          PARM           BJSLCD                   CSW005 CSW097
     C***********          PARM           BJLCCY                   CSW005 CSW097
     C***********          PARM *ZERO     ZFRNXD  50    * NEXT DATECSW005 CSW097
     C***********ZFRRTC    IFEQ '*ERR*'                            CSW005 CSW097
     C************LOCK     IN   LDA                                CSW005 CSW097
     C***********          MOVE '031'     DBASE     * * * * * * * *CSW005 CSW097
     C***********          MOVELZFRRTC    DBKEY     * DB ERROR 31 *CSW005 CSW097
     C***********          MOVEL'DLZFRQ'  DBFILE    * * * * * * * *CSW005 CSW097
     C***********          OUT  LDA                                CSW005 CSW097
     C***********          EXSR *PSSR                              CSW005 CSW097
     C***********          END                                     CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****New*interest*date****************************************CSW005 CSW097
     C***********          Z-ADDZFRNXD    W#NIPD                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C***********          ENDDO                                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Include*the*maturity*date*as*the*last*payment*date.******CSW005 CSW097
     C***********TINPM     IFNE 'D'                                CSW005 CSW097
     C***********TINPM     ANDNE'Y'                                CSW005 CSW097
     C***********          Z-ADDMDAT      MGPDAT                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Output*MGY36NPD*record***********************************CSW005 CSW097
     C***********          WRITEMGY36ND0                           CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Sequence*E***********************************************CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Cashflow*is*used*and*IRC*feature*is**ON.*****************CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C***********UIPFR     IFEQ 'C'                                CSW005 CSW097
     C***********CIR001    ANDEQ'Y'                                CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Sequence*details*****************************************CSW005 CSW097
     C***********          Z-ADDMGSEQN    MGSEQN                   CSW005 CSW097
     C***********          MOVE 'E'       MGMSSQ                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Partial*keys.**Note:**DDLNO*is*used*here.****************CSW005 CSW097
     C***********          MOVE 'U'       @OTIN                    CSW005 CSW097
     C***********          Z-ADD*LOVAL    @PRDT                    CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C***********IRCKY1    SETLLDLCFSCD0               71          CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C************IN71     IFEQ '0'                                CSW005 CSW097
     C***********          READ DLCFSCD0               7170        CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Write*to*MGY36NPD*for*every*partial*matched*DLCFSCPD*recoCSW005 CSW097
     C************IN70     DOWEQ'0'                                CSW005 CSW097
     C************IN71     ANDEQ'0'                                CSW005 CSW097
     C***********DDLNO     ANDEQDLNO                               CSW005 CSW097
     C***********@OTIN     ANDEQOTIN                               CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Payment/repayment*date*and*amount************************CSW005 CSW097
     C***********          Z-ADDPRDT      MGPDAT                   CSW005 CSW097
     C***********          Z-ADDCFLA      MGPAMT                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Output*MGY36NPD*record***********************************CSW005 CSW097
     C***********          WRITEMGY36ND0                           CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Next*record**********************************************CSW005 CSW097
     C***********          READ DLCFSCD0               7170        CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C***********          ENDDO                                   CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Error*in*accessing*DLCFSCPD******************************CSW005 CSW097
     C************IN71     IFEQ '1'                                CSW005 CSW097
     C***********          MOVELDDLNO     @K1DL                    CSW005 CSW097
     C***********          MOVE @OTIN     @K1OT                    CSW005 CSW097
     C***********          MOVE *BLANKS   @K1PR                    CSW005 CSW097
     C************LOCK     IN   LDA                                CSW005 CSW097
     C***********          MOVE '032'     DBASE     * * * * * * * *CSW005 CSW097
     C***********          MOVEL@IRCK1    DBKEY     * DB ERROR 32 *CSW005 CSW097
     C***********          MOVEL'DLCFSCPD'DBFILE    * * * * * * * *CSW005 CSW097
     C***********          OUT  LDA                                CSW005 CSW097
     C***********          EXSR *PSSR                              CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Sequence*E*or*F******************************************CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Cashflow*is*not*used*and*Our*Rate*is*fixed***************CSW005 CSW097
      ****OR*Floating*Rate*is*used*********************************CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C***********UIPFR     IFNE 'C'                                CSW005 CSW097
     C***********UBRTT     ANDEQ00                                 CSW005 CSW097
     C***********UBRTT     ORGT 00                                 CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Sequence*details*****************************************CSW005 CSW097
     C***********          Z-ADDMGSEQN    MGSEQN                   CSW005 CSW097
     C***********UBRTT     IFEQ 00                                 CSW005 CSW097
     C***********          MOVE 'E'       MGMSSQ                   CSW005 CSW097
     C***********          ELSE                                    CSW005 CSW097
     C***********          MOVE 'F'       MGMSSQ                   CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Payment*amount*set*to*zero*******************************CSW005 CSW097
     C***********          Z-ADD*ZEROS    MGPAMT                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****If*payment*frequency*is*'Z'*i.e.*irregular*schedule******CSW005 CSW097
     C***********UIPFR     IFEQ 'Z'                                CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Partial*keys.**Note:**DDLNO*is*used*here.****************CSW005 CSW097
     C***********          MOVE 'U'       @OTIN                    CSW005 CSW097
     C***********          MOVE 'P'       @RCIP                    CSW005 CSW097
     C***********          Z-ADD*LOVAL    @PRDT                    CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****If*interest*is*paid*up-front,*first*payment*date*is*valueCSW005 CSW097
     C***********UINPM     IFEQ 'D'                                CSW005 CSW097
     C***********UINPM     OREQ 'Y'                                CSW005 CSW097
     C***********          Z-ADDDVDAT     MGPDAT                   CSW005 CSW097
     C***********          WRITEMGY36ND0                           CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C***********IRCKY2    SETLLDLDTSCD0               71          CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C************IN71     IFEQ '0'                                CSW005 CSW097
     C***********          READ DLDTSCD0               7170        CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Write*to*MGY36NPD*for*every*partial*matched*DLDTSCPD*recoCSW005 CSW097
     C************IN70     DOWEQ'0'                                CSW005 CSW097
     C************IN71     ANDEQ'0'                                CSW005 CSW097
     C***********DDLNO     ANDEQDLNO                               CSW005 CSW097
     C***********@OTIN     ANDEQOTIN                               CSW005 CSW097
     C***********@RCIP     ANDEQRCIP                               CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Payment/repayment*date*and*amount************************CSW005 CSW097
     C***********          Z-ADDPRDT      MGPDAT                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Output*MGY36NPD*record***********************************CSW005 CSW097
     C***********          WRITEMGY36ND0                           CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Next*record**********************************************CSW005 CSW097
     C***********          READ DLDTSCD0               7170        CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C***********          ENDDO                                   CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Error*in*accessing*DLDTSCPD******************************CSW005 CSW097
     C************IN71     IFEQ '1'                                CSW005 CSW097
     C***********          MOVELDDLNO     @K2DL                    CSW005 CSW097
     C***********          MOVE @OTIN     @K2OT                    CSW005 CSW097
     C***********          MOVE @RCIP     @K2RC                    CSW005 CSW097
     C***********          MOVE *BLANKS   @K2PR                    CSW005 CSW097
     C************LOCK     IN   LDA                                CSW005 CSW097
     C***********          MOVE '033'     DBASE     * * * * * * * *CSW005 CSW097
     C***********          MOVEL@IRCK2    DBKEY     * DB ERROR 33 *CSW005 CSW097
     C***********          MOVEL'DLDTSCPD'DBFILE    * * * * * * * *CSW005 CSW097
     C***********          OUT  LDA                                CSW005 CSW097
     C***********          EXSR *PSSR                              CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****payment*frequency*not*'Z'*get*repayment*details*by*frequeCSW005 CSW097
     C***********          ELSE                                    CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Should*have*Next*Interest*Date***************************CSW005 CSW097
     C***********UNIPD     IFGT *ZERO                              CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Set*workfield*for*Our*next*int*payment*date**************CSW005 CSW097
     C***********          Z-ADDUNIPD     W#NIPD                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Write*to*MGY36NPD*for*every*int*date*before*maturity.****CSW005 CSW097
     C***********W#NIPD    DOWLTMDAT                               CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Payment/repayment*date***********************************CSW005 CSW097
     C***********          Z-ADDW#NIPD    MGPDAT                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Output*MGY36NPD*record***********************************CSW005 CSW097
     C***********          WRITEMGY36ND0                           CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Determine*next*interest*payment*according*to*frequency***CSW005 CSW097
     C***********          CALL 'DLZFRQ'                           CSW005 CSW097
     C***********          PARM *BLANK    ZFRRTC  5                CSW005 CSW097
     C***********          PARM W#NIPD    ZFRDAT  50       * DATE  CSW005 CSW097
     C***********          PARM UIPFR     ZFRFRQ  1     * FREQUENCYCSW005 CSW097
     C***********          PARM UIPFD     ZFRBAS  20    * BASE DAY CSW005 CSW097
     C***********          PARM PSETM     ZFRSET  20    * SETT.METHCSW005 CSW097
     C***********          PARM UCUCY     ZFRCCY  3     * CURRENCY CSW005 CSW097
     C***********          PARM UPACC     ZFRNOS  2     * NOSTRO   CSW005 CSW097
     C***********          PARM MDAT      ZFRMDT  50    * MAT.DATE CSW005 CSW097
     C***********          PARM           BKAPDT                   CSW005 CSW097
     C***********          PARM           BJSLCD                   CSW005 CSW097
     C***********          PARM           BJLCCY                   CSW005 CSW097
     C***********          PARM *ZERO     ZFRNXD  50    * NEXT DATECSW005 CSW097
     C***********ZFRRTC    IFEQ '*ERR*'                            CSW005 CSW097
     C************LOCK     IN   LDA                                CSW005 CSW097
     C***********          MOVE '034'     DBASE     * * * * * * * *CSW005 CSW097
     C***********          MOVELZFRRTC    DBKEY     * DB ERROR 34 *CSW005 CSW097
     C***********          MOVEL'DLZFQR'  DBFILE    * * * * * * * *CSW005 CSW097
     C***********          OUT  LDA                                CSW005 CSW097
     C***********          EXSR *PSSR                              CSW005 CSW097
     C***********          END                                     CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****New*interest*date****************************************CSW005 CSW097
     C***********          Z-ADDZFRNXD    W#NIPD                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C***********          ENDDO                                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Include*the*maturity*date*as*the*last*payment*date.******CSW005 CSW097
     C***********UINPM     IFNE 'D'                                CSW005 CSW097
     C***********UINPM     ANDNE'Y'                                CSW005 CSW097
     C***********          Z-ADDMDAT      MGPDAT                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
      ****Output*MGY36NPD*record***********************************CSW005 CSW097
     C***********          WRITEMGY36ND0                           CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
     C***********          ENDIF                                   CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C***********          ENDSR                                   CSW005 CSW097
      *****************************************************************   CSW005
     C/EJECT                                                              CSW097
      *****************************************************************   CSW097
      *   SRY36N - Format FRA/IRS Payment Details                     *   CSW097
      *   Called by - F360FR, F360RS, F361                            *   CSW097
      *****************************************************************   CSW097
     C           SRY36N    BEGSR                                          CSW097
      *                                                                   CSW097
      ** Forward Rate Agreement                                           CSW097
      **   o Bought FRA - Output Sequence C and E                         CSW097
      **   o Sell FRA   - Output Sequence B and F                         CSW097
     C           DTYP      IFEQ 'FR'                                      CSW097
      *                                                                   CSW097
     C                     Z-ADD1         X       20                      CSW097
     C           X         DOWLE2                                         CSW097
      *                                                                   CSW097
     C           X         IFEQ 1                                         CSW097
      *                                                                   CSW097
     C           BYSL      IFEQ 'B'                                       CSW097
     C                     MOVE 'C'       MGMSSQ                          CSW097
     C                     ELSE                                           CSW097
     C                     MOVE 'B'       MGMSSQ                          CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
     C                     ELSE                                           CSW097
      *                                                                   CSW097
     C           BYSL      IFEQ 'B'                                       CSW097
     C                     MOVE 'E'       MGMSSQ                          CSW097
     C                     ELSE                                           CSW097
     C                     MOVE 'F'       MGMSSQ                          CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
     C                     Z-ADDDVDAT     MGPDAT                          CSW097
     C                     Z-ADD*ZERO     MGPAMT                          CSW097
      *                                                                   CSW097
     C                     WRITEMGY36ND0                                  CSW097
      *                                                                   CSW097
     C                     ADD  1         X                               CSW097
     C                     ENDDO                                          CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
      ** Single and Cross Currency Swaps                                  CSW097
      **   o Their side is fixed    - Output Sequence B                   CSW097
      **   o Their side is floating - Output Sequence C                   CSW097
      **   o Our side is fixed      - Output Sequence E                   CSW097
      **   o Our side is floating   - Output Sequence F                   CSW097
     C           DTYP      IFEQ 'RS'                                      CSW097
     C           DTYP      OREQ 'RX'                                      CSW097
      *                                                                   CSW097
     C                     Z-ADD1         X                               CSW097
     C           X         DOWLE2                                         CSW097
      *                                                                   CSW097
     C           X         IFEQ 1                                         CSW097
      *                                                                   CSW097
     C********** TBRTT     IFEQ 0                                         CSW097              CSD103
     C           TBRTT     IFEQ *BLANKS                                                       CSD103
     C                     MOVE 'B'       MGMSSQ                          CSW097
     C                     ELSE                                           CSW097
     C                     MOVE 'C'       MGMSSQ                          CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
     C                     ELSE                                           CSW097
      *                                                                   CSW097
     C********** UBRTT     IFEQ 0                                         CSW097              CSD103
     C           UBRTT     IFEQ *BLANKS                                                       CSD103
     C                     MOVE 'E'       MGMSSQ                          CSW097
     C                     ELSE                                           CSW097
     C                     MOVE 'F'       MGMSSQ                          CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
      ** If Their side is fixed or floating                               CSW097
     C           MGMSSQ    IFEQ 'B'                                       CSW097
     C           MGMSSQ    OREQ 'C'                                       CSW097
      *                                                                   CSW097
     C                     MOVE TINPM     W#INPM                          CSW097
     C                     MOVE TIPFR     W#IPFR                          CSW097
     C                     MOVE TIPFD     W#IPFD                          CSW097
     C                     MOVE RSETM     W#SETM                          CSW097
     C***********          MOVE URACC     W#NOSN                   CSW097 CIR005
     C                     MOVELURACC     W#NOSN                          CIR005
     C                     MOVE 'T'       @OTIN                           CSW097
     C                     Z-ADDTNIPD     W#NIPD                          CSW097
      *                                                                   CSW097
     C                     MOVE RSCY      W#STCY                          CSW097
     C                     MOVE TCUCY     W#CUCY                          CSW097
      *                                                                   CIR005
     C           CIR005    IFEQ 'Y'                                       CIR005
     C           DTYP      IFEQ 'RX'                                      CIR005
     C                     MOVELL2AMCN    WAMCN                           CIR005
     C                     MOVELL2PDCN    WPDCN                           CIR005
     C                     MOVELL2CYP1    WCYP1                           CIR005
     C                     MOVELL2CYP2    WCYP2                           CIR005
     C                     MOVELL2CYP3    WCYP3                           CIR005
     C                     MOVELL2CYP4    WCYP4                           CIR005
     C                     MOVELL2CYP5    WCYP5                           CIR005
     C                     MOVELL2CYP6    WCYP6                           CIR005
     C                     MOVELL2CYP7    WCYP7                           CIR005
     C                     MOVELL2CYP8    WCYP8                           CIR005
     C                     MOVELL2CYP9    WCYP9                           CIR005
     C                     MOVELL2CYP0    WCYP0                           CIR005
     C                     ELSE                                           CIR005
     C                     MOVELL1AMCN    WAMCN                           CIR005
     C                     MOVELL1PDCN    WPDCN                           CIR005
     C                     MOVELL1CYP1    WCYP1                           CIR005
     C                     MOVELL1CYP2    WCYP2                           CIR005
     C                     MOVELL1CYP3    WCYP3                           CIR005
     C                     MOVELL1CYP4    WCYP4                           CIR005
     C                     MOVELL1CYP5    WCYP5                           CIR005
     C                     MOVELL1CYP6    WCYP6                           CIR005
     C                     MOVELL1CYP7    WCYP7                           CIR005
     C                     MOVELL1CYP8    WCYP8                           CIR005
     C                     MOVELL1CYP9    WCYP9                           CIR005
     C                     MOVELL1CYP0    WCYP0                           CIR005
     C                     ENDIF                                          CIR005
      *                                                                                       CIR017
     C           CIR017    IFEQ 'Y'                                                           CIR017
     C           DTYP      ANDEQ'RS'                                                          CIR017
     C                     MOVE L2AMCN    WAMCN                                               CIR017
     C                     MOVE L2PDCN    WPDCN                                               CIR017
     C                     ENDIF                                                              CIR017
      *                                                                                       CIR017
     C                     ENDIF                                          CIR005
      *                                                                   CSW097
     C                     ELSE                                           CSW097
      *                                                                   CSW097
      ** Otherwise ("E" or "F"), Our side is fixed or floating            CSW097
     C                     MOVE UINPM     W#INPM                          CSW097
     C                     MOVE UIPFR     W#IPFR                          CSW097
     C                     MOVE UIPFD     W#IPFD                          CSW097
     C                     MOVE PSETM     W#SETM                          CSW097
     C***********          MOVE UPACC     W#NOSN                   CSW097 CIR005
     C                     MOVELUPACC     W#NOSN                          CIR005
     C                     MOVE 'U'       @OTIN                           CSW097
     C***********          Z-ADDTNIPD     W#NIPD                   CSW097 181906
     C                     Z-ADDUNIPD     W#NIPD                          181906
      *                                                                   CSW097
     C                     MOVE PSCY      W#STCY                          CSW097
     C                     MOVE UCUCY     W#CUCY                          CSW097
      *                                                                   CSW097
     C           CIR005    IFEQ 'Y'                                       CIR005
     C                     MOVELL1AMCN    WAMCN   2                       CIR005
     C                     MOVELL1PDCN    WPDCN   2                       CIR005
     C                     MOVELL1CYP1    WCYP1                           CIR005
     C                     MOVELL1CYP2    WCYP2                           CIR005
     C                     MOVELL1CYP3    WCYP3                           CIR005
     C                     MOVELL1CYP4    WCYP4                           CIR005
     C                     MOVELL1CYP5    WCYP5                           CIR005
     C                     MOVELL1CYP6    WCYP6                           CIR005
     C                     MOVELL1CYP7    WCYP7                           CIR005
     C                     MOVELL1CYP8    WCYP8                           CIR005
     C                     MOVELL1CYP9    WCYP9                           CIR005
     C                     MOVELL1CYP0    WCYP0                           CIR005
     C                     ENDIF                                          CIR005
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
     C                     MOVE 'P'       @RCIP                           CSW097
     C                     MOVE *LOVAL    @PRDT                           CSW097
     C                     EXSR SRYWRT                                    CSW097
      *                                                                   CSW097
     C                     ADD  1         X                               CSW097
     C                     ENDDO                                          CSW097
      *                                                                   CSW097
      ** End of DTYP = "RS" or "RX"                                       CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
     C                     ENDSR                                          CSW097
      *****************************************************************   CSW097
     C/EJECT                                                              CSW097
      *****************************************************************   CSW097
      *   SRYWRT - Write record to MGY36NPD - "RS" and "RX" only.     *   CSW097
      *   Called by - SRY36N                                          *   CSW097
      *****************************************************************   CSW097
     C           SRYWRT    BEGSR                                          CSW097
      *                                                                                      BUG6599
      ** Access OISD Settlement Days of currenct                                             BUG6599
      *                                                                                      BUG6599
     C                     CALL 'AOCURRR0'                                                   BUG6599
     C                     PARM '*MSG   ' @RTCD                                              BUG6599
     C                     PARM '*KEY   ' @OPTN                                              BUG6599
     C                     PARM MGCCY     @KEY3                                              BUG6599
     C           SDCURR    PARM SDCURR    DSSDY                                              BUG6599
      *                                                                                      BUG6599
     C                     Z-ADDA6SETD    W#SETD  30                                         BUG6599
      *                                                                   CSW097
      ** If Int Proc Method is not "C"                                    CSW097
     C           W#INPM    IFNE 'C'                                       CSW097
     C           CIR006    ANDEQ'N'                                       CIR006
     C           W#INPM    ORNE 'C'                                       CIR006
     C           W#INPM    ANDNE'A'                                       CIR006
     C           CIR006    ANDEQ'Y'                                       CIR006
      *                                                                   CSW097
      **  ...If Int Payment Freq is "Z", Output each record               CSW097
      **     from the interest payment schedule file.                     CSW097
     C           W#IPFR    IFEQ 'Z'                                       CSW097
      *                                                                   CSW097
     C           IRCKY2    SETLLDLDTSCPD               70                 CSW097
     C                     READ DLDTSCPD                 70               CSW097
     C           *IN70     DOWEQ'0'                                       CSW097
     C           DDLNO     ANDEQDLNO                                      CSW097
     C           @OTIN     ANDEQOTIN                                      CSW097
     C           @RCIP     ANDEQRCIP                                      CSW097
     C                     Z-ADDPRDT      MGPDAT                          CSW097
     C                     Z-ADD*ZERO     MGPAMT                          CSW097
      *                                                                                      BUG6599
      ** Add OISD Settledays when UICFR/TICFR is O                                           BUG6599
      *                                                                                      BUG6599
     C           UICFR     IFEQ 'O'                                                          BUG6599
     C           TICFR     OREQ 'O'                                                          BUG6599
     C                     ADD  W#SETD    MGPDAT                                             BUG6599
     C                     ENDIF                                                             BUG6599
      *                                                                                      BUG6599
     C                     WRITEMGY36ND0                                  CSW097
     C                     READ DLDTSCPD                 70               CSW097
     C                     ENDDO                                          CSW097
      *                                                                   CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
      **  ...If Int Payment Freq is "C", Output each record               CSW097
      **     from Cash-Flow Schedule file.                                CSW097
     C           W#IPFR    IFEQ 'C'                                       CSW097
      *                                                                   CSW097
     C           IRCKY1    SETLLDLCFSCPD               70                 CSW097
     C                     READ DLCFSCPD                 70               CSW097
     C           *IN70     DOWEQ'0'                                       CSW097
     C           DDLNO     ANDEQDLNO                                      CSW097
     C           @OTIN     ANDEQOTIN                                      CSW097
     C                     Z-ADDPRDT      MGPDAT                          CSW097
     C                     Z-ADDCFLA      MGPAMT                          CSW097
     C                     WRITEMGY36ND0                                  CSW097
     C                     READ DLCFSCD0                 70               CSW097
     C                     ENDDO                                          CSW097
      *                                                                   CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
      **  ...If Int Payment Freq is NOT "Z" nor "C" and the               CSW097
      **     Next Int Payment Date > 0, Output each Interest              CSW097
      **     Payment Date calculated from the Next Interest               CSW097
      **     Payment Date to Maturity Date.                               CSW097
     C           W#IPFR    IFNE 'Z'                                       CSW097
     C           W#IPFR    ANDNE'C'                                       CSW097
     C           W#NIPD    ANDGT0                                         CSW097
      *                                                                   CSW097
     C********** W#NIPD    DOWLTMDAT                                                  CSW097 BUG7911
     C           W#NIPD    DOWLTW#MDAT                                                       BUG7911
     C           W#NIPD    ANDGT0                                                             165933
      *                                                                   CSW097
     C                     Z-ADDW#NIPD    MGPDAT                          CSW097
     C                     Z-ADD*ZERO     MGPAMT                          CSW097
      *                                                                                      BUG6599
      ** Add OISD Settledays when UICFR/TICFR is O                                           BUG6599
      *                                                                                      BUG6599
     C           UICFR     IFEQ 'O'                                                          BUG6599
     C           TICFR     OREQ 'O'                                                          BUG6599
     C                     ADD  W#SETD    MGPDAT                                             BUG6599
     C                     ENDIF                                                             BUG6599
      *                                                                                      BUG6599
     C                     WRITEMGY36ND0                                  CSW097
      *                                                                   CSW097
      ** Determine next interest payment according to frequency           CSW097
     C                     MOVE W#SETM    ZFRSET                       od CSW097
      *                                                                   CIR005
     C           CIR005    IFEQ 'Y'                                       CIR005
     C           WCYP1     ANDNE*BLANKS                                   CIR005
     C           W#IPFR    IFEQ *BLANKS                                   CIR005
     C**********           Z-ADDMDAT      ZFRNXD                                      CIR005 BUG7911
     C                     Z-ADDW#MDAT    ZFRNXD                                             BUG7911
     C                     ELSE                                           CIR005
     C                     MOVE W#IPFD    ZMDAY                           CIR005
     C                     Z-ADDW#NIPD    ZDAYNO                          CIR005
     C                     MOVELW#IPFR    ZFREQ                           CIR005
     C                     MOVELBJSLCD    ZLOC                            CIR005
      *                                                                   CIR005
     C                     EXSR ZFRQB3                                    CIR005
      *                                                                   CIR005
     C                     CALL 'DLZIRP'                                  CIR005
     C                     PARM           ZDAYNO                          CIR005
     C                     PARM WCCYD2    PCURR                           CIR005
     C                     PARM WPDCN     PPDCN   2                       CIR005
     C                     PARM ZLOC      PLOCN                           CIR005
     C                     PARM           BJDFIN                          CIR005
     C                     PARM *ZEROS    PAJDT   50                      CIR005
     C                     PARM *ZEROS    PBSDT   50                      CIR005
      *                                                                   CIR005
     C********** PAJDT     IFGE MDAT                                                  CIR005 BUG7911
     C********** PBSDT     ORGT MDAT                                                  CIR005 BUG7911
     C**********           Z-ADDMDAT      ZFRNXD                                      CIR005 BUG7911
     C           PAJDT     IFGE W#MDAT                                                       BUG7911
     C           PBSDT     ORGT W#MDAT                                                       BUG7911
     C                     Z-ADDW#MDAT    ZFRNXD                                             BUG7911
     C                     ELSE                                           CIR005
     C********** WAMCN     IFEQ 'A'                                CIR005 184003
     C********** W#NIPD    ORGE PAJDT                              CIR005 184003
     C                     Z-ADDPBSDT     ZFRNXD                          CIR005
     C**********           ELSE                                    CIR005 184003
     C**********           Z-ADDPAJDT     ZFRNXD                   CIR005 184003
     C**********           ENDIF                                   CIR005 184003
     C                     ENDIF                                          CIR005
     C                     ENDIF                                          CIR005
      *                                                                   CIR005
     C                     ELSE                                           CIR005
      *                                                                   CIR005
     C                     CALL 'DLZFRQ'                                  CSW097
     C                     PARM *BLANK    ZFRRTC  5                       CSW097
     C                     PARM W#NIPD    ZFRDAT  50       * Date         CSW097
     C                     PARM W#IPFR    ZFRFRQ  1        * Frequency    CSW097
     C                     PARM W#IPFD    ZFRBAS  20       * Base Day     CSW097
     C                     PARM           ZFRSET  20       * Sett. Method CSW097
     C                     PARM W#CUCY    ZFRCCY  3        * Currency     CSW097
     C**********           PARM W#STCY    ZSTCY   3        * Settl CSW097 167426
     C**********           PARM 'P'       ZRCIP   1        * R/P   CSW097 167426
     C                     PARM W#STCY    ZSTCY   3        * Settl        171312
     C                     PARM 'P'       ZRCIP   1        * R/P          171312
     C                     PARM W#NOSN    ZFRNOS  2        * Nostro       CSW097
     C                     PARM MDAT      ZFRMDT  50       * Mat. Date    CSW097
     C                     PARM           BKAPDT                          CSW097
     C                     PARM           BJSLCD                          CSW097
     C                     PARM           BJLCCY                          CSW097
     C                     PARM *ZERO     ZFRZBD  50       * BASE DATE    180466
     C                     PARM *ZERO     ZFRNXD  50       * Next Date    CSW097
      *                                                                   CSW097
     C           ZFRRTC    IFEQ '*ERR*'                                   CSW097
     C           *LOCK     IN   LDA                                       CSW097
     C                     MOVE '057'     DBASE            * * * * * * * *CSW097
     C                     MOVELZFRRTC    DBKEY            * DB ERROR 57 *CSW097
     C                     MOVEL'DLZFRQ'  DBFILE           * * * * * * * *CSW097
     C                     OUT  LDA                                       CSW097
     C                     EXSR *PSSR                                     CSW097
     C                     ENDIF                                          CSW097
     C                     ENDIF                                          CIR005
      *                                                                   CSW097
      ** New interest date                                                CSW097
     C**********           Z-ADDZFRNXD    W#NIPD                   CSW097 184003
      *                                                                                      BUG6675
     C           CIR005    IFEQ 'Y'                                                          BUG6675
     C           WCYP1     ANDNE*BLANKS                                                      BUG6675
     C                     Z-ADDZFRNXD    W#NIPD                                             BUG6675
     C                     ELSE                                                              BUG6675
     C                     Z-ADDZFRZBD    W#NIPD                          184003
     C                     ENDIF                                                             BUG6675
      *                                                                                      BUG6675
     C                     ENDDO                                          CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
      ** End of W#INPM <> "C"                                             CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
      ** Output maturity as payment date                                  CSW097
     C           W#INPM    IFEQ 'C'                                       CSW097
     C           W#INPM    OREQ 'A'                                       CIR006
     C           CIR006    ANDEQ'Y'                                       CIR006
     C           W#INPM    ORNE 'C'                                       CSW097
     C           W#INPM    ANDNE'A'                                       CIR006
     C           W#IPFR    ANDNE'C'                                       CSW097
     C           W#IPFR    ANDNE'Z'                                       CSW097
      *                                                                                      BUG7911
     C           BOVD      IFEQ 0                                                            BUG7911
     C                     Z-ADDMDAT      MGPDAT                          CSW097
     C                     ELSE                                                              BUG7911
     C                     Z-ADDBOVD      MGPDAT                                             BUG7911
     C                     ENDIF                                                             BUG7911
      *                                                                                      BUG7911
     C                     Z-ADD*ZERO     MGPAMT                          CSW097
      *                                                                                      BUG6599
      ** Add OISD Settledays when UICFR/TICFR is O                                           BUG6599
      *                                                                                      BUG6599
     C           UICFR     IFEQ 'O'                                                          BUG6599
     C           TICFR     OREQ 'O'                                                          BUG6599
     C                     ADD  W#SETD    MGPDAT                                             BUG6599
     C                     ENDIF                                                             BUG6599
      *                                                                                      BUG6599
     C                     WRITEMGY36ND0                                  CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
     C                     ENDSR                                          CSW097
      *****************************************************************   CSW097
     C/EJECT                                                              CSW005
      *****************************************************************   CSW005
      ****Z36N*-*Set*up*Amortising*Iterative*Details*for*MT360/1***CSW005 CSW097
      *   SRZ36N - Set up Amortising Iterative Details for MT360/1    *   CSW097
      ****Called*by*-*F360,*F361***********************************CSW005 CSW097
      *   Called by - F360RS, F361                                    *   CSW097
      *****************************************************************   CSW005
      *                                                                   CSW005
     C***********Z36N      BEGSR                                   CSW005 CSW097
     C           SRZ36N    BEGSR                                          CSW097
      *                                                                   CSW005
      **  Set up MGZ36NPD record.                                         CSW005
      *                                                                   CSW005
      ****If*amortising,*output*iterative*details*to*MGZ36NPD.**** CSW005 CSW097
      ***********                                                  CSW005 CSW097
     C***********MGAMRT    IFEQ*'Y'                                CSW005 CSW097
      *                                                                   CSW005
      **  Sequence details                                                CSW005
     C***********          Z-ADDMGSEQN    MGSEQN                   CSW005 CSW097
      *                                                                   CSW005
     C                     SELEC                                          CSW005
     C           WOTIN     WHEQ *BLANKS                                   CSW005
     C           WOTIN     OREQ 'T'                                       CSW005
      *                                                                                     MD034496
      ** SWIFT 2015 Change: Re-label sequences H-O to I-P for MT361                         MD034496
      *                                                                                     MD034496
     C           CSW215    IFEQ 'Y'                                                         MD034496
     C           @TYP      ANDEQ'361'                                                       MD034496
     C                     MOVE 'I'       MGMSSQ                                            MD034496
     C                     ELSE                                                             MD034496
     C                     MOVEL'H'       MGMSSQ                          CSW005
     C                     ENDIF                                                            MD034496
      *                                                                                     MD034496
     C                     Z-ADDTOPAM     W#NAMT 130                      CSW005
     C           WOTIN     WHEQ 'U'                                       CSW005
      *                                                                                     MD034496
     C           CSW215    IFEQ 'Y'                                                         MD034496
     C           @TYP      ANDEQ'361'                                                       MD034496
     C                     MOVE 'J'       MGMSSQ                                            MD034496
     C                     ELSE                                                             MD034496
     C                     MOVEL'I'       MGMSSQ                          CSW005
     C                     ENDIF                                                            MD034496
     C                     Z-ADDUOPAM     W#NAMT                          CSW005
     C                     ENDSL                                          CSW005
      *                                                                   CSW005
      **  Set workfields for calculated start date and amount             CSW005
     C                     Z-ADDDVDAT     W#CSDT  50                      CSW005
      *                                                                   CSW097
      **  Set count of succesful write to MGZ36NPD. This counter          CSW097
      **  will determine if maturity date record will be output.          CSW097
     C                     Z-ADD*ZERO     W#SWRT  30                      CSW097
      *                                                                   CSW005
      **  Partial key with DDLNO.                                         CSW005
     C           AMRKY     SETLLDLPCSCD0               71                 CSW005
      *                                                                   CSW005
     C           *IN71     IFEQ '0'                                       CSW005
     C                     READ DLPCSCD0               7170               CSW005
      *                                                                   CSW005
      **  Write to MGZ36NPD for every partial matched DLPCSCPD record.    CSW005
     C           *IN70     DOWEQ'0'                                       CSW005
     C           *IN71     ANDEQ'0'                                       CSW005
     C           DDLNO     ANDEQDLNO                                      CSW005
     C           WOTIN     ANDEQOTIN                                      CSW005
     C           PRDT      ANDLTW#MDAT                                                       BUG7911
      *                                                                   CSW005
      **  Calculation start date                                          CSW005
     C                     Z-ADDW#CSDT    MGCSDT                          CSW005
      *                                                                   CSW005
      **  Calculation end date                                            CSW005
     C                     Z-ADDPRDT      MGCEDT                          CSW005
      *                                                                   CSW097
     C********** MGCEDT    IFNE MDAT                                                  CSW097 BUG7911
     C           MGCEDT    IFNE W#MDAT                                                       BUG7911
     C                     SUB  1         MGCEDT                          CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW005
      **  Outstanding notional amount                                     CSW005
     C                     Z-ADDW#NAMT    MGOSNA                          CSW005
      *                                                                   CSW005
      **  Output MGZ36NPD record                                          CSW005
     C                     WRITEMGZ36ND0                                  CSW005
      *                                                                   CSW097
      **  Add 1 to counter                                                CSW097
     C                     ADD  1         W#SWRT                          CSW097
      *                                                                   CSW005
      **  Next calc. start date and amount                                CSW005
     C                     Z-ADDPRDT      W#CSDT                          CSW005
     C                     Z-ADDPAMT      W#NAMT                          CSW005
      *                                                                   CSW005
      **  Next record                                                     CSW005
     C                     READ DLPCSCD0               7170               CSW005
      *                                                                   CSW005
     C                     ENDDO                                          CSW005
      *                                                                   CSW005
     C                     ENDIF                                          CSW005
      *                                                                   CSW005
      **  Error in accessing DLPCSCPD                                     CSW005
     C           *IN71     IFEQ '1'                                       CSW005
     C           *LOCK     IN   LDA                                       CSW005
     C                     MOVE '035'     DBASE            * * * * * * * *CSW005
     C                     MOVELDDLNO     DBKEY            * DB ERROR 35 *CSW005
     C                     MOVEL'DLPCSCPD'DBFILE           * * * * * * * *CSW005
     C                     OUT  LDA                                       CSW005
     C                     EXSR *PSSR                                     CSW005
     C                     ENDIF                                          CSW005
      *                                                                   CSW005
      **  Last record for MGZ36NPD                                        CSW005
     C           W#SWRT    IFGT *ZERO                                     CSW097
     C                     Z-ADDW#CSDT    MGCSDT                          CSW005
     C**********           Z-ADDMDAT      MGCEDT                                      CSW005 BUG7911
     C                     Z-ADDW#MDAT    MGCEDT                                             BUG7911
     C                     Z-ADDW#NAMT    MGOSNA                          CSW005
     C                     WRITEMGZ36ND0                                  CSW005
     C                     ENDIF                                          CSW097
      *                                                                   CSW005
     C***********          ENDIF                                   CSW005 CSW097
      *                                                                   CSW005
     C                     ENDSR                                          CSW005
      *****************************************************************   CSW005
     C/EJECT                                                              CSW097
      *****************************************************************   CSW097
      *   SRCMPD - Output to compounding details file                 *   CSW097
      *   Called by - SRV36N                                          *   CSW097
      *   Calls - DLZFRQ                                              *   CSW097
      *****************************************************************   CSW097
      *                                                                   CSW097
     C           SRCMPD    BEGSR                                          CSW097
      *                                                                   CSW097
      ** If Interest Processing Method is "C" and                         CSW097
      ** Interest Rate Calendar feature (CIR001) is installed             CSW097
     C           W#INPM    IFEQ 'C'                                       CSW097
     C           CIR001    ANDEQ'Y'                                       CSW097
     C           W#INPM    OREQ 'A'                                       CIR006
     C           CIR006    ANDEQ'Y'                                       CIR006
      *                                                                   CSW097
      ** If Interest Payment Frequency = "Z", Output each record          CSW097
      ** from interest payment schedule file.                             CSW097
     C           W#IPFR    IFEQ 'Z'                                       CSW097
      *                                                                   CSW097
      ** Setup partial key                                                CSW097
     C                     MOVE *BLANK    @OTIN                           CSW097
     C           DTYP      IFEQ 'RS'                                      CSW097
     C           DTYP      OREQ 'RX'                                      CSW097
     C           MGMSSQ    IFEQ 'C'                                       CSW097
     C                     MOVE 'T'       @OTIN                           CSW097
     C                     ELSE                                           CSW097
     C           MGMSSQ    IFEQ 'F'                                       CSW097
     C                     MOVE 'U'       @OTIN                           CSW097
     C                     ENDIF                                          CSW097
     C                     ENDIF                                          CSW097
     C                     ENDIF                                          CSW097
     C                     MOVE 'P'       @RCIP                           CSW097
     C                     MOVE *LOVAL    @PRDT                           CSW097
      *                                                                   CSW097
      ** Set DLDTSCPD file pointer to partial key                         CSW097
     C           IRCKY2    SETLLDLDTSCPD                                  CSW097
     C                     READ DLDTSCPD                 70               CSW097
     C           *IN70     DOWEQ'0'                                       CSW097
     C           DDLNO     ANDEQDLNO                                      CSW097
     C           @OTIN     ANDEQOTIN                                      CSW097
     C           @RCIP     ANDEQRCIP                                      CSW097
     C                     Z-ADDPRDT      K@VDAT                          CSW097
     C           MGVKY     CHAINMGV36ND0             73                   CSW097
     C           *IN73     IFEQ *ON                                       CSW097
     C                     Z-ADDPRDT      MGCDAT                          CSW097
     C                     WRITEMGV36ND0                                  CSW097
     C                     ENDIF                                          CSW097
     C                     READ DLDTSCPD                 70               CSW097
     C                     ENDDO                                          CSW097
      *                                                                   CSW097
     C                     ELSE                                           CSW097
      *                                                                   CSW097
      ** Otherwise (W#IPFR <> "Z"), Output each interest payment date     CSW097
      ** calculated from the next interest payment to maturity date       CSW097
     C           W#NIPD    DOWLTMDAT                                      CSW097
     C           W#NIPD    ANDGT*ZERO                                     CSW097
      *                                                                   CSW097
     C                     Z-ADDW#NIPD    K@VDAT                          CSW097
     C           MGVKY     CHAINMGV36ND0             73                   CSW097
     C           *IN73     IFEQ *ON                                       CSW097
     C                     Z-ADDW#NIPD    MGCDAT                          CSW097
     C                     WRITEMGV36ND0                                  CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
      ** Determine next interest payment according to frequency           CSW097
     C                     MOVE W#SETM    ZFRSET                          CSW097
      *                                                                   CIR005
     C           CIR005    IFEQ 'Y'                                       CIR005
     C           WCYP1     ANDNE*BLANKS                                   CIR005
     C           W#IPFR    IFEQ *BLANKS                                   CIR005
     C                     Z-ADDMDAT      ZFRNXD                          CIR005
     C                     ELSE                                           CIR005
     C                     MOVE W#IPFD    ZMDAY                           CIR005
     C                     Z-ADDW#NIPD    ZDAYNO                          CIR005
     C                     MOVELW#IPFR    ZFREQ                           CIR005
     C                     MOVELBJSLCD    ZLOC                            CIR005
     C                     EXSR ZFRQB3                                    CIR005
      *                                                                   CIR005
     C                     CALL 'DLZIRP'                                  CIR005
     C                     PARM           ZDAYNO                          CIR005
     C                     PARM WCCYD2    PCURR                           CIR005
     C                     PARM WPDCN     PPDCN   2                       CIR005
     C                     PARM ZLOC      PLOCN                           CIR005
     C                     PARM           BJDFIN                          CIR005
     C                     PARM *ZEROS    PAJDT   50                      CIR005
     C                     PARM *ZEROS    PBSDT   50                      CIR005
      *                                                                   CIR005
     C           PAJDT     IFGE MDAT                                      CIR005
     C           PBSDT     ORGT MDAT                                      CIR005
     C                     Z-ADDMDAT      ZFRNXD                          CIR005
     C                     ELSE                                           CIR005
     C           WAMCN     IFEQ 'A'                                       CIR005
     C           W#NIPD    ORGE PAJDT                                     CIR005
     C                     Z-ADDPBSDT     ZFRNXD                          CIR005
     C                     ELSE                                           CIR005
     C                     Z-ADDPAJDT     ZFRNXD                          CIR005
     C                     ENDIF                                          CIR005
     C                     ENDIF                                          CIR005
     C                     ENDIF                                          CIR005
      *                                                                   CIR005
     C                     ELSE                                           CIR005
      *                                                                   CIR005
     C                     CALL 'DLZFRQ'                                  CSW097
     C                     PARM *BLANK    ZFRRTC  5                       CSW097
     C                     PARM W#NIPD    ZFRDAT  50       * Date         CSW097
     C                     PARM W#IPFR    ZFRFRQ  1        * Frequency    CSW097
     C                     PARM W#IPFD    ZFRBAS  20       * Base Day     CSW097
     C                     PARM           ZFRSET  20       * Sett.Meth    CSW097
     C                     PARM W#CUCY    ZFRCCY  3        * Currency     CSW097
     C**********           PARM W#STCY    ZSTCY   3        * Settl CSW097 167426
     C**********           PARM 'P'       ZRCIP   1        * R/P   CSW097 167426
     C                     PARM W#STCY    ZSTCY   3        * Settl        171312
     C                     PARM 'P'       ZRCIP   1        * R/P          171312
     C                     PARM W#NOSN    ZFRNOS  2        * Nostro       CSW097
     C                     PARM MDAT      ZFRMDT  50       * Mat.Date     CSW097
     C                     PARM           BKAPDT                          CSW097
     C                     PARM           BJSLCD                          CSW097
     C                     PARM           BJLCCY                          CSW097
     C                     PARM *ZERO     ZFRZBD  50       * BASE DATE    180466
     C                     PARM *ZERO     ZFRNXD  50       * Next Date    CSW097
      *                                                                   CSW097
     C           ZFRRTC    IFEQ '*ERR*'                                   CSW097
     C           *LOCK     IN   LDA                                       CSW097
     C                     MOVE '055'     DBASE            * * * * * * * *CSW097
     C                     MOVELZFRRTC    DBKEY            * DB ERROR 55 *CSW097
     C                     MOVEL'DLZFRQ'  DBFILE           * * * * * * * *CSW097
     C                     OUT  LDA                                       CSW097
     C                     EXSR *PSSR                                     CSW097
     C                     ENDIF                                          CSW097
     C                     ENDIF                                          CIR005
      *                                                                   CSW097
      **  New interest payment date                                       CSW097
     C                     Z-ADDZFRNXD    W#NIPD                          CSW097
     C                     ENDDO                                          CSW097
      *                                                                   CSW097
      ** End of W#IPFR =  "Z"                                             CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
      ** End of W#INPM = "C" and CIR001 = "Y"                             CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
      ** If Compounding of Interest feature (CIR002) is installed         CSW097
      ** or CIR006 is installed and interest processing method            CIR006
      ** is 'A', 'I' or 'L'.                                              CIR006
      *                                                                   CIR006
     C           CIR002    IFEQ 'Y'                                       CSW097
     C           CIR006    OREQ 'Y'                                       CIR006
     C           W#INPM    ANDEQ'A'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           W#INPM    ANDEQ'I'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           W#INPM    ANDEQ'L'                                       CIR006
     C/COPY WNCPYSRC,DL6305C034
      *                                                                   CSW097
      ** If Interest Rate Change Freq = "Z", for each Interest            CSW097
      ** Rate Change Date that does not coincide with the                 CSW097
      ** payment date from MGY36NPD, a record will be output to           CSW097
      ** MGV36NPD.                                                        CSW097
     C           W#ICFR    IFEQ 'Z'                                       CSW097
      ** Setup partial key                                                CSW097
     C                     MOVE *BLANK    @OTIN                           CSW097
     C           DTYP      IFEQ 'RS'                                      CSW097
     C           DTYP      OREQ 'RX'                                      CSW097
     C           MGMSSQ    IFEQ 'C'                                       CSW097
     C                     MOVE 'T'       @OTIN                           CSW097
     C                     ELSE                                           CSW097
     C           MGMSSQ    IFEQ 'F'                                       CSW097
     C                     MOVE 'U'       @OTIN                           CSW097
     C                     ENDIF                                          CSW097
     C                     ENDIF                                          CSW097
     C                     ENDIF                                          CSW097
     C                     MOVE 'R'       @RCIP                           CSW097
     C                     MOVE *LOVAL    @PRDT                           CSW097
      * Set DLDTSCPD file pointer to partial key                          CSW097
     C           IRCKY2    SETLLDLDTSCPD                                  CSW097
     C                     READ DLDTSCPD                 70               CSW097
     C           *IN70     DOWEQ'0'                                       CSW097
     C           DDLNO     ANDEQDLNO                                      CSW097
     C           @OTIN     ANDEQOTIN                                      CSW097
     C           @RCIP     ANDEQRCIP                                      CSW097
     C                     Z-ADDPRDT      MGCDAT                          CSW097
     C           MGYKY     CHAINMGY36NL0             70                   CSW097
     C           *IN70     IFEQ '1'                                       CSW097
     C                     Z-ADDMGCDAT    K@VDAT                          CSW097
     C           MGVKY     CHAINMGV36ND0             73                   CSW097
     C           *IN73     IFEQ *ON                                       CSW097
     C                     WRITEMGV36ND0                                  CSW097
     C                     ENDIF                                          CSW097
     C                     ENDIF                                          CSW097
     C                     READ DLDTSCPD                 70               CSW097
     C                     ENDDO                                          CSW097
      *                                                                   CSW097
     C                     ELSE                                           CSW097
      *                                                                   CSW097
      ** Otherwise, each Int Rate Change Date calculated from the         CSW097
      ** Next Rate Change Date to Maturity Date that does not             CSW097
      ** coincide with the payment date from MGY36NPD.                    CSW097
     C           W#NICD    DOWLTMDAT                                      CSW097
     C           W#NICD    ANDGT*ZERO                                     CSW097
     C                     Z-ADDW#NICD    MGCDAT                          CSW097
     C           MGYKY     CHAINMGY36NL0             70                   CSW097
     C           *IN70     IFEQ '1'                                       CSW097
     C                     Z-ADDMGCDAT    K@VDAT                          CSW097
     C           MGVKY     CHAINMGV36ND0             73                   CSW097
     C           *IN73     IFEQ *ON                                       CSW097
     C                     WRITEMGV36ND0                                  CSW097
     C                     ENDIF                                          CSW097
     C                     ENDIF                                          CSW097
      ** Determine next interest rate chg date according to frequency     CSW097
     C                     MOVE W#SETM    ZFRSET                          CSW097
      *                                                                   CIR005
     C           CIR005    IFEQ 'Y'                                       CIR005
     C           WCYP1     ANDNE*BLANKS                                   CIR005
     C           W#ICFR    IFEQ *BLANKS                                   CIR005
     C                     Z-ADDMDAT      ZFRNXD                          CIR005
     C                     ELSE                                           CIR005
     C                     MOVE W#ICFD    ZMDAY                           CIR005
     C                     Z-ADDW#NICD    ZDAYNO                          CIR005
     C                     MOVELW#ICFR    ZFREQ                           CIR005
     C                     MOVELBJSLCD    ZLOC                            CIR005
     C                     EXSR ZFRQB3                                    CIR005
      *                                                                   CIR005
     C                     CALL 'DLZIRP'                                  CIR005
     C                     PARM           ZDAYNO                          CIR005
     C                     PARM WCCYD2    PCURR                           CIR005
     C                     PARM WPDCN     PPDCN   2                       CIR005
     C                     PARM ZLOC      PLOCN                           CIR005
     C                     PARM           BJDFIN                          CIR005
     C                     PARM *ZEROS    PAJDT   50                      CIR005
     C                     PARM *ZEROS    PBSDT   50                      CIR005
      *                                                                   CIR005
     C           PAJDT     IFGT MDAT                                      CIR005
     C                     Z-ADDMDAT      ZFRNXD                          CIR005
     C                     ELSE                                           CIR005
     C           W#NICD    IFGE PAJDT                                     CIR005
     C                     Z-ADDPBSDT     ZFRNXD                          CIR005
     C                     ELSE                                           CIR005
     C                     Z-ADDPAJDT     ZFRNXD                          CIR005
     C                     ENDIF                                          CIR005
     C                     ENDIF                                          CIR005
     C                     ENDIF                                          CIR005
      *                                                                   CIR005
     C                     ELSE                                           CIR005
      *                                                                   CIR005
     C                     CALL 'DLZFRQ'                                  CSW097
     C                     PARM *BLANK    ZFRRTC  5                       CSW097
     C                     PARM W#NICD    ZFRDAT  50       * Date         CSW097
     C                     PARM W#ICFR    ZFRFRQ  1        * Frequency    CSW097
     C                     PARM W#ICFD    ZFRBAS  20       * Base Day     CSW097
     C                     PARM           ZFRSET  20       * Sett.Meth    CSW097
     C                     PARM W#CUCY    ZFRCCY  3        * Currency     CSW097
     C**********           PARM W#STCY    ZSTCY   3        * Settl CSW097 167426
     C**********           PARM 'R'       ZRCIP   1        * R/P   CSW097 167426
     C                     PARM W#STCY    ZSTCY   3        * Settl        171312
     C                     PARM 'R'       ZRCIP   1        * R/P          171312
     C                     PARM W#NOSN    ZFRNOS  2        * Nostro       CSW097
     C                     PARM MDAT      ZFRMDT  50       * Mat.Date     CSW097
     C                     PARM           BKAPDT                          CSW097
     C                     PARM           BJSLCD                          CSW097
     C                     PARM           BJLCCY                          CSW097
     C                     PARM *ZERO     ZFRZBD  50       * BASE DATE    180466
     C                     PARM *ZERO     ZFRNXD  50       * Next Date    CSW097
      *                                                                   CSW097
     C           ZFRRTC    IFEQ '*ERR*'                                   CSW097
     C           *LOCK     IN   LDA                                       CSW097
     C                     MOVE '056'     DBASE            * * * * * * * *CSW097
     C                     MOVELZFRRTC    DBKEY            * DB ERROR 56 *CSW097
     C                     MOVEL'DLZFRQ'  DBFILE           * * * * * * * *CSW097
     C                     OUT  LDA                                       CSW097
     C                     EXSR *PSSR                                     CSW097
     C                     ENDIF                                          CSW097
     C                     ENDIF                                          CIR005
      *                                                                   CSW097
      **  Next Rate Change Date                                           CSW097
     C                     Z-ADDZFRNXD    W#NICD                          CSW097
     C                     ENDDO                                          CSW097
      *                                                                   CSW097
      ** End of W#IPFR = "Z"                                              CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
      ** End of CIR002 = "Y"                                              CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
     C                     ENDSR                                          CSW097
      *****************************************************************   CSW097
     C/EJECT                                                              CSW097
      *****************************************************************   CSW097
      *   SRFCTR - DetermineFinancial Centre and Output to MGU36NPD.  *   CSW097
      *   Called by - SRU36N                                          *   CSW097
      *   Calls -                                                     *   CSW097
      *****************************************************************   CSW097
      *                                                                   CSW097
     C           SRFCTR    BEGSR                                          CSW097
      *                                                                   CSW097
      ** Initialise ISDA Financial Centre and                             CSW097
      ** Nostro Location Code workfields to blank                         CSW097
     C                     MOVE *BLANK    W#ISFC  4                       CSW097
     C                     MOVE *BLANK    W#NLCD  3                       CSW097
     C                     MOVE *BLANK    W#LOCN 30                       178970
     C           CIR005    IFEQ 'Y'                                       CIR005
     C                     EXSR SRBDCY                                    CIR005
     C                     ENDIF                                          CIR005
      *                                                                   CIR005
     C           CIR005    IFEQ 'N'                                       CIR005
     C           CIR005    OREQ 'Y'                                       CIR005
     C           WCNTR     ANDEQ0                                         CIR005
      *                                                                   CSW097
     C           W#SETM    IFEQ '01'                                      CSW097
     C           W#SETM    OREQ '07'                                      CSW097
     C           W#SETM    OREQ '08'                                      CSW097
     C                     CALL 'AONOSTR0'                                CSW097
     C                     PARM '*MSG   ' @RTCD   7                       CSW097
     C                     PARM '*KEY   ' @OPTN   7                       CSW097
     C                     PARM *BLANKS   P@CUST  6                       CSW097
     C                     PARM W#CYCD    P@CYCD  3                       CSW097
     C**********           PARM *BLANKS   P@ACCD  4                                    CSW097 CGL029
     C                     PARM *BLANKS   P@ACCD 10                                           CGL029
     C                     PARM *BLANKS   P@ACSN  2                       CSW097
     C                     PARM W#NOSN    P@NONB  2                       CSW097
     C                     PARM *BLANKS   P@BRCD  3                       CSW097
     C                     PARM *BLANKS   P@CSSN 10                       CSW097
     C                     PARM *BLANKS   P@PNOI  1                       CSW097
     C           SDNOST    PARM SDNOST    DSFDY                           CSW097
      *                                                                   CSW097
      ** Access Error                                                     CSW097
     C           @RTCD     IFNE *BLANKS                                   CSW097
     C           *LOCK     IN   LDA                                       CSW097
     C                     MOVE '050'     DBASE                           CSW097
     C                     MOVE P@CYCD    @WK5    5                       CSW097
     C                     MOVELP@NONB    @WK5                            CSW097
     C                     MOVEL@WK5      DBKEY                           CSW097
     C                     MOVEL'SDNOSTPD'DBFILE                          CSW097
     C                     OUT  LDA                                       CSW097
     C                     EXSR *PSSR                                     CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
      ** Nostro Location Code is the last 3 chars of Nostro Shortname     CSW097
     C                     MOVE A7NOSN    W#NLCD                          CSW097
     C           W#NLCD    IFEQ *BLANK                                    CSW097
     C                     CALL 'AOCURRR0'                                CSW097
     C                     PARM '*MSG   ' @RTCD                           CSW097
     C                     PARM '*KEY   ' @OPTN                           CSW097
     C                     PARM W#CYCD    @KEY3   3                       CSW097
     C           SDCURR    PARM SDCURR    DSSDY                           CSW097
      *                                                                   CSW097
     C           @RTCD     IFNE *BLANKS                                   CSW097
     C           *LOCK     IN   LDA                                       CSW097
     C                     MOVE '051'     DBASE            * * * * * * * *CSW097
     C                     MOVEL@KEY3     DBKEY            * DB ERROR 51 *CSW097
     C                     MOVEL'SDCURRPD'DBFILE           * * * * * * * *CSW097
     C                     OUT  LDA                                       CSW097
     C                     EXSR *PSSR                                     CSW097
     C                     ELSE                                           CSW097
     C                     MOVELA6DLOC    W#NLCD                          CSW097
     C                     ENDIF                                          CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
     C                     ELSE                                           CSW097
      *                                                                   CSW097
     C           W#SETM    IFEQ '02'                                      CSW097
     C           W#SETM    OREQ '12'                                      CSW097
     C           W#SETM    OREQ '06'                                      176772
     C           W#SETM    OREQ '00'                                      178583
     C                     CALL 'AOCURRR0'                                CSW097
     C                     PARM '*MSG   ' @RTCD                           CSW097
     C                     PARM '*KEY   ' @OPTN                           CSW097
     C                     PARM W#CYCD    @KEY3   3                       CSW097
     C           SDCURR    PARM SDCURR    DSSDY                           CSW097
      *                                                                   CSW097
     C           @RTCD     IFNE *BLANKS                                   CSW097
     C           *LOCK     IN   LDA                                       CSW097
     C                     MOVE '052'     DBASE            * * * * * * * *CSW097
     C                     MOVEL@KEY3     DBKEY            * DB ERROR 51 *CSW097
     C                     MOVEL'SDCURRPD'DBFILE           * * * * * * * *CSW097
     C                     OUT  LDA                                       CSW097
     C                     EXSR *PSSR                                     CSW097
     C                     ELSE                                           CSW097
     C                     MOVELA6DLOC    W#NLCD                          CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
     C                     ELSE                                           CSW097
     C                     MOVE BJSLCD    W#NLCD                          CSW097
     C                     ENDIF                                          CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
     C           W#NLCD    IFNE *BLANK                                    CSW097
     C                     CALL 'AOLOCNR0'                                CSW097
     C                     PARM           P@RTCD  7        B:Return code  CSW097
     C                     PARM '*KEY    'P@OPTN  7        I:Option       CSW097
     C                     PARM W#NLCD    P@LCCD  3        I:Key field    CSW097
     C           SDLOCN    PARM SDLOCN    DSFDY            O:Format       CSW097
      *                                                                   CSW097
     C           P@RTCD    IFNE *BLANKS                                   CSW097
     C********** *LOCK     IN   LDA                                                   CSW097 BUG8653
     C**********           MOVE '053'     DBASE                                       CSW097 BUG8653
     C**********           MOVELP@LCCD    DBKEY                                       CSW097 BUG8653
     C**********           MOVEL'SDLOCNPD'DBFILE                                      CSW097 BUG8653
     C**********           OUT  LDA                                                   CSW097 BUG8653
     C**********           EXSR *PSSR                                                 CSW097 BUG8653
     C                     MOVEL*BLANKS   W#ISFC                                             BUG8653
     C                     MOVEL*BLANKS   W#LOCN                                             BUG8653
     C                     ELSE                                           CSW097
     C                     MOVELDVISFC    W#ISFC                          CSW097
     C                     MOVELDVLCNM    W#LOCN                          178970
     C                     ENDIF                                          CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
      ** If ISDA Financial Centre workfield is not blank,                 CSW097
      ** then write new record to MGU36NPD file.                          CSW097
     C           W#ISFC    IFNE *BLANK                                    CSW097
      *                                                                   CSW097
     C                     MOVE W#ISFC    MGISFC                          CSW097
     C                     MOVE W#LOCN    LOCN36                          178970
     C                     MOVE MSEQ,X    MGMSSQ                          CSW097
     C                     WRITEMGU36ND0               40                 CSW097
      *                                                                   CSW097
      ** Error occur in writing record                                    CSW097
     C           *IN40     IFEQ '1'                                       CSW097
     C           *LOCK     IN   LDA                                       CSW097
     C                     MOVE '054'     DBASE            * * * * * * * *CSW097
     C                     MOVEL@TYP      DBKEY            * DB ERROR 54 *CSW097
     C                     MOVEL'MGU36NPD'DBFILE           * * * * * * * *CSW097
     C                     OUT  LDA                                       CSW097
     C                     EXSR *PSSR                                     CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
     C                     ENDIF                                          CSW097
     C                     ENDIF                                          CIR005
      *                                                                   CSW097
     C                     ENDSR                                          CSW097
      *****************************************************************   CSW097
     C/EJECT                                                              CSW005
      *****************************************************************   CSW005
      *   ISDAD - Set up ISDA details essential for messages.  Only   *   CSW005
      *   used if old data entered before CSW005 is on and not updated*   CSW005
      *****************************************************************   CSW005
      *                                                                   CSW005
     C           ISDAD     BEGSR                                          CSW005
      *                                                                   CSW005
     C           BQISDA    IFNE *BLANKS                                   CSW005
     C                     MOVELBQISDA    MGISDA                          CSW005
     C                     ELSE                                           CSW005
     C                     MOVEL'1991'    MGISDA                          CSW005
     C                     ENDIF                                          CSW005
     C*                                                                   CSW005
     C           BQAGTY    IFNE *BLANKS                                   CSW005
     C                     MOVELBQAGTY    MGAGTY                          CSW005
     C                     ELSE                                           CSW005
     C                     MOVEL'ISDA'    MGAGTY                          CSW005
     C                     ENDIF                                          CSW005
     C*                                                                   CSW005
     C           BQAGDT    IFNE *BLANKS                                   CSW005
     C***********          MOVELBQAGDT    MGAGDT                   CSW005 CSW097
     C                     MOVE BQAGDT    ZAGDT                           CSW097
     C                     EXSR SRAGDT                                    CSW097
     C                     Z-ADD@@VDT     MGAGDT                          CSW097
     C                     ELSE                                           CSW005
     C***********          MOVEL'871012'  MGAGDT                          CSW005
     C                     MOVEL'19871012'MGAGDT                          CSW005
     C                     ENDIF                                          CSW005
     C*                                                                   CSW005
     C           BQAGVV    IFNE *BLANKS                                   CSW005
     C***********          MOVELBQAGVV    MGAGVV                   CSW005 CSW097
     C                     MOVELBQAGVC    ZZ0004                          CSW097
     C                     MOVE BQAGVV    ZZ0004                          CSW097
     C                     MOVE ZZ0004    MGAGVV                          CSW097
     C                     ELSE                                           CSW005
     C***********          MOVEL'87'      MGAGVV                   CSW005 CSW097
     C                     MOVEL'1987'    MGAGVV                          CSW097
     C                     ENDIF                                          CSW005
     C*                                                                   CSW005
     C                     MOVE CNUM      @CUST                           CSW005
     C                     MOVE UCUCY     @CYCD                           CSW005
     C                     MOVE DTYP      @TRTY                           CSW005
      *                                                                   CSW005
     C                     CALL 'AOEXSTR0'                                CSW005
     C                     PARM *BLANKS   @RTCD                           CSW005
     C                     PARM '*KEY   ' @OPTN                           CSW005
     C                     PARM           @CYCD   3                       CSW005
     C                     PARM           @CUST   6                       CSW005
     C                     PARM           @TRTY   2                       CSW005
     C           SDEXST    PARM SDEXST    DS1DY                           CSW005
      *                                                                   CSW005
     C           @RTCD     IFNE *BLANKS                                   CSW005
      *                                                                   CSW005
     C                     MOVE 'AT'      @TRTY                           CSW005
     C                     CALL 'AOEXSTR0'                                CSW005
     C                     PARM *BLANKS   @RTCD                           CSW005
     C                     PARM '*KEY   ' @OPTN                           CSW005
     C                     PARM           @CYCD   3                       CSW005
     C                     PARM           @CUST   6                       CSW005
     C                     PARM           @TRTY   2                       CSW005
     C           SDEXST    PARM SDEXST    DS1DY                           CSW005
     C                     ENDIF                                          CSW005
      *                                                                   CSW005
     C           @RTCD     IFEQ *BLANKS                                   CSW005
     C           BYISDA    IFNE *BLANKS                                   CSW005
     C                     MOVE BYISDA    MGISDA                          CSW005
     C                     ENDIF                                          CSW005
     C           BYAGTY    IFNE *BLANKS                                   CSW005
     C                     MOVELBYAGTY    MGAGTY                          CSW005
     C                     ENDIF                                          CSW005
     C           BYAGDT    IFNE *BLANKS                                   CSW005
     C***********          MOVELBYAGDT    MGAGDT                   CSW005 CSW097
     C                     MOVE BYAGDT    ZAGDT                           CSW097
     C                     EXSR SRAGDT                                    CSW097
     C                     Z-ADD@@VDT     MGAGDT                          CSW097
     C                     ENDIF                                          CSW005
     C           BYAGVV    IFNE *BLANKS                                   CSW005
     C***********          MOVELBYAGVV    MGAGVV                   CSW005 CSW097
     C                     MOVE BYAGVV    ZZ0004                          CSW097
     C                     MOVELBYAGVC    ZZ0004                          CSW097
     C                     MOVE ZZ0004    MGAGVV                          CSW097
     C                     ENDIF                                          CSW005
     C                     ENDIF                                          CSW005
      *                                                                   CSW005
     C                     ENDSR                                          CSW005
      *****************************************************************   CSW005
     C/EJECT
      *****************************************************************
      *   DELT - Call cancellation/deletion control program (MG9200)  *
      ****Called*by*-*main*process*************************************   042844
      *   Called by - MSG  Produce message                            *   042844
      *****************************************************************
      *
     C           DELT      BEGSR
      *
      **  Call cancellation program with parameters of the deal number    E29588
      **  program type (CE = confirmation),                               E29588
      **  module id,                                                      E29588
      **  deal amendment value date (blank for input cycle),              E29588
      **  deal amendment sequence number (blank for input cycle),         E29588
      **  an indicator to determine if further processing is              E29588
      **   Nostro Transfers (blank),                                      E29588
      **  return Code ('E' indicates a DB error)                          E29588
      **  return Code ('C' indicates a 'CANCEL' confirmation required)    E31801
      *                                                                   CSW005
      **  Call new pgm MG9220 for FRA/IRS msgs if feature is *ON          CSW005
      **  and this kind of message is being processed.                    CSW005
      *                                                                   CSW005
     C********** RPTI      IFEQ 'Y'                                                  CSW213 MD023402
     C           RPTI      IFNE ' '                                                         MD023402
      *                                                                                       CSW213
     C                     MOVE *BLANK    MG922N  1                                           CSW213
      *                                                                                       CSW213
     C           @TYP      IFEQ '340'                                                         CSW213
     C           @TYP      OREQ '360'                                                         CSW213
     C           @TYP      OREQ '361'                                                         CSW213
      *                                                                                       CSW213
     C                     MOVELCNUM      PTRID                                               CSW213
      *                                                                                       CSW213
     C                     CALL 'MG922000'             97                                     CSW213
     C                     PARM CDLNO     TRNUM                                               CSW213
     C                     PARM           PTRID                                               CSW213
     C                     PARM 'FI'      MODID                                               CSW213
     C                     PARM           @TYP                                                CSW213
     C                     PARM *BLANKS   PTRAN  16                                           CSW213
     C                     PARM *BLANKS   @RTNC                                               CSW213
      *                                                                                       CSW213
     C                     MOVE 'Y'       MG922N                                              CSW213
      *                                                                                       CSW213
     C                     ELSE                                                               CSW213
      *                                                                                       CSW213
      **  Pass also the last swift confirmation sequence to know if a                         CSW213
      **  previous confo. was generated.                                                      CSW213
      *                                                                                       CSW213
     C                     Z-ADDRICFNR    TRSEQ                                               CSW213
     C                     MOVELCNUM      PTRID                                               CSW213
      *                                                                                       CSW213
     C                     CALL 'MG920000'             97                                     CSW213
     C                     PARM CDLNO     TRNUM                                               CSW213
     C                     PARM           PTRID   6                                           CSW213
     C                     PARM 'CE'      CALLP                                               CSW213
     C                     PARM 'DL'      MODID                                               CSW213
     C                     PARM           TRSEQ                                               CSW213
     C                     PARM *BLANKS   @RTNC                                               CSW213
     C                     PARM           @CLSS                                               CSW213
      *                                                                                       CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
      **  If Cancs/Dels programs ended with a DB error, use the LDA                           CSW213
      **  entries set up for that error                                                       CSW213
      *                                                                                       CSW213
     C           @RTNC     IFEQ 'E'                                                           CSW213
     C           *LOCK     IN   LDA                                                           CSW213
     C                     OUT  LDA                                                           CSW213
     C                     EXSR *PSSR                                                         CSW213
     C                     END                                                                CSW213
      *                                                                                       CSW213
      ** If CALL to Cancs/Dels programs ended abnormally                                      CSW213
      *                                                                                       CSW213
     C           *IN97     IFEQ '1'                                                           CSW213
     C           *LOCK     IN   LDA                                                           CSW213
     C                     Z-ADD11        DBASE            *************                      CSW213
     C                     MOVEL'MG920000'DBKEY            * DBERR 011 *                      CSW213
     C                     MOVEL*BLANKS   DBFILE           *************                      CSW213
      *                                                                                       CSW213
     C           CSW005    IFEQ 'Y'                                                           CSW213
     C           MG922N    ANDEQ'Y'                                                           CSW213
     C           CSW011    OREQ 'Y'                                                           CSW213
     C           MG922N    ANDEQ'Y'                                                           CSW213
     C                     MOVEL'MG922000'DBKEY                                               CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
     C                     OUT  LDA                                                           CSW213
     C                     EXSR *PSSR                                                         CSW213
      *                                                                                       CSW213
     C                     END                                                                CSW213
      *                                                                                       CSW213
      **  Produce a confirmation message with the codeword 'CANCEL'.                          CSW213
      **  This occurs when a deal is reversed to confirm the                                  CSW213
      **  mutually agreed cancellation of the contract.                                       CSW213
      *                                                                                       CSW213
     C           CHTP      IFEQ 'R'                                                           CSW213
     C           @RTNC     ANDEQ'C'                                                           CSW213
     C                     MOVE 'C'       MGCHTP                                              CSW213
     C                     END                                                                CSW213
      *                                                                                       CSW213
      **  Also if FRA/IRS messages is being processed and the deal was                        CSW213
      **  amended and a previous confo was already send,                                      CSW213
      **  produce a confirmation message with codeword 'AMEND'.                               CSW213
      *                                                                                       CSW213
     C           MG922N    IFEQ 'Y'                                                           CSW213
     C           CHTP      ANDEQ'A'                                                           CSW213
     C           @RTNC     ANDEQ'C'                                                           CSW213
     C                     MOVE 'A'       MGCHTP                                              CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
      ** If CDL008 is on and CLS Settlement on the deal was changed                           CSW213
      ** from 'Y' to 'N', generate a new MT300 with codeword 'NEWT'.                          CSW213
      *                                                                                       CSW213
     C           CDL008    IFEQ 'Y'                                                           CSW213
     C           CHTP      ANDEQ'A'                                                           CSW213
     C           @CLSS     ANDEQ'Y'                                                           CSW213
     C           CLSS      ANDEQ'N'                                                           CSW213
     C                     MOVE 'I'       MGCHTP                                              CSW213
     C                     END                                                                CSW213
      *                                                                                       CSW213
     C/COPY WNCPYSRC,DL6305C032                                                               CSW213
      *                                                                                       CSW213
     C           *LOCK     IN   LDA                                                           CSW213
     C                     MOVEL'DL6305  'DBPGM                                               CSW213
     C                     OUT  LDA                                                           CSW213
      *                                                                                       CSW213
     C                     ELSE                                                               CSW213
      *                                                                                       CSW213
     C                     MOVE *BLANK    MG9220  1                       CSW005
      *                                                                   CSW005
     C           @TYP      IFEQ '340'                                     CSW005
     C           @TYP      OREQ '360'                                     CSW005
     C           @TYP      OREQ '361'                                     CSW005
      *                                                                   CSW005
     C/COPY WNCPYSRC,DL6305C079                                                              LSC204A
     C                     CALL 'MG9220'               97                 CSW005
     C                     PARM CDLNO     TRNUM                           CSW005
     C                     PARM 'FI'      MODID                           CSW005
     C                     PARM           @TYP                            CSW005
     C                     PARM *BLANKS   PTRAN  16                       CSW005
     C                     PARM *BLANKS   @RTNC                           CSW005
     C/COPY WNCPYSRC,DL6305C080                                                              LSC204A
      *                                                                   CSW005
     C                     MOVE 'Y'       MG9220                          CSW005
      *                                                                   CSW005
     C                     ELSE                                           CSW005
      *
      **  Pass also the last swift confirmation sequence to know if a     CSW096
      **  previous confo. was generated.                                  CSW096
     C                     Z-ADDLSWC      TRSEQ                           CSW096
     C                     MOVE CDLNO     TRNUMA  6                                           CLE148
     C                     CALL 'MG9200'               97
     C**********           PARM CDLNO     TRNUM   60                                          CLE148
     C                     PARM           TRNUMA                                              CLE148
     C                     PARM 'CE'      CALLP   2
     C                     PARM 'DL'      MODID   2
     C                     PARM 0         TRVDT   50                      E29588
     C***********          PARM 0         TRSEQ   30                E29588CSW096
     C                     PARM           TRSEQ   30                      CSW096
     C                     PARM *BLANKS   REVNX   1
     C                     PARM *BLANKS   @RTNC   1
     C***********          PARM @TYP      @TYPE   3                157756 169025
     C                     PARM           @CLSS                           CDL008
      *                                                                   CSW005
     C                     ENDIF                                          CSW005
      *
      **  If Cancs/Dels programs ended with a DB error, use the LDA
      **  entries set up for that error
      *
     C           @RTNC     IFEQ 'E'
     C           *LOCK     IN   LDA
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END
      *
      ** If CALL to Cancs/Dels programs ended abnormally
      *
     C           *IN97     IFEQ '1'
     C           *LOCK     IN   LDA
     C                     MOVE '011'     DBASE            * * * * * * * *
     C                     MOVEL'MG9200'  DBKEY            *  DBERR 011  *
     C                     MOVEL*BLANKS   DBFILE           * * * * * * * *
     C           CSW005    IFEQ 'Y'                                       CSW005
     C           MG9220    ANDEQ'Y'                                       CSW005
     C           CSW011    OREQ 'Y'                                       CSW011
     C           MG9220    ANDEQ'Y'                                       CSW011
     C                     MOVEL'MG9220'  DBKEY                           CSW005
     C                     ENDIF                                          CSW005
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END
      *
      **  Produce a confirmation message with the codeword 'CANCEL'.
      **  This occurs when a deal is reversed to confirm the
      **  mutually agreed cancellation of the contract.
      *
     C           CHTP      IFEQ 'R'                                       E29588
     C           @RTNC     ANDEQ'C'                                       E31801
     C                     MOVE 'C'       MGCHTP
     C                     END                                            E29588
      *                                                                   CSW005
      **  Also if FRA/IRS messages is being processed and the deal was    CSW005
      **  amended and a previous confo was already send,                  CSW005
      **  produce a confirmation message with codeword 'AMEND'.           CSW005
      *                                                                   CSW005
     C           MG9220    IFEQ 'Y'                                       CSW005
     C           CHTP      ANDEQ'A'                                       CSW005
     C           @RTNC     ANDEQ'C'                                       CSW005
     C                     MOVE 'A'       MGCHTP                          CSW005
     C                     ENDIF                                          CSW005
      *                                                                   CDL008
      ** If CDL008 is on and CLS Settlement on the deal was changed       CDL008
      ** from 'Y' to 'N', generate a new MT300 with codeword 'NEWT'.      CDL008
      *                                                                   CDL008
     C           CDL008    IFEQ 'Y'                                       CDL008
     C           CHTP      ANDEQ'A'                                       CDL008
     C           @CLSS     ANDEQ'Y'                                       CDL008
     C           CLSS      ANDEQ'N'                                       CDL008
     C                     MOVE 'I'       MGCHTP                          CDL008
     C                     END                                            CDL008
      *                                                                   CDL008
     C/COPY WNCPYSRC,DL6305C032
      *                                                                   E32797
     C           *LOCK     IN   LDA                                       E32797
     C                     MOVEL'DL6305  'DBPGM                           E32797
     C                     OUT  LDA                                       E32797
      *                                                                                       CSW213
     C                     ENDIF                                                              CSW213
      *
     C                     ENDSR
      *****************************************************************
     C/EJECT
      *****************************************************************
      *   LORD - If deal is a loan or a deposit set up MGLORD field   *
      *   Called by - F320 F330                                       *
      *****************************************************************
      *
     C           LORD      BEGSR
      *
      **  Check deal type - loans
      *
     C           DTYP      IFEQ 'TI'
     C           DTYP      OREQ 'IP'
     C           DTYP      OREQ 'CL'
     C           DTYP      OREQ 'FL'                                      CDL006
     C           CDL006    ANDEQ'Y'                                       CDL006
     C           DTYP      OREQ 'DP'                                      CDL006
     C           CDL006    ANDEQ'Y'                                       CDL006
     C           DTYP      OREQ 'LP'                                      CDL006
     C           CDL006    ANDEQ'Y'                                       CDL006
     C                     MOVE 'L'       MGLORD
     C                     END
      *
      **  Check deal type - deposits
      *
     C           DTYP      IFEQ 'TD'
     C           DTYP      OREQ 'IT'
     C           DTYP      OREQ 'CD'
     C           DTYP      OREQ 'CI'
     C           DTYP      OREQ 'FT'                                      CDL006
     C           CDL006    ANDEQ'Y'                                       CDL006
     C           DTYP      OREQ 'DT'                                      CDL006
     C           CDL006    ANDEQ'Y'                                       CDL006
     C           DTYP      OREQ 'LT'                                      CDL006
     C           CDL006    ANDEQ'Y'                                       CDL006
     C                     MOVE 'D'       MGLORD
     C                     END
      *
     C                     ENDSR
     C/EJECT                                                              119626
      *****************************************************************   119626
      *   DELT2 - Call cancellation/deletion control program (MG9200).*   119626
      *           To process all existing messages for the current    *   119626
      *           CONEXCY record not requiring ISO Conf generation.   *   119626
      *           (RCDT = 'X').                                       *   119626
      *   Called by - MAIN.                                           *   119626
      *****************************************************************   119626
     C           DELT2     BEGSR                                          119626
      *                                                                   119626
      **  Call cancellation program with parameters of the deal number    119626
      **  program type (PR).                                              119626
      **  module id,                                                      119626
      **  deal amendment value date (blank for input cycle),              119626
      **  deal amendment sequence number (blank for input cycle),         119626
      **  an indicator to determine if further processing is              119626
      **   Nostro Transfers (blank),                                      119626
      **  return Code ('E' indicates a DB error)                          119626
      **  return Code ('C' indicates a 'CANCEL' confirmation required)    119626
      *                                                                   119626
      **  Pass also the last swift confirmation sequence to know if a     119626
      **  previous confo. was generated.                                  119626
     C           @TYP      IFEQ '340'                                                         242587
     C           @TYP      OREQ '360'                                                         242587
     C           @TYP      OREQ '361'                                                         242587
      *                                                                                       242587
     C                     CALL 'MG9220'               97                                     242587
     C                     PARM CDLNO     TRNUM                                               242587
     C                     PARM 'FI'      MODID                                               242587
     C                     PARM           @TYP                                                242587
     C                     PARM *BLANKS   PTRAN  16                                           242587
     C                     PARM *BLANKS   @RTNC                                               242587
      *                                                                                       242587
     C                     MOVE 'Y'       MG9220                                              242587
      *                                                                                       242587
     C                     ELSE                                                               242587
     C                     Z-ADDLSWC      TRSEQ                           119626
     C                     MOVE CDLNO     TRNUMA                                              CLE148
     C                     CALL 'MG9200'               97                 119626
     C**********           PARM CDLNO     TRNUM   60                                   119626 CLE148
     C                     PARM           TRNUMA                                              CLE148
     C*********************PARM 'CE'      CALLP   2                       119626
     C                     PARM 'PR'      CALLP   2                       119626
     C                     PARM 'DL'      MODID   2                       119626
     C                     PARM 0         TRVDT   50                      119626
     C                     PARM           TRSEQ   30                      119626
     C                     PARM *BLANKS   REVNX   1                       119626
     C                     PARM *BLANKS   @RTNC   1                       119626
     C***********          PARM @TYP      @TYPE   3                157756 169025
     C                     PARM           @CLSS                                               222373
     C                     ENDIF                                                              242587
      *                                                                   119626
      **  If Cancs/Dels programs ended with a DB error, use the LDA       119626
      **  entries set up for that error                                   119626
      *                                                                   119626
     C           @RTNC     IFEQ 'E'                                       119626
     C           *LOCK     IN   LDA                                       119626
     C                     OUT  LDA                                       119626
     C                     EXSR *PSSR                                     119626
     C                     END                                            119626
      *                                                                   119626
      ** If CALL to Cancs/Dels programs ended abnormally                  119626
      *                                                                   119626
     C           *IN97     IFEQ '1'                                       119626
     C           *LOCK     IN   LDA                                       119626
     C                     MOVE '012'     DBASE            * * * * * * * *119626
     C                     MOVEL'MG9200'  DBKEY            *  DBERR 012  *119626
     C                     MOVEL*BLANKS   DBFILE           * * * * * * * *119626
     C                     OUT  LDA                                       119626
     C                     EXSR *PSSR                                     119626
     C                     END                                            119626
      *                                                                   119626
      **  Produce a confirmation message with the codeword 'CANCEL'.      119626
      **  This occurs when a deal is reversed to confirm the              119626
      **  mutually agreed cancellation of the contract.                   119626
      *                                                                   119626
     C           CHTP      IFEQ 'R'                                       119626
     C           @RTNC     ANDEQ'C'                                       119626
     C                     MOVE 'C'       MGCHTP                          119626
     C                     END                                            119626
      *                                                                                       242587
      **  Also if FRA/IRS messages is being processed and the deal was                        242587
      **  amended and a previous confo was already send,                                      242587
      **  produce a confirmation message with codeword 'AMEND'.                               242587
      *                                                                                       242587
     C           MG9220    IFEQ 'Y'                                                           242587
     C           CHTP      ANDEQ'A'                                                           242587
     C           @RTNC     ANDEQ'C'                                                           242587
     C                     MOVE 'A'       MGCHTP                                              242587
     C                     ENDIF                                                              242587
      *                                                                   119626
     C           *LOCK     IN   LDA                                       119626
     C                     MOVEL'DL6305  'DBPGM                           119626
     C                     OUT  LDA                                       119626
      *                                                                   119626
     C                     ENDSR                                          119626
      *****************************************************************
     C/EJECT
      *****************************************************************
      *****************************************************************   137909
      *   STCY1- If CEU003 (EMU enhancement) is on set up Payment and *   137909
      *          Receipt settlement currencies.                       *   137909
      *   Called by - F300                                            *   137909
      *****************************************************************   137909
      *                                                                   137909
     C           STCY1     BEGSR                                          137909
      *                                                                   137909
      ** Move settlement currencies for FX deal.                          137909
      *                                                                   137909
      ** Use payment settlement currency if entered. Otherwise use        137909
      ** sell currency.                                                   137909
     C           PSCY      IFNE *BLANKS                                   137909
     C                     MOVE PSCY      MGPYCY                          137909
     C                     ELSE                                           137909
     C                     MOVE SLCY      MGPYCY                          137909
     C                     ENDIF                                          137909
      *                                                                   137909
      ** Use receipt settlement currency if entered. Otherwise use        137909
      ** buy currency.                                                    137909
     C           RSCY      IFNE *BLANKS                                   137909
     C                     MOVE RSCY      MGRCCY                          137909
     C                     ELSE                                           137909
     C                     MOVE PUCY      MGRCCY                          137909
     C                     ENDIF                                          137909
      *                                                                   137909
     C                     ENDSR                                          137909
     C/EJECT                                                              137909
      *****************************************************************   137909
      *****************************************************************   137909
      *   STCY2- If CEU003 (EMU enhancement) is on set up Payment and *   137909
      *          Receipt settlement currencies.                       *   137909
      *   Called by - F320 F321 F330                                  *   137909
      *****************************************************************   137909
      *                                                                   137909
     C           STCY2     BEGSR                                          137909
      *                                                                   137909
      ** Move settlement currency for MM deal.                            137909
      *                                                                   137909
      ** Use settlement currency if entered. Otherwise use deal           137909
      ** currency.                                                        137909
     C           STCY      IFNE *BLANKS                                   137909
     C                     MOVE STCY      MGSTCY                          137909
     C                     ELSE                                           137909
     C                     MOVE CCY       MGSTCY                          137909
     C                     ENDIF                                          137909
      *                                                                   137909
     C                     ENDSR                                          137909
     C/EJECT                                                              137909
      *****************************************************************   137909
      *****************************************************************   137909
      *   STCY3- If CEU003 (EMU enhancement) is on set up Payment and *   137909
      *          Receipt settlement currencies.                       *   137909
      *   Called by - F340                                            *   137909
      *****************************************************************   137909
      *                                                                   137909
     C           STCY3     BEGSR                                          137909
      *                                                                   137909
      ** Move settlement currency for FRA deal.                           137909
      *                                                                   137909
      ** Use receipt settlement currency if entered. Otherwise use deal   137909
      ** currency.                                                        137909
     C           RSCY      IFNE *BLANKS                                   137909
     C                     MOVE RSCY      MGSTCY                          137909
     C                     ELSE                                           137909
     C                     MOVE UCUCY     MGSTCY                          137909
     C                     ENDIF                                          137909
      *                                                                   137909
     C                     ENDSR                                          137909
     C/EJECT                                                              137909
      *****************************************************************   CSW097
      *   SRAGDT - Convert Agreement Date (YYMMDD) to YYYYMMDD format.*   CSW097
      *   Called by -                                                 *   CSW097
      *                                                               *   CSW097
      *****************************************************************   CSW097
      *                                                                   CSW097
     C           SRAGDT    BEGSR                                          CSW097
      *                                                                   CSW097
      ** Extract Year, Month, and Day from ZAGDT                          CSW097
      *                                                                                       224586
     C                     MOVE *BLANKS   YY                                                  224586
     C                     MOVE *BLANKS   MM                                                  224586
     C                     MOVE *BLANKS   DD                                                  224586
      *                                                                                       224586
     C                     MOVELZAGDT     YY      2                       CSW097
     C           2         SUBSTZAGDT:3   MM      2                       CSW097
     C                     MOVE ZAGDT     DD      2                       CSW097
      *                                                                   CSW097
      ** Set up input to SR/ZDATE1 (DDMMYY format)                        CSW097
     C                     MOVE *BLANKS   DDMMYY                                              210926
     C                     MOVELDD        DDMMYY  6                       CSW097
     C           DDMMYY    CAT  MM:0      DDMMYY                          CSW097
     C                     MOVE YY        DDMMYY                          CSW097
      *                                                                   CSW097
      ** Call SR/ZDATE1 to convert it to day number (ZDAYNO)              CSW097
     C                     MOVE DDMMYY    ZDATE                           CSW097
     C                     MOVE '0'       *IN98                           CSW097
     C                     EXSR ZDATE1                                    CSW097
      *                                                                   CSW097
      ** Call SR/ZDATE9 to convert ZDAYNO to YYYYMMDD format (@@VDT)      CSW097
     C                     Z-ADDZDAYNO    @@DAYN  50                      CSW097
     C                     EXSR ZDATE9                                    CSW097
      *                                                                   CSW097
     C                     ENDSR                                          CSW097
      *****************************************************************   CIR005
      /EJECT                                                              CIR005
      *****************************************************************   CIR005
      *  SRBDCY - Derivation of financial centres for each currency   *   CIR005
      *  Called by - SRFCTR                                           *   CIR005
      *                                                               *   CIR005
      *****************************************************************   CIR005
      *                                                                   CIR005
     C           SRBDCY    BEGSR                                          CIR005
      *                                                                   CIR005
     C           DTYP      IFEQ 'RX'                                      CIR005
      *                                                                   CIR005
      ** SWIFT 2015 Change: Re-label sequences I,K,M to J,L,N                               MD034496
      *                                                                                     MD034496
     C           MSEQ,X    IFEQ 'E'                                       CIR005
     C           MSEQ,X    OREQ 'F'                                       CIR005
     C           MSEQ,X    OREQ 'I'                                       CIR005
     C           CSW215    ANDEQ'N'                                                         MD034496
     C           MSEQ,X    OREQ 'J'                                                         MD034496
     C           CSW215    ANDEQ'Y'                                                         MD034496
     C           MSEQ,X    OREQ 'K'                                       CIR005
     C           CSW215    ANDEQ'N'                                                         MD034496
     C           MSEQ,X    OREQ 'L'                                                         MD034496
     C           CSW215    ANDEQ'Y'                                                         MD034496
     C           MSEQ,X    OREQ 'M'                                       CIR005
     C           CSW215    ANDEQ'N'                                                         MD034496
     C           MSEQ,X    OREQ 'N'                                                         MD034496
     C           CSW215    ANDEQ'Y'                                                         MD034496
     C                     Z-ADD1         WLEGP                           CIR005
     C                     ELSE                                           CIR005
     C                     Z-ADD2         WLEGP                           CIR005
     C                     ENDIF                                          CIR005
      *                                                                   CIR005
     C                     ELSE                                           CIR005
     C                     Z-ADD1         WLEGP   10                      CIR005
     C                     ENDIF                                          CIR005
      *                                                                   CIR005
      ***Leg*1*Rate*Fixing*Currencies***                                  CIR005             BUG6796
      ** Leg 1 Payment and Rate Change Currencies                                            BUG6796
      *                                                                   CIR005
     C           WLEGP     IFEQ 1                                         CIR005
     C**********           MOVEAWCCYD1    WRFCY                           CIR005             BUG6796
     C                     MOVEAWCCYD4    WRFCY                                              BUG6796
     C                     ELSE                                           CIR005
      *                                                                   CIR005
      ***Leg*2*Rate*Fixing*Currencies**                                   CIR005             BUG6796
      ** Leg 2 Payment and Rate Change Currencies                                            BUG6796
      *                                                                   CIR005
     C**********           MOVEAWCCYD3    WRFCY                           CIR005             BUG6796
     C                     MOVEAWCCYD5    WRFCY                                              BUG6796
     C                     ENDIF                                          CIR005
      *                                                                   CIR005
     C                     Z-ADD1         Y       20                      CIR005
     C                     Z-ADD0         WCNTR   20                      CIR005
      *                                                                   CIR005
     C           Y         DOWLE10                                        CIR005
     C           WRFCY,Y   ANDNE*BLANKS                                   CIR005
      *                                                                   CIR005
     C                     MOVE *BLANKS   W#ISFC                          CIR005
      *                                                                   CIR005
      ** Get Default Location code from SDCURRPD                          CIR005
      *                                                                   CIR005
     C                     CALL 'AOCURRR0'                                CIR005
     C                     PARM *BLANKS   PRTCD                           CIR005
     C                     PARM '*KEY   ' POPTN                           CIR005
     C                     PARM WRFCY,Y   PCCY    3                       CIR005
     C           SDCURR    PARM SDCURR    DSSDY                           CIR005
      *                                                                   CIR005
     C           PRTCD     IFNE *BLANKS                                   CIR005
     C           *LOCK     IN   LDA                                       CIR005
     C                     MOVE '058'     DBASE            * * * * * * * *CIR005
     C                     MOVELPCCY      DBKEY            * DB ERROR 58 *CIR005
     C                     MOVEL'SDCURRPD'DBFILE           * * * * * * * *CIR005
     C                     OUT  LDA                                       CIR005
     C                     EXSR *PSSR                                     CIR005
     C                     ENDIF                                          CIR005
      *                                                                   CIR005
     C           A6DLOC    IFNE *BLANKS                                   CIR005
      *                                                                   CIR005
      ** Get Finacial Centre from SDLOCNPD                                CIR005
      *                                                                   CIR005
     C                     CALL 'AOLOCNR0'                                CIR005
     C                     PARM *BLANKS   PRTCD                           CIR005
     C                     PARM '*KEY   ' POPTN                           CIR005
     C                     PARM A6DLOC    PLOC    3                       CIR005
     C           SDLOCN    PARM SDLOCN    DSFDY                           CIR005
      *                                                                   CIR005
     C           PRTCD     IFNE *BLANKS                                   CIR005
     C           *LOCK     IN   LDA                                       CIR005
     C                     MOVE '059'     DBASE            * * * * * * * *CIR005
     C                     MOVELPLOC      DBKEY            * DB ERROR 59 *CIR005
     C                     MOVEL'SDLOCNPD'DBFILE           * * * * * * * *CIR005
     C                     OUT  LDA                                       CIR005
     C                     EXSR *PSSR                                     CIR005
     C                     ENDIF                                          CIR005
      *                                                                   CIR005
     C                     MOVELDVISFC    W#ISFC                          CIR005
     C           W#ISFC    IFNE *BLANKS                                   CIR005
     C                     ADD  1         WCNTR                           CIR005
     C                     MOVELW#ISFC    MGISFC                          CIR005
     C                     MOVELMSEQ,X    MGMSSQ                          CIR005
     C           WMGUKY    CHAINMGU36NPD            N40                   CIR005
      *                                                                   CIR005
     C           *IN40     IFEQ '1'                                       CIR005
     C                     WRITEMGU36ND0               40                 CIR005
      *                                                                   CIR005
      ** Error occur in writing record                                    CIR005
      *                                                                   CIR005
     C           *IN40     IFEQ '1'                                       CIR005
     C           *LOCK     IN   LDA                                       CIR005
     C                     MOVE '060'     DBASE            * * * * * * * *CIR005
     C                     MOVEL@TYP      DBKEY            * DB ERROR 60 *CIR005
     C                     MOVEL'MGU36NPD'DBFILE           * * * * * * * *CIR005
     C                     OUT  LDA                                       CIR005
     C                     EXSR *PSSR                                     CIR005
     C                     ENDIF                                          CIR005
     C                     ENDIF                                          CIR005
     C                     ENDIF                                          CIR005
     C                     ENDIF                                          CIR005
      *                                                                   CIR005
     C                     ADD  1         Y                               CIR005
      *                                                                   CIR005
     C                     ENDDO                                          CIR005
      *                                                                   CIR005
     C                     ENDSR                                          CIR005
      *****************************************************************                      BUG5646
      /EJECT                                                                                 BUG5646
      *****************************************************************                      BUG5646
      *  CHKNSW - Check if Settlement was changed from Swift to       *                      BUG5646
      *           Non-Swift.                                          *                      BUG5646
      *  Called by -                                                  *                      BUG5646
      *                                                               *                      BUG5646
      *****************************************************************                      BUG5646
      *                                                                                      BUG5646
     C           CHKNSW    BEGSR                                                             BUG5646
      *                                                                                      BUG5646
     C           NONSWK    KLIST                                                             BUG5646
     C                     KFLD           KMTRN  15                                          BUG5646
     C                     KFLD           KDATE   60                                         BUG5646
     C                     KFLD           KTIME   60                                         BUG5646
      *                                                                                      BUG5646
     C                     MOVE 'N'       PRXST                                              BUG5646
     C                     MOVEL*BLANKS   KMTRN                                              BUG5646
     C                     MOVELCDLNO     KMTRN                                              BUG5646
     C                     MOVE *HIVAL    KDATE                                              BUG5646
     C                     MOVE *HIVAL    KTIME                                              BUG5646
      *                                                                                      BUG5646
     C           DRCDT     IFEQ 'C'                                                          BUG5646
     C           DRCDT     OREQ 'D'                                                          BUG5646
     C           DRCDT     OREQ 'E'                                                          BUG5646
     C                     MOVE CCY       MMPCCY  3                                          BUG5646
     C                     MOVE CCY       MMRCCY  3                                          BUG5646
     C                     ENDIF                                                             BUG5646
      *                                                                                      BUG5646
     C           DRCDT     IFEQ 'B'                                                          BUG5646
     C                     MOVE SLCY      MMPCCY                                             BUG5646
     C                     MOVE PUCY      MMRCCY                                             BUG5646
     C                     ENDIF                                                             BUG5646
      *                                                                                      BUG5646
     C           NONSWK    SETGTMGOREFD0                                                     BUG5646
     C           *IN69     DOWEQ*OFF                                                         BUG5646
     C           PRXST     ANDEQ'N'                                                          BUG5646
      *                                                                                      BUG5646
     C           KMTRN     REDPEMGOREFD0                 69                                  BUG5646
      *                                                                                      BUG5646
     C           PSTM      IFNE 08                                                           BUG5646
     C********** PSTM      ANDNE01                                                    BUG5646 238445
      *                                                                                      BUG5646
     C           MTPY      IFEQ '202'                                                        BUG5646
     C           MTPY      OREQ '103'                                                        BUG5646
     C                     MOVE 'Y'       PRXST   1                                          BUG5646
     C                     ENDIF                                                             BUG5646
      *                                                                                      BUG5646
     C                     ELSE                                                              BUG5646
      *                                                                                      BUG5646
     C                     CALL 'AONOSTR0'                                                   BUG5646
     C                     PARM '*MSG   ' MNRTCD  7                                          BUG5646
     C                     PARM '*KEY   ' @OPTN                                              BUG5646
     C                     PARM *BLANKS   P@CUST                                             BUG5646
     C                     PARM MMPCCY    P@CYCD                                             BUG5646
     C                     PARM *BLANKS   P@ACCD                                             BUG5646
     C                     PARM *BLANKS   P@ACSN                                             BUG5646
     C                     PARM PONS      P@NONB                                             BUG5646
     C                     PARM *BLANKS   P@BRCD                                             BUG5646
     C                     PARM *BLANKS   P@CSSN                                             BUG5646
     C                     PARM *BLANKS   P@PNOI                                             BUG5646
     C           SDNOST    PARM SDNOST    DSFDY                                              BUG5646
      *                                                                                      BUG5646
     C                     MOVE *BLANKS   MKEY1  10                                          BUG5646
     C                     CALL 'AOCUSTR0'                                                   BUG5646
     C                     PARM '*MSG   ' MCRTCD  7                                          BUG5646
     C                     PARM '*KEY   ' @OPTN                                              BUG5646
     C                     PARM A7CUST    MKEY1                                              BUG5646
     C                     PARM *BLANKS   @KYST                                              BUG5646
     C           SDCUST    PARM SDCUST    DSSDY                                              BUG5646
      *                                                                                      BUG5646
     C           A7CLSD    IFEQ 'Y'                                                          BUG5646
     C           MNRTCD    ANDEQ*BLANKS                                                      BUG5646
     C           BBCSID    OREQ *BLANKS                                                      BUG5646
     C           MCRTCD    ANDEQ*BLANKS                                                      BUG5646
     C           MTPY      IFEQ '202'                                                        BUG5646
     C           MTPY      OREQ '103'                                                        BUG5646
     C                     MOVE 'Y'       PRXST   1                                          BUG5646
     C                     ENDIF                                                             BUG5646
     C                     ENDIF                                                             BUG5646
      *                                                                                      BUG5646
     C                     ENDIF                                                             BUG5646
      *                                                                                      BUG5646
     C           RSTM      IFNE 08                                                           BUG5646
     C           RSTM      ANDNE01                                                           BUG5646
     C           MTPY      IFEQ '210'                                                        BUG5646
     C                     MOVE 'Y'       PRXST                                              BUG5646
     C                     ENDIF                                                             BUG5646
      *                                                                                      BUG5646
     C                     ELSE                                                              BUG5646
      *                                                                                      BUG5646
     C                     CALL 'AONOSTR0'                                                   BUG5646
     C                     PARM '*MSG   ' @RTCD                                              BUG5646
     C                     PARM '*KEY   ' @OPTN                                              BUG5646
     C                     PARM *BLANKS   P@CUST                                             BUG5646
     C                     PARM MMRCCY    P@CYCD                                             BUG5646
     C                     PARM *BLANKS   P@ACCD                                             BUG5646
     C                     PARM *BLANKS   P@ACSN                                             BUG5646
     C                     PARM RONS      P@NONB                                             BUG5646
     C                     PARM *BLANKS   P@BRCD                                             BUG5646
     C                     PARM *BLANKS   P@CSSN                                             BUG5646
     C                     PARM *BLANKS   P@PNOI                                             BUG5646
     C           SDNOST    PARM SDNOST    DSFDY                                              BUG5646
      *                                                                                      BUG5646
     C                     MOVE *BLANKS   MKEY1                                              BUG5646
     C                     CALL 'AOCUSTR0'                                                   BUG5646
     C                     PARM '*MSG   ' MCRTCD                                             BUG5646
     C                     PARM '*KEY   ' @OPTN                                              BUG5646
     C                     PARM A7CUST    MKEY1                                              BUG5646
     C                     PARM *BLANKS   @KYST                                              BUG5646
     C           SDCUST    PARM SDCUST    DSSDY                                              BUG5646
      *                                                                                      BUG5646
     C           A7CLSD    IFEQ 'Y'                                                          BUG5646
     C           MNRTCD    ANDEQ*BLANKS                                                      BUG5646
     C           BBCSID    OREQ *BLANKS                                                      BUG5646
     C           MCRTCD    ANDEQ*BLANKS                                                      BUG5646
     C           MTPY      IFEQ '210'                                                        BUG5646
     C                     MOVE 'Y'       PRXST                                              BUG5646
     C                     ENDIF                                                             BUG5646
     C                     ENDIF                                                             BUG5646
      *                                                                                      BUG5646
     C                     ENDIF                                                             BUG5646
      *                                                                                      BUG5646
     C                     ENDDO                                                             BUG5646
      *                                                                                      BUG5646
     C                     ENDSR                                                             BUG5646
      *****************************************************************                      BUG5646
      /EJECT                                                                                 BUG5646
      *****************************************************************                     AR582922
      *  CHKMNI - CHECK IF NEXT INTEREST PAYMENT DATE OR MATURITY     *                     AR582922
      *           DATE WAS AMENDED.                                   *                     AR582922
      *                                                               *                     AR582922
      *  CALLED BY -  MAIN PROCESS                                    *                     AR582922
      *                                                               *                     AR582922
      *****************************************************************                     AR582922
      *                                                                                     AR582922
     C           CHKMNI    BEGSR                                                            AR582922
      *                                                                                     AR582922
     C           NONMNI    KLIST                                                            AR582922
     C                     KFLD           GMODI   2                                         AR582922
     C                     KFLD           GMTRN  15                                         AR582922
      *                                                                                     AR582922
     C                     MOVE 'N'       WMDAT   1                                         AR582922
     C                     MOVE 'N'       WNIDT   1                                         AR582922
     C                     MOVEL*BLANKS   GMTRN                                             AR582922
     C                     MOVELCDLNO     GMTRN                                             AR582922
     C                     MOVEL'DL'      GMODI                                             AR582922
      *                                                                                     AR582922
     C           NONMNI    SETGTMGOREFD3                                                    AR582922
     C           *IN74     DOWEQ*OFF                                                        AR582922
     C           PRMNI     ANDEQ'N'                                                         AR582922
      *                                                                                     AR582922
     C           NONMNI    REDPEMGOREFD3                 74                                 AR582922
      *                                                                                     AR582922
     C           *IN74     IFEQ *OFF                                                        AR582922
     C                     MOVE *BLANKS   DYMYR                                             AR582922
     C                     MOVELSVDT      YR1                                               AR582922
     C                     MOVE SVDT      DY1                                               AR582922
     C                     MOVE SVDT      MDY     40                                        AR582922
     C                     MOVELMDY       MT1                                               AR582922
     C                     MOVE DYMYR     ZDATE                                             AR582922
     C                     EXSR ZDATE1                                                      AR582922
     C                     Z-ADDZDAYNO    VALDT   50                                        AR582922
      *                                                                                     AR582922
     C           DVDAT     IFNE VALDT                                                       AR582922
     C           MTPY      IFEQ '202'                                                       AR582922
     C           MTPY      OREQ '210'                                                       AR582922
     C           MTPY      OREQ '103'                                                       AR582922
      *                                                                                     AR582922
     C           MDAT      IFNE VALDT                                                       AR582922
     C           NIDT      ANDNEVALDT                                                       AR582922
     C           WMDAT     OREQ 'Y'                                                         AR582922
     C           NIDT      ANDNEVALDT                                                       AR582922
     C           NIDT      ANDNE0                                                           AR916823
     C           WNIDT     OREQ 'Y'                                                         AR582922
     C           MDAT      ANDNEVALDT                                                       AR582922
     C           MDAT      ANDNE0                                                           AR916823
      *                                                                                     AR582922
     C           MDAT      OREQ VALDT                                                       AR582922
     C           NIDT      ANDNE0                                                           AR582922
     C                     MOVE 'Y'       PRMNI                                             AR582922
      *                                                                                     AR582922
     C                     ELSE                                                             AR582922
     C           MDAT      IFEQ VALDT                                                       AR582922
     C                     MOVE 'Y'       WMDAT                                             AR582922
     C                     ENDIF                                                            AR582922
      *                                                                                     AR582922
     C           NIDT      IFEQ VALDT                                                       AR582922
     C                     MOVE 'Y'       WNIDT                                             AR582922
     C                     ENDIF                                                            AR582922
      *                                                                                     AR582922
     C           WMDAT     IFEQ 'Y'                                                         AR582922
     C           WNIDT     ANDEQ'Y'                                                         AR582922
     C                     LEAVE                                                            AR582922
     C                     ENDIF                                                            AR582922
     C                     ENDIF                                                            AR582922
     C                     ENDIF                                                            AR582922
     C                     ENDIF                                                            AR582922
     C                     ENDIF                                                            AR582922
     C                     ENDDO                                                            AR582922
      *                                                                                     AR582922
     C                     ENDSR                                                            AR582922
      *****************************************************************                     AR582922
      /EJECT                                                                                AR582922
      *****************************************************************                       242622
      *  CHKMUL - Check if there are settlements that are part of a   *                       242622
      *           multiple message.                                   *                       242622
      *  Called by -                                                  *                       242622
      *                                                               *                       242622
      *****************************************************************                       242622
      *                                                                                       242622
     C           CHKMUL    BEGSR                                                              242622
      *                                                                                       242622
     C                     MOVE 'N'       PRMUL                                               242622
     C                     MOVEL*BLANKS   MMTRN  15                                           242622
     C                     MOVELCDLNO     MMTRN                                               242622
     C                     MOVE *OFF      *IN69                                               242622
      *                                                                                       242622
     C           MMTRN     SETLLMGOREFD2                                                      242622
     C           *IN69     DOWEQ*OFF                                                          242622
     C           PRMUL     ANDEQ'N'                                                           242622
      *                                                                                       242622
     C           MMTRN     READEMGOREFD2                 69                                   242622
      *                                                                                       242622
     C           CARQ      IFNE 'Y'                                                           242622
     C           MTPY      IFEQ '203'                                                         242622
     C           MTPY      OREQ '210'                                                         242622
     C           TRNF      ANDNE*BLANKS                                                       242622
     C           MTPY      OREQ '210'                                                         242622
     C           TRNM      ANDNE*BLANKS                                                       242622
     C                     MOVE 'Y'       PRMUL                                               242622
     C                     ENDIF                                                              242622
     C                     ENDIF                                                              242622
      *                                                                                       242622
     C                     ENDDO                                                              242622
      *                                                                                       242622
     C                     ENDSR                                                              242622
      *****************************************************************                       242622
      /EJECT                                                                                  242622
      *****************************************************************                       240603
      *  CHKNET - Check if Buy / Sell Net Indicator is 'Y' then       *                       240603
      *           cancel messages                                     *                       240603
      *****************************************************************                       240603
     C           CHKNET    BEGSR                                                              240603
      *                                                                                       240603
     C           NETMSG    KLIST                                                              240603
     C                     KFLD           KMTRN                                               240603
     C                     KFLD           KDATE                                               240603
     C                     KFLD           KTIME                                               240603
      *                                                                                       240603
     C                     MOVE 'N'       PRXST                                               240603
     C                     MOVEL*BLANKS   KMTRN                                               240603
     C                     MOVELCDLNO     KMTRN                                               240603
     C                     MOVE *HIVAL    KDATE                                               240603
     C                     MOVE *HIVAL    KTIME                                               240603
      *                                                                                       240603
     C           NETMSG    SETGTMGOREFD0                                                      240603
     C           *IN68     DOWEQ*OFF                                                          240603
     C           PRXST     ANDEQ'N'                                                           240603
      *                                                                                       240603
     C           KMTRN     REDPEMGOREFD0                 68                                   240603
     C           NETBY     IFEQ 'Y'                                                           240603
     C           MTPY      IFEQ '210'                                                         240603
     C           MTPY      OREQ '103'                                                         240603
     C                     MOVE 'Y'       PRXST                                               240603
     C                     END                                                                240603
     C                     END                                                                240603
      *                                                                                       240603
     C           NETSL     IFEQ 'Y'                                                           240603
     C           MTPY      IFEQ '202'                                                         240603
     C                     MOVE 'Y'       PRXST                                               240603
     C                     END                                                                240603
     C                     END                                                                240603
      *                                                                                       240603
     C                     END                                                                240603
     C                     ENDSR                                                              240603
      *****************************************************************                       240603
      /EJECT                                                                                  240603
      *****************************************************************                     AR916823
      *  CHKMSG - Check if there is a new Pay/Rec message to be       *                     AR916823
      *           generated                                           *                     AR916823
      *                                                               *                     AR916823
      *  Called by -  Main Process                                    *                     AR916823
      *                                                               *                     AR916823
      *****************************************************************                     AR916823
      *                                                                                     AR916823
     C           CHKMSG    BEGSR                                                            AR916823
      *                                                                                     AR916823
     C                     MOVE 'N'       WMSG    1                                         AR916823
     C                     MOVEL*BLANKS   GMTRN                                             AR916823
     C                     MOVELCDLNO     GMTRN                                             AR916823
     C                     MOVEL'DL'      GMODI                                             AR916823
     C                     MOVE '0'       *IN75                                             AR916823
      *                                                                                     AR916823
     C           CDLNO     SETGTDTRIXL7                                                     AR916823
     C           CDLNO     REDPEDTRIXL7                  75                                 AR916823
      *                                                                                     AR916823
     C           *IN75     IFEQ '0'                                                         AR916823
     C           PRI2      ANDEQ1                                                           AR916823
     C           *IN75     OREQ '0'                                                         AR916823
     C           PRI3      ANDEQ1                                                           AR916823
      *                                                                                     AR916823
     C           NONMNI    SETGTMGOREFD3                                                    AR916823
     C           *IN76     DOWEQ*OFF                                                        AR916823
      *                                                                                     AR916823
     C           NONMNI    REDPEMGOREFD3                 76                                 AR916823
      *                                                                                     AR916823
     C           *IN76     IFEQ *OFF                                                        AR916823
     C           MTPY      IFEQ '202'                                                       AR916823
     C           MTPY      OREQ '210'                                                       AR916823
     C           MTPY      OREQ '103'                                                       AR916823
     C                     MOVE *BLANKS   DYMYR                                             AR916823
     C                     MOVELSVDT      YR1                                               AR916823
     C                     MOVE SVDT      DY1                                               AR916823
     C                     MOVE SVDT      MDY     40                                        AR916823
     C                     MOVELMDY       MT1                                               AR916823
     C                     MOVE DYMYR     ZDATE                                             AR916823
     C                     EXSR ZDATE1                                                      AR916823
     C                     Z-ADDZDAYNO    VALDT   50                                        AR916823
      *                                                                                     AR916823
     C           DVDAT     IFNE VALDT                                                       AR916823
     C           EVTP      ANDEQ*BLANKS                                                     AR916823
     C           MDAT      IFEQ VALDT                                                       AR916823
     C           NIDT      OREQ VALDT                                                       AR916823
     C                     MOVE 'Y'       WMSG                                              AR916823
     C                     ENDIF                                                            AR916823
     C                     ENDIF                                                            AR916823
     C                     ENDIF                                                            AR916823
     C                     ENDIF                                                            AR916823
     C                     ENDDO                                                            AR916823
     C                     ENDIF                                                            AR916823
      *                                                                                     AR916823
     C                     ENDSR                                                            AR916823
      *****************************************************************                     AR916823
      /EJECT                                                                                AR916823
      *****************************************************************                       242587
      *  CHKFRA - Check if Forward Rate Agreement is amendended to    *                       242587
      *           cancel message previously generated                 *                       242587
      *****************************************************************                       242587
     C           CHKFRA    BEGSR                                                              242587
      *                                                                                       242587
     C           FRAMSG    KLIST                                                              242587
     C                     KFLD           KMTRN                                               242587
     C                     KFLD           KDATE                                               242587
     C                     KFLD           KTIME                                               242587
      *                                                                                       242587
     C                     MOVE 'N'       PRXST                                               242587
     C                     MOVEL*BLANKS   KMTRN                                               242587
     C                     MOVELCDLNO     KMTRN                                               242587
     C                     MOVE *HIVAL    KDATE                                               242587
     C                     MOVE *HIVAL    KTIME                                               242587
      *                                                                                       242587
     C           FRAMSG    SETGTMGOREFD1                                                      242587
     C           *IN67     DOWEQ*OFF                                                          242587
     C           PRXST     ANDEQ'N'                                                           242587
      *                                                                                       242587
     C           KMTRN     REDPEMGOREFD1                 67                                   242587
     C           MTPY      IFEQ '340'                                                         242587
     C           MTPY      OREQ '360'                                                         242587
     C           MTPY      OREQ '361'                                                         242587
     C                     MOVE 'Y'       PRXST                                               242587
     C                     END                                                                242587
     C                     END                                                                242587
      *                                                                                       242587
     C                     ENDSR                                                              242587
      *****************************************************************                       242587
      /EJECT                                                                                  242587
      *****************************************************************                       234068
      *                                                               *                       234068
      *  SRCHKD - Subroutine to check the effectivity date            *                       234068
      *                                                               *                       234068
      *****************************************************************                       234068
     C           SRCHKD    BEGSR                                                              234068
      *                                                                                       234068
      ** Access the Branch details to get location code                                       234068
      *                                                                                       234068
     C                     CALL 'AOBRCHR0'                                                    234068
     C                     PARM '*MSG    'PRTCD                                               234068
     C                     PARM '*KEY    'POPTN                                               234068
     C                     PARM DBRCA     PDSNB   3                                           234068
     C           SDBRCH    PARM SDBRCH    DSFDY                                               234068
      *                                                                                       234068
     C           PRTCD     IFNE *BLANKS                                                       234068
     C                     ENDIF                                                              234068
      *                                                                                       234068
      ** Access the Country of Tax using the branch's location code                           234068
      *                                                                                       234068
     C                     CALL 'AOLOCNR0'                                                    234068
     C                     PARM *BLANKS   PRTCD                                               234068
     C                     PARM '*KEY   ' POPTN                                               234068
     C                     PARM A8LCCD    PLOCN   3                                           234068
     C           SDLOCN    PARM SDLOCN    DSFDY                                               234068
      *                                                                                       234068
     C           PRTCD     IFNE *BLANKS                                                       234068
     C                     ENDIF                                                              234068
      *                                                                                       234068
      ** Retreive the country of residence of the customer                                    234068
      *                                                                                       234068
     C                     CALL 'AOCUSTR0'                                                    234068
     C                     PARM *BLANKS   PRTCD                                               234068
     C                     PARM '*KEY   ' POPTN                                               234068
     C                     PARM WCNUM     PCNUM  10                                           234068
     C                     PARM           PKEYS   7                                           234068
     C           SDCUST    PARM SDCUST    DSSDY                                               234068
      *                                                                                       234068
     C           PRTCD     IFNE *BLANKS                                                       234068
     C                     ENDIF                                                              234068
      *                                                                                       234068
      ** Retrieve effective date                                                              234068
      *                                                                                       234068
     C                     CALL 'AOCTTXR0'                                                    234068
     C                     PARM *BLANKS   PRTCD                                               234068
     C                     PARM '*KEY   ' POPTN                                               234068
     C                     PARM DVCNCD    PCTRT   2                                           234068
     C                     PARM BBCOLC    PCTRR   2                                           234068
     C           SDCTTX    PARM SDCTTX    DSFDY                                               234068
      *                                                                                       234068
      ** If no record is found, access with country of tax only                               234068
      *                                                                                       234068
     C           PRTCD     IFNE *BLANKS                                                       234068
     C                     CALL 'AOCTTXR0'                                                    234068
     C                     PARM *BLANKS   PRTCD                                               234068
     C                     PARM '*KEY   ' POPTN                                               234068
     C                     PARM DVCNCD    PCTRT                                               234068
     C                     PARM *BLANKS   PCTRR                                               234068
     C           SDCTTX    PARM SDCTTX    DSFDY                                               234068
      *                                                                                       234068
     C           PRTCD     IFNE *BLANKS                                                       234068
     C                     ENDIF                                                              234068
     C                     ENDIF                                                              234068
      *                                                                                       234068
     C           WKMDAT    IFLT EWEDT1                                                        234068
     C                     MOVE 'Y'       WSKIP   1                                           234068
     C                     ELSE                                                               234068
     C                     MOVE 'N'       WSKIP                                               234068
     C                     ENDIF                                                              234068
      *                                                                                       234068
     C                     ENDSR                                                              234068
      *****************************************************************                       234068
     C/EJECT                                                                                  234068
      *****************************************************************                       234068
      *                                                               *                       234068
      *  SRCEUT - Calculate EU Tax Amount                             *                       234068
      *                                                               *                       234068
      *****************************************************************                       234068
     C           SRCEUT    BEGSR                                                              234068
      *                                                                                       234068
     C                     Z-ADD*ZEROS    WNTAMT 130                                          234068
     C                     Z-ADD*ZEROS    PSTXA                                             AR745096
     C                     Z-ADD*ZEROS    PTTXA                                             AR745096
      *                                                                                       234068
      ** Call EU Tax Calculation for Private Individual                                       234068
      *                                                                                       234068
     C                     CALL 'ZATXCLPI'                                                    234068
      *                                                                                       234068
     C                     PARM 'D'       @@MODI  1                                           234068
     C                     PARM WDLNO     @@TRRF 18                                           234068
     C                     PARM DBRCA     @@BRCA  3                                           234068
     C                     PARM WCNUM     @@CUST  6                                           234068
     C                     PARM DVDAT     @@STRD  50                                          234068
     C                     PARM WKMDAT    @@ENDD  50                                          234068
     C                     PARM TOTI      @@TOTI 150                                          234068
     C                     PARM *ZERO     @@TAXR  64                                          234068
     C                     PARM CCY       @@OCCY  3                                           234068
     C**********           PARM *BLANKS   PINTH   1                                  CER048 AR784699
     C                     PARM TAXI      PINTH   1                                         AR784699
      *                                                                                       234068
      ** Output parameters                                                                    234068
      *                                                                                       234068
     C                     PARM           @@IAED 150                                          234068
     C                     PARM           @@TAXA 150                                          234068
     C                     PARM           @@TOTO 150                                          234068
     C                     PARM           @@TXCY  3                                           234068
     C                     PARM           @@CTAX  2                                           234068
     C                     PARM           @@TXBS  2                                           234068
     C**********           PARM           @@WTAC  40                                 234068 AR784699
     C                     PARM           @@WTAC 100                                        AR784699
     C                     PARM           @@COLC  2                                           234068
     C                     PARM           @@STAT  5                                           234068
     C                     PARM           @@TRTE  1                                           234068
     C                     PARM           @@TXR1  64                                          234068
     C**********           PARM *ZEROS    PSTXB   20                                 CER048 BUG22911
     C**********           PARM *ZEROS    PSTAC  100                                 CER048 BUG22911
     C**********           PARM *ZEROS    PSTTR   64                                 CER048 BUG22911
     C**********           PARM *BLANKS   PSTTP   1                                  CER048 BUG22911
     C**********           PARM *ZEROS    PSTXA  150                                 CER048 BUG22911
     C                     PARM           @@KEY  10                                           234068
     C                     PARM           @@FILE 10                                           234068
     C                     PARM           @@RTRN  7                                           234068
     C           SDTXPA    PARM SDTXPA    DSSDY                                             BUG22911
      *                                                                                       234068
     C                     SELEC                                                              234068
      *                                                                                       234068
     C           @@RTRN    WHEQ 'ERROR'                                                       234068
     C                     MOVE @@FILE    DBFILE                                              234068
     C                     MOVE @@KEY     DBKEY                                               234068
     C                     MOVE '1'       *IN15                                               234068
     C                     EXSR *PSSR                                                         234068
      *                                                                                       234068
     C           @@RTRN    WHNE 'JOINT'                                                       234068
     C                     Z-ADD@@TAXA    WNTAMT                                              234068
      *                                                                                     AR745096
      ** Apply the 2nd and 3rd tax to the tax amount                                        AR745096
      *                                                                                     AR745096
     C           CER048    IFEQ 'Y'                                                         AR745096
     C                     ADD  PSTXA     WNTAMT                                            AR745096
     C                     ENDIF                                                            AR745096
     C           CER054    IFEQ 'Y'                                                         AR745096
     C                     ADD  PTTXA     WNTAMT                                            AR745096
     C                     ENDIF                                                            AR745096
      *                                                                                       234068
     C           @@RTRN    WHEQ 'JOINT'                                                       234068
     C                     EXSR SRCALJ                                                        234068
     C                     ENDSL                                                              234068
      *                                                                                       234068
      ** Calculate Tax according to the effective date                                        234068
      *                                                                                       234068
     C           EWTRT1    IFEQ '1'                                                           234068
     C           DVDAT     ANDLTEWEDT1                                                        234068
     C           WKMDAT    SUB  DVDAT     WINTP   50                                          234068
     C           WKMDAT    SUB  EWEDT1    WEFFP   50                                          234068
      *                                                                                       234068
     C           WNTAMT    MULT WEFFP     WEFAMT 160                                          234068
     C           WEFAMT    DIV  WINTP     WNTAMT                                              234068
     C                     ENDIF                                                              234068
      *                                                                                       234068
     C                     ENDSR                                                              234068
      *****************************************************************                       234068
     C/EJECT                                                                                  234068
      *****************************************************************                       234068
      *                                                               *                       234068
      *  SRCJAH - Calculate EU Tax Amount for Joint Account Members   *                       234068
      *                                                               *                       234068
      *****************************************************************                       234068
     C           SRCALJ    BEGSR                                                              234068
      *                                                                                       234068
     C           WCNUM     SETLLSDJACCLB                                                      234068
     C           WCNUM     READESDJACCLB                 21                                   234068
      *                                                                                       234068
     C                     Z-ADD*ZEROS    WTAXA                                               234068
     C                     Z-ADD*ZEROS    PSTXA
     C                     Z-ADD*ZEROS    PTTXA
      *                                                                                       234068
     C           *IN21     DOWEQ'0'                                                           234068
      *                                                                                       234068
     C                     EXSR SRCZJA                                                        234068
      *                                                                                       234068
     C           @@RTRN    IFEQ 'ERROR'                                                       234068
     C                     MOVE @@FILE    DBFILE                                              234068
     C                     MOVE @@KEY     DBKEY                                               234068
     C                     MOVE '1'       *IN15                                               234068
     C                     EXSR *PSSR                                                         234068
     C                     ENDIF                                                              234068
      *                                                                                       234068
     C           @@STAT    IFEQ 'TAXAB'                                                       234068
     C           @@STAT    OREQ 'DISCL'                                                       234068
     C           @@STAT    OREQ 'SELF '                                                       234068
     C                     ADD  @@TAXA    WTAXA  150                                          234068
      *                                                                                     AR745096
      ** Apply the 2nd and 3rd tax to the tax amount                                        AR745096
      *                                                                                     AR745096
     C           CER048    IFEQ 'Y'                                                         AR745096
     C                     ADD  PSTXA     WTAXA                                             AR745096
     C                     ENDIF                                                            AR745096
     C           CER054    IFEQ 'Y'                                                         AR745096
     C                     ADD  PTTXA     WTAXA                                             AR745096
     C                     ENDIF                                                            AR745096
      *                                                                                     AR745096
     C                     ENDIF                                                              234068
      *                                                                                       234068
     C           @@RTRN    IFEQ 'NOTAX'                                                       234068
     C           @@RTRN    OREQ 'TAXAB'                                                       234068
     C           WCNUM     READESDJACCLB                 21                                   234068
     C                     ENDIF                                                              234068
      *                                                                                       234068
     C           @@RTRN    IFEQ 'LAST '                                                       234068
     C                     MOVE '1'       *IN21                                               234068
     C                     ENDIF                                                              234068
      *                                                                                       234068
     C                     ENDDO                                                              234068
      *                                                                                       234068
      ** Accumulate the taxa amount from the account holder and                               234068
      ** non-account holder                                                                   234068
      *                                                                                       234068
     C                     ADD  WTAXA     WNTAMT                                              234068
      *                                                                                       234068
     C                     ENDSR                                                              234068
      *****************************************************************                       234068
     C/EJECT                                                                                  234068
      *****************************************************************                       234068
      *                                                               *                       234068
      *  SRCZJA - Calls European W/Tax Calculation for Joint Accounts *                       234068
      *                                                               *                       234068
      *****************************************************************                       234068
     C           SRCZJA    BEGSR                                                              234068
      *                                                                                       234068
     C                     CALL 'ZATXCLJA'                                                    234068
     C                     PARM 'D'       @@MODI                                              234068
     C                     PARM WDLNO     @@TRRF                                              234068
     C                     PARM DBRCA     @@BRCA                                              234068
     C                     PARM WCNUM     @@JANO  6                                           234068
     C                     PARM JCCUST    @@CUST                                              234068
     C                     PARM JCNAHO    @@NARF 10                                           234068
     C                     PARM JCINVP    @@INVP 10                                           234068
     C                     PARM JCPAHT    PPAHT   1                                         BUG26839
     C                     PARM DVDAT     @@STRD                                              234068
     C                     PARM WKMDAT    @@ENDD                                              234068
     C                     PARM TOTI      @@TOTI                                              234068
     C                     PARM *ZERO     @@TAXR                                              234068
     C                     PARM CCY       @@OCCY                                              234068
     C                     PARM *BLANKS   PINTH                                               CER048
      *                                                                                       234068
      ** Output parameters                                                                    234068
      *                                                                                       234068
     C                     PARM           @@IAED                                              234068
     C                     PARM           @@TAXA                                              234068
     C                     PARM           @@TOTO                                              234068
     C                     PARM           @@TXCY                                              234068
     C                     PARM           @@CTAX                                              234068
     C                     PARM           @@TXBS                                              234068
     C                     PARM           @@WTAC                                              234068
     C                     PARM           @@COLC                                              234068
     C                     PARM           @@STAT                                              234068
     C                     PARM           @@TRTE                                              234068
     C                     PARM           @@TXR1                                              234068
     C                     PARM           @@JAMG  1                                           234068
     C**********           PARM *ZEROS    PSTXB                                      CER048 BUG22911
     C**********           PARM *ZEROS    PSTAC                                      CER048 BUG22911
     C**********           PARM *ZEROS    PSTTR                                      CER048 BUG22911
     C**********           PARM *BLANKS   PSTTP                                      CER048 BUG22911
     C**********           PARM *ZEROS    PSTXA                                      CER048 BUG22911
     C                     PARM           @@KEY                                               234068
     C                     PARM           @@FILE                                              234068
     C                     PARM           @@RTRN                                              234068
     C           SDTXPA    PARM SDTXPA    DSSDY                                             BUG22911
      *                                                                                       234068
     C                     ENDSR                                                              234068
      *****************************************************************                       234068
     C/EJECT                                                                                  234068
      *****************************************************************   CSW097
      /EJECT                                                                                  CSW213
      *****************************************************************                       CSW213
      *                                                               *                       CSW213
      *   SRREPI - Reporting Information Subroutine                   *                       CSW213
      *                                                               *                       CSW213
      *****************************************************************                       CSW213
     C           SRREPI    BEGSR                                                              CSW213
      *                                                                                       CSW213
     C           CSW213    IFEQ 'Y'                                                           CSW213
     C           *IN13     ANDEQ'0'                                                         MD023231
      *                                                                                       CSW213
     C                     MOVE RIAPID    MGAPID                                              CSW213
     C                     MOVE RITRRF    MGTRRF                                              CSW213
     C                     MOVE RILNRF    MGLNRF                                              CSW213
     C                     MOVE RICPID    MGCPID                                              CSW213
     C                     MOVE RIDTYP    MGDTYP                                              CSW213
     C                     MOVE RIDLST    MGDLST                                              CSW213
     C                     MOVE RITRID    MGTRID                                              CSW213
      *                                                                                     MD030880
     C           @TYP      IFEQ '300'                                                       MD030880
     C                     MOVE RICCPI    MGCCPI                                              CSW213
     C                     MOVE RICCPA    MGCCPA                                              CSW213
     C                     ENDIF                                                            MD030880
      *                                                                                     MD030880
     C                     MOVE RICEPI    MGCEPI                                              CSW213
     C                     MOVE RICEPA    MGCEPA                                              CSW213
     C                     MOVE RICBCI    MGCBCI                                              CSW213
     C                     MOVE RICBPI    MGCBPI                                              CSW213
     C                     MOVE RIPRID    MGPRID                                              CSW213
     C                     MOVE RIEXVE    MGEXVE                                              CSW213
     C                     MOVE RIUPID    MGUPID                                              CSW213
      *                                                                                       CSW213
      ** Sort fields of 01                                                                    CSW213
      *                                                                                       CSW213
     C                     MOVE RIRJ01    MGRJ01                                              CSW213
     C                     MOVE RIRP01    MGRP01                                              CSW213
     C                     MOVE RIRN01    MGRN01                                              CSW213
     C                     MOVE RIRC01    MGRC01                                              CSW213
     C                     MOVE RIRS01    MGRS01                                              CSW213
     C                     MOVE RIRL01    MGRL01                                              CSW213
     C                     MOVE RIRA01    MGRA01                                              CSW213
     C                     MOVE RITIT1    MGTI01                                              CSW213
     C                     MOVE RIUT01    MGUT01                                              CSW213
     C                     MOVE RITNI1    MGTN01                                              CSW213
      *                                                                                       CSW213
      ** Sort fields of 02                                                                    CSW213
      *                                                                                       CSW213
     C                     MOVE RIRJ02    MGRJ02                                              CSW213
     C                     MOVE RIRP02    MGRP02                                              CSW213
     C                     MOVE RIRN02    MGRN02                                              CSW213
     C                     MOVE RIRC02    MGRC02                                              CSW213
     C                     MOVE RIRS02    MGRS02                                              CSW213
     C                     MOVE RIRL02    MGRL02                                              CSW213
     C                     MOVE RIRA02    MGRA02                                              CSW213
     C                     MOVE RITIT2    MGTI02                                              CSW213
     C                     MOVE RIUT02    MGUT02                                              CSW213
     C                     MOVE RITNI2    MGTN02                                              CSW213
      *                                                                                       CSW213
      ** Sort fields of 03                                                                    CSW213
      *                                                                                       CSW213
     C                     MOVE RIRJ03    MGRJ03                                              CSW213
     C                     MOVE RIRP03    MGRP03                                              CSW213
     C                     MOVE RIRN03    MGRN03                                              CSW213
     C                     MOVE RIRC03    MGRC03                                              CSW213
     C                     MOVE RIRS03    MGRS03                                              CSW213
     C                     MOVE RIRL03    MGRL03                                              CSW213
     C                     MOVE RIRA03    MGRA03                                              CSW213
     C                     MOVE RITIT3    MGTI03                                              CSW213
     C                     MOVE RIUT03    MGUT03                                              CSW213
     C                     MOVE RITNI3    MGTN03                                              CSW213
      *                                                                                       CSW213
      ** Sort fields of 04                                                                    CSW213
      *                                                                                       CSW213
     C                     MOVE RIRJ04    MGRJ04                                              CSW213
     C                     MOVE RIRP04    MGRP04                                              CSW213
     C                     MOVE RIRN04    MGRN04                                              CSW213
     C                     MOVE RIRC04    MGRC04                                              CSW213
     C                     MOVE RIRS04    MGRS04                                              CSW213
     C                     MOVE RIRL04    MGRL04                                              CSW213
     C                     MOVE RIRA04    MGRA04                                              CSW213
     C**********           MOVE RITIT1    MGTI04                                     CSW213 MD022633
     C                     MOVE RITIT4    MGTI04                                            MD022633
     C                     MOVE RIUT04    MGUT04                                              CSW213
     C                     MOVE RITNI4    MGTN04                                              CSW213
      *                                                                                       CSW213
     C                     MOVE RIETT1    MGET01                                              CSW213
     C                     MOVE RIETT2    MGET02                                              CSW213
     C                     MOVE RIETT3    MGET03                                              CSW213
     C                     MOVE RIETT4    MGET04                                              CSW213
     C                     MOVE RICGTI    MGCGTI                                              CSW213
     C                     MOVE RIALLI    MGALLI                                              CSW213
     C                     MOVE RICLLI    MGCLLI                                              CSW213
     C                     MOVE RINORS    MGNORS                                              CSW213
     C                     Z-ADDRIGEDT    MGGEDT                                              CSW213
     C                     Z-ADDRIGETM    MGGETM                                              CSW213
     C                     MOVE RIUSGN    MGUSGN                                              CSW213
     C                     Z-ADDRIUTCT    MGUTCT                                              CSW213
     C                     MOVE RILSID    MGLSID                                              CSW213
     C                     MOVE RIAR01    MGAR01                                              CSW213
     C                     MOVE RIAR02    MGAR02                                              CSW213
     C                     MOVE RIAR03    MGAR03                                              CSW213
     C                     MOVE RIAR04    MGAR04                                              CSW213
     C                     MOVE RIAR05    MGAR05                                              CSW213
     C                     MOVE RIAR06    MGAR06                                              CSW213
     C                     MOVE RIAR07    MGAR07                                              CSW213
     C                     MOVE RIAR08    MGAR08                                              CSW213
     C                     MOVE RIAR09    MGAR09                                              CSW213
     C                     MOVE RIAR10    MGAR10                                              CSW213
     C                     MOVE RIAR11    MGAR11                                              CSW213
     C                     MOVE RIAR12    MGAR12                                              CSW213
     C                     MOVE RIAR13    MGAR13                                              CSW213
     C                     MOVE RIAR14    MGAR14                                              CSW213
     C                     MOVE RIAR15    MGAR15                                              CSW213
     C                     MOVE RIAR16    MGAR16                                              CSW213
     C                     MOVE RIAR17    MGAR17                                              CSW213
     C                     MOVE RIAR18    MGAR18                                              CSW213
     C                     MOVE RIAR19    MGAR19                                              CSW213
     C                     MOVE RIAR20    MGAR20                                              CSW213
     C                     MOVE RIFOID    MGFOID                                              CSW213
     C                     MOVE RIAFOI    MGAFOI                                              CSW213
     C                     MOVE RICFRQ    MGCFRQ                                              CSW213
     C                     MOVE RICFGN    MGCFGN                                              CSW213
     C                     Z-ADDRICFNR    MGCFNR                                              CSW213
     C                     MOVE RIPRED    MGPRED                                              CSW213
     C                     MOVE RIBCCY    MGBCCY                                              CSW213
     C                     MOVE RIBPMI    MGBPMI                                              CSW213
     C                     MOVE RISCCY    MGSCCY                                              CSW213
     C                     MOVE RISPMI    MGSPMI                                              CSW213
     C********** MGCHTP    IFNE 'C'                                                MD027940 MD028236
     C           MGCHTP    IFEQ *BLANKS                                                     MD028236
     C           MGACMI    ANDEQ'Y'                                                           CSW214
     C           RPTI      OREQ 'A'                                                         MD030954
     C           RIPRED    ANDNE*BLANKS                                                     MD030954
     C           MGACMI    ANDEQ'Y'                                                         MD030954
     C                     MOVE RICHTP    MGCHTP                                            MD023231
     C                     ENDIF                                                            MD027940
     C                     Z-ADDRILCD     MGLCD                                               CSW213
     C           MGACMI    IFEQ 'Y'                                                           CSW213
     C                     MOVE RITMST    MGTMST                                              CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
     C           CSW214    IFEQ 'Y'                                                           CSW214
      *                                                                                       CSW214
      ** Set the newly-added MG fields                                                        CSW214
      *                                                                                       CSW214
     C           @TYP      IFEQ '300'                                                         CSW214
     C                     MOVELRICBRI    MGCBRI                                              CSW214
     C                     MOVELRICBRA    MGCBRA                                              CSW214
     C                     ENDIF                                                              CSW214
      *                                                                                       CSW214
     C                     MOVELRIFNCI    MGFNCI                                              CSW214
     C                     MOVELRICOPI    MGCOPI                                              CSW214
     C                     MOVELRICOPC    MGCOPC                                              CSW214
     C                     MOVELRIPOCI    MGPOCI                                              CSW214
     C                     MOVELRICOSI    MGCOSI                                              CSW214
     C                     MOVELRITNEI    MGTNEI                                              CSW214
     C                     MOVELRIIGTI    MGIGTI                                              CSW214
     C                     MOVELRICTFI    MGCTFI                                              CSW214
     C                     ENDIF                                                              CSW214
      *                                                                                       CSW214
     C                     ENDSR                                                              CSW213
      *****************************************************************                       CSW213
      /EJECT                                                                                  CSW213
      *****************************************************************                       CSW213
      *   *PSSR - error handling                                      *
      *****************************************************************
      *
     C           *PSSR     BEGSR
      *
     C                     OPEN DL6305AU
      *
     C                     SETON                     U7U8LR
      *
     C                     WRITEDL6305D0
     C                     WRITEDL6305D1
     C                     DUMP
      *
     C                     RETRN
      *
     C                     ENDSR
      *****************************************************************
     C/EJECT                                                              CSW005
     C/COPY ZSRSRC,ZACCH                                                  CSW005
     C/COPY ZSRSRC,ZCHKH                                                  CSW005
     C/COPY ZSRSRC,ZDATE1Z2                                               CSW097
     C/COPY ZSRSRC,ZDATE9Z3                                               CSW097
     C/COPY ZSRSRC,ZFRQB3                                                 CIR005
     C/COPY ZSRSRC,ZDATE2Z2                                               CIR005
     C/EJECT
      *****************************************************************
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
** TX#    **      Text messages (15 records length 20)                    CSW005
FIXEDFIXEDNET                                                             CSW005
FIXEDFLOATNET                                                             CSW005
FLOATFIXEDNET                                                             CSW005
FLOATFLOATNET                                                             CSW005
MODIFIEDF                                                                 CSW005
AFI/365                                                                   CSW005
ACT/360                                                                   CSW005
30E/360                                                                   CSW005
ACT/365                                                                   CSW005
USD/LIBOR                                                                 CSW005
New York and London                                                       CSW005
FIXEDFIXEDGROSS                                                           CSW005
FIXEDFLOATGROSS                                                           CSW005
FLOATFIXEDGROSS                                                           CSW005
FLOATFLOATGROSS                                                           CSW005
360/360                                                                   183212
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES                                            CIR005
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC                                      CIR005
** @YD  USED BY SR. ZDATE9 - YEARS, IN DAYS, CUMULATIVE IN 4 YEAR SPAN
00366007310109601461
** @MD  USED BY SR. ZDATE9 - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
00000000310005900090001200015100181002120024300273003040033400365
**   ZFMD  -  NUMBER OF DAYS IN THE MONTH                                 CIR005
312831303130313130313031                                                  CIR005
** TSTAM - Dummy timestamp                                                                    CSW213
0001-01-01-00.00.00.000000                                                                    CSW213
