     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas DL COB confirmations message extraction')        *
     F*****************************************************************
     F*                                                               *
     F*  Midas - DEALING MODULE                                       *
     F*                                                               *
     F*  DL6310 - EOD CONFIRMATION MESSAGE EXTRACTION                 *
     F*                                                               *
      *  (c) Finastra International Limited 2001                      *
      *                                                               *
      *  Last Amend No. AR933432           Date 04Oct23               *
      *  Prev Amend No. 256996             Date 30Jun22               *
      *                 CSD103             Date 10Aug20               *
      *                 MD055733           Date 03Jul20               *
      *                 MD050139           Date 23Mar18               *
      *                 MD046248           Date 27Oct17               *
      *                 CDL099             Date 06Oct17               *
      *                 CGL184             Date 07Dec16               *
      *                 CSW216             Date 14Mar16               *
      *                 AR916361           Date 25May16               *
      *                 MD034675           Date 08Jul15               *
      *                 AR598353           Date 04Jun14               *
      *                 AR694628           Date 05Jun15               *
      *                 CDL088             Date 07Jul15               *
      *                 CGL165             Date 17Feb15               *
      *                 183944             Date 25Nov14               *
      *                 MD028991           Date 25Nov14               *
      *                 CSW214             Date 25Nov14               *
      *                 CDL096             Date 22Sep14               *
      *                 CDL094             Date 30May14               *
      *                 MD022979           Date 23Oct13               *
      *                 CSW213             Date 03Jun13               *
      *                 AR1054657          Date 08Nov12               *
      *                 CMG003             Date 04Oct12               *
      *                 CLE134             Date 01Aug12               *
      *                 CLE148             Date 23Jul12               *
      *                 CSW212             Date 03May12               *
      *                 AR784699           Date 06Jun11               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      *                 255986             Date 26Aug08               *
      *                 257464             Date 19Nov08               *
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 BUG20927           Date 11Sep08               *
      *                 CSW208             Date 15Apr08               *
      *                 245960             Date 23Apr07               *
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CDL049             Date 05Jul06               *
      *                 222546             Date 01Jun06               *
      *                 CSD027             Date 09Dec05               *
      *                 CDL038             Date 10May05               *
      *                 CSW037A            Date 02May05               *
      *                 CDL028             Date 07Feb05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CLE025             Date 20Oct03               *
      *                 222373             Date 03Nov03               *
      *                 199345             Date 26Feb03               *
      * Midas Release 4.01 -------------------------------------------*
      *                 CSW025             Date 26Mar02               *
      *                 183976             Date 14Dec01               *
      *                 179848             Date 16Aug01               *
      * Midas Release 4 --------------- Base -------------------------*
      *                 169025             Date 05Jun01               *
      * Midas DBA 3.04 -----------------------------------------------*
      *                 186725             Date 22Nov00               *
      *                 CDL008             Date 02May00               *
      * Midas DBA 3.03 -----------------------------------------------*
      *                 CSW200             Date 21Aug00               *
      *                 165468             Date 24May00               *
      * Midas DBA 3.02 -----------------------------------------------*
     F*                 CSW097             Date 02DEC99               *
      * Midas DBA 3.01 -----------------------------------------------*
      *                 CDL006             Date 26Apr99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 157756             Date 14Jul99               *
      *                 145001             Date 19Oct98               *
     F*                 CEU015             Date 19Jun98               *
     F*                 137909             Date 17Jul98               *
     F*                 CEU003             Date 19Dec97               *
     F*                 041713             DATE 29OCT97               *
     F*                 106777             Date 16Sep97               *
     F*                 CSW012             Date 26May97               *
     F*                 CSW097             Date 26May97               *
     F*                 CSW011             Date 09Apr97               *
     F*                 CSW005             Date 01Aug96               *
     F*                 089642             DATE 08JUL96               *
     F*                 068795             DATE 27FEB96               *
     F*                 067680             DATE 27FEB96               *
     F*                 088043             DATE 14JUN95               *
     F*                 S01408             DATE 21APR95               *
     F*                 059439             DATE 28MAR94               *
     F*                 056739             DATE 10JAN94               *
     F*                 S01453             DATE 14DEC93               *
     F*                 059258             DATE 24NOV93               *
     F*                 E40937             DATE 12JUN92               *
     F*                 E32797             DATE 03DEC91               *
     F*                 E32363             DATE 02DEC91               *
     F*                 E31211             DATE 30OCT91               *
     F*                 E31801             DATE 25OCT91               *
     F*                 E29588             DATE 07OCT91               *
     F*                                                               *
     F*---------------------------------------------------------------*
      *                                                               *
      *  AR933432 - Add aditional parameter when calling MG9200.      *
      *             (Child: AR933433)                                 *
      *  256996 - MT350 messages being NAK'd                          *
      *  CSD103 - LIBOR Deregulation - Common Layer/Standing Data     *
      *  MD055733 - COB: Multiple UTCHOBJEX calls in LEC06A           *
      *             components.                                       *
      *           - Redeliver of MD050139.                            *
      *  MD050139- AOSARDR0 called every time causing performance     *
      *            issue. Recompile due to changes in /COPY           *
      *            ZFREQ/ZFRQ*.                                       *
      *  MD046248 - Finastra Rebranding                               *
      *  CDL099 - Split Value Date (Recompile)                        *
      *  CGL184 - New Frequencies for Account Statements (Recompile)  *
      *  CSW216 - SWIFT Changes 2016                                  *
      *  AR916361 - Add Fix base rate checking on CDL019 before       *
      *             clearing MGINTR and MGTOTI field of MGF320PD.     *
      *             (Child: AR916362)                                 *
      *           - Appled for MD038215.                              *
      *  MD034675 - Invalid messages generated for 'CI',PI/PD' and    *
      *             'SC' events                                       *
      *  AR598353 - Generate MT320 message for Amendment Type 'EM'.   *
      *             Suppress MT320 for NAP/NAS deals with Amendment   *
      *             Type 'SC'. Applied for MD034571                   *
      *  AR694628 - Error on SC deal amendment on MT320. Ensure fields*
      *             get correct values after SC. Applied for MD034571 *
      *  CDL088 - Allow Spread Change for Negotiable Assets           *
      *  CGL165 - Dual Withholding Tax (Recompile)                    *
      *  183944 - Duplicate MT330 with codeword 'SETTLE' generated    *
      *           on COB of the day when the deal is called. This     *
      *           confirmation is already generated in Input Cycle.   *
      *         - Applied for MD029928.                               *
      *  MD028991 - Field tag generated for UTI Namespace/Issuer Code *
      *             field in MT341 is incorrect                       *
      *  CSW214 - SWIFT Changes 2014                                  *
      *  CDL096 - Business Day Conventions on MM Deals                *
      *           (Recompile)                                         *
      *  CDL094 - Enhance  Receive Settlement Instructions            *
      *  MD022979 - No MT300 generated when CSW213 is off             *
      *  CSW213 - SWIFT Changes 2013                                  *
      *  AR1054657 - No MT600 must be generated if CLS Settlement     *
      *              is set to Y                                      *
      *  CMG003 - SWIFT MT600 Message Generation                      *
      *  CLE134 - Past Due Call Loan Processing (Recompile)           *
      *  CLE148 - Alpha Loan Reference                                *
      *  CSW212 - SWIFT 2012 Changes                                  *
      *  AR784699 - In the generated MT320 field 34E value is         *
      *             incorrect. Tax was not considered.                *
      *  255986 - Field 72 to be included in MT300/320/321/330        *
      *  257464 - Correctly show /FLTR/ for Swift2008                 *
      *  BUG20927 - Wrong value of field 18A in MT320                 *
      *  CSW208 - SWIFT 2008 Changes                                  *
      *  245960 - Output MT320s for fixed term deals instead of  MT330*
      *  CDL049 - Addition of a Reference Rate field (recompile)      *
      *  222546 - Amend program to cater MT350 generation from 'SI'   *
      *           deal amendments.  Apply fix 215580.                 *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CDL038 - Extended Deal Sub Type (Recompile)                  *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CDL028 - Automatic Rate Interpolations (Recompile)           *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  222373 - Correct parameters on program calls                 *
      *  199345 - If interest paid separately, put interest details   *
      *           to the sett. details for MT350 to be message        *
      *           generated correctly.                                *
      *  CSW025 - Midas Message Manager                               *
      *           - Pass original change type                         *
      *  183976 - Rename CCY in the I specs of DEAMS to avoid         *
      *           incorrect retrieval of currency if the deal has no  *
      *           amendments.                                         *
      *  179848 - Field 34 has a wrong interest amount.  Recompiled   *
      *           over changed in PF/MGF330PD.                        *
      *  169025 - Remove fix 157756 as it is causing problems under   *
      *           the dealing module.                                 *
     F*  186725 - Remove switching of loan/deposit indicator if a     *
     F*           principal decrease                                  *
      *  CDL008 - Continuous Linked Settlement                        *
     F*  CSW200 - SWIFT2000 changes.                                  *
     F*  165468 - Amended program to consider in the calculation of   *
     F*           MGNAMT for MT330 or MGPCPL for MT335 the previous   *
     F*           deal amendments. Also, made it to report in MT330   *
     F*           the most current interest rate.                     *
     F*  CSW097 - SWIFT97 changes to MT340s and MT360s.               *
      *  CDL006 - Dealing Fiduciary.                                  *
     F*  157756 - Additional parameter to match parameters in         *
     F*           deletion/cancellation control program MG9200.       *
     F*  145001 - CEU015 fix: Remove CEU015 changes as RBDA is again  *
     F*           expressed in deal currency.                         *
     F*  CEU015 - EMU - Enhanced MM Deal Rollover                     *
     F*  137909 - New settlement currency fields added to confirmation*
     F*           messages. Only use if CEU003 is on.                 *
     F*  CEU003 - EMU - Settlement Currency Conversion                *
     F*  041713 - If Account With Institution field is blank, SWIFT   *
     F*           message should say UNKNOWN - change program to not  *
     F*           default Pay Nostro in this case. Remove fix E32363  *
     F*           originally done for BHF New York and later removed  *
     F*           by them.                                            *
     F*  106777 - Ensure that the interest amount is correct on       *
     F*           MT330's and that the principal amount is correct    *
     F*           on MT335's for deals with more than one DEAM        *
     F*  CSW012 - Extract Contact person details for MT300.           *
     F*  CSW097 - Swift changes 1997.                                 *
     F*           If Account with Bank A/c line = 'DIRECT'            *
     F*           put 'DIRECT' on MGAWBA. Also, add extract of fields *
     F*           POBN and POCN.                                      *
     F*  087195 - Change DIRECT to /DIRECT for SWIFT                  *
     F*  CSW011 - Generate FRA MT34n messages only.                   *
     F*  CSW005 - FRA/IRS MG34n and MG36n Msg Generation.             *
     F*  089642 - For CD and CL deal types with inserted maturity     *
     F*           date, system should produce an MT330 instead of     *
     F*           an MT324.                                           *
     F*  068795 - Ensure that the principal amount is correct on      *
     F*           MT330's for deals with more than one DEAM.          *
     F*  067680 - Pgm MG0350 was calculating total interest capit-    *
     F*           alised for month incorrectly. Add new fields to     *
     F*           MG0350PD for new calculation.                       *
     F*  088043 - Add Beneficiary Account Line to MGF3XXPD.           *
     F*  S01408 - Core hook DL6310CCP1 added                          *
     F*  059439 - Check first if APSTM is NOT EQUAL to 03 before      *
     F*           checking if deal's pay settlement is via nostro     *
     F*           and moving APONS to P@NONB.                         *
     F*  056739 - Add account line for fields :56: and :57:           *
     F*  S01453 - MARGIN AND FX POSITIONS/POINTS AND BASE CURRENCY    *
     F*           POSITIONS/POINTS ADDED TO FX INPUT (RECOMPILED)     *
     F*  059258 - If Swift confirmation is amended, place deal date   *
     F*           into field 30 of the message instead of run date.   *
     F*  E40937 - MG9200 CALLED TWICE, ONCE WITH INCORRECT PARMS.     *
     F*           REMOVE INCORRECT CALL (REMAINDER OF E29588).        *
     F*  E32797 - CURRENCY CODE MISSING.                              *
     F*  E32363 - IF A/C WITH INST. BLANK, DEFAULT FIELD 57           *
     F*           TO THE NOSTRO ACCOUNT.                              *
     F*  E31211 - LARGE REWRITE OF PROGRAM FOR DEAL AMENDMENTS        *
     F*  E31801 - 'CANCEL' CONFIRMATION GENERATED FOR UNSENT MSGS     *
     F*  E29588 - POST COLLECTION SWIFT RATIONALISATION FIXES         *
     F*  RE-WRITTEN FOR S01344 - SWIFT RATIONALISATION PHASE 2        *
     F*                                                               *
     F*****************************************************************
     FECONXCY IF  E           K        DISK
     FDEAMS   IF  E           K        DISK
     F            DEAMSDHF                          KIGNORE
     F            DEAMSDJF                          KIGNORE
     FDEALS   IF  E           K        DISK
     F            DEALSDAF                          KIGNORE
     F            DEALSDFF                          KIGNORE
     F            DEALSDGF                          KIGNORE
     F                                              KCOMIT
     FSDJACCLBIF  E           K        DISK                                                 AR784699
     F/COPY WNCPYSRC,DL6310F001
     FMGF300PDO   E                    DISK
     F                                              KCOMIT
     F***MGF324PDO***E                    DISK                            CSW200
     FMGF324PDO   E                    DISK                           UC  CSW200
     F                                              KCOMIT
     FMGF330PDO   E                    DISK
     F                                              KCOMIT
     F***MGF335PDO***E                    DISK                            CSW200
     FMGF335PDO   E                    DISK                           UC  CSW200
     F                                              KCOMIT
     FMGF320PDO   E                    DISK                           UC  CSW200
     F                                              KCOMIT                CSW200
     FMGF350PDO   E                    DISK
     F                                              KCOMIT
     FMGX320PDO   E                    DISK                           UC                      CSW208
     F                                              KCOMIT                                    CSW208
     FMGF600PDO   E                    DISK                                                   CMG003
     F                                              KCOMIT                                    CMG003
     FDLFHSTL0IF  E           K        DISK                                                   CSW208
     FDLFEEDLIIF  E           K        DISK                                                   CSW208
     FDLRPIFL1IF  E           K        DISK                                                   CSW213
     FDL6310AUO   E                    PRINTER                        UC
      *
     C/EJECT
      *****************************************************************
      *
      *    Function of indicators
      *
      *    10    EOF ECONXCY
      *    11    EOF DEALS
      *    12    EOF DEAMS
      *    20    MESSAGE TYPE NOT GENERATED FOR CUSTOMER
      *    21    CONFIRMATIONS NOT GENERATED FOR CUSTOMER
      *    22    MESSAGE GROUP NOT GENERATED FOR CUSTOMER
      *    U7U8LR        DB ERROR
      *
      *****************************************************************
     C/EJECT
      *****************************************************************
     E                    CPY@    1   1 80
      *
      **  Copyright array
      *
     E                    NGN        15  3
      *
      **  Array of message types not generated for customer
      *
     E/COPY ZSRSRC,ZHOLE                                                                      CSW208
     E/COPY ZSRSRC,ZDATE2Z1                                                                   CSW208
     E/COPY ZSRSRC,ZFREQBZ1                                                                   CSW208
      *                                                                                       CSW208
      **  Array of next payment date frequency                                                CSW208
      *                                                                                       CSW208
     E/COPY ZSRSRC,ZDATE9Z1                                                                   CSW212
      *                                                                                       CSW212
     E                    TSTAM   1   1 26                                                    CSW213
     ICONEXCYF
     I              RECI                            CRECI
     I              RCDT                            CRCDT
     I              DLNO                            CDLNO
     I              VDAT                            CVDAT
     I              DASN                            CDASN
     I              CNRQ                            CCNRQ
     I              BRCA                            CBRCA
      *
      **  Rename conflicting ECONXCY fields
      *
     IDEALSDBF
     I              RECI                            DRECI
     I              DLNO                            DDLNO
     I              RCDT                            DRCDT
     I              VDAT                            DVDAT
     I              BRCA                            DBRCA
     I              LSWS                            DLSWS
     I              LSWC                            DLSWC
      *
      **  Rename conflicting DEALS fields
      *
     IDEALSDCF
     I              RECI                            DRECI
     I              DLNO                            DDLNO
     I              RCDT                            DRCDT
     I              VDAT                            DVDAT
     I              BRCA                            DBRCA
     I              LSWS                            DLSWS
     I              LSWC                            DLSWC
      **************                                                      E29588
      ****Retain*settlement instructions from deal for amendments         E29588
      ****with*settlement type '00'                                       E29588
      **************                                                      E29588
     I**************RSTM                            DRSTM                 E29588
     I**************RONS                            DRONS                 E29588
     I**************RIBN                            DRIBN                 E29588
     I**************PSTM                            DPSTM                 E29588
     I**************PONS                            DPONS                 E29588
     I**************PIBN                            DPIBN                 E29588
     I**************RVNO                            DRVNO                 E29588
     I**************AWBN                            DAWBN                 E29588
     I**************AWBA                            DAWBA                 E29588
     I**************BENN                            DBENN                 E29588
     I**************POBR                            DPOBR                 E29588
     I**************ROBR                            DROBR                 E29588
      *
      **  Rename conflicting DEALS fields
      *
     IDEALSDDF
     I              RECI                            DRECI
     I              DLNO                            DDLNO
     I              RCDT                            DRCDT
     I              VDAT                            DVDAT
     I              BRCA                            DBRCA
     I              LSWS                            DLSWS
     I              LSWC                            DLSWC
     I              PUPR                            PCPL                                      CDL088
      *
      **  Rename conflicting DEALS fields
      *
     IDEALSDEF
     I              RECI                            DRECI
     I              DLNO                            DDLNO
     I              RCDT                            DRCDT
     I              VDAT                            DVDAT
     I              BRCA                            DBRCA
     I              LSWS                            DLSWS
     I              LSWC                            DLSWC
      *
      **  Rename conflicting DEALS fields
      *
     IDEAMSDIF                                                            E31211
     I              CCY                             ACCY                  183976
     I              RSTM                            ARSTM                 E31211
     I              RONS                            ARONS                 E31211
     I              RIBN                            ARIBN                 E31211
     I              RIBA                            ARIBA                 056739
     I              PSTM                            APSTM                 E31211
     I              PONS                            APONS                 E31211
     I              PIBN                            APIBN                 E31211
     I              PIBA                            APIBA                 056739
     I              RVNO                            ARVNO                 E31211
     I              AWBN                            AAWBN                 E31211
     I              AWBA                            AAWBA                 E31211
     I              BENN                            ABENN                 E31211
     I              BENA                            ABENA                 088043
     I              OSBR                            AOSBR                 E31211
     I              STCY                            ASTCY                 CEU003
      *                                                                   E31211
      **  Rename settlement instructions from deal amendments             E31211
      **  (to check for settlement type '00')                             E31211
      *
     IDSRUN       DS                             13
     I                                        1   7 RUNA
     I                                       13  13 MBIN
      *                                                                                       CSW208
      **  System Values Constant                                                              CSW208
      *                                                                                       CSW208
     I              'DLFSWIFTConf'        C         P@DL                                      CSW208
      *
      **  RUNDAT data area
      *
     I*LBCCY****  DS                                               E32797 183976
     I**********                              1   3 CCY            E32797 183976
     I**********                              1   3 SLCY           E32797 183976
      ** Data structure to retrieve ccy code for access to nostro file    E32797
      *                                                                   E32797
     ISDBANK    E DSSDBANKPD
      *
      **  Data structure for bank file
      *
     ISDCUST    E DSSDCUSTPD
      *
      **  Data structure for customer file
      *
     ISDMMOD    E DSSDMMODPD
      *
      **  Data structure for MIDAS modules
      *
     ISDCURR    E DSSDCURRPD                                                                  CSW212
      *                                                                                       CSW212
      **  Data structure for Currency Details file.                                           CSW212
      *                                                                                       CSW212
     I*DNOST****E*DSSDNOSTPD                                        E32363041713
      ****Data*structure*for*nostro*file***                         E32363041713
      *                                                                   E32363
     ISCSARD    E DSSCSARDPD                                              CSW005
      **  Data structure for Switchable Features file                     CSW005
      *                                                                   CSW005
     ISDACOF    E DSSDACOFPD                                              CSW012
      **  Data structure for Account Officer Details File                 CSW012
      *                                                                   CSW012
     ISDDEPT    E DSSDDEPTPD                                              CSW012
      **  Data structure for Department Codes                             CSW012
      *                                                                   CSW012
     ISDGELR    E DSSDGELRPD                                                                  CSW208
      *                                                                                       CSW208
      **  Data structure for General Ledger Details file                                      CSW208
      *                                                                                       CSW208
     ISDLOCN    E DSSDLOCNPD                                                                AR784699
      **  Data structure for Location Codes                                                 AR784699
      *                                                                                     AR784699
     ISDCTTX    E DSSDCTTXPD                                                                AR784699
      ** Data Structure for Country of Tax Code Details                                     AR784699
      *                                                                                     AR784699
     ISDBRCH    E DSSDBRCHPD                                                                AR784699
     I              QQDFAC                          QQDFA1                                  AR784699
      ** Data Structure for Branch Details                                                  AR784699
     ISDTXPA    E DSSDTXPAPD                                                                AR784699
      ** Data structure for Tax Parameter File                                              AR784699
      *                                                                                     AR784699
     IDSFDY     E DSDSFDY
      *
      **  Short data structure for access programs
      *
     IDSSDY     E DSDSSDY
      *
      **  Long data structure for access programs
      *
     ILDA         DS                            256
     I                                      134 141 DBFILE
     I                                      142 170 DBKEY
     I                                      171 180 DBPGM
     I                                      181 1830DBASE
     IAWBA        DS                                                      087195
     I                                        1   6 WWAWBA                087195
     I                                        7  35 WWAWBB                087195
      *
      **  Local data area
      *
     I/COPY ZSRSRC,ZHOLI                                                                      CSW208
      *                                                                                       CSW208
     I/COPY ZSRSRC,ZDATE9Z2                                                                   CSW212
      *                                                                                       CSW212
      *****************************************************************
     C/EJECT
      *****************************************************************
      *                   Index to subroutines                        *
      *   main process                                                *
      *   INIT  - initial process                                     *
      *   SETF  - set up GDF files                                    *
      *   TYPE  - determine message type                              *
      *   DEST  - determine destination customer address              *
      *   VALD  - generate message type for destination customer ?    *
      *   COMM  - format common fields                                *
      *   F300  - format message specific fields for MT300            *
      *   X320  - format message specific fields for MT320            *                       CSW208
      *   X320H - format message specific fields for MT320            *                       CSW208
      *   X320L - format message specific fields for MT320            *                       CSW208
      *   X320L2- format message specific fields for MT320            *                       CSW208
      *   F350  - format message specific fields for MT350            *
      *   F335  - format message specific fields for MT335            *
      *   F330  - format message specific fields for MT330            *
      *   F324  - format message specific fields for MT324            *
      *   LORD  - Set up loan or deposit flag field                   *
      *   STCY1 - Set up settlement currencies for MT300              *   137909
      *   STCY2 - Set up settlement currency for MT324/30/50          *   137909
      *   *PSSR - error handling                                      *
      *
      *****************************************************************
     C/EJECT
      *****************************************************************
      *   main process                                                *
      *   Calls - INIT initial process                                *
      *           SETF set up GDF files                               *
      *           TYPE determine message type                         *
      *           DEST determine destination customer                 *
      *           VALD generate message for destination customer ?    *
      *****************************************************************
      *
      **  Perform initial process
      *
     C                     EXSR INIT
      *
      **  Read first confirmations extract record
      *
     C                     READ ECONXCY                  10
      *
      **  Do until EOF
      *
     C           *IN10     DOWEQ'0'
      *                                                                   CSW005
      **  When FRA/IRS Msg Gen feature is swithced on, DL0195 extracts    CSW005
      **  PF/ECONXCY records for FRA/IRS deals.  These records should     CSW005
      **  not be processed by DL6310.  So process records only with       CSW005
      **  either Value Date is defined, or Confo Request is for Maturity  CSW005
      **  or for Interest.                                                CSW005
      *                                                                   CSW005
     C           CSW005    IFEQ 'N'                                       CSW005
     C           CSW011    ANDEQ'N'                                       CSW011
     C           CSW005    OREQ 'Y'                                       CSW005
     C           CVDAT     ANDGT*ZERO                                     CSW005
     C           CCNRQ     ANDNE'F'                                       CSW097
     C           CCNRQ     ANDNE'D'                                       CSW097
     C           CCNRQ     ANDNE'H'                                       CSW097
     C           CSW005    OREQ 'Y'                                       CSW005
     C           CCNRQ     ANDEQ'M'                                       CSW005
     C           CSW005    OREQ 'Y'                                       CSW005
     C           CCNRQ     ANDEQ'I'                                       CSW005
     C           CSW011    OREQ 'Y'                                       CSW011
     C           CVDAT     ANDGT*ZERO                                     CSW011
     C           CCNRQ     ANDNE'F'                                       CSW097
     C           CCNRQ     ANDNE'D'                                       CSW097
     C           CCNRQ     ANDNE'H'                                       CSW097
     C           CSW011    OREQ 'Y'                                       CSW011
     C           CCNRQ     ANDEQ'M'                                       CSW011
     C           CSW011    OREQ 'Y'                                       CSW011
     C           CCNRQ     ANDEQ'I'                                       CSW011
      *
      **  Set up generation driver file fields
      *
     C                     EXSR SETF
      *
      **  Access corresponding deal record
      *
     C           CDLNO     CHAINDEALS                11
     C                     MOVE CHTP      @CHG    1                                           CSW025
      *
     C           *IN11     IFEQ '1'
     C           DRECI     ORNE 'D'
     C           DRECI     ANDNE'R'
     C           *LOCK     IN   LDA
     C                     MOVE '001'     DBASE            * * * * * * * *
     C                     MOVELCDLNO     DBKEY            *  DBERR 001  *
     C                     MOVEL'DEALS'   DBFILE           * * * * * * * *
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END
     C/COPY WNCPYSRC,DL6310C001
      *                                                                                       183944
      **  If deal type is either CD or CL and maturity date is not                            183944
      **  zero (transaction is called), 'SETTLE' MT330 is already                             183944
      **  generated in Input Cycle. Hence, there is no need to                                183944
      **  generate confirmation in COB.                                                       183944
      *                                                                                       183944
     C           CRCDT     IFEQ 'D'                                                           183944
     C           CCNRQ     ANDEQ'M'                                                           183944
     C           MDAT      ANDNE0                                                             183944
      *                                                                                       183944
     C           DTYP      IFEQ 'CD'                                                          183944
     C           DTYP      OREQ 'CL'                                                          183944
     C                     GOTO READ                                                          183944
     C                     ENDIF                                                              183944
      *                                                                                       183944
     C                     ENDIF                                                              183944
      *                                                                                       CSW213
     C           RPTI      IFEQ 'Y'                                                           CSW213
      *                                                                                       CSW213
     C                     MOVE 'Y'       MGACMI                                              CSW213
     C                     MOVE CNUM      MGPTYA                                              CSW213
     C                     MOVE RITRID    CNUM                                                CSW213
      *                                                                                       CSW213
     C                     ENDIF                                                              CSW213
      *
      **  Determine message type
      *
     C                     EXSR TYPE
      *
      **  Determine destination customer address
      *
     C                     EXSR DEST
      *
      **  Write message if message type required for customer
      *
     C           CHTP      IFNE 'R'
     C                     EXSR VALD
     C                     END
     C*                                                                  CSW005
     C                     ENDIF                                         CSW005
      *
      **  Read next confirmation extract record
      *
     C           READ      TAG                                                                183944
     C                     READ ECONXCY                  10
      *
     C                     END
      *
      **  Close files opened under user control                           CSW200
     C           CSW200    IFNE 'CSW200'                                  CSW200
     C                     CLOSEMGF324PD                                  CSW200
     C                     CLOSEMGF335PD                                  CSW200
     C                     ELSE                                           CSW200
     C                     CLOSEMGF320PD                                  CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
      **  Terminate program
      *
     C                     SETON                     LR
      *
      *****************************************************************
     C/EJECT
      *****************************************************************
      *   INIT - inital process                                       *
      *   Called by - main process                                    *
      *****************************************************************
      *
     C           INIT      BEGSR
      *
     C                     MOVEACPY@      BIS@   80
      *
      **  Set up LDA
      *
     C           *NAMVAR   DEFN           LDA
     C           *LOCK     IN   LDA
     C                     MOVE *BLANKS   DBFILE
     C                     MOVE *BLANKS   DBKEY
     C                     MOVE *BLANKS   DBPGM
     C                     MOVEL'DL6310'  DBPGM
     C                     MOVE *BLANKS   DBASE
     C                     OUT  LDA
      *
      **  Access SDBANKPD for report title
      *
     C                     CALL 'AOBANKR0'
     C                     PARM '*MSG   ' @RTCD   7
     C                     PARM '*FIRST ' @OPTN   7
     C           SDBANK    PARM SDBANK    DSFDY
     C*
     C           @RTCD     IFNE *BLANKS
     C           *LOCK     IN   LDA
     C                     MOVE '002'     DBASE            * * * * * * * *
     C                     MOVEL'FIRST'   DBKEY            *  DBERR 002  *
     C                     MOVEL'SDBANKPD'DBFILE           * * * * * * * *
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END
      *
      **  Access RUNDAT to find run date & multibranching indicator
      *
     C           *NAMVAR   DEFN RUNDAT    DSRUN
     C           *LOCK     IN   DSRUN
     C                     OUT  DSRUN
      *                                                                   CSW005
      **  Access Switchable Features file for FRA/IRS Msg Generation.     CSW005
      *                                                                   CSW005
     C                     CALL 'AOSARDR0'                                CSW005
     C                     PARM *BLANKS   @RTCD                           CSW005
     C                     PARM '*VERIFY' @OPTN                           CSW005
     C                     PARM 'CSW005'  @SARD   6                       CSW005
     C           SCSARD    PARM SCSARD    DSFDY                           CSW005
      *                                                                   CSW005
     C           @RTCD     IFEQ *BLANKS                                   CSW005
     C                     MOVEL'Y'       CSW005  1                       CSW005
     C                     ELSE                                           CSW005
     C           @RTCD     IFEQ '*NRF   '                                 CSW005
     C                     MOVEL'N'       CSW005                          CSW005
     C                     ELSE                                           CSW005
     C           *LOCK     IN   LDA                                       CSW005
     C                     MOVE '014'     DBASE            * * * * * * * *CSW005
     C                     MOVEL@SARD     DBKEY            * DB ERROR 14 *CSW005
     C                     MOVEL'SCSARDPD'DBFILE           * * * * * * * *CSW005
     C                     OUT  LDA                                       CSW005
     C                     EXSR *PSSR                                     CSW005
     C                     ENDIF                                          CSW005
     C                     ENDIF                                          CSW005
      *                                                                   CSW011
     C                     CALL 'AOSARDR0'                                CSW011
     C                     PARM *BLANKS   @RTCD                           CSW011
     C                     PARM '*VERIFY' @OPTN                           CSW011
     C                     PARM 'CSW011'  @SARD   6                       CSW011
     C           SCSARD    PARM SCSARD    DSFDY                           CSW011
      *                                                                   CSW011
     C           @RTCD     IFEQ *BLANKS                                   CSW011
     C                     MOVEL'Y'       CSW011  1                       CSW011
     C                     ELSE                                           CSW011
     C                     MOVEL'N'       CSW011                          CSW011
     C                     ENDIF                                          CSW011
      *                                                                   CSW012
      **  Access Switchable Features file for CSW012                      CSW012
      *                                                                   CSW012
     C                     CALL 'AOSARDR0'                                CSW012
     C                     PARM *BLANKS   @RTCD                           CSW012
     C                     PARM '*VERIFY' @OPTN                           CSW012
     C                     PARM 'CSW012'  @SARD                           CSW012
     C           @RTCD     IFEQ *BLANKS                                   CSW012
     C                     MOVEL'Y'       CSW012  1                       CSW012
     C                     ELSE                                           CSW012
     C                     MOVEL'N'       CSW012                          CSW012
     C                     ENDIF                                          CSW012
     C/COPY WNCPYSRC,DL6310C002
      *                                                                   CEU003
      **  Access Switchable Features file for CEU003                      CEU003
      *                                                                   CEU003
     C                     CALL 'AOSARDR0'                                CEU003
     C                     PARM *BLANKS   @RTCD                           CEU003
     C                     PARM '*VERIFY' @OPTN                           CEU003
     C                     PARM 'CEU003'  @SARD   6                       CEU003
     C           @RTCD     IFEQ *BLANKS                                   CEU003
     C                     MOVEL'Y'       CEU003  1                       CEU003
     C                     ELSE                                           CEU003
     C                     MOVEL'N'       CEU003                          CEU003
     C                     ENDIF                                          CEU003
     C***********                                                  CEU015 145001
     C****Access*SAR*details*file*to*see*if*CEU015*SAR*is*installedCEU015 145001
     C***********                                                  CEU015 145001
     C***********          CALL 'AOSARDR0'                         CEU015 145001
     C***********          PARM *BLANKS   @RTCD   7                CEU015 145001
     C***********          PARM '*VERIFY' @OPTN   7                CEU015 145001
     C***********          PARM 'CEU015'  @SARD   6                CEU015 145001
     C***********                                                  CEU015 145001
     C***********@RTCD     IFEQ *BLANK                             CEU015 145001
     C***********          MOVE 'Y'       CEU015  1                CEU015 145001
     C***********          ELSE                                    CEU015 145001
     C***********          MOVE 'N'       CEU015                   CEU015 145001
     C***********          ENDIF                                   CEU015 145001
      *                                                                   CDL006
      ** Access Switchable Features file to check if Dealing Fiducia      CDL006
      ** ry is installed.                                                 CDL006
      *                                                                   CDL006
     C                     MOVE 'N'       CDL006  1                       CDL006
     C                     CALL 'AOSARDR0'                                CDL006
     C                     PARM *BLANKS   WRTCD   7                       CDL006
     C                     PARM '*VERIFY' WOPTN   7                       CDL006
     C                     PARM 'CDL006'  WSARD   6                       CDL006
     C           SCSARD    PARM SCSARD    DSFDY                           CDL006
      *                                                                   CDL006
     C           WRTCD     IFNE *BLANKS                                   CDL006
     C           WRTCD     ANDNE'*NRF   '                                 CDL006
     C           *LOCK     IN   LDA                                       CDL006
     C                     Z-ADD042       DBASE             ************* CDL006
     C                     MOVEL'SCSARDPD'DBFILE            * DBERR 042 * CDL006
     C                     MOVELWRTCD     DBKEY             ************* CDL006
     C                     OUT  LDA                                       CDL006
     C                     EXSR *PSSR                                     CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
     C           WRTCD     IFEQ *BLANK                                    CDL006
     C                     MOVEL'Y'       CDL006                          CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL008
      ** Check if CDL008 (Continuous Linked Settlement) is installed.     CDL008
      *                                                                   CDL008
     C                     MOVE 'N'       CDL008  1                       CDL008
     C                     CALL 'AOSARDR0'                                CDL008
     C                     PARM *BLANKS   WRTCD                           CDL008
     C                     PARM '*VERIFY' WOPTN                           CDL008
     C                     PARM 'CDL008'  WSARD                           CDL008
     C           SCSARD    PARM SCSARD    DSFDY                           CDL008
      *                                                                   CDL008
     C           WRTCD     IFNE *BLANKS                                   CDL008
     C           WRTCD     ANDNE'*NRF   '                                 CDL008
     C           *LOCK     IN   LDA                                       CDL008
     C                     Z-ADD043       DBASE             ************* CDL008
     C                     MOVEL'SCSARDPD'DBFILE            * DBERR 043 * CDL008
     C                     MOVELWRTCD     DBKEY             ************* CDL008
     C                     OUT  LDA                                       CDL008
     C                     EXSR *PSSR                                     CDL008
     C                     ENDIF                                          CDL008
     C           WRTCD     IFEQ *BLANK                                    CDL008
     C                     MOVEL'Y'       CDL008                          CDL008
     C                     ENDIF                                          CDL008
      *
      ** Is CSW025 installed?                                                                 CSW025
      *                                                                                       CSW025
     C                     CALL 'AOSARDR0'                                                    CSW025
     C                     PARM '       ' @RTCD                                               CSW025
     C                     PARM '*VERIFY' @OPTN                                               CSW025
     C                     PARM 'CSW025'  @SARD                                               CSW025
     C           @RTCD     IFNE *BLANK                                                        CSW025
     C           @RTCD     ANDNE'*NRF   '                                                     CSW025
     C                     MOVEL'SCSARDPD'DBFILE                                              CSW025
     C                     MOVEL'020'     DBASE                                               CSW025
     C                     MOVEL@RTCD     DBKEY                                               CSW025
     C                     MOVE *ON       *INU7                                               CSW025
     C                     MOVE *ON       *INU8                                               CSW025
     C                     EXSR *PSSR                                                         CSW025
     C                     ENDIF                                                              CSW025
     C           @RTCD     IFEQ *BLANK                                                        CSW025
     C                     MOVE 'Y'       CSW025  1                                           CSW025
     C                     ENDIF                                                              CSW025
      *                                                                                       CSW025
      ** Check if SWIFT 2000 is on.                                       CSW200
     C/COPY WNCPYSRC,DL6310C032
      *                                                                   CSW200
     C                     CALL 'SWIF2000'                                CSW200
     C                     PARM *BLANKS   CSW200  6                       CSW200
      *                                                                   CSW200
      ** If SWIFT 2000 is off, open files MGF324PD and MGF335PD.  If it   CSW200
      ** it is on, open file MGF320PD.                                    CSW200
      *                                                                   CSW200
     C           CSW200    IFNE 'CSW200'                                  CSW200
     C                     OPEN MGF324PD                                  CSW200
     C                     OPEN MGF335PD                                  CSW200
     C                     ELSE                                           CSW200
     C                     OPEN MGF320PD                                  CSW200
     C                     ENDIF                                          CSW200
     C/COPY WNCPYSRC,DLH00430
      *                                                                   CSW200
      ** Access SAR details to see if CAS009 is enabled.                                      CSW208
      *                                                                                       CSW208
     C                     MOVE 'N'       CAS009  1                                           CSW208
     C                     CALL 'AOSARDR0'                                                    CSW208
     C                     PARM *BLANKS   @RTCD                                               CSW208
     C                     PARM '*VERIFY' @OPTN                                               CSW208
     C                     PARM 'CAS009'  @SARD                                               CSW208
     C           SCSARD    PARM SCSARD    DSFDY                                               CSW208
      *                                                                                       CSW208
     C           @RTCD     IFEQ *BLANKS                                                       CSW208
     C                     MOVE 'Y'       CAS009                                              CSW208
     C                     ENDIF                                                              CSW208
      *                                                                                       CSW208
      ** Access SAR details to see if CDL019 is enabled.                                      CSW208
      *                                                                                       CSW208
     C                     MOVE 'N'       CDL019  1                                           CSW208
     C                     CALL 'AOSARDR0'                                                    CSW208
     C                     PARM *BLANKS   @RTCD                                               CSW208
     C                     PARM '*VERIFY' @OPTN                                               CSW208
     C                     PARM 'CDL019'  @SARD                                               CSW208
     C           SCSARD    PARM SCSARD    DSFDY                                               CSW208
      *                                                                                       CSW208
     C           @RTCD     IFEQ *BLANKS                                                       CSW208
     C                     MOVE 'Y'       CDL019                                              CSW208
     C                     ENDIF                                                              CSW208
      *                                                                                       CSW208
     C                     MOVE 'N'       DLSWCF  1                                           CSW208
     C                     Z-ADD*ZEROS    WSEQN   50                                          CSW208
     C**********           Z-ADD*ZEROS    WFECNT  50                                 CSW208 BUG20927
     C                     MOVE '0'       *IN98                                               CSW208
      *                                                                                       CSW208
      ** Access Switchable Features file for CSW208                                           CSW208
      *                                                                                       CSW208
     C                     MOVE 'N'       CSW208  1                                           CSW208
     C                     CALL 'SWIF2008'                                                    CSW208
     C                     PARM *BLANKS   @RTCD                                               CSW208
      *                                                                                       CSW208
     C           @RTCD     IFEQ 'CSW2008'                                                     CSW208
     C                     MOVE 'Y'       CSW208                                              CSW208
      *                                                                                       CSW208
     C                     OPEN MGX320PD                                                      CSW208
      *                                                                                       CSW208
     C                     CALL 'AOSVALR0'                                                    CSW208
     C                     PARM *BLANKS   P@RTCD  7                                           CSW208
     C                     PARM P@DL      P@OP01 20                                           CSW208
     C                     PARM           P@VL01200                                           CSW208
     C                     PARM           P@OP02 20                                           CSW208
     C                     PARM           P@VL02200                                           CSW208
     C                     PARM           P@OP03 20                                           CSW208
     C                     PARM           P@VL03200                                           CSW208
     C                     PARM           P@OP04 20                                           CSW208
     C                     PARM           P@VL04200                                           CSW208
     C                     PARM           P@OP05 20                                           CSW208
     C                     PARM           P@VL05200                                           CSW208
     C                     PARM           P@OP06 20                                           CSW208
     C                     PARM           P@VL06200                                           CSW208
     C                     PARM           P@OP07 20                                           CSW208
     C                     PARM           P@VL07200                                           CSW208
     C                     PARM           P@OP08 20                                           CSW208
     C                     PARM           P@VL08200                                           CSW208
     C                     PARM           P@OP09 20                                           CSW208
     C                     PARM           P@VL09200                                           CSW208
     C                     PARM           P@OP10 20                                           CSW208
     C                     PARM           P@VL10200                                           CSW208
      *                                                                                       CSW208
     C           P@RTCD    IFEQ *BLANKS                                                       CSW208
     C           P@VL01    ANDEQ'Y'                                                           CSW208
     C           CAS009    ANDEQ'Y'                                                           CSW208
      *                                                                                       CSW208
      ** Add records to MGX320PD if Current setup is Y and CAS009 is ON                       CSW208
      *                                                                                       CSW208
     C                     MOVE 'Y'       DLSWCF                                              CSW208
     C                     ENDIF                                                              CSW208
      *                                                                                       CSW208
     C                     ENDIF                                                              CSW208
      *                                                                                       CSW208
      ** Access Switchable Feature file for CGL031.                                         AR784699
      *                                                                                     AR784699
     C                     CALL 'AOSARDR0'                                                  AR784699
     C                     PARM *BLANKS   PRTCD   7                                         AR784699
     C                     PARM '*VERIFY' POPTN   7                                         AR784699
     C                     PARM 'CGL031'  PSARD   6                                         AR784699
      *                                                                                     AR784699
     C           PRTCD     IFNE *BLANKS                                                     AR784699
     C           PRTCD     ANDNE'*NRF   '                                                   AR784699
     C           *LOCK     IN   LDA                                                         AR784699
     C                     MOVEL'SCSARDPD'DBFILE                                            AR784699
     C                     MOVEL'044'     DBASE                                             AR784699
     C                     MOVEL'CGL031'  DBKEY                                             AR784699
     C                     EXSR *PSSR                                                       AR784699
     C                     OUT  LDA                                                         AR784699
     C                     ENDIF                                                            AR784699
      *                                                                                     AR784699
     C           PRTCD     IFEQ *BLANKS                                                     AR784699
     C                     MOVEL'Y'       CGL031  1                                         AR784699
     C                     ELSE                                                             AR784699
     C                     MOVEL'N'       CGL031                                            AR784699
     C                     ENDIF                                                            AR784699
      *                                                                                     AR784699
      ** Check if switchable feature CER048 is ON                                           AR784699
      *                                                                                     AR784699
     C                     CALL 'AOSARDR0'                                                  AR784699
     C                     PARM *BLANKS   @RTCD                                             AR784699
     C                     PARM '*VERIFY' @OPTN                                             AR784699
     C                     PARM 'CER048'  @SARD                                             AR784699
     C           SCSARD    PARM SCSARD    DSFDY                                             AR784699
      *                                                                                     AR784699
     C           @RTCD     IFNE *BLANK                                                      AR784699
     C           @RTCD     ANDNE'*NRF   '                                                   AR784699
     C                     MOVEL'SCSARDPD'DBFILE                                            AR784699
     C                     MOVEL'045'     DBASE                                             AR784699
     C                     MOVEL@RTCD     DBKEY                                             AR784699
     C                     MOVE *ON       *INU7                                             AR784699
     C                     MOVE *ON       *INU8                                             AR784699
     C                     EXSR *PSSR                                                       AR784699
     C                     ENDIF                                                            AR784699
     C           @RTCD     IFEQ *BLANK                                                      AR784699
     C                     MOVE 'Y'       CER048  1                                         AR784699
     C                     ENDIF                                                            AR784699
      *                                                                                     AR784699
      ** Check if switchable feature CER054 is ON                                           AR784699
      *                                                                                     AR784699
     C                     CALL 'AOSARDR0'                                                  AR784699
     C                     PARM *BLANKS   @RTCD                                             AR784699
     C                     PARM '*VERIFY' @OPTN                                             AR784699
     C                     PARM 'CER054'  @SARD                                             AR784699
     C           SCSARD    PARM SCSARD    DSFDY                                             AR784699
      *                                                                                     AR784699
     C           @RTCD     IFNE *BLANK                                                      AR784699
     C           @RTCD     ANDNE'*NRF   '                                                   AR784699
     C                     MOVEL'SCSARDPD'DBFILE                                            AR784699
     C                     MOVEL'046'     DBASE                                             AR784699
     C                     MOVEL@RTCD     DBKEY                                             AR784699
     C                     MOVE *ON       *INU7                                             AR784699
     C                     MOVE *ON       *INU8                                             AR784699
     C                     EXSR *PSSR                                                       AR784699
     C                     ENDIF                                                            AR784699
     C           @RTCD     IFEQ *BLANK                                                      AR784699
     C                     MOVE 'Y'       CER054  1                                         AR784699
     C                     ENDIF                                                            AR784699
      *                                                                                     AR784699
      ** Check if SWIFT Changes 2012 (CSW212) is installed                                    CSW212
      *                                                                                       CSW212
     C                     CALL 'SWIF2012'                                                    CSW212
     C                     PARM *BLANKS   @RTCD                                               CSW212
      *                                                                                       CSW212
     C           @RTCD     IFEQ 'CSW2012'                                                     CSW212
     C                     MOVE 'Y'       CSW212  1                                           CSW212
     C                     ELSE                                                               CSW212
     C                     MOVE 'N'       CSW212                                              CSW212
     C                     ENDIF                                                              CSW212
     C/COPY WNCPYSRC,DLH00458
      *                                                                                       CSW212
      ** Check if SWIFT MT600 Message Generation is installed                                 CMG003
      *                                                                                       CMG003
     C                     MOVE 'N'       CMG003  1                                           CMG003
     C                     CALL 'AOSARDR0'                                                    CMG003
     C                     PARM *BLANKS   @RTCD                                               CMG003
     C                     PARM '*VERIFY' @OPTN                                               CMG003
     C                     PARM 'CMG003'  @SARD                                               CMG003
     C           SCSARD    PARM SCSARD    DSFDY                                               CMG003
      *                                                                                       CMG003
     C           @RTCD     IFEQ *BLANKS                                                       CMG003
     C                     MOVE 'Y'       CMG003                                              CMG003
     C                     ENDIF                                                              CMG003
      *                                                                                       CMG003
      ** Check if Enhance Receive Settlement Instructions is On                               CDL094
      *                                                                                       CDL094
     C                     MOVE 'N'       CDL094  1                                           CDL094
     C                     CALL 'AOSARDR0'                                                    CDL094
     C                     PARM *BLANKS   @RTCD                                               CDL094
     C                     PARM '*VERIFY' @OPTN                                               CDL094
     C                     PARM 'CDL094'  @SARD                                               CDL094
     C           SCSARD    PARM SCSARD    DSFDY                                               CDL094
      *                                                                                       CDL094
     C           @RTCD     IFEQ *BLANKS                                                       CDL094
     C                     MOVE 'Y'       CDL094                                              CDL094
     C                     ENDIF                                                              CDL094
      ** Check if SWIFT Changes 2013 (CSW213) is installed                                    CSW213
      *                                                                                       CSW213
     C                     CALL 'SWIF2013'                                                    CSW213
     C                     PARM *BLANKS   @RTCD                                               CSW213
      *                                                                                       CSW213
     C           @RTCD     IFEQ 'CSW2013'                                                     CSW213
     C                     MOVE 'Y'       CSW213  1                                           CSW213
     C                     ELSE                                                               CSW213
     C                     MOVE 'N'       CSW213                                              CSW213
     C                     END                                                                CSW213
      *                                                                                       CSW214
      ** Check if SWIFT Changes 2014 (CSW214) is installed                                    CSW214
      *                                                                                       CSW214
     C                     CALL 'SWIF2014'                                                    CSW214
     C                     PARM *BLANKS   PRTCD                                               CSW214
      *                                                                                       CSW214
     C           PRTCD     IFEQ 'CSW2014'                                                     CSW214
     C                     MOVE 'Y'       CSW214  1                                           CSW214
     C                     ELSE                                                               CSW214
     C                     MOVE 'N'       CSW214                                              CSW214
     C                     ENDIF                                                              CSW214
      *                                                                                       CSW216
      ** Check if SWIFT Changes 2016 (CSW216) is installed                                    CSW216
      *                                                                                       CSW216
     C                     CALL 'SWIF2016'                                                    CSW216
     C                     PARM *BLANKS   PRTCD   7                                           CSW216
      *                                                                                       CSW216
     C           PRTCD     IFEQ 'CSW2016'                                                     CSW216
     C                     MOVE 'Y'       CSW216  1                                           CSW216
     C                     ELSE                                                               CSW216
     C                     MOVE 'N'       CSW216                                              CSW216
     C                     ENDIF                                                              CSW216
      *                                                                                       CSW213
      ** Setup key Fields for DLRPIFPD                                                        CSW213
      *                                                                                       CSW213
     C           RPIFKY    KLIST                                                              CSW213
     C                     KFLD           KCDTYP                                              CSW213
     C                     KFLD           KCDLNO                                              CSW213
      *                                                                                       CSW213
     C                     ENDSR
      *
      *****************************************************************
     C/EJECT
      *****************************************************************
      *    SETF - Set up GDF fields                                   *
      *    Called by - main process                                   *
      *****************************************************************
      *
     C           SETF      BEGSR
      *
      **  Clear generation driver file fields
      *
     C                     MOVE *BLANKS   MGBRCA
     C                     MOVE *BLANKS   MGCNUM
     C                     MOVE *BLANKS   MGMODI
     C                     MOVE *BLANKS   MGTNUM
     C                     Z-ADD0         MGTDAT
     C                     Z-ADD0         MGEXRT
     C/COPY WNCPYSRC,DL6310C017
     C                     MOVE *BLANKS   MGBRKC
     C                     Z-ADD0         MGMDAT
     C                     Z-ADD0         MGVDAT
     C                     Z-ADD0         MGOTDT
     C                     MOVE *BLANKS   MGPUCY
     C                     Z-ADD0         MGPAMT
     C                     Z-ADD0         MGPCPL
     C                     MOVE *BLANKS   MGRIBN
     C                     MOVE *BLANKS   MGRIBA                          056739
     C                     MOVE *BLANKS   MGRONS
     C                     MOVE *BLANKS   MGSLCY
     C                     Z-ADD0         MGSAMT
     C                     MOVE *BLANKS   MGPONS
     C                     MOVE *BLANKS   MGPIBN
     C                     MOVE *BLANKS   MGPIBA                          056739
     C**********           Z-ADD0         MGPOBN                                       CSW097 CSD027
     C**********           Z-ADD0         MGPOCN                                       CSW097 CSD027
     C                     MOVE *BLANKS   MGPOBN                                              CSD027
     C                     MOVE *BLANKS   MGPOCN                                              CSD027
     C                     MOVE *BLANKS   MGAWBN
     C                     MOVE *BLANKS   MGAWBA
     C                     MOVE *BLANKS   MGRVNO
     C                     MOVE *BLANKS   MGBENN
     C                     MOVE *BLANKS   MGBENA                          088043
     C                     MOVE *BLANKS   MGTTYP
     C                     MOVE *BLANKS   MGTSTP
     C                     MOVE *BLANKS   MGPOBR
     C                     MOVE *BLANKS   MGEVTP
     C                     MOVE *BLANKS   MGCHTP
     C                     MOVE *BLANKS   MGROBR
     C                     Z-ADD0         MGRSTM
     C                     Z-ADD0         MGPSTM
      *
     C                     MOVE *BLANKS   MGCCY
     C                     Z-ADD0         MGINTR
     C                     Z-ADD0         MGNIDT
     C                     Z-ADD0         MGSLID
     C                     Z-ADD0         MGIACD                          067680
     C                     Z-ADD0         MGAITC                          067680
     C                     Z-ADD0         MGAIAN                          067680
     C                     Z-ADD0         MGAIAP                          067680
     C                     Z-ADD0         MGIPRD                          067680
     C                     Z-ADD0         MGICTD                          067680
     C                     Z-ADD0         MGINTA                          068795
     C                     MOVE *BLANKS   MGICBS
     C                     Z-ADD0         MGTOTI
     C                     MOVE *BLANKS   MGIPFR
      *
     C                     Z-ADD0         MGNAMT
     C                     Z-ADD0         MGNOTD
     C                     MOVE *BLANKS   MGAMTP
     C                     Z-ADD0         MGAVDT                          E29588
     C                     Z-ADD0         MGASEQ                          E29588
      *
      **  Initialise account officer name, dept. and phone number         CSW012
      **  to blanks.                                                      CSW012
      *                                                                   CSW012
     C                     MOVE *BLANKS   MGCTC1                          CSW012
     C                     MOVE *BLANKS   MGCTC2                          CSW012
     C                     MOVE *BLANKS   MGCTC3                          CSW012
     C                     MOVE *BLANKS   MGCTC4                          CSW012
     C                     MOVE *BLANKS   WACOC   2                       CSW012
      *                                                                   CDL008
      ** Initialise CLS Settlement field to blanks                        CDL008
      *                                                                   CDL008
     C                     MOVE *BLANKS   MGCLSS                          CDL008
      *                                                                                       CSW212
      ** Initialise fields for CSW212 if feature is installed                                 CSW212
      *                                                                                       CSW212
     C           CSW212    IFEQ 'Y'                                                           CSW212
     C                     MOVE *BLANKS   MGCON1                                              CSW212
     C                     MOVE *BLANKS   MGCON2                                              CSW212
     C                     MOVE *BLANKS   MGCON3                                              CSW212
     C                     MOVE *BLANKS   MGCON4                                              CSW212
     C                     MOVE *BLANKS   MGCON5                                              CSW212
     C                     MOVE *BLANKS   MGCON6                                              CSW212
     C                     MOVE *BLANKS   MGAGTY                                              CSW212
     C                     MOVE *BLANKS   MGPMBC                                              CSW212
     C                     MOVE *BLANKS   MGPMSC                                              CSW212
     C                     Z-ADD0         MGISDA                                              CSW212
     C                     Z-ADD0         MGAGDT                                              CSW212
     C                     Z-ADD0         MGAGVV                                              CSW212
     C                     ENDIF                                                              CSW212
      *                                                                                       CSW213
      ** Reset new of fields to blanks if CSW213 is switch on                                 CSW213
      *                                                                                       CSW213
     C           CSW213    IFEQ 'Y'                                                           CSW213
      *                                                                                       CSW213
     C                     MOVE *BLANKS   MGAPID                                              CSW213
     C                     MOVE *BLANKS   MGTRRF                                              CSW213
     C                     MOVE *BLANKS   MGLNRF                                              CSW213
     C                     MOVE *BLANKS   MGCPID                                              CSW213
     C                     MOVE *BLANKS   MGDTYP                                              CSW213
     C                     MOVE *BLANKS   MGDLST                                              CSW213
     C                     MOVE *BLANKS   MGTRID                                              CSW213
     C                     MOVE *BLANKS   MGCCPI                                              CSW213
     C                     MOVE *BLANKS   MGCCPA                                              CSW213
     C                     MOVE *BLANKS   MGCEPI                                              CSW213
     C                     MOVE *BLANKS   MGCEPA                                              CSW213
     C                     MOVE *BLANKS   MGCBCI                                              CSW213
     C                     MOVE *BLANKS   MGCBPI                                              CSW213
     C                     MOVE *BLANKS   MGPRID                                              CSW213
     C                     MOVE *BLANKS   MGEXVE                                              CSW213
     C                     MOVE *BLANKS   MGUPID                                              CSW213
     C                     MOVE *BLANKS   MGRJ01                                              CSW213
     C                     MOVE *BLANKS   MGRJ02                                              CSW213
     C                     MOVE *BLANKS   MGRJ03                                              CSW213
     C                     MOVE *BLANKS   MGRJ04                                              CSW213
     C                     MOVE *BLANKS   MGRP01                                              CSW213
     C                     MOVE *BLANKS   MGRP02                                              CSW213
     C                     MOVE *BLANKS   MGRP03                                              CSW213
     C                     MOVE *BLANKS   MGRP04                                              CSW213
     C                     MOVE *BLANKS   MGRA01                                              CSW213
     C                     MOVE *BLANKS   MGRA02                                              CSW213
     C                     MOVE *BLANKS   MGRA03                                              CSW213
     C                     MOVE *BLANKS   MGRA04                                              CSW213
     C                     MOVE *BLANKS   MGRN01                                              CSW213
     C                     MOVE *BLANKS   MGRN02                                              CSW213
     C                     MOVE *BLANKS   MGRN03                                              CSW213
     C                     MOVE *BLANKS   MGRN04                                              CSW213
     C                     MOVE *BLANKS   MGRC01                                              CSW213
     C                     MOVE *BLANKS   MGRC02                                              CSW213
     C                     MOVE *BLANKS   MGRC03                                              CSW213
     C                     MOVE *BLANKS   MGRC04                                              CSW213
     C                     MOVE *BLANKS   MGRS01                                              CSW213
     C                     MOVE *BLANKS   MGRS02                                              CSW213
     C                     MOVE *BLANKS   MGRS03                                              CSW213
     C                     MOVE *BLANKS   MGRS04                                              CSW213
     C                     MOVE *BLANKS   MGRL01                                              CSW213
     C                     MOVE *BLANKS   MGRL02                                              CSW213
     C                     MOVE *BLANKS   MGRL03                                              CSW213
     C                     MOVE *BLANKS   MGRL04                                              CSW213
     C                     MOVE *BLANKS   MGUT01                                              CSW213
     C                     MOVE *BLANKS   MGUT02                                              CSW213
     C                     MOVE *BLANKS   MGUT03                                              CSW213
     C                     MOVE *BLANKS   MGUT04                                              CSW213
     C                     MOVE *BLANKS   MGTN01                                              CSW213
     C                     MOVE *BLANKS   MGTN02                                              CSW213
     C                     MOVE *BLANKS   MGTN03                                              CSW213
     C                     MOVE *BLANKS   MGTN04                                              CSW213
     C                     MOVE *BLANKS   MGTI01                                              CSW213
     C                     MOVE *BLANKS   MGTI02                                              CSW213
     C                     MOVE *BLANKS   MGTI03                                              CSW213
     C                     MOVE *BLANKS   MGTI04                                              CSW213
     C                     MOVE *BLANKS   MGET01                                              CSW213
     C                     MOVE *BLANKS   MGET02                                              CSW213
     C                     MOVE *BLANKS   MGET03                                              CSW213
     C                     MOVE *BLANKS   MGET04                                              CSW213
     C                     MOVE *BLANKS   MGCGTI                                              CSW213
     C                     MOVE *BLANKS   MGALLI                                              CSW213
     C                     MOVE *BLANKS   MGCLLI                                              CSW213
     C                     MOVE *BLANKS   MGNORS                                              CSW213
     C                     MOVE *BLANKS   MGUSGN                                              CSW213
     C                     MOVE *BLANKS   MGLSID                                              CSW213
     C                     MOVE *BLANKS   MGAR01                                              CSW213
     C                     MOVE *BLANKS   MGAR02                                              CSW213
     C                     MOVE *BLANKS   MGAR03                                              CSW213
     C                     MOVE *BLANKS   MGAR04                                              CSW213
     C                     MOVE *BLANKS   MGAR05                                              CSW213
     C                     MOVE *BLANKS   MGAR06                                              CSW213
     C                     MOVE *BLANKS   MGAR07                                              CSW213
     C                     MOVE *BLANKS   MGAR08                                              CSW213
     C                     MOVE *BLANKS   MGAR09                                              CSW213
     C                     MOVE *BLANKS   MGAR10                                              CSW213
     C                     MOVE *BLANKS   MGAR11                                              CSW213
     C                     MOVE *BLANKS   MGAR12                                              CSW213
     C                     MOVE *BLANKS   MGAR13                                              CSW213
     C                     MOVE *BLANKS   MGAR14                                              CSW213
     C                     MOVE *BLANKS   MGAR15                                              CSW213
     C                     MOVE *BLANKS   MGAR16                                              CSW213
     C                     MOVE *BLANKS   MGAR17                                              CSW213
     C                     MOVE *BLANKS   MGAR18                                              CSW213
     C                     MOVE *BLANKS   MGAR19                                              CSW213
     C                     MOVE *BLANKS   MGAR20                                              CSW213
     C                     MOVE *BLANKS   MGFOID                                              CSW213
     C                     MOVE *BLANKS   MGAFOI                                              CSW213
     C                     MOVE *BLANKS   MGCFRQ                                              CSW213
     C                     MOVE *BLANKS   MGCFGN                                              CSW213
     C                     MOVE *BLANKS   MGPRID                                              CSW213
     C                     MOVE *BLANKS   MGBCCY                                              CSW213
     C                     MOVE *BLANKS   MGBPMI                                              CSW213
     C                     MOVE *BLANKS   MGSCCY                                              CSW213
     C                     MOVE *BLANKS   MGSPMI                                              CSW213
     C                     MOVE *BLANKS   MGCHTP                                              CSW213
     C**********           MOVEATSTAM     MGTMST                                     CSW213 MD022979
     C                     MOVE *BLANKS   MGACMI                                              CSW213
     C                     MOVE *BLANKS   MGPTYA                                              CSW213
      *                                                                                       CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                     MD022979
     C                     MOVEATSTAM     MGTMST                                            MD022979
      *
      ** Initialize the newly-added MG fields to blanks                                       CSW214
      *                                                                                       CSW214
     C           CSW214    IFEQ 'Y'                                                           CSW214
     C                     MOVE *BLANKS   MGCBRI                                              CSW214
     C                     MOVE *BLANKS   MGCBRA                                              CSW214
     C                     MOVE *BLANKS   MGFNCI                                              CSW214
     C                     MOVE *BLANKS   MGCOPI                                              CSW214
     C                     MOVE *BLANKS   MGCOPC                                              CSW214
     C                     MOVE *BLANKS   MGPOCI                                              CSW214
     C                     MOVE *BLANKS   MGCOSI                                              CSW214
     C                     MOVE *BLANKS   MGTNEI                                              CSW214
     C                     MOVE *BLANKS   MGIGTI                                              CSW214
     C                     MOVE *BLANKS   MGCTFI                                              CSW214
     C                     ENDIF                                                              CSW214
      *                                                                                       CSW214
     C                     ENDSR
      *
      *****************************************************************
     C/EJECT
      *****************************************************************
      *   TYPE - determine message type (@TYP)                        *
      *   Called by - main process                                    *
      *****************************************************************
      *
     C           TYPE      BEGSR
      *                                                                   CSW005
     C                     MOVE *BLANKS   @TYP                            CSW005
     C                     MOVE *BLANKS   D@AMD   1                                         MD034675
     C           *LIKE     DEFN DAAM      D@AAM                                             MD034675
     C           *LIKE     DEFN RTSP      D@RSP                                             MD034675
     C           *LIKE     DEFN BRTE      D@BRT                                             MD034675
     C                     Z-ADD*ZEROS    D@AAM                                             MD034675
     C                     Z-ADD*ZEROS    D@RSP                                             MD034675
     C                     Z-ADD*ZEROS    D@BRT                                             MD034675
      *
      ** Check for deal amendment confirmations
      *
     C           CVDAT     IFGT 0
     C                     Z-ADDCDLNO     KDLNO   60
      *
     C           ECONKY    KLIST
     C                     KFLD           KDLNO
     C                     KFLD           CVDAT
     C                     KFLD           CDASN
      *
     C           ECONKY    CHAINDEAMS                12
      *
     C           *IN12     IFEQ '1'
     C           RECI      ORNE 'D'
     C           RECI      ANDNE'R'                                       E29588
     C           *LOCK     IN   LDA
     C                     MOVE '003'     DBASE            * * * * * * * *
     C                     MOVELKDLNO     DBKEY            *  DBERR 003  *
     C                     MOVEL'DEAMS'   DBFILE           * * * * * * * *
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END
     C           AMTP      IFEQ 'PD'                                                        MD034675
     C           AMTP      OREQ 'PI'                                                        MD034675
      ** DEAL AMENDMENT FLAG                                                                MD034675
     C                     MOVE 'Y'       D@AMD                                             MD034675
      ** DEAL AMENDMENT AMOUNT                                                              MD034675
     C                     Z-ADDDAAM      D@AAM                                             MD034675
     C                     ENDIF                                                            MD034675
      *                                                                                     MD034675
     C           AMTP      IFEQ 'SC'                                                        MD034675
      ** DEAL AMENDMENT FLAG                                                                MD034675
     C                     MOVE 'Y'       D@AMD                                             MD034675
      ** DEAMSDI INTEREST RATE                                                              MD034675
     C                     Z-ADDRTSP      D@RSP                                             MD034675
     C                     ENDIF                                                            MD034675
      *                                                                                     MD034675
     C           AMTP      IFEQ 'BC'                                                        MD034675
     C                     MOVE 'Y'       D@AMD                                             MD034675
      ** DEAMSDI BASE RATE                                                                  MD034675
     C                     Z-ADDBRTE      D@BRT                                             MD034675
     C                     ENDIF                                                            MD034675
      *
      ** Event type saves amentment type to indicate deal amendment
      ** Check for rate change (SC) or principal change (PI/PD)
      *
     C                     MOVE AMTP      MGEVTP
     C                     Z-ADDVDAT      MGAVDT                          E29588
     C                     Z-ADDDASN      MGASEQ                          E29588
     C           AMTP      IFEQ 'SC'
     C           CSW200    ANDEQ*BLANKS                                   CSW200
     C                     MOVE '335'     @TYP    3        *MT335 message*
     C                     ELSE                                                               222546
     C           AMTP      IFEQ 'SI'                                                          222546
     C                     MOVE '350'     @TYP                                                222546
     C                     ELSE
      *                                                                                     AR598353
     C           DRCDT     IFEQ 'D'                                                         AR598353
     C           DRCDT     OREQ 'E'                                                         AR598353
     C                     ELSE                                                             AR598353
      *                                                                                       245960
     C           DTYP      IFEQ 'CD'                                                          245960
     C           DTYP      OREQ 'CL'                                                          245960
     C           DTYP      OREQ 'DL'                                                          245960
     C           DTYP      OREQ 'DT'                                                          245960
     C           CDL006    ANDEQ'Y'                                                           245960
     C           DTYP      OREQ 'LP'                                                          245960
     C           CDL006    ANDEQ'Y'                                                           245960
     C           DTYP      OREQ 'LT'                                                          245960
     C           CDL006    ANDEQ'Y'                                                           245960
     C                     MOVE '330'     @TYP             *MT330 message*
     C                     ELSE                                                               245960
     C           AMTP      IFNE 'CI'                                                        MD034675
     C                     MOVE '320'     @TYP                                                245960
     C                     ENDIF                                                            MD034675
     C                     END                                                                245960
      *                                                                                       245960
     C                     ENDIF                                                            AR598353
     C                     END
     C                     END                                                                222546
     C**                                                                  E29588
     C**  THIS CALL TO MG9200 NOT CORRECTLY REMOVED BY E29588             E40937
      ****Call*cancellation program with parameters of the deal number    E29588
      ****program*type*(CA*= deal amendment confirmation),                E29588
      ****module*id,*an*indicator to determine if further processing      E29588
      ****is*required*for*Nostro Transfers (not relevent),                E29588
      ****and*a*Return*Code ('E' indicates a DB error)
     C**********           CALL 'MG9200'               97           E29588E40937
     C**********           PARM KDLNO     TRNUM   60                E29588E40937
     C**********           PARM 'CA'      CALLP   2                 E29588E40937
     C**********           PARM 'DL'      MODID   2                 E29588E40937
     C**********           PARM *BLANKS   REVNX   1                 E29588E40937
     C**********           PARM *BLANKS   @RTNC   1                 E29588E40937
      *
      **  Call cancellation program with parameters of the deal number    E29588
      **  program type (CA = deal amendment confirmation),                E29588
      **  module id,                                                      E29588
      **  deal amendment value date,                                      E29588
      **  deal amendment sequence number,                                 E29588
      **  an indicator to determine if further processing is              E29588
      **   Nostro Transfers,                                              E29588
      **  return Code ('E' indicates a DB error)                          E29588
      **  return Code ('C' indicates a 'CANCEL' confirmation required)    E31801
      *                                                                   E29588
     C           CHTP      IFNE 'I'                                       E29588
     C           CSW025    ANDNE'Y'                                                           CSW025
     C                     MOVE KDLNO     TRNUM                                               CLE148
     C                     CALL 'MG9200'               97                 E29588
     C**********           PARM KDLNO     TRNUM   60                                   E29588 CLE148
     C                     PARM           TRNUM   6                                           CLE148
     C                     PARM 'CA'      CALLP   2                       E29588
     C                     PARM 'DL'      MODID   2                       E29588
     C                     PARM VDAT      TRVDT   50                      E29588
     C                     PARM DASN      TRSEQ   30                      E29588
     C                     PARM *BLANKS   REVNX   1                       E29588
     C                     PARM *BLANKS   @RTNC   1                       E29588
     C***********          PARM @TYP      @TYPE   3                157756 169025
     C                     PARM *BLANKS   @CLSS   1                                           222373
     C                     PARM *BLANKS   WEAMT1 13                                         AR933432
      *
      **  If Cancs/Dels programs ended with a DB error, use the LDA
      **  entries set up for that error
      *
     C           @RTNC     IFEQ 'E'                                       E29588
     C           *LOCK     IN   LDA
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END
      *
      ** If CALL to Cancs/Dels programs ended abnormally
      *
     C           *IN97     IFEQ '1'
     C           *LOCK     IN   LDA
     C                     MOVE '011'     DBASE            * * * * * * * *
     C                     MOVEL'MG9200'  DBKEY            *  DBERR 011  *
     C                     MOVEL*BLANKS   DBFILE           * * * * * * * *
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END
      *
      **  Produce a confirmation message with the codeword 'CANCEL'.      E29588
      **  This occurs when a deal is reversed to confirm the              E29588
      **  mutually agreed cancellation of the deal amendment contract.    E29588
      *                                                                   E29588
     C           CHTP      IFEQ 'R'                                       E29588
     C           @TYP      ANDNE'335'                                     E29588
     C           @RTNC     ANDEQ'C'                                       E31801
     C                     MOVE 'C'       MGCHTP                          E29588
     C                     END                                            E29588
     C                     END                                            E29588
      *
     C                     ELSE
      *
      ** Check for interest or maturity confirmations
      *
      ** Interest
      *
     C           CCNRQ     IFEQ 'I'
     C                     MOVE '350'     @TYP             *MT350 message*
     C                     END
      *
      ** Maturity
      *
     C           CCNRQ     IFEQ 'M'
      *
      ** Check for FX deals
      *
     C           DRCDT     IFEQ 'B'
     C                     MOVE '300'     @TYP             *MT300 message*
     C                     ELSE
     C*                                                                   089642
     C**  if MM Deals, check if CD or CL.  If it is, then message         089642
     C**  type should be 330.                                             089642
     C*                                                                   089642
     C           DTYP      IFEQ 'CD'                                      089642
     C           DTYP      OREQ 'CL'                                      089642
     C           DTYP      OREQ 'DT'                                      CDL006
     C           CDL006    ANDEQ'Y'                                       CDL006
     C           DTYP      OREQ 'LT'                                      CDL006
     C           CDL006    ANDEQ'Y'                                       CDL006
     C           DTYP      OREQ 'DP'                                      CDL006
     C           CDL006    ANDEQ'Y'                                       CDL006
     C           DTYP      OREQ 'LP'                                      CDL006
     C           CDL006    ANDEQ'Y'                                       CDL006
     C                     MOVE '330'     @TYP             *MT330 message*089642
     C                     ELSE                                           089642
     C           CSW200    IFEQ 'CSW200'                                  CSW200
     C                     MOVE '320'     @TYP                            CSW200
     C                     ELSE                                           CSW200
     C                     MOVE '324'     @TYP             *MT324 message*
     C                     ENDIF                                          CSW200
     C                     END                                            089642
     C                     END
     C                     END
      *
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
     C/EJECT
      *****************************************************************
      *   DEST - determine destination customer                       *
      *   Called by - main process                                    *
      *****************************************************************
      *
     C           DEST      BEGSR
      *
      **  Using customer no. of deal
      *
     C                     MOVELCNUM      @DEST   8
      *
      **  Access SDCUSTPD with access object
      *
     C                     MOVE *BLANKS   @KEY1  10
     C                     MOVE *BLANKS   @KYST   7
      *
     C                     CALL 'AOCUSTR0'
     C                     PARM '*MSG   ' @RTCD
     C                     PARM '*KEY   ' @OPTN
     C                     PARM @DEST     @KEY1
     C                     PARM *BLANKS   @KYST
     C           SDCUST    PARM SDCUST    DSSDY
      *
     C           @RTCD     IFNE *BLANKS
     C           *LOCK     IN   LDA
     C                     MOVE '004'     DBASE            * * * * * * * *
     C                     MOVEL@DEST     DBKEY            *  DBERR 004  *
     C                     MOVEL'SDCUSTPD'DBFILE           * * * * * * * *
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     ELSE
      *
      ** Load array with fields containing message types not to be
      ** generated for this customer
      *
     C                     MOVE BBNG01    NGN,1
     C                     MOVE BBNG02    NGN,2
     C                     MOVE BBNG03    NGN,3
     C                     MOVE BBNG04    NGN,4
     C                     MOVE BBNG05    NGN,5
     C                     MOVE BBNG06    NGN,6
     C                     MOVE BBNG07    NGN,7
     C                     MOVE BBNG08    NGN,8
     C                     MOVE BBNG09    NGN,9
     C                     MOVE BBNG10    NGN,10
     C                     MOVE BBNG11    NGN,11
     C                     MOVE BBNG12    NGN,12
     C                     MOVE BBNG13    NGN,13
     C                     MOVE BBNG14    NGN,14
     C                     MOVE BBNG15    NGN,15
      *
      **  Store A/c Officer Code to use later in SR/F300                  CSW012
      **  to access A/c officer details                                   CSW012
      *                                                                   CSW012
     C           CSW012    IFEQ 'Y'                                       CSW012
     C                     MOVELBBACOC    WACOC                           CSW012
     C                     ENDIF                                          CSW012
      *
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
     C/EJECT
      *****************************************************************
      *   VALD - generate message type for destination customer ?     *
      *   Called by - main process                                    *
      *   Calls - COMM format common fields                           *
      *         - F335 format message specific fields for MT335       *
      *         - F330 format message specific fields for MT330       *
      *         - F350 format message specific fields for MT350       *
      *         - F300 format message specific fields for MT300       *
      *         - F324 format message specific fields for MT324       *
      *****************************************************************
      *
     C           VALD      BEGSR
      *
      **  Check message type to be generated for destination customer
      *
     C           @TYP      LOKUPNGN                      20
      *
     C           *IN20     IFNE '1'
      *
      **  Check message group is to be generated
      *
     C           '3**'     LOKUPNGN                      21
     C                     MOVE @TYP      GROUP   3
     C                     MOVE '*'       GROUP
     C           GROUP     LOKUPNGN                      22
      *
     C           *IN21     IFNE '1'
     C           *IN22     ANDNE'1'
      *
      **  Format common fields
      *
     C                     EXSR COMM
      *
      **  Format message specific fields
      *
     C           @TYP      CASEQ'335'     F335
     C           @TYP      CASEQ'330'     F330
     C           @TYP      CASEQ'350'     F350
     C           @TYP      CASEQ'300'     F300
     C           @TYP      CASEQ'324'     F324
     C           @TYP      CASEQ'320'     F320                            CSW200
     C                     END
      *
     C                     COMIT
      *
     C                     END
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
     C/EJECT
      *****************************************************************
      *   COMM - format common fields                                 *
      *   Called by - VALD generate message for destination customer ?*
      *****************************************************************
      *
     C           COMM      BEGSR
      *
      ** Module ID
      *
     C                     MOVEL'DL'      MGMODI
      *
      ** Deal details
      *
     C                     MOVELDBRCA     MGBRCA
     C                     MOVEL@DEST     MGCNUM
     C                     MOVELCDLNO     MGTNUM
     C                     Z-ADDDVDAT     MGVDAT
     C                     Z-ADDMDAT      MGMDAT
     C                     MOVELCCY       MGCCY
     C                     MOVELDTYP      MGTTYP
     C                     MOVELDLST      MGTSTP
     C                     MOVELBRKC      MGBRKC
     C           MGCHTP    IFEQ *BLANKS
     C***********          MOVE CHTP      MGCHTP                          E29588
     C***********          END                                            E29588
     C                     MOVELCHTP      MGCHTP
     C                     END                                            E29588
      *                                                                   E32363
      ***Default*A/C*with*Institution*to*the*Pay*Nostro*customer****E32363041713
      ***if*the*A/C*with*Inst.*is*not*entered*on*the*settlements*scrE32363041713
      ***Check*'PONS'*is*a*nostro*and*settlement*is*via*nostro.*****E32363041713
      ************                                                  E32363041713
     C************         MOVE PONS      BLANK  10                 E32363041713
     C************         MOVE *BLANKS   AWBA6   6                 088043041713
     C************         MOVELAWBA      AWBA6                     088043041713
     C***********AWBN      IFEQ *BLANKS                             E32363041713
     C***********AWBA6     ANDNE'DIRECT'                            088043041713
     C***********BLANK     ANDEQ*BLANKS                             E32363041713
      ************                                                  E32363041713
      ***Check*settlement*via*nostro********************************E32363041713
     C***********PSTM      IFEQ 01                                  E32363041713
     C***********PSTM      OREQ 02                                  E32363041713
     C***********PSTM      OREQ 07                                  E32363041713
     C***********PSTM      OREQ 08                                  E32363041713
     C***********PSTM      OREQ 12                                  E32363041713
      ************                                                  E32363041713
      ***Retrieve*Pay*Nostro*customer*******************************E32363041713
     C************         MOVELPONS      P@NONB                    E32363041713
     C************         CALL 'AONOSTR0'                          E32363041713
     C************         PARM '*MSG   ' @RTCD   7                 E32363041713
     C************         PARM '*KEY   ' @OPTN   7                 E32363041713
     C************         PARM *BLANKS   P@CUST  6                 E32363041713
     C************         PARM LBCCY     P@CYCD  3                 E32363041713
     C************         PARM *BLANKS   P@ACCD  4                 E32363041713
     C************         PARM *BLANKS   P@ACSN  2                 E32363041713
     C************         PARM           P@NONB  2                 E32363041713
     C************         PARM *BLANKS   P@BRCD  3                 E32363041713
     C************         PARM *BLANKS   P@CSSN 10                 E32363041713
     C************         PARM *BLANKS   P@PNOI  1                 E32363041713
     C***********SDNOST    PARM SDNOST    DSFDY                     E32363041713
      ************                                                  E32363041713
      ***Error****                                                  E32363041713
     C***********@RTCD     IFNE *BLANKS                             E32363041713
     C************LOCK     IN   LDA                                 E32363041713
     C************         MOVE '012'     DBASE                     E32363041713
     C************         MOVE LBCCY     @WK5    5                 E32363041713
     C************         MOVELPONS      @WK5             * * * * *E32363041713
     C************         MOVEL@WK5      DBKEY            *  DBERR E32363041713
     C************         MOVEL'SDNOSTPD'DBFILE           * * * * *E32363041713
     C************         OUT  LDA                                 E32363041713
     C************         EXSR *PSSR                               E32363041713
     C************         END                                      E32363041713
      ************                                                  E32363041713
      ***A/C*with*Institution*is*equal*to*the*pay*nostro*customer***E32363041713
     C************         MOVELA7CUST    AWBN                      E32363041713
     C************         END                                      E32363041713
     C************         END                                      E32363041713
      ************                                                  E32363041713
      ***For*a*deal*amendment*with*pay*settlement*instructions,*defaE32363041713
      ***the*A/C*with*Institution*to*the*Pay*Nostro*customer*for*theE32363041713
      ***deal*amendment,*if*the*A/C*with*Institution*is*not*entered*E32363041713
      ***on*the*settlements*screen**********************************E32363041713
      ************                                                  E32363041713
     C************         MOVE APONS     BLANK  10                 E32363041713
     C***********CRCDT     IFEQ 'A'                                 E32363041713
     C***********APSTM     ANDGT0                                   E32363041713
     C***********AAWBN     ANDEQ*BLANKS                             E32363041713
     C***********BLANK     ANDEQ*BLANKS                             E32363041713
     C************                                                  059439041713
     C***Check*first*if*APSTM*is*NOT*EQUAL*to*03********************059439041713
     C************                                                  059439041713
     C***********APSTM     IFNE 03                                  059439041713
      ************                                                  E32363041713
      ***Check*settlement*via*nostro********************************E32363041713
     C***********PSTM      IFEQ 01                                  E32363041713
     C***********PSTM      OREQ 02                                  E32363041713
     C***********PSTM      OREQ 07                                  E32363041713
     C***********PSTM      OREQ 08                                  E32363041713
     C***********PSTM      OREQ 12                                  E32363041713
      ************                                                  E32363041713
      ***Retrieve*Deal*Amendment*Pay*Nostro*customer****************E32363041713
     C************         MOVELAPONS     P@NONB                    E32363041713
     C************         CALL 'AONOSTR0'                          E32363041713
     C************         PARM '*MSG   ' @RTCD   7                 E32363041713
     C************         PARM '*KEY   ' @OPTN   7                 E32363041713
     C************         PARM *BLANKS   P@CUST  6                 E32363041713
     C************         PARM LBCCY     P@CYCD  3                 E32363041713
     C************         PARM *BLANKS   P@ACCD  4                 E32363041713
     C************         PARM *BLANKS   P@ACSN  2                 E32363041713
     C************         PARM           P@NONB  2                 E32363041713
     C************         PARM *BLANKS   P@BRCD  3                 E32363041713
     C************         PARM *BLANKS   P@CSSN 10                 E32363041713
     C************         PARM *BLANKS   P@PNOI  1                 E32363041713
     C***********SDNOST    PARM SDNOST    DSFDY                     E32363041713
      ************                                                  E32363041713
      ***Error******************************************************E32363041713
     C***********@RTCD     IFNE *BLANKS                             E32363041713
     C************LOCK     IN   LDA                                 E32363041713
     C************         MOVE '013'     DBASE                     E32363041713
     C************         MOVE LBCCY     @WK5    5                 E32363041713
     C************         MOVELAPONS     @WK5             * * * * *E32363041713
     C************         MOVEL@WK5      DBKEY            *  DBERR E32363041713
     C************         MOVEL'SDNOSTPD'DBFILE           * * * * *E32363041713
     C************         OUT  LDA                                 E32363041713
     C************         EXSR *PSSR                               E32363041713
     C************         END                                      E32363041713
      ************                                                  E32363041713
      ***A/C*with*Institution*is*equal*to*the*pay*nostro*customer***E32363041713
     C************         MOVELA7CUST    AAWBN                     E32363041713
     C************         END                                      E32363041713
     C************         END                                      059439041713
     C************         END                                      E32363041713
      *                                                                                       255986
      ** Bank to Bank Information fields                                                      255986
      *                                                                                       255986
     C           CSW212    IFNE 'Y'                                                           CSW212
     C           @TYP      ORNE '300'                                                         CSW212
     C                     MOVELBTB1      MGBTB1                                              255986
     C                     MOVELBTB2      MGBTB2                                              255986
     C                     MOVELBTB3      MGBTB3                                              255986
     C                     MOVELBTB4      MGBTB4                                              255986
     C                     MOVELBTB5      MGBTB5                                              255986
     C                     MOVELBTB6      MGBTB6                                              255986
     C                     ENDIF                                                              CSW212
      *
      * If Enhanced Receive Settlement Instructions feature is On output                      CDL094
      * receive bank to bank info                                                             CDL094
     C           CDL094    IFEQ 'Y'                                                           CDL094
     C           @TYP      IFEQ '320'                                                         CDL094
     C           @TYP      OREQ '330'                                                         CDL094
     C           RBTB1     IFNE *BLANKS                                                       CDL094
     C                     MOVELRBTB1     MGBTB1                                              CDL094
     C                     MOVELRBTB2     MGBTB2                                              CDL094
     C                     MOVELRBTB3     MGBTB3                                              CDL094
     C                     MOVELRBTB4     MGBTB4                                              CDL094
     C                     MOVELRBTB5     MGBTB5                                              CDL094
     C                     MOVELRBTB6     MGBTB6                                              CDL094
     C                     ENDIF                                                              CDL094
     C                     ENDIF                                                              CDL094
     C                     ENDIF                                                              CDL094
      *                                                                                       CDL094
     C                     ENDSR
      *
      *****************************************************************
     C/EJECT
      *****************************************************************
      *   F300 - Format message specific fields for MT300             *
      *   Called by - VALD                                            *
      *****************************************************************
      *
     C           F300      BEGSR
      *
      **  Format fields for MT300
      *
     C                     MOVELPOBR      MGPOBR
     C                     MOVELROBR      MGROBR
     C                     Z-ADDRSTM      MGRSTM
     C                     Z-ADDPSTM      MGPSTM
      *
     C                     Z-ADDDDAT      MGTDAT
     C                     Z-ADDOTDT      MGOTDT                          CSW097
     C/COPY WNCPYSRC,DL6310C018
     C                     Z-ADDEXRT      MGEXRT
     C/COPY WNCPYSRC,DL6310C019
     C                     MOVE PUCY      MGPUCY
     C/COPY WNCPYSRC,DL6310C020
     C                     Z-ADDPUAM      MGPAMT
     C                     Z-ADDSLAM      MGSAMT
     C/COPY WNCPYSRC,DL6310C021
     C                     MOVELSLCY      MGSLCY
      *
     C                     MOVELPIBN      MGPIBN
     C                     MOVELPIBA      MGPIBA                          056739
     C                     MOVELRIBN      MGRIBN
     C                     MOVELRIBA      MGRIBA                          056739
      *                                                                   CSW097
     C**********           Z-ADDPOBN      MGPOBN                                       CSW097 CSD027
     C**********           Z-ADDPOCN      MGPOCN                                       CSW097 CSD027
     C                     MOVE POBN      MGPOBN                                              CSD027
     C                     MOVE POCN      MGPOCN                                              CSD027
      *                                                                   CSW097
     C                     MOVELPONS      MGPONS
     C                     MOVELRONS      MGRONS
     C/COPY WNCPYSRC,DL6310C003
     C                     MOVELAWBN      MGAWBN
     C                     MOVELAWBA      MGAWBA
     C           WWAWBA    IFEQ 'DIRECT'                                  CSW097
     C           WWAWBB    ANDEQ*BLANKS                                   CSW097
     C                     MOVEL'/DIRECT' MGAWBA    P                     CSW097
     C                     END                                            CSW097
     C/COPY WNCPYSRC,DL6310C004
     C                     MOVELRVNO      MGRVNO
     C                     MOVELBENN      MGBENN
     C                     MOVELBENA      MGBENA                          088043
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL6310CCP1                                           S01408
     C*                                                                   S01408
      *                                                                   CSW012
     C           CSW012    IFEQ 'Y'                                       CSW012
     C           WACOC     ANDNE*BLANKS                                   CSW012
      *                                                                   CSW012
     C                     MOVEL*BLANKS   WDPNM  30                       CSW012
      *                                                                   CSW012
      **  Access Account Officer Details                                  CSW012
     C                     CALL 'AOACOFR0'                                CSW012
     C                     PARM '*MSG   ' @RTCD                           CSW012
     C                     PARM '*KEY   ' @OPTN                           CSW012
     C                     PARM WACOC     @KEY2   2                       CSW012
     C           SDACOF    PARM SDACOF    DSSDY                           CSW012
      *                                                                   CSW012
     C           @RTCD     IFNE *BLANKS                                   CSW012
     C           *LOCK     IN   LDA                                       CSW012
     C                     MOVE '005'     DBASE            * * * * * * * *CSW012
     C                     MOVELWACOC     DBKEY            *  DBERR 005  *CSW012
     C                     MOVEL'SDACOFPD'DBFILE           * * * * * * * *CSW012
     C                     OUT  LDA                                       CSW012
     C                     EXSR *PSSR                                     CSW012
     C                     ENDIF                                          CSW012
      *                                                                   CSW012
     C           @RTCD     IFEQ *BLANKS                                   CSW012
      *                                                                   CSW012
     C           AZDPCD    IFNE *BLANKS                                   CSW012
     C                     CALL 'AODEPTR0'                                CSW012
     C                     PARM *BLANKS   @RTCD                           CSW012
     C                     PARM '*KEY   ' @OPTN                           CSW012
     C                     PARM           AZDPCD                          CSW012
     C           SDDEPT    PARM SDDEPT    DSFDY                           CSW012
     C           @RTCD     IFNE *BLANKS                                   CSW012
     C           *LOCK     IN   LDA                                       CSW012
     C                     MOVE '041'     DBASE            * * * * * * * *CSW012
     C                     MOVELAZDPCD    DBKEY            * DB ERROR 41 *CSW012
     C                     MOVEL'SDDEPTPD'DBFILE           * * * * * * * *CSW012
     C                     OUT  LDA                                       CSW012
     C                     EXSR *PSSR                                     CSW012
     C                     ENDIF                                          CSW012
     C                     MOVELAEDPNM    WDPNM                           CSW012
     C                     ENDIF                                          CSW012
      *                                                                   CSW012
     C           '/NAME/'  CAT  AZACON:0  MGCTC1                          CSW012
     C           '/DEPT/'  CAT  WDPNM:0   MGCTC2                          CSW012
     C           AZAPHN    IFNE *BLANKS                                   CSW012
     C           '/PHON/'  CAT  AZAPHN:0  MGCTC3                          CSW012
     C                     ENDIF                                          CSW012
     C           AZAEXT    IFNE *BLANKS                                   CSW012
     C           MGCTC3    CAT  'EXT':1   MGCTC3                          CSW012
     C           MGCTC3    CAT  AZAEXT:1  MGCTC3                          CSW012
     C                     ENDIF                                          CSW012
     C                     ENDIF                                          CSW012
      *                                                                   CSW012
     C                     ENDIF                                          CSW012
      *                                                                   137909
      ** Move settlement currencies.                                      137909
     C           CEU003    IFEQ 'Y'                                       137909
     C                     EXSR STCY1                                     137909
     C                     ENDIF                                          137909
      *                                                                   CDL008
      ** CLS Settlement                                                   CDL008
      *                                                                   CDL008
     C           CDL008    IFEQ 'Y'                                       CDL008
     C                     MOVE CLSS      MGCLSS                          CDL008
     C                     ENDIF                                          CDL008
      *
     C           MGCHTP    IFEQ *BLANK                                                        CSW025
     C                     MOVE @CHG      MGCHTP                                              CSW025
     C                     ENDIF                                                              CSW025
      *                                                                                       CSW212
      ** Condition lines                                                                      CSW212
      *                                                                                       CSW212
     C                     MOVELCND1      MGCON1                                              CSW212
     C                     MOVELCND2      MGCON2                                              CSW212
     C                     MOVELCND3      MGCON3                                              CSW212
     C                     MOVELCND4      MGCON4                                              CSW212
     C                     MOVELCND5      MGCON5                                              CSW212
     C                     MOVELCND6      MGCON6                                              CSW212
      *                                                                                       CSW212
     C           CSW212    IFEQ 'Y'                                                           CSW212
      *                                                                                       CSW212
      ** Bank to Bank Information and ISDA fields                                             CSW212
      *                                                                                       CSW212
      * Use Receive Bank to Bank details if CDL094 is On                                      CDL094
     C           CDL094    IFEQ 'Y'                                                           CDL094
     C           RBTB1     ANDNE*BLANKS                                                       CDL094
     C                     MOVELRBTB1     MGBTB1                                              CDL094
     C                     MOVELRBTB2     MGBTB2                                              CDL094
     C                     MOVELRBTB3     MGBTB3                                              CDL094
     C                     MOVELRBTB4     MGBTB4                                              CDL094
     C                     MOVELRBTB5     MGBTB5                                              CDL094
     C                     MOVELRBTB6     MGBTB6                                              CDL094
     C                     ELSE                                                               CDL094
     C                     MOVELSSR1      MGBTB1                                              CSW212
     C                     MOVELSSR2      MGBTB2                                              CSW212
     C                     MOVELSSR3      MGBTB3                                              CSW212
     C                     MOVELSSR4      MGBTB4                                              CSW212
     C                     MOVELSSR5      MGBTB5                                              CSW212
     C                     MOVELSSR6      MGBTB6                                              CSW212
     C                     ENDIF                                                              CDL094
      *                                                                                       CSW212
      ** ISDA fields                                                                          CSW212
      *                                                                                       CSW212
     C                     MOVELAGTY      MGAGTY                                              CSW212
     C                     MOVELISDA      MGISDA                                              CSW212
     C                     MOVE AGDT      ZAGDT   6                                           CSW212
     C                     EXSR SRAGDT                                                        CSW212
     C                     MOVEL@@VDT     MGAGDT                                              CSW212
     C                     MOVEL*BLANKS   WAGVV   4                                           CSW212
     C                     MOVELAGVC      WAGVV                                               CSW212
     C                     MOVE AGVV      WAGVV                                               CSW212
     C                     MOVELWAGVV     MGAGVV                                              CSW212
      *                                                                                       CSW212
      ** Precious Metal Buy and Sell Indicators                                               CSW212
      *                                                                                       CSW212
     C                     MOVELMGPUCY    W#CYCD                                              CSW212
     C                     EXSR SRUCCY                                                        CSW212
     C                     MOVELA6PMRT    MGPMBC                                              CSW212
      *                                                                                       CSW212
     C                     MOVELMGSLCY    W#CYCD                                              CSW212
     C                     EXSR SRUCCY                                                        CSW212
     C                     MOVELA6PMRT    MGPMSC                                              CSW212
      *                                                                                       CMG003
     C                     MOVEL'N'       MT600   1                                           CMG003
     C           CMG003    IFEQ 'Y'                                                           CMG003
     C           MGCLSS    ANDNE'Y'                                                        AR1054657
     C           MGPMBC    IFEQ 'Y'                                                           CMG003
     C           MGPMSC    ANDEQ'N'                                                           CMG003
     C           MGPMBC    OREQ 'N'                                                           CMG003
     C           MGPMSC    ANDEQ'Y'                                                           CMG003
     C                     MOVEL'Y'       MT600                                               CMG003
     C                     ENDIF                                                              CMG003
     C                     ENDIF                                                              CMG003
     C                     ENDIF                                                              CSW212
      *                                                                                       CSW212
     C                     EXSR SRREPI                                                        CSW213
      *                                                                                       CSW213
     C           MT600     IFEQ 'Y'                                                           CMG003
     C                     WRITEMGF600D0               40                                     CMG003
     C                     MOVEL'MGF600PD'DBFILE                                              CMG003
     C                     ELSE                                                               CMG003
     C                     WRITEMGF300D0               40
     C                     MOVEL'MGF300PD'DBFILE                                              CMG003
     C                     ENDIF                                                              CMG003
      *
     C           *IN40     IFEQ '1'
     C           *LOCK     IN   LDA
     C                     MOVE '006'     DBASE            * * * * * * * *
     C                     MOVEL@TYP      DBKEY            *  DBERR 006  *
     C**********           MOVEL'MGF300PD'DBFILE           * * * * * * * *                    CMG003
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
     C/EJECT
      *****************************************************************
      *   F324 - Format message specific fields for MT324             *
      *   Called by - VALD                                            *
      *   Calls - LORD                                                *
      *****************************************************************
      *
     C           F324      BEGSR
     C/COPY WNCPYSRC,DL6310C033
      *
      **  Format fields for MT324
      *
     C                     MOVELPOBR      MGPOBR
     C                     MOVELROBR      MGROBR
     C                     Z-ADDRSTM      MGRSTM
     C                     Z-ADDPSTM      MGPSTM
      *
     C                     Z-ADDDDAT      MGTDAT
     C/COPY WNCPYSRC,DL6310C022
     C                     Z-ADDPCPL      MGPCPL
      *
      **  If interest amount on ECONXCY/PF is negative make it positive
     C/COPY WNCPYSRC,DL6310C023
      *
     C           INTA      IFLT 0
     C/COPY WNCPYSRC,DL6310C024
     C                     Z-SUBINTA      MGINTA
     C                     ELSE
     C                     Z-ADDINTA      MGINTA
     C/COPY WNCPYSRC,DL6310C025
     C                     END
      *
     C                     MOVELICBS      MGICBS
     C                     Z-ADDINTR      MGINTR
     C                     MOVELIPFR      MGIPFR
     C                     Z-ADDNIDT      MGNIDT
      *
      ** Amount transferred = principal + interest - amount rolled over
     C/COPY WNCPYSRC,DL6310C026
      *
     C                     Z-ADDPCPL      MGAMTT
     C                     ADD  INTA      MGAMTT
      *                                                                   CEU015
     C***********          Z-ADD0         P@OUTA                   CEU015 145001
     C***********CEU015    IFEQ 'Y'                                CEU015 145001
     C***********RTFC      ANDNE*BLANKS                            CEU015 145001
     C***********RBDA      ANDNE0                                  CEU015 145001
     C***********          Z-ADDRBDA      P@FRAM                   CEU015 145001
     C***********          MOVELRTFC      P@FRCY                   CEU015 145001
     C***********          MOVELCCY       P@TOCY                   CEU015 145001
      ***********                                                  CEU015 145001
      ***Convert*RBDA*to*deal*currency*equivalent*via*call*to*EU020CEU015 145001
      ***********                                                  CEU015 145001
     C***********          CALL 'EU0200'                           CEU015 145001
     C***********          PARM *BLANKS   P@RTCD  7                CEU015 145001
     C***********          PARM           P@FRAM 183               CEU015 145001
     C***********          PARM           P@FRCY  3                CEU015 145001
     C***********          PARM           P@TOCY  3                CEU015 145001
     C***********          PARM           P@OUTA 150               CEU015 145001
     C***********          PARM           P@INTA 183               CEU015 145001
     C***********          PARM           P@EXRT 159               CEU015 145001
     C***********          PARM           P@MDIN  1                CEU015 145001
      ***********                                                  CEU015 145001
      ***Database*error*processing*if*P@RTCD*=**ERROR************* CEU015 145001
      ***********                                                  CEU015 145001
     C***********P@RTCD    IFEQ '*ERROR*'                          CEU015 145001
     C************LOCK     IN   LDA                                CEU015 145001
     C***********          MOVEL'EU0200  'DBFILE    ************** CEU015 145001
     C***********          MOVEL' 17'     DBASE     ** DBERROR 17  CEU015 145001
     C***********          MOVE *BLANKS   DBKEY     ************** CEU015 145001
     C***********          OUT  LDA                                CEU015 145001
     C***********          EXSR *PSSR                              CEU015 145001
     C***********          ENDIF                                   CEU015 145001
     C***********          SUB  P@OUTA    MGAMTT                   CEU015 145001
     C***********          ELSE                                    CEU015 145001
     C                     SUB  RBDA      MGAMTT
     C***********          ENDIF                                   CEU015 145001
     C/COPY WNCPYSRC,DL6310C027
      *
     C                     MOVELPIBN      MGPIBN
     C                     MOVELPIBA      MGPIBA                          056739
     C                     MOVELRIBN      MGRIBN
     C                     MOVELRIBA      MGRIBA                          056739
     C                     MOVELPONS      MGPONS
     C                     MOVELRONS      MGRONS
     C/COPY WNCPYSRC,DL6310C005
     C                     MOVELAWBN      MGAWBN
     C                     MOVELAWBA      MGAWBA
     C/COPY WNCPYSRC,DL6310C006
     C                     MOVELRVNO      MGRVNO
     C                     MOVELBENN      MGBENN
     C                     MOVELBENA      MGBENA                          088043
      *
     C                     EXSR LORD
      *
      ** Move settlement currencies.                                      137909
     C           CEU003    IFEQ 'Y'                                       137909
     C                     EXSR STCY2                                     137909
     C                     ENDIF                                          137909
      *                                                                   137909
     C           MGCHTP    IFEQ *BLANK                                                        CSW025
     C                     MOVE @CHG      MGCHTP                                              CSW025
     C                     ENDIF                                                              CSW025
     C                     WRITEMGF324D0               40
      *
     C           *IN40     IFEQ '1'
     C           *LOCK     IN   LDA
     C                     MOVE '007'     DBASE            * * * * * * * *
     C                     MOVEL@TYP      DBKEY            *  DBERR 007  *
     C                     MOVEL'MGF324PD'DBFILE           * * * * * * * *
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END
     C/COPY WNCPYSRC,DL6310C034
      *
     C                     ENDSR
      *
      *****************************************************************
     C/EJECT
      *****************************************************************   CSW200
      *   F320 - Format message specific fields for MT320             *   CSW200
      *   Called by - VALD                                            *   CSW200
      *   Calls - LORD                                                *   CSW200
      *****************************************************************   CSW200
      *                                                                   CSW200
     C           F320      BEGSR                                          CSW200
      *                                                                   CSW200
      **  Format fields for MT320                                         CSW200
      *                                                                   CSW200
     C                     MOVELPOBR      MGPOBR                          CSW200
     C                     MOVELROBR      MGROBR                          CSW200
     C                     Z-ADDRSTM      MGRSTM                          CSW200
     C                     Z-ADDPSTM      MGPSTM                          CSW200
      *                                                                   CSW200
     C                     Z-ADDDDAT      MGTDAT                          CSW200
     C                     Z-ADDPCPL      MGPCPL                          CSW200
      *                                                                                     MD034675
     C           D@AMD     IFEQ 'Y'                                                         MD034675
     C           AMTP      IFEQ 'PI'                                                        MD034675
     C                     ADD  D@AAM     MGPCPL                                            MD034675
     C                     END                                                              MD034675
     C           AMTP      IFEQ 'PD'                                                        MD034675
     C                     SUB  D@AAM     MGPCPL                                            MD034675
     C                     END                                                              MD034675
     C                     ENDIF                                                            MD034675
      *                                                                                     AR784699
     C                     MOVE 'N'       WTXDT   1                                         AR784699
     C                     Z-ADD*ZEROS    WNTAMT                                            AR784699
     C           CGL031    IFEQ 'Y'                                                         AR784699
      *                                                                                     AR784699
      ** Check if deal type if liable for tax                                               AR784699
      *                                                                                     AR784699
     C           DTYP      IFEQ 'IT'                                                        AR784699
     C           DTYP      OREQ 'CD'                                                        AR784699
     C           DTYP      OREQ 'TD'                                                        AR784699
     C           DTYP      OREQ 'DT'                                                        AR784699
     C           CDL006    ANDEQ'Y'                                                         AR784699
     C           DTYP      OREQ 'LT'                                                        AR784699
     C           CDL006    ANDEQ'Y'                                                         AR784699
     C           DTYP      OREQ 'FT'                                                        AR784699
     C           CDL006    ANDEQ'Y'                                                         AR784699
     C                     MOVE 'Y'       WTXDT   1                                         AR784699
     C                     ENDIF                                                            AR784699
      *                                                                                     AR784699
      ** Call Deposits                                                                      AR784699
      *                                                                                     AR784699
     C           DTYP      IFEQ 'CD'                                                        AR784699
     C           MDAT      ANDEQ0                                                           AR784699
     C           DTYP      OREQ 'DT'                                                        AR784699
     C           CDL006    ANDEQ'Y'                                                         AR784699
     C           MDAT      ANDEQ0                                                           AR784699
     C           DTYP      OREQ 'LT'                                                        AR784699
     C           CDL006    ANDEQ'Y'                                                         AR784699
     C           MDAT      ANDEQ0                                                           AR784699
      *                                                                                     AR784699
     C           DVDAT     IFGE BJRDNB                                                      AR784699
     C           NOTD      IFEQ 0                                                           AR784699
     C           DVDAT     ADD  1         WKMDAT  50                                        AR784699
     C                     ELSE                                                             AR784699
     C           NOTD      ADD  DVDAT     WKMDAT                                            AR784699
     C                     ENDIF                                                            AR784699
     C                     ENDIF                                                            AR784699
      *                                                                                     AR784699
     C           DVDAT     IFLT BJRDNB                                                      AR784699
     C           NOTD      IFEQ 0                                                           AR784699
     C           BJRDNB    ADD  1         WKMDAT                                            AR784699
     C                     ELSE                                                             AR784699
     C           NOTD      ADD  BJRDNB    WKMDAT                                            AR784699
     C                     ENDIF                                                            AR784699
     C                     ENDIF                                                            AR784699
      *                                                                                     AR784699
      ** Else, Fixed Term Deposits                                                          AR784699
      *                                                                                     AR784699
     C                     ELSE                                                             AR784699
     C                     Z-ADDMDAT      WKMDAT                                            AR784699
     C                     ENDIF                                                            AR784699
      *                                                                                     AR784699
     C           WTXDT     IFEQ 'Y'                                                         AR784699
     C                     MOVE DLNO      WDLNO   6                                         AR784699
     C                     MOVE CNUM      WCNUM   6                                         AR784699
     C                     EXSR SRCHKD                                                      AR784699
     C           WSKIP     IFEQ 'N'                                                         AR784699
     C                     EXSR SRCEUT                                                      AR784699
     C                     ELSE                                                             AR784699
     C                     Z-ADD*ZEROS    WNTAMT                                            AR784699
     C                     ENDIF                                                            AR784699
     C                     ENDIF                                                            AR784699
     C                     ENDIF                                                            AR784699
      *                                                                                     AR694628
      ** Value date should be the effective date of interest change                         AR694628
      *                                                                                     AR694628
     C           AMTP      IFEQ 'SC'                                                        AR694628
     C           AMTP      OREQ 'BC'                                                        MD034675
     C           AMTP      OREQ 'PI'                                                        MD034675
     C           AMTP      OREQ 'PD'                                                        MD034675
     C                     Z-ADDVDAT      MGVDAT                                            AR694628
     C                     ENDIF                                                            AR694628
      *                                                                                     AR598353
      ** Maturity date should be the Early Maturity date for deal                           AR598353
      ** amendment type 'EM' and Trade date should be the Value date                        AR598353
      ** of the deal amendment                                                              AR598353
      *                                                                                     AR598353
     C           AMTP      IFEQ 'EM'                                                        AR598353
     C                     Z-ADDEMDAT     MGMDAT                                            AR598353
     C                     Z-ADDVDAT      MGTDAT                                            AR598353
     C                     ENDIF                                                            AR598353
      *                                                                   CSW200
      **  If interest amount on ECONXCY/PF is negative make it positive   CSW200
      *                                                                   CSW200
     C           INTA      IFLT 0                                         CSW200
     C                     Z-SUBINTA      MGINTA                          CSW200
     C                     ELSE                                           CSW200
     C                     Z-ADDINTA      MGINTA                          CSW200
     C                     ENDIF                                          CSW200
      *
     C                     SUB  WNTAMT    MGINTA                                            AR784699
      *                                                                   CSW200
     C                     MOVELICBS      MGICBS                          CSW200
     C                     Z-ADDINTR      MGINTR                          CSW200
     C           D@AMD     IFEQ 'Y'                                                         MD034675
     C           AMTP      IFEQ 'SC'                                                        MD034675
     C           D@RSP     ADD  BRTE      MGINTR                                            MD034675
     C                     END                                                              MD034675
     C           AMTP      IFEQ 'BC'                                                        MD034675
     C           D@RSP     ADD  D@BRT     MGINTR                                            MD034675
     C                     END                                                              MD034675
     C                     ENDIF                                                            MD034675
     C                     MOVELIPFR      MGIPFR                          CSW200
     C                     Z-ADDNIDT      MGNIDT                          CSW200
      *                                                                   CSW200
      ** Amount transferred = principal + interest - amount rolled over   CSW200
      *                                                                   CSW200
     C                     Z-ADDPCPL      MGAMTT                          CSW200
     C                     ADD  INTA      MGAMTT                          CSW200
     C                     SUB  RBDA      MGAMTT                          CSW200
     C/COPY WNCPYSRC,DLH00431
      *                                                                   CSW200
     C                     MOVELPIBN      MGPIBN                          CSW200
     C/COPY WNCPYSRC,DLH00459
     C                     MOVELPIBA      MGPIBA                          CSW200
     C                     MOVELRIBN      MGRIBN                          CSW200
     C                     MOVELRIBA      MGRIBA                          CSW200
     C                     MOVELPONS      MGPONS                          CSW200
     C                     MOVELRONS      MGRONS                          CSW200
     C                     MOVELAWBN      MGAWBN                          CSW200
     C                     MOVELAWBA      MGAWBA                          CSW200
     C                     MOVELRVNO      MGRVNO                          CSW200
     C                     MOVELBENN      MGBENN                          CSW200
     C                     MOVELBENA      MGBENA                          CSW200
      *                                                                   CSW200
     C           AMTP      IFEQ 'SC'                                                        AR694628
     C           BRTE      ADD  RTSP      MGINTR                                            AR694628
     C                     ENDIF                                                            AR694628
      *                                                                                     AR694628
     C                     EXSR LORD                                      CSW200
      *                                                                   CSW200
      ** Move settlement currencies.                                      CSW200
     C           CEU003    IFEQ 'Y'                                       CSW200
     C                     EXSR STCY2                                     CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
     C           CSW200    IFEQ 'CSW200'                                  CSW200
     C                     MOVEL'C'       MGMATU                          CSW200
     C                     MOVELIPDS      MGIPDS                          CSW200
     C                     MOVELINSA      MGINSA                          CSW200
     C                     MOVELIMET      MGIMET                          CSW200
     C                     MOVELINOS      MGINOS                          CSW200
     C                     MOVELISCY      MGISCY                          CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
     C           MGCHTP    IFEQ *BLANK                                                        CSW025
     C                     MOVE @CHG      MGCHTP                                              CSW025
     C                     ENDIF                                                              CSW025
      *                                                                                       CSW208
     C           DLSWCF    IFEQ 'Y'                                                           CSW208
     C                     ADD  1         WSEQN                                               CSW208
     C                     EXSR X320                                                          CSW208
     C                     Z-ADDWSEQN     MGSEQN                                              CSW208
     C                     Z-ADDWFECNT    MGFTOT                                              CSW208
     C                     ENDIF                                                              257464
      *                                                                                       257464
     C                     MOVE 'N'       MGFLTR                                              CSW208
      *                                                                                       CSW208
     C           CDL019    IFEQ 'Y'                                                           CSW208
     C********** BRTT      ANDNE*ZEROS                                                 CSW208 CSD103
     C           BRTT      ANDNE*BLANKS                                                       CSD103
     C           FSFBRT    ANDNE'Y'                                                         AR916361
     C                     MOVE 'Y'       MGFLTR                                              CSW208
     C                     ENDIF                                                              CSW208
     C**********           ENDIF                                                       CSW208 257464
      *                                                                                       CSW208
     C                     WRITEMGF320D0               40                 CSW200
      *                                                                   CSW200
     C           *IN40     IFEQ '1'                                       CSW200
     C           *LOCK     IN   LDA                                       CSW200
     C                     MOVE '017'     DBASE            * * * * * * * *CSW200
     C                     MOVEL@TYP      DBKEY            *  DBERR 017  *CSW200
     C                     MOVEL'MGF320PD'DBFILE           * * * * * * * *CSW200
     C                     OUT  LDA                                       CSW200
     C                     EXSR *PSSR                                     CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
     C                     ENDSR                                          CSW200
      *                                                                   CSW200
      *****************************************************************   CSW200
     C/EJECT                                                              CSW200
      *****************************************************************                       CSW208
      *   X320 - Format message specific fields for MT320             *                       CSW208
      *   Called by - F320                                            *                       CSW208
      *   Calls - X320H, X320L                                        *                       CSW208
      *****************************************************************                       CSW208
      *                                                                                       CSW208
     C           X320      BEGSR                                                              CSW208
      *                                                                                       CSW208
     C           KFEED     KLIST                                                              CSW208
     C                     KFLD           CDLNO                                               CSW208
      *                                                                                       CSW208
     C                     Z-ADD*ZEROS    WFECNT  50                                        BUG20927
     C           KFEED     SETLLDLFHSTL0                                                      CSW208
     C           KFEED     READEDLFHSTL0                 99                                   CSW208
      *                                                                                       CSW208
     C           *IN99     DOWEQ'0'                                                           CSW208
     C                     EXSR X320H                                                         CSW208
      *                                                                                       CSW208
     C           KFEED     READEDLFHSTL0                 99                                   CSW208
     C                     ENDDO                                                              CSW208
      *                                                                                       CSW208
     C           KFEED     SETLLDLFEEDLI                                                      CSW208
     C           KFEED     READEDLFEEDLI                 99                                   CSW208
      *                                                                                       CSW208
     C           *IN99     DOWEQ'0'                                                           CSW208
     C                     EXSR X320L                                                         CSW208
      *                                                                                       CSW208
     C           KFEED     READEDLFEEDLI                 99                                   CSW208
     C                     ENDDO                                                              CSW208
      *                                                                                       CSW208
     C                     ENDSR                                                              CSW208
      *****************************************************************                       CSW208
     C/EJECT                                                                                  CSW208
      *****************************************************************                       CSW208
      *   X320H - Format message specific fields for MT320            *                       CSW208
      *   Called by - X320                                            *                       CSW208
      *   Calls - None                                                *                       CSW208
      *****************************************************************                       CSW208
      *                                                                                       CSW208
     C           X320H     BEGSR                                                              CSW208
      *                                                                                       CSW208
     C                     ADD  1         WFECNT                                              CSW208
      *                                                                                       CSW208
     C                     Z-ADDWSEQN     MFSEQN                                              CSW208
     C                     Z-ADDWFECNT    MFSEQO                                              CSW208
     C                     Z-ADDHIHDAT    MFPDAT                                              CSW208
     C                     MOVELHIFCCY    MFPCCY                                              CSW208
     C                     Z-ADDHIAMTS    MFPAMT                                              CSW208
     C                     MOVELHIPONS    MFPONS                                              CSW208
     C                     MOVELHIRVNO    MFRVNO                                              CSW208
     C                     MOVELHIPIBN    MFPIBN                                              CSW208
     C                     MOVELHIPIBA    MFPIBA                                              CSW208
     C                     MOVELHIAWBN    MFAWBN                                              CSW208
     C                     MOVELHIAWBA    MFAWBA                                              CSW208
     C                     MOVELHIRONS    MFRONS                                              CSW208
     C                     MOVELHIRIBN    MFRIBN                                              CSW208
     C                     MOVELHIRIBA    MFRIBA                                              CSW208
     C                     MOVELHIBENN    MFBENN                                              CSW208
     C                     MOVELHIBENA    MFBENA                                              CSW208
     C                     MOVELHIOMDB    MFPOBR                                              CSW208
     C                     MOVELHIOSDB    MFROBR                                              CSW208
     C                     Z-ADDHIPSTM    MFPSTM                                              CSW208
     C                     Z-ADDHIRSTM    MFRSTM                                              CSW208
     C                     MOVELHISCCY    MFSTCY                                              CSW208
     C                     MOVELHISCCY    MFPSCY                                              CSW208
     C                     MOVEL'H'       MFHIST                                              CSW208
     C                     WRITEMGX320D0                                                      CSW208
      *                                                                                       CSW208
     C                     ENDSR                                                              CSW208
      *****************************************************************                       CSW208
     C/EJECT                                                                                  CSW208
      *****************************************************************                       CSW208
      *   X320L - Format message specific fields for MT320            *                       CSW208
      *   Called by - X320                                            *                       CSW208
      *   Calls - X320L2                                              *                       CSW208
      *****************************************************************                       CSW208
      *                                                                                       CSW208
     C           X320L     BEGSR                                                              CSW208
      *                                                                                       CSW208
     C           DFPYON    IFEQ ' '                                                           CSW208
     C           DFPYON    OREQ 'S'                                                           CSW208
     C                     Z-ADDDFPSTD    MFPDAT                                              CSW208
     C                     EXSR X320L2                                                        CSW208
     C                     ENDIF                                                              CSW208
      *                                                                                       CSW208
     C           DFPYON    IFEQ 'E'                                                           CSW208
     C                     Z-ADDDFPEND    MFPDAT                                              CSW208
     C                     EXSR X320L2                                                        CSW208
     C                     ENDIF                                                              CSW208
      *                                                                                       CSW208
     C           DFPYON    IFEQ 'N'                                                           CSW208
      *                                                                                       CSW208
     C           DFNPYD    IFEQ *ZEROS                                                        CSW208
     C                     Z-ADDDFPEND    MFPDAT                                              CSW208
     C                     ELSE                                                               CSW208
     C                     Z-ADDDFNPYD    MFPDAT                                              CSW208
     C                     ENDIF                                                              CSW208
      *                                                                                       CSW208
     C                     EXSR X320L2                                                        CSW208
      *                                                                                       CSW208
     C                     Z-ADDMFPDAT    NWNPYD  50                                          CSW208
      *                                                                                       CSW208
     C           NWNPYD    DOWLTDFPEND                                                        CSW208
      *                                                                                       CSW208
      ** If frequency not blank, calculate next payment date                                  CSW208
      *                                                                                       CSW208
     C           DFFREQ    IFNE *BLANKS                                                       CSW208
     C                     MOVE DFFREQ    ZFREQ   1                                           CSW208
     C                     Z-ADDNWNPYD    ZDAYNO  50                                          CSW208
     C                     Z-ADDDFDYIM    ZMDAY   20                                          CSW208
     C                     MOVE BJLCCY    ZCCY    3                                           CSW208
     C                     MOVE *BLANK    ZZERR@  7                                           CSW208
      *                                                                                       CSW208
     C                     EXSR ZFREQB                                                        CSW208
      *                                                                                       CSW208
     C           ZZERR@    IFNE *BLANKS                                                       CSW208
     C                     MOVE '003'     DBASE            * * * * * * * *                    CSW208
     C                     MOVELDFNPYD    DBKEY            * DB ERROR 03 *                    CSW208
     C                     MOVEL'ZFREQB'  DBFILE           * * * * * * * *                    CSW208
     C                     EXSR *PSSR                                                         CSW208
     C                     ENDIF                                                              CSW208
      *                                                                                       CSW208
     C           ZDAYNO    IFGT DFPEND                                                        CSW208
     C                     Z-ADDDFPEND    NWNPYD                                              CSW208
     C                     ELSE                                                               CSW208
     C                     Z-ADDZDAYNO    NWNPYD                                              CSW208
     C                     ENDIF                                                              CSW208
      *                                                                                       CSW208
     C                     ELSE                                                               CSW208
     C                     Z-ADDDFPEND    NWNPYD                                              CSW208
     C                     ENDIF                                                              CSW208
      *                                                                                       CSW208
     C                     ADD  1         WFECNT                                              CSW208
     C                     Z-ADDWFECNT    MFSEQO                                              CSW208
     C                     Z-ADDNWNPYD    MFPDAT                                              CSW208
     C                     WRITEMGX320D0                                                      CSW208
      *                                                                                       CSW208
     C                     ENDDO                                                              CSW208
      *                                                                                       CSW208
     C                     ENDIF                                                              CSW208
      *                                                                                       CSW208
     C                     ENDSR                                                              CSW208
      *****************************************************************                       CSW208
     C/EJECT                                                                                  CSW208
      *****************************************************************                       CSW208
      *   X320L2 - Format message specific fields for MT320           *                       CSW208
      *   Called by - X320L                                           *                       CSW208
      *   Calls - None                                                *                       CSW208
      *****************************************************************                       CSW208
      *                                                                                       CSW208
     C           X320L2    BEGSR                                                              CSW208
      *                                                                                       CSW208
     C                     ADD  1         WFECNT                                              CSW208
      *                                                                                       CSW208
     C                     Z-ADDWSEQN     MFSEQN                                              CSW208
     C                     Z-ADDWFECNT    MFSEQO                                              CSW208
     C                     MOVELDFFCCY    MFPCCY                                              CSW208
     C                     Z-ADDDFFAMT    MFPAMT                                              CSW208
     C                     MOVELDFPONS    MFPONS                                              CSW208
     C                     MOVELDFRVNO    MFRVNO                                              CSW208
     C                     MOVELDFPIBN    MFPIBN                                              CSW208
     C                     MOVELDFPIBA    MFPIBA                                              CSW208
     C                     MOVELDFAWBN    MFAWBN                                              CSW208
     C                     MOVELDFAWBA    MFAWBA                                              CSW208
     C                     MOVELDFRONS    MFRONS                                              CSW208
     C                     MOVELDFRIBN    MFRIBN                                              CSW208
     C                     MOVELDFRIBA    MFRIBA                                              CSW208
     C                     MOVELDFBENN    MFBENN                                              CSW208
     C                     MOVELDFBENA    MFBENA                                              CSW208
     C                     MOVELDFOMDB    MFPOBR                                              CSW208
     C                     MOVELDFOSDB    MFROBR                                              CSW208
     C                     Z-ADDDFPSTM    MFPSTM                                              CSW208
     C                     Z-ADDDFRSTM    MFRSTM                                              CSW208
     C                     MOVELDFSCCY    MFSTCY                                              CSW208
     C                     MOVELDFSCCY    MFPSCY                                              CSW208
     C                     MOVEL'L'       MFHIST                                              CSW208
     C                     WRITEMGX320D0                                                      CSW208
      *                                                                                       CSW208
     C                     ENDSR                                                              CSW208
      *****************************************************************                       CSW208
     C/EJECT                                                                                  CSW208
      *****************************************************************                       CSW208
      *   Standard Midas Subroutine                                   *                       CSW208
      *   Called by - X320L                                           *                       CSW208
      *   Calls - ZFREQB                                              *                       CSW208
      *****************************************************************                       CSW208
     C/COPY ZSRSRC,ZACCH                                                                      CSW208
     C/COPY ZSRSRC,ZCHKH                                                                      CSW208
     C/COPY ZSRSRC,ZDATE1Z2                                                                   CSW208
     C/COPY ZSRSRC,ZDATE2Z2                                                                   CSW208
     C/COPY ZSRSRC,ZFREQBZ2                                                                   CSW208
      *****************************************************************                       CSW208
     C/EJECT                                                                                  CSW208
      *****************************************************************
      *   F330 - Format message specific fields for MT330             *
      *   Called by - VALD                                            *
      *   Calls - LORD                                                *
      *****************************************************************
      *
     C           F330      BEGSR
      *
      **  Format fields for MT330
      *
     C***********          Z-ADDBJRDNB    MGTDAT                          059258
     C                     Z-ADDDDAT      MGTDAT                          059258
     C/COPY WNCPYSRC,DL6310C028
     C                     Z-ADDDAAM      MGPCPL
     C           AMTP      IFEQ 'SC'                                      CSW200
     C/COPY WNCPYSRC,DL6310C029
     C                     Z-ADDPCPL      MGPCPL                          CSW200
     C                     ENDIF                                          CSW200
     C*                                                                   089642
     C**  Set up amount if not for maturity confirmation                  089642
     C*                                                                   089642
     C           CCNRQ     IFNE 'M'                                       089642
     C                     Z-ADDVDAT      MGVDAT                             FIX
      *
      ** Increase or decrease principal by amendment amount
     C/COPY WNCPYSRC,DL6310C030
      *
     C                     Z-ADDPCPL      MGNAMT
     C/COPY WNCPYSRC,DL6310C031
     C*                                                                   089642
     C                     END                                            089642
      *                                                                   068795
      ***If*more*than*one*deam*for*a*deal*ensure*that*the*princi-* 068795 165468
      ***pal*amount*takes*into*account*the*previous adjustments.** 068795 165468
      *                                                                   068795
      ***Also*ensure*that*interest*amount*takes*into*account****** 106777 165468
      ***previous*adjustments************************************* 106777 165468
      *                                                                   106777
     C***********CRCDT     IFEQ 'A'                                068795 165468
     C***********STNUM     IFNE MGTNUM                             068795 165468
     C***********          Z-ADDPCPL      CPCPL  130               068795 165468
     C***********          MOVE MGTNUM    STNUM  15                068795 165468
      *                                                                   106777
      ***Blank*'Interest changed'*ind*on*change*of*deal*no.******* 106777 165468
      *                                                                   106777
     C***********          MOVE ' '       STIND   1                106777 165468
      *                                                                   106777
     C***********          ELSE                                    068795 165468
     C***********          Z-ADDCPCPL     MGNAMT                   068795 165468
      *                                                                   106777
      ***Pick*up*stored*interest*rate*if*it*has*changed*for*this** 106777 165468
      ***deal*****************************************************        165468
      *                                                                   106777
     C***********STIND     IFEQ 'Y'                                106777 165468
     C***********          Z-ADDSTINTR    INTR                     106777 165468
     C***********          ENDIF                                   106777 165468
     C***********          ENDIF                                   068795 165468
     C***********          ENDIF                                   068795 165468
      *                                                                   068795
      ***Add/subtract*amendment*amount*to*get*new*amount*and****** 068795 165468
      ***stored*current*principal********************************* 068795 165468
      *                                                                   068795
     C***********AMTP      IFEQ 'PI'                                      165468
     C***********          ADD  DAAM      MGNAMT                          165468
     C***********          ADD  DAAM      CPCPL                    068795 165468
     C***********          ELSE                                           165468
     C***********          SUB  DAAM      MGNAMT                          165468
     C***********          SUB  DAAM      CPCPL                    068795 165468
     C***********          END                                            165468
      *
      ** Check whether interest is due before maturity
      *
     C           NIDT      IFEQ 0
     C                     Z-ADDMDAT      MGNIDT
     C                     ELSE
     C                     Z-ADDNIDT      MGNIDT
     C                     END
      *
     C                     Z-ADDINTR      MGINTR
     C***********AMTP******IFEQ 'SC'                                CSW200165468
     C*********************Z-ADDRTSP      MGINTR                    CSW200165468
     C*********************Z-ADDRTSP      STINTR                    CSW200165468
     C*********************MOVEL'Y'       STIND                     CSW200165468
     C*********************ENDIF                                    CSW200165468
     C*                                                             CSW200
     C                     MOVELAMTP      MGAMTP
     C                     MOVELICBS      MGICBS
     C                     MOVELIPFR      MGIPFR
     C                     MOVELSLID      MGSLID
     C                     Z-ADDTOTI      MGTOTI
      *                                                                   CSW200
     C           AMTP      IFEQ 'SC'                                      CSW200
     C           INTA      IFLT *ZEROS                                    CSW200
     C                     Z-SUBINTA      MGTOTI                          CSW200
     C                     ELSE                                           CSW200
     C                     Z-ADDINTA      MGTOTI                          CSW200
     C                     ENDIF                                          CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
     C                     MOVELNOTD      MGNOTD
      ***********                                                         E31211
      ****Use*settlement instructions from original deal if               E31211
      ****settlement method on amendment is 00 - because                  E31211
      ****amendment settlement instructions will be blank                 E31211
      ***********                                                         E31211
     C***********DPSTM     IFGT 0                                         E31211
     C***********          MOVELPIBN      MGPIBN                          E31211
     C***********          MOVELPONS      MGPONS                          E31211
     C***********          Z-ADDPSTM      MGPSTM                          E31211
     C***********          MOVELOSBR      MGPOBR                          E31211
     C***********          ELSE                                           E31211
     C***********          MOVELDPIBN     MGPIBN                          E31211
     C***********          MOVELDPONS     MGPONS                          E31211
     C***********          Z-ADDDPSTM     MGPSTM                          E31211
     C***********          MOVELDPOBR     MGPOBR                          E31211
     C***********          END                                            E31211
      ***********                                                         E31211
     C***********DRSTM     IFGT 0                                         E31211
     C***********          MOVELRIBN      MGRIBN                          E31211
     C***********          MOVELRONS      MGRONS                          E31211
     C***********          Z-ADDRSTM      MGRSTM                          E31211
     C***********          MOVELOSBR      MGROBR                          E31211
     C***********          ELSE                                           E31211
     C***********          MOVELDRIBN     MGRIBN                          E31211
     C***********          MOVELDRONS     MGRONS                          E31211
     C***********          Z-ADDDRSTM     MGRSTM                          E31211
     C***********          MOVELDROBR     MGROBR                          E31211
     C***********          END                                            E31211
      ***********                                                         E31211
     C***********DPSTM     IFGT 0                                         E31211
     C***********DRSTM     ANDGT0                                         E31211
     C***********          MOVELAWBA      MGAWBA                          E31211
     C***********          MOVELAWBN      MGAWBN                          E31211
     C***********          MOVELRVNO      MGRVNO                          E31211
     C***********          MOVELBENN      MGBENN                          E31211
     C***********          ELSE                                           E31211
     C***********          MOVELDAWBA     MGAWBA                          E31211
     C***********          MOVELDAWBN     MGAWBN                          E31211
     C***********          MOVELDRVNO     MGRVNO                          E31211
     C***********          MOVELDBENN     MGBENN                          E31211
     C***********          END                                            E31211
      *                                                                   E31211
      **  If this is a deal amendment and the settlement instructions     E31211
      **  are filled in, use the deal amendment instructions;             E31211
      **  Else use the deal settlement instructions                       E31211
      *                                                                   E31211
     C           CRCDT     IFEQ 'A'                                       E31211
     C           APSTM     ANDGT0                                         E31211
     C                     MOVELAPIBN     MGPIBN                          E31211
     C                     MOVELAPIBA     MGPIBA                          056739
     C                     MOVELAPONS     MGPONS                          E31211
     C                     Z-ADDAPSTM     MGPSTM                          E31211
     C/COPY WNCPYSRC,DL6310C007
     C                     MOVELAAWBA     MGAWBA                          E31211
     C                     MOVELAAWBN     MGAWBN                          E31211
     C/COPY WNCPYSRC,DL6310C008
     C                     MOVELARVNO     MGRVNO                          E31211
     C                     MOVELABENN     MGBENN                          E31211
     C                     MOVELABENA     MGBENA                          088043
     C                     MOVELAOSBR     MGPOBR                          E31211
     C                     ELSE                                           E31211
     C                     MOVELPIBN      MGPIBN                          E31211
     C                     MOVELPIBA      MGPIBA                          056739
     C                     MOVELPONS      MGPONS                          E31211
     C                     Z-ADDPSTM      MGPSTM                          E31211
     C/COPY WNCPYSRC,DL6310C009
     C                     MOVELAWBA      MGAWBA                          E31211
     C                     MOVELAWBN      MGAWBN                          E31211
     C/COPY WNCPYSRC,DL6310C010
     C                     MOVELRVNO      MGRVNO                          E31211
     C                     MOVELBENN      MGBENN                          E31211
     C                     MOVELBENA      MGBENA                          088043
     C                     MOVELPOBR      MGPOBR                          E31211
     C                     END                                            E31211
      *                                                                   E31211
     C           CRCDT     IFEQ 'A'                                       E31211
     C           ARSTM     ANDGT0                                         E31211
     C                     MOVELARIBN     MGRIBN                          E31211
     C                     MOVELARIBA     MGRIBA                          056739
     C                     MOVELARONS     MGRONS                          E31211
     C                     Z-ADDARSTM     MGRSTM                          E31211
     C                     MOVELAOSBR     MGROBR                          E31211
     C                     ELSE                                           E31211
     C                     MOVELRIBN      MGRIBN                          E31211
     C                     MOVELRIBA      MGRIBA                          056739
     C                     MOVELRONS      MGRONS                          E31211
     C                     Z-ADDRSTM      MGRSTM                          E31211
     C                     MOVELROBR      MGROBR                          E31211
     C                     END                                            E31211
      *
      ** Check for loan or deposit
      *
     C                     EXSR LORD
      *
      **  If an amendment, & the amendment type is a principle decrease
      **  the loan/deposit flag has to be reversed.
     C           CVDAT     IFGT 0
     C           AMTP      ANDEQ'PD'
     C           CSW200    ANDNE'CSW200'                                  186725
      *
     C           MGLORD    IFEQ 'L'
     C                     MOVE 'D'       MGLORD
     C                     ELSE
     C                     MOVE 'L'       MGLORD
     C                     END
      *
     C                     END
      *
      ** Move settlement currencies.                                      137909
     C           CEU003    IFEQ 'Y'                                       137909
     C                     EXSR STCY2                                     137909
     C                     ENDIF                                          137909
      *                                                                   137909
     C           CSW200    IFEQ 'CSW200'                                  CSW200
     C                     MOVELIPDS      MGIPDS                          CSW200
     C                     MOVELINSA      MGINSA                          CSW200
     C                     MOVELIMET      MGIMET                          CSW200
     C                     MOVELINOS      MGINOS                          CSW200
     C                     MOVELISCY      MGISCY                          CSW200
     C                     ENDIF                                          CSW200
      *                                                                   CSW200
      *                                                                   165468
      ** If more than one deam for a deal ensure that the principal       165468
      ** amount takes into account the previous adjustments.              165468
      *                                                                   165468
     C           CRCDT     IFEQ 'A'                                       165468
      *                                                                   165468
      ** Read DEAMS for all amendments for this deal up until this one    165468
      *                                                                   165468
     C                     Z-ADDCVDAT     STVDAT  50                      165468
     C                     Z-ADDCDASN     STDASN  30                      165468
     C                     Z-ADDCDLNO     KDLNO                           165468
     C                     Z-ADD0         CVDAT                           165468
     C                     Z-ADD0         CDASN                           165468
     C           ECONKY    SETLLDEAMS                                     165468
     C                     READ DEAMS                    12               165468
     C           DLNO      DOWEQCDLNO                                     165468
     C           *IN12     ANDEQ'0'                                       165468
     C           RECI      IFEQ 'D'                                       165468
     C           STVDAT    IFGT VDAT                                      165468
     C           STVDAT    OREQ VDAT                                      165468
     C           STDASN    ANDGEDASN                                      165468
      *                                                                   165468
      ** Add/subtract amendment amount to get new amount and stored       165468
      ** current principal                                                165468
      *                                                                   165468
     C           AMTP      IFEQ 'PI'                                      165468
     C           AMTP      OREQ 'CI'                                      165468
     C                     ADD  DAAM      MGNAMT                          165468
     C                     END                                            165468
     C           AMTP      IFEQ 'PD'                                      165468
     C                     SUB  DAAM      MGNAMT                          165468
     C                     END                                            165468
     C           AMTP      IFEQ 'SC'                                      165468
     C                     Z-ADDRTSP      MGINTR                          165468
     C                     END                                            165468
     C                     END                                            165468
     C                     END                                            165468
     C                     READ DEAMS                    12               165468
     C                     ENDDO                                          165468
     C                     ENDIF                                          165468
      *                                                                   165468
     C           MGCHTP    IFEQ *BLANK                                                        CSW025
     C                     MOVE @CHG      MGCHTP                                              CSW025
     C                     ENDIF                                                              CSW025
     C                     WRITEMGF330D0               40
      *
     C           *IN40     IFEQ '1'
     C           *LOCK     IN   LDA
     C                     MOVE '008'     DBASE            * * * * * * * *
     C                     MOVEL@TYP      DBKEY            *  DBERR 008  *
     C                     MOVEL'MGF330PD'DBFILE           * * * * * * * *
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
     C/EJECT
      *****************************************************************
      *   F335 - Format message specific fields for MT335             *
      *   Called by - VALD                                            *
      *****************************************************************
      *
     C           F335      BEGSR
      *
      **  Format fields for MT335
      *
     C                     MOVELNOTD      MGNOTD
     C***********          Z-ADDLCD       MGTDAT                          059258
     C                     Z-ADDDDAT      MGTDAT                          059258
      *                                                                   106777
      ***If*more*than*one*DEAM*for*a*deal,*ensure*principal*is**** 106777 165468
      ***latest*amount******************************************** 106777 165468
      *                                                                   106777
     C***********STNUM     IFNE MGTNUM                             106777 165468
     C***********          Z-ADDPCPL      MGPCPL                   106777 165468
     C***********          ELSE                                    106777 165468
     C***********          Z-ADDCPCPL     MGPCPL                   106777 165468
     C***********          END                                     106777 165468
     C***********          Z-ADDPCPL      MGPCPL                          106777
     C                     Z-ADDPCPL      MGPCPL                          165468
      *                                                                   106777
     C                     Z-ADDRTSP      MGINTR                             FIX
      *                                                                   106777
      ***Save*interest*rate*in*case*further*DEAMS*for*this*deal*** 106777 165468
      *                                                                   106777
     C***********          Z-ADDRTSP      STINTR 117               106777 165468
     C***********          MOVE 'Y'       STIND   1                106777 165468
      *                                                                   106777
     C                     Z-ADDVDAT      MGVDAT                             FIX
     C                     Z-ADDNIDT      MGNIDT
     C                     MOVELICBS      MGICBS
     C                     MOVELIPFR      MGIPFR
     C                     MOVELSLID      MGSLID
     C                     MOVELAMTP      MGAMTP
      *
      **  If interest amount on ECONXCY/PF is negative make it positive
      *
     C           INTA      IFLT 0
     C                     Z-SUBINTA      MGTOTI
     C                     ELSE
     C                     Z-ADDINTA      MGTOTI
     C                     END
      ***********                                                         E31211
      ****Use*settlement instructions from original deal if               E31211
      ****settlement method on amendment is 00 - because                  E31211
      ****amendment settlement instructions will be blank                 E31211
      ***********                                                         E31211
     C***********PSTM      IFGT 0                                         E31211
     C***********          MOVELPIBN      MGPIBN                          E31211
     C***********          MOVELPONS      MGPONS                          E31211
     C***********          Z-ADDPSTM      MGPSTM                          E31211
     C***********          MOVELOSBR      MGPOBR                          E31211
     C***********          ELSE                                           E31211
     C***********          MOVELDPIBN     MGPIBN                          E31211
     C***********          MOVELDPONS     MGPONS                          E31211
     C***********          Z-ADDDPSTM     MGPSTM                          E31211
     C***********          MOVELDPOBR     MGPOBR                          E31211
     C***********          END                                            E31211
      ***********                                                         E31211
     C***********RSTM      IFGT 0                                         E31211
     C***********          MOVELRIBN      MGRIBN                          E31211
     C***********          MOVELRONS      MGRONS                          E31211
     C***********          Z-ADDRSTM      MGRSTM                          E31211
     C***********          MOVELOSBR      MGROBR                          E31211
     C***********          ELSE                                           E31211
     C***********          MOVELDRIBN     MGRIBN                          E31211
     C***********          MOVELDRONS     MGRONS                          E31211
     C***********          Z-ADDDRSTM     MGRSTM                          E31211
     C***********          MOVELDROBR     MGROBR                          E31211
     C***********          END                                            E31211
      ***********                                                         E31211
     C***********PSTM      IFGT 0                                         E31211
     C***********RSTM      ANDGT0                                         E31211
     C***********          MOVELAWBA      MGAWBA                          E31211
     C***********          MOVELAWBN      MGAWBN                          E31211
     C***********          MOVELRVNO      MGRVNO                          E31211
     C***********          MOVELBENN      MGBENN                          E31211
     C***********          ELSE                                           E31211
     C***********          MOVELDAWBA     MGAWBA                          E31211
     C***********          MOVELDAWBN     MGAWBN                          E31211
     C***********          MOVELDRVNO     MGRVNO                          E31211
     C***********          MOVELDBENN     MGBENN                          E31211
     C***********          END                                            E31211
      *                                                                   E31211
      **  If this is a deal amendment and the settlement instructions     E31211
      **  are filled in, use the deal amendment instructions;             E31211
      **  Else use the deal settlement instructions                       E31211
      *                                                                   E31211
     C           CRCDT     IFEQ 'A'                                       E31211
     C           APSTM     ANDGT0                                         E31211
     C                     MOVELAPIBN     MGPIBN                          E31211
     C                     MOVELAPIBA     MGPIBA                          056739
     C                     MOVELAPONS     MGPONS                          E31211
     C                     Z-ADDAPSTM     MGPSTM                          E31211
     C/COPY WNCPYSRC,DL6310C011
     C                     MOVELAAWBA     MGAWBA                          E31211
     C                     MOVELAAWBN     MGAWBN                          E31211
     C/COPY WNCPYSRC,DL6310C012
     C                     MOVELARVNO     MGRVNO                          E31211
     C                     MOVELABENN     MGBENN                          E31211
     C                     MOVELABENA     MGBENA                          088043
     C                     MOVELAOSBR     MGPOBR                          E31211
     C                     ELSE                                           E31211
     C                     MOVELPIBN      MGPIBN                          E31211
     C                     MOVELPIBA      MGPIBA                          056739
     C                     MOVELPONS      MGPONS                          E31211
     C                     Z-ADDPSTM      MGPSTM                          E31211
     C/COPY WNCPYSRC,DL6310C013
     C                     MOVELAWBA      MGAWBA                          E31211
     C                     MOVELAWBN      MGAWBN                          E31211
     C/COPY WNCPYSRC,DL6310C014
     C                     MOVELRVNO      MGRVNO                          E31211
     C                     MOVELBENN      MGBENN                          E31211
     C                     MOVELBENA      MGBENA                          088043
     C                     MOVELPOBR      MGPOBR                          E31211
     C                     END                                            E31211
      *                                                                   E31211
     C           CRCDT     IFEQ 'A'                                       E31211
     C           ARSTM     ANDGT0                                         E31211
     C                     MOVELARIBN     MGRIBN                          E31211
     C                     MOVELARIBA     MGRIBA                          056739
     C                     MOVELARONS     MGRONS                          E31211
     C                     Z-ADDARSTM     MGRSTM                          E31211
     C                     MOVELAOSBR     MGROBR                          E31211
     C                     ELSE                                           E31211
     C                     MOVELRIBN      MGRIBN                          E31211
     C                     MOVELRIBA      MGRIBA                          056739
     C                     MOVELRONS      MGRONS                          E31211
     C                     Z-ADDRSTM      MGRSTM                          E31211
     C                     MOVELROBR      MGROBR                          E31211
     C                     END                                            E31211
      *                                                                   165468
      ** If more than one deam for a deal ensure that the principal       165468
      ** amount takes into account the previous adjustments.              165468
      *                                                                   165468
     C           CRCDT     IFEQ 'A'                                       165468
      *                                                                   165468
      ** Read DEAMS for all amendments for this deal up until this one    165468
      *                                                                   165468
     C                     Z-ADDCVDAT     STVDAT  50                      165468
     C                     Z-ADDCDASN     STDASN  30                      165468
     C                     Z-ADDCDLNO     KDLNO                           165468
     C                     Z-ADD0         CVDAT                           165468
     C                     Z-ADD0         CDASN                           165468
     C           ECONKY    SETLLDEAMS                                     165468
     C                     READ DEAMS                    12               165468
     C           DLNO      DOWEQCDLNO                                     165468
     C           *IN12     ANDEQ'0'                                       165468
     C           RECI      IFEQ 'D'                                       165468
     C           STVDAT    IFGT VDAT                                      165468
     C           STVDAT    OREQ VDAT                                      165468
     C           STDASN    ANDGEDASN                                      165468
      *                                                                   165468
      ** Add/subtract amendment amount to get new amount and stored       165468
      ** current principal                                                165468
      *                                                                   165468
     C           AMTP      IFEQ 'PI'                                      165468
     C           AMTP      OREQ 'CI'                                      165468
     C                     ADD  DAAM      MGPCPL                          165468
     C                     END                                            165468
     C           AMTP      IFEQ 'PD'                                      165468
     C                     SUB  DAAM      MGPCPL                          165468
     C                     END                                            165468
     C                     END                                            165468
     C                     END                                            165468
     C                     READ DEAMS                    12               165468
     C                     ENDDO                                          165468
     C                     ENDIF                                          165468
      *                                                                   165468
      *
     C           MGCHTP    IFEQ *BLANK                                                        CSW025
     C                     MOVE @CHG      MGCHTP                                              CSW025
     C                     ENDIF                                                              CSW025
     C                     WRITEMGF335D0               40
      *
     C           *IN40     IFEQ '1'
     C           *LOCK     IN   LDA
     C                     MOVE '009'     DBASE            * * * * * * * *
     C                     MOVEL@TYP      DBKEY            *  DBERR 009  *
     C                     MOVEL'MGF335PD'DBFILE           * * * * * * * *
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
     C/EJECT
      *****************************************************************
      *   F350 - Format message specific fields for MT350             *
      *   Called by - VALD                                            *
      *   Calls - LORD                                                *
      *****************************************************************
      *
     C           F350      BEGSR
      *
      **  Format fields for MT350
      *
     C           AMTP      IFEQ 'SI'                                                          222546
     C           APSTM     ANDGT0                                                             222546
     C           CDLNO     ANDEQDLNO                                                          256996
     C                     Z-ADDAPSTM     MGPSTM                                              222546
     C                     MOVELAPONS     MGPONS                                              222546
     C                     MOVELAPIBN     MGPIBN                                              222546
     C                     MOVELAPIBA     MGPIBA                                              222546
     C                     ELSE                                                               222546
     C                     Z-ADDPSTM      MGPSTM                                              222546
     C                     MOVELPONS      MGPONS                                              222546
     C                     MOVELPIBN      MGPIBN                                              222546
     C                     MOVELPIBA      MGPIBA                                              222546
     C                     ENDIF                                                              222546
     C                     MOVELPOBR      MGPOBR
     C                     MOVELROBR      MGROBR
     C                     Z-ADDRSTM      MGRSTM
     C**********           Z-ADDPSTM      MGPSTM                                              222546
      *
     C**********           MOVELPIBN      MGPIBN                                              222546
     C**********           MOVELPIBA      MGPIBA                          056739              222546
     C                     MOVELRIBN      MGRIBN
     C                     MOVELRIBA      MGRIBA                          056739
     C**********           MOVELPONS      MGPONS                                              222546
     C                     MOVELRONS      MGRONS
     C/COPY WNCPYSRC,DL6310C015
     C                     MOVELAWBN      MGAWBN
     C                     MOVELAWBA      MGAWBA                          088043
     C/COPY WNCPYSRC,DL6310C016
     C                     MOVELRVNO      MGRVNO
     C                     MOVELBENN      MGBENN
     C                     MOVELBENA      MGBENA                          088043
      *
      *
     C                     Z-ADDPCPL      MGPCPL
     C                     Z-ADD0         MGINTA                          068795
     C           AMTP      IFEQ 'SI'                                                          222546
     C           CDLNO     ANDEQDLNO                                                          256996
     C                     Z-ADDCVDAT     NIDT                                                222546
     C                     Z-ADDINTA      MGINTA                                              222546
     C                     ENDIF                                                              222546
      *                                                                   068795
      ** CHECK IF THERE ARE ANY DEAL AMENDMENTS TODAY IF SO INCREASE      068795
      ** OR DECREASE MGPCPL ACCORDINGLY AND SET MGINTA TO VALUE ON        068795
      ** ECONXCY WHICH IS CORRECT.                                        068795
     C                     Z-ADDCDLNO     KDLNO                           068795
     C                     Z-ADD0         CVDAT                           068795
     C                     Z-ADD0         CDASN                           068795
     C           ECONKY    SETLLDEAMS                                     068795
     C                     READ DEAMS                    12               068795
     C           DLNO      DOWEQCDLNO                                     068795
     C           *IN12     ANDEQ'0'                                       068795
     C           RECI      ANDEQ'D'                                       068795
      *                                                                   068795
      ** IF PI INCREASE PRINCIPAL ELSE DECREASE IF PD                     068795
     C           VDAT      IFLE NIDT                                      068795
     C           AMTP      IFEQ 'PI'                                      068795
     C                     ADD  DAAM      MGPCPL                          068795
     C                     Z-ADDINTA      MGINTA                          068795
     C                     ELSE                                           068795
     C           AMTP      IFEQ 'PD'                                      068795
     C                     SUB  DAAM      MGPCPL                          068795
     C                     Z-ADDINTA      MGINTA                          068795
     C                     ENDIF                                          068795
     C                     ENDIF                                          068795
     C                     ENDIF                                          068795
     C                     READ DEAMS                    12               068795
     C                     ENDDO                                          068795
      *
     C           CSW216    IFEQ 'N'                                                           CSW216
     C           CSW216    OREQ 'Y'                                                           CSW216
     C           INTR      ANDLT0                                                             CSW216
     C                     Z-ADDINTR      MGINTR
     C                     ELSE                                                               CSW216
      *                                                                                       CSW216
      ** Check if negative rate                                                               CSW216
      *                                                                                       CSW216
     C                     TESTB'1'       DSTI           20                                   CSW216
     C           *IN20     IFEQ '1'                                                           CSW216
     C                     Z-SUBINTR      MGINTR                                              CSW216
     C                     ELSE                                                               CSW216
     C                     Z-ADDINTR      MGINTR                                              CSW216
     C                     ENDIF                                                              CSW216
     C                     ENDIF                                                              CSW216
     C                     Z-ADDNIDT      MGNIDT
      *                                                                   067680
      ** FORMAT NEW FIELDS FOR CORRECT INTEREST CALCULATION IN MG0350     067680
     C                     Z-ADDIACD      MGIACD                          067680
     C                     Z-ADDAITC      MGAITC                          067680
     C                     Z-ADDAIAN      MGAIAN                          067680
     C                     Z-ADDAIAP      MGAIAP                          067680
     C                     Z-ADDIPRD      MGIPRD                          067680
     C                     Z-ADDICTD      MGICTD                          067680
     C*                                                                   067680
     C                     MOVELICBS      MGICBS
     C                     MOVELIPFR      MGIPFR
     C                     MOVELSLID      MGSLID
     C                     Z-ADDRTSP      MGNINT
      *
      ** Check for loan or deposit
      *
     C                     EXSR LORD
      *
      ** Move settlement currencies.                                      137909
     C           CEU003    IFEQ 'Y'                                       137909
     C                     EXSR STCY2                                     137909
     C                     ENDIF                                          137909
      *                                                                   137909
     C           MGCHTP    IFEQ *BLANK                                                        CSW025
     C                     MOVE @CHG      MGCHTP                                              CSW025
     C                     ENDIF                                                              CSW025
      *                                                                                       199345
      ** If interest paid sep. move interest details                                          199345
      *                                                                                       199345
     C           IPDS      IFEQ 'Y'                                                           199345
      *                                                                                       199345
     C           MGLORD    IFEQ 'D'                                                           199345
     C                     MOVELINSA      MGPONS                                              199345
     C                     MOVELIMET      MGPSTM                                              199345
     C                     ELSE                                                               199345
     C                     MOVELINSA      MGRONS                                              199345
     C                     MOVELIMET      MGRSTM                                              199345
     C                     ENDIF                                                              199345
      *                                                                                       199345
     C                     MOVELINOS      MGAWBN                                              199345
     C                     MOVE *BLANKS   MGAWBA                                              199345
      *                                                                                       199345
     C           ISCY      IFNE *BLANK                                                        199345
     C                     MOVELISCY      MGSTCY                                              199345
     C                     ENDIF                                                              199345
      *                                                                                       199345
     C           ISCY      IFEQ *BLANK                                                        199345
     C           II72      ANDNE*BLANK                                                        199345
     C           MGAWBN    ANDNE*BLANK                                                        199345
     C                     MOVELII72      MGSTCY                                              199345
     C                     ENDIF                                                              199345
      *                                                                                       199345
     C                     ENDIF                                                              199345
     C/COPY WNCPYSRC,DLH00432
      *                                                                                       199345
     C                     WRITEMGF350D0               40
      *
     C           *IN40     IFEQ '1'
     C           *LOCK     IN   LDA
     C                     MOVE '010'     DBASE            * * * * * * * *
     C                     MOVEL@TYP      DBKEY            *  DBERR 010  *
     C                     MOVEL'MGF350PD'DBFILE           * * * * * * * *
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
     C/EJECT
      *****************************************************************
      *   LORD - If deal is a loan or a deposit set up MGLORD field   *
      *   Called by - F330                                            *
      *             - F324                                            *
      *             - F350                                            *
      *****************************************************************
      *
     C           LORD      BEGSR
      *
      **  Check deal type - loans
      *
     C           DTYP      IFEQ 'TI'
     C           DTYP      OREQ 'IP'
     C           DTYP      OREQ 'CL'
     C           DTYP      OREQ 'FL'                                      CDL006
     C           CDL006    ANDEQ'Y'                                       CDL006
     C           DTYP      OREQ 'DP'                                      CDL006
     C           CDL006    ANDEQ'Y'                                       CDL006
     C           DTYP      OREQ 'LP'                                      CDL006
     C           CDL006    ANDEQ'Y'                                       CDL006
     C                     MOVE 'L'       MGLORD
     C                     END
      *
      **  Check deal type - deposits
      *
     C           DTYP      IFEQ 'TD'
     C           DTYP      OREQ 'IT'
     C           DTYP      OREQ 'CD'
     C           DTYP      OREQ 'CI'
     C           DTYP      OREQ 'FT'                                      CDL006
     C           CDL006    ANDEQ'Y'                                       CDL006
     C           DTYP      OREQ 'DT'                                      CDL006
     C           CDL006    ANDEQ'Y'                                       CDL006
     C           DTYP      OREQ 'LT'                                      CDL006
     C           CDL006    ANDEQ'Y'                                       CDL006
     C                     MOVE 'D'       MGLORD
     C                     END
      *
     C                     ENDSR
      *
      *****************************************************************
     C/EJECT
      *****************************************************************
      *****************************************************************   137909
      *   STCY1- If CEU003 (EMU enhancement) is on set up Payment and *   137909
      *          Receipt settlement currencies.                       *   137909
      *   Called by - F300                                            *   137909
      *****************************************************************   137909
      *                                                                   137909
     C           STCY1     BEGSR                                          137909
      *                                                                   137909
      ** Move settlement currencies for FX deal.                          137909
      *                                                                   137909
      ** Use payment settlement currency if entered. Otherwise use        137909
      ** sell currency.                                                   137909
     C           PSCY      IFNE *BLANKS                                   137909
     C                     MOVE PSCY      MGPYCY                          137909
     C                     ELSE                                           137909
     C                     MOVE SLCY      MGPYCY                          137909
     C                     ENDIF                                          137909
      *                                                                   137909
      ** Use receipt settlement currency if entered. Otherwise use        137909
      ** buy currency.                                                    137909
     C           RSCY      IFNE *BLANKS                                   137909
     C                     MOVE RSCY      MGRCCY                          137909
     C                     ELSE                                           137909
     C                     MOVE PUCY      MGRCCY                          137909
     C                     ENDIF                                          137909
      *                                                                   137909
     C                     ENDSR                                          137909
     C/EJECT                                                              137909
      *****************************************************************   137909
      *****************************************************************   137909
      *   STCY2- If CEU003 (EMU enhancement) is on set up Payment and *   137909
      *          Receipt settlement currencies.                       *   137909
      *   Called by - F324 F330 F350                                  *   137909
      *****************************************************************   137909
      *                                                                   137909
     C           STCY2     BEGSR                                          137909
      *                                                                   137909
      ** Move settlement currency for MM deal.                            137909
      *                                                                   137909
      ** Use settlement currency if entered. Otherwise use deal           137909
      ** currency.                                                        137909
     C           STCY      IFNE *BLANKS                                   137909
     C                     MOVE STCY      MGSTCY                          137909
     C                     ELSE                                           137909
     C                     MOVE CCY       MGSTCY                          137909
     C                     ENDIF                                          137909
      *                                                                   137909
     C                     ENDSR                                          137909
     C/EJECT                                                              137909
      *****************************************************************                     AR784699
      *                                                               *                     AR784699
      *  SRCHKD - Subroutine to check the effectivity date            *                     AR784699
      *                                                               *                     AR784699
      *****************************************************************                     AR784699
     C           SRCHKD    BEGSR                                                            AR784699
      *                                                                                     AR784699
      ** Access the Branch details to get location code                                     AR784699
      *                                                                                     AR784699
     C                     CALL 'AOBRCHR0'                                                  AR784699
     C                     PARM '*MSG    'PRTCD                                             AR784699
     C                     PARM '*KEY    'POPTN                                             AR784699
     C                     PARM DBRCA     PDSNB   3                                         AR784699
     C           SDBRCH    PARM SDBRCH    DSFDY                                             AR784699
      *                                                                                     AR784699
     C           PRTCD     IFNE *BLANKS                                                     AR784699
     C                     ENDIF                                                            AR784699
      *                                                                                     AR784699
      ** Access the Country of Tax using the branch's location code                         AR784699
      *                                                                                     AR784699
     C                     CALL 'AOLOCNR0'                                                  AR784699
     C                     PARM *BLANKS   PRTCD                                             AR784699
     C                     PARM '*KEY   ' POPTN                                             AR784699
     C                     PARM A8LCCD    PLOCN   3                                         AR784699
     C           SDLOCN    PARM SDLOCN    DSFDY                                             AR784699
      *                                                                                     AR784699
     C           PRTCD     IFNE *BLANKS                                                     AR784699
     C                     ENDIF                                                            AR784699
      *                                                                                     AR784699
      ** Retreive the country of residence of the customer                                  AR784699
      *                                                                                     AR784699
     C                     CALL 'AOCUSTR0'                                                  AR784699
     C                     PARM *BLANKS   PRTCD                                             AR784699
     C                     PARM '*KEY   ' POPTN                                             AR784699
     C                     PARM WCNUM     PCNUM  10                                         AR784699
     C                     PARM           PKEYS   7                                         AR784699
     C           SDCUST    PARM SDCUST    DSSDY                                             AR784699
      *                                                                                     AR784699
     C           PRTCD     IFNE *BLANKS                                                     AR784699
     C                     ENDIF                                                            AR784699
      *                                                                                     AR784699
      ** Retrieve effective date                                                            AR784699
      *                                                                                     AR784699
     C                     CALL 'AOCTTXR0'                                                  AR784699
     C                     PARM *BLANKS   PRTCD                                             AR784699
     C                     PARM '*KEY   ' POPTN                                             AR784699
     C                     PARM DVCNCD    PCTRT   2                                         AR784699
     C                     PARM BBCOLC    PCTRR   2                                         AR784699
     C           SDCTTX    PARM SDCTTX    DSFDY                                             AR784699
      *                                                                                     AR784699
      ** If no record is found, access with country of tax only                             AR784699
      *                                                                                     AR784699
     C           PRTCD     IFNE *BLANKS                                                     AR784699
     C                     CALL 'AOCTTXR0'                                                  AR784699
     C                     PARM *BLANKS   PRTCD                                             AR784699
     C                     PARM '*KEY   ' POPTN                                             AR784699
     C                     PARM DVCNCD    PCTRT                                             AR784699
     C                     PARM *BLANKS   PCTRR                                             AR784699
     C           SDCTTX    PARM SDCTTX    DSFDY                                             AR784699
      *                                                                                     AR784699
     C           PRTCD     IFNE *BLANKS                                                     AR784699
     C                     ENDIF                                                            AR784699
     C                     ENDIF                                                            AR784699
      *                                                                                     AR784699
     C           WKMDAT    IFLT EWEDT1                                                      AR784699
     C                     MOVE 'Y'       WSKIP   1                                         AR784699
     C                     ELSE                                                             AR784699
     C                     MOVE 'N'       WSKIP                                             AR784699
     C                     ENDIF                                                            AR784699
      *                                                                                     AR784699
     C                     ENDSR                                                            AR784699
      *****************************************************************                     AR784699
     C/EJECT                                                                                AR784699
      *****************************************************************                     AR784699
      *                                                               *                     AR784699
      *  SRCEUT - Calculate EU Tax Amount                             *                     AR784699
      *                                                               *                     AR784699
      *****************************************************************                     AR784699
     C           SRCEUT    BEGSR                                                            AR784699
      *                                                                                     AR784699
     C                     Z-ADD*ZEROS    WNTAMT 130                                        AR784699
     C                     Z-ADD*ZEROS    PSTXA                                             AR784699
     C                     Z-ADD*ZEROS    PTTXA                                             AR784699
      *                                                                                     AR784699
      ** Call EU Tax Calculation for Private Individual                                     AR784699
      *                                                                                     AR784699
     C                     CALL 'ZATXCLPI'                                                  AR784699
      *                                                                                     AR784699
     C                     PARM 'D'       @@MODI  1                                         AR784699
     C                     PARM WDLNO     @@TRRF 18                                         AR784699
     C                     PARM DBRCA     @@BRCA  3                                         AR784699
     C                     PARM WCNUM     @@CUST  6                                         AR784699
     C                     PARM DVDAT     @@STRD  50                                        AR784699
     C                     PARM WKMDAT    @@ENDD  50                                        AR784699
     C                     PARM TOTI      @@TOTI 150                                        AR784699
     C                     PARM *ZERO     @@TAXR  64                                        AR784699
     C                     PARM CCY       @@OCCY  3                                         AR784699
     C                     PARM TAXI      PINTH   1                                         AR784699
      *                                                                                     AR784699
      ** Output parameters                                                                  AR784699
      *                                                                                     AR784699
     C                     PARM           @@IAED 150                                        AR784699
     C                     PARM           @@TAXA 150                                        AR784699
     C                     PARM           @@TOTO 150                                        AR784699
     C                     PARM           @@TXCY  3                                         AR784699
     C                     PARM           @@CTAX  2                                         AR784699
     C                     PARM           @@TXBS  2                                         AR784699
     C                     PARM           @@WTAC 100                                        AR784699
     C                     PARM           @@COLC  2                                         AR784699
     C                     PARM           @@STAT  5                                         AR784699
     C                     PARM           @@TRTE  1                                         AR784699
     C                     PARM           @@TXR1  64                                        AR784699
     C                     PARM           @@KEY  10                                         AR784699
     C                     PARM           @@FILE 10                                         AR784699
     C                     PARM           @@RTRN  7                                         AR784699
     C           SDTXPA    PARM SDTXPA    DSSDY                                             AR784699
      *                                                                                     AR784699
     C                     SELEC                                                            AR784699
      *                                                                                     AR784699
     C           @@RTRN    WHEQ 'ERROR'                                                     AR784699
     C                     MOVE @@FILE    DBFILE                                            AR784699
     C                     MOVE @@KEY     DBKEY                                             AR784699
     C                     MOVE '1'       *IN15                                             AR784699
     C                     EXSR *PSSR                                                       AR784699
      *                                                                                     AR784699
     C           @@RTRN    WHNE 'JOINT'                                                     AR784699
     C                     Z-ADD@@TAXA    WNTAMT                                            AR784699
      *                                                                                     AR784699
      ** Apply the 2nd and 3rd tax to the tax amount                                        AR784699
      *                                                                                     AR784699
     C           CER048    IFEQ 'Y'                                                         AR784699
     C                     ADD  PSTXA     WNTAMT                                            AR784699
     C                     ENDIF                                                            AR784699
     C           CER054    IFEQ 'Y'                                                         AR784699
     C                     ADD  PTTXA     WNTAMT                                            AR784699
     C                     ENDIF                                                            AR784699
      *                                                                                     AR784699
     C           @@RTRN    WHEQ 'JOINT'                                                     AR784699
     C                     EXSR SRCALJ                                                      AR784699
     C                     ENDSL                                                            AR784699
      *                                                                                     AR784699
      ** Calculate Tax according to the effective date                                      AR784699
      *                                                                                     AR784699
     C           EWTRT1    IFEQ '1'                                                         AR784699
     C           DVDAT     ANDLTEWEDT1                                                      AR784699
     C           WKMDAT    SUB  DVDAT     WINTP   50                                        AR784699
     C           WKMDAT    SUB  EWEDT1    WEFFP   50                                        AR784699
      *                                                                                     AR784699
     C           WNTAMT    MULT WEFFP     WEFAMT 160                                        AR784699
     C           WEFAMT    DIV  WINTP     WNTAMT                                            AR784699
     C                     ENDIF                                                            AR784699
      *                                                                                     AR784699
     C                     ENDSR                                                            AR784699
      *****************************************************************                     AR784699
     C/EJECT                                                                                AR784699
      *****************************************************************                     AR784699
      *                                                               *                     AR784699
      *  SRCJAH - Calculate EU Tax Amount for Joint Account Members   *                     AR784699
      *                                                               *                     AR784699
      *****************************************************************                     AR784699
     C           SRCALJ    BEGSR                                                            AR784699
      *                                                                                     AR784699
     C           WCNUM     SETLLSDJACCLB                                                    AR784699
     C           WCNUM     READESDJACCLB                 21                                 AR784699
      *                                                                                     AR784699
     C                     Z-ADD*ZEROS    WTAXA                                             AR784699
     C                     Z-ADD*ZEROS    PSTXA                                             AR784699
     C                     Z-ADD*ZEROS    PTTXA                                             AR784699
      *                                                                                     AR784699
     C           *IN21     DOWEQ'0'                                                         AR784699
      *                                                                                     AR784699
     C                     EXSR SRCZJA                                                      AR784699
      *                                                                                     AR784699
     C           @@RTRN    IFEQ 'ERROR'                                                     AR784699
     C                     MOVE @@FILE    DBFILE                                            AR784699
     C                     MOVE @@KEY     DBKEY                                             AR784699
     C                     MOVE '1'       *IN15                                             AR784699
     C                     EXSR *PSSR                                                       AR784699
     C                     ENDIF                                                            AR784699
      *                                                                                     AR784699
     C           @@STAT    IFEQ 'TAXAB'                                                     AR784699
     C           @@STAT    OREQ 'DISCL'                                                     AR784699
     C           @@STAT    OREQ 'SELF '                                                     AR784699
     C                     ADD  @@TAXA    WTAXA  150                                        AR784699
      *                                                                                     AR784699
      ** Apply the 2nd and 3rd tax to the tax amount                                        AR784699
      *                                                                                     AR784699
     C           CER048    IFEQ 'Y'                                                         AR784699
     C                     ADD  PSTXA     WTAXA                                             AR784699
     C                     ENDIF                                                            AR784699
     C           CER054    IFEQ 'Y'                                                         AR784699
     C                     ADD  PTTXA     WTAXA                                             AR784699
     C                     ENDIF                                                            AR784699
      *                                                                                     AR784699
     C                     ENDIF                                                            AR784699
      *                                                                                     AR784699
     C           @@RTRN    IFEQ 'NOTAX'                                                     AR784699
     C           @@RTRN    OREQ 'TAXAB'                                                     AR784699
     C           WCNUM     READESDJACCLB                 21                                 AR784699
     C                     ENDIF                                                            AR784699
      *                                                                                     AR784699
     C           @@RTRN    IFEQ 'LAST '                                                     AR784699
     C                     MOVE '1'       *IN21                                             AR784699
     C                     ENDIF                                                            AR784699
      *                                                                                     AR784699
     C                     ENDDO                                                            AR784699
      *                                                                                     AR784699
      ** Accumulate the taxa amount from the account holder and                             AR784699
      ** non-account holder                                                                 AR784699
      *                                                                                     AR784699
     C                     ADD  WTAXA     WNTAMT                                            AR784699
      *                                                                                     AR784699
     C                     ENDSR                                                            AR784699
      *****************************************************************                     AR784699
     C/EJECT                                                                                AR784699
      *****************************************************************                     AR784699
      *                                                               *                     AR784699
      *  SRCZJA - Calls European W/Tax Calculation for Joint Accounts *                     AR784699
      *                                                               *                     AR784699
      *****************************************************************                     AR784699
     C           SRCZJA    BEGSR                                                            AR784699
      *                                                                                     AR784699
     C                     CALL 'ZATXCLJA'                                                  AR784699
     C                     PARM 'D'       @@MODI                                            AR784699
     C                     PARM WDLNO     @@TRRF                                            AR784699
     C                     PARM DBRCA     @@BRCA                                            AR784699
     C                     PARM WCNUM     @@JANO  6                                         AR784699
     C                     PARM JCCUST    @@CUST                                            AR784699
     C                     PARM JCNAHO    @@NARF 10                                         AR784699
     C                     PARM JCINVP    @@INVP 10                                         AR784699
     C                     PARM JCPAHT    PPAHT   1                                         AR784699
     C                     PARM DVDAT     @@STRD                                            AR784699
     C                     PARM WKMDAT    @@ENDD                                            AR784699
     C                     PARM TOTI      @@TOTI                                            AR784699
     C                     PARM *ZERO     @@TAXR                                            AR784699
     C                     PARM CCY       @@OCCY                                            AR784699
     C                     PARM *BLANKS   PINTH                                             AR784699
      *                                                                                     AR784699
      ** Output parameters                                                                  AR784699
      *                                                                                     AR784699
     C                     PARM           @@IAED                                            AR784699
     C                     PARM           @@TAXA                                            AR784699
     C                     PARM           @@TOTO                                            AR784699
     C                     PARM           @@TXCY                                            AR784699
     C                     PARM           @@CTAX                                            AR784699
     C                     PARM           @@TXBS                                            AR784699
     C                     PARM           @@WTAC                                            AR784699
     C                     PARM           @@COLC                                            AR784699
     C                     PARM           @@STAT                                            AR784699
     C                     PARM           @@TRTE                                            AR784699
     C                     PARM           @@TXR1                                            AR784699
     C                     PARM           @@JAMG  1                                         AR784699
     C                     PARM           @@KEY                                             AR784699
     C                     PARM           @@FILE                                            AR784699
     C                     PARM           @@RTRN                                            AR784699
     C           SDTXPA    PARM SDTXPA    DSSDY                                             AR784699
      *                                                                                     AR784699
     C                     ENDSR                                                            AR784699
      *****************************************************************                     AR784699
     C/EJECT                                                                                AR784699
      *****************************************************************   137909
      *                                                               *                       CSW212
      *   SRUCCY - Retrieve Currency                                  *                       CSW212
      *   Called by: SR/F300                                          *                       CSW212
      *                                                               *                       CSW212
      *****************************************************************                       CSW212
     C           SRUCCY    BEGSR                                                              CSW212
      *                                                                                       CSW212
     C                     CALL 'AOCURRR0'                                                    CSW212
     C                     PARM '*MSG   ' @RTCD                                               CSW212
     C                     PARM '*KEY   ' @OPTN                                               CSW212
     C                     PARM           W#CYCD  3                                           CSW212
     C           SDCURR    PARM SDCURR    DSSDY                                               CSW212
      *                                                                                       CSW212
     C                     ENDSR                                                              CSW212
      *****************************************************************                       CSW212
     C/EJECT                                                                                  CSW212
      *****************************************************************                       CSW212
      *                                                               *                       CSW212
      *   SRAGDT - Convert Agreement Date YYMMDD to YYYYMMDD format.  *                       CSW212
      *   CALLED BY: SR/F300                                          *                       CSW212
      *                                                               *                       CSW212
      *****************************************************************                       CSW212
     C           SRAGDT    BEGSR                                                              CSW212
      *                                                                                       CSW212
      ** Extract Year, Month, and Day from ZAGDT                                              CSW212
      *                                                                                       CSW212
     C                     MOVELZAGDT     YY      2                                           CSW212
     C           2         SUBSTZAGDT:3   MM      2                                           CSW212
     C                     MOVE ZAGDT     DD      2                                           CSW212
      *                                                                                       CSW212
      ** Set up input to SR/ZDATE1 (DDMMYY format)                                            CSW212
      *                                                                                       CSW212
     C                     MOVE *BLANKS   DDMMYY                                              CSW212
     C                     MOVELDD        DDMMYY  6                                           CSW212
     C           DDMMYY    CAT  MM:0      DDMMYY                                              CSW212
     C                     MOVE YY        DDMMYY                                              CSW212
      *                                                                                       CSW212
      ** Call SR/ZDATE1 to convert it to day number (ZDAYNO)                                  CSW212
      *                                                                                       CSW212
     C                     MOVE DDMMYY    ZDATE                                               CSW212
     C                     MOVE '0'       *IN98                                               CSW212
     C                     EXSR ZDATE1                                                        CSW212
      *                                                                                       CSW212
      ** Call SR/ZDATE9 to convert ZDAYNO to YYYYMMDD format (@@VDT)                          CSW212
      *                                                                                       CSW212
     C                     Z-ADDZDAYNO    @@DAYN  50                                          CSW212
     C                     EXSR ZDATE9                                                        CSW212
      *                                                                                       CSW212
     C                     ENDSR                                                              CSW212
      *****************************************************************                       CSW212
     C/EJECT                                                                                  CSW212
      *****************************************************************                       CSW212
      *                                                               *                       CSW213
      *   SRREPI - Reporting Information Subroutine                   *                       CSW213
      *                                                               *                       CSW213
      *****************************************************************                       CSW213
      *                                                                                       CSW213
     C           SRREPI    BEGSR                                                              CSW213
      *                                                                                       CSW213
     C                     MOVELDTYP      KCDTYP  2                                           CSW213
     C                     MOVELCDLNO     KCDLNO 16                                           CSW213
     C           RPIFKY    CHAINDLRPIFL1             13                                       CSW213
      *                                                                                       CSW213
     C           *IN13     IFEQ '0'                                                           CSW213
      *                                                                                       CSW213
     C                     MOVE RIAPID    MGAPID                                              CSW213
     C                     MOVE RITRRF    MGTRRF                                              CSW213
     C                     MOVE RILNRF    MGLNRF                                              CSW213
     C                     MOVE RICPID    MGCPID                                              CSW213
     C                     MOVE RIDTYP    MGDTYP                                              CSW213
     C                     MOVE RIDLST    MGDLST                                              CSW213
     C                     MOVE RITRID    MGTRID                                              CSW213
     C                     MOVE RICCPI    MGCCPI                                              CSW213
     C                     MOVE RICCPA    MGCCPA                                              CSW213
     C                     MOVE RICEPI    MGCEPI                                              CSW213
     C                     MOVE RICEPA    MGCEPA                                              CSW213
     C                     MOVE RICBCI    MGCBCI                                              CSW213
     C                     MOVE RICBPI    MGCBPI                                              CSW213
     C                     MOVE RIPRID    MGPRID                                              CSW213
     C                     MOVE RIEXVE    MGEXVE                                              CSW213
     C                     MOVE RIUPID    MGUPID                                              CSW213
      *                                                                                       CSW213
      ** Sort fields of 01                                                                    CSW213
      *                                                                                       CSW213
     C                     MOVE RIRJ01    MGRJ01                                              CSW213
     C                     MOVE RIRP01    MGRP01                                              CSW213
     C                     MOVE RIRN01    MGRN01                                              CSW213
     C                     MOVE RIRC01    MGRC01                                              CSW213
     C                     MOVE RIRS01    MGRS01                                              CSW213
     C                     MOVE RIRL01    MGRL01                                              CSW213
     C                     MOVE RIRA01    MGRA01                                              CSW213
     C                     MOVE RITIT1    MGTI01                                              CSW213
     C                     MOVE RIUT01    MGUT01                                              CSW213
     C                     MOVE RITNI1    MGTN01                                              CSW213
      *                                                                                       CSW213
      ** Sort fields of 02                                                                    CSW213
      *                                                                                       CSW213
     C                     MOVE RIRJ02    MGRJ02                                              CSW213
     C                     MOVE RIRP02    MGRP02                                              CSW213
     C                     MOVE RIRN02    MGRN02                                              CSW213
     C                     MOVE RIRC02    MGRC02                                              CSW213
     C                     MOVE RIRS02    MGRS02                                              CSW213
     C                     MOVE RIRL02    MGRL02                                              CSW213
     C                     MOVE RIRA02    MGRA02                                              CSW213
     C                     MOVE RITIT2    MGTI02                                              CSW213
     C                     MOVE RIUT02    MGUT02                                              CSW213
     C                     MOVE RITNI2    MGTN02                                              CSW213
      *                                                                                       CSW213
      ** Sort fields of 03                                                                    CSW213
      *                                                                                       CSW213
     C                     MOVE RIRJ03    MGRJ03                                              CSW213
     C                     MOVE RIRP03    MGRP03                                              CSW213
     C                     MOVE RIRN03    MGRN03                                              CSW213
     C                     MOVE RIRC03    MGRC03                                              CSW213
     C                     MOVE RIRS03    MGRS03                                              CSW213
     C                     MOVE RIRL03    MGRL03                                              CSW213
     C                     MOVE RIRA03    MGRA03                                              CSW213
     C                     MOVE RITIT3    MGTI03                                              CSW213
     C                     MOVE RIUT03    MGUT03                                              CSW213
     C                     MOVE RITNI3    MGTN03                                              CSW213
      *                                                                                       CSW213
      ** Sort fields of 04                                                                    CSW213
      *                                                                                       CSW213
     C                     MOVE RIRJ04    MGRJ04                                              CSW213
     C                     MOVE RIRP04    MGRP04                                              CSW213
     C                     MOVE RIRN04    MGRN04                                              CSW213
     C                     MOVE RIRC04    MGRC04                                              CSW213
     C                     MOVE RIRS04    MGRS04                                              CSW213
     C                     MOVE RIRL04    MGRL04                                              CSW213
     C                     MOVE RIRA04    MGRA04                                              CSW213
     C**********           MOVE RITIT1    MGTI04                                     CSW213 MD028991
     C                     MOVE RITIT4    MGTI04                                            MD028991
     C                     MOVE RIUT04    MGUT04                                              CSW213
     C                     MOVE RITNI4    MGTN04                                              CSW213
      *                                                                                       CSW213
     C                     MOVE RIETT1    MGET01                                              CSW213
     C                     MOVE RIETT2    MGET02                                              CSW213
     C                     MOVE RIETT3    MGET03                                              CSW213
     C                     MOVE RIETT4    MGET04                                              CSW213
     C                     MOVE RICGTI    MGCGTI                                              CSW213
     C                     MOVE RIALLI    MGALLI                                              CSW213
     C                     MOVE RICLLI    MGCLLI                                              CSW213
     C                     MOVE RINORS    MGNORS                                              CSW213
     C                     Z-ADDRIGEDT    MGGEDT                                              CSW213
     C                     Z-ADDRIGETM    MGGETM                                              CSW213
     C                     MOVE RIUSGN    MGUSGN                                              CSW213
     C                     Z-ADDRIUTCT    MGUTCT                                              CSW213
     C                     MOVE RILSID    MGLSID                                              CSW213
     C                     MOVE RIAR01    MGAR01                                              CSW213
     C                     MOVE RIAR02    MGAR02                                              CSW213
     C                     MOVE RIAR03    MGAR03                                              CSW213
     C                     MOVE RIAR04    MGAR04                                              CSW213
     C                     MOVE RIAR05    MGAR05                                              CSW213
     C                     MOVE RIAR06    MGAR06                                              CSW213
     C                     MOVE RIAR07    MGAR07                                              CSW213
     C                     MOVE RIAR08    MGAR08                                              CSW213
     C                     MOVE RIAR09    MGAR09                                              CSW213
     C                     MOVE RIAR10    MGAR10                                              CSW213
     C                     MOVE RIAR11    MGAR11                                              CSW213
     C                     MOVE RIAR12    MGAR12                                              CSW213
     C                     MOVE RIAR13    MGAR13                                              CSW213
     C                     MOVE RIAR14    MGAR14                                              CSW213
     C                     MOVE RIAR15    MGAR15                                              CSW213
     C                     MOVE RIAR16    MGAR16                                              CSW213
     C                     MOVE RIAR17    MGAR17                                              CSW213
     C                     MOVE RIAR18    MGAR18                                              CSW213
     C                     MOVE RIAR19    MGAR19                                              CSW213
     C                     MOVE RIAR20    MGAR20                                              CSW213
     C                     MOVE RIFOID    MGFOID                                              CSW213
     C                     MOVE RIAFOI    MGAFOI                                              CSW213
     C                     MOVE RICFRQ    MGCFRQ                                              CSW213
     C                     MOVE RICFGN    MGCFGN                                              CSW213
     C                     Z-ADDRICFNR    MGCFNR                                              CSW213
     C                     MOVE RIPRED    MGPRED                                              CSW213
     C                     MOVE RIBCCY    MGBCCY                                              CSW213
     C                     MOVE RIBPMI    MGBPMI                                              CSW213
     C                     MOVE RISCCY    MGSCCY                                              CSW213
     C                     MOVE RISPMI    MGSPMI                                              CSW213
     C                     MOVE RICHTP    MGCHTP                                              CSW213
     C                     Z-ADDRILCD     MGLCD                                               CSW213
     C           MGACMI    IFEQ 'Y'                                                           CSW213
     C                     MOVE RITMST    MGTMST                                              CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
      ** Set the newly-added MG fields                                                        CSW214
      *                                                                                       CSW214
     C           CSW214    IFEQ 'Y'                                                           CSW214
     C                     MOVELRICBRI    MGCBRI                                              CSW214
     C                     MOVELRICBRA    MGCBRA                                              CSW214
     C                     MOVELRIFNCI    MGFNCI                                              CSW214
     C                     MOVELRICOPI    MGCOPI                                              CSW214
     C                     MOVELRICOPC    MGCOPC                                              CSW214
     C                     MOVELRIPOCI    MGPOCI                                              CSW214
     C                     MOVELRICOSI    MGCOSI                                              CSW214
     C                     MOVELRITNEI    MGTNEI                                              CSW214
     C                     MOVELRIIGTI    MGIGTI                                              CSW214
     C                     MOVELRICTFI    MGCTFI                                              CSW214
     C                     ENDIF                                                              CSW214
      *                                                                                       CSW214
     C                     ENDIF                                                              CSW213
      *                                                                                       CSW213
     C                     ENDSR                                                              CSW213
      *****************************************************************                       CSW213
      /EJECT                                                                                  CSW213
      *****************************************************************                       CSW213
      *   *PSSR - error handling                                      *
      *****************************************************************
      *
     C           *PSSR     BEGSR
      *
     C                     OPEN DL6310AU
      *
     C                     SETON                     U7U8LR
      *
     C                     WRITEDL6310D0
     C                     WRITEDL6310D1
     C                     DUMP
     C                     RETRN
      *
     C                     ENDSR
      *
      *****************************************************************
     C/COPY ZSRSRC,ZDATE9Z3                                                                   CSW212
     C/EJECT
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN                                          CSW208
0366073110961461                                                                              CSW208
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR                                            CSW208
000031059090120151181212243273304334365                                                       CSW208
**   ZMNM - MONTHS SHORT NAMES                                                                CSW208
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC                                                          CSW208
**   ZFMD  -  NUMBER OF DAYS IN THE MONTH                                                     CSW208
312831303130313130313031                                                                      CSW208
     X/COPY ZSRSRC,ZDATE9Z4                                                                   CSW212
** TSTAM - Dummy timestamp                                                                    CSW213
0001-01-01-00.00.00.000000                                                                    CSW213
