     H        1   D
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas DL Extract for money at call report')            *
     F*****************************************************************
     F*                                                               *
     F*  Midas - Dealing Module                                   *
     F*                                                               *
     F*  DL7055 - EXTRACT FOR MONEY AT CALL REPORT.                   *
     F*                                                               *
      *  (c) Misys International Banking Systems Ltd. 2001            *
     F*                                                               *
      *  Last Amend No. CDL096             Date 22Sep14               *
      *  Prev Amend No. CDL094             Date 11Jun14               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD031             Date 10Apr06               *
      *                 CDL049             Date 05Jul06               *
      *                 CSD027             Date 09Dec05               *
      *                 CDL038             Date 10May05               *
      *                 CSW037A            Date 02May05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CLE025             Date 20Oct03               *
      *                 CGL029             Date 01Sep03               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.01 -----------------------------------------------*
      *                 CDL006             Date 26Apr99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 096087             Date 17Jan96               *
      *                 060712              Date 15Jul94              *
     F*                 S01390              DATE 26JUN92              *
     F*                 AUE145              DATE 09JUL91              *
     F*                 AUS028              DATE 07/06/88             *
     F*                                                               *
     F*---------------------------------------------------------------*
     F*                                                               *
      *  CDL096 - Business Day Conventions on MM Deals                *
      *           (Recompile)                                         *
      *  CDL094 - Enhance  Receive Settlement Instructions            *
      *           (Recompiled)                                        *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CDL049 - Addition of a Reference Rate field (recompile)      *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CDL038 - Extended Deal Sub Type                              *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  CDL006 - Dealing Fiduciary.                                  *
     F*  096087 - Array index error in ZF2C (RECOMPILE OVER ZF2C)     *
     F*  060712 - Recompiled due to change in copy source ZF2C.       *
     F*  S01390 - Release 10 Changes for Australianisation            *
     F*  AUE145 - MONEY AT CALL LIST DL7060 SHOULD SHOW INTEREST      *
     F*           RATE INSTEAD OF SPREAD. RECOMPILE PRORGAM.          *
     F*  AUS028 - AUSTRALIAN PRODUCT - MONEY AT CALL LISTS            *
     F*                                                               *
     F*****************************************************************
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
     F/SPACE 3
     F* ID F  C  H  L    FUNCTION OF INDICATORS
     F*
     F*      N10      FIRST CYCLE INDICATOR
     F*       20      No details to report                                S01390
     F*       25      EOF FOR DEALA
     F********27******CHAIN*FAIL*FOR*TABLE*FILE***************************S01390
     F********28******CHAIN*FAIL*FOR*CLINT*FILE***************************S01390
     F*       50      VALID DEAL TO APPEAR ON 'MONEY AT CALL' REPORT
     F*
     F/SPACE 3
     F***TABDLEI*IF**E           K        DISK                            S01390
     F*********** TABLETAF                          KIGNORE               S01390
     F*********** TABTB20F                          KIGNORE               S01390
     F*********** TABTB40F                          KIGNORE               S01390
     F*********** TABTE10F                          KIGNORE               S01390
     F*********** TABTE20F                          KIGNORE               S01390
     F*********** TABLETHF                          KIGNORE               S01390
     F*********** TABLETIF                          KIGNORE               S01390
     F*********** TABLETKF                          KIGNORE               S01390
     F*********** TABLETLF                          KIGNORE               S01390
     F*********** TABLETMF                          KIGNORE               S01390
     F*********** TABLETPF                          KIGNORE               S01390
     F*********** TABLETRF                          KIGNORE               S01390
     F*********** TABLETSF                          KIGNORE               S01390
     F*********** TABLETXF                          KIGNORE               S01390
     F*********** TABLET1F                          KIGNORE               S01390
     F*********** TABLET2F                          KIGNORE               S01390
     F*********** TABLET5F                          KIGNORE               S01390
     F***CLINT***IF**E           K        DISK                            S01390
     F*********** CLINTCAF                          KIGNORE               S01390
     F*********** CLINTCCF                          KIGNORE               S01390
     F*********** CLINTC1F                          KIGNORE               S01390
     FDEALA   IP  E           K        DISK
     F*
     FCALLMAA O   E           K        DISK
     F*
     FDL7055AUO   E                    PRINTER                        UC  S01390
     E***********         HCCY1      25  3               HOLIDAY CURENCIESS01390
     E/EJECT                                                              S01390
     E/COPY ZSRSRC,ZHOLE                                                  S01390
     E/SPACE 3                                                            S01390
     E/COPY ZSRSRC,ZF2CE                                                  S01390
     E/SPACE 3                                                            S01390
     E                    CPY@    1   1 80                                S01390
     I***CLINTCBF******                                                   S01390
     I***********   BRCD                            BRCDXX                S01390
     I*                                                                   S01390
     ISDBANK    E DSSDBANKPD                                              S01390
     I* Bank Details Accesses Via Access Program                          S01390
     I*                                                                   S01390
     ISDBRCH    E DSSDBRCHPD                                              S01390
     I* Branch Details Accessed Via Access Program                        S01390
     I*                                                                   S01390
     ISDCUST    E DSSDCUSTPD                                              S01390
     I* Customer Details Accessed Via Access Program                      S01390
     I              QQDFAC                          #DFAC1                                    CGL029
     I*                                                                   S01390
     ISCSARD    E DSSCSARDPD                                              CDL006
      ** External DS for SAR details                                      CDL006
      *                                                                   CDL006
     IDSFDY     E DSDSFDY                                                 S01390
     I* First DS For Access Programs, Short Data Structure                S01390
     I*                                                                   S01390
     IDSSDY     E DSDSSDY                                                 S01390
     I* Second DS For Access Programs, Long Data Structure                S01390
     ILDA         DS                            256                       S01390
     I*                                                                   S01390
     I** Local Data Area To Identify Database Errors                      S01390
     I*                                                                   S01390
     I                                      134 141 DBFILE                S01390
     I                                      142 170 DBKEY                 S01390
     I                                      171 180 DBPGM                 S01390
     I                                      181 1830DBASE                 S01390
     I*                                                                   S01390
     IRUNDAT      DS                                                      S01390
     I                                       13  13 MBIN                  S01390
     I/COPY ZSRSRC,ZHOLI                                                  S01390
     I/SPACE 3                                                            S01390
     I/COPY ZSRSRC,ZF2CI                                                  S01390
     I/EJECT                                                              S01390
     C***********KCLINT    KLIST                           *KEY LIST FOR  S01390
     C***********          KFLD           CNUMK            *  CLINT FILE  S01390
     C***********          KFLD           RCDTK                           S01390
     C***********                                                         S01390
     C***********KTAB      KLIST                           *KEY LIST FOR  S01390
     C***********          KFLD           TABKEY           *  TABLE FILE  S01390
     C*
     C*    LIKE DEFINITIONS
     C*
     C************LIKE     DEFN CNUM      CNUMK                           S01390
     C           *LIKE     DEFN RCDT      RCDTK
     C************LIKE     DEFN KEY       TABKEY                          S01390
     C************LIKE     DEFN DNWD      DNWDK                           S01390
     C           *LIKE     DEFN BJDNWD    DNWDK                           S01390
     C*
     C/EJECT
     C********************************************************************
     C*                                                                  *
     C*                    M A I N L I N E                               *
     C*                                                                  *
     C********************************************************************
     C*
     C  N10                EXSR INIT                        INIT RTN.
     C*
     C*   SET UP OUTPUT FOR VALID RECORDS
     C*
     C                     EXSR PROCES
     C*
     C           *IN50     IFEQ '1'                         *VALID TYPE
     C                     EXSR RCLINT
     C                     WRITECALLMAAR
     C                     END
     C*
     CLR         *IN10     IFEQ '0'                                       S01390
     C*                                                                   S01390
     C** READ BANK DETAILS VIA ACCESS PROGRAM                             S01390
     C*                                                                   S01390
     CLR                   CALL 'AOBANKR0'                                S01390
     CLR                   PARM '*DBERR ' RTCD    7                       S01390
     CLR                   PARM '*FIRST ' OPTN    7                       S01390
     CLR         SDBANK    PARM SDBANK    DSFDY                           S01390
     CLR                   OPEN DL7055AU                                  S01390
     CLR                   WRITEHEADAU                                    S01390
     CLR                   WRITENODETL                                    S01390
     CLR                   END                                            S01390
     C*                                                                   S01390
     CLR         *INU7     IFEQ '1'                                       S01390
     C*                                                                   S01390
     C** READ BANK DETAILS VIA ACCESS PROGRAM                             S01390
     C*                                                                   S01390
     CLR                   CALL 'AOBANKR0'                                S01390
     CLR                   PARM '*DBERR ' RTCD    7                       S01390
     CLR                   PARM '*FIRST ' OPTN    7                       S01390
     CLR         SDBANK    PARM SDBANK    DSFDY                           S01390
     CLR                   OPEN DL7055AU                                  S01390
     CLR                   WRITEHEADAU                                    S01390
     CLR                   WRITEDBERR                                     S01390
     CLR                   END                                            S01390
     C*
     C********************************************************************
     C/EJECT
     C********************************************************************
     C*                                                                  *
     C*                 ---I N I T---                                    *
     C*                                                                  *
     C********************************************************************
     C* DESCRIPTION.                                                     *
     C*           THIS ROUTINE READS THE FILE TABDLEE TO GET THE         *
     C*           WORKING DAY.                                           *
     C********************************************************************
     C           INIT      BEGSR
     C*
     C                     MOVE '1'       *IN10
     C***********          MOVEL'01'      TABKEY                          S01390
     C***********          MOVE '10'      TABKEY                          S01390
     C***********KTAB      CHAINTABTB10F             27                   S01390
     C************IN27     IFEQ '1'                                       S01390
     C***********          Z-ADD0         DNWDK                           S01390
     C***********          GOTO ENDI                                      S01390
     C***********          END                                            S01390
     C*                                                                   S01390
     C** READ BANK DETAILS VIA ACCESS PROGRAM                             S01390
     C*                                                                   S01390
     C                     CALL 'AOBANKR0'                                S01390
     C                     PARM '*DBERR ' RTCD    7                       S01390
     C                     PARM '*FIRST ' OPTN    7                       S01390
     C           SDBANK    PARM SDBANK    DSFDY                           S01390
     C           BJDFIN    IFEQ 'M'                                       S01390
     C                     SETON                     98                   S01390
     C                     END                                            S01390
      *                                                                   CDL006
      ** Check if Dealing Fiduciary is switched ON                        CDL006
      *                                                                   CDL006
     C                     CALL 'AOSARDR0'                                CDL006
     C                     PARM *BLANKS   WRTCD   7                       CDL006
     C                     PARM '*VERIFY' WOPTN   7                       CDL006
     C                     PARM 'CDL006'  WSARD   6                       CDL006
     C           SCSARD    PARM SCSARD    DSFDY                           CDL006
     C           WRTCD     IFEQ *BLANKS                                   CDL006
     C                     MOVE 'Y'       CDL006  1                       CDL006
     C                     ELSE                                           CDL006
     C           WRTCD     IFNE '*NRF   '                                 CDL006
     C                     MOVEL'SCSARDPD'DBFILE           ************   CDL006
     C                     Z-ADD3         DBASE            * DBERR 03 *   CDL006
     C                     MOVEL'CDL006'  DBKEY            ************   CDL006
     C                     EXSR *PSSR                                     CDL006
     C                     ENDIF                                          CDL006
     C                     MOVE 'N'       CDL006                          CDL006
     C                     ENDIF                                          CDL006
     C*                                                                   S01390
     C***********          Z-ADDRUND      ZDAYNO                          S01390
     C***********          MOVE 'AUD'     ZCCY                            S01390
     C                     Z-ADDBJRDNB    ZDAYNO                          S01390
     C                     MOVE BJLCCY    ZCCY1                           S01390
     C                     MOVE 'AUD'     ZCCY2                           S01390
     C                     Z-ADD2         ZNRDYS
     C***********          EXSR ZTXDAY                                    S01390
     C                     EXSR ZF2C                                      S01390
     C                     Z-ADDZDYNBR    DNWDK                           S01093
     C                     MOVEACPY@      BIS@   80                       S01390
     C*                                                                   S01390
     C           *NAMVAR   DEFN           LDA                             S01390
     C           ENDI      ENDSR
     C*                                                                  *
     C********************************************************************
     C/EJECT
     C********************************************************************
     C*                                                                  *
     C*                 ---R C L I N T---                                *
     C*                                                                  *
     C********************************************************************
     C* DESCRIPTION.                                                     *
     C*           THIS ROUTINE READS THE FILE 'CLINT' TO GET THE         *
     C*           CUSTOMER'S REPORT NAME.                                *
     C********************************************************************
     C           RCLINT    BEGSR
     C*
     C***********          MOVE CNUM      CNUMK                           S01390
     C                     MOVE *BLANKS   CNUMK  10                       S01390
     C                     MOVE CNUM      CNUMK  10                       S01390
     C***********          MOVE 'A'       RCDTK                           S01390
     C***********KCLINT    CHAINCLINTCBF             28                   S01390
     C***********                                                         S01390
     C************IN28     IFEQ '1'                                       S01390
     C***********          MOVE *BLANKS   CRNM                            S01390
     C***********          END                                            S01390
     C***********                                                         S01390
     C***********          MOVE CNUMK     CNUM                            S01390
     C*
     C                     CALL 'AOCUSTR0'                                S01390
     C                     PARM *BLANKS   RTCD                            S01390
     C                     PARM '*KEY   ' OPTN                            S01390
     C                     PARM           CNUMK                           S01390
     C                     PARM *BLANKS   KYST    7                       S01390
     C           SDCUST    PARM SDCUST    DSSDY                           S01390
     C*                                                                   S01390
     C           RTCD      IFNE *BLANKS                                   S01390
     C           *LOCK     IN   LDA                                       S01390
     C                     MOVEL'SDCUSTPD'DBFILE                          S01390
     C                     MOVELCNUM      DBKEY                           S01390
     C                     Z-ADD1         DBASE                           S01390
     C                     OUT  LDA                                       S01390
     C                     SETON                     U7U8LR               S01390
     C                     EXSR *PSSR                                     S01390
     C                     ELSE                                           S01390
     C                     MOVE BBCRNM    CRNM                            S01390
     C                     END                                            S01390
     C                     ENDSR
     C*
     C********************************************************************
     C/EJECT
     C********************************************************************
     C*                                                                  *
     C*                 ---P R O C E S---                                *
     C*                                                                  *
     C********************************************************************
     C* DESCRIPTION.                                                     *
     C*           THIS ROUTINE PROCESSES THE DEALS RECORD AND IF         *
     C*           VALID SETS ON INDICATOR 50.                            *
     C********************************************************************
     C           PROCES    BEGSR
     C*
     C                     SETOF                     50
     C*                                                    *IF PCPL=0 DO
     C           PCPL      IFNE 0                          * NOT VALIDATE.
     C*
     C           DTYP      IFEQ 'TD'                       *TERM DEPOSIT
     C           MDAT      IFLE DNWDK
     C                     SETON                     50
     C                     Z-ADD1         TRMI
     C                     MOVE 'D'       DLNI
     C                     END
     C                     END
     C*
     C           DTYP      IFEQ 'IT'                       *INTER-BANK
     C           MDAT      IFLE DNWDK                      *  TAKING
     C                     SETON                     50
     C                     Z-ADD1         TRMI
     C                     MOVE 'D'       DLNI
     C                     END
     C                     END
     C*
     C           DTYP      IFEQ 'TI'                       *TERM
     C           MDAT      IFLE DNWDK                      *  INVESTMENT
     C                     SETON                     50
     C                     Z-ADD1         TRMI
     C                     MOVE 'L'       DLNI
     C                     END
     C                     END
     C*
     C           DTYP      IFEQ 'IP'                       *INTER-BANK
     C           MDAT      IFLE DNWDK                      *  PLACING
     C                     SETON                     50
     C                     Z-ADD1         TRMI
     C                     MOVE 'L'       DLNI
     C                     END
     C                     END
     C*
     C           DTYP      IFEQ 'CD'                       *CALL DEPOSIT
     C           NOTD      IFEQ 0
     C                     SETON                     50
     C                     Z-ADD0         TRMI
     C                     MOVE 'D'       DLNI
     C                     Z-ADD0         MDAT
     C                     ELSE
     C           MDAT      IFGT 0
     C           MDAT      IFLE DNWDK
     C                     SETON                     50
     C                     Z-ADD1         TRMI
     C                     MOVE 'D'       DLNI
     C                     END
     C                     END
     C                     END
     C                     END
     C*
     C           DTYP      IFEQ 'CL'                       *CALL LOAN
     C           NOTD      IFEQ 0
     C                     SETON                     50
     C                     Z-ADD0         TRMI
     C                     MOVE 'L'       DLNI
     C                     Z-ADD0         MDAT
     C                     ELSE
     C           MDAT      IFGT 0
     C           MDAT      IFLE DNWDK
     C                     SETON                     50
     C                     Z-ADD1         TRMI
     C                     MOVE 'L'       DLNI
     C                     END
     C                     END
     C                     END
     C                     END
      *                                                                   CDL006
     C           CDL006    IFEQ 'Y'                                       CDL006
      *                                                                   CDL006
     C           DTYP      IFEQ 'DP'                                      CDL006
     C           DTYP      OREQ 'LP'                                      CDL006
      *                                                                   CDL006
     C           NOTD      IFEQ 0                                         CDL006
     C                     MOVE 'P'       DLNI                            CDL006
     C                     MOVE '1'       *IN50                           CDL006
     C                     Z-ADD0         TRMI                            CDL006
     C                     Z-ADD0         MDAT                            CDL006
     C                     ELSE                                           CDL006
     C           MDAT      IFGT 0                                         CDL006
     C           MDAT      ANDLEDNWDK                                     CDL006
     C                     MOVE 'P'       DLNI                            CDL006
     C                     MOVE '1'       *IN50                           CDL006
     C                     Z-ADD1         TRMI                            CDL006
     C                     ENDIF                                          CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
     C           DTYP      IFEQ 'FL'                                      CDL006
     C           MDAT      ANDLEDNWDK                                     CDL006
     C                     MOVE 'P'       DLNI                            CDL006
     C                     MOVE '1'       *IN50                           CDL006
     C                     Z-ADD1         TRMI                            CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
     C           DTYP      IFEQ 'DT'                                      CDL006
     C           DTYP      OREQ 'LT'                                      CDL006
      *                                                                   CDL006
     C           NOTD      IFEQ 0                                         CDL006
     C                     MOVE 'T'       DLNI                            CDL006
     C                     MOVE '1'       *IN50                           CDL006
     C                     Z-ADD0         TRMI                            CDL006
     C                     Z-ADD0         MDAT                            CDL006
     C                     ELSE                                           CDL006
     C           MDAT      IFGT 0                                         CDL006
     C           MDAT      ANDLEDNWDK                                     CDL006
     C                     MOVE 'T'       DLNI                            CDL006
     C                     MOVE '1'       *IN50                           CDL006
     C                     Z-ADD1         TRMI                            CDL006
     C                     ENDIF                                          CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
     C           DTYP      IFEQ 'FT'                                      CDL006
     C           MDAT      ANDLEDNWDK                                     CDL006
     C                     MOVE 'T'       DLNI                            CDL006
     C                     MOVE '1'       *IN50                           CDL006
     C                     Z-ADD1         TRMI                            CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
     C                     ENDIF                                          CDL006
     C*
     C                     END
     C*                                                                   S01390
     C** Get Branch Information For Output                                S01390
     C*                                                                   S01390
     C**********           CALL 'AOBRCHR0'                                S01390              CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM *BLANKS   RTCD                            S01390
     C                     PARM '*KEY   ' OPTN                            S01390
     C                     PARM BRCA      KYBR    3                       S01390
     C********** SDBRCH    PARM SDBRCH    DSFDY                           S01390              CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C           RTCD      IFNE *BLANKS                                   S01390
     C           *LOCK     IN   LDA                                       S01390
     C                     MOVEL'SDBRCHPD'DBFILE                          S01390
     C                     MOVELBRCA      DBKEY                           S01390
     C                     Z-ADD2         DBASE                           S01390
     C                     OUT  LDA                                       S01390
     C                     SETON                     U7U8LR               S01390
     C                     EXSR *PSSR                                     S01390
     C                     ELSE                                           S01390
     C                     MOVELA8CMCD    CMPYM                           S01390
     C                     END                                            S01390
     C*
     C           EPROC     ENDSR
     C********************************************************************S01390
0904 C***********                                                         S01390
0905 C*****ZTXDAY*SR.*TO*CALCULATE*ANY*NUMBER*OF*DAYS*FORWARD*THAT*ARE****S01390
0906 C****************WORKING*DAYS*IN*BOTH*THE*LOCAL*CURRENCY*AND*ANY*****S01390
0907 C****************SPECIFIED*CURRENCY.*********************************S01390
0908 C***********                                                         S01390
0909 C*********THIS*SR.*CAN*BE*USED*WHEN*THE*INPUT*CYCLE*IS*RUNNING*AS****S01390
0910 C*********HOLIDAY*RECORDS*ARE*ACCESSED*BY*CHAIN.*THEREFORE*NEWLY*****S01390
0911 C*********ADDED*RECORDS*IN*THE*OVERFLOW*AREA*CAN*ALSO*BE*ACCESSED.***S01390
0912 C***********                                                         S01390
0913 C***********ZTXDAY    BEGSR                           *** ZTXDAY *** S01390
0914 C***********                                                         S01390
0915 C*****CALCULATIONS*TO*DEFINE*INPUT*FIELDS.***************************S01390
0916 C***********          Z-ADDZDAYNO    ZDAYNO  50       STARTING DATE  S01390
0917 C***********          MOVE ZCCY      ZCCY    3        DATE CURRENCY  S01390
0918 C***********          Z-ADDZNRDYS    ZNRDYS  20       NBR OF WORKING S01390
0919 C*****LOCY*DEFINED*ON*TABLE,TB-11;**AND*SHOULD*ALREADY*HAVE**********S01390
0920 C*****BEEN*INPUT.****************************************************S01390
0921 C***********                                          DAYS FORWARD   S01390
0922 C*****CLEAR*COUNT*OF*NBR*OF*DAYS*ADDED,*&*DEFINE*ZDYNBR.*************S01390
0923 C***********          Z-ADD0         ZDCNT   20                      S01390
0924 C***********          Z-ADDZDAYNO    ZDYNBR  50                      S01390
     C******SEE*MANUAL*ON*SYSTEM*SUBROUTINES******************************S01390
     C******IF*ZNRDYS*IS*INPUT*AS*ZERO*IT*WILL*NOW*BE*TREATED*AS*ZERO.****S01390
     C******FIRST*CHECK*FOR*ZERO*NOTICE*DAYS******************************S01390
     C***********ZNRDYS    COMP 0                        95               S01390
     C***95******          GOTO ZTXEND                                    S01390
0925 C***********                                                         S01390
0926 C*****LOOP*TO*INCREMENT*DAY*NUMBER*AND*CHECK*FOR*HOLIDAY.************S01390
0927 C***********ZTLOP1    TAG                             ** ZTLOP1 TAG *S01390
0928 C***********                                                         S01390
0929 C***********          SETOF                     9596                 S01390
0930 C***********ZDYNBR    ADD  1         ZDYNBR                          S01390
0931 C***********                                                         S01390
0932 C*****SET*KEY*FOR*FIRST*HOLIDAY*RECORD.******************************S01390
0933 C***********          MOVEL'22    '  ZDHKEY 12                       S01390
0934 C***********          MOVELZDYNBR    ZWRK6   6                       S01390
0935 C***********          MOVE '1'       ZWRK6                           S01390
0936 C***********          MOVE ZWRK6     ZDHKEY                          S01390
0937 C***********                                                         S01390
0938 C*****CHAIN*FOR*HOLIDAY*RECORD,*RECORD*1*OR*2************************S01390
0939 C***********ZTHCHN    TAG                             ** ZTHCHN TAG *S01390
0940 C***********                                                         S01390
0941 C***********ZDHKEY    CHAINTABDLEI              90    ON NOT THERE   S01390
0942 C**N90******RECI      COMP 'D'                  9090  DELETED        S01390
0943 C***********                                                         S01390
0944 C*****NO*RECORD*1*FOUND,*IS*NOT*A*HOLIDAY****************************S01390
0945 C***90N95***          GOTO ZTOAGN                                    S01390
0946 C***********                                                         S01390
0947 C*****NO*RECORD*2*FOUND**********************************************S01390
0948 C***90*95*96          GOTO ZTLOP1                     EXC. NOT FOUND S01390
0949 C***90*95N96          GOTO ZTOAGN                     INC. NOT FOUND S01390
0950 C***********                                                         S01390
0951 C*****DETERMINE*TYPE*FOUND,*INCLUDE*OR*EXCLUDE***********************S01390
0952 C***********INEX      COMP 'E'                  92  91               S01390
0953 C***********                                                         S01390
0954 C*****CHECK*IF*DAY*IS*HOLIDAY*FOR*CURRENCY.**************************S01390
     C***********          MOVEAHCCY      HCCY1                           S01390
0955 C***********ZCCY      LOKUPHCCY1                    93               S01390
0957 C***91*93***          GOTO ZTOAGN                     EXCLUDE FOUND  S01390
0958 C***92*93***          GOTO ZTLOP1                     INCLUDE FOUND  S01390
0959 C***********                                                         S01390
0960 C*****IF*EXCLUDE*OR*INCLUDE*NOT*FOUND*CHECK**************************S01390
0961 C*****FOR*SECOND*HOLIDAY*RECORD,*IF*REQUIRED.************************S01390
0962 C***********'   '     LOKUPHCCY1                    94ON IF NO RCD.2 S01390
0963 C***********          MOVE ZDHKEY    ZWRK1   1                       S01390
0964 C***********ZWRK1     COMP '1'                      95               S01390
0965 C***91*95***          SETON                     96                   S01390
0966 C***95N94***          MOVE '2'       ZDHKEY                          S01390
0967 C***95N94***          GOTO ZTHCHN                     GET SECOND REC S01390
0968 C***********                                                         S01390
0969 C***91******          GOTO ZTLOP1                     EXC. NOT FOUND S01390
0970 C***92******          GOTO ZTOAGN                     INC. NOT FOUND S01390
0971 C***********                                                         S01390
0972 C*****INCREMENT*COUNT*AND*CHECK*IF*REQUIRED*NUMBER*OF*DAYS***********S01390
0973 C*****HAVE*BEEN*ADDED.*IF*NOT,*GO*THROUGH*LOOP1*AGAIN.***************S01390
0974 C***********ZTOAGN    TAG                             ** ZTOAGN TAG *S01390
0975 C***********                                                         S01390
0976 C***********ZDCNT     ADD  1         ZDCNT                           S01390
0977 C***********ZDCNT     COMP ZNRDYS                 97                 S01390
0978 C***97******          GOTO ZTLOP1                                    S01390
0979 C***********                                                         S01390
0863 C***********ZTXEND    ENDSR                                          S01390
0981 C***********                                                         S01390
0982 C***********                                                         S01390
0983 C********************************************************************S01390
     C********************************************************************S01390
     C*                                                                   S01390
     C*  ERROR DUMP SUB-ROUTINE                                           S01390
     C           *PSSR     BEGSR                           *** *PSSR  *** S01390
     C*                                                                   S01390
     C           @RUN      IFEQ *BLANK                                    S01390
     C                     MOVE 'Y'       @RUN    1                       S01390
     C                     DUMP                                           S01390
     C                     OUT  LDA                                       S01390
     C                     END                                            S01390
     C                     ENDSR                           * *PSSR  ENDSR*S01390
     C*                                                                   S01390
     C********************************************************************S01390
     C/EJECT                                                              S01390
     C/COPY ZSRSRC,ZACCH                                                  S01390
     C/EJECT                                                              S01390
     C/COPY ZSRSRC,ZF2C                                                   S01390
** CPY@   **      OBJECT COPYRIGHT                                        S01390
(c) Misys International Banking Systems Ltd. 2001
