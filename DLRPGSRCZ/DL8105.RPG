     H        1                                                           S01390
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas DL Domestic MM brokerage paid - branch')         *
     H***********                                                         S01390
     F*****************************************************************
     F*                                                               *
     F*  Midas - Dealing Module
     F*                                                               *
     F*     DL8105 - DOMESTIC MONEY MARKEY BROKERAGE PAID REPORT.     *
     F*                                                               *
      *  (c) Misys International Banking Systems Ltd. 2001            *
     F*                                                               *
      *  Last Amend No. MD047993           Date 23Sep17               *
      *  Prev Amend No. MD035545           Date 11Sep15               *
      *                 CGL165             Date 17Feb15               *
      *                 CDL096             Date 22Sep14               *
      *                 CDL094             Date 11Jun14               *
      *                 AR996895           Date 25Nov12               *
      *                 263666             Date 01Feb10               *
      *                 CER059             Date 19Jul10               *
      *                 CER016A            Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 246141             Date 26Mar07               *
      *                 164847             Date 30Nov06               *
      *                 BUG12990           Date 05Jan07               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 242286             Date 25Sep06               *
      *                 CSD031             Date 10Apr06               *
      *                 CDL049             Date 05Jul06               *
      *                 CSD027             Date 09Dec05               *
      *                 CDL038             Date 10May05               *
      *                 CIR013             Date 25Apr05               *
      *                 CSW037A            Date 02May05               *
      *                 CDL028             Date 07Feb05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CLE025             Date 20Oct03               *
      *                 CGL029             Date 01Sep03               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.03 -----------------------------------------------*
      *                 CIR004             Date 20Jan00               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 126017             Date 18Nov97               *
      *                 097885             Date 31Jan97               *
     F*                 095244             DATE 01NOV95               *
     F*                 095238             DATE 31OCT95               *
     F*                    066550              DATE 04FEB94           *
     F*                    S01390              DATE 14JUL92           *
     F*                    SA002               DATE 27/02/89          *
     F*                                                               *
     F*---------------------------------------------------------------*
     F*                                                               *
      *  MD047993 - Modified MD035545. Removed dependency on Accrue   *
      *             on Last Day indicator.                            *
      *  MD035545 - LE: Interest Calculation in Leap year. Consider   *
      *             Accrue on Last Day Indicator for method 6.        *
      *  CGL165 - Dual Withholding Tax (Recompile)                    *
      *  CDL096 - Business Day Conventions on MM Deals                *
      *           (Recompile)                                         *
      *  CDL094 - Enhance  Receive Settlement Instructions            *
      *           (Recompiled)                                        *
      *  AR996895 - Incorrect acrrual interest calculation            *
      *             (Child: AR996897) (Recompile)                     *
      *  263666 - Recompiled due to changes in ZINTDYZ2               *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  CER016A - German Interest Calculation: Upgarde of FGE059     *
      *            to Midas Plus (Recompile)                          *
      *  246141 - Recompiled due to changes in ZINTDYZ2               *
      *  164847 - Recompile over changes in /COPY ZINTDYZ2.           *
      *  BUG12990 - Recompiled due to changes in ZINTDYZ2/ZINTDYZ2LE  *
      *  242286 - Recompile over changes in /COPY ZINTDYZ2.           *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CDL049 - Addition of a Reference Rate field (recompile)      *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CDL038 - Extended Deal Sub Type (Recompile)                  *
      *  CIR013 - Additional Calculation Method for FRA/IRS/CCF       *
      *           Recompile over GLINTC and ZINTDY.                   *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CDL028 - Automatic Rate Interpolations (Recompile)           *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  CIR004 - Dealing Calculation Method Change.                  *
      *         - Recompiled due to GLINTC and ZINTDY changes         *
     F*  126017 - Correction to interest calculation for calculation  *
     F*           basis 6 in SR/GLINTC. Add SR/ZDAT10                 *
     F*  097885 - Recompiled for wrong calculation of number of day   *
     F*           interest (ZINTDYZ2).                                *
     F*  095244 - Recompiled for Calculation method 3                 *
     F*  095238 - Recompiled for Calculation method 3                 *
     F*   066550 - GLINTC has had historical problems and inaccuracies*
     F*            and is now externaly descibed and changed to use   *
     F*            ZINTDYZ1. See document atached to error no on GEMS *
     F*     S01390 - Release 10 Changes for Australianisation         *
     F*     SA002  - AUSTRALIAN BROKERAGE                             *
     F*                                                               *
     F*****************************************************************
     F*
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
     F***DL8105P1O***E             18     PRINTER                         S01390
     FDL8105P1O   E             18     PRINTER      KINFDS SPOOL      UC  S01390
     FDL8105AUO   E                    PRINTER      KINFDS SPOOLU         S01390
     F*
     F***CLINT***IF**E           K        DISK                            S01390
     F*********** CLINTCAF                          KIGNORE               S01390
     F*********** CLINTC1F                          KIGNORE               S01390
     F*********** CLINTCCF                          KIGNORE               S01390
     F*********** CLINTSEF                          KIGNORE               S01390
     F***********                                                         S01390
     F***TABDLEE*IF**E           K        DISK                            S01390
     F*********** TABLETAF                          KIGNORE               S01390
     F*********** TABTB20F                          KIGNORE               S01390
     F*********** TABTB40F                          KIGNORE               S01390
     F*********** TABTB70F                          KIGNORE               S01390
     F*********** TABTG10F                          KIGNORE               S01390
     F*********** TABTG20F                          KIGNORE               S01390
     F*********** TABLETHF                          KIGNORE               S01390
     F*********** TABLETIF                          KIGNORE               S01390
     F*********** TABLETKF                          KIGNORE               S01390
     F*********** TABLETLF                          KIGNORE               S01390
     F*********** TABLETMF                          KIGNORE               S01390
     F*********** TABLETPF                          KIGNORE               S01390
     F*********** TABLETSF                          KIGNORE               S01390
     F*********** TABLET2F                          KIGNORE               S01390
     F*********** TABLET5F                          KIGNORE               S01390
     F*
     FDEALALL IF  E           K        DISK
     F            DEALSDAF                          KIGNORE
     F            DEALSDBF                          KIGNORE
     F            DEALSDDF                          KIGNORE
     F            DEALSDEF                          KIGNORE
     F            DEALSDGF                          KIGNORE
     F            DEALSDFF                          KIGNORE
     F*
     FBRKEY5  IF  E           K        DISK
     F*
     F/EJECT
     F********************************************************************
     F* ID F  C  H  L    FUNCTION OF INDICATORS
     F********************************************************************
     F*
     F*       10         AT LEAST 1 RECORD READ TO BE PROCESSED.
     F*       18         OVERFLOW ON THE REPORT
     F*       30         END OF FILE OR DB ERROR TO TERMINATE READ LOOP
     F*       50         WORK INDICATOR.
     F*       89         ERROR OCCURED WHEN FORMATTING OUTPUT FIELD
     F*     90-99        STANDARD SUBROUTINE INDICATORS.
     F*
     F*
     F/EJECT
     E*
     E                    ZYDY    4   4  4 0             ZDATE1/2 SR.ARRAY
     E                    ZMDY   13  13  3 0             ZDATE1/2 SR.ARRAY
     E                    ZMNM   12  12  3               ZDATE2 SR. ARRAY
     E                    ZAR1       20  1               AMOUNT ARRAY 1
     E                    ZAR2       20  1               AMOUNT ARRAY 2
     E                    CPY@    1   1 80                                S01390
     E*
     E/COPY ZSRSRC,ZDATE9Z1                                               066550
     E/EJECT
     IBRKEYDPF
     I              BRKC                            BRKCA
     I*********** DS                                                      S01390
     I***********                             1  12 ZTABKY                S01390
     I***********                             1   2 TABKY1                S01390
     I***********                             9  11 TABKY2                S01390
     I***********                            12  12 TABKY3                S01390
     I***********                            10  12 TABKY4                S01390
     I***********                             9  12 TABKY5                S01390
     I*
     I***LDA********UDS                            256                    S01390
     I***********                           129 133 DBFILE                S01390
     I***********                           134 162 DBKEY                 S01390
     I***********                           163 170 DBPGM                 S01390
     I***********                           171 172 DBASE                 S01390
     ILDA         DS                            256                       S01390
     I                                      134 141 DBFILE                S01390
     I                                      142 170 DBKEY                 S01390
     I                                      171 180 DBPGM                 S01390
     I                                      181 1830DBASE                 S01390
     I*
     ISDBANK    E DSSDBANKPD                                              S01390
     I* Bank Details Accesses Via Access Program                          S01390
     I*                                                                   S01390
     ISDBRCH    E DSSDBRCHPD                                              S01390
     I* Branch Details Accesses Via Access Program                        S01390
     I*                                                                   S01390
     ISDBROK    E DSSDBROKPD                                              S01390
     I* Broker Details Accesses Via Access Program                        S01390
     I*                                                                   S01390
     ISDCUST    E DSSDCUSTPD                                              S01390
     I* Customer Details Accesses Via Access Program                      S01390
     I              QQDFAC                          #DFAC1                                    CGL029
     I*                                                                   S01390
     I***SDGELR*   E DSSDGELRPD                                                    MD035545 MD047993
     I**GENERAL*LEDGER*DETAILS*ACCESSED*VIA*ACCESS*PROGRAM*************            MD035545 MD047993
     I**********    QQACCD                          ACCDQQ                         MD035545 MD047993
     IDSFDY     E DSDSFDY                                                 S01390
     I* First DS For Access Programs, Short Data Structure                S01390
     I*                                                                   S01390
     IDSSDY     E DSDSSDY                                                 S01390
     I* Second DS For Access Programs, Long Data Structure                S01390
     I*                                                                   S01390
     ISPOOL       DS                                                      S01390
     I**    SPOOL FILE INFORMATION DATA STRUCTURE                         S01390
     I                                       83  92 SFILE                 S01390
     I                                    B 123 1240SFNUM                 S01390
     I*                                                                   S01390
     ISPOOLU      DS                                                      S01390
     I**    SPOOL FILE INFORMATION DATA STRUCTURE                         S01390
     I                                       83  92 SFILEU                S01390
     I                                    B 123 1240SFNUMU                S01390
     I*
     IRUNDT       DS                                                      S01390
     I                                       13  13 MBIN                  S01390
     I              'LECalcBasis6LeapYear'C         WPARML                                  MD035545
     I/COPY ZSRSRC,ZINTDYZ1                                               066550
     I/COPY ZSRSRC,ZDATE9Z2                                               066550
     I/COPY ZSRSRC,ZDAT10Z1                                               126017
     I/EJECT
     I/COPY WNCPYSRC,DL8105I001
     C********************************************************************
     C*
     C*    M A I N L I N E.
     C*
     C*    FIRST CYCLE PROCESSING
     C*
     C                     EXSR FIRSTC
     C*
     C*    SET UP LOOP TO READ FILE
     C*
     C                     MOVE OFF       *IN30
     C                     READ BRKEY5                   30
     C           *IN30     DOWEQOFF
     C*                                                                   S01390
     C**   ONLY PROCESS IF BRANCH WAS REQUESTED                           S01390
     C*                                                                   S01390
     C           ENT       IFNE 'ALL'                                     S01390
     C           ENT       ANDNE'   '                                     S01390
     C           ENT       ANDNEBRCA                                      S01390
     C                     SETON                         30               S01390
     C                     ELSE                                           S01390
     C*
     C*    ONLY READ IN PAID KEYS FOR BROKERAGE.
     C*
     C           KEY1      IFEQ 'P'
     C           KEY2      ANDEQ'B'
     C*
     C*    TEST FOR NEW BRANCH.
     C*
     C***********OBRCD     IFNE BRCD                                      S01390
     C           OBRCA     IFNE BRCA                                      S01390
     C                     EXSR NEWBCH
     C                     ELSE
     C*
     C*    TEST FOR NEW BROKER.
     C*
     C           OBRKCA    IFNE BRKCA
     C                     EXSR NEWBRK
     C                     ELSE
     C*
     C*    TEST OVERFLOW.
     C*
     C           *IN18     IFEQ ON
     C                     WRITEP1HEAD
     C                     MOVE OFF       *IN18
     C                     END
     C                     END
     C                     END
     C*
     C*    RETRIEVE AND FORMAT OUTPUT INFORMATION.
     C*
     C                     EXSR STRUCT
     C*
     C*    WRITE OUT DETAIL LINE.
     C*
     C                     WRITEP1DLLN
     C*
     C*    SET ON RECORD READ INDICATOR.
     C*
     C                     MOVE ON        *IN10            1ST REC READ
     C                     END
     C*
     C*    READ NEXT RECORD.
     C*
     C                     READ BRKEY5                   30
     C                     END                                            S01390
     C                     END
     C*
     C*    OUTPUT TOTAL LINE AND TERMINATE PROGRAM.
     C*
     C           *IN10     IFEQ ON
     C*
     C*    ADD PREVIOUS BROKER TOTAL TO GRAND TOTAL.
     C*
     C                     ADD  BBPTM     TBPTM
     C*
     C*    FORMAT BROKER TOTAL AMOUNTS.
     C*
     C                     MOVE BBPTM     ZNUMIN
     C                     EXSR FORMAT
     C                     MOVE ZNUMOT    BBPTMA
     C*
     C*    WRITE OUT BROKER TOTAL LINE.
     C*
     C                     WRITEP1BKTL
     C*
     C*    FORMAT TOTAL AMOUNTS.
     C*
     C                     MOVE TBPTM     ZNUMIN
     C                     EXSR FORMAT
     C                     MOVE ZNUMOT    TBPTMA
     C*
     C                     WRITEP1GTOT
     C                     ELSE
     C*
     C***********          WRITEP1HEAD
     C***********          WRITEP1NDTR
     C                     WRITEAUHEAD
     C                     WRITEAUNDTR
     C*                                                                   S01390
     C** Report printer file to RCF via ZSFILE                            S01390
     C*                                                                   S01390
     C                     Z-ADDSFNUMU    ZSNUM   60                      S01390
     C                     CALL 'ZSFILE'                                  S01390
     C                     PARM           SEQ                             S01390
     C                     PARM *BLANKS   @ENT    3                       S01390
     C                     PARM           SFILEU                          S01390
     C                     PARM           ZSNUM                           S01390
     C                     PARM *BLANKS   ZSERR   1                       S01390
     C*                                                                   S01390
     C** Error during ZSFILE processing, return to calling program        S01390
     C*                                                                   S01390
     C           ZSERR     IFEQ 'Y'                                       S01390
     C                     SETON                     U7U8LR               S01390
     C                     END                                            S01390
     C                     END
     C*
     C*    OUTPUT DATABASE IN ERROR MESSAGE
     C*
     C           *INU8     IFEQ ON
     C***********          WRITEP1ERR
     C                     WRITEAUHEAD
     C                     WRITEAUERR
     C*                                                                   S01390
     C** Report printer file to RCF via ZSFILE                            S01390
     C*                                                                   S01390
     C                     Z-ADDSFNUMU    ZSNUM                           S01390
     C                     CALL 'ZSFILE'                                  S01390
     C                     PARM           SEQ                             S01390
     C                     PARM *BLANKS   @ENT                            S01390
     C                     PARM           SFILEU                          S01390
     C                     PARM           ZSNUM                           S01390
     C                     PARM *BLANKS   ZSERR                           S01390
     C*                                                                   S01390
     C** Error during ZSFILE processing, return to calling program        S01390
     C*                                                                   S01390
     C           ZSERR     IFEQ 'Y'                                       S01390
     C                     SETON                     U7U8LR               S01390
     C                     END                                            S01390
     C                     END
     C*
     C           *IN10     IFEQ '1'                                       S01390
     C                     WRITEP1END
     C                     END                                            S01390
     C                     MOVE ON        *INLR
     C*
     C/EJECT
     C********************************************************************
     C*
     C*      FIRST IS A SUBROUTINE TO PERFORM ALL FIRST CYCLE
     C*      CALCULATIONS.
     C*
     C           FIRSTC    BEGSR                           *** FIRSTC ***
     C           *ENTRY    PLIST                                          S01390
     C                     PARM           SEQ     5                       S01390
     C                     PARM           ENT     3                       S01390
     C                     MOVEACPY@      BIS@   80                       S01390
     C/COPY WNCPYSRC,DL8105C001
     C           *NAMVAR   DEFN           LDA                             S01390
     C           *NAMVAR   DEFN RUNDAT    RUNDT                           S01390
     C                     IN   RUNDT                                     S01390
     C           MBIN      IFEQ 'Y'                                       S01390
     C                     MOVE '1'       *IN88                           S01390
     C                     END                                            S01390
     C*
     C*    INITILIZE STANDARD VARIABLES & FIRST CYCLE AMOUNT
     C*
     C           *LOCK     IN   LDA                                       S01390
     C                     MOVEL'DL8105'  DBPGM
     C                     OUT  LDA                                       S01390
     C                     MOVE '1'       ON      1
     C                     MOVE '0'       OFF     1
     C***********                                                         S01390
     C*****KEY*LIST*FOR*CLINT*FILE.***************************************S01390
     C***********                                                         S01390
     C***********CLTKY     KLIST                                          S01390
     C***********          KFLD           CLKY01  60       CUST           S01390
     C***********          KFLD           CLKY02  1        REC TYPE       S01390
     C*
     C*    INITILIZE LEVEL BREAK FIELDS.
     C*
     C           *LIKE     DEFN BRCA      OBRCA                           S01390
     C***********          Z-ADD0         OBRCD   30                      S01390
     C                     MOVE *BLANKS   OBRCA                           S01390
     C                     MOVE *BLANKS   OBRKCA  4
     C*
     C*****ICD.*1*********************************************************S01390
     C** READ BANK DETAILS VIA ACCESS PROGRAM                             S01390
     C*
     C***********          EXSR ZSYSTM                                    S01390
     C************IN99     IFEQ ON                                        S01390
     C***********          MOVEL'TABLE'   DBFILE                          S01390
     C***********          MOVELZTABKY    DBKEY                           S01390
     C***********          MOVE '01'      DBASE                           S01390
     C***********          MOVE ON        *INLR                           S01390
     C***********          MOVE ON        *INU8                           S01390
     C***********          MOVE ON        *IN30                           S01390
     C***********          END                                            S01390
     C                     CALL 'AOBANKR0'                                S01390
     C                     PARM '*DBERR ' RTCD    7                       S01390
     C                     PARM '*FIRST ' OPTN    7                       S01390
     C           SDBANK    PARM SDBANK    DSFDY                           S01390
     C           BJDFIN    IFEQ 'M'                                       S01390
     C                     SETON                     98                   S01390
     C                     END                                            S01390
     C***********                                                         S01390
     C*****ICD.*2*********************************************************S01390
     C***********                                                         S01390
     C***********          MOVE '11'      ZTABKY                          S01390
     C***********ZTABKY    CHAINTABDLEE              99                   S01390
     C************IN99     IFEQ OFF                                       S01390
     C***********RECI      ANDNE'D'                                       S01390
     C***********          MOVE ON        *IN99                           S01390
     C***********          END                                            S01390
     C************IN99     IFEQ ON                                        S01390
     C***********          MOVEL'TABLE'   DBFILE                          S01390
     C***********          MOVELZTABKY    DBKEY                           S01390
     C***********          MOVE '02'      DBASE                           S01390
     C***********          MOVE ON        *INLR                           S01390
     C***********          MOVE ON        *INU8                           S01390
     C***********          MOVE ON        *IN30                           S01390
     C***********          END                                            S01390
     C*
     C*    INITILIZE PARAMETERS FOR FORMAT SUBROUTINE.
     C*
     C                     Z-ADD17        ZCHRO
     C                     MOVE ' '       ZSIGNT
     C                     MOVE ' '       ZSIGN
     C                     MOVE 'Y'       ZCOMA
     C                     Z-ADD2         ZDEC
      *****************************************************************            MD035545 MD047993
      ***Call*access*program*for*General*Ledger*details.***************            MD035545 MD047993
      *****************************************************************            MD035545 MD047993
     C**********           CALL 'AOGELRR1'                                         MD035545 MD047993
     C**********           PARM '*MSG   ' @RTCD   7                                MD035545 MD047993
     C**********           PARM '*FIRST ' @OPTN   7                                MD035545 MD047993
     C********** SDGELR    PARM SDGELR    DSSDY                                    MD035545 MD047993
      *                                                                                     MD035545
     C********** @RTCD     IFNE *BLANK                                             MD035545 MD047993
     C**********           MOVEL'SDGELRPD'DBFILE                                   MD035545 MD047993
     C**********           MOVEL'062'     DBASE                                    MD035545 MD047993
     C**********           MOVEL@OPTN     DBKEY                                    MD035545 MD047993
     C**********           EXSR *PSSR                                              MD035545 MD047993
     C**********           ENDIF                                                   MD035545 MD047993
      *                                                                                     MD035545
      ** Retrieve system value setting                                                      MD035545
      *                                                                                     MD035545
     C                     MOVELWPARML    P@OP01                                            MD035545
     C                     CALL 'AOSVALR0'                                                  MD035545
     C                     PARM *BLANKS   W0RTCD  7                                         MD035545
     C                     PARM           P@OP01 20                                         MD035545
     C                     PARM           P@VL01200                                         MD035545
     C                     PARM           P@OP02 20                                         MD035545
     C                     PARM           P@VL02200                                         MD035545
     C                     PARM           P@OP03 20                                         MD035545
     C                     PARM           P@VL03200                                         MD035545
     C                     PARM           P@OP04 20                                         MD035545
     C                     PARM           P@VL04200                                         MD035545
     C                     PARM           P@OP05 20                                         MD035545
     C                     PARM           P@VL05200                                         MD035545
     C                     PARM           P@OP06 20                                         MD035545
     C                     PARM           P@VL06200                                         MD035545
     C                     PARM           P@OP07 20                                         MD035545
     C                     PARM           P@VL07200                                         MD035545
     C                     PARM           P@OP08 20                                         MD035545
     C                     PARM           P@VL08200                                         MD035545
     C                     PARM           P@OP09 20                                         MD035545
     C                     PARM           P@VL09200                                         MD035545
     C                     PARM           P@OP10 20                                         MD035545
     C                     PARM           P@VL10200                                         MD035545
      *                                                                                     MD035545
      ** If system value is not found then default value to 'N'                             MD035545
      *                                                                                     MD035545
     C           W0RTCD    IFNE '       '                                                   MD035545
     C                     MOVE 'N'       WCALC6                                            MD035545
     C                     ELSE                                                             MD035545
     C                     MOVELP@VL01    WCALC6                                            MD035545
     C********** WCALC6    IFEQ 'Y'                                                MD035545 MD047993
     C********** BKALDI    ANDEQ'Y'                                                MD035545 MD047993
     C**********           MOVE 'Y'       WCALC6                                   MD035545 MD047993
     C**********           ELSE                                                    MD035545 MD047993
     C**********           MOVE 'N'       WCALC6                                   MD035545 MD047993
     C**********           ENDIF                                                   MD035545 MD047993
     C                     ENDIF                                                            MD035545
     C*
     C           ENDFC     ENDSR                           *** ENDFC  ***
     C*
     C/EJECT
     C********************************************************************
     C*
     C*      CHANGE OF BRANCH.
     C*
     C           NEWBCH    BEGSR                           *** NEWBCH ***
     C*
     C*    CHAIN TO BRANCH INFORMATION.
     C*
     C***********          MOVE *BLANKS   ZTABKY                          S01390
     C***********          MOVE '10'      TABKY1                          S01390
     C***********          MOVE BRCD      TABKY4                          S01390
     C***********ZTABKY    CHAINTABDLEE              99                   S01390
     C**********           CALL 'AOBRCHR0'                                S01390              CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM *BLANKS   RTCD                            S01390
     C                     PARM '*KEY   ' OPTN                            S01390
     C                     PARM BRCA      KYBR    3                       S01390
     C********** SDBRCH    PARM SDBRCH    DSFDY                           S01390              CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C************IN99     IFEQ ON                                        S01390
     C***********RECI      ORNE 'D'                                       S01390
     C***********          MOVEL'TABLE'   DBFILE                          S01390
     C***********          MOVELZTABKY    DBKEY                           S01390
     C***********          MOVE '06'      DBASE                           S01390
     C           RTCD      IFNE *BLANKS                                   S01390
     C           *LOCK     IN   LDA                                       S01390
     C                     MOVEL'SDBRCHPD'DBFILE                          S01390
     C                     MOVELBRCA      DBKEY                           S01390
     C                     Z-ADD5         DBASE                           S01390
     C                     OUT  LDA                                       S01390
     C                     MOVE ON        *INLR
     C                     MOVE ON        *INU8
     C                     MOVE ON        *IN30
     C                     END
     C***********          Z-ADDBRCD      OBRCD                           S01390
     C                     MOVE BRCA      OBRCA                           S01390
     C                     MOVE 'Y'       BRCHNW  1                       S01390
     C*
     C*    GET NEW BROKER DETAILS AS WELL.
     C*
     C                     EXSR NEWBRK
     C*
     C                     ENDSR
     C*
     C/EJECT
     C********************************************************************
     C*
     C*      NEWBRK SR  RETRIEVE BROKER INFORMATION.
     C*
     C           NEWBRK    BEGSR                           *** NEWBRK ***
     C*
     C           *IN10     IFEQ ON
     C*
     C*    ADD PREVIOUS BROKER TOTAL TO GRAND TOTAL.
     C*
     C                     ADD  BBPTM     TBPTM  130
     C*
     C*    FORMAT BROKER TOTAL AMOUNTS.
     C*
     C                     MOVE BBPTM     ZNUMIN
     C                     EXSR FORMAT
     C                     MOVE ZNUMOT    BBPTMA
     C*
     C*    WRITE OUT BROKER TOTAL LINE.
     C*
     C                     WRITEP1BKTL
     C                     END
     C*                                                                   S01390
     C           BRCHNW    IFEQ 'Y'                                       S01390
     C*                                                                   S01390
     C*    FORMAT TOTAL AMOUNTS.                                          S01390
     C*                                                                   S01390
     C           *IN10     IFEQ '1'                                       S01390
     C                     MOVE TBPTM     ZNUMIN                          S01390
     C                     EXSR FORMAT                                    S01390
     C                     MOVE ZNUMOT    TBPTMA                          S01390
     C*                                                                   S01390
     C                     WRITEP1GTOT                                    S01390
     C                     WRITEP1END                                     S01390
     C                     CLOSEDL8105P1                                  S01390
     C                     END                                            S01390
     C                     OPEN DL8105P1                                  S01390
     C                     MOVE *BLANKS   BRCHNW                          S01390
     C*                                                                   S01390
     C*    RESET BRANCH TOTALS.                                           S01390
     C*                                                                   S01390
     C                     Z-ADD0         TBPTM                           S01390
     C*                                                                   S01390
     C** Report printer file to RCF via ZSFILE                            S01390
     C*                                                                   S01390
     C                     Z-ADDSFNUM     ZSNUM                           S01390
     C                     CALL 'ZSFILE'                                  S01390
     C                     PARM           SEQ                             S01390
     C                     PARM BRCA      @ENT                            S01390
     C                     PARM           SFILE                           S01390
     C                     PARM           ZSNUM                           S01390
     C                     PARM *BLANKS   ZSERR                           S01390
     C*                                                                   S01390
     C** Error during ZSFILE processing, return to calling program        S01390
     C*                                                                   S01390
     C           ZSERR     IFEQ 'Y'                                       S01390
     C                     SETON                     U7U8LR               S01390
     C                     END                                            S01390
     C                     END                                            S01390
     C*
     C*    RESET BROKER TOTALS.
     C*
     C                     Z-ADD0         BBPTM  130
     C*
     C*****CHAIN*TO*BRANCH*INFORMATION.***********************************S01390
     C*    CHAIN TO BROKER INFORMATION.                                   S01390
     C*
     C***********          MOVE *BLANKS   ZTABKY                          S01390
     C***********          MOVE '80'      TABKY1                          S01390
     C***********          MOVE BRKCA     TABKY5                          S01390
     C***********ZTABKY    CHAINTABDLEE              99                   S01390
     C                     CALL 'AOBROKR0'                                S01390
     C                     PARM *BLANKS   RTCD                            S01390
     C                     PARM '*KEY   ' OPTN                            S01390
     C                     PARM BRKC      KYBK    4                       S01390
     C           SDBROK    PARM SDBROK    DSFDY                           S01390
     C************IN99     IFEQ ON                                        S01390
     C***********RECI      ORNE 'D'                                       S01390
     C***********          MOVEL'TABLE'   DBFILE                          S01390
     C***********          MOVELZTABKY    DBKEY                           S01390
     C***********          MOVE '07'      DBASE                           S01390
     C           RTCD      IFNE *BLANKS                                   S01390
     C           *LOCK     IN   LDA                                       S01390
     C                     MOVEL'SDBROKPD'DBFILE                          S01390
     C                     MOVELBRKC      DBKEY                           S01390
     C                     Z-ADD7         DBASE                           S01390
     C                     OUT  LDA                                       S01390
     C                     MOVE ON        *INLR
     C                     MOVE ON        *INU8
     C                     MOVE ON        *IN30
     C                     END
     C                     MOVE BRKCA     OBRKCA
     C*
     C*    OUTPUT HEADINGS FOR NEXT BRANCH/BROKER COMBINATION.
     C*
     C                     WRITEP1HEAD
     C                     MOVE OFF       *IN18
     C*
     C                     ENDSR
     C*
     C/EJECT
     C********************************************************************
     C*
     C*      STRUCT SR  FORMAT AND STRUCTURE OUTPUT INFORMATION.
     C*
     C           STRUCT    BEGSR                           *** SCRUCT ***
     C*
     C*    CHAIN TO DEALS FILE TO GET DEAL INFORMATION.
     C*
     C           DLNO      CHAINDEALALL              99
     C           *IN99     IFEQ ON
     C           *LOCK     IN   LDA                                       S01390
     C                     MOVEL'DEALS'   DBFILE
     C                     MOVELDLNO      DBKEY
     C***********          MOVE '03'      DBASE                           S01390
     C                     Z-ADD3         DBASE                           S01390
     C                     OUT  LDA                                       S01390
     C                     MOVE ON        *INLR
     C                     MOVE ON        *INU8
     C                     MOVE ON        *IN30
     C                     END
     C*
     C*****CHAIN*TO*CUSTOMER*REC.*TYPE*'A'.*******************************S01390
     C*    ACCESS CUSTOMER DETAILS                                        S01390
     C*
     C***********          Z-ADDCNUM      CLKY01                          S01390
     C***********          MOVE 'A'       CLKY02                          S01390
     C***********          MOVELCNUM      CLTKEY  7                       S01390
     C***********          MOVE 'A'       CLTKEY                          S01390
     C***********CLTKY     CHAINCLINT                99                   S01390
     C                     MOVE CNUM      KYCNUM 10                       S01390
     C                     CALL 'AOCUSTR0'                                S01390
     C                     PARM *BLANKS   RTCD                            S01390
     C                     PARM '*KEY   ' OPTN                            S01390
     C                     PARM           KYCNUM                          S01390
     C                     PARM *BLANKS   KYST    7                       S01390
     C           SDCUST    PARM SDCUST    DSSDY                           S01390
     C************IN99     IFEQ ON                                        S01390
     C***********RECI      ORNE 'D'                                       S01390
     C***********          MOVEL'CLINT'   DBFILE                          S01390
     C***********          MOVELCLTKEY    DBKEY                           S01390
     C***********          MOVE '04'      DBASE                           S01390
     C           RTCD      IFNE *BLANKS                                   S01390
     C           *LOCK     IN   LDA                                       S01390
     C                     MOVEL'SDCUSTPD'DBFILE                          S01390
     C                     MOVELCNUM      DBKEY                           S01390
     C                     Z-ADD4         DBASE                           S01390
     C                     OUT  LDA                                       S01390
     C                     MOVE ON        *INLR
     C                     MOVE ON        *INU8
     C                     MOVE ON        *IN30
     C                     END
     C*
     C*    FORMAT DEAL DATE FOR OUTPUT.
     C*
     C                     Z-ADDDDAT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    DDATE
     C*
     C*    FORMAT VALUE DATE FOR OUTPUT.
     C*
     C                     Z-ADDVDAT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    VDATE
     C*
     C*    FORMAT MATURITY DATE FOR OUTPUT.
     C*
     C           MDAT      IFEQ 0
     C                     MOVE *BLANKS   MDATE
     C                     ELSE
     C                     Z-ADDMDAT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    MDATE
     C                     END
     C*
     C*    FORMAL PRINCIPLE AMOUNT
     C*
     C                     MOVE PCPL      ZNUMIN
     C                     EXSR FORMAT
     C                     MOVE ZNUMOT    PCPLA
     C*
     C*    FORMAL BROKERAGE PAID AMOUNT
     C*
     C                     MOVE EAMT      ZNUMIN
     C                     EXSR FORMAT
     C                     MOVE ZNUMOT    BPTMA
     C*
     C*    ADD BROKERAGE PAID TO TOTAL.
     C*
     C                     ADD  EAMT      BBPTM
     C*
     C                     ENDSR
     C*
     C/EJECT
     C********************************************************************
     C*
     C*    FORMAT SR. FORMAT FIELDS FOR OUTPUT.
     C*
     C*  PARAMETERS IN;
     C*              ZNUMIN : ALPHA FIELD CONTAINING THE NUMBER TO BE
     C*                       CONVERTED. THE NUMBER IS RIGHT JUSTIFIED.
     C*              ZDEC   : NUMBER OF DECIMAL PLACES
     C*              ZSIGNT : THE SIGN REQUIRED
     C*                        (ASSUME SIGN BLANK)
     C*              ZSIGN  : WHETHER A SIGN SHOULD APPEAR
     C*                        'A' = SIGN APPEARS AFTER THE NUMBER
     C*                        'B' = SIGN APPEARS BEFORE THE NUMBER
     C*                        ' ' = NO SIGN TO APPEAR.
     C*                        (ASSUME SIGN IS NOT REQUIRED)
     C*              ZCOMA  : WHETHER COMMA'S SHOULD APPEAR
     C*                        (ASSUME COMMA'S ARE REQUIRED)
     C*              ZCHRO  : MAXIMUM NUMBER OF OUTPUT CHARACTERS
     C*                        (ASSUME 13 IE. 10 NUMBERS
     C*                          WITH COMMA'S AND DECIMAL POINT)
     C* * * * * * * * * * *  W A R N I N G  * * * * * * * * * * *
     C*        ZSIGN, ZSIGNT, ZCOMA AND ZCHRO SHOULD BE INILILIZED
     C*        WITH DEFAULT VALUES IN THE FIRST CYCLE SUBROUTINE.
     C*
     C*  PARAMETERS OUT;
     C*              ZNUMOT : ARRAY CONTAINING FORMATTED NUMBER
     C*                        THE NUMBER IS RIGHT JUSTIFIED.
     C*              *IN89  : ERROR INDICATOR.
     C*
     C*  VARIABLES USED;
     C*              U      : WORK.
     C*              V      : USED TO CALCULATE IF A COMMA IS REQUIRED.
     C*              W      : STARTING POSITION OF THE NUMBER IN ZAR1.
     C*              X      : CURRENT ELEMENT IN ZAR1 BEING PROCESSED.
     C*              Y      : NEXT ELEMENT AVAILABLE IN ZAR2.
     C*              ZAR1   : ARRAY CONTAINING THE NUMBER TO BE
     C*                        FORMATTED. RIGHT JUSTIFIED.
     C*              ZAR2   : ARRAY CONTAINING THE FORMATTED NUMBER.
     C*                        RIGHT JUSTIFIED.
     C*
     C*
     C           FORMAT    BEGSR                           *** FORMAT ***
     C*
     C*    MOVE THE NUMBER COMING IN TO ARRAY 1.
     C*
     C                     MOVEA*BLANKS   ZAR1
     C                     MOVEA*BLANKS   ZAR2
     C                     MOVE *BLANKS   ZNUMOT 20
     C                     Z-ADDZDEC      ZDEC    10
     C                     MOVE OFF       *IN89
     C*
     C*    MOVE THE NUMBER COMING IN TO ARRAY 1.
     C*
     C                     MOVEAZNUMIN    ZAR1
     C*
     C*    FIND FIRST NUMBER IN INTEREST AMOUNT.
     C*
     C                     Z-ADD0         W       20
     C           20        SUB  ZDEC      U       20
     C                     MOVE OFF       *IN50
     C           *IN50     DOUEQON
     C                     ADD  1         W
     C*
     C*        FOUND FIRST NON '0' OR ' ' CHARACTER.
     C*
     C           ZAR1,W    IFNE ' '
     C           ZAR1,W    ANDNE'0'
     C                     MOVE ON        *IN50
     C                     END
     C*
     C*        IF NO CHARACTERS FOUND THEN SET W TO DECIMAL
     C*            PLACES + 1.
     C*
     C           W         IFEQ U
     C                     MOVE ON        *IN50
     C                     END
     C                     END
     C*
     C*    MOVE SIGN INTO OUTPUT FIELD. (APPEARS AFTER THE NUMBER)
     C*
     C                     Z-ADD20        X       20
     C                     Z-ADD20        Y       20
     C           ZSIGN     IFEQ 'A'
     C                     MOVE ZSIGNT    ZAR2,Y
     C                     SUB  1         Y
     C                     END
     C*
     C*    PROCESS NUMBER.
     C*
     C*    DECIMAL PORTION, (IF REQUIRED).
     C*
     C           ZDEC      IFGT 0
     C                     DO   ZDEC                       LOOP
     C                     MOVE ZAR1,X    ZAR2,Y
     C                     SUB  1         X
     C                     SUB  1         Y
     C                     END
     C                     MOVE '.'       ZAR2,Y
     C                     SUB  1         Y
     C                     END
     C                     Z-ADD0         V
     C*
     C*    PROCESS REST OF NUMBER.
     C*
     C                     MOVE OFF       *IN50
     C           *IN50     DOUEQON                         LOOP
     C*
     C*    COMMA'S.
     C*
     C           Y         IFGT 0
     C           ZCOMA     IFEQ 'Y'
     C           V         ANDGE3
     C                     MOVE ','       ZAR2,Y
     C                     SUB  1         Y
     C                     Z-ADD0         V       20
     C                     END
     C                     END
     C*
     C*    MOVE NUMERICS.
     C*
     C           Y         IFGT 0
     C                     MOVE ZAR1,X    ZAR2,Y
     C                     SUB  1         X
     C                     SUB  1         Y
     C                     ADD  1         V
     C                     END
     C*
     C           X         IFLT W                          PROCESSED
     C                     MOVE ON        *IN50            ALL NUMBERS
     C                     ELSE
     C           Y         IFLE 0                          NUMBER IS
     C                     MOVE ON        *IN50            TO BIG FOR
     C                     MOVE ON        *IN89            OUTPUT
     C                     END
     C                     END
     C*
     C                     END
     C*
     C*    MOVE SIGN INTO OUTPUT FIELD. (APPEARS BEFORE THE NUMBER)
     C*
     C           Y         IFGT 0
     C           ZSIGN     IFEQ 'B'
     C                     MOVE ZSIGNT    ZAR2,Y
     C                     SUB  1         Y
     C                     END
     C                     ELSE
     C                     MOVE ON        *IN89
     C                     END
     C*
     C*    IS OUTPUT VALUE TO LARGE
     C*
     C           20        SUB  Y         U
     C           U         IFGT ZCHRO
     C                     MOVE ON        *IN89
     C                     END
     C*
     C*    MOVE FORMATTED AMOUNT TO OUTPUT FIELD.
     C*
     C                     MOVEAZAR2      ZNUMOT 20
     C*
     C*    INITILIZE INPUT PARAMETERS.
     C*
     C                     Z-ADD17        ZCHRO   20
     C                     MOVE *BLANKS   ZNUMIN 20
     C                     MOVE ' '       ZSIGNT  1
     C                     MOVE 'N'       ZSIGN   1
     C                     MOVE 'Y'       ZCOMA   1
     C*
     C                     ENDSR
     C*
     C***/EJECT*****                                                      S01390
     C********************************************************************S01390
     C***********                                                         S01390
     C*****ZSYSTM*SR.*TO*CHAIN*TO*THE*INSTALLATION*CONTROL*DATA*RECORD.***S01390
     C***********                                                         S01390
     C***********ZSYSTM    BEGSR                           *** ZSYSTM *** S01390
     C***********                                                         S01390
     C*****SET*UP*KEY*FOR*INSTALLATION*CONTROL*RECORD.********************S01390
     C***********          MOVEL'01      'ZTABKY 12                       S01390
     C***********          MOVE '  10'    ZTABKY                          S01390
     C***********                                                         S01390
     C***********ZTABKY    CHAINTABDLEE              99    ON NOT THERE   S01390
     C**N99******RECI      COMP 'D'                  9999  ON, IS DELETED S01390
     C***********                                                         S01390
     C*****CHECK*SYSTEM*DATE*FORMAT,*DDMMYY*OR*MMDDYY.********************S01390
     C***********DATF      COMP 'M'                      98MMDDYY, 98 ON  S01390
     C***********                                                         S01390
     C***********          ENDSR                                          S01390
     C***********                                                         S01390
     C********************************************************************S01390
     C***********                                                         S01390
     C*****GLINTC*SR.*TO*CALCULATE*INTEREST*BETWEEN*ANY*TWO*DAY*NUMBERS.**S01390
     C***********                                                         S01390
     C*****THIS*VERSION*REPLACES*THE*ORIGINAL*GLINTC*SR.*NOW*NAMED********S01390
     C*****GLINTO.********************************************************S01390
     C***********                                                         S01390
     C*****CALCULATION*METHODS*ARE*-**************************************S01390
     C*****1**ACTUAL/365**************************************************S01390
     C*****2**ACTUAL/360**************************************************S01390
     C*****3**360/360*(SOMETIMES*CALLED*30/360)***************************S01390
     C*****4**365/365*(EXCLUDING*29/02)***********************************S01390
     C*****5**365/360*(EXCLUDING*29/02)***********************************S01390
     C*****6**ACTUAL/366**************************************************S01390
     C***********                                                         S01390
     C*****REQUIRES*SUBRS.*-*ZDATE2,*ZSAVE,*&*ZRSTOR.*********************S01390
     C***********                                                         S01390
     C***********                                                         S01390
     C***********GLINTC    BEGSR                           ** GLINTC  **  S01390
     C***********                                                         S01390
     C*****CALCULATIONS*TO*DEFINE*INPUT*FIELDS.***************************S01390
     C***********          Z-ADDZIBEG     ZIBEG   50       STARTING DATE  S01390
     C***********          Z-ADDZIEND     ZIEND   50       FINISHING DATE S01390
     C***********          Z-ADDZICALC    ZICALC  10       CALC. BASIS    S01390
     C***********          Z-ADDZIAMT     ZIAMT  150       PRINCIPAL      S01390
     C***********          Z-ADDZIRATE    ZIRATE 117       RATE OF INTRST S01390
     C***********                                                         S01390
     C****TO*DETERMINE*NUMBER*OF*DAYS*INTEREST*TO*BE*CALCULATED***********S01390
     C***********ZIEND     SUB  ZIBEG     ZDAYN1  50                      S01390
     C***********                                                         S01390
     C****CHECK*FOR*INTEREST*CALCULATION*BASIS****************************S01390
     C*****USE*OF*INDICATRS***********************************************S01390
     C*****1,92**2,90**3,91**4,97**5,96**6,95*****************************S01390
     C***********          SETOF                     959697               S01390
     C***********ZICALC    COMP 2                    919290               S01390
     C**N91******          GOTO ZICAL                                     S01390
     C***********ZICALC    COMP 5                    959796               S01390
     C***97******ZICALC    COMP 3                    97  91               S01390
     C***95******                                                         S01390
     C***OR*96******          SETOF                     91                S01390
     C**N91******          GOTO ZILPCK                                    S01390
     C***********                                                         S01390
     C*****THIS*CODING*WILL*CALCULATE*THE*NUMBER*OF*DAYS*TO*USE*WHEN******S01390
     C*****USING*THE*30/360*BASIS*-*METHOD*3.*****************************S01390
     C***********          EXSR ZSAVE                                     S01390
     C***********          Z-ADDZIBEG     ZDAYNO                          S01390
     C***********          EXSR ZDATE2                                    S01390
     C***********          MOVE ZDAY      ZISD    20                      S01390
     C***********          MOVE ZMTH      ZISM    20                      S01390
     C***********          MOVE ZYEAR     ZISY    20                      S01390
     C***********          Z-ADDZIEND     ZDAYNO                          S01390
     C***********          EXSR ZDATE2                                    S01390
     C***********          MOVE ZDAY      ZIFD    20                      S01390
     C***********          MOVE ZMTH      ZIFM    20                      S01390
     C***********          MOVE ZYEAR     ZIFY    20                      S01390
     C***********          EXSR ZRSTOR                                    S01390
     C***********          SETOF                     93                   S01390
     C****IN*ORDER*FOR*THE*FINISH*YEAR*TO*BE*LESS*THAN*THE*START*YEAR*IF**S01390
     C****ZIEND*IS*GREATER*THAN*ZIBEG,THEN*THE*DATE*ZIEND*MUST*BE*IN*A****S01390
     C****DIFFERENT*CENTURY*TO*ZIBEG.IF*SO*ADD*100*YEARS*TO*IT.***********S01390
     C***********ZIEND     COMP ZIBEG                93                   S01390
     C***93******ZIFY      COMP ZISY                   93                 S01390
     C***********          Z-ADDZISY      ZISY2   30                      S01390
     C**N93******          Z-ADDZIFY      ZIFY2   30                      S01390
     C***93******ZIFY      ADD  100       ZIFY2                           S01390
     C***********                                                         S01390
     C*****DETERMINE*WHETHER*START*YEAR*IS*A*LEAP*YEAR*AND*IF*START*******S01390
     C*****MONTH*IS*FEBRUARY.*********************************************S01390
     C***********                                                         S01390
     C**N98******          BITOF'0'       ZGLBIT  1                       S01390
     C***98******          BITON'0'       ZGLBIT                          S01390
     C***********ZISY2     ADD  1900      ZLYCHK  40                      S01390
     C***********ZLYCHK    DIV  4         ZLYCHK                          S01390
     C***********          MVR            ZLYREM  20                      S01390
     C***********ZLYREM    COMP *ZERO                    98*LEAP YEAR     S01390
     C***********ZISM      COMP 2                        99*FEBRUARY      S01390
     C**N99******30        SUB  ZISD      ZID1    50   93                 S01390
     C**N99*93***          Z-ADD0         ZID1                            S01390
     C***99N98***28        SUB  ZISD      ZID1                            S01390
     C***99*98***29        SUB  ZISD      ZID1                            S01390
     C***********ZISM      COMP 12                       93               S01390
     C***93******          Z-ADD0         ZISM                            S01390
     C***93******ZISY      ADD  1         ZISY                            S01390
     C***93******ZISY2     ADD  1         ZISY2                           S01390
     C***********                                                         S01390
     C*****DETERMINE*WHETHER*END*YEAR*IS*A*LEAP*YEAR*AND*IF*END*MONTH*****S01390
     C*****IS*FEBRUARY.***************************************************S01390
     C***********                                                         S01390
     C***********ZIFY2     ADD  1900      ZLYCHK  40                      S01390
     C***********ZLYCHK    DIV  4         ZLYCHK                          S01390
     C***********          MVR            ZLYREM  20                      S01390
     C***********ZLYREM    COMP *ZERO                    98*LEAP YEAR     S01390
     C***********ZIFM      COMP 2                        99*FEBRUARY      S01390
     C**N99******ZIFD      COMP 31                       93               S01390
     C***99N98***ZIFD      COMP 28                       93               S01390
     C***99*98***ZIFD      COMP 29                       93               S01390
     C***********          SETOF                     98                   S01390
     C***********          TESTB'0'       ZGLBIT         98               S01390
     C***93******ZID1      ADD  30        ZID1                            S01390
     C**N93******ZID1      ADD  ZIFD      ZID1                            S01390
     C***********ZIFM      SUB  1         ZIFM                            S01390
     C***********ZISY      COMP ZIFY                     93               S01390
     C***93******ZIFM      SUB  ZISM      ZINOM   30                      S01390
     C***93******          GOTO ZIOUT                                     S01390
     C***********12        SUB  ZISM      ZIM1    20                      S01390
     C***********          Z-ADD1         ZISM                            S01390
     C*****USE*ENLARGED*FIELDS*THAT*CAN*HANDLE*1999*ONWARDS***************S01390
     C***********ZISY2     ADD  1         ZISY2                           S01390
     C***********ZIFY2     SUB  ZISY2     ZIY1    20                      S01390
     C***********ZIY1      MULT 12        ZIM2    30                      S01390
     C***********ZIM2      ADD  ZIFM      ZIM2                            S01390
     C***********ZIM1      ADD  ZIM2      ZINOM                           S01390
     C***********ZIOUT     TAG                             * ZIOUT TAG *  S01390
     C***********ZINOM     MULT 30        ZID2    50                      S01390
     C***********ZID2      ADD  ZID1      ZDAYN1                          S01390
     C***********          SETOF                     93                   S01390
     C***********ZILPCK    TAG                             * ZILPCK TAG * S01390
     C**N96N97***          GOTO ZICAL                                     S01390
     C*****THE*FOLLOWING*CODING*APPLIES*FOR*METHODS*4*AND*5*ONLY.*********S01390
     C*****1*DAY*IS*SUBTRACTED*FROM*ZDAYN1*FOR*EACH*OCCURANCE*OF*29*FEB***S01390
     C*****IN*THE*INTEREST*CALCULATION*PERIOD*INCLUSIVE*OF*ZIBEG,*&*ZIEND.S01390
     C***********                                                         S01390
     C*****FIND*NO*OF*4*YEAR*PERIODS*BETWEEN*DATES************************S01390
     C***********ZDAYN1    DIV  1461      ZIMAN   20                      S01390
     C***********          MVR            ZIREM   50                      S01390
     C*****FIND*NEXT*29*FEB*DAY*NO.*ON*OR*AFTER*ZIBEG.********************S01390
     C***********ZIBEG     SUB  60        ZIBW1   50                      S01390
     C***********ZIBW1     DIV  1461      ZIDW1   20                      S01390
     C***********          MVR            ZIDREM  50                      S01390
     C***********ZIDREM    COMP 0                        94               S01390
     C***94******          Z-ADDZIBEG     ZIDW2   50                      S01390
     C***94******          GOTO ZILP1                                     S01390
     C*****ROUND*UP*RESULT************************************************S01390
     C***********ZIDW1     ADD  1         ZIDW2                           S01390
     C*****CALCULATE*NEXT*29*FEB.*****************************************S01390
     C***********ZIDW2     MULT 1461      ZIDW2                           S01390
     C***********ZIDW2     ADD  60        ZIDW2                           S01390
     C***********ZILP1     TAG                             * ZILP1 TAG *  S01390
     C*****IF*THIS*NEXT*29*FEB.*DAYNO*-*ZIBEG*IS*GR.*TH.*OR*EQ.*TO********S01390
     C*****ZIREM*THEN*ADD*1*TO*ZIMAN.*************************************S01390
     C***********ZIDW2     SUB  ZIBEG     ZILPCP  50                      S01390
     C***********ZIREM     COMP ZILPCP               94  94               S01390
     C***94******ZIMAN     ADD  1         ZIMAN                           S01390
     C*****SUBTRACT*ZIMAN*FROM*ZDAYN1*TO*GIVE*VALUE*OF*ZDAYN1*************S01390
     C*****REQUIRED*FOR*THIS*INTEREST*CALCULATION.************************S01390
     C***********ZDAYN1    SUB  ZIMAN     ZDAYN1                          S01390
     C***********          SETOF                     94                   S01390
     C***********ZICAL     TAG                             * ZICAL TAG *  S01390
     C***********                                                         S01390
     C****CALCULATE*INTEREST**********************************************S01390
     C***90******                                                         S01390
     C***OR*91******                                                      S01390
     C***OR*96******ZIAMT     DIV  36000     ZIWRK1 155H                  S01390
     C***92******                                                         S01390
     C***OR*97******ZIAMT     DIV  36500     ZIWRK1    H                  S01390
     C***95******ZIAMT     DIV  36600     ZIWRK1    H                     S01390
     C***********ZIWRK1    MULT ZIRATE    ZIWRK2 155H                     S01390
     C***********ZIWRK2    MULT ZDAYN1    ZINTR  152H      AMT. OF INTRST S01390
     C***********                                                         S01390
     C***********          SETOF                     909192               S01390
     C***********          SETOF                     959697               S01390
     C***********                                                         S01390
     C***********                                                         S01390
     C*****AMENDMENT*FOR*THIS*PROGRAM*ONLY********************************S01390
     C*****ROUND*INTEREST*AMOUNT*TO*ZERO*DEC*PL***************************S01390
     C***********                                                         S01390
     C***********          Z-ADDZINTR     WKINT  130H                     S01390
     C***********                                                         S01390
     C***********          ENDSR                                          S01390
     C***********                                                         S01390
     C********************************************************************S01390
     C***********                                                         S01390
     C*****ZSAVE*SR.*TO*MEMORISE*THE*SETTINGS*AND*TO*SET*OFF*INDICATORS***S01390
     C****************90*-*97*BEFORE*EXECUTION*OF*A*Z-SUBROUTINE.*********S01390
     C***********                                                         S01390
     C*****THIS*SR.*IS*REQUIRED*ONLY*IF*INDICATORS************************S01390
     C*****90*-*97*ARE*USED*ELSEWHERE*IN*A*PROGRAM.***********************S01390
     C***********                                                         S01390
     C***********ZSAVE     BEGSR                           *** ZSAVE ***  S01390
     C***********                                                         S01390
     C***********          BITOF'01234567'ZBITS   1                       S01390
     C***90******          BITON'0'       ZBITS                           S01390
     C***91******          BITON'1'       ZBITS                           S01390
     C***92******          BITON'2'       ZBITS                           S01390
     C***93******          BITON'3'       ZBITS                           S01390
     C***94******          BITON'4'       ZBITS                           S01390
     C***95******          BITON'5'       ZBITS                           S01390
     C***96******          BITON'6'       ZBITS                           S01390
     C***97******          BITON'7'       ZBITS                           S01390
     C***********                                                         S01390
     C***********          SETOF                     909192               S01390
     C***********          SETOF                     939495               S01390
     C***********          SETOF                     9697                 S01390
     C***********                                                         S01390
     C***********          ENDSR                                          S01390
     C***********                                                         S01390
     C********************************************************************S01390
     C***********                                                         S01390
     C*****ZRSTOR*SR.*TO*RESTORE*INDICATORS*90*-*97*TO*THE*SETTINGS*******S01390
     C***********     THEY HAD BEFORE THE EXECUTION OF SR. ZSAVE.         S01390
     C***********                                                         S01390
     C***********ZRSTOR    BEGSR                           *** ZRSTOR *** S01390
     C***********                                                         S01390
     C***********          TESTB'0'       ZBITS          90               S01390
     C***********          TESTB'1'       ZBITS          91               S01390
     C***********          TESTB'2'       ZBITS          92               S01390
     C***********          TESTB'3'       ZBITS          93               S01390
     C***********          TESTB'4'       ZBITS          94               S01390
     C***********          TESTB'5'       ZBITS          95               S01390
     C***********          TESTB'6'       ZBITS          96               S01390
     C***********          TESTB'7'       ZBITS          97               S01390
     C***********                                                         S01390
     C***********          ENDSR                                          S01390
     C***********                                                         S01390
     C********************************************************************S01390
     C***********                                                         S01390
     C*****ZDATE2*SR.*TO*CONVERT*A*DAY*NUMBER*TO*DATE*FORMATS.************S01390
     C***********                                                         S01390
     C*****THE*YEAR*2000,*BEING*DIVISIBLE*BY*400,*IS*A*LEAP*YEAR.*********S01390
     C***********                                                         S01390
     C***********ZDATE2    BEGSR                           *** ZDATE2 *** S01390
     C***********                                                         S01390
     C*****CLEAR*DATE*FIELDS.*********************************************S01390
     C***********          Z-ADD0         ZDATE   60                      S01390
     C***********          MOVEL'       ' ZADATE  7                       S01390
     C***********                                                         S01390
     C*****CALCULATION*TO*DEFINE*INPUT*DAY*NUMBER.************************S01390
     C***********          Z-ADDZDAYNO    ZDAYNO  50                      S01390
     C***********                                                         S01390
     C*****DETERMINE*YEAR*NUMBER.*****************************************S01390
     C***********                                                         S01390
     C*****ADJUST*DAY*NUMBER*IN*CASE*LAST*DAY*OF*YEAR.********************S01390
     C***********ZDAYNO    SUB  1         ZDAYN1  50   99                 S01390
     C***99******          GOTO ZDEND2                                    S01390
     C***********                                                         S01390
     C*****CALCULATE*NUMBER*OF*4*YEAR*SPANS*SINCE*31/12/1971.*************S01390
     C***********ZDAYN1    DIV  1461      ZLYR    20                      S01390
     C***********          MVR            ZDAYN1           SAVE REMAINING S01390
     C***********                                          DAYS           S01390
     C*****CALCULATE*NUMBER*OF*REMAINING*YEARS.***************************S01390
     C***********          Z-ADD1         ZWRK2   20                      S01390
     C***********ZDTAG1    TAG                             ** ZDTAG1 TAG *S01390
     C***********ZDAYN1    COMP ZYDY,ZWRK2             90                 S01390
     C**N90******ZWRK2     ADD  1         ZWRK2                           S01390
     C**N90******          GOTO ZDTAG1                                    S01390
     C***********ZWRK2     SUB  1         ZWRK2          91LEAP YR, 91 ON S01390
     C***********                                                         S01390
     C*****DECREMENT*DAY*NO.*BY*DAYS*IN*REMAINING*YEARS.******************S01390
     C**N91******ZDAYN1    SUB  ZYDY,ZWRK2ZDAYN1                          S01390
     C***********                                                         S01390
     C*****CALCULATE*ACTUAL*YEAR*NUMBER.**********************************S01390
     C***********ZLYR      MULT 4         ZWRK3   30                      S01390
     C***********ZWRK3     ADD  72        ZWRK3            BASE IS 1972   S01390
     C***********          Z-ADDZWRK3     ZYEAR   20                      S01390
     C***********ZYEAR     ADD  ZWRK2     ZYEAR            YEAR           S01390
     C***********                                                         S01390
     C*****DETERMINE*MONTH*NUMBER.****************************************S01390
     C***********                                                         S01390
     C*****ADJUST*DAY*NO.*IN*CASE*LAST*DAY*OF*LEAP*YEAR*FEBRUARY.*********S01390
     C***********          SETOF                     9293                 S01390
     C***91******ZDAYN1    COMP 59                     9293               S01390
     C***91N92***ZDAYN1    SUB  1         ZDAYN1                          S01390
     C***********                                                         S01390
     C*****CALCULATE*MONTH*NUMBER.****************************************S01390
     C***********          Z-ADD2         ZWRK2                           S01390
     C***********ZDTAG2    TAG                             ** ZDTAG2 TAG *S01390
     C***********ZDAYN1    COMP ZMDY,ZWRK2             94                 S01390
     C**N94******ZWRK2     ADD  1         ZWRK2                           S01390
     C**N94******          GOTO ZDTAG2                                    S01390
     C***********ZWRK2     SUB  1         ZWRK2                           S01390
     C***********                                                         S01390
     C***********          Z-ADDZWRK2     ZMTH    20       MONTH          S01390
     C***********                                                         S01390
     C*****DETERMINE*DAY*OF*MONTH.****************************************S01390
     C***********                                                         S01390
     C*****ADD*BACK*LAST*DAY*OF*YEAR*ADJUSTMENT.**************************S01390
     C***********ZDAYN1    ADD  1         ZDAYN1                          S01390
     C***********                                                         S01390
     C*****CALCULATE*DAY*OF*MONTH.****************************************S01390
     C***********ZDAYN1    SUB  ZMDY,ZWRK2ZDAY    20       DAY            S01390
     C***********                                                         S01390
     C*****ADD*BACK*LEAP*YEAR*29TH*FEBUARY*ADJUSTMENT,*IF*REQUIRED.*******S01390
     C***93******ZDAY      ADD  1         ZDAY                            S01390
     C***********                                                         S01390
     C*****FORMAT*DATE,*DDMMYY*OR*MMDDYY.*********************************S01390
     C**N98******          MOVELZDAY      ZWRK4   40                      S01390
     C***98******          MOVE ZDAY      ZWRK4                           S01390
     C**N98******          MOVE ZMTH      ZWRK4                           S01390
     C***98******          MOVELZMTH      ZWRK4                           S01390
     C***********          MOVELZWRK4     ZDATE                           S01390
     C***********          MOVE ZYEAR     ZDATE                           S01390
     C***********                                                         S01390
     C*****FORMAT*ALPHA*DATE,*DDMMMYY.************************************S01390
     C***********ZDAY      COMP 10                     95                 S01390
     C***********          MOVELZDAY      ZWRK5   5                       S01390
     C***95******          MOVEL' '       ZWRK5                           S01390
     C***********          MOVE ZMNM,ZMTH ZWRK5                           S01390
     C***********          MOVELZWRK5     ZADATE                          S01390
     C***********          MOVE ZYEAR     ZADATE                          S01390
     C***********                                                         S01390
     C***********ZDEND2    ENDSR                           * ZDEND2 ENDSR*S01390
     C***********                                                         S01390
     C********************************************************************
     C********************************************************************S01390
     C*                                                                   S01390
     C*  ERROR DUMP SUB-ROUTINE                                           S01390
     C           *PSSR     BEGSR                           *** *PSSR  *** S01390
     C*                                                                   S01390
     C           @RUN      IFEQ *BLANK                                    S01390
     C                     MOVE 'Y'       @RUN    1                       S01390
     C                     DUMP                                           S01390
     C                     OUT  LDA                                       S01390
     C                     END                                            S01390
     C                     ENDSR                           * *PSSR  ENDSR*S01390
     C*                                                                   S01390
     C********************************************************************S01390
     C/EJECT
     C/COPY ZSRSRC,ZDATE2Z2                                               S01390
      /EJECT                                                              066550
     C/COPY ZSRSRC,ZINTDYZ2                                               066550
      /EJECT                                                              066550
     C/COPY ZSRSRC,ZDATE9Z3                                               066550
     C/EJECT                                                              126017
     C/COPY ZSRSRC,ZDAT10Z2                                               126017
     C/EJECT                                                              126017
     C/SPACE 3                                                            S01390
     O*
     O*
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
** CPY@   **      OBJECT COPYRIGHT                                        S01390
(c) Misys International Banking Systems Ltd. 2001
** @YD  USED BY SR. ZDATE9 - YEARS, IN DAYS, CUMULATIVE IN 4 YEAR SPAN
00366007310109601461
** @MD  USED BY SR. ZDATE9 - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
00000000310005900090001200015100181002120024300273003040033400365
