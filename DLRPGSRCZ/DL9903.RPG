     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas DL FRA/IRS create extended settlement inst.')
      *****************************************************************
      *                                                               *
      *  Midas - Dealing Module                                       *
      *                                                               *
      *  DL9903 - Create Extra Extended Settlement Instruction        *
      *                                                               *
      *  (c) Misys International Banking Systems Ltd. 2001            *
      *                                                               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *  Last Amend No. CSD027             Date 09Dec05               *
      *  Prev Amend No. CDL038             Date 10May05               *
      *                 CDL028             Date 07Feb05               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.05 -----------------------------------------------*
      *                 CIR003  *CREATE    Date 12Sep00               *
      *                                                               *
      *---------------------------------------------------------------*
      *                                                               *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CDL038 - Extended Deal Sub Type (Recompile)                  *
      *  CDL028 - Automatic Rate Interpolations (Recompile)           *
      *  CIR003 - Principal Exchange on Cross Currencies IRS          *
      *                                                               *
      *****************************************************************
     FDLDLDGLDIF  E           K        DISK         KINFSR *PSSR
     FDLGXSTPDO   E                    DISK                           UC
      *****************************************************************
      /EJECT
      *****************************************************************
     E                    PCMD    1   1 15
     E                    CPY@    1   1 80
      ** Array containing Copyright statement
      *
      *****************************************************************
      /SPACE 3
      *****************************************************************
     ILDA       E DSLDA                         256
      ** Local data area for database error details
      *
      *****************************************************************
      /EJECT
      *****************************************************************
      *
      ** Entry Parameters
      *
     C           *ENTRY    PLIST
     C                     PARM           PRTCD   7
     C                     PARM           PMOD    1
      *
      ** Set up copyright parameter
      *
     C                     MOVEACPY@      CPY2@  80
      *
     C                     MOVE *BLANKS   PRTCD
     C                     Z-ADD15        PLGTH  155
      *
      ** Clear file first when file is already written
      *
     C           PMOD      IFEQ '2'
     C                     CALL 'QCMDEXC'
     C                     PARM           PCMD
     C                     PARM           PLGTH
     C                     ENDIF
      *
      ** Read DLDLDGLD
      *
     C           PMOD      IFEQ '1'
     C           PMOD      OREQ '2'
      *
     C                     READ DLDLDGLD                 80
     C                     OPEN DLGXSTPD
      *
     C           *IN80     DOWEQ*OFF
      *
     C           DTYP      IFEQ 'RX'
      *
     C           VDEI      IFEQ 'Y'
     C           PDEI      OREQ 'Y'
      *
      ** Clear DLGXSTPD fields
      *
     C                     MOVE *BLANKS   RXDLNO
     C                     MOVE *BLANKS   RXEDCD
     C                     MOVE *BLANKS   RXRSTM
     C                     MOVE *BLANKS   RXRONS
     C                     MOVE *BLANKS   RXRIBN
     C                     MOVE *BLANKS   RXRIBA
     C                     MOVE *BLANKS   RXROBN
     C                     MOVE *BLANKS   RXROCN
     C                     MOVE *BLANKS   RXROBR
     C                     MOVE *BLANKS   RXRSCY
     C                     MOVE *BLANKS   RXPSTM
     C                     MOVE *BLANKS   RXPONS
     C                     MOVE *BLANKS   RXPIBN
     C                     MOVE *BLANKS   RXPIBA
     C                     MOVE *BLANKS   RXPOBN
     C                     MOVE *BLANKS   RXPOCN
     C                     MOVE *BLANKS   RXRCRN
     C                     MOVE *BLANKS   RXRCRA
     C                     MOVE *BLANKS   RXRVNO
     C                     MOVE *BLANKS   RXAWBN
     C                     MOVE *BLANKS   RXAWBA
     C                     MOVE *BLANKS   RXBENN
     C                     MOVE *BLANKS   RXBENA
     C                     MOVE *BLANKS   RXDTP1
     C                     MOVE *BLANKS   RXDTP2
     C                     MOVE *BLANKS   RXDTP3
     C                     MOVE *BLANKS   RXDTP4
     C                     MOVE *BLANKS   RXDCHG
     C                     MOVE *BLANKS   RXBTB1
     C                     MOVE *BLANKS   RXBTB2
     C                     MOVE *BLANKS   RXBTB3
     C                     MOVE *BLANKS   RXBTB4
     C                     MOVE *BLANKS   RXBTB5
     C                     MOVE *BLANKS   RXBTB6
     C                     MOVE *BLANKS   RXCVMR
     C                     MOVE *BLANKS   RXPOBR
     C                     MOVE *BLANKS   RXPSCY
     C                     MOVE *BLANKS   RXIC72
     C                     MOVE *BLANKS   RXDSR1
     C                     MOVE *BLANKS   RXDSR2
     C                     MOVE *BLANKS   RXDSR3
     C                     MOVE *BLANKS   RXDSR4
     C                     MOVE *BLANKS   RXDSR5
     C                     MOVE *BLANKS   RXDSR6
     C                     MOVE *BLANKS   RXSSR1
     C                     MOVE *BLANKS   RXSSR2
     C                     MOVE *BLANKS   RXSSR3
     C                     MOVE *BLANKS   RXSSR4
     C                     MOVE *BLANKS   RXSSR5
     C                     MOVE *BLANKS   RXSSR6
     C                     MOVE *BLANKS   RXCND1
     C                     MOVE *BLANKS   RXCND2
     C                     MOVE *BLANKS   RXCND3
     C                     MOVE *BLANKS   RXCND4
     C                     MOVE *BLANKS   RXCND5
     C                     MOVE *BLANKS   RXCND6
     C                     MOVE *BLANKS   RXISDA
     C                     MOVE *BLANKS   RXAGTY
     C                     MOVE *BLANKS   RXAGDT
     C                     MOVE *BLANKS   RXAGVV
     C                     MOVE *BLANKS   RXAGVC
      *
     C                     MOVE DLNO      RXDLNO
     C                     MOVE 'VAL'     RXEDCD
      *
      ** Write record
      *
     C                     WRITEDLGXSTD0               81
      *
     C           *IN81     IFEQ *ON
     C                     MOVEL'DLGXSTPD'DBFILE
     C                     Z-ADD01        DBASE
     C                     MOVEL*BLANK    DBKEY
     C                     EXSR *PSSR
     C                     ENDIF
      *
     C                     ENDIF
      *
      ** Move DLDLDGLD fields to DLGXSTPD fields
      *
     C                     MOVE DLNO      RXDLNO
     C                     MOVE 'INT'     RXEDCD
     C                     MOVE RSTM      RXRSTM
     C                     MOVE RONS      RXRONS
     C                     MOVE RIBN      RXRIBN
     C                     MOVE RIBA      RXRIBA
     C                     MOVE ROBN      RXROBN
     C                     MOVE ROCN      RXROCN
     C                     MOVE ROBR      RXROBR
     C                     MOVE RSCY      RXRSCY
     C                     MOVE PSTM      RXPSTM
     C                     MOVE PONS      RXPONS
     C                     MOVE PIBN      RXPIBN
     C                     MOVE PIBA      RXPIBA
     C                     MOVE POBN      RXPOBN
     C                     MOVE POCN      RXPOCN
     C                     MOVE RCRN      RXRCRN
     C                     MOVE RCRA      RXRCRA
     C                     MOVE RVNO      RXRVNO
     C                     MOVE AWBN      RXAWBN
     C                     MOVE AWBA      RXAWBA
     C                     MOVE BENN      RXBENN
     C                     MOVE BENA      RXBENA
     C                     MOVE DTP1      RXDTP1
     C                     MOVE DTP2      RXDTP2
     C                     MOVE DTP3      RXDTP3
     C                     MOVE DTP4      RXDTP4
     C                     MOVE DCHG      RXDCHG
     C                     MOVE BTB1      RXBTB1
     C                     MOVE BTB2      RXBTB2
     C                     MOVE BTB3      RXBTB3
     C                     MOVE BTB4      RXBTB4
     C                     MOVE BTB5      RXBTB5
     C                     MOVE BTB6      RXBTB6
     C                     MOVE CVMR      RXCVMR
     C                     MOVE POBR      RXPOBR
     C                     MOVE PSCY      RXPSCY
     C                     MOVE IC72      RXIC72
     C                     MOVE DSR1      RXDSR1
     C                     MOVE DSR2      RXDSR2
     C                     MOVE DSR3      RXDSR3
     C                     MOVE DSR4      RXDSR4
     C                     MOVE DSR5      RXDSR5
     C                     MOVE DSR6      RXDSR6
     C                     MOVE SSR1      RXSSR1
     C                     MOVE SSR2      RXSSR2
     C                     MOVE SSR3      RXSSR3
     C                     MOVE SSR4      RXSSR4
     C                     MOVE SSR5      RXSSR5
     C                     MOVE SSR6      RXSSR6
     C                     MOVE CND1      RXCND1
     C                     MOVE CND2      RXCND2
     C                     MOVE CND3      RXCND3
     C                     MOVE CND4      RXCND4
     C                     MOVE CND5      RXCND5
     C                     MOVE CND6      RXCND6
     C                     MOVE ISDA      RXISDA
     C                     MOVE AGTY      RXAGTY
     C                     MOVE AGDT      RXAGDT
     C                     MOVE AGVV      RXAGVV
     C                     MOVE AGVC      RXAGVC
      *
      ** Write record
      *
     C                     WRITEDLGXSTD0               81
      *
     C           *IN81     IFEQ *ON
     C                     MOVEL'DLGXSTPD'DBFILE
     C                     Z-ADD02        DBASE
     C                     MOVEL*BLANK    DBKEY
     C                     EXSR *PSSR
     C                     ENDIF
      *
     C           MDEI      IFEQ 'Y'
     C           PDEI      OREQ 'Y'
      *
      ** Clear DLGXSTPD fields
      *
     C                     MOVE *BLANKS   RXDLNO
     C                     MOVE *BLANKS   RXEDCD
     C                     MOVE *BLANKS   RXRSTM
     C                     MOVE *BLANKS   RXRONS
     C                     MOVE *BLANKS   RXRIBN
     C                     MOVE *BLANKS   RXRIBA
     C                     MOVE *BLANKS   RXROBN
     C                     MOVE *BLANKS   RXROCN
     C                     MOVE *BLANKS   RXROBR
     C                     MOVE *BLANKS   RXRSCY
     C                     MOVE *BLANKS   RXPSTM
     C                     MOVE *BLANKS   RXPONS
     C                     MOVE *BLANKS   RXPIBN
     C                     MOVE *BLANKS   RXPIBA
     C                     MOVE *BLANKS   RXPOBN
     C                     MOVE *BLANKS   RXPOCN
     C                     MOVE *BLANKS   RXRCRN
     C                     MOVE *BLANKS   RXRCRA
     C                     MOVE *BLANKS   RXRVNO
     C                     MOVE *BLANKS   RXAWBN
     C                     MOVE *BLANKS   RXAWBA
     C                     MOVE *BLANKS   RXBENN
     C                     MOVE *BLANKS   RXBENA
     C                     MOVE *BLANKS   RXDTP1
     C                     MOVE *BLANKS   RXDTP2
     C                     MOVE *BLANKS   RXDTP3
     C                     MOVE *BLANKS   RXDTP4
     C                     MOVE *BLANKS   RXDCHG
     C                     MOVE *BLANKS   RXBTB1
     C                     MOVE *BLANKS   RXBTB2
     C                     MOVE *BLANKS   RXBTB3
     C                     MOVE *BLANKS   RXBTB4
     C                     MOVE *BLANKS   RXBTB5
     C                     MOVE *BLANKS   RXBTB6
     C                     MOVE *BLANKS   RXCVMR
     C                     MOVE *BLANKS   RXPOBR
     C                     MOVE *BLANKS   RXPSCY
     C                     MOVE *BLANKS   RXIC72
     C                     MOVE *BLANKS   RXDSR1
     C                     MOVE *BLANKS   RXDSR2
     C                     MOVE *BLANKS   RXDSR3
     C                     MOVE *BLANKS   RXDSR4
     C                     MOVE *BLANKS   RXDSR5
     C                     MOVE *BLANKS   RXDSR6
     C                     MOVE *BLANKS   RXSSR1
     C                     MOVE *BLANKS   RXSSR2
     C                     MOVE *BLANKS   RXSSR3
     C                     MOVE *BLANKS   RXSSR4
     C                     MOVE *BLANKS   RXSSR5
     C                     MOVE *BLANKS   RXSSR6
     C                     MOVE *BLANKS   RXCND1
     C                     MOVE *BLANKS   RXCND2
     C                     MOVE *BLANKS   RXCND3
     C                     MOVE *BLANKS   RXCND4
     C                     MOVE *BLANKS   RXCND5
     C                     MOVE *BLANKS   RXCND6
     C                     MOVE *BLANKS   RXISDA
     C                     MOVE *BLANKS   RXAGTY
     C                     MOVE *BLANKS   RXAGDT
     C                     MOVE *BLANKS   RXAGVV
     C                     MOVE *BLANKS   RXAGVC
      *
     C                     MOVE DLNO      RXDLNO
     C                     MOVE 'MAT'     RXEDCD
      *
      ** Write record
      *
     C                     WRITEDLGXSTD0               81
      *
     C           *IN81     IFEQ *ON
     C                     MOVEL'DLGXSTPD'DBFILE
     C                     Z-ADD03        DBASE
     C                     MOVEL*BLANK    DBKEY
     C                     EXSR *PSSR
     C                     ENDIF
      *
     C                     ENDIF
      *
     C                     ENDIF
      *
     C                     READ DLDLDGLD                 80
      *
     C                     ENDDO
      *
     C                     ENDIF
      *
     C                     MOVE *ON       *INLR
      *
      *****************************************************************
      /EJECT
      *****************************************************************
      *                                                               *
      * *PSSR  - Program exception error routine                      *
      *                                                               *
      *****************************************************************
      *
     C           *PSSR     BEGSR
      *
     C                     DUMP
      *
     C                     MOVE *ON       *INU7
     C                     MOVE *ON       *INU8
     C                     MOVE *ON       *INLR
      *
     C                     MOVE '*ERROR'  PRTCD
      *
     C                     RETRN
      *
     C                     ENDSR
      *
      ********************************************************************
**  PCMD
CLRPFM DLGXSTPD
**  CPY@
(c) Misys International Banking Systems Ltd. 2001
