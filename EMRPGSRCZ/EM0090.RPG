0001 H                                                                    EM0090
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas EM Dubious Indicator Check')
0002 F********************************************************************EM0090
0004 F*                                                                  *EM0090
     F*  Midas EXPOSURE MANAGEMENT MODULE                             EM0090
0004 F*                                                                  *EM0090
0005 F*    EM0090 - CHECK DUBIOUS INDICATOR                               EM0090
0004 F*                                                                  *EM0090
     F*  Function: This program tests if the dubious indicator in the
     F*  (I/C)     on-line Exposure Management file header (EMCEXX1)
     F*            has been set on, indicating an error in the on-line
     F*            exposure update.
     F*
     F*            If the dubious indicator has not been set on, the
     F*            'exposure update wait time' is retrieved from
     F*            TABTB95 and is moved to the LDA.
     F*
     F*            The 'wait-time' is used in the background update
     F*            program EM0101 to control the time between exposure
     F*            updates.
     F*
     F*  Called By: EMC0202
     F*
     F*  Calls: None
     F*
      *  (c) Finastra International Limited 2001                      *
0004 F*                                                                  *EM0090
      *  Last Amend No. AR832484           Date 10Nov23               *
      *  Prev Amend No. MD046248           Date 27Oct17               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 CTI002 EM / TI Interface 23/09/98             *
0009 F*                  S01332         DATE 19JUL91                     *S01332
0007 F*                  S01117         DATE 24/10/89                    *
0007 F*                  S01129         DATE 18/11/87                    *S01129
0007 F*                  S01128         DATE 08/01/87                    *
0008 F*                                                                  *EM0090
0011 F********************************************************************EM0090
0010 F*                                                                  *
      *  AR832484 - Enclosure shows the difference between On-screen  *
      *             checking and EM0600P1.  Recompiled over fixed     *
      *             logical file TABEM.  (Child: AR832485)            *
      *    MD046248 - Finastra Rebranding                                *
      *    CTI002 - Recompiled : File EMCEX changed
     F*    S01332 - EM REL 10 ENHANCEMENTS: DESCRIPTION OF FUNCTION
     F*             ADDED TO HEADER BOX
0009 F*    S01117 - RELEASE TEN MULTIBRANCHING                           *
0009 F*    S01128 - RECOMPILE DUE TO CHANGE OF FILE EMCEX                *S01128
0009 F*    S01129 - SECURITIES TRADING RELEASE 2                         *S01129
0010 F*                                                                  *
0011 F********************************************************************
0012 F**** EMCEX   IP  F     128  6AI     2 DISK                          S01128
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
0012 FEMCEX   IP  F     150  6AI     2 DISK                               S01128
0013 F*ABLE***IF  F      96 12AI     2 DISK                               S01129
0013 FTABEM   IF  E           K        DISK                               S01129
0013 F            TABTB10F                          KIGNORE               S01129
0013 F            TABTB11F                          KIGNORE               S01129
0013 F            TABTB36F                          KIGNORE               S01129
0013 F*           TABTB95F                          KIGNORE               S01129
0013 F            TABTE10F                          KIGNORE               S01129
0013 F            TABTG10F                          KIGNORE               S01129
0013 F            TABLETHF                          KIGNORE               S01129
0013 F            TABLETIF                          KIGNORE               S01129
0013 F            TABLETNF                          KIGNORE               S01129
0013 F            TABLETTF                          KIGNORE               S01129
0014 F*PRINT  O   F     132     OF     PRINTER                            EM0090
0015 F*                                                                   EM0090
0016 F* ID F  C  H  L    FUNCTION OF INDICATORS                           EM0090
0017 F**                                                                  EM0090
0018 F* 01            EMCEX - HEADER RECORD UNDELETED                     EM0090
0019 F*****           TABLE - INSTALATION CONTROL RECORD 2.               S01129
0020 F**                                                                  EM0090
0021 F*       40             IF ON - DUBIOUS INDICATOR = Y                EM0090
0022 F**                                                                  EM0090
0023 F*       99      Z -SUBROUTINES, ERROR FOUND.                        EM0090
0024 F*                     (DATABASE ERROR)                              EM0090
0025 F**                                                                  EM0090
0026 F*          LR   IF ON - PROCESS NORMAL SINGLE CYCLE                 EM0090
0027 F*                                                                   EM0090
0028 F**                                                                  EM0090
0029 F*               EXTERNAL INDICATOR MEANINGS ON OUTPUT-              EM0090
0030 F*          U1   IF ON - DUBIOUS INDICATOR ON                        EM0090
0031 F*          U7   SYSTEM ERROR.                                       EM0090
0032 F*          U8   DATABASE ERROR, REQUIRED RECORDS NOT FOUND.         EM0090
0033 F*               N.B. U6, U7 & U8 END THE PROGRAM AND CONDITION      EM0090
0034 F*                    FOLLOWING OCL EXECUTION.                       EM0090
     E                    CPY@    1   1 80               COPYRIGHT STATEMENT
0036 I*                                                                   EM0090
0037 I*  EXPOSURE MANAGEMENT INPUT CYCLE EXPOSURE FILE - HEADER RECORD    EM0090
0038 I*                                                                   EM0090
0039 IEMCEX   NS  01   1 CH                                               EM0090
0040 I                                        1   1 RECI                  EM0090
0041 I********                                2   70KEY                   S01129
0041 I                                        2   70EMKEY                 S01129
0042 I*****                                       20  20 MDI              S01128
0042 I                                        8   8 MDI                   S01128
0043 I** CATCHALL                                                         EM0090
0044 I        NS                                                          EM0090
0045 I**                                                                  S01129
0046 I**   TABLE FILE - INSTALLATION CONTROL DATA RECORD 2.               S01129
0047 I**                                                                  S01129
0048 I*ABLE   NS  02   1 CD   2 C0   3 C1                                 S01129
0049 I*      AND      12 C1  13 C1                                        S01129
0050 I*                                       1   1 RECI                  S01129
0051 I*                                      72  770WTIM                  S01129
0052 I*       NS                                                          S01129
     I*  DATA STRUCTURE FOR COMPILATION  - COPYRIGHT INSERTION
     ICPYR@#      DS
     I                                        1  80 CPY@
     I                                        1  20 CPY@##
0053 I**  DATA STRUCTURE FOR WTIM TO USE IN CONVERSION                    EM0090
0054 I            DS                              6                       EM0090
     I                                        1   60WTIM
0055 I                                        1   20HOURS                 EM0090
0056 I                                        3   40MINS                  EM0090
0057 I                                        5   60SECS                  EM0090
0053 I**  LOCAL DATA AREA FOR DATABASE RECORD                             EM0090
0054 ILDA        UDS                            256                       EM0090
0055 I**********                            134 138 DBFILE                S01117
0056 I**********                            139 167 DBKEY                 S01117
0057 I**********                            168 175 DBPGM                 S01117
0058 I**********                            176 1770DBASE                 S01117
0055 I                                      134 141 DBFILE                S01117
0056 I                                      142 170 DBKEY                 S01117
0057 I                                      171 180 DBPGM                 S01117
0058 I                                      181 1830DBASE                 S01117
0059 I                                      251 2560WAITT                 EM0090
0060 I**                                                                  EM0090
0061 C/EJECT                                                              EM0090
     C                     MOVEACPY@      BIS@   80
0062 C********************************************************************EM0090
0063 C**                                                                  EM0090
0064 C**   SET ON LR TO GOVERN A ONE CYCLE PROGRAM TO CHECK               EM0090
0065 C**   THE DUBIOUS INDICATOR FOR Y OR BLANK                           EM0090
0066 C**                                                                  EM0090
0067 C                     SETON                     LR                   EM0090
0068 C**                                                                  EM0090
0069 C**   N01 MEANS NO EMCEX HEADER RECORD                               EM0090
0070 C**                                                                  EM0090
0071 C  N01                SETON                     99                   EM0090
0072 C   99                MOVE 'EMCEX'   DBFILE                          EM0090
0073 C   99                MOVE 'HEADER'  DBKEY                           EM0090
0074 C   99                MOVE 'EM0090'  DBPGM                           EM0090
0075 C   99                Z-ADD01        DBASE            DATABASE 01    EM0090
0076 C   99                SETON                     LRU7U8               EM0090
0077 C   99                GOTO TERM                       ** GOTO TERM   EM0090
0078 C           MDI       COMP 'Y'                      40               EM0090
0079 C   40                SETON                     U1                   EM0090
0080 C   40                GOTO TERM                       ** GOTO TERM   EM0090
0081 C*    ACCESS ICR2 FOR WAIT TIME                                      EM0090
0082 C**                                                                  EM0090
0083 C*********** KEY FOR INSTALLATION CONTROL RECORD 2 .                 S01129
0083 C**   SET UP KEY FOR INSTALLATION CONTROL RECORD TABTB95             S01129
0084 C******               MOVEL'01      'ZTABKY 12                       S01129
0085 C*******              MOVE '  11'    ZTABKY                          S01129
0084 C                     MOVEL'01      'ZTABKY 12                       S01129
0085 C                     MOVE '  95'    ZTABKY                          S01129
0086 C**                                                                  EM0090
0087 C******     ZTABKY    CHAINTABLE                99    ON NOT THERE   S01129
0087 C           ZTABKY    CHAINTABEM                99    ON NOT THERE   S01129
0088 C**                                                                  EM0090
0087 C  N99      RECI      COMP '*'                      99ON NOT THERE   S01129
0089 C   99                MOVE 'TABLE'   DBFILE                          EM0090
0090 C   99                MOVE ZTABKY    DBKEY                           EM0090
0091 C   99                MOVE 'EM0090'  DBPGM                           EM0090
0092 C   99                Z-ADD02        DBASE            DATABASE 02    EM0090
0093 C   99                SETON                     LRU7U8               EM0090
0094 C  N99      HOURS     MULT 60        WORK1   50                      EM0090
0094 C  N99      WORK1     MULT 60        WORK1                           EM0090
0094 C  N99                Z-ADDWORK1     WAITT                           EM0090
0094 C  N99      MINS      MULT 60        WORK1                           EM0090
0094 C  N99                ADD  WORK1     WAITT                           EM0090
0094 C  N99                ADD  SECS      WAITT                           EM0090
0095 C           TERM      TAG                                            EM0090
0096 O/EJECT                                                              EM0090
0097 O********************************************************************EM0090
**  CPY@
(c) Finastra International Limited 2001
