0001 H
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas EM Parents Limits/Exps/Avail Rep')               *
0002 F********************************************************************
0010 F*                                                                  *
     F*  Midas EXPOSURE MANAGEMENT MODULE
0004 F*                                                                  *
0005 F*    EM0610 - PARENTS LIMITS/EXPOSURE/AVAILABILITY REPORT          *
0004 F*                                                                  *
     F*  Function: This program produces a report showing up to date
     F*(COB ONREQ) limits, exposure and availability details for those
     F*            parents for whom limits have been specified and who
     F*            have children.
     F*
     F*            The report can be requested as a 'full' report which
     F*            shows all customers for whom limits have been
     F*            defined or as an 'exception' report which shows only
     F*            those customers who have exceeded one or more of
     F*            their limits.
     F*
     F*            If a 'full' report is selected, a total for those
     F*            customers without limits is printed at the end of
     F*            the report.
     F*
     F*            Each parent is processed in turn by reading through
     F*            the Parent/Customer file PACUS and the limits are
     F*            obtained from the Exposure Management limits file
     F*            EMLIM.
     F*
     F*            The Exposure Management COB file by Customer,EMDE4,
     F*            is then read, accumulating the exposure and
     F*            off-setting balances for each of the business areas
     F*            for each parent.
     F*
     F*            When all the records for a parent have been read,
     F*            the availability for each business area and overall
     F*            totals are calculated and the details printed.
     F*
     F*  Called By: EMC0803
     F*
     F*  Calls: None
     F*
0006 F*                                                                  *
      *  (c) Finastra International Limited 2001                      *
0008 F*                                                                  *
      *  Last Amend No. MD046248           Date 27Oct17               *
      *  Prev Amend No. MD030956           Date 09Oct14               *
      *                 CER059             Date 19Jul10               *
      *                 CER020             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD027             Date 09Dec05               *
      *                 CAAA03             Date 27Apr04               *
      * Midas Release 4.01.03 ----------------------------------------*
      * Midas Release 4.01 -------------------------------------------*
      *                 180028             Date 31Jul01               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.05 -----------------------------------------------*
      *                 173911             Date 20Jan00               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 CTI002             Date 16OCT98               *
     F*                  S01332         DATE 24APR91                     *
     F*                  E21179         DATE 11MAY90                     *
     F*                  S01196         DATE 18NOV89                     *
     F*                  S01117         DATE 25OCT89                     *
     F*                  E18414         DATE 21JUN89                     *
     F*                  E14725         DATE 07/03/89                    *
     F*                  S01129         DATE 21/11/87                    *
     F*                  E10331         DATE 21/08/87                    *
     F*                  S01128         DATE 20/02/87                    *
0011 F*                                                                  *
0013 F********************************************************************
     F*                                                                   CTI002
      *  MD046248 - Finastra Rebranding                               *
      *  MD030956 - Additional changes to BFM-TI enhancement          *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  CER020 - Enhanced Rollover Window: Upgrade FGE089 to            *
      *           Midas Plus                                             *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CAAA03 - Webfacing Changes. (recompile)                      *
     F*    180028 - Array Lim not initialised on change of parent thus   *
     F*             resulting in wrong ST-ISS being displayed/reported.  *
     F*    173911 - Some fields are misaligned in the 'Off-Setting       *
     F*             Balance' column.                                     *
     F*    CTI002 - TRADE INNOVATION INTERFACE PHASE II                  *CTI002
     F*    S01332 - Release 10 EM changes                                *S01332
     F*    E21179 - HAS BEEN PUT IN BY S01117                            *E21179
     F*             INCORRECT FIELD NAME USED FOR RECORD ID. TABTB95.    *E21179
0011 F*    S01196 - DROP LETTERS OF CREDIT MODULE                        *
     F*    S01117 - RELEASE 10 MULTIBRANCHING
     F*    E18414 - DELETED LIMITS SHOWN ON REPORT.                      *E18414
     F*    E14725 - AMOUNT FIELDS ON REPORT TO BE EDITED AS SIGNED.      *E14725
0012 F*    S01128 - CHNAGE 'TOTAL' TO 'OVERALL'                          *
     F*    S01128 - OUTPUT FX OFFSETTING BALANCE FIGURE                  *S01128
     F*    E10331 - 'LNCNT' SHOULD ONLY BE CALLED WHEN A PARENT WITH     *E10331
     F*             A LIMIT IS FOUND (INDICATOR 60 IS OFF).              *E10331
     F*    S01129 - REPORT SEQUENCE TO BE DETERMINED BY TABTB95          *S01129
0011 F*                                                                  *
0013 F********************************************************************
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
     F/COPY WNCPYSRC,EM0610F001
0014 FPACUS   IF  E           K        DISK
     F**** EMDE4   IF  F     128  6AI     4 DISK                          S01128
     F**** EMDE4   IF  F     152  6AI     4 DISK                   S01129 S01128
     F***EMDE4***IF**F     178  6AI     4 DISK                      S01129S01332
     F***EMDE4***IF**F     226  6AI     4 DISK                      S01332CTI002
     F***EMDE4** IF  F     250  6AI     4 DISK                                         CTI002 CER020
     FEMDE4   IF  F     253  6AI     4 DISK                                                   CER020
0016 F**** EMLIM   IF  F     128  7AI     2 DISK                          S01129
0016 F***EMLIM***IF**F     143  7AI     2 DISK                      S01129S01332
0021 F***EMLIM***IF**F     165  7AI     2 DISK                      S01332CTI002
0021 FEMLIM   IF  F     175  7AI     2 DISK                               CTI002
0017 F**** TABLE   IF  F      96 12AI     2 DISK                          S01129
     F***TABEM**   IF  F      96 12AI     2 DISK                                       S01129 CER020
0018 F***CLINT** IF  F     256  7AI     2 DISK                                                CER020
     FTABEM   IF  F      99 12AI     2 DISK                                                   CER020
     FCLINT   IF  F     264  7AI     2 DISK                                                   CER020
0019 F*M0610P1O***F     132            PRINTER                     S01124 S01117
0019 FEM0610P1O   F     132            PRINTER      KINFDS SPOOL      UC  S01117
0019 FEM0610AUO   F     132            PRINTER      KINFDS SPOOLU     UC  S01117
     FEMEXSCL1IF  E           K        DISK                               S01332
0020 F*
0021 F* ID F  C  H  L    FUNCTION OF INDICATORS
0022 F**
0023 F* 01            EMDE4 - FILE DETAIL RECORD.
0024 F* 02            EMLIM - DETAIL RECORD UNDELETED
0025 F* 03                  - DETAIL RECORD DELETED
0026 F* 05            TABLE - INSTALATION CONTROL RECORD 1.
0027 F* 06                  - INSTALATION CONTROL RECORD 2.
0028 F* 07                  - CURRENCIES RECORD 1.
0029 F* 08  N/A       PACUS - HEADER RECORD.
0030 F* 09  N/A             - DETAIL RECORD.
0031 F* 11            CLINT - CLIENT MASTER RECORD.
0032 F**
0033 F**
0034 F*       40             IF ON - NEGATIVE AVAILABILITY
0035 F*       41             IF ON - NO NEGATIVE AVAILABILITY
0029 F*       42             NO DETAILS TO REPORT                         S01117
0036 F*       50             IF ON - LAST CUST NO. ON PACUS
0037 F*       51             IF ON - 12 CUST NO'S ON PACUS READ
0038 F*       52             IF ON - ALL EMDEX RECORDS READ FOR CUST
0039 F*       60             IF ON - EMLIM CHAIN FAILED
0039 F*      N65             FIRST TIME THRU LNCNT WITH LRNU1N99          S01129
0039 F*       70             FIRST CYCLE INDICATOR
0077 F*       74             CHAINING INDICATOR                           S01332
0077 F*       77             PRINT EXCLUDED BUSINESS AREAS                S01332
     F*       84             ARRAY LOOKUP SUCCESSFUL                      S01332
     F*       85             ERROR ON ACCESS OBJECT CALL                  S01332
0040 F*       89             ** READ EMDEX INDICATOR
0041 F**
0042 F*       90-97   USED BY Z - SUBROUTINES.
0043 F*       98      DATE FORMAT MMDDYY IF ON.
0044 F*       99      Z -SUBROUTINES, ERROR FOUND.
0045 F*                     (DATABASE ERROR)
0046 F**
0047 F*          L1   IF ON - CHANGE IN PARENT NUMBER
0048 F*          LR   IF ON - PROCESS TOTALS AND TERMINATE PROG
0049 F*
0050 F**
0051 F*               EXTERNAL INDICATOR MEANINGS ON OUTPUT-
0052 F*          U1   IF ON - EXEPTION REPORT
0053 F*          U1   IF OFF- FULL REPORT                                 S01332
0053 F***********U2***IF*OFF-*FULL*REPORT****                             S01332
0054 F*          U7   SYSTEM ERROR, LOG FILE HEADER FOUND, WRONG STATUS.
0055 F*          U8   DATABASE ERROR, REQUIRED RECORDS NOT FOUND.
0056 F*               N.B. U6, U7 & U8 END THE PROGRAM AND CONDITION
0057 F*                    FOLLOWING OCL EXECUTION.
0058 F**
     E                    CPY@    1   1 80               COPYRIGHT STATEMENT
0059 E** REMOVED FOR S/38 CSN        12  6 0             CUST NO'S (PACUS)
0060 E***                 LIM         7 11 0             LIMITS ARRAY(NUM)S01129
0061 E***                 EXP         7 15 0             EXPOSURE ARRAY   S01129
0062 E***                 AVA         7 15 0             AVAILABILITY ARR S01129
0063 E***                 OSB         7 15 0             OFF-SET BAL ARR  S01129
0064 E***                 NLE         7 15 0             NO LIMIT EXP ARR S01129
0065 E***                 NLA         7 15 0             NO LIMIT AVA ARR S01129
0066 E***                 NLO         7 15 0             NO LIMIT OSB ARR S01129
0067 E***                 TTL         7 15 0             TOTAL LIMITS     S01129
0068 E***                 TTE         7 15 0             TOTAL EXPOSURE   S01129
0069 E***                 TTA         7 15 0             TOTAL AVAIL      S01129
0070 E***                 TTO         7 15 0             TOTAL OFF-SET BALS01129
0071 E                    ZYDY    4   4  4 0             ZDATE1/2 SR.ARRAY
0072 E                    ZMDY   13  13  3 0             ZDATE1/2 SR.ARRAY
0073 E                    ZMNM   12  12  3               ZDATE2 SR. ARRAY
0060 E**********          LIM         9 11 0             LIMITS ARRS01129 S01332
0061 E**********          EXP         9 15 0             EXPOSURE AS01129 S01332
0062 E**********          AVA         9 15 0             AVAILABILIS01129 S01332
0063 E**********          OSB         9 15 0             OFF-SET BAS01129 S01332
0064 E**********          NLE         9 15 0             NO LIMIT ES01129 S01332
0065 E**********          NLA         9 15 0             NO LIMIT AS01129 S01332
0066 E**********          NLO         9 15 0             NO LIMIT OS01129 S01332
0067 E**********          TTL         9 15 0             TOTAL LIMIS01129 S01332
0068 E**********          TTE         9 15 0             TOTAL EXPOS01129 S01332
0069 E**********          TTA         9 15 0             TOTAL AVAIS01129 S01332
0070 E**********          TTO         9 15 0             TOTAL OFF-S01129 S01332
     E**********          ATY     9   9  2               SEQUENCE TS01129 S01332
     E**********          ASQ         9  2 0             SEQUENCE NS01129 S01332
     E**********          WTY         9  2               TYPES IN SS01129 S01332
0060 E*************       LIM        11 11 0             LIMITS ARRS01332 CTI002
0061 E*************       EXP        11 15 0             EXPOSURE AS01332 CTI002
0062 E*************       AVA        11 15 0             AVAILABILIS01332 CTI002
0063 E*************       OSB        11 15 0             OFF-SET BAS01332 CTI002
0064 E*************       NLE        11 15 0             NO LIMIT ES01332 CTI002
0065 E*************       NLA        11 15 0             NO LIMIT AS01332 CTI002
0066 E*************       NLO        11 15 0             NO LIMIT OS01332 CTI002
0067 E*************       TTL        11 15 0             TOTAL LIMIS01332 CTI002
0068 E*************       TTE        11 15 0             TOTAL EXPOS01332 CTI002
0069 E*************       TTA        11 15 0             TOTAL AVAIS01332 CTI002
0070 E*************       TTO        11 15 0             TOTAL OFF-S01332 CTI002
     E*************       ATY    11  11  2               SEQUENCE TS01332 CTI002
     E*************       ASQ        11  2 0             SEQUENCE NS01332 CTI002
     E*************       WTY        11  2               TYPES IN SS01332 CTI002
0060 E                    LIM        12 11 0             LIMITS ARRAY(NUM)CTI002
0061 E                    EXP        12 15 0             EXPOSURE ARRAY   CTI002
0062 E                    AVA        12 15 0             AVAILABILITY ARR CTI002
0063 E                    OSB        12 15 0             OFF-SET BAL ARR  CTI002
0064 E                    NLE        12 15 0             NO LIMIT EXP ARR CTI002
0065 E                    NLA        12 15 0             NO LIMIT AVA ARR CTI002
0066 E                    NLO        12 15 0             NO LIMIT OSB ARR CTI002
0067 E                    TTL        12 15 0             TOTAL LIMITS     CTI002
0068 E                    TTE        12 15 0             TOTAL EXPOSURE   CTI002
0069 E                    TTA        12 15 0             TOTAL AVAIL      CTI002
0070 E                    TTO        12 15 0             TOTAL OFF-SET BALCTI002
     E                    ATY    12  12  2               SEQUENCE TYPE    CTI002
     E                    ASQ        12  2 0             SEQUENCE NUMBER  CTI002
     E                    WTY        12  2               TYPES IN SEQUENCECTI002
      *                                                                   S01332
      * Excluded business areas array for output                          S01332
     E                    EXC        65  1                                S01332
      * Compile time table of excluded areas text                         S01332
     E************        XCL     1  10  8                         S01332 CTI002
     E                    XCL     1  11  8                                CTI002
      * Business areas with no specified print sequence                   S01332
     E************        @SQ        11  2                         S01332 CTI002
     E                    @SQ        12  2                                CTI002
0074 E**
0075 L**
0076 L**   LINE COUNTER USED TO PREVENT DETAILS BEING PRINTED ACROSS PAGES
0077 L**
0078 L*PRINT   66FL 57OL
0079 I*
     I/COPY WNCPYSRC,EM0610I003
0080 I*    PARENT/CUSTOMER FILE - HEADER RECORD.
0081 I*
0082 I*ACUS   NS  08   1 CH
0083 I**********************************      1   1 RECI
0084 I**  EXTERNALY DEFINED FOR S/38   *      2   70CPAR
0085 I**                               *      8   90RECN
0086 I**  DUE TO DIFFERENT FILE FORMAT *     14  170NREC
0087 I**********************************     18  210NINS
0088 I*                                      22  250NDEL
0089 I*                                      26  290NAMD
0090 I*
0091 I*
0092 I*    PARENT/CUSTOMER FILE - DETAIL RECORD.
0093 I*
0094 I*ACUS   NS  09   1 CD
0095 I*                                       1   1 RECI
0096 I*                                       2   70CPAR  L1
0097 I*                                       8   90RECN
0098 I*                                      10  81 CSN
0099 I*                                   P  90  920LCD
0100 I*                                      93  93 CHTP
0101 I*                                   P  94  960TNLU
0102 I*
0103 I** CATCHALL
0104 I*       NS
0105 I*
0106 I*
0107 I*  EXPOSURE MANAGEMENT    EOD EXPOSURE FILE - DETAIL RECORD
0108 I*
0109 IEMDE4   NS  01   1 CD
0110 I                                        1   1 RECI
0111 I                                        2   3 MACO
0112 I**********                              4   90MCUN                                      CSD027
0112 I                                        4   9 MCUN                                      CSD027
0113 I                                       10  120EMIND
0114 I                                       13  14 MRGC
0115 I                                       15  16 MCNC
0116 I                                    P  17  240MFXE
0117 I                                    P  25  320MFXB
0118 I                                    P  33  400MMME
0119 I                                    P  41  480MMMB
     I                                    P  49  560MLEG                  S01128
     I                                    P  57  640MLEE                  S01128
     I                                    P  65  720MLEB                  S01128
     I                                    P  73  800MLAE                  S01128
     I                                    P  81  880MLAB                  S01128
     I                                    P  89  960MREG                  S01128
     I                                    P  97 1040MREE                  S01128
     I                                    P 105 1120MREB                  S01128
     I                                    P 113 1200MFRE                  S01332
     I                                    P 121 1280MFRO                  S01332
     I                                    P 153 1600MSIE                  S01129
     I                                    P 161 1680MSCE                  S01129
     I                                    P 169 1760MSPO                  S01129
     I****                                P  49  560MLEE                  S01128
     I****                                P  57  640MLEB                  S01128
     I****                                P  65  720MREE                  S01128
     I****                                P  73  800MREB                  S01128
     I                                    P 179 1860MIRE                  S01332
     I                                    P 187 1940MIRO                  S01332
     I                                    P 195 2020MFUE                  S01332
     I                                    P 203 2100MFUO                  S01332
     I                                    P 211 2180MOPE                  S01332
     I                                    P 219 2260MOPO                  S01332
     I                                    P 227 2340TFEX                  CTI002
     I                                    P 235 2420TFGR                  CTI002
     I                                    P 243 2500TFOF                  CTI002
     I                                      251 253 EMLOIC                                    CER020
0124 I*
0125 I** CATCHALL
0126 I        NS
0127 I*
0128 I*
0129 I*     EXPOSURE MANAGEMENT LIMITS FILE - DETAIL RECORD
0130 I*
0131 IEMLIM   NS  02   1 CD
0132 I       OR   03   1 C*
0133 I                                        1   1 RCID
0134 I                                        2   20RETP
0135 I                                        3   8 MLC
0136 I                                    P   9  110MXPD
0137 I                                       12  12 MPI
0138 I                                    P  13  180MOAL
0139 I                                    P  19  240MFXL
0140 I                                    P  25  300MMML
0141 I                                    P  31  360MLEL
0142 I                                    P  37  420MREL
0143 I*************                       P  43  480MBCL                  S01196
0144 I**********                          P  49  540MSTL                  S01332
0145 I**********                          P  55  600MFFL                  S01332
0146 I**********                          P  61  644MFXP                  S01332
0147 I**********                          P  65  684MMMP                  S01332
0148 I**********                          P  69  724MLEP                  S01332
0149 I**********                          P  73  764MREP                  S01332
0150 I*************                       P  77  804MLOP                  S01196
0151 I                                    P  81  860MSLI                  S01129
0152 I                                    P  87  904MSPI                  S01129
0153 I                                    P  91  960MSCL                  S01129
0257 I                                    P 105 1100MFRL                  S01332
0257 I                                    P 111 1160MIRL                  S01332
0257 I                                    P 117 1220MFUL                  S01332
0257 I                                    P 123 1280MOPL                  S01332
     I/COPY WNCPYSRC,EM0610I002
0257 I                                    P 166 1710TFLI                  CTI002
0151 I**********                          P  97 1004MSPC           S01129 S01332
0152 I**********                          P 101 1044MFFP           S01129 S01332
0153 I**********                          P 134 1360ORED           S01129 S01332
0154 I**********                          P 137 1390LCD            S01129 S01332
0155 I**********                            140 140 CHTP           S01129 S01332
0156 I**********                          P 141 1430TNLU           S01129 S01332
0151 I***                                 P  81  844MSEP                  S01129
0152 I***                                 P  85  884MFFP                  S01129
0153 I***                                 P 119 1210ORED                  S01129
0154 I***                                 P 122 1240LCD                   S01129
0155 I***                                   125 125 CHTP                  S01129
0156 I***                                 P 126 1280TNLU                  S01129
0157 I*
0158 I*
0159 I*
0160 I** CATCHALL
0161 I        NS
0162 I**
0163 I**   TABLE FILE - INSTALLATION CONTROL DATA RECORD 1.
0164 I**
0165 I***TABLE   NS  05          2 C0   3 C1                              S01129
0165 ITABEM   NS  05          2 C0   3 C1                                 S01129
0166 I       AND      12 C1  13 C0
0167 I                                        1   1 RECIX
0168 I                                       14  66 TITL
0169 I                                       67  67 DATF
0170 I                                    P  77  790RUND
0171 I                                       80  86 RUNA
0172 I**
0173 I**   TABLE FILE - INSTALLATION CONTROL DATA RECORD 2.
0174 I**
0175 I********NS**06          2 C0   3 C1                                 S01332
0176 I***    AND      12 C1  13 C1                                        S01129
0139 I*******AND***   12 C9  13 C5                                 S01129 S01332
0177 I****                                    1   1 RECIX                 S01129
0178 I****                                   69  71 LCCY                  S01129
     I**********                              1   1 RECI           S01129 S01332
     I**********                             14  16 LCCY           S01129 S01332
     I**********                             23  240MSFX           S01129 S01332
     I**********                             25  260MSMM           S01129 S01332
     I**********                             27  280MSIF           S01129 S01332
     I**********                             29  300MSLN           S01129 S01332
     I**********                             31  320MSRE           S01129 S01332
     I**********                             33  340MSLC           S01129 S01332
     I**********                             35  360MSSC           S01129 S01332
     I**********                             37  380MSSI           S01129 S01332
     I**********                             39  400MSSP           S01129 S01332
     I**********                             41  420MSFI           S01129 S01332
0179 I**
0180 I**   TABLE FILE - CURRENCIES RECORD 1.
0181 I**
0182 I        NS  07          2 C2   3 C0
0183 I       AND      13 C1
0184 I                                        1   1 RECIX
0185 I                                        2  13 ZTABKY
0186 I                                       10  12 CCY
0187 I                                       14  27 CCNM
0188 I**
0189 I**   CATCHALL.
0190 I        NS
0191 I**
0192 I**   CLIENT MASTER RECORD 1. - TO CHECK PARENT INDICATOR/EXISTANCE
0193 I**
0194 ICLINT   NS  11   1 CD
0195 I                                        1   1 CRECI
0196 I                                        2   8 CCLKEY
0197 I**********                              2   70CCNUM                                     CSD027
0197 I                                        2   7 CCNUM                                     CSD027
0198 I                                        8   8 CRCDT
0199 I                                        9  28 CCRNM
0200 I                                       29  38 CCTWN
0201 I                                      111 111 CCMIN
0202 I**
0203 I**   CATCHALL.
0204 I        NS
0208 ICLINTCBF
0205 I**
0206 I**   PACUS RECORD
0207 I**
0208 I            DS
0205 I**
     I*  DATA STRUCTURE FOR COMPILATION  - COPYRIGHT INSERTION
     ICPYR@#      DS
     I                                        1  80 CPY@
     I                                        1  20 CPY@##
     I**                                                                  S01117
     ISPOOLU      DS                                                      S01117
     I                                       83  90 SFILEU                S01117
     I                                    B 123 1240SFNUMU                S01117
     ISPOOL       DS                                                      S01117
     I                                       83  90 SFILE                 S01117
     I                                    B 123 1240SFNUM                 S01117
     I                                    B 188 1890OFLOW                 S01332
     I                                    B 367 3680CURLIN                S01332
     I**                                                                  S01117
0206 I**   DATA STRUCTURE FOR CLINT KEY - CCLKEY
0207 I**
0209 I                                        1   7 CCLKEY
0210 I**********                              1   60CCNUM                                     CSD027
0210 I                                        1   6 CCNUM                                     CSD027
0211 I                                        7   7 CRCDT
0212 I**
0213 I**   DATA STRUCTURE FOR TABLE KEY - ZTABKY
0214 I**
0215 I            DS
0216 I                                        1  12 ZTABKY
0217 I                                        9  11 CCY
0218 I                                       11  12 CCOD
0219 I                                       11  12 REGC
0220 I**********                             10  120LIND                                      CER020
     I                                       10  12 LOIC                                      CER020
0221 I**
0222 I**   DATA STRUCTURE FOR LIMIT ARRAY (LIM)
0223 I**
0224 I            DS
0225 I***                                     1  77 LIM                   S01129
0225 I**********                              1  99 LIM            S01129 S01332
0225 I************                            1 121 LIM            S01332 CTI002
0225 I                                        1 132 LIM                   CTI002
0226 I                                        1  110MFXL
0227 I                                       12  220MMML
0228 I                                       23  330MLEL
0229 I                                       34  440MREL
0230 I*************                          45  550MBCL                  S01196
0456 I                                       45  550MFRL                  S01332
     I                                       56  660MSCL                  S01129
     I                                       67  770MSLI                  S01129
     I**********                             89  990MFFL           S01129 S01332
0231 I**                                     56  660MSTL                  S01129
0232 I**                                     67  770MFFL                  S01129
0456 I                                       89  990MIRL                  S01332
0456 I                                      100 1100MFUL                  S01332
0456 I                                      111 1210MOPL                  S01332
0456 I                                      122 1320TFLI                  CTI002
0233 I**  LOCAL DATA AREA FOR DATABASE RECORD
0234 ILDA        UDS                            256
0235 I**********                            134 138 DBFILE                S01117
0236 I**********                            139 167 DBKEY                 S01117
0237 I**********                            168 175 DBPGM                 S01117
0238 I**********                            176 1770DBASE                 S01117
     I                                      134 141 DBFILE                S01117
     I                                      142 170 DBKEY                 S01117
     I                                      171 180 DBPGM                 S01117
     I                                      181 1830DBASE                 S01117
     ISDMMOD    E DSSDMMODPD                                              S01332
     I* External DS for Module Details                                    S01332
     ISDEXPM    E DSSDEXPMPD                                              S01332
     I* External DS for Exposure Management details                       S01332
     ISCSARD    E DSSCSARDPD                                              CTI002
     I* External DS for Switchable feature                                CTI002
     IDSFDY     E DSDSFDY                                                 S01332
     I* DS used by Access Objects (short records)                         S01332
0239 I**
     I/COPY WNCPYSRC,EM0610I001
0240 C/EJECT
0241 C********************************************************************
     C                     MOVEACPY@      BIS@   80
     C           *NAMVAR   DEFN           LDA                             S01117
     C**                                                                  S01117
     C           *ENTRY    PLIST                                          S01117
     C                     PARM           SEQ     5         SEQUENCE NUM. S01117
     C                     PARM           SENTY   3         BRANCH OR ALL S01117
     C*
0242 C**
0243 C**   FIRST CYCLE PROCESSING
0244 C**
0245 C   70                GOTO ENDFC
0253 C                     SETON                     70
0246 C                     Z-ADD0         RECCNT  30       EXE REP REC CNT
     C                     Z-ADD*ZEROS    LIM                             S01129
     C/COPY WNCPYSRC,EM0610C023
0247 C*    ACCESS ICR1
0248 C                     EXSR ZSYSTM
0249 C   99                MOVE 'TABLE'   DBFILE
0250 C   99                MOVE ZTABKY    DBKEY
0251 C   99                MOVE 'EM0610'  DBPGM
0252 C   99                Z-ADD01        DBASE            DATABASE 01
     C   99                OPEN EM0610AU                                  S01117
     C***99*******         EXCPTHEADER                                    S01117
0253 C   99                SETON                     LRU7U8
0254 C   99                GOTO TERM
0255 C*    ACCESS RUN DATE AND TITLE
0256 C                     MOVE RUNA      RUNDAT  7
0257 C                     MOVE RUND      RUNDAY  50
0258 C                     MOVE TITL      TITLE  53
0259 C*****ACCESS*EM*CURRENCY*ON*ICR2***                                  S01332
0260 C**********                                                          S01332
0261 C*****SET*UP*KEY*FOR*INSTALLATION*CONTROL*RECORD*2**                 S01332
0262 C**********           MOVEL'01      'ZTABKY 12                       S01332
0263 C****                 MOVE '  11'    ZTABKY                          S01129
     C**********           MOVE '  95'    ZTABKY                   S01129 S01332
0264 C**
0265 C****       ZTABKY    CHAINTABLE                99    ON NOT THERE   S01129
0265 C********** ZTABKY    CHAINTABEM                99    ON NOT TS01129 S01332
0266 C**
0267 C**N99******RECIX     COMP 'D'                  9999  ON - DELETED   S01117
0267 C**N99***** RECI      COMP 'D'                  9999  ON - DELS01117 S01332
0268 C***99*****           MOVE 'TABLE'   DBFILE                          S01332
0269 C***99*****           MOVE ZTABKY    DBKEY                           S01332
0270 C***99*****           MOVE 'EM0610'  DBPGM                           S01332
0271 C***99*****           Z-ADD02        DBASE            DATABASE 02    S01332
     C***99*****           OPEN EM0610AU                           S01117 S01332
     C***99*******         EXCPTHEADER                                    S01117
0272 C***99*****           SETON                     LRU7U8               S01332
0273 C***99*****           GOTO TERM                                      S01332
      *                                                                   S01332
      * Call Access Object to get Exposure Management details             S01332
     C                     CALL 'AOEXPMR0'             85                 S01332
     C                     PARM *BLANKS   @RTCD   7                       S01332
     C                     PARM '*FIRST ' @OPTN   7                       S01332
     C           SDEXPM    PARM SDEXPM    DSFDY                           S01332
      *                                                                   S01332
     C           @RTCD     IFNE *BLANKS                                   S01332
     C           *IN85     OREQ '1'                        ***************S01332
     C                     MOVE 'SDEXPMPD'DBFILE           *   DB ERROR  *S01332
     C                     MOVE '*FIRST'  DBKEY            *     02      *S01332
     C                     MOVE 'EM0610'  DBPGM            ***************S01332
     C                     OPEN EM0610AU                                  S01332
     C                     Z-ADD02        DBASE                           S01332
     C                     SETON                     LRU7U8               S01332
     C                     SETON                     99                   S01332
     C                     GOTO TERM                       ** GOTO TERM **S01332
     C                     END                                            S01332
      *                                                                   S01332
      * Get module information via access object                          S01332
     C                     CALL 'AOMMODR0'             85                 S01332
     C                     PARM *BLANKS   @RTCD   7                       S01332
     C                     PARM '*FIRST ' @OPTN   7                       S01332
     C           SDMMOD    PARM SDMMOD    DSFDY                           S01332
      *                                                                   S01332
     C           @RTCD     IFNE *BLANKS                                   S01332
     C           *IN85     OREQ '1'                        ***************S01332
     C                     MOVE 'SDMMODPD'DBFILE           *   DB ERROR  *S01332
     C                     MOVE '*FIRST'  DBKEY            *     05      *S01332
     C                     MOVE 'EM0610'  DBPGM            ***************S01332
     C                     Z-ADD05        DBASE                           S01332
     C                     OPEN EM0610AU                           S01117 S01332
     C                     SETON                     LRU7U8               S01332
     C                     SETON                     99                   S01332
     C                     GOTO TERM                       ** GOTO TERM **S01332
     C                     END                                            S01332
      *                                                                   CTI002
      ** Access SAR details file to determine if CTI002 is switched ON    CTI002
      *                                                                   CTI002
     C                     MOVE *BLANKS   CTI002  1                       CTI002
      *                                                                   CTI002
     C                     CALL 'AOSARDR0'                                CTI002
     C                     PARM *BLANKS   @RTCD   7                       CTI002
     C                     PARM '*VERIFY' @OPTN   7                       CTI002
     C                     PARM 'CTI002'  @SARD   6                       CTI002
     C           SCSARD    PARM SCSARD    DSFDY                           CTI002
      *                                                                   CTI002
      ** If core feature is switched ON, set a variable field to          CTI002
      ** condition the rest of the processing                             CTI002
      *                                                                   CTI002
     C           @RTCD     IFEQ *BLANKS                                   CTI002
     C                     MOVE 'Y'       CTI002                          CTI002
     C                     ELSE                                           CTI002
      *                                                                   CTI002
      ** else, database error (return code other than *NRF)               CTI002
      *                                                                   CTI002
     C           @RTCD     IFNE '*NRF   '                                 CTI002
     C                     MOVE 'SCSARDPD'DBFILE           ***************CTI002
     C                     MOVE '*VERIFY' DBKEY            *   DB ERROR  *CTI002
     C                     MOVE 'EM0610'  DBPGM            *     06      *CTI002
     C                     Z-ADD06        DBASE            ***************CTI002
     C                     OPEN EM0610AU                                  CTI002
     C                     SETON                     LRU7U8               CTI002
     C                     GOTO TERM                                      CTI002
     C                     ENDIF                                          CTI002
      *                                                                   CTI002
     C                     ENDIF                                          CTI002
      *                                                                   CTI002
      ** Check if CTI007 BFM-TI Exposure Management is enabled                              MD030956
      *                                                                                     MD030956
     C                     MOVE *BLANKS   CTI007  1                                         MD030956
      *                                                                                     MD030956
     C                     CALL 'AOSARDR0'                                                  MD030956
     C                     PARM *BLANKS   @RTCD                                             MD030956
     C                     PARM '*VERIFY' @OPTN                                             MD030956
     C                     PARM 'CTI007'  @SARD                                             MD030956
     C           SCSARD    PARM SCSARD    DSFDY                                             MD030956
      *                                                                                     MD030956
     C           @RTCD     IFEQ *BLANKS                                                     MD030956
     C                     MOVE 'Y'       CTI007                                            MD030956
     C                     ELSE                                                             MD030956
     C           @RTCD     IFNE '*NRF   '                                                   MD030956
     C                     MOVE 'SCSARDPD'DBFILE                                            MD030956
     C                     MOVE '*VERIFY' DBKEY                                             MD030956
     C                     MOVE 'EM0610'  DBPGM                                             MD030956
     C                     Z-ADD07        DBASE                                             MD030956
     C                     OPEN EM0610AU                                                    MD030956
     C                     SETON                     LRU7U8                                 MD030956
     C                     GOTO TERM                                                        MD030956
     C                     ENDIF                                                            MD030956
     C                     ENDIF                                                            MD030956
     C*                                                                   S01129
      * Set up array of print sequence reqd.                              S01332
      * ALSO                                                              S01332
      * Set up work total of detail lines for each set of details         S01332
      * (used to ensure correct page breaking) by checking which          S01332
      * modules are switched on                                           S01332
     C                     Z-ADD0         @DETL   20                      S01332
     C*                                                                   S01129
     C                     Z-ADD*ZEROS    ASQ                             S01129
     C**********           Z-ADDMSFX      ASQ,1                    S01129 S01332
     C**********           Z-ADDMSMM      ASQ,2                    S01129 S01332
     C**********           Z-ADDMSLN      ASQ,3                    S01129 S01332
     C**********           Z-ADDMSRE      ASQ,4                    S01129 S01332
     C**********           Z-ADDMSLC      ASQ,5                    S01129 S01332
     C**********           Z-ADDMSSC      ASQ,6                    S01129 S01332
     C**********           Z-ADDMSSI      ASQ,7                    S01129 S01332
     C**********           Z-ADDMSSP      ASQ,8                    S01129 S01332
     C**********           Z-ADDMSFI      ASQ,9                    S01129 S01332
      *                                                                   S01332
      * A business area cannot be printed if the module is off            S01332
      * If print sequence is zero but module is on, write to              S01332
      * seperate array @SQ - these will be tagged on to the end           S01332
      * of ASQ i.e. output last                                           S01332
     C           BGDLFX    IFEQ 'Y'                        BEG FX         S01332
     C           BUMSFX    IFNE *ZEROS                                    S01332
     C                     Z-ADDBUMSFX    ASQ,1                           S01332
     C                     ELSE                                           S01332
     C                     MOVE 'FX'      @SQ,1                           S01332
     C                     END                                            S01332
     C                     ADD  1         @DETL                           S01332
     C                     END                             END FX         S01332
     C*                                                                   S01332
     C           BGDLMM    IFEQ 'Y'                        BEG MM         S01332
     C           BUMSMM    IFNE *ZEROS                                    S01332
     C                     Z-ADDBUMSMM    ASQ,2                           S01332
     C                     ELSE                                           S01332
     C                     MOVE 'MM'      @SQ,2                           S01332
     C                     END                                            S01332
     C                     ADD  1         @DETL                           S01332
     C                     END                             END MM         S01332
     C*                                                                   S01332
     C           BGCSLN    IFEQ 'Y'                        BEG LE         S01332
     C           BUMSLN    IFNE *ZEROS                                    S01332
     C                     Z-ADDBUMSLN    ASQ,3                           S01332
     C                     ELSE                                           S01332
     C                     MOVE 'LN'      @SQ,3                           S01332
     C                     END                                            S01332
     C                     ADD  1         @DETL                           S01332
     C                     END                             END LE         S01332
     C*                                                                   S01332
     C           BGRTBN    IFEQ 'Y'                        BEG RE         S01332
     C           BUMSRT    IFNE *ZEROS                                    S01332
     C                     Z-ADDBUMSRT    ASQ,4                           S01332
     C                     ELSE                                           S01332
     C                     MOVE 'RE'      @SQ,4                           S01332
     C                     END                                            S01332
     C                     ADD  1         @DETL                           S01332
     C                     END                             END RE         S01332
     C*                                                                   S01332
     C           BGFIIN    IFEQ 'Y'                        BEG FRA/IRS    S01332
     C           BUMSFR    IFNE *ZEROS                                    S01332
     C                     Z-ADDBUMSFR    ASQ,5                           S01332
     C                     ELSE                                           S01332
     C                     MOVE 'FR'      @SQ,5                           S01332
     C                     END                                            S01332
     C           BUMSIR    IFNE *ZEROS                                    S01332
     C                     Z-ADDBUMSIR    ASQ,11                          S01332
     C                     ELSE                                           S01332
     C                     MOVE 'IR'      @SQ,11                          S01332
     C                     END                                            S01332
     C                     ADD  2         @DETL                           S01332
     C                     END                             END FRA/IRS    S01332
     C*                                                                   S01332
     C           BGSECS    IFEQ 'Y'                        BEG SECS       S01332
     C           BUMSSC    IFNE *ZEROS                                    S01332
     C                     Z-ADDBUMSSC    ASQ,6                           S01332
     C                     ELSE                                           S01332
     C                     MOVE 'SC'      @SQ,6                           S01332
     C                     END                                            S01332
     C           BUMSSI    IFNE *ZEROS                                    S01332
     C                     Z-ADDBUMSSI    ASQ,7                           S01332
     C                     ELSE                                           S01332
     C                     MOVE 'SI'      @SQ,7                           S01332
     C                     END                                            S01332
     C           BUMSSP    IFNE *ZEROS                                    S01332
     C                     Z-ADDBUMSSP    ASQ,8                           S01332
     C                     ELSE                                           S01332
     C                     MOVE 'SP'      @SQ,8                           S01332
     C                     END                                            S01332
     C                     ADD  3         @DETL                           S01332
     C                     END                             END SECS       S01332
     C*                                                                   S01332
     C           BGFUOP    IFEQ 'Y'                        BEG FUT/OPT    S01332
     C           BUMSFU    IFNE *ZEROS                                    S01332
     C                     Z-ADDBUMSFU    ASQ,9                           S01332
     C                     ELSE                                           S01332
     C                     MOVE 'FU'      @SQ,9                           S01332
     C                     END                                            S01332
     C           BUMSOP    IFNE *ZEROS                                    S01332
     C                     Z-ADDBUMSOP    ASQ,10                          S01332
     C                     ELSE                                           S01332
     C                     MOVE 'OP'      @SQ,10                          S01332
     C                     END                                            S01332
     C                     ADD  2         @DETL                           S01332
     C                     END                             END FUT/OPT    S01332
      *                                                                   CTI002
     C           CTI002    IFEQ 'Y'                        BEG TF         CTI002
     C           CTI007    OREQ 'Y'                                                         MD030956
     C           BUMSTF    IFNE *ZEROS                                    CTI002
     C                     Z-ADDBUMSTF    ASQ,12                          CTI002
     C                     ELSE                                           CTI002
     C                     MOVE 'TF'      @SQ,12                          CTI002
     C                     END                                            CTI002
     C                     ADD  1         @DETL                           CTI002
     C                     END                             END TF         CTI002
     C*                                                                   S01129
     C**********           Z-ADD*ZEROS    Z       20               S01129 S01332
     C                     Z-ADD1         X       20                      S01332
     C**********           XFOOTASQ       TOTASQ  30               S01129 S01332
     C*                                                                   S01129
     C*   ARRANGE TYPES INTO CORRECT SEQUENCE                             S01129
      *                                                                   S01332
     C                     Z-ADD0         CT      20                      S01332
     C********** X         DOWLT12                             B1  S01332 CTI002
     C           X         DOWLE12                             B1         CTI002
     C                     Z-ADD1         Y       20                      S01332
      *                                                                   S01332
      * Look for value of X in type order array                           S01332
     C           X         LOKUPASQ,Y                    84               S01332
      *                                                                   S01332
      * If lookup successful, move module ID from table into sequenced    S01332
      * array                                                             S01332
     C           *IN84     IFEQ '1'                            B2         S01332
     C                     ADD  1         CT                              S01332
     C                     MOVE ATY,Y     WTY,CT                          S01332
     C                     END                                 E2         S01332
      *                                                                   S01332
     C                     ADD  1         X                               S01332
     C                     END                                 E1         S01332
      *                                                                   S01332
      * After sequenced array has been set up add non-sequenced           S01332
      * business areas to end of this array                               S01332
     C                     Z-ADD1         X                               S01332
     C*********  X         DOWLT12                                 S01332 CTI002
     C           X         DOWLE12                                        CTI002
     C           @SQ,X     IFNE *BLANKS                                   S01332
     C                     ADD  1         CT                              S01332
     C                     MOVE @SQ,X     WTY,CT                          S01332
     C                     END                                            S01332
     C                     ADD  1         X                               S01332
     C                     END                                            S01332
      *                                                                   S01332
     C********** TOTASQ    DOWGT*ZEROS                             S01129 S01332
     C**********                                                   S01129 S01332
     C**********           ADD  1         Z                        S01129 S01332
     C**********           Z-ADD*ZEROS    X       20               S01129 S01332
     C**********           Z-ADD*HIVAL    WSQ                      S01129 S01332
     C**********                                                   S01129 S01332
     C********** X         DOWLT9                                  S01129 S01332
     C**********           ADD  1         X                        S01129 S01332
     C**********                                                   S01129 S01332
     C********** ASQ,X     IFLT WSQ                                S01129 S01332
     C********** ASQ,X     ANDNE*ZEROS                             S01129 S01332
     C**********                                                   S01129 S01332
     C**********           MOVE ATY,X     WTY,Z                    S01129 S01332
     C**********           Z-ADDASQ,X     WSQ     20               S01129 S01332
     C**********           Z-ADDX         W       20               S01129 S01332
     C**********                                                   S01129 S01332
     C**********           END                                     S01129 S01332
     C**********                                                   S01129 S01332
     C**********           END                                     S01129 S01332
     C**********                                                   S01129 S01332
     C**********           Z-ADD*ZEROS    ASQ,W                    S01129 S01332
     C**********           ADD  1         WTYCNT  20               S01129 S01332
     C**********           XFOOTASQ       TOTASQ                   S01129 S01332
     C**********                                                   S01129 S01332
     C**********           END                                     S01129 S01332
     C**********                                                   S01129 S01332
     C********** WTYCNT    IFLE 4                                  S01129 S01332
     C**********           Z-ADD4         WBLNO   10               S01129 S01332
     C**********           ELSE                                    S01129 S01332
     C**********           Z-ADD3         WBLNO                    S01129 S01332
     C**********           END                                     S01129 S01332
     C*                                                                   S01129
0524 C*
0274 C**   SET UP KEY FOR INSTALLATION CONTROL RECORD(CURRENCY REC 1)
0275 C**********           MOVE LCCY      CCY                             S01332
0526 C                     MOVE BUCYCD    CCY                             S01332
0276 C                     MOVEL'20      'ZTABKY 12
0277 C                     MOVE '1'       ZTABKY
0278 C**
0279 C****       ZTABKY    CHAINTABLE                99    ON NOT THERE   S01129
0279 C           ZTABKY    CHAINTABEM                99    ON NOT THERE   S01129
0280 C  N99      RECIX     COMP 'D'                  9999  ON - DELETED
0281 C   99                MOVE 'TABLE'   DBFILE
0282 C   99                MOVE ZTABKY    DBKEY
0283 C   99                MOVE 'EM0610'  DBPGM
0284 C   99                Z-ADD03        DBASE            DATABASE 03
     C   99                OPEN EM0610AU                                  S01117
     C***99*******         EXCPTHEADER                                    S01117
0285 C   99                SETON                     LRU7U8
0286 C   99                GOTO TERM
0287 C                     MOVE CCNM      CURRNM 14
0288 C                     MOVE *BLANKS   ZTABKY
     C                     OPEN EM0610P1                                  S01117
     C  N99                EXCPTHEADER
      *                                                                   S01332
      * Access the Exposure Management scaling file to determine          S01332
      * which business areas to include in report totals                  S01332
      * Set up excluded areas array for report output                     S01332
      * (No need to check modules which are not on system, avoids         S01332
      * unnecessary chains)                                               S01332
     C                     MOVE '0'       *IN74                           S01332
     C                     Z-ADD1         X                               S01332
     C                     Z-ADD0         NEXC    20                      S01332
      * FX                                                                S01332
     C           BGDLFX    IFEQ 'Y'                                       S01332
     C           'FX'      CHAINEMEXSCL1             74                   S01332
     C           *IN74     IFNE '1'                                       S01332
     C           EKINTO    ANDNE'Y'                                       S01332
     C                     MOVEAXCL,1     EXC,X                           S01332
     C                     ADD  3         X                 EXCLUDE       S01332
     C                     MOVE *BLANKS   EXC,X                           S01332
     C                     ADD  1         X                               S01332
     C                     ADD  1         NEXC                            S01332
     C                     MOVE 'N'       @FX     1                       S01332
     C                     ELSE                                           S01332
     C                     MOVE 'Y'       @FX               INCLUDE       S01332
     C                     MOVE '0'       *IN74                           S01332
     C                     END                                            S01332
     C                     END                                            S01332
      * MM                                                                S01332
     C           BGDLMM    IFEQ 'Y'                                       S01332
     C           'MM'      CHAINEMEXSCL1             74                   S01332
     C           *IN74     IFNE '1'                                       S01332
     C           EKINTO    ANDNE'Y'                                       S01332
     C                     MOVEAXCL,2     EXC,X                           S01332
     C                     ADD  3         X                 EXCLUDE       S01332
     C                     MOVE *BLANKS   EXC,X                           S01332
     C                     ADD  1         X                               S01332
     C                     ADD  1         NEXC                            S01332
     C                     MOVE 'N'       @MM     1                       S01332
     C                     ELSE                                           S01332
     C                     MOVE 'Y'       @MM               INCLUDE       S01332
     C                     MOVE '0'       *IN74                           S01332
     C                     END                                            S01332
     C                     END                                            S01332
      * LE                                                                S01332
     C           BGCSLN    IFEQ 'Y'                                       S01332
     C           'LE'      CHAINEMEXSCL1             74                   S01332
     C           *IN74     IFNE '1'                                       S01332
     C           EKINTO    ANDNE'Y'                                       S01332
     C                     MOVEAXCL,3     EXC,X                           S01332
     C                     ADD  6         X                 EXCLUDE       S01332
     C                     MOVE *BLANKS   EXC,X                           S01332
     C                     ADD  1         X                               S01332
     C                     ADD  1         NEXC                            S01332
     C                     MOVE 'N'       @LE     1                       S01332
     C                     ELSE                                           S01332
     C                     MOVE 'Y'       @LE               INCLUDE       S01332
     C                     MOVE '0'       *IN74                           S01332
     C                     END                                            S01332
     C                     END                                            S01332
      * FRA/IRS                                                           S01332
     C           BGFIIN    IFEQ 'Y'                                       S01332
      *                                                                   S01332
     C           'FR'      CHAINEMEXSCL1             74                   S01332
     C           *IN74     IFNE '1'                                       S01332
     C           EKINTO    ANDNE'Y'                                       S01332
     C                     MOVEAXCL,4     EXC,X                           S01332
     C                     ADD  4         X                 EXCLUDE       S01332
     C                     MOVE *BLANKS   EXC,X                           S01332
     C                     ADD  1         X                               S01332
     C                     ADD  1         NEXC                            S01332
     C                     MOVE 'N'       @FR     1                       S01332
     C                     ELSE                                           S01332
     C                     MOVE 'Y'       @FR               INCLUDE       S01332
     C                     MOVE '0'       *IN74                           S01332
     C                     END                                            S01332
      *                                                                   S01332
     C           'IR'      CHAINEMEXSCL1             74                   S01332
     C           *IN74     IFNE '1'                                       S01332
     C           EKINTO    ANDNE'Y'                                       S01332
     C                     MOVEAXCL,5     EXC,X                           S01332
     C                     ADD  4         X                 EXCLUDE       S01332
     C                     MOVE *BLANKS   EXC,X                           S01332
     C                     ADD  1         X                               S01332
     C                     ADD  1         NEXC                            S01332
     C                     MOVE 'N'       @IR     1                       S01332
     C                     ELSE                                           S01332
     C                     MOVE 'Y'       @IR               INCLUDE       S01332
     C                     MOVE '0'       *IN74                           S01332
     C                     END                                            S01332
      *                                                                   S01332
     C                     END                                            S01332
      * FUTURES+OPTIONS                                                   S01332
     C           BGFUOP    IFEQ 'Y'                                       S01332
      *                                                                   S01332
     C           'FU'      CHAINEMEXSCL1             74                   S01332
     C           *IN74     IFNE '1'                                       S01332
     C           EKINTO    ANDNE'Y'                                       S01332
     C                     MOVEAXCL,6     EXC,X                           S01332
     C                     ADD  8         X                 EXCLUDE       S01332
     C                     MOVE *BLANKS   EXC,X                           S01332
     C                     ADD  1         X                               S01332
     C                     ADD  1         NEXC                            S01332
     C                     MOVE 'N'       @FU     1                       S01332
     C                     ELSE                                           S01332
     C                     MOVE 'Y'       @FU               INCLUDE       S01332
     C                     MOVE '0'       *IN74                           S01332
     C                     END                                            S01332
      *                                                                   S01332
     C           'OP'      CHAINEMEXSCL1             74                   S01332
     C           *IN74     IFNE '1'                                       S01332
     C           EKINTO    ANDNE'Y'                                       S01332
     C                     MOVEAXCL,7     EXC,X                           S01332
     C                     ADD  8         X                 EXCLUDE       S01332
     C                     MOVE *BLANKS   EXC,X                           S01332
     C                     ADD  1         X                               S01332
     C                     ADD  1         NEXC                            S01332
     C                     MOVE 'N'       @OP     1                       S01332
     C                     ELSE                                           S01332
     C                     MOVE 'Y'       @OP               INCLUDE       S01332
     C                     MOVE '0'       *IN74                           S01332
     C                     END                                            S01332
      *                                                                   S01332
     C                     END                                            S01332
      * SECURITIES                                                        S01332
     C           BGSECS    IFEQ 'Y'                                       S01332
      * SE C/PARTY                                                        S01332
     C           'CP'      CHAINEMEXSCL1             74                   S01332
     C           *IN74     IFNE '1'                                       S01332
     C           EKINTO    ANDNE'Y'                                       S01332
     C                     MOVEAXCL,8     EXC,X                           S01332
     C                     ADD  7         X                 EXCLUDE       S01332
     C                     MOVE *BLANKS   EXC,X                           S01332
     C                     ADD  1         X                               S01332
     C                     ADD  1         NEXC                            S01332
     C                     MOVE 'N'       @CP     1                       S01332
     C                     ELSE                                           S01332
     C                     MOVE 'Y'       @CP               INCLUDE       S01332
     C                     MOVE '0'       *IN74                           S01332
     C                     END                                            S01332
      * SE ISSUER                                                         S01332
     C           'IS'      CHAINEMEXSCL1             74                   S01332
     C           *IN74     IFNE '1'                                       S01332
     C           EKINTO    ANDNE'Y'                                       S01332
     C                     MOVEAXCL,9     EXC,X                           S01332
     C                     ADD  7         X                 EXCLUDE       S01332
     C                     MOVE *BLANKS   EXC,X                           S01332
     C                     ADD  1         X                               S01332
     C                     ADD  1         NEXC                            S01332
     C                     MOVE 'N'       @IS     1                       S01332
     C                     ELSE                                           S01332
     C                     MOVE 'Y'       @IS               INCLUDE       S01332
     C                     MOVE '0'       *IN74                           S01332
     C                     END                                            S01332
      *                                                                   S01332
     C                     END                                            S01332
      * RETAIL                                                            S01332
     C           BGRTBN    IFEQ 'Y'                                       S01332
     C           'RE'      CHAINEMEXSCL1             74                   S01332
     C           *IN74     IFNE '1'                                       S01332
     C           EKINTO    ANDNE'Y'                                       S01332
     C                     MOVEAXCL,10    EXC,X                           S01332
     C                     ADD  8         X                               S01332
     C                     ADD  1         NEXC                            S01332
     C                     MOVE 'N'       @RE     1         EXCLUDE       S01332
     C                     ELSE                                           S01332
     C                     MOVE 'Y'       @RE               INCLUDE       S01332
     C                     MOVE '0'       *IN74                           S01332
     C                     END                                            S01332
     C                     END                                            S01332
      * TF                                                                CTI002
     C           CTI002    IFEQ 'Y'                                       CTI002
     C           CTI007    OREQ 'Y'                                                         MD030956
     C           'TF'      CHAINEMEXSCL1             74                   CTI002
     C           *IN74     IFNE '1'                                       CTI002
     C           EKINTO    ANDNE'Y'                                       CTI002
     C                     MOVEAXCL,11    EXC,X                           CTI002
     C                     ADD  9         X                 EXCLUDE       CTI002
     C                     MOVE *BLANKS   EXC,X                           CTI002
     C                     ADD  1         X                               CTI002
     C                     ADD  1         NEXC                            CTI002
     C                     MOVE 'N'       @TF     1                       CTI002
     C                     ELSE                                           CTI002
     C                     MOVE 'Y'       @TF               INCLUDE       CTI002
     C                     MOVE '0'       *IN74                           CTI002
     C                     END                                            CTI002
     C                     END                                            CTI002
      *                                                                   S01332
      *                                                                   S01332
      * If entry in array but not full, delete last comma and             S01332
      * ensure rest of array is blanks                                    S01332
     C           NEXC      IFGE 1                                         S01332
     C           NEXC      ANDLT11                                        CTI002
     C********** NEXC      ANDLT10                                 S01332 CTI002
     C                     SUB  2         X                               S01332
     C                     MOVEA*BLANKS   EXC,X                           S01332
     C                     END                                            S01332
      *                                                                   S01332
      * If there are business areas to exclude set on output indicator    S01332
      * Add correct no. of lines to @DETL so the correct detail lines     S01332
      * per record is allowed for in page breaking                        S01332
     C           NEXC      IFGE 1                                         S01332
     C                     MOVE '1'       *IN77                           S01332
     C                     ADD  7         @DETL                           S01332
     C                     ELSE                                           S01332
     C                     ADD  5         @DETL                           S01332
     C                     END                                            S01332
     C/COPY WNCPYSRC,EM0610C024
     C**
     C** READ FIRST PACUS RECORD
     C                     READ PACUS                    LR
     C   LR                GOTO TERM
0289 C**
0290 C**   END OF FIRST CYCLE PROCESSING
0291 C**
0292 C           ENDFC     TAG                             ** ENDFC TAG
0293 C********************************************************************
0294 C/EJECT
0295 C********************************************************************
0296 C**   START OF MAIN CYCLE TO PROCESS EXPOSURES BY PARENT
0297 C**
0298 C**   BYPASS ON HEADER RECORD
0299 C**
0300 C**N09****************GOTO TERM***********************
0301 C  NU1                EXSR FULREP                      FULL REPORT
0302 C   U1                EXSR EXEREP                      EXEPT REPORT
0388 C           RECCNT    IFEQ 0                                         S01117
     C                     SETON                     42                   S01117
     C                     END                                            S01117
0303 C           TERM      TAG                             ** TAG TERM
     C                     Z-ADDSFNUM     SFNUM1  60                      S01117
     C                     OUT  LDA                                       S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ                             S01117
     C                     PARM           SENTY   3                       S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           SFNUM1                          S01117
     C                     PARM *BLANKS   ZSERR   1                       S01117
     C           *LOCK     IN   LDA                                       S01117
     C*                                                                   S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
     C*                                                                   S01117
     C* ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAMME       S01117
     C*                                                                   S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C           *IN99     IFEQ '1'                                       S01117
     C           *INU7     ANDEQ'1'                                       S01117
     C           *INU8     ANDEQ'1'                                       S01117
     C                     Z-ADDSFNUMU    SFNMU   60                      S01117
     C                     OUT  LDA                                       S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ                             S01117
     C                     PARM           SENTY   3                       S01117
     C                     PARM           SFILEU                          S01117
     C                     PARM           SFNMU                           S01117
     C                     PARM *BLANKS   ZSERR   1                       S01117
     C           *LOCK     IN   LDA                                       S01117
     C*                                                                   S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
     C*                                                                   S01117
     C* ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAMME       S01117
     C*                                                                   S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C   99 U7 U8          EXCPTDTBASE
0304 C*R U1                EXSR EXETOT                      EXEPT TOTAL
0305 CLRNU1N99             EXSR TOTNOL                      NO LIMIT TOT
0306 CLRNU1N99             EXSR GRDTOT                      COMPLETE TOT
0341 C*****LRNU1N99             EXSR LNCNT                                S01332
0306 CLRNU1N99             EXSR CNOLIM                                    S01129
0306 CLRNU1N99             EXSR TOTS                                      S01129
0307 C********************************************************************
0308 C/EJECT
0309 C********************************************************************
0310 C**
0311 C**   SUBROUTINES
0312 C**
0313 C********************************************************************
0314 C********************************************************************
0315 C**
0316 C**   FULREP SR. - FULL REPORT PROCESSING, CALLED FROM MAIN LINE
0317 C**
0318 C           FULREP    BEGSR
0319 C*                    Z-ADD1         X       20
     C           NXTPAR    TAG
     C                     SETON                     L1
0320 C**
0321 C**   CHAIN TO CLINT(CLIENT MASTER FILE) AND EMLIM(LIMITS FILE)
0322 C**   RETURNS WITH 99 ON FOR CLINT CHAIN FAILED, 60 FOR EMLIM
0323 C**
0324 C   L1                Z-ADD0         LIM                             180028
0324 C   L1                EXSR CHAINS
     C   99                GOTO ENDRTN
     C/COPY WNCPYSRC,EM0610C034
0325 C  N60                MOVE MXPD      ZDAYNO
0326 C  N60                EXSR ZDATE2                      CONVERT DATE
0327 C   L1                Z-ADD0         EXP
0328 C   L1                Z-ADD0         OSB
0329 C   L1                Z-ADD0         AVA
0330 C   L1                Z-ADD0         EXPTOT
0331 C   L1                Z-ADD0         OSBTOT
0332 C   L1                Z-ADD0         AVATOT
     C*
     C/COPY WNCPYSRC,EM0610C001
     C                     SETOF                     L1
0333 C**
0334 C**   PROCESS ALL PACUS RECORDS FOR A PARENT
0335 C**
     C**   SAVE PARENT NUMBER
     C**********           MOVE CPAR      SAVEPN  60                                          CSD027
     C                     MOVE CPAR      SAVEPN  6                                           CSD027
0336 C           LPFUL     TAG                             ** TAG LPFUL
0339 C                     EXSR EXPRD                       READ EMDE4
0337 C                     READ PACUS                    LR
0338 C           CPAR      COMP SAVEPN                   L1
0340 C   L1NLR             GOTO LPFUL
0344 C   60                EXSR NOLIM                       PAR W/O LIM
0345 C  N60                EXSR LIMIT                       PAR WITH LIM
     C/COPY WNCPYSRC,EM0610C025
0341 C*********************EXSR LNCNT                                     E10331
0341 C  N60                EXSR LNCNT                                     E10331
0341 C****                 EXCPTDETAIL                                    S01129
0341 C                     EXSR DETAIL                                    S01129
0341 C  N60                ADD  1         RECCNT                          S01332
0345 C  NL1NLR             GOTO NXTPAR                      PAR WITH LIM
0346 C           ENDRTN    ENDSR
0347 C********************************************************************
0348 C/EJECT
0349 C********************************************************************
0350 C**
0351 C**   EXEREP SR. - EXEPTION REPORTING IE. THOSE PARENTS WHO HAVE
0352 C**                EXCEEDED ONE OR MORE OF THEIR LIMITS
0353 C**                CALLED FROM MAIN LINE
0354 C**
0355 C           EXEREP    BEGSR
0356 C*                    Z-ADD1         X       20
     C           NXTPR1    TAG
     C                     SETON                     L1
0357 C**
0358 C**   CHAIN TO CLINT(CLIENT MASTER FILE) AND EMLIM(LIMITS FILE)
0359 C**   RETURNS WITH 99 ON FOR CLINT CHAIN FAILED, 60 FOR EMLIM
0360 C**
0324 C   L1                Z-ADD0         LIM                             180028
0361 C   L1                EXSR CHAINS
     C   99                GOTO ENDEXE
     C/COPY WNCPYSRC,EM0610C035
0362 C  N60                MOVE MXPD      ZDAYNO
0363 C  N60                EXSR ZDATE2                      CONVERT DATE
0364 C   L1                Z-ADD0         EXP
0365 C   L1                Z-ADD0         OSB
0366 C   L1                Z-ADD0         AVA
0367 C   L1                Z-ADD0         EXPTOT
0368 C   L1                Z-ADD0         OSBTOT
0369 C   L1                Z-ADD0         AVATOT
     C*
     C/COPY WNCPYSRC,EM0610C002
     C                     SETOF                     L1
0370 C   60                READ PACUS                    LR
     C   60                GOTO ENDEXE
0371 C**
0372 C**   PROCESS ALL CUST NO'S ON A PACUS RECORD
0373 C**
     C**   SAVE PARENT NUMBER
     C                     MOVE CPAR      SAVEPN
0374 C           LPEXE     TAG                             ** TAG LPEXE
0339 C                     EXSR EXPRD                       READ EMDE4
0337 C                     READ PACUS                    LR
0338 C           CPAR      COMP SAVEPN                   L1
0340 C   L1NLR             GOTO LPEXE
0381 C           EXEND     TAG                             ** TAG EXEND
0382 C  N60                EXSR LIMIT                       PAR WITH LIM
     C/COPY WNCPYSRC,EM0610C026
0383 C                     EXSR NEGCHK                      CHK NEG AVA
0384 C  N40      AVATOT    COMP 0                      40
0341 C   40                EXSR LNCNT
0341 C***40                EXCPTDETAIL                                    S01129
0341 C   40                EXSR DETAIL                                    S01129
0388 C   40                ADD  1         RECCNT                          S01117
0342 C  NL1NLR             GOTO NXTPR1
0385 C**
0386 C**N40  DON'T PRINT DETAILS, 40 ON = NEGATIVE AVAILABILITY
0387 C**
0388 C***40******          ADD  1         RECCNT                          S01117
0389 C           ENDEXE    ENDSR
0390 C********************************************************************
0391 C/EJECT
0392 C********************************************************************
0393 C**
0394 C**   CHAINS SR. - CHAINS TO CLINT AND EMLIM
0395 C**                    (CALLED FROM FULL & EXEPTION RTN'S)
0396 C           CHAINS    BEGSR                           ** BEGSR CHAINS
0397 C                     MOVE 'A'       CRCDT            SET CLKEY TO
0398 C                     MOVE CPAR      CCNUM            CHAIN CLINT
0399 C           CCLKEY    CHAINCLINT                99
0400 C   99                MOVE 'CLINT'   DBFILE
0401 C   99                MOVE CCLKEY    DBKEY
0402 C   99                MOVE 'EM0610'  DBPGM
     C   99                OPEN EM0610AU                                  S01117
0403 C   99                SETON                     LRU7U8
0404 C   99                Z-ADD04        DBASE            ** DATABASE 04
0405 C   99                GOTO ENDCHA
     C**                                                                  E18414
     C**   SETOF RECORD INDICATORS FOR EMLIM.                             E18414
     C**                                                                  E18414
     C                     SETOF                     0203                 E18414
     C**                                                                  E18414
0406 C                     MOVEL'1'       LIMKEY  7        SET LIMKEY TO
0407 C                     MOVE CPAR      LIMKEY           CHAIN EMLIM
0408 C           LIMKEY    CHAINEMLIM                60
0409 C  N60N02             SETON                     60
0410 C           ENDCHA    ENDSR                           ** TAG ENDCHA
0411 C********************************************************************
0412 C********************************************************************
0413 C**
0414 C**   EXPRD SR. - READS EMDE4 (EMDEX)RECS
0415 C**               ACCESS ALL CUSTOMERS FOR A PARENT BY CUSTOMER NO.
0416 C**                    (CALLED FROM FULL & EXEPTION RTN'S)
0417 C**
0418 C           EXPRD     BEGSR
0419 C**********           MOVE CNUM      CHILDN  60       SET LOWER LIMIT                    CSD027
0419 C                     MOVE CNUM      CHILDN  6        SET LOWER LIMIT                    CSD027
0420 C           CHILDN    SETLLEMDE4                      ON EMDEX
0421 C           START     TAG                             ** TAG START
0422 C                     SETOF                     5201
0423 C                     READ EMDE4                    79
0424 C   01N79   CHILDN    COMP MCUN                     52
0425 C   52                EXSR ACCARR                      ACCUMULATE
0426 C   52                GOTO START                       EXP & OSB
0427 C                     ENDSR
0428 C********************************************************************
0429 C********************************************************************
0430 C**
0431 C**   ACCARR SR. - ACCUMULATES ARRAYS OF EXPOSURE AND
0432 C**                OFF-SETTING BALANCE FROM EMDEX(EMDE4)
0433 C**               (CALLED FROM EXPRD)
0434 C**
0435 C           ACCARR    BEGSR
     C*                                                                   S01129
     C********** MSFX      IFNE *ZEROS                              S01129S01332
     C           BGDLFX    IFEQ 'Y'                                       S01332
0436 C                     ADD  MFXE      EXP,1
0437 C                     ADD  MFXB      OSB,1
     C                     END                                            S01129
     C*                                                                   S01129
     C********** MSMM      IFNE *ZEROS                             S01129 S01332
     C           BGDLMM    IFEQ 'Y'                                       S01332
0438 C                     ADD  MMME      EXP,2
0439 C                     ADD  MMMB      OSB,2
     C                     END                                            S01129
     C*                                                                   S01129
     C********** MSLN      IFNE *ZEROS                             S01129 S01332
     C           BGCSLN    IFEQ 'Y'                                       S01332
0440 C                     ADD  MLEE      EXP,3
0441 C                     ADD  MLEB      OSB,3
     C                     ADD  MLAE      EXP,3                           S01128
     C                     ADD  MLAB      OSB,3                           S01128
     C                     END                                            S01129
     C*                                                                   S01129
     C********** MSRE      IFNE *ZEROS                             S01129 S01332
     C           BGRTBN    IFEQ 'Y'                                       S01332
0442 C                     ADD  MREE      EXP,4
0443 C                     ADD  MREB      OSB,4
     C                     END                                            S01129
     C*                                                                   S01129
     C********** MSSC      IFNE *ZEROS                             S01129 S01332
     C           BGSECS    IFEQ 'Y'                                       S01332
     C                     ADD  MSCE      EXP,6                           S01129
     C                     ADD  MSIE      EXP,7                           S01332
     C                     ADD  MSPO      OSB,8                           S01332
     C                     END                                            S01129
     C*                                                                   S01129
     C********** MSSI      IFNE *ZEROS                             S01129 S01332
0442 C**********           ADD  MSIE      EXP,7                    S01129 S01332
     C**********           END                                     S01129 S01332
     C**********                                                   S01129 S01332
     C********** MSSP      IFNE *ZEROS                             S01129 S01332
0443 C**********           ADD  MSPO      OSB,8                    S01129 S01332
     C**********           END                                     S01129 S01332
     C**********                                                   S01129 S01332
     C*                                                                   S01332
     C           BGFIIN    IFEQ 'Y'                                       S01332
     C                     ADD  MFRE      EXP,5                           S01332
     C                     ADD  MFRO      OSB,5                           S01332
     C                     ADD  MIRE      EXP,9                           S01332
     C                     ADD  MIRO      OSB,9                           S01332
     C                     END                                            S01332
     C*                                                                   S01332
     C           BGFUOP    IFEQ 'Y'                                       S01332
     C                     ADD  MFUE      EXP,10                          S01332
     C                     ADD  MFUO      OSB,10                          S01332
     C                     ADD  MOPE      EXP,11                          S01332
     C                     ADD  MOPO      OSB,11                          S01332
     C                     END                                            S01332
     C*                                                                   CTI002
     C           CTI002    IFEQ 'Y'                                       CTI002
     C           CTI007    OREQ 'Y'                                                         MD030956
0436 C                     ADD  TFEX      EXP,12                          CTI002
0437 C                     ADD  TFOF      OSB,12                          CTI002
     C                     END                                            CTI002
     C*                                                                   CTI002
0444 C                     ENDSR
0445 C********************************************************************
0446 C********************************************************************
0447 C**
0448 C**   NEGCHK SR. - SEARCHES FOR NEGATIVE AVAILABILITY IN AVA ARRAY
0449 C*********************(SEARCHES*FIRST*FOUR*ELEMENTS*ONLY)****        S01332
0450 C**                   (CALLED FROM FULL & EXEPTION RTN'S)
0451 C**
0452 C**
0453 C           NEGCHK    BEGSR
0454 C**********           Z-ADD1         Y       10                      S01332
0454 C                     Z-ADD1         Y                               S01332
     C/COPY WNCPYSRC,EM0610C027
0455 C           SRCHLP    TAG                             ** TAG SRCHLP
0456 C***        Y         COMP 5                        41               S01129
0456 C********** Y         COMP 9                        41        S01129 S01332
0456 C***********Y         COMP 12                       41        S01332 CTI002
0456 C           Y         COMP 13                       41               CTI002
0457 C   41                GOTO ENDCHK
     C*                                                                   S01129
     C********** Y         IFNE 5                                  S01129 S01332
      * Don't check SE Portfolio since no availability                    S01332
     C           Y         IFNE 8                                         S01332
0458 C           0         COMP AVA,Y                40
     C                     END                                            S01129
     C*                                                                   S01129
0459 C                     ADD  1         Y
0460 C  N40                GOTO SRCHLP
0461 C           ENDCHK    ENDSR                           ** TAG ENDCHK
0462 C********************************************************************
0463 C/EJECT
0464 C********************************************************************
0465 C**
0466 C**   NOLIM SR. - NO LIMIT PROCESSING, ACCUMULATE TOTALS FOR
0467 C**               PARENTS WITH NO LIMITS
0468 C**                    (CALLED FROM FULL RTN ONLY)
0469 C**
0470 C           NOLIM     BEGSR
     C/COPY WNCPYSRC,EM0610C015
0471 C                     DIV  1000      EXP       H
0472 C                     DIV  1000      OSB       H
     C/COPY WNCPYSRC,EM0610C016
0473 C                     Z-SUBEXP       AVA              CALC AVAILBLTY
     C/COPY WNCPYSRC,EM0610C003
0474 C           EXP       ADD  NLE       NLE
0475 C           AVA       ADD  NLA       NLA
0476 C           OSB       ADD  NLO       NLO
     C/COPY WNCPYSRC,EM0610C018
0477 C                     ENDSR
0478 C********************************************************************
0479 C********************************************************************
0480 C**
0481 C**   LIMIT SR. - LIMITS PROCESSING, CALC TOTALS AND GRAND TOTALS
0482 C**               FOR PARENTS WITH LIMITS
0483 C**                    (CALLED FROM FULL & EXEPTION RTN'S)
0484 C**
0485 C           LIMIT     BEGSR
     C/COPY WNCPYSRC,EM0610C017
0486 C                     DIV  1000      EXP       H
0487 C                     DIV  1000      OSB       H
     C/COPY WNCPYSRC,EM0610C004
0488 C           LIM       SUB  EXP       AVA              CALC AVAILBLTY
     C/COPY WNCPYSRC,EM0610C005
0489 C                     ADD  MOAL      GRDTTL 150       CALC TOT FOR
0490 C                     XFOOTEXP       EXPTOT 150       A PARENT
0496 C                     XFOOTOSB       OSBTOT 150                      S01332
      *                                                                   S01332
      * For exposure and offset balance calculation, only add in          S01332
      * the business areas specified on EM scaling file                   S01332
      * FX                                                                S01332
     C           @FX       IFNE 'Y'                                       S01332
     C                     SUB  EXP,1     EXPTOT                          S01332
     C                     SUB  OSB,1     OSBTOT                          S01332
     C                     END                                            S01332
      * MM                                                                S01332
     C           @MM       IFNE 'Y'                                       S01332
     C                     SUB  EXP,2     EXPTOT                          S01332
     C                     SUB  OSB,2     OSBTOT                          S01332
     C                     END                                            S01332
      * LE                                                                S01332
     C           @LE       IFNE 'Y'                                       S01332
     C                     SUB  EXP,3     EXPTOT                          S01332
     C                     SUB  OSB,3     OSBTOT                          S01332
     C                     END                                            S01332
      * RE                                                                S01332
     C           @RE       IFNE 'Y'                                       S01332
     C                     SUB  EXP,4     EXPTOT                          S01332
     C                     SUB  OSB,4     OSBTOT                          S01332
     C                     END                                            S01332
      * FRA                                                               S01332
     C           @FR       IFNE 'Y'                                       S01332
     C                     SUB  EXP,5     EXPTOT                          S01332
     C                     SUB  OSB,5     OSBTOT                          S01332
     C                     END                                            S01332
      * SE C/PARTY                                                        S01332
     C           @CP       IFNE 'Y'                                       S01332
     C                     SUB  EXP,6     EXPTOT                          S01332
     C                     END                                            S01332
      * SE ISSUER                                                         S01332
     C           @IS       IFNE 'Y'                                       S01332
     C                     SUB  EXP,7     EXPTOT                          S01332
     C                     END                                            S01332
      * IRS                                                               S01332
     C           @IR       IFNE 'Y'                                       S01332
     C                     SUB  EXP,9     EXPTOT                          S01332
     C                     SUB  OSB,9     OSBTOT                          S01332
     C                     END                                            S01332
      * FUTURES                                                           S01332
     C           @FU       IFNE 'Y'                                       S01332
     C                     SUB  EXP,10    EXPTOT                          S01332
     C                     SUB  OSB,10    OSBTOT                          S01332
     C                     END                                            S01332
      * OPTIONS                                                           S01332
     C           @OP       IFNE 'Y'                                       S01332
     C                     SUB  EXP,11    EXPTOT                          S01332
     C                     SUB  OSB,11    OSBTOT                          S01332
     C                     END                                            S01332
      * TF                                                                CTI002
     C           @TF       IFNE 'Y'                                       CTI002
     C                     SUB  EXP,12    EXPTOT                          CTI002
     C                     SUB  OSB,12    OSBTOT                          CTI002
     C                     END                                            CTI002
0491 C**
0492 C*****SUB*FX*EXP*FROM*TOTAL*EXP***                                   S01332
0493 C**********                                                          S01332
0494 C**********           SUB  EXP,1     EXPTOT                          S01332
     C**********           SUB  EXP,6     EXPTOT                   S01129 S01332
0495 C           MOAL      SUB  EXPTOT    AVATOT 150
0496 C**********           XFOOTOSB       OSBTOT 150                      S01332
     C**********           SUB  OSB,1     OSBTOT                   S01128 S01332
0497 C           LIM       ADD  TTL       TTL              CALC GRAND
0498 C           EXP       ADD  TTE       TTE              TOTALS
0499 C           AVA       ADD  TTA       TTA
0500 C           OSB       ADD  TTO       TTO
0501 C                     ADD  AVATOT    GRDTTA
     C/COPY WNCPYSRC,EM0610C019
0502 C                     ENDSR                           ** ENDSR LIMIT
0503 C********************************************************************
0504 C/EJECT
0505 C********************************************************************
0506 C**
0507 C**   TOTNOL SR. - TOTAL OF PARENTS WITHOUT LIMITS
0508 C**               CALLED FROM MAINLINE
0509 C**
0510 C           TOTNOL    BEGSR
0511 C                     XFOOTNLE       EXPTOT
0512 C**
0513 C*****SUB*FX*EXP*FROM*TOTAL*EXP***                                   S01332
0514 C**********                                                          S01332
0515 C**********           SUB  NLE,1     EXPTOT                          S01332
     C**********           SUB  NLE,6     EXPTOT                   S01129 S01332
0516 C                     XFOOTNLA       AVATOT
0517 C**********           SUB  NLA,1     AVATOT                          S01332
     C**********           SUB  NLA,6     AVATOT                          S01332
0518 C                     XFOOTNLO       OSBTOT
     C**********           SUB  NLO,1     OSBTOT                   S01128 S01332
      *                                                                   S01332
      * Only include specified areas in totals                            S01332
      * FX                                                                S01332
     C           @FX       IFNE 'Y'                                       S01332
     C                     SUB  NLE,1     EXPTOT                          S01332
     C                     SUB  NLO,1     OSBTOT                          S01332
     C                     SUB  NLA,1     AVATOT                          S01332
     C                     END                                            S01332
      * MM                                                                S01332
     C           @MM       IFNE 'Y'                                       S01332
     C                     SUB  NLE,2     EXPTOT                          S01332
     C                     SUB  NLO,2     OSBTOT                          S01332
     C                     SUB  NLA,2     AVATOT                          S01332
     C                     END                                            S01332
      * LE                                                                S01332
     C           @LE       IFNE 'Y'                                       S01332
     C                     SUB  NLE,3     EXPTOT                          S01332
     C                     SUB  NLO,3     OSBTOT                          S01332
     C                     SUB  NLA,3     AVATOT                          S01332
     C                     END                                            S01332
      * RE                                                                S01332
     C           @RE       IFNE 'Y'                                       S01332
     C                     SUB  NLE,4     EXPTOT                          S01332
     C                     SUB  NLO,4     OSBTOT                          S01332
     C                     SUB  NLA,4     AVATOT                          S01332
     C                     END                                            S01332
      * FRA                                                               S01332
     C           @FR       IFNE 'Y'                                       S01332
     C                     SUB  NLE,5     EXPTOT                          S01332
     C                     SUB  NLO,5     OSBTOT                          S01332
     C                     SUB  NLA,5     AVATOT                          S01332
     C                     END                                            S01332
      * SE C/PARTY                                                        S01332
     C           @CP       IFNE 'Y'                                       S01332
     C                     SUB  NLE,6     EXPTOT                          S01332
     C                     SUB  NLA,6     AVATOT                          S01332
     C                     END                                            S01332
      * SE ISSUER                                                         S01332
     C           @IS       IFNE 'Y'                                       S01332
     C                     SUB  NLE,7     EXPTOT                          S01332
     C                     SUB  NLA,7     AVATOT                          S01332
     C                     END                                            S01332
      * IRS                                                               S01332
     C           @IR       IFNE 'Y'                                       S01332
     C                     SUB  NLE,9     EXPTOT                          S01332
     C                     SUB  NLO,9     OSBTOT                          S01332
     C                     SUB  NLA,9     AVATOT                          S01332
     C                     END                                            S01332
      * FUTURES                                                           S01332
     C           @FU       IFNE 'Y'                                       S01332
     C                     SUB  NLE,10    EXPTOT                          S01332
     C                     SUB  NLO,10    OSBTOT                          S01332
     C                     SUB  NLA,10    AVATOT                          S01332
     C                     END                                            S01332
      * OPTIONS                                                           S01332
     C           @OP       IFNE 'Y'                                       S01332
     C                     SUB  NLE,11    EXPTOT                          S01332
     C                     SUB  NLO,11    OSBTOT                          S01332
     C                     SUB  NLA,11    AVATOT                          S01332
     C                     END                                            S01332
      * TF                                                                CTI002
     C           @TF       IFNE 'Y'                                       CTI002
     C                     SUB  NLE,12    EXPTOT                          CTI002
     C                     SUB  NLO,12    OSBTOT                          CTI002
     C                     SUB  NLA,12    AVATOT                          CTI002
     C                     END                                            CTI002
     C/COPY WNCPYSRC,EM0610C028
      *                                                                   CTI002
0519 C                     ENDSR
0520 C********************************************************************
0521 C********************************************************************
0522 C**
0523 C**   GRDTOT SR. - GRAND TOTAL RTN
0524 C**               CALLED FROM MAINLINE
0525 C**
0526 C           GRDTOT    BEGSR
0527 C           NLE       ADD  TTE       TTE              ADD PARENTS
0528 C           NLA       ADD  TTA       TTA              WITH LIMITS TO
0529 C           NLO       ADD  TTO       TTO              PARENTS W/O LIM
0530 C                     XFOOTTTE       GRDTTE 150
0536 C                     XFOOTTTO       GRDTTO 150                      S01332
      *                                                                   S01332
      * Only include specified areas in totals                            S01332
      * FX                                                                S01332
     C           @FX       IFNE 'Y'                                       S01332
     C                     SUB  TTE,1     GRDTTE                          S01332
     C                     SUB  TTO,1     GRDTTO                          S01332
     C                     END                                            S01332
      * MM                                                                S01332
     C           @MM       IFNE 'Y'                                       S01332
     C                     SUB  TTE,2     GRDTTE                          S01332
     C                     SUB  TTO,2     GRDTTO                          S01332
     C                     END                                            S01332
      * LE                                                                S01332
     C           @LE       IFNE 'Y'                                       S01332
     C                     SUB  TTE,3     GRDTTE                          S01332
     C                     SUB  TTO,3     GRDTTO                          S01332
     C                     END                                            S01332
      * RE                                                                S01332
     C           @RE       IFNE 'Y'                                       S01332
     C                     SUB  TTE,4     GRDTTE                          S01332
     C                     SUB  TTO,4     GRDTTO                          S01332
     C                     END                                            S01332
      * FRA                                                               S01332
     C           @FR       IFNE 'Y'                                       S01332
     C                     SUB  TTE,5     GRDTTE                          S01332
     C                     SUB  TTO,5     GRDTTO                          S01332
     C                     END                                            S01332
      * SE C/PARTY                                                        S01332
     C           @CP       IFNE 'Y'                                       S01332
     C                     SUB  TTE,6     GRDTTE                          S01332
     C                     END                                            S01332
      * SE ISSUER                                                         S01332
     C           @IS       IFNE 'Y'                                       S01332
     C                     SUB  TTE,7     GRDTTE                          S01332
     C                     END                                            S01332
      * IRS                                                               S01332
     C           @IR       IFNE 'Y'                                       S01332
     C                     SUB  TTE,9     GRDTTE                          S01332
     C                     SUB  TTO,9     GRDTTO                          S01332
     C                     END                                            S01332
      * FUTURES                                                           S01332
     C           @FU       IFNE 'Y'                                       S01332
     C                     SUB  TTE,10    GRDTTE                          S01332
     C                     SUB  TTO,10    GRDTTO                          S01332
     C                     END                                            S01332
      * OPTIONS                                                           S01332
     C           @OP       IFNE 'Y'                                       S01332
     C                     SUB  TTE,11    GRDTTE                          S01332
     C                     SUB  TTO,11    GRDTTO                          S01332
     C                     END                                            S01332
      * TF                                                                CTI002
     C           @TF       IFNE 'Y'                                       CTI002
     C                     SUB  TTE,12    GRDTTE                          CTI002
     C                     SUB  TTO,12    GRDTTO                          CTI002
     C                     END                                            CTI002
0531 C**
0532 C*****SUB*FX*EXP*FROM*TOTAL*EXP***                                   S01332
0533 C**********                                                          S01332
0534 C**********           SUB  TTE,1     GRDTTE                          S01332
0534 C**********           SUB  TTE,6     GRDTTE                   S01129 S01332
0535 C           GRDTTL    SUB  GRDTTE    GRDTTA 150
0536 C**********           XFOOTTTO       GRDTTO 150                      S01332
     C**********           SUB  TTO,1     GRDTTO                   S01128 S01332
     C/COPY WNCPYSRC,EM0610C029
0537 C                     ENDSR
0538 C********************************************************************
     C/EJECT                                                              S01129
     C********************************************************************S01129
     C**                                                                  S01129
     C**   PRINT DETAIL LINES                                             S01129
     C**                                                                  S01129
     C           DETAIL    BEGSR                                          S01129
     C*                                                                   S01129
     C                     EXCPTDET1                                      S01129
     C*                                                                   S01129
     C                     Z-ADD*ZEROS    X                               S01129
     C*                                                                   S01129
     C********** X         DOWLT9                                  S01129 S01332
     C***********X         DOWLT11                                 S01332 CTI002
     C           X         DOWLT12                                        CTI002
     C*                                                                   S01129
     C                     ADD  1         X                               S01129
     C*                                                                   S01129
     C           WTY,X     IFEQ *BLANKS                                   S01129
     C**********           Z-ADD10        X                        S01129 S01332
     C                     Z-ADD12        X                               S01332
     C*                                                                   S01129
     C                     ELSE                                           S01129
     C*                                                                   S01129
     C/COPY WNCPYSRC,EM0610C006
     C           WTY,X     IFEQ 'FX'                                      S01129
     C                     EXCPTDETFX                                     S01129
     C                     END                                            S01129
     C           WTY,X     IFEQ 'MM'                                      S01129
     C                     EXCPTDETMM                                     S01129
     C                     END                                            S01129
     C           WTY,X     IFEQ 'LN'                                      S01129
     C                     EXCPTDETLN                                     S01129
     C                     END                                            S01129
     C           WTY,X     IFEQ 'RE'                                      S01129
     C                     EXCPTDETRE                                     S01129
     C                     END                                            S01129
     C***********WTY,X     IFEQ 'LC'                               S01129 S01196
     C*************        EXCPTDETLC                              S01129 S01196
     C*************        END                                     S01129 S01196
     C           WTY,X     IFEQ 'SC'                                      S01129
     C                     EXCPTDETSC                                     S01129
     C                     END                                            S01129
     C           WTY,X     IFEQ 'SI'                                      S01129
     C                     EXCPTDETSI                                     S01129
     C                     END                                            S01129
     C           WTY,X     IFEQ 'SP'                                      S01129
     C                     EXCPTDETSP                                     S01129
     C                     END                                            S01129
     C********** WTY,X     IFEQ 'FI'                               S01129 S01332
     C**********           EXCPTDETFI                              S01129 S01332
     C**********           END                                     S01129 S01332
     C/COPY WNCPYSRC,EM0610C007
     C           WTY,X     IFEQ 'FR'                                      S01332
     C                     EXCPTDETFR                                     S01332
     C                     END                                            S01332
     C           WTY,X     IFEQ 'IR'                                      S01332
     C                     EXCPTDETIR                                     S01332
     C                     END                                            S01332
     C/COPY WNCPYSRC,EM0610C020
     C           WTY,X     IFEQ 'FU'                                      S01332
     C                     EXCPTDETFU                                     S01332
     C                     END                                            S01332
     C           WTY,X     IFEQ 'OP'                                      S01332
     C                     EXCPTDETOP                                     S01332
     C                     END                                            S01332
     C           WTY,X     IFEQ 'TF'                                      CTI002
     C                     EXCPTDETTF                                     CTI002
     C                     END                                            CTI002
     C*                                                                   S01129
     C/COPY WNCPYSRC,EM0610C008
     C                     END                                            S01129
     C*                                                                   S01129
     C                     END                                            S01129
     C*                                                                   S01129
     C/COPY WNCPYSRC,EM0610C030
     C                     EXCPTDET2                                      S01129
     C*                                                                   S01129
     C                     ENDSR                                          S01129
     C********************************************************************S01129
     C/EJECT                                                              S01129
     C********************************************************************S01129
     C**                                                                  S01129
     C**   PRINT CUSTOMERS WITH NO LIMITS                                 S01129
     C**                                                                  S01129
     C           CNOLIM    BEGSR                                          S01129
     C*                                                                   S01129
      * For no limits print, one less line is needed than for detail      S01332
     C                     SUB  1         @DETL                           S01332
     C                     EXSR LNCNT                                     S01332
     C                     ADD  1         @DETL                           S01332
      *                                                                   S01332
     C                     EXCPTCNOLM1                                    S01129
     C*                                                                   S01129
     C                     Z-ADD*ZEROS    X                               S01129
     C*                                                                   S01129
     C********** X         DOWLT9                                  S01129 S01332
     C********** X         DOWLT11                                 S01332 CTI002
     C           X         DOWLT12                                        CTI002
     C*                                                                   S01129
     C                     ADD  1         X                               S01129
     C*                                                                   S01129
     C           WTY,X     IFEQ *BLANKS                                   S01129
     C**********           Z-ADD10        X                        S01129 S01332
     C                     Z-ADD12        X                               S01332
     C*                                                                   S01129
     C                     ELSE                                           S01129
     C*                                                                   S01129
     C/COPY WNCPYSRC,EM0610C009
     C           WTY,X     IFEQ 'FX'                                      S01129
     C                     EXCPTCNLFX                                     S01129
     C                     END                                            S01129
     C           WTY,X     IFEQ 'MM'                                      S01129
     C                     EXCPTCNLMM                                     S01129
     C                     END                                            S01129
     C           WTY,X     IFEQ 'LN'                                      S01129
     C                     EXCPTCNLLN                                     S01129
     C                     END                                            S01129
     C           WTY,X     IFEQ 'RE'                                      S01129
     C                     EXCPTCNLRE                                     S01129
     C                     END                                            S01129
     C********** WTY,X     IFEQ 'LC'                               S01129 S01196
     C**********           EXCPTCNLLC                              S01129 S01196
     C**********           END                                     S01129 S01196
     C           WTY,X     IFEQ 'SC'                                      S01129
     C                     EXCPTCNLSC                                     S01129
     C                     END                                            S01129
     C           WTY,X     IFEQ 'SI'                                      S01129
     C                     EXCPTCNLSI                                     S01129
     C                     END                                            S01129
     C           WTY,X     IFEQ 'SP'                                      S01129
     C                     EXCPTCNLSP                                     S01129
     C                     END                                            S01129
     C********** WTY,X     IFEQ 'FI'                               S01129 S01332
     C**********           EXCPTCNLFI                              S01129 S01332
     C**********           END                                     S01129 S01332
     C/COPY WNCPYSRC,EM0610C010
     C           WTY,X     IFEQ 'FR'                                      S01332
     C                     EXCPTCNLFR                                     S01332
     C                     END                                            S01332
     C           WTY,X     IFEQ 'IR'                                      S01332
     C                     EXCPTCNLIR                                     S01332
     C                     END                                            S01332
     C/COPY WNCPYSRC,EM0610C021
     C           WTY,X     IFEQ 'FU'                                      S01332
     C                     EXCPTCNLFU                                     S01332
     C                     END                                            S01332
     C           WTY,X     IFEQ 'OP'                                      S01332
     C                     EXCPTCNLOP                                     S01332
     C                     END                                            S01332
     C           WTY,X     IFEQ 'TF'                                      CTI002
     C                     EXCPTCNLTF                                     CTI002
     C                     END                                            CTI002
     C*                                                                   S01129
     C/COPY WNCPYSRC,EM0610C011
     C                     END                                            S01129
     C*                                                                   S01129
     C                     END                                            S01129
     C/COPY WNCPYSRC,EM0610C031
     C*                                                                   S01129
     C                     EXCPTCNOLM2                                    S01129
     C*                                                                   S01129
     C                     ENDSR                                          S01129
     C********************************************************************S01129
     C/EJECT                                                              S01129
     C********************************************************************S01129
     C**                                                                  S01129
     C**   PRINT TOTALS FOR REPORT GROUPING                               S01129
     C**                                                                  S01129
     C           TOTS      BEGSR                                          S01129
     C*                                                                   S01129
      * For totals print, one less line is needed than for detail         S01332
     C                     SUB  1         @DETL                           S01332
     C                     EXSR LNCNT                                     S01332
     C                     ADD  1         @DETL                           S01332
      *                                                                   S01332
     C                     EXCPTTOTS1                                     S01129
     C*                                                                   S01129
     C                     Z-ADD*ZEROS    X                               S01129
     C*                                                                   S01129
     C********** X         DOWLT9                                  S01129 S01332
     C********** X         DOWLT11                                 S01332 CTI002
     C           X         DOWLT12                                        CTI002
     C*                                                                   S01129
     C                     ADD  1         X                               S01129
     C*                                                                   S01129
     C           WTY,X     IFEQ *BLANKS                                   S01129
     C**********           Z-ADD10        X                        S01129 S01332
     C                     Z-ADD12        X                               S01332
     C*                                                                   S01129
     C                     ELSE                                           S01129
     C*                                                                   S01129
     C/COPY WNCPYSRC,EM0610C012
     C           WTY,X     IFEQ 'FX'                                      S01129
     C                     EXCPTTOTFX                                     S01129
     C                     END                                            S01129
     C           WTY,X     IFEQ 'MM'                                      S01129
     C                     EXCPTTOTMM                                     S01129
     C                     END                                            S01129
     C           WTY,X     IFEQ 'LN'                                      S01129
     C                     EXCPTTOTLN                                     S01129
     C                     END                                            S01129
     C           WTY,X     IFEQ 'RE'                                      S01129
     C                     EXCPTTOTRE                                     S01129
     C                     END                                            S01129
     C***********WTY,X     IFEQ 'LC'                             S01129   S01196
     C*************        EXCPTTOTLC                            S01129   S01196
     C*************        END                                   S01129   S01196
     C           WTY,X     IFEQ 'SC'                                      S01129
     C                     EXCPTTOTSC                                     S01129
     C                     END                                            S01129
     C           WTY,X     IFEQ 'SI'                                      S01129
     C                     EXCPTTOTSI                                     S01129
     C                     END                                            S01129
     C           WTY,X     IFEQ 'SP'                                      S01129
     C                     EXCPTTOTSP                                     S01129
     C                     END                                            S01129
     C********** WTY,X     IFEQ 'FI'                               S01129 S01332
     C**********           EXCPTTOTFI                              S01129 S01332
     C**********           END                                     S01129 S01332
     C/COPY WNCPYSRC,EM0610C013
     C           WTY,X     IFEQ 'FR'                                      S01332
     C                     EXCPTTOTFR                                     S01332
     C                     END                                            S01332
     C           WTY,X     IFEQ 'IR'                                      S01332
     C                     EXCPTTOTIR                                     S01332
     C                     END                                            S01332
     C/COPY WNCPYSRC,EM0610C022
     C           WTY,X     IFEQ 'FU'                                      S01332
     C                     EXCPTTOTFU                                     S01332
     C                     END                                            S01332
     C           WTY,X     IFEQ 'OP'                                      S01332
     C                     EXCPTTOTOP                                     S01332
     C                     END                                            S01332
     C           WTY,X     IFEQ 'TF'                                      CTI002
     C                     EXCPTTOTTF                                     CTI002
     C                     END                                            CTI002
     C*                                                                   S01129
     C/COPY WNCPYSRC,EM0610C014
     C                     END                                            S01129
     C*                                                                   S01129
     C                     END                                            S01129
     C/COPY WNCPYSRC,EM0610C032
     C*                                                                   S01129
     C                     EXCPTTOTS2                                     S01129
     C*                                                                   S01129
     C                     ENDSR                                          S01129
     C********************************************************************S01129
0539 C/EJECT
 475 C********************************************************************
0476 C**
0477 C**   LNCNT   SR. - TO MAINTAIN COUNT OF DETAILS PRINTED AND
0478 C**                 TO PRINT NEW HEADINGS ON PAGE OVERFLOW
0479 C**           THIS SR. IS CALLED FROM FULL AND EXEPTION RTN'S
0480 C**
0481 C           LNCNT     BEGSR                           ** BEGSR LNCNT
0482 C**********           ADD  1         LINEC   10
     C********** *INLR     IFEQ '1'                                S01129 S01332
     C********** *INU1     ANDEQ'0'                                S01129 S01332
     C********** *IN99     ANDEQ'0'                                S01129 S01332
0483 C***LRNU1N99          ADD  1         LINEC                           S01129
0483 C***65*****           ADD  1         LINEC                    S01129 S01332
     C**********           SETON                         65        S01129 S01332
     C**********           END                                     S01129 S01332
0484 C***        4         COMP LINEC                  71                 S01129
0484 C********** WBLNO     COMP LINEC                  71          S01129 S01332
      *                                                                   S01332
      * Determine whether a page break is needed. To do this, the         S01332
      * current print line and overflow line no. are extracted from       S01332
      * the printer file INFDS. The difference between these is           S01332
      * then compared to @DETL i.e. no. of lines per detail record        S01332
      * If not enough lines then force a new page                         S01332
     C           OFLOW     SUB  CURLIN    REM     20                      S01332
     C           REM       IFLT @DETL                                     S01332
     C                     MOVE '1'       *IN71                           S01332
     C                     END                                            S01332
0485 C**
0486 C**   PRINT HEADINGS ON OVERFLOW
0487 C**
0488 C   71                EXCPTHEADER
0489 C***71*****           Z-ADD1         LINEC                           S01332
0490 C   71                SETOF                     71
0491 C                     ENDSR                           ** ENDSR LNCNT
 492 C********************************************************************
0493 C/EJECT
0540 C********************************************************************
0541 C**
0542 C**   ZSYSTM SR. TO CHAIN TO THE INSTALLATION CONTROL DATA RECORD.
0543 C**
0544 C           ZSYSTM    BEGSR                           *** ZSYSTM ***
0545 C**
0546 C**   SET UP KEY FOR INSTALLATION CONTROL RECORD.
0547 C                     MOVEL'01      'ZTABKY 12
0548 C                     MOVE '  10'    ZTABKY
0549 C**
0550 C****       ZTABKY    CHAINTABLE                99    ON NOT THERE   S01129
0550 C           ZTABKY    CHAINTABEM                99    ON NOT THERE   S01129
0551 C  N99      RECIX     COMP 'D'                  9999  ON, IS DELETED
0552 C**
0553 C**   CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.
0554 C           DATF      COMP 'M'                      98MMDDYY, 98 ON
0555 C**
0556 C                     ENDSR
0557 C**
0558 C**
0559 C********************************************************************
0560 C/EJECT
0561 C********************************************************************
0562 C**
0563 C**   ZDATE2 SR. TO CONVERT A DAY NUMBER TO DATE FORMATS.
0564 C**
0565 C**   THE YEAR 2000, BEING DIVISIBLE BY 400, IS A LEAP YEAR.
0566 C**
0567 C           ZDATE2    BEGSR                           *** ZDATE2 ***
0568 C**
0569 C**   CLEAR DATE FIELDS.
0570 C                     Z-ADD0         ZDATE   60
0571 C                     MOVEL'       ' ZADATE  7
0572 C**
0573 C**   CALCULATION TO DEFINE INPUT DAY NUMBER.
0574 C                     Z-ADDZDAYNO    ZDAYNO  50
0575 C**
0576 C**   DETERMINE YEAR NUMBER.
0577 C**
0578 C**   ADJUST DAY NUMBER IN CASE LAST DAY OF YEAR.
0579 C           ZDAYNO    SUB  1         ZDAYN1  50   99
0580 C   99                GOTO ZDEND2
0581 C**
0582 C**   CALCULATE NUMBER OF 4 YEAR SPANS SINCE 31/12/1971.
0583 C           ZDAYN1    DIV  1461      ZLYR    20
0584 C                     MVR            ZDAYN1           SAVE REMAINING
0585 C**                                                   DAYS
0586 C**   CALCULATE NUMBER OF REMAINING YEARS.
0587 C                     Z-ADD1         ZWRK2   20
0588 C           ZDTAG1    TAG                             ** ZDTAG1 TAG *
0589 C           ZDAYN1    COMP ZYDY,ZWRK2             90
0590 C  N90      ZWRK2     ADD  1         ZWRK2
0591 C  N90                GOTO ZDTAG1
0592 C           ZWRK2     SUB  1         ZWRK2          91LEAP YR, 91 ON
0593 C**
0594 C**   DECREMENT DAY NO. BY DAYS IN REMAINING YEARS.
0595 C  N91      ZDAYN1    SUB  ZYDY,ZWRK2ZDAYN1
0596 C**
0597 C**   CALCULATE ACTUAL YEAR NUMBER.
0598 C           ZLYR      MULT 4         ZWRK3   30
0599 C           ZWRK3     ADD  72        ZWRK3            BASE IS 1972
0600 C                     Z-ADDZWRK3     ZYEAR   20
0601 C           ZYEAR     ADD  ZWRK2     ZYEAR            YEAR
0602 C**
0603 C**   DETERMINE MONTH NUMBER.
0604 C**
0605 C**   ADJUST DAY NO. IN CASE LAST DAY OF LEAP YEAR FEBRUARY.
0606 C                     SETOF                     9293
0607 C   91      ZDAYN1    COMP 59                     9293
0608 C   91N92   ZDAYN1    SUB  1         ZDAYN1
0609 C**
0610 C**   CALCULATE MONTH NUMBER.
0611 C                     Z-ADD2         ZWRK2
0612 C           ZDTAG2    TAG                             ** ZDTAG2 TAG *
0613 C           ZDAYN1    COMP ZMDY,ZWRK2             94
0614 C  N94      ZWRK2     ADD  1         ZWRK2
0615 C  N94                GOTO ZDTAG2
0616 C           ZWRK2     SUB  1         ZWRK2
0617 C**
0618 C                     Z-ADDZWRK2     ZMTH    20       MONTH
0619 C**
0620 C**   DETERMINE DAY OF MONTH.
0621 C**
0622 C**   ADD BACK LAST DAY OF YEAR ADJUSTMENT.
0623 C           ZDAYN1    ADD  1         ZDAYN1
0624 C**
0625 C**   CALCULATE DAY OF MONTH.
0626 C           ZDAYN1    SUB  ZMDY,ZWRK2ZDAY    20       DAY
0627 C**
0628 C**   ADD BACK LEAP YEAR 29TH FEBUARY ADJUSTMENT, IF REQUIRED.
0629 C   93      ZDAY      ADD  1         ZDAY
0630 C**
0631 C**   FORMAT DATE, DDMMYY OR MMDDYY.
0632 C  N98                MOVELZDAY      ZWRK4   40
0633 C   98                MOVE ZDAY      ZWRK4
0634 C  N98                MOVE ZMTH      ZWRK4
0635 C   98                MOVELZMTH      ZWRK4
0636 C                     MOVELZWRK4     ZDATE
0637 C                     MOVE ZYEAR     ZDATE
0638 C**
0639 C**   FORMAT ALPHA DATE, DDMMMYY.
0640 C           ZDAY      COMP 10                     95
0641 C                     MOVELZDAY      ZWRK5   5
0642 C   95                MOVEL' '       ZWRK5
0643 C                     MOVE ZMNM,ZMTH ZWRK5
0644 C                     MOVELZWRK5     ZADATE
0645 C                     MOVE ZYEAR     ZADATE
0646 C**
0647 C           ZDEND2    ENDSR                           * ZDEND2 ENDSR*
0648 C**
0649 C**
     C/COPY WNCPYSRC,EM0610C033
0650 C********************************************************************
0651 C/EJECT
0652 O********************************************************************
0653 O*
0654 O*   REPORT TITLES
0655 O*
0656 OEM0610P1E  203           HEADER                                     S01124
0658 O**********                         22 'REFERENCE EM0610'            S01117
0658 O                                   22 'REFERENCE EM0610P1'          S01117
0659 O                         TITLE     81
0660 O                                  104 'DATE'
0661 O                         RUNDAT   112
0662 O                                  122 'PAGE'
0663 O                         PAGE     127
0664 O*
0665 O        E  1             HEADER
0667 O                                   61 'LIMIT/EXPOSURE/AVAILABIL'
0668 O                                   81 'ITY REPORT BY PARENT'
0669 O                                   95 'IN 000''S OF'
     O/COPY WNCPYSRC,EM0610O010
0670 O                         CURRNM   110
0671 O                 U1               132 '* EXCEPTION REPORT *'
0672 O*
0673 O        E  1             HEADER
0675 O*
0676 O                                   61 '------------------------'
0677 O                                   81 '--------------------'
0678 O*
0679 O        E  1             HEADER
0681 O******                            128 'OFF-SETTING'                 S01117
0681 O                                  130 'OFF-SETTING'                 S01117
0682 O*
0683 O        E  2             HEADER
0685 O                                   26 ' PARENT NUMBER / NAME /'
0686 O                                   31 ' TOWN'
0687 O                                   50 'TYPE'
0688 O                                   70 'LIMIT'
0689 O                                   90 'EXPOSURE'
0690 O                                  109 'AVAILABILITY'
0691 O******                            126 'BALANCE'                     S01117
0691 O                                  128 'BALANCE'                     S01117
0692 O*
0693 O********************************************************************
0694 O**
0695 O**   DATABASE ERROR OUTPUT
0696 O**
0697 O**      E 3      99      DTBASE                                     S01117
0698 O**                                 48 '**** DATABASE ERROR ****'    S01117
0699 O**      E 3      99      DTBASE                                     S01117
0700 O**                                 34 '************************'    S01117
0701 O**                                 58 '************************'    S01117
0702 O**                                 64 '******'                      S01117
0703 O**      E 1      99      DTBASE                                     S01117
0704 O**                                 11 '*'                           S01117
0705 O**                                 64 '*'                           S01117
0706 O**      E 1      99      DTBASE                                     S01117
0707 O**                                 29 '*    FILE NAME    '''        S01117
0708 O**                       DBFILE    34                               S01117
0709 O**                                 35 ''''
0710 O**                                 64 '*'                           S01117
0711 O**      E 1      99      DTBASE                                     S01117
0712 O**                                 29 '*    KEY          '''        S01117
0713 O**                       DBKEY     58                               S01117
0714 O**                                 64 '''    *'                     S01117
0715 O**      E 1      99      DTBASE                                     S01117
0716 O**                                 29 '*    PROGRAM NAME '''        S01117
0717 O**                       DBPGM     37                               S01117
0718 O**                                 38 ''''                          S01117
0719 O**                                 64 '*'                           S01117
0720 O**      E 1      99      DTBASE                                     S01117
0721 O**                                 29 '*    AT           '''        S01117
0722 O**                       DBASE     31                               S01117
0723 O**                                 32 ''''                          S01117
0724 O**                                 64 '*'                           S01117
0725 O**      E 1      99      DTBASE                                     S01117
0726 O**                                 11 '*'                           S01117
0727 O**                                 64 '*'                           S01117
0728 O**      E 1      99      DTBASE                                     S01117
0729 O**                                 34 '************************'    S01117
0730 O**                                 58 '************************'    S01117
0731 O**                                 64 '******'                      S01117
0732 O********************************************************************S01117
0733 O/EJECT
0734 O********************************************************************
0735 O***     E  2    NU1N60   DETAIL                                     S01129
0735 O        E 12    NU1N60   DET1                                       S01129
0737 O       OR        U1 40N60
0739 O                         CCNUM      6
0740 O                         CCRNM     28
0741 O                         CCTWN     40
0735 O********E**0    NU1N60   DET1                                S01129 S01332
0735 O        E  1    NU1N60   DET1                                       S01332
0737 O       OR        U1 40N60                                           S01129
0760 O                                   25 'EXPIRY DATE'                 S01129
0761 O                         ZADATE    33                               S01129
0742 O*
0735 O        E  1    NU1N60   DETFX                                      S01129
0737 O       OR        U1 40N60                                           S01129
0743 O                                   50 'FX'
0744 O*****                    LIM,1 1   70                               CTI002
0744 O                         LIM,1 J   70                               CTI002
0745 O*****                    EXP,1 1   90                               CTI002
0745 O                         EXP,1 J   90                               CTI002
0746 O                         AVA,1 J  110
     O*****                    OSB,1 1  130                        S01128 CTI002
     O                         OSB,1 J  130                               CTI002
0747 O***     E  1    NU1N60   DETAIL                                     S01129
0747 O        E  1    NU1N60   DETMM                                      S01129
0749 O       OR        U1 40N60
0751 O                                   50 'MM'
0752 O*****                    LIM,2 1   70                               CTI002
0752 O                         LIM,2 J   70                               CTI002
0753 O*****                    EXP,2 1   90                               CTI002
0753 O                         EXP,2 J   90                               CTI002
0754 O                         AVA,2 J  110
0755 O*****                    OSB,2 1  130                               CTI002
0755 O                         OSB,2 J  130                               CTI002
0756 O***     E  1    NU1N60   DETAIL                                     S01129
0756 O        E  1    NU1N60   DETLN                                      S01129
0758 O       OR        U1 40N60
0760 O***                                25 'EXPIRY DATE'                 S01129
0761 O***                      ZADATE    33                               S01129
0762 O                                   50 'LOANS'                       S01129
0763 O*****                    LIM,3 1   70                               CTI002
0763 O                         LIM,3 J   70                               CTI002
0764 O*****                    EXP,3 1   90                               CTI002
0764 O                         EXP,3 J   90                               CTI002
0765 O                         AVA,3 J  110
0766 O*****                    OSB,3 1  130                               CTI002
0766 O                         OSB,3 J  130                               CTI002
0767 O***     E  1    NU1N60   DETAIL                                     S01129
0767 O        E  1    NU1N60   DETRE                                      S01129
0769 O       OR        U1 40N60
0771 O**********                         50 'RE'                          S01332
     O/COPY WNCPYSRC,EM0610O001
0771 O                                   50 'RETAIL'                      S01332
     O/COPY WNCPYSRC,EM0610O002
0772 O*****                    LIM,4 1   70                               CTI002
0772 O                         LIM,4 J   70                               CTI002
0773 O*****                    EXP,4 1   90                               CTI002
0773 O                         EXP,4 J   90                               CTI002
0774 O                         AVA,4 J  110
0775 O*****                    OSB,4 1  130                               CTI002
0775 O                         OSB,4 J  130                               CTI002
0776 O***     E  1    NU1N60   DETAIL                                     S01129
0776 O********E**1    NU1N60   DETLC                              S01129  S01196
0778 O*******OR**      U1 40N60                                           S01196
0780 O*************                      50 'L/C'                         S01196
0781 O*************            LIM,5 J   70                               S01196
0782 O*************            EXP,5 1   90                               CTI002
0782 O*                        EXP,5 J   90                               CTI002
0783 O*                        AVA,5 J  110
0784 O*
0785 O***     E  1    NU1N60   DETAIL                                     S01129
0787 O***    OR        U1 40N60                                           S01129
0789 O***                                50 'SEC TR'                      S01129
0790 O***                      LIM,6 1   70                               S01129
0791 O***                      EXP,6 1   90
0792 O***                      AVA,6 1  110
0793 O*
0767 O        E  1    NU1N60   DETSC                                      S01129
0769 O       OR        U1 40N60                                           S01129
0771 O                                   50 'ST-C/P'                      S01129
0772 O*****                    LIM,6 1   70                        S01129 CTI002
0772 O                         LIM,6 J   70                               CTI002
0773 O*****                    EXP,6 1   90                        S01129 CTI002
0773 O                         EXP,6 J   90                               CTI002
0774 O                         AVA,6 J  110                               S01129
0767 O        E  1    NU1N60   DETSI                                      S01129
0769 O       OR        U1 40N60                                           S01129
0771 O                                   50 'ST-ISS'                      S01129
0772 O*****                    LIM,7 1   70                        S01129 CTI002
0772 O                         LIM,7 J   70                               CTI002
0773 O*****                    EXP,7 1   90                        S01129 CTI002
0773 O                         EXP,7 J   90                               CTI002
0774 O                         AVA,7 J  110                               S01129
0767 O        E  1    NU1N60   DETSP                                      S01129
0769 O       OR        U1 40N60                                           S01129
0771 O                                   50 'ST-P/F'                      S01129
0775 O                         OSB,8 J  130                               173911
0775 O**********               OSB,8 J  131                         E14725173911
0775 O********                 OSB,8 1  130                         S01129E14725
0794 O***     E  2    NU1N60   DETAIL                                     S01129
0794 O********E**1    NU1N60   DETFI                               S01129 S01332
0796 O*******OR**      U1 40N60                                           S01332
0798 O**********                         50 'FIN FUT'                     S01332
0799 O***                      LIM,7 1   70                               S01129
0799 O**********               LIM,9 1   70                        S01129 S01332
0800 O*                        EXP,7 1   90
0801 O*                        AVA,7 J  110
     O/COPY WNCPYSRC,EM0610O007
0767 O        E  1    NU1N60   DETFR                                      S01332
0769 O       OR        U1 40N60                                           S01332
0771 O                                   50 'FRA'                         S01332
0772 O*****                    LIM,5 1   70                        S01332 CTI002
0772 O                         LIM,5 J   70                               CTI002
0773 O*****                    EXP,5 1   90                        S01332 CTI002
0773 O                         EXP,5 J   90                               CTI002
0774 O                         AVA,5 J  110                               S01332
0775 O*****                    OSB,5 1  130                        S01332 CTI002
0775 O                         OSB,5 J  130                               CTI002
0767 O        E  1    NU1N60   DETIR                                      S01332
0769 O       OR        U1 40N60                                           S01332
0771 O                                   50 'IRS'                         S01332
0772 O*****                    LIM,9 1   70                        S01332 CTI002
0772 O                         LIM,9 J   70                               CTI002
0773 O*****                    EXP,9 1   90                        S01332 CTI002
0773 O                         EXP,9 J   90                               CTI002
0774 O                         AVA,9 J  110                               S01332
0775 O*****                    OSB,9 1  130                        S01332 CTI002
0775 O                         OSB,9 J  130                               CTI002
     O/COPY WNCPYSRC,EM0610O011
0767 O        E  1    NU1N60   DETFU                                      S01332
0769 O       OR        U1 40N60                                           S01332
0771 O                                   50 'FUTURES'                     S01332
0772 O*****                    LIM,101   70                        S01332 CTI002
0772 O                         LIM,10J   70                               CTI002
0773 O*****                    EXP,101   90                        S01332 CTI002
0773 O                         EXP,10J   90                               CTI002
0774 O                         AVA,10J  110                               S01332
0775 O*****                    OSB,101  130                        S01332 CTI002
0775 O                         OSB,10J  130                               CTI002
0767 O        E  1    NU1N60   DETOP                                      S01332
0769 O       OR        U1 40N60                                           S01332
0771 O                                   50 'OPTIONS'                     S01332
0772 O*****                    LIM,111   70                        S01332 CTI002
0772 O                         LIM,11J   70                               CTI002
0773 O*****                    EXP,111   90                        S01332 CTI002
0773 O                         EXP,11J   90                               CTI002
0774 O                         AVA,11J  110                               S01332
0775 O*****                    OSB,111  130                        S01332 CTI002
0775 O                         OSB,11J  130                               CTI002
0742 O*                                                                   CTI002
0735 O        E  1    NU1N60   DETTF                                      CTI002
0737 O       OR        U1 40N60                                           CTI002
0743 O                                   50 'TF'                          CTI002
0744 O                         LIM,12J   70                               CTI002
0745 O                         EXP,12J   90                               CTI002
0746 O                         AVA,12J  110                               CTI002
     O                         OSB,12J  130                               CTI002
0802 O*
     O/COPY WNCPYSRC,EM0610O016
0803 O***     E  3    NU1N60   DETAIL                                     S01129
0803 O********E*13    NU1N60   DET2                                S01129 S01332
0803 O        E 11    NU1N60   DET2                                       S01332
0805 O       OR        U1 40N60
0807 O****                                   50 'TOTAL'                   S01128
0807 O                                   50 'OVERALL'                     S01128
0808 O*****                    MOAL  1   70                               CTI002
0808 O                         MOAL  J   70                               CTI002
0809 O*****                    EXPTOT1   90                               CTI002
0809 O                         EXPTOTJ   90                               CTI002
0810 O                         AVATOTJ  110
0811 O                         OSBTOTJ  130                               173911
0811 O**********               OSBTOTJ  131                         E14725173911
0811 O********                 OSBTOT1  130                               E14725
     O        E 11     77NU1N60DET2                                       S01332
0805 O       OR        U1 40N60                                           S01332
     O       AND       77                                                 S01332
1596 O                                   50 'EXCLUDES:'                   S01332
     O                         EXC      116                               S01332
0812 O/EJECT
0813 O*
0814 O**       CUSTOMERS WITH NO LIMITS TOTALS
0815 O*
0816 O***     T  2     LRNU1N99                                           S01129
0816 O        E 12             CNOLM1                                     S01129
0817 O                                   23 'PARENTS WITH NO LIMITS'
0818 O*
0822 O        E  1             CNLFX                                      S01129
0819 O                                   50 'FX'
0820 O*****                    NLE,1 1   90                               CTI002
0820 O                         NLE,1 J   90                               CTI002
0821 O                         NLA,1 J  110
     O*****                    NLO,1 1  130                        S01128 CTI002
     O                         NLO,1 J  130                               CTI002
0822 O***     T  1     LRNU1N99                                           S01129
0822 O        E  1             CNLMM                                      S01129
0823 O                                   50 'MM'
0824 O*****                    NLE,2 1   90                               CTI002
0824 O                         NLE,2 J   90                               CTI002
0825 O                         NLA,2 J  110
0826 O*****                    NLO,2 1  130                               CTI002
0826 O                         NLO,2 J  130                               CTI002
0827 O***     T  1     LRNU1N99                                           S01129
0822 O        E  1             CNLLN                                      S01129
0828 O                                   50 'LOANS'
0829 O*****                    NLE,3 1   90                               CTI002
0829 O                         NLE,3 J   90                               CTI002
0830 O                         NLA,3 J  110
0831 O*****                    NLO,3 1  130                               CTI002
0831 O                         NLO,3 J  130                               CTI002
0832 O***     T  1     LRNU1N99                                           S01129
0822 O        E  1             CNLRE                                      S01129
0833 O**********                         50 'RE'                          S01332
     O/COPY WNCPYSRC,EM0610O003
0833 O                                   50 'RETAIL'                      S01332
     O/COPY WNCPYSRC,EM0610O004
0834 O*****                    NLE,4 1   90                               CTI002
0834 O                         NLE,4 J   90                               CTI002
0835 O                         NLA,4 J  110
0836 O*****                    NLO,4 1  130                               CTI002
0836 O                         NLO,4 J  130                               CTI002
0837 O***     T  1     LRNU1N99                                           S01129
0822 O********E**1             CNLLC                               S01129 S01196
0838 O*************                      50 'L/C'                         S01196
0839 O***                      NLE,5 1   90
0840 O***                      NLA,5 J  110
0841 O*
0842 O***     T  1     LRNU1N99                                           S01129
0843 O***                                50 'SEC TR'                      S01129
0844 O*                        NLE,6 1   90
0845 O*                        NLA,6 J  110
0846 O*
0822 O        E  1             CNLSC                                      S01129
0838 O                                   50 'ST-C/P'                      S01129
0839 O*****                    NLE,6 1   90                        S01129 CTI002
0839 O                         NLE,6 J   90                               CTI002
0840 O                         NLA,6 J  110                               S01129
0822 O        E  1             CNLSI                                      S01129
0838 O                                   50 'ST-ISS'                      S01129
0839 O*****                    NLE,7 1   90                        S01129 CTI002
0839 O                         NLE,7 J   90                               CTI002
0840 O                         NLA,7 J  110                               S01129
0822 O        E  1             CNLSP                                      S01129
0838 O                                   50 'ST-P/F'                      S01129
0839 O*****                    NLO,8 1  130                        S01129 CTI002
0839 O                         NLO,8 J  130                               CTI002
0847 O***     T  2     LRNU1N99                                           S01129
0822 O********E**1             CNLFI                               S01129 S01332
0848 O**********                         50 'FIN FUT'                     S01332
0849 O*                        NLE,7 1   90
0850 O*                        NLA,7 J  110
     O/COPY WNCPYSRC,EM0610O008
0822 O        E  1             CNLFR                                      S01332
0819 O                                   50 'FRA'                         S01332
0820 O*****                    NLE,5 1   90                        S01332 CTI002
0820 O                         NLE,5 J   90                               CTI002
0821 O                         NLA,5 J  110                               S01332
     O*****                    NLO,5 1  130                        S01332 CTI002
     O                         NLO,5 J  130                               CTI002
0822 O        E  1             CNLIR                                      S01332
0819 O                                   50 'IRS'                         S01332
0820 O*****                    NLE,9 1   90                        S01332 CTI002
0820 O                         NLE,9 J   90                               CTI002
0821 O                         NLA,9 J  110                               S01332
     O*****                    NLO,9 1  130                        S01332 CTI002
     O                         NLO,9 J  130                               CTI002
     O/COPY WNCPYSRC,EM0610O013
0822 O        E  1             CNLFU                                      S01332
0819 O                                   50 'FUTURES'                     S01332
0820 O*****                    NLE,101   90                        S01332 CTI002
0820 O                         NLE,10J   90                               CTI002
0821 O                         NLA,10J  110                               S01332
     O*****                    NLO,101  130                        S01332 CTI002
     O                         NLO,10J  130                               CTI002
0822 O        E  1             CNLOP                                      S01332
0819 O                                   50 'OPTIONS'                     S01332
0820 O*****                    NLE,111   90                        S01332 CTI002
0820 O                         NLE,11J   90                               CTI002
0821 O                         NLA,11J  110                               S01332
     O*****                    NLO,111  130                        S01332 CTI002
     O                         NLO,11J  130                               CTI002
0818 O*                                                                   CTI002
0822 O        E  1             CNLTF                                      CTI002
0819 O                                   50 'TF'                          CTI002
0820 O                         NLE,12J   90                               CTI002
0821 O                         NLA,12J  110                               CTI002
     O                         NLO,12J  130                               CTI002
     O/COPY WNCPYSRC,EM0610O017
0851 O*
0852 O***     T  3     LRNU1N99                                           S01129
0853 O*******                                   50 'TOTAL'                S01128
0816 O********E*13             CNOLM2                              S01129 S01332
0816 O        E 11             CNOLM2                                     S01332
0853 O                                   50 'OVERALL'                     S01128
     O/COPY WNCPYSRC,EM0610O019
0854 O*****                    EXPTOT1   90                               CTI002
0854 O                         EXPTOTJ   90                               CTI002
0855 O                         AVATOTJ  110
0856 O*****                    OSBTOT1  130                               CTI002
0856 O                         OSBTOTJ  130                               CTI002
     O        E 11     77      CNOLM2                                     S01332
1596 O                                   50 'EXCLUDES:'                   S01332
     O                         EXC      116                               S01332
0857 O/EJECT
0858 O*
0859 O* GRAND TOTALS FOR FULL REPORT
0860 O*
0861 O***     T  2     LRNU1N99                                           S01129
0861 O        E 12             TOTS1                                      S01129
0862 O                                   25 '*** TOTAL FOR ALL PARENT'
0863 O                                   30 'S ***'
0864 O*
0865 O*
0861 O        E  1             TOTFX                                      S01129
0866 O                                   50 'FX'
0867 O*****                    TTL,1 1   70                               CTI002
0867 O                         TTL,1 J   70                               CTI002
0868 O*****                    TTE,1 1   90                               CTI002
0868 O                         TTE,1 J   90                               CTI002
0869 O                         TTA,1 J  110
     O*****                    TTO,1 1  130                        S01128 CTI002
     O                         TTO,1 J  130                               CTI002
0870 O***     T  1     LRNU1N99                                           S01129
0861 O        E  1             TOTMM                                      S01129
0871 O                                   50 'MM'
0872 O*****                    TTL,2 1   70                               CTI002
0872 O                         TTL,2 J   70                               CTI002
0873 O*****                    TTE,2 1   90                               CTI002
0873 O                         TTE,2 J   90                               CTI002
0874 O                         TTA,2 J  110
0875 O*****                    TTO,2 1  130                               CTI002
0875 O                         TTO,2 J  130                               CTI002
0876 O***     T  1     LRNU1N99                                           S01129
0861 O        E  1             TOTLN                                      S01129
0877 O                                   50 'LOANS'
0878 O*****                    TTL,3 1   70                               CTI002
0878 O                         TTL,3 J   70                               CTI002
0879 O*****                    TTE,3 1   90                               CTI002
0879 O                         TTE,3 J   90                               CTI002
0880 O                         TTA,3 J  110
0881 O*****                    TTO,3 1  130                               CTI002
0881 O                         TTO,3 J  130                               CTI002
0882 O***     T  1     LRNU1N99                                           S01129
0861 O        E  1             TOTRE                                      S01129
0883 O**********                         50 'RE'                          S01332
     O/COPY WNCPYSRC,EM0610O005
0883 O                                   50 'RETAIL'                      S01332
     O/COPY WNCPYSRC,EM0610O006
0884 O*****                    TTL,4 1   70                               CTI002
0884 O                         TTL,4 J   70                               CTI002
0885 O*****                    TTE,4 1   90                               CTI002
0885 O                         TTE,4 J   90                               CTI002
0886 O                         TTA,4 J  110
0887 O*****                    TTO,4 1  130                               CTI002
0887 O                         TTO,4 J  130                               CTI002
0888 O***     T  1     LRNU1N99                                           S01129
0861 O********E**1             TOTLC                                S01129S01196
0889 O*************                      50 'L/C'                         S01196
0890 O*************            TTL,5 1   70                               S01196
0891 O*                        TTE,5 1   90
0892 O*                        TTA,5 J  110
0893 O*
0894 O***     T  1     LRNU1N99                                           S01129
0895 O***                                50 'SEC TR'                      S01129
0896 O***                      TTL,6 1   70                               S01129
0897 O*                        TTE,6 1   90
0898 O*                        TTA,6 J  110
0899 O*
0861 O        E  1             TOTSC                                      S01129
0871 O                                   50 'ST-C/P'                      S01129
0872 O*****                    TTL,6 1   70                        S01129 CTI002
0872 O                         TTL,6 J   70                               CTI002
0873 O*****                    TTE,6 1   90                        S01129 CTI002
0873 O                         TTE,6 J   90                               CTI002
0874 O                         TTA,6 J  110                               S01129
0861 O        E  1             TOTSI                                      S01129
0871 O                                   50 'ST-ISS'                      S01129
0872 O*****                    TTL,7 1   70                        S01129 CTI002
0872 O                         TTL,7 J   70                               CTI002
0873 O*****                    TTE,7 1   90                        S01129 CTI002
0873 O                         TTE,7 J   90                               CTI002
0874 O                         TTA,7 J  110                               S01129
0861 O        E  1             TOTSP                                      S01129
0871 O                                   50 'ST-P/F'                      S01129
0881 O*****                    TTO,8 1  130                        S01129 CTI002
0881 O                         TTO,8 J  130                               CTI002
0900 O***     T  2     LRNU1N99                                           S01129
0861 O********E**1             TOTFI                               S01129 S01332
0901 O**********                         50 'FIN FUT'                     S01332
0902 O***                      TTL,7 1   70                               S01129
0902 O**********               TTL,9 1   70                        S01129 S01332
0903 O*                        TTE,7 1   90
0904 O*                        TTA,7 J  110
     O/COPY WNCPYSRC,EM0610O009
0861 O        E  1             TOTFR                                      S01332
0883 O                                   50 'FRA'                         S01332
0884 O*****                    TTL,5 1   70                        S01332 CTI002
0884 O                         TTL,5 J   70                               CTI002
0885 O*****                    TTE,5 1   90                        S01332 CTI002
0885 O                         TTE,5 J   90                               CTI002
0886 O                         TTA,5 J  110                               S01332
0887 O*****                    TTO,5 1  130                        S01332 CTI002
0887 O                         TTO,5 J  130                               CTI002
0861 O        E  1             TOTIR                                      S01332
0883 O                                   50 'IRS'                         S01332
0884 O*****                    TTL,9 1   70                        S01332 CTI002
0884 O                         TTL,9 J   70                               CTI002
0885 O*****                    TTE,9 1   90                        S01332 CTI002
0885 O                         TTE,9 J   90                               CTI002
0886 O                         TTA,9 J  110                               S01332
0887 O*****                    TTO,9 1  130                        S01332 CTI002
0887 O                         TTO,9 J  130                               CTI002
     O/COPY WNCPYSRC,EM0610O014
0861 O        E  1             TOTFU                                      S01332
0883 O                                   50 'FUTURES'                     S01332
0884 O*****                    TTL,101   70                        S01332 CTI002
0884 O                         TTL,10J   70                               CTI002
0885 O*****                    TTE,101   90                        S01332 CTI002
0885 O                         TTE,10J   90                               CTI002
0886 O                         TTA,10J  110                               S01332
0887 O*****                    TTO,101  130                        S01332 CTI002
0887 O                         TTO,10J  130                               CTI002
0861 O        E  1             TOTOP                                      S01332
0883 O                                   50 'OPTIONS'                     S01332
0884 O*****                    TTL,111   70                        S01332 CTI002
0884 O                         TTL,11J   70                               CTI002
0885 O*****                    TTE,111   90                        S01332 CTI002
0885 O                         TTE,11J   90                               CTI002
0886 O                         TTA,11J  110                               S01332
0887 O*****                    TTO,111  130                        S01332 CTI002
0887 O                         TTO,11J  130                               CTI002
0865 O*                                                                   CTI002
0861 O        E  1             TOTTF                                      CTI002
0866 O                                   50 'TF'                          CTI002
0867 O                         TTL,12J   70                               CTI002
0868 O                         TTE,12J   90                               CTI002
0869 O                         TTA,12J  110                               CTI002
     O                         TTO,12J  130                               CTI002
     O/COPY WNCPYSRC,EM0610O020
0905 O*
0906 O***     T  3     LRNU1N99                                           S01129
0861 O********E*13             TOTS2                               S01129 S01332
0861 O        E 11             TOTS2                                      S01332
0907 O******                                   50 'TOTAL'                 S01128
0907 O                                   50 'OVERALL'                     S01128
0908 O*****                    GRDTTL1   70                               CTI002
0908 O                         GRDTTLJ   70                               CTI002
0909 O*****                    GRDTTE1   90                               CTI002
0909 O                         GRDTTEJ   90                               CTI002
0910 O                         GRDTTAJ  110
0911 O*****                    GRDTTO1  130                               CTI002
0911 O                         GRDTTOJ  130                               CTI002
     O        E 11     77      TOTS2                                      S01332
1596 O                                   50 'EXCLUDES:'                   S01332
     O                         EXC      116                               S01332
     O*                                                                   S01117
     O        T 22     LR 42NU7                                           S01117
     O       AND      NU8                                                 S01117
0914 O**********                  85 '* NO DEATILS TO REPORT *'    S01117 S01332
0914 O                                   85 '* NO DETAILS TO REPORT *'    S01332
     O*                                                                   S01117
0913 O********T 2      LR                                                 S01117
0913 O        T 2      LRNU7NU8                                           S01117
0914 O                                   80 '*** END OF REPORT ***'
     O*****************************************************************   S01117
0656 OEM0610AUE  203           DTBASE                                     S01117
0658 O                                   22 'REFERENCE EM0610AU'          S01117
0659 O                         TITLE     81                               S01117
0660 O                                  104 'DATE'                        S01117
0661 O                         RUNDAT   112                               S01117
0662 O                                  122 'PAGE'                        S01117
0663 O                         PAGE1    127                               S01117
0694 O**                                                                  S01117
0695 O**   DATABASE ERROR OUTPUT                                          S01117
0696 O**                                                                  S01117
0697 O        E 3              DTBASE                                     S01117
0698 O                                   51 '**** DATABASE ERROR ****'    S01117
0699 O        E 3              DTBASE                                     S01117
0700 O                                   34 '************************'    S01117
0701 O                                   58 '************************'    S01117
0702 O                                   70 '************'                S01117
0703 O        E 1              DTBASE                                     S01117
0704 O                                   11 '*'                           S01117
0705 O                                   70 '*'                           S01117
0706 O        E 1              DTBASE                                     S01117
0707 O                                   29 '*    FILE NAME    '''        S01117
0708 O                         DBFILE    40                               S01117
0709 O                                   41 ''''                          S01117
0710 O                                   70 '*'                           S01117
0711 O        E 1              DTBASE                                     S01117
0712 O                                   29 '*    KEY          '''        S01117
0713 O                         DBKEY     64                               S01117
0714 O                                   70 '''    *'                     S01117
0715 O        E 1              DTBASE                                     S01117
0716 O                                   29 '*    PROGRAM NAME '''        S01117
0717 O                         DBPGM     43                               S01117
0718 O                                   44 ''''                          S01117
0719 O                                   70 '*'                           S01117
0720 O        E 1              DTBASE                                     S01117
0721 O                                   29 '*    AT           '''        S01117
0722 O                         DBASE     37                               S01117
0723 O                                   38 ''''                          S01117
0724 O                                   70 '*'                           S01117
0725 O        E 1              DTBASE                                     S01117
0726 O                                   11 '*'                           S01117
0727 O                                   70 '*'                           S01117
0728 O        E 1              DTBASE                                     S01117
0729 O                                   34 '************************'    S01117
0730 O                                   58 '************************'    S01117
0731 O                                   70 '************'                S01117
0913 O        E 2              DTBASE                                     S01117
0914 O                                   83 '*** END OF REPORT ***'       S01117
0732 O********************************************************************S01117
0664 O*                                                                   S01117
      **  S01332 - CHANGE REPORT SEQUENCE ARRAY - REMOVE LETTERS OF       S01332
      **           CREDIT & FINANCIAL FUTURES AND ADD FRA, IRS,           S01332
      **           FUTURES & OPTIONS                                      S01332
      **                                                                  S01332
**  CPY@
(c) Finastra International Limited 2001
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
**  REPORT SEQUENCE                                                       S01129
FXMMLNREFRSCSISPFUOPIRTF                                     S011296S01332CTI002
**  XCL - EXCLUDED AREAS TEXT                                             S01332
FX,                                                                       S01332
MM,                                                                       S01332
Loans,                                                                    S01332
FRA,                                                                      S01332
IRS,                                                                      S01332
Futures,                                                                  S01332
Options,                                                                  S01332
SE-C/p,                                                                   S01332
SE-Iss,                                                                   S01332
Retail,                                                                   S01332
TF                                                                        CTI002
