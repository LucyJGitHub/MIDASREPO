      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas ER Book code/Investment - setup ERBKIVPD')
      *****************************************************************
      *                                                               *
      *   MIDAS/ABS  EUROPEAN REPORTING                               *
      *                                                               *
      *   ER0050X - BOOK CODE / INVESTMENT TYPE - SETUP PF/ERBKIVPD   *
      *                                                               *
      *  (c) Finastra International Limited 2005                      *
      *                                                               *
      *  Last Amend No. MD046248           Date 27Oct17               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *  Prev Amend No. CSD027A            Date 03May06               *
      *                 CER001             Date 25Apr05               *
      *                 ER_R10             Date 11May95               *
      *                 ERL370 TLI         Date 02Sep93               *
      *                                                               *
      *****************************************************************
      *  MD046248 - Finastra Rebranding                               *
      *  CSD027A - Conversion of customer number to alpha (post       *
      *            build 103). Recompiled.                            *
      *  CER001 - LUX Upgrade to MidasPlus                            *
      *   ER_R10 - IML INCORPORATION IN R10                           *
      *   ERL370 - BOOK CODE / INVESTMENT TYPE DEVELOPMENT            *
     F*****************************************************************
     FERBKIVPDO   E           K        DISK                      A
     FBOOKD   IF  E           K        DISK
     FINVTO   IF  E           K        DISK
     FERBANKPDIF  E                    DISK
      /EJECT
     F*                  FUNCTION OF INDICATORS
     F*
     F*       01         BOOKD    - End Of File
     F*       02         INVTO    - End Of File
     F*       LR         Last Record
      /EJECT
     C                     READ ERBANKPD                 99
     C*
     C** Read record from main file BOOKD
     C*
     C                     READ BOOKD                    01
     C*
     C** Do while not end of file BOOKD
     C*
     C           *IN01     DOWEQ'0'                        - B1
     C*
     C** LOOP ON INVESTMENT TYPE
     C           *LOVAL    SETLLINVTO
     C                     READ INVTO                    02
     C                     MOVE *BLANKS   WWINVT  3
     C*
     C           *IN02     DOWEQ'0'                        - B2
     C*
     C           WWINVT    IFNE INVT                       - B3
     C                     EXSR W001
     C                     END                             - E3
     C*
     C                     MOVE INVT      WWINVT
     C                     READ INVTO                    02
     C*
     C                     END                             - E2
     C*
     C** Read record from main file BOOKD
     C*
     C                     READ BOOKD                    01
     C*
     C                     END                             E1
     C*
     C** Terminate program
     C*
     C                     MOVE '1'       *INLR
     C                     RETRN
     C**************************************************************************
     C* W001 - WRITE A RECORD                                                  *
     C**************************************************************************
     C           W001      BEGSR
     C*
     C                     MOVE BOKC      BIBOKC  2
     C                     MOVE INVT      BIINVT  3
     C                     MOVE *BLANKS   BITIFA  1
     C                     MOVE *BLANKS   BIEVAM  10
     C***********          Z-ADDRUND      BILCD   50                      ER_R10
     C                     Z-ADDBJRDNB    BILCD   50                      ER_R10
     C                     MOVE 'I'       BITYLC  1
     C*
     C                     WRITEERBKIVPR
     C*
     C                     ENDSR
     C**************************************************************************
