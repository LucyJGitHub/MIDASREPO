     H        1   Y
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas ER Account Code Details')                        *
      *****************************************************************
      *                                                               *
      *  Midas - European Reporting Module - Italy                    *
      *                                                               *
      *  ERIT78 - Account Code Details                                *
      *                                                               *
      *  Called By: RPG/ERIT60                                        *
      *                                                               *
      *  (C) Copyright Midas-Kapiti International Ltd. 1997.          *
      *                                                               *
      *  Last Amend No. MD058100           Date 20May21               *
      *  Prev Amend No. LUC139 *Amend      Date 16Mar21               *
      *                 LUC139             Date 04Jan21               *
      *                 UIT021             Date 29JAN97               *
      *                                                               *
      *---------------------------------------------------------------*
      *                                                               *
      *  MD058100 - Rollup of additional BoI onsite fixes at FbMidas  *
      *  LUC139 - Set EXDECK = 14A                                    *
      *  LUC139 - Upgrade UCI Italian Returns                         *
      *  UIT021 - Bank of Italy Monthly Reporting                     *
      *                                                               *
      *****************************************************************
     F****SDACODL1IF  E           K        DISK
      **** SD Account code details - Master file
      **** NO MORE DOWNLOAD NEEDED
      ****  Must be Downloaded  ***  Must be Downloaded  ***  Must be Downloaded
      *
     FSDACT1L0IF  E           K        DISK
     F* Account Code Details Italy Extension File
      *
      *===============================================================*
     E** ARRAY FOR COPYRIGHT
     E                    CPY@    1   1 80
      *===============================================================*
     I*
     I** LOCAL DATA AREA FOR DATABASE ERROR DETAILS
     I*
     ILDA        UDS                            256
     I                                      134 141 DBFILE
     I                                      142 170 DBKEY
     I                                      171 180 DBPGM
     I                                      181 183 DBASE
     I**
     I*  DATA STRUCTURE FOR COMPILATION  - COPYRIGHT INSERTION
     I**
     ICPYR@#      DS
     I                                        1  80 CPY@
     I                                        1  20 CPY@##
      *
      * Program status data structure
     I           SDS
     I                                     *PROGRAM PGM
      **=================================================================
     C                     EXSR #INIT
      *----------------------------------------------------------------==
      *
      ** Access Account Codes
      *
     C                     MOVELEXDECK    KACOD  10
      ****
      ***Retrieve if Account code is 'AS' or 'LI'
     C****       KACOD     CHAINSDACODL1             80
     C****       *IN80     IFEQ '1'                        - B1
     C****       *LOCK     IN   LDA
     C****                 MOVEL'781'     DBASE            ******************
     C****                 MOVEL'SDACODPD'DBFILE           ** DB ERROR 781 **
     C****                 MOVELKACOD     DBKEY            ******************
     C****                 EXSR #DBERR
     C****                 ELSE                            - X1
      *
      ** Retrieve Bank of Italy extended details
     C           KACOD     CHAINSDACT1L0             80
     C           *IN80     IFEQ '1'                        - B2
     C           *LOCK     IN   LDA
     C                     MOVEL'782'     DBASE            ******************
     C                     MOVEL'SDACT1L0'DBFILE           ** DB ERROR 782 **
     C                     MOVELKACOD     DBKEY            ******************
     C                     EXSR #DBERR
     C                     ELSE                            - X2
      *
     C****       A5ACSC    IFEQ 'AS'                       - B3
     C****                 SELEC
     C****       A5ACSC    WHEQ 'AS'                       Assets account
     C****                 MOVE PMCLAA    ICCLAC
     C****                 ELSE
     C****       A5ACSC    WHEQ 'LI'                       Liability Account
     C****                 MOVE PMCLAL    ICCLAC
     C****                 END                             - E3
      *
      ***  Account code should be Assets OR Liabilities Accounts Code
      ***  , or other but not both.
      *
     C           PMCLAA    IFEQ 99
     C                     Z-ADDPMCLAL    ICCLAC           Liability value
     C                     ELSE
     C                     Z-ADDPMCLAA    ICCLAC           Assets value
     C                     ENDIF
      *
     C                     MOVE PMMBCD    ICMBCD
      *
     C                     END                             - E2
     C****                 END                             - E1
      **=================================================================
     C                     RETRN
      **=================================================================
      **
      **  #INIT       Program initialisation sub-routine
      **
      *----------------------------------------------------------------==
     C           #INIT     BEGSR
      *----------------------------------------------------------------==
      *                                                                *****
     C           *NAMVAR   DEFN           LDA
     C                     UNLCKLDA
      *
     C           *ENTRY    PLIST
      *  Input Parameters
     C                     PARM           EXDECK 14        Decision key
      *  Output Parameters
     C                     PARM           ICCLAC  20       Class of Account
     C                     PARM           ICMBCD  20       Mobilisation code
     C                     PARM           ERROR   1
      *
     C                     MOVE '0'       *INU7
      *
     C                     ENDSR
      **=================================================================
      **
      **  #DBERR      Program-detected exception OR monitored error
      **              sub-routine.
      **
     C*================================================================
     C           #DBERR    BEGSR
      **
     C                     MOVELPGM       DBPGM
     C                     OUT  LDA
     C                     MOVE 'Y'       ERROR
     C                     MOVE '1'       *INU7
     C                     MOVE '1'       *INLR
     C                     DUMP
     C                     RETRN
     C**
     C                     ENDSR
     C********************************************************************
**  CPY@
(C) Copyright Midas-Kapiti International Ltd. 1997.
