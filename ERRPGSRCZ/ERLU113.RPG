     H        1
     H****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas ER IML Lump-Sum Rate EOM recalculation')         *
     H****************************************************************
     H*                                                              *
     H*          MIDAS ABS - EUROPEAN REPORTING                      *
     H*                                                              *
     H*        ERLU113  -  LUMP-SUM RATES EOM RECALCULATION          *
     H*                                                              *
      *  (c) Finastra International Limited 2005                      *
     H*                                                              *
      *  Last Amend No. MD046248           Date 27Oct17               *
      *  Prev Amend No. CLE134             Date 01Aug12               *
      *                 CLE148             Date 23Jul12               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD027A            Date 03May06               *
      *                 CER001             Date 25Apr05               *
      *                 ULX008             Date 24Jul00               *
      *                 169521             Date 19May00               *
     H*                 ULX008                Date 24Feb00           *
     H*                 ULX004                Date 28apr98           *
     H*                 ERL437 LV *CREATE     Date 30Aug94           *
     H*                                                              *
     H*****************************************************************
     H*                                                              *
      *  MD046248 - Finastra Rebranding                               *
      *  CLE134 - Past Due Call Loan Processing (Recompile)           *
      *  CLE148 - Alpha Loan Reference (Recompile)                    *
      *  CSD027A - Conversion of customer number to alpha (post       *
      *            build 103). Recompiled.                            *
      *  CER001 - LUX Upgrade to MidasPlus                            *
     H*  ULX008 - "Commissariat aux Bourses" - Change Control C       *
     H*           Recompiled due to changes in PF/SECTYDX6            *
     H*  169521   Recompile due to changes in PF/SECTYDX6            *
     H*  ULX008 - CSSF Statutory Reporting : Commissariat aux Bourses*
     H*           Recompile due to changes in PF/SECTYDX6            *
     H*  ULX004 - IML Circular 97/138                                *
     H*           Recompile only                                     *
     H*  ERL437 - NEW PROGRAM TO UPDATE LUMP-SUM RATES AT E.O.M.     *
     H*                                                              *
     H*****************************************************************
      /TITLE FUNCTION OF INDICATORS
     F*****************************************************************
     F*                                                               *
     F*  F U N C T I O N   O F   I N D I C A T O R S                  *
     F*  ===========================================                  *
     F*                                                               *
     F*   81      Main cycle reading.                                 *
     F*   82      Chain to ERLUMPL0                                   *
     F*   82      Access to SDBANKPD                                   *
     F*                                                               *
     F*                                                               *
     F*   SWITCHES USED IN PROGRAM                                    *
     F*                                                               *
     F*       U7         Database error                               *
     F*       U8         Database error                               *
     F*                                                               *
     F**             *************************                        *
     F**             ** INDICATORS NOT USED **                        *
     F**             ** ------------------- **                        *
     F**             *************************                        *
     F**                                                              *
     F**      ***************************************************     *
     F**      * 01   02   03   04   05   06   07   08   09   10 *     *
     F**      * 11   12   13   14   15   16   17   18   19   20 *     *
     F**      * 21   22   23   24   25   26   27   28   29   30 *     *
     F**      * 31   32   33   34   35   36   37   38   39   40 *     *
     F**      * 41   42   43   44   45   46   47   48   49   50 *     *
     F**      * 51   52   53   54   55   56   57   58   59   60 *     *
     F**      * 61   62   63   64   65   66   67   68   69   70 *     *
     F**      * 71   72   73   74   75   76   77   78   79   80 *     *
     F**      * xx   xx   xx   84   85   86   87   83   89   90 *     *
     F**      * 91   92   93   94   95   96   97   98   99      *     *
     F**      ***************************************************     *
     F*****************************************************************
      /TITLE SUBROUTINE INDEX
     F*****************************************************************
     F*                                                               *
     F*  S U B R O U T I N E   I N D E X                              *
     F*  ===============================                              *
     F*                                                               *
     F* *PSSR    - Error handling.                                    *
     F*                                                               *
     F*****************************************************************
      /TITLE FILE DEFINITION
     F*****************************************************************
     F*
     F*  F I L E   D E F I N I T I O N
     F*  =============================
     F*
     F* ER Lump-sum rates setup audit report
     FERLU113AO   E                    PRINTER
     F*
     F* ICD Bank Details
     FSDBANKPDIF  E                    DISK
     F*
     F* ER Lump-Sum Codes Table (key Lump-Sum Code)
     FERLUMPL0IF  E           K        DISK
     F*
     F* LF over all files with Lump-Sum Rates (non zero codes only)
     FERLUMPLAUF  E           K        DISK         KINFSR *PSSR
     F*
     F*****************************************************************
      /TITLE E-SPECIFICATIONS
     E*****************************************************************
     E*
     E                    CPY@    1   1 80                 COPYRIGHT STAT.
     E*
     E*****************************************************************
      /TITLE FIELDS SPECIFICATIONS
     I*****************************************************************
     I*
     I** LOCAL DATA AREA FOR DATABASE ERROR DETAILS
     I*
     ILDA        UDS                            256
     I                                      132 183 DBLOT
     I                                      132 141 DBFILE
     I                                      142 170 DBKEY
     I                                      171 180 DBPGM
     I                                      181 1830DBASE
     I*
     I** DATA STRUCTURE FOR COMPILATION  - COPYRIGHT INSERTION
     I*
     ICPYR@#      DS
     I                                        1  80 CPY@
     I                                        1  20 CPY@##
     I*
     I*****************************************************************
      /EJECT
      *****************************************************************
      /TITLE MAIN PROCESSING SPECIFICATIONS
      *----------------------------------------------------------------
      ***          M   A   I   N
      *----------------------------------------------------------------
     C*
     C*  Initialization
     C                     MOVEL*BLANKS   DBLOT
     C                     MOVEL'ERLU113 'DBPGM
     C*
     C**  Get ICD Bank Details
     C           1         SETLLSDBANKPD
     C                     READ SDBANKPD                 83
     C*
     C           *IN83     IFEQ *ON                        - B1
     C                     Z-ADD1         DBASE            ***************
     C                     MOVEL'SDBANKPD'DBFILE           **DB ERROR 01**
     C                     MOVEL'BANK'    DBKEY            ***************
     C                     EXSR *PSSR
     C                     ENDIF                           - E1
     C*
     C*  Update CLOANKX6
     C           *LOVAL    SETLLCLOANKF6               81
     C                     READ CLOANKF6                 81
     C           *IN81     DOWEQ*OFF                       - B1
     C           VKLUSU    CHAINERLUMPL0             82
     C           *IN82     IFEQ *OFF
     C                     Z-ADDLSRATE    VKLURA
     C                     ELSE
     C                     Z-ADD0         VKLURA
     C                     ENDIF
     C                     UPDATCLOANKF6
     C                     READ CLOANKF6                 81
     C                     ENDDO                           - E1
     C*
     C*  Update MMDENBX6
     C           *LOVAL    SETLLMMDENBF6               81
     C                     READ MMDENBF6                 81
     C           *IN81     DOWEQ*OFF                       - B1
     C           VMLUSU    CHAINERLUMPL0             82
     C           *IN82     IFEQ *OFF
     C                     Z-ADDLSRATE    VMLURA
     C                     ELSE
     C                     Z-ADD0         VMLURA
     C                     ENDIF
     C                     UPDATMMDENBF6
     C                     READ MMDENBF6                 81
     C                     ENDDO                           - E1
     C*
     C***Update LOANCSX6
     C********   *LOVAL    SETLLLOANCSF6               81
     C********             READ LOANCSF6                 81
     C********   *IN81     DOWEQ*OFF                       - B1
     C********   VYLUSU    CHAINERLUMPL0             82
     C********   *IN82     IFEQ *OFF
     C********             Z-ADDLSRATE    VYLURA
     C********             ELSE
     C********             Z-ADD0         VYLURA
     C********             ENDIF
     C********             UPDATLOANCSF6
     C********             READ LOANCSF6                 81
     C********             ENDDO                           - E1
     C*
     C*  Update MMDELDX6
     C           *LOVAL    SETLLMMDELDF6               81
     C                     READ MMDELDF6                 81
     C           *IN81     DOWEQ*OFF                       - B1
     C           VLLUSU    CHAINERLUMPL0             82
     C           *IN82     IFEQ *OFF
     C                     Z-ADDLSRATE    VLLURA
     C                     ELSE
     C                     Z-ADD0         VLLURA
     C                     ENDIF
     C                     UPDATMMDELDF6
     C                     READ MMDELDF6                 81
     C                     ENDDO                           - E1
     C*
     C*  Update SECTYDX6
     C           *LOVAL    SETLLSECTYDF6               81
     C                     READ SECTYDF6                 81
     C           *IN81     DOWEQ*OFF                       - B1
     C           VVLUSU    CHAINERLUMPL0             82
     C           *IN82     IFEQ *OFF
     C                     Z-ADDLSRATE    VVLURA
     C                     ELSE
     C                     Z-ADD0         VVLURA
     C                     ENDIF
     C                     UPDATSECTYDF6
     C                     READ SECTYDF6                 81
     C                     ENDDO                           - E1
     C*
     C*  Update ACCNTBX6
     C           *LOVAL    SETLLACCNTBF6               81
     C                     READ ACCNTBF6                 81
     C           *IN81     DOWEQ*OFF                       - B1
     C           WELUSU    CHAINERLUMPL0             82
     C           *IN82     IFEQ *OFF
     C                     Z-ADDLSRATE    WELURA
     C                     ELSE
     C                     Z-ADD0         WELURA
     C                     ENDIF
     C                     UPDATACCNTBF6
     C                     READ ACCNTBF6                 81
     C                     ENDDO                           - E1
     C*
     C*  Write audit report
     C                     WRITEHEADAU
     C                     WRITEENDRPT
     C*
     C                     SETON                       LR
     C*
     C*****************************************************************
     C/EJECT
     C*****************************************************************
      *
      ***  *PSSR    :
      ***  Called   : MAIN, #UPDAC
      ***  Calls    : none
      *
      *---------------------------------------------------------------*
      *
     C           *PSSR     BEGSR
      *
     C                     MOVE *ON       *INU7
     C                     MOVE *ON       *INU8
     C                     MOVE *ON       *INLR
      *
      *  Write end database error details
     C                     WRITEHEADAU
     C                     WRITEERROR
     C                     WRITEENDRPT
      *
      *  Print DUMP and cancel program
     C                     DUMP
     C                     RETRN
      *
     C                     ENDSR
      *
     C*****************************************************************
**  CPY@
(c) Finastra International Limited 2005
