     H        1                           F
     H*                                                         85645
     H****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas ER IML Consolidated Customer positions')
     H****************************************************************
     H*                                                              *
     H*          MIDAS ABS - EUROPEAN REPORTING                      *
     H*                                                              *
     H*        ERLU114  -  CUSTOMER POSITIONS CONSOLIDATION          *
     H*                                                              *
     H*  (c) Finastra International Limited 2005                     *
     H*                                                              *
      *  Last Amend No. MD046248           Date 27Oct17               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      *  Prev Amend No. 225555             Date 01Nov06               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD027A            Date 12May06               *
      *                 CER001             Date 25Apr05               *
      *                 187689             Date 20Dec00               *
      *                 157801             Date 06Sep00               *
     H*                 CAD013 PT             Date 02Sep98           *
     H*                 ULX004
     H*                 92406  PT             Date 31Aug95           *
     H*                 85645  DDJ            Date 08Apr95           *
     H*                 76795  PT             DATE 03OCT94           *
     H*                 ERL438 PT *CREATE     DATE 03SEP94           *
     H*                                                              *
     H*****************************************************************
     H*                                                              *
      *  MD046248 - Finastra Rebranding                               *
      * 225555 - Add discount/premium amount, amount to amortize      *
      *          and 'Prix d'Acquisition'. Recompile only over        *
      *          changed ERLUTRPD.                                    *
      *  CSD027A - Conversion of cust. no. to alpha (post build 103)  *
      *  CER001 - LUX Upgrade to MidasPlus                            *
     H*  187689 - "GRD" currency in EMU                              *
     H*           Just recompile over new PF/ERLUTRPD description    *
     H*  157801 - Market value not cumulated                         *
     H*  CAD013 - Sequence number wrongly managed                    *
     H*  ULX004 - IML Circular 97/138                                *
     H*           Recompile only                                     *
     H*  92406  - DB/CR INDICATOR MUST BE USED TO CALCULATE TOTALS   *
     H*  85645  - ADD CONVERTION TABLE ON FILE ERLUTRPD TO AVOID     *
     H*           INCORRECTE CHAR IN EDIFACT FORMAT                  *
     H*  76795  - DO NOT OUTPUT ZERO RECORDS                         *
     H*  ERL438 - NEW PROGRAM TO CONSOLIDATE THE CUSTOMER POSITIONS  *
     H*                                                              *
     F*****************************************************************
      /TITLE FUNCTION OF INDICATORS
     F*****************************************************************
     F*                                                               *
     F*  F U N C T I O N   O F   I N D I C A T O R S                  *
     F*  ===========================================                  *
     F*                                                               *
     F*   SWITCHES USED IN PROGRAM                                    *
     F*                                                               *
     F*       *NONE                                                   *
     F*                                                               *
     F**             *************************                        *
     F**             ** INDICATORS NOT USED **                        *
     F**             ** ------------------- **                        *
     F**             *************************                        *
     F**                                                              *
     F**      ***************************************************     *
     F**      * 01   02   03   04   05   06   07   08   09   10 *     *
     F**      * 11   12   13   14   15   16   17   18   19   20 *     *
     F**      * 21   22   23   24   25   26   27   28   29   30 *     *
     F**      * 31   32   33   34   35   36   37   38   39   40 *     *
     F**      * 41   42   43   44   45   46   47   48   49   50 *     *
     F**      * 51   52   53   54   55   56   57   58   59   60 *     *
     F**      * 61   62   63   64   65   66   67   68   69   70 *     *
     F**      * 71   72   73   74   75   76   77   78   79   80 *     *
     F**      * 81   82   83   84   85   86   87   83   89   90 *     *
     F**      * 91   92   93   94   95   96   97   98   99      *     *
     F**      ***************************************************     *
     F*****************************************************************
      /TITLE SUBROUTINE INDEX
     F*****************************************************************
     F*                                                               *
     F*  S U B R O U T I N E   I N D E X                              *
     F*  ===============================                              *
     F*                                                               *
     F* *PSSR    - Error handling.                                    *
     F*                                                               *
     F*****************************************************************
      /TITLE FILE DEFINITION
     F*****************************************************************
     F*
     F*  F I L E   D E F I N I T I O N
     F*  =============================
     F*
     F* ER Customer Positions Detail Records
     F***ERLUCPL0IP**E           K        DISK                                                CER001
     FERLCPXL0IP  E           K        DISK                                                   CER001
     F            ERLUTRF0                          KRENAMEERLUCPF0
     F*
     F* ER Allocation File
     F***ERLUTRPDO***E                    DISK                                                CER001
     FERLTRXPDO   E                    DISK                                                CER001
     F*
     F*****************************************************************
      /TITLE E-SPECIFICATIONS
     E*****************************************************************
     E*
     E                    CPY@    1   1 80                 COPYRIGHT STAT.
     E*
     E*****************************************************************
      /TITLE FIELDS SPECIFICATIONS
     I*****************************************************************
      *
     IERLUCPF0    01
     I                                              EXRECTL1
     I                                              EXECOSL1
     I                                              EXCUCLL1
     I                                              EXCCYLL1
     I                                              EXCLASL1
     I*
     I** DATA STRUCTURE FOR COMPILATION  - COPYRIGHT INSERTION
     I*
     ICPYR@#      DS
     I                                        1  80 CPY@
     I                                        1  20 CPY@##
     I*
     I*****************************************************************
      /EJECT
      *****************************************************************
      /TITLE MAIN PROCESSING SPECIFICATIONS
      *----------------------------------------------------------------
      ***          M   A   I   N
      *----------------------------------------------------------------
      *                                                                *****
     C           *ENTRY    PLIST
     C           WWSEQN    PARM           LASTSQ  60       Output Parm
     C           *LIKE     DEFN LASTSQ    WWSEQN
     C*
     C   L1                Z-ADD*ZEROS    WWAMNT 160
     C   L1                Z-ADD*ZEROS    WWLAMT 160
     C   L1                Z-ADD*ZEROS    WWNPVA 160
     C   L1                Z-ADD*ZEROS    WWLNPV 160
     C*
     C           EXDRCR    IFEQ 1                                         92406
     C                     ADD  EXAMNT    WWAMNT
     C                     ADD  EXLAMT    WWLAMT
     C                     ADD  EXNPVA    WWNPVA                          157801
     C                     ADD  EXLNPV    WWLNPV                          157801
     C                     ELSE                                           92406
     C                     SUB  EXAMNT    WWAMNT                          92406
     C                     SUB  EXLAMT    WWLAMT                          92406
     C                     SUB  EXNPVA    WWNPVA                          157801
     C                     SUB  EXLNPV    WWLNPV                          157801
     C                     END                                            92406
     C*
     CL1                   Z-ADDWWAMNT    EXAMNT
     CL1                   Z-ADDWWLAMT    EXLAMT
     CL1                   Z-ADDWWNPVA    EXNPVA                          157801
     CL1                   Z-ADDWWLNPV    EXLNPV                          157801
     CL1         EXLAMT    IFNE *ZEROS                                    76795
     C*****L1              ADD  1         WWSEQN                          CAD013
     C*****L1              Z-ADDWWSEQN    EXSEQN                          CAD013
     CL1                   ADD  1         LASTSQ                          CAD013
     CL1                   Z-ADDLASTSQ    EXSEQN                          CAD013
     CL1                   WRITEERLUTRF0
     CL1                   END                                            76795
     C*
     C**LR*****************Z-ADDEXSEQN    LASTSQ                          CAD013
     CLR                   Z-ADDLASTSQ    WWSEQN                          CAD013
     C*
     C*****************************************************************
** FILE TRANS. ERLUTRPD FILE TO REMOVE ALL NON STANDART CHAR      85645   85645
*EQUATE ERLTRXPD
*EQUATE C144504EC551C552C554C956C164C368406A406FC571C572C5744079407A407D407E407F
*EQUATE C181C282C383C484C585C686C787C888C989D191D292D393D494D595D696D797D898D999
*EQUATE E2A2E3A3E4A4E5A5E6A6E7A7E8A8E9A940E0E4FE
**  CPY@
(c) Finastra International Limited 2005
