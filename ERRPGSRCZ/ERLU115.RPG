     H        1                           F
     H*                                                         85645
     H****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas ER IML Discretionary Customer Assets')
     H****************************************************************
     H*                                                              *
     H*          MIDAS ABS - EUROPEAN REPORTING                      *
     H*                                                              *
     H*        ERLU115  -  DISCRETIONARY CUSTOMER ASSETS             *
     H*                                                              *
      *  (c) Finastra International Limited 2005                      *
     H*                                                              *
      *  Last Amend No. MD046248           Date 27Oct17               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      *  Prev Amend No. 225555             Date 01Nov06               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD027A            Date 12May06               *
      *                 CER001             Date 25Apr05               *
      *                 ULX048             Date 11Aug03               *
      *                 ULX046             Date 31Oct02               *
     H*  Prev Amend No. 187689                Date 20Dec00           *
     H*                 CAD013                Date 02Sep98           *
     H*                 ULX004                Date 28Oct97           *
     H*                 85645  DDJ            Date 08APR95           *
     H*                 ERL436 PT *CREATE     DATE 03SEP94           *
     H*                                                              *
     H*****************************************************************
     H*                                                              *
      *  MD046248 - Finastra Rebranding                               *
      * 225555 - Add discount/premium amount, amount to amortize     *
      *          and 'Prix d'Acquisition'. Recompile only over       *
      *          changed ERLUTRPD.                                   *
      *  CSD027A - Conversion of cust. no. to alpha (post build 103)  *
      *  CER001 - LUX Upgrade to MidasPlus                            *
     H* ULX048 - Circular CSSF 2003/100 management (recompiled)      *
     H* ULX046 - Circulars 2002/170-174-175 Integration              *
     H*          Recompiled due to changes in file layout            *
     H* 187689 - "GRD" currency in EMU                               *
     H*          Just recompile over new PF/ERLUTRPD description     *
     H* CAD013 - Sequence number wrongly managed                     *
     H* ULX004 - Capital Adequacy                                    *
     H*        - IML Circular 97/138                                 *
     H*          Recompile only                                      *
     H* 85645  - ADD CONVERTION TABLE ON FILE ERLUTRPD TO AVOID      *
     H*          INCORRECTE CHAR IN EDIFACT FORMAT                   *
     H*  ERL436 - NEW PROGRAM                                        *
     H*                                                              *
     H*****************************************************************
      /TITLE FUNCTION OF INDICATORS
     F*****************************************************************
     F*                                                               *
     F*  F U N C T I O N   O F   I N D I C A T O R S                  *
     F*  ===========================================                  *
     F*                                                               *
     F*   SWITCHES USED IN PROGRAM                                    *
     F*                                                               *
     F*       *NONE                                                   *
     F*                                                               *
     F**             *************************                        *
     F**             ** INDICATORS NOT USED **                        *
     F**             ** ------------------- **                        *
     F**             *************************                        *
     F**                                                              *
     F**      ***************************************************     *
     F**      * 01   02   03   04   05   06   07   08   09   10 *     *
     F**      * 11   12   13   14   15   16   17   18   19   20 *     *
     F**      * 21   22   23   24   25   26   27   28   29   30 *     *
     F**      * 31   32   33   34   35   36   37   38   39   40 *     *
     F**      * 41   42   43   44   45   46   47   48   49   50 *     *
     F**      * 51   52   53   54   55   56   57   58   59   60 *     *
     F**      * 61   62   63   64   65   66   67   68   69   70 *     *
     F**      * 71   72   73   74   75   76   77   78   79   80 *     *
     F**      * 81   82   83   84   85   86   87   83   89   90 *     *
     F**      * 91   92   93   94   95   96   97   98   99      *     *
     F**      ***************************************************     *
     F*****************************************************************
      /TITLE SUBROUTINE INDEX
     F*****************************************************************
     F*                                                               *
     F*  S U B R O U T I N E   I N D E X                              *
     F*  ===============================                              *
     F*                                                               *
     F* *PSSR    - Error handling.                                    *
     F*                                                               *
     F*****************************************************************
      /TITLE FILE DEFINITION
     F*****************************************************************
     F*
     F*  F I L E   D E F I N I T I O N
     F*  =============================
     F*
     F* VC - ER Decision table - Transaction Type File
     F***ERLUTTL2IF**E           K        DISK                                                CER001
     FERLTTXL2IF  E           K        DISK                                                   CER001
     F*
     F* ER Allocation File
     F***ERLUTRPDO***E                    DISK                                                CER001
     FERLTRXPDO   E                    DISK                                                   CER001
     F*
     F* ER Discretionary Customer Assets
     F***ERLUTRL7IF**E           K        DISK                                                CER001
     FERLTRXL4IF  E           K        DISK                                                   CER001
     F            ERLUTRF0                          KRENAMEERLUTRF7
     F*
     F*****************************************************************
      /TITLE E-SPECIFICATIONS
     E*****************************************************************
     E*
     E                    CPY@    1   1 80                 COPYRIGHT STAT.
     E*
     E*****************************************************************
      /TITLE FIELDS SPECIFICATIONS
     I*****************************************************************
     IERLUTRF7
     I              EXLOTD                          INLOTD
     I              EXDECK                          INDECK
     I              EXRIND                          INRIND
     I              EXEXTT                          INEXTT
     I              EXSCHA                          INSCHA
     I              EXSEQN                          INSEQN
     I*
     I** DATA STRUCTURE FOR COMPILATION  - COPYRIGHT INSERTION
     I*
     ICPYR@#      DS
     I                                        1  80 CPY@
     I                                        1  20 CPY@##
     I*
     I*****************************************************************
      /EJECT
      *****************************************************************
      /TITLE MAIN PROCESSING SPECIFICATIONS
      *----------------------------------------------------------------
      ***          M   A   I   N
      *----------------------------------------------------------------
      *                                                                *****
     C           *ENTRY    PLIST
     C***********EXSEQN    PARM           LASTSQ  60       Output Parm    CAD013
     C           WWSEQN    PARM           LASTSQ  60       Output Parm    CAD013
     C           *LIKE     DEFN LASTSQ    WWSEQN                          CAD013
     C*
     C                     EXSR SRINIT
     C*
     C********** *LOVAL    SETLLERLUTRL7                                                      CER001
     C**********           READ ERLUTRL7                 80                                   CER001
     C           *LOVAL    SETLLERLTRXL4                                                      CER001
     C                     READ ERLTRXL4                 80                                   CER001
     C           *IN80     DOWEQ*OFF                        - B1
     C*
     C*********************ADD  1         EXSEQN                          CAD013
     C                     ADD  1         LASTSQ                          CAD013
     C                     Z-ADDLASTSQ    EXSEQN                          CAD013
     C                     WRITEERLUTRF0               81
     C*
     C************IN81     IFEQ '0'                         - B2          ULX004
     C***********EXEXTT    ANDEQ'Y'                                       ULX004
     C***********          MOVE 001       EXRECT                          ULX004
     C***********          ADD  1         EXSEQN                          ULX004
     C***********          WRITEERLUTRF0               81                 ULX004
     C***********          ENDIF                            - E2          ULX004
     C*
     C**********           READ ERLUTRL7                 80                                   CER001
     C                     READ ERLTRXL4                 80                                   CER001
     C                     ENDDO                            - E1
     C*
     C*********************Z-ADDEXSEQN    LASTSQ                          CAD013
     C                     Z-ADDLASTSQ    WWSEQN                          CAD013
     C*
     C                     SETON                     LR
     C                     RETRN
     C*
     C*****************************************************************
     C*
     C           SRINIT    BEGSR
     C*
     C** Set up static fields
     C                     MOVE 'DIS'     EXLOTD
     C                     MOVE 'DISC'    EXRIND
     C                     MOVE *BLANKS   EXDECK
     C                     MOVEL'DISC'    EXDECK
     C*
     C** Retrieve IML code
     C********** EXDECK    CHAINERLUTTL2             82                                       CER001
     C           EXDECK    CHAINERLTTXL2             82                                       CER001
     C           *IN82     IFEQ '0'                        - B1
     C                     MOVELVCEXTT    EXEXTT
     C                     MOVELVCRBNC    EXSCHA
     C           EXSCHA    IFEQ *ZEROS                     - B2
     C                     MOVELVCRBND    EXSCHA
     C                     END                             - E2
     C                     END                             - E1
     C*
     C** If discretionary assets must not be reported, quit program
     C           *IN82     IFEQ '1'                        - B1
     C           EXSCHA    OREQ 0
     C                     SETON                     LR
     C                     RETRN
     C                     END                             - E1
     C*
     C                     ENDSR
     C*
     C*****************************************************************
      *
      ** Array File Trans. change to ERLTRXPD instead of ERLUTRPD                             CER001
      *
** FILE TRANS. ERLUTRPD FILE TO REMOVE ALL NON STANDART CHAR      85645   85645
*EQUATE ERLTRXPD
*EQUATE C144504EC551C552C554C956C164C368406A406FC571C572C5744079407A407D407E407F
*EQUATE C181C282C383C484C585C686C787C888C989D191D292D393D494D595D696D797D898D999
*EQUATE E2A2E3A3E4A4E5A5E6A6E7A7E8A8E9A940E0E4FE
**  CPY@
(c) Finastra International Limited 2005
