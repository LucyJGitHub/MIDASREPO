     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas Decision Table - Account Codes')
      *****************************************************************
      *                                                               *
      *  Midas - European Reporting Module                            *
      *                                                               *
      *  ERLU30 - Decision Table - Account Codes                      *
      *                                                               *
      *  (c) Misys International Banking Systems Ltd. 2005            *
      *                                                               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *  Last Amend No. CER001             Date 25Apr05               *
      *  Prev Amend No. ULX046             Date 21Oct02               *
      *                 ULX004             Date 28Oct97               *
      *                 ERL415             Date 22Jul94               *
      *                 ERL200  *CREATE    Date 13Jan93               *
      *                                                               *
      *****************************************************************
      *                                                               *
      *  CER001 - LUX Upgrade to MidasPlus                            *
      *  ULX046 - Circulars 2002/170-174-175 Integration              *
      *  ULX004 - Capital Adequacy                                    *
      *         - IML Circular 97/138                                 *
      *  ERL415 - IML codes 1.1 validation                            *
      *  ERL200 - New subfile processing                              *
      *                                                               *
      *****************************************************************
      *
     FERPRDCPDIF  E           K        DISK                               ULX004
      *                                                                   ULX004
     FERLU11PDIF  E           K        DISK                               ERL415
     F*                                                                   ERL415
     FSDACODL1IF  E           K        DISK
     F*
     FERLUACL0UF  E           K        DISK         KCOMIT       A
     F            ERLUACD0                          KRENAMEUPERLUAC
     FERLUACL1IF  E           K        DISK
     F*
     F******SDBANKPDIF  E           K        DISK                         ULX004
     F*
     FERLU30DFCF  E                    WORKSTN
     F                                        RRN   KSFILE ERLU30S1
     E*****************************************************************
     E******              PROD   18  52  4 0                       ULX004 ULX004
     E                    PORT   10  10  1                                ULX004
     E                    AMTY   33  33  2                                ULX046
     E                    AMTY2  33  33  2                                ULX046
     E                    ARR        25  1               ARRAY FOR LENGHT
     E                    CPY@    1   1 80
     I*****************************************************************
     I* PROGRAM DATA STRUCTURE
     IPGMDS     ESDSY2PGDSP
     I*
     ILDA        UDS                            256
     I                                      132 141 DBFILE
     I                                      142 170 DBKEY
     I                                      171 180 DBPGM
     I                                      181 1830DBASE
     I***
     I            DS
     I                                        1  25 DHNARA
     I                                       26  26 DHTYPE
     I                                       27  27 DHEXTY
     I                                       28  35 DHDEBI
     I                                       36  43 DHCRED
     I***************************************44  44 DHAMTY                ULX004
     I****************************************1  44 SELEC1                ULX004
     I******                                 44  47 DHPRCD        ULX004  ULX004
     I******                                 48  48 DHPORT        ULX004  ULX004
     I******                                  1  48 SELEC1        ULX004  ULX004
     I*D***                                  44  44 DHAMTY        ULX004  ULX046
     I*D***                                  45  48 DHPRCD        ULX004  ULX046
     I*D***                                  49  49 DHPORT        ULX004  ULX046
     I*D***                                   1  49 SELEC1        ULX004  ULX046
     I                                       44  45 DHAMTY                ULX046
     I                                       46  49 DHPRCD                ULX046
     I                                       50  50 DHPORT                ULX046
     I                                        1  50 SELEC1                ULX046
     I***
     I            DS
     I                                        1  25 WWNARA
     I                                       26  26 WWTYPE
     I                                       27  27 WWEXTY
     I                                       28  35 WWDEBI
     I                                       36  43 WWCRED
     I***************************************44  44 WWAMTY                ULX004
     I****************************************1  44 SELEC2                ULX004
     I******                                 44  47 WWPRCD                ULX004
     I******                                 48  48 WWPORT                ULX004
     I******                                  1  48 SELEC2                ULX004
     I*D***                                  44  44 WWAMTY         ULX004 ULX046
     I*D***                                  45  48 WWPRCD         ULX004 ULX046
     I*D***                                  49  49 WWPORT         ULX004 ULX046
     I*D***                                   1  49 SELEC2         ULX004 ULX046
     I                                       44  45 WWAMTY                ULX046
     I                                       46  49 WWPRCD                ULX046
     I                                       50  50 WWPORT                ULX046
     I                                        1  50 SELEC2                ULX046
     I*
     I**  DATA STRUCTURE FOR COMPILATION  - COPYRIGHT INSERTION:
     ICPYR@#      DS
     I                                        1  80 CPY@
     I                                        1  20 CPY@##
      *                                                                   ULX004
      **  External DS for Bank Details                                    ULX004
     ISDBANK    E DSSDBANKPD                                              ULX004
      *                                                                   ULX004
      * First DS for access programs, SHORT DATA STRUCTURE                ULX004
     IDSFDY     E DSDSFDY                                                 ULX004
      *                                                                   ULX004
      * Second DS dor access programs, LONG DATA STRUCTURE                ULX004
     IDSSDY     E DSDSSDY                                                 ULX004
     I*
     C**************************************************************************
     C* MAIN PROCESSING                                                        *
     C**************************************************************************
     C* CALL INIT SUBROUTINE
     C**************************************************************************
     C*
     C           *ENTRY    PLIST
     C                     PARM           ACTION  1
     C                     PARM           #RETRN  1
     C                     PARM           CTRY    2
     C*
     C                     MOVE *BLANKS   @RTCD   7        * AO Parameter ULX004
     C                     MOVE *BLANKS   @OPTN   7        * AO Paramrter ULX004
     C*
     C                     EXSR INIT                       INITIATION
     C*
     C                     EXSR MAIN
     C*
     C** SETUP RETURN CODE
     C           *INKC     IFEQ '1'
     C                     MOVE '3'       #RETRN
     C                     END
     C*
     C** END OF PGM
     C                     MOVE '1'       *INLR
     C                     ROLBK
     C*
     C                     RETRN
     C**************************************************************************
     C** MAIN - MAIN SUBROUTINE
     C**************************************************************************
     C*
     C           MAIN      BEGSR
     C*
     C** ' ADD MODE ' ON FIRST CYCLE
     C           *IN09     IFNE '1'                        - B1
     C*
     C                     EXSR INISFL                     INIT. SUBFILE
     C                     EXSR LOASFE                     LOAD SUBFILE ENQUIRY
     C                     Z-ADD1         RRN
     C*
     C                     END                             - E1
     C*
     C* DO WHILE NOT F3 OR F12 PRESSED
     C           *INKC     DOWEQ'0'                        - B1
     C           *IN12     ANDEQ'0'
     C*
     C                     MOVE SELEC1    SELEC2
     C*
     C** RESET F9 INDICATOR
     C                     MOVE '0'       *IN16
     C*
     C* WRITE SUBFILE
     C           *IN09     IFNE '1'                        - B2
     C*
     C                     WRITEERLU30C0                   BOTTOM
     C                     EXFMTERLU30C1                   SUBFILE
     C*
     C** CLEAR MESSAGES FROM PROGRAM MESSAGE QUEUE
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGM  10
     C                     PARM '*SAME'   ZAPGRL  5
     C*                                                                   ERL200
     C** WICH KEY HAS BEEN PRESSED                                        ERL200
     C                     EXSR PRESS                                     ERL200
     C*                                                                   ERL200
     C           WWAID     IFEQ 'UP'                       - B3           ERL200
     C                     Z-ADDWWRRN     RRN                             ERL200
     C                     EXSR LOASFE                                    ERL200
     C                     END                             - E3           ERL200
     C*                                                                   ERL200
     C                     END                             - E2
     C*
     C**************************************************************************
     C** F9 HAS BEEN PRESSED
     C**************************************************************************
     C           *IN09     IFEQ '1'                        - B2
     C                     EXSR SRF9
     C                     MOVE SELEC1    SELEC2
     C           *INKC     IFEQ '1'                        - B3
     C                     MOVE '0'       *IN16
     C                     END                             - E3
     C                     END                             - E2
     C**************************************************************************
     C** ENTER HAS BEEN PRESSED
     C**************************************************************************
     C           *IN45     IFEQ '0'                        - B2
     C           *IN16     ANDEQ'0'
     C*
     C           *IN45     IFEQ '0'                        - B3
     C           DHACOD    ANDNEWWACOD
     C           *IN45     OREQ '0'
     C           SELEC1    ANDNESELEC2
     C                     EXSR INISFL
     C                     EXSR LOASFE
     C                     Z-ADD1         RRN
     C                     END                             - E3
     C*
     C** CHECK IF CHANGES IN SUBFILE
     C                     EXSR SRCHCK
     C*
     C                     END                             - E2
     C**************************************************************************
     C** F5 HAS BEEN PRESSED : REFRESH PROCESSING ==> REBUILD SUBFILE
     C** OR BACK FROM F9 SCREEN WITH F9 OR F12
     C**************************************************************************
     C                     MOVE *BLANKS   IN16
     C           *IN05     IFEQ '1'                        - B2
     C           *IN16     OREQ '1'
     C                     MOVE 'Y'       IN16    1
     C                     MOVE '0'       *IN16
     C                     Z-ADD0         DHACOD
     C                     MOVE *BLANKS   DHNARA
     C                     MOVE *BLANKS   DHTYPE
     C                     MOVE *BLANKS   DHEXTY
     C                     MOVE *BLANKS   DHDEBI
     C                     MOVE *BLANKS   DHTYPE
     C*********************MOVE *BLANKS   DHAMTY                          ULX004
     C                     MOVE *BLANKS   DHAMTY                          ULX004
     C                     MOVE *BLANKS   DHPRCD                          ULX004
     C                     MOVE *BLANKS   DHPORT                          ULX004
     C*
     C                     EXSR INISFL
     C                     EXSR LOASFE
     C                     Z-ADD1         RRN
     C                     MOVE *BLANKS   IN16
     C                     END                             - E2
     C*
     C                     END                             - E1
     C*
     C                     ENDSR
     C*
     C**************************************************************************
     C* SRF9 - SUBROUTINE EXECUTED IF F9 PRESSED
     C**************************************************************************
     C*
     C           SRF9      BEGSR
     C*
     C                     MOVE '1'       *IN16
     C*
     C                     EXSR INISFL
     C                     EXSR LOASF9
     C                     Z-ADD1         RRN
     C*
     C           *INKC     DOWEQ'0'                        - B1
     C           *IN12     ANDEQ'0'
     C*
     C* WRITE SUBFILE 'F9'
     C                     WRITEERLU30C0                   BOTTOM
     C                     EXFMTERLU30C1                   SUBFILE
     C*
     C** CLEAR MESSAGES FROM PROGRAM MESSAGE QUEUE
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGM  10
     C                     PARM '*SAME'   ZAPGRL  5
     C*
     C** F9 PRESSED ONCE AGAIN = F12 IS SETON
     C           *IN09     IFEQ '1'                        - B2
     C                     MOVE '1'       *IN12
     C                     MOVE '0'       *IN09
     C                     END                             - E2
     C*
     C** ENTER HAS BEEN PRESSED ON 'F9' SCREEN
     C           *IN45     IFEQ '0'                        - B2
     C                     READCERLU30S1                 32
     C*
     C           *IN32     DOWEQ'0'                        - B3
     C*
     C                     MOVE '0'       *IN15
     C                     MOVE '0'       *IN21
     C                     MOVE '0'       *IN23
     C                     MOVE '0'       *IN24
     C                     MOVE '0'       *IN25
     C                     MOVE '0'       *IN26
     C                     MOVE '0'       *IN27                           ULX004
     C                     MOVE '0'       *IN28                           ULX004
     C                     MOVE '0'       *IN63
     C*
     C           DSACOD    CHAINSDACODL1             88
     C*
     C           DSACOD    IFNE *BLANKS                    - B4
     C           *IN88     IFEQ '1'                        - B5
     C                     MOVE '1'       *IN23
     C                     MOVE '1'       *IN63
     C                     MOVEL'ERB3003' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE *BLANKS   DSNARA
     C                     MOVE *BLANKS   DSTYPE
     C                     ELSE                            - X5
     C           A5TOIN    IFEQ 'Y'                        - B6
     C                     MOVE '1'       *IN23
     C                     MOVE '1'       *IN63
     C                     MOVEL'ERB3003' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE *BLANKS   DSNARA
     C                     MOVE *BLANKS   DSTYPE
     C                     ELSE                            - X6
     C                     MOVE A5ACCN    DSNARA
     C                     MOVE A5ACTY    DSTYPE
     C                     END                             - E6
     C                     END                             - E5
     C*
     C                     ELSE                            - X4
     C*
     C           DSEXTY    IFNE *BLANKS                    - B5
     C           DSDEBI    ORNE *BLANKS
     C           DSCRED    ORNE *BLANKS
     C                     MOVE '1'       *IN23
     C                     MOVE '1'       *IN63
     C                     MOVEL'ERB3005' ZAMSID
     C                     EXSR ZASNMS
     C                     END                             - E5
     C                     END                             - E4
     C*
     C** ALREADY EXISTS ON FILE
     C                     MOVE DSACOD    XXACOD
     C           XXACOD    CHAINERLUACL1             88
     C           *IN88     IFEQ '0'                        - B4
     C                     MOVE '1'       *IN23
     C                     MOVE '1'       *IN63
     C                     MOVEL'ERB3004' ZAMSID
     C                     EXSR ZASNMS
     C                     END                             - E4
     C*
     C***********DSEXTY    IFNE *BLANKS                    - B4           ERL415
     C***********DSEXTY    ANDNE'Y'                                       ERL415
     C***********DSEXTY    ANDNE'N'                                       ERL415
     C***********          MOVE '1'       *IN21                           ERL415
     C***********          MOVE '1'       *IN63                           ERL415
     C***********          MOVEL'ERB3002' ZAMSID                          ERL415
     C***********          EXSR ZASNMS                                    ERL415
     C***********          END                             - E4           ERL415
     C***********                                                         ERL415
     C***VALIDATION IF FULLY NUMERIC                                      ERL415
     C***********DSDEBI    IFEQ *BLANKS                                   ERL415
     C***********          MOVE *ZEROS    DSDEBI                          ERL415
     C***********          END                                            ERL415
     C***********                                                         ERL415
     C***********DSDEBI    IFNE *ZEROS                     - B4           ERL415
     C***********          MOVELDSDEBI    TEST9   90                      ERL415
     C***********          MOVELTEST9     ALPH8   8                       ERL415
     C***********DSDEBI    IFNE ALPH8                      - B5           ERL415
     C***********          MOVE '1'       *IN24                           ERL415
     C***********          MOVE '1'       *IN63                           ERL415
     C***********          MOVEL'ERB3008' ZAMSID                          ERL415
     C***********          EXSR ZASNMS                                    ERL415
     C***********          END                             - E5           ERL415
     C***********          END                             - E4           ERL415
     C***********                                                         ERL415
     C***********DSCRED    IFEQ *BLANKS                                   ERL415
     C***********          MOVE *ZEROS    DSCRED                          ERL415
     C***********          END                                            ERL415
     C***********                                                         ERL415
     C***********DSCRED    IFNE *ZEROS                     - B4           ERL415
     C***********          MOVELDSCRED    TEST9   90                      ERL415
     C***********          MOVELTEST9     ALPH8   8                       ERL415
     C***********DSCRED    IFNE ALPH8                      - B5           ERL415
     C***********          MOVE '1'       *IN25                           ERL415
     C***********          MOVE '1'       *IN63                           ERL415
     C***********          MOVEL'ERB3008' ZAMSID                          ERL415
     C***********          EXSR ZASNMS                                    ERL415
     C***********          END                             - E5           ERL415
     C***********          END                             - E4           ERL415
     C***********                                                         ERL415
     C***VALIDATE RUBRIC NUMBERS                                          ERL415
     C***********DSEXTY    IFEQ *BLANKS                    - B4           ERL415
     C***********DSDEBI    ANDNE*ZEROS                                    ERL415
     C***********DSEXTY    OREQ *BLANKS                                   ERL415
     C***********DSCRED    ANDNE*ZEROS                                    ERL415
     C***********          MOVE '1'       *IN21                           ERL415
     C***********          MOVE '1'       *IN63                           ERL415
     C***********          MOVEL'ERB3006' ZAMSID                          ERL415
     C***********          EXSR ZASNMS                                    ERL415
     C***********          END                             - E4           ERL415
      ***********                                                         ERL415
      ***Validate*Amount Type                                             ERL415
      ***********                                                         ERL415
     C***********DSAMTY    IFEQ *BLANKS                    - B4           ERL415
     C***********          MOVE 'G'       DSAMTY                          ERL415
     C***********          ELSE                            - X4           ERL415
     C***********DSAMTY    IFNE 'G'                        - B5           ERL415
     C***********DSAMTY    ANDNE'C'                                       ERL415
     C***********DSAMTY    ANDNE'L'                                       ERL415
     C***********          MOVE '1'       *IN26                           ERL415
     C***********          MOVE '1'       *IN63                           ERL415
     C***********          MOVEL'ERL3009' ZAMSID                          ERL415
     C***********          EXSR ZASNMS                                    ERL415
     C***********          END                             - E5           ERL415
     C***********          END                             - E4           ERL415
     C*                                                                   ERL415
     C** VALIDATE INPUT FIELDS                                            ERL415
     C                     EXSR SRVAL                                     ERL415
     C*
     C** NO ERRORS
     C           *IN23     IFEQ '0'                        - B4
     C           *IN21     ANDEQ'0'
     C           *IN24     ANDEQ'0'
     C           *IN25     ANDEQ'0'
     C           *IN26     ANDEQ'0'
     C           *IN27     ANDEQ'0'                                       ULX004
     C           *IN28     ANDEQ'0'                                       ULX004
     C           DSACOD    ANDNE*BLANKS
     C                     MOVE DSACOD    VBACOD
     C                     MOVE DSEXTY    VBEXTT
     C*********************MOVE DSAMTY    VBAMTY                          ULX004
     C                     MOVE DSAMTY    VBAMTY                          ULX004
     C                     MOVE DSPRCD    VBPRCD                          ULX004
     C                     MOVE DSPORT    VBPORT                          ULX004
     C                     MOVE DSDEBI    VBRBND
     C                     MOVE DSCRED    VBRBNC
     C                     Z-ADDBJRDNB    VBLCD
     C                     MOVE 'I'       VBTYLC
     C                     WRITEUPERLUAC
     C*
     C** WRITE DONE THEN PROTECT RECORD
     C                     MOVE '1'       *IN15
     C*
     C                     COMIT
     C                     END                             - E4
     C*
     C                     UPDATERLU30S1
     C                     MOVE '0'       *IN15
     C                     MOVE '0'       *IN21
     C                     MOVE '0'       *IN23
     C                     MOVE '0'       *IN24
     C                     MOVE '0'       *IN25
     C                     MOVE '0'       *IN26
     C                     MOVE '0'       *IN27                           ULX004
     C                     MOVE '0'       *IN28                           ULX004
     C                     MOVE '0'       *IN63
     C*
     C** READ NEXT CHANGED RECORD
     C                     READCERLU30S1                 32
     C*
     C                     ENDDO                           - E3
     C                     END                             - E2
     C*
     C** REFRESH ON F9 SCREEN
     C           *IN05     IFEQ '1'                        - B2
     C                     EXSR INISFL
     C                     EXSR LOASF9
     C                     Z-ADD1         RRN
     C                     END                             - E2
     C*
     C                     END                             - E1
     C*
     C           *IN12     IFEQ '1'
     C                     MOVE '0'       *IN12
     C                     END
     C*
     C                     ENDSR
     C*
     C**************************************************************************
     C* SRCHCK - SUBROUTINE TO CHECK IF CHANGES IN SUBFILE
     C**************************************************************************
     C*
     C           SRCHCK    BEGSR
     C*
     C** Retrive all changed records
     C                     READCERLU30S1                 32
     C*
     C           *IN32     DOWEQ'0'                        - B1
     C*
     C** VALIDATION ON RECORD SUBFILE
     C*
     C                     MOVE '0'       *IN63
     C                     MOVE '0'       *IN20
     C                     MOVE '0'       *IN21
     C                     MOVE '0'       *IN24
     C                     MOVE '0'       *IN25
     C                     MOVE '0'       *IN26
     C                     MOVE '0'       *IN27                           ULX004
     C                     MOVE '0'       *IN28                           ULX004
     C*
     C           DSSELE    IFNE 'D'                        - B2
     C           DSSELE    ANDNE*BLANKS
     C                     MOVE '1'       *IN20
     C                     MOVE '1'       *IN63
     C                     MOVEL'ERB3001' ZAMSID
     C                     EXSR ZASNMS
     C                     END                             - E2
     C*
     C***********DSEXTY    IFNE *BLANKS                    - B2           ERL415
     C***********DSEXTY    ANDNE'Y'                                       ERL415
     C***********DSEXTY    ANDNE'N'                                       ERL415
     C***********          MOVE '1'       *IN21                           ERL415
     C***********          MOVE '1'       *IN63                           ERL415
     C***********          MOVEL'ERB3002' ZAMSID                          ERL415
     C***********          EXSR ZASNMS                                    ERL415
     C***********          END                             - E2           ERL415
     C***********                                                         ERL415
     C***VALIDATION IF FULLY NUMERIC                                      ERL415
     C***********DSDEBI    IFEQ *BLANKS                                   ERL415
     C***********          MOVE *ZEROS    DSDEBI                          ERL415
     C***********          END                                            ERL415
     C***********                                                         ERL415
     C***********DSDEBI    IFNE *ZEROS                     - B2           ERL415
     C***********          MOVELDSDEBI    TEST9   90                      ERL415
     C***********          MOVELTEST9     ALPH8   8                       ERL415
     C***********DSDEBI    IFNE ALPH8                      - B3           ERL415
     C***********          MOVE '1'       *IN24                           ERL415
     C***********          MOVE '1'       *IN63                           ERL415
     C***********          MOVEL'ERB3008' ZAMSID                          ERL415
     C***********          EXSR ZASNMS                                    ERL415
     C***********          END                             - E3           ERL415
     C***********          END                             - E2           ERL415
     C***********                                                         ERL415
     C***********DSCRED    IFEQ *BLANKS                                   ERL415
     C***********          MOVE *ZEROS    DSCRED                          ERL415
     C***********          END                                            ERL415
     C***********                                                         ERL415
     C***********DSCRED    IFNE *ZEROS                     - B2           ERL415
     C***********          MOVELDSCRED    TEST9   90                      ERL415
     C***********          MOVELTEST9     ALPH8   8                       ERL415
     C***********DSCRED    IFNE ALPH8                      - B3           ERL415
     C***********          MOVE '1'       *IN25                           ERL415
     C***********          MOVE '1'       *IN63                           ERL415
     C***********          MOVEL'ERB3008' ZAMSID                          ERL415
     C***********          EXSR ZASNMS                                    ERL415
     C***********          END                             - E3           ERL415
     C***********          END                             - E2           ERL415
     C***********                                                         ERL415
     C***VALIDATE RUBRIC NUMBERS                                          ERL415
     C***********DSEXTY    IFEQ *BLANKS                    - B2           ERL415
     C***********DSDEBI    ANDNE*ZEROS                                    ERL415
     C***********DSEXTY    OREQ *BLANKS                                   ERL415
     C***********DSCRED    ANDNE*ZEROS                                    ERL415
     C***********          MOVE '1'       *IN21                           ERL415
     C***********          MOVE '1'       *IN63                           ERL415
     C***********          MOVEL'ERB3006' ZAMSID                          ERL415
     C***********          EXSR ZASNMS                                    ERL415
     C***********          END                             - E2           ERL415
      ***********                                                         ERL415
      ***Validate*Amount Type                                             ERL415
      ***********                                                         ERL415
     C***********DSAMTY    IFEQ *BLANKS                    - B2           ERL415
     C***********          MOVE 'G'       DSAMTY                          ERL415
     C***********          ELSE                            - X2           ERL415
     C***********DSAMTY    IFNE 'G'                        - B3           ERL415
     C***********DSAMTY    ANDNE'C'                                       ERL415
     C***********DSAMTY    ANDNE'L'                                       ERL415
     C***********          MOVE '1'       *IN26                           ERL415
     C***********          MOVE '1'       *IN63                           ERL415
     C***********          MOVEL'ERL3009' ZAMSID                          ERL415
     C***********          EXSR ZASNMS                                    ERL415
     C***********          END                             - E3           ERL415
     C***********          END                             - E2           ERL415
     C*                                                                   ERL415
     C** VALIDATE INPUT FIELDS                                            ERL415
     C                     EXSR SRVAL                                     ERL415
     C*
     C** NO ERRORS
     C           *IN20     IFEQ '0'                        - B2
     C           *IN21     ANDEQ'0'
     C           *IN24     ANDEQ'0'
     C           *IN25     ANDEQ'0'
     C           *IN26     ANDEQ'0'
     C           *IN27     ANDEQ'0'                                       ULX004
     C           *IN28     ANDEQ'0'                                       ULX004
     C*
     C** IF NO ERROR AND 'D' SELECTED ==> DELETE IN FILE
     C           DSSELE    IFEQ 'D'                        - B3
     C                     MOVE DSACOD    XXACOD
     C           XXACOD    CHAINERLUACL0             88
     C           *IN88     IFEQ '0'                        - B4
     C                     DELETUPERLUAC
     C                     MOVE '1'       *IN15
     C                     END                             - E4
     C                     ELSE                            - X3
     C*
     C** UPDATE FILE AND SUBFILE
     C**********           MOVE DSACOD    XXACOD  40                                          CER001
     C                     MOVE DSACOD    XXACOD 100                                          CER001
     C           XXACOD    CHAINERLUACL0             88
     C           *IN88     IFEQ '0'                        - B4
     C                     MOVE DSEXTY    VBEXTT
     C*********************MOVE DSAMTY    VBAMTY                          ULX004
     C                     MOVE DSAMTY    VBAMTY                          ULX004
     C                     MOVE DSPRCD    VBPRCD                          ULX004
     C                     MOVE DSPORT    VBPORT                          ULX004
     C                     MOVE DSDEBI    VBRBND
     C                     MOVE DSCRED    VBRBNC
     C                     Z-ADDBJRDNB    VBLCD
     C                     MOVE 'A'       VBTYLC
     C                     UPDATUPERLUAC
     C                     END                             - E4
     C                     END                             - E3
     C                     COMIT
     C                     END                             - E2
     C*
     C                     UPDATERLU30S1
     C                     MOVE '0'       *IN63
     C                     MOVE '0'       *IN15
     C                     MOVE '0'       *IN20
     C                     MOVE '0'       *IN21
     C                     MOVE '0'       *IN24
     C                     MOVE '0'       *IN25
     C                     MOVE '0'       *IN26
     C                     MOVE '0'       *IN27                           ULX004
     C                     MOVE '0'       *IN28                           ULX004
     C*
     C** READ NEXT CHANGED RECORD
     C                     READCERLU30S1                 32
     C*
     C                     ENDDO                           - E1
     C*
     C*
     C                     ENDSR
     C********************************************************************ERL415
     C* VALIDATION SUBROUTINE                                             ERL415
     C********************************************************************ERL415
     C*                                                                   ERL415
     C           SRVAL     BEGSR                                          ERL415
     C*                                                                   ERL415
     C** Extract type validation                                          ERL415
     C*                                                                   ERL415
     C           DSEXTY    IFNE *BLANKS                    - B1           ERL415
     C           DSEXTY    ANDNE'Y'                                       ERL415
     C           DSEXTY    ANDNE'N'                                       ERL415
     C                     MOVE '1'       *IN21                           ERL415
     C                     MOVE '1'       *IN63                           ERL415
     C                     MOVEL'ERB3002' ZAMSID                          ERL415
     C                     EXSR ZASNMS                                    ERL415
     C                     END                             - E1           ERL415
     C*                                                                   ERL415
     C** DEBIT IML CODE VALIDATION                                        ERL415
     C*                                                                   ERL415
     C** Check if fully numeric                                           ERL415
     C           DSDEBI    IFEQ *BLANKS                    - B1           ERL415
     C                     MOVE *ZEROS    DSDEBI                          ERL415
     C                     END                             - E1           ERL415
     C*                                                                   ERL415
     C           DSDEBI    IFNE *ZEROS                     - B1           ERL415
     C                     MOVELDSDEBI    TEST9   90                      ERL415
     C                     MOVELTEST9     ALPH8   8                       ERL415
     C           DSDEBI    IFNE ALPH8                      - B2           ERL415
     C                     MOVE '1'       *IN24                           ERL415
     C                     MOVE '1'       *IN63                           ERL415
     C                     MOVEL'ERB3008' ZAMSID                          ERL415
     C                     EXSR ZASNMS                                    ERL415
     C                     END                             - E2           ERL415
     C                     END                             - E1           ERL415
     C*                                                                   ERL415
     C           DSDEBI    IFNE *ZEROS                     - B1           ERL415
     C           *IN24     ANDEQ'0'                                       ERL415
     C           DSDEBI    CHAINERLU11PD             82                   ERL415
     C*                                                                   ERL415
     C** IML code 1.1 must exist                                          ERL415
     C           *IN82     IFEQ '1'                        - B2           ERL415
     C                     MOVE '1'       *IN24                           ERL415
     C                     MOVE '1'       *IN63                           ERL415
     C                     MOVEL'ERL3010' ZAMSID                          ERL415
     C                     EXSR ZASNMS                                    ERL415
     C                     ELSE                            - X2           ERL415
     C*                                                                   ERL415
     C** IML code 1.1 can not be a 'Sub-total' not managed (action 'X')   ERL415
     C           IMACTI    IFEQ 'X'                        - B3           ERL415
     C           IMTYPE    ANDEQ'S'                                       ERL415
     C                     MOVE '1'       *IN24                           ERL415
     C                     MOVE '1'       *IN63                           ERL415
     C                     MOVEL'ERL3011' ZAMSID                          ERL415
     C                     EXSR ZASNMS                                    ERL415
     C                     END                             - E3           ERL415
     C*                                                                   ERL415
     C** IML code 1.1 can not be a 'Dont' not managed (action 'X')        ERL415
     C           IMACTI    IFEQ 'X'                        - B3           ERL415
     C           IMTYPE    ANDEQ'I'                                       ERL415
     C           IMACTI    OREQ 'X'                                       ERL415
     C           IMTYPE    ANDEQ'X'                                       ERL415
     C                     MOVE '1'       *IN24                           ERL415
     C                     MOVE '1'       *IN63                           ERL415
     C                     MOVEL'ERL3012' ZAMSID                          ERL415
     C                     EXSR ZASNMS                                    ERL415
     C                     END                             - E3           ERL415
     C*                                                                   ERL415
     C** IML code 1.1 can not be a 'Total' not managed (action 'X')       ERL415
     C           IMACTI    IFEQ 'X'                        - B3           ERL415
     C           IMTYPE    ANDEQ'T'                                       ERL415
     C                     MOVE '1'       *IN24                           ERL415
     C                     MOVE '1'       *IN63                           ERL415
     C                     MOVEL'ERL3013' ZAMSID                          ERL415
     C                     EXSR ZASNMS                                    ERL415
     C                     END                             - E3           ERL415
     C                     END                             - E2           ERL415
     C                     END                             - E1           ERL415
     C*                                                                   ERL415
     C** CREDIT IML CODE VALIDATION                                       ERL415
     C*                                                                   ERL415
     C** Validation if fully numeric                                      ERL415
     C           DSCRED    IFEQ *BLANKS                    - B1           ERL415
     C                     MOVE *ZEROS    DSCRED                          ERL415
     C                     END                             - E1           ERL415
     C*                                                                   ERL415
     C           DSCRED    IFNE *ZEROS                     - B1           ERL415
     C                     MOVELDSCRED    TEST9   90                      ERL415
     C                     MOVELTEST9     ALPH8   8                       ERL415
     C           DSCRED    IFNE ALPH8                      - B2           ERL415
     C                     MOVE '1'       *IN25                           ERL415
     C                     MOVE '1'       *IN63                           ERL415
     C                     MOVEL'ERB3008' ZAMSID                          ERL415
     C                     EXSR ZASNMS                                    ERL415
     C                     END                             - E2           ERL415
     C                     END                             - E1           ERL415
     C*                                                                   ERL415
     C           DSCRED    IFNE *ZEROS                     - B1           ERL415
     C           *IN25     ANDEQ'0'                        - B1           ERL415
     C           DSCRED    CHAINERLU11PD             82                   ERL415
     C*                                                                   ERL415
     C** IML code 1.1 must exist                                          ERL415
     C           *IN82     IFEQ '1'                        - B2           ERL415
     C                     MOVE '1'       *IN25                           ERL415
     C                     MOVE '1'       *IN63                           ERL415
     C                     MOVEL'ERL3010' ZAMSID                          ERL415
     C                     EXSR ZASNMS                                    ERL415
     C                     ELSE                            - X2           ERL415
     C*                                                                   ERL415
     C** IML code 1.1 can not be a 'Sub-total' not managed (action 'X')   ERL415
     C           IMACTI    IFEQ 'X'                        - B3           ERL415
     C           IMTYPE    ANDEQ'S'                                       ERL415
     C                     MOVE '1'       *IN25                           ERL415
     C                     MOVE '1'       *IN63                           ERL415
     C                     MOVEL'ERL3011' ZAMSID                          ERL415
     C                     EXSR ZASNMS                                    ERL415
     C                     END                             - E3           ERL415
     C*                                                                   ERL415
     C** IML code 1.1 can not be a 'Dont' not managed (action 'X')        ERL415
     C           IMACTI    IFEQ 'X'                        - B3           ERL415
     C           IMTYPE    ANDEQ'I'                                       ERL415
     C           IMACTI    OREQ 'X'                                       ERL415
     C           IMTYPE    ANDEQ'X'                                       ERL415
     C                     MOVE '1'       *IN25                           ERL415
     C                     MOVE '1'       *IN63                           ERL415
     C                     MOVEL'ERL3012' ZAMSID                          ERL415
     C                     EXSR ZASNMS                                    ERL415
     C                     END                             - E3           ERL415
     C*                                                                   ERL415
     C** IML code 1.1 can not be a 'Total' not managed (action 'X')       ERL415
     C           IMACTI    IFEQ 'X'                        - B3           ERL415
     C           IMTYPE    ANDEQ'T'                                       ERL415
     C                     MOVE '1'       *IN25                           ERL415
     C                     MOVE '1'       *IN63                           ERL415
     C                     MOVEL'ERL3013' ZAMSID                          ERL415
     C                     EXSR ZASNMS                                    ERL415
     C                     END                             - E3           ERL415
     C                     END                             - E2           ERL415
     C                     END                             - E1           ERL415
     C*                                                                   ERL415
     C** Extract type must be entered if IML code entered                 ERL415
     C           DSEXTY    IFEQ *BLANKS                    - B1           ERL415
     C           DSDEBI    ANDNE*ZEROS                                    ERL415
     C           DSEXTY    OREQ *BLANKS                                   ERL415
     C           DSCRED    ANDNE*ZEROS                                    ERL415
     C                     MOVE '1'       *IN21                           ERL415
     C                     MOVE '1'       *IN63                           ERL415
     C                     MOVEL'ERB3006' ZAMSID                          ERL415
     C                     EXSR ZASNMS                                    ERL415
     C                     END                             - E1           ERL415
      ***********                                                  ERL415 ULX004
      ***Validate Amount Type                                      ERL415 ULX004
      ***********                                                  ERL415 ULX004
     C***********DSAMTY    IFEQ *BLANKS                    - B1    ERL415 ULX004
     C***********          MOVE 'G'       DSAMTY                   ERL415 ULX004
     C***********          ELSE                            - X1    ERL415 ULX004
     C***********DSAMTY    IFNE 'G'                        - B2    ERL415 ULX004
     C***********DSAMTY    ANDNE'C'                                ERL415 ULX004
     C***********DSAMTY    ANDNE'L'                                ERL415 ULX004
     C***********          MOVE '1'       *IN26                    ERL415 ULX004
     C***********          MOVE '1'       *IN63                    ERL415 ULX004
     C***********          MOVEL'ERL3009' ZAMSID                   ERL415 ULX004
     C***********          EXSR ZASNMS                             ERL415 ULX004
     C***********          END                             - E2    ERL415 ULX004
     C***********          END                             - E1    ERL415 ULX004
     C***********                                                  ERL415 ULX004
      *                                                                   ULX004
      **  Validate Amount Type                                            ULX004
      *                                                                   ULX004
     C           DSAMTY    IFEQ *BLANKS                    - B1           ULX004
     C*D***                MOVE '0'       DSAMTY                    ULX004ULX046
     C                     MOVE '00'      DSAMTY                          ULX046
     C                     ELSE                            - X1           ULX004
     C*D***      DSAMTY    LOKUPPORT                     83         ULX004ULX046
     C                     Z-ADD1         X       30                      ULX046
     C           DSAMTY    LOKUPAMTY,X                   83               ULX046
     C           *IN83     IFEQ *OFF                       - B2           ULX004
     C                     MOVE '1'       *IN28                           ULX004
     C                     MOVE '1'       *IN63                           ULX004
     C                     MOVEL'ERL3009' ZAMSID                          ULX004
     C                     EXSR ZASNMS                                    ULX004
     C                     ELSE                                           ULX046
     C                     MOVELAMTY2,X   DSAMTY                          ULX046
     C                     END                             - E2           ULX004
     C                     END                             - E1           ULX004
      *                                                                   ULX004
      ** Validate Product Code.                                           ULX004
      *                                                                   ULX004
      ** Validation if fully numeric                                      ULX004
      *                                                                   ULX004
     C           DSPRCD    IFEQ *BLANKS                    - B1           ULX004
     C                     MOVE *ZEROS    DSPRCD                          ULX004
     C                     END                             - E1           ULX004
      *                                                                   ULX004
     C           DSPRCD    IFNE *ZEROS                     - B1           ULX004
     C                     MOVELDSPRCD    TEST5   50                      ULX004
     C                     MOVELTEST5     ALPH4   4                       ULX004
     C           DSPRCD    IFNE ALPH4                      - B2           ULX004
     C                     MOVE '1'       *IN26                           ULX004
     C                     MOVE '1'       *IN63                           ULX004
     C                     MOVEL'ERL0012' ZAMSID                          ULX004
     C                     EXSR ZASNMS                                    ULX004
     C                     END                             - E2           ULX004
     C                     END                             - E1           ULX004
      *                                                                   ULX004
     C           DSPRCD    IFNE *ZEROS                     - B1           ULX004
     C           *IN27     ANDEQ'0'                                       ULX004
     C                     MOVE DSPRCD    WPRCD   40                      ULX004
     C******     WPRCD     LOKUPPROD                     83        ULX004 ULX004
      *                                                                   ULX004
      ** Product*Code*doesn't*exist*on*table.                      ULX004 ULX004
     C******     *IN83     IFEQ '0'                        - B2           ULX004
     C           WPRCD     CHAINERPRDCPD             82                   ULX004
      ** Product Code doesn't exist                                       ULX004
     C           *IN82     IFEQ '1'                        - B2           ULX004
     C                     MOVE '1'       *IN26                           ULX004
     C                     MOVE '1'       *IN63                           ULX004
     C                     MOVEL'ERL0013' ZAMSID                          ULX004
     C                     EXSR ZASNMS                                    ULX004
     C                     END                             - E2           ULX004
     C                     END                             - E1           ULX004
      *                                                                   ULX004
      ** Validate Portfolio Type.                                         ULX004
      *                                                                   ULX004
     C           DSPORT    IFEQ *BLANKS                    - B1           ULX004
     C                     MOVE *ZEROS    DSPORT                          ULX004
     C                     ELSE                            - E1           ULX004
      *                                                                   ULX004
     C           DSPORT    LOKUPPORT                     83               ULX004
      *                                                                   ULX004
      ** Portfolio Type doesn't exist on table.                           ULX004
     C           *IN83     IFEQ '0'                        - B2           ULX004
     C                     MOVE '1'       *IN27                           ULX004
     C                     MOVE '1'       *IN63                           ULX004
     C                     MOVEL'ERL0014' ZAMSID                          ULX004
     C                     EXSR ZASNMS                                    ULX004
     C                     END                             - E2           ULX004
     C                     END                             - E1           ULX004
      *                                                                   ULX004
     C                     ENDSR                                          ERL415
     C*                                                                   ERL415
     C**************************************************************************
     C* INITIALIZE SUBFILE
     C**************************************************************************
     C*
     C           INISFL    BEGSR
     C*
     C                     MOVE '0'       *IN80
     C                     MOVE '0'       *IN81
     C                     WRITEERLU30C1
     C                     MOVE '1'       *IN80
     C                     Z-ADD0         RRN     40
     C*
     C                     ENDSR
     C*
     C**************************************************************************
     C* LOAD SUBFILE
     C**************************************************************************
     C*
     C           LOASFE    BEGSR
     C*
     C** IF SELECTION FIELD RESET TO BLANK BY USER ==> SELECT ALL RECORDS
     C           SELEC1    IFNE SELEC2                     - B1
     C           DHNARA    ANDEQ*BLANKS
     C           DHTYPE    ANDEQ*BLANKS
     C           DHEXTY    ANDEQ*BLANKS
     C           DHDEBI    ANDEQ*BLANKS
     C           DHCRED    ANDEQ*BLANKS
     C***********DHAMTY    ANDEQ*BLANKS                                   ULX004
     C           DHAMTY    ANDEQ*BLANKS                                   ULX004
     C           DHPRCD    ANDEQ*BLANKS                                   ULX004
     C           DHPORT    ANDEQ*BLANKS                                   ULX004
     C                     MOVE SELEC1    SELEC2
     C                     END                             - B2
      *                                                                   ULX046
      ** Format the selection field for amount type, to have correct      ULX046
      ** comparisons in the SELEC subroutine                              ULX046
      *                                                                   ULX046
     C           DHAMTY    IFNE *BLANKS                                   ULX046
     C                     Z-ADD1         X                               ULX046
     C           DHAMTY    LOKUPAMTY,X                   83               ULX046
     C   83                MOVELAMTY2,X   DHAMTY                          ULX046
     C                     ENDIF                                          ULX046
     C*
     C** RESETUP WORK FIELDS IF POSITION FIELD CHANGED AFTER SELECTION
     C           DHACOD    IFNE WWACOD                     - B1
     C           DHNARA    IFNE *BLANKS                    - B2
     C           DHEXTY    ORNE *BLANKS
     C           DHTYPE    ORNE *BLANKS
     C           DHCRED    ORNE *BLANKS
     C           DHDEBI    ORNE *BLANKS
     C***********DHAMTY    ORNE *BLANKS                                   ULX004
     C           DHAMTY    ORNE *BLANKS                                   ULX004
     C           DHPRCD    ORNE *BLANKS                                   ULX004
     C           DHPORT    ORNE *BLANKS                                   ULX004
     C                     MOVE *BLANKS   WWNARA
     C                     MOVE *BLANKS   WWEXTY
     C                     MOVE *BLANKS   WWTYPE
     C                     MOVE *BLANKS   WWCRED
     C                     MOVE *BLANKS   WWDEBI
     C***********          MOVE *BLANKS   WWAMTY                          ULX004
     C                     MOVE *BLANKS   WWAMTY                          ULX004
     C                     MOVE *BLANKS   WWPRCD                          ULX004
     C                     MOVE *BLANKS   WWPORT                          ULX004
     C                     END                             - E2
     C                     END                             - E1
     C*
     C* INIT SCREEN LINE NUMBER
     C                     Z-ADD0         WWCPT   20
     C*
     C* ACCOUNT CODE SELECTED
     C           DHACOD    IFNE *ZEROS                     - B1
     C           DHACOD    SETLLERLUACL1
     C                     ELSE
     C           *LOVAL    SETLLERLUACL1
     C                     END                             - E1
     C*
     C* NAME SELECTED
     C           DHNARA    IFNE *BLANKS                    - B1
     C                     EXSR CALLEN
     C                     END                             - E1
     C*                                                                   ERL200
     C* ROLLUP PRESSED                                                    ERL200
     C           WWAID     IFEQ 'UP'                       - B1           ERL200
     C**********           MOVELWWSAV2    DUSELE  40                                   ERL200 CER001
     C                     MOVE WWSAV2    DUSELE 100                                          CER001
     C           DUSELE    SETLLERLUACL1                                  ERL200
     C                     END                             - E1           ERL200
     C*
     C* READ RECORD
     C                     READ ERLUACL1                 30
     C*
     C* LOAD SUBFILE
     C                     MOVE '0'       *IN63
     C*
     C           *IN30     DOWEQ'0'                        - B1
     C           WWCPT     ANDLT14                                        ERL200
     C*
     C                     MOVE VBACOD    DSACOD
     C                     MOVE VBEXTT    DSEXTY
     C**********           MOVE VBAMTY    DSAMTY                          ULX004
     C                     MOVE VBAMTY    DSAMTY                          ULX004
     C                     MOVE VBPRCD    DSPRCD                          ULX004
     C                     MOVE VBPORT    DSPORT                          ULX004
     C                     MOVE VBRBND    DSDEBI
     C                     MOVE VBRBNC    DSCRED
     C*
     C                     MOVE *BLANKS   DSSELE
     C           DSACOD    CHAINSDACODL1             88
     C           *IN88     IFEQ '0'                        - B2
     C*
     C** TAKE NOT-TITLE ONLY
     C           A5TOIN    IFEQ 'Y'                        - B3
     C                     GOTO NEXT
     C                     END                             - E3
     C*
     C                     MOVE A5ACCN    DSNARA
     C                     MOVE A5ACTY    DSTYPE
     C                     ELSE                            - X2
     C                     MOVE *BLANKS   DSNARA
     C                     MOVE *BLANKS   DSTYPE
     C                     END                             - E2
     C*
     C* SELECTION HAS BEEN ENTERRED AND NOT COMING FROM F9
     C***********SELEC1    IFNE SELEC2                     - B2           ERL200
     C           SELEC1    IFNE *BLANKS                    - B2           ERL200
     C           IN16      ANDEQ*BLANKS
     C*
     C** RECORD READ SELECTED OR NOT ???
     C           DHNARA    IFNE *BLANKS                    - B3
     C                     MOVE '0'       *IN90
     C           DHNARA:I  SCAN A5ACCN                   90
     C                     END                             - E3
     C*
     C                     MOVE '0'       *IN10
     C                     EXSR SELEC
     C           *IN10     IFEQ '1'                        - B3
     C*
     C* LOAD FIELDS
     C                     ADD  1         RRN        81
     C                     ADD  1         WWCPT            SCREEN LINE MBR
     C*
     C* WRITE IN SUBFILE
     C                     WRITEERLU30S1
     C*
     C                     END                             - E3
     C*
     C                     ELSE                            - X2
     C* LOAD FIELDS
     C                     ADD  1         RRN        81
     C                     ADD  1         WWCPT            SCREEN LINE MBR
     C*
     C* WRITE IN SUBFILE
     C                     WRITEERLU30S1
     C*
     C                     END                             - E2
     C*
     C* READ NEXT RECORD
     C           NEXT      TAG
     C                     READ ERLUACL1                 30
     C**********           Z-ADDVBACOD    WWSAV2  40                                   ERL200 CER001
     C                     Z-ADDVBACOD    WWSAV2 100                                   ERL200 CER001
     C*
     C                     END                             - E1
     C*
     C                     Z-ADDDHACOD    WWACOD
     C                     Z-ADDRRN       WWRRN   40                      ERL200
     C*
     C                     ENDSR
     C**************************************************************************
     C* LOAD SUBFILE WHEN F9 HAS BEEN PRESSED !
     C**************************************************************************
     C*
     C           LOASF9    BEGSR
     C*
     C                     MOVE '0'       *IN63
     C*
     C* INIT SCREEN LINE NUMBER
     C                     Z-ADD1         CPT     20
     C*
     C* LOAD SUBFILE
     C           CPT       DOWLE30                         - B1
     C*
     C                     MOVE *BLANKS   DSACOD
     C                     MOVE *BLANKS   DSNARA
     C                     MOVE *BLANKS   DSEXTY
     C                     MOVE *BLANKS   DSTYPE
     C                     MOVE *BLANKS   DSDEBI
     C                     MOVE *BLANKS   DSCRED
     C**********           MOVE *BLANKS   DSAMTY                          ULX004
     C                     MOVE *BLANKS   DSAMTY                          ULX004
     C                     MOVE *BLANKS   DSPRCD                          ULX004
     C                     MOVE *BLANKS   DSPORT                          ULX004
     C*
     C*
     C* LOAD FIELDS
     C                     ADD  1         RRN        81
     C                     ADD  1         CPT              SCREEN LINE MBR
     C*
     C* WRITE IN SUBFILE
     C                     WRITEERLU30S1
     C*
     C                     END                             - E1
     C*
     C                     ENDSR
     C**************************************************************************
     C* SELEC SUBROUTINE - SELECTION FOR THE RECORD READ                       *
     C**************************************************************************
     C*
     C           SELEC     BEGSR
     C*
     C** NARRATIVE SELECTED
     C           DHNARA    IFNE *BLANKS                    - B1
     C           *IN90     IFEQ '1'                        - B2
     C*
     C           DHTYPE    IFEQ *BLANKS                    - B3
     C           DHEXTY    ANDEQ*BLANKS
     C           DHDEBI    ANDEQ*BLANKS
     C           DHCRED    ANDEQ*BLANKS
     C***********DHAMTY    ANDEQ*BLANKS                                   ULX004
     C           DHAMTY    ANDEQ*BLANKS                                   ULX004
     C           DHPRCD    ANDEQ*BLANKS                                   ULX004
     C           DHPORT    ANDEQ*BLANKS                                   ULX004
     C                     MOVE '1'       *IN10
     C                     END                             - E3
     C*
     C           DHTYPE    IFNE *BLANKS                    - B3
     C           DHTYPE    IFEQ DSTYPE                     - B4
     C                     MOVE '1'       *IN10
     C                     ELSE                            - X4
     C                     MOVE '0'       *IN10
     C                     GOTO ENDSEL
     C                     END                             - E4
     C                     END                             - E3
     C*
     C           DHEXTY    IFNE *BLANKS                    - B3
     C           DHEXTY    IFEQ DSEXTY                     - B4
     C                     MOVE '1'       *IN10
     C                     ELSE                            - X4
     C                     MOVE '0'       *IN10
     C                     GOTO ENDSEL
     C                     END                             - E4
     C                     END                             - E3
     C*
     C           DHDEBI    IFNE *BLANKS                    - B3
     C           DHDEBI    IFEQ DSDEBI                     - B4
     C                     MOVE '1'       *IN10
     C                     ELSE                            - X4
     C                     MOVE '0'       *IN10
     C                     GOTO ENDSEL
     C                     END                             - E4
     C                     END                             - E3
     C*
     C           DHCRED    IFNE *BLANKS                    - B3
     C           DHCRED    IFEQ DSCRED                     - B4
     C                     MOVE '1'       *IN10
     C                     ELSE                            - X4
     C                     MOVE '0'       *IN10
     C                     GOTO ENDSEL
     C                     END                             - E4
     C                     END                             - E3
     C*
     C***********DHAMTY    IFNE *BLANKS                    - B3           ULX004
     C***********DHAMTY    IFEQ DSAMTY                     - B4           ULX004
     C           DHAMTY    IFNE *BLANKS                    - B3           ULX004
     C           DHAMTY    IFEQ DSAMTY                     - B4           ULX004
     C                     MOVE '1'       *IN10                           ULX004
     C                     ELSE                            - X4           ULX004
     C                     MOVE '0'       *IN10                           ULX004
     C                     GOTO ENDSEL                                    ULX004
     C                     END                             - E4           ULX004
     C                     END                             - E3           ULX004
     C*                                                                   ULX004
     C           DHPRCD    IFNE *BLANKS                    - B3           ULX004
     C           DHPRCD    IFEQ DSPRCD                     - B4           ULX004
     C                     MOVE '1'       *IN10
     C                     ELSE                            - X4
     C                     MOVE '0'       *IN10
     C                     GOTO ENDSEL
     C                     END                             - E4
     C                     END                             - E3
     C*                                                                   ULX004
     C           DHPORT    IFNE *BLANKS                    - B3           ULX004
     C           DHPORT    IFEQ DSPORT                     - B4           ULX004
     C                     MOVE '1'       *IN10                           ULX004
     C                     ELSE                            - X4           ULX004
     C                     MOVE '0'       *IN10                           ULX004
     C                     GOTO ENDSEL                                    ULX004
     C                     END                             - E4           ULX004
     C                     END                             - E3           ULX004
     C*                                                                   ULX004
     C                     END                             - E2
     C                     GOTO ENDSEL
     C                     END                             - E1
     C*
     C** TYPE SELECTED
     C           DHTYPE    IFNE *BLANKS                    - B1
     C           DHTYPE    IFEQ DSTYPE                     - B2
     C*
     C           DHNARA    IFEQ *BLANKS                    - B3
     C           DHEXTY    ANDEQ*BLANKS
     C           DHDEBI    ANDEQ*BLANKS
     C           DHCRED    ANDEQ*BLANKS
     C           DHPRCD    ANDEQ*BLANKS                                   ULX004
     C           DHPORT    ANDEQ*BLANKS                                   ULX004
     C                     MOVE '1'       *IN10
     C                     END                             - E3
     C*
     C           DHEXTY    IFNE *BLANKS                    - B3
     C           DHEXTY    IFEQ DSEXTY                     - B4
     C                     MOVE '1'       *IN10
     C                     ELSE                            - X4
     C                     MOVE '0'       *IN10
     C                     GOTO ENDSEL
     C                     END                             - E4
     C                     END                             - E3
     C*
     C           DHDEBI    IFNE *BLANKS                    - B3
     C           DHDEBI    IFEQ DSDEBI                     - B4
     C                     MOVE '1'       *IN10
     C                     ELSE                            - X4
     C                     MOVE '0'       *IN10
     C                     GOTO ENDSEL
     C                     END                             - E4
     C                     END                             - E3
     C*
     C           DHCRED    IFNE *BLANKS                    - B3
     C           DHCRED    IFEQ DSCRED                     - B4
     C                     MOVE '1'       *IN10
     C                     ELSE                            - X4
     C                     MOVE '0'       *IN10
     C                     GOTO ENDSEL
     C                     END                             - E4
     C                     END                             - E3
     C*
     C***********DHAMTY    IFNE *BLANKS                    - B3           ULX004
     C***********DHAMTY    IFEQ DSAMTY                     - B4           ULX004
     C           DHAMTY    IFNE *BLANKS                    - B3           ULX004
     C           DHAMTY    IFEQ DSAMTY                     - B4           ULX004
     C                     MOVE '1'       *IN10                           ULX004
     C                     ELSE                            - X4           ULX004
     C                     MOVE '0'       *IN10                           ULX004
     C                     GOTO ENDSEL                                    ULX004
     C                     END                             - E4           ULX004
     C                     END                             - E3           ULX004
     C*                                                                   ULX004
     C           DHPRCD    IFNE *BLANKS                    - B3           ULX004
     C           DHPRCD    IFEQ DSPRCD                     - B4           ULX004
     C                     MOVE '1'       *IN10
     C                     ELSE                            - X4
     C                     MOVE '0'       *IN10
     C                     GOTO ENDSEL
     C                     END                             - E4
     C                     END                             - E3
     C*                                                                   ULX004
     C           DHPORT    IFNE *BLANKS                    - B3           ULX004
     C           DHPORT    IFEQ DSPORT                     - B4           ULX004
     C                     MOVE '1'       *IN10                           ULX004
     C                     ELSE                            - X4           ULX004
     C                     MOVE '0'       *IN10                           ULX004
     C                     GOTO ENDSEL                                    ULX004
     C                     END                             - E4           ULX004
     C                     END                             - E3           ULX004
     C*                                                                   ULX004
     C                     END                             - E2
     C                     GOTO ENDSEL
     C                     END                             - E1
     C*
     C** EXTRACT TYPE SELECTED
     C           DHEXTY    IFNE *BLANKS                    - B1
     C           DHEXTY    IFEQ DSEXTY                     - B2
     C*
     C           DHNARA    IFEQ *BLANKS                    - B3
     C           DHTYPE    ANDEQ*BLANKS
     C           DHDEBI    ANDEQ*BLANKS
     C           DHCRED    ANDEQ*BLANKS
     C           DHPRCD    ANDEQ*BLANKS                                   ULX004
     C           DHPORT    ANDEQ*BLANKS                                   ULX004
     C                     MOVE '1'       *IN10
     C                     END                             - E3
     C*
     C           DHDEBI    IFNE *BLANKS                    - B3
     C           DHDEBI    IFEQ DSDEBI                     - B4
     C                     MOVE '1'       *IN10
     C                     ELSE                            - X4
     C                     MOVE '0'       *IN10
     C                     GOTO ENDSEL
     C                     END                             - E4
     C                     END                             - E3
     C*
     C           DHCRED    IFNE *BLANKS                    - B3
     C           DHCRED    IFEQ DSCRED                     - B4
     C                     MOVE '1'       *IN10
     C                     ELSE                            - X4
     C                     MOVE '0'       *IN10
     C                     GOTO ENDSEL
     C                     END                             - E4
     C                     END                             - E3
     C*
     C***********DHAMTY    IFNE *BLANKS                    - B3           ULX004
     C***********DHAMTY    IFEQ DSAMTY                     - B4           ULX004
     C           DHAMTY    IFNE *BLANKS                    - B3           ULX004
     C           DHAMTY    IFEQ DSAMTY                     - B4           ULX004
     C                     MOVE '1'       *IN10                           ULX004
     C                     ELSE                            - X4           ULX004
     C                     MOVE '0'       *IN10                           ULX004
     C                     GOTO ENDSEL                                    ULX004
     C                     END                             - E4           ULX004
     C                     END                             - E3           ULX004
     C*                                                                   ULX004
     C           DHPRCD    IFNE *BLANKS                    - B3           ULX004
     C           DHPRCD    IFEQ DSPRCD                     - B4           ULX004
     C                     MOVE '1'       *IN10
     C                     ELSE                            - X4
     C                     MOVE '0'       *IN10
     C                     GOTO ENDSEL
     C                     END                             - E4
     C                     END                             - E3
     C*                                                                   ULX004
     C           DHPORT    IFNE *BLANKS                    - B3           ULX004
     C           DHPORT    IFEQ DSPORT                     - B4           ULX004
     C                     MOVE '1'       *IN10                           ULX004
     C                     ELSE                            - X4           ULX004
     C                     MOVE '0'       *IN10                           ULX004
     C                     GOTO ENDSEL                                    ULX004
     C                     END                             - E4           ULX004
     C                     END                             - E3           ULX004
     C*                                                                   ULX004
     C                     END                             - E2
     C                     GOTO ENDSEL
     C                     END                             - E1
     C*
     C** RUBRIC DEBIT SELECTED
     C           DHDEBI    IFNE *BLANKS                    - B1
     C           DHDEBI    IFEQ DSDEBI                     - B2
     C*
     C           DHNARA    IFEQ *BLANKS                    - B3
     C           DHTYPE    ANDEQ*BLANKS
     C           DHEXTY    ANDEQ*BLANKS
     C           DHCRED    ANDEQ*BLANKS
     C           DHPRCD    ANDEQ*BLANKS                                   ULX004
     C           DHPORT    ANDEQ*BLANKS                                   ULX004
     C                     MOVE '1'       *IN10
     C                     END                             - E3
     C*
     C           DHCRED    IFNE *BLANKS                    - B3
     C           DHCRED    IFEQ DSCRED                     - B4
     C                     MOVE '1'       *IN10
     C                     ELSE                            - X4
     C                     MOVE '0'       *IN10
     C                     GOTO ENDSEL
     C                     END                             - E4
     C                     END                             - E3
     C*
     C***********DHAMTY    IFNE *BLANKS                    - B3           ULX004
     C***********DHAMTY    IFEQ DSAMTY                     - B4           ULX004
     C           DHAMTY    IFNE *BLANKS                    - B3           ULX004
     C           DHAMTY    IFEQ DSAMTY                     - B4           ULX004
     C                     MOVE '1'       *IN10                           ULX004
     C                     ELSE                            - X4           ULX004
     C                     MOVE '0'       *IN10                           ULX004
     C                     GOTO ENDSEL                                    ULX004
     C                     END                             - E4           ULX004
     C                     END                             - E3           ULX004
     C*                                                                   ULX004
     C           DHPRCD    IFNE *BLANKS                    - B3           ULX004
     C           DHPRCD    IFEQ DSPRCD                     - B4           ULX004
     C                     MOVE '1'       *IN10
     C                     ELSE                            - X4
     C                     MOVE '0'       *IN10
     C                     GOTO ENDSEL
     C                     END                             - E4
     C                     END                             - E3
     C*                                                                   ULX004
     C           DHPORT    IFNE *BLANKS                    - B3           ULX004
     C           DHPORT    IFEQ DSPORT                     - B4           ULX004
     C                     MOVE '1'       *IN10                           ULX004
     C                     ELSE                            - X4           ULX004
     C                     MOVE '0'       *IN10                           ULX004
     C                     GOTO ENDSEL                                    ULX004
     C                     END                             - E4           ULX004
     C                     END                             - E3           ULX004
     C*                                                                   ULX004
     C                     END                             - E2
     C                     GOTO ENDSEL
     C                     END                             - E1
     C*
     C** RUBRIC CREDIT SELECTED
     C           DHCRED    IFNE *BLANKS                    - B1
     C           DHCRED    IFEQ DSCRED                     - B2
     C*
     C           DHNARA    IFEQ *BLANKS                    - B3
     C           DHTYPE    ANDEQ*BLANKS
     C           DHEXTY    ANDEQ*BLANKS
     C           DHDEBI    ANDEQ*BLANKS
     C           DHPRCD    ANDEQ*BLANKS                                   ULX004
     C           DHPORT    ANDEQ*BLANKS                                   ULX004
     C                     MOVE '1'       *IN10
     C                     END                             - E3
     C*
     C***********DHAMTY    IFNE *BLANKS                    - B3           ULX004
     C***********DHAMTY    IFEQ DSAMTY                     - B4           ULX004
     C           DHAMTY    IFNE *BLANKS                    - B3           ULX004
     C           DHAMTY    IFEQ DSAMTY                     - B4           ULX004
     C                     MOVE '1'       *IN10                           ULX004
     C                     ELSE                            - X4           ULX004
     C                     MOVE '0'       *IN10                           ULX004
     C                     GOTO ENDSEL                                    ULX004
     C                     END                             - E4           ULX004
     C                     END                             - E3           ULX004
     C*                                                                   ULX004
     C           DHPRCD    IFNE *BLANKS                    - B3           ULX004
     C           DHPRCD    IFEQ DSPRCD                     - B4           ULX004
     C                     MOVE '1'       *IN10
     C                     ELSE                            - X4
     C                     MOVE '0'       *IN10
     C                     GOTO ENDSEL
     C                     END                             - E4
     C                     END                             - E3
     C*                                                                   ULX004
     C           DHPORT    IFNE *BLANKS                    - B3           ULX004
     C           DHPORT    IFEQ DSPORT                     - B4           ULX004
     C                     MOVE '1'       *IN10                           ULX004
     C                     ELSE                            - X4           ULX004
     C                     MOVE '0'       *IN10                           ULX004
     C                     GOTO ENDSEL                                    ULX004
     C                     END                             - E4           ULX004
     C                     END                             - E3           ULX004
     C*                                                                   ULX004
     C                     END                             - E2
     C                     GOTO ENDSEL                                    ULX004
     C                     END                             - E1
      *
      ***Amount*Type*selected**********                                   ULX004
      **  Amount Type selected                                            ULX004
     C           DHAMTY    IFNE *BLANKS                    - B1           ULX004
     C           DHAMTY    IFEQ DSAMTY                     - B2           ULX004
     C           DHNARA    IFEQ *BLANKS                    - B3           ULX004
     C           DHTYPE    ANDEQ*BLANKS                                   ULX004
     C           DHEXTY    ANDEQ*BLANKS                                   ULX004
     C           DHDEBI    ANDEQ*BLANKS                                   ULX004
     C           DHCRED    ANDEQ*BLANKS                                   ULX004
     C           DHPORT    ANDEQ*BLANKS                                   ULX004
     C                     MOVE '1'       *IN10                           ULX004
     C                     END                             - E3           ULX004
     C                     END                             - E2           ULX004
     C                     GOTO ENDSEL                                    ULX004
     C                     END                             - E1           ULX004
      *                                                                   ULX004
      ** Product Code selected                                            ULX004
      *
     C***********DHAMTY    IFNE *BLANKS                    - B1           ULX004
     C***********DHAMTY    IFEQ DSAMTY                     - B2           ULX004
     C           DHPRCD    IFNE *BLANKS                    - B1           ULX004
     C           DHPRCD    IFEQ DSPRCD                     - B2           ULX004
      *
     C           DHNARA    IFEQ *BLANKS                    - B3
     C           DHTYPE    ANDEQ*BLANKS
     C           DHEXTY    ANDEQ*BLANKS
     C           DHDEBI    ANDEQ*BLANKS
     C           DHCRED    ANDEQ*BLANKS
     C           DHPORT    ANDEQ*BLANKS                                   ULX004
     C                     MOVE '1'       *IN10
     C                     END                             - E3
     C*                                                                   ULX004
     C           DHPORT    IFNE *BLANKS                    - B3           ULX004
     C           DHPORT    IFEQ DSPORT                     - B4           ULX004
     C                     MOVE '1'       *IN10                           ULX004
     C                     ELSE                            - X4           ULX004
     C                     MOVE '0'       *IN10                           ULX004
     C                     GOTO ENDSEL                                    ULX004
     C                     END                             - E4           ULX004
     C                     END                             - E3           ULX004
     C*                                                                   ULX004
     C                     END                             - E2
     C                     GOTO ENDSEL                                    ULX004
     C                     END                             - E1
      *                                                                   ULX004
      ** Portfolio Type selected.                                         ULX004
      *                                                                   ULX004
     C           DHPORT    IFNE *BLANKS                    - B1           ULX004
     C           DHPORT    IFEQ DSPORT                     - B2           ULX004
      *                                                                   ULX004
     C           DHNARA    IFEQ *BLANKS                    - B3           ULX004
     C           DHTYPE    ANDEQ*BLANKS                                   ULX004
     C           DHEXTY    ANDEQ*BLANKS                                   ULX004
     C           DHDEBI    ANDEQ*BLANKS                                   ULX004
     C           DHCRED    ANDEQ*BLANKS                                   ULX004
     C           DHPRCD    ANDEQ*BLANKS                                   ULX004
     C                     MOVE '1'       *IN10                           ULX004
     C                     END                             - E3           ULX004
     C*                                                                   ULX004
     C                     END                             - E2           ULX004
     C                     END                             - E1           ULX004
     C*
     C           ENDSEL    TAG
     C*
     C                     ENDSR
     C**************************************************************************
     C* INITIAL ROUTINE                                                        *
     C**************************************************************************
     C*
     C           INIT      BEGSR
     C*
     C                     MOVE CTRY      PARCTR
     C*
     C                     MOVE '0'       *IN
     C*
     C           ACTION    IFEQ 'E'
     C                     MOVE '1'       *IN15
     C                     END
     C*
     C*   Select the program MSGQ for error msg.
     C                     MOVEL'*'       TOPQ   10
     C                     MOVEL'*PRV'    TOPRQ   5
     C                     MOVEL'*'       DDPGMQ
     C**********           MOVEL'ERUSRMSG'PMSGF  10                                           CER001
     C                     MOVEL'STUSRMSG'PMSGF  10                                           CER001
     C*
     C*   Fill in fields for subroutine ZASNMS
     C                     MOVEL'ERLU30'  ZAPGM  10        Message queue
     C**********           MOVEL'ERUSRMSG'ZAMSGF 10        Message file                       CER001
     C                     MOVEL'STUSRMSG'ZAMSGF 10                                           CER001
     C                     MOVEL*BLANK    ZAPGRL  5        Rel queue
     C                     MOVEL*BLANK    ZAMSID  7        Message Id.
     C                     MOVEL*BLANK    ZAMSDA132        Message data.
     C                     MOVEL*BLANK    ZAMSTP  7        Message type.
     C*
     C******               READ SDBANKPD                 88               ULX004
     C*
      *                                                                   ULX004
      **  Get Installation Control Data Record 1                          ULX004
      *                                                                   ULX004
     C                     CALL 'AOBANKR0'                                ULX004
     C                     PARM '*MSG   ' @RTCD   7                       ULX004
     C                     PARM '*FIRST ' @OPTN   7                       ULX004
     C           SDBANK    PARM SDBANK    DSFDY                           ULX004
     C           @RTCD     IFNE *BLANKS                    *----------1   ULX004
     C                     Z-ADD1         DBASE            ***************ULX004
     C                     MOVEL'SDBANKPD'DBFILE           * DB ERROR 01 *ULX004
     C                     MOVEL'*FIRST'  DBKEY            ***************ULX004
     C                     EXSR *PSSR                                     ULX004
     C                     ENDIF                           *----------1   ULX004
      *                                                                   ULX004
     C                     MOVE *BLANKS   DHDEBI
     C                     MOVE *BLANKS   DHCRED
     C                     MOVE *BLANKS   WWDEBI
     C                     MOVE *BLANKS   WWCRED
     C*
     C                     Z-ADD0         DHACOD
     C                     Z-ADD0         WWACOD  40
     C*
     C** SETUP 'ADD' OR 'AMEND' MODE
     C                     READ ERLUACL1                 88
     C           *IN88     IFEQ '1'
     C                     MOVE '1'       *IN09
     C                     END
     C*
     C                     ENDSR
     C****************************************************************
     C*  ZASNMS : SEND MESSAGE TO PROGRAM'S MESSAGE QUEUE            *
     C****************************************************************
     C           ZASNMS    BEGSR
     C*
     C**   message file specified use PMSGF
     C                     MOVELPMSGF     ZAMSGF
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGM  10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message Id.
     C                     PARM           ZAMSGF 10        Message file.
     C                     PARM           ZAMSDA132        Message data.
     C                     PARM           ZAMSTP  7        Message type.
     C**
     C**   Clear all fields for default mechanism next time.
     C                     MOVEL*BLANK    ZAPGM            Program queue
     C                     MOVEL*BLANK    ZAPGRL           Rel queue
     C                     MOVEL*BLANK    ZAMSDA           Message data.
     C                     MOVEL*BLANK    ZAMSTP           Message type.
     C                     MOVEL*BLANK    ZAMSGF           Message file
     C                     MOVEL*BLANK    ZAMSID           Message id.
     C**
     C                     ENDSR
     C*
     C*****************************************************************
     C**                                                              *
     C**   *PSSR     - PROGRAM ERROR HANDLING ROUTINE                 *
     C**                                                              *
     C**   CALLS     -                                                *
     C**                                                              *
     C**   CALLED BY -                                                *
     C**                                                              *
     C*****************************************************************
     C*
     C           *PSSR     BEGSR
     C*
     C                     MOVE 'E'       #RETRN
     C                     DUMP
     C*
     C           #PSSR0    ENDSR
     C**************************************************************************
     C* CALLEN - SUBROUTINE TO CALCULATE THE LENGHT OF NARRATIVE INPUT
     C**************************************************************************
     C           CALLEN    BEGSR
     C*
     C                     MOVEADHNARA    ARR
     C                     Z-ADD25        I       20
     C*
     C           ARR,I     DOWEQ*BLANKS
     C                     SUB  1         I
     C                     END
     C*
     C                     ENDSR
     C********************************************************************ERL200
      ** PRESS S/R TO MOVE THE APPROPRIATE VALUES INTO FIELD WWAID,       ERL200
      ** DEPENDING ON WHICH FUNCTION KEY HAS BEEN PRESSED.                ERL200
      **                                                                  ERL200
     C*===================================================================ERL200
     C*                                                                   ERL200
     C           PRESS     BEGSR                           ** PRESS BSR **ERL200
     C*                                                                   ERL200
     C** If ENTER pressed, the VLDCMDKEY indicator will be off            ERL200
     C*                                                                   ERL200
     C                     MOVE '  '      WWAID                           ERL200
     C*                                                                   ERL200
     C           *IN45     IFEQ '0'                                       ERL200
     C                     MOVE 'RA'      WWAID   2                       ERL200
     C                     END                                            ERL200
     C*                                                                   ERL200
     C** If F3                                                            ERL200
     C*                                                                   ERL200
     C           *INKC     IFEQ '1'                                       ERL200
     C                     MOVE '03'      WWAID                           ERL200
     C                     END                                            ERL200
     C*                                                                   ERL200
     C** If F12                                                           ERL200
     C*                                                                   ERL200
     C           *INKL     IFEQ '1'                                       ERL200
     C                     MOVE '12'      WWAID                           ERL200
     C                     END                                            ERL200
     C*                                                                   ERL200
     C** If ROLLUP pressed                                                ERL200
     C*                                                                   ERL200
     C           *IN35     IFEQ '1'                                       ERL200
     C                     MOVE 'UP'      WWAID                           ERL200
     C                     END                                            ERL200
     C*                                                                   ERL200
     C                     ENDSR                           ** PRESS ESR **ERL200
     C*                                                                   ERL200
     C*===================================================================ERL200
**  PORT                                                                  ULX004
0123456789                                                                ULX004
**  AMTY                                                                  ULX046
00 00 01 11 02 22 03 33 04 44 05 55 06 66 07 77 08 88 09 99 101112        ULX046
**  AMTY2                                                                 ULX046
000000010101020202030303040404050505060606070707080808090909101112        ULX046
**  CPY@
(c) Misys International Banking Systems Ltd. 2005
