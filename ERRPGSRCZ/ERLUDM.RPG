     H        1                           F
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas ER - CSSF Depot Movements Extract')              *
      *****************************************************************
      *                                                               *
      *  Midas - European Reporting (CSSF)                            *
      *                                                               *
      *  ERLUDM - Depot Movements Extract for CSSF Reporting          *
      *                                                               *
      *  Function:  This program will read DPTMB file to select       *
      *  (phase(s)) trades to be reported at CSSF. These are written  *
      *             in ERLUCBPP flat file.                            *
      *  Called  in : COB automatically  (Rundate)                    *
      *             : I/C by menu (Chosen date)                       *
      *                                                               *
      *  Called By: ERCLUCB - CCSF Reporting                          *
      *                                                               *
      *  (c) Finastra International Limited 2005                      *
      *                                                               *
      *  Last Amend No. MD057247           Date 01Feb21               *
      *  Prev Amend No. 248698             Date 01Jun20               *
      *                 MD046248           Date 27Oct17               *
      *                 MD034387           Date 25Jan16               *
      *                 MD034776           Date 08Jul15               *
      *                 AR1067108          Date 11Dec12               *
      *                 AR1001183A         Date 20Nov12               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD027A            Date 03May06               *
      *                 CER001             Date 25Apr05               *
      *                 223136             DATE 05DEC03               *
      *                 ULX042             DATE 14Apr03               *
      *                 UPG402             Date 03Oct04               *
      *                 186797             DATE 07MAR01               *
      *                 ULX008             Date 25Jul00               *
      *                 180013             Date 29Jun00               *
      *                 180219             Date 14Jun00               *
      *                 180074             Date 06Jun00               *
      *                 179959             Date 06Jun00               *
      *                 ULX008             Date 18Apr00               *
      *                 ULX008             Date 16Mar00               *
      *                                                               *
      *---------------------------------------------------------------*
      *                                                               *
      *  MD057247 - Multiple calls of UTCHOBJEX for several COB com-  *
      *             ponents - Securities module.                      *
      *           - Moved the call of AOSARDR0 from /copy ZLCDZ1.     *
      *  248698 - Rounding discrepancies on some SE reports. Applied  *
      *           fix 228682.                                         *
      *  228682 - Recompiled due to ZCNSDZ1 changes. Applied 176594.  *      
      *  MD046248 - Finastra Rebranding                               *
      *  MD034387 - Recompiled over changes made in /COPY ZDYYRZ3     *
      *  MD034776 - Reverse AR1001183A to allow negative interest     *
      *             rate. (Recompile)                                 *
      *  AR1067108 - PMC1140 Component failed during Clean COB        *
      *              Applied fix AR1001183A                           *
      *  AR1001183A- Coupon rate was still used in computation of     *
      *              interest instead of using the details in FRN tab *
      *              (Reopen) (Recompile)                             *
      *  CSD027A - Conversion of customer number to alpha (post       *
      *            build 103). Recompiled.                            *
      *  CER001 - LUX Upgrade to MidasPlus                            *
      *  223136 - Do not divide the price by 100 if pourcentage       *
      *  ULX042 - Change Control D to ULX008 (TAF Reporting)          *
      *  UPG402 - Recompile due to upgrade to R4.02                   *
      *  186797 - "Succursales" should also be reported to CSSF.      *
      *  ULX008 - CSSF Statutory Reporting : Change Control C         *
      *  180013 - Deleted depot movements are reported as input ones  *
      *  180219 - Confusion between Beneficiary and Counterparty      *
      *           on Depot Movements                                  *
      *  180074 - Wrong Details for Price ==> must Be percentage      *
      *  179959 - BFCLAS to Be 'K' for depositairy and not 'D'        *
      *  ULX008 - CSSF Statutory Reporting : Change Control B         *
      *  ULX008 - CSSF Statutory Reporting : Change Control A         *
      *                                                               *
      *****************************************************************
     FDPTMB   IF  E           K        DISK         KINFSR *PSSR
      ***  Depot Movements by branch
      *
     FERLUICL1IF  E           K        DISK         KINFSR *PSSR
      ***  LU I.C.D.
      *
     F***DPTMVDY6UF  E           K        DISK         KINFSR *PSSR                           CER001
     FSEDPX1L0UF  E           K        DISK         KINFSR *PSSR                              CER001
      ***  Depot Movements - Ext Details
      *
     F***SDBRCHY6IF  E           K        DISK         KINFSR *PSSR                           CER001
     FSDBRX2L0IF  E           K        DISK         KINFSR *PSSR                              CER001
      ***  Branch Codes - Ext Details
      *
     F***INVTPDY6IF  E           K        DISK         KINFSR *PSSR                           CER001
     FSEINX2L0IF  E           K        DISK         KINFSR *PSSR                              CER001
      ***  Investment Type - Ext Details
      *
     F***SEMKCDY6IF  E           K        DISK         KINFSR *PSSR                           CER001
     FSEMKX1L0IF  E           K        DISK         KINFSR *PSSR                              CER001
      ***  Market Centre - Ext Details
      *
     F***SDCUSTY6IF  E           K        DISK         KINFSR *PSSR                           CER001
     FSDCUX2L0IF  E           K        DISK         KINFSR *PSSR                              CER001
      ***  Customer - Ext Details
      *
     F***SECTYDY6IF  E           K        DISK         KINFSR *PSSR                           CER001
     FSESDX3L0IF  E           K        DISK         KINFSR *PSSR                              CER001
      ***  SE Security - Ext Details
      *
     FSECTY   IF  E           K        DISK         KINFSR *PSSR
      ***  SE Security details
      *
     FINVTP   IF  E           K        DISK         KINFSR *PSSR
      ***  SE Investment Type
      *
     FSEDEV   IF  E           K        DISK
      *
     FSECEO   IF  E           K        DISK
     F            SEDEVDF                           KRENAMESEDEVDO
     F            SNDEVDF                           KRENAMESNDEVDO
      *
     FERLUCBPPO   E                    DISK         KINFSR *PSSR
      ***  ER LU - CSSF Flat File
      *
      /EJECT
     E****                POW     1   8  8 3                              180074
      /COPY ZSRSRC,ZSDESCZ1
      /COPY ZSRSRC,ZDATE2Z1
      /COPY ZSRSRC,ZDATE9Z1
      /COPY ZSRSRC,ZDAYSZ1
      /COPY ZSRSRC,ZACCRZ0
      /COPY ZSRSRC,ZPOWER8Z1
      /COPY ZSRSRC,ZNCDZ1
      /COPY ZSRSRC,ZHOLE                                                  180074
      ***  Array containing Copyright statement
     E                    CPY@    1   1 80
      *
      /SPACE 3
     IDPTMVDF                                                             180013
      ***  Rename CHTP of DPTMB                                           180013
     I              CHTP                            LASTCH                180013
      *                                                                   180013
     ILDA       E DSLDA                         256
      ***  Local data area for database error details
      *
     IRUNDAT    E DSRUNDAT
      ***  Data Area giving Installation Control Details
      *
     IPSDS       SDS
      ***  Program Status Data Structure
     I                                     *PROGRAM PGM
     I                                      244 253 WSID
     I                                      254 263 USER
      *
     ISDSTRD    E DSSDSTRDPD
      ***  SD Securities Trading I.C.D.
      *
     ISDBANK    E DSSDBANKPD
      ***  SD Bank Details
      *
     ISDBRCH    E DSSDBRCHPD
     I              QQDFAC                          XXDFAC                                    CER001
      ***  SD Branch Details
      *
     ISDSECS    E DSSDSECSPD
     I              QQACCD                          XXACCD                                    CER001
      ***  SD Customer for Sec. Trading
      *
     ISDCUST    E DSSDCUSTPD
      ***  SD Customer Details
      *
     ISDCURR    E DSSDCURRPD
      ***  SD Currency Details
      *
     ISDGELR    E DSSDGELRPD
      ***  General Ledger Details
      *
     IDSSDY     E DSDSSDY
      ***  Long DS for Access Objects Programs
      *
      /COPY ZSRSRC,ZNCDZ2
      /COPY ZSRSRC,ZSDESCZ2
      /COPY ZSRSRC,ZDATE9Z2
      /COPY ZSRSRC,ZYLDZ1
      /COPY ZSRSRC,ZHOLI                                                  180074
      /EJECT
      *****************************************************************
      *                       M A I N L I N E S                       *
      *****************************************************************
      *
      ***  Read Records with LCD = date to work with
      *
     C           *LOVAL    SETLLDPTMB                      First Record
     C                     READ DPTMB                    35
      *
      ***  While record exist for this date,
      *
     C           *IN35     DOWEQ*OFF
      *
      ***  Verify that the record is eligible to be reported to CSSF
      *
     C                     MOVE 'N'       WKDOIT  1        FLAG
      *
      ***  When branch Break, read branch details
      *
     C           DPBA      IFNE WKBRCA
     C                     MOVE DPBA      WKBRCA  3        Read DPBA details
      *
     C                     CALL 'AOBRCHR0'
     C                     PARM *BLANKS   PRTCD   7
     C                     PARM '*KEY   ' POPTN   7
     C                     PARM           WKBRCA
     C           SDBRCH    PARM SDBRCH    DSSDY
      *
     C           PRTCD     IFNE *BLANKS                    Error or not found
     C           *LOCK     IN   LDA
     C                     MOVELPGM       DBPGM            ***************
     C                     Z-ADD6         DBASE            * DBERROR 006 *
     C                     MOVEL'SDBRCHPD'DBFILE    P      ***************
     C                     MOVELDPBA      DBKEY     P
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     ENDIF
      *
      *****Access*LF/SDBRCHY6*to*retrieve*flag*"Include data for*******                       CER001
      ** Access LF/SDBRX2L0 to retrieve flag "Include data for                                CER001
      ***  Reporting"
      *
     C********** DPBA      CHAINSDBRCHY6             99                                       CER001
     C           DPBA      CHAINSDBRX2L0             99                                       CER001
     C           *IN99     IFEQ *ON
     C           *LOCK     IN   LDA
     C                     MOVELPGM       DBPGM            ***************
     C                     Z-ADD7         DBASE            * DBERROR 007 *
     C**********           MOVEL'SDBRCHY6'DBFILE    P      ***************                    CER001
     C                     MOVEL'SDBRX2L0'DBFILE    P      ***************                    CER001
     C                     MOVELDPBA      DBKEY     P
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     ENDIF
     C                     ENDIF                           Branch break
      *
     C           VEINCL    IFNE 'Y'                        branch to report ?
     C           DPBA      SETGTDPTMB                      Next Branch
     C                     ELSE
     C                     MOVE 'Y'       WKDOIT           to be treated
     C                     ENDIF
      *
      ***  Walk In and Walk Out Depot Movements should be considered
      *
     C           DPMV      IFEQ 'WI'
     C           WKDOIT    ANDEQ'Y'
     C           DPMV      OREQ 'WO'
     C           WKDOIT    ANDEQ'Y'
      *
      *****The "Include in CAB Reporting" Flag should be 'Y'
      ***  The "Exclude in CAB Reporting" Flag should not be 'N' to bypass record
      *
     C********** KDEPO     CHAINDPTMVDY6            N99                                       CER001
     C           KDEPO     CHAINSEDPX1L0            N99                                       CER001
      *
     C           *IN99     IFEQ *ON                        Not found
     C           *IN99     OREQ *OFF                       or Excluded
     C           WNCABR    ANDNE'N'
     C                     MOVE 'N'       WKDOIT           Bypass
     C                     ENDIF
      *
     C           WKDOIT    IFEQ 'Y'
     C                     EXSR #CHKP                      Check to process
     C                     ENDIF
      *
      ***  Create Record into Flat File ERLUCBPP
      *
     C           WKDOIT    IFEQ 'Y'
     C                     EXSR #PROC
     C                     ENDIF
      *
     C                     ENDIF                           WI or WO
      *
      ***  Read next record
      *
     C                     READ DPTMB                    35
     C                     ENDDO
      *****************************************************************
      *               E N D    O F    M A I N L I N E S               *
      *****************************************************************
      *
     C                     MOVE *ON       *INLR
     C                     RETRN
      /EJECT
      *****************************************************************
      *  #CHKP  - This routine is used to verify that record is to be *
      *  ------   processed                                           *
      *  Called by : Mainlines                                        *
      *  Calls     : *PSSR                                            *
      *****************************************************************
      *
     C           #CHKP     BEGSR
      *
     C                     MOVE 'N'       WKDOIT  1        FLAG
      *
      ***  Depot Movements will be processed
      ***       if they are cancelled this WKDATE
      ***       or if they are input this WKDATE
      *
     C********   CHTP      IFEQ 'D'                        Deleted        180013
     C           LASTCH    IFEQ 'D'                        Deleted        180013
     C           LCD       ANDEQWKDATE                     At Working Date
     C********   CHTP      ORNE 'D'                        or Inserted    180013
     C           LASTCH    ORNE 'D'                        or Inserted    180013
     C           ORED      ANDEQWKDATE                     At Working Date
      *
     C                     MOVE 'Y'       WKDOIT           Rec. to process
      *
      ***  Exclude depot movements which don't correspond to
      ***  the following criteria
      *
      ***  1) Depot Movements with "Extracted Flag" to D
      ***      OR depot movements with "Extracted Flag" to I but
      ***      last change type not D
      *
     C           WNEXFL    IFEQ 'D'                        Reported as deleted
     C                     MOVE 'N'       WKDOIT
     C                     ENDIF
      *
     C           WNEXFL    IFEQ 'I'                        already reported as inserted
     C***********CHTP      ANDNE'D'                        Except for dele180013
     C           LASTCH    ANDNE'D'                        Except for dele180013
     C                     MOVE 'N'       WKDOIT
     C                     ENDIF
      *
      ***  2) Access LF/SECTY to retrieve Market Indicator
      *
     C           WKDOIT    IFEQ 'Y'                        to be processed
      *
     C           DPSS      CHAINSECTY                99
     C           *IN99     IFEQ *ON                        Not Found
     C           *LOCK     IN   LDA
     C                     MOVELPGM       DBPGM            ***************
     C                     Z-ADD10        DBASE            * DBERROR 010 *
     C                     MOVEL'SECTY'   DBFILE    P      ***************
     C                     MOVELDPSS      DBKEY     P
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     ENDIF
      *
      ***  Exclude if Market Indicator of security is not 'S'
     C           MKTI      IFNE 'S'
     C                     MOVE 'N'       WKDOIT
     C                     ENDIF
     C                     ENDIF
      *
      *****3)*Access*LF/INVTPDY6*to*retrieve*the*flag******************                       CER001
      ** 3) Access LF/SEINX2L0 to retrieve the flag                                           CER001
      ***     "Include in CAB reporting"
      *
     C           WKDOIT    IFEQ 'Y'                        to be processed
     C                     MOVE NMCY      KCCYI
     C                     MOVE SITP      KINVS
      *
     C********** KINVT     CHAININVTPDY6             99                                       CER001
     C           KINVT     CHAINSEINX2L0             99                                       CER001
     C           *IN99     IFEQ *ON                        Not Found
     C           *LOCK     IN   LDA
     C                     MOVELPGM       DBPGM            ***************
     C                     Z-ADD11        DBASE            * DBERROR 011 *
     C**********           MOVEL'INVTPDY6'DBFILE    P      ***************                    CER001
     C                     MOVEL'SEINX2L0'DBFILE    P      ***************                    CER001
     C           KCCYI     CAT  KINVS:1   DBKEY     P
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     ENDIF
      *
      ***  If not included in CAB reporting, Bypass
      *
     C           VUCABR    IFNE 'Y'
     C                     MOVE 'N'       WKDOIT
     C                     ENDIF
     C                     ENDIF                           WKDOIT = 'Y'
      *
      ***  4) If Market Centre is not specifed, the trade is ignored
      *
     C           WKDOIT    IFEQ 'Y'                        to be processed
     C           SMCC      IFEQ *BLANK
     C                     MOVE 'N'       WKDOIT
     C                     ENDIF
     C                     ENDIF                           WKDOIT = 'Y'
      *
      ***  If the "EEE Indicator from Market Centre or from Security"     ULX008
      *****from*LF/ERLUICL1*equals*'M',*then*LF/SEMKCDY6*should*be*****                ULX008 CER001
      ** from LF/ERLUICL1 equals 'M', then LF/SEMKX1L0 should be                              CER001
      ***  accessed to retrieve the "EEE Regulated Market Centre"         ULX008
      ***  indicator                                                      ULX008
      *                                                                   ULX008
      ***  5) Access Market centre ext. details to check EEE Regulated Market
      ***     centre flag (must be set to 'Y')
      *
     C           WKDOIT    IFEQ 'Y'                        to be processed
      *                                                                   ULX008
     C           VPMKSE    IFEQ 'M'                                       ULX008
      *                                                                   ULX008
     C********** SMCC      CHAINSEMKCDY6             99                                       CER001
     C           SMCC      CHAINSEMKX1L0             99                                       CER001
     C           *IN99     IFEQ *ON                        Not Found
     C           *LOCK     IN   LDA
     C                     MOVELPGM       DBPGM            ***************
     C                     Z-ADD12        DBASE            * DBERROR 012 *
     C**********           MOVEL'SEMKCDY6'DBFILE    P      ***************                    CER001
     C                     MOVEL'SEMKX1L0'DBFILE    P      ***************                    CER001
     C                     MOVELSMCC      DBKEY     P
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     ENDIF
      *
     C           X8ERMC    IFNE 'Y'
     C                     MOVE 'N'       WKDOIT
     C                     ENDIF
      *                                                                   ULX008
     C                     ELSE                                           ULX008
      *                                                                   ULX008
      ***  If the "EEE Indicator from Market Centre or from Security"     ULX008
      *****from*LF/ERLUICL1*equals*'S',*then*LF/SECTYDY6*should*be*****                ULX008 CER001
      ** from LF/ERLUICL1 equals 'S', then LF/SESDX3L0 should be                              CER001
      ***  accessed to retieve the "EEE Regulated Market Centre"          ULX008
      ***  indicator                                                      ULX008
      *                                                                   ULX008
     C           VPMKSE    IFEQ 'S'                                       ULX008
     C********** DPSS      CHAINSECTYDY6             99                                ULX008 CER001
     C           DPSS      CHAINSESDX3L0             99                                       CER001
     C           *IN99     IFEQ *ON                        Not Found      ULX008
     C           *LOCK     IN   LDA                                       ULX008
     C                     MOVELPGM       DBPGM            ***************ULX008
     C                     Z-ADD16        DBASE            * DBERROR 016 *ULX008
     C**********           MOVEL'SECTYDY6'DBFILE    P      ***************             ULX008 CER001
     C                     MOVEL'SESDX3L0'DBFILE    P      ***************                    CER001
     C                     MOVELDPSS      DBKEY     P                     ULX008
     C                     OUT  LDA                                       ULX008
     C                     EXSR *PSSR                                     ULX008
     C                     ENDIF                                          ULX008
      *                                                                   ULX008
     C           VVEEEM    IFNE 'Y'                                       ULX008
     C                     MOVE 'N'       WKDOIT                          ULX008
     C                     ENDIF                                          ULX008
      *                                                                   ULX008
     C                     ENDIF                                          ULX008
     C                     ENDIF                                          ULX008
      *                                                                   ULX008
     C                     ENDIF                           WKDOIT = 'Y'
      *
      ***  6) If the market is the 'LU Market'
      ***     and if Counterparty is 'LU' Market Customer
      ***     then Bypass the trade
      ***  180219 - Counterparty is taken for DPTMVDX6 (WNCNBR)           180219
      *
     C           WKDOIT    IFEQ 'Y'                        to be processed
      *
     C******               MOVE DPBN      ALPH06  6        ALPHA 06       180219
     C                     MOVELWNCNBR    ALPH06  6        ALPHA 06       180219
      *
     C           X8MCIN    IFEQ 'Y'                        LU Market = 'Y'
     C           X8LMCN    ANDEQALPH06                     Counterparty
     C                     MOVE 'N'       WKDOIT
     C                     ENDIF
     C                     ENDIF                           WKDOIT = 'Y'
      *
      ***  7) if counterparty Company code is blanks and
      ***        counterparty citizenship is 'LU', ignore the trade
      ***     when counterparty classifiaction is 'E'uroclear, or 'C'edel or
      ***     K'assenverein or 'X' Market customer, take A8BICN as Counterparty
      ***  180219 - Counterparty is taken for DPTMVDX6 (WNCNBR)           180219
      *
     C           WKDOIT    IFEQ 'Y'                        to be processed
      *
     C******               MOVE DPBN      PCUST   6                       180219
     C                     MOVELWNCNBR    PCUST   6                       180219
      *                                                                   180219
     C           WNCNBR    IFNE *BLANKS                    If defined     180219
     C                     CALL 'AOSECSR0'
     C                     PARM *BLANKS   PRTCD   7
     C                     PARM '*KEY'    POPTN   7
     C                     PARM           PCUST   6
     C           SDSECS    PARM SDSECS    DSSDY
      *
     C           PRTCD     IFNE *BLANKS                    Error
     C           *LOCK     IN   LDA
     C                     MOVELPGM       DBPGM            ***************
     C                     Z-ADD13        DBASE            * DBERROR 013 *
     C                     MOVEL'SDSECSPD'DBFILE    P      ***************
     C                     MOVELPCUST     DBKEY     P
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     ENDIF
     C                     ENDIF                                          180219
      *
     C******     BFCLAS    IFEQ 'C'                                       180219
     C****       BFCLAS    OREQ 'D'                                       179959
     C******     BFCLAS    OREQ 'K'                                179959 180219
     C******     BFCLAS    OREQ 'E'                                       180219
     C******     BFCLAS    OREQ 'X'                                       180219
      ******                                                              180219
      *****use*Branch*internal*Customer********************************** 180219
      ******                                                              180219
     C******               MOVE A8BICN    WKCUST  6                       180219
     C******               ELSE                                           180219
      ******                                                              180219
      *****use*the*counterparty*itself*********************************** 180219
      ******                                                              180219
     C******               MOVE DPBN      WKCUST                          180219
     C******               ENDIF                                          180219
      *
      ***  Access Customer details and Customer ext details
      *
     C******               MOVELWKCUST    WWCUST 10 P                     180219
     C           WNCNBR    IFNE *BLANKS                                   180219
     C                     MOVELWNCNBR    WWCUST 10 P                     180219
      *
     C                     CALL 'AOCUSTR0'
     C                     PARM *BLANKS   PRTCD
     C                     PARM '*KEY    'POPTN
     C                     PARM           WWCUST
     C                     PARM *BLANKS   DUMMY   7
     C           SDCUST    PARM SDCUST    DSSDY
      *
     C           PRTCD     IFNE *BLANKS
     C           *LOCK     IN   LDA
     C                     MOVELPGM       DBPGM            ***************
     C                     Z-ADD14        DBASE            * DBERROR 014 *
     C                     MOVEL'SDCUSTPD'DBFILE    P      ***************
     C                     MOVELWWCUST    DBKEY     P
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     ENDIF
      *
     C******     WKCUST    CHAINSDCUSTY6             99                   180219
     C********** WNCNBR    CHAINSDCUSTY6             99                                180219 CER001
     C           WNCNBR    CHAINSDCUX2L0             99                                       CER001
     C           *IN99     IFEQ *ON                        Not Found
     C           *LOCK     IN   LDA
     C                     MOVELPGM       DBPGM            ***************
     C                     Z-ADD15        DBASE            * DBERROR 015 *
     C**********           MOVEL'SDCUSTY6'DBFILE    P      ***************                    CER001
     C                     MOVEL'SDCUX2L0'DBFILE    P      ***************                    CER001
     C******               MOVELWKCUST    DBKEY     P                     180219
     C                     MOVELWNCNBR    DBKEY     P                     180219
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     ENDIF
     C                     ENDIF                                          180219
      *
      *****If*Investment*Company*code*is*Blank*and*Customer*Citizenship*is*'LU'
      *****Then*Bypass*************************************************** 180219
      ******                                                              180219
     C******     VFICCD    IFEQ *BLANKS                                   180219
     C******     BBCNCZ    ANDEQ'LU'                                      180219
     C******               MOVE 'N'       WKDOIT                          180219
     C******               ENDIF                                          180219
      *
     C                     ENDIF                           WKDOIT = 'N'
      *
     C                     ENDIF                           Select
      *
     C                     ENDSR
      /EJECT
      *****************************************************************
      *  #PROC  - This routine will fill in ERLUCBD0 record Fields    *
      *  ------   and write it out                                    *
      *  Called by : Mainlines                                        *
      *  Calls     : *PSSR                                            *
      *****************************************************************
      *
     C           #PROC     BEGSR
      *
      ***  Reset Record Format
      *
     C                     CLEARERLUCBD0
      *
      *** C072 : Transaction Reference (External Identification)
      *
     C                     MOVE DPRN      ALPH06  6        6 alpha
     C           'DM'      CAT  ALPH06:0  LUC072    P
     C*********  CHTP      IFEQ 'D'                        Deletion       180013
     C           LASTCH    IFEQ 'D'                        Deletion       180013
     C           LUC072    CAT  'D':0     LUC072            Transaction Ref.
      *
      ***  C009 : Cancellation indicator
      *
     C                     MOVEL'O'       LUC009            Cancellation Flag
     C                     ELSE
     C           LUC072    CAT  'I':0     LUC072           Insertion
     C                     MOVEL'N'       LUC009            Cancellation Flag
     C                     ENDIF
      *
      ***  C011 : Date of Transaction
      ***  Set to Date In for Walk In
      ***  Set to Date Out for Walk Out
      *
     C           DPMV      IFEQ 'WI'
     C                     Z-ADDDPMD      @@DAYN  50
     C                     ELSE
     C           DPMV      IFEQ 'WO'
     C                     Z-ADDDPDO      @@DAYN
     C                     ENDIF
     C                     ENDIF
      *
     C                     EXSR ZDATE9
      *
     C           @@RTN     IFEQ '1'                        Error flag
     C           *LOCK     IN   LDA
     C                     MOVELPGM       DBPGM            ***************
     C                     Z-ADD20        DBASE            * DBERROR 020 *
     C           'TRADE DA'CAT  'TE'      DBFILE    P      ***************
     C                     MOVE @@DAYN    DBKEY     P
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     ENDIF
      *
     C                     Z-ADD@@VDT     LUC011            Trade Date
      *
      ***  C012 : time of Transaction
      *
     C           WNTIME    MULT 1000      LUC012            Time of Trans.
      *
      ***  C013 : Ext. ID of Cancelled Transaction
      *
     C           LUC009    IFEQ 'O'                        Cancelled trade ?
     C           'DM'      CAT  ALPH06:0  LUC013
     C           LUC013    CAT  'I':0     LUC013            Ext. ID of Cancel. Trans.
     C                     ENDIF
      *
      ***  C014 : Reference of Investment Company
      *
     C                     MOVELLUC072    LUC014            Ref of Invst. Company
      *
      ***  C015 : ID of Investment Company
      *
     C                     MOVELVPINCC    LUC015            ID of Invst. Company
      *
      ***  C016 : Identification of Customer Account
      ***  180219 - Always 'O'                                            180219
      *
     C******     BFCLAS    IFEQ 'D'                                       180219
     C******     BFCLAS    OREQ 'S'                                       180219
     C                     MOVE 'O'       LUC016            Id of Cust. Account
     C******               ELSE                                           180219
     C******               MOVE 'N'       LUC016    Id of Cust. Account   180219
     C******               ENDIF                                          180219
      *
      ***  C017 : Type of counterparty
      ***  180219 - When no counterparty, always put 'ETR'                180219
      *
     C           WNCNBR    IFNE *BLANKS                                   180219
     C           BBCNCZ    IFEQ 'LU'
     C           BBCOLC    OREQ 'LU'                                      186797
     C           VFICCD    ANDEQ*BLANKS                                   186797
     C                     MOVEL'LUX'     LUC017            Type of Counterparty
     C                     ELSE
     C                     MOVEL'ETR'     LUC017            Type of Counterparty
     C                     ENDIF
     C                     ELSE                             no cntrprty   180219
     C                     MOVEL'ETR'     LUC017            Type of Counterparty
     C                     ENDIF                                          180219
      *
      ***  C018 : Counterpart (Lux)
      ***  If the retrieved Investment Company Code is blank when C017    180219
      ***  is equal to 'LUX' C018 must be set to C015 (VPINCC)            180219
      ***  C019 : Counterpart (Not Lux)
      *
     C           LUC017    IFEQ 'LUX'
     C           WNCNBR    IFNE *BLANKS                    Cntrprty exist 180219
     C           VFICCD    ANDNE*BLANKS                    and has Cie id 180219
     C                     MOVELVFICCD    LUC018            Counterpart (Lux)
     C                     ELSE                                           180219
     C                     MOVELVPINCC    LUC018                          180219
     C                     ENDIF                                          180219
      *                                                                   180219
     C                     ELSE
      ***  Set to blank when no counterpart number has been entered       180219
     C           WNCNBR    IFNE *BLANK                                    180219
     C                     MOVELBBCRNM    LUC019            Counterpart (Not Lux)
     C                     ELSE                                           180219
     C                     MOVEL*BLANK    LUC019                          180219
     C                     ENDIF                                          180219
     C                     ENDIF
      *
      ***  C020 : ISIN Code
      *
     C                     MOVELISIN      LUC020
      *
      ***  C021 : Security code
      ***  C022 : Security Code Type
      *
     C           LUC020    IFEQ *BLANKS
      *
      ***  Access Security Ext Details
      *
     C********** DPSS      CHAINSECTYDY6             99                                       CER001
     C           DPSS      CHAINSESDX3L0             99                                       CER001
     C           *IN99     IFEQ *ON                        Not Found
     C           *LOCK     IN   LDA
     C                     MOVELPGM       DBPGM            ***************
     C                     Z-ADD21        DBASE            * DBERROR 021 *
     C**********           MOVEL'SECTYDY6'DBFILE    P      ***************                    CER001
     C                     MOVEL'SESDX3L0'DBFILE    P      ***************                    CER001
     C                     MOVELDPSS      DBKEY     P
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     ENDIF
      *
     C                     MOVELVVSECD    LUC021            Security Code
     C                     MOVELVVSNCD    LUC022            Security National Code
     C                     ENDIF
      *
      ***  C023 : Security description (using ZSDESC)
      *
      ***  input fields
      *
     C                     MOVELSRPN      ZSRPN            Sec. Report Name
     C                     MOVELSFN1      ZSFN1                 Full name 1
     C                     MOVELSFN2      ZSFN2                 Full name 2
     C*                    Z-ADDCPNR      CPNR             Coupon rate
     C*                    Z-ADDMATY      MATY             Maturity date
     C*                    Z-ADDSCPP      SCPP             Redemption Price
     C*                    Z-ADDSCPD      SCPD             1st Redemption Price
     C                     MOVELBVRIDF    ZRSFD            Redemp. in Sec. Full Ind.
     C*                    MOVELSCPI      SCPI             Put/Call ind.
      *
     C                     EXSR ZSDESC
      *
     C                     MOVELZRNME     LUC023    P       Sec. Description
      *
      ***  C024 : Quantity
      *
     C           VUPRCD    IFEQ 'ACT'                      Equity
     C           VUPRCD    OREQ 'WAR'                      Warrants
     C           VUPRCD    OREQ 'OPT'                      Options
     C           VUPRCD    OREQ 'FUT'                      Futures
     C                     Z-ADDDPNA      LUC024            Quantity
      *
      ***  Quantity taken into Account Nominal CCY dec. places
      *
     C                     Z-ADDNMDP      #I      10       (0 to 4)
     C                     DO   #I
     C           LUC024    DIV  10        LUC024            Quantity
     C                     ENDDO
     C                     ENDIF
      *
      ***  C025 : Amount
      *
     C           VUPRCD    IFEQ 'OBL'                      Bonds
     C           VUPRCD    OREQ 'OCW'                      Bonds Cum Warrants
     C                     Z-ADDDPNA      LUC025            Amount
      *
      ***  Amount taken into Account Nominal CCY dec. places
      *
     C                     Z-ADDNMDP      #I      10       (0 to 4)
     C                     DO   #I
     C           LUC025    DIV  10        LUC025            Amount
     C                     ENDDO
     C                     ENDIF
      *
      ***  C026 : Transaction Price
      *
      ***  Read INVTP details (Need PROT for ZPRCI STD routine)
      *
     C           KINVT     CHAININVTP                99
     C           *IN99     IFEQ *ON                        Not Found
     C           *LOCK     IN   LDA
     C                     MOVELPGM       DBPGM            ***************
     C                     Z-ADD24        DBASE            * DBERROR 024 *
     C                     MOVEL'INVTP'   DBFILE    P      ***************
     C           KCCYI     CAT  KINVS:1   DBKEY     P
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     ENDIF
      *                                                                   180074
      ***  Read Nominal Currency details                                  180074
      *                                                                   180074
     C                     CALL 'AOCURRR0'                                180074
     C                     PARM *BLANKS   PRTCD                           180074
     C                     PARM '*KEY   ' POPTN                           180074
     C                     PARM           NMCY                            180074
     C           SDCURR    PARM SDCURR    DSSDY                           180074
      *                                                                   180074
     C           PRTCD     IFNE *BLANKS                    Error/Not Found180074
     C           *LOCK     IN   LDA                                       180074
     C                     MOVELPGM       DBPGM            ***************180074
     C                     Z-ADD22        DBASE            * DBERROR 022 *180074
     C                     MOVEL'SDCURRPD'DBFILE    P      ***************180074
     C                     MOVELNMCY      DBKEY     P                     180074
     C                     OUT  LDA                                       180074
     C                     EXSR *PSSR                                     180074
     C                     ENDIF                                          180074
      *                                                                   180074
      *** Setup Decimal places                                            180074
      *                                                                   180074
     C***                  Z-ADD0         B       10                      180074
     C***                  Z-ADD0         C       10                      180074
     C***        7         SUB  NMDP      B       10                      180074
      *
     C                     Z-ADDMKTP      ZPRCIN
     C                     Z-ADDWKDATE    ZFDATE
     C****                 EXSR ZPRCI                                     180074
     C****       DPNA      MULT ZPRCOT    LUC026                          180074
      *                                                                   180074
     C                     Z-ADDDPNA      ZNOML  150                      180074
     C*                                                                   180074
     C*     Set up parameters for Australian Yields mod                   180074
     C*                                                                   180074
     C           STBS      IFEQ 'Y'                                       180074
     C           SYBS      ANDEQ'AU'                                      180074
     C                     Z-ADDDPMD      ZECD                            180074
     C                     EXSR ZLCD                                      180074
     C                     Z-ADDDPMD      ECD                             180074
     C                     EXSR ZNCD                                      180074
     C                     Z-ADDZZLCD     ZDCSDT                          180074
     C                     Z-ADDDPMD      ZDCEDT                          180074
     C                     Z-ADDZNOML     ZAMT                            180074
     C*                                                                   180074
     C**  Set the currency dec. places parameter for call to SR.ZACCR     180074
     C*                                                                   180074
     C                     Z-ADDA6NBDP    ZCDP                            180074
     C*                                                                   180074
     C                     EXSR ZACCZ                                     180074
     C                     Z-ADDDPMD      WRKD    50                      180074
     C           ZDCINT    DIV  ZNOML     WRKPI                           180074
     C*                                                                   180074
     C**  Set the location parameter to blanks for call to SR.ZBKDT       180074
     C*                                                                   180074
     C                     MOVE *BLANKS   ZLOC                            180074
     C*                                                                   180074
     C                     EXSR ZYCE                                      180074
     C*                                                                   180074
     C*  IF EX-COUPON THEN PI PASSED IS THE REMAINING INTEREST            180074
     C*     TILL NCD AND IS NEGATIVE                                      180074
     C*                                                                   180074
     C           SCUMEX    IFEQ 'X'                                       180074
     C                     Z-ADDZZLCD     ZDCSDT                          180074
     C                     Z-ADDNCD       ZDCEDT                          180074
     C                     EXSR ZACCZ                                     180074
     C           ZDCINT    DIV  ZNOML     WKWPI  159                      180074
     C           WRKPI     SUB  WKWPI     WRKPI                           180074
     C                     ENDIF                                          180074
     C                     ELSE                                           180074
     C                     MOVE 'C'       SCUMEX  1                       180074
     C                     Z-ADD0         WRKPI                           180074
     C                     END                                            180074
     C*                                                                   180074
     C                     EXSR ZPRCI                                     180074
     C***********ZPRCOT    DIV  100       LUC026                   180074 223136
      *
      ***  Price basis equal 'P'
     C***        SPBS      IFEQ 'P'                        - B1           180074
     C***        B         SUB  2         C                               180074
     C***        LUC026    MULT POW,C     LUC026                          180074
     C***                  ELSE                            - X1           180074
     C***        LUC026    MULT POW,B     LUC026                          180074
     C***                  END                             - E1           180074
      *
      ***  C027 : Flag Exchange Traded / OTC
      ***  180219 - Always 'N' (over the counter)
      *
     C******     VFMCID    IFEQ 'Y'                                       180219
     C******               MOVE 'O'       LUC027   Exchange Traded / OTC  180219
     C******               ELSE                                           180219
     C                     MOVE 'N'       LUC027            Exchange Traded / OTC
     C******               ENDIF                                          180219
      *
      ***  C028 : Aggregation Flag
      *
     C                     MOVE 'N'       LUC028            No Aggregation
      *
      ***  C029 : Product Code of the Security
      *
     C                     MOVE VUPRCD    LUC029            Product Code
      *
      ***  C007 : ISO country Code
      *
      *** 180074 AOCURRR0 called sooner                                   180074
     C***                  CALL 'AOCURRR0'                                180074
     C***                  PARM *BLANKS   PRTCD                           180074
     C***                  PARM '*KEY   ' POPTN                           180074
     C***                  PARM           NMCY                            180074
     C***        SDCURR    PARM SDCURR    DSSDY                           180074
      ***                                                                 180074
     C***        PRTCD     IFNE *BLANKS                    Error or Not Found074
     C***        *LOCK     IN   LDA                                       180074
     C***                  MOVELPGM       DBPGM            ***************180074
     C***                  Z-ADD22        DBASE            * DBERROR 022 *180074
     C***                  MOVEL'SDCURRPD'DBFILE    P      ***************180074
     C***                  MOVELNMCY      DBKEY     P                     180074
     C***                  OUT  LDA                                       180074
     C***                  EXSR *PSSR                                     180074
     C***                  ENDIF                                          180074
      *
     C                     MOVELA6SWCY    LUC007            ISO Currency
      *
      ***  C030 : Purchase/Sale Code
      *
     C           DPMV      IFEQ 'WI'
     C*********************MOVE 'A'       LUC030            Purchase      ULX042
     C                     MOVE 'V'       LUC030            Purchase      ULX042
     C                     ELSE
     C           DPMV      IFEQ 'WO'
     C*********************MOVE 'V'       LUC030            Sale          ULX042
     C                     MOVE 'A'       LUC030            Sale          ULX042
     C                     ENDIF
     C                     ENDIF
      *
      ***  Additional Fields for Audit Report
      *
     C                     MOVELDPSS      LUSSHN            Sec. Shortname
      *                                                                   180219
      ***  Customer Number :                                              180219
      *****Counterparty*number*from*LF/DPTMVDY6*or*to*the*branch*******                180219 CER001
      ** Counterparty number from LF/SEDPX1L0 or to the branch                                CER001
      ***  internal customer number when the counterparty number          180219
      ***  is blank                                                       180219
     C******               MOVELWKCUST    LUCNUM            Counterparty  180219
      *                                                                   180219
     C           WNCNBR    IFNE *BLANKS                                   180219
     C                     MOVELWNCNBR    LUCNUM                          180219
     C                     ELSE                                           180219
     C                     MOVELA8BICN    LUCNUM                          180219
     C                     ENDIF                                          180219
      *                                                                   180219
     C                     MOVELBBCNCZ    LUCOCZ            Country of Citizenship
     C                     MOVELDPBA      LUBKBR            Booking Branch
      *
      ***  Write out Record
      *
     C                     WRITEERLUCBD0
      *
      *****Update*LF/DPTMVDY6,*Extracted*Flag*to*setup*****************                       CER001
      ** Update LF/SEDPX1L0, Extracted Flag to setup                                          CER001
      ***  Trades Cancelled : Flag = D
      ***  Others           : Flag = I
      *
     C********** KDEPO     CHAINDPTMVDY6             99                                       CER001
     C           KDEPO     CHAINSEDPX1L0             99                                       CER001
     C           *IN99     IFEQ *ON                        Not Found
     C           *LOCK     IN   LDA
     C                     MOVELPGM       DBPGM            ***************
     C                     Z-ADD23        DBASE            * DBERROR 023 *
     C**********           MOVEL'DPTMVDY6'DBFILE    P      ***************                    CER001
     C                     MOVEL'SEDPX1L0'DBFILE    P      ***************                    CER001
     C           DPSS      CAT  DPRN:1    DBKEY     P
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     ENDIF
      *
     C********   CHTP      IFEQ 'D'                                       180013
     C           LASTCH    IFEQ 'D'                                       180013
     C                     MOVE 'D'       WNEXFL
     C                     ELSE
     C                     MOVE 'I'       WNEXFL
     C                     ENDIF
     C                     UPDATDPTMVDF6
      *
     C                     ENDSR
      /EJECT
      /COPY ZSRSRC,ZSDESCZ3
      /COPY ZSRSRC,ZDATE1Z2
      /COPY ZSRSRC,ZDATE2Z2
      /COPY ZSRSRC,ZDATE9Z3
      /COPY ZSRSRC,ZPRCIZ1
      /COPY ZSRSRC,ZDAYSZ2
      /COPY ZSRSRC,ZDYYRZ3
      /COPY ZSRSRC,ZNCDZ3
      /COPY ZSRSRC,ZLCDZ1                                                                   MD057247
      /COPY ZSRSRC,ZYCEZ1                                                 180074
      /COPY ZSRSRC,ZYLDIZ1
      /COPY ZSRSRC,ZYLDZ2
      /COPY ZSRSRC,ZACCZZ1
      /COPY ZSRSRC,ZACCRZ1
      /COPY ZSRSRC,ZRATEZ1
      /COPY ZSRSRC,ZCNSDZ1
      /COPY ZSRSRC,ZCALCD
      /COPY ZSRSRC,ZEVCDZ1
      /COPY ZSRSRC,ZACCH                                                  180074
      /COPY ZSRSRC,ZBKDT                                                  180074
      /EJECT
      *****************************************************************
      *  *INZSR - Innitial subroutine : automatically called at start *
      *  ------                                                       *
      *  Called by : at pgm start                                     *
      *  Calls     : *PSSR                                            *
      *****************************************************************
      *
     C           *INZSR    BEGSR
      *
      ***  Set up copyright parameter
      *
     C                     MOVEACPY@      CPY2@  80
      *
      ***  Read in Installation Data
      *
     C           *NAMVAR   DEFN           LDA
      *
      ***  Set Date Format Indicator *IN98  on if date format is MMDDYY
      *
     C           *ENTRY    PLIST
     C                     PARM           PDATE   5        5 ALPHA
      *
     C                     CALL 'AOBANKR0'
     C                     PARM *BLANKS   @RTCD   7
     C                     PARM '*FIRST ' @OPTN   7
     C           SDBANK    PARM SDBANK    DSSDY
      *
     C           @RTCD     IFNE *BLANKS
     C           *LOCK     IN   LDA
     C                     MOVELPGM       DBPGM            ***************
     C                     Z-ADD1         DBASE            * DBERROR 001 *
     C                     MOVEL'SDBANKPD'DBFILE           ***************
     C                     MOVEL'*NONE'   DBKEY     P
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     ENDIF
      *
     C           BJDFIN    IFEQ 'M'
     C                     MOVE *ON       *IN98
     C                     ENDIF
      *
      ***  If entry date is equal to Zero, take midas rundate
      *
     C           PDATE     IFEQ '00000'
     C                     Z-ADDBJRDNB    WKDATE  50       Midas Run date
     C                     ELSE
     C                     MOVE PDATE     WKDATE  50
     C                     ENDIF
      *
      ***  Validate date as correct using ZDATE2
      *
     C                     Z-ADDWKDATE    ZDAYNO
     C                     EXSR ZDATE2
     C           *IN99     IFEQ *ON
     C           *LOCK     IN   LDA
     C                     MOVELPGM       DBPGM            ***************
     C                     Z-ADD2         DBASE            * DBERROR 002 *
     C                     MOVEL'*NONE'   DBFILE           ***************
     C           'WRONG '  CAT  'DATE'    DBKEY     P
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     ENDIF
      *
      ***  Read LU ICD
      *
     C           'LU'      CHAINERLUICL1             99
     C           *IN99     IFEQ *ON                        not Found
     C           *LOCK     IN   LDA
     C                     MOVELPGM       DBPGM            ***************
     C                     Z-ADD3         DBASE            * DBERROR 003 *
     C                     MOVEL'ERLUICL1'DBFILE           ***************
     C                     MOVEL'LU'      DBKEY     P
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     ENDIF
      *
      ***  Read SDSTRDPD details
      *
     C                     CALL 'AOSTRDR0'
     C                     PARM *BLANKS   PRTCD
     C                     PARM '*FIRST ' POPTN
     C           SDSTRD    PARM SDSTRD    DSSDY
      *
     C           PRTCD     IFNE *BLANKS                    Error or not found
     C           *LOCK     IN   LDA
     C                     MOVELPGM       DBPGM            ***************
     C                     Z-ADD4         DBASE            * DBERROR 004 *
     C                     MOVEL'SDSTRDPD'DBFILE           ***************
     C                     MOVEL'*FIRST'  DBKEY     P
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     ENDIF
      *
      ***  Get General Ledger Data Record:
     C                     CALL 'AOGELRR0'
     C                     PARM *BLANKS   @RTCD   7
     C                     PARM '*FIRST ' @OPTN   7
     C           SDGELR    PARM SDGELR    DSSDY
      *
      ***  If record not found
      *
     C           @RTCD     IFNE *BLANKS
     C           *LOCK     IN   LDA
     C                     MOVELPGM       DBPGM            ***************
     C                     Z-ADD5         DBASE            * DBERROR 005 *
     C                     MOVEL'SDGELRL1'DBFILE           ***************
     C                     MOVEL' NONE '  DBKEY
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END
      *                                                                                     MD057247
      ** Access Switchable Features file to determine if CSE031 is                          MD057247
      ** installed in the system.                                                           MD057247
      *                                                                                     MD057247
     C                     CALL 'AOSARDR0'                                                  MD057247
     C                     PARM           URTNCD  7                                         MD057247
     C                     PARM '*VERIFY' UOPTN   7                                         MD057247
     C                     PARM 'CSE031'  UUKEY   6                                         MD057247
     C                     PARM           UDSFDY 76                                         MD057247
      *                                                                                     MD057247
     C                     MOVE 'N'       CSE031  1                                         MD057247
     C           URTNCD    IFEQ *BLANKS                                                     MD057247
     C                     MOVE 'Y'       CSE031                                            MD057247
     C                     ENDIF                                                            MD057247
      *                                                                                     MD057247
      ** Access Switchable Features file to determine if CSE071 is                          MD057247
      ** installed in the system.                                                           MD057247
      *                                                                                     MD057247
     C                     CALL 'AOSARDR0'                                                  MD057247
     C                     PARM           URTNCD                                            MD057247
     C                     PARM '*VERIFY' UOPTN                                             MD057247
     C                     PARM 'CSE071'  UUKEY                                             MD057247
     C                     PARM           UDSFDY                                            MD057247
      *                                                                                     MD057247
     C                     MOVE 'N'       CSE071  1                                         MD057247
     C           URTNCD    IFEQ *BLANKS                                                     MD057247
     C                     MOVE 'Y'       CSE071                                            MD057247
     C                     ENDIF                                                            MD057247
      *
      ***  Retrieve event control date
      *
     C                     Z-ADDBKAPDT    ZZAPDT
     C                     Z-ADDBJDNWD    ZZDNWD
     C                     EXSR ZEVCD
      *
      ***  Key list for INVTYPX6
      *
     C           KINVT     KLIST
     C                     KFLD           KCCYI   3        Currency code
     C                     KFLD           KINVS   3        investment type
      *
     C           KDEPO     KLIST
     C                     KFLD           DPSS             Sec Shortname
     C                     KFLD           DPRN             Reference
      *
     C                     ENDSR
      /EJECT
      *****************************************************************
      *  *PSSR  - Program exception error routine                     *
      *  ------   Called automatically if a program error occurs,     *
      *           or directly by the program code using EXSR.         *
      *           This subroutine DUMPs the program just once.        *
      *  Called by :                                                  *
      *  Calls     :                                                  *
      *****************************************************************
      *
     C           *PSSR     BEGSR
      *
     C           @RUN      IFEQ *BLANK
     C                     MOVE 'Y'       @RUN    1
     C                     DUMP
     C                     END
      *
     C                     SETON                     U7U8LR
     C                     RETRN
      *
     C                     ENDSR
      *
      ********************************************************************
      ***  180074 Remove Array POW no more used                           180074
      *** ** POW                                                          180074
      *** 00000001                                                        180074
      *** 00000010                                                        180074
      *** 00000100                                                        180074
      *** 00001000                                                        180074
      *** 00010000                                                        180074
      *** 00100000                                                        180074
      *** 01000000                                                        180074
      *** 10000000                                                        180074
** FILE TRANS. ERLUCBPP FILE TO REMOVE ALL NON STANDARD CHARACTERS
*EQUATE ERLUCBPP
*EQUATE C144504EC551C552C554C956C164C368406A406FC571C572C5744079407A407D407E407F
*EQUATE C181C282C383C484C585C686C787C888C989D191D292D393D494D595D696D797D898D999
*EQUATE E2A2E3A3E4A4E5A5E6A6E7A7E8A8E9A940E0E4FE409D4B6B4B9D
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
** @YD  USED BY SR. ZDATE9 - YEARS, IN DAYS, CUMULATIVE IN 4 YEAR SPAN
00366007310109601461
** @MD  USED BY SR. ZDATE9 - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
00000000310005900090001200015100181002120024300273003040033400365
**   ZF29 DAY NOS OF FEB 29 TO 2096 (INCLUDING 2000)
0006001521029820444305904073650882610287117481320914670161311759219053
2051421975234362489726358278192928030741322023366335124365853804639507
40968424294389045351
**  POWER8 - ARRAY OF POWERS FOR CURRENCY CONVERSION
00000001
00000010
00000100
00001000
00010000
00100000
01000000
10000000
**  CPY@
(c) Finastra International Limited 2005
