     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas EU Retail settlement a/c exception report')      *
      *****************************************************************
      *                                                               *
      *  Midas - EMU Retail Utilities                                 *
      *                                                               *
      *  EU0190 - Retail Settlement A/C Exception Report              *
      *                                                               *
      *  Function:  This program is a new report that will show       *
      *             all transactions which generate account postings  *
      *             using the retail account number and whose         *
      *             transaction currency differs from the account     *
      *             currency.                                         *
      *                                                               *
      *  Called By: EUC0190                                           *
      *                                                               *
      *  (c) Misys International Banking Systems Ltd. 2001            *
      *                                                               *
      *  Last Amend No. CDL096             Date 22Sep14               *
      *  Prev Amend No. CDL094             Date 11Jun14               *
      *                 CLE134             Date 01Aug12               *
      *                 CLE148             Date 23Jul12               *
      *                 CCB020             Date 06Aug12               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      *                 CRE401             Date 26Nov09               *
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 BUG15105A          Date 25Oct07               *
      *                 BUG15105           Date 23Oct07               *
      *                 239481             Date 10Jul07               *
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CFT032             Date 11Sep06               *
      *                 CDL049             Date 06Jul06               *
      *                 239548             Date 22Nov06               *
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CLE042             Date 06Sep05               *
      *                 CLE106             Date 26Apr05               *
      *                 CDL038             Date 10May05               *
      *                 CDL028             Date 07Feb05               *
      *                 BUG2304            Date 30Apr04               *
      *                 CLE031             Date 05Feb03               *
      *                 CAS006             Date 21Jan03               *
      *                 CAS005             Date 16Dec02               *
      * Midas Release 4.01.02 ----------------------------------------*
      *                 204452             Date 03May02               *
      * Midas Release 4.01 -------------------------------------------*
      *                 179699             Date 24Jan02               *
      *                 182855             Date 30Oct01               *
      *                 152216             Date 19Oct01               *
      * Midas Release 4 --------------- Base -------------------------*
      *                 186120             Date 18Sep01               *
      * Midas DBA 3.05 -----------------------------------------------*
      *                 CLE011             Date 07Nov00               *
      *                 160164             Date 31Jan01               *
      *                 155644             Date 30Jan01               *
      * Midas DBA 3.04 -----------------------------------------------*
      *                 CSE023             Date 12Jul00               *
      *                 178704             Date 01Sep00               *
      *                 CFT014             Date 25May00               *
      *                 CFT013             Date 25May00               *
      * Midas DBA 3.03 -----------------------------------------------*
      *                 CAP136             Date 15Nov99               *
      *                 175479             Date 08Feb00               *
      * Midas DBA 3.02 -----------------------------------------------*
      *                 CPB001             DATE 18Jun99               *
      *                 CLE009             Date 26Apr99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 156926             Date 06JAN99               *
      *                 144915             Date 28Oct98               *
      *                 146327             DATE 30NOV98               *
      *                 147975             Date 18Nov98               *
      *                 145427             Date 29Oct98               *
      *                 145805             Date 28Oct98               *
      *                 144999             Date 16Oct98               *
      *                 144528             Date 08Oct98               *
      *                 143038             Date 06Oct98               *
      *                 142373             Date 10Sep98               *
      *                 CEU022  *CREATE    Date 17Jul98               *
      *                                                               *
      *---------------------------------------------------------------*
      *                                                               *
      *  CDL096 - Business Day Conventions on MM Deals                *
      *           (Recompile)                                         *
      *  CDL094 - Enhance  Receive Settlement Instructions            *
      *           (Recompiled)                                        *
      *  CLE134 - Past Due Call Loan Processing (Recompile)           *
      *  CLE148 - Alpha Loan Reference (Recompile)                    *
      *  CCB020 - COB Restructure - Secondary COB Infrastructure      *
      *  CRE401 - 4-Eyes Checking Gaps - Sweeps (Recompile)           *
      *  BUG15105A - Missing Process for SWIFT 2007 (Reopen)          *
      *  BUG15105 - Missing Process for SWIFT 2007                    *
      *  239481 - Show type of account so as to make report clearer.  *
      *  CFT032 - Account Line in Field 50X in MT103                  *
      *  CDL049 - Addition of a Reference Rate field (recompile)      *
      *  239548 - add check for interest settlement account on MM     *
      *           deals.                                              *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CLE042 - Extended Loan Sub Type (Recompile)                  *
      *  CLE106 - Syndication Manager                                 *
      *  CDL038 - Extended Deal Sub Type (Recompile)                  *
      *  CDL028 - Automatic Rate Interpolations (Recompile)           *
      *  BUG2304 - Various file layout changes. Recompile.            *
      *  CLE031 - Lending Enhancements (recompile).                   *
      *  CAS006 - Hedge Accounting Phase B.                           *
      *           - Rename new field CRSK on TRADS.                   *
      *           - Rename new field CRSK on SOBTR.                   *
      *  CAS005 - Enhancements to CAS001, CAS002 and CAS004           *
      *           (Recompile)                                         *
      *  204452 - Recompiled due to changed PF/LEFEED.                *
      *  179699 - For Deal Amendments, process all deal amendment     *
      *           types except for 'SC' and 'CI' types.               *
      *  182855 - For Facility fees, do not verify the Pay/Receive    *
      *           Settlement Accounts from the Loan, only from the    *
      *           fee.                                                *
      *  152216 - Check only trades which are not yet fully settled.  *
      *  186120 - Select only live trades for report processing.      *
      *  CLE011 - Rate Fixing Days for Lending Rollover Processing    *
      *           Recompile                                           *
      *  160164 - Sender and beneficiary were filled by the same      *
      *           accnt and also the correspondent was indicated.     *
      *           In this case settle should came from the receiver,  *
      *           the pay from the beneficiary, and the sender is no  *
      *           longer needed in accounting. But the difference in  *
      *           the sender's currency and the settlement currency   *
      *           was still reported.                                 *
      *  155644 - Check settlement date as well as currency           *
      *  CSE023 - Treaty Withholding Tax                              *
      *  178704 - Loan start date account may have changed to EUR now.*
      *           Do not report error if start date postings have     *
      *           already been done.                                  *
      *  CFT014 - Straight-through Processing Phase 2 MT103           *
      *           Messages Generation for FT.                         *
      *  CFT013 - Straight-through Processing Phase 2 MT103           *
      *           Messages Generation for non-FT (joint change        *
      *           with CFT014)                                        *
      *  CAP136 - Conversion of FT Incoming Payment inputs into       *
      *           modular structure to use as APIs.                   *
      *           Recompiled over changed PF/INPAYDD                  *
     A*  175479 - Recompiled over changes in INPAYDD & OTPAYDD        *
      *  CPB001 - 'Private Banking' Module                            *
      *  CLE009 - LE I/C Swift Message Generation for Fees            *
      *           Recompiled due to changes in LEFEED                 *
      *  156926 - CLOANLB error displayed 3 times because the         *
      *           original ccy was used instead of the rollover ccy   *
      *           for multi-currency rollovers.                       *
      *  144915 - Bring up both sides of the settlement details when  *
      *           it is a multi-ccy rollover to euro.                 *
      *  146327 - Retail settlement account exception for fees not    *
      *           reported.                                           *
      *  147975 - Check only deals, loans etc... for retail acc nbr   *
      *           that exist and they are not closed .                *
      *  145427 - 1) For cust. exchanges check a/c ccy only if retail *
      *           a/c no. used. 2) Do not check teller transactions   *
      *           as trans. ccy does not have to be a/c ccy. 3) For   *
      *           sweep details check CR ccy only if CR a/c is an RE  *
      *           a/c no. 4) If no RE a/c report a/c ccy as blank.    *
      *           5) For outgoing payments use correct settlement ccy *
      *           field (error found in testing).                     *
      *  145805 - Cheques to be paid/collected causing EUC0190 to     *
      *           fail during COB.                                    *
      *  144999 - Incoming Payment causing problem for COB with       *
      *           EUC0190.                                            *
      *  144528 - Do not include deleted deals in report.             *
      *  143038 - For facility file, checking/advising that there are *
      *           facilities with settlement account for facilities.  *
      *           COB stops - no user correcting possible.            *
      *  142373 - The user cannot amend the settlement details for a  *
      *           past due Loan Amendment and therefore is unable to  *
      *           run the close of business. Reports on Facility is   *
      *           duplicating.                                        *
      *  CEU022 - EMU Retail Utilities                                *
      *                                                               *
      *****************************************************************
      *                                                               *
     FCUSEX   IF  E           K        DISK         KINFSR *PSSR
     F            CUSEXH1F                          KIGNORE
     F            CUSEXZ1F                          KIGNORE
      *                                                               *
     FDEALS   IF  E           K        DISK         KINFSR *PSSR
     F            DEALSDFF                          KIGNORE
     F            DEALSDAF                          KIGNORE
      *
     FDEAMS   IF  E           K        DISK         KINFSR *PSSR
     F            DEAMSDHF                          KIGNORE
     F            DEAMSDJF                          KIGNORE
      *                                                               *
     FOTPAY   IF  E           K        DISK         KINFSR *PSSR
      *
     FINPAY   IF  E           K        DISK         KINFSR *PSSR
      *                                                                   CFT014
     FINPAYXL2IF  E           K        DISK         KINFSR *PSSR      UC  CFT014
      *                                                               *
     FCQCOD   IF  E           K        DISK         KINFSR *PSSR
      *
     FCQPAC   IF  E           K        DISK         KINFSR *PSSR
      *                                                               *
     FCLOANLB IF  E           K        DISK         KINFSR *PSSR
      *                                                               *
     FCLOAN   IF  E           K        DISK         KINFSR *PSSR
     F            CLOANCLF                          KIGNORE
     F            CLOANZ1F                          KIGNORE
      *                                                               *
     FLOAMS   IF  E           K        DISK         KINFSR *PSSR
     F            LOAMSDHF                          KIGNORE
     F            LOAMSZ1F                          KIGNORE
      *                                                               *
     FFCLTY   IF  E           K        DISK         KINFSR *PSSR
     F            FCLTYHHF                          KIGNORE
     F            FCLTYZZF                          KIGNORE
      *
     F***LEFEEDL0IF  E           K        DISK         KINFSR *PSSR       146327
     FLEFEEDL1IF  E           K        DISK         KINFSR *PSSR          146327
      *                                                               *
     FLEFEADL1IF  E           K        DISK         KINFSR *PSSR
      *                                                               *
     FSTAND   IF  E           K        DISK         KINFSR *PSSR
     F            STANDSAF                          KIGNORE
     F            STANDSCF                          KIGNORE
      *                                                               *
     F*TTRANL1*IF**E           K        DISK         KINFSR *PSSR         145427
     F********    TTRANPTF                          KIGNORE               145427
      *                                                               *
     FTRADS   IF  E           K        DISK         KINFSR *PSSR
      *
     FRESWEPL0IF  E           K        DISK         KINFSR *PSSR
      *                                                               *
     FTRSET   IF  E           K        DISK         KINFSR *PSSR
      *                                                               *
     FTRANS   IF  E           K        DISK         KINFSR *PSSR
      *
     FPMPORTL1IF  E           K        DISK         KINFSR *PSSR
      *                                                               *
     FPOSET   IF  E           K        DISK         KINFSR *PSSR
      *                                                               *
     FSOBTR   IF  E           K        DISK         KINFSR *PSSR
     F            TRADSDF                           KRENAMESOBTRDF
      *
     FACCNTL1 IF  E           K        DISK         KINFSR *PSSR
      *                                                               *
     FEU0190AUO   E                    PRINTER
     F                                              KINFDS SPOOLU
     FEU0190P1O   E                    PRINTER                        UC
     F                                              KINFDS SPOOL1
      *****************************************************************
      *                                                               *
      *  F U N C T I O N   O F   I N D I C A T O R S                  *
      *                                                               *
      *   37  - Multibranching ON                                     *
      *                                                               *
      * 69-87 - Read on files
      *                                                               *
      *   98  - Date Format: DDMMYY (off); MMDDYY (on)                *
      * 90-99 - Used by Standard Subroutines                          *
      *                                                               *
      * U7+U8 - Database Error                                        *
      *                                                               *
      *****************************************************************
      /SPACE 3
      *****************************************************************
      *                                                               *
      *  S U B R O U T I N E   I N D E X                              *
      *                                                               *
      *  INIT   - Program Initialisation                              *
      *  PROCES - Detail Processing                                   *
      *  REPORT - Process Report Lines                                *
      *                                                               *
      *  WP1REC - Format and Write a Detail Record to the Report      *
      *  WP1END - Write End of Report                                 *
      *                                                               *
      *  AUDIT  - Produce Audit Report and End Program                *
      *  *PSSR  - Program Error Processing Subroutine                 *
      *  RCFP1  - RCF Processing for P1 Report                        *
      *  RCFAU  - RCF Processing for Audit Report                     *
      *                                                               *
      *  ZDATE2 - Convert Midas Day Number into Date (DDMMYY/MMDDYY)  *
      *  ZSEDIT - Edit an Amount                                      *
      *                                                               *
      *****************************************************************
     E/EJECT
     E                    CPY@    1   1 80
      *
      ** Array containing Copyright statement
      *
     E/COPY ZSRSRC,ZDATE2Z1
     E/COPY ZSRSRC,ZSEDITZ1
      *
      ** Array for report name
      *
     E                    #RPN    1  20 26
      *                                                                                       239481
      ** Array for type of account                                                            239481
      *                                                                                       239481
     E                    #ATP    1  25 30                                                    239481
      /SPACE 3
      *                                                                                       CCB020
      ** Constant for calling program CBC001001                                               CCB020
      *                                                                                       CCB020
     I              'CBC001001'           C         PGNME                                     CCB020
     I*
     ISTANDSBF
     I* Standing Orders
     I              PNAM                            PNAM1
     I*
     IRESWEPD0
     I* Sweep Details
     I              TRAT                            TRAT1
     I*
     ICLOANCKF
     I* Loans records
     I              NLRA                            NLRA1
     I/COPY WNCPYSRC,EU0190I001
      *                                                                                       CAS006
      ** Rename fields for TRADS                                                              CAS006
      *                                                                                       CAS006
     ISOBTRDF                                                                                 CAS006
     I              CRSK                            SBCRSK                                    CAS006
      *                                                                                       CAS006
      ** Rename fields for TRADS                                                              CAS006
      *                                                                                       CAS006
     ITRADSDF                                                                                 CAS006
     I              CRSK                            TRCRSK                                    CAS006
      *                                                                   CSE023
      ** Rename fields for Position Settlement File - POSETD              CSE023
      *                                                                   CSE023
     IPOSETDF                                                             CSE023
     I              PREF                            PPREF                 CSE023
     I              PSEQ                            PPSEQ                 CSE023
     I*
     I*TTRANPDF*****                                                      145427
     I**Re*Teller*Transaction                                             145427
     I**********    PRAM                            PRAM1                 145427
     I/COPY ZSRSRC,ZSEDITZ2
     ILDA       E DSLDA                         256
      *
      ** Local data area for database error details
      ** *LOCK IN LDA immediately before and OUT LDA immediately
      ** after each database error handling.
      **
      **                                    134 141 DBFILE
      **       Defines:                     142 170 DBKEY
      **                                    171 180 DBPGM
      **                                    181 1830DBASE
      *
     IRUNDAT    E DSRUNDAT
      *
      ** Data Area giving Installation Control Details
      *
     IPSDS       SDS
      *
      ** Program Status Data Structure
      *
     I                                     *PROGRAM PGM
     I                                      244 253 WSID
     I                                      254 263 USER
     ISPOOL1      DS
      ***  File Information Data Structure for EU0190P1.
     I                                       83  92 SFILE1
     I                                    B 123 1240SFNUM1
     I                                    B 188 1890OFLLN1
     I                                    B 367 3680PRTLN1
      *
     ISPOOLU      DS
      ***  File Information Data Structure for EU0190AU.
     I                                       83  92 SFILEU
     I                                    B 123 1240SFNUMU
      *
      ***  Dummy Data Structures used by Access Programs.
     IDSFDY     E DSDSFDY
      *
      ***  Dummy Data Structures used by Access Programs
     IDSSDY     E DSDSSDY
      *                                                                   CEU014
      ** SAR Details Accessed via access program                          CEU014
     ISCSARD    E DSSCSARDPD                                              CEU014
      *
      ***  External data structures for Bank Details
     ISDBANK    E DSSDBANKPD
      *
      **  External DS for Module details
     ISDMMOD    E DSSDMMODPD
      *
      **  External DS for Currency Details
     ISDCURR    E DSSDCURRPD                                              CEU014
      *
      * ===============================================================
      **                  D E F I N I T I O N S
      * ===============================================================
      *
     C           *LIKE     DEFN ACNO      K#RAN1
      *
      *================================================================
      *  P R O G R A M   S T A R T                                    *
      *================================================================
      *
      ***  Perform Initialisation.
      *
     C                     EXSR INIT
      *
      ***  Perform Detail Processing.
      *
      ** Customer Exchange.
     C                     EXSR SRCUSE
      *
      ** Check if Dealing Module is present.
     C           BGDLFX    IFEQ 'Y'
     C           BGDLMM    OREQ 'Y'
     C                     EXSR SRDEAL
     C                     EXSR SRDEAM
     C                     ENDIF
      *
      ** Check if Funds Transfer Module is present.
     C           BGFDTR    IFEQ 'Y'
     C                     EXSR SROTPY
     C                     EXSR SRINPY
     C                     EXSR SRCQCD
     C                     EXSR SRCQPC
     C                     ENDIF
      *
      ** Check if Customer Lending Module is present.
     C           BGCSLN    IFEQ 'Y'
     C                     EXSR SRLOAN
     C                     EXSR SRLOAM
     C                     EXSR SRFCLT
     C                     EXSR SRFEED
     C                     EXSR SRFEAD
     C                     ENDIF
      *
      ** Standing Order processing.
     C                     EXSR SRSTAN
      *
      ***TTRANL1*processing.********************************************* 145427
     C**********           EXSR SRTTRN                                    145427
      *
      ** Check if Securities Module is present.
     C           BGSECS    IFEQ 'Y'
     C                     EXSR SRTRAD
     C                     EXSR SRPOSE
     C                     EXSR SRSOBT
     C                     ENDIF
      *
      ** RE Sweep processing.
     C                     EXSR SRSWEP
      *
      ** Check if Future and Options Module is present.
     C           BGFUOP    IFEQ 'Y'
     C                     EXSR SRFFTR
     C                     ENDIF
      *
      ** Check if Portfolio Management Module is present.
      ** Or Private Banking Module is present.                            CPB001
     C           BGPFMG    IFEQ 'Y'
     C           BGN4ST    OREQ 'Y'                                       CPB001
     C                     EXSR SRPORT
     C                     ENDIF
      *
      ** Print End of Report.
     C                     MOVE *OFF      *IN37
     C                     WRITETRAILPY
      *
      ** Do End-of-program Processing.
     C                     EXSR SRENDP
      *
      *================================================================
      *  P R O G R A M   E N D                                        *
      *================================================================
     C/EJECT
      *****************************************************************
      *                                                               *
      *  INIT   - Subroutine to do Program Initialisation.            *
      *                                                               *
      *  Called By: Main Processing                                   *
      *  Calls:                                                       *
      *  RCFAU  - RCF Processing for Audit Report                     *
      *  AOBANKR0 Access Program                                      *
      *                                                               *
      *****************************************************************
      *
     C           INIT      BEGSR                           ***  INIT  ***
      *
      ** Set up copyright parameter
      *
     C                     MOVEACPY@      CPY2@  80
      *
      ***  Receive Parameter List.
      *
     C           *ENTRY    PLIST
     C                     PARM           PSEQ1   5
     C                     PARM           RLEV    1
     C                     PARM           RENT    3
     C**********           PARM           P#PARM  1                                           CCB020
      *                                                                                       CCB020
      ** Call program CBC001001 to check Midas System Phase                                   CCB020
      ** Return value is *YES (i.e. system is in COB) or *NO                                  CCB020
      *                                                                                       CCB020
     C                     CALL PGNME                                                         CCB020
     C                     PARM           WCOB    4                                           CCB020
      *
      ***  Initialise LDA field.
      *
     C                     MOVEL'EU0190'  DBPGM
     C                     MOVE 'Y'       #FIRST  1
      *
      ***  Call Access Program for Bank Details - Title, Run Date and
      ***  Run Day Number.
      *
     C                     CALL 'AOBANKR0'
     C                     PARM '*MSG   ' @RTCD   7
     C                     PARM '*FIRST ' @OPTN   7
     C           SDBANK    PARM SDBANK    DSFDY
      *
      ***  Handle Database Error.
      *
     C           @RTCD     IFNE *BLANKS
     C                     MOVE 'SDBANKPD'DBFILE           ***************
     C                     Z-ADD001       DBASE            * DB ERROR 01 *
     C                     EXSR *PSSR                      ***************
     C                     ENDIF
      *
      ***  Check System Date Format, DDMMYY (*IN98 off)
      ***                            MMDDYY (*IN98 on).
      *
     C           BJDFIN    IFEQ 'M'
     C                     SETON                     98
     C                     ENDIF
      *
      **   Access RUNDAT for multibranching indicator
      *
     C           *NAMVAR   DEFN           RUNDAT
     C           *NAMVAR   DEFN           LDA
     C                     IN   RUNDAT
      *
     C           AGMBIN    IFEQ 'M'
     C                     SETON                     37
     C                     END
      *
     C                     CALL 'AOMMODR0'
     C                     PARM '*MSG   ' @RTCD   7
     C                     PARM '*FIRST ' @OPTN   7
     C           SDMMOD    PARM SDMMOD    DSFDY
      *
     C           @RTCD     IFNE *BLANK
     C           *LOCK     IN   LDA
     C                     SETON                       U7U8
     C                     Z-ADD2         DBASE            ***************
     C                     MOVEL'SDMMODPD'DBFILE           *DB ERROR 002 *
     C                     MOVEL*BLANKS   DBKEY            ***************
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END
      *
      ** Access Switchable Features Access Program
      *
     C                     MOVE 'N'       CEU022
     C                     CALL 'AOSARDR0'
     C                     PARM *BLANK    @RTCD   7
     C                     PARM '*VERIFY' @OPTN   7
     C                     PARM 'CEU022'  @SARD   6
     C           SCSARD    PARM SCSARD    DSFDY
      *
     C           @RTCD     IFEQ *BLANK
     C                     MOVE 'Y'       CEU022  1
     C                     ENDIF
      *
      ** Database Error
      *
     C           @RTCD     IFNE *BLANKS
     C           @RTCD     ANDNE'*NRF   '
      *
     C                     Z-ADD03        DBASE             **************
     C                     MOVEL'SCSARDPD'DBFILE            * DB ERROR 03*
     C                     MOVEL'CEU022'  DBKEY             **************
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     ENDIF
      *                                                                   CFT014
      ** Access SAR file to determine if CFT014 is installed.             CFT014
      *                                                                   CFT014
     C                     CALL 'AOSARDR0'                                CFT014
     C                     PARM *BLANKS   @RTCD                           CFT014
     C                     PARM '*VERIFY' @OPTN                           CFT014
     C                     PARM 'CFT014'  @SARD                           CFT014
     C           SCSARD    PARM SCSARD    DSFDY                           CFT014
      *                                                                   CFT014
      ** An NRF (No Record Found) return code is valid.                   CFT014
      ** Issue database error only for error return codes.                CFT014
      *                                                                   CFT014
     C           @RTCD     IFNE *BLANKS                                   CFT014
     C           @RTCD     ANDNE'*NRF   '                                 CFT014
     C           *LOCK     IN   LDA                                       CFT014
     C                     MOVEL'CFT014'  DBKEY                           CFT014
     C                     MOVEL'SCSARDPD'DBFILE                          CFT014
     C                     Z-ADD5         DBASE                           CFT014
     C                     OUT  LDA                                       CFT014
     C                     EXSR *PSSR                                     CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           @RTCD     IFEQ *BLANK                                    CFT014
     C                     MOVEL'Y'       CFT014  1                       CFT014
     C                     OPEN INPAYXL2                                  CFT014
     C                     ELSE                                           CFT014
     C                     MOVEL'N'       CFT014                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CLE031
      ** Check whether SAR CLE031 is installed or not.                    CLE031
      *                                                                   CLE031
     C                     CALL 'AOSARDR0'                                CLE031
     C                     PARM *BLANK    PRTCD   7                       CLE031
     C                     PARM '*VERIFY' POPTN   7                       CLE031
     C                     PARM 'CLE031'  PSARD   6                       CLE031
     C           SCSARD    PARM SCSARD    DSFDY                           CLE031
      *                                                                   CLE031
     C           PRTCD     IFEQ *BLANK                                    CLE031
     C                     MOVE 'Y'       CLE031  1                       CLE031
      *                                                                   CLE031
     C                     ELSE                                           CLE031
      *                                                                   CLE031
     C                     MOVE 'N'       CLE031                          CLE031
     C           PRTCD     IFNE '*NRF   '                                 CLE031
     C           *LOCK     IN   LDA                                       CLE031
     C                     MOVEL'EU0190  'DBPGM                           CLE031
     C                     MOVEL'SCSARDPD'DBFILE                          CLE031
     C                     Z-ADD07        DBASE                           CLE031
     C                     MOVEL'CLE031'  DBKEY                           CLE031
     C                     OUT  LDA                                       CLE031
     C                     EXSR *PSSR                                     CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
     C                     ENDIF                                          CLE031
      *                                                                                       CLE106
      ** Check whether SAR CLE106 is installed or not.                                        CLE106
      *                                                                                       CLE106
     C                     CALL 'AOSARDR0'                                                    CLE106
     C                     PARM *BLANK    PRTCD   7                                           CLE106
     C                     PARM '*VERIFY' POPTN   7                                           CLE106
     C                     PARM 'CLE106'  PSARD   6                                           CLE106
     C           SCSARD    PARM SCSARD    DSFDY                                               CLE106
      *                                                                                       CLE106
     C           PRTCD     IFEQ *BLANK                                                        CLE106
     C                     MOVE 'Y'       CLE106  1                                           CLE106
      *                                                                                       CLE106
     C                     ELSE                                                               CLE106
      *                                                                                       CLE106
     C                     MOVE 'N'       CLE106                                              CLE106
     C           PRTCD     IFNE '*NRF   '                                                     CLE106
     C           *LOCK     IN   LDA                                                           CLE106
     C                     MOVEL'EU0190  'DBPGM                                               CLE106
     C                     MOVEL'SCSARDPD'DBFILE                                              CLE106
     C                     Z-ADD08        DBASE                                               CLE106
     C                     MOVEL'CLE106'  DBKEY                                               CLE106
     C                     OUT  LDA                                                           CLE106
     C                     EXSR *PSSR                                                         CLE106
     C                     ENDIF                                                              CLE106
      *                                                                                       CLE106
     C                     ENDIF                                                              CLE106
      *
      ***  RCF Processing for Audit File.
      *
     C                     EXSR RCFAU
      *
     C                     OPEN EU0190P1
     C                     EXSR RCFP1
      *
      ***  Report Work fields.
      *
     C                     Z-ADD0         RQDLN1  30
     C                     Z-ADD0         DIFLN1  30
     C/COPY WNCPYSRC,EU0190C001
      *
     C                     ENDSR
      *
      *****************************************************************
      /TITLE SR/SRCUSE
      *****************************************************************
      *                                                               *
      *  SRCUSE - Subroutine to do the Detail Processing for Customer *
      *           Exchange records.                                   *
      *                                                               *
      *****************************************************************
      *
     C           SRCUSE    BEGSR                           *** SRCUSE ***
      *
      ***  Read first record from File.
      *
     C                     READ CUSEX                    69
      *
      ***  Print header of record format.
      *
     C                     MOVEL#RPN,1    REPNAM
     C                     WRITEHEADPY
     C                     WRITECUSESUB
      *
     C                     Z-ADD0         R1CTR   20
      *
      ***  Do WHILE not end of file.
      *
     C           *IN69     DOWEQ*OFF
      *
     C           RECI      IFNE 'C'                        * RECI *
      *                                                                   145427
     C                     MOVE *BLANKS   DACCY1                          145427
     C                     MOVE *BLANKS   CACCY1                          145427
      *
      ** Debit Retail Account no. <> blanks
      *
     C           DRAN      IFNE *ZERO
     C                     MOVE DRAN      K#RAN1
     C                     EXSR SRACCT
     C*                                                                   147975
     C           RECI      IFEQ 'C'                                       147975
     C           *IN87     OREQ *ON                                       147975
     C                     MOVEL'Y'       CLOSE   1        CLOSE OR NEXIST147975
     C                     END                                            147975
     C*                                                                   147975
     C                     MOVELTCCY      DACCY1  3
     C                     ENDIF
      *
      ** Credit Retail Account no. <> blanks
      *
     C           CRAN      IFNE *ZERO
     C                     MOVE CRAN      K#RAN1
     C                     EXSR SRACCT
     C*                                                                   147975
     C           RECI      IFEQ 'C'                                       147975
     C           *IN87     OREQ *ON                                       147975
     C                     MOVEL'Y'       CLOSE   1        CLOSE OR NEXIST147975
     C                     END                                            147975
     C*                                                                   147975
     C                     MOVELTCCY      CACCY1  3
     C                     ENDIF
      *
     C           CLOSE     IFNE 'Y'                                       147975
     C*                                                                   147975
     C           DRCY      IFNE *BLANKS
     C           DRAN      ANDNE*ZERO                                     145427
     C           DRCY      ANDNEDACCY1
     C           CRCY      ORNE *BLANKS
     C           CRAN      ANDNE*ZERO                                     145427
     C           CRCY      ANDNECACCY1
      *
      ***  Output details to report.
      *
     C                     MOVELIPDN      RIPDN
      *
      ***  Convert date to DDMMMYY format
      *
     C                     MOVE VALD      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    RVALD
      *
     C                     MOVELDRCY      RDRCY
     C                     MOVE DRAN      RDRAN
     C                     MOVELDACCY1    RDACCY
      *
     C                     MOVE DRCY      WCCY    3
     C                     EXSR SRCURR
      *
     C                     MOVE 'J'       ZECODE
     C                     Z-ADDDRAM      ZFLD15
     C                     Z-ADDA6NBDP    ZDECS
      *
     C                     EXSR ZSEDIT
      *
     C                     MOVE ZOUT21    RDRAM
      *
     C                     MOVELCRCY      RCRCY
     C                     MOVE CRAN      RCRAN
      *
     C                     MOVE CRCY      WCCY    3
     C                     EXSR SRCURR
      *
     C                     MOVE 'J'       ZECODE
     C                     Z-ADDCRAM      ZFLD15
     C                     Z-ADDA6NBDP    ZDECS
      *
     C                     EXSR ZSEDIT
      *
     C                     MOVE ZOUT21    RCRAM
      *
     C                     MOVELCACCY1    RCACCY
      *
     C                     EXSR WP1REC
     C           #CHKLN    IFEQ 'Y'
     C                     WRITECUSESUB
     C                     ENDIF
      *
     C                     WRITECUSEDTL
      *
      ***  Count records read.
      *
     C                     ADD  1         R1CTR
     C                     ENDIF
      *
     C                     ENDIF                                          147975
      *                                                                   147975
     C                     ENDIF                           * RECI *
      *
      ** Read next record.
     C                     READ CUSEX                    69
     C                     ENDDO
      *
     C                     Z-ADDR1CTR     RCOUNT
     C           RCOUNT    IFEQ 0
      * Print No details.
     C                     WRITENODTLS
     C                     ENDIF
      *
      ** Do Audit report processing.
      *
     C                     MOVEL'CUSEX'   FNAME
     C                     EXSR SRAUDT
      *
     C                     ENDSR
      *
      *****************************************************************
      /TITLE SR/SRDEAL
      *****************************************************************
      *                                                               *
      *  SRDEAL - Subroutine to do the Detail Processing for Deals    *
      *           records.                                            *
      *                                                               *
      *****************************************************************
      *
     C           SRDEAL    BEGSR                           *** SRDEAL ***
      *
      ***  Read first record from File.
      *
     C                     READ DEALS                    70
      *
      ***  Print header of record format.
      *
     C                     MOVEL#RPN,2    REPNAM
     C                     WRITEHEADPY
     C                     WRITEDEALSUB
      *
     C                     Z-ADD0         R2CTR   20
      *
      ***  Do WHILE not end of file.
      *
     C           *IN70     DOWEQ*OFF
      *
     C           RECI      IFNE 'M'                        * RECI *
     C           RECI      ANDNE'*'
     C           RECI      ANDNE'R'                                       144528
      *
     C                     MOVELCCY       ##CCY   3
      *
      **  FX Deals.
     C           RCDT      IFEQ 'B'
     C                     EXSR SRDLDB
     C                     ENDIF
      *
      **  MM and Loan Deals; Neg. Asset Purchased.
     C           RCDT      IFEQ 'C'
     C           RCDT      OREQ 'D'
     C                     EXSR SRDLDC
     C                     ENDIF
      *
      **  Neg. Asset sold.
     C           RCDT      IFEQ 'E'
     C                     EXSR SRDLDE
     C                     ENDIF
      *
      **  FRA/IRS.
     C           RCDT      IFEQ 'G'
     C                     EXSR SRDLDG
     C                     ENDIF
      *
     C                     ENDIF                           * RECI *
      *
      ** Read next record.
     C                     READ DEALS                    70
     C                     ENDDO
      *
     C                     Z-ADDR2CTR     RCOUNT
     C           RCOUNT    IFEQ 0
      * Print No details.
     C                     WRITENODTLS
     C                     ENDIF
      *
      ** Do Audit report processing.
      *
     C                     MOVEL'DEALS'   FNAME
     C                     EXSR SRAUDT
      *
     C                     ENDSR
      *
      *****************************************************************
      /TITLE SR/SRDLDB
      *****************************************************************
      *                                                               *
      *  SRDLDB - Subroutine to do the Detail Processing for FX deal  *
      *           records.                                            *
      *  Called By: SR/SRDEAL                                         *
      *                                                               *
      *****************************************************************
      *
     C           SRDLDB    BEGSR                           *** SRDLDB ***
      *
      ** Purchased Ccy settlement type = '14'
      *
     C           PCST      IFEQ 14
      *                                                                   147975
      ** Only retail accounts are to be processed for eventual            147975
      ** reporting .                                                      147975
      *                                                                   147975
     C           OPCA      IFNE *ZERO                                     147975
     C                     MOVELOPCA      K#RAN1
     C                     MOVEL#ATP,5    RACTP                                               239481
     C                     EXSR SRACCT
      *
     C           RECI      IFNE 'C'                                       147975
     C           *IN87     ANDEQ*OFF                                      147975
      *                                                                   147975
     C           RSCY      IFNE *BLANKS
     C           RSCY      IFNE TCCY
      *
      ** Output details to report.
      *
     C                     MOVELDLNO      RDLNO
     C                     MOVELDTYP      RDTYP
     C                     MOVELDLST      RDLST
      *
      ***  Convert date to DDMMMYY format
      *
     C                     MOVE DDAT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    RDDAT
      *
     C                     MOVELRSCY      RTRCCY
     C                     MOVELOPCA      RRSAN
     C                     MOVELTCCY      RACCY
      *
     C                     EXSR WP1REC
     C           #CHKLN    IFEQ 'Y'
     C                     WRITEDEALSUB
     C                     ENDIF
      *
     C                     WRITEDEALDTL
      *
     C                     ADD  1         R2CTR
     C                     ENDIF
      *
     C                     ELSE
     C           PUCY      IFNE TCCY
      *
      ** Output details to report.
      *
     C                     MOVELDLNO      RDLNO
     C                     MOVELDTYP      RDTYP
     C                     MOVELDLST      RDLST
      *
      ***  Convert date to DDMMMYY format
      *
     C                     MOVE DDAT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    RDDAT
      *
     C                     MOVELPUCY      RTRCCY
     C                     MOVELOPCA      RRSAN
     C                     MOVELTCCY      RACCY
      *
     C                     EXSR WP1REC
     C           #CHKLN    IFEQ 'Y'
     C                     WRITEDEALSUB
     C                     ENDIF
      *
     C                     WRITEDEALDTL
      *
     C                     ADD  1         R2CTR
     C                     ENDIF
     C                     ENDIF
      *
     C                     ENDIF                                          147975
      *                                                                   147975
     C                     ENDIF                                          147975
      *                                                                   147975
     C                     ENDIF
      *
      ** Sell Ccy settlement type = '14'
      *
     C           SCST      IFEQ 14
      *                                                                   147975
      ** Only retail accounts are to be processed for eventual            147975
      ** reporting .                                                      147975
      *                                                                   147975
     C           OSCA      IFNE *ZERO                                     147975
     C                     MOVELOSCA      K#RAN1
     C                     MOVEL#ATP,6    RACTP                                               239481
     C                     EXSR SRACCT
      *
     C           RECI      IFNE 'C'                                       147975
     C           *IN87     ANDEQ*OFF                                      147975
      *                                                                   147975
     C           PSCY      IFNE *BLANKS
     C           PSCY      IFNE TCCY
      *
      ** Output details to report.
      *
     C                     MOVELDLNO      RDLNO
     C                     MOVELDTYP      RDTYP
     C                     MOVELDLST      RDLST
      *
      ***  Convert date to DDMMMYY format
      *
     C                     MOVE DDAT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    RDDAT
      *
     C                     MOVELPSCY      RTRCCY
     C                     MOVELOSCA      RRSAN
     C                     MOVELTCCY      RACCY
      *
     C                     EXSR WP1REC
     C           #CHKLN    IFEQ 'Y'
     C                     WRITEDEALSUB
     C                     ENDIF
      *
     C                     WRITEDEALDTL
      *
     C                     ADD  1         R2CTR
     C                     ENDIF
     C                     ELSE
      *
     C           SLCY      IFNE TCCY
      *
      ** Output details to report.
      *
     C                     MOVELDLNO      RDLNO
     C                     MOVELDTYP      RDTYP
     C                     MOVELDLST      RDLST
      *
      ***  Convert date to DDMMMYY format
      *
     C                     MOVE DDAT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    RDDAT
      *
     C                     MOVELSLCY      RTRCCY
     C                     MOVELOSCA      RRSAN
     C                     MOVELTCCY      RACCY
      *
     C                     EXSR WP1REC
     C           #CHKLN    IFEQ 'Y'
     C                     WRITEDEALSUB
     C                     ENDIF
      *
     C                     WRITEDEALDTL
      *
     C                     ADD  1         R2CTR
     C                     ENDIF
     C                     ENDIF
      *
     C                     ENDIF                                          147975
      *                                                                   147975
     C                     ENDIF                                          147975
      *                                                                   147975
     C                     ENDIF
      *
     C                     ENDSR
      *
      *****************************************************************
      /TITLE SR/SRDLDC
      *****************************************************************
      *                                                               *
      *  SRDLDC - Subroutine to do the Detail Processing for MM,      *
      *           Loan and Neg. Assets Purchased Deal.                *
      *  Called By: SR/SRDEAL                                         *
      *                                                               *
      *****************************************************************
      *
     C           SRDLDC    BEGSR                           *** SRDLDC ***
      *
      ** Start date settlement type = '14'
      *
     C           SDST      IFEQ 14
      *                                                                   147975
      ** Only retail accounts are to be processed for eventual            147975
      ** reporting .                                                      147975
      *                                                                   147975
     C           OSDA      IFNE *ZERO                                     147975
     C                     MOVELOSDA      K#RAN1
     C                     MOVEL#ATP,1    RACTP                                               239481
     C                     EXSR SRACCT
      *
     C           RECI      IFNE 'C'                                       147975
     C           *IN87     ANDEQ*OFF                                      147975
      *                                                                   147975
     C           STCY      IFNE *BLANKS
     C           STCY      IFNE TCCY
      *
      ** Output details to report.
      *
     C                     MOVELDLNO      RDLNO
     C                     MOVELDTYP      RDTYP
     C                     MOVELDLST      RDLST
      *
      ***  Convert date to DDMMMYY format
      *
     C                     MOVE DDAT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    RDDAT
      *
     C                     MOVELSTCY      RTRCCY
     C                     MOVELOSDA      RRSAN
     C                     MOVELTCCY      RACCY
      *
     C                     EXSR WP1REC
     C           #CHKLN    IFEQ 'Y'
     C                     WRITEDEALSUB
     C                     ENDIF
      *
     C                     WRITEDEALDTL
      *
     C                     ADD  1         R2CTR
     C                     ENDIF
      *
     C                     ELSE
     C           ##CCY     IFNE TCCY
      *
      ** Output details to report.
      *
     C                     MOVELDLNO      RDLNO
     C                     MOVELDTYP      RDTYP
     C                     MOVELDLST      RDLST
      *
      ***  Convert date to DDMMMYY format
      *
     C                     MOVE DDAT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    RDDAT
      *
     C                     MOVEL##CCY     RTRCCY
     C                     MOVELOSDA      RRSAN
     C                     MOVELTCCY      RACCY
      *
     C                     EXSR WP1REC
     C           #CHKLN    IFEQ 'Y'
     C                     WRITEDEALSUB
     C                     ENDIF
      *
     C                     WRITEDEALDTL
      *
     C                     ADD  1         R2CTR
     C                     ENDIF
     C                     ENDIF
      *
     C                     ENDIF                                          147975
      *                                                                   147975
     C                     ENDIF                                          147975
      *                                                                   147975
     C                     ENDIF
      *
      ** Maturity date settlement type = '14'
      *
     C           MDST      IFEQ 14
      *                                                                   147975
      ** Only retail accounts are to be processed for eventual            147975
      ** reporting .                                                      147975
      *                                                                   147975
     C           OMDA      IFNE *ZERO                                     147975
     C                     MOVELOMDA      K#RAN1
     C                     MOVEL#ATP,2    RACTP                                               239481
     C                     EXSR SRACCT
      *
     C           RECI      IFNE 'C'                                       147975
     C           *IN87     ANDEQ*OFF                                      147975
      *                                                                   147975
     C           STCY      IFNE *BLANKS
     C           STCY      IFNE TCCY
      *
      ** Output details to report.
      *
     C                     MOVELDLNO      RDLNO
     C                     MOVELDTYP      RDTYP
     C                     MOVELDLST      RDLST
      *
      ***  Convert date to DDMMMYY format
      *
     C                     MOVE DDAT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    RDDAT
      *
     C                     MOVELSTCY      RTRCCY
     C                     MOVELOMDA      RRSAN
     C                     MOVELTCCY      RACCY
      *
     C                     EXSR WP1REC
     C           #CHKLN    IFEQ 'Y'
     C                     WRITEDEALSUB
     C                     ENDIF
      *
     C                     WRITEDEALDTL
      *
     C                     ADD  1         R2CTR
     C                     ENDIF
      *
     C                     ELSE
     C           ##CCY     IFNE TCCY
      *
      ** Output details to report.
      *
     C                     MOVELDLNO      RDLNO
     C                     MOVELDTYP      RDTYP
     C                     MOVELDLST      RDLST
      *
      ***  Convert date to DDMMMYY format
      *
     C                     MOVE DDAT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    RDDAT
      *
     C                     MOVEL##CCY     RTRCCY
     C                     MOVELOMDA      RRSAN
     C                     MOVELTCCY      RACCY
      *
     C                     EXSR WP1REC
     C           #CHKLN    IFEQ 'Y'
     C                     WRITEDEALSUB
     C                     ENDIF
      *
     C                     WRITEDEALDTL
      *
     C                     ADD  1         R2CTR
     C                     ENDIF
     C                     ENDIF
      *                                                                   147975
     C                     ENDIF                                          147975
      *
     C                     ENDIF                                          147975
      *                                                                   147975
     C                     ENDIF
      *                                                                                       239548
      ** Interest Settlement A/C for MM Loan/Deposit                                          239548
      *                                                                                       239548
     C           RCDT      IFEQ 'C'                                                           239548
     C           IPDS      ANDEQ'Y'                                                           239548
     C           IMET      ANDEQ'14'                                                          239548
      *                                                                                       239548
      ** Only retail accounts are to be processed for eventual                                239548
      ** reporting .                                                                          239548
      *                                                                                       239548
     C           INSA      IFNE *ZERO                                                         239548
     C                     MOVELINSA      K#RAN1                                              239548
     C                     MOVE *BLANKS   RACTP                                               239481
     C                     MOVEL'INTEREST'RACTP                                               239481
     C                     CAT  #ATP,23:1 RACTP                                               239481
     C                     EXSR SRACCT                                                        239548
      *                                                                                       239548
     C           RECI      IFNE 'C'                                                           239548
     C           *IN87     ANDEQ*OFF                                                          239548
      *                                                                                       239548
     C           STCY      IFNE *BLANKS                                                       239548
     C           STCY      IFNE TCCY                                                          239548
      *                                                                                       239548
      ** Output details to report.                                                            239548
      *                                                                                       239548
     C                     MOVELDLNO      RDLNO                                               239548
     C                     MOVELDTYP      RDTYP                                               239548
     C                     MOVELDLST      RDLST                                               239548
      *                                                                                       239548
      ***  Convert date to DDMMMYY format                                                     239548
      *                                                                                       239548
     C                     MOVE DDAT      ZDAYNO                                              239548
     C                     EXSR ZDATE2                                                        239548
     C                     MOVE ZADATE    RDDAT                                               239548
      *                                                                                       239548
     C                     MOVELSTCY      RTRCCY                                              239548
     C                     MOVELINSA      RRSAN                                               239548
     C                     MOVELTCCY      RACCY                                               239548
      *                                                                                       239548
     C                     EXSR WP1REC                                                        239548
     C           #CHKLN    IFEQ 'Y'                                                           239548
     C                     WRITEDEALSUB                                                       239548
     C                     ENDIF                                                              239548
      *                                                                                       239548
     C                     WRITEDEALDTL                                                       239548
      *                                                                                       239548
     C                     ADD  1         R2CTR                                               239548
     C                     ENDIF                                                              239548
      *                                                                                       239548
     C                     ELSE                                                               239548
     C           ##CCY     IFNE TCCY                                                          239548
      *                                                                                       239548
      ** Output details to report.                                                            239548
      *                                                                                       239548
     C                     MOVELDLNO      RDLNO                                               239548
     C                     MOVELDTYP      RDTYP                                               239548
     C                     MOVELDLST      RDLST                                               239548
      *                                                                                       239548
      ***  Convert date to DDMMMYY format                                                     239548
      *                                                                                       239548
     C                     MOVE DDAT      ZDAYNO                                              239548
     C                     EXSR ZDATE2                                                        239548
     C                     MOVE ZADATE    RDDAT                                               239548
      *                                                                                       239548
     C                     MOVEL##CCY     RTRCCY                                              239548
     C                     MOVELINSA      RRSAN                                               239548
     C                     MOVELTCCY      RACCY                                               239548
      *                                                                                       239548
     C                     EXSR WP1REC                                                        239548
     C           #CHKLN    IFEQ 'Y'                                                           239548
     C                     WRITEDEALSUB                                                       239548
     C                     ENDIF                                                              239548
      *                                                                                       239548
     C                     WRITEDEALDTL                                                       239548
      *                                                                                       239548
     C                     ADD  1         R2CTR                                               239548
     C                     ENDIF                                                              239548
     C                     ENDIF                                                              239548
      *                                                                                       239548
     C                     ENDIF                                                              239548
      *                                                                                       239548
     C                     ENDIF                                                              239548
      *                                                                                       239548
     C                     ENDIF                                                              239548
      *
     C                     ENDSR
      *
      *****************************************************************
      /TITLE SR/SRDLDE
      *****************************************************************
      *                                                               *
      *  SRDLDE - Subroutine to do the Detail Processing for Neg.     *
      *           Assets Sold Deal records.                           *
      *  Called By: SR/SRDEAL                                         *
      *                                                               *
      *****************************************************************
      *
     C           SRDLDE    BEGSR                           *** SRDLDE ***
      *
      ** Settlement type = '14'
      *
     C           SETP      IFEQ 14
      *                                                                   147975
      ** Only retail accounts are to be processed for eventual            147975
      ** reporting .                                                      147975
      *                                                                   147975
     C           OSAC      IFNE *ZERO                                     147975
     C                     MOVEL#ATP,23   RACTP                                               239481
     C                     MOVELOSAC      K#RAN1
     C                     MOVEL#ATP,23   RACTP                                               239481
     C                     EXSR SRACCT
      *
     C           RECI      IFNE 'C'                                       147975
     C           *IN87     ANDEQ*OFF                                      147975
      *                                                                   147975
     C           STCY      IFNE *BLANKS
     C           STCY      IFNE TCCY
      *
      ** Output details to report.
      *
     C                     MOVELDLNO      RDLNO
     C                     MOVELDTYP      RDTYP
     C                     MOVELDLST      RDLST
      *
      ***  Convert date to DDMMMYY format
      *
     C                     MOVE DDAT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    RDDAT
      *
     C                     MOVELSTCY      RTRCCY
     C                     MOVELOSAC      RRSAN
     C                     MOVELTCCY      RACCY
      *
     C                     EXSR WP1REC
     C           #CHKLN    IFEQ 'Y'
     C                     WRITEDEALSUB
     C                     ENDIF
      *
     C                     WRITEDEALDTL
      *
     C                     ADD  1         R2CTR
     C                     ENDIF
      *
     C                     ELSE
     C           ##CCY     IFNE TCCY
      *
      ** Output details to report.
      *
     C                     MOVELDLNO      RDLNO
     C                     MOVELDTYP      RDTYP
     C                     MOVELDLST      RDLST
      *
      ***  Convert date to DDMMMYY format
      *
     C                     MOVE DDAT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    RDDAT
      *
     C                     MOVEL##CCY     RTRCCY
     C                     MOVELOSAC      RRSAN
     C                     MOVELTCCY      RACCY
      *
     C                     EXSR WP1REC
     C           #CHKLN    IFEQ 'Y'
     C                     WRITEDEALSUB
     C                     ENDIF
      *
     C                     WRITEDEALDTL
      *
     C                     ADD  1         R2CTR
     C                     ENDIF
     C                     ENDIF
      *                                                                   147975
     C                     ENDIF                                          147975
      *                                                                   147975
     C                     ENDIF                                          147975
      *
     C                     ENDIF
      *
     C                     ENDSR
      *
      *****************************************************************
      /TITLE SR/SRDLDG
      *****************************************************************
      *                                                               *
      *  SRDLDG - Subroutine to do the Detail Processing for FRA/IRS  *
      *           Deal records.                                       *
      *  Called By: SR/SRDEAL                                         *
      *                                                               *
      *****************************************************************
      *
     C           SRDLDG    BEGSR                           *** SRDLDG ***
      *
      ** DTYP = 'RX' (Cross Currency Interest rate Swap)
      *
     C           DTYP      IFEQ 'RX'
      *
      ** If Receipt settlement method = '14'
     C           RSETM     IFEQ 14
      *                                                                   147975
      ** Only retail accounts are to be processed for eventual            147975
      ** reporting .                                                      147975
      *                                                                   147975
     C           URACC     IFNE *ZERO                                     147975
     C                     MOVELURACC     K#RAN1
     C                     MOVEL#ATP,3    RACTP                                               239481
     C                     EXSR SRACCT
      *
     C           RECI      IFNE 'C'                                       147975
     C           *IN87     ANDEQ*OFF                                      147975
      *                                                                   147975
     C           RSCY      IFNE *BLANKS
     C           RSCY      IFNE TCCY
      *
      ** Output details to report.
      *
     C                     MOVELDLNO      RDLNO
     C                     MOVELDTYP      RDTYP
     C                     MOVELDLST      RDLST
      *
      ***  Convert date to DDMMMYY format
      *
     C                     MOVE DDAT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    RDDAT
      *
     C                     MOVELRSCY      RTRCCY
     C                     MOVELURACC     RRSAN
     C                     MOVELTCCY      RACCY
      *
     C                     EXSR WP1REC
     C           #CHKLN    IFEQ 'Y'
     C                     WRITEDEALSUB
     C                     ENDIF
      *
     C                     WRITEDEALDTL
      *
     C                     ADD  1         R2CTR
     C                     ENDIF
      *
     C                     ELSE
     C           TCUCY     IFNE TCCY
      *
      ** Output details to report.
      *
     C                     MOVELDLNO      RDLNO
     C                     MOVELDTYP      RDTYP
     C                     MOVELDLST      RDLST
      *
      ***  Convert date to DDMMMYY format
      *
     C                     MOVE DDAT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    RDDAT
      *
     C                     MOVELTCUCY     RTRCCY
     C                     MOVELURACC     RRSAN
     C                     MOVELTCCY      RACCY
      *
     C                     EXSR WP1REC
     C           #CHKLN    IFEQ 'Y'
     C                     WRITEDEALSUB
     C                     ENDIF
      *
     C                     WRITEDEALDTL
      *
     C                     ADD  1         R2CTR
     C                     ENDIF
     C                     ENDIF
      *                                                                   147975
     C                     ENDIF                                          147975
      *                                                                   147975
     C                     ENDIF                                          147975
      *
     C                     ENDIF
      *
      ** If Payment settlement method = '14'
     C           PSETM     IFEQ 14
      *                                                                   147975
      ** Only retail accounts are to be processed for eventual            147975
      ** reporting .                                                      147975
      *                                                                   147975
     C           UPACC     IFNE *ZERO                                     147975
     C                     MOVELUPACC     K#RAN1
     C                     MOVEL#ATP,4    RACTP                                               239481
     C                     EXSR SRACCT
      *
     C           RECI      IFNE 'C'                                       147975
     C           *IN87     ANDEQ*OFF                                      147975
      *                                                                   147975
     C           PSCY      IFNE *BLANKS
     C           PSCY      IFNE TCCY
      *
      ** Output details to report.
      *
     C                     MOVELDLNO      RDLNO
     C                     MOVELDTYP      RDTYP
     C                     MOVELDLST      RDLST
      *
      ***  Convert date to DDMMMYY format
      *
     C                     MOVE DDAT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    RDDAT
      *
     C                     MOVELPSCY      RTRCCY
     C                     MOVELUPACC     RRSAN
     C                     MOVELTCCY      RACCY
      *
     C                     EXSR WP1REC
     C           #CHKLN    IFEQ 'Y'
     C                     WRITEDEALSUB
     C                     ENDIF
      *
     C                     WRITEDEALDTL
      *
     C                     ADD  1         R2CTR
     C                     ENDIF
      *
     C                     ELSE
     C           UCUCY     IFNE TCCY
      *
      ** Output details to report.
      *
     C                     MOVELDLNO      RDLNO
     C                     MOVELDTYP      RDTYP
     C                     MOVELDLST      RDLST
      *
      ***  Convert date to DDMMMYY format
      *
     C                     MOVE DDAT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    RDDAT
      *
     C                     MOVELUCUCY     RTRCCY
     C                     MOVELUPACC     RRSAN
     C                     MOVELTCCY      RACCY
      *
     C                     EXSR WP1REC
     C           #CHKLN    IFEQ 'Y'
     C                     WRITEDEALSUB
     C                     ENDIF
      *
     C                     WRITEDEALDTL
      *
     C                     ADD  1         R2CTR
     C                     ENDIF
     C                     ENDIF
      *                                                                   147975
     C                     ENDIF                                          147975
      *                                                                   147975
     C                     ENDIF                                          147975
      *
     C                     ENDIF
      *
     C                     ELSE
      *
      ** Other FRA/IRS deals.
      *
      ** Receipt settlement method = '14'.
      *
     C           RSETM     IFEQ 14
      *                                                                   147975
      ** Only retail accounts are to be processed for eventual            147975
      ** reporting .                                                      147975
      *                                                                   147975
     C           URACC     IFNE *ZERO                                     147975
     C                     MOVELURACC     K#RAN1
     C                     MOVEL#ATP,3    RACTP                                               239481
     C                     EXSR SRACCT
      *
     C           RECI      IFNE 'C'                                       147975
     C           *IN87     ANDEQ*OFF                                      147975
      *                                                                   147975
     C           RSCY      IFNE *BLANKS
     C           RSCY      IFNE TCCY
      *
      ** Output details to report.
      *
     C                     MOVELDLNO      RDLNO
     C                     MOVELDTYP      RDTYP
     C                     MOVELDLST      RDLST
      *
      ***  Convert date to DDMMMYY format
      *
     C                     MOVE DDAT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    RDDAT
      *
     C                     MOVELRSCY      RTRCCY
     C                     MOVELURACC     RRSAN
     C                     MOVELTCCY      RACCY
      *
     C                     EXSR WP1REC
     C           #CHKLN    IFEQ 'Y'
     C                     WRITEDEALSUB
     C                     ENDIF
      *
     C                     WRITEDEALDTL
      *
     C                     ADD  1         R2CTR
     C                     ENDIF
      *
     C                     ELSE
     C           UCUCY     IFNE TCCY
      *
      ** Output details to report.
      *
     C                     MOVELDLNO      RDLNO
     C                     MOVELDTYP      RDTYP
     C                     MOVELDLST      RDLST
      *
      ***  Convert date to DDMMMYY format
      *
     C                     MOVE DDAT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    RDDAT
      *
     C                     MOVELUCUCY     RTRCCY
     C                     MOVELURACC     RRSAN
     C                     MOVELTCCY      RACCY
      *
     C                     EXSR WP1REC
     C           #CHKLN    IFEQ 'Y'
     C                     WRITEDEALSUB
     C                     ENDIF
      *
     C                     WRITEDEALDTL
      *
     C                     ADD  1         R2CTR
     C                     ENDIF
     C                     ENDIF
      *                                                                   147975
     C                     ENDIF                                          147975
      *                                                                   147975
     C                     ENDIF                                          147975
      *
     C                     ENDIF
      *
      ** Payment settlement method = '14'.
      *
     C           PSETM     IFEQ 14
      *                                                                   147975
      ** Only retail accounts are to be processed for eventual            147975
      ** reporting .                                                      147975
      *                                                                   147975
     C           UPACC     IFNE *ZERO                                     147975
     C                     MOVELUPACC     K#RAN1
     C                     MOVEL#ATP,4    RACTP                                               239481
     C                     EXSR SRACCT
      *
     C           RECI      IFNE 'C'                                       147975
     C           *IN87     ANDEQ*OFF                                      147975
      *                                                                   147975
     C           PSCY      IFNE *BLANKS
     C           PSCY      IFNE TCCY
      *
      ** Output details to report.
      *
     C                     MOVELDLNO      RDLNO
     C                     MOVELDTYP      RDTYP
     C                     MOVELDLST      RDLST
      *
      ***  Convert date to DDMMMYY format
      *
     C                     MOVE DDAT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    RDDAT
      *
     C                     MOVELPSCY      RTRCCY
     C                     MOVELUPACC     RRSAN
     C                     MOVELTCCY      RACCY
      *
     C                     EXSR WP1REC
     C           #CHKLN    IFEQ 'Y'
     C                     WRITEDEALSUB
     C                     ENDIF
      *
     C                     WRITEDEALDTL
      *
     C                     ADD  1         R2CTR
     C                     ENDIF
      *
     C                     ELSE
     C           UCUCY     IFNE TCCY
      *
      ** Output details to report.
      *
     C                     MOVE DLNO      RDLNO
     C                     MOVELDTYP      RDTYP
     C                     MOVELDLST      RDLST
      *
      ***  Convert date to DDMMMYY format
      *
     C                     MOVE DDAT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    RDDAT
      *
     C                     MOVELUCUCY     RTRCCY
     C                     MOVELUPACC     RRSAN
     C                     MOVELTCCY      RACCY
      *
     C                     EXSR WP1REC
     C           #CHKLN    IFEQ 'Y'
     C                     WRITEDEALSUB
     C                     ENDIF
      *
     C                     WRITEDEALDTL
      *
     C                     ADD  1         R2CTR
     C                     ENDIF
     C                     ENDIF
      *                                                                   147975
     C                     ENDIF                                          147975
      *                                                                   147975
     C                     ENDIF                                          147975
      *
     C                     ENDIF
      *
     C                     ENDIF
      *
     C                     ENDSR
      *
      *****************************************************************
      /TITLE SR/SRDEAM
      *****************************************************************
      *                                                               *
      *  SRDEAM - Subroutine to do the Detail Processing DEAMS        *
      *           records.                                            *
      *                                                               *
      *****************************************************************
      *
     C           SRDEAM    BEGSR                           *** SRDEAM ***
      *
      ***  Read first record from File.
      *
     C                     READ DEAMS                    71
      *
      ***  Print header of record format.
      *
     C                     MOVEL#RPN,3    REPNAM
     C                     WRITEHEADPY
     C                     WRITEDEAMSUB
      *
     C                     Z-ADD0         R3CTR   20
      *
      ***  Do WHILE not end of file.
      *
     C           *IN71     DOWEQ*OFF
      *
     C           RECI      IFNE 'M'                        * RECI *
     C           RECI      ANDNE'*'
      *
     C                     MOVELCCY       ##CCY1  3
      *                                                                   179699
      ** Do not process if Amendment types are 'SC' or 'CI'               179699
      *                                                                   179699
     C           AMTP      IFNE 'SC'                                      179699
     C           AMTP      ANDNE'CI'                                      179699
     C           SETP      IFEQ 14
      *                                                                   147975
      ** Only retail accounts are to be processed for eventual            147975
      ** reporting .                                                      147975
      *                                                                   147975
     C           OSAC      IFNE *ZERO                                     147975
     C                     MOVELOSAC      K#RAN1
     C                     EXSR SRACCT
      *
     C           RECI      IFNE 'C'                                       147975
     C           *IN87     ANDEQ*OFF                                      147975
      *                                                                   147975
     C           STCY      IFNE *BLANKS
     C           STCY      IFNE TCCY
      *
      ** Output details to report.
      *
     C                     MOVE DLNO      RDLNO
     C                     MOVELAMTP      RAMTP
     C                     MOVELDTYP      RDTYP
     C                     MOVELDLST      RDLST
      *
      ***  Convert date to DDMMMYY format
      *
     C                     MOVE VDAT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    RVDAT
      *
     C                     MOVELSTCY      RTRCCY
     C                     MOVELOSAC      RRSAN
     C                     MOVELTCCY      RACCY
      *
     C                     EXSR WP1REC
     C           #CHKLN    IFEQ 'Y'
     C                     WRITEDEAMSUB
     C                     ENDIF
      *
     C                     WRITEDEAMDTL
      *
     C                     ADD  1         R3CTR
     C                     ENDIF
      *
     C                     ELSE
     C           ##CCY1    IFNE TCCY
      *
      ** Output details to report.
      *
     C                     MOVE DLNO      RDLNO
     C                     MOVELAMTP      RAMTP
     C                     MOVELDTYP      RDTYP
     C                     MOVELDLST      RDLST
      *
      ***  Convert date to DDMMMYY format
      *
     C                     MOVE VDAT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    RVDAT
      *
     C                     MOVEL##CCY1    RTRCCY
     C                     MOVELOSAC      RRSAN
     C                     MOVELTCCY      RACCY
      *
     C                     EXSR WP1REC
     C           #CHKLN    IFEQ 'Y'
     C                     WRITEDEAMSUB
     C                     ENDIF
      *
     C                     WRITEDEAMDTL
      *
     C                     ADD  1         R3CTR
     C                     ENDIF
     C                     ENDIF
      *                                                                   147975
     C                     ENDIF                                          147975
      *                                                                   147975
     C                     ENDIF                                          147975
      *
     C                     ENDIF
      *
     C                     ENDIF                                          179699
      *                                                                   179699
     C                     ENDIF                           * RECI *
      *
      ** Read next record.
     C                     READ DEAMS                    71
     C                     ENDDO
      *
     C                     Z-ADDR3CTR     RCOUNT
     C           RCOUNT    IFEQ 0
      * Print No details.
     C                     WRITENODTLS
     C                     ENDIF
      *
      ** Do Audit report processing.
      *
     C                     MOVEL'DEAMS'   FNAME
     C                     EXSR SRAUDT
      *
     C                     ENDSR
      *
      *****************************************************************
      /TITLE SR/SROTPY
      *****************************************************************
      *                                                               *
      *  SROTPY - Subroutine to do the Detail Processing for FT Out.  *
      *           Payments records.                                   *
      *                                                               *
      *****************************************************************
      *
     C           SROTPY    BEGSR                           *** SROTPY ***
      *
      ***  Read first record from File.
      *
     C                     READ OTPAY                    72
      *
      ***  Print header of record format.
      *
     C                     MOVEL#RPN,4    REPNAM
     C                     WRITEHEADPY
     C                     WRITEOTPYSUB
      *
     C                     Z-ADD0         R4CTR   20
      *
      ***  Do WHILE not end of file.
      *
     C           *IN72     DOWEQ*OFF
      *
     C***********RECI      IFNE 'M'                        * RECI *       144999
     C***********RECI      ANDNE'*'                                       144999
     C           RECI      IFEQ 'D'                        * RECI *       144999
      *
      ** Destination is retail no.
      ** and sender's correspondent is blank                              160164
      *
     C           SNCO      IFEQ *ZERO                                     160164
     C                     MOVELDST1      P10    10
     C                     MOVELDST1      P11    11
     C                     MOVE P11       P01     1
     C                     MOVE P10       P02     1
     C           P01       IFEQ *BLANKS
     C           P02       ANDNE*BLANKS
     C           DSTT      ANDEQ'R'                                       144999
     C                     MOVE P10       K#RAN1
     C                     MOVEL#ATP,7    RACTP                                               239481
     C                     EXSR SRACCT
      *
     C           RECI      IFNE 'C'                                       147975
     C           *IN87     ANDEQ*OFF                                      147975
      *                                                                   147975
     C           PCCY      IFNE TCCY
     C/COPY WNCPYSRC,EU0190C002
      *
      ** Output details to report.
      *
     C                     MOVELPREF      RPREF
     C                     MOVELPYTP      RPYTP
     C                     MOVELPYST      RPYST
     C                     MOVELPCCY      RTRCCY
     C                     MOVE P10       RRSAN
     C                     MOVELTCCY      RACCY
      *
     C                     EXSR WP1REC
     C           #CHKLN    IFEQ 'Y'
     C                     WRITEOTPYSUB
     C                     ENDIF
      *
     C                     WRITEOTPYDTL
      *
     C                     ADD  1         R4CTR
     C/COPY WNCPYSRC,EU0190C003
     C                     ENDIF
      *                                                                   147975
     C                     ENDIF                                          147975
      *                                                                   147975
     C                     ENDIF
     C                     ENDIF                                          160164
      *
      ** Sender's Correspondent.
      *
     C           SNCO      IFNE *ZERO
     C           SNCT      ANDEQ'R'                                       144999
     C                     MOVE SNCO      SNCO#  10
     C                     MOVE SNCO      K#RAN1
     C                     MOVEL#ATP,8    RACTP                                               239481
     C                     EXSR SRACCT
      *
     C           RECI      IFNE 'C'                                       147975
     C           *IN87     ANDEQ*OFF                                      147975
      *                                                                   147975
     C           PCCY      IFNE TCCY
      *
      ** Output details to report.
      *
     C                     MOVELPREF      RPREF
     C                     MOVELPYTP      RPYTP
     C                     MOVELPYST      RPYST
     C                     MOVELPCCY      RTRCCY
     C                     MOVE SNCO#     RRSAN
     C                     MOVELTCCY      RACCY
      *
     C                     EXSR WP1REC
     C           #CHKLN    IFEQ 'Y'
     C                     WRITEOTPYSUB
     C                     ENDIF
      *
     C                     WRITEOTPYDTL
      *
     C                     ADD  1         R4CTR
     C                     ENDIF
      *                                                                   147975
     C                     ENDIF                                          147975
      *                                                                   147975
     C                     ENDIF
      *
      ** Ordering Customer is a retail number.
      *
     C                     MOVE *BLANKS   P10
     C                     MOVE *BLANKS   P11
      *
     C                     MOVELORC1      W@C1    1                                           CFT032
     C           W@C1      IFEQ '/'                                                           CFT032
     C********** ORCT      IFEQ 'C'                                               BUG15105 BUG15105A
     C********** ORCT      OREQ 'S'                                               BUG15105 BUG15105A
     C**********           MOVELORC2      P10                                     BUG15105 BUG15105A
     C**********           MOVELORC2      P11                                     BUG15105 BUG15105A
     C**********           ELSE                                                   BUG15105 BUG15105A
     C           34        SUBSTORC1:2    P10                                                 CFT032
     C           34        SUBSTORC1:2    P11                                                 CFT032
     C**********           ENDIF                                                  BUG15105 BUG15105A
     C                     ELSE                                                               CFT032
     C                     MOVELORC1      P10
     C                     MOVELORC1      P11
     C                     ENDIF                                                              CFT032
     C                     MOVE P11       P01
     C                     MOVE P10       P02
     C           P01       IFEQ *BLANKS
     C           P02       ANDNE*BLANKS
     C           ORCT      ANDEQ'R'                                       144999
     C                     MOVE P10       K#RAN1
     C                     MOVEL#ATP,9    RACTP                                               239481
     C                     EXSR SRACCT
      *
     C           RECI      IFNE 'C'                                       147975
     C           *IN87     ANDEQ*OFF                                      147975
      *                                                                   147975
     C********** STCY      IFNE TCCY                                      145427
     C           SMCY      IFNE TCCY                                      145427
     C           SLDT      ANDGEBJRDNB                                    155644
     C/COPY WNCPYSRC,EU0190C004
      *
      ** Output details to report.
      *
     C                     MOVELPREF      RPREF
     C                     MOVELPYTP      RPYTP
     C                     MOVELPYST      RPYST
     C**********           MOVELSTCY      RTRCCY                          145427
     C                     MOVELSMCY      RTRCCY                          145427
     C                     MOVE P10       RRSAN
     C                     MOVELTCCY      RACCY
      *
     C                     EXSR WP1REC
     C           #CHKLN    IFEQ 'Y'
     C                     WRITEOTPYSUB
     C                     ENDIF
      *
     C                     WRITEOTPYDTL
      *
     C                     ADD  1         R4CTR
     C/COPY WNCPYSRC,EU0190C005
     C                     ENDIF
      *
     C                     ENDIF                                          147975
      *                                                                   147975
     C                     ELSE
     C                     MOVE *BLANKS   P10
     C                     MOVE *BLANKS   P11
      *
     C                     MOVELORBK      P10
     C                     MOVELORBK      P11
     C                     MOVE P11       P01
     C                     MOVE P10       P02
     C           P01       IFEQ *BLANKS
     C           P02       ANDNE*BLANKS
     C           ORBT      ANDEQ'R'                                       144999
     C                     MOVE P10       K#RAN1
     C                     MOVEL#ATP,10   RACTP                                               239481
     C                     EXSR SRACCT
      *
     C           RECI      IFNE 'C'                                       147975
     C           *IN87     ANDEQ*OFF                                      147975
      *                                                                   147975
     C********** STCY      IFNE TCCY                                      145427
     C           SMCY      IFNE TCCY                                      145427
     C           SLDT      ANDGEBJRDNB                                    155644
     C/COPY WNCPYSRC,EU0190C006
      *
      ** Output details to report.
      *
     C                     MOVELPREF      RPREF
     C                     MOVELPYTP      RPYTP
     C                     MOVELPYST      RPYST
     C**********           MOVELSTCY      RTRCCY                          145427
     C                     MOVELSMCY      RTRCCY                          145427
     C                     MOVE P10       RRSAN
     C                     MOVELTCCY      RACCY
      *
     C                     EXSR WP1REC
     C           #CHKLN    IFEQ 'Y'
     C                     WRITEOTPYSUB
     C                     ENDIF
      *
     C                     WRITEOTPYDTL
      *
     C                     ADD  1         R4CTR
     C/COPY WNCPYSRC,EU0190C007
     C                     ENDIF
      *                                                                   147975
     C                     ENDIF                                          147975
      *                                                                   147975
     C                     ENDIF
     C                     ENDIF
     C/COPY WNCPYSRC,EU0190C008
      *
     C                     ENDIF                           * RECI *
     C/COPY WNCPYSRC,EU0190C017
      *
     C                     READ OTPAY                    72
     C                     ENDDO
      *
     C                     Z-ADDR4CTR     RCOUNT
     C           RCOUNT    IFEQ 0
      * Print No details.
     C                     WRITENODTLS
     C                     ENDIF
      *
      ** Do Audit report processing.
      *
     C                     MOVEL'OTPAY'   FNAME
     C                     EXSR SRAUDT
      *
     C                     ENDSR
      *
      *****************************************************************
      /TITLE SR/SRINPY
      *****************************************************************
      *                                                               *
      *  SRINPY - Subroutine to do the Detail Processing for FT Inc.  *
      *           Payment records.                                    *
      *                                                               *
      *****************************************************************
      *
     C           SRINPY    BEGSR                           *** SRINPY ***
      *
      ***  Read first record from File.
      *
     C                     READ INPAY                    73
      *
      ***  Print header of record format.
      *
     C                     MOVEL#RPN,5    REPNAM
     C                     WRITEHEADPY
     C                     WRITEINPYSUB
      *
     C                     Z-ADD0         R5CTR   20
      *
      ***  Do WHILE not end of file.
      *
     C           *IN73     DOWEQ*OFF
      *
     C***********RECI      IFNE 'M'                        * RECI *       144999
     C***********RECI      ANDNE'*'                                       144999
     C           RECI      IFEQ 'D'                        * RECI *       144999
      *                                                                   CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
     C           PREF      CHAININPAYXL2             89                   CFT014
     C           *IN89     IFEQ *ON                                       CFT014
     C           *LOCK     IN   LDA                                       CFT014
     C                     MOVELPREF      DBKEY                           CFT014
     C                     MOVEL'INPAYXPD'DBFILE                          CFT014
     C                     Z-ADD6         DBASE                           CFT014
     C                     OUT  LDA                                       CFT014
     C                     EXSR *PSSR                                     CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *
      ** If Sender is Retail number.
      ** and receiver's correspondent is blank                            160164
      *
     C           RCCO      IFEQ *ZERO                                     160164
     C                     MOVE *BLANKS   P10
     C                     MOVE *BLANKS   P11
      *
     C                     MOVELSND1      P10
     C                     MOVELSND1      P11
     C                     MOVE P11       P01
     C                     MOVE P10       P02
     C           P01       IFEQ *BLANKS
     C           P02       ANDNE*BLANKS
     C           SNTP      ANDEQ'R'                                       144999
     C                     MOVE P10       K#RAN1
     C                     MOVEL#ATP,11   RACTP                                               239481
     C                     EXSR SRACCT
      *
     C           RECI      IFNE 'C'                                       147975
     C           *IN87     ANDEQ*OFF                                      147975
      *                                                                   147975
     C           SMCY      IFNE TCCY
     C           SLDT      ANDGEBJRDNB                                    155644
     C/COPY WNCPYSRC,EU0190C009
      *
      ** Output details to report.
      *
     C                     MOVELPREF      RPREF
     C                     MOVELPYTP      RPYTP
     C                     MOVELPYST      RPYST
     C                     MOVELSMCY      RTRCCY
     C                     MOVE P10       RRSAN
     C                     MOVELTCCY      RACCY
      *
     C                     EXSR WP1REC
     C           #CHKLN    IFEQ 'Y'
     C                     WRITEINPYSUB
     C                     ENDIF
      *
     C                     WRITEINPYDTL
      *
     C                     ADD  1         R5CTR
     C/COPY WNCPYSRC,EU0190C010
     C                     ENDIF
      *                                                                   147975
     C                     ENDIF                                          147975
      *                                                                   147975
     C                     ENDIF
     C                     ENDIF                                          160164
      *
      ** Receiver's Correspondent.
      *
     C***********RCCO      IFNE *ZERO                                     CFT014
     C***********RCRT      ANDEQ'R'                                144999 CFT014
     C***********          MOVE RCCO      RCCO#  10                       CFT014
     C           INRCO1    IFNE *BLANK                                    CFT014
     C           INRCRT    ANDEQ'R'                                       CFT014
     C                     MOVELINRCO1    RCCO#  10                       CFT014
     C                     MOVE RCCO#     K#RAN1
     C                     MOVEL#ATP,12   RACTP                                               239481
     C                     EXSR SRACCT
      *
     C           RECI      IFNE 'C'                                       147975
     C           *IN87     ANDEQ*OFF                                      147975
      *                                                                   147975
     C           SMCY      IFNE TCCY
     C           SLDT      ANDGEBJRDNB                                    155644
      *
      ** Output details to report.
      *
     C                     MOVELPREF      RPREF
     C                     MOVELPYTP      RPYTP
     C                     MOVELPYST      RPYST
     C                     MOVELSMCY      RTRCCY
     C                     MOVE RCCO#     RRSAN
     C                     MOVELTCCY      RACCY
      *
     C                     EXSR WP1REC
     C           #CHKLN    IFEQ 'Y'
     C                     WRITEINPYSUB
     C                     ENDIF
      *
     C                     WRITEINPYDTL
      *
     C                     ADD  1         R5CTR
     C                     ENDIF
      *                                                                   147975
     C                     ENDIF                                          147975
      *                                                                   147975
     C                     ENDIF
      *                                                                   CFT014
      ** If 3rd Reimbursement is Retail number.                           CFT014
      *                                                                   CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
      *                                                                   CFT014
     C                     MOVE *BLANKS   P10                             CFT014
     C                     MOVE *BLANKS   P11                             CFT014
     C                     MOVELINTRIB    P10                             CFT014
     C                     MOVELINTRIB    P11                             CFT014
     C                     MOVE P11       P01                             CFT014
     C                     MOVE P10       P02                             CFT014
      *                                                                   CFT014
     C           P01       IFEQ *BLANKS                                   CFT014
     C           P02       ANDNE*BLANKS                                   CFT014
     C           INTRIT    ANDEQ'R'                                       CFT014
      *                                                                   CFT014
     C                     MOVE P10       K#RAN1                          CFT014
     C                     MOVEL#ATP,13   RACTP                                               239481
     C                     EXSR SRACCT                                    CFT014
      *                                                                   CFT014
     C           RECI      IFNE 'C'                                       CFT014
     C           *IN87     ANDEQ*OFF                                      CFT014
      *                                                                   CFT014
     C           SMCY      IFNE TCCY                                      CFT014
      *                                                                   CFT014
      ** Output details to report.                                        CFT014
      *                                                                   CFT014
     C                     MOVELPREF      RPREF                           CFT014
     C                     MOVELPYTP      RPYTP                           CFT014
     C                     MOVELPYST      RPYST                           CFT014
     C                     MOVELSMCY      RTRCCY                          CFT014
     C                     MOVE P10       RRSAN                           CFT014
     C                     MOVELTCCY      RACCY                           CFT014
      *                                                                   CFT014
     C                     EXSR WP1REC                                    CFT014
     C           #CHKLN    IFEQ 'Y'                                       CFT014
     C                     WRITEINPYSUB                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     WRITEINPYDTL                                   CFT014
      *                                                                   CFT014
     C                     ADD  1         R5CTR                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *
      ** Beneficiary
      *
     C                     MOVE *BLANKS   P10
     C                     MOVE *BLANKS   P11
      *
     C                     MOVELBNC1      P10
     C                     MOVELBNC1      P11
     C                     MOVE P11       P01
     C                     MOVE P10       P02
     C           P01       IFEQ *BLANKS
     C           P02       ANDNE*BLANKS
     C           BNCT      ANDEQ'R'                                       144999
     C                     MOVE P10       K#RAN1
     C                     MOVEL#ATP,14   RACTP                                               239481
     C                     EXSR SRACCT
      *
     C           RECI      IFNE 'C'                                       147975
     C           *IN87     ANDEQ*OFF                                      147975
      *                                                                   147975
     C           PCCY      IFNE TCCY
     C/COPY WNCPYSRC,EU0190C011
      *
      ** Output details to report.
      *
     C                     MOVELPREF      RPREF
     C                     MOVELPYTP      RPYTP
     C                     MOVELPYST      RPYST
     C                     MOVELPCCY      RTRCCY
     C                     MOVE P10       RRSAN
     C                     MOVELTCCY      RACCY
      *
     C                     EXSR WP1REC
     C           #CHKLN    IFEQ 'Y'
     C                     WRITEINPYSUB
     C                     ENDIF
      *
     C                     WRITEINPYDTL
      *
     C                     ADD  1         R5CTR
     C/COPY WNCPYSRC,EU0190C012
     C                     ENDIF
      *                                                                   147975
     C                     ENDIF                                          147975
      *
     C                     ELSE
     C                     MOVE *BLANKS   P10
     C                     MOVE *BLANKS   P11
      *
     C                     MOVELACBK      P10
     C                     MOVELACBK      P11
     C                     MOVE P11       P01
     C                     MOVE P10       P02
     C           P01       IFEQ *BLANKS
     C           P02       ANDNE*BLANKS
     C           ACBT      ANDEQ'R'                                       144999
     C                     MOVE P10       K#RAN1
     C                     MOVEL#ATP,15   RACTP                                               239481
     C                     EXSR SRACCT
      *
     C           RECI      IFNE 'C'                                       147975
     C           *IN87     ANDEQ*OFF                                      147975
      *                                                                   147975
     C           PCCY      IFNE TCCY
     C/COPY WNCPYSRC,EU0190C013
      *
      ** Output details to report.
      *
     C                     MOVELPREF      RPREF
     C                     MOVELPYTP      RPYTP
     C                     MOVELPYST      RPYST
     C                     MOVELPCCY      RTRCCY
     C                     MOVE P10       RRSAN
     C                     MOVELTCCY      RACCY
      *
     C                     EXSR WP1REC
     C           #CHKLN    IFEQ 'Y'
     C                     WRITEINPYSUB
     C                     ENDIF
      *
     C                     WRITEINPYDTL
      *
     C                     ADD  1         R5CTR
     C/COPY WNCPYSRC,EU0190C014
     C                     ENDIF
      *                                                                   147975
     C                     ENDIF                                          147975
      *                                                                   147975
     C                     ENDIF
      *
     C                     ENDIF
     C/COPY WNCPYSRC,EU0190C015
      *
     C                     ENDIF                           * RECI *
     C/COPY WNCPYSRC,EU0190C018
      *
     C                     READ INPAY                    73
     C                     ENDDO
      *
     C                     Z-ADDR5CTR     RCOUNT
     C           RCOUNT    IFEQ 0
      * Print No details.
     C                     WRITENODTLS
     C                     ENDIF
      *
      ** Do Audit report processing.
      *
     C                     MOVEL'INPAY'   FNAME
     C                     EXSR SRAUDT
      *
     C                     ENDSR
      *
      *****************************************************************
      /TITLE SR/SRCQCD
      *****************************************************************
      *                                                               *
      *  SRCQCD - Subroutine to do the Detail Processing FT Checks    *
      *           for collection records.                             *
      *                                                               *
      *****************************************************************
      *
     C           SRCQCD    BEGSR                           *** SRCQCD ***
      *
      ***  Read first record from File.
      *
     C                     READ CQCOD                    74
      *
      ***  Print header of record format.
      *
     C                     MOVEL#RPN,6    REPNAM
     C                     WRITEHEADPY
     C                     WRITECQCDSUB
      *
     C                     Z-ADD0         R6CTR   20
      *
      ***  Do WHILE not end of file.
      *
     C           *IN74     DOWEQ*OFF
      *
     C***********RECI      IFNE 'M'                        * RECI *       145805
     C***********RECI      ANDNE'*'                                       145805
     C           RECI      IFEQ 'D'                                       145805
      *
      ** If Collecting Bank is Retail no.
      ** and receiver's correspondent is is blank                         160164
      *
     C           RCCO      IFEQ *ZERO                                     160164
     C                     MOVE *BLANKS   P10
     C                     MOVE *BLANKS   P11
      *
     C                     MOVELCOB1      P10
     C                     MOVELCOB1      P11
     C                     MOVE P11       P01
     C                     MOVE P10       P02
     C           P01       IFEQ *BLANKS
     C           P02       ANDNE*BLANKS
     C           COBT      ANDEQ'R'                                       145805
     C                     MOVE P10       K#RAN1
     C                     MOVEL#ATP,16   RACTP                                               239481
     C                     EXSR SRACCT
      *
     C           RECI      IFNE 'C'                                       147975
     C           *IN87     ANDEQ*OFF                                      147975
      *                                                                   147975
     C           SMCY      IFNE TCCY
      *
      ** Output details to report.
      *
     C                     MOVELPREF      RPREF
     C                     MOVELCQSQ      RCQSQ
     C                     MOVELPYTP      RPYTP
     C                     MOVELPYST      RPYST
     C                     MOVELSMCY      RTRCCY
     C                     MOVE P10       RRSAN
     C                     MOVELTCCY      RACCY
      *
     C                     EXSR WP1REC
     C           #CHKLN    IFEQ 'Y'
     C                     WRITECQCDSUB
     C                     ENDIF
      *
     C                     WRITECQCDDTL
      *
     C                     ADD  1         R6CTR
     C                     ENDIF
      *                                                                   147975
     C                     ENDIF                                          147975
      *                                                                   147975
     C                     ENDIF
     C                     ENDIF                                          160164
      *
      ** Reciever's Correspondent.
      *
     C           RCCO      IFNE *ZERO
     C           RCRT      ANDEQ'R'                                       145805
     C                     MOVE RCCO      RCCO#
     C                     MOVE RCCO      K#RAN1
     C                     MOVEL#ATP,12   RACTP                                               239481
     C                     EXSR SRACCT
      *
     C           RECI      IFNE 'C'                                       147975
     C           *IN87     ANDEQ*OFF                                      147975
      *                                                                   147975
     C***********SMCY      IFEQ TCCY                                      145805
     C           SMCY      IFNE TCCY                                      145805
      *
      ** Output details to report.
      *
     C                     MOVELPREF      RPREF
     C                     MOVELCQSQ      RCQSQ
     C                     MOVELPYTP      RPYTP
     C                     MOVELPYST      RPYST
     C                     MOVELSMCY      RTRCCY
     C                     MOVE RCCO#     RRSAN
     C                     MOVELTCCY      RACCY
      *
     C                     EXSR WP1REC
     C           #CHKLN    IFEQ 'Y'
     C                     WRITECQCDSUB
     C                     ENDIF
      *
     C                     WRITECQCDDTL
      *
     C                     ADD  1         R6CTR
     C                     ENDIF
      *                                                                   147975
     C                     ENDIF                                          147975
      *                                                                   147975
     C                     ENDIF
      *
      ** Credit Party.
      *
     C                     MOVE *BLANKS   P10
     C                     MOVE *BLANKS   P11
      *
     C                     MOVELCRPY      P10
     C                     MOVELCRPY      P11
     C                     MOVE P11       P01
     C                     MOVE P10       P02
     C           P01       IFEQ *BLANKS
     C           P02       ANDNE*BLANKS
     C           CRPT      ANDEQ'R'                                       145805
     C                     MOVE P10       K#RAN1
     C                     MOVEL#ATP,17   RACTP                                               239481
     C                     EXSR SRACCT
      *
     C           RECI      IFNE 'C'                                       147975
     C           *IN87     ANDEQ*OFF                                      147975
      *                                                                   147975
     C***********CRCY      IFEQ TCCY                                      145805
     C           CRCY      IFNE TCCY                                      145805
      *
      ** Output details to report.
      *
     C                     MOVELPREF      RPREF
     C                     MOVELCQSQ      RCQSQ
     C                     MOVELPYTP      RPYTP
     C                     MOVELPYST      RPYST
     C                     MOVELCRCY      RTRCCY
     C                     MOVE P10       RRSAN
     C                     MOVELTCCY      RACCY
      *
     C                     EXSR WP1REC
     C           #CHKLN    IFEQ 'Y'
     C                     WRITECQCDSUB
     C                     ENDIF
      *
     C                     WRITECQCDDTL
      *
     C                     ADD  1         R6CTR
     C                     ENDIF
      *                                                                   147975
     C                     ENDIF                                          147975
      *                                                                   147975
     C                     ENDIF
      *
     C                     ENDIF                           * RECI *
      *
     C                     READ CQCOD                    74
     C                     ENDDO
      *
     C                     Z-ADDR6CTR     RCOUNT
     C           RCOUNT    IFEQ 0
      * Print No details.
     C                     WRITENODTLS
     C                     ENDIF
      *
      ** Do Audit report processing.
      *
     C                     MOVEL'CQCOD'   FNAME
     C                     EXSR SRAUDT
      *
     C                     ENDSR
      *
      *****************************************************************
      /TITLE SR/SRCQPC
      *****************************************************************
      *                                                               *
      *  SRCQPC - Subroutine to do the Detail Processing for Checks   *
      *           to be paid records.                                 *
      *                                                               *
      *****************************************************************
      *
     C           SRCQPC    BEGSR                           *** SRCQPC ***
      *
      ***  Read first record from File.
      *
     C                     READ CQPAC                    75
      *
      ***  Print header of record format.
      *
     C                     MOVEL#RPN,7    REPNAM
     C                     WRITEHEADPY
     C                     WRITECQPCSUB
      *
     C                     Z-ADD0         R7CTR   20
      *
      ***  Do WHILE not end of file.
      *
     C           *IN75     DOWEQ*OFF
      *
     C***********RECI      IFNE 'M'                        * RECI *       145805
     C***********RECI      ANDNE'*'                                       145805
     C           RECI      IFEQ 'D'                                       145805
      *
      ** If Remitting Bank is Retail no.
      ** and sender's correspondent is blank                              160164
      *
     C           SNCO      IFEQ *ZERO                                     160164
     C                     MOVE *BLANKS   P10
     C                     MOVE *BLANKS   P11
      *
     C                     MOVELRBK1      P10
     C                     MOVELRBK1      P11
     C                     MOVE P11       P01
     C                     MOVE P10       P02
     C           P01       IFEQ *BLANKS
     C           P02       ANDNE*BLANKS
     C           RBKT      ANDEQ'R'                                       145805
     C                     MOVE P10       K#RAN1
     C                     MOVEL#ATP,18   RACTP                                               239481
     C                     EXSR SRACCT
      *
     C           RECI      IFNE 'C'                                       147975
     C           *IN87     ANDEQ*OFF                                      147975
      *                                                                   147975
     C           PCCY      IFNE TCCY
      *
      ** Output details to report.
      *
     C                     MOVELPREF      RPREF
     C                     MOVELCQSQ      RCQSQ
     C                     MOVELPYTP      RPYTP
     C                     MOVELPYST      RPYST
     C                     MOVELPCCY      RTRCCY
     C                     MOVE P10       RRSAN
     C                     MOVELTCCY      RACCY
      *
     C                     EXSR WP1REC
     C           #CHKLN    IFEQ 'Y'
     C                     WRITECQPCSUB
     C                     ENDIF
      *
     C                     WRITECQPCDTL
      *
     C                     ADD  1         R7CTR
     C                     ENDIF
      *                                                                   147975
     C                     ENDIF                                          147975
      *                                                                   147975
     C                     ENDIF
     C                     ENDIF                                          160164
      *
      ** Sender's Correspondent.
      *
     C           SNCO      IFNE *ZERO
     C           SNCT      ANDEQ'R'                                       145805
     C                     MOVE SNCO      SNCO#
     C                     MOVE SNCO      K#RAN1
     C                     MOVEL#ATP,8    RACTP                                               239481
     C                     EXSR SRACCT
      *
     C           RECI      IFNE 'C'                                       147975
     C           *IN87     ANDEQ*OFF                                      147975
      *                                                                   147975
     C           PCCY      IFNE TCCY
      *
      ** Output details to report.
      *
     C                     MOVELPREF      RPREF
     C                     MOVELCQSQ      RCQSQ
     C                     MOVELPYTP      RPYTP
     C                     MOVELPYST      RPYST
     C                     MOVELPCCY      RTRCCY
     C                     MOVE SNCO#     RRSAN
     C                     MOVELTCCY      RACCY
      *
     C                     EXSR WP1REC
     C           #CHKLN    IFEQ 'Y'
     C                     WRITECQPCSUB
     C                     ENDIF
      *
     C                     WRITECQPCDTL
      *
     C                     ADD  1         R7CTR
     C                     ENDIF
      *                                                                   147975
     C                     ENDIF                                          147975
      *                                                                   147975
     C                     ENDIF
      *
      ** Debit Party.
      *
     C                     MOVE *BLANKS   P10
     C                     MOVE *BLANKS   P11
      *
     C                     MOVELDRPY      P10
     C                     MOVELDRPY      P11
     C                     MOVE P11       P01
     C                     MOVE P10       P02
     C           P01       IFEQ *BLANKS
     C           P02       ANDNE*BLANKS
     C           DRPT      ANDEQ'R'                                       145805
     C                     MOVE P10       K#RAN1
     C                     MOVEL#ATP,19   RACTP                                               239481
     C                     EXSR SRACCT
      *
     C           RECI      IFNE 'C'                                       147975
     C           *IN87     ANDEQ*OFF                                      147975
      *                                                                   147975
     C           DRCY      IFNE TCCY
      *
      ** Output details to report.
      *
     C                     MOVELPREF      RPREF
     C                     MOVELCQSQ      RCQSQ
     C                     MOVELPYTP      RPYTP
     C                     MOVELPYST      RPYST
     C                     MOVELDRCY      RTRCCY
     C                     MOVE P10       RRSAN
     C                     MOVELTCCY      RACCY
      *
     C                     EXSR WP1REC
     C           #CHKLN    IFEQ 'Y'
     C                     WRITECQPCSUB
     C                     ENDIF
      *
     C                     WRITECQPCDTL
      *
     C                     ADD  1         R7CTR
     C                     ENDIF
      *                                                                   147975
     C                     ENDIF                                          147975
      *                                                                   147975
     C                     ENDIF
      *
     C                     ENDIF                           * RECI *
      *
     C                     READ CQPAC                    75
     C                     ENDDO
      *
     C                     Z-ADDR7CTR     RCOUNT
     C           RCOUNT    IFEQ 0
      * Print No details.
     C                     WRITENODTLS
     C                     ENDIF
      *
      ** Do Audit report processing.
      *
     C                     MOVEL'CQPAC'   FNAME
     C                     EXSR SRAUDT
      *
     C                     ENDSR
      *
      *****************************************************************
      /TITLE SR/SRLOAN
      *****************************************************************
      *                                                               *
      *  SRLOAN - Subroutine to do the Detail Processing for Loan     *
      *           records.                                            *
      *                                                               *
      *****************************************************************
      *
     C           SRLOAN    BEGSR                           *** SRLOAN ***
      *
      ***  Read first record from File.
      *
     C                     READ CLOANLB                  76
      *
      ***  Print header of record format.
      *
     C                     MOVEL#RPN,8    REPNAM
     C                     WRITEHEADPY
     C                     WRITELOANSUB
      *
     C                     Z-ADD0         R8CTR   20
      *
      ***  Do WHILE not end of file.
      *
     C           *IN76     DOWEQ*OFF
      *
     C           RECI      IFNE '*'                        * RECI *
     C           RECI      ANDNE'R'
     C           RECI      ANDNE'M'
      *
     C                     MOVELCCY       #CCY    3
      *
      ** Start Date.
      *
     C           SDST      IFEQ 14
     C           CLE031    ANDNE'Y'                                       CLE031
      *                                                                   147975
      ** Only retail accounts are to be processed for eventual            147975
      ** reporting .                                                      147975
      *                                                                   147975
     C           OSDA      IFNE *ZERO                                     147975
     C                     MOVELOSDA      K#RAN1
     C                     MOVEL#ATP,1    RACTP                                               239481
     C                     EXSR SRACCT
      *
     C           RECI      IFNE 'C'                                       147975
     C           *IN87     ANDEQ*OFF                                      147975
      *                                                                   147975
     C           SCCY      IFNE *BLANKS
     C           SCCY      IFNE TCCY
      *
      ** Output details to report.
      *
     C                     MOVELLNRF      RLNRF
     C                     MOVELLTYP      RLTYP
     C                     MOVELSUTP      RSUTP
     C                     MOVELFTYP      RFTYP
     C                     MOVELFSEQ      RFSEQ
      *
      ***  Convert date to DDMMMYY format
      *
     C                     MOVE DDAT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    RDDAT
      *
     C                     MOVELSCCY      RTRCCY
     C                     MOVELOSDA      RRSAN
     C                     MOVELTCCY      RACCY
      *
     C                     EXSR WP1REC
     C           #CHKLN    IFEQ 'Y'
     C                     WRITELOANSUB
     C                     ENDIF
      *
     C                     WRITELOANDTL
      *
     C                     ADD  1         R8CTR
     C                     ENDIF
      *
     C                     ELSE
     C           #CCY      IFNE TCCY
      * If settlement ccy blank, loan ccy is different from account       178704
      *  ccy, and start date postings have not yet been done...           178704
     C           VDAT      ANDGEBJRDNB                                    178704
     C           #CCY      ORNE TCCY                                      178704
     C           ORED      ANDEQBJRDNB                                    178704
      *
      ** Output details to report.
      *
     C                     MOVELLNRF      RLNRF
     C                     MOVELLTYP      RLTYP
     C                     MOVELSUTP      RSUTP
     C                     MOVELFTYP      RFTYP
     C                     MOVELFSEQ      RFSEQ
      *
      ***  Convert date to DDMMMYY format
      *
     C                     MOVE DDAT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    RDDAT
      *
     C                     MOVEL#CCY      RTRCCY
     C                     MOVELOSDA      RRSAN
     C                     MOVELTCCY      RACCY
      *
     C                     EXSR WP1REC
     C           #CHKLN    IFEQ 'Y'
     C                     WRITELOANSUB
     C                     ENDIF
      *
     C                     WRITELOANDTL
      *
     C                     ADD  1         R8CTR
     C                     ENDIF
     C                     ENDIF
      *                                                                   147975
     C                     ENDIF                                          147975
      *                                                                   147975
     C                     ENDIF                                          147975
      *
     C                     ENDIF
      *
      ** Maturity Date.
      *
     C           MDST      IFEQ 14
     C           CLE031    ANDNE'Y'                                       CLE031
      *                                                                   147975
      ** Only retail accounts are to be processed for eventual            147975
      ** reporting .                                                      147975
      *                                                                   147975
     C           OMDA      IFNE *ZERO                                     147975
     C                     MOVELOMDA      K#RAN1
     C                     MOVEL#ATP,2    RACTP                                               239481
     C                     EXSR SRACCT
      *
     C           RECI      IFNE 'C'                                       147975
     C           *IN87     ANDEQ*OFF                                      147975
      *                                                                   147975
     C           SCCY      IFNE *BLANKS
     C           SCCY      IFNE TCCY
      *
      ** Output details to report.
      *
     C                     MOVELLNRF      RLNRF
     C                     MOVELLTYP      RLTYP
     C                     MOVELSUTP      RSUTP
     C                     MOVELFTYP      RFTYP
     C                     MOVELFSEQ      RFSEQ
      *
      ***  Convert date to DDMMMYY format
      *
     C                     MOVE DDAT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    RDDAT
      *
     C                     MOVELSCCY      RTRCCY
     C                     MOVELOMDA      RRSAN
     C                     MOVELTCCY      RACCY
      *
     C                     EXSR WP1REC
     C           #CHKLN    IFEQ 'Y'
     C                     WRITELOANSUB
     C                     ENDIF
      *
     C                     WRITELOANDTL
      *
     C                     ADD  1         R8CTR
     C                     ENDIF
      *
     C                     ELSE
     C           #CCY      IFNE TCCY
      *
      ** Output details to report.
      *
     C                     MOVELLNRF      RLNRF
     C                     MOVELLTYP      RLTYP
     C                     MOVELSUTP      RSUTP
     C                     MOVELFTYP      RFTYP
     C                     MOVELFSEQ      RFSEQ
      *
      ***  Convert date to DDMMMYY format
      *
     C                     MOVE DDAT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    RDDAT
      *
     C                     MOVEL#CCY      RTRCCY
     C                     MOVELOMDA      RRSAN
     C                     MOVELTCCY      RACCY
      *
     C                     EXSR WP1REC
     C           #CHKLN    IFEQ 'Y'
     C                     WRITELOANSUB
     C                     ENDIF
      *
     C                     WRITELOANDTL
      *
     C                     ADD  1         R8CTR
     C                     ENDIF
     C                     ENDIF
      *                                                                   147975
     C                     ENDIF                                          147975
      *                                                                   147975
     C                     ENDIF                                          147975
      *
     C                     ENDIF
      *
      ** Receipt Settlement Method.
      *
     C           RSTM      IFEQ 14
      *                                                                   147975
      ** Only retail accounts are to be processed for eventual            147975
      ** reporting .                                                      147975
      *                                                                   147975
     C           RONS      IFNE *ZERO                                     147975
     C                     MOVELRONS      K#RAN1
     C                     MOVEL#ATP,3    RACTP                                               239481
     C                     EXSR SRACCT
      *
     C           RECI      IFNE 'C'                                       147975
     C           *IN87     ANDEQ*OFF                                      147975
      *                                                                   147975
     C           SCCY      IFNE *BLANKS
     C           SCCY      IFNE TCCY
      *
      ** Output details to report.
      *
     C                     MOVELLNRF      RLNRF
     C                     MOVELLTYP      RLTYP
     C                     MOVELSUTP      RSUTP
     C                     MOVELFTYP      RFTYP
     C                     MOVELFSEQ      RFSEQ
      *
      ***  Convert date to DDMMMYY format
      *
     C                     MOVE DDAT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    RDDAT
      *
     C                     MOVELSCCY      RTRCCY
     C                     MOVELRONS      RRSAN
     C                     MOVELTCCY      RACCY
      *
     C                     EXSR WP1REC
     C           #CHKLN    IFEQ 'Y'
     C                     WRITELOANSUB
     C                     ENDIF
      *
     C                     WRITELOANDTL
      *
     C                     ADD  1         R8CTR
     C                     ENDIF
      *
     C                     ELSE
     C           #CCY      IFNE TCCY
      *
      ** Output details to report.
      *
     C                     MOVELLNRF      RLNRF
     C                     MOVELLTYP      RLTYP
     C                     MOVELSUTP      RSUTP
     C                     MOVELFTYP      RFTYP
     C                     MOVELFSEQ      RFSEQ
      *
      ***  Convert date to DDMMMYY format
      *
     C                     MOVE DDAT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    RDDAT
      *
     C                     MOVEL#CCY      RTRCCY
     C                     MOVELRONS      RRSAN
     C                     MOVELTCCY      RACCY
      *
     C                     EXSR WP1REC
     C           #CHKLN    IFEQ 'Y'
     C                     WRITELOANSUB
     C                     ENDIF
      *
     C                     WRITELOANDTL
      *
     C                     ADD  1         R8CTR
     C                     ENDIF
     C                     ENDIF
      *                                                                   147975
     C                     ENDIF                                          147975
      *                                                                   147975
     C                     ENDIF                                          147975
      *
     C                     ENDIF
      *
      ** Payment Settlement Method.
      *
     C           PSTM      IFEQ 14
      *                                                                   147975
      ** Only retail accounts are to be processed for eventual            147975
      ** reporting .                                                      147975
      *                                                                   147975
     C           PONS      IFNE *ZERO                                     147975
     C                     MOVELPONS      K#RAN1
     C                     MOVEL#ATP,4    RACTP                                               239481
     C                     EXSR SRACCT
      *
     C           RECI      IFNE 'C'                                       147975
     C           *IN87     ANDEQ*OFF                                      147975
      *                                                                   147975
     C           CLE031    IFNE 'Y'                                       CLE031
     C           SCCY      IFNE *BLANKS
     C           SCCY      IFNE TCCY
      *
      ** Output details to report.
      *
     C                     MOVELLNRF      RLNRF
     C                     MOVELLTYP      RLTYP
     C                     MOVELSUTP      RSUTP
     C                     MOVELFTYP      RFTYP
     C                     MOVELFSEQ      RFSEQ
      *
      ***  Convert date to DDMMMYY format
      *
     C                     MOVE DDAT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    RDDAT
      *
     C                     MOVELSCCY      RTRCCY
     C                     MOVELPONS      RRSAN
     C                     MOVELTCCY      RACCY
      *
     C                     EXSR WP1REC
     C           #CHKLN    IFEQ 'Y'
     C                     WRITELOANSUB
     C                     ENDIF
      *
     C                     WRITELOANDTL
      *
     C                     ADD  1         R8CTR
     C                     ENDIF
      *
     C                     ELSE
     C           #CCY      IFNE TCCY
      * If settlement ccy blank, loan ccy is different from account       178704
      *  ccy, and start date postings have not yet been done...           178704
     C           VDAT      ANDGEBJRDNB                                    178704
     C           #CCY      ORNE TCCY                                      178704
     C           ORED      ANDEQBJRDNB                                    178704
      *
      ** Output details to report.
      *
     C                     MOVELLNRF      RLNRF
     C                     MOVELLTYP      RLTYP
     C                     MOVELSUTP      RSUTP
     C                     MOVELFTYP      RFTYP
     C                     MOVELFSEQ      RFSEQ
      *
      ***  Convert date to DDMMMYY format
      *
     C                     MOVE DDAT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    RDDAT
      *
     C                     MOVEL#CCY      RTRCCY
     C                     MOVELPONS      RRSAN
     C                     MOVELTCCY      RACCY
      *
     C                     EXSR WP1REC
     C           #CHKLN    IFEQ 'Y'
     C                     WRITELOANSUB
     C                     ENDIF
      *
     C                     WRITELOANDTL
      *
     C                     ADD  1         R8CTR
     C                     ENDIF
     C                     ENDIF
      *                                                                   CLE031
      ** Else if CLE031 is on then check the pay settlement ccy           CLE031
      *                                                                   CLE031
     C                     ELSE                                           CLE031
      *                                                                   CLE031
     C           PSCY      IFNE *BLANKS                                   CLE031
     C           PSCY      IFNE TCCY                                      CLE031
      *                                                                   CLE031
      ** Output details to report.                                        CLE031
      *                                                                   CLE031
     C                     MOVELLNRF      RLNRF                           CLE031
     C                     MOVELLTYP      RLTYP                           CLE031
     C                     MOVELSUTP      RSUTP                           CLE031
     C                     MOVELFTYP      RFTYP                           CLE031
     C                     MOVELFSEQ      RFSEQ                           CLE031
      *                                                                   CLE031
      ***  Convert date to DDMMMYY format                                 CLE031
      *                                                                   CLE031
     C                     MOVE DDAT      ZDAYNO                          CLE031
     C                     EXSR ZDATE2                                    CLE031
     C                     MOVE ZADATE    RDDAT                           CLE031
      *                                                                   CLE031
     C                     MOVELPSCY      RTRCCY                          CLE031
     C                     MOVELPONS      RRSAN                           CLE031
     C                     MOVELTCCY      RACCY                           CLE031
      *                                                                   CLE031
     C                     EXSR WP1REC                                    CLE031
     C           #CHKLN    IFEQ 'Y'                                       CLE031
     C                     WRITELOANSUB                                   CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
     C                     WRITELOANDTL                                   CLE031
      *                                                                   CLE031
     C                     ADD  1         R8CTR                           CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
     C                     ELSE                                           CLE031
     C           #CCY      IFNE TCCY                                      CLE031
      * If settlement ccy blank, loan ccy is different from account       CLE031
      *  ccy, and start date postings have not yet been done...           CLE031
     C           VDAT      ANDGEBJRDNB                                    CLE031
     C           #CCY      ORNE TCCY                                      CLE031
     C           ORED      ANDEQBJRDNB                                    CLE031
      *                                                                   CLE031
      ** Output details to report.                                        CLE031
      *                                                                   CLE031
     C                     MOVELLNRF      RLNRF                           CLE031
     C                     MOVELLTYP      RLTYP                           CLE031
     C                     MOVELSUTP      RSUTP                           CLE031
     C                     MOVELFTYP      RFTYP                           CLE031
     C                     MOVELFSEQ      RFSEQ                           CLE031
      *                                                                   CLE031
      ***  Convert date to DDMMMYY format                                 CLE031
      *                                                                   CLE031
     C                     MOVE DDAT      ZDAYNO                          CLE031
     C                     EXSR ZDATE2                                    CLE031
     C                     MOVE ZADATE    RDDAT                           CLE031
      *                                                                   CLE031
     C                     MOVEL#CCY      RTRCCY                          CLE031
     C                     MOVELPONS      RRSAN                           CLE031
     C                     MOVELTCCY      RACCY                           CLE031
      *                                                                   CLE031
     C                     EXSR WP1REC                                    CLE031
     C           #CHKLN    IFEQ 'Y'                                       CLE031
     C                     WRITELOANSUB                                   CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
     C                     WRITELOANDTL                                   CLE031
      *                                                                   CLE031
     C                     ADD  1         R8CTR                           CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
     C                     ENDIF                                          CLE031
     C                     ENDIF                                          CLE031
      *                                                                   147975
     C                     ENDIF                                          147975
      *                                                                   147975
     C                     ENDIF                                          147975
      *
     C                     ENDIF
      *
      ** Chain to CLOAN  for extended details.
      *
     C           LNRF      CHAINCLOAN                46
      *
     C           *IN46     IFEQ *OFF
     C           NCCY      IFNE *BLANK                                    156926
     C                     MOVELNCCY      #CCY2                           156926
     C                     ELSE                                           156926
     C                     MOVELCCY       #CCY2   3
     C                     ENDIF                                          156926
     C           RRST      IFEQ 14
      *                                                                   147975
      ** Only retail accounts are to be processed for eventual            147975
      ** reporting .                                                      147975
      *                                                                   147975
     C           RRON      IFNE *ZERO                                     147975
     C                     MOVELRRON      K#RAN1
     C                     MOVEL#ATP,25   RACTP                                               239481
     C                     EXSR SRACCT
      *
     C           RECI      IFNE 'C'                                       147975
     C           *IN87     ANDEQ*OFF                                      147975
      *                                                                   147975
     C           RRSC      IFNE *BLANKS
     C           RRSC      IFNE TCCY
      *
      ** Output details to report.
      *
     C                     MOVELLNRF      RLNRF
     C                     MOVELLTYP      RLTYP
     C                     MOVELSUTP      RSUTP
     C                     MOVELFTYP      RFTYP
     C                     MOVELFSEQ      RFSEQ
      *
      ***  Convert date to DDMMMYY format
      *
     C                     MOVE DDAT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    RDDAT
      *
     C                     MOVELRRSC      RTRCCY
     C                     MOVELRRON      RRSAN
     C                     MOVELTCCY      RACCY
      *
     C                     EXSR WP1REC
     C           #CHKLN    IFEQ 'Y'
     C                     WRITELOANSUB
     C                     ENDIF
      *
     C                     WRITELOANDTL
      *
     C                     ADD  1         R8CTR
     C                     ENDIF
      *
     C                     ELSE
     C           NCCY      IFNE *BLANKS
     C           NCCY      ANDNETCCY
      *
      ** Output details to report.
      *
     C                     MOVELLNRF      RLNRF
     C                     MOVELLTYP      RLTYP
     C                     MOVELSUTP      RSUTP
     C                     MOVELFTYP      RFTYP
     C                     MOVELFSEQ      RFSEQ
      *
      ***  Convert date to DDMMMYY format
      *
     C                     MOVE DDAT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    RDDAT
      *
     C                     MOVELNCCY      RTRCCY
     C                     MOVELRRON      RRSAN
     C                     MOVELTCCY      RACCY
      *
     C                     EXSR WP1REC
     C           #CHKLN    IFEQ 'Y'
     C                     WRITELOANSUB
     C                     ENDIF
      *
     C                     WRITELOANDTL
      *
     C                     ADD  1         R8CTR
     C                     ELSE
     C           #CCY2     IFNE TCCY
      *
      ** Output details to report.
      *
     C                     MOVELLNRF      RLNRF
     C                     MOVELLTYP      RLTYP
     C                     MOVELSUTP      RSUTP
     C                     MOVELFTYP      RFTYP
     C                     MOVELFSEQ      RFSEQ
      *
      ***  Convert date to DDMMMYY format
      *
     C                     MOVE DDAT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    RDDAT
      *
     C                     MOVEL#CCY2     RTRCCY
     C                     MOVELRRON      RRSAN
     C                     MOVELTCCY      RACCY
      *
     C                     EXSR WP1REC
     C           #CHKLN    IFEQ 'Y'
     C                     WRITELOANSUB
     C                     ENDIF
      *
     C                     WRITELOANDTL
      *
     C                     ADD  1         R8CTR
     C                     ENDIF
     C                     ENDIF
      *
     C                     ENDIF
      *                                                                   147975
     C                     ENDIF                                          147975
      *                                                                   147975
     C                     ENDIF                                          147975
      *
     C                     ENDIF
     C                     ENDIF
      *
      ** Pay Settlement Method = '14'.
      *
     C           RPST      IFEQ 14
      *                                                                   147975
      ** Only retail accounts are to be processed for eventual            147975
      ** reporting .                                                      147975
      *                                                                   147975
     C           RPON      IFNE *ZERO                                     147975
     C                     MOVELRPON      K#RAN1
     C                     MOVEL#ATP,20   RACTP                                               239481
     C                     EXSR SRACCT
      *
     C           RECI      IFNE 'C'                                       147975
     C           *IN87     ANDEQ*OFF                                      147975
      *                                                                   147975
     C           RPSC      IFNE *BLANKS
     C           RPSC      IFNE TCCY
      *
      ** Output details to report.
      *
     C                     MOVELLNRF      RLNRF
     C                     MOVELLTYP      RLTYP
     C                     MOVELSUTP      RSUTP
     C                     MOVELFTYP      RFTYP
     C                     MOVELFSEQ      RFSEQ
      *
      ***  Convert date to DDMMMYY format
      *
     C                     MOVE DDAT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    RDDAT
      *
     C                     MOVELRPSC      RTRCCY
     C                     MOVELRPON      RRSAN
     C                     MOVELTCCY      RACCY
      *
     C                     EXSR WP1REC
     C           #CHKLN    IFEQ 'Y'
     C                     WRITELOANSUB
     C                     ENDIF
      *
     C                     WRITELOANDTL
      *
     C                     ADD  1         R8CTR
     C                     ENDIF
      *
     C                     ELSE
     C           NCCY      IFNE *BLANKS
     C           NCCY      ANDNETCCY
      *
      ** Output details to report.
      *
     C                     MOVELLNRF      RLNRF
     C                     MOVELLTYP      RLTYP
     C                     MOVELSUTP      RSUTP
     C                     MOVELFTYP      RFTYP
     C                     MOVELFSEQ      RFSEQ
      *
      ***  Convert date to DDMMMYY format
      *
     C                     MOVE DDAT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    RDDAT
      *
     C                     MOVELNCCY      RTRCCY
     C                     MOVELRPON      RRSAN
     C                     MOVELTCCY      RACCY
      *
     C                     EXSR WP1REC
     C           #CHKLN    IFEQ 'Y'
     C                     WRITELOANSUB
     C                     ENDIF
      *
     C                     WRITELOANDTL
      *
     C                     ADD  1         R8CTR
     C                     ELSE
     C           #CCY2     IFNE TCCY
      *
      ** Output details to report.
      *
     C                     MOVELLNRF      RLNRF
     C                     MOVELLTYP      RLTYP
     C                     MOVELSUTP      RSUTP
     C                     MOVELFTYP      RFTYP
     C                     MOVELFSEQ      RFSEQ
      *
      ***  Convert date to DDMMMYY format
      *
     C                     MOVE DDAT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    RDDAT
      *
     C                     MOVEL#CCY2     RTRCCY
     C                     MOVELRPON      RRSAN
     C                     MOVELTCCY      RACCY
      *
     C                     EXSR WP1REC
     C           #CHKLN    IFEQ 'Y'
     C                     WRITELOANSUB
     C                     ENDIF
      *
     C                     WRITELOANDTL
      *
     C                     ADD  1         R8CTR
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
      *                                                                   147975
     C                     ENDIF                                          147975
      *                                                                   147975
     C                     ENDIF                                          147975
      *
     C                     ENDIF
      *
      ** Rollover Settlement Type = '14'.
      *
     C           RDST      IFEQ 14
      *                                                                   147975
      ** Only retail accounts are to be processed for eventual            147975
      ** reporting .                                                      147975
      *                                                                   147975
     C           ORVD      IFNE *ZERO                                     147975
     C                     MOVELORVD      K#RAN1
     C                     MOVEL#ATP,21   RACTP                                               239481
     C                     EXSR SRACCT
      *
     C           RECI      IFNE 'C'                                       147975
     C           *IN87     ANDEQ*OFF                                      147975
      *                                                                   147975
     C           RRSC      IFNE *BLANKS
     C           RRSC      IFNE TCCY
      *
      ** Output details to report.
      *
     C                     MOVELLNRF      RLNRF
     C                     MOVELLTYP      RLTYP
     C                     MOVELSUTP      RSUTP
     C                     MOVELFTYP      RFTYP
     C                     MOVELFSEQ      RFSEQ
      *
      ***  Convert date to DDMMMYY format
      *
     C                     MOVE DDAT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    RDDAT
      *
     C                     MOVELRRSC      RTRCCY
     C                     MOVELORVD      RRSAN
     C                     MOVELTCCY      RACCY
      *
     C                     EXSR WP1REC
     C           #CHKLN    IFEQ 'Y'
     C                     WRITELOANSUB
     C                     ENDIF
      *
     C                     WRITELOANDTL
      *
     C                     ADD  1         R8CTR
     C                     ENDIF
      *
     C                     ELSE
     C           NCCY      IFNE *BLANKS
     C           NCCY      ANDNETCCY
      *
      ** Output details to report.
      *
     C                     MOVELLNRF      RLNRF
     C                     MOVELLTYP      RLTYP
     C                     MOVELSUTP      RSUTP
     C                     MOVELFTYP      RFTYP
     C                     MOVELFSEQ      RFSEQ
      *
      ***  Convert date to DDMMMYY format
      *
     C                     MOVE DDAT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    RDDAT
      *
     C                     MOVELNCCY      RTRCCY
     C                     MOVELORVD      RRSAN
     C                     MOVELTCCY      RACCY
      *
     C                     EXSR WP1REC
     C           #CHKLN    IFEQ 'Y'
     C                     WRITELOANSUB
     C                     ENDIF
      *
     C                     WRITELOANDTL
      *
     C                     ADD  1         R8CTR
     C                     ELSE
     C           #CCY2     IFNE TCCY
      *
      ** Output details to report.
      *
     C                     MOVELLNRF      RLNRF
     C                     MOVELLTYP      RLTYP
     C                     MOVELSUTP      RSUTP
     C                     MOVELFTYP      RFTYP
     C                     MOVELFSEQ      RFSEQ
      *
      ***  Convert date to DDMMMYY format
      *
     C                     MOVE DDAT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    RDDAT
      *
     C                     MOVEL#CCY2     RTRCCY
     C                     MOVELORVD      RRSAN
     C                     MOVELTCCY      RACCY
      *
     C                     EXSR WP1REC
     C           #CHKLN    IFEQ 'Y'
     C                     WRITELOANSUB
     C                     ENDIF
      *
     C                     WRITELOANDTL
      *
     C                     ADD  1         R8CTR
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
      *                                                                   147975
     C                     ENDIF                                          147975
      *                                                                   147975
     C                     ENDIF                                          147975
      *
      ** Rollover Pay Settlement Method = '14'.                           144915
      *                                                                   144915
     C           RPSM      IFEQ 14                                        144915
     C                     MOVELRPOS      K#RAN1                          144915
     C                     MOVEL#ATP,22   RACTP                                               239481
     C                     EXSR SRACCT                                    144915
      *                                                                   144915
     C           RPSC      IFNE *BLANKS                                   144915
     C           RPSC      IFNE TCCY                                      144915
      *                                                                   144915
      ** Output details to report.                                        144915
      *                                                                   144915
     C                     MOVELLNRF      RLNRF                           144915
     C                     MOVELLTYP      RLTYP                           144915
     C                     MOVELSUTP      RSUTP                           144915
     C                     MOVELFTYP      RFTYP                           144915
     C                     MOVELFSEQ      RFSEQ                           144915
      *                                                                   144915
      ***  Convert date to DDMMMYY format                                 144915
      *                                                                   144915
     C                     MOVE DDAT      ZDAYNO                          144915
     C                     EXSR ZDATE2                                    144915
     C                     MOVE ZADATE    RDDAT                           144915
      *                                                                   144915
     C                     MOVELRPSC      RTRCCY                          144915
     C                     MOVELRPOS      RRSAN                           144915
     C                     MOVELTCCY      RACCY                           144915
      *                                                                   144915
     C                     EXSR WP1REC                                    144915
     C           #CHKLN    IFEQ 'Y'                                       144915
     C                     WRITELOANSUB                                   144915
     C                     ENDIF                                          144915
      *                                                                   144915
     C                     WRITELOANDTL                                   144915
      *                                                                   144915
     C                     ADD  1         R8CTR                           144915
     C                     ENDIF                                          144915
      *                                                                   144915
     C                     ELSE                                           144915
     C           NCCY      IFNE *BLANKS                                   144915
     C           NCCY      ANDNETCCY                                      144915
      *                                                                   144915
      ** Output details to report.                                        144915
      *                                                                   144915
     C                     MOVELLNRF      RLNRF                           144915
     C                     MOVELLTYP      RLTYP                           144915
     C                     MOVELSUTP      RSUTP                           144915
     C                     MOVELFTYP      RFTYP                           144915
     C                     MOVELFSEQ      RFSEQ                           144915
      *                                                                   144915
      ***  Convert date to DDMMMYY format                                 144915
      *                                                                   144915
     C                     MOVE DDAT      ZDAYNO                          144915
     C                     EXSR ZDATE2                                    144915
     C                     MOVE ZADATE    RDDAT                           144915
      *                                                                   144915
     C                     MOVELNCCY      RTRCCY                          144915
     C                     MOVELRPOS      RRSAN                           144915
     C                     MOVELTCCY      RACCY                           144915
      *                                                                   144915
     C                     EXSR WP1REC                                    144915
     C           #CHKLN    IFEQ 'Y'                                       144915
     C                     WRITELOANSUB                                   144915
     C                     ENDIF                                          144915
      *                                                                   144915
     C                     WRITELOANDTL                                   144915
      *                                                                   144915
     C                     ADD  1         R8CTR                           144915
     C                     ELSE                                           144915
     C           #CCY2     IFNE TCCY                                      144915
      *                                                                   144915
      ** Output details to report.                                        144915
      *                                                                   144915
     C                     MOVELLNRF      RLNRF                           144915
     C                     MOVELLTYP      RLTYP                           144915
     C                     MOVELSUTP      RSUTP                           144915
     C                     MOVELFTYP      RFTYP                           144915
     C                     MOVELFSEQ      RFSEQ                           144915
      *                                                                   144915
      ***  Convert date to DDMMMYY format                                 144915
      *                                                                   144915
     C                     MOVE DDAT      ZDAYNO                          144915
     C                     EXSR ZDATE2                                    144915
     C                     MOVE ZADATE    RDDAT                           144915
      *                                                                   144915
     C                     MOVEL#CCY2     RTRCCY                          144915
     C                     MOVELRPOS      RRSAN                           144915
     C                     MOVELTCCY      RACCY                           144915
      *                                                                   144915
     C                     EXSR WP1REC                                    144915
     C           #CHKLN    IFEQ 'Y'                                       144915
     C                     WRITELOANSUB                                   144915
     C                     ENDIF                                          144915
      *                                                                   144915
     C                     WRITELOANDTL                                   144915
      *                                                                   144915
     C                     ADD  1         R8CTR                           144915
     C                     ENDIF                                          144915
     C                     ENDIF                                          144915
     C                     ENDIF                                          144915
      *                                                                   144915
     C                     ENDIF                                          144915
      *
     C                     ENDIF
      *
     C                     ENDIF                           * RECI *
      *
      ** Read next record.
     C                     READ CLOANLB                  76
      *
     C                     ENDDO
      *
     C                     Z-ADDR8CTR     RCOUNT
     C           RCOUNT    IFEQ 0
      * Print No details.
     C                     WRITENODTLS
     C                     ENDIF
      *
      ** Do Audit report processing.
      *
     C                     MOVEL'CLOANLB' FNAME
     C                     EXSR SRAUDT
      *
     C                     ENDSR
      *
      *****************************************************************
      /TITLE SR/SRLOAM
      *****************************************************************
      *                                                               *
      *  SRLOAM - Subroutine to do the Detail Processing for Loan     *
      *           Amendment records.                                  *
      *                                                               *
      *****************************************************************
      *
     C           SRLOAM    BEGSR                           *** SRLOAM ***
      *
      ***  Read first record from File.
      *
     C                     READ LOAMS                    77
      *
      ***  Print header of record format.
      *
     C                     MOVEL#RPN,9    REPNAM
     C                     WRITEHEADPY
     C                     WRITELOAMSUB
      *
     C                     Z-ADD0         R9CTR   20
      *
      ***  Do WHILE not end of file.
      *
     C           *IN77     DOWEQ*OFF
      *
     C           RECI      IFNE '*'                        * RECI *
     C           RECI      ANDNE'R'
     C           RECI      ANDNE'M'
     C           AMTP      ANDNE'PD'                                      142373
      *
     C                     MOVELCCY       #CCY3   3
      *
      ** Settlement type = '14'.
      *
     C           SETP      IFEQ 14
      *                                                                   147975
      ** Only retail accounts are to be processed for eventual            147975
      ** reporting .                                                      147975
      *                                                                   147975
     C           OSAC      IFNE *ZERO                                     147975
     C                     MOVELOSAC      K#RAN1
     C                     MOVEL#ATP,23   RACTP                                               239481
     C                     EXSR SRACCT
      *
     C           RECI      IFNE 'C'                                       147975
     C           *IN87     ANDEQ*OFF                                      147975
      *                                                                   147975
     C           SCCY      IFNE *BLANKS
     C           SCCY      IFNE TCCY
      *
      ** Output details to report.
      *
     C                     MOVELLNRF      RLNRF
     C                     MOVELLTYP      RLTYP
     C                     MOVELSUTP      RSUTP
     C                     MOVELAMTP      RAMTP
      *
      ***  Convert date to DDMMMYY format
      *
     C                     MOVE VDAT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    RVDAT
      *
     C                     MOVELLASN      RLASN
     C                     MOVELSCCY      RTRCCY
     C                     MOVELOSAC      RRSAN
     C                     MOVELTCCY      RACCY
      *
     C                     EXSR WP1REC
     C           #CHKLN    IFEQ 'Y'
     C                     WRITELOAMSUB
     C                     ENDIF
      *
     C                     WRITELOAMDTL
      *
     C                     ADD  1         R9CTR
     C                     ENDIF
      *
     C                     ELSE
     C           #CCY3     IFNE TCCY
      *
      ** Output details to report.
      *
     C                     MOVELLNRF      RLNRF
     C                     MOVELLTYP      RLTYP
     C                     MOVELSUTP      RSUTP
     C                     MOVELAMTP      RAMTP
      *
      ***  Convert date to DDMMMYY format
      *
     C                     MOVE VDAT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    RVDAT
      *
     C                     MOVELLASN      RLASN
     C                     MOVEL#CCY3     RTRCCY
     C                     MOVELOSAC      RRSAN
     C                     MOVELTCCY      RACCY
      *
     C                     EXSR WP1REC
     C           #CHKLN    IFEQ 'Y'
     C                     WRITELOAMSUB
     C                     ENDIF
      *
     C                     WRITELOAMDTL
      *
     C                     ADD  1         R9CTR
     C                     ENDIF
     C                     ENDIF
      *                                                                   147975
     C                     ENDIF                                          147975
      *                                                                   147975
     C                     ENDIF                                          147975
      *
     C                     ENDIF
      *
      ** Receipt Settlement method = '14'.
      *
     C           RSTM      IFEQ 14
      *                                                                   147975
      ** Only retail accounts are to be processed for eventual            147975
      ** reporting .                                                      147975
      *                                                                   147975
     C           RONS      IFNE *ZERO                                     147975
     C                     MOVELRONS      K#RAN1
     C                     MOVEL#ATP,3    RACTP                                               239481
     C                     EXSR SRACCT
      *
     C           RECI      IFNE 'C'                                       147975
     C           *IN87     ANDEQ*OFF                                      147975
      *                                                                   147975
     C           SCCY      IFNE *BLANKS
     C           SCCY      IFNE TCCY
      *
      ** Output details to report.
      *
     C                     MOVELLNRF      RLNRF
     C                     MOVELLTYP      RLTYP
     C                     MOVELSUTP      RSUTP
     C                     MOVELAMTP      RAMTP
      *
      ***  Convert date to DDMMMYY format
      *
     C                     MOVE VDAT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    RVDAT
      *
     C                     MOVELLASN      RLASN
     C                     MOVELSCCY      RTRCCY
     C                     MOVELRONS      RRSAN
     C                     MOVELTCCY      RACCY
      *
     C                     EXSR WP1REC
     C           #CHKLN    IFEQ 'Y'
     C                     WRITELOAMSUB
     C                     ENDIF
      *
     C                     WRITELOAMDTL
      *
     C                     ADD  1         R9CTR
     C                     ENDIF
      *
     C                     ELSE
     C           #CCY3     IFNE TCCY
      *
      ** Output details to report.
      *
     C                     MOVELLNRF      RLNRF
     C                     MOVELLTYP      RLTYP
     C                     MOVELSUTP      RSUTP
     C                     MOVELAMTP      RAMTP
      *
      ***  Convert date to DDMMMYY format
      *
     C                     MOVE VDAT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    RVDAT
      *
     C                     MOVELLASN      RLASN
     C                     MOVEL#CCY3     RTRCCY
     C                     MOVELRONS      RRSAN
     C                     MOVELTCCY      RACCY
      *
     C                     EXSR WP1REC
     C           #CHKLN    IFEQ 'Y'
     C                     WRITELOAMSUB
     C                     ENDIF
      *
     C                     WRITELOAMDTL
      *
     C                     ADD  1         R9CTR
     C                     ENDIF
     C                     ENDIF
      *                                                                   147975
     C                     ENDIF                                          147975
      *                                                                   147975
     C                     ENDIF                                          147975
      *
     C                     ENDIF
      *
      ** Payment Settlement Method = '14'.
      *
     C           PSTM      IFEQ 14
      *                                                                   147975
      ** Only retail accounts are to be processed for eventual            147975
      ** reporting .                                                      147975
      *                                                                   147975
     C           PONS      IFNE *ZERO                                     147975
     C                     MOVELPONS      K#RAN1
     C                     MOVEL#ATP,4    RACTP                                               239481
     C                     EXSR SRACCT
      *
     C           RECI      IFNE 'C'                                       147975
     C           *IN87     ANDEQ*OFF                                      147975
      *                                                                   147975
     C           CLE031    IFNE 'Y'                                       CLE031
     C           SCCY      IFNE *BLANKS
     C           SCCY      IFNE TCCY
      *
      ** Output details to report.
      *
     C                     MOVELLNRF      RLNRF
     C                     MOVELLTYP      RLTYP
     C                     MOVELSUTP      RSUTP
     C                     MOVELAMTP      RAMTP
      *
      ***  Convert date to DDMMMYY format
      *
     C                     MOVE VDAT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    RVDAT
      *
     C                     MOVELLASN      RLASN
     C                     MOVELSCCY      RTRCCY
     C                     MOVELPONS      RRSAN
     C                     MOVELTCCY      RACCY
      *
     C                     EXSR WP1REC
     C           #CHKLN    IFEQ 'Y'
     C                     WRITELOAMSUB
     C                     ENDIF
      *
     C                     WRITELOAMDTL
      *
     C                     ADD  1         R9CTR
     C                     ENDIF
      *
     C                     ELSE
     C           #CCY3     IFNE TCCY
      *
      ** Output details to report.
      *
     C                     MOVELLNRF      RLNRF
     C                     MOVELLTYP      RLTYP
     C                     MOVELSUTP      RSUTP
     C                     MOVELAMTP      RAMTP
      *
      ***  Convert date to DDMMMYY format
      *
     C                     MOVE VDAT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    RVDAT
      *
     C                     MOVELLASN      RLASN
     C                     MOVEL#CCY3     RTRCCY
     C                     MOVELPONS      RRSAN
     C                     MOVELTCCY      RACCY
      *
     C                     EXSR WP1REC
     C           #CHKLN    IFEQ 'Y'
     C                     WRITELOAMSUB
     C                     ENDIF
      *
     C                     WRITELOAMDTL
      *
     C                     ADD  1         R9CTR
     C                     ENDIF
     C                     ENDIF
      *                                                                   CLE031
      ** Processing for CLE031                                            CLE031
      *                                                                   CLE031
     C                     ELSE                                           CLE031
     C           PSCY      IFNE *BLANKS                                   CLE031
     C           PSCY      IFNE TCCY                                      CLE031
      *                                                                   CLE031
      ** Output details to report.                                        CLE031
      *                                                                   CLE031
     C                     MOVELLNRF      RLNRF                           CLE031
     C                     MOVELLTYP      RLTYP                           CLE031
     C                     MOVELSUTP      RSUTP                           CLE031
     C                     MOVELAMTP      RAMTP                           CLE031
      *                                                                   CLE031
      ***  Convert date to DDMMMYY format                                 CLE031
      *                                                                   CLE031
     C                     MOVE VDAT      ZDAYNO                          CLE031
     C                     EXSR ZDATE2                                    CLE031
     C                     MOVE ZADATE    RVDAT                           CLE031
      *                                                                   CLE031
     C                     MOVELLASN      RLASN                           CLE031
     C                     MOVELPSCY      RTRCCY                          CLE031
     C                     MOVELPONS      RRSAN                           CLE031
     C                     MOVELTCCY      RACCY                           CLE031
      *                                                                   CLE031
     C                     EXSR WP1REC                                    CLE031
     C           #CHKLN    IFEQ 'Y'                                       CLE031
     C                     WRITELOAMSUB                                   CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
     C                     WRITELOAMDTL                                   CLE031
      *                                                                   CLE031
     C                     ADD  1         R9CTR                           CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
     C                     ELSE                                           CLE031
     C           #CCY3     IFNE TCCY                                      CLE031
      *                                                                   CLE031
      ** Output details to report.                                        CLE031
      *                                                                   CLE031
     C                     MOVELLNRF      RLNRF                           CLE031
     C                     MOVELLTYP      RLTYP                           CLE031
     C                     MOVELSUTP      RSUTP                           CLE031
     C                     MOVELAMTP      RAMTP                           CLE031
      *                                                                   CLE031
      ***  Convert date to DDMMMYY format                                 CLE031
      *                                                                   CLE031
     C                     MOVE VDAT      ZDAYNO                          CLE031
     C                     EXSR ZDATE2                                    CLE031
     C                     MOVE ZADATE    RVDAT                           CLE031
      *                                                                   CLE031
     C                     MOVELLASN      RLASN                           CLE031
     C                     MOVEL#CCY3     RTRCCY                          CLE031
     C                     MOVELPONS      RRSAN                           CLE031
     C                     MOVELTCCY      RACCY                           CLE031
      *                                                                   CLE031
     C                     EXSR WP1REC                                    CLE031
     C           #CHKLN    IFEQ 'Y'                                       CLE031
     C                     WRITELOAMSUB                                   CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
     C                     WRITELOAMDTL                                   CLE031
      *                                                                   CLE031
     C                     ADD  1         R9CTR                           CLE031
     C                     ENDIF                                          CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
      *                                                                   147975
     C                     ENDIF                                          147975
      *                                                                   147975
     C                     ENDIF                                          147975
      *
     C                     ENDIF
      *
     C                     ENDIF                           * RECI *
      *
      ** Read next record.
     C                     READ LOAMS                    77
      *
     C                     ENDDO
      *
     C                     Z-ADDR9CTR     RCOUNT
     C           RCOUNT    IFEQ 0
      * Print No details.
     C                     WRITENODTLS
     C                     ENDIF
      *
      ** Do Audit report processing.
      *
     C                     MOVEL'LOAMS'   FNAME
     C                     EXSR SRAUDT
      *
     C                     ENDSR
      *
      *****************************************************************
      /TITLE SR/SRSTAN
      *****************************************************************
      *                                                               *
      *  SRSTAN - Subroutine to do the Detail Processing for Standing *
      *           Orders records.                                     *
      *                                                               *
      *****************************************************************
      *
     C           SRSTAN    BEGSR                           *** SRSTAN ***
      *
      ***  Read first record from File.
      *
     C                     READ STAND                    78
      *
      ***  Print header of record format.
      *
     C                     MOVEL#RPN,10   REPNAM
     C                     WRITEHEADPY
     C                     WRITESTANSUB
      *
     C                     Z-ADD0         R10CTR  20
      *
      ***  Do WHILE not end of file.
      *
     C           *IN78     DOWEQ*OFF
      *
     C           RECI      IFNE '*'                        * RECI *
      *
     C                     MOVELCCY       #CCY4   3
     C                     MOVE *BLANKS   DRCCY1                          145427
     C                     MOVE *BLANKS   CRCCY1                          145427
     C                     MOVEL*BLANK    CLOSE                           147975
      *                                                                   147975
     C           DRAN      IFNE *ZERO
     C                     MOVE DRAN      K#RAN1
     C                     EXSR SRACCT
     C*                                                                   147975
     C           RECI      IFEQ 'C'                                       147975
     C           *IN87     OREQ *ON                                       147975
     C                     MOVEL'Y'       CLOSE            CLOSE OR NEXIST147975
     C                     END                                            147975
     C*                                                                   147975
     C                     MOVELTCCY      DRCCY1  3
     C                     ENDIF
      *
     C           CRAN      IFNE *ZERO
     C                     MOVE CRAN      K#RAN1
     C                     EXSR SRACCT
     C*                                                                   147975
     C           RECI      IFEQ 'C'                                       147975
     C           *IN87     OREQ *ON                                       147975
     C                     MOVEL'Y'       CLOSE            CLOSE OR NEXIST147975
     C                     END                                            147975
     C*                                                                   147975
     C                     MOVELTCCY      CRCCY1  3
     C                     ENDIF
      *
     C           CLOSE     IFNE 'Y'                                       147975
      *                                                                   147975
     C           #CCY4     IFNE DRCCY1
     C           DRAN      ANDNE*ZERO
     C           #CCY4     ORNE CRCCY1
     C           CRAN      ANDNE*ZERO
      *
      ***  Output details to report.
      *
     C                     MOVELSTOR      RSTOR
     C                     MOVEL#CCY4     RTRCCY
     C                     MOVE DRAN      RDRAN
     C                     MOVELDRCCY1    RDACCY
     C                     MOVE CRAN      RCRAN
     C                     MOVELCRCCY1    RCACCY
      *
     C                     EXSR WP1REC
     C           #CHKLN    IFEQ 'Y'
     C                     WRITESTANSUB
     C                     ENDIF
      *
     C                     WRITESTANDTL
      *
     C                     ADD  1         R10CTR
     C                     ENDIF
      *
     C                     ENDIF                                          147975
      *                                                                   147975
     C                     ENDIF                           * RECI *
      *
      ** Read next record.
     C                     READ STAND                    78
     C                     ENDDO
      *
     C                     Z-ADDR10CTR    RCOUNT
     C           RCOUNT    IFEQ 0
      * Print No details.
     C                     WRITENODTLS
     C                     ENDIF
      *
      ** Do Audit report processing.
      *
     C                     MOVEL'STAND'   FNAME
     C                     EXSR SRAUDT
      *
     C                     ENDSR
      *
      *****************************************************************
      /TITLE SR/SRTTRN
      *****************************************************************
      *                                                               *
      *  SRTTRN - Subroutine to do the Detail Processing for Teller   *
      *           Transaction records.                                *
      *                                                               *
      *****************************************************************
      *
     C********** SRTTRN    BEGSR                           *** SRTTRN *** 145427
      *
      ***  Read first record from File.
      *
     C**********           READ TTRANL1                  79               145427
      *
      ***  Print header of record format.
      *
     C**********           MOVEL#RPN,11   REPNAM                          145427
     C**********           WRITEHEADPY                                    145427
     C**********           WRITETTRNSUB                                   145427
      *
     C**********           Z-ADD0         R11CTR  20                      145427
      *
      ***  Do WHILE not end of file.
      *
     C********** *IN79     DOWEQ*OFF                                      145427
      *
     C**********           MOVE ACNO      K#RAN1                          145427
     C**********           EXSR SRACCT                                    145427
      *
     C********** CCY1      IFNE TCCY                                      145427
      *
      ** Output details to report.
      *
     C**********           MOVELTBID      RTBID                           145427
     C**********           MOVELTBTN      RTBTN                           145427
     C**********           MOVELCCY1      RTRCCY                          145427
     C**********           MOVELACNO      RRSAN                           145427
     C**********           MOVELTCCY      RCACCY                          145427
      *
     C**********           EXSR WP1REC                                    145427
     C********** #CHKLN    IFEQ 'Y'                                       145427
     C**********           WRITETTRNSUB                                   145427
     C**********           ENDIF                                          145427
      *
     C**********           WRITETTRNDTL                                   145427
      *
     C**********           ADD  1         R11CTR                          145427
     C**********           ENDIF                                          145427
      *
      ** Read next record.
     C**********           READ TTRANL1                  79               145427
     C**********           ENDDO                                          145427
      *
     C**********           Z-ADDR11CTR    RCOUNT                          145427
     C********** RCOUNT    IFEQ 0                                         145427
      * Print No details.
     C**********           WRITENODTLS                                    145427
     C**********           ENDIF                                          145427
      *
      ** Do Audit report processing.
      *
     C**********           MOVEL'TTRANL1' FNAME                           145427
     C**********           EXSR SRAUDT                                    145427
      *
     C**********           ENDSR                                          145427
      *
      *****************************************************************
      /TITLE SR/SRSWEP
      *****************************************************************
      *                                                               *
      *  SRSWEP - Subroutine to do the Detail Processing for Sweep    *
      *           details.                                            *
      *                                                               *
      *****************************************************************
      *
     C           SRSWEP    BEGSR                           *** SRSWEP ***
      *
      ***  Read first record from File.
      *
     C                     READ RESWEPL0                 80
      *
      ***  Print header of record format.
      *
     C                     MOVEL#RPN,12   REPNAM
     C                     WRITEHEADPY
     C                     WRITESWEPSUB
      *
     C                     Z-ADD0         R12CTR  20
      *
      ***  Do WHILE not end of file.
      *
     C           *IN80     DOWEQ*OFF
      *
     C           RECI      IFNE '*'                        * RECI *
      *
     C                     MOVELCCY       #CCYD   3
     C                     MOVE *BLANKS   DSCCY1                          145427
     C                     MOVE *BLANKS   CSCCY1                          145427
     C                     MOVEL*BLANK    CLOSE                           147975
      *
     C           DRAN      IFNE *ZERO
     C                     MOVE DRAN      K#RAN1
     C                     EXSR SRACCT
     C*                                                                   147975
     C           RECI      IFEQ 'C'                                       147975
     C           *IN87     OREQ *ON                                       147975
     C                     MOVEL'Y'       CLOSE            CLOSE OR NEXIST147975
     C                     END                                            147975
     C*                                                                   147975
     C                     MOVELTCCY      DSCCY1  3
     C                     ENDIF
      *
     C           CRAN      IFNE *ZERO
     C                     MOVE CRAN      K#RAN1
     C                     EXSR SRACCT
     C*                                                                   147975
     C           RECI      IFEQ 'C'                                       147975
     C           *IN87     OREQ *ON                                       147975
     C                     MOVEL'Y'       CLOSE            CLOSE OR NEXIST147975
     C                     END                                            147975
     C*                                                                   147975
     C                     MOVELTCCY      CSCCY1  3
     C                     ENDIF
      *
     C           CLOSE     IFNE 'Y'                                       147975
      *                                                                   147975
     C           CEU022    IFEQ 'Y'
     C           CCYC      IFNE CSCCY1
     C           CRAN      ANDNE*ZERO
     C           #CCYD     ORNE DSCCY1
     C           DRAN      ANDNE*ZERO
      *
      ***  Output details to report.
      *
     C                     MOVELSWEP      RSWEP
     C                     MOVEL#CCYD     RDCCY
     C                     MOVE DRAN      RDRAN
     C                     MOVELDSCCY1    RDACCY
     C                     MOVELCCYC      RCCYC
     C                     MOVE CRAN      RCRAN
     C                     MOVELCSCCY1    RACCY
      *
     C                     EXSR WP1REC
     C           #CHKLN    IFEQ 'Y'
     C                     WRITESWEPSUB
     C                     ENDIF
      *
     C                     WRITESWEPDTL
      *
     C                     ADD  1         R12CTR
     C                     ENDIF
      *
     C                     ELSE
     C           #CCYD     IFNE CSCCY1
     C********** DRAN      ANDNE*ZERO                                     145427
     C           CRAN      ANDNE*ZERO                                     145427
     C           #CCYD     ORNE DSCCY1
     C           DRAN      ANDNE*ZERO
      *
      ***  Output details to report.
      *
     C                     MOVELSWEP      RSWEP
     C                     MOVEL#CCYD     RDCCY
     C                     MOVE DRAN      RDRAN
     C                     MOVELDSCCY1    RDACCY
     C                     MOVELCCYC      RCCYC
     C                     MOVE CRAN      RCRAN
     C                     MOVELCSCCY1    RACCY
      *
     C                     EXSR WP1REC
     C           #CHKLN    IFEQ 'Y'
     C                     WRITESWEPSUB
     C                     ENDIF
      *
     C                     WRITESWEPDTL
      *
     C                     ADD  1         R12CTR
     C                     ENDIF
      *
     C                     ENDIF
      *                                                                   147975
     C                     ENDIF                                          147975
      *
     C                     ENDIF                           * RECI *
      *
      ** Read next record.
     C                     READ RESWEPL0                 80
     C                     ENDDO
      *
     C                     Z-ADDR12CTR    RCOUNT
     C           RCOUNT    IFEQ 0
      * Print No details.
     C                     WRITENODTLS
     C                     ENDIF
      *
      ** Do Audit report processing.
      *
     C                     MOVEL'RESWEPL0'FNAME
     C                     EXSR SRAUDT
      *
     C                     ENDSR
      *
      *****************************************************************
      /TITLE SR/SRFFTR
      *****************************************************************
      *                                                               *
      *  SRFFTR - Subroutine to do the Detail Processing for FF       *
      *           Transaction settlement.                             *
      *                                                               *
      *****************************************************************
      *
     C           SRFFTR    BEGSR                           *** SRFFTR ***
      *
      ***  Read first record from File.
      *
     C                     READ TRSET                    81
      *
      ***  Print header of record format.
      *
     C                     MOVEL#RPN,13   REPNAM
     C                     WRITEHEADPY
     C                     WRITEFFTRSUB
      *
     C                     Z-ADD0         R13CTR  20
      *
      ***  Do WHILE not end of file.
      *
     C           *IN81     DOWEQ*OFF
      *
     C           RECI      IFNE '*'                        * RECI *
     C           RECI      ANDNE'M'
      *
     C           TNBR      CHAINTRANS                47
     C                     MOVEL*BLANK    CLOSE                           147975
     C           BSLT      IFEQ 14
      *                                                                   147975
      ** Only retail accounts are to be processed for eventual            147975
      ** reporting .                                                      147975
      *                                                                   147975
     C           BSLA      IFNE *ZERO                                     147975
     C                     MOVELBSLA      K#RAN1
     C                     EXSR SRACCT
     C*                                                                   147975
     C           RECI      IFEQ 'C'                                       147975
     C           *IN87     OREQ *ON                                       147975
     C                     MOVEL'Y'       CLOSE            CLOSE OR NEXIST147975
     C                     END                                            147975
     C*                                                                   147975
     C                     MOVELTCCY      BTCCY1  3
     C                     ENDIF                                          147975
      *                                                                   147975
     C                     ENDIF
      *
     C           CSLT      IFEQ 14
      *                                                                   147975
      ** Only retail accounts are to be processed for eventual            147975
      ** reporting .                                                      147975
      *                                                                   147975
     C           CSLA      IFNE *ZERO                                     147975
     C                     MOVELCSLA      K#RAN1
     C                     EXSR SRACCT
     C*                                                                   147975
     C           RECI      IFEQ 'C'                                       147975
     C           *IN87     OREQ *ON                                       147975
     C                     MOVEL'Y'       CLOSE            CLOSE OR NEXIST147975
     C                     END                                            147975
     C*                                                                   147975
     C                     MOVELTCCY      CTCCY1  3
     C                     ENDIF                                          147975
      *                                                                   147975
     C                     ENDIF
      *
     C           CLOSE     IFNE 'Y'                                       147975
      *                                                                   147975
     C           ISCY      IFNE CTCCY1
     C           CSLT      ANDEQ14
     C           CSLA      ANDNE*ZERO                                     147975
     C           ISCY      ORNE BTCCY1
     C           BSLT      ANDEQ14
     C           BSLA      ANDNE*ZERO                                     147975
      *
      ***  Output details to report.
      *
     C                     MOVELTNBR      RTNBR
     C                     MOVELISCY      RISCY
     C                     MOVELBSLA      RBSLA
     C                     MOVELBTCCY1    RBCCY
     C                     MOVELCSLA      RCSLA
     C                     MOVELCTCCY1    RCCCY
      *
     C                     EXSR WP1REC
     C           #CHKLN    IFEQ 'Y'
     C                     WRITEFFTRSUB
     C                     ENDIF
      *
     C                     WRITEFFTRDTL
      *
     C                     ADD  1         R13CTR
     C                     ENDIF
      *                                                                   147975
     C                     ENDIF                                          147975
      *
     C                     ENDIF                           * RECI *
      *
      ** Read next record.
     C                     READ TRSET                    81
     C                     ENDDO
      *
     C                     Z-ADDR13CTR    RCOUNT
     C           RCOUNT    IFEQ 0
      * Print No details.
     C                     WRITENODTLS
     C                     ENDIF
      *
      ** Do Audit report processing.
      *
     C                     MOVEL'TRSET'   FNAME
     C                     EXSR SRAUDT
      *
     C                     ENDSR
      *
      *****************************************************************
      /TITLE SR/SRTRAD
      *****************************************************************
      *                                                               *
      *  SRTRAD - Subroutine to do the Detail Processing for SE       *
      *           Trades.                                             *
      *                                                               *
      *****************************************************************
      *
     C           SRTRAD    BEGSR                           *** SRTRAD ***
      *
      ***  Read first record from File.
      *
     C                     READ TRADS                    82
      *
      ***  Print header of record format.
      *
     C                     MOVEL#RPN,14   REPNAM
     C                     WRITEHEADPY
     C                     WRITETRADSUB
      *
     C                     Z-ADD0         R14CTR  20
      *
      ***  Do WHILE not end of file.
      *
     C           *IN82     DOWEQ*OFF
      *
     C********** RECI      IFNE '*'                        * RECI *                           186120
     C           RECI      IFEQ 'D'                                                           186120
      *
      ** If Settlement Method = '14'.
      *
     C           SMTH      IFEQ 14
     C           TDFS      ANDEQ0                                         152216
      *
      ** If Trade is purchase.
     C           TDTP      IFEQ 'TP'
      *                                                                   147975
      ** Only retail accounts are to be processed for eventual            147975
      ** reporting .                                                      147975
      *                                                                   147975
     C           PYFM      IFNE *ZERO                                     147975
     C                     MOVELPYFM      K#RAN1
     C                     EXSR SRACCT
      *
     C           RECI      IFNE 'C'                                       147975
     C           *IN87     ANDEQ*OFF                                      147975
      *                                                                   147975
     C           SETC      IFNE TCCY
      *
      ***  Output details to report.
      *
     C                     MOVELTDRF      RTDRF
     C                     MOVELTDSS      RTDSS
     C                     MOVELTCNR      RTCNR
     C                     MOVELTDTP      RTDTP
     C                     MOVELSETC      RTRCCY
     C                     MOVELPYFM      RRSAN
     C                     MOVELTCCY      RACCY
      *
     C                     EXSR WP1REC
     C           #CHKLN    IFEQ 'Y'
     C                     WRITETRADSUB
     C                     ENDIF
      *
     C                     WRITETRADDTL
      *
     C                     ADD  1         R14CTR
     C                     ENDIF
      *                                                                   147975
     C                     ENDIF                                          147975
      *                                                                   147975
     C                     ENDIF                                          147975
      *                                                                   147975
     C                     ENDIF
      *
      ** If Trade is purchase.
     C           TDTP      IFEQ 'TS'
      *                                                                   147975
      ** Only retail accounts are to be processed for eventual            147975
      ** reporting .                                                      147975
      *                                                                   147975
     C           PAYT      IFNE *ZERO                                     147975
     C                     MOVELPAYT      K#RAN1
     C                     EXSR SRACCT
      *
     C           RECI      IFNE 'C'                                       147975
     C           *IN87     ANDEQ*OFF                                      147975
      *                                                                   147975
     C           SETC      IFNE TCCY
      *
      ***  Output details to report.
      *
     C                     MOVELTDRF      RTDRF
     C                     MOVELTDSS      RTDSS
     C                     MOVELTCNR      RTCNR
     C                     MOVELTDTP      RTDTP
     C                     MOVELSETC      RTRCCY
     C                     MOVELPAYT      RRSAN
     C                     MOVELTCCY      RACCY
      *
     C                     EXSR WP1REC
     C           #CHKLN    IFEQ 'Y'
     C                     WRITETRADSUB
     C                     ENDIF
      *
     C                     WRITETRADDTL
      *
     C                     ADD  1         R14CTR
     C                     ENDIF
      *                                                                   147975
     C                     ENDIF                                          147975
      *                                                                   147975
     C                     ENDIF                                          147975
      *                                                                   147975
     C                     ENDIF
      *
     C                     ENDIF
      *
     C                     ENDIF                           * RECI *
      *
      ** Read next record.
     C                     READ TRADS                    82
     C                     ENDDO
      *
     C                     Z-ADDR14CTR    RCOUNT
     C           RCOUNT    IFEQ 0
      * Print No details.
     C                     WRITENODTLS
     C                     ENDIF
      *
      ** Do Audit report processing.
      *
     C                     MOVEL'TRADS'   FNAME
     C                     EXSR SRAUDT
      *
     C                     ENDSR
      *
      *****************************************************************
      /TITLE SR/SRPOSE
      *****************************************************************
      *                                                               *
      *  SRPOSE - Subroutine to do the Detail Processing for SE       *
      *           Position Settlement.                                *
      *                                                               *
      *****************************************************************
      *
     C           SRPOSE    BEGSR                           *** SRTRAD ***
      *
      ***  Read first record from File.
      *
     C                     READ POSET                    88
      *
      ***  Print header of record format.
      *
     C                     MOVEL#RPN,19   REPNAM
     C                     WRITEHEADPY
     C                     WRITEPOSESUB
      *
     C                     Z-ADD0         R19CTR  20
      *
      ***  Do WHILE not end of file.
      *
     C           *IN88     DOWEQ*OFF
      *
     C           RECI      IFNE '*'                        * RECI *
     C           RECI      ANDNE'M'
      *
      ** If Settlement Method = '14'.
      *
     C           PSMT      IFEQ 14
      *
      *                                                                   147975
      ** Only retail accounts are to be processed for eventual            147975
      ** reporting .                                                      147975
      *                                                                   147975
     C           PSEA      IFNE *ZERO                                     147975
     C                     MOVELPSEA      K#RAN1
     C                     EXSR SRACCT
      *
     C           RECI      IFNE 'C'                                       147975
     C           *IN87     ANDEQ*OFF                                      147975
      *                                                                   147975
     C           PSCU      IFNE *BLANKS
     C           PSCU      IFNE TCCY
      *
      ***  Output details to report.
      *
     C                     MOVELPBCA      RPBCA
     C                     MOVELPSSH      RPSSH
     C                     MOVELPCPY      RPCPY
      *
      ***  Convert date to DDMMMYY format
      *
     C                     MOVE PDUD      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    RPDUD
      *
     C                     MOVELPEVT      RPEVT
     C                     MOVELPSCU      RTRCCY
     C                     MOVELPSEA      RRSAN
     C                     MOVELTCCY      RACCY
      *
     C                     EXSR WP1REC
     C           #CHKLN    IFEQ 'Y'
     C                     WRITEPOSESUB
     C                     ENDIF
      *
     C                     WRITEPOSEDTL
      *
     C                     ADD  1         R19CTR
     C                     ENDIF
      *
     C                     ELSE
     C           PNCY      IFNE TCCY
      *
      ***  Output details to report.
      *
     C                     MOVELPBCA      RPBCA
     C                     MOVELPSSH      RPSSH
     C                     MOVELPCPY      RPCPY
      *
      ***  Convert date to DDMMMYY format
      *
     C                     MOVE PDUD      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    RPDUD
      *
     C                     MOVELPEVT      RPEVT
     C                     MOVELPNCY      RTRCCY
     C                     MOVELPSEA      RRSAN
     C                     MOVELTCCY      RACCY
      *
     C                     EXSR WP1REC
     C           #CHKLN    IFEQ 'Y'
     C                     WRITEPOSESUB
     C                     ENDIF
      *
     C                     WRITEPOSEDTL
      *
     C                     ADD  1         R19CTR
     C                     ENDIF
     C                     ENDIF
      *                                                                   147975
     C                     ENDIF                                          147975
      *
     C                     ENDIF                                          147975
      *                                                                   147975
     C                     ENDIF
      *
     C                     ENDIF                           * RECI *
      *
      ** Read next record.
     C                     READ POSET                    88
     C                     ENDDO
      *
     C                     Z-ADDR19CTR    RCOUNT
     C           RCOUNT    IFEQ 0
      * Print No details.
     C                     WRITENODTLS
     C                     ENDIF
      *
      ** Do Audit report processing.
      *
     C                     MOVEL'POSET'   FNAME
     C                     EXSR SRAUDT
      *
     C                     ENDSR
      *
      *****************************************************************
      /TITLE SR/SRSOBT
      *****************************************************************
      *                                                               *
      *  SRSOBT - Subroutine to do the Detail Processing for SE       *
      *           Trades.                                             *
      *                                                               *
      *****************************************************************
      *
     C           SRSOBT    BEGSR                           *** SRTRAD ***
      *
      ***  Read first record from File.
      *
     C                     READ SOBTR                    89
      *
      ***  Print header of record format.
      *
     C                     MOVEL#RPN,20   REPNAM
     C                     WRITEHEADPY
     C                     WRITETRADSUB
      *
     C                     Z-ADD0         R20CTR  20
      *
      ***  Do WHILE not end of file.
      *
     C           *IN89     DOWEQ*OFF
      *
     C********** RECI      IFNE '*'                        * RECI *                           186120
     C           RECI      IFEQ 'D'                                                           186120
      *
      ** If Settlement Method = '14'.
      *
     C           SMTH      IFEQ 14
     C           TDFS      ANDEQ0                                         152216
      *
      ** If Trade is purchase.
     C           TDTP      IFEQ 'TP'
      *                                                                   147975
      ** Only retail accounts are to be processed for eventual            147975
      ** reporting .                                                      147975
      *                                                                   147975
     C           PYFM      IFNE *ZERO                                     147975
     C                     MOVELPYFM      K#RAN1
     C                     EXSR SRACCT
      *
     C           RECI      IFNE 'C'                                       147975
     C           *IN87     ANDEQ*OFF                                      147975
      *                                                                   147975
     C           SETC      IFNE TCCY
      *
      ***  Output details to report.
      *
     C                     MOVELTDRF      RTDRF
     C                     MOVELTDSS      RTDSS
     C                     MOVELTCNR      RTCNR
     C                     MOVELTDTP      RTDTP
     C                     MOVELSETC      RTRCCY
     C                     MOVELPYFM      RRSAN
     C                     MOVELTCCY      RACCY
      *
     C                     EXSR WP1REC
     C           #CHKLN    IFEQ 'Y'
     C                     WRITETRADSUB
     C                     ENDIF
      *
     C                     WRITETRADDTL
      *
     C                     ADD  1         R20CTR
     C                     ENDIF
      *                                                                   147975
     C                     ENDIF                                          147975
      *                                                                   147975
     C                     ENDIF                                          147975
      *                                                                   147975
     C                     ENDIF
      *
      ** If Trade is purchase.
     C           TDTP      IFEQ 'TS'
      *                                                                   147975
      ** Only retail accounts are to be processed for eventual            147975
      ** reporting .                                                      147975
      *                                                                   147975
     C           PAYT      IFNE *ZERO                                     147975
     C                     MOVELPAYT      K#RAN1
     C                     EXSR SRACCT
      *
     C           RECI      IFNE 'C'                                       147975
     C           *IN87     ANDEQ*OFF                                      147975
      *                                                                   147975
     C           SETC      IFNE TCCY
      *
      ***  Output details to report.
      *
     C                     MOVELTDRF      RTDRF
     C                     MOVELTDSS      RTDSS
     C                     MOVELTCNR      RTCNR
     C                     MOVELTDTP      RTDTP
     C                     MOVELSETC      RTRCCY
     C                     MOVELPAYT      RRSAN
     C                     MOVELTCCY      RACCY
      *
     C                     EXSR WP1REC
     C           #CHKLN    IFEQ 'Y'
     C                     WRITETRADSUB
     C                     ENDIF
      *
     C                     WRITETRADDTL
      *
     C                     ADD  1         R20CTR
     C                     ENDIF
      *                                                                   147975
     C                     ENDIF                                          147975
      *                                                                   147975
     C                     ENDIF                                          147975
      *                                                                   147975
     C                     ENDIF
      *
     C                     ENDIF
      *
     C                     ENDIF                           * RECI *
      *
      ** Read next record.
     C                     READ SOBTR                    89
     C                     ENDDO
      *
     C                     Z-ADDR20CTR    RCOUNT
     C           RCOUNT    IFEQ 0
      * Print No details.
     C                     WRITENODTLS
     C                     ENDIF
      *
      ** Do Audit report processing.
      *
     C                     MOVEL'SOBTR'   FNAME
     C                     EXSR SRAUDT
      *
     C                     ENDSR
      *
      *****************************************************************
      /TITLE SR/SRFCLT
      *****************************************************************
      *                                                               *
      *  SRFCLT - Subroutine to do the Detail Processing for LE       *
      *           Customer Facility records.                          *
      *                                                               *
      *****************************************************************
      *
     C           SRFCLT    BEGSR                           *** SRFCLT ***
      *
      ***  Read first record from File.
      *
     C                     READ FCLTY                    83
      *
      ***  Print header of record format.
      *
     C                     MOVEL#RPN,15   REPNAM
     C                     WRITEHEADPY
     C                     WRITEFCLTSUB
      *
     C                     Z-ADD0         R15CTR  20
      *
      ***  Do WHILE not end of file.
      *
     C           *IN83     DOWEQ*OFF
      *
     C           RECI      IFEQ 'D'                        * RECI *
      *
     C                     MOVELFACT      FACT#   3
     C                     MOVELFCNO      FCNO#   2
     C                     MOVELCNUM      CNUM#   6
      *
     C           PRTR      IFEQ 'P'                                       143038
     C           PRTR      OREQ 'I'                                       143038
     C           PRTR      OREQ 'S'                                                           CLE106
     C           PRTR      OREQ 'R'                                                           CLE106
      *                                                                   143038
      ** Receipt Settlement method = '14'.
      *
     C           RSTM      IFEQ 14
      *                                                                   147975
      ** Only retail accounts are to be processed for eventual            147975
      ** reporting .                                                      147975
      *                                                                   147975
     C           RONS      IFNE *ZERO                                     147975
     C                     MOVELRONS      K#RAN1
     C                     MOVEL#ATP,3    RACTP                                               239481
     C                     EXSR SRACCT
      *
     C           RECI      IFNE 'C'                                       147975
     C           *IN87     ANDEQ*OFF                                      147975
      *                                                                   147975
     C           SCCY      IFNE *BLANKS
     C           SCCY      IFNE TCCY
      *
      ** Output details to report.
      *
     C                     MOVELFACT#     RFACT
     C                     MOVELFCNO#     RFCNO
     C                     MOVELCNUM#     RCNUM
     C                     MOVELSCCY      RTRCCY
     C                     MOVELRONS      RRSAN
     C                     MOVELTCCY      RACCY
      *
     C                     EXSR WP1REC
     C           #CHKLN    IFEQ 'Y'
     C                     WRITEFCLTSUB
     C                     ENDIF
      *
     C                     WRITEFCLTDTL
      *
     C                     ADD  1         R15CTR
     C                     ENDIF
      *
     C                     ELSE
     C           FCCY      IFNE TCCY
      *
      ** Output details to report.
      *
     C                     MOVELFACT#     RFACT
     C                     MOVELFCNO#     RFCNO
     C                     MOVELCNUM#     RCNUM
     C                     MOVELFCCY      RTRCCY
     C                     MOVELRONS      RRSAN
     C                     MOVELTCCY      RACCY
      *
     C                     EXSR WP1REC
     C           #CHKLN    IFEQ 'Y'
     C                     WRITEFCLTSUB
     C                     ENDIF
      *
     C                     WRITEFCLTDTL
      *
     C                     ADD  1         R15CTR
     C                     ENDIF
     C                     ENDIF
      *                                                                   147975
     C                     ENDIF                                          147975
      *                                                                   147975
     C                     ENDIF                                          147975
      *
     C                     ENDIF
      *
      ** Payment Settlement method = '14'.
      *
     C           PSTM      IFEQ 14
      *                                                                   147975
      ** Only retail accounts are to be processed for eventual            147975
      ** reporting .                                                      147975
      *                                                                   147975
     C           PONS      IFNE *ZERO                                     147975
     C                     MOVELPONS      K#RAN1
     C                     MOVEL#ATP,4    RACTP                                               239481
     C                     EXSR SRACCT
      *
     C           RECI      IFNE 'C'                                       147975
     C           *IN87     ANDEQ*OFF                                      147975
      *                                                                   147975
     C           CLE031    IFNE 'Y'                                       CLE031
     C           SCCY      IFNE *BLANKS
     C           SCCY      IFNE TCCY
      *
      ** Output details to report.
      *
     C                     MOVELFACT#     RFACT
     C                     MOVELFCNO#     RFCNO
     C                     MOVELCNUM#     RCNUM
     C                     MOVELSCCY      RTRCCY
     C                     MOVELPONS      RRSAN
     C                     MOVELTCCY      RACCY
      *
     C                     EXSR WP1REC
     C           #CHKLN    IFEQ 'Y'
     C                     WRITEFCLTSUB
     C                     ENDIF
      *
     C                     WRITEFCLTDTL
      *
     C                     ADD  1         R15CTR
     C                     ENDIF
      *
     C                     ELSE
     C           FCCY      IFNE TCCY
      *
      ** Output details to report.
      *
     C                     MOVELFACT#     RFACT
     C                     MOVELFCNO#     RFCNO
     C                     MOVELCNUM#     RCNUM
     C                     MOVELFCCY      RTRCCY
     C                     MOVELPONS      RRSAN
     C                     MOVELTCCY      RACCY
      *
     C                     EXSR WP1REC
     C           #CHKLN    IFEQ 'Y'
     C                     WRITEFCLTSUB
     C                     ENDIF
      *
     C                     WRITEFCLTDTL
      *
     C                     ADD  1         R15CTR
     C                     ENDIF
     C                     ENDIF
      *                                                                   CLE031
      ** Processing for CLE031                                            CLE031
      *                                                                   CLE031
     C                     ELSE                                           CLE031
      *                                                                   CLE031
     C           PSCY      IFNE *BLANKS                                   CLE031
     C           PSCY      IFNE TCCY                                      CLE031
      *                                                                   CLE031
      ** Output details to report.                                        CLE031
      *                                                                   CLE031
     C                     MOVELFACT#     RFACT                           CLE031
     C                     MOVELFCNO#     RFCNO                           CLE031
     C                     MOVELCNUM#     RCNUM                           CLE031
     C                     MOVELPSCY      RTRCCY                          CLE031
     C                     MOVELPONS      RRSAN                           CLE031
     C                     MOVELTCCY      RACCY                           CLE031
      *                                                                   CLE031
     C                     EXSR WP1REC                                    CLE031
     C           #CHKLN    IFEQ 'Y'                                       CLE031
     C                     WRITEFCLTSUB                                   CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
     C                     WRITEFCLTDTL                                   CLE031
     C                     ADD  1         R15CTR                          CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
     C                     ELSE                                           CLE031
     C           FCCY      IFNE TCCY                                      CLE031
      *                                                                   CLE031
      ** Output details to report.                                        CLE031
      *                                                                   CLE031
     C                     MOVELFACT#     RFACT                           CLE031
     C                     MOVELFCNO#     RFCNO                           CLE031
     C                     MOVELCNUM#     RCNUM                           CLE031
     C                     MOVELFCCY      RTRCCY                          CLE031
     C                     MOVELPONS      RRSAN                           CLE031
     C                     MOVELTCCY      RACCY                           CLE031
      *                                                                   CLE031
     C                     EXSR WP1REC                                    CLE031
     C           #CHKLN    IFEQ 'Y'                                       CLE031
     C                     WRITEFCLTSUB                                   CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
     C                     WRITEFCLTDTL                                   CLE031
      *                                                                   CLE031
     C                     ADD  1         R15CTR                          CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
     C                     ENDIF                                          CLE031
     C                     ENDIF                                          CLE031
      *                                                                   147975
     C                     ENDIF                                          147975
      *                                                                   147975
     C                     ENDIF                                          147975
      *
     C                     ENDIF
      *                                                                   143038
     C                     ENDIF                                          143038
      *
      ** Settlement Type = '14'.
      *
     C           SETT      IFEQ 14
      *                                                                   147975
      ** Only retail accounts are to be processed for eventual            147975
      ** reporting .                                                      147975
      *                                                                   147975
     C           OBAC      IFNE *ZERO                                     147975
     C                     MOVELOBAC      K#RAN1
     C                     MOVEL#ATP,24   RACTP                                               239481
     C                     EXSR SRACCT
      *
     C           RECI      IFNE 'C'                                       147975
     C           *IN87     ANDEQ*OFF                                      147975
      *                                                                   147975
     C           SCCY      IFNE *BLANKS
     C           SCCY      IFNE TCCY
      *
      ** Output details to report.
      *
     C                     MOVELFACT#     RFACT
     C                     MOVELFCNO#     RFCNO
     C                     MOVELCNUM#     RCNUM
     C                     MOVELSCCY      RTRCCY
     C                     MOVELOBAC      RRSAN
     C                     MOVELTCCY      RACCY
      *
     C                     EXSR WP1REC
     C           #CHKLN    IFEQ 'Y'
     C                     WRITEFCLTSUB
     C                     ENDIF
      *
     C                     WRITEFCLTDTL
      *
     C                     ADD  1         R15CTR
     C                     ENDIF
      *
     C                     ELSE
     C           FCCY      IFNE TCCY
      *
      ** Output details to report.
      *
     C                     MOVELFACT#     RFACT
     C                     MOVELFCNO#     RFCNO
     C                     MOVELCNUM#     RCNUM
     C                     MOVELFCCY      RTRCCY
     C                     MOVELOBAC      RRSAN
     C                     MOVELTCCY      RACCY
      *
     C                     EXSR WP1REC
     C           #CHKLN    IFEQ 'Y'
     C                     WRITEFCLTSUB
     C                     ENDIF
      *
     C                     WRITEFCLTDTL
      *
     C                     ADD  1         R15CTR
     C                     ENDIF
     C                     ENDIF
      *                                                                   147975
     C                     ENDIF                                          147975
      *                                                                   147975
     C                     ENDIF                                          147975
      *
     C                     ENDIF
      *
     C                     ENDIF                           * RECI *
      *                                                                   142373
     C                     Z-ADD0         RSTM                            142373
     C                     Z-ADD0         PSTM                            142373
     C                     Z-ADD0         SETT                            142373
      *
      ** Read next record.
     C                     READ FCLTY                    83
      *
     C                     ENDDO
      *
     C                     Z-ADDR15CTR    RCOUNT
     C           RCOUNT    IFEQ 0
      * Print No details.
     C                     WRITENODTLS
     C                     ENDIF
      *
      ** Do Audit report processing.
      *
     C                     MOVEL'FCLTY'   FNAME
     C                     EXSR SRAUDT
      *
     C                     ENDSR
      *
      *****************************************************************
      /TITLE SR/SRFEED
      *****************************************************************
      *                                                               *
      *  SRFEED - Subroutine to do the Detail Processing for LE       *
      *           Fee details.                                        *
      *                                                               *
      *****************************************************************
      *
     C           SRFEED    BEGSR                           *** SRFEED ***
      *
      ***  Read first record from File.
      *
     C***********          READ LEFEEDL0                 84               146327
     C                     READ LEFEEDL1                 84               146327
      *
      ***  Print header of record format.
      *
     C                     MOVEL#RPN,16   REPNAM
     C                     WRITEHEADPY
     C                     WRITEFEEDSUB
      *
     C                     Z-ADD0         R16CTR  20
      *
      ***  Do WHILE not end of file.
      *
     C           *IN84     DOWEQ*OFF
      *
     C***********RECI      IFNE 'R'                        * RECI *       146327
     C***********RECI      ANDNE'M'                                       146327
     C           FERECI    IFNE 'R'                                       146327
     C           FERECI    ANDNE'M'                                       146327
      *
      ** Settlement type = '14'.
      *
     C           FESTTL    IFEQ 14
     C           CLE031    ANDNE'Y'                                       CLE031
      *                                                                   147975
      ** Only retail accounts are to be processed for eventual            147975
      ** reporting .                                                      147975
      *                                                                   147975
     C           FEOURS    IFNE *ZERO                                     147975
     C                     MOVELFEOURS    K#RAN1
     C                     MOVE *BLANKS   RACTP                                               239481
     C                     MOVEL'OUR'     RACTP                                               239481
     C                     CAT  #ATP,23:1 RACTP                                               239481
     C                     EXSR SRACCT
      *
     C           RECI      IFNE 'C'                                       147975
     C           *IN87     ANDEQ*OFF                                      147975
      *                                                                   147975
     C           FESCCY    IFNE *BLANKS
     C           FESCCY    IFNE TCCY
      *
      ** Output details to report.
      *
     C                     MOVELFECNUM    RFCNUM
     C                     MOVELFEFACL    RFFACL
     C                     MOVELFEFSEQ    RFFSEQ
     C                     MOVELFELOAN    RFLOAN
     C                     MOVELFESCCY    RTRCCY
     C                     MOVELFEOURS    RRSAN
     C                     MOVELTCCY      RACCY
      *
     C                     EXSR WP1REC
     C           #CHKLN    IFEQ 'Y'
     C                     WRITEFEEDSUB
     C                     ENDIF
      *
     C                     WRITEFEEDDTL
      *
     C                     ADD  1         R16CTR
     C                     ENDIF
      *
     C                     ELSE
     C           FEFCCY    IFNE TCCY
      *
      ** Output details to report.
      *
     C                     MOVELFECNUM    RFCNUM
     C                     MOVELFEFACL    RFFACL
     C                     MOVELFEFSEQ    RFFSEQ
     C                     MOVELFELOAN    RFLOAN
     C                     MOVELFEFCCY    RTRCCY
     C                     MOVELFEOURS    RRSAN
     C                     MOVELTCCY      RACCY
      *
     C                     EXSR WP1REC
     C           #CHKLN    IFEQ 'Y'
     C                     WRITEFEEDSUB
     C                     ENDIF
      *
     C                     WRITEFEEDDTL
      *
     C                     ADD  1         R16CTR
     C                     ENDIF
     C                     ENDIF
      *                                                                   147975
     C                     ENDIF                                          147975
      *                                                                   147975
     C                     ENDIF                                          147975
      *
     C                     ENDIF
      *
      ** Receipt Settlement method = '14'.
      *
     C***********RSTM      IFEQ 14                                        182855
     C***********                                                   147975182855
     C***Only*retail accounts are to be processed for eventual      147975182855
     C***reporting .                                                147975182855
     C***********                                                   147975182855
     C***********RONS      IFNE *ZERO                               147975182855
     C***********          MOVELRONS      K#RAN1                          182855
     C***********          EXSR SRACCT                                    182855
     C***********                                                         182855
     C***********RECI      IFNE 'C'                                 147975182855
     C************IN87     ANDEQ*OFF                                147975182855
     C***********                                                   147975182855
     C***********FESCCY    IFNE *BLANKS                                   182855
     C***********FESCCY    IFNE TCCY                                      182855
     C***********                                                         182855
     C***Output*details to report.                                        182855
     C***********                                                         182855
     C***********          MOVELFECNUM    RFCNUM                          182855
     C***********          MOVELFEFACL    RFFACL                          182855
     C***********          MOVELFEFSEQ    RFFSEQ                          182855
     C***********          MOVELFELOAN    RFLOAN                          182855
     C***********          MOVELFESCCY    RTRCCY                          182855
     C***********          MOVELRONS      RRSAN                           182855
     C***********          MOVELTCCY      RACCY                           182855
     C***********                                                         182855
     C***********          EXSR WP1REC                                    182855
     C***********#CHKLN    IFEQ 'Y'                                       182855
     C***********          WRITEFEEDSUB                                   182855
     C***********          ENDIF                                          182855
     C***********                                                         182855
     C***********          WRITEFEEDDTL                                   182855
     C***********                                                         182855
     C***********          ADD  1         R16CTR                          182855
     C***********          ENDIF                                          182855
      ***********                                                         182855
     C***********          ELSE                                           182855
     C***********FEFCCY    IFNE TCCY                                      182855
      ***********                                                         182855
      ***Output*details to report.                                        182855
      ***********                                                         182855
     C***********          MOVELFECNUM    RFCNUM                          182855
     C***********          MOVELFEFACL    RFFACL                          182855
     C***********          MOVELFEFSEQ    RFFSEQ                          182855
     C***********          MOVELFELOAN    RFLOAN                          182855
     C***********          MOVELFEFCCY    RTRCCY                          182855
     C***********          MOVELRONS      RRSAN                           182855
     C***********          MOVELTCCY      RACCY                           182855
      ***********                                                         182855
     C***********          EXSR WP1REC                                    182855
     C***********#CHKLN    IFEQ 'Y'                                       182855
     C***********          WRITEFEEDSUB                                   182855
     C***********          ENDIF                                          182855
      ***********                                                         182855
     C***********          WRITEFEEDDTL                                   182855
      ***********                                                         182855
     C***********          ADD  1         R16CTR                          182855
     C***********          ENDIF                                          182855
     C***********          ENDIF                                          182855
      ***********                                                   147975182855
     C***********          ENDIF                                    147975182855
      ***********                                                   147975182855
     C***********          ENDIF                                    147975182855
      ***********                                                         182855
     C***********          ENDIF                                          182855
      ***********                                                         182855
      *                                                                   CLE031
      ** If CLE031 is on and PTFI is blank do processing for receipt      CLE031
      ** settlement method 14.                                            CLE031
      *                                                                   CLE031
     C           CLE031    IFEQ 'Y'                                       CLE031
     C           PTFI      ANDEQ*BLANKS                                   CLE031
     C           RSTM      ANDEQ14                                        CLE031
      *                                                                   CLE031
      ** Only retail accounts are to be processed for eventual            CLE031
      ** reporting .                                                      CLE031
      *                                                                   CLE031
     C           RONS      IFNE *ZERO                                     CLE031
     C                     MOVELRONS      K#RAN1                          CLE031
     C                     MOVEL#ATP,3    RACTP                                               239481
     C                     EXSR SRACCT                                    CLE031
      *                                                                   CLE031
     C           RECI      IFNE 'C'                                       CLE031
     C           *IN87     ANDEQ*OFF                                      CLE031
      *                                                                   CLE031
     C           FESCCY    IFNE *BLANKS                                   CLE031
     C           FESCCY    IFNE TCCY                                      CLE031
      *                                                                   CLE031
      ** Output details to report.                                        CLE031
      *                                                                   CLE031
     C                     MOVELFECNUM    RFCNUM                          CLE031
     C                     MOVELFEFACL    RFFACL                          CLE031
     C                     MOVELFEFSEQ    RFFSEQ                          CLE031
     C                     MOVELFELOAN    RFLOAN                          CLE031
     C                     MOVELFESCCY    RTRCCY                          CLE031
     C                     MOVELRONS      RRSAN                           CLE031
     C                     MOVELTCCY      RACCY                           CLE031
      *                                                                   CLE031
     C                     EXSR WP1REC                                    CLE031
     C           #CHKLN    IFEQ 'Y'                                       CLE031
     C                     WRITEFEEDSUB                                   CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
     C                     WRITEFEEDDTL                                   CLE031
      *                                                                   CLE031
     C                     ADD  1         R16CTR                          CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
     C                     ELSE                                           CLE031
     C           FEFCCY    IFNE TCCY                                      CLE031
      *                                                                   CLE031
      ** Output details to report.                                        CLE031
      *                                                                   CLE031
     C                     MOVELFECNUM    RFCNUM                          CLE031
     C                     MOVELFEFACL    RFFACL                          CLE031
     C                     MOVELFEFSEQ    RFFSEQ                          CLE031
     C                     MOVELFELOAN    RFLOAN                          CLE031
     C                     MOVELFEFCCY    RTRCCY                          CLE031
     C                     MOVELRONS      RRSAN                           CLE031
     C                     MOVELTCCY      RACCY                           CLE031
      *                                                                   CLE031
     C                     EXSR WP1REC                                    CLE031
     C           #CHKLN    IFEQ 'Y'                                       CLE031
     C                     WRITEFEEDSUB                                   CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
     C                     WRITEFEEDDTL                                   CLE031
      *                                                                   CLE031
     C                     ADD  1         R16CTR                          CLE031
     C                     ENDIF                                          CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
     C                     ENDIF                                          CLE031
      ***Payment*Settlement Method = '14'.                                182855
      ***********                                                         182855
     C***********PSTM      IFEQ 14                                        182855
      ***********                                                   147975182855
      ***Only*retail accounts are to be processed for eventual      147975182855
      ***reporting .                                                147975182855
      ***********                                                   147975182855
     C***********PONS      IFNE *ZERO                               147975182855
     C***********          MOVELPONS      K#RAN1                          182855
     C***********          EXSR SRACCT                                    182855
      ***********                                                         182855
     C***********RECI      IFNE 'C'                                 147975182855
     C************IN87     ANDEQ*OFF                                147975182855
      ***********                                                   147975182855
     C***********FESCCY    IFNE *BLANKS                                   182855
     C***********FESCCY    IFNE TCCY                                      182855
      ***********                                                         182855
      ***Output*details to report.                                        182855
      ***********                                                         182855
     C***********          MOVELFECNUM    RFCNUM                          182855
     C***********          MOVELFEFACL    RFFACL                          182855
     C***********          MOVELFEFSEQ    RFFSEQ                          182855
     C***********          MOVELFELOAN    RFLOAN                          182855
     C***********          MOVELFESCCY    RTRCCY                          182855
     C***********          MOVELPONS      RRSAN                           182855
     C***********          MOVELTCCY      RACCY                           182855
      ***********                                                         182855
     C***********          EXSR WP1REC                                    182855
     C***********#CHKLN    IFEQ 'Y'                                       182855
     C***********          WRITEFEEDSUB                                   182855
     C***********          ENDIF                                          182855
      ***********                                                         182855
     C***********          WRITEFEEDDTL                                   182855
      ***********                                                         182855
     C***********          ADD  1         R16CTR                          182855
     C***********          ENDIF                                          182855
      ***********                                                         182855
     C***********          ELSE                                           182855
     C***********FEFCCY    IFNE TCCY                                      182855
      ***********                                                         182855
      ***Output*details to report.                                        182855
      ***********                                                         182855
     C***********          MOVELFECNUM    RFCNUM                          182855
     C***********          MOVELFEFACL    RFFACL                          182855
     C***********          MOVELFEFSEQ    RFFSEQ                          182855
     C***********          MOVELFELOAN    RFLOAN                          182855
     C***********          MOVELFEFCCY    RTRCCY                          182855
     C***********          MOVELPONS      RRSAN                           182855
     C***********          MOVELTCCY      RACCY                           182855
      ***********                                                         182855
     C***********          EXSR WP1REC                                    182855
     C***********#CHKLN    IFEQ 'Y'                                       182855
     C***********          WRITEFEEDSUB                                   182855
     C***********          ENDIF                                          182855
      ***********                                                         182855
     C***********          WRITEFEEDDTL                                   182855
      ***********                                                         182855
     C***********          ADD  1         R16CTR                          182855
     C***********          ENDIF                                          182855
     C***********          ENDIF                                          182855
      ***********                                                   147975182855
     C***********          ENDIF                                    147975182855
      ***********                                                   147975182855
     C***********          ENDIF                                    147975182855
      ***********                                                         182855
     C***********          ENDIF                                          182855
      *                                                                   CLE031
      ** If CLE031 is on and PTFI is 'P' do processing for payment        CLE031
      ** settlement method 14                                             CLE031
      *                                                                   CLE031
     C           CLE031    IFEQ 'Y'                                       CLE031
     C           PTFI      ANDEQ'P'                                       CLE031
     C           PSTM      ANDEQ14                                        CLE031
     C           CLE106    OREQ 'Y'                                                           CLE106
     C           CLE031    ANDEQ'Y'                                                           CLE106
     C           PTFI      ANDEQ'S'                                                           CLE106
     C           PSTM      ANDEQ14                                                            CLE106
     C           CLE106    OREQ 'Y'                                                           CLE106
     C           CLE031    ANDEQ'Y'                                                           CLE106
     C           PTFI      ANDEQ'R'                                                           CLE106
     C           PSTM      ANDEQ14                                                            CLE106
      *                                                                   CLE031
      ** Only retail accounts are to be processed for eventual            CLE031
      ** reporting.                                                       CLE031
      *                                                                   CLE031
     C           PONS      IFNE *ZERO                                     CLE031
     C                     MOVELPONS      K#RAN1                          CLE031
     C                     MOVEL#ATP,4    RACTP                                               239481
     C                     EXSR SRACCT                                    CLE031
      *                                                                   CLE031
     C           RECI      IFNE 'C'                                       CLE031
     C           *IN87     ANDEQ*OFF                                      CLE031
      *                                                                   CLE031
     C           FEPSCY    IFNE *BLANKS                                   CLE031
     C           FEPSCY    IFNE TCCY                                      CLE031
      *                                                                   CLE031
      ** Output details to report.                                        CLE031
      *                                                                   CLE031
     C                     MOVELFECNUM    RFCNUM                          CLE031
     C                     MOVELFEFACL    RFFACL                          CLE031
     C                     MOVELFEFSEQ    RFFSEQ                          CLE031
     C                     MOVELFELOAN    RFLOAN                          CLE031
     C                     MOVELFEPSCY    RTRCCY                          CLE031
     C                     MOVELPONS      RRSAN                           CLE031
     C                     MOVELTCCY      RACCY                           CLE031
      *                                                                   CLE031
     C                     EXSR WP1REC                                    CLE031
     C           #CHKLN    IFEQ 'Y'                                       CLE031
     C                     WRITEFEEDSUB                                   CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
     C                     WRITEFEEDDTL                                   CLE031
      *                                                                   CLE031
     C                     ADD  1         R16CTR                          CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
     C                     ELSE                                           CLE031
     C           FEFCCY    IFNE TCCY                                      CLE031
      *                                                                   CLE031
      ** Output details to report.                                        CLE031
      *                                                                   CLE031
     C                     MOVELFECNUM    RFCNUM                          CLE031
     C                     MOVELFEFACL    RFFACL                          CLE031
     C                     MOVELFEFSEQ    RFFSEQ                          CLE031
     C                     MOVELFELOAN    RFLOAN                          CLE031
     C                     MOVELFEFCCY    RTRCCY                          CLE031
     C                     MOVELPONS      RRSAN                           CLE031
     C                     MOVELTCCY      RACCY                           CLE031
      *                                                                   CLE031
     C                     EXSR WP1REC                                    CLE031
     C           #CHKLN    IFEQ 'Y'                                       CLE031
     C                     WRITEFEEDSUB                                   CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
     C                     WRITEFEEDDTL                                   CLE031
      *                                                                   CLE031
     C                     ADD  1         R16CTR                          CLE031
     C                     ENDIF                                          CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
     C                     ENDIF                                          CLE031
      *
     C                     ENDIF                           * RECI *
      *
      ** Read next record.
     C***********          READ LEFEEDL0                 84               146327
     C                     READ LEFEEDL1                 84               146327
      *
     C                     ENDDO
      *
     C                     Z-ADDR16CTR    RCOUNT
     C           RCOUNT    IFEQ 0
      * Print No details.
     C                     WRITENODTLS
     C                     ENDIF
      *
      ** Do Audit report processing.
      *
     C***********          MOVEL'LEFEEDL0'FNAME                           146327
     C                     MOVEL'LEFEEDL1'FNAME                           146327
     C                     EXSR SRAUDT
      *
     C                     ENDSR
      *
      *****************************************************************
      /TITLE SR/SRFEAD
      *****************************************************************
      *                                                               *
      *  SRFEAD - Subroutine to do the Detail Processing for Fee      *
      *           Adjustment for Fee accrual.                         *
      *                                                               *
      *****************************************************************
      *
     C           SRFEAD    BEGSR                           *** SRFEAD ***
      *
      ***  Read first record from File.
      *
     C                     READ LEFEADL1                 85
      *
      ***  Print header of record format.
      *
     C                     MOVEL#RPN,17   REPNAM
     C                     WRITEHEADPY
     C                     WRITEFEADSUB
      *
     C                     Z-ADD0         R17CTR  20
      *
      ***  Do WHILE not end of file.
      *
     C           *IN85     DOWEQ*OFF
      *
     C***********RECI      IFNE '*'                        * RECI *       146327
     C           FARECI    IFNE '*'                                       146327
      *
      ** Receipt Settlement Method = '14'.
      *
     C           RSTM      IFEQ 14
      *                                                                   147975
      ** Only retail accounts are to be processed for eventual            147975
      ** reporting .                                                      147975
      *                                                                   147975
     C           RONS      IFNE *ZERO                                     147975
     C                     MOVELRONS      K#RAN1
     C                     MOVEL#ATP,3    RACTP                                               239481
     C                     EXSR SRACCT
      *
     C           RECI      IFNE 'C'                                       147975
     C           *IN87     ANDEQ*OFF                                      147975
      *                                                                   147975
     C           FASCCY    IFNE *BLANKS
     C           FASCCY    IFNE TCCY
      *
      ** Output details to report.
      *
     C                     MOVELFAFACL    RFFACL
     C                     MOVELFAFSEQ    RFFSEQ
     C                     MOVELFACNUM    RFCNUM
     C                     MOVELFASCCY    RTRCCY
     C                     MOVELRONS      RRSAN
     C                     MOVELTCCY      RACCY
      *
     C                     EXSR WP1REC
     C           #CHKLN    IFEQ 'Y'
     C                     WRITEFEADSUB
     C                     ENDIF
      *
     C                     WRITEFEADDTL
      *
     C                     ADD  1         R17CTR
     C                     ENDIF
      *
     C                     ELSE
     C           FAFCCY    IFNE TCCY
      *
      ** Output details to report.
      *
     C                     MOVELFAFACL    RFFACL
     C                     MOVELFAFSEQ    RFFSEQ
     C                     MOVELFACNUM    RFCNUM
     C                     MOVELFAFCCY    RTRCCY
     C                     MOVELRONS      RRSAN
     C                     MOVELTCCY      RACCY
      *
     C                     EXSR WP1REC
     C           #CHKLN    IFEQ 'Y'
     C                     WRITEFEADSUB
     C                     ENDIF
      *
     C                     WRITEFEADDTL
      *
     C                     ADD  1         R17CTR
     C                     ENDIF
     C                     ENDIF
      *                                                                   147975
     C                     ENDIF                                          147975
      *                                                                   147975
     C                     ENDIF                                          147975
      *
     C                     ENDIF
      *
      ** Payment Settlement Method = '14'.
      *
     C           PSTM      IFEQ 14
      *                                                                   147975
      ** Only retail accounts are to be processed for eventual            147975
      ** reporting .                                                      147975
      *                                                                   147975
     C           PONS      IFNE *ZERO                                     147975
     C                     MOVELPONS      K#RAN1
     C                     MOVEL#ATP,4    RACTP                                               239481
     C                     EXSR SRACCT
      *
     C           RECI      IFNE 'C'                                       147975
     C           *IN87     ANDEQ*OFF                                      147975
      *                                                                   147975
     C           CLE031    IFNE 'Y'                                       CLE031
     C           FASCCY    IFNE *BLANKS
     C           FASCCY    IFNE TCCY
      *
      ** Output details to report.
      *
     C                     MOVELFAFACL    RFFACL
     C                     MOVELFAFSEQ    RFFSEQ
     C                     MOVELFACNUM    RFCNUM
     C                     MOVELFASCCY    RTRCCY
     C                     MOVELPONS      RRSAN
     C                     MOVELTCCY      RACCY
      *
     C                     EXSR WP1REC
     C           #CHKLN    IFEQ 'Y'
     C                     WRITEFEADSUB
     C                     ENDIF
      *
     C                     WRITEFEADDTL
      *
     C                     ADD  1         R17CTR
     C                     ENDIF
      *
     C                     ELSE
     C           FAFCCY    IFNE TCCY
      *
      ** Output details to report.
      *
     C                     MOVELFAFACL    RFFACL
     C                     MOVELFAFSEQ    RFFSEQ
     C                     MOVELFACNUM    RFCNUM
     C                     MOVELFAFCCY    RTRCCY
     C                     MOVELPONS      RRSAN
     C                     MOVELTCCY      RACCY
      *
     C                     EXSR WP1REC
     C           #CHKLN    IFEQ 'Y'
     C                     WRITEFEADSUB
     C                     ENDIF
      *
     C                     WRITEFEADDTL
      *
     C                     ADD  1         R17CTR
     C                     ENDIF
     C                     ENDIF
      *                                                                   CLE031
      ** Processing for CLE031                                            CLE031
      *                                                                   CLE031
     C                     ELSE                                           CLE031
     C           FAPSCY    IFNE *BLANKS                                   CLE031
     C           FAPSCY    IFNE TCCY                                      CLE031
      *                                                                   CLE031
      ** Output details to report.                                        CLE031
      *                                                                   CLE031
     C                     MOVELFAFACL    RFFACL                          CLE031
     C                     MOVELFAFSEQ    RFFSEQ                          CLE031
     C                     MOVELFACNUM    RFCNUM                          CLE031
     C                     MOVELFAPSCY    RTRCCY                          CLE031
     C                     MOVELPONS      RRSAN                           CLE031
     C                     MOVELTCCY      RACCY                           CLE031
      *                                                                   CLE031
     C                     EXSR WP1REC                                    CLE031
     C           #CHKLN    IFEQ 'Y'                                       CLE031
     C                     WRITEFEADSUB                                   CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
     C                     WRITEFEADDTL                                   CLE031
      *                                                                   CLE031
     C                     ADD  1         R17CTR                          CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
     C                     ELSE                                           CLE031
     C           FAFCCY    IFNE TCCY                                      CLE031
      *                                                                   CLE031
      ** Output details to report.                                        CLE031
      *                                                                   CLE031
     C                     MOVELFAFACL    RFFACL                          CLE031
     C                     MOVELFAFSEQ    RFFSEQ                          CLE031
     C                     MOVELFACNUM    RFCNUM                          CLE031
     C                     MOVELFAFCCY    RTRCCY                          CLE031
     C                     MOVELPONS      RRSAN                           CLE031
     C                     MOVELTCCY      RACCY                           CLE031
      *                                                                   CLE031
     C                     EXSR WP1REC                                    CLE031
     C           #CHKLN    IFEQ 'Y'                                       CLE031
     C                     WRITEFEADSUB                                   CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
     C                     WRITEFEADDTL                                   CLE031
      *                                                                   CLE031
     C                     ADD  1         R17CTR                          CLE031
     C                     ENDIF                                          CLE031
     C                     ENDIF                                          CLE031
      *                                                                   CLE031
     C                     ENDIF                                          CLE031
      *                                                                   147975
     C                     ENDIF                                          147975
      *                                                                   147975
     C                     ENDIF                                          147975
      *
     C                     ENDIF
      *
     C                     ENDIF                           * RECI *
      *
      ** Read next record.
     C                     READ LEFEADL1                 85
      *
     C                     ENDDO
      *
     C                     Z-ADDR17CTR    RCOUNT
     C           RCOUNT    IFEQ 0
      * Print No details.
     C                     WRITENODTLS
     C                     ENDIF
      *
      ** Do Audit report processing.
      *
     C                     MOVEL'LEFEADL1'FNAME
     C                     EXSR SRAUDT
      *
     C                     ENDSR
      *
      *****************************************************************
      /TITLE SR/SRPORT
      *****************************************************************
      *                                                               *
      *  SRPORT - Subroutine to do the Detail Processing for PM Live  *
      *           Portfolio Definition records.                       *
      *                                                               *
      *****************************************************************
      *
     C           SRPORT    BEGSR                           *** SRPORT ***
      *
      ***  Read first record from File.
      *
     C                     READ PMPORTL1                 86
      *
      ***  Print header of record format.
      *
     C                     MOVEL#RPN,18   REPNAM
     C                     WRITEHEADPY
     C                     WRITEPORTSUB
      *
     C                     Z-ADD0         R18CTR  20
      *
      ***  Do WHILE not end of file.
      *
     C           *IN86     DOWEQ*OFF
      *
      ** If Customer Account is Retail number.
      *
     C                     MOVE *BLANKS   P10
     C                     MOVE *BLANKS   P11
      *
     C                     MOVELPNCUSA    P10
     C                     MOVELPNCUSA    P11
     C                     MOVE P11       P01
     C                     MOVE P10       P02
     C           P01       IFEQ *BLANKS
     C           P02       ANDNE*BLANKS
     C                     MOVE P10       K#RAN1
     C                     EXSR SRACCT
      *
     C           RECI      IFNE 'C'                                       147975
     C           *IN87     ANDEQ*OFF                                      147975
      *                                                                   147975
     C           PNCSCY    IFNE TCCY
      *
      ** Output details to report.
      *
     C                     MOVELPNCNUM    RPCNUM
     C                     MOVELPNPTFR    RPPTFR
     C                     MOVELPNCSCY    RPCSCY
     C                     MOVELPNCUSA    RPCUSA
     C                     MOVELTCCY      RACCY
      *
     C                     EXSR WP1REC
     C           #CHKLN    IFEQ 'Y'
     C                     WRITEPORTSUB
     C                     ENDIF
      *
     C                     WRITEPORTDTL
      *
     C                     ADD  1         R18CTR
     C                     ENDIF
      *                                                                   147975
     C                     ENDIF                                          147975
     C                     ENDIF
      *
     C                     READ PMPORTL1                 86
     C                     ENDDO
      *
     C                     Z-ADDR18CTR    RCOUNT
     C           RCOUNT    IFEQ 0
      * Print No details.
     C                     WRITENODTLS
     C                     ENDIF
      *
      ** Do Audit report processing.
      *
     C                     MOVEL'PMPORTL1'FNAME
     C                     EXSR SRAUDT
      *
     C                     ENDSR
      *
      *****************************************************************
      /TITLE SR/SRACCT
      *****************************************************************
      *                                                               *
      *  SRACCT - Subroutine for Retail Settlement account.           *
      *                                                               *
      *****************************************************************
      *
     C           SRACCT    BEGSR                           *** SRACCT ***
      *
     C           K#RAN1    CHAINACCNTL1              87
     C           *IN87     IFEQ *ON
     C***********          MOVEL'***'     TCCY    3                       147975
     C                     ELSE
     C***********          MOVELCCY       TCCY                            147975
     C                     MOVELCCY       TCCY    3                       147975
     C                     ENDIF
      *
     C                     ENDSR
      *
      *****************************************************************
      /TITLE SR/SRENDP
      *****************************************************************
      *                                                               *
      *  SRENDP - Subroutine to close printer file at the end of      *
      *           detail processing.                                  *
      *                                                               *
      *****************************************************************
      *
     C           SRENDP    BEGSR                           *** SRENDP ***
      *
     C                     CLOSEEU0190P1
      *
      ***  End Program and Return.
      *
     C                     SETON                     LR
      *
     C                     ENDSR
      *
      *****************************************************************
      /TITLE SR/SRAUDT
      *****************************************************************
      *                                                               *
      *  SRAUDT - Subroutine to Output Audit report.                  *
      *                                                               *
      *****************************************************************
      *
     C           SRAUDT    BEGSR                           *** SRAUDT ***
      *
      **  Print Header.
      *
     C           #FIRST    IFEQ 'Y'
     C                     WRITEHEADAU
     C                     WRITECONTROL
     C                     MOVE 'N'       #FIRST  1
     C                     ENDIF
      *
      *** If no records read, Output "No Details" message.
      *
     C           RCOUNT    IFEQ 0
     C                     WRITENRECS2
     C                     ELSE
     C                     WRITENRECS1
     C                     ENDIF
      *
     C                     MOVEL*BLANKS   FNAME
      *
      ****If*program*is*running*in*input*cycle*termination.************                       CCB020
      ** If program is running in Close of Business.                                          CCB020
      *
     C********** P#PARM    IFNE 'A'                                                           CCB020
     C           WCOB      IFEQ '*YES'                                                        CCB020
     C           RCOUNT    IFGT 0
     C                     SETON                     U7U8
     C                     ENDIF
     C                     ENDIF
      *
     C                     ENDSR
      *
      *****************************************************************
      /TITLE SR/SRCURR
      *****************************************************************
      *                                                               *
      *  SRCURR - Calls AOCURRR0                                      *
      *                                                               *
      *  Calls    : *PSSR  - Program Error Processing                 *
      *             AOCURRR0 Access Program                           *
      *                                                               *
      *****************************************************************
      *
     C           SRCURR    BEGSR
      *
      ***  Call Access Program for Currency Details
      *
     C                     CALL 'AOCURRR0'
     C                     PARM *BLANKS   @RTCD
     C                     PARM '*KEY    '@OPTN
     C                     PARM WCCY      @CURR   3
     C           SDCURR    PARM SDCURR    DSSDY
      *
      ***  Handle Database Error.
      *
     C           @RTCD     IFNE *BLANKS
     C           *LOCK     IN   LDA
     C                     MOVEL'SDCURRPD'DBFILE           ************
     C                     MOVELWCCY      DBKEY            * DBERR 04 *
     C                     Z-ADD04        DBASE            ************
     C                     MOVEL'EU0190'  DBPGM
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     ENDIF
      *
     C                     ENDSR
      *****************************************************************
      /TITLE SR/WP1REC
      *****************************************************************
      *                                                               *
      *  WP1REC - Subroutine to Check if Sufficient line remains for  *
      *           the format.                                         *
      *                                                               *
      *****************************************************************
      *
     C           WP1REC    BEGSR                           *** WP1REC ***
      *
      ***  Check that sufficient lines remain for the Format. If not,
      ***  write out the Main Headings on a new page.
      *
     C                     MOVE 'N'       #CHKLN  1
     C                     Z-ADD3         RQDLN1
     C           OFLLN1    SUB  PRTLN1    DIFLN1
     C           DIFLN1    IFLE RQDLN1
     C                     WRITEHEADPY
     C                     MOVE 'Y'       #CHKLN
     C                     ENDIF
      *
     C                     ENDSR
      *
      *****************************************************************
      /TITLE SR/WP1END
      *****************************************************************
      *                                                               *
      *  WP1END - Subroutine to Write End of Report.                  *
      *                                                               *
      *****************************************************************
      *
     C           WP1END    BEGSR                           *** WP1END ***
      *
      ***  Check that sufficient lines remain for the Format. If not,
      ***  write out the Main Headings on a new page.
      *
     C                     Z-ADD4         RQDLN1
     C           OFLLN1    SUB  PRTLN1    DIFLN1
     C           DIFLN1    IFLE RQDLN1
     C                     WRITEHEADPY
     C                     ENDIF
      *
      ***  Write out Total Format.
      *
     C                     WRITETRAILPY
      *
     C                     ENDSR
      *
      *****************************************************************
      /TITLE SR/AUDIT
      *****************************************************************
      *                                                               *
      *  AUDIT  - Subroutine to Output Audit report and End Program.  *
      *                                                               *
      *****************************************************************
      *
     C           AUDIT     BEGSR                           *** AUDIT  ***
      *
      ***  Output Report Header and File Controls.
      *
     C                     WRITEHEADAU
     C                     WRITECONTROL
      *
      ***  If there is a DB Error, Output the DB Error Information.
      *
     C           *INU7     IFEQ *ON
     C                     WRITEDBERROR
     C                     ELSE
      *
      ***  Or, if no records read, Output "No Details" message.
      *
     C           RCOUNT    IFEQ 0
     C                     WRITENODTLS
     C                     ENDIF
     C                     ENDIF
      *
      ***  End Program and Return.
      *
     C                     SETON                     LR
     C                     RETRN
      *
     C                     ENDSR
      *
      *****************************************************************
      /TITLE SR/*PSSR
      *****************************************************************
      *                                                               *
      *  *PSSR  - Error control subroutine                            *
      *                                                               *
      *****************************************************************
      *
     C           *PSSR     BEGSR                           ** *PSSR **
      *
      ***  Check to see that *PSSR has not already been called.
      *
     C           WRUN      IFEQ *BLANK
     C                     MOVE 'Y'       WRUN    1
      *
     C                     SETON                     U7U8LR
     C                     DUMP
     C                     EXSR AUDIT
     C                     ENDIF
      *
      ***  If *PSSR already run, then just end the program here.
      *
     C                     SETON                     U7U8LR
     C                     RETRN
      *
     C                     ENDSR
      *
      *****************************************************************
      /TITLE SR/RCFP1
      *****************************************************************
      *                                                               *
      *  RCFP1  - Subroutine to register the P1 Printer File via RCF. *
      *                                                               *
      *****************************************************************
      *
     C           RCFP1     BEGSR                            *** RCFP1  ***
      *
      ***  Ensure Report Spool File recorded by RCF.
      *
     C                     Z-ADDSFNUM1    ZSNUM   60
      *
     C                     CALL 'ZSFILE'
     C                     PARM PSEQ1     SEQ     5
     C                     PARM           SENTY   3
     C                     PARM           SFILE1
     C                     PARM           ZSNUM
     C                     PARM           ZSERR   1
      *
      ***  If Error occurs during ZSFILE processing, then return to the
      ***  Calling Program.
      *
     C           ZSERR     IFEQ 'Y'
     C                     SETON                     U7U8LR
     C                     RETRN
     C                     ENDIF
      *
     C                     ENDSR
      *
      *****************************************************************
      /TITLE SR/RCFAU
      *****************************************************************
      *                                                               *
      *  RCFAU  - Subroutine to register the AU Printer File via RCF. *
      *                                                               *
      *****************************************************************
      *
     C           RCFAU     BEGSR                            *** RCFAU  ***
      *
      ***  Ensure Audit Spool File recorded by RCF.
      *
     C                     Z-ADDSFNUMU    ZSNUMU  60
      *
     C                     CALL 'ZSFILE'
     C                     PARM PSEQ1     SEQ
     C                     PARM *BLANKS   SENTY
     C                     PARM           SFILEU
     C                     PARM           ZSNUMU
     C                     PARM *BLANK    ZSERR
      *
      ***  If Error occurs during ZSFILE processing, then return to the
      ***  Calling Program.
      *
     C           ZSERR     IFEQ 'Y'
     C                     SETON                     U7U8LR
     C                     RETRN
     C                     ENDIF
      *
     C                     ENDSR
      *
      *****************************************************************
     C/COPY WNCPYSRC,EU0190C016
      /TITLE SR/ZDATE2
     C/COPY ZSRSRC,ZDATE2Z2
      /TITLE SR/ZSEDIT
     C/COPY ZSRSRC,ZSEDITZ3
**  CPY@
(c) Misys International Banking Systems Ltd. 2001
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
**  #RPN
CUSTOMER EXCHANGES
DEALS
DEAL AMENDMENTS
OUTGOING PAYMENTS
INCOMING PAYMENTS
CHEQUES FOR COLLECTION
CHEQUES TO BE PAID
LOANS
LOAN AMENDMENTS
STANDING ORDERS
RE TELLER TRANSACTIONS
SWEEPS
FUTURES AND OPTIONS TRADES
TRADES
FACILITIES
FACILITIES FEES
FEES ADJUSTMENTS
PORTFOLIO MANAGEMENT
POSITION SETTLEMENT
START OF BUSINESS TRADES
**  #ATP
START DATE ACCOUNT
MATURITY DATE ACCOUNT
RECEIPT ACCOUNT
PAYMENT ACCOUNT
PURCHASE CCY ACCOUNT
SELL CCY ACCOUNT
DESTINATION
SENDER'S CORRESPONDENT
ORDERING CUSTOMER
ORDERING BANK
SENDER
RECEIVER'S CORRESPONDENT
THIRD REIMBURSEMENT INST
BENEFICIARY
ACCOUNT WITH BANK
COLLECTING BANK
CREDIT PARTY
REMITTING BANK
DEBIT PARTY
PAY- ROLLOVER
ROLLOVER DATE ACCOUNT
ROLLOVER PAY OUR NOSTRO
SETTLEMENT ACCOUNT
OUR BANK ACCOUNT
RECEIPT- ROLLOVER
