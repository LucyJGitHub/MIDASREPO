     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas EU EMU GL accounts extract')                     *
      *****************************************************************
      *                                                               *
      *  Midas - EMU Module                                           *
      *                                                               *
      *  EU0720 - EMU GL Accoutns Extract                             *
      *                                                               *
      *  Function:  This program reads the open query file created    *
      *  (I/C)      in the CLP/EUC0700.  Following the range          *
      *             (received as entry parameter), it writes the      *
      *             selected records in the extract file PF/EUWORKPD. *
      *                                                               *
      *  Called By: EUC0700 - 'In' Currency to Euro GL Account Mapping*
      *                                                               *
      *  (c) Finastra International Limited 2001                      *
      *                                                               *
      *  Last Amend No. MD046248           Date 27Oct17               *
      *  Prev Amend No. CRE073             Date 06Dec10               *
      *                 CRE075             Date 06Dec10               *
      *                 CER059             Date 19Jul10               *
      *                 CER047             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD027             Date 09Dec05               *
      *                 CLE025             Date 20Oct03               *
      *                 CGL029             Date 01Sep03               *
      * Midas Release 4.01 -------------------------------------------*
      *                 CPK015             Date 28Jun02               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 CEU028  *CREATE    Date 24Aug98               *
      *                                                               *
      *---------------------------------------------------------------*
      *                                                               *
      *  MD046248 - Finastra Rebranding                               *
      *  CRE073 - Interest Rate Rounding (Recompile)                  *
      *  CRE075 - Effective Date for Retail Accounts (Recompile)      *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  CER047 - German Features LF037-00 Reporting §24c KWG         *
      *           (Recompile)                                         *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  CPK015 - Release 4.01 Packaging:                             *
      *           - A default timestamp string is required for WRITE. *
      *  CEU028 - EMU GL Utilities                                    *
      *                                                               *
      *****************************************************************
     FACCNTAB IF  E                    DISK         KINFSR *PSSR
     FEUWORKPDO   E                    DISK         KINFSR *PSSR
     F            ACCNTABF                          KRENAMEWORKPF
      *
      *****************************************************************
      *                                                               *
      *  F U N C T I O N   O F   I N D I C A T O R S                  *
      *                                                               *
      *  20 - EOF for ACCNTAB                                         *
      *                                                               *
      *****************************************************************
      /EJECT
     E                    STAMP   1   1 26                                                    CPK015
      ** Array containing dummy timestamp                                                     CPK015
     E                    CPY@    1   1 80
      *
      ** Array containing Copyright statement
      *
      /SPACE 3
      *
      *****************************************************************
      *                                                               *
      *  P001 - Main Processing                                       *
      *                                                               *
      *  Called by: None                                              *
      *                                                               *
      *  Calls:     None                                              *
      *                                                               *
      *****************************************************************
      *                                                               *
     C           *ENTRY    PLIST
     C**********           PARM           PFRAC   4                                           CGL029
     C**********           PARM           PTOAC   4                                           CGL029
     C                     PARM           PFRAC  10                                           CGL029
     C                     PARM           PTOAC  10                                           CGL029
      *
     C                     MOVEACPY@      BIS@   80
     C**********           MOVE PFRAC     WFRAC   40                                          CGL029
     C**********           MOVE PTOAC     WTOAC   40                                          CGL029
     C                     MOVE PFRAC     WFRAC  100                                          CGL029
     C                     MOVE PTOAC     WTOAC  100                                          CGL029
      *
     C                     READ ACCNTAB                  20
      *
     C           *IN20     DOWEQ*OFF
      *
      ** If Account Code is greater than or equal to 'From Account' and
      ** less than or equal to 'To Account'
      *
     C           ACOD      IFGE WFRAC
     C           ACOD      ANDLEWTOAC
     C                     MOVEASTAMP,1   TMST             Default Timestamp                  CPK015
     C                     WRITEWORKPF
     C                     ENDIF
      *
     C                     READ ACCNTAB                  20
      *
     C                     ENDDO
      *
     C                     MOVE *ON       *INLR
      *****************************************************************
      /EJECT
      *****************************************************************
      *                                                               *
      * *PSSR  - Program exception error routine                      *
      *          Called automatically if a program error occurs,      *
      *          or directly by the program code using EXSR.          *
      *          This subroutine DUMPs the program just once.         *
      *                                                               *
      *****************************************************************
      *
     C           *PSSR     BEGSR
      *
     C           WRUN      IFEQ *BLANK
     C                     MOVE 'Y'       WRUN    1
     C                     DUMP
     C                     END
      *
      ** If *PSSR already run, then just end the program here
      *
     C                     MOVE *ON       *INU7
     C                     MOVE *ON       *INU8
     C                     MOVE *ON       *INLR
     C                     RETRN
      *
     C                     ENDSR
      *
      ********************************************************************
      *
** STAMP - Dummy timestamp                                                                    CPK015
0001-01-01-00.00.00.000000                                                                    CPK015
**  CPY@
(c) Finastra International Limited 2001
