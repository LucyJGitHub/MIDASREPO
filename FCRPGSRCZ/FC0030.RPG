     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas FC Retrieve report parameters')
     F********************************************************************
     F*                                                                  *
     F*  Midas - Report Control Facility Module
     F*                                                                  *
     F*  FC0030 - PERIODIC REQUESTS ENQUIRY                              *
     F*                                                                  *
     F*  (c) Finastra International Limited 2001                         *
     F*                                                                  *
      *  Last Amend No. MD046248           Date 27Oct17               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
     F*      PREV AMEND.NO.                  DATE 00/00/00               *
     F*                                      DATE 00/00/00               *
      ********************************************************************
      *  MD046248 - Finastra Rebranding                               *
      ********************************************************************
      *  C R E A T I O N     P A R A M E T E R S
      *
      *
      ********************************************************************
      *****************************************************************
      * OPERATION
      * ~~~~~~~~~
      *
      *
      *      INDICATORS: 88 - RECORD FOUND INDICATOR
      *
      *****************************************************************
      *
      *****************************************************************
      * FILE DECLARATION
      *****************************************************************
      *
     FFCRCOML1IF  E           K        DISK
      *
     E                    CPY@    1   1 80
      *
      **
      * DATA STRUCTURE FOR DATABASE ERROR
     ILDA         DS                            256
     I                                      134 141 DBFILE
     I                                      142 170 DBKEY
     I                                      171 180 DBPGM
     I                                      181 1830DBASE
      *
      **
      * DATA STRUCTURE FOR FIELDS IN KLIST (FOR ERROR HANDLING)
      *
     IPFLDS       DS                             25
     I                                        1  10 FPRPG
     I                                       11  20 FPGCL
     I                                       20  25 FOCCU
      *****************************************************************
      *         INITIALISE PARAMATER LIST, SET KEY.
      *****************************************************************
      **
     C                     MOVEACPY@      BIS@   80
     C           *NAMVAR   DEFN           LDA
      *
      **
      * PARAMETER PASSED FROM       :
      **
     C           *ENTRY    PLIST
     C                     PARM           PGRPG  10
     C                     PARM           PGCL   10
     C                     PARM           OCCU    5
     C                     PARM           PARMS 100
     C                     PARM           PNAM   10
     C**
     C* KLIST TO READ FCRCOML1
     C*
     C           PARMKY    KLIST
     C                     KFLD           PGRPG
     C                     KFLD           PGCL
     C                     KFLD           OCCU
      *****************************************************************
      * MAIN
      *****************************************************************
      *
     C                     EXSR BCHAIN
     C                     EXSR CTERM
      ********PROG END
      /EJECT
      *****************************************************************
      *                 SUBROUTINES
      *
      * BCHAIN - PERFORMS CHAIN TO FCRCOML1
      * BANOTF - PERFORMED IF NO RECORD FOUND IN FCRCOML1
      * *PSSR  - DATABASE ERROR HANDLING ROUTINE
      * BBRFND - PERFORMED IF RECORD FOUND IN FCRCOML1
      * CTERM  - PROGRAM EXIT ROUTINE
      *****************************************************************
      /EJECT
      *****************************************************************
      *BCHAIN - CHAIN TO FCRCOML1 USING PARMKEY
      *(CALLED FROM MAIN)
      *****************************************************************
     C           BCHAIN    BEGSR
     C           PARMKY    CHAINFCRCOML1             88
     C           *IN88     IFEQ '1'
     C                     EXSR BANOTF
     C                     ELSE
     C                     EXSR BBRFND
     C                     END
     C                     ENDSR
      *****************************************************************
      * BANOTF - RECORD NOT FOUND
      * (CALLED FROM BCHAIN)
      *****************************************************************
      *
     C           BANOTF    BEGSR
     C           *LOCK     IN   LDA
      * MOVE VARIABLES INTO PFLDS *
     C                     MOVELPGRPG     FPRPG
     C                     MOVELPGCL      FPGCL
     C                     MOVELOCCU      FOCCU
      *
     C                     MOVEL'FCRCOML1'DBFILE
     C                     MOVELPFLDS     DBKEY            ************
     C                     MOVEL'FC0030'  DBPGM            *DBERR 001 *
     C                     MOVEL'001'     DBASE            ************
     C                     EXSR *PSSR
     C                     SETON                     U7U8
     C                     OUT  LDA
     C                     ENDSR
      *****************************************************************
      * *PSSR - DATABASE ERROR HANDLING ROUTINE
      * (CALLED FROM BANOTF)
      *****************************************************************
     C           *PSSR     BEGSR
     C           @RUN      IFEQ *BLANK
     C                     MOVE 'Y'       @RUN    1
     C                     DUMP
     C                     END
     C                     ENDSR
      *****************************************************************
      * BBRFND - RECORD FOUND
      * (CALLED FROM BCHAIN)
      *****************************************************************
     C           BBRFND    BEGSR
     C                     MOVE D3CLPM    PARMS
     C                     MOVE D3PRPG    PNAM
     C                     ENDSR
      *****************************************************************
      * CTERM - PROGRAM EXIT
      * (CALLED FROM MAIN)
      *****************************************************************
     C           CTERM     BEGSR
     C                     SETON                     LR
     C                     RETRN
     C                     ENDSR
** CPY@
(c) Finastra International Limited 2001
