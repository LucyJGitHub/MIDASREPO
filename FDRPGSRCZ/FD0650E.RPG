     H*********** Y                                                                           CAS001
     H        1   Y                                                                           CAS001
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas FD Display deal type/subtypes')                  *
/*XBI1*  OVRDBF FILE(GPPRDXL0) TOFILE(GPPRODXL0)                      *                       BG0257
/*XBI2*  OVRDBF FILE(GPINSXL0) TOFILE(GPINSTXL0)                      *                       BG0257
     H/TITLE Midas Display Deal type/subtypes Display file
     Z* CRTRPGPGM
      *
     H* SYNOPSIS :
     H*  - Displays the records from DBF as a subfile.
     H*  - Loads the SFL from the SBF a page at a time.
     H*  - The DBF record at which the SFL display starts may be
     H*    controlled by positioning fields on the SFL header.
     H*  - Any key fields on the SFL header will be used as
     H*    positioning values.
     H*  - Any non-key fields on the SFL header will be used as
     H*    selection values: a maximum of W0SLM records will be
     H*    read from the DBF before giving up.
     H* Generated by  : Synon/2  Version:  8646
     H* Function type : Display file  Version:   0.1
      *
     H*  Company :
     H*  System  : Midas Standing Data
     H* User name  : MIDAS
     H* Date       : 14/01/91 time: 12:44:07
      *  (c) Misys International Banking Systems Ltd. 2001            *
     H*
      *================================================================
     M* Maintenance   :
      *================================================================
     F*****************************************************************
      *                                                               *
      *  Last Amend No. AR1068283          Date 19Aug14               *
      *  Prev Amend No. 207288             Date 06Jun03               *
      *                 AR795970           Date 05Jul11               *
      *                 AR787620           Date 10Jun11               *
      *                 CER059             Date 19Jul10               *
      *                 CER047             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 CPK027             Date 30Apr07               *
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD027             Date 09Dec05               *
      *                 CAS009             Date 04May04               *
      *                 CDL038             Date 10May05               *
      *                 CAS008             Date 16Jun04               *
      *                 BUG3039            Date 10Jun04               *
      *                 CLE025             Date 20Oct03               *
      *                 CGL014             Date 20Oct03               *
      *                 CDL019             Date 09Feb04               *
      *                 BG0257             Date 23May03               *
      *                 CAS005             Date 16Dec02               *
      * Midas Release 4.01 -------------------------------------------*
      *                 CAS001             Date 23Nov01               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.04 -----------------------------------------------*
      * Midas DBA 3.03 -----------------------------------------------*
      * Midas DBA 3.02 -----------------------------------------------*
      *                 CPB001             Date 18Jun99               *
      *                 168238             Date 28Sep99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
     F*                 CPL002             DATE 08Mar99               *
     F*                 S01408             DATE 12DEC95               *
     F*                 S01408             DATE 12APR95               *
     F*                 S01408             DATE 06MAR95               *
     F*                 S01486             DATE 29NOV94               *   S01486
     F*                 AUS011             DATE 18JUN92               *   AUS011
     F*                                                               *
     F*****************************************************************
      *                                                               *
      *  AR1068283 - Description field is 35 long not 30 long         *
      *              Applied for MD021909A                            *
      *  207288 - Display spot indicator.                             *
      *           Applied for AR999664 (Child: AR999668)              *
      *  AR795970 - Change §24c to plain 24c (Recompile)              *
      *  AR787620 - Hooks Incorporation                               *
      *             WNCPYSRC,FDH00003                                 *
      *             WNCPYSRC,FDH00004                                 *
      *             WNCPYSRC,FDH00005                                 *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  CER047 - German Features LF037-00 Reporting §24c KWG         *
      *  CPK027 - External field name entry is longer than six(6)     *
      *           characters                                          *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CAS009 - Effective Interest Rate/Amortised Cost Accounting   *
      *  CDL038 - Extended Deal Sub Type                              *
      *  CAS008 - IAS 39 Enhancements                                 *
      *  BUG3039 - Webfacing Changes. Recompile.                      *
      *  CLE025 - Credit Lines                                        *
      *  CGL014 - Collaterals Processing                              *
      *  CDL019 - Allow Base Rate Changes on Fixed Deposits/Loans     *
      *  BG0257 - Errors in Deal Type/Sub Type input                  *
      *  CAS005 - Enhancements to CAS001, CAS002 and CAS004           *
      *  CAS001 - Net Present Value (NPV) Accounting                  *
     F*  CPB001 - 'Private Banking' Module                            *
     F*  168238 - Text Pricing Group not appear on title(recompile).  *
     F*  CPL001 - Addition of Midas-Plato interface fields            *
     F*  S01408 - Addition of core hooks FD0650ECP9                   *
     F*           Addition of core hooks FD0650EFP1                   *
     F*  S01408 - Addition of core hooks FD0650ECP8                   *
     F*  S01408 - Addition of core hooks FD0650EIPG                   *
     F*                                  FD0650ECP7                   *
     F*                                  FD0650ECP1                   *
     F*                                  FD0650ECP2                   *
     F*                                  FD0650ECP3                   *
     F*                                  FD0650ECP4                   *
     F*                                  FD0650ECP5                   *
     F*                                  FD0650ECP6                   *
     F*                                  FD0650EFPG                   *
     F*                                  FD0650ECPG                   *
     F*  S01486 - Porfolio Management Upgrade to Release 10.          *
     F*  AUS011 - AUSTRALIAN PRODUCT - DEAL TYPE/SUB TYPE VALIDATION  *   AUS011
     F*                                                               *
     F********************************************************************
      *                                                                   S01408
     F/COPY WNCPYSRC,FD0650EFP1                                           S01408
      *                                                                   S01408
     FFD0650E#CF  E                    WORKSTN
     F/COPY WNCPYSRC,FDH00003
     F                                        ##RR  KSFILE #SFLRCD
     F                                              KINFDS INFDS#
      * DSP: Display Deal type/subtypes Display file
      *
     FFDDTSTL1IF  E           K        DISK
     F                                              KINFDS INFDS1
      * RTV: Deal type/sub types       Retrieval index
      *
     FGPPRDXL0IF  E           K        DISK                           UC                      BG0257
     F                                              KINFSR *PSSR                              BG0257
     F            GPPRODXD0                         KRENAMEGPPRDXD0                           BG0257
      ** Midas GP Global Products X-Reference                                                 BG0257
      *                                                                                       BG0257
     FGPINSXL0IF  E           K        DISK                           UC                      BG0257
     F                                              KINFSR *PSSR                              BG0257
     F            GPINSTXD0                         KRENAMEGPINSXD0                           BG0257
      ** Midas GP Global Instruments X-Reference                                              BG0257
      *                                                                                       BG0257
      *                                                                   S01408
     FFDDTSTYTIF  E           K        DISK                                                   207288
     F/COPY WNCPYSRC,FD0650EFPG                                           S01408
      *                                                                   S01408
     E* Description     : Copyright notice for inclusion in all programs
     E*
     E********************************************************************
     E                    CPY@    1   1 80               Copyright     array
     E                    OVRC    1   2 80                                                    BG0257
      ** Override Command Array                                                               BG0257
      *                                                                                       BG0257
     I*
     I* Description     : Copyright notice for inclusion in all programs
     I*
      /EJECT
     I              'GOGETZONE'           C         GOPGM                                     BG0257
     I              'ERROR IN GOGETZONE'  C         GOMSG                                     BG0257
      ** Global Processing Constants                                                          BG0257
      *                                                                                       BG0257
      * Data structures:-
     ISDMMOD    E DSSDMMODPD                                              S01486
     I** Dummy record format for access to Modules File                   S01486
     I*                                                                   S01486
     IDSFDY     E DSDSFDY                                                 S01486
     I** First DS for access programs, short data structure               S01486
     I*                                                                   S01486
     ILDA         DS                            256                                           CAS005
      ** Local data area for database error details                                           CAS005
      *                                                                                       CAS005
     ISDYLDC    E DSSDYLDCPD                                                                  CAS001
      ** Dummy record format for access to Yield Curve files                                  CAS001
     I              FSYLDCA                         FYSLCA                                    CPK027
      *                                                                                       CAS001
     ISCSARD    E DSSCSARDPD                                                                  CAS001
      ** External data structures for Switchable Features Details                             CAS001
      *                                                                                       CAS001
     IPGMDS     ESDSY2PGDSP
      * Program data structure.
     IJBDTTM      DS
      * Job date/time.
     I                                        1   60##JDT
     I                                        1   20##JYY
     I                                        3   40##JMM
     I                                        5   60##JDD
     I                                        7  120##JTM
     I                                        7   80##JHH
     I                                        9  100##JNN
     I                                       11  120##JSS
     IINFDS#    E DSY2I#DSP
      * Display file information data structure.
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure.
      *
     IRUNDAT      DS
     I                                        1   7 MRDT                  S01229
     I                                    P   8  100RDNB                  S01229
     I                                       11  11 SUC                   S01229
     I                                       12  12 DFF                   S01229
     I                                       13  13 MBIN                  S01229
     I/COPY WNCPYSRC,FD0650EI01
     IA@CPY       DS
     I* Copyright array
     I                                        1  80 CPY@
     C*                                                                   S01408
     C/COPY WNCPYSRC,FD0650EIPG                                           S01408
     C*                                                                   S01408
      /EJECT
      *****************************************************************
     C           *ENTRY    PLIST                           Entry parameter
     C                     PARM           P0RTN   7        Return code
      *****************************************************************
      * Initialise
     C                     EXSR ZZINIT
      *
     C                     DO   *HIVAL
      * Initialise & load subfile page.
     C                     EXSR BAIZSF
     C                     MOVEL'N'       W0RSF   1
      * Display screen until reload requested:
     C           W0RSF     DOWEQ'N'
      * Display screen.
     C                     EXSR CAEXFM
      *   Process response:
      * Cancel & exit program.
     C   03                CAS            ZXEXPG
      * HOME: Request subfile reload.
     C   05                CAS            FBRQRL
      *   Display next SFL page.
     C   27                CAS            BBLDSF
      *   Process screen input.
     C                     CAS            DAPR##
     C                     END
      *
     C                     END                             OD W0RSF
     C                     END                             OD *HIVAL
      *****************************************************************
      /EJECT
     CSR         BAIZSF    BEGSR
      *================================================================
      * Initialise & Load subfile page.
      *================================================================
      * Clear subfile.
     C                     SETON                     80
     C                     WRITE#SFLCTL
     C                     SETOF                     80
      * Reset no of records in subfile.
     C                     Z-ADD*ZERO     ##RRMX  50 81     SETOF 81
      * Position DBF file:
     C           KPOS      KLIST
     C                     KFLD           DTPE11           Deal type
     C                     KFLD           DLST11           Subtype
     C                     KFLD           CLAS11           Class                              CDL038
      * Setup key.
     C                     MOVEL#2DTPE    DTPE11           Deal type
     C                     MOVEL#2DLST    DLST11           Subtype
     C                     MOVEL#2CLAS    CLAS11           Class                              CDL038
     C/COPY WNCPYSRC,FD0650EC09
     C           KPOS      SETLLFDDTSTPD
     C                     READ FDDTSTPD               8782*82=EOF
     C*                                                                   S01408
     C/COPY WNCPYSRC,FD0650ECPG                                           S01408
     C*                                                                   S01408
      * Save previous selector values.
     C           *LIKE     DEFN #2LCD     WZLCD
     C                     MOVEL#2LCD     WZLCD            Last Change Dat
     C           *LIKE     DEFN #2TYLC    WZTYLC
     C                     MOVEL#2TYLC    WZTYLC           Type of Last Ch
     C           *LIKE     DEFN #2DTPE    WZDTPE
     C                     MOVEL#2DTPE    WZDTPE           Deal type
     C           *LIKE     DEFN #2DLST    WZDLST
     C                     MOVEL#2DLST    WZDLST           Subtype
     C           *LIKE     DEFN #2CLAS    WZCLAS                                              CDL038
     C                     MOVEL#2CLAS    WZCLAS           Class                              CDL038
     C           *LIKE     DEFN #2NARR    WZNARR
     C                     MOVEL#2NARR    WZNARR           Description of
     C/COPY WNCPYSRC,FD0650EC10
      * Translate search mask for text field.
     C                     MOVEL'QSYST'   WQB10X 10
     C                     MOVE 'RNTBL'   WQB10X
     C           *LIKE     DEFN #2NARR    WQNARR           Description of
     C                     CALL 'QDCXLATE'
     C                     PARM 30        WQA5N   50       Len
     C                     PARM #2NARR    WQNARR           Description of
     C                     PARM           WQB10X           QSYSTRNTBL
     C                     PARM 'QSYS'    WQC10X 10
     C/COPY WNCPYSRC,FD0650EC05
      *                                                                   S01486
      **  Set up Fix Base Rate                                                                CDL019
     C           *LIKE     DEFN #2FBRT    WZFBRT                                              CDL019
     C           CDL019    IFEQ 'Y'                                                           CDL019
     C                     MOVEL#2FBRT    WZFBRT                                              CDL019
     C                     ENDIF                                                              CDL019
      **  Set up Instrument Type                                          S01486
     C           *LIKE     DEFN #2INNR    WZINNR                          S01486
     C                     MOVEL#2INNR    WZINNR                          S01486
      *                                                                   CPL001
      **  Set up Midas-Plato interface fields                             CPL001
      *                                                                   CPL001
     C           *LIKE     DEFN #2PLDP    WZPLDP                          CPL001
     C                     MOVEL#2PLDP    WZPLDP                          CPL001
      *                                                                   CPL001
     C           *LIKE     DEFN #2PLDR    WZPLDR                          CPL001
     C                     MOVEL#2PLDR    WZPLDR                          CPL001
      *                                                                   CPL001
     C           *LIKE     DEFN #2PLCR    WZPLCR                          CPL001
     C                     MOVEL#2PLCR    WZPLCR                          CPL001
      *                                                                                       CAS001
      **  Set up Amortised Cost Accounting Indicator                                          CAS009
     C           CAS009    IFEQ 'Y'                                                           CAS009
     C           *LIKE     DEFN #2ACAI    WZACAI                                              CAS009
     C                     MOVEL#2ACAI    WZACAI                                              CAS009
     C                     ENDIF                                                              CAS009
      *                                                                                       CAS009
      ** If CAS001 is installed, set up Yield Curve fields                                    CAS001
      *                                                                                       CAS001
     C           CAS001    IFEQ 'Y'                                                           CAS001
     C/COPY WNCPYSRC,FDH00046
     C                     MOVEL#2OURY    WZOURY  5                                           CAS001
     C                     MOVEL#2THRY    WZTHRY  5                                           CAS001
     C                     MOVEL#2YLDM    WZYLDM  1                                           CAS001
     C                     ENDIF                                                              CAS001
      *                                                                                       CAS005
      ** If CAS005 is installed, set up Forward Yield Curve fields                            CAS005
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     MOVEL#2ORFY    WZORFY  5                                           CAS005
     C                     MOVEL#2THFY    WZTHFY  5                                           CAS005
     C                     MOVEL#2FYCM    WZFYCM  1                                           CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       BG0257
      ** If CGP001 is installed, set up Product and Instrument fields                         BG0257
      *                                                                                       BG0257
     C           CGP001    IFEQ 'Y'                                                           BG0257
     C                     MOVEL#2PRDC    WZPRDC 10                                           BG0257
     C                     MOVEL#2INSC    WZINSC 10                                           BG0257
     C                     ENDIF                                                              BG0257
      *                                                                                       CAS005
      ** If CAS008 and CIR003 is installed, set up Forward Commitment                         CAS008
      ** yield curve.                                                                         CAS008
      *                                                                                       CAS008
     C           *IN57     IFEQ *ON                                                           CAS008
     C                     MOVEL#2OFCY    WZOFCY  5                                           CAS008
     C                     MOVEL#2TFCY    WZTFCY  5                                           CAS008
     C                     MOVEL#2FCCM    WZFCCM  1                                           CAS008
     C                     ENDIF                                                              CAS008
      *                                                                                       CAS008
      *                                                                                       CAS009
      ** If CAS009 is installed, set up Amortised Cost Acctg. Ind.                            CAS009
      *                                                                                       CAS009
     C           CAS009    IFEQ 'Y'                                                           CAS009
     C                     MOVEL#2ACAI    WSACAI  1                                           CAS009
     C                     ENDIF                                                              CAS009
      *                                                                                       CAS009
      * Load subfile page.
     C                     Z-ADD0         ##RROK  50
     C                     EXSR BBLDSF
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         BBLDSF    BEGSR
      *================================================================
      * Load subfile page.
      *================================================================
      * Re-establish fields in read-ahead record.
     C   27                DO
     C/COPY WNCPYSRC,FD0650EC11
     C  N82                READPFDDTSTPD                 90*
     C  N82                READ FDDTSTPD                 90*
     C*                                                                   S01408
     C/COPY WNCPYSRC,FD0650ECP1                                           S01408
     C*                                                                   S01408
     C                     END
     C/COPY WNCPYSRC,FD0650EC07
      *
      * Setof record error indicators.
     C                     MOVEL*ALL'0'   WKIND0  1
     C                     MOVEAWKIND0    *IN,33
      * Start at previous highest record in SFL.
     C                     Z-ADD##RRMX    ##RR    50
      * Reset count of DBF records read.
     C                     Z-ADD0         ##RRRD  50
      *................................................................
      * Load next SFL page until SFL page full, or :
      * scan limit reached.
     C           *IN82     DOWEQ'0'                        DO
     C           ##RROK    ANDLT##SFPG
     C           ##RRRD    ANDLTW0SLM
      * Check selection fields - if fail, read next record.
     C           #2LCD     IFNE *ZERO                      Last Change Dat
     C           LCD11     CABNE#2LCD     BB020            Last Change Dat
     C                     END
     C           #2TYLC    IFNE *BLANK                     Type of Last Ch
     C           TYLC11    CABNE#2TYLC    BB020            Type of Last Ch
     C                     END
     C           #2NARR    IFNE *BLANK                     Description of
      * Scan for search string.
     C                     CALL 'QCLSCAN'
     C                     PARM           NARR11           Description of
     C**********           PARM 30        WQA3N   30       Length                          AR1068283
     C                     PARM 35        WQA3N   30       Length                          AR1068283
     C                     PARM 1         WQB3N   30       Start
     C                     PARM           WQNARR           Mask
     C**********           PARM 30        WQC3N   30       Length                          AR1068283
     C                     PARM 35        WQC3N   30       Length                          AR1068283
     C                     PARM '1'       WQD1    1        Translate
     C                     PARM '1'       WQE1    1        Trim
     C                     PARM '?'       WQF1    1        Wild
     C                     PARM           WQG3N   30       Result
     C           WQG3N     CABLT1         BB020
     C                     END
     C           #2FBRT    IFNE *BLANK                                                        CDL019
     C           FDFBRT    CABNE#2FBRT    BB020                                               CDL019
     C                     END                                                                CDL019
     C           #2INNR    IFNE *BLANK                                    CPL002
     C           INNR      CABNE#2INNR    BB020                           CPL002
     C                     END                                            CPL002
     C           #2PLDP    IFNE *BLANK                                    CPL002
     C           PLDPCD    CABNE#2PLDP    BB020                           CPL002
     C                     END                                            CPL002
     C           #2PLDR    IFNE *BLANK                                    CPL002
     C           PLDRCD    CABNE#2PLDR    BB020                           CPL002
     C                     END                                            CPL002
     C           #2PLCR    IFNE *BLANK                                    CPL002
     C           PLCRED    CABNE#2PLCR    BB020                           CPL002
     C                     END                                            CPL002
     C           #2OURY    IFNE *BLANK                                                        CAS001
     C           FSOURY    CABLT#2OURY    BB020                                               CAS001
     C                     ENDIF                                                              CAS001
     C           #2THRY    IFNE *BLANK                                                        CAS001
     C           FSTHRY    CABLT#2THRY    BB020                                               CAS001
     C                     ENDIF                                                              CAS001
     C           #2YLDM    IFNE *BLANK                                                        CAS001
     C           FSYLDM    CABNE#2YLDM    BB020                                               CAS001
     C                     ENDIF                                                              CAS001
     C           #2ORFY    IFNE *BLANK                                                        CAS005
     C           FSORFY    CABNE#2ORFY    BB020                                               CAS005
     C                     ENDIF                                                              CAS005
     C           #2THFY    IFNE *BLANK                                                        CAS005
     C           FSTHFY    CABNE#2THFY    BB020                                               CAS005
     C                     ENDIF                                                              CAS005
     C           #2FYCM    IFNE *BLANK                                                        CAS005
     C           FSFYCM    CABNE#2FYCM    BB020                                               CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       BG0257
      ** Move the Global Product and Instrument Codes to screen fields                        BG0257
      ** if CGP001 is enabled.                                                                BG0257
      *                                                                                       BG0257
     C           CGP001    IFEQ 'Y'                                                           BG0257
     C                     EXSR SRGPPI                                                        BG0257
     C                     ENDIF                                                              BG0257
     C           #2PRDC    IFNE *BLANK                                                        BG0257
     C           #1PRDC    CABNE#2PRDC    BB020                                               BG0257
     C                     ENDIF                                                              BG0257
     C           #2INSC    IFNE *BLANK                                                        BG0257
     C           #1INSC    CABNE#2INSC    BB020                                               BG0257
     C                     ENDIF                                                              BG0257
      *                                                                                       CAS008
     C           #2OFCY    IFNE *BLANK                                                        CAS008
     C           FSOFCY    CABNE#2OFCY    BB020                                               CAS008
     C                     ENDIF                                                              CAS008
     C           #2TFCY    IFNE *BLANK                                                        CAS008
     C           FSTFCY    CABNE#2TFCY    BB020                                               CAS008
     C                     ENDIF                                                              CAS008
     C           #2FCCM    IFNE *BLANK                                                        CAS008
     C           FSFCCM    CABNE#2FCCM    BB020                                               CAS008
     C                     ENDIF                                                              CAS008
      *                                                                                       CAS009
     C           CAS009    IFEQ 'Y'                                                           CAS009
     C           #2ACAI    ANDNE*BLANK                                                        CAS009
     C           FSACAI    CABNE#2ACAI    BB020                                               CAS009
     C                     ENDIF                                                              CAS009
     C*                                                                   S01408
     C/COPY WNCPYSRC,FD0650ECP3                                           S01408
     C*                                                                   S01408
      * Load SFL fields.
     C                     EXSR MBFL#1
     C           CDL019    IFEQ 'Y'                                                           CDL019
     C           #1DTPE    IFEQ 'IT'                                                          CDL019
     C           #1DTPE    OREQ 'TD'                                                          CDL019
     C           #1DTPE    OREQ 'IP'                                                          CDL019
     C           #1DTPE    OREQ 'TI'                                                          CDL019
     C                     MOVE *ON       *IN59                                               CDL019
     C                     ELSE                                                               CDL019
     C                     MOVE *OFF      *IN59                                               CDL019
     C                     ENDIF                                                              CDL019
     C                     ENDIF                                                              CDL019
      * Output to subfile.
     C                     ADD  1         ##RR       81    *
     C                     ADD  1         ##RROK
     C*                                                                   S01408
     C/COPY WNCPYSRC,FD0650ECP9                                           S01408
     C*                                                                   S01408
     C                     WRITE#SFLRCD
     C           BB020     TAG
      * Increment scan check count.
     C                     ADD  1         ##RRRD
     C/COPY WNCPYSRC,FD0650EC12
     C                     READ FDDTSTPD                 82*82=EOF
     C*                                                                   S01408
     C/COPY WNCPYSRC,FD0650ECP2                                           S01408
     C*                                                                   S01408
     C                     END                             OD 1 - ##SFPG
      *................................................................
      * If no DBF records found, display error message.
     C           ##RR      IFEQ *ZERO
     C           *IN82     ANDEQ'1'
      * Send message '*No data to display'
     C                     MOVEL'Y2U0008' ZAMSID           Message id.
     C                     MOVEL'Y2USRMSG'ZAMSGF           Message file.
     C                     EXSR ZASNMS                     Send message
     C                     END                             FI ##RR = *ZERO
      *
      *................................................................
      * Save highest SFL record load can continue at end point.
     C           ##RR      IFGT ##RRMX
     C           ##RRMX    ADD  1         ##SFRC
     C                     Z-ADD##RR      ##RRMX
     C                     END
      * If scan limit reached, display error message.
     C           ##RRRD    IFGE W0SLM
      * Send message '*Scan limit reached'
     C                     MOVEL'Y2U0017' ZAMSID           Message id.
     C                     MOVEL'Y2USRMSG'ZAMSGF           Message file.
     C                     EXSR ZASNMS                     Send message
     C                     ELSE
     C                     Z-ADD0         ##RROK
     C                     END
     C/COPY WNCPYSRC,FD0650EC03
      *================================================================
     CSR         BBEXIT    ENDSR
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen.
      *================================================================
     C           W0HLP     DOUEQ'N'
      * Update screen time.
     C                     TIME           ##TME            Screen time.
      * PUTOVR unless conditioned fields change.
     C                     SETON                     86
     C           *IN81     IFNE CAIN81
     C                     SETOF                     86
     C                     END
     C                     MOVE *IN81     CAIN81  1
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#SFLCTL
     C                     MOVEL'N'       W0HLP   1        Reset help requ
      * If help requested, display help text.
     C   25                EXSR ZHHPKY                     Display help te
     C                     END
      * Update job time.
     C                     TIME           ##JTM            Job time.
      * Clear messages from program message queue.
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGM  10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag.
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     SETOF                       8388*
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPR##    BEGSR
      *================================================================
      * Process screen input.
      *================================================================
      * Maintain subfile position where possible.
     C           @#SFRC    IFGT *ZERO
     C                     Z-ADD@#SFRC    ##SFRC
     C                     END
      *
      * Confirm/update is not defered.
     C                     MOVEL'N'       W0DCF   1
      * Change of position specified.
     C           WZDTPE    CASNE#2DTPE    FBRQRL
     C           WZDLST    CASNE#2DLST    FBRQRL
     C           WZCLAS    CASNE#2CLAS    FBRQRL                                              CDL038
     C           WZNARR    CASNE#2NARR    FBRQRL
     C/COPY WNCPYSRC,FD0650EC13
     C           WZFBRT    CASNE#2FBRT    FBRQRL                                              CDL019
     C           WZINNR    CASNE#2INNR    FBRQRL                          S01486
     C           WZPLDP    CASNE#2PLDP    FBRQRL                          CPL002
     C           WZPLDR    CASNE#2PLDR    FBRQRL                          CPL002
     C           WZPLCR    CASNE#2PLCR    FBRQRL                          CPL002
     C           WZOURY    CASNE#2OURY    FBRQRL                                              CAS001
     C           WZTHRY    CASNE#2THRY    FBRQRL                                              CAS001
     C           WZYLDM    CASNE#2YLDM    FBRQRL                                              CAS001
     C           WZORFY    CASNE#2ORFY    FBRQRL                                              CAS005
     C           WZTHFY    CASNE#2THFY    FBRQRL                                              CAS005
     C           WZFYCM    CASNE#2FYCM    FBRQRL                                              CAS005
     C           WZPRDC    CASNE#2PRDC    FBRQRL                                              BG0257
     C           WZINSC    CASNE#2INSC    FBRQRL                                              BG0257
     C           WZOFCY    CASNE#2OFCY    FBRQRL                                              CAS008
     C           WZTFCY    CASNE#2TFCY    FBRQRL                                              CAS008
     C           WZFCCM    CASNE#2FCCM    FBRQRL                                              CAS008
     C           WZACAI    CASNE#2ACAI    FBRQRL                                              CAS009
     C*                                                                   S01408
     C/COPY WNCPYSRC,FD0650ECP4                                           S01408
     C*                                                                   S01408
     C                     END
      * Reload subfile requested:
     C           W0RSF     CABEQ'Y'       DAEXIT
      * If error, Quit processing:
     C           *IN99     CABEQ'1'       DAEXIT
      * Defer confirm/update requested:
     C           W0DCF     CABEQ'Y'       DAEXIT
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         FBRQRL    BEGSR
      *================================================================
      * Request subfile reload.
      *================================================================
     C                     MOVEL'Y'       W0RSF
      *================================================================
     CSR         FBEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move FDDTSTPD   fields to subfile.
      *================================================================
     C/COPY WNCPYSRC,FD0650EC08
     C                     Z-ADDLCD11     #1LCD            Last Change Dat
     C                     MOVELTYLC11    #1TYLC           Type of Last Ch
     C                     MOVELDTPE11    #1DTPE           Deal type
     C                     MOVELDLST11    #1DLST           Subtype
     C                     MOVELCLAS11    #1CLAS           Class                              CDL038
     C                     MOVELNARR11    #1NARR           Description of
     C/COPY WNCPYSRC,FD0650EC14
     C                     MOVELFDFBRT    #1FBRT           Fix Base Rate                      CDL019
     C                     MOVELINNR      #1INNR           Instrument TypeS01486
     C                     MOVELPLDPCD    #PLDPC           Pricing Group  CPL002
     C                     MOVELPLDRCD    #PLDRC           Reporting GroupCPL002
     C                     MOVELPLCRED    #PLCRE           Credit Rating  CPL002
      *                                                                                       207288
      ** Load spot indicator.                                                                 207288
      *                                                                                       207288
     C                     MOVE ' '       #1SFLG                                              207288
     C           BGN4ST    IFEQ 'Y'                                                           207288
     C           #1DTPE    IFEQ 'FP'                                                          207288
     C           #1DTPE    OREQ 'FS'                                                          207288
     C           #1DTPE    OREQ 'CX'                                                          207288
     C           #1DTPE    OREQ 'PI'                                                          207288
     C           #1DTPE    OREQ 'SI'                                                          207288
     C           #1DTPE    OREQ 'OP'                                                          207288
     C           #1DTPE    OREQ 'OT'                                                          207288
     C           #1DTPE    OREQ 'SW'                                                          207288
     C                     MOVELDTPE11    TFDTPE                                              207288
     C                     MOVELDLST11    TFDLST                                              207288
     C           KSECU     KLIST                                                              207288
     C                     KFLD           TFDTPE                                              207288
     C                     KFLD           TFDLST                                              207288
     C           KSECU     CHAINFDDTSTD0             90                                       207288
     C           *IN90     IFEQ '0'                                                           207288
     C                     MOVE TFSPOT    #1SFLG                                              207288
     C                     ENDIF                                                              207288
     C                     ENDIF                                                              207288
     C                     ENDIF                                                              207288
     C                     MOVELFSOURY    #1OURY                                              CAS001
     C                     MOVELFSTHRY    #1THRY                                              CAS001
     C                     MOVELFSYLDM    #1YLDM                                              CAS001
     C                     MOVELFSORFY    #1ORFY                                              CAS005
     C                     MOVELFSTHFY    #1THFY                                              CAS005
     C                     MOVELFSFYCM    #1FYCM                                              CAS005
     C/COPY WNCPYSRC,FDH00004
      *                                                                                       CER047
     C           CER047    IFEQ 'Y'                                                           CER047
     C                     MOVELFSK24C    #1K24C                                              CER047
     C                     ENDIF                                                              CER047
      *                                                                                       CER047
      *                                                                                       BG0257
      ** Move the Global Product and Instrument Codes to screen fields                        BG0257
      ** if CGP001 is enabled.                                                                BG0257
      *                                                                                       BG0257
     C           CGP001    IFEQ 'Y'                                                           BG0257
     C                     EXSR SRGPPI                                                        BG0257
     C                     ENDIF                                                              BG0257
      *                                                                                       CAS008
     C                     MOVELFSOFCY    #1OFCY                                              CAS008
     C                     MOVELFSTFCY    #1TFCY                                              CAS008
     C                     MOVELFSFCCM    #1FCCM                                              CAS008
     C           CAS009    IFEQ 'Y'                                                           CAS009
     C                     MOVELFSACAI    #1ACAI                                              CAS009
     C                     ENDIF                                                              CAS009
     C*                                                                   S01408
     C/COPY WNCPYSRC,FD0650ECP5                                           S01408
     C*                                                                   S01408
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MEIZ#2    BEGSR
      *================================================================
      * Initialise subfile control.
      *================================================================
     C                     Z-ADD*ZERO     #2LCD            Last Change Dat
     C                     MOVEL*BLANK    #2TYLC           Type of Last Ch
     C                     MOVEL*BLANK    #2DTPE           Deal type
     C                     MOVEL*BLANK    #2DLST           Subtype
     C                     MOVEL*BLANK    #2CLAS           Class                              CDL038
     C                     MOVEL*BLANK    #2NARR           Description of
     C/COPY WNCPYSRC,FD0650EC04
     C                     MOVEL*BLANK    #2FBRT           Fix Base Rate                      CDL019
     C                     MOVEL*BLANK    #2INNR           Instrument TypeS01486
     C                     MOVEL*BLANK    #2PLDP           Pricing Group  CPL002
     C                     MOVEL*BLANK    #2PLDR           Reporting GroupCPL002
     C                     MOVEL*BLANK    #2PLCR           Credit Rating  CPL002
     C                     MOVEL*BLANK    #2OURY                                              CAS001
     C                     MOVEL*BLANK    #2THRY                                              CAS001
     C                     MOVEL*BLANK    #2YLDM                                              CAS001
     C                     MOVEL*BLANK    #2ORFY                                              CAS005
     C                     MOVEL*BLANK    #2THFY                                              CAS005
     C                     MOVEL*BLANK    #2FYCM                                              CAS005
     C                     MOVEL*BLANK    #2PRDC                                              BG0257
     C                     MOVEL*BLANK    #2INSC                                              BG0257
     C                     MOVEL*BLANK    #2OFCY                                              CAS008
     C                     MOVEL*BLANK    #2TFCY                                              CAS008
     C                     MOVEL*BLANK    #2FCCM                                              CAS008
     C           CAS009    IFEQ 'Y'                                                           CAS009
     C                     MOVE *BLANK    #2ACAI                                              CAS009
     C                     ENDIF                                                              CAS009
     C*                                                                   S01408
     C/COPY WNCPYSRC,FD0650ECP6                                           S01408
     C*                                                                   S01408
      *================================================================
     CSR         MEEXIT    ENDSR
      /EJECT                                                                                  BG0257
      *****************************************************************                       BG0257
      *                                                               *                       BG0257
      *  SRGPPI - Gets the Global Product and Instrument Codes.       *                       BG0257
      *                                                               *                       BG0257
      *****************************************************************                       BG0257
     C           SRGPPI    BEGSR                                                              BG0257
      *                                                                                       BG0257
     C                     MOVE *BLANKS   #1PRDC                                              BG0257
     C                     MOVE *BLANKS   #1INSC                                              BG0257
      *                                                                                       BG0257
     C                     MOVE WZONE     KZONE                                               BG0257
     C                     MOVE 'DL'      KMOD                                                BG0257
     C                     MOVELDTPE11    KTRTP                                               BG0257
     C                     MOVELDLST11    KTRST                                               BG0257
      *                                                                                       BG0257
     C           KGPXR     CHAINGPPRDXL0            N43                                       BG0257
      *                                                                                       BG0257
     C           *IN43     IFEQ *OFF                                                          BG0257
     C                     MOVE PDGPRD    #1PRDC                                              BG0257
     C                     ENDIF                                                              BG0257
      *                                                                                       BG0257
     C           KGPXR     CHAINGPINSXL0            N43                                       BG0257
      *                                                                                       BG0257
     C           *IN43     IFEQ *OFF                                                          BG0257
     C                     MOVE INGINS    #1INSC                                              BG0257
     C                     ENDIF                                                              BG0257
      *                                                                                       BG0257
     C                     ENDSR                                                              BG0257
      *****************************************************************                       BG0257
      /EJECT                                                                                  BG0257
      *****************************************************************                       BG0257
      *                                                               *                       BG0257
      *  SRGPOF - Opens the Global Processing Cross-Reference Files.  *                       BG0257
      *                                                               *                       BG0257
      *****************************************************************                       BG0257
     C           SRGPOF    BEGSR                                                              BG0257
      *                                                                                       BG0257
     C                     Z-ADD80        PLEN   155                                          BG0257
      *                                                                                       BG0257
     C                     DO   2         WIDX    10                                          BG0257
      *                                                                                       BG0257
     C                     MOVE OVRC,WIDX PCMD   80                                           BG0257
      *                                                                                       BG0257
     C                     CALL 'QCMDEXC'                                                     BG0257
     C                     PARM           PCMD                                                BG0257
     C                     PARM           PLEN                                                BG0257
      *                                                                                       BG0257
     C                     ENDDO                                                              BG0257
      *                                                                                       BG0257
     C                     OPEN GPPRDXL0                                                      BG0257
     C                     OPEN GPINSXL0                                                      BG0257
      *                                                                                       BG0257
     C                     ENDSR                                                              BG0257
      *****************************************************************                       BG0257
      /EJECT                                                                                  BG0257
      *****************************************************************                       BG0257
      *                                                               *                       BG0257
      *  SRGPGZ - Gets the Zone via GOGETZONE.                        *                       BG0257
      *                                                               *                       BG0257
      *****************************************************************                       BG0257
     C           SRGPGZ    BEGSR                                                              BG0257
      *                                                                                       BG0257
     C                     CALL GOPGM                                                         BG0257
     C                     PARM *BLANKS   PZRTCD  7                                           BG0257
     C                     PARM *BLANKS   PZERMS 50                                           BG0257
     C                     PARM 'N'       PZFCHK  1                                           BG0257
     C                     PARM *BLANKS   PZZONE 10                                           BG0257
     C                     PARM *BLANKS   PZSHTC  4                                           BG0257
     C                     PARM *ZERO     PZRDNB  50                                          BG0257
     C                     PARM *ZERO     PZDNWD  50                                          BG0257
     C                     PARM *BLANKS   PZBCCY  3                                           BG0257
     C                     PARM *ZERO     PZNJOB  10                                          BG0257
      *                                                                                       BG0257
     C           PZRTCD    IFEQ *BLANKS                                                       BG0257
     C                     MOVE PZZONE    WZONE  10                                           BG0257
     C                     ELSE                                                               BG0257
      *                                                                                       BG0257
     C           PZRTCD    IFEQ '*ERROR'                                                      BG0257
     C                     MOVELGOMSG     PZERMS                                              BG0257
     C                     MOVE *ON       *INU7                                               BG0257
     C                     MOVE *ON       *INU8                                               BG0257
     C                     MOVE *ON       *INLR                                               BG0257
     C                     EXSR *PSSR                                                         BG0257
     C                     ENDIF                                                              BG0257
      *                                                                                       BG0257
     C                     ENDIF                                                              BG0257
      *                                                                                       BG0257
     C                     ENDSR                                                              BG0257
      *****************************************************************                       BG0257
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue.
      *================================================================
     C           ZAPGM     IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGM
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGM  10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message Id.
     C                     PARM           ZAMSGF 10        Message file.
     C                     PARM           ZAMSDA132        Message data.
     C                     PARM           ZAMSTP  7        Message type.
      * Clear all fields for default mechanism next time.
     C                     MOVEL*BLANK    ZAPGM            Program queue
     C                     MOVEL*BLANK    ZAPGRL           Rel queue
     C                     MOVEL*BLANK    ZAMSID           Message Id.
     C                     MOVEL*BLANK    ZAMSGF           Message file.
     C                     MOVEL*BLANK    ZAMSDA           Message data.
     C                     MOVEL*BLANK    ZAMSTP           Message type.
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text.
      *================================================================
     C                     MOVEL'Y'       W0HLP   1        Signal help req
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Member name.
     C                     PARM *BLANK    YYHPFL 10        *DFT text file.
     C                     PARM *BLANK    YYHPLB 10        Help text lib.
     C                     PARM           W0RTN   7        Return Code.
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel & exit program.
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct.
      *================================================================
      * Terminate program.
     C                     SETON                     LR
      *
      * Exit program.
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation.
      *================================================================
      *                                                                                       BG0257
      ** Global Processing X-Reference Key List                                               BG0257
      *                                                                                       BG0257
     C           KGPXR     KLIST                                                              BG0257
     C                     KFLD           KZONE  10                                           BG0257
     C                     KFLD           KMOD    2                                           BG0257
     C                     KFLD           KTRTP   5                                           BG0257
     C                     KFLD           KTRST   5                                           BG0257
      *                                                                                       BG0257
      * Define LDA                                                                            CAS005
     C           *NAMVAR   DEFN           LDA                                                 CAS005
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
      * Setup job date/time.
     C                     Z-ADDUDATE     ##JDT            Job date.
     C                     TIME           ##JTM            Job time.
     C                     TIME           ##TME   60       Screen time.
      * Define work field Midas Run Date
     C                     MOVEL*BLANK    WUMRDT  7
      * Define work field Run day number
     C                     Z-ADD*ZERO     WURDNB  50
      * Define work field Set Up Complete
     C                     MOVEL*BLANK    WUSUC   1
      * Define work field Date format flag
     C                     MOVEL*BLANK    WUDFF   1
      * Define work field Multi-branching Indicator
     C                     MOVEL*BLANK    WUMBIN  1
     C**********           Z-ADD12        ##SFPG  30       SFLPAG                             CAS001
     C**********           Z-ADD6         ##SFPG  30       SFLPAG                      CAS001 CAS005
     C**********           Z-ADD5         ##SFPG  30       SFLPAG                      CAS005 CAS008
     C                     Z-ADD3         ##SFPG  30       SFLPAG                             CAS008
     C                     Z-ADD1         ##SFRC
     C                     Z-ADD*ZERO     ##RRMX           MAX RECNO
     C                     Z-ADD500       W0SLM   50       SCAN LIMIT
      *................................................................
      * USER: Initialise program
      * Standard RPG Creation PAR - Standard Functions  *
      * Get Rundate - Rundate  *
     C           *NAMVAR   DEFN           RUNDAT
     C                     IN   RUNDAT
     C                     MOVE MRDT      ##MRDT           RUN DATE       S01229
     C                     MOVE MRDT      WUMRDT                          S01229
     C                     MOVE RDNB      WURDNB           RUNDAY NO.     S01229
     C                     MOVE SUC       WUSUC            SET UP COMPLT  S01229
     C                     MOVE DFF       WUDFF            DTE FMT FLAG   S01229
     C                     MOVE MBIN      WUMBIN           MULTI BR. IND  S01229
     C*                                                                   S01408
     C/COPY WNCPYSRC,FD0650ECP8                                           S01408
     C*                                                                   S01408
      *                                                                   S01486
      **  Access module file                                              S01486
      *                                                                   S01486
     C                     CALL 'AOMMODR0'                                S01486
     C                     PARM '*MSG   ' @RTCD   7                       S01486
     C                     PARM '*FIRST ' @OPTN   7                       S01486
     C           SDMMOD    PARM SDMMOD    DSFDY                           S01486
      *                                                                   S01486
     C           @RTCD     IFNE *BLANK                                    S01486
     C                     MOVEL'SDMMODPD'DBFILE 10         ************* S01486
     C                     MOVEL'01'      DBASE   3         *DBERROR 001* S01486
     C                     MOVEL@OPTN     DBOPTN  7         ************* S01486
     C                     SETON                     U7U8LR               S01486
     C                     EXSR *PSSR                                     S01486
     C                     END                                            S01486
     C/COPY WNCPYSRC,FD0650EC01
      *                                                                   S01486
      ** Portfolio Management is ON.                                      S01486
      ** Or Private Banking is ON.                                        CPB001
     C           BGPFMG    IFEQ 'Y'                                       S01486
     C           BGN4ST    OREQ 'Y'                                       CPB001
     C                     MOVE *ON       *IN20                           S01486
     C                     ENDIF                                          S01486
     C/COPY WNCPYSRC,FD0650EC02
      *                                                                   S01486
      *                                                                   CPL002
      ** Midas-Plato module is switched on.                               CPL002
     C           BGN2ST    IFEQ 'Y'                                       CPL002
     C                     MOVE *ON       *IN50                           CPL002
     C                     ELSE                                           CPL002
     C                     MOVE *OFF      *IN50                           CPL002
     C                     ENDIF                                          CPL002
     C/COPY WNCPYSRC,FDH00005
      *                                                                                       BG0257
      ** Check if CGP001 is enabled.                                                          BG0257
      *                                                                                       BG0257
     C                     CALL 'AOSARDR0'                                                    BG0257
     C                     PARM *BLANKS   PRTCD                                               BG0257
     C                     PARM '*VERIFY' POPTN                                               BG0257
     C                     PARM 'CGP001'  PSARD                                               BG0257
     C           SCSARD    PARM SCSARD    DSFDY                                               BG0257
      *                                                                                       BG0257
     C                     MOVE 'N'       CGP001  1                                           BG0257
     C           PRTCD     IFEQ *BLANKS                                                       BG0257
     C                     MOVE 'Y'       CGP001                                              BG0257
     C                     MOVE *ON       *IN40                                               BG0257
      *                                                                                       BG0257
      ** Open the Global Processing Files.                                                    BG0257
      *                                                                                       BG0257
     C                     EXSR SRGPOF                                                        BG0257
      *                                                                                       BG0257
      ** Get the Zone.                                                                        BG0257
      *                                                                                       BG0257
     C                     EXSR SRGPGZ                                                        BG0257
     C                     ELSE                                                               BG0257
      *                                                                                       BG0257
     C           PRTCD     IFNE '*NRF'                                                        BG0257
     C                     MOVEL'SCSARDPD'DBFILE                                              BG0257
     C                     MOVEL'CGP001'  DBKEY                                               BG0257
     C                     MOVEL'07'      DBASE                                               BG0257
     C                     MOVE *ON       *INU7                                               BG0257
     C                     MOVE *ON       *INU8                                               BG0257
     C                     MOVE *ON       *INLR                                               BG0257
     C                     EXSR *PSSR                                                         BG0257
     C                     ENDIF                                                              BG0257
      *                                                                                       BG0257
     C                     ENDIF                                                              BG0257
      *                                                                   CPL002
      ** Determine if CAS001 is installed                                                     CAS001
      *                                                                                       CAS001
     C                     CALL 'AOSARDR0'                                                    CAS001
     C                     PARM *BLANKS   PRTCD   7                                           CAS001
     C                     PARM '*VERIFY 'POPTN   7                                           CAS001
     C                     PARM 'CAS001'  PSARD   6                                           CAS001
     C           SCSARD    PARM SCSARD    DSFDY                                               CAS001
      *                                                                                       CAS001
     C           PRTCD     IFNE *BLANKS                                                       CAS001
     C           PRTCD     ANDNE'*NRF   '                                                     CAS001
     C                     MOVEL'SCSARDPD'DBFILE                                              CAS001
     C                     MOVEL'02'      DBASE                                               CAS001
     C                     MOVEL'CAS001'  DBKEY  10                                           CAS001
     C                     MOVE *ON       *INU7                                               CAS001
     C                     MOVE *ON       *INU8                                               CAS001
     C                     MOVE *ON       *INLR                                               CAS001
     C                     EXSR *PSSR                                                         CAS001
     C                     ENDIF                                                              CAS001
      *                                                                                       CAS001
     C           PRTCD     IFEQ *BLANKS                                                       CAS001
     C                     MOVE 'Y'       CAS001  1                                           CAS001
     C                     MOVE *ON       *IN55                                               CAS001
     C                     ELSE                                                               CAS001
     C                     MOVE 'N'       CAS001                                              CAS001
     C                     MOVE *OFF      *IN55                                               CAS001
     C                     ENDIF                                                              CAS001
     C/COPY WNCPYSRC,FDH00047
      *                                                                                       CAS001
      ** Determine if CAS005 is installed                                                     CAS005
      *                                                                                       CAS005
     C                     CALL 'AOSARDR0'                                                    CAS005
     C                     PARM *BLANKS   PRTCD                                               CAS005
     C                     PARM '*VERIFY 'POPTN                                               CAS005
     C                     PARM 'CAS005'  PSARD                                               CAS005
     C           SCSARD    PARM SCSARD    DSFDY                                               CAS005
      *                                                                                       CAS005
     C           PRTCD     IFNE *BLANKS                                                       CAS005
     C           PRTCD     ANDNE'*NRF   '                                                     CAS005
     C           *LOCK     IN   LDA                                                           CAS005
     C                     MOVEL'SCSARDPD'DBFILE                                              CAS005
     C                     MOVEL'03'      DBASE                                               CAS005
     C                     MOVEL'CAS005'  DBKEY                                               CAS005
     C                     OUT  LDA                                                           CAS005
     C                     MOVE *ON       *INU7                                               CAS005
     C                     MOVE *ON       *INU8                                               CAS005
     C                     MOVE *ON       *INLR                                               CAS005
     C                     EXSR *PSSR                                                         CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
     C           PRTCD     IFEQ *BLANKS                                                       CAS005
     C                     MOVE 'Y'       CAS005  1                                           CAS005
     C                     MOVE *ON       *IN56                                               CAS005
     C                     ELSE                                                               CAS005
     C                     MOVE 'N'       CAS005                                              CAS005
     C                     MOVE *OFF      *IN56                                               CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CDL019
      ** Determine if CDL019 is installed                                                     CDL019
      *                                                                                       CDL019
     C                     CALL 'AOSARDR0'                                                    CDL019
     C                     PARM *BLANKS   PRTCD                                               CDL019
     C                     PARM '*VERIFY 'POPTN                                               CDL019
     C                     PARM 'CDL019'  PSARD                                               CDL019
     C           SCSARD    PARM SCSARD    DSFDY                                               CDL019
      *                                                                                       CDL019
     C           PRTCD     IFEQ *BLANKS                                                       CDL019
     C                     MOVE 'Y'       CDL019  1                                           CDL019
     C                     MOVE *ON       *IN57                                               CDL019
     C                     ELSE                                                               CDL019
     C                     MOVE 'N'       CDL019                                              CDL019
     C                     MOVE *OFF      *IN57                                               CDL019
     C                     ENDIF                                                              CDL019
      *                                                                                       CDL019
      *                                                                                       CAS005
      ** Determine if CGL014 is installed                                                     CGL014
      *                                                                                       CGL014
     C                     CALL 'AOSARDR0'                                                    CGL014
     C                     PARM *BLANKS   PRTCD                                               CGL014
     C                     PARM '*VERIFY 'POPTN                                               CGL014
     C                     PARM 'CGL014'  PSARD                                               CGL014
     C           SCSARD    PARM SCSARD    DSFDY                                               CGL014
      *                                                                                       CGL014
     C           PRTCD     IFNE *BLANKS                                                       CGL014
     C           PRTCD     ANDNE'*NRF   '                                                     CGL014
     C                     MOVEL'SCSARDPD'DBFILE                                              CGL014
     C                     MOVEL'04'      DBASE                                               CGL014
     C                     MOVEL'CGL014'  DBKEY                                               CGL014
     C                     MOVE *ON       *INU7                                               CGL014
     C                     MOVE *ON       *INU8                                               CGL014
     C                     MOVE *ON       *INLR                                               CGL014
     C                     EXSR *PSSR                                                         CGL014
     C                     ENDIF                                                              CGL014
      *                                                                                       CGL014
     C           PRTCD     IFEQ *BLANKS                                                       CGL014
     C                     MOVE 'Y'       CGL014  1                                           CGL014
     C                     ELSE                                                               CGL014
     C                     MOVE 'N'       CGL014                                              CGL014
     C                     ENDIF                                                              CGL014
      *                                                                                       CLE025
      ** Determine if CLE025 is installed                                                     CLE025
      *                                                                                       CLE025
     C                     CALL 'AOSARDR0'                                                    CLE025
     C                     PARM *BLANKS   PRTCD                                               CLE025
     C                     PARM '*VERIFY 'POPTN                                               CLE025
     C                     PARM 'CLE025'  PSARD                                               CLE025
     C           SCSARD    PARM SCSARD    DSFDY                                               CLE025
      *                                                                                       CLE025
     C           PRTCD     IFNE *BLANKS                                                       CLE025
     C           PRTCD     ANDNE'*NRF   '                                                     CLE025
     C                     MOVEL'SCSARDPD'DBFILE                                              CLE025
     C                     MOVEL'05'      DBASE                                               CLE025
     C                     MOVEL'CLE025'  DBKEY                                               CLE025
     C                     MOVE *ON       *INU7                                               CLE025
     C                     MOVE *ON       *INU8                                               CLE025
     C                     MOVE *ON       *INLR                                               CLE025
     C                     EXSR *PSSR                                                         CLE025
     C                     ENDIF                                                              CLE025
      *                                                                                       CLE025
     C           PRTCD     IFEQ *BLANKS                                                       CLE025
     C                     MOVE 'Y'       CLE025  1                                           CLE025
     C                     ELSE                                                               CLE025
     C                     MOVE 'N'       CLE025                                              CLE025
     C                     ENDIF                                                              CLE025
      *                                                                                       CLE025
     C           CGL014    IFEQ 'Y'                                                           CGL014
     C           CLE025    OREQ 'Y'                                                           CLE025
     C                     MOVE *ON       *IN20                                               CGL014
     C                     ENDIF                                                              CGL014
      *                                                                                       CGL014
      ** Determine if CAS008 is installed                                                     CAS008
      *                                                                                       CAS008
     C                     CALL 'AOSARDR0'                                                    CAS008
     C                     PARM *BLANKS   PRTCD                                               CAS008
     C                     PARM '*VERIFY 'POPTN                                               CAS008
     C                     PARM 'CAS008'  PSARD                                               CAS008
     C           SCSARD    PARM SCSARD    DSFDY                                               CAS008
      *                                                                                       CAS008
     C           PRTCD     IFNE *BLANKS                                                       CAS008
     C           PRTCD     ANDNE'*NRF   '                                                     CAS008
     C           *LOCK     IN   LDA                                                           CAS008
     C                     MOVEL'SCSARDPD'DBFILE                                              CAS008
     C                     MOVEL'04'      DBASE                                               CAS008
     C                     MOVEL'CAS008'  DBKEY                                               CAS008
     C                     OUT  LDA                                                           CAS008
     C                     MOVE *ON       *INU7                                               CAS008
     C                     MOVE *ON       *INU8                                               CAS008
     C                     MOVE *ON       *INLR                                               CAS008
     C                     EXSR *PSSR                                                         CAS008
     C                     ENDIF                                                              CAS008
     C           PRTCD     IFEQ *BLANKS                                                       CAS008
     C                     MOVE 'Y'       CAS008  1                                           CAS008
     C                     ELSE                                                               CAS008
     C                     MOVE 'N'       CAS008                                              CAS008
     C                     ENDIF                                                              CAS008
      *                                                                                       CAS008
      ** Determine if CIR003 is installed                                                     CAS008
      *                                                                                       CAS008
     C                     CALL 'AOSARDR0'                                                    CAS008
     C                     PARM *BLANKS   PRTCD                                               CAS008
     C                     PARM '*VERIFY 'POPTN                                               CAS008
     C                     PARM 'CIR003'  PSARD                                               CAS008
     C           SCSARD    PARM SCSARD    DSFDY                                               CAS008
      *                                                                                       CAS008
     C           PRTCD     IFNE *BLANKS                                                       CAS008
     C           PRTCD     ANDNE'*NRF   '                                                     CAS008
     C           *LOCK     IN   LDA                                                           CAS008
     C                     MOVEL'SCSARDPD'DBFILE                                              CAS008
     C                     MOVEL'05'      DBASE                                               CAS008
     C                     MOVEL'CIR003'  DBKEY                                               CAS008
     C                     OUT  LDA                                                           CAS008
     C                     MOVE *ON       *INU7                                               CAS008
     C                     MOVE *ON       *INU8                                               CAS008
     C                     MOVE *ON       *INLR                                               CAS008
     C                     EXSR *PSSR                                                         CAS008
     C                     ENDIF                                                              CAS008
     C           PRTCD     IFEQ *BLANKS                                                       CAS008
     C           CAS008    ANDEQ'Y'                                                           CAS008
     C                     MOVE *ON       *IN57                                               CAS008
     C                     ELSE                                                               CAS008
     C                     MOVE *OFF      *IN57                                               CAS008
     C                     ENDIF                                                              CAS008
      *                                                                                       CAS008
      *                                                                                       CDL038
      ** Check if CDL038 is enabled (Extended Deal Sub-Type)                                  CDL038
      *                                                                                       CDL038
     C                     CALL 'AOSARDR0'                                                    CDL038
     C                     PARM *BLANKS   PRTCD                                               CDL038
     C                     PARM '*VERIFY' POPTN                                               CDL038
     C                     PARM 'CDL038'  PSARD                                               CDL038
     C           SCSARD    PARM SCSARD    DSFDY                                               CDL038
      *                                                                                       CDL038
     C                     MOVE 'N'       CDL038  1                                           CDL038
     C           PRTCD     IFEQ *BLANKS                                                       CDL038
     C                     MOVE 'Y'       CDL038                                              CDL038
     C                     MOVE *ON       *IN58                                               CDL038
     C                     ENDIF                                                              CDL038
      *                                                                                       CDL038
      *                                                                                       CAS009
      ** Determine if CAS009 is installed                                                     CAS009
      *                                                                                       CAS009
     C                     CALL 'AOSARDR0'                                                    CAS009
     C                     PARM *BLANKS   PRTCD                                               CAS009
     C                     PARM '*VERIFY 'POPTN                                               CAS009
     C                     PARM 'CAS009'  PSARD                                               CAS009
     C           SCSARD    PARM SCSARD    DSFDY                                               CAS009
      *                                                                                       CAS009
     C           PRTCD     IFNE *BLANKS                                                       CAS009
     C           PRTCD     ANDNE'*NRF   '                                                     CAS009
     C           *LOCK     IN   LDA                                                           CAS009
     C                     MOVEL'SCSARDPD'DBFILE                                              CAS009
     C                     MOVEL'09'      DBASE                                               CAS009
     C                     MOVEL'CAS009'  DBKEY                                               CAS009
     C                     OUT  LDA                                                           CAS009
     C                     EXSR *PSSR                                                         CAS009
     C                     ENDIF                                                              CAS009
      *                                                                                       CAS009
     C           PRTCD     IFEQ *BLANKS                                                       CAS009
     C                     MOVE 'Y'       CAS009  1                                           CAS009
     C                     MOVE *ON       *IN60                                               CAS009
     C                     ELSE                                                               CAS009
     C                     MOVE 'N'       CAS009                                              CAS009
     C                     MOVE *OFF      *IN60                                               CAS009
     C                     ENDIF                                                              CAS009
      *                                                                                       CAS009
      ** Call AOSARDR0 to check for CER047                                                    CER047
      *                                                                                       CER047
     C                     CALL 'AOSARDR0'                                                    CER047
     C                     PARM *BLANKS   PRTCD                                               CER047
     C                     PARM '*VERIFY 'POPTN                                               CER047
     C                     PARM 'CER047'  PSARD                                               CER047
     C           SCSARD    PARM SCSARD    DSFDY                                               CER047
      *                                                                                       CER047
     C           PRTCD     IFEQ *BLANKS                                                       CER047
      *                                                                                       CER047
     C                     MOVE 'Y'       CER047  1                                           CER047
     C                     MOVE *OFF      *IN41                                               CER047
     C                     ELSE                                                               CER047
     C                     MOVE 'N'       CER047                                              CER047
     C                     MOVE *ON       *IN41                                               CER047
      *                                                                                       CER047
     C                     ENDIF                                                              CER047
      *                                                                                       CER047
     C           PRTCD     IFNE *BLANKS                                                       CER047
     C           PRTCD     ANDNE'*NRF   '                                                     CER047
      *                                                                                       CER047
     C           *LOCK     IN   LDA                                                           CER047
     C                     MOVEL'SCSARDPD'DBFILE                                              CER047
     C                     MOVEL'10'      DBASE                                               CER047
     C                     MOVEL'CER047'  DBKEY                                               CER047
     C                     OUT  LDA                                                           CER047
      *                                                                                       CER047
     C                     EXSR *PSSR                                                         CER047
      *                                                                                       CER047
     C                     ENDIF                                                              CER047
      *                                                                                       CER047
      * Copyright Statement - Standard Functions  * copyright
      * Initialise subfile control.
     C                     EXSR MEIZ#2
      *================================================================
     CSR         ZZEXIT    ENDSR
     C*                                                                   S01408
     C/COPY WNCPYSRC,FD0650ECP7                                           S01408
     C*                                                                   S01408
      *================================================================   S01486
     C*                                                                   S01486
     C           *PSSR     BEGSR                                          S01486
      *                                                                   S01486
     C                     DUMP                                           S01486
     C/COPY WNCPYSRC,FD0650EC06
     C                     RETRN                                          S01486
      *                                                                   S01486
     C                     ENDSR                                          S01486
      *================================================================   S01486
** CPY@     : Copyright notice for inclusion in all programs
(c) Misys International Banking Systems Ltd. 2001
** OVRC                                                                                       BG0257
OVRDBF FILE(GPPRDXL0) TOFILE(GPPRODXL0)                                                       BG0257
OVRDBF FILE(GPINSXL0) TOFILE(GPINSTXL0)                                                       BG0257
