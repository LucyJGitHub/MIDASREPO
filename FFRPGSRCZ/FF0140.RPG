     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas FF OTCs maintenance')                            *
/*OVRF*: OVRDBF INTYP1X INTYP1                                      : *
     F********************************************************************
     F*                                                                  *
     F*  Midas  -  Futures and Options Module                            *
     F*                                                                  *
     F*   FF0140  -  OTC'S MAINTENANCE                                   *
     F*                                                                  *
      *  (c) Finastra International Limited 2001                      *
     F*                                                                  *
      *  Last Amend No. MD046248           Date 27Oct17               *
      *  Prev Amend No. CAP208             Date 06Dec10               *
      *                 CER059             Date 19Jul10               *
      *                 CER020             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 CRE026             Date 24May06               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 BUG8046            Date 02Aug05               *
      *                 CER001             Date 25Apr05               *
      *                 CSE071             Date 19Jul05               *
      *                 BUG3644            Date 12Jul04               *
      *                 CLE025             Date 20Oct03               *
      *                 CAAA03             Date 11Mar04               *
      *                 CGP001             Date 08Sep03               *
      *                 CAS006             Date 21Jan03               *
      *                 CAS005             Date 16Dec02               *
      * Midas Release 4.01.02 ----------------------------------------*
      *                 208490             Date 20Aug02               *
      * Midas Release 4 --------------- Base -------------------------*
      *                 CFF007             Date 01Mar01               *
      * Midas DBA 3.05 -----------------------------------------------*
      *                 CFF006             Date 28Nov00               *
      * Midas DBA 3.03 -----------------------------------------------*
      * Midas DBA 3.02 -----------------------------------------------*
      *                 CPB001             Date 13Sep99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 CPL002             Date 08Mar99               *
     F*                 101432             DATE 09APR96               *
     F*                 105750             DATE 17FEB97               *
     F*                 CFF004             DATE 13SEP96                  *
     F*                 104633             DATE 08JUL96               *
     F*                 S01408             DATE 14AUG96               *
     F*                 CPM003             DATE 01MAY96               *
     F*                 S71062             DATE 11DEC95               *
     F*                 S01235             DATE 11DEC95               *
     F*                 PMC143             DATE 11DEC95               *
     F*                  S01408             DATE 04SEP95                 *
     F*                  073714             DATE 01MAR95                 *
     F*                  E49198             DATE 20MAR93                 *
     F*                  S01393             DATE 13OCT92                 *
     F*                  FUJI-FF0011        DATE 21SEP92                 *
     F*                  E44683             DATE 17SEP92                 *
     F*                  E44668             DATE 17SEP92                 *
     F*                  AUS022             DATE 10AUG92                 *
     F*                  FO0007             DATE 31JAN91                 *
     F*                  FO0006             DATE 29JAN91                 *
     F*                  FO0012             DATE 03JAN91                 *
     F*                  S01299             DATE 24AUG90                 *
     F*                  E19546             DATE 06APR90                 *
     F*                  S01199             DATE 27FEB90                 *
     F*                  HK0000             DATE 14MAR90                 *
     F*                  S01195             DATE 12MAR90                 *
     F*                  S01117             DATE 12MAR90                 *
     F*                  E18188             DATE 04/05/89                *
     F*                  E18011             DATE 19/04/89                *
     F*                  E16369             DATE 24/09/88                *
     F*                  E16371             DATE 24/09/88                *
     F*                  E16372             DATE 24/09/88                *
     F*                  S01179             DATE 23/09/88                *
     F*                                                                  *
     F*------------------------------------------------------------------*
     F*                                                                  *
      *  MD046248 - Finastra Rebranding                               *
      *  CAP208 - F&O Market Instrument API (Recompile)               *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  CER020 - Enhanced Rollover Window: Upgrade FGE089 to         *
      *           Midas Plus (Recompile)                              *
      *  CRE026 - Consumer Banking (Recompile)                        *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  BUG8046 - F10 is not working                                 *
      *  CER001 - LUX Upgrade to MidasPlus                            *
      *  CSE071 - Multiple Holidays Re Securities (recompile)         *
      *  BUG3644 - Serious Error in Collateralised Lending (Recompile)*
      *  CLE025 - Credit Lines                                        *
      *  CAAA03 - Webfacing Changes                                   *
      *  CGP001 - Global Processing.                                  *
      *           - SDWEIG* files renamed to GPWEIG*.                 *
      *           - AOWEIGR0 renamed to GPAOWEIGR0.                   *
      *  CAS006 - Hedge Accounting Phase B (Recompile)                *
      *  CAS005 - Enhancements to CAS001, CAS002 and CAS004           *
      *           (Recompile)                                         *
      *  208490 - Display delivery amount according to currency's     *
      *           number of decimal places.                           *
      *  CFF007 - Futures and Options Enhancement for Private Banking *
      *  CFF006 - Fractional Ticks Enhancement.                       *
     F*  CPB001 - 'Private Banking' Module                               *
     F*  CPL002 - Midas-Plato Interface (Recompiled)                  *
     F*  101432 - WHEN DELETION, CHECK ALSO IF ACTIVE RECORDS         *
     F*           IN TRANSD (LF TRANS13).                             *
     F*  105750 - COMPLETE 073714 : OTHC IS BLANK WHEN ISTP IS 1, 3,  *
     F*           4 OR 6                                              *
     F*  CFF004 - Increase in size of Price Fields                       *
     F*  104633 - GUI Amendments to DSPF with non-standard footers    *
     F*  S01408 - Addition of hooks FF0140CCP5                        *
     F*  CPM003 - FF PM Interface Upgrade to R10.                     *
     F*  S71062 - FF/PM Interface (Just Recompiled)                   *
     F*  S01235 - Portfolio Management Amendment.                     *
     F*  PMC143 - Allow default instrument with PM module             *
     F*   S01408 - Addition of hooks FF0140IIP1                          *
     F*                              FF0140IIP2                          *
     F*                              FF0140CCP1                          *
     F*                              FF0140CCP2                          *
     F*                              FF0140CCP3                          *
     F*                              FF0140CCP4                          *
     F*   073714  -  OTC ENHANCEMENTS                                    *
     F*   E49198  -  Show on enquiry screen that instrument is mature    *
     F*              if it's the case.                                   *
     F*   S01393  -  Amended for Strategic Risk Management               *
     F*              to add a new field for Underlying Period.           *
     F*              The old field is renamed to P&L Amortisation        *
     F*              Period.                                             *
     F*              When called as a linked enquiry the OTC Code is     *
     F*              passed as a parameter and relevant OTC details      *
     F*              are displayed                                       *
     F* FUJI-FF0011 - The system does not differentiate between          *
     F*               american and european option on exercise           *
     F*               validation and OTC confirmation wording.           *
     F*                                                                  *
     F*   E44683    - The OTC maintenance pgm forces the last trading    *
     F*               date to be less than the settlement date,          *
     F*               however inpratice the last trading date can        *
     F*               be less than or equal to settlement date.          *
     F*                                                                  *
     F*   E44668  -  Change AUS022 causes decimal data error.            *
     F*   AUS022  -  AUSTRALIAN CHANGE : Contract Type (CNTT) added to   *
     F*              PF/INTYPD.  Recompile program only.                 *
     F*   FO0007  -  Tick Value validation added for processing types    *
     F*              '2' and '5'                                         *
     F*   FO0006  -  Tick value is formatted prior to display on screen  *
     F*              such that the no. of decimal places is equal to     *
     F*              instrument currency decimal places + 2.             *
     F*   FO0012  -  Remove redundant database error processing.         *
     F*   S01299  -  ALLOW 32 MARKET CENTRES AS PER ORIGINAL             *
     F*              SPECIFICATION.                                      *
     F*   E19546  -  THIS FIX CAUSES P/L CALCULATIONS TO BE OUT BY A     *
     F*              FACTOR OF 100.FIX NOT INCORPORATED.                 *
     F*   S01199  -  HELP SYSTEM                                         *
     F*   HK0000  -  SETTLEMENT DATE SHOULD NOT BE USED TO CHECK         *
     F*              WHETHER THE SPOT MONTH DATE FOR THE OTHER           *
     F*              CURRENCY IS A HOLIDAY                               *
     F*   S01195  -  HOLIDAY AMENDMENT                                   *
     F*   S01117  -  MULTIBRANCHING                                      *
     F*   E18188  -  CORRECT TICK VALUE WHICH MUST HAVE 5 DECIMAL        *
     F*              PLACES.                                             *
     F*   E18011  -  CORRECT VALIDATION OF SETTLEMENT CURRENCY.          *
     F*   E16369  -  TO ENSURE INF. MSG. APPEARS ON EACH SCREEN.         *
     F*   E16371  -  TICK VALUE TO ALLOW 2 DEC. PLACES MORE THAN         *
     F*              INSTRUMENT CURRENCY.                                *
     F*   E16372  -  CHANGE TO VALIDATE 'OTHER CURRENCY' ENTRY.          *
     F*   S01179      ****** AS400 CONVERSION ******                     *
     F*     The keyword RTGAID is no longer supported on the AS400       *
     F*     and command keys and indicators have been used to replace    *
     F*     this in the display file. To disrupt the structure of the    *
     F*     program as little as possible a new subroutine - ASCHGS -    *
     F*     has been coded. This moves the values which would have       *
     F*     been passed to the program (via RTGAID) into the AID         *
     F*     field depending on which function key has been pressed.      *
     F*                                                                  *
     F*------------------------------------------------------------------*
     F*     CREATION REQUIREMENTS                                        *
     F*                                                                  *
     F******IGNDECERR(*NO)                                               *073714
     F*     IGNDECERR(*YES)                                              *073714
     F*     OVRDBF     FILE(INTYP1X) TOFILE(INTYP1)                      *
     F*                                                                  *
     F********************************************************************
     FINTYP1  UF  E           K        DISK         KCOMIT       A
     F                                              KINFDS INFDS
     F                                              KINFSR INFSR
     FTRANS13 IF  E           K        DISK                               101432
     FINTYPA  UF  E                    DISK         KCOMIT
     F*POSTN2**IF**E***********K        DISK                              S01299
     FPOSTNCO IF  E           K        DISK                               S01299
     FPOSTNKO IF  E           K        DISK                               S01299
     FCHGCM   IF  E           K        DISK
     F*ABLETJ*IF* E           K        DISK                               S01195
     F*ABFF***IF* E           K        DISK                               S01117
     F**ICD*1**** TABTB10F                          KIGNORE               S01117
     F*********** TABTB11F                          KIGNORE               S01117
     F*********** TABTB20F                          KIGNORE               S01117
     F*********** TABTB40F                          KIGNORE               S01117
     F*********** TABTB80F                          KIGNORE               S01117
     F*********** TABTE10F                          KIGNORE               S01117
     F**CCY*1**** TABTG10F                          KIGNORE               S01117
     F*********** TABLETHF                          KIGNORE               S01117
     F*********** TABLETLF                          KIGNORE               S01117
     F*********** TABLETRF                          KIGNORE               S01117
     F*********** TABLET2F                          KIGNORE               S01117
     FFF0140DFCF  E                    WORKSTN      KINFDS SCRDS
     F                                        RRN   KSFILE FF0140S0
     FINTYP1X IF  E           K        DISK
     F            INTYPDF                           KRENAMEINTYPDFX
     F/COPY WNCPYSRC,FF0140F001
     FSECTY   IF  E           K        DISK                               CFF007
     F*
     F* ID F  C  H  L    FUNCTION OF INDICATORS
     F*
     F*       01         S/FF0140C0  SFLDSP
     F*       02         S/FF0140C0  SFLDSPCTL
     F*       03         S/FF0140C0  SFLEND
     F*       04         S/FF0140C0  ROLLDOWN NOT ALLOWED
     F*       05         S/FF0140F1  PROTECT/NON-DISPLAY ON LOCATION
     F*       06         S/FF0140F0  PROTECT FIELDS
     F*       07         S/FF0140F0  NON-DISPLAY INSTRUMENT TYPE          S01235
     F*
     F*       10         START  SCREEN
     F*       11         REVIEW SCREEN
     F*       12         UPDATE SCREEN
     F*
     F*       15         INDICATOR USED ON TESTN OPERATIONS
     F*       16         INDICATOR USED ON WRITE/UPDATE OPS TO CONDITION
     F*                                    CALL OF INFSR
     F*
     F*       21         S/FF0140F1  ERROR-ACTN
     F*       22         S/FF0140F1  ERROR-ISTT
     F*
     F*       23         S/FF0140F3  START SCREEN IS BEING DISPLAYED,
     F*                              F12 NOT ALLOWED                      S01179
     F*
     F*       25         ROLLUP                                           S01179
     F*       26         ROLLDOWN                                         S01179
     F********27**       HELP                                       S01179S01199
     F*                                                                   S01179
     F*       29         PROTECT INDICATOR FOR AMENDMENTS WITH SSF ON
     F*
     F*       30         S/FF0140F0  POSITION CURSOR
     F*       31         S/FF0140F0  ERROR-ISTN
     F*       32         S/FF0140F0  ERROR-ISPT
     F*                  S/FF0140F4  ERROR-SUNSE                          CFF007
     F*       33         S/FF0140F0  ERROR-ISCY
     F*       34         S/FF0140F0  ERROR-CTAM
     F*                  S/FF0140F4  ERROR-STECO                          CFF007
     F*       35         S/FF0140F0  ERROR-QOTC
     F*                  S/FF0140F4  ERROR-STNAT                          CFF007
     F*       36         S/FF0140F0  ERROR-TKDM
     F*                  S/FF0140F4  ERROR-SCRIK                          CFF007
     F*       37         S/FF0140F0  ERROR-MNPF
     F*                  S/FF0140F4  ERROR-SCCYR                          CFF007
     F*       38         S/FF0140F0  ERROR-TKVL
     F*                  S/FF0140F4  ERROR-STWEI                          CFF007
     F*       39         S/FF0140F0  ERROR-CMRF
     F*       40         S/FF0140F0  ERROR-PRRF
     F*       41         S/FF0140F0  ERROR-STRC
     F*       42         S/FF0140F0  ERROR-CCPT
     F*       43         S/FF0140F0  ERROR-OTHC
     F*       44         S/FF0140F0  ERROR-CCMC
     F*       45         S/FF0140F0  ERROR-CCMS
     F*       46         S/FF0140F0  ERROR-CCGP
     F*       47         S/FF0140F0  ERROR-CCGS
     F*       48         S/FF0140F0  ERROR-PUPF
     F*       49         S/FF0140F0  ERROR-FTDT
     F*       50         S/FF0140F0  ERROR-SETD
     F*       51         S/FF0140F0  ERROR-SPDT
     F*       52         S/FF0140F0  ERROR-ULPD
     F*       53         S/FF0140F0  ERROR-ALPD                           S01393
     F*       54         S/FF0140F0  ERROR-SINNR                          S01235
     F*
     F*       55         VLDCMDKY INDICATOR FOR DISPLAY FILE
     F*
     F*       56         S/FF0140F0  MATURE TRANSACTION                   E49198
     F*       57         S/FF0140F0  OVER FINAL TRANSACTION DATE          E49198
     F*                                                                   S01117
     F*       58         NO SELECTION IS MADE ON USER QUERY FACILITY      S01117
     F*                  OF OTHC WHEN ISPT IS '2' OR '5'                  S01117
     F*
     F*       60         ADD RECORD
     F*
     F*       71         S/FF0140F0  ERROR-AEIN                           FF0011
     F*       74         S/FF0140F4  NO DISPLAY-UNSE                      CFF007
     F*       75         S/FF0140F4  PROTECT                              CFF007
     F*                                                                   S01393
     F*       80         Linked enquiry                                   S01393
     F*                                                                   101432
     F*       84         READ TRANS13 FILE                                101432
     F*       89         End of File                                      CFF007
     F*
     F*       90-97      RESERVED FOR STANDARD SUBROUTINES
     F*       98         DATF = MMDDYY
     F*       99         WORK - ERROR INDICATOR
     F*
     F*       U1         PORTFOLIO MANAGEMENT MODULE PRESENT              S01235
     F*       U7         DATABASE ERROR
     F*       U8         PROGRAM  ERROR
     F*
     F*       'AID' VALUES USED
     F*
     F*       01         CA1
     F*       04         CA4
     F*       05         CA5
     F*       RA         ENTER PRESSED
     F*       UP         ROLLUP
     F*       DN         ROLLDOWN
     F*       HP         HELP PRESSED
     F*
     F* NOT USED ARE
     F*
     F*       PT         PRINT
     F*       CL         CLEAR
     F*       HM         HOME
     F*
     E                    CPY@    1   1 80
     E*
     E                    DET       256  1
     E*
      ** ARRAY FOR FORMATTING COMMIT TEXT
     E*
     E                    ERR        40  4
     E                    WER        10  4
     E*
      ** ARRAYS FOR SCREEN ERRORS
     E/COPY WNCPYSRC,FF0140E001
     E*
     E********************INF     1  12 76                                S01393
     E** Extra entry in array for use when program is called as           S01393
     E** linked enquiry.                                                  S01393
     E**********          INF     1  13 76                         S01393 CFF007
     E                    INF     1  14 76                                CFF007
     E/COPY WNCPYSRC,FF0140E002
     E*
      ** ARRAY OF SCREEN INFORMATIONAL FF0140F3
     E*
     E/COPY ZSRSRC,ZDATE2Z1
     E** SR.ARRAY FOR BOTH ZDATE1 AND ZDATE2
     E*
     E*COPY*ZSRSRC,ZDATE5Z1********************************************   S01195
     E***SR.ARRAY*FOR*ZDATE5*******************************************   S01195
     E*
     E/COPY ZSRSRC,ZALIGNZ1
     E** SR.ARRAY FOR BOTH ZALIGN AND ZEDIT
     E*
     E*COPY*ZSRSRC,ZHOLE**                                         S01195 073714
     E***SR.ARRAY*FOR*BOTH ZACCH AND ZCHKH                         S01195 073714
     E********************                                         S01195 073714
     E********************                                         FO0007 073714
     E***Array*of*Powers**                                         FO0007 073714
     E********************                                         FO0007 073714
     E********************POWER9  1   9 10 0                       FO0007 073714
     E/COPY WNCPYSRC,FF0140E003
     ISECTYDF                                                             CFF007
     I              RECI                            RECISE                CFF007
     ISCRCTL      DS
     I*
     I** KEY FIELDS (TAKEN FROM 'KEY' PORTION OF SCREEN)
     I                                        1   1 REVW
     I                                        2   2 ACTN
     I                                        3   7 ISTT
     I                                        8  12 PISTT
     I*                                                                   S01408
     I/COPY WNCPYSRC,FF0140IIP2                                           S01408
     I*                                                                   S01408
     I*
     IDETREC    E DSINTYPD
     I*
     I** DATA STRUCTURE FOR INITIALISING A RECORD
     I              ISTI                            ISTIX
     I              ISTT                            ISTTX
     I*DETS******E DSFF0140DF                                             S01179
     IDETS        DS                                                      S01179
     I*
     I** DATA STRUCTURE FOR SCREEN DETAIL OUTPUT TO CMTTXT
     I                                        1  20 SISTN                 S01179
     I                                       21  21 SISPT                 S01179
     I                                       22  24 SISCY                 S01179
     I                                       25  38 SCTAM                 S01179
     I                                       39  40 SQOTC                 S01179
     I                                       41  43 STKDM                 S01179
     I                                       44  55 SMNPF                 S01179
     I                                       56  70 STKVL                 S01179
     I                                       71  80 SCMRF                 S01179
     I                                       81  90 SPRRF                 S01179
     I                                       91  95 SSTRC                 S01179
     I                                       96  96 SCCPT                 S01179
     I                                       97  99 SOTHC                 S01179
     I                                      100 101 SCCMC                 S01179
     I                                      102 103 SCCMS                 S01179
     I                                      104 105 SCCGP                 S01179
     I                                      106 107 SCCGS                 S01179
     I                                      108 108 SPUPF                 S01179
     I                                      109 114 SFTDT                 S01179
     I                                      115 120 SSETD                 S01179
     I                                      121 126 SSPDT                 S01179
     I                                      127 129 SULPD                 S01179
     I                                      133 133 SAEIN                 FF0011
     I                                      134 138 SALPD                 S01393
     I                                      139 152 SCCAM                 073714
     I                                      153 155 SCTCY                 073714
     I                                      156 161 SFTTM                 073714
     I                                      156 159 SFTTMP                073714
     I                                      160 161 SFTTML                073714
     I                                      162 162 SFRTK                 CFF006
     I/COPY WNCPYSRC,FF0140I001
     I                                      162 171 SUNSE                 CFF007
     I                                      172 174 STECO                 CFF007
     I                                      175 177 STNAT                 CFF007
     I                                      178 179 SCRIK                 CFF007
     I                                      180 182 SCCYR                 CFF007
     I                                      183 184 STWEI                 CFF007
     I*CYK******* DS                             12                       S01117
     I***********                                                         S01117
     I***DATA*STRUCTURE*FOR*CHAIN*TO*CURRENCY*TABLE***********************S01117
     I***********                             1   2 CCY1                  S01117
     I***********                             9  11 TCCY                  S01117
     I***********                            12  12 CCY3                  S01117
     I*
     ISCRMSG      DS                          1 152
     I*
     I** DATA STRUCTURE FOR ERROR FF0140F3 TO SCREEN
     I                                        1  76 ERRMSG
     I                                       77 152 INFMSG
     ISCRDS       DS
     I*
     I** DISPLAY FORMAT STATUS DATA STRUCTURE
     I                                      287 288 AID
     IINFDS       DS
     I*
     I** FILE STATUS DATA STRUCTURE FOR RPG 01021 ERROR HANDLING
     I                                     *STATUS  STATUS
     I*DA********UDS                            256                       S01117
     ILDA         DS                            256                       S01117
     I*
     I** LOCAL DATA AREA FOR DATABASE ERROR DETAILS
     I** *LOCK IN LDA immediately before and OUT LDA immediately          S01117
     I** after each database error handling.                              S01117
     I***********                           134 177 DBLOT                 S01117
     I***********                           134 138 DBFILE                S01117
     I***********                           139 167 DBKEY                 S01117
     I***********                           168 175 DBPGM                 S01117
     I***********                           176 1770DBASE                 S01117
     I                                      134 141 DBFILE                S01117
     I                                      142 170 DBKEY                 S01117
     I                                      171 180 DBPGM                 S01117
     I                                      181 1830DBASE                 S01117
     I**                                                                  S01117
     IRUNDT       DS                                                      S01117
     I** DATA AREA RUNDAT                                                 S01117
     I                                        1   7 RUNA                  S01117
     I                                    P   8  100RUND                  S01117
     I                                       11  11 SSF                   S01117
     I                                       12  12 DATF                  S01117
     I                                       13  13 MBIN                  S01117
      *                                                                   CFF007
      ** DS for Economic Sector Description Access Object                 CFF007
      *                                                                   CFF007
     ISDECOS    E DSSDECOSPD                                              CFF007
      *                                                                   CFF007
      ** DS for Local Industry Codes Access Object                        CFF007
      *                                                                   CFF007
     ISDINDS    E DSSDINDSPD                                              CFF007
      *                                                                   CFF007
      ** DS for Nature Code Description Access Object                     CFF007
      *                                                                   CFF007
     ISDNATU    E DSSDNATUPD                                              CFF007
      *                                                                   CFF007
      ** DS for Country Code Access Object                                CFF007
      *                                                                   CFF007
     ISDCTRY    E DSSDCTRYPD                                              CFF007
      *                                                                   CFF007
      ** DS for Weighting Code Description Access Object                  CFF007
      *                                                                   CFF007
     I*SDWEIG***E*DSSDWEIGPD***                                                        CFF007 CGP001
     IGPWEIG    E DSGPWEIGPD                                                                  CGP001
     I              PDLCD                           PDLCDX                CFF007
      *                                                                   CFF007
      **                                                                  S01117
     ISDBANK    E DSSDBANKPD                                              S01195
     I** BANK DETAILS                                                     S01195
     I              BJSLCD                          SYSL                  S01195
     ISDCURR    E DSSDCURRPD                                              S01117
     I** CURRENCY DETAILS                                                 S01117
     I              A6CYCD                          CURR                  S01117
     I              A6NBDP                          CDP                   S01117
     ISDPLIN    E DSSDPLINPD                                              S01235
     I** Instrument types details                                         S01235
     I              PDWEIG                          P2WEIG                                    CLE025
      *                                                                                       CLE025
     ISDMMOD    E DSSDMMODPD                                              S01235
     I** Modules details                                                  S01235
     ISDPORT    E DSSDPORTPD                                              PMC143
     I** Portfolio ICD                                                    PMC143
      **                                                                  S01117
     IZMUSER      DS                             17                       S01117
      ** DATA AREA OF MENU USER                                           S01117
     I                                       11  13 USRBCH                S01117
     ISCSARD    E DSSCSARDPD                                              CFF006
      ** External DS for SAR Details                                      CFF006
     I              LCD                             SALCD                 CFF006
      *                                                                   CFF006
     I@DSFDY    E DSDSFDY                                                 S01117
     I*  FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE               S01117
     IDSSDY     E DSDSSDY                                                 073714
     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE                073714
     I*
     I/COPY ZSRSRC,ZTNLU1Z1
     I**   DATA STRUCTURE TO UPDATE LAST TRANSACTION NUMBER DTAARA
     I*                                                                   S01195
     I*COPY*ZSRSRC,ZHOLI******                                     S01195 073714
      ****EXTERNAL*DS*FOR*HOLIDAY DETAILS                          S01195 073714
     I************************                                     S01195 073714
     I*COPY*ZSRSRC,ZHOLDS*****                                     S01195 073714
      ****EXTERNAL*DS*FOR*HOLIDAY DETAILS AND ACCESS OBJECTS       S01195 073714
     I*
     ICMTTXT      DS
     I*
     I** DATA STRUCTURE FOR SETUP OF COMMIT TEXT
     I                                        1   50NATN
     I                                        6   7 MDID
     I                                        8  15 PGMN
     I                                       16  18 WSIDX
     I                                       19  240MTIME
     I                                       25  25 ACTNX
     I                                       26  35 USIDX
     I                                       51 306 DET
     IPSDS       SDS
     I*
     I** PROGRAM STATUS DATA STRUCTURE FOR WS/USER ID'S
     I** and passed parameter indicator, used when called as              S01393
     I** a linked enquiry.                                                S01393
     I                                       37  390WWPARM                S01393
     I                                      244 246 WSID
     I                                      254 263 USID
     I*  DATA STRUCTURE FOR COMPILATION  - COPYRIGHT INSERTION
     ICPYR@#      DS
     I                                        1  80 CPY@
     I                                        1  20 CPY@##
     I*                                                                   S01408
     I/COPY WNCPYSRC,FF0140IIP1                                           S01408
     I*                                                                   S01408
     C* CALCULATION SPECIFICATIONS:KEY LISTS
     C*
      **  DEFINE KEY LIST FOR CHAINING TO INTYP1 FILE
     C*
     C           INTP1K    KLIST
     C                     KFLD           ISTI
     C                     KFLD           ISTT
     C*
      **  DEFINE KEY LIST FOR CHAINING TO CHGCM FILE
     C*
     C           CHGCMK    KLIST
     C                     KFLD           CCY
     C                     KFLD           CGCM
      /EJECT
     C*================================================================
     C*  P R O G R A M     S T A R T
     C*================================================================
     C*
      ** PERFORM SETUP OF STANDARD FIELDS
     C*
     C                     EXSR INIT
     C*
      ** MAIN PROCESS - PERFORM UNTIL F3 OR ERROR
     C*
     C           AID       DOUEQ'01'
     C           *INU7     OREQ '1'
     C*
     C           *IN10     CASEQ'1'       START
     C*
     C           *IN11     CASEQ'1'       REVIEW
     C*
     C           *IN12     CASEQ'1'       UPDATE
     C*
     C                     END
     C                     END
     C*
      ** TERMINATE PROGRAM
      ** If program has been called as a linked enquiry and a database    S01393
      ** error has occurred then set return code and return to calling    S01393
      ** program.                                                         S01393
     C*                                                                   S01393
     C           *IN80     IFEQ '1'                                       S01393
     C           *INU7     ANDEQ'1'                                       S01393
     C                     MOVE 'ERR '    PPRTCD                          S01393
     C                     RETRN                                          S01393
     C                     END                                            S01393
     C*
     C                     SETON                         LR
     C*================================================================
     C*  P R O G R A M     E N D
     C*================================================================
      /EJECT
      ********************************************************************
      ** INDEX OF SUBROUTINES
      **
      ** INIT              INITIALISATION OF STANDARD FIELDS,
      **                   ACCESS OF STANDING DATA
      **
      ** START             OUTPUT AND PROCESS KEY FIELDS SCREEN
      **
      ** REVIEW            PROCESS SUBFILE SELECTION SCREEN
      **
      ** UPDATE            PROCESS DETAIL SCREEN AND UPDATE FILE
      **
      ** VALIDK            VALIDATE KEY FIELDS
      **
      ** VALIDD            VALIDATE DETAIL SCREEN
      **
      ** DEFLTS            FORMAT DEFAULT FIELD VALUES
      **
      ** INITRC            INITIALISE ALL FILE FIELDS TO ZERO/BLANK
      **
      ** TRSFS             FORMAT RECORD FIELDS FOR SCREEN
      **
      ** UPDFLS            UPDATE FILE RECORDS
      **
      ** UPDOWS            PROCESS UPDATE BY ANOTHER WORKSTATION
      **
      ** ZALIGN            VALIDATE AMOUNT FIELDS
      **
      ***ZDATE5************VALIDATE*DATES*AS*HOLIDAYS*IN*A*GIVEN*CCY******S01195
      ***ZACCH*************ACCESS THE HOLIDAY FILE*****************S01195 073714
      *************************************************************S01195 073714
      ***ZCHKH*************VALIDATE*DATES*AS*HOLIDAYS*IN*A*GIVEN*CCS01195 073714
      **
      ** ZEDIT             FORMAT AMOUNT FIELDS FOR DISPLAY
      **
      ** ZDATE1            CONVERT DATE TO DAYNO. AND REPORT IF ERROR
      **
      ** ZDATE2            CONVERT DAYNO. TO DATE FOR DISPLAY
      **
      ** ZTNLU1            ACCESS DATAAREA FOR NEXT TRANSACTION NO.
      **
      ** INFSR             FILE ERROR HANDLING S/R
      **                                                                  S01117
      ** *PSSR             HANDLES ABNORMAL ERROR CONDITIONS              S01117
      **
      ********************************************************************
      /EJECT
      ********************************************************************
      **
      ** INIT S/R - TO INITIALISE STATIC FIELDS AND ACCESS STANDING DATA
      ** If program is called as a linked enquiry the OTC code (passed    S01393
      ** in as a parameter) is moved to the relevant field and            S01393
      ** indicator 80 is set on.                                          S01393
      ** CALLED ONCE AT START OF PROGRAM FROM MAIN LINE
      ** CALLS NO OTHER ROUTINES
      **
      ********************************************************************
     C*
     C           INIT      BEGSR                           * INIT BEGSR *
     C*
      ** Linked enquiry                                                   S01393
     C*                                                                   S01393
     C           *ENTRY    PLIST                                          S01393
     C                     PARM           PPOTCC  5                       S01393
     C                     PARM           PPRTCD  4                       S01393
     C*                                                                   S01393
     C           WWPARM    IFNE 0                          B1             S01393
     C                     MOVE PPOTCC    ISTT             *1             S01393
     C                     MOVE 'Y'       ISTI             *1             S01393
     C                     MOVE 'E'       ACTN             *1             S01393
     C                     SETON                     80    *1             S01393
     C                     END                             E1             S01393
     C*                                                                   S01393
      ** PREPARE LDA
     C*
     C           *NAMVAR   DEFN           LDA                             S01117
     C           *LOCK     IN   LDA                                       S01117
     C***********          MOVEL*BLANK    DBLOT                           S01117
     C                     MOVEL*BLANK    DBFILE                          S01117
     C                     MOVEL*BLANK    DBKEY                           S01117
     C                     MOVEL*BLANK    DBPGM                           S01117
     C                     MOVEL'FF0140'  DBPGM
     C                     Z-ADD*ZEROS    DBASE                           S01117
     C                     OUT  LDA                                       S01117
     C***********                                                         S01117
      ***CURRENCY*RECORD*KEY**********************************************S01117
     C***********                                                         S01117
     C***********          MOVEL'20'      CCY1                            S01117
     C***********          MOVEL'1'       CCY3                            S01117
     C*
      ** PREPARE COMIT TEXT
     C*
     C                     MOVEL'FF'      MDID
     C                     MOVEL'FF0140'  PGMN
     C                     MOVELWSID      WSIDX
     C                     MOVELUSID      USIDX
     C*
      ** HELP PROGRAM PARAMETER
     C*
     C                     MOVEL'FF0140'  HBPGM   8
     C                     MOVEL*BLANK    WBLNK   1
     C*
      ** FOR HIGH INTENSITY SCREEN ATTRIBUTE
     C*
     C                     BITOF'01234567'HI      1
     C                     BITON'267'     HI
     C                     MOVELHI        INF,7
     C                     MOVELHI        INF,8
     C                     MOVELHI        INF,9
     C                     MOVELHI        INF,10
     C                     MOVELHI        INF,11
     C/COPY WNCPYSRC,FF0140C003
     C                     MOVELHI        INF,14                          CFF007
     C***********                                                         S01117
      ***GET*INSTALLATION*CONTROL*DATA*RECORD*1***************************S01117
     C***********                                                         S01117
     C***********          READ TABTB10F                 99               S01117
     C**N99******RECI      COMP 'D'                  9999                 S01117
     C************IN99     IFEQ '0'                                       S01117
     C***********                                                         S01117
      ***IF*FOUND*CHECK*SYSTEM*DATE*FORMAT,*DDMMYY*OR*MMDDYY.*************S01117
     C*                                                                   S01117
     C** IN THE DATAAREA RUNDAT                                           S01117
     C*                                                                   S01117
     C           *NAMVAR   DEFN RUNDAT    RUNDT                           S01117
     C                     IN   RUNDT                                     S01117
     C*                                                                   S01117
     C** IN THE DATAAREA ZMUSER                                           S01117
     C*                                                                   S01117
     C           *NAMVAR   DEFN           ZMUSER                          S01117
     C                     IN   ZMUSER                                    S01117
     C*
     C           DATF      COMP 'M'                      98
     C***********          ELSE                                           S01117
     C***********                                                         S01117
      ***OTHERWISE*DB*ERROR***********************************************S01117
     C***********                                                         S01117
     C***********          SETON                     U7U8  ***************S01117
     C***********          Z-ADD1         DBASE            * DB ERROR 01 *S01117
     C***********          MOVEL'TABFF'   DBFILE           ***************S01117
     C***********          MOVEL'01'      ZTABKY 12                       S01117
     C***********          MOVE '10'      ZTABKY                          S01117
     C***********          MOVELZTABKY    DBKEY                           S01117
     C***********          END                                            S01117
     C**                                                                  S01117
     C**   GET BANK DETAILS                                               S01117
     C**                                                                  S01117
     C                     CALL 'AOBANKR0'                                S01117
     C                     PARM '*DBERR ' @RTCD   7                       S01117
     C                     PARM '*FIRST ' @OPTN   7                       S01117
     C           SDBANK    PARM SDBANK    @DSFDY                          S01117
     C***********@RTCD     IFNE *BLANKS                            S01117 FO0012
     C************LOCK     IN   LDA                                S01117 FO0012
     C***********          MOVEL'SDBANKPD'DBFILE                   S01117 FO0012
     C***********          SETON                     U7U8    ******S01117 FO0012
     C***********          Z-ADD01        DBASE              * DBERS01117 FO0012
     C***********          MOVEL@OPTN     DBOPTN  7          ******S01117 FO0012
     C***********          MOVEL@OPTN     DBKEY                    S01117 FO0012
     C***********          OUT  LDA                                S01117 FO0012
     C***********          EXSR *PSSR                              S01117 FO0012
     C***********          END                                     S01117 FO0012
     C*
      ** PROCEED TO START SCREEN UNLESS DATABASE ERRPR
      ** or program has been called as a linked enquiry in which case     S01393
      ** display OTC instrument details ('UPDATE' subroutine)             S01393
     C*
     C           *INU7     IFNE '1'
     C**********           MOVEA'1'       *IN,10                          S01393
     C  N80                MOVEA'1'       *IN,10                          S01393
     C   80                MOVEA'1'       *IN,12                          S01393
     C*                                                                   S01408
     C/COPY WNCPYSRC,FF0140CCP1                                           S01408
     C*                                                                   S01408
     C                     END
     C*                                                                   S01408
     C/COPY WNCPYSRC,FF0140CCP5                                           S01408
     C*                                                                   S01408
     C*                                                                   S01235
     C** DO NOT DISPLAY INSTRUMENT TYPE INPUT FIELD IF NO PORTF MGMT      S01235
     C*                                                                   S01235
     C                     CALL 'AOMMODR0'                                S01235
     C                     PARM *BLANKS   @RTCD   7                       S01235
     C                     PARM '*FIRST ' @OPTN   7                       S01235
     C           SDMMOD    PARM SDMMOD    @DSFDY                          S01235
     C           @RTCD     IFNE *BLANKS                                   S01235
     C           *LOCK     IN   LDA                                       S01235
     C                     Z-ADD31        DBASE            ***************S01235
     C                     MOVE 'SDMMODPD'DBFILE           * DB ERROR 31 *S01235
     C                     MOVE *BLANKS   DBKEY            ***************S01235
     C                     OUT  LDA                                       S01235
     C                     EXSR *PSSR                                     S01235
     C                     END                                            S01235
     C           BGN4ST    IFEQ 'Y'                                       CPB001
     C                     MOVE *ON       *IN08                           CPB001
     C                     ENDIF                                          CPB001
     C           BGPFMG    IFNE 'Y'                                       S01235
     C           BGN4ST    IFNE 'Y'                                       CPB001
     C                     MOVE *ON       *IN07                           S01235
     C                     ENDIF                                          CPB001
     C                     ELSE                                           PMC143
     C*                                                                   PMC143
     C                     CALL 'AOPORTR0'                                PMC143
     C                     PARM *BLANKS   @RTCD   7                       PMC143
     C                     PARM '*FIRST ' @OPTN   7                       PMC143
     C           SDPORT    PARM SDPORT    @DSFDY                          PMC143
     C           @RTCD     IFNE *BLANKS                                   PMC143
     C           *LOCK     IN   LDA                                       PMC143
     C                     SETON                     U7U8  ***************PMC143
     C                     Z-ADD32        DBASE            * DB ERROR 32 *PMC143
     C                     MOVE 'SDPORTPD'DBFILE           ***************PMC143
     C                     MOVE *BLANKS   DBKEY                           PMC143
     C                     OUT  LDA                                       PMC143
     C                     EXSR *PSSR                                     PMC143
     C                     END                                            PMC143
     C*                                                                   PMC143
     C** If Bank Portfolios are supported, treat as if PM off             CPM003
     C*                                                                   CPM003
     C           FCPORS    IFEQ 'B'                                       CPM003
     C           BGN4ST    ANDNE'Y'                                       CPB001
     C                     MOVE *ON       *IN07                           CPM003
     C                     END                                            CPM003
     C*                                                                   CPM003
     C                     END                                            S01235
     C/COPY WNCPYSRC,FF0140C004
      *                                                                   CFF007
      ** Check if switchable feature CFF007 is installed                  CFF007
      *                                                                   CFF007
     C                     CALL 'AOSARDR0'                                CFF007
     C                     PARM *BLANKS   @RTCD   7                       CFF007
     C                     PARM '*VERIFY' @OPTN   7                       CFF007
     C                     PARM 'CFF007'  @SARD   6                       CFF007
     C           SCSARD    PARM SCSARD    DSSDY                           CFF007
      *                                                                   CFF007
     C           @RTCD     IFNE *BLANKS                                   CFF007
     C           @RTCD     ANDNE'*NRF   '                                 CFF007
     C           *LOCK     IN   LDA                                       CFF007
     C                     Z-ADD15        DBASE             **************CFF007
     C                     MOVE 'SCSARDPD'DBFILE            *DB ERROR 015*CFF007
     C                     MOVEL@SARD     DBKEY             **************CFF007
     C                     EXSR *PSSR                                     CFF007
     C                     ELSE                                           CFF007
      *                                                                   CFF007
     C           @RTCD     IFEQ *BLANKS                                   CFF007
     C                     MOVE 'Y'       CFF007  1                       CFF007
     C                     ELSE                                           CFF007
     C                     MOVE 'N'       CFF007                          CFF007
     C                     ENDIF                                          CFF007
     C                     ENDIF                                          CFF007
     C*
     C           *LIKE     DEFN CDP       ICDP                            073714
     C           *LIKE     DEFN CDP       OCDP                            073714
     C           *LIKE     DEFN CDP       CCDP                            073714
      *                                                                   CFF006
      **  Access SAR details file to see if switchable feature            CFF006
      **  CFF006 - Fractional Ticks Enhancement is installed.             CFF006
      *                                                                   CFF006
     C                     CALL 'AOSARDR0'                                CFF006
     C                     PARM *BLANKS   PRTCD   7                       CFF006
     C                     PARM '*VERIFY' POPTN   7                       CFF006
     C                     PARM 'CFF006'  PSARD   6                       CFF006
     C           SCSARD    PARM SCSARD    @DSFDY                          CFF006
      *                                                                   CFF006
     C           PRTCD     IFEQ *BLANK                                    CFF006
     C                     MOVE *OFF      *IN89                           CFF006
     C                     MOVE 'Y'       CFF006  1                       CFF006
     C                     ELSE                                           CFF006
     C                     MOVE *ON       *IN89                           CFF006
     C                     MOVE 'N'       CFF006                          CFF006
     C                     ENDIF                                          CFF006
     C*                                                                   073714
      *                                                                                       CER001
      **  Determine if ULX004 is installed.                                                   CER001
      *                                                                                       CER001
     C                     CALL 'AOSARDR0'                                                    CER001
     C                     PARM *BLANKS   PRTCD                                               CER001
     C                     PARM '*VERIFY' POPTN                                               CER001
     C                     PARM 'ULX004'  PSARD                                               CER001
     C           SCSARD    PARM SCSARD    @DSFDY                                              CER001
     C           PRTCD     IFEQ *BLANK                                                        CER001
     C                     MOVE 'Y'       ULX004  1                                           CER001
     C                     ELSE                                                               CER001
     C                     MOVE 'N'       ULX004                                              CER001
     C           PRTCD     IFNE '*NRF    '                                                    CER001
     C                     MOVEL'SCSARDPD'DBFILE                                              CER001
     C                     Z-ADD1         DBASE                                               CER001
     C                     MOVEL'ULX004'  DBKEY                                               CER001
     C                     EXSR *PSSR                                                         CER001
     C                     ENDIF                                                              CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
     C           XTINIT    ENDSR                           ** XTINIT ESR**
     C*===================================================================
      /EJECT
      ********************************************************************
      **
      ** START S/R TO OUTPUT AND PROCESS KEY FIELDS SCREEN
      ** CALLED FROM MAIN PROCESSING
      ** CALLS: VALIDK TO VALIDATE KEY FIELDS IF ENTERED
      **
      ********************************************************************
     C*
     C           START     BEGSR                           ** START BSR **
     C*
      ** INITIALISE SCREEN DATA
     C*
     C                     MOVEA'0'       *IN,10
     C                     MOVEA'001'     *IN,21
     C                     MOVEA'0'       *IN,29
     C                     MOVEL*BLANK    SCRCTL
     C*********************MOVELINF,1     INFMSG                          E16369
     C                     MOVEL*BLANK    ERRMSG
     C*
      ** CLEAR WHOLE SCREEN
     C*
     C                     WRITEFF0140F3
     C*
      ** PERFORM UNTIL CHANGE OF REQUEST (TO END/REVIEW/DETAIL)
     C*
     C           *IN10     DOUEQ'1'
     C           *IN11     OREQ '1'
     C           *IN12     OREQ '1'
     C*
      ** OUTPUT START SCREEN AND READ IN
     C*
     C                     MOVELINF,1     INFMSG                          E16369
     C**********           WRITEFF0140F1                                                      CAAA03
     C                     WRITEFF0140F2
     C                     WRITEFF0140F1                                                      CAAA03
     C                     READ FF0140F1                 99
     C                     MOVELERRMSG    HERCD 160
     C                     MOVELWBLNK     HERCD
     C                     MOVEL*BLANK    SCRMSG
     C                     MOVEA*BLANK    ERR
     C*
      ** KEY FIELDS SCREEN OUTPUT - READ UNTIL REQUEST TO PROCESS
     C*
     C** Call S/R to move values into AID                                 S01179
     C*                                                                   S01179
     C                     EXSR ASCHGS                                    S01179
     C*                                                                   S01179
      **  CK3, HELP, OR ENTER CAN BE TAKEN
     C*
      ** CK3 - TERMINATE
     C*
     C           AID       IFEQ '01'
     C                     MOVEA'1'       *IN,10
     C                     END
     C*
      ** HELP - CALL HELP PROGRAM
     C*
     C********** AID       IFEQ 'HP'                                      S01199
     C**********           MOVELHERCD     ERRMSG                          S01199
     C**********                                                          S01199
      ***IF*ERRORS ARE PRESENT, HIGHLIGHT MESSAGE LINE                    S01199
     C**********                                                          S01199
     C***********ERRMSG    IFNE *BLANK                                    S01199
     C***********          MOVELHI        ERRMSG                          S01199
     C***********          END                                            S01199
     C***********                                                         S01199
     C***********          CALL 'MHELP'                                   S01199
     C***********          PARM           HBPGM                           S01199
     C***********          PARM           HERCD                           S01199
     C***********                                                         S01199
     C***END*OF*HELP PROCESSING                                           S01199
     C***********                                                         S01199
     C***********          END                                            S01199
     C*
      ** ENTER TAKEN VALIDATE KEY INPUT
     C*
     C           AID       IFEQ 'RA'
     C                     EXSR VALIDK
     C*
      ** IF NO ERRORS, DETERMINE NEXT SCREEN
     C*
     C           SCRMSG    IFEQ *BLANK
     C*
      **  - IF ISSUE TYPE KEY FIELD IS BLANK, FORMAT FOR A REVIEW
     C*
     C           ISTT      IFEQ *BLANK
     C                     MOVEA'1'       *IN,11
     C*
      **  - OTHERWISE, DISPLAY REQUESTED DETAIL SCREEN AS PER KEY INPUT
     C*
     C                     ELSE
     C                     MOVEA'1'       *IN,12
     C                     END
     C*
      ** SET OFF INDICATOR CONDITIONING F12
     C*
     C                     MOVEA'0'       *IN,23
     C*
      ** IF AMEND, AND SSF IS ON, SET SCREEN INDICATOR
      ** DISALLOWING AMENDMENT OF ISCY, ISPT, TKDM AND OTHC.
     C*
     C           ACTN      IFEQ 'A'
     C***********SFLG      ANDEQ1                                         S01117
     C           SSF       ANDEQ'Y'                                       S01117
     C                     SETON                     29
     C                     END
     C*
      ** END OF PROCESSING FOR CLEAN OF ERRORS
     C*
     C                     END
     C*
      ** END OF ENTER PROCESSING
     C*
     C                     END
     C*
      ** END OF START SCREEN PROCESSING LOOP
     C*
     C                     END
     C*
     C           XTSTAR    ENDSR                           ** XTSTAR ESR**
     C*
      /EJECT
     C********************************************************************
      **
      ** REVIEW S/R TO PROCESS SUBFILE SELECTION SCREEN
      ** CALLED FROM MAIN PROCESSING
      ** CALLS NO OTHER ROUTINES
      **
     C********************************************************************
     C*
     C           REVIEW    BEGSR                           ** REVIEW BSR**
     C*
      ** SET OFF PROCESS REVIEW INDICATOR
      ** SET PROCESSING FLAG TO FORCE SUBFILE REBUILD
     C*
     C                     MOVEL*BLANK    ERRMSG
     C                     MOVEA'0'       *IN,11
     C                     MOVEA'0'       *IN,29
     C                     MOVEL'RA'      AID
     C*
      ** PERFORM UNTIL CHANGE OF REQUEST (TO END/KEY SCREEN/DETAIL)
     C*
     C           *IN10     DOUEQ'1'
     C           *IN11     OREQ '1'
     C           *IN12     OREQ '1'
     C*
      ** SUBFILE PROCESSING - ROLLUP, ROLLDOWN OR ENTER
     C*
      ** REBUILD SUBFILE
     C*
     C           AID       IFEQ 'DN'
     C           AID       OREQ 'UP'
     C           AID       OREQ 'RA'
     C*
      ** WRITE CONTROL RECORD
     C*
     C                     MOVEA'000'     *IN,1
     C                     Z-ADD*ZERO     RRN
     C                     WRITEFF0140C0
     C                     MOVEA'1'       *IN,4
     C*
      ** SET FILE POINTER - PAGE BACK
     C*
     C           AID       IFEQ 'DN'
     C                     MOVEL'Y'       ISTI
     C                     MOVEL*BLANK    ISTT
     C           *LIKE     DEFN PISTT     PPAGK
     C                     MOVEL*BLANK    PPAGK
     C           INTP1K    SETLLINTYP1X
     C*
      **  - PAGE FORWARD
     C*
     C                     ELSE
     C                     MOVEL'Y'       ISTI
     C                     MOVELPISTT     ISTT
     C                     MOVELPISTT     PPAGK
     C           INTP1K    SETLLINTYP1X
     C                     END
     C*
      ** READ IN DETAILS-FILL UP SUBFILE
     C*
     C           RRN       DOUEQ18
     C           *IN,03    OREQ '1'
     C*
      ** READ DETIALS UNTIL SUBFILE PAGE IS FULL
     C*
     C                     READ INTYP1X                  03
     C           *IN,03    IFEQ '0'
     C*
      ** IF RECORD IS DELETED, FLAG IT AS SO ON SCREEN
     C*
     C           RECI      IFEQ '*'
     C                     MOVEL'D'       STAT    1
     C                     ELSE
     C                     MOVEL*BLANK    STAT
     C                     END
     C*
     C                     ADD  1         RRN     40     04
     C*
     C                     WRITEFF0140S0
     C*
      ** RECORD NOW WRITTEN TO SUBFILE
     C*
     C                     END
     C*
      ** PAGE NOW FULL (OR EOF)
     C*
     C                     END
     C*
      **  READ ONE MORE RECORD FOR NEXT SCREEN
     C*
     C           *IN,03    IFEQ '0'
     C                     READ INTYP1X                  03
     C                     END
     C*
      ** IF NOT EOF SET NEXT 'REVIEW FROM' KEY ELSE SET IT TO BLANK
     C*
     C           *IN,03    IFEQ '0'
     C                     MOVELISTT      PISTT
     C                     ELSE
     C                     MOVEL*BLANK    PISTT
     C                     END
     C*
      ** FOR SUBFILE CONTROL
     C*
     C           *IN,4     IFEQ '1'
     C                     MOVEA'010'     *IN,1
     C                     ELSE
     C                     MOVEA'11'      *IN,1
     C                     END
     C*
      ** END OF PAGING PROCESSING
     C*
     C                     END
     C*
      ** OUTPUT REVIEW SCREEN AND READ REQUEST
     C*
     C           *IN04     IFEQ '0'
     C                     MOVELINF,2     INFMSG
     C                     ELSE
     C                     MOVELINF,12    INFMSG
     C                     END
     C**********           WRITEFF0140C0                                                      CAAA03
     C                     WRITEFF0140F2
     C                     WRITEFF0140C0                                                      CAAA03
     C                     READ FF0140C0                 99
     C                     MOVELERRMSG    HERCD
     C                     MOVELWBLNK     HERCD
     C                     MOVEL*BLANK    SCRMSG
     C                     MOVEA*BLANK    ERR
     C                     MOVEL*BLANK    REVW
     C*
      ** PROCESS REQUEST - F3, F12, HELP OR RECORD SELECT
     C*
     C** Call S/R to move values into AID                                 S01179
     C*                                                                   S01179
     C                     EXSR ASCHGS                                    S01179
     C*                                                                   S01179
      ** CK3
     C*
     C           AID       IFEQ '01'
     C                     MOVEA'1'       *IN,11
     C                     END
     C*
      ** CK12
     C*
     C           AID       IFEQ '05'
     C                     MOVEA'1'       *IN,10
     C                     END
     C*
      **  HELP
     C*
     C***********AID       IFEQ 'HP'                                      S01199
     C***********          MOVELHERCD     ERRMSG                          S01199
     C***********                                                         S01199
     C***HIGHLIGHT IF ERROR                                               S01199
     C***********                                                         S01199
     C***********ERRMSG    IFNE *BLANK                                    S01199
     C***********          MOVELHI        ERRMSG                          S01199
     C***********          END                                            S01199
     C***********                                                         S01199
     C***********          CALL 'MHELP'                                   S01199
     C***********          PARM           HBPGM                           S01199
     C***********          PARM           HERCD                           S01199
     C***********          END                                            S01199
     C*
      ** ENTER PRESSED, PROCESS RECORD SELECTION
     C*
     C           AID       IFEQ 'RA'
     C                     MOVEA'1'       *IN,99
     C           *IN,04    IFEQ '0'
     C                     READCFF0140S0                 99
     C                     END
     C*
      ** VALIDATE RECORD SELECTION
     C*
     C           *IN99     IFEQ '0'
     C                     EXSR VALIDK
     C*
      ** NO ERRORS, UPDATE SCREEN CAN BE PROCESSED NEXT
     C*
     C           SCRMSG    IFEQ *BLANK
     C                     MOVEA'1'       *IN,12
     C                     MOVEL'Y'       REVW
     C*
      ** IF AMEND, AND SSF IS ON, SET SCREEN INDICATOR
      ** DISALLOWING AMENDMENT OF ISCY, ISPT, TKDM AND OTHC.
     C*
     C           ACTN      IFEQ 'A'
     C***********SFLG      ANDEQ1                                         S01117
     C           SSF       ANDEQ'Y'                                       S01117
     C                     SETON                     29
     C                     END
     C                     END
     C*
      ** END OF RECORD VALIDATION
     C*
     C                     END
     C*
      ** END OF ENTER PROCESSING
     C*
     C                     END
     C*
      ** END OF PROCESSING LOOP
     C*
     C                     END
     C*
     C           XTREVI    ENDSR                           ** XTREVI ESR**
     C*
     C********************************************************************
      /EJECT
     C********************************************************************
      **
      ** UPDATE S/R TO PROCESS DETAIL SCREEN AND UPDATE FILE
      ** CALLED FROM MAIN PROCESSING
      ** CALLS: VALIDD, UPDFLS, INITRC, TRSFS, DEFLTS
      **
     C********************************************************************
     C*
     C           UPDATE    BEGSR                           ** UPDATE BSR**
     C*
      ** SET SCREEN INDICATORS - PROTECT KEY, SET OFF ERROR INDS,
      ** POSITION CURSOR
     C*
     C                     MOVEA'1'       *IN,5
     C                     MOVEA'0'       *IN,12
     C                     MOVEA'10000000'*IN,30
     C                     MOVEA'00000000'*IN,38
     C                     MOVEA'00000000'*IN,46
     C                     MOVE '0'       *IN54                           CPB001
     C                     MOVEA'0'       *IN,71                          FF0011
     C*
      ** ACCESS FILE RECORD FOR OLD TNLU TO CHECK AT UPDATE TIME
      ** IF NO RECORD PRESENTLY ON FILE, ZEROISE STORED TNLU
     C*
     C                     Z-ADD*ZERO     STNLU   50
     C           INTP1K    CHAININTYP1X              99
     C           *IN,99    IFEQ '0'
     C                     Z-ADDTNLU      STNLU
     C                     END
     C*
      ** IF INSERT (NEW OR OVER DELETED RECORD)
      ** INITIALIZE ALL FIELDS ON THE RECORD (IE ZEROIZE/BLANK OUT)
     C*
     C           ACTN      IFEQ 'I'
     C                     EXSR INITRC
     C                     END
     C*
      ** IF DELETED RECORD-ENQUIRY ONLY (RECI IS SET TO BLANK FOR INSERTS)
     C*
     C           RECI      IFEQ '*'
     C                     MOVEL'E'       ACTN
     C                     MOVEL'DELETED' DELT
     C                     ELSE
     C                     MOVEL*BLANK    DELT
     C                     END
     C*
      ** TRANSLATE RECORD DETAILS FROM FILE LAYOUT TO SCREEN LAYOUT
     C*
     C                     EXSR TRSFS
     C*
      ** DATABASE ERROR CAN OCCUR IN TRSFS - EXIT S/R
     C*
     C           *INU7     CABEQ'1'       XTUPDT
     C*
      ** SET UP DEFAULTS (DONE ON BLANK FIELDS)
     C*
     C                     EXSR DEFLTS
     C*
      ** IF DELETE/ENQUIRY PROTECT FIELD INPUT ON S/FF0140F0
     C*
     C           ACTN      IFEQ 'D'
     C           ACTN      OREQ 'E'
     C                     MOVEA'1'       *IN,6
     C                     END
     C*
      ** PERFORM UNTIL CHANGE OF REQUEST
     C*
     C           *IN10     DOUEQ'1'
     C           *IN11     OREQ '1'
     C           *IN12     OREQ '1'
     C*
      ** FORMAT INFORMATIONAL MESSAGE IF NOT ALREADY PRESENT
     C*
     C                     SETOF                     5657                 073714
     C           INFMSG    IFEQ *BLANK
     C           ACTN      IFEQ 'I'
     C                     MOVELINF,3     INFMSG
     C                     END
     C           ACTN      IFEQ 'A'
     C                     MOVELINF,4     INFMSG
     C                     END
     C           ACTN      IFEQ 'E'
     C*                                                                   S01393
     C** Use linked enquiry text message if program called as such.       S01393
     C*                                                                   S01393
     C**********           MOVELINF,5     INFMSG                          S01393
     C  N80                MOVELINF,5     INFMSG                          S01393
     C   80                MOVELINF,13    INFMSG                          S01393
     C***********          SETOF                     5657          E49198 073714
     C***********DELT      IFEQ *BLANK                             E49198 073714
     C***********SETD      IFLT RUND                               E49198 073714
     C***********          SETON                     56            E49198 073714
     C***********          MOVEL'MATURED' DELT                     E49198 073714
     C***********          ELSE                                    E49198 073714
     C***********          SETOF                     56            E49198 073714
     C***********          MOVEL*BLANK    DELT                     E49198 073714
     C***********          END                                     E49198 073714
     C***********FTDT      IFLT RUND                               E49198 073714
     C***********DELT      ANDEQ*BLANK                             E49198 073714
     C***********          SETON                     57            E49198 073714
     C***********          ELSE                                    E49198 073714
     C***********          SETOF                     57            E49198 073714
     C***********          END                                     E49198 073714
     C***********          END                                     E49198 073714
     C           DELT      IFEQ *BLANK                                    073714
     C           FTDT      IFLT RUND                                      073714
     C           SETD      ORLT RUND                                      073714
     C                     SETON                     57                   073714
     C                     SETON                     56                   073714
     C                     MOVEL'MATURED' DELT                            073714
     C                     END                                            073714
     C                     END                                            073714
     C                     END
     C           ACTN      IFEQ 'D'
     C                     MOVELINF,6     INFMSG
     C                     END
     C                     END
     C*
      ** OUTPUT DETAIL SCREEN AND READ - SAVE OLD SCREEN FOR COMPARISON
     C*
     C           *LIKE     DEFN DETS      DETO
     C                     MOVELDETS      DETO
     C                     WRITEFF0140F1
     C**********           WRITEFF0140F0                                                      CAAA03
     C                     WRITEFF0140F2
     C                     WRITEFF0140F0                                                      CAAA03
     C                     READ FF0140F0                 99
     C                     MOVEAERR       HERCD
     C                     MOVELWBLNK     HERCD
     C                     MOVELHERCD     WERC    2
     C                     MOVEL*BLANK    SCRMSG
     C                     MOVEA*BLANK    ERR
     C                     MOVEA*BLANK    WER
     C*
      ** F3, F12, HELP, OR ROLL REQUEST PROCESSING
     C*
     C** Call S/R to move values into AID                                 S01179
     C*                                                                   S01179
     C                     EXSR ASCHGS                                    S01179
     C*                                                                   S01179
      ** CK3
      ** Set exit parameter if program called as linked enquiry           S01393
     C*
     C           AID       IFEQ '01'
     C                     MOVEA'1'       *IN,12
     C   80                MOVE 'EXIT'    PPRTCD                          S01393
     C                     END
     C*
      ** CK12
      ** Set exit parameter if program called as a linked enquiry         S01393
      ** and force program to terminate.                                  S01393
     C*
     C           AID       IFEQ '05'
     C                     MOVEA'1'       *IN,10
     C   80                MOVE 'PREV'    PPRTCD                          S01393
     C   80                MOVE '01'      AID                             S01393
     C                     END
     C*
      ** HELP
     C*
     C***********AID       IFEQ 'HP'                                      S01199
     C***********          MOVEAHERCD     ERR                             S01199
     C***********                                                         S01199
     C***HIGHLIGHT ERROR IF ONE EXISTS                                    S01199
     C***********                                                         S01199
     C***********ERR,1     IFNE *BLANK                                    S01199
     C***********          MOVEAERR       ERRMSG                          S01199
     C***********          MOVELHI        ERRMSG                          S01199
     C***********          END                                            S01199
     C***********                                                         S01199
     C***FORMAT*SECOND HALF OF ERROR BANK IF PRESENT                      S01199
     C***********                                                         S01199
     C***********ERR,20    IFNE *BLANK                                    S01199
     C***********          MOVEAERR,20    INFMSG                          S01199
     C***********          MOVELHI        INFMSG                          S01199
     C***********          END                                            S01199
     C***********                                                         S01199
     C***********          CALL 'MHELP'                                   S01199
     C***********          PARM           HBPGM                           S01199
     C***********          PARM           HERCD                           S01199
     C***********          END                                            S01199
     C*
      ** PAGE FORWARD TAKEN, READ NEXT RECORD
     C*
     C           AID       IFEQ 'UP'
     C           ACTN      ANDNE'I'
     C                     READ INTYP1X                  12
     C*
      ** CHANGE MESSAGE IF END OF FILE REACHED - NO ROLL FWD
     C*
     C           *IN,12    IFEQ '1'
     C                     MOVELINF,7     INFMSG
     C                     ELSE
     C                     MOVEA'1'       *IN,12
     C                     END
     C*
     C                     END
     C*
      ** PAGE BACK TAKEN, READ PREVIOUS RECORD
     C*
     C           AID       IFEQ 'DN'
     C           ACTN      ANDNE'I'
     C                     READPINTYP1X                  12
     C*
      ** BEGINNING OF FILE REACHED IF INSTRUMENT IS MARKET
     C*
     C           ISTI      IFEQ 'N'
     C                     SETON                     12
     C                     READ INTYP1X                  99
     C                     END
     C*
      ** CHANGE MESSAGE IF BEGINNING OF FILE REACHED - NO ROLL BACK
     C*
     C           *IN,12    IFEQ '1'
     C                     MOVELINF,8     INFMSG
     C                     ELSE
     C                     MOVEA'1'       *IN,12
     C                     END
     C*
     C                     END
     C*
      ** ENTER PRESSED/F10 TAKEN
      ** Set exit parameter if program called as a linked enquiry         S01393
      ** and force program to terminate.                                  S01393
     C*
     C           AID       IFEQ 'RA'
     C           AID       OREQ '04'
     C   80                MOVE 'PREV'    PPRTCD                          S01393
     C   80                MOVE '01'      AID                             S01393
     C*
      ** VALIDATE DETAIL SCREEN INPUT UNLESS THERE IS NO CHANGE SINCE
      ** WARNING ERRORS WERE ISSUED
     C*
     C           DETS      IFNE DETO
     C           WERC      ORNE ' W'
     C                     EXSR VALIDD
     C/COPY WNCPYSRC,FF0140C005
     C*                                                                   CFF007
     C           CFF007    IFEQ 'Y'                                       CFF007
     C           BGN4ST    ANDEQ'Y'                                       CFF007
     C           SCRMSG    ANDEQ*BLANKS                                   CFF007
     C*                                                                   CFF007
     C           ACTN      IFEQ 'A'                                       CFF007
     C           ACTN      OREQ 'E'                                       CFF007
     C                     EXSR SRDTS2                                    CFF007
     C                     MOVE '0'       *IN32                           CFF007
     C                     MOVE '00000'   *IN,34                          CFF007
     C           AID       IFEQ '01'                                      CFF007
     C                     GOTO XTUPDT                                    CFF007
     C                     ENDIF                                          CFF007
     C           AID       IFEQ '05'                                      CFF007
     C                     MOVE '0'       *IN10                           CFF007
     C                     MOVELINF,14    INFMSG                          CFF007
     C                     MOVE UNSE      SUNSE                           CFF007
     C                     MOVE TECO      STECO                           CFF007
     C                     MOVE TNAT      STNAT                           CFF007
     C                     MOVE CRIK      SCRIK                           CFF007
     C                     MOVE CCYR      SCCYR                           CFF007
     C*                                                                   CFF007
     C           TWEI      IFNE *ZERO                                     CFF007
     C                     MOVE TWEI      STWEI                           CFF007
     C                     ELSE                                           CFF007
     C                     MOVE *BLANK    STWEI                           CFF007
     C                     ENDIF                                          CFF007
     C*                                                                   CFF007
     C                     ENDIF                                          CFF007
     C                     ENDIF                                          CFF007
     C*                                                                   CFF007
     C                     ENDIF                                          CFF007
     C*                                                                   CFF007
     C                     END
     C*
      *                                                                                       CER001
      ** Display LUX OTCs Maintenance Screen if allowed                                       CER001
      *                                                                                       CER001
     C                     EXSR SRLUX                                                         CER001
      *                                                                                       CER001
      ** N O    D E T A I L   S C R E E N    E R R O R S    -  S T A R T
     C*
     C           ULX004    IFNE 'Y'                                                           CER001
     C           ULX004    OREQ 'Y'                                                           CER001
     C           W#EXIT    ANDEQ'N'                                                           CER001
     C           SCRMSG    IFEQ *BLANK
     C*                                                                   S01408
     C/COPY WNCPYSRC,FF0140CCP2                                           S01408
     C*                                                                   S01408
     C*
      ** DETERMINE NEXT SCREEN TO BE DISPLAYED - REVIEW OR KEY
     C*
     C           REVW      IFEQ 'Y'
     C                     MOVELPPAGK     PISTT
     C                     MOVEA'1'       *IN,11
     C                     ELSE
     C                     MOVEA'1'       *IN,10
     C                     END
     C*
      ** UPDATE FILES IF LAST ACTION WAS NOT ENQUIRE
     C*
     C           ACTN      IFEQ 'I'
     C           ACTN      OREQ 'A'
     C           ACTN      OREQ 'D'
     C                     EXSR UPDFLS
     C                     END
     C*                                                                   S01408
     C/COPY WNCPYSRC,FF0140CCP3                                           S01408
     C*                                                                   S01408
     C                     ELSE                                           CFF007
     C*                                                                   CFF007
     C           CFF007    IFEQ 'Y'                                       CFF007
     C           BGN4ST    ANDEQ'Y'                                       CFF007
     C           ACTN      ANDEQ'E'                                       CFF007
     C                     MOVE *BLANKS   INFMSG                          CFF007
     C                     ENDIF                                          CFF007
     C*
      ** END OF CLEAR OF ERRORS PROCESSING
     C*
     C                     END
      *                                                                                       CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
     C*
      ** END OF ENTER/F10 PROCESSING
     C*
     C                     END
     C*
      ** END OF PROCESSING LOOP
     C*
     C                     END
     C*
      ** RESET PROTECT/NON-DISPLAY INDS
     C*
     C                     MOVEA'00'      *IN,5
     C*
     C           XTUPDT    ENDSR                           ** XTUPDA ESR**
     C********************************************************************
      /EJECT
     C/COPY WNCPYSRC,FF0140C006
     C********************************************************************CFF007
      **                                                                  CFF007
      ** SRDTS2 S/R to process detail screen 2                            CFF007
      **                                                                  CFF007
      ** CALLED BY: UPDATE S/R                                            CFF007
      **                                                                  CFF007
      ** CALLS: ASCHGS S/R, SRROLL S/R, SRVLD2 S/R                        CFF007
      **                                                                  CFF007
     C********************************************************************CFF007
      *                                                                   CFF007
     C           SRDTS2    BEGSR                                          CFF007
      *                                                                   CFF007
      ** Perform until change of request                                  CFF007
      *                                                                   CFF007
     C           *IN10     DOUEQ'1'                                       CFF007
     C           *IN11     OREQ '1'                                       CFF007
     C           *IN12     OREQ '1'                                       CFF007
      *                                                                   CFF007
      ** Format informational message if not already present              CFF007
      *                                                                   CFF007
     C           INFMSG    IFEQ *BLANKS                                   CFF007
     C           ACTN      IFEQ 'A'                                       CFF007
     C                     MOVELINF,4     INFMSG                          CFF007
     C                     ENDIF                                          CFF007
     C           ACTN      IFEQ 'E'                                       CFF007
      *                                                                   CFF007
      ** Use linked enquiry text message if program called as such.       CFF007
      *                                                                   CFF007
     C           *IN80     IFEQ '0'                                       CFF007
     C                     MOVELINF,5     INFMSG                          CFF007
     C                     ELSE                                           CFF007
     C                     MOVELINF,13    INFMSG                          CFF007
     C                     ENDIF                                          CFF007
     C                     ENDIF                                          CFF007
     C*                                                                   CFF007
     C                     ENDIF                                          CFF007
     C*                                                                   CFF007
     C                     MOVE 'N'       WPRTEC  1                       CFF007
     C*                                                                   CFF007
     C           BGSECS    IFEQ 'Y'                                       CFF007
     C*                                                                   CFF007
     C           ISTT      SETLLTRANS13                                   CFF007
     C           ISTT      READETRANS13                  89               CFF007
     C*                                                                   CFF007
     C           *IN89     DOWEQ'0'                                       CFF007
     C           WPRTEC    ANDEQ'N'                                       CFF007
     C           BLUP      IFEQ 'Y'                                       CFF007
     C           NOCO      ANDGT*ZEROS                                    CFF007
     C                     MOVE 'Y'       WPRTEC                          CFF007
     C                     ENDIF                                          CFF007
     C           ISTT      READETRANS13                  89               CFF007
     C                     ENDDO                                          CFF007
      *                                                                   CFF007
      ** Display UNDERLYING SECURITY                                      CFF007
      *                                                                   CFF007
     C                     MOVE '0'       *IN74                           CFF007
     C                     ELSE                                           CFF007
      *                                                                   CFF007
     C                     MOVE '1'       *IN74                           CFF007
     C                     ENDIF                                          CFF007
      *                                                                   CFF007
      ** If delete/enquire, protect fields                                CFF007
      *                                                                   CFF007
     C           ACTN      IFEQ 'D'                                       CFF007
     C           ACTN      OREQ 'E'                                       CFF007
     C                     MOVE '1'       *IN75                           CFF007
     C                     ENDIF                                          CFF007
      *                                                                   CFF007
      ** Output detail screen and read (save old screen for comparison)   CFF007
      *                                                                   CFF007
     C                     WRITEFF0140F1                                  CFF007
     C                     WRITEFF0140F2                                  CFF007
     C                     EXFMTFF0140F4                                  CFF007
      *                                                                   CFF007
     C                     MOVE '0'       *IN75                           CFF007
     C                     MOVE '0'       *IN24                                              BUG8046
     C                     MOVEAERR       HERCD                           CFF007
     C                     MOVELWBLNK     HERCD                           CFF007
     C                     MOVELHERCD     WERC                            CFF007
     C                     MOVE *BLANKS   SCRMSG                          CFF007
     C                     MOVEA*BLANKS   ERR                             CFF007
     C                     MOVEA*BLANKS   WER                             CFF007
      *                                                                   CFF007
      ** CMD3, CMD12, HELP, or ROLL request processing                    CFF007
      *                                                                   CFF007
     C                     EXSR ASCHGS                                    CFF007
      *                                                                   CFF007
      ** CMD3                                                             CFF007
      ** Set exit parameter if program called as linked enquiry           CFF007
      *                                                                   CFF007
     C           AID       IFEQ '01'                                      CFF007
     C                     MOVE '1'       *IN12                           CFF007
     C           *IN80     IFEQ '1'                                       CFF007
     C                     MOVE 'EXIT'    PPRTCD                          CFF007
     C                     ENDIF                                          CFF007
     C                     ENDIF                                          CFF007
      *                                                                   CFF007
      ** CMD12                                                            CFF007
      *                                                                   CFF007
     C           AID       IFEQ '05'                                      CFF007
     C                     MOVE '1'       *IN10                           CFF007
     C                     ENDIF                                          CFF007
      *                                                                   CFF007
      ** PAGE FORWARD taken, read next record                             CFF007
      *                                                                   CFF007
     C           AID       IFEQ 'UP'                                      CFF007
     C                     READ INTYP1X                  99               CFF007
      *                                                                   CFF007
      ** Change message if end of file reached (no roll fwd)              CFF007
      *                                                                   CFF007
     C           *IN99     IFEQ '1'                                       CFF007
     C                     MOVELINF,7     INFMSG                          CFF007
     C                     ENDIF                                          CFF007
      *                                                                   CFF007
     C                     EXSR SRROLL                                    CFF007
      *                                                                   CFF007
     C                     ENDIF                                          CFF007
      *                                                                   CFF007
      ** PAGE BACK taken, read previous record                            CFF007
      *                                                                   CFF007
     C           AID       IFEQ 'DN'                                      CFF007
     C                     READPINTYP1X                  99               CFF007
      *                                                                   CFF007
     C           ISTI      IFEQ 'N'                                       CFF007
     C           *IN99     OREQ '1'                                       CFF007
     C                     MOVELINF,8     INFMSG                          CFF007
     C           ISTI      IFEQ 'N'                                       CFF007
     C                     READ INTYP1X                  99               CFF007
     C                     ENDIF                                          CFF007
     C                     ENDIF                                          CFF007
      *                                                                   CFF007
     C                     EXSR SRROLL                                    CFF007
      *                                                                   CFF007
     C                     ENDIF                                          CFF007
      *                                                                   CFF007
      ** ENTER pressed/F10 taken                                          CFF007
      ** Set exit parameter if program called as a linked enquiry         CFF007
      ** and force program to terminate.                                  CFF007
      *                                                                   CFF007
     C           AID       IFEQ 'RA'                                      CFF007
     C           AID       OREQ '04'                                      CFF007
      *                                                                   CFF007
     C           *IN80     IFEQ '1'                                       CFF007
     C                     MOVE 'PREV'    PPRTCD                          CFF007
     C                     MOVE '01'      AID                             CFF007
     C                     ENDIF                                          CFF007
      *                                                                   CFF007
      ** Validate detail screen input unless there is no change since     CFF007
      ** warning errors were issued                                       CFF007
      *                                                                   CFF007
     C           DETS      IFNE DETO                                      CFF007
     C           WERC      ORNE ' W'                                      CFF007
      *                                                                   CFF007
     C           ACTN      IFNE 'E'                                       CFF007
     C                     EXSR SRVLD2                                    CFF007
     C                     ENDIF                                          CFF007
     C                     ENDIF                                          CFF007
      *                                                                   CFF007
      ** If no detail screen errors                                       CFF007
      *                                                                   CFF007
     C           SCRMSG    IFEQ *BLANKS                                   CFF007
      *                                                                   CFF007
      ** Determine next screen to be displayed (REVIEW or KEY)            CFF007
      *                                                                   CFF007
     C           REVW      IFEQ 'Y'                                       CFF007
     C                     MOVELPPAGK     PISTT                           CFF007
     C                     MOVE '1'       *IN11                           CFF007
     C                     ELSE                                           CFF007
     C                     MOVE '1'       *IN10                           CFF007
     C                     ENDIF                                          CFF007
      *                                                                   CFF007
      ** End of 'CLEAR OF ERRORS' processing                              CFF007
      *                                                                   CFF007
     C                     ENDIF                                          CFF007
      *                                                                   CFF007
      ** End of ENTER/F10 processing                                      CFF007
      *                                                                   CFF007
     C                     ENDIF                                          CFF007
      *                                                                   CFF007
      ** End of processing loop                                           CFF007
      *                                                                   CFF007
     C                     ENDDO                                          CFF007
      *                                                                   CFF007
      ** End of SRDTS2 S/R                                                CFF007
      *                                                                   CFF007
     C                     ENDSR                                          CFF007
     C********************************************************************CFF007
      /EJECT                                                              CFF007
     C********************************************************************CFF007
      **                                                                  CFF007
      ** SRROLL S/R to process rollup/rolldown request                    CFF007
      **                                                                  CFF007
      ** CALLED BY: SRDTS2 S/R                                            CFF007
      **                                                                  CFF007
      ** CALLS: TRSFS S/R, DEFLTS S/R                                     CFF007
      **                                                                  CFF007
     C********************************************************************CFF007
      *                                                                   CFF007
     C           SRROLL    BEGSR                                          CFF007
      *                                                                   CFF007
      ** Set screen indicators                                            CFF007
      *                                                                   CFF007
     C                     MOVE '1'       *IN05                           CFF007
     C                     MOVE '1'       *IN30                           CFF007
     C                     MOVE '0'       *IN12                           CFF007
     C                     MOVEA'00000000'*IN,31                          CFF007
     C                     MOVEA'00000000'*IN,39                          CFF007
     C                     MOVEA'0000000' *IN,47                          CFF007
     C                     MOVE '0'       *IN71                           CFF007
     C                     MOVE '0'       *IN75                           CFF007
      *                                                                   CFF007
      ** Access file record for old TNLU to check at update time;         CFF007
      ** If no record presently on file, zeroise stored TNLU              CFF007
      *                                                                   CFF007
     C                     Z-ADD*ZEROS    STNLU                           CFF007
     C           INTP1K    CHAININTYP1X              99                   CFF007
     C           *IN99     IFEQ '0'                                       CFF007
     C                     Z-ADDTNLU      STNLU                           CFF007
     C                     ENDIF                                          CFF007
      *                                                                   CFF007
      ** If record is deleted                                             CFF007
      *                                                                   CFF007
     C           RECI      IFEQ '*'                                       CFF007
     C                     MOVEL'E'       ACTN                            CFF007
     C                     MOVEL'DELETED' DELT                            CFF007
     C                     ELSE                                           CFF007
     C                     MOVE *BLANKS   DELT                            CFF007
     C                     ENDIF                                          CFF007
      *                                                                   CFF007
      ** Translate record details from file layout to screen layout       CFF007
      *                                                                   CFF007
     C                     EXSR TRSFS                                     CFF007
      *                                                                   CFF007
     C           *INU7     IFEQ '0'                                       CFF007
      *                                                                   CFF007
      ** Set up defaults                                                  CFF007
      *                                                                   CFF007
     C                     EXSR DEFLTS                                    CFF007
      *                                                                   CFF007
      ** If delete/enquire, protect fields                                CFF007
      *                                                                   CFF007
     C           ACTN      IFEQ 'D'                                       CFF007
     C           ACTN      OREQ 'E'                                       CFF007
     C                     MOVE '1'       *IN75                           CFF007
     C                     ENDIF                                          CFF007
      *                                                                   CFF007
     C                     ENDIF                                          CFF007
      *                                                                   CFF007
      ** End of SRROLL S/R                                                CFF007
      *                                                                   CFF007
     C                     ENDSR                                          CFF007
     C********************************************************************CFF007
      /EJECT                                                              CFF007
     C********************************************************************
      **           ****** AS400 CONVERSION ******                         S01179
      **                                                                  S01179
      ** ASCHGS S/R TO MOVE THE APPROPRIATE VALUES INTO FIELD AID,        S01179
      ** DEPENDING ON WHICH FUNCTION KEY HAS BEEN PRESSED.                S01179
      ** CALLED FROM UPDATE                                               S01179
      **                                                                  S01179
     C*================================================================   S01179
     C*                                                                   S01179
     C           ASCHGS    BEGSR                                          S01179
     C*                                                                   S01179
     C* If ENTER pressed, the VLDCMDKEY indicator will be off             S01179
     C*                                                                   S01179
     C           *IN55     IFEQ '0'                                       S01179
     C                     MOVE 'RA'      AID                             S01179
     C                     END                                            S01179
     C*                                                                   S01179
     C* If F3                                                             S01179
     C*                                                                   S01179
     C           *INKC     IFEQ '1'                                       S01179
     C                     MOVE '01'      AID                             S01179
     C                     MOVE '0'       *INKC                           S01179
     C                     END                                            S01179
     C*                                                                   S01179
     C* If F10                                                            S01179
     C*                                                                   S01179
     C           *INKJ     IFEQ '1'                                       S01179
     C                     MOVE '04'      AID                             S01179
     C                     MOVE '0'       *INKJ                           S01179
     C                     END                                            S01179
     C*                                                                   S01179
     C* If F12                                                            S01179
     C*                                                                   S01179
     C           *INKL     IFEQ '1'                                       S01179
     C                     MOVE '05'      AID                             S01179
     C                     MOVE '0'       *INKL                           S01179
     C                     END                                            S01179
     C*                                                                   S01179
     C* If ROLLUP pressed                                                 S01179
     C*                                                                   S01179
     C           *IN25     IFEQ '1'                                       S01179
     C                     MOVE 'UP'      AID                             S01179
     C                     MOVE '0'       *IN25                           S01179
     C                     END                                            S01179
     C*                                                                   S01179
     C* If ROLLDOWN pressed                                               S01179
     C*                                                                   S01179
     C           *IN26     IFEQ '1'                                       S01179
     C                     MOVE 'DN'      AID                             S01179
     C                     MOVE '0'       *IN26                           S01179
     C                     END                                            S01179
     C***********                                                   S01179S01199
     C**If*HELP*key pressed                                         S01179S01199
     C***********                                                   S01179S01199
     C************IN27     IFEQ '1'                                 S01179S01199
     C***********          MOVE 'HP'      AID                       S01179S01199
     C***********          MOVE '0'       *IN27                     S01179S01199
     C***********          END                                      S01179S01199
     C***********                                                   S01179S01199
     C*                                                                   S01179
     C                     ENDSR                                          S01179
     C*================================================================
      /EJECT
     C*================================================================
      ** VALIDK S/R TO VALIDATE KEY FIELDS
      ** CALLED FROM S/R START, REVIEW
      ** CALLS NO OTHER S/R'S
      **
     C********************************************************************
     C*
     C           VALIDK    BEGSR                           ** VALIDK BSR**
     C*
      ** RESET ERROR INDICATORS AND SET DEFAULT KEY FIELD FOR FILE
      ** SET ERROR ARRAY COUNTER TO ZERO
     C*
     C                     MOVEA'00'      *IN,21
     C                     MOVEL'Y'       ISTI
     C                     Z-ADD*ZERO     EC      40
     C*
      ***VALIDATE*ACTION*CODE*-*MUST*BE*BLANK,*I, A, E OR D               073714
      ** VALIDATE ACTION CODE - MUST BE BLANK, A, E OR D                  073714
     C*
     C           ACTN      IFNE *BLANK
     C***********ACTN      ANDNE'I'                                       073714
     C           ACTN      ANDNE'A'
     C           ACTN      ANDNE'E'
     C           ACTN      ANDNE'D'
     C                     ADD  1         EC         21
     C                     MOVEL' 101'    ERR,EC
     C                     END
     C*                                                                   S01117
     C**   VALIDATE ACTION CODE FOR THIS USER                             S01117
     C*                                                                   S01117
     C           ACTN      IFEQ 'I'                                       S01117
     C           ACTN      OREQ 'A'                                       S01117
     C           ACTN      OREQ 'E'                                       S01117
     C           ACTN      OREQ 'D'                                       S01117
     C*                                                                   S01117
     C**   IF SINGLE BRANCH ENVIRONMENT                                   S01117
     C*                                                                   S01117
     C           MBIN      IFNE 'Y'                                       S01117
     C                     CALL 'ZVACTU'                                  S01117
     C                     PARM ACTN      @ZACTN  1                       S01117
     C                     PARM           @ERR    10                      S01117
     C**                                                                  S01117
     C           @ERR      IFNE *ZERO                                     S01117
     C                     ADD  1         EC         21                   S01117
     C                     MOVE '303'     ERR,EC                          S01117
     C                     END                                            S01117
     C                     ELSE                                           S01117
     C*                                                                   S01117
     C**   IF MULTIBRANCHING ENVIRONMENT                                  S01117
     C*                                                                   S01117
     C                     CALL 'ZVACTBU'                                 S01117
     C                     PARM ACTN      @ZACTN  1                       S01117
     C                     PARM USRBCH    @ZBR    3                       S01117
     C                     PARM           @ERR    10                      S01117
     C**                                                                  S01117
     C           @ERR      IFNE *ZERO                                     S01117
     C                     ADD  1         EC         21                   S01117
     C                     MOVE '304'     ERR,EC                          S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C*
      ** ACTION CODE BLANK - CROSS VALIDATE WITH REFERENCE;
      ** KEY SHOULD ALSO BE BLANK
     C*
     C           ACTN      IFEQ *BLANK
     C           ISTT      ANDNE*BLANK
     C*
     C                     ADD  1         EC         21
     C                     MOVEL' 102'    ERR,EC
     C*
     C                     END
     C*
     C           ACTN      IFNE *BLANK
     C           ISTT      ANDEQ*BLANK
     C*
     C                     ADD  1         EC         21
     C                     MOVEL' 102'    ERR,EC
     C*
     C                     END
     C*
      ** N O   E R R O R  O N  K E Y  F I E L D S
     C*
     C           *IN,21    IFNE '1'
     C*
      ** A C T I O N  C O D E I - NO LIVE RECORD TO EXIST
     C*
     C           ACTN      IFEQ 'I'
     C           INTP1K    CHAININTYP1X              99
     C*
      ** IF LIVE OTC RECORD FOUND, ERROR.
     C*
     C           *IN99     IFEQ '0'
     C           RECI      ANDEQ'D'
     C                     ADD  1         EC         22
     C                     MOVEL' 103'    ERR,EC
     C                     END
     C*
      ** CHECK FOR MKT/INSTR REF
     C*
     C                     MOVE 'N'       ISTI
     C           INTP1K    CHAININTYP1X              99
     C*
      ** IF LIVE RECORD FOUND, ERROR.
     C*
     C           *IN99     IFEQ '0'
     C           RECI      ANDEQ'D'
     C                     ADD  1         EC         22
     C                     MOVEL' 104'    ERR,EC
     C                     END
     C                     MOVE 'Y'       ISTI
     C*
     C                     END
     C*
      ** A C T I O N    C O D E  A , D   -  LIVE OTC RECORD MUST EXIST
     C*
     C           ACTN      IFEQ 'A'
     C           ACTN      OREQ 'D'
     C           INTP1K    CHAININTYP1X              99
     C*
      ** NO LIVE RECORD FOUND, ERROR
     C*
     C           *IN99     IFEQ '1'
     C           RECI      OREQ '*'
     C                     ADD  1         EC         22
     C                     MOVEL' 105'    ERR,EC
     C                     END
     C*
     C                     END
     C*
      ** A C T I O N    C O D E    E  - RECORD MUST BE ON FILE
     C*
     C           ACTN      IFEQ 'E'
     C                     MOVE 'Y'       ISTI
     C           INTP1K    CHAININTYP1X              99
     C*
      ** NO RECORD FOUND
     C*
     C           *IN99     IFEQ '1'
     C                     ADD  1         EC         22
     C                     MOVEL' 106'    ERR,EC
     C                     END
     C*
     C                     END
     C*
      ** IF DELETION REQUESTED, NO OUTSTANDING POSITIONS ALLOWED
     C*
     C           ACTN      IFEQ 'D'
     C***********ISTT      CHAINPOSTN2               99                   S01299
     C           ISTT      CHAINPOSTNCO              99                   S01299
      *                                                                   S01299
     C           *IN99     IFEQ '1'                                       S01299
     C           ISTT      CHAINPOSTNKO              99                   S01299
     C                     END                                            S01299
      *                                                                   S01299
      ** IF DELETION REQUESTED, NO TRANSACTION MUST EXIST ON TRANSD       101432
     C           *IN99     IFEQ '1'                        - B3           101432
     C           ISTT      CHAINTRANS13              84                   101432
     C*                                                                   101432
     C           *IN84     IFEQ '0'                        - B4           101432
     C                     MOVE '0'       *IN99                           101432
     C                     END                             - E4           101432
     C*                                                                   101432
     C                     END                             - E3           101432
     C* If *in99 is off, there are still positions and/or transactions    101432
     C*                                                                   101432
     C           *IN99     IFEQ '0'
     C                     ADD  1         EC         22
     C                     MOVEL' 107'    ERR,EC
     C                     END
     C                     END
     C*
     C                     END
     C*
     C           EC        IFNE *ZERO
     C                     MOVEAERR       ERRMSG
     C                     MOVELHI        ERRMSG
     C                     MOVEL*BLANK    AID
     C                     END
     C*
     C                     ENDSR
     C*
     C********************************************************************
      /EJECT
     C********************************************************************
      **
      ** VALIDD S/R - TO VALIDATE DETAIL SCREEN
      ** CALLED FROM UPDATE S/R
     C***CALLS:*DEFLTS;*ZEDIT;*ZALIGN;*ZDATE1;*ZDATE5*********************S01195
      ***CALLS:*DEFLTS;*ZEDIT;*ZALIGN;*ZDATE1;*ZCHKH***************S01195 073714
      ** CALLS: DEFLTS; ZEDIT; ZALIGN; ZDATE1                             073714
      **
     C********************************************************************
     C*
     C           VALIDD    BEGSR
     C*
      ** RESET SCREEN ERROR INDICATORS
     C*
     C                     MOVEA'00000000'*IN,30
     C                     MOVEA'00000000'*IN,38
     C                     MOVEA'00000000'*IN,46
     C                     MOVEA'0'       *IN,54                          CPB001
     C                     MOVEA'0'       *IN,58                          S01117
     C                     MOVEA'0'       *IN,71                          FF0011
     C*
      ** SET ERROR COUNT TO ZERO
     C*
     C                     Z-ADD*ZERO     EC
     C                     Z-ADD*ZERO     W       10
     C*
      ** ENTER KEY PRESSSED
     C*
     C           AID       IFEQ 'RA'
     C*
      ** ACTION = I OR A
     C*
     C           ACTN      IFEQ 'I'
     C           ACTN      OREQ 'A'
     C*
      ** DO DEFAULTS
     C*
     C                     EXSR DEFLTS
     C*
      ** VALIDATION OF FIELDS FOR INSERT/AMEND
     C*
      ** VALIDATE OTC NAME - MUST BE ENTERED
     C*
     C                     MOVELSISTN     ISTN
     C*
     C           SISTN     IFEQ *BLANK
     C                     MOVEL'1'       *IN,30
     C                     ADD  1         EC         31
     C                     MOVEL' 201'    ERR,EC
     C                     END
     C*
      ***VALIDATE PROCESSING TYPE - MUST BE FROM 1-6                      073714
     C***********                                                         073714
     C***********SISPT     IFLT '1'                                       073714
     C***********SISPT     ORGT '6'                                       073714
     C***********          ADD  1         EC         32                   073714
     C***********          MOVEL' 202'    ERR,EC                          073714
     C***********                                                         073714
     C***********          ELSE                                           073714
     C***********          MOVELSISPT     ISPT                            073714
     C***********                                                         073714
     C***********          END                                            073714
     C***********                                                         073714
      ***VALIDATE INSTRUMENT CURRENCY                                     073714
     C***********                                                         073714
     C***********          MOVELSISCY     ISCY                            073714
     C***********                                                         073714
      ***MANDATORY FIELD                                                  073714
     C***********                                                         073714
     C***********SISCY     IFEQ *BLANK                                    073714
     C***********          ADD  1         EC         33                   073714
     C***********          MOVEL' 203'    ERR,EC                          073714
     C***********          END                                            073714
     C***********                                                         073714
      ***MUST*BE*ON*TABTG10*-*ERROR*IF*NOT*FOUND,*ELSE*STORE*DEC*PLACES***S01117
      ***GET*CURRENCY RECORD - ERROR IF NOT FOUND, ELSE STORE DEC PS01117 073714
     C***********                                                         073714
     C***********SISCY     IFNE *BLANK                                    073714
     C***********          MOVE SISCY     TCCY                            S01117
     C***********CCYK      CHAINTABFF                99                   S01117
     C***********                                                         S01117
     C************IN99     IFEQ '1'                                       S01117
     C***********RECI      ORNE 'D'                                       S01117
     C***********          CALL 'AOCURRR0'                         S01117 073714
     C***********          PARM *BLANKS   @RTCD   7                S01117 073714
     C***********          PARM '*KEY   ' @OPTN   7                S01117 073714
     C***********          PARM SISCY     @AJCD   3                S01117 073714
     C***********SDCURR    PARM SDCURR    DSSDY                    S01117 073714
     C***********@RTCD     IFNE *BLANKS                            S01117 073714
     C***********                                                  S01117 073714
     C***********@RTCD     IFEQ '*NOSEL '                          S01117 073714
     C***********          ADD  1         EC         33            S01117 073714
     C***********          MOVEL' 250'    ERR,EC                   S01117 073714
     C***********          ELSE                                    S01117 073714
     C***********          ADD  1         EC         33                   073714
     C***********          MOVEL' 204'    ERR,EC                          073714
     C***********          END                                     S01117 073714
     C***********                                                  S01117 073714
     C***********          ELSE                                           073714
     C************LIKE     DEFN CDP       ICDP                            073714
     C***********          Z-ADDCDP       ICDP                            073714
     C***********SISCY     IFNE CURR                               S01117 073714
     C***********          MOVE CURR      SISCY                    S01117 073714
     C***********          END                                     S01117 073714
     C***********          END                                            073714
     C***********                                                         073714
     C***********          END                                            073714
     C***********                                                         073714
      ***ACCESS*TABLE*FILE*FOR*OTHER*CCY*DEC*PLACES*IF*PTYP*2/5***********S01117
      ***ACCESS*CURRENCY RECORD FOR OTHER CCY DEC PLACES IF PTYP 2/S01117 073714
     C***********                                                         073714
     C***********SISPT     IFEQ '2'                                       073714
     C***********SISPT     OREQ '5'                                       073714
     C***********                                                         073714
      ***MUST*BE*ON*TABTG10***********************************************S01117
      ***MUST*BE*ON SDCURRPD                                       S01117 073714
     C***********                                                         073714
     C***********SOTHC     IFNE *BLANK                                    073714
     C***********          MOVE SOTHC     TCCY                            S01117
     C***********CCYK      CHAINTABFF                99                   S01117
     C***********                                                         S01117
     C************IN99     IFEQ '1'                                       S01117
     C***********RECI      ORNE 'D'                                       S01117
     C***********          CALL 'AOCURRR0'                         S01117 073714
     C***********          PARM *BLANKS   @RTCD   7                S01117 073714
     C***********          PARM '*KEY   ' @OPTN   7                S01117 073714
     C***********          PARM SOTHC     @AJCD   3                S01117 073714
     C***********SDCURR    PARM SDCURR    DSSDY                    S01117 073714
     C***********@RTCD     IFNE *BLANKS                            S01117 073714
     C***********          MOVE '1'       *IN,43                          073714
     C***********                                                  S01117 073714
     C***********@RTCD     IFEQ '*NOSEL '                          S01117 073714
     C***********          ADD  1         EC         58            S01117 073714
     C***********          MOVEL' 251'    ERR,EC                   S01117 073714
     C***********          END                                     S01117 073714
     C***********                                                  S01117 073714
     C***********          ELSE                                           073714
     C************LIKE     DEFN CDP       OCDP                            073714
     C***********          Z-ADDCDP       OCDP                            073714
     C***********SOTHC     IFNE CURR                               S01117 073714
     C***********          MOVE CURR      SOTHC                    S01117 073714
     C***********          END                                     S01117 073714
     C***********          END                                            073714
     C***********                                                         073714
      ***MUST*NOT*BE BLANK FOR ABOVE PROCESSING TYPES                     073714
     C***********                                                         073714
     C***********          ELSE                                           073714
     C***********          MOVE '1'       *IN,43                          073714
     C***********          END                                            073714
     C***********                                                         073714
     C***********          END                                            073714
     C***********                                                         073714
      ***VALIDATE CONTINGENT AMOUNT                                       073714
     C***********                                                         073714
      ***MUST*BE*ENTERED                                                  073714
     C***********                                                         073714
     C***********SCTAM     IFEQ *BLANK                                    073714
     C***********          ADD  1         EC         34                   073714
     C***********          MOVE ' 205'    ERR,EC                          073714
     C***********          ELSE                                           073714
     C***********                                                         073714
      ***MUST*BE*VALID AMOUNT IN EITHER INSTRUMENT CCY, OR OTHER CCY IF   073714
      ***PROCESSING TYPE IS 2/5                                           073714
      ***CANNOT*THEREFORE BE VALIDATED IF THESE ARE NOT VALID THEMSELVES  073714
     C***********                                                         073714
     C************IN32     IFEQ '0'                                       073714
     C***********                                                         073714
      ***PROCESSING TYPE VALID                                            073714
     C***********                                                         073714
      ***SET*INTEGER FIELD FOR ZALIGN TO ZERO - IF THIS CHANGES THEN      073714
      ***PROCESSING MAY TAKE PLACE                                        073714
     C***********                                                         073714
     C***********          Z-ADD0         ZADIG                           073714
     C***********                                                         073714
      ***IF*OTHER CCY REQUIRED AND VALID, SET UP OTHER CCY DECIMAL PLACES 073714
     C***********                                                         073714
     C***********SISPT     IFEQ '2'                                       073714
     C************IN43     ANDEQ'0'                                       073714
     C***********SISPT     OREQ '5'                                       073714
     C************IN43     ANDEQ'0'                                       073714
     C***********          Z-ADDOCDP      ZADEC                           073714
     C***********13        SUB  OCDP      ZADIG                           073714
     C***********          END                                            073714
     C***********                                                         073714
      ***IF*INSTRUMENT CCY RQD AND VALID, SET UP INSTRUMENT CDP           073714
     C***********                                                         073714
     C***********SISPT     IFNE '2'                                       073714
     C***********SISPT     ANDNE'5'                                       073714
     C************IN33     ANDEQ'0'                                       073714
     C***********          Z-ADDICDP      ZADEC                           073714
     C***********13        SUB  ICDP      ZADIG                           073714
     C***********          END                                            073714
     C***********                                                         073714
     C***********ZADIG     IFNE 0                                         073714
     C***********                                                         073714
      ***ABOVE*PROCESSING HAS CHANGED ZADIG, THEREFORE VALID CASE FOUND   073714
     C***********                                                         073714
     C***********          MOVEL*BLANK    ZFIELD                          073714
     C***********          MOVE SCTAM     ZFIELD                          073714
     C***********          EXSR ZALIGN                                    073714
     C***********                                                         073714
     C************IN,99    IFEQ '1'                                       073714
     C***********ZFIELD    OREQ *ZERO                                     073714
     C***********          ADD  1         EC         34                   073714
     C***********          MOVEL' 206'    ERR,EC                          073714
     C***********          ELSE                                           073714
     C***********          MOVE ZFIELD    CTAM                            073714
     C***********          EXSR ZEDIT                                     073714
     C***********          MOVE ZFIELD    SCTAM                           073714
     C***********          END                                            073714
     C***********                                                         073714
     C***********          END                                            073714
     C***********          END                                            073714
     C***********          END                                            073714
     C***********                                                         073714
      ***VALIDATE QUOTATION CONVENTION                                    073714
     C***********                                                         073714
     C***********          MOVE SQOTC     QDIG    1                       073714
     C***********          MOVELSQOTC     QSIGN   1                       073714
     C***********                                                         073714
      ***CANNOT*BE VALIDATED IF PROCESSING TYPE INVALID                   073714
     C***********                                                         073714
     C************IN32     IFEQ '0'                                       073714
     C***********                                                         073714
      ***NOT*MANDATORY                                                    073714
     C***********                                                         073714
     C***********SQOTC     ANDNE*BLANK                                    073714
     C***********                                                         073714
      ***MUST*ONLY BE ENTERED FOR PROCESSING TYPES 2&5                    073714
     C***********                                                         073714
     C***********SISPT     IFNE '2'                                       073714
     C***********SISPT     ANDNE'5'                                       073714
     C***********          ADD  1         EC         35                   073714
     C***********          MOVEL' 207'    ERR,EC                          073714
     C***********          ELSE                                           073714
     C***********                                                         073714
      ***CAN*BE*+/-  1-9   ONLY THE FIRST CHARACTER CAN CONTAIN A SIGN    073714
      ***FIRST*CHAR QSIGN, SECOND QDIG                                    073714
     C***********                                                         073714
     C***********QDIG      IFEQ *BLANK                                    073714
     C***********                                                         073714
      ***IF*SECOND CHARACTER IS BLANK FIRST MUST CONTAIN DIGIT            073714
     C***********                                                         073714
     C***********QSIGN     IFLT '0'                                       073714
     C***********QSIGN     ORGT '9'                                       073714
     C***********          ADD  1         EC         35                   073714
     C***********          MOVEL' 208'    ERR,EC                          073714
     C***********          ELSE                                           073714
     C***********                                                         073714
      ***FORMAT*FIELD IF NOT IN ERROR                                     073714
     C***********                                                         073714
     C***********          MOVE QSIGN     QOTC                            073714
     C***********          END                                            073714
     C***********                                                         073714
     C***********          ELSE                                           073714
     C***********                                                         073714
      ***SECOND*CHARACTER NON-BLANK - FIRST CHARACTER MUST BE +,- OR BLANK073714
     C***********                                                         073714
     C***********QSIGN     IFNE *BLANK                                    073714
     C***********QSIGN     ANDNE'+'                                       073714
     C***********QSIGN     ANDNE'-'                                       073714
     C***********          ADD  1         EC         35                   073714
     C***********          MOVEL' 208'    ERR,EC                          073714
     C***********          ELSE                                           073714
     C***********                                                         073714
      ***FIRST*CHARACTER VALID, SECOND MUST BE A DIGIT                    073714
     C***********                                                         073714
     C***********QDIG      IFLT '0'                                       073714
     C***********QDIG      ORGT '9'                                       073714
     C***********          ADD  1         EC         35                   073714
     C***********          MOVEL' 208'    ERR,EC                          073714
     C***********          END                                            073714
     C***********                                                         073714
     C***********          END                                            073714
     C***********                                                         073714
      ***FORMAT*FIELD IF NOT IN ERROR                                     073714
     C***********                                                         073714
     C************IN35     IFEQ '0'                                       073714
     C***********          MOVE QDIG      QOTC                            073714
     C***********QSIGN     IFEQ '-'                                       073714
     C***********          Z-SUBQOTC      QOTC                            073714
     C***********          END                                            073714
     C***********          END                                            073714
     C***********          END                                            073714
     C***********                                                         073714
     C***********          END                                            073714
     C***********          END                                            073714
     C***********                                                         073714
      ***IF*BLANK, ZEROISE FILE FIELD                                     073714
     C***********                                                         073714
     C***********SQOTC     IFEQ *BLANK                                    073714
     C***********          Z-ADD0         QOTC                            073714
     C***********          END                                            073714
     C***********                                                         073714
      ***VALIDATE TICK DENOMINATOR MUST BE NUMERIC                        073714
     C***********                                                         073714
     C***********          Z-ADD0         ZADEC                           073714
     C***********          Z-ADD3         ZADIG                           073714
     C***********          MOVEL*BLANK    ZFIELD                          073714
     C***********          MOVE STKDM     ZFIELD                          073714
     C***********          EXSR ZALIGN                                    073714
     C***********                                                         073714
     C************IN99     IFEQ '0'                                       073714
     C***********          MOVE ZFIELD    TKDM                            073714
     C***********          ELSE                                           073714
     C***********          Z-ADD0         TKDM                            073714
     C***********          END                                            073714
     C***********                                                         073714
     C***********TKDM      IFEQ *ZERO                                     073714
     C***********          ADD  1         EC         36                   073714
     C***********          MOVEL' 209'    ERR,EC                          073714
     C***********          ELSE                                           073714
     C***********                                                         073714
      ***IF*PROCESSING TYPE IS 2/5, TICKS DENOMINATOR MUST BE 100         073714
     C***********                                                         073714
     C***********SISPT     IFEQ '2'                                       073714
     C***********STKDM     ANDNE'100'                                     073714
     C***********SISPT     OREQ '5'                                       073714
     C***********STKDM     ANDNE'100'                                     073714
     C***********          ADD  1         EC         36                   073714
     C***********          MOVEL' 210'    ERR,EC                          073714
     C***********          END                                            073714
     C***********          END                                            073714
     C***********                                                         073714
      ***MINIMUM PRICE FLUCTUATION MUST BE ENTERED FOR TICKS DENOM 100    073714
      ***NOT*ALLOWED FOR TKDM = 100                                      073714
     C***********                                                         073714
     C***********STKDM     IFEQ '100'                                     073714
     C***********SMNPF     ANDEQ*BLANK                                    073714
     C***********          ADD  1         EC         37                   073714
     C***********          MOVEL' 212'    ERR,EC                          073714
     C***********          END                                            073714
     C***********                                                         073714
     C***********STKDM     IFNE '100'                                     073714
     C************IN36     ANDEQ'0'                                       073714
     C***********SMNPF     ANDNE*BLANK                                    073714
     C***********          ADD  1         EC         37                   073714
     C***********          MOVEL' 212'    ERR,EC                          073714
     C***********          END                                            073714
     C***********                                                         073714
      ***VALIDATE*MINIMUM PRICE FLUCTUATION IF ENTERED, MUST BE NUMERIC,  073714
      ***MAX*11,7*AND NON ZERO                                            073714
     C***********                                                         073714
     C***********SMNPF     IFNE *BLANK                                    073714
     C************IN37     ANDEQ'0'                                       073714
     C***********                                                         073714
     C***********          Z-ADD7         ZADEC                           073714
     C***********          Z-ADD4         ZADIG                           073714
     C***********          MOVEL*BLANK    ZFIELD                          073714
     C***********          MOVE SMNPF     ZFIELD                          073714
     C***********          EXSR ZALIGN                                    073714
     C***********                                                         073714
     C************IN99     IFEQ '1'                                       073714
     C***********          ADD  1         EC         37                   073714
     C***********          MOVEL' 211'    ERR,EC                          073714
     C***********          ELSE                                           073714
     C***********          MOVE ZFIELD    MNPF                            073714
     C***********MNPF      IFEQ *ZERO                                     073714
     C***********          ADD  1         EC         37                   073714
     C***********          MOVEL' 211'    ERR,EC                          073714
     C***********          END                                            073714
     C***********          END                                            073714
     C***********          ELSE                                           073714
     C***********          Z-ADD0         MNPF                            073714
     C***********          END                                            073714
     C***********                                                         073714
      ***VALIDATE TICK VALUE MANDATORY, NUMERIC UP TO 2 MORE DEC PLACES   073714
      ***THAN*INSTRUMENT CURRENCY                                         073714
     C***********                                                         073714
     C***********STKVL     IFNE *BLANK                                    073714
     C************IN33     ANDEQ'0'                                       073714
     C***********                                                         073714
     C***********ICDP      ADD  5         ZADEC                           E16371
     C***********ICDP      ADD  2         ZADEC                    E16371 073714
     C***********14        SUB  ZADEC     ZADIG                           073714
     C***********          MOVEL*BLANK    ZFIELD                          073714
     C***********          MOVE STKVL     ZFIELD                          073714
     C***********          EXSR ZALIGN                                    073714
     C***********                                                         073714
     C************IN99     IFEQ '0'                                E18188 073714
     C***********ICDP      ADD  5         ZADEC                    E18188 073714
     C***********14        SUB  ZADEC     ZADIG                    E18188 073714
     C***********          MOVEL*BLANK    ZFIELD                   E18188 073714
     C***********          MOVE STKVL     ZFIELD                   E18188 073714
     C***********          EXSR ZALIGN                             E18188 073714
     C***********          END                                     E18188 073714
     C***********                                                  E18188 073714
     C************IN99     IFEQ '1'                                       073714
     C***********ZFIELD    OREQ *ZERO                                     073714
     C***********          ADD  1         EC         38                   073714
     C***********          MOVEL' 214'    ERR,EC                          073714
     C***********          ELSE                                           073714
     C***********          MOVE ZFIELD    TKVL                            073714
     C***********          END                                            073714
     C***********                                                         073714
     C***********          END                                            073714
     C***********                                                         073714
     C***********STKVL     IFEQ *BLANK                                    073714
     C***********          ADD  1         EC         38                   073714
     C***********          MOVEL' 213'    ERR,EC                          073714
     C***********          END                                            073714
     C***********                                                  FO0007 073714
     C****CHECK*TICK VALUE (IF FOREX) = CONT. AM. * MIN. PRCDE FLUCFO0007 073714
     C***********                       * 10 TO POWER (QUOT.CONV.) FO0007 073714
     C****WARNING MESSAGE IF UNEQUAL.                              FO0007 073714
     C***********                                                  FO0007 073714
     C***********SISPT     IFEQ '2'                                FO0007 073714
     C***********SISPT     OREQ '5'                                FO0007 073714
     C***********                                                  FO0007 073714
     C***ONLY*VALIDATE IF NO ERRORS ON FIELDS USED IN CALCULATION OFO0007 073714
     C***TICK*VALUE.                                               FO0007 073714
     C***********                                                  FO0007 073714
     C************IN34     IFNE '1'                                FO0007 073714
     C************IN35     ANDNE'1'                                FO0007 073714
     C************IN37     ANDNE'1'                                FO0007 073714
     C***********                                                  FO0007 073714
     C***********CTAM      MULT MNPF      TEMP   145               FO0007 073714
     C***********                                                  FO0007 073714
     C***IF*THE DIGIT IN THE QUOTATION CONVENTION IS NON ZERO SCALEFO0007 073714
     C***UP*OR*DOWN DEPENDANT ON THE SIGN.                         FO0007 073714
     C***********                                                  FO0007 073714
     C***********SQOTC     IFNE *BLANK                             FO0007 073714
     C***********QDIG      IFEQ *BLANK                             FO0007 073714
     C***********          MOVE QSIGN     QDIG                     FO0007 073714
     C***********          END                                     FO0007 073714
     C***********QDIG      IFGE '1'                                FO0007 073714
     C***********          MOVE QDIG      N       10               FO0007 073714
     C***********QSIGN     IFEQ '-'                                FO0007 073714
     C***********TEMP      DIV  POWER9,N  TEMP                     FO0007 073714
     C***********          ELSE                                    FO0007 073714
     C***********TEMP      MULT POWER9,N  TEMP                     FO0007 073714
     C***********          END                                     FO0007 073714
     C***********          END                                     FO0007 073714
     C***********          END                                     FO0007 073714
     C***********                                                  FO0007 073714
     C***CHECK*TICK VALUE EQUALS EQUATION                          FO0007 073714
     C***********                                                  FO0007 073714
     C***********TKVL      IFNE TEMP                               FO0007 073714
     C***********          ADD  1         W          38            FO0007 073714
     C***********          MOVEL' W07'    WER,W                    FO0007 073714
     C***********          END                                     FO0007 073714
     C***********          END                                     FO0007 073714
     C***********          END                                     FO0007 073714
     C***********                                                         073714
      ***VALIDATE COMMODITY REFERENCE - IF ENTERED, PROCESSING TYPE 3/6   073714
     C***********                                                         073714
     C***********          MOVE SCMRF     CMRF                            073714
     C***********                                                         073714
     C***********SISPT     IFNE '6'                                       073714
     C***********SISPT     ANDNE'3'                                       073714
     C***********SCMRF     ANDNE*BLANK                                    073714
     C***********          ADD  1         EC         39                   073714
     C***********          MOVEL' 226'    ERR,EC                          073714
     C***********          END                                            073714
     C*                                                                   073714
      ** COMMODITY REFERENCE                                              073714
     C*                                                                   073714
     C                     MOVE SCMRF     CMRF                            073714
     C*
      ** VALIDATE PRICING REFERENCE
     C*
     C                     MOVE SPRRF     PRRF
     C*
      ** NO FURTHER VALIDATION FOR PRICING REF - ERROR INDICATOR IS 42
     C*
      ** VALIDATE STATUTORY RETURNS REF
     C*
     C                     MOVE SSTRC     STRC
     C*
      ** NO FURTHER VALIDATION FOR STAT RETURNS - ERROR IND 44
     C*
      ** VALIDATE CHARGE/COMMISSION PATTERN
     C*
     C                     MOVELSCCPT     CCPT
     C*
     C           SCCPT     IFNE *BLANK
     C           SCCPT     ANDNE'S'
     C           SCCPT     ANDNE'H'
     C           SCCPT     ANDNE'E'
     C                     ADD  1         EC         42
     C                     MOVEL' 215'    ERR,EC
     C                     END
     C*
     C***********                                                         073714
      ***VALIDATE OTHER CURRENCY                                          073714
     C***********                                                         073714
     C***********                                                  S01117 073714
      ***MUST*BE ON SDCURRPD                                       S01117 073714
     C***********                                                  S01117 073714
     C***********SOTHC     IFNE *BLANK                             S01117 073714
     C************IN58     ANDEQ'0'                                S01117 073714
     C***********          CALL 'AOCURRR0'                         S01117 073714
     C***********          PARM *BLANKS   @RTCD   7                S01117 073714
     C***********          PARM '*KEY   ' @OPTN   7                S01117 073714
     C***********          PARM SOTHC     @AJCD   3                S01117 073714
     C***********SDCURR    PARM SDCURR    DSSDY                    S01117 073714
     C***********@RTCD     IFNE *BLANKS                            S01117 073714
     C***********                                                  S01117 073714
     C***********@RTCD     IFEQ '*NOSEL '                          S01117 073714
     C***********          ADD  1         EC         43            S01117 073714
     C***********          MOVEL' 251'    ERR,EC                   S01117 073714
     C***********          ELSE                                    S01117 073714
     C***********          ADD  1         EC         43            S01117 073714
     C***********          MOVEL' 228'    ERR,EC                   S01117 073714
     C***********          END                                     S01117 073714
     C***********                                                  S01117 073714
     C***********          ELSE                                    S01117 073714
     C***********SOTHC     IFNE CURR                               S01117 073714
     C***********          MOVE CURR      SOTHC                    S01117 073714
     C***********          END                                     S01117 073714
     C***********          END                                     S01117 073714
     C***********          END                                     S01117 073714
     C***********                                                  S01117 073714
     C***********          MOVELSOTHC     OTHC                            073714
     C***********                                                         073714
      ***MANDATORY FIELD FOR TYPES 2&5, FORBIDDEN OTHERWISE               073714
     C***********                                                         073714
     C***********SOTHC     IFEQ *BLANK                                    073714
     C***********SISPT     ANDEQ'2'                                       073714
     C***********SOTHC     OREQ *BLANK                                    073714
     C***********SISPT     ANDEQ'5'                                       073714
     C***********          ADD  1         EC         43                   073714
     C***********          MOVEL' 227'    ERR,EC                          073714
     C***********          END                                            073714
     C***********                                                         073714
     C************IN32     IFEQ '0'                                       073714
     C***********SOTHC     ANDNE*BLANK                                    073714
     C***********SISPT     ANDNE'2'                                       073714
     C***********SISPT     ANDNE'5'                                       073714
     C***********          ADD  1         EC         43                   073714
     C***********          MOVEL' 227'    ERR,EC                          073714
     C***********          END                                            073714
     C***********                                                         073714
      ***MUST*NOT BE SAME AS INSTRUMENT CCY                               073714
     C***********                                                         073714
     C***********SOTHC     IFEQ SISCY                                     073714
     C************IN43     ANDEQ'0'                                       073714
     C***********          ADD  1         EC         43                   073714
     C***********          MOVEL' 229'    ERR,EC                          073714
     C***********          END                                            073714
     C***********                                                         073714
      ***MUST*BE*ON*TABTG10***********************************************S01117
     C***********                                                         S01117
     C***********SOTHC     IFNE *BLANK                                    S01117
     C************IN43     ANDEQ'0'                                       E16372
     C***********          MOVE SOTHC     TCCY                            S01117
     C***********CCYK      CHAINTABFF                99                   S01117
     C************IN99     IFEQ '1'                                       S01117
     C***********RECI      ORNE 'D'                                       S01117
     C***********          ADD  1         EC         43                   S01117
     C***********          MOVEL' 228'    ERR,EC                          S01117
     C***********          END                                            S01117
     C***********          END                                            S01117
     C*
      ** VALIDATE COMMISSION CODE - MUST BE NUMERIC IF ENTERED
      ** MUST ENTERED ONLY IF PATTERN IS ENTERED
     C*
     C           SCCMC     IFEQ *BLANK
     C           SCCPT     ANDNE*BLANK
     C                     ADD  1         EC         44
     C                     MOVEL' 218'    ERR,EC
     C                     END
     C*
     C           SCCMC     IFNE *BLANK
     C           SCCPT     ANDEQ*BLANK
     C                     ADD  1         EC         44
     C                     MOVEL' 218'    ERR,EC
     C                     END
     C*
     C           SCCMC     IFNE *BLANK
     C           *IN44     ANDEQ'0'
     C           *LIKE     DEFN SCCMC     WRK3A + 1
     C                     MOVE 0         WRK3A
     C                     MOVELSCCMC     WRK3A
     C                     TESTN          WRK3A      15
     C*
     C           *IN15     IFEQ '0'
     C                     ADD  1         EC         44
     C                     MOVEL' 216'    ERR,EC
     C                     ELSE
     C                     MOVE SCCMC     CCMC
     C                     END
     C*
      ** MUST EXIST FOR THE INSTRUMENT CCY ON FL-CHGCM
      ** ONLY IF INSTRUMENT CCY IS VALID
     C*
     C           *IN33     IFEQ '0'
     C           *IN44     ANDEQ'0'
     C                     MOVE SISCY     CCY
     C                     MOVE SCCMC     CGCM
     C           CHGCMK    CHAINCHGCM                99
     C           *IN99     IFEQ '1'
     C           RECI      ORNE 'D'
     C                     ADD  1         EC         44
     C                     MOVE ' 217'    ERR,EC
     C                     END
     C                     END
     C*
      ** ENTRY NOT MADE
     C*
     C                     ELSE
     C                     Z-ADD0         CCMC
     C                     END
     C*
      ** VALIDATE COMMISSION CODE FOR SAME DAY
      ** MUST ENTERED ONLY IF PATTERN IS ENTERED
     C*
     C           SCCMS     IFEQ *BLANK
     C           SCCPT     ANDNE*BLANK
     C                     ADD  1         EC         45
     C                     MOVEL' 221'    ERR,EC
     C                     END
     C*
     C           SCCMS     IFNE *BLANK
     C           SCCPT     ANDEQ*BLANK
     C                     ADD  1         EC         45
     C                     MOVEL' 221'    ERR,EC
     C                     END
     C*
     C           SCCMS     IFNE *BLANK
     C           *IN45     ANDEQ'0'
     C                     MOVE 0         WRK3A
     C                     MOVELSCCMS     WRK3A
     C                     TESTN          WRK3A      15
     C*
     C           *IN15     IFEQ '0'
     C                     ADD  1         EC         45
     C                     MOVEL' 219'    ERR,EC
     C                     ELSE
     C                     MOVE SCCMS     CCMS
     C                     END
     C*
      ** MUST EXIST FOR THE INSTRUMENT CCY ON LF-CHGCM
      ** ONLY IF INSTRUMENT CCY IS VALID
     C*
     C           *IN33     IFEQ '0'
     C           *IN45     ANDEQ'0'
     C                     MOVE SISCY     CCY
     C                     MOVE SCCMS     CGCM
     C           CHGCMK    CHAINCHGCM                99
     C           *IN99     IFEQ '1'
     C           RECI      ORNE 'D'
     C                     ADD  1         EC         45
     C                     MOVE ' 220'    ERR,EC
     C                     END
     C                     END
     C*
      ** NO ENTRY MADE
     C*
     C                     ELSE
     C                     Z-ADD0         CCMS
     C                     END
     C*
      ** VALIDATE CHARGES CODE FOR PURCHASE IF ENTERED
     C*
     C           SCCGP     IFNE *BLANK
     C                     MOVE 0         WRK3A
     C                     MOVELSCCGP     WRK3A
     C                     TESTN          WRK3A      15
     C*
     C           *IN15     IFEQ '0'
     C                     ADD  1         EC         46
     C                     MOVEL' 222'    ERR,EC
     C                     ELSE
     C                     MOVE SCCGP     CCGP
     C                     END
     C*
      ** MUST EXIST FOR THE INSTRUMENT CCY ON FL-CHGCM
      ** ONLY IF INSTRUMENT CCY IS VALID
     C*
     C           *IN33     IFEQ '0'
     C           *IN46     ANDEQ'0'
     C                     MOVE SISCY     CCY
     C                     MOVE SCCGP     CGCM
     C           CHGCMK    CHAINCHGCM                99
     C           *IN99     IFEQ '1'
     C           RECI      ORNE 'D'
     C                     ADD  1         EC         46
     C                     MOVE ' 223'    ERR,EC
     C                     END
     C                     END
     C*
      ** NO ENTRY MADE
     C*
     C                     ELSE
     C                     Z-ADD0         CCGP
     C                     END
     C*
      ** VALIDATE CHARGES CODE FOR SALE IF ENTERED
     C*
     C           SCCGS     IFNE *BLANK
     C                     MOVE 0         WRK3A
     C                     MOVELSCCGS     WRK3A
     C                     TESTN          WRK3A      15
     C*
     C           *IN15     IFEQ '0'
     C                     ADD  1         EC         47
     C                     MOVEL' 224'    ERR,EC
     C                     ELSE
     C                     MOVE SCCGS     CCGS
     C                     END
     C*
      ** MUST EXIST FOR THE INSTRUMENT CCY ON FL-CHGCM
      ** ONLY IF INSTRUMENT CCY IS VALID
     C*
     C           *IN33     IFEQ '0'
     C           *IN47     ANDEQ'0'
     C                     MOVE SISCY     CCY
     C                     MOVE SCCGS     CGCM
     C           CHGCMK    CHAINCHGCM                99
     C           *IN99     IFEQ '1'
     C           RECI      ORNE 'D'
     C                     ADD  1         EC         47
     C                     MOVE ' 225'    ERR,EC
     C                     END
     C                     END
     C*
      ** NO ENTRY MADE
     C*
     C                     ELSE
     C                     Z-ADD0         CCGS
     C                     END
     C***********                                                         073714
      ***VALIDATE PREMIUM UP FRONT - MUST BE Y/N DEPENDANT ON PROC TYPE   073714
     C***********                                                         073714
     C***********          MOVE SPUPF     PUPF                            073714
     C***********                                                         073714
     C************IN32     IFEQ '0'                                       073714
     C***********                                                         073714
     C***********SPUPF     IFNE *BLANK                                    073714
     C***********SISPT     ANDNE'4'                                       073714
     C***********SISPT     ANDNE'5'                                       073714
     C***********SISPT     ANDNE'6'                                       073714
     C***********          ADD  1         EC         48                   073714
     C***********          MOVEL' 230'    ERR,EC                          073714
     C***********          END                                            073714
     C***********                                                         073714
     C***********SPUPF     IFNE *BLANK                                    073714
     C************IN48     ANDEQ'0'                                       073714
     C***********SPUPF     ANDNE'Y'                                       073714
     C***********SPUPF     ANDNE'N'                                       073714
     C***********          ADD  1         EC         48                   073714
     C***********          MOVEL' 231'    ERR,EC                          073714
     C***********          END                                            073714
     C***********          END                                            073714
     C***********                                                  FF0011 073714
      ***Validate American/European option indicator               FF0011 073714
     C***********                                                  FF0011 073714
     C***********          MOVE SAEIN     AEIN                     FF0011 073714
     C***********                                                  FF0011 073714
     C************IN32     IFEQ '0'                                FF0011 073714
     C***********                                                  FF0011 073714
     C***********SAEIN     IFNE *BLANK                             FF0011 073714
     C***********SISPT     ANDNE'4'                                FF0011 073714
     C***********SISPT     ANDNE'5'                                FF0011 073714
     C***********SISPT     ANDNE'6'                                FF0011 073714
     C***********          ADD  1         EC         71            FF0011 073714
     C***********          MOVEL' 275'    ERR,EC                   FF0011 073714
     C***********          END                                     FF0011 073714
     C***********                                                  FF0011 073714
     C***********SAEIN     IFNE *BLANK                             FF0011 073714
     C************IN71     ANDEQ'0'                                FF0011 073714
     C***********SAEIN     ANDNE'A'                                FF0011 073714
     C***********SAEIN     ANDNE'E'                                FF0011 073714
     C***********          ADD  1         EC         71            FF0011 073714
     C***********          MOVEL' 276'    ERR,EC                   FF0011 073714
     C***********          END                                     FF0011 073714
     C***********          END                                     FF0011 073714
     C***********                                                         073714
      ***VALIDATE FINAL TRANSACTION DATE                                  073714
     C***********                                                         073714
      ***MANDATORY                                                        073714
     C***********                                                         073714
     C***********SFTDT     IFEQ *BLANK                                    073714
     C***********          ADD  1         EC         49                   073714
     C***********          MOVEL' 232'    ERR,EC                          073714
     C***********          ELSE                                           073714
     C***********                                                         073714
      ***TO*BE*A*VALID DATE, MUST BE NUMERIC                              073714
     C***********                                                         073714
     C************LIKE     DEFN SFTDT     WRK7A + 1                       073714
     C***********          MOVE '0'       WRK7A                           073714
     C***********          MOVELSFTDT     WRK7A                           073714
     C***********          TESTN          WRK7A      1515                 073714
     C***********                                                         073714
      ***IF*NUMERIC VALIDATE AS A DATE                                    073714
     C***********                                                         073714
     C***********          SETOF                     99                   073714
     C***********                                                         073714
     C************IN15     IFEQ '1'                                       073714
     C***********          MOVE SFTDT     ZDATE                           073714
     C***********          EXSR ZDATE1                                    073714
     C***********          END                                            073714
     C***********                                                         073714
     C************IN,99    IFEQ '1'                                       073714
     C************IN15     OREQ '0'                                       073714
     C***********          ADD  1         EC         49                   073714
     C***********          MOVEL' 233'    ERR,EC                          073714
     C***********          ELSE                                           073714
     C***********          Z-ADDZDAYNO    FTDT                            073714
     C***********          END                                            073714
     C***********          END                                            073714
     C***********                                                         073714
      ***MUST*BE*ON OR AFTER RUN DATE                                     073714
     C***********                                                         073714
     C************IN49     IFEQ '0'                                       073714
     C***********FTDT      ANDLTRUND                                      073714
     C***********          ADD  1         EC         49                   073714
     C***********          MOVEL' 234'    ERR,EC                          073714
     C***********          END                                            073714
     C*                                                                   S01235
      ** VALIDATE INSTRUMENT TYPE IF PORTFOLIO MGMT MODULE IS PRESENT     S01235
     C** If Bank Portfolios are supported, treat as if PM off             CPM003
     C*                                                                   S01235
     C           BGPFMG    IFEQ 'Y'                        b1             S01235
     C           FCPORS    ANDNE'B'                                       CPM003
     C           BGN4ST    OREQ 'Y'                                       CPB001
     C*                                                                   PMC143
     C           SINNR     IFEQ *BLANKS                    b2             PMC143
     C           BGN4ST    ANDNE'Y'                                       CPB001
     C           SINNR     OREQ FCDINR                                    PMC143
     C           BGN4ST    ANDNE'Y'                                       CPB001
     C                     MOVE FCDINR    SINNR                           PMC143
     C                     ELSE                            x2             PMC143
     C                     CALL 'AOPLINR0'                                S01235
     C                     PARM *BLANKS   @RTCD   7                       S01235
     C                     PARM '*KEY   ' @OPTN   7                       S01235
     C                     PARM SINNR     @KEY    3                       S01235
     C           SDPLIN    PARM SDPLIN    @DSFDY                          S01235
     C           @RTCD     IFNE *BLANKS                    b3             S01235
     C           @RTCD     OREQ *BLANKS                                   S01235
     C           PDRECI    ANDNE'D'                                       PMC143
     C                     ADD  1         EC         54                   S01235
     C                     MOVE '242'     ERR,EC                          S01235
     C                     ELSE                            x3             S01235
     C                     MOVE '0'       *IN54                           CPB001
     C                     MOVELSINNR     INNR                            S01235
     C                     END                             e3             S01235
     C*                                                                   PMC143
     C                     END                             e2             PMC143
     C*                                                                   S01235
     C                     END                             e1             S01235
     C***********                                                         073714
      ***VALIDATE SETTLEMENT DATE                                         073714
     C***********                                                         073714
      ***MANDATORY                                                        073714
     C***********                                                         073714
     C***********SSETD     IFEQ *BLANK                                    073714
     C***********          ADD  1         EC         50                   073714
     C***********          MOVEL' 235'    ERR,EC                          073714
     C***********          ELSE                                           073714
     C***********                                                         073714
      ***TO*BE*A*VALID DATE, MUST BE NUMERIC                              073714
     C***********                                                         073714
     C***********          MOVE '0'       WRK7A                           073714
     C***********          MOVELSSETD     WRK7A                           073714
     C***********          TESTN          WRK7A      1515                 073714
     C***********                                                         073714
      ***IF*NUMERIC VALIDATE AS A DATE                                    073714
     C***********                                                         073714
     C***********          SETOF                     99                   073714
     C***********                                                         073714
     C************IN15     IFEQ '1'                                       073714
     C***********          MOVE SSETD     ZDATE                           073714
     C***********          EXSR ZDATE1                                    073714
     C***********          END                                            073714
     C***********          MOVE SSETD     ZDATE                    E18011 073714
     C***********          EXSR ZDATE1                             E18011 073714
     C************IN,99    IFEQ '1'                                       073714
     C************IN15     OREQ '0'                                       073714
     C***********          ADD  1         EC         50                   073714
     C***********          MOVEL' 236'    ERR,EC                          073714
     C***********          ELSE                                           073714
     C***********          Z-ADDZDAYNO    SETD                            073714
     C***********          END                                            073714
     C***********          END                                            073714
     C***********                                                         073714
      ***MUST*BE*ON OR AFTER RUN DATE                                     073714
     C***********                                                         073714
     C************IN50     IFEQ '0'                                       073714
     C***********SETD      ANDLTRUND                                      073714
     C***********          ADD  1         EC         50                   073714
     C***********          MOVEL' 237'    ERR,EC                          073714
     C***********          END                                            073714
     C***********                                                         073714
      ***SETTLEMENT DATE IS VALID                                         073714
     C***********                                                         073714
     C************IN50     IFEQ '0'                                       073714
     C***********                                                         073714
      ***VALIDATE FINAL TRANSACTION DATE AGAINST SETTLEMENT DATE          073714
     C***********                                                         073714
     C************IN49     IFEQ '0'                                       073714
     C***********FTDT      ANDGESETD                                      E44683
     C***********FTDT      ANDGTSETD                               E44683 073714
     C***********          ADD  1         EC         49                   073714
     C***********          MOVEL' 234'    ERR,EC                          073714
     C***********          END                                            073714
     C***********                                                         073714
      ***WARNING*ERRORS                                                   073714
     C***********                                                         073714
      ***SHOULD*BE A WORKING DAY IN INSTRUMENT CCY                        073714
     C***********                                                         073714
     C************IN33     IFEQ '0'                                       073714
     C***********          MOVE SISCY     ZCCY                            073714
     C***********          Z-ADDSETD      ZDAYNO                          073714
     C***********          MOVE SYSL      ZLOC                     S01195 073714
     C***********          EXSR ZDATE5                                    S01195
     C***********          EXSR ZCHKH                              S01195 073714
     C************IN99     IFEQ '1'                                       S01195
     C***********ZIND      IFEQ 'H'                                S01195 073714
     C***********          ADD  1         W          50                   073714
     C***********          MOVEL' W03'    WER,W                           073714
     C***********          END                                            073714
     C***********          END                                            073714
     C***********SISPT     IFEQ '2'                                       073714
     C***********SISPT     OREQ '5'                                       073714
     C************IN43     IFEQ '0'                                       073714
     C***********          MOVE SOTHC     ZCCY                            073714
     C***********          Z-ADDSETD      ZDAYNO                          073714
     C***********          MOVE SYSL      ZLOC                     S01195 073714
     C***********          EXSR ZDATE5                                    S01195
     C***********          EXSR ZCHKH                              S01195 073714
     C************IN99     IFEQ '1'                                       S01195
     C***********ZIND      IFEQ 'H'                                S01195 073714
     C***********          ADD  1         W          50                   073714
     C***********          MOVEL' W04'    WER,W                           073714
     C***********          END                                            073714
     C***********          END                                            073714
     C***********          END                                            073714
     C***********          END                                            073714
     C***********                                                         073714
      ***VALIDATE SPOT MONTH DATE                                         073714
     C***********                                                         073714
      ***MANDATORY                                                        073714
     C***********                                                         073714
     C***********SSPDT     IFEQ *BLANK                                    073714
     C***********          ADD  1         EC         51                   073714
     C***********          MOVEL' 238'    ERR,EC                          073714
     C***********          ELSE                                           073714
     C***********                                                         073714
      ***TO*BE*A*VALID DATE, MUST BE NUMERIC                              073714
     C***********                                                         073714
     C***********          MOVE '0'       WRK7A                           073714
     C***********          MOVELSSPDT     WRK7A                           073714
     C***********          TESTN          WRK7A      1515                 073714
     C***********                                                         073714
      ***IF*NUMERIC VALIDATE AS A DATE                                    073714
     C***********                                                         073714
     C***********          SETOF                     99                   073714
     C***********                                                         073714
     C************IN15     IFEQ '1'                                       073714
     C***********          MOVE SSPDT     ZDATE                           073714
     C***********          EXSR ZDATE1                                    073714
     C***********          END                                            073714
     C************IN,99    IFEQ '1'                                       073714
     C************IN15     OREQ '0'                                       073714
     C***********          ADD  1         EC         51                   073714
     C***********          MOVEL' 239'    ERR,EC                          073714
     C***********          ELSE                                           073714
     C***********          Z-ADDZDAYNO    SPDT                            073714
     C***********          END                                            073714
     C***********          END                                            073714
     C***********                                                         073714
      ***SPOT*MONTH DATE IS VALID                                         073714
     C***********                                                         073714
     C************IN51     IFEQ '0'                                       073714
     C***********                                                         073714
      ***VALIDATE SPOT DATE AGAINST FINAL TRANSACTION DATE                073714
     C***********                                                         073714
     C************IN49     IFEQ '0'                                       073714
     C***********SPDT      ANDGTFTDT                                      073714
     C***********          ADD  1         EC         51                   073714
     C***********          MOVEL' 240'    ERR,EC                          073714
     C***********          END                                            073714
     C***********                                                         073714
      ***WARNING*ERRORS                                                   073714
     C***********                                                         073714
     C************IN49     IFEQ '0'                                       073714
     C***********                                                         073714
      ***SHOULD*BE A WORKING DAY IN INSTRUMENT CCY                        073714
     C***********                                                         073714
     C************IN33     IFEQ '0'                                       073714
     C***********          MOVE SISCY     ZCCY                            073714
     C***********          Z-ADDFTDT      ZDAYNO                          073714
     C***********          MOVE SYSL      ZLOC                     S01195 073714
     C***********          EXSR ZDATE5                                    S01195
     C***********          EXSR ZCHKH                              S01195 073714
     C************IN99     IFEQ '1'                                       S01195
     C***********ZIND      IFEQ 'H'                                S01195 073714
     C***********          ADD  1         W          49                   073714
     C***********          MOVEL' W01'    WER,W                           073714
     C***********          END                                            073714
     C***********          END                                            073714
     C***********SISPT     IFEQ '2'                                       073714
     C***********SISPT     OREQ '5'                                       073714
     C************IN43     IFEQ '0'                                       073714
     C***********          MOVE SOTHC     ZCCY                            073714
     C***********          Z-ADDFTDT      ZDAYNO                          073714
     C***********          MOVE SYSL      ZLOC                     S01195 073714
     C***********          EXSR ZDATE5                                    S01195
     C***********          EXSR ZCHKH                              S01195 073714
     C************IN99     IFEQ '1'                                       S01195
     C***********ZIND      IFEQ 'H'                                S01195 073714
     C***********          ADD  1         W          49                   073714
     C***********          MOVEL' W02'    WER,W                           073714
     C***********          END                                            073714
     C***********          END                                            073714
     C***********          END                                            073714
     C***********          END                                            073714
     C***********                                                         073714
      ***WARNING*ERRORS                                                   073714
     C***********                                                         073714
      ***SHOULD*BE A WORKING DAY IN INSTRUMENT CCY                        073714
     C***********                                                         073714
     C************IN33     IFEQ '0'                                       073714
     C***********          MOVE SISCY     ZCCY                            073714
     C***********          Z-ADDSPDT      ZDAYNO                          073714
     C***********          MOVE SYSL      ZLOC                     S01195 073714
     C***********          EXSR ZDATE5                                    S01195
     C***********          EXSR ZCHKH                              S01195 073714
     C************IN99     IFEQ '1'                                       S01195
     C***********ZIND      IFEQ 'H'                                S01195 073714
     C***********          ADD  1         W          51                   073714
     C***********          MOVEL' W05'    WER,W                           073714
     C***********          END                                            073714
     C***********          END                                            073714
     C***********SISPT     IFEQ '2'                                       073714
     C***********SISPT     OREQ '5'                                       073714
     C************IN43     IFEQ '0'                                       073714
     C***********          MOVE SOTHC     ZCCY                            073714
     C***********          Z-ADDSETD      ZDAYNO                          HK0000
     C***********          Z-ADDSPDT      ZDAYNO                   HK0000 073714
     C***********          MOVE SYSL      ZLOC                     S01195 073714
     C***********          EXSR ZDATE5                                    S01195
     C***********          EXSR ZCHKH                              S01195 073714
     C************IN99     IFEQ '1'                                       S01195
     C***********ZIND      IFEQ 'H'                                S01195 073714
     C***********          ADD  1         W          51                   073714
     C***********          MOVEL' W06'    WER,W                           073714
     C***********          END                                            073714
     C***********          END                                            073714
     C***********          END                                            073714
     C***********          END                                            073714
     C*
      ***VALIDATE*UNDERLYING*PERIOD*-*MUST*BE*NUMERIC                     S01393
     C*  VALIDATE P&L AMORTISATION PERIOD - MUST BE NUMERIC               S01393
     C*
     C           SULPD     IFNE *BLANK
     C                     Z-ADD0         ZADEC
     C                     Z-ADD3         ZADIG
     C                     MOVEL*BLANK    ZFIELD
     C                     MOVE SULPD     ZFIELD
     C                     EXSR ZALIGN
     C*
     C           *IN99     IFEQ '0'
     C                     MOVE ZFIELD    ULPD
     C                     ELSE
     C                     Z-ADD0         ULPD
     C                     ADD  1         EC         52
     C                     MOVEL' 241'    ERR,EC
     C                     END
     C*
     C                     ELSE
     C                     Z-ADD0         ULPD
     C                     END
     C*
     C*                                                                   S01393
      ** Validate Underlying Period - Must be Numeric                     S01393
     C*                                                                   S01393
     C           SALPD     IFNE *BLANK                                    S01393
     C                     Z-ADD0         ZADEC                           S01393
     C                     Z-ADD5         ZADIG                           S01393
     C                     MOVEL*BLANK    ZFIELD                          S01393
     C                     MOVE SALPD     ZFIELD                          S01393
     C                     EXSR ZALIGN                                    S01393
     C*                                                                   S01393
     C           *IN99     IFEQ '0'                                       S01393
     C                     MOVE ZFIELD    ALPD                            S01393
     C                     ELSE                                           S01393
     C                     Z-ADD0         ALPD                            S01393
     C                     ADD  1         EC         53                   S01393
     C                     MOVEL' 241'    ERR,EC                          S01393
     C                     END                                            S01393
     C*                                                                   S01393
     C                     ELSE                                           S01393
     C                     Z-ADD0         ALPD                            S01393
     C                     END                                            S01393
     C*                                                                   S01393
      ** END OF INSERT/AMEND PROCESSING
     C*
     C                     END
     C*
      ** IF ACTION IS 'D' AND ENTER WAS PRESSED, THIS IS AN ERROR
     C*
     C           ACTN      IFEQ 'D'
     C                     MOVELINF,9     INFMSG
     C                     MOVE '1'       *IN24                                              BUG8046
     C                     END
     C*
      ** END OF 'ENTER' PROCESSING
     C*
     C                     END
     C*
      ** IF COMMAND 4 TAKEN
     C*
     C           AID       IFEQ '04'
     C*
      ** COMMAND 4 TAKEN CORRECTLY WHEN ACTION IS D-FORCE 'RECORD ADVANCE'
      ** FOR LATER FORMAT PROCESSING
     C*
     C           ACTN      IFEQ 'D'
     C                     MOVEL'RA'      AID
     C*
     C* COMMAND 4 TAKEN INCORRECTLY WHEN ACTION IS NOT D-HENCE ERROR
     C*
     C                     ELSE
     C                     MOVELINF,10    INFMSG
     C                     END
     C                     END
     C*
      ** MOVE WARNINGS OT ARRAY IF SOME HAVE OCCURRED
     C*
     C           WER,1     IFNE *BLANK
     C                     ADD  1         EC
     C                     MOVEAWER       ERR,EC
     C                     END
     C*
      ** IF ERRORS OCCURED, HIGHLIGHT ERROR BAND
     C*
     C           EC        IFNE *ZERO
     C                     MOVEAERR       ERRMSG
     C                     MOVELHI        ERRMSG
     C                     END
     C*
      ** IF MORE THAN 19 ERRORS OCCURRED, DISPLAY ON SECOND LINE
     C*
     C           EC        IFGT 19
     C                     MOVEAERR,20    INFMSG
     C                     MOVELHI        INFMSG
     C                     END
     C*
     C                     ENDSR
     C********************************************************************
     C/COPY WNCPYSRC,FF0140C007
      /EJECT                                                              CFF007
     C********************************************************************CFF007
      **                                                                  CFF007
      ** SRVLD2 S/R to validate detail screen 2                           CFF007
      **                                                                  CFF007
      ** CALLED BY: UPDFLS S/R                                            CFF007
      **                                                                  CFF007
      ** CALLS: *PSSR S/R                                                 CFF007
      **                                                                  CFF007
     C********************************************************************CFF007
     C*                                                                   CFF007
     C           SRVLD2    BEGSR                                          CFF007
     C*                                                                   CFF007
     C                     MOVE '0'       *IN32                           CFF007
     C                     MOVEA'00000'   *IN,34                          CFF007
     C*                                                                   CFF007
     C                     Z-ADD*ZERO     EC                              CFF007
     C*                                                                   CFF007
     C** Validate Underlying Security                                     CFF007
     C*                                                                   CFF007
     C           SUNSE     IFNE *BLANKS                                   CFF007
     C           BGSECS    ANDEQ'Y'                                       CFF007
     C*                                                                   CFF007
     C           SUNSE     CHAINSECTY                99                   CFF007
     C*                                                                   CFF007
     C           *IN99     IFEQ '1'                                       CFF007
     C           *IN99     OREQ '0'                                       CFF007
     C           RECISE    ANDNE'D'                                       CFF007
     C*                                                                   CFF007
     C                     MOVE '1'       *IN32                           CFF007
     C                     ADD  1         EC                              CFF007
     C                     MOVEL' 400'    ERR,EC                          CFF007
      *                                                                   CFF007
     C                     ELSE                                           CFF007
     C                     MOVE 'N'       WPRTEC                          CFF007
      *                                                                   CFF007
     C           ACTN      IFEQ 'A'                                       CFF007
      *                                                                   CFF007
     C           ISTT      SETLLTRANS13                                   CFF007
     C           ISTT      READETRANS13                  89               CFF007
      *                                                                   CFF007
     C           *IN89     DOWEQ'0'                                       CFF007
     C           WPRTEC    ANDEQ'N'                                       CFF007
      *                                                                   CFF007
     C           BLUP      IFEQ 'Y'                                       CFF007
     C           NOCO      ANDGT*ZEROS                                    CFF007
     C                     MOVE 'Y'       WPRTEC                          CFF007
     C                     MOVE '1'       *IN32                           CFF007
     C                     ADD  1         EC                              CFF007
     C                     MOVEL' 406'    ERR,EC                          CFF007
     C                     ENDIF                                          CFF007
      *                                                                   CFF007
     C           ISTT      READETRANS13                  89               CFF007
     C                     ENDDO                                          CFF007
      *                                                                   CFF007
     C           WPRTEC    IFEQ 'N'                                       CFF007
     C                     MOVE SUNSE     UNSE                            CFF007
     C                     ENDIF                                          CFF007
      *                                                                   CFF007
     C                     ELSE                                           CFF007
     C                     MOVE SUNSE     UNSE                            CFF007
     C                     ENDIF                                          CFF007
      *                                                                   CFF007
     C                     ENDIF                                          CFF007
      *                                                                   CFF007
     C                     ELSE                                           CFF007
     C                     MOVE *BLANKS   UNSE                            CFF007
     C                     ENDIF                                          CFF007
      *                                                                   CFF007
      ** Validate PB Economic Sector                                      CFF007
      *                                                                   CFF007
     C           STECO     IFNE *BLANKS                                   CFF007
      *                                                                   CFF007
     C                     CALL 'AOECOSR0'                                CFF007
     C                     PARM *BLANKS   @RTCD                           CFF007
     C                     PARM '*KEY   ' @OPTN                           CFF007
     C                     PARM           STECO                           CFF007
     C           SDECOS    PARM SDECOS    @DSFDY                          CFF007
      *                                                                   CFF007
     C           @RTCD     IFNE *BLANKS                                   CFF007
     C                     MOVE '1'       *IN34                           CFF007
     C                     ADD  1         EC                              CFF007
     C                     MOVEL' 401'    ERR,EC                          CFF007
      *                                                                   CFF007
     C                     ELSE                                           CFF007
     C                     MOVE PCECOS    TECO                            CFF007
     C                     MOVE PCECOS    STECO                           CFF007
      *                                                                   CFF007
     C                     ENDIF                                          CFF007
      *                                                                   CFF007
     C                     ELSE                                           CFF007
     C           BGSECS    IFEQ 'Y'                                       CFF007
      *                                                                   CFF007
     C           SUNSE     CHAINSECTY                99                   CFF007
      *                                                                   CFF007
     C           *IN99     IFEQ '0'                                       CFF007
     C                     MOVE SIDY      @LICD   3                       CFF007
     C                     CALL 'AOINDSR0'                                CFF007
     C                     PARM *BLANKS   @RTCD                           CFF007
     C                     PARM '*KEY   ' @OPTN                           CFF007
     C                     PARM           @LICD                           CFF007
     C           SDINDS    PARM SDINDS    @DSFDY                          CFF007
      *                                                                   CFF007
     C           @RTCD     IFNE *BLANKS                                   CFF007
     C                     MOVE '1'       *IN34                           CFF007
     C                     ADD  1         EC                              CFF007
     C                     MOVEL' 401'    ERR,EC                          CFF007
     C                     ELSE                                           CFF007
     C                     MOVE AOECOS    STECO                           CFF007
     C                     MOVE AOECOS    TECO                            CFF007
     C                     ENDIF                                          CFF007
      *                                                                   CFF007
     C                     ELSE                                           CFF007
     C                     MOVE '1'       *IN34                           CFF007
     C                     ADD  1         EC                              CFF007
     C                     MOVEL' 401'    ERR,EC                          CFF007
     C                     ENDIF                                          CFF007
      *                                                                   CFF007
     C                     ELSE                                           CFF007
     C                     MOVE '1'       *IN34                           CFF007
     C                     ADD  1         EC                              CFF007
     C                     MOVEL' 401'    ERR,EC                          CFF007
     C                     ENDIF                                          CFF007
      *                                                                   CFF007
     C                     ENDIF                                          CFF007
      *                                                                   CFF007
      ** Validate Nature Code                                             CFF007
      *                                                                   CFF007
     C           STNAT     IFNE *BLANKS                                   CFF007
     C*                                                                   CFF007
     C                     CALL 'AONATUR0'                                CFF007
     C                     PARM *BLANKS   @RTCD                           CFF007
     C                     PARM '*KEY   ' @OPTN                           CFF007
     C                     PARM           STNAT                           CFF007
     C           SDNATU    PARM SDNATU    @DSFDY                          CFF007
     C*                                                                   CFF007
     C           @RTCD     IFNE *BLANKS                                   CFF007
     C                     MOVE '1'       *IN35                           CFF007
     C                     ADD  1         EC                              CFF007
     C                     MOVEL' 402'    ERR,EC                          CFF007
     C                     ELSE                                           CFF007
     C                     MOVE TNNATU    TNAT                            CFF007
     C                     MOVE TNNATU    STNAT                           CFF007
     C                     ENDIF                                          CFF007
      *                                                                   CFF007
     C                     ELSE                                           CFF007
     C           BGSECS    IFEQ 'Y'                                       CFF007
      *                                                                   CFF007
     C           SUNSE     CHAINSECTY                99                   CFF007
      *                                                                   CFF007
     C           *IN99     IFEQ '0'                                       CFF007
     C                     MOVE NATU      STNAT                           CFF007
     C                     MOVE NATU      TNAT                            CFF007
     C                     ELSE                                           CFF007
     C                     MOVE '1'       *IN35                           CFF007
     C                     ADD  1         EC                              CFF007
     C                     MOVEL' 402'    ERR,EC                          CFF007
     C                     ENDIF                                          CFF007
      *                                                                   CFF007
     C                     ELSE                                           CFF007
     C                     MOVE '1'       *IN35                           CFF007
     C                     ADD  1         EC                              CFF007
     C                     MOVEL' 402'    ERR,EC                          CFF007
     C                     ENDIF                                          CFF007
      *                                                                   CFF007
     C                     ENDIF                                          CFF007
      *                                                                   CFF007
      ** Validate Country of Risk                                         CFF007
      *                                                                   CFF007
     C           SCRIK     IFNE *BLANKS                                   CFF007
     C                     CALL 'AOCTRYR0'                                CFF007
     C                     PARM *BLANKS   @RTCD                           CFF007
     C                     PARM '*KEY   ' @OPTN                           CFF007
     C                     PARM           SCRIK                           CFF007
     C           SDCTRY    PARM SDCTRY    @DSFDY                          CFF007
     C*                                                                   CFF007
     C           @RTCD     IFNE *BLANKS                                   CFF007
     C                     MOVE '1'       *IN36                           CFF007
     C                     ADD  1         EC                              CFF007
     C                     MOVEL' 403'    ERR,EC                          CFF007
     C                     ELSE                                           CFF007
     C                     MOVE A4CNCD    SCRIK                           CFF007
     C                     MOVE A4CNCD    CRIK                            CFF007
     C                     ENDIF                                          CFF007
      *                                                                   CFF007
     C                     ELSE                                           CFF007
     C           BGSECS    IFEQ 'Y'                                       CFF007
      *                                                                   CFF007
     C           SUNSE     CHAINSECTY                99                   CFF007
      *                                                                   CFF007
     C           *IN99     IFEQ '0'                                       CFF007
     C                     MOVE SCOR      SCRIK                           CFF007
     C                     MOVE SCOR      CRIK                            CFF007
     C                     ELSE                                           CFF007
     C                     MOVE '1'       *IN36                           CFF007
     C                     ADD  1         EC                              CFF007
     C                     MOVEL' 403'    ERR,EC                          CFF007
     C                     ENDIF                                          CFF007
      *                                                                   CFF007
     C                     ELSE                                           CFF007
     C                     MOVE '1'       *IN36                           CFF007
     C                     ADD  1         EC                              CFF007
     C                     MOVEL' 403'    ERR,EC                          CFF007
     C                     ENDIF                                          CFF007
      *                                                                   CFF007
     C                     ENDIF                                          CFF007
      *                                                                   CFF007
      ** Validate Currency of Risk                                        CFF007
      *                                                                   CFF007
     C           SCCYR     IFNE *BLANKS                                   CFF007
      *                                                                   CFF007
     C                     CALL 'AOCURRR0'                                CFF007
     C                     PARM *BLANKS   @RTCD                           CFF007
     C                     PARM '*KEY   ' @OPTN                           CFF007
     C                     PARM           SCCYR                           CFF007
     C           SDCURR    PARM SDCURR    DSSDY                           CFF007
      *                                                                   CFF007
     C           @RTCD     IFNE *BLANKS                                   CFF007
     C                     MOVE '1'       *IN37                           CFF007
     C                     ADD  1         EC                              CFF007
     C                     MOVEL' 404'    ERR,EC                          CFF007
     C                     ELSE                                           CFF007
     C                     MOVE CURR      SCCYR                           CFF007
     C                     MOVE CURR      CCYR                            CFF007
     C                     ENDIF                                          CFF007
      *                                                                   CFF007
     C                     ELSE                                           CFF007
     C                     CALL 'AOCTRYR0'                                CFF007
     C                     PARM *BLANKS   @RTCD                           CFF007
     C                     PARM '*KEY   ' @OPTN                           CFF007
     C                     PARM           SCRIK                           CFF007
     C           SDCTRY    PARM SDCTRY    @DSFDY                          CFF007
      *                                                                   CFF007
     C           @RTCD     IFNE *BLANKS                                   CFF007
     C                     MOVE '1'       *IN37                           CFF007
     C                     ADD  1         EC                              CFF007
     C                     MOVEL' 404'    ERR,EC                          CFF007
     C                     ELSE                                           CFF007
     C                     MOVE A4CTAY    SCCYR                           CFF007
     C                     MOVE A4CTAY    CCYR                            CFF007
     C                     ENDIF                                          CFF007
      *                                                                   CFF007
     C                     ENDIF                                          CFF007
      *                                                                   CFF007
      ** Validate Weighting Code                                          CFF007
      *                                                                   CFF007
     C           STWEI     IFNE *BLANKS                                   CFF007
     C                     MOVE STWEI     @WEIG   2                       CFF007
     C                     MOVEL'GP'      AOPGM  10                                           CGP001
     C                     MOVE 'AOWEIGR0'AOPGM                                               CGP001
     C**********           CALL 'AOWEIGR0'                                             CFF007 CGP001
     C                     CALL AOPGM                                                         CGP001
     C                     PARM *BLANKS   @RTCD                           CFF007
     C                     PARM '*KEY   ' @OPTN                           CFF007
     C                     PARM           @WEIG                           CFF007
     C********** SDWEIG    PARM SDWEIG    @DSFDY                                       CFF007 CGP001
     C           GPWEIG    PARM GPWEIG    @DSFDY                                              CGP001
      *                                                                   CFF007
     C           @RTCD     IFNE *BLANKS                                   CFF007
     C                     MOVE '1'       *IN38                           CFF007
     C                     ADD  1         EC                              CFF007
     C                     MOVEL' 405'    ERR,EC                          CFF007
     C                     ELSE                                           CFF007
     C                     MOVE PDWEIG    STWEI                           CFF007
     C                     MOVE PDWEIG    TWEI                            CFF007
     C                     ENDIF                                          CFF007
      *                                                                   CFF007
     C                     ELSE                                           CFF007
     C           BGSECS    IFEQ 'Y'                                       CFF007
      *                                                                   CFF007
     C           SUNSE     CHAINSECTY                99                   CFF007
      *                                                                   CFF007
     C           *IN99     IFEQ '0'                                       CFF007
     C                     MOVE WEIC      STWEI                           CFF007
     C                     MOVE WEIC      TWEI                            CFF007
     C                     ELSE                                           CFF007
     C                     MOVE '1'       *IN38                           CFF007
     C                     ADD  1         EC                              CFF007
     C                     MOVEL' 405'    ERR,EC                          CFF007
     C                     ENDIF                                          CFF007
      *                                                                   CFF007
     C                     ELSE                                           CFF007
     C                     MOVE '1'       *IN38                           CFF007
     C                     ADD  1         EC                              CFF007
     C                     MOVEL' 405'    ERR,EC                          CFF007
     C                     ENDIF                                          CFF007
      *                                                                   CFF007
     C                     ENDIF                                          CFF007
      *                                                                   CFF007
      ** If errors occured, highlight error band                          CFF007
      *                                                                   CFF007
     C           EC        IFNE *ZEROS                                    CFF007
     C                     MOVEAERR       ERRMSG                          CFF007
     C                     MOVELHI        ERRMSG                          CFF007
     C                     ENDIF                                          CFF007
      *                                                                   CFF007
      ** End of SRVLD2 S/R                                                CFF007
      *                                                                   CFF007
     C                     ENDSR                                          CFF007
     C********************************************************************CFF007
      /EJECT
     C********************************************************************
      **
      ** DEFLTS S/R TO FORMAT DEFAULT FIELD VALUES FOR INSERT SCREEN ETC
      ** CALLED FROM UPDATE; VALIDD
      ** CALLS NO OTHER S/R'S
      **
     C********************************************************************
     C           DEFLTS    BEGSR
     C*
      ** DEFAULTS FOR RECORD
     C*
      ** TICKS VALUE DEFAULTS TO 100
     C*
     C           STKDM     IFEQ *BLANK
     C                     MOVE '100'     STKDM
     C                     END
     C*
      ** PREMIUM UP FRONT DEFAULTS TO 'Y'
     C*
     C           SPUPF     IFEQ *BLANK
     C           SISPT     IFEQ '4'
     C           SISPT     OREQ '5'
     C           SISPT     OREQ '6'
     C                     MOVE 'Y'       SPUPF
     C                     END
     C                     END
     C*
     C*                                                                   FF0011
      ** The American/European option indicator defaults to 'A' for       FF0011
      ** American.                                                        FF0011
      *                                                                   FF0011
     C           SAEIN     IFEQ *BLANK                                    FF0011
     C           SISPT     IFEQ '4'                                       FF0011
     C           SISPT     OREQ '5'                                       FF0011
     C           SISPT     OREQ '6'                                       FF0011
     C                     MOVE 'A'       SAEIN                           FF0011
     C                     END                                            FF0011
     C                     END                                            FF0011
     C*                                                                   FF0011
     C                     ENDSR
     C*******************************************************************
      /EJECT
     C*******************************************************************
      **
      ** INITRC S/R TO INITIALISE ALL FILE FIELDS TO ZERO/BLANK
      ** CALLED FROM UPDATE; UPDFLS
      ** CALLS NO OTHER S/R'S
      **
     C*******************************************************************
     C*
     C           INITRC    BEGSR
     C*
      ** INITIALIZE ALL DATA ON RECORD DEFINED IN DETREC (KEY EXCLUDED)
     C*
     C                     MOVEL*BLANK    DETREC
     C                     Z-ADD*ZERO     ISPT
     C                     Z-ADD*ZERO     QOTC
     C                     Z-ADD*ZERO     TKDM
     C                     Z-ADD*ZERO     MNPF
     C                     Z-ADD*ZERO     TKVL
     C                     Z-ADD*ZERO     CCMC
     C                     Z-ADD*ZERO     CCMS
     C                     Z-ADD*ZERO     CCGP
     C                     Z-ADD*ZERO     CCGS
     C                     Z-ADD*ZERO     CTAM
     C                     Z-ADD*ZERO     ULPD
     C                     Z-ADD*ZERO     FTDT
     C                     Z-ADD*ZERO     SETD
     C                     Z-ADD*ZERO     SPDT
     C                     Z-ADD*ZERO     LCD
     C                     Z-ADD*ZERO     TNLU
     C                     Z-ADD*ZERO     CNTT                            E44655
     C                     Z-ADD*ZERO     ALPD                            S01393
     C*
      ** MKT/INSTR NUMERIC FIELDS
     C*
     C**********           Z-ADD*ZERO     DBRK                                                CSD027
     C                     MOVE *BLANKS   DBRK                                                CSD027
     C                     Z-ADD*ZERO     BCMC
     C                     Z-ADD*ZERO     BCMS
     C                     Z-ADD*ZERO     BCGP
     C                     Z-ADD*ZERO     BCGS
     C                     Z-ADD*ZERO     TFPD
     C                     Z-ADD*ZERO     FSPM
     C/COPY WNCPYSRC,FF0140C008
     C                     Z-ADD*ZERO     TWEI                            CFF007
     C*
     C                     ENDSR
     C********************************************************************
      /EJECT
     C********************************************************************
      **
      ** TRSFS S/R TO FORMAT RECORD FIELDS FOR SCREEN
      ** CALLED FROM UPDATE
      ** CALLS NO OTHER S/R'S
      **
     C********************************************************************
     C*
     C           TRSFS     BEGSR
     C*
      ** TRANSLATE RECORD DETAILS FROM FILE LAYOUT TO SCREEN LAYOUT
     C*
     C*
      ** ALPHA VALUES
     C*
      ** INSTRUMENT NAME
     C                     MOVELISTN      SISTN
     C*
      ** INSTRUMENT CURRENCY
     C                     MOVELISCY      SISCY
     C*
      ** OTHER CURRENCY
     C                     MOVELOTHC      SOTHC
     C*                                                                   073714
      ** COUNTER CURRENCY                                                 073714
     C                     MOVELCTCY      SCTCY                           073714
     C*
      ** PREMIUM UP FRONT
     C                     MOVELPUPF      SPUPF
     C*                                                                   FF0011
      ** AMERICAN/EUROPEAN OPTION INDICATOR                               FF0011
     C*                                                                   FF0011
     C                     MOVELAEIN      SAEIN                           FF0011
     C*
      ** STATUTORY RETURNS
     C                     MOVELSTRC      SSTRC
     C*
      ** PRICING REF
     C                     MOVELPRRF      SPRRF
     C*
      ** COMMODITY REF
     C                     MOVELCMRF      SCMRF
     C*
      ** CUSTOMER CHARGE COMMISSION PATTERN
     C                     MOVELCCPT      SCCPT
     C*                                                                   S01235
      ** INSTRUMENT TYPE (PORTFOLIO MGMT)                                 S01235
     C                     MOVELINNR      SINNR                           S01235
     C*
      ** TRANSLATE QUOTATION CONVENTION - SIGNED NUMERIC
      ** AS THIS IS A DIFFERENT LENGTH ON FILE/SCREEN, MUST BE BLANKED
     C*
     C                     MOVE *BLANK    SQOTC
     C           QOTC      IFGE 0
     C                     MOVE QOTC      SQOTC
     C                     ELSE
     C                     MOVEL'-'       SQOTC
     C           *LIKE     DEFN QOTC      WRKN1
     C                     Z-SUBQOTC      WRKN1
     C                     MOVE WRKN1     SQOTC
     C                     END
     C*
      ** BLANK IF ZERO
     C*
     C           QOTC      IFEQ 0
     C                     MOVE *BLANK    SQOTC
     C                     END
     C*
      ** INTEGER FIELDS - MANDATORY FILL
     C*
      ** INSTRUMENT PROCESSING TYPE
     C           ISPT      IFNE *ZERO
     C                     MOVELISPT      SISPT
     C                     ELSE
     C                     MOVEL*BLANK    SISPT
     C                     END
     C*
      ** CUSTOMER COMMISSION CODE
     C           CCMC      IFNE *ZERO
     C                     MOVELCCMC      SCCMC
     C                     ELSE
     C                     MOVEL*BLANK    SCCMC
     C                     END
     C*
      ** CUSTOMER COMMISSION CODE - SAME DAY
     C           CCMS      IFNE *ZERO
     C                     MOVELCCMS      SCCMS
     C                     ELSE
     C                     MOVEL*BLANK    SCCMS
     C                     END
     C*
      ** CUSTOMER CHARGE CODE - PURCHASES
     C           CCGP      IFNE *ZERO
     C                     MOVELCCGP      SCCGP
     C                     ELSE
     C                     MOVEL*BLANK    SCCGP
     C                     END
     C*
      ** CUSTOMER CHARGE CODE - SALES
     C           CCGS      IFNE *ZERO
     C                     MOVELCCGS      SCCGS
     C                     ELSE
     C                     MOVEL*BLANK    SCCGS
     C                     END
     C*
      ** NUMERIC FIELDS WITH DECIMAL PLACES; NON-MANDATORY FILL INTEGERS
     C*
     C*
      ** TICK DENOMINATOR
     C           TKDM      IFNE *ZERO
     C                     MOVE *BLANK    ZFIELD
     C                     Z-ADD0         ZADEC
     C                     Z-ADD3         ZADIG
     C                     MOVE TKDM      ZFIELD
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    STKDM
     C                     ELSE
     C                     MOVEL*BLANK    STKDM
     C                     END
      *                                                                   CFF006
      ** Move Fractional ticks processed indicator to screen field        CFF006
      *                                                                   CFF006
     C           CFF006    IFEQ 'Y'                                       CFF006
     C                     MOVE FRTK      SFRTK                           CFF006
     C                     ENDIF                                          CFF006
     C*
      ***UNDERLYING*PERIOD******                                          S01393
      ** P&L Amortisation Period                                          S01393
      **                                                                  S01393
     C           ULPD      IFNE *ZERO
     C                     MOVE *BLANK    ZFIELD
     C                     Z-ADD0         ZADEC
     C                     Z-ADD3         ZADIG
     C                     MOVE ULPD      ZFIELD
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    SULPD
     C                     ELSE
     C                     MOVEL*BLANK    SULPD
     C                     END
     C*
      ** Underlying Period                                                S01393
      **                                                                  S01393
     C           ALPD      IFNE *ZERO                                     S01393
     C                     MOVE *BLANK    ZFIELD                          S01393
     C                     Z-ADD0         ZADEC                           S01393
     C                     Z-ADD5         ZADIG                           S01393
     C                     MOVE ALPD      ZFIELD                          S01393
     C                     EXSR ZEDIT                                     S01393
     C                     MOVE ZFIELD    SALPD                           S01393
     C                     ELSE                                           S01393
     C                     MOVEL*BLANK    SALPD                           S01393
     C                     END                                            S01393
     C*                                                                   S01393
      ** MINIMUM PRICE FLUCTUATION
     C           MNPF      IFNE *ZERO
     C                     MOVE *BLANK    ZFIELD
     C/COPY WNCPYSRC,FF0140C001
     C***********          Z-ADD7         ZADEC                           CFF004
     C***********          Z-ADD4         ZADIG                           CFF004
     C/COPY WNCPYSRC,FF0140C002
     C                     Z-ADD8         ZADEC                           CFF004
     C                     Z-ADD7         ZADIG                           CFF004
     C                     MOVE MNPF      ZFIELD
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    SMNPF
     C                     ELSE
     C                     MOVEL*BLANK    SMNPF
     C                     END
     C*
      ** AMOUNT FIELDS
     C*
     C***ACCESS*TABLE*FILE*FOR*INSTRUMENT*CURRENCY*DECIMAL*POSITIONS******S01117
      ***DATABASE*ERROR*IF*NO*RECORD*FOUND**                       S01117 073714
      ***NO*DB*ERROR*FOR ACTION IS 'I' OR                          S01117 073714
      ***************FOR ACTION IS 'E' AND DELT IS NOT EQUAL TO BLAS01117 073714
      ***ACCESS OBJECT FOR INSTRUMENT CURRENCY DECIMAL POSITIONS   S01117 073714
     C***********                                                         073714
     C***********          MOVE ISCY      TCCY                            S01117
     C***********          Z-ADD0         CDP                             073714
     C***********CCYK      CHAINTABFF                99                   S01117
     C***********ACTN      IFNE 'I'                                S01117 073714
     C***********ACTN      IFNE 'E'                                S01117 073714
     C***********DELT      OREQ *BLANK                             S01117 073714
     C***********          CALL 'AOCURRR0'                         S01117 073714
     C***********          PARM '*DBERR'  @RTCD   7                S01117 073714
     C***********          PARM '*KEY   ' @OPTN   7                S01117 073714
     C***********          PARM ISCY      @AJCD   3                S01117 073714
     C***********SDCURR    PARM SDCURR    DSSDY                    S01117 073714
     C***********                                                         073714
      ***DATABASE*ERROR*IF*NO*RECORD*FOUND********************************S01117
      ***NO*DB*ERROR*FOR*INSERTS,*OR*IF*ACTION*IS*'E'*AND*DELT*SET*UP*****S01117
     C***********                                                         073714
     C***********ACTN      IFNE 'E'                                       S01117
     C***********DELT      ANDNE*BLANK                                    S01117
     C***********ACTN      ORNE 'I'                                       S01117
     C************IN99     IFEQ '1'                                       S01117
     C***********RECI      ORNE 'D'                                       S01117
     C***********@RTCD     IFNE *BLANKS                            S01117 FO0012
     C************LOCK     IN   LDA                                S01117 FO0012
     C***********          SETON                     U7U8                 FO0012
     C***********          MOVE 'TABFF'   DBFILE           ********S01117 FO0012
     C***********          MOVE 'SDCURRPD'DBFILE           ********S01117 FO0012
     C***********          Z-ADD2         DBASE            * DB ERROR 02 *FO0012
     C***********          MOVELISCY      DBKEY            ********S01117 FO0012
     C***********          MOVEL@OPTN     DBOPTN                   S01117 FO0012
     C***********          MOVELCCYK      DBKEY            ********S01117 FO0012
     C***********          OUT  LDA                                S01117 FO0012
     C***********          EXSR *PSSR                              S01117 FO0012
     C***********          GOTO XTTRSF                                    FO0012
     C***********          END                                            FO0012
     C***********          END                                            073714
     C***********                                                  S01117 073714
     C***********          END                                     S01117 073714
     C***********                                                  S01117 073714
     C***********          Z-ADDCDP       ICDP                            073714
     C***********                                                         073714
      ***ACCESS*TABLE*FILE*FOR*OTHER*CURRENCY*DECIMAL*POSITIONS***********S01117
      ***DATABASE*ERROR*IF*NO*RECORD*FOUND***                      S01117 073714
      ***NO*DB*ERROR FOR ACTION IS 'I' OR                          S01117 073714
      ***********    FOR ACTION IS 'E' AND DELT IS NOT EQUAL TO BLAS01117 073714
      ***ACCESS*OBJECT FOR OTHER CURRENCY DECIMAL POSITIONS        S01117 073714
     C***********                                                         073714
     C***********ISPT      IFEQ 2                                         073714
     C***********ISPT      OREQ 5                                         073714
     C***********          MOVE OTHC      TCCY                            S01117
     C***********          Z-ADD0         CDP                             073714
     C***********CCYK      CHAINTABFF                99                   S01117
     C***********ACTN      IFNE 'I'                                S01117 073714
     C***********ACTN      IFNE 'E'                                S01117 073714
     C***********DELT      OREQ *BLANK                             S01117 073714
     C***********          CALL 'AOCURRR0'                         S01117 073714
     C***********          PARM '*DBERR'  @RTCD   7                S01117 073714
     C***********          PARM '*KEY   ' @OPTN   7                S01117 073714
     C***********          PARM OTHC      @AJCD   3                S01117 073714
     C***********SDCURR    PARM SDCURR    DSSDY                    S01117 073714
     C***********                                                         073714
      ***DATABASE*ERROR*IF*NO*RECORD*FOUND********************************S01117
      ***NO*DB*ERROR*FOR*INSERTS,*OR*IF*ACTION*IS*'E'*AND*DELT*SET*UP*****S01117
     C***********                                                         073714
     C***********ACTN      IFNE 'E'                                       S01117
     C***********DELT      ANDNE*BLANK                                    S01117
     C***********ACTN      ORNE 'I'                                       S01117
     C************IN99     IFEQ '1'                                       S01117
     C***********RECI      ORNE 'D'                                       S01117
     C***********                                                         FO0012
     C***********@RTCD     IFNE *BLANKS                            S01117 FO0012
     C************LOCK     IN   LDA                                S01117 FO0012
     C***********          SETON                     U7U8                 FO0012
     C***********          MOVE 'TABFF'   DBFILE           ********S01117 FO0012
     C***********          MOVE 'SDCURRPD'DBFILE           ** *****S01117 FO0012
     C***********          Z-ADD3         DBASE            * DB ERROR 03 *FO0012
     C***********          MOVELOTHC      DBKEY            ********S01117 FO0012
     C***********          MOVEL@OPTN     DBOPTN                   S01117 FO0012
     C***********          MOVELCCYK      DBKEY            ********S01117 FO0012
     C***********          OUT  LDA                                S01117 FO0012
     C***********          EXSR *PSSR                              S01117 FO0012
     C***********          GOTO XTTRSF                                    FO0012
     C***********          END                                            FO0012
     C***********          END                                            073714
     C***********                                                  S01117 073714
     C***********          END                                     S01117 073714
     C***********                                                  S01117 073714
     C***********          Z-ADDCDP       OCDP                            073714
     C***********          END                                            073714
     C***********                                                         073714
      ***TICK*VALUE - DEPENDANT ON INSTRUMENT CCY                         073714
     C***********TKVL      IFNE *ZERO                                     073714
     C***********          MOVE *BLANK    ZFIELD                          073714
     C***********ICDP      ADD  5         ZADEC                           E16371
     C***********ICDP      ADD  2         ZADEC                     E16371E18188
     C***********ICDP      ADD  5         ZADEC                    E18188 073714
     C***********14        SUB  ZADEC     ZADIG                           073714
     C***********          MOVE TKVL      ZFIELD                          073714
     C***********          EXSR ZEDIT                                     073714
     C***********          MOVE ZFIELD    STKVL                           FO0006
     C***********          MOVELZFIELD    TKVLX  13                FO0006 073714
     C***********          MOVE *BLANK    STKVL                    FO0006 073714
     C***********          MOVE TKVLX     STKVL                    FO0006 073714
     C***********          ELSE                                           073714
     C***********          MOVEL*BLANK    STKVL                           073714
     C***********          END                                            073714
     C***********                                                         073714
      ***AMOUNTS*IN INSTRUMENT CURRENCY                                   073714
     C***********                                                         073714
     C***********          Z-ADDICDP      ZADEC                           073714
     C***********13        SUB  ICDP      ZADIG                           073714
     C***********                                                         073714
      ***CONTINGENT AMOUNT                                                073714
     C***********                                                         073714
      ***WILL*BE IN OTHER CURRENCY FOR PROCESSING TYPE 2&5                073714
     C***********                                                         073714
     C***********CTAM      IFNE 0                                         073714
     C***********ISPT      IFEQ 2                                         073714
     C***********ISPT      OREQ 5                                         073714
     C***********          Z-ADDOCDP      ZADEC                           073714
     C***********13        SUB  OCDP      ZADIG                           073714
     C***********          END                                            073714
     C***********                                                         073714
     C***********          MOVE *BLANK    ZFIELD                          073714
     C***********          MOVE CTAM      ZFIELD                          073714
     C***********          EXSR ZEDIT                                     073714
     C***********          MOVE ZFIELD    SCTAM                           073714
     C***********          ELSE                                           073714
     C***********          MOVE *BLANK    SCTAM                           073714
     C***********          END                                            073714
     C*                                                                   073714
      ** ACCESS TABLE FILE FOR INSTRUMENT CURRENCY DECIMAL PLACES         073714
     C*                                                                   073714
     C                     CALL 'AOCURRR0'                                073714
     C                     PARM '*DBERR'  @RTCD   7                       073714
     C                     PARM '*KEY   ' @OPTN   7                       073714
     C                     PARM ISCY      @AJCD   3                       073714
     C           SDCURR    PARM SDCURR    DSSDY                           073714
     C*                                                                   073714
      ** DATABASE ERROR IF NO RECORD FOUND                                073714
     C*                                                                   073714
     C           @RTCD     IFNE *BLANKS                                   073714
     C           ACTN      ANDNE'E'                                       073714
     C           *LOCK     IN   LDA                                       073714
     C                     SETON                     U7U8                 073714
     C                     MOVE 'SDCURRPD'DBFILE           ***************073714
     C                     Z-ADD02        DBASE            * DB ERROR 02 *073714
     C                     MOVELISCY      DBKEY            ***************073714
     C                     OUT  LDA                                       073714
     C                     EXSR *PSSR                                     073714
     C                     GOTO XTTRSF                                    073714
     C                     END                                            073714
     C                     Z-ADDCDP       ICDP                            073714
     C*                                                                   073714
      ** ACCESS TABLE FILE FOR OTHER CURRENCY DECIMAL POSITIONS           073714
     C** IF INSTRUMENT TYPE IS 2 OR 5                                     105750
     C*                                                                   073714
     C           ISPT      IFEQ 2                                         105750
     C           ISPT      OREQ 5                                         105750
     C                     CALL 'AOCURRR0'                                073714
     C                     PARM '*DBERR'  @RTCD   7                       073714
     C                     PARM '*KEY   ' @OPTN   7                       073714
     C                     PARM OTHC      @AJCD   3                       073714
     C           SDCURR    PARM SDCURR    DSSDY                           073714
     C*                                                                   073714
      ** DATABASE ERROR IF NO RECORD FOUND                                073714
     C*                                                                   073714
     C           @RTCD     IFNE *BLANKS                                   073714
     C           ACTN      ANDNE'E'                                       073714
     C           *LOCK     IN   LDA                                       073714
     C                     SETON                     U7U8                 073714
     C                     MOVE 'SDCURRPD'DBFILE           ***************073714
     C                     Z-ADD03        DBASE            * DB ERROR 03 *073714
     C                     MOVELOTHC      DBKEY            ***************073714
     C                     OUT  LDA                                       073714
     C                     EXSR *PSSR                                     073714
     C                     GOTO XTTRSF                                    073714
     C                     END                                            073714
     C                     Z-ADDCDP       OCDP                            073714
     C                     END                                            105750
     C*                                                                   073714
      ** ACCESS TABLE FILE FOR COUNTER CURRENCY DECIMAL POSITIONS         073714
     C*                                                                   073714
     C           ISPT      IFEQ 5                                         073714
     C                     CALL 'AOCURRR0'                                073714
     C                     PARM '*DBERR'  @RTCD                           073714
     C                     PARM '*KEY   ' @OPTN                           073714
     C                     PARM CTCY      @AJCD                           073714
     C           SDCURR    PARM SDCURR    DSSDY                           073714
     C*                                                                   073714
      ** DATABASE ERROR IF NO RECORD FOUND                                073714
     C*                                                                   073714
     C           @RTCD     IFNE *BLANKS                                   073714
     C           ACTN      ANDNE'E'                                       073714
     C           *LOCK     IN   LDA                                       073714
     C                     SETON                     U7U8                 073714
     C                     MOVE 'SDCURRPD'DBFILE           ***************073714
     C                     Z-ADD04        DBASE            * DB ERROR 04 *073714
     C                     MOVELCTCY      DBKEY            ***************073714
     C                     OUT  LDA                                       073714
     C                     EXSR *PSSR                                     073714
     C                     GOTO XTTRSF                                    073714
     C                     END                                            073714
     C                     END                                            073714
     C                     Z-ADDCDP       CCDP                            073714
     C*                                                                   073714
      ** CONTINGENT AMOUNT                                                073714
     C*                                                                   073714
     C           ISPT      IFEQ 5                                                             208490
     C                     Z-ADDOCDP      ZADEC                           073714
     C                     ELSE                                                               208490
     C                     Z-ADDICDP      ZADEC                                               208490
     C                     ENDIF                                                              208490
     C           13        SUB  OCDP      ZADIG                           073714
     C                     MOVE *BLANK    ZFIELD                          073714
     C                     MOVE CTAM      ZFIELD                          073714
     C                     EXSR ZEDIT                                     073714
     C                     MOVE ZFIELD    SCTAM                           073714
     C*                                                                   073714
      ** COUNTER AMOUNT                                                   073714
     C*                                                                   073714
     C           CCAM      IFNE 0                                         073714
     C                     Z-ADDCCDP      ZADEC                           073714
     C           13        SUB  CCDP      ZADIG                           073714
     C                     MOVE *BLANK    ZFIELD                          073714
     C                     MOVE CCAM      ZFIELD                          073714
     C                     EXSR ZEDIT                                     073714
     C                     MOVE ZFIELD    SCCAM                           073714
     C                     ELSE                                           073714
     C                     MOVE *BLANK    SCCAM                           073714
     C                     END                                            073714
     C*                                                                   073714
      ** TICK VALUE                                                       073714
     C*                                                                   073714
     C           ICDP      ADD  2         ZADEC                           073714
     C           10        SUB  ZADEC     ZADIG                           073714
     C                     Z-ADDTKVL      Z152   152H                     073714
     C                     MOVEL*BLANK    ZFIELD                          073714
     C                     MOVE Z152      ZFIELD                          073714
     C                     EXSR ZEDIT                                     073714
     C                     MOVE ZFIELD    STKVL                           073714
     C*
      ** DATE FIELDS
     C*
      ** FINAL TRANSACTION DATE
     C                     Z-ADDFTDT      ZDAYNO         99
     C           *IN,99    IFEQ '0'
     C                     EXSR ZDATE2
     C                     MOVELZDATE     SFTDT
     C                     ELSE
     C                     MOVEL*BLANK    SFTDT
     C                     END
     C*
      ** SETTLEMENT DATE
     C                     Z-ADDSETD      ZDAYNO         99
     C           *IN,99    IFEQ '0'
     C                     EXSR ZDATE2
     C                     MOVELZDATE     SSETD
     C                     ELSE
     C                     MOVEL*BLANK    SSETD
     C                     END
     C*
      ** SPOT MONTH DATE
     C                     Z-ADDSPDT      ZDAYNO         99
     C           *IN,99    IFEQ '0'
     C                     EXSR ZDATE2
     C                     MOVELZDATE     SSPDT
     C                     ELSE
     C                     MOVEL*BLANK    SSPDT
     C                     END
     C*                                                                   073714
      ** FINAL TRANSACTION TIME                                           073714
     C                     MOVELFTTM      SFTTM                           073714
     C/COPY WNCPYSRC,FF0140C009
     C*                                                                   CFF007
     C           CFF007    IFEQ 'Y'                                       CFF007
     C                     MOVE UNSE      SUNSE                           CFF007
     C                     MOVE TECO      STECO                           CFF007
     C                     MOVE TNAT      STNAT                           CFF007
     C                     MOVE CRIK      SCRIK                           CFF007
     C                     MOVE CCYR      SCCYR                           CFF007
     C*                                                                   CFF007
     C           TWEI      IFNE *ZERO                                     CFF007
     C                     MOVE TWEI      STWEI                           CFF007
     C                     ELSE                                           CFF007
     C                     MOVE *BLANK    STWEI                           CFF007
     C                     ENDIF                                          CFF007
     C*                                                                   CFF007
     C                     ENDIF                                          CFF007
     C*
     C           XTTRSF    ENDSR
     C********************************************************************
      /EJECT
     C********************************************************************
      **
      ** UPDFLS S/R TO UPDATE FILE RECORDS
      ** CALLED FROM UPDATE
      ** CALLS INITRC; ZTNLU1; INFSR
      **
     C           UPDFLS    BEGSR
     C*
      ** U P D A T E   F I L E S
     C*
      ** INITIALIZE ALL FIELDS ON THE RECORD (IE ZEROIZE/BLANK OUT)
     C*
     C                     EXSR INITRC
     C*
      ** RETRIEVE NEXT TRANSACTION NUMBER
     C*
     C                     EXSR ZTNLU1
     C*
      ** INITIALISE ERROR BAND
     C*
     C                     MOVEL*BLANK    INFMSG
     C*
      **               I  N  S  E  R  T  S
     C*
     C           ACTN      IFEQ 'I'
     C           INTP1K    CHAININTYPDF              60
     C*
      ** CHECK FOR INSERT OVER DELETED MARKET RECORD
     C*
     C           *IN60     IFEQ '1'
     C                     MOVE 'N'       ISTI
     C           INTP1K    CHAININTYPDF              60
     C                     MOVE 'Y'       ISTI
     C                     END
     C           TNLU      IFNE STNLU
     C                     EXSR UPDOWS
     C*
      ** IF NO PROCESSING OCCURRED EXIT TO SUPPRESS AUDIT UPDATE
     C*
     C                     GOTO XTUPDF
     C*
     C                     ELSE
     C*
      ** TRANSLATE RECORD DETAILS FROM SCREEN LAYOUT TO FILE LAYOUT
     C*
     C                     EXSR VALIDD
     C/COPY WNCPYSRC,FF0140C010
     C*                                                                   CFF007
     C           CFF007    IFEQ 'Y'                                       CFF007
     C           BGN4ST    ANDEQ'Y'                                       CFF007
     C                     EXSR SRVLD2                                    CFF007
     C                     ENDIF                                          CFF007
     C*                                                                   CFF007
     C                     MOVEL'D'       RECI
     C                     Z-ADDRUND      LCD
     C                     MOVEL'I'       CHTP
     C                     MOVELNATN      TNLU
     C                     END
     C   60                WRITEINTYPDF                16
     C*
      ** TEST FOR UPDATE BY ANOTHER W/S, OR A TERMINAL ERROR
     C*
     C           *IN16     IFEQ '1'
     C           STATUS    ANDEQ01021
     C           INTP1K    CHAININTYP1X              16
     C*
     C           *IN16     IFEQ '0'
     C                     EXSR UPDOWS
     C                     GOTO XTUPDF
     C                     END
     C                     END
     C*
     C           *IN16     IFEQ '1'
     C                     EXSR INFSR
     C                     END
     C  N60                UPDATINTYPDF
     C                     END
     C*
      **               A  M  E  N  D  S
     C*
     C           ACTN      IFEQ 'A'
     C           INTP1K    CHAININTYPDF              60
     C           TNLU      IFNE STNLU
     C                     EXSR UPDOWS
     C*
      ** IF NO PROCESSING OCCURRED EXIT TO SUPPRESS AUDIT UPDATE
     C*
     C                     GOTO XTUPDF
     C*
     C                     ELSE
     C*
     C* TRANSLATE RECORD DETAILS FROM SCREEN LAYOUT TO FILE LAYOUT
     C*
     C                     EXSR VALIDD
     C/COPY WNCPYSRC,FF0140C011
     C*                                                                   CFF007
     C           CFF007    IFEQ 'Y'                                       CFF007
     C           BGN4ST    ANDEQ'Y'                                       CFF007
     C                     EXSR SRVLD2                                    CFF007
     C                     ENDIF                                          CFF007
     C*                                                                   CFF007
     C                     Z-ADDRUND      LCD
     C                     MOVEL'A'       CHTP
     C                     MOVELNATN      TNLU
     C                     END
     C  N60                UPDATINTYPDF
     C                     END
     C*
      **               D  E  L  E  T  E  S
     C*
     C           ACTN      IFEQ 'D'
     C           INTP1K    CHAININTYPDF              60
     C           TNLU      IFNE STNLU
     C                     EXSR UPDOWS
     C*
      ** IF NO PROCESSING OCCURRED EXIT TO SUPPRESS AUDIT UPDATE
     C*
     C                     GOTO XTUPDF
     C*
     C                     ELSE
     C                     MOVEL'*'       RECI
     C                     Z-ADDRUND      LCD
     C                     MOVEL'D'       CHTP
     C                     MOVELNATN      TNLU
     C                     END
     C  N60                UPDATINTYPDF
     C                     END
     C*
      ** GET AUDIT RECORD
     C*
     C           1         CHAININTYPAF              99
     C*
      ** UPDATE AUDIT RECORD IF FOUND
     C*
     C           *IN99     IFEQ '0'
     C*
      ** FOR INSERT, UPDATE LIVE RECORDS INSERTED TODAY, AND NO. OF LIVE
      ** RECORDS
     C*
     C           ACTN      IFEQ 'I'
     C                     ADD  1         NINS
     C                     ADD  1         NORE
     C                     END
     C*
      ** FOR AMENDS, UPDATE NO. OF RECORDS AMENDED TODAY
     C*
     C           ACTN      IFEQ 'A'
     C                     ADD  1         NAMD
     C                     END
     C*
      ** FOR DELETIONS, UPDATE NO. DELETIONS TODAY, AND NO. OF LIVE RECS
     C*
     C           ACTN      IFEQ 'D'
     C                     ADD  1         NDEL
     C                     SUB  1         NORE
     C                     END
     C*
      ** FORMAT COMIT TEXT
     C                     TIME           MTIME
     C                     MOVELACTN      ACTNX
     C                     MOVEASCRCTL    DET,01
     C                     MOVEADETS      DET,08
     C*
      ** UPDATE AUDIT RECORD
     C*
     C                     UPDATINTYPAF
     C*
      ** C  O  M  I  T
     C*
     C           CMTTXT    COMIT
     C*
      ** AUDIT RECORD NOT FOUND: DATABASE ERROR
     C*
     C                     ELSE
     C*
     C           *LOCK     IN   LDA                                       S01117
     C                     SETON                     U7U8  ***************
     C                     Z-ADD4         DBASE            * DB ERROR 04 *
     C                     MOVEL'INTYP'   DBFILE           ***************
     C                     MOVEL'AUDIT'   DBKEY
     C                     OUT  LDA                                       S01117
     C                     EXSR *PSSR                                     S01117
     C                     RETRN                                          S01117
     C                     END
     C*
     C           XTUPDF    ENDSR
     C*
      ********************************************************************
      /EJECT
      ********************************************************************
      **
      ** UPDOWS S/R TO PROCESS UPDATE BY ANOTHER WORKSTATION
      ** CALLED FROM UPDFLS
      ** CALLS NO OTHER S/R'S
      **
     C           UPDOWS    BEGSR
      **
     C                     ROLBK
      **
      **   SET UP NEXT SCREEN TO BE DISPLAYED:
      **   IF RECORD IS LIVE, ALLOW AMEND PROCESSING;
      **
     C           RECI      IFEQ 'D'
     C                     MOVEL'A'       ACTN
     C                     ELSE
      **
      **   IF RECORD HAS BEEN DELETED, ALLOW ENQUIRY
      **
     C                     MOVEL'E'       ACTN
     C                     END
      **
      **   SET SCREEN PROCESSOR TO UPDATE AND MOVE UPDATE MESSAGE TO ERROR
      **
     C                     MOVEA'001'     *IN,10
     C                     MOVELINF,11    INFMSG
      **
     C                     ENDSR
      **
      ********************************************************************
      *                                                               *                       CER001
      * SRLUX - LUX OTC's Maintenance Screen                          *                       CER001
      *                                                               *                       CER001
      *****************************************************************                       CER001
      *                                                                                       CER001
     C           SRLUX     BEGSR                                                              CER001
      *                                                                                       CER001
     C           ULX004    IFEQ 'Y'                                                           CER001
     C                     CALL 'FF0141'                                                      CER001
     C                     PARM *BLANKS   RTNCD   7                                           CER001
     C                     PARM           ACTN                                                CER001
     C                     PARM           ISTT                                                CER001
     C                     PARM           W0RTN   7                                           CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
     C                     MOVE 'Y'       W#EXIT  1                                           CER001
     C                     SELEC                                                              CER001
      *                                                                                       CER001
      ** F12 pressed from previous screen                                                     CER001
      *                                                                                       CER001
     C           W0RTN     WHEQ 'USR0790'                                                     CER001
     C                     MOVE *OFF      *IN12                                               CER001
      *                                                                                       CER001
      ** F3 pressed from previous screen                                                      CER001
      *                                                                                       CER001
     C           W0RTN     WHEQ 'Y2U9999'                                                     CER001
     C                     MOVE *ON       *IN12                                               CER001
     C                     MOVE '01'      AID                                                 CER001
     C                     MOVE *OFF      *INKC                                               CER001
      *                                                                                       CER001
      ** ENTER key pressed from previous screen                                               CER001
      *                                                                                       CER001
     C                     OTHER                                                              CER001
     C                     MOVE 'N'       W#EXIT                                              CER001
     C                     ENDSL                                                              CER001
      *                                                                                       CER001
     C                     ENDSR                                                              CER001
      *                                                                                       CER001
      *****************************************************************                       CER001
      /EJECT
     C*                                                                   S01408
     C/COPY WNCPYSRC,FF0140CCP4                                           S01408
     C*                                                                   S01408
     C** ZALIGN SUBROUTINE
     C/COPY ZSRSRC,ZALIGNZ2
     C*
      /EJECT
     C** ZEDIT SUBROUTINE
     C/COPY ZSRSRC,ZEDITZ2
     C*
     C/EJECT
     C** ZTNLU1 SUBROUTINE
     C/COPY ZSRSRC,ZTNLU1Z2
     C*
     C/EJECT
     C** ZDATE1 SUBROUTINE
     C/COPY ZSRSRC,ZDATE1Z2
     C*
     C/EJECT
     C** ZDATE2 SUBROUTINE
     C/COPY ZSRSRC,ZDATE2Z2
     C*
     C/EJECT
     C***ZDATE5*SUBROUTINE*********************************************   S01195
     C*COPY*ZSRSRC,ZDATE5Z2********************************************   S01195
     C***ZACCH**SUBROUTINE                                         S01195 073714
     C*COPY*ZSRSRC,ZACCH**                                         S01195 073714
     C********************                                         S01195 073714
     C*EJECT**************                                         S01195 073714
     C***ZCHKH**SUBROUTINE                                         S01195 073714
     C*COPY*ZSRSRC,ZCHKH**                                         S01195 073714
     C********************                                                073714
     C*EJECT**************                                                073714
      *****************************************************************
      **
      **   FILE EXEPTION/ERROR HANDLING SUBROUTINE
      **
     C           INFSR     BEGSR
      **
      ** ROLL BACK CHANGES AND CALCEL PROGRAM
      **
     C                     ROLBK
     C                     MOVE '*CANCL'  EXTTAG  6
      **
     C                     ENDSREXTTAG
      ********************************************************************
      /EJECT                                                              S01117
      *****************************************************************   S01117
      **                                                                  S01117
      ** *PSSR --- SUBROUTINE TO HANDLE ABNORMAL ERROR CONDITIONS         S01117
      ** CALLED FROM: AFTER ABNORMAL OPERATION OCCURS                     S01117
      ** CALLS: NOTHING                                                   S01117
      **                                                                  S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C           *PSSR     BEGSR                           ** *PSSR **    S01117
     C*                                                                   S01117
     C           @RUN      IFEQ *BLANKS                                   S01117
     C                     MOVE 'Y'       @RUN    1                       S01117
     C                     DUMP                                           S01117
     C                     END                                            S01117
     C                     ENDSR                           ** *PSSR **    S01117
     C*                                                                   S01117
     C********************************************************************S01117
     C** POWER9 ARRAY REMOVED                                      FO0007 073714
      * /104633/ Change
      * INF,6  DELETION F3:F10 to delete this record:F12:Rollup:Rolldown:help
      * INF,9  F10 is reqiured
      * INF,10 F10 is not reqiured
     C/COPY WNCPYSRC,FF0140C012
      *                                                                   CFF007
      ** INF,14 F12 Taken - Update Cancelled                              CFF007
      *                                                                   CFF007
      *                                                                                       CER001
      ** INF,1 Remove action code 'I' from the selection                                      CER001
      *                                                                                       CER001
**  CPY@
(c) Finastra International Limited 2001
** INF - SCREEN FF0140F2 OUTPUT
 Enter:Action Code A,D,E and selection:Review from point;F3;Help                              CER001
 Enter:Review from point;Action Code A,D,E;F3;F12;Rollup;Rolldown;     Help
 INSERTION Enter:F3:F12:Help
 AMENDMENT Enter:F3:F12:Rollup:Rolldown:Help
 ENQUIRY Enter:F3:F12:Rollup:Rolldown:Help
 DELETION F3:F10=Delete record:F12:Rollup:Rolldown:Help
 Rollup is not possible
 Rolldown is not possible
 F10=Confirm
 
 Record has been updated by another workstation
 No Records Found: Enter Review from point; F12; F3; Help
 LINKED ENQUIRY Enter:F3:F12:Help                                         S01393
 F12 Taken - Update Cancelled                                             CFF007
     X/COPY WNCPYSRC,FF0140X001
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
