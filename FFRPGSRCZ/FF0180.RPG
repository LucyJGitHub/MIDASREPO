     H        1
      *****************************************************************
/*OVR *  OVRDBF FILE(GZSDBANK) TOFILE(GZSDBANKL2)                     *                       CSD031
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas FF Account Keys Maintenance')
/*OVRF*: OVRDBF FACKYX FACKY                                        : *
     F********************************************************************
     F*                                                                  *
     F*  Midas  -  Futures and Options Module
     F*                                                                  *
     F*   FF0180  -  FO ACCOUNT KEYS                                     *
     F*                                                                  *
      *  (c) Finastra International Limited 2001                      *
     F*                                                                  *
      *  Last Amend No. MD058769           Date 21Sep21               *
      *  Prev Amend No. MD046248           Date 27Oct17               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 BUG12272           Date 25Oct06               *
      *                 BUG11812           Date 04Aug06               *
      *                 BUG11811           Date 31Jul06               *
      *                 BUG11802           Date 30Jul06               *
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CAAA03             Date 10Mar04               *
      *                 CGL029             Date 01Sep03               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.02 -----------------------------------------------*
      *                 128512             Date 12Oct99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 CSD005             Date 01Mar99               *
      *                 CTI002 Exposure Management / TI Interface     *
     F*                  104633             DATE 08JUL96              *
     F*                  S01408             DATE 09JAN96                 *
     F*                  E23097             DATE 12SEP90                 *
     F*                  E22049             DATE 11MAY90                 *
     F*                  S01199             DATE 27FEB90                 *
     F*                  S01117             DATE 16JAN90                 *
     F*                  S01179             DATE 23/09/88                *
     F*                                                                  *
     F*------------------------------------------------------------------*
     F*                                                                  *
      *  MD058769 - Deliverable Data Split for SDNARRPD and TABLETP   *
      *  MD046248 - Finastra Rebranding                               *
      *  BUG12272 - Record not updated when accepting amendment       *
      *  BUG11812 - Action Code & Account Key are not displayed in    *
      *             the input screen (Recompile)                      *
      *  BUG11811 - Input field is protected after accepting          *
      *             deletion in zonal acceptance screen               *
      *  BUG11802 - Error message appear when rejecting a record        *
      *  CSD031 - Enhanced Centralised Static Data                    *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CAAA03 - Initial Screen is not disaplyed properly.           *
      *  CGL029 - Increase Account Code to 10 digits                  *
     F*  128512 - FF Account Keys can be deleted even if the System   *
     F*           Set Up Flag (SSF) is set on.  Allow deletion only   *
     F*           if SSF is switched off.                             *
      *  CSD005 - Standing Data Account Narrative.  Add new field     *
      *           to SDACODPD.  Recompilation of programs.            *
      *  CTI002 - Recompiled : File SDACODPD changed                  *
     A*  104633 - GUI Amendments to DSPF with non-standard footers    *
     F*   S01408 -   Addition of core hooks FF0180FFP1
     F*                                     FF0180IIP1
     F*                                     FF0180CCP1
     F*                                     FF0180CCP2
     F*                                     FF0180CCP3
     F*                                     FF0180CCP4
     F*   E23097  -  FF NARRATIVE CODES FA TO FO NOW HELD ON TABLETP.    *
     F*              PROGRAM ALSO AMENDED DUE TO CHANGE OF NARRATIVE CODE*
     F*   E22049  -  SIMPLIFY ERROR CODES AND HELP TEXT                  *
     F*   S01199  -  HELP SYSTEM                                     *
     F*   S01117  -  MULTIBRANCHING                                      *
     F*   101179      ****** AS400 CONVERSION ******                     *
     F*     The keyword RTGAID is no longer supported on the AS400       *
     F*     and command keys and indicators have been used to replace    *
     F*     this in the display file. To disrupt the structure of the    *
     F*     program as little as possible a new subroutine - ASCHGS -    *
     F*     has been coded. This moves the values which would have       *
     F*     been passed to the program (via RTGAID) into the AID         *
     F*     field depending on which function key has been pressed.      *
     F*                                                                  *
     F*------------------------------------------------------------------*
     F*     CREATION REQUIREMENTS                                        *
     F*                                                                  *
     F*     IGNDECERR(*NO)                                               *
     F*     OVRDBF     FILE(FACKYX) TOFILE(FACKY)                        *
     F*                                                                  *
     F********************************************************************
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
     FFF0180DFCF  E                    WORKSTN      KINFDS SCRDS
     F                                        RRN   KSFILE FF0180S0
     FFACKY   UF  E           K        DISK         KCOMIT       A
     F                                              KINFDS INFDS
     F                                              KINFSR INFSR
     FFACKYX  IF  E           K        DISK
     F            FACKYDF                           KRENAMEFACKYDFX
     FFACKYA  UF  E                    DISK         KCOMIT
     FGPFAKYL0UF  E           K        DISK         KCOMIT       A                            CSD031
     F            FACKYDF                           KRENAMEGPFFAKLF                           CSD031
     F                                              KINFDS INFD2                              CSD031
     F                                              KINFSR INFS2                              CSD031
     FGPFAKYL1IF  E           K        DISK                                                   CSD031
     F            FACKYDF                           KRENAMEGPFFAKLX                           CSD031
     FSDAFAKL0UF  E           K        DISK         KCOMIT                                    CSD031
     F            FACKYDF                           KRENAMESDAFAKLF                           CSD031
     F                                              KINFDS INFD1                              CSD031
     F                                              KINFSR INFS1                              CSD031
     FSDAFAKL1IF  E           K        DISK                                                   CSD031
     F            FACKYDF                           KRENAMESDAFAKLX                           CSD031
     F*GPNARRL0IF E           K        DISK                                          CSD031 MD058769
      ** Global narratives                                                                    CSD031
      *                                                                                       CSD031
     FGPZONEL0IF  E           K        DISK                                                   CSD031
      ** Zone                                                                                 CSD031
     FGZSDBANKIF  E           K        DISK                           UC                      CSD031
      ** Bank                                                                                 CSD031
     F*SDNARRL0IF  E           K        DISK                                       BUG12272 MD058769
      ** Zonal narratives                                                                   BUG12272
      *                                                                                     BUG12272
     F*ABFF***IF* E           K        DISK                               S01117
     F**ICD****** TABTB10F                          KIGNORE               S01117
     F*********** TABTB11F                          KIGNORE               S01117
     F*********** TABTB20F                          KIGNORE               S01117
     F*********** TABTB40F                          KIGNORE               S01117
     F*********** TABTB80F                          KIGNORE               S01117
     F**A/C*CODES TABTE10F                          KIGNORE               S01117
     F*********** TABTG10F                          KIGNORE               S01117
     F*********** TABLETHF                          KIGNORE               S01117
     F*********** TABLETLF                          KIGNORE               S01117
     F*********** TABLETRF                          KIGNORE               S01117
     F*********** TABLET2F                          KIGNORE               S01117
     F*TABLETP IF  E           K        DISK                                                MD059769
     F*                                                                   S01408
     F/COPY WNCPYSRC,FF0180FFP1                                           S01408
     F*                                                                   S01408
     F*FILE SPECIFICATIONS*********************************************
     F*
     F* ID F  C  H  L    FUNCTION OF INDICATORS
     F*
     F*       01         S/FF0180C0  SFLDSP
     F*       02         S/FF0180C0  SFLDSPCTL
     F*       03         S/FF0180C0  SFLEND
     F*       04         S/FF0180C0  ROLLDOWN NOT ALLOWED
     F*       05         S/FF0180F1  PROTECT/NON-DISPLAY ON LOCATION
     F*       06         S/FF0180F0  PROTECT FIELDS
     F*
     F*       10         START  SCREEN
     F*       11         REVIEW SCREEN
     F*       12         UPDATE SCREEN
     F*
     F*       15         INDICATOR USED ON WRITE/UPDATE OPS TO CONDITION
     F*                                    CALL OF INFSR
     F*       20         S/FF0180C0 NON DISPLAY FIELD -Action                                 CSD031
     F*
     F*       21         S/FF0180F1  ERROR-ACTN
     F*       22         S/FF0180F1  ERROR-FFKY
     F*
     F*       23         S/FF0180F2  DISABLE COMMAND 4/5
     F*
     F*       25         SET ON WHEN LOKUP OPERATION TO TABLE SUCCEDES
     F*
     F*       26         CHAIN TO TABLE FILES UNSUCCESSFUL WHEN ON
     F*
     F*       28         S/FF0180F1 NON DISPLAY FIELD                                         CSD031
     F*       29         S/FF0180F1 PROTECT FIELD                                             CSD031
     F*       30         S/FF0180F0  POSITION CURSOR
     F*
     F*       50         ROLLUP                                           S01179
     F*       51         ROLLDOWN                                         S01179
     F********52*        HELP                                      S01179 S01199
     F*                                                                   S01179
     F*       55         VLDCMDKY INDICATOR FOR DISPLAY FILE              S01179
     F*                                                                   S01179
     F*       57         ERROR INDICATOR - CODE 203/204/205                                   CSD031
     F*       58         S/FF0180F1 REVERSE IMAGE                                             CSD031
     F*       59         S/FF0180F1 REVERSE IMAGE                                             CSD031
     F*       60         ADD RECORD
     F*
     F*       82         S/FF0180F0 NON DISPLAY FIELD                                         CSD031
     F*       83         S/FF0180C0 NON DISPLAY FIELD -Effective Date                         CSD031
     F*       98         DATF = MMDDYY
     F*       99         WORK
     F*
     F*       U7         DATABASE ERROR
     F*       U8         PROGRAM  ERROR
     F*       U1         CENTRAL/ZONAL MODE                                                   CSD031
     F*
     F*       'AID' VALUES USED
     F*
     F*       01         CA3                                              S01179
     F*       04         CA10                                             S01179
     F*       05         CA12                                             S01179
     F*       06         CA11                                                                 CSD031
     F*       RA         ENTER PRESSED
     F*       UP         ROLLUP
     F*       DN         ROLLDOWN
     F*       HP         HELP PRESSED
     E                    CPY@    1   1 80
     E*EXTENSION SPECIFICATIONS****************************************
     E*
     E                    DET       256  1
     E*
     E                    ERR        19  4
     E**********          INF     1  11 76                                                    CSD031
     E                    INF     1  17 80                                                    CSD031
     E********************TABNRC*15**15**2                                E23097
      ***Table*of*valid*characters*that*constitute*the*narrative*code     E23097
      *
     E                    TABACD 37  37  1
      *
      ** Table of valid characters that constitute the account key code
      *
     E                    AR         14  1
      *                                                                                       CSD031
      **Table of Screen Title                                                                 CSD031
      *                                                                                       CSD031
     E                    TITL    1   9 40                                                    CSD031
     E/COPY WNCPYSRC,FF0180E001
      *                                                                                       CSD031
     I              'XLIB/SDCSNDDTQ'      C         PGMB                                      CSD031
      *
      ** Array to hold the account key code for validation purposes
      *
     ISCRCTL      DS
     I*
     I** KEY FIELDS (TAKEN FROM 'KEY' PORTION OF SCREEN)
     I*
     I                                        1   1 REVW
     I                                        2   2 ACTN
     I                                        3 016 INPK
     I                                        3 016 FFKY
     I                                      017 030 PAGK
     I**********                            017 030 PFFKY                                     CSD031
     I*
     IDETREC    E DSFACKYD
     I*
     I** DATA STRUCTURE FOR INITIALISING A RECORD
     I*
     I              FFKY                            FFKYX
     I*
     I*DETS******E DSFF0180DF                                             S01179
     IDETS        DS                                                      S01179
     I*
     I** DATA STRUCTURE FOR SCREEN DETAIL OUTPUT TO CMTTXT
     I                                        1  10 SACD1                                     CGL029
     I                                       11  12 SNRC1                                     CGL029
     I                                       13  13 SPRF1                                     CGL029
     I                                       14  23 SACD2                                     CGL029
     I                                       24  25 SNRC2                                     CGL029
     I                                       26  26 SPRF2                                     CGL029
     I                                       27  36 SACD3                                     CGL029
     I                                       37  38 SNRC3                                     CGL029
     I                                       39  39 SPRF3                                     CGL029
     I                                       40  49 SACD4                                     CGL029
     I                                       50  51 SNRC4                                     CGL029
     I                                       52  52 SPRF4                                     CGL029
     I                                       53  62 SACD5                                     CGL029
     I                                       63  64 SNRC5                                     CGL029
     I                                       65  65 SPRF5                                     CGL029
     I                                       66  75 SACD6                                     CGL029
     I                                       76  77 SNRC6                                     CGL029
     I                                       78  78 SPRF6                                     CGL029
     I**********                              1   4 SACD1                              S01179 CGL029
     I**********                              5   6 SNRC1                              S01179 CGL029
     I**********                              7   7 SPRF1                              S01179 CGL029
     I**********                              8  11 SACD2                              S01179 CGL029
     I**********                             12  13 SNRC2                              S01179 CGL029
     I**********                             14  14 SPRF2                              S01179 CGL029
     I**********                             15  18 SACD3                              S01179 CGL029
     I**********                             19  20 SNRC3                              S01179 CGL029
     I**********                             21  21 SPRF3                              S01179 CGL029
     I**********                             22  25 SACD4                              S01179 CGL029
     I**********                             26  27 SNRC4                              S01179 CGL029
     I**********                             28  28 SPRF4                              S01179 CGL029
     I**********                             29  32 SACD5                              S01179 CGL029
     I**********                             33  34 SNRC5                              S01179 CGL029
     I**********                             35  35 SPRF5                              S01179 CGL029
     I**********                             36  39 SACD6                              S01179 CGL029
     I**********                             40  41 SNRC6                              S01179 CGL029
     I**********                             42  42 SPRF6                              S01179 CGL029
     I                                       79  79 SAACC                                     CSD031
     I                                       80  84 SEACC                                     CSD031
     I                                       85  85 SGPDT                                     CSD031
     I@1DBRC    E DSGPFAKYL0                                                                  CSD031
     I              RECI                            W01                                       CSD031
     I              FFKY                            W02                                       CSD031
     I              ZZ002                           W03                                       CSD031
     I              ACD1QQ                          W04                                       CSD031
     I              ACD2QQ                          W05                                       CSD031
     I              ACD3QQ                          W06                                       CSD031
     I              ACD4QQ                          W07                                       CSD031
     I              ACD5QQ                          W08                                       CSD031
     I              ACD6QQ                          W09                                       CSD031
     I              NRC1                            W010                                      CSD031
     I              NRC2                            W011                                      CSD031
     I              NRC3                            W012                                      CSD031
     I              NRC4                            W013                                      CSD031
     I              NRC5                            W014                                      CSD031
     I              NRC6                            W015                                      CSD031
     I              PRF1                            W016                                      CSD031
     I              PRF2                            W017                                      CSD031
     I              PRF3                            W018                                      CSD031
     I              PRF4                            W019                                      CSD031
     I              PRF5                            W020                                      CSD031
     I              PRF6                            W021                                      CSD031
     I              ZZ034                           W022                                      CSD031
     I              LCD                             W023                                      CSD031
     I              CHTP                            W024                                      CSD031
     I              TNLU                            W025                                      CSD031
     I              ACD1                            W026                                      CSD031
     I              ACD2                            W027                                      CSD031
     I              ACD3                            W028                                      CSD031
     I              ACD4                            W029                                      CSD031
     I              ACD5                            W030                                      CSD031
     I              ACD6                            W031                                      CSD031
     I              ZONE                            W032                                      CSD031
     I              IUSR                            W033                                      CSD031
     I              AUSR                            W034                                      CSD031
     I              XUSR                            W035                                      CSD031
     I              AACC                            W036                                      CSD031
     I              EACC                            W037                                      CSD031
     I              GPDT                            W038                                      CSD031
     I@2DBRC    E DSSDAFAKL0                                                                  CSD031
     I              RECI                            WRECI                                     CSD031
     I              FFKY                            WFFKY                                     CSD031
     I              ZZ002                           WZZ002                                    CSD031
     I              ACD1QQ                          WACD1Q                                    CSD031
     I              ACD2QQ                          WACD2Q                                    CSD031
     I              ACD3QQ                          WACD3Q                                    CSD031
     I              ACD4QQ                          WACD4Q                                    CSD031
     I              ACD5QQ                          WACD5Q                                    CSD031
     I              ACD6QQ                          WACD6Q                                    CSD031
     I              NRC1                            WNRC1                                     CSD031
     I              NRC2                            WNRC2                                     CSD031
     I              NRC3                            WNRC3                                     CSD031
     I              NRC4                            WNRC4                                     CSD031
     I              NRC5                            WNRC5                                     CSD031
     I              NRC6                            WNRC6                                     CSD031
     I              PRF1                            WPRF1                                     CSD031
     I              PRF2                            WPRF2                                     CSD031
     I              PRF3                            WPRF3                                     CSD031
     I              PRF4                            WPRF4                                     CSD031
     I              PRF5                            WPRF5                                     CSD031
     I              PRF6                            WPRF6                                     CSD031
     I              ZZ034                           WZZ034                                    CSD031
     I              LCD                             WLCD                                      CSD031
     I              CHTP                            WCHTP                                     CSD031
     I              TNLU                            WTNLU                                     CSD031
     I              ACD1                            WACD1                                     CSD031
     I              ACD2                            WACD2                                     CSD031
     I              ACD3                            WACD3                                     CSD031
     I              ACD4                            WACD4                                     CSD031
     I              ACD5                            WACD5                                     CSD031
     I              ACD6                            WACD6                                     CSD031
     I              ZONE                            WZONE                                     CSD031
     I              IUSR                            WIUSR                                     CSD031
     I              AUSR                            WAUSR                                     CSD031
     I              XUSR                            WXUSR                                     CSD031
     I              AACC                            WAACC                                     CSD031
     I              EACC                            WEACC                                     CSD031
     I              GPDT                            WGPDT                                     CSD031
     I/COPY WNCPYSRC,FF0180I001
     I*
     I*INPUT SPECIFICATIONS (DATA STRUCTURES)**************************
     ISCRMSG      DS                          1 152
     I*
     I** DATA STRUCTURE FOR ERROR MESSAGES TO SCREEN
     I*
     I                                        1  76 ERR
     I                                        1  76 ERRMSG
     I                                       77 152 INFMSG
     I*
     ISCRDS       DS
     I*
     I** DISPLAY FORMAT STATUS DATA STRUCTURE
     I*
     I                                      287 288 AID
     IINFDS       DS
     IINFD1       DS                                                                          CSD031
     IINFD2       DS                                                                          CSD031
     I*
     I** DATA STRUCTURE FOR RPG 01021 ERROR HANDLING
     I*
     I                                     *STATUS  STATUS
     I*
     I*DA********UDS                            256                       S01117
     ILDA         DS                            256                       S01117
     I*
     I** LOCAL DATA AREA FOR DATABASE ERROR DETAILS
     I*
      ** Data queue parameters                                                                CSD031
      *                                                                                       CSD031
     IPDQMSG      DS                           4040                                           CSD031
     I                                        1  10 PDFILE                                    CSD031
     I                                       11  12 PRANGE                                    CSD031
     I                                       13  40 PBLANK                                    CSD031
     I                                       41 256 PDDATA                                    CSD031
     IWDATE       DS                                                                          CSD031
     I                                        1   20WMM                                       CSD031
     I                                        3   40WDD                                       CSD031
     I                                        5   60WYY                                       CSD031
     I#WDATE      DS                                                                          CSD031
     I                                        1   20#DD                                       CSD031
     I                                        3   40#MM                                       CSD031
     I                                        5   60#YY                                       CSD031
     I***********                           134 177 DBLOT                 S01117
     I***********                           134 138 DBFILE                S01117
     I***********                           139 167 DBKEY                 S01117
     I***********                           168 175 DBPGM                 S01117
     I***********                           176 177 DBASE                 S01117
     I                                      134 141 DBFILE                S01117
     I                                      142 170 DBKEY                 S01117
     I                                      171 180 DBPGM                 S01117
     I                                      181 1830DBASE                 S01117
     I*
     IDNATN       DS                              5
     I*
     I** DATA STRUCTURE CONTAINING NEXT AVALABLE TRANSACTION NUMBER
     I*
     I                                        1   50FNATN
     I*
     ICMTTXT      DS
     I*
     I** DATA STRUCTURE FOR SETUP OF COMMIT TEXT
     I*
     I                                        1   50NATN
     I                                        6   7 MDID
     I                                        8  15 PGMN
     I                                       16  18 WSIDX
     I                                       19  240MTIME
     I                                       25  25 ACTNX
     I                                       26  35 USIDX
     I                                       51 306 DET
     I*
     IPSDS       SDS
     I*
     I** PROGRAM STATUS DATA STRUCTURE FOR WS/USER ID'S
     I*
     I                                      244 246 WSID
     I                                      254 263 USID
     I*                                                                   S01408
     I/COPY WNCPYSRC,FF0180IIP1                                           S01408
     I*                                                                   S01408
     I*
     I            DS
     I*
     I***KEY*TO*ACCESS*TABTE10                                            S01117
     I***********                                                         S01117
     I***********                             1  12 KEY                   S01117
     I***********                             1   2 TCD                   S01117
     I***********                             8  11 SACD                  S01117
     I***********                            12  12 ACTP                  S01117
     ISDACOD    E DSSDACODPD                                              S01117
      **  EXTERNAL DS FOR ACCOUNT CODES DETAILS                           S01117
      *                                                                   S01117
     I@DSFDY    E DSDSFDY                                                 S01117
      **  FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE              S01117
      *                                                                   S01117
     IDSSDY     E DSDSSDY                                                                     CGL029
      ** Second DS for access programs, Long data structure                                   CGL029
      *                                                                                       CGL029
     ISDBANK    E DSSDBANKPD                                                                  CSD031
      ** Bank details file                                                                    CSD031
      *                                                                                       CSD031
     IGPACOD    E DSGPACODPD                                                                  CSD031
      ** Midas GP Global Account Codes                                                        CSD031
      *                                                                                       CSD031
     ISCSARD    E DSSCSARDPD                                                                  CSD031
     I              LCD                             SLCD                                      CSD031
     I              ZONE                            SZONE                                     CSD031
      ** Switchable features file                                                             CSD031
      *                                                                                       CSD031
     ISDNARR    E DSSDNARRPD                                                                MD058769
     IRUNDT       DS                                                      S01117
      **  DATA AREA RUNDAT                                                S01117
     I                                        1   7 RUNA                  S01117
     I                                    P   8  100RUND                  S01117
     I                                       11  11 SSF                   S01117
     I                                       12  12 DATF                  S01117
     I                                       13  13 MBIN                  S01117
     IZMUSER      DS                             17                       S01117
     I** DATA AREA OF MENU USER                                           S01117
     I                                       11  13 USRBCH                S01117
     I*  DATA STRUCTURE FOR COMPILATION  - COPYRIGHT INSERTION
     ICPYR@#      DS
     I                                        1  80 CPY@
     I                                        1  20 CPY@##
     C*================================================================
     C*
     C** CALCULATION SPECIFICATIONS:KEY LISTS
     C*
     C**  DEFINE KEY LIST FOR CHAINING TO FACKY FILE
     C*
     C           FACKYK    KLIST
     C                     KFLD           FFKY
     C*CALCULATION SPECIFICATIONS:KEY LISTS****************************
     C*================================================================
      /EJECT
     C*================================================================
     C*  P R O G R A M     S T A R T
     C*================================================================
     C*
     C** PERFORM SETUP OF STANDARD FIELDS
     C*
     C                     EXSR INIT
     C*
     C** D O    U N T I L   C K 3   O R   E R R O R        -  S T A R T
     C*
     C           AID       DOUEQ'01'
     C           *INU7     OREQ '1'
     C*
     C           *IN10     CASEQ'1'       START
     C*
     C           *IN11     CASEQ'1'       REVIEW
     C*
     C           *IN12     CASEQ'1'       UPDATE
     C*
     C                     END
     C                     END
     C*
     C** D O    U N T I L   C K 3   O R   E R R O R        -  E N D
     C*
     C** TERMINATE PROGRAM
     C*
     C                     SETON                         LR
     C*================================================================
     C*  P R O G R A M     E N D
     C*================================================================
      /EJECT
     C*================================================================
      ** INDEX OF SUBROUTINES
      **
      ** INIT              INITIALISATION OF STANDARD FIELDS,
      **                   ACCESS OF STANDING DATA
      **
      ** START             OUTPUT AND PROCESS KEY FIELDS SCREEN
      **
      ** REVIEW            PROCESS SUBFILE SELECTION SCREEN
      **
      ** UPDATE            PROCESS DETAIL SCREEN AND UPDATE FILE
      **
      ** VALIDK            VALIDATE KEY FIELDS
      **
      ** VALIDD            VALIDATE DETAIL SCREEN
      **
      ** DEFLTS            FORMAT DEFAULT FIELD VALUES
      **
      ** INITRC            INITIALISE ALL FILE FIELDS TO ZERO/BLANK
      **
      ** TRSFS             FORMAT RECORD FIELDS FOR SCREEN
      **
      ** UPDFLS            UPDATE FILE RECORDS
      **
      ** UPDOWS            PROCESS UPDATE BY ANOTHER WORKSTATION
      **
      ** ZALIGN            VALIDATE AMOUNT FIELDS
      **
      ** ZEDIT             FORMAT AMOUNT FIELDS FOR DISPLAY
      **
      ** ZDATE1            CONVERT DATE TO DAYNO. AND REPORT IF ERROR
      **
      ** ZDATE2            CONVERT DAYNO. TO DATE FOR DISPLAY
      **
      ** ZTNLU1            ACCESS DATAAREA FOR NEXT TRANSACTION NO.
      **
      ** INFSR             FILE ERROR HANDLING S/R
      **                                                                  S01117
      ** *PSSR             HANDLES ABNORMAL ERROR CONDITIONS              S01117
      **
      **                                                                                      CSD031
      ** MDATA             ACCESS DATAA FOR @1DBRC - GPFACKYL0                                CSD031
      **                                                                                      CSD031
      ** MDATA1            ACCESS FIELD FROM @1DBSR to DETS                                   CSD031
      **                                                                                      CSD031
      ** SRRTXX            RETRIEVE TEXT FOR ERROR MESSAGE                                    CSD031
      **                                                                                      CSD031
      ** INFSR1            FILE ERROR HANDLING S/R                                            CSD031
      **                                                                                      CSD031
      ** INFSR2            FILE ERROR HANDLING S/R                                            CSD031
      **                                                                                      CSD031
     C*================================================================
      /EJECT
     C*================================================================
      **
      ** INIT S/R - TO INITIALISE STATIC FIELDS AND ACCESS STANDING DATA
      ** CALLED ONCE AT START OF PROGRAM FROM MAIN LINE
      ** CALLS NO OTHER ROUTINES
      **
     C*================================================================
     C*
     C           INIT      BEGSR                           * INIT BEGSR *
     C*
     C** PREPARE LDA
     C*
     C***********          MOVEL*BLANK    DBLOT                           S01117
     C           *NAMVAR   DEFN           LDA                             S01117
     C           *LOCK     IN   LDA                                       S01117
     C                     MOVE *BLANK    DBFILE                          S01117
     C                     MOVE *BLANK    DBKEY                           S01117
     C                     MOVE *BLANK    DBPGM                           S01117
     C                     Z-ADD*ZERO     DBASE                           S01117
     C                     MOVEL'FF0180'  DBPGM
     C                     OUT  LDA                                       S01117
     C*
     C** PREPARE COMIT TEXT
     C*
     C                     MOVEL'FF'      MDID
     C                     MOVEL'FF0180'  PGMN
     C                     MOVELWSID      WSIDX
     C                     MOVELUSID      USIDX
     C*
     C** HELP PROGRAM PARAMETER
     C*
     C                     MOVEL'FF0180'  HBPGM   8
     C                     MOVEL*BLANK    WBLNK   1
     C*
     C** FOR HIGH INTENSITY SCREEN ATTRIBUTE
     C*
     C                     BITOF'01234567'HI      1
     C                     BITON'267'     HI
     C                     MOVELHI        INF,7
     C                     MOVELHI        INF,8
     C                     MOVELHI        INF,9
     C                     MOVELHI        INF,10
     C                     MOVELHI        INF,11
     C*                                                                   S01117
     C**      IN THE DATAAREA                                             S01117
     C*                                                                   S01117
     C           *NAMVAR   DEFN RUNDAT    RUNDT                           S01117
     C                     IN   RUNDT                                     S01117
     C           *NAMVAR   DEFN           ZMUSER                          S01117
     C                     IN   ZMUSER                                    S01117
     C*
     C***GET*INSTALLATION*CONTROL*DATA*RECORD*1***************************S01117
     C***********                                                         S01117
     C***********          READ TABTB10F                 99               S01117
     C**N99******RECI      COMP 'D'                  9999                 S01117
      ***********                                                         S01117
      ***If**in99*on,*the*table*is*deleted********************************S01117
      ***********                                                         S01117
     C************IN99     IFEQ '0'                                       S01117
     C***********                                                         S01117
     C***IF*FOUND*CHECK*SYSTEM*DATE*FORMAT,*DDMMYY*OR*MMDDYY.*************S01117
     C*
     C           DATF      COMP 'M'                      98
      *
      ** Format MMDDYY if *in98 on
      *
     C***********          ELSE                                           S01117
     C***********                                                         S01117
     C***OTHERWISE*DB*ERROR***********************************************S01117
     C***********                                                         S01117
     C***********          SETON                     U7U8  ***************S01117
     C***********          MOVEL'01'      DBASE            **DB ERROR 01**S01117
     C***********          MOVEL'TABFF'   DBFILE           ***************S01117
     C***********          MOVEL'01'      ZTABKY 12                       S01117
     C***********          MOVE '10'      ZTABKY                          S01117
     C***********          MOVELZTABKY    DBKEY                           S01117
     C***********          END                                            S01117
      ***********                                                         S01117
      ***PREPARE*KEY*TO*ACCESS*TABTE10                                    S01117
      ***********                                                         S01117
     C***********          MOVE '30'      TCD                             S01117
     C***********          MOVE '1'       ACTP                            S01117
     C*                                                                   S01408
     C/COPY WNCPYSRC,FF0180CCP1                                           S01408
     C*                                                                   S01408
     C*
     C** PROCEED TO START SCREEN UNLESS DATABASE ERRPR
     C*
     C           *INU7     IFNE '1'
     C                     MOVEA'1'       *IN,10
     C                     END
      *                                                                                       CSD031
      ** Check if switchable feature CSD034 in On                                             CSD031
      *                                                                                       CSD031
     C                     CALL 'AOSARDR0'                                                    CSD031
     C                     PARM *BLANKS   PRTCD   7                                           CSD031
     C                     PARM '*VERIFY' POPTN   7                                           CSD031
     C                     PARM 'CSD034'  PSARD   6                                           CSD031
     C           SCSARD    PARM SCSARD    DSSDY                                               CSD031
      *                                                                                       CSD031
     C           PRTCD     IFNE *BLANKS                                                       CSD031
     C           PRTCD     ANDNE'*NRF   '                                                     CSD031
     C           *LOCK     IN   LDA                                                           CSD031
     C                     MOVEL'SCSARDPD'DBFILE                                              CSD031
     C                     MOVEL'CSD034  'DBKEY                                               CSD031
     C                     Z-ADD1         DBASE                                               CSD031
     C                     OUT  LDA                                                           CSD031
     C                     EXSR *PSSR                                                         CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C           PRTCD     IFEQ *BLANK                                                        CSD031
     C                     MOVEL'Y'       CSD034  1                                           CSD031
     C                     MOVE *ON       *IN34                                               CSD031
     C                     ELSE                                                               CSD031
     C                     MOVEL'N'       CSD034                                              CSD031
     C                     MOVE *OFF      *IN34   1                                           CSD031
     C                     END                                                                CSD031
      *                                                                                       CSD031
     C           CSD034    IFEQ 'Y'                                                           CSD031
      *                                                                                       CSD031
      **  Use access program to read bank details file                                        CSD031
      *                                                                                       CSD031
     C                     Z-ADD80        PLEN   155                                          CSD031
     C                     MOVE TITL,9    PCMD   80                                           CSD031
      *                                                                                       CSD031
      ** Default subfile page mode to 'CHANGE MODE'                                           CSD031
      *                                                                                       CSD031
     C           *INU1     IFEQ *OFF                                                          CSD031
     C                     MOVEL'C'       WPGEMD  1                                           CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
      ** Override GZSDBANKL2                                                                  CSD031
      *                                                                                       CSD031
     C                     CALL 'QCMDEXC'                                                     CSD031
     C                     PARM           PCMD                                                CSD031
     C                     PARM           PLEN                                                CSD031
     C                     OPEN GZSDBANK                                                      CSD031
     C                     READ GZSDBANK                 90                                   CSD031
     C           *IN90     IFEQ *ON                                                           CSD031
     C                     MOVEL'GZSDBANK'DBFILE                                              CSD031
     C                     Z-ADD002       DBASE                                               CSD031
     C                     EXSR *PSSR                                                         CSD031
     C                     ELSE                                                               CSD031
     C                     MOVELBJDFIN    GJDFIN  1                                           CSD031
     C                     Z-ADDBJDNWD    GJDNWD  50                                          CSD031
     C                     ENDIF                                                              CSD031
     C                     CLOSEGZSDBANK                                                      CSD031
      *                                                                                       CSD031
     C                     ELSE                                                               CSD031
      *                                                                                       CSD031
     C                     CALL 'AOBANKR0'                                                    CSD031
     C                     PARM '*MSG   ' PRTCD   7                                           CSD031
     C                     PARM '*FIRST ' POPTN   7                                           CSD031
     C           SDBANK    PARM SDBANK    @DSFDY                                              CSD031
      *                                                                                       CSD031
     C           PRTCD     IFNE *BLANK                                                        CSD031
     C                     MOVEL'SDBANKPD'DBFILE                                              CSD031
     C                     Z-ADD3         DBASE                                               CSD031
     C                     EXSR *PSSR                                                         CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
      ** End -CSD034                                                                          CSD031
      *                                                                                       CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
      ** Check Date Format                                                                    CSD031
      *                                                                                       CSD031
     C           CSD034    IFEQ 'Y'                                                           CSD031
     C           BJDFIN    IFEQ 'M'                                                           CSD031
     C                     MOVE *ON       *IN98                                               CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C                     MOVE *BLANKS   WUMTXT 80                                           CSD031
      *                                                                                       CSD031
      ** Obtain default message file                                                          CSD031
      *                                                                                       CSD031
     C           *NAMVAR   DEFN Y2MGFLA   ZADFMF 10                                           CSD031
     C                     IN   ZADFMF                                                        CSD031
      *                                                                                       CSD031
      ** Indicator for Non Display Title field *IN27 for Central Data/*IN20 for Action        CSD031
      *                                                                                       CSD031
     C                     MOVE *OFF      *IN27                                               CSD031
     C                     MOVE *OFF      *IN20                                               CSD031
     C                     MOVE *OFF      *IN83                                               CSD031
      *                                                                                       CSD031
      ** Indicator for Non Display field on screen                                            CSD031
      *                                                                                       CSD031
     C                     MOVE *OFF      *IN28                                               CSD031
     C                     MOVE *OFF      *IN82                                               CSD031
     C                     ENDIF                                                              CSD031
     C*
     C           XTINIT    ENDSR                           ** XTINIT ESR**
     C*===================================================================
      /EJECT
     C*===================================================================
      **
      ** START S/R TO OUTPUT AND PROCESS KEY FIELDS SCREEN
      ** CALLED FROM MAIN PROCESSING
      ** CALLS: VALIDK TO VALIDATE KEY FIELDS IF ENTERED
      **
     C*===================================================================
     C*
     C           START     BEGSR                           ** START BSR **
     C*
     C** INITIALISE SCREEN DATA
     C*
     C                     MOVEA'0'       *IN,10
     C                     MOVEA'0010'    *IN,21
     C                     MOVEL*BLANK    SCRCTL
      *                                                                                       CSD031
      ** Display footer narrative                                                             CSD031
      ** If *INU1 = '1' show the initail screen Central Mode ELSE Zone Mode                   CSD031
      *                                                                                       CSD031
     C           CSD034    IFEQ 'N'                                                           CSD031
     C                     MOVELTITL,2    #1HDR                                               CSD031
     C                     MOVELINF,1     INFMSG
     C                     ELSE                                                               CSD031
      *                                                                                       CSD031
     C           *INU1     IFEQ *ON                                                           CSD031
     C                     MOVELTITL,1    #1HDR                                               CSD031
     C                     MOVELINF,12    INFMSG                                              CSD031
     C                     ELSE                                                               CSD031
     C           WPGEMD    IFEQ 'C'                                                           CSD031
     C                     MOVELTITL,2    #1HDR                                               CSD031
     C                     MOVELINF,14    INFMSG                                              CSD031
     C                     ENDIF                                                              CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C                     ENDIF                                                              CSD031
     C*
     C** CLEAR WHOLE SCREEN
     C*
     C                     WRITEFF0180F3
     C*
     C** D O    U N T I L   C H A N G E  O F  S C R E E N  -  S T A R T
     C*
     C           *IN10     DOUEQ'1'
     C           *IN11     OREQ '1'
     C           *IN12     OREQ '1'
     C*
     C** S T A R T   S C R E E N     O U T P U T           -  S T A R T
     C*
     C**********           WRITEFF0180F1                                                      CAAA03
     C                     WRITEFF0180F2
     C                     WRITEFF0180F1                                                      CAAA03
     C                     READ FF0180F1                 99
     C                     MOVELERRMSG    HERCD 160
     C                     MOVELWBLNK     HERCD
     C                     MOVEL*BLANK    SCRMSG
     C*
     C** S T A R T   S C R E E N     O U T P U T           -  E N D
     C*
     C** C K 3 , H E L P , O R  E N T E R   P R E S S E D  -  S T A R T
     C*
     C** Call S/R to move values into AID                                 S01179
     C*                                                                   S01179
     C                     EXSR ASCHGS                                    S01179
     C*                                                                   S01179
     C** CK1 - TERMINATE
     C*
     C           AID       IFEQ '01'
     C                     MOVEA'1'       *IN,10
     C*
     C** HELP - CALL HELP PROGRAM
     C*
     C**********           ELSE                                           S01199
     C********** AID       IFEQ 'HP'                                      S01199
     C**********           MOVELHERCD     ERRMSG                          S01199
     C********** ERR,1     IFNE *BLANK                                    S01199
     C**********           MOVELHI        ERRMSG                          S01199
     C**********           END                                            S01199
     C**********           CALL 'MHELP'                                   S01199
     C**********           PARM           HBPGM                           S01199
     C**********           PARM           HERCD                           S01199
     C*
     C** ENTER TAKEN VALIDATE KEY INPUT
     C*
     C                     ELSE
     C                     EXSR VALIDK
     C*
     C** D E T E R M I N E    S C R E E N   C H A N G E    -  S T A R T
     C*
     C** IF NO ERRORS, DETERMINE NEXT SCREEN
     C*
     C           SCRMSG    IFEQ *BLANK
     C*
     C**  - IF KEY FIELD IS BLANK, NEXT SCREEN IS REVIEW SCREEN
     C*
     C           FFKY      IFEQ *BLANK
     C                     MOVEA'1'       *IN,11
     C*
     C**  - OTHERWISE, DISPLAY REQUESTED DETAIL SCREEN AS PER KEY INPUT
     C*
     C                     ELSE
     C                     MOVEA'1'       *IN,12
     C                     END
     C*
     C                     SETOF                     23
     C*
     C                     END
     C*
     C** D E T E R M I N E    S C R E E N   C H A N G E    -  E N D
     C*
     C                     END
     C                     END
     C*
     C** C K 3, H E L P , O R  E N T E R   P R E S S E D  -  E N D
     C*
     C**********           END                                            S01199
     C*
     C** D O    U N T I L   C H A N G E  O F  S C R E E N  -  E N D
     C*
     C           XTSTAR    ENDSR                           ** XTSTAR ESR**
     C*================================================================
      /EJECT
     C*================================================================
      **
      ** REVIEW S/R TO PROCESS SUBFILE SELECTION SCREEN
      ** CALLED FROM MAIN PROCESSING
      ** CALLS: VALIDK TO VALIDATE KEY FIELDS IF SUBFILE RECORD SELECTED
      **
     C*================================================================
     C*
     C           REVIEW    BEGSR                           ** REVIEW BSR**
      *                                                                                       CSD031
     C           CSD034    IFEQ 'Y'                                                           CSD031
      *                                                                                       CSD031
      ** Initialize subfile field                                                             CSD031
      *                                                                                       CSD031
     C                     MOVEL*BLANKS   #1AACC                                              CSD031
     C                     MOVE *BLANKS   #1EACC                                              CSD031
     C                     MOVE *BLANKS   #1ACTN                                              CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C*
     C                     MOVEA'0'       *IN,11
     C*
     C** SET PROCESSING FLAG TO FORCE SUBFILE REBUILD
     C*
     C                     MOVEL'RA'      AID
     C*
     C** D O    U N T I L   C H A N G E  O F  S C R E E N  -  S T A R T
     C*
     C           *IN10     DOUEQ'1'
     C           *IN11     OREQ '1'
     C           *IN12     OREQ '1'
     C*
     C** I F  R O L L   U P / D O W N   O R   E N T E R   P R E S S E D
     C*
     C** R E B U I L D   S U B F I L E                     -  S T A R T
     C*
     C           AID       IFEQ 'DN'
     C           AID       OREQ 'UP'
     C           AID       OREQ 'RA'
     C*
     C** WRITE CONTROL RECORD
     C*
     C                     MOVEA'000'     *IN,1
     C                     Z-ADD*ZERO     RRN
      *                                                                                       CSD031
      ** Display Screen Title :'Accept to Zone' field should only be display during CENTRAL   CSD031
      ** MODE and 'Central Data' field during ZONAL MODE.                                     CSD031
      *                                                                                       CSD031
     C           CSD034    IFEQ 'Y'                                                           CSD031
      *                                                                                       CSD031
     C           *INU1     IFEQ *OFF                                                          CSD031
     C           WPGEMD    IFEQ 'C'                                                           CSD031
     C                     MOVELTITL,4    #1HDR                                               CSD031
     C                     MOVELTITL,7    #1TITL                                              CSD031
     C                     MOVE *OFF      *IN27                                               CSD031
     C                     MOVE *ON       *IN20                                               CSD031
     C                     ELSE                                                               CSD031
     C                     MOVELTITL,5    #1HDR                                               CSD031
     C                     MOVE *ON       *IN27                                               CSD031
     C                     MOVE *OFF      *IN20                                               CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C                     ELSE                                                               CSD031
     C                     MOVELTITL,3    #1HDR                                               CSD031
     C                     MOVELTITL,8    #1TITL                                              CSD031
     C                     MOVE *OFF      *IN27                                               CSD031
     C                     MOVE *ON       *IN20                                               CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C                     ELSE                                                               CSD031
     C                     MOVELTITL,4    #1HDR                                               CSD031
     C                     MOVEL*ON       *IN83                                               CSD031
     C                     MOVEL*ON       *IN20                                               CSD031
      *                                                                                       CSD031
      ** ENDIF CSD034                                                                         CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C                     WRITEFF0180C0
     C                     MOVEA'1'       *IN,4
     C*
     C** SET FILE POINTER - PAGE BACK
     C*
     C           AID       IFEQ 'DN'
     C                     MOVEL*BLANK    FFKY
     C                     MOVEL*BLANK    PPAGK 014
      *                                                                                       CSD031
     C           CSD034    IFEQ 'Y'                                                           CSD031
      *                                                                                       CSD031
     C           *INU1     IFEQ *ON                                                           CSD031
     C           FACKYK    SETLLGPFAKYL1                                                      CSD031
     C                     ELSE                                                               CSD031
     C           WPGEMD    IFEQ 'C'                                                           CSD031
     C           FACKYK    SETLLFACKYX                                                        CSD031
     C                     ELSE                                                               CSD031
     C           FACKYK    SETLLSDAFAKLX                                                      CSD031
     C                     ENDIF                                                              CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C                     ELSE                                                               CSD031
     C           FACKYK    SETLLFACKYX
      *                                                                                       CSD031
      ** EndIF  CSD034 = 'Y'                                                                  CSD031
      *                                                                                       CSD031
     C                     ENDIF                                                              CSD031
     C*
     C** OTHERWISE        - PAGE FORWARD
     C*
     C                     ELSE
     C           PFFKY     IFEQ *BLANKS                                                       CSD031
     C                     MOVELPAGK      FFKY                                                CSD031
     C                     ELSE                                                               CSD031
     C                     MOVELPFFKY     FFKY
     C                     ENDIF                                                              CSD031
     C                     MOVELPAGK      PPAGK
      *                                                                                       CSD031
     C           CSD034    IFEQ 'Y'                                                           CSD031
      *                                                                                       CSD031
     C           *INU1     IFEQ *ON                                                           CSD031
     C           FACKYK    SETLLGPFAKYL1                                                      CSD031
     C                     ELSE                                                               CSD031
     C           WPGEMD    IFEQ 'C'                                                           CSD031
     C           FACKYK    SETLLFACKYX                                                        CSD031
     C                     ELSE                                                               CSD031
     C           FACKYK    SETLLSDAFAKLX                                                      CSD031
     C                     ENDIF                                                              CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C                     ELSE                                                               CSD031
     C           FACKYK    SETLLFACKYX
      *                                                                                       CSD031
      ** EndIF  CSD034 = 'Y'                                                                  CSD031
      *                                                                                       CSD031
     C                     ENDIF                                                              CSD031
     C                     END
     C*
     C** READ IN DETAILS-FILL UP SUBFILE
     C*
     C*
     C           RRN       DOUEQ18
     C           *IN,03    OREQ '1'
     C*
     C** READ DETAILS UNTIL SUBFILE PAGE IS FULL
     C*
      *                                                                                       CSD031
     C           CSD034    IFEQ 'Y'                                                           CSD031
      *                                                                                       CSD031
     C           *INU1     IFEQ *ON                                                           CSD031
     C                     READ GPFAKYL1                 03                                   CSD031
     C                     ELSE                                                               CSD031
     C           WPGEMD    IFEQ 'C'                                                           CSD031
     C                     READ FACKYX                   03                                   CSD031
     C                     ELSE                                                               CSD031
     C                     READ SDAFAKL1                 03                                   CSD031
     C                     ENDIF                                                              CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C                     ELSE                                                               CSD031
     C                     READ FACKYX                   03
      *                                                                                       CSD031
      ** EndIF  CSD034 = 'Y'                                                                  CSD031
      *                                                                                       CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
      ** Display 'Accept to Zone' field during CENTRAL MODE else display 'Central Data' field CSD031
      ** during ZONE MODE.                                                                    CSD031
      *                                                                                       CSD031
     C           CSD034    IFEQ 'Y'                                                           CSD031
      *                                                                                       CSD031
     C           *INU1     IFEQ *ON                                                           CSD031
     C                     MOVELAACC      #1AACC                                              CSD031
     C                     MOVEL*BLANKS   #1ACTN                                              CSD031
     C                     ELSE                                                               CSD031
      *                                                                                       CSD031
     C           WPGEMD    IFEQ 'C'                                                           CSD031
     C                     MOVELGPDT      #1AACC                                              CSD031
     C                     MOVEL*BLANKS   #1ACTN                                              CSD031
     C                     ELSE                                                               CSD031
     C                     MOVELGPDT      #1AACC                                              CSD031
     C                     MOVEL*BLANKS   #1ACTN                                              CSD031
      *                                                                                       CSD031
      ** Action  for FO Account Keys Acceptance Review                                        CSD031
      *                                                                                       CSD031
     C           CHTP      IFEQ 'I'                                                           CSD031
     C                     MOVEL'INSERT'  #1ACTN                                              CSD031
     C                     ELSE                                                               CSD031
     C           CHTP      IFEQ 'A'                                                           CSD031
     C                     MOVEL'AMEND'   #1ACTN                                              CSD031
     C                     ELSE                                                               CSD031
     C           CHTP      IFEQ 'D'                                                           CSD031
     C                     MOVEL'DELETE'  #1ACTN                                              CSD031
     C                     ENDIF                                                              CSD031
     C                     ENDIF                                                              CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
      ** END for WPGEMD / *INU1                                                               CSD031
      *                                                                                       CSD031
     C                     ENDIF                                                              CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
      ** Convert Effective Date                                                               CSD031
      *                                                                                       CSD031
     C           *INU1     IFEQ *ON                                                           CSD031
     C           #1AACC    IFEQ 'Y'                                                           CSD031
     C                     MOVEL*BLANKS   #1EACC                                              CSD031
     C                     ELSE                                                               CSD031
     C                     MOVE EACC      WVLDTE                                              CSD031
     C                     MOVE GJDFIN    WDTFMT                                              CSD031
     C                     EXSR ZDATE2                                                        CSD031
     C                     MOVELWRNDTE    #1EACC                                              CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
      ** Zonal Mode: Effective Date                                                           CSD031
      *                                                                                       CSD031
     C                     ELSE                                                               CSD031
     C                     MOVE EACC      WVLDTE                                              CSD031
     C                     MOVE GJDFIN    WDTFMT                                              CSD031
     C                     EXSR ZDATE2                                                        CSD031
     C                     MOVELWRNDTE    #1EACC                                              CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
      ** END for CSD034                                                                       CSD031
      *                                                                                       CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C           *IN,03    IFEQ '0'
     C*
     C** IF RECORD IS DELETED, FLAG IT AS SO ON SCREEN
     C*
     C           RECI      IFEQ '*'
     C                     MOVEL'D'       STAT    1
     C                     ELSE
     C                     MOVEL*BLANK    STAT
     C                     END
     C*
     C                     ADD  1         RRN     40     04
     C*
     C*CALCULATION SPECIFICATIONS:PAGE BREAK***************************
     C                     WRITEFF0180S0
      *                                                                                       CSD031
     C                     ELSE                                                               CSD031
      *                                                                                       CSD031
     C           CSD034    IFEQ 'Y'                                                           CSD031
     C           *INU1     IFEQ *OFF                                                          CSD031
     C           WPGEMD    IFEQ 'C'                                                           CSD031
     C                     MOVELTITL,4    #1HDR                                               CSD031
     C                     MOVELTITL,7    #1TITL                                              CSD031
     C                     MOVELINF,15    INFMSG                                              CSD031
     C                     MOVE *OFF      *IN27                                               CSD031
     C                     MOVE *ON       *IN20                                               CSD031
     C                     ELSE                                                               CSD031
     C                     MOVELTITL,5    #1HDR                                               CSD031
     C                     MOVELINF,16    INFMSG                                              CSD031
     C                     MOVE *ON       *IN27                                               CSD031
     C                     MOVE *OFF      *IN20                                               CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C                     ELSE                                                               CSD031
     C                     MOVELTITL,3    #1HDR                                               CSD031
     C                     MOVELTITL,8    #1TITL                                              CSD031
     C                     MOVELINF,13    INFMSG                                              CSD031
     C                     MOVE *OFF      *IN27                                               CSD031
     C                     MOVE *ON       *IN20                                               CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C                     WRITEFF0180F4                                                      CSD031
     C                     WRITEFF0180F2                                                      CSD031
      *                                                                                       CSD031
      ** EndIF CSD034                                                                         CSD031
      *                                                                                       CSD031
     C                     ENDIF                                                              CSD031
     C*
     C** RECORD NOW WRITTEN TO SUBFILE
     C*
     C                     END
     C*
     C** PAGE NOW FULL (OR EOF)
     C*
     C                     END
     C*
     C** READ ONE MORE RECORD FOR NEXT SCREEN
     C*
     C           *IN,03    IFEQ '0'
      *                                                                                       CSD031
     C           CSD034    IFEQ 'Y'                                                           CSD031
      *                                                                                       CSD031
     C           *INU1     IFEQ *ON                                                           CSD031
     C                     READ GPFAKYL1                 03                                   CSD031
     C                     ELSE                                                               CSD031
     C           WPGEMD    IFEQ 'C'                                                           CSD031
     C                     READ FACKYX                   03                                   CSD031
     C                     ELSE                                                               CSD031
     C                     READ SDAFAKL1                 03                                   CSD031
     C                     ENDIF                                                              CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C                     ELSE                                                               CSD031
     C                     READ FACKYX                   03
     C                     ENDIF                                                              CSD031
     C                     END
     C*
     C** IF NOT EOF SET NEXT 'REVIEW FROM' KEY ELSE SET IT TO BLANK
     C*
     C           *IN,03    IFEQ '0'
     C                     MOVELINPK      PAGK
     C                     ELSE
     C                     MOVEL*BLANK    PAGK
     C                     END
     C*
     C** FOR SUBFILE CONTROL
     C*
     C           *IN,4     IFEQ '1'
     C                     MOVEA'010'     *IN,1
     C                     ELSE
     C                     MOVEA'11'      *IN,1
     C                     END
     C                     END
     C*
     C** R E B U I L D   S U B F I L E     -     E N D
     C*
     C** R E V I E W   S C R E E N     O U T P U T         -  S T A R T
     C*
      *                                                                                       CSD031
      ** Check if CSD034 is *ON                                                               CSD031
      *                                                                                       CSD031
     C           CSD034    IFEQ 'N'                                                           CSD031
     C                     MOVELINF,2     INFMSG
      *                                                                                       CSD031
     C                     ELSE                                                               CSD031
     C           *INU1     IFEQ *OFF                                                          CSD031
     C           WPGEMD    IFEQ 'A'                                                           CSD031
     C                     MOVELINF,16    INFMSG                                              CSD031
     C                     MOVELTITL,5    #1HDR                                               CSD031
     C                     MOVE *ON       *IN27                                               CSD031
     C                     MOVE *OFF      *IN20                                               CSD031
     C                     ELSE                                                               CSD031
     C                     MOVELINF,15    INFMSG                                              CSD031
     C                     MOVELTITL,4    #1HDR                                               CSD031
     C                     MOVELTITL,7    #1TITL                                              CSD031
     C                     MOVE *OFF      *IN27                                               CSD031
     C                     MOVE *ON       *IN20                                               CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C                     ELSE                                                               CSD031
     C                     MOVELINF,13    INFMSG                                              CSD031
     C                     MOVELTITL,3    #1HDR                                               CSD031
     C                     MOVELTITL,8    #1TITL                                              CSD031
     C                     MOVE *OFF      *IN27                                               CSD031
     C                     MOVE *ON       *IN20                                               CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C**********           WRITEFF0180C0                                                      CAAA03
     C                     WRITEFF0180F2
     C                     WRITEFF0180C0                                                      CAAA03
     C                     READ FF0180C0                 99
     C                     MOVELERRMSG    HERCD
     C                     MOVELWBLNK     HERCD
     C                     MOVEL*BLANK    SCRMSG
     C                     MOVEL*BLANK    REVW
     C*
     C** R E V I E W   S C R E E N     O U T P U T         -  E N D
     C*
     C** C K 3 , C K12 , H E L P , R E C O R D  S E L E C T-  S T A R T
     C*
     C** Call S/R to move values into AID                                 S01179
     C*                                                                   S01179
     C                     EXSR ASCHGS                                    S01179
     C*                                                                   S01179
     C** CK1 - TERMINATE
     C*
     C           AID       IFEQ '01'
     C                     MOVEA'1'       *IN,11
     C*
     C** CK5 - INITIAL SCREEN
     C*
     C                     ELSE
     C           AID       IFEQ '05'
     C                     MOVEA'1'       *IN,10
     C*
     C** HELP - CALL HELP PROGRAM
     C*
     C**********           ELSE                                           S01199
     C********** AID       IFEQ 'HP'                                      S01199
     C**********           MOVELHERCD     ERRMSG                          S01199
     C********** ERR,1     IFNE *BLANK                                    S01199
     C**********           MOVELHI        ERRMSG                          S01199
     C**********           END                                            S01199
     C**********           CALL 'MHELP'                                   S01199
     C**********           PARM           HBPGM                           S01199
     C**********           PARM           HERCD                           S01199
     C*
     C** ENTER PRESSED, PROCESS RECORD SELECTION
     C*
     C                     ELSE
      *                                                                                       CSD031
      ** Ck11 = *Inkk                                                                         CSD031
      *                                                                                       CSD031
     C           CSD034    IFEQ 'Y'                                                           CSD031
      *                                                                                       CSD031
     C           AID       IFEQ '06'                                                          CSD031
     C           *INU1     IFEQ *OFF                                                          CSD031
     C           WPGEMD    IFEQ 'C'                                                           CSD031
     C                     MOVEL'A'       WPGEMD                                              CSD031
     C                     MOVE *ON       *IN11                                               CSD031
     C                     MOVEL*BLANKS   PFFKY                                               CSD031
     C                     MOVEL*BLANKS   PAGK                                                CSD031
     C                     MOVE *ON       *IN27                                               CSD031
     C                     MOVE *OFF      *IN20                                               CSD031
     C                     ELSE                                                               CSD031
     C                     MOVEL'C'       WPGEMD                                              CSD031
     C                     MOVE *ON       *IN11                                               CSD031
     C                     MOVE *OFF      *IN27                                               CSD031
     C                     MOVE *ON       *IN20                                               CSD031
     C                     MOVEL*BLANKS   PFFKY                                               CSD031
     C                     MOVEL*BLANKS   PAGK                                                CSD031
     C                     ENDIF                                                              CSD031
     C                     ENDIF                                                              CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C                     MOVEA'1'       *IN,99
     C           *IN,04    IFEQ '0'
     C                     READCFF0180S0                 99
     C                     END
     C*
     C** R E C O R D   S E L E C T   V A L I D A T I O N   -  S T A R T
     C*
     C           *IN99     IFEQ '0'
     C                     EXSR VALIDK
     C*
     C** NO ERRORS, UPDATE SCREEN CAN BE PROCESSED NEXT
     C*
     C           SCRMSG    IFEQ *BLANK
     C                     MOVEA'1'       *IN,12
     C                     MOVEL'Y'       REVW
     C                     END
     C                     END
     C*
     C** R E C O R D   S E L E C T   V A L I D A T I O N   -  E N D
     C*
     C                     END
     C                     END
     C                     END
     C*
     C** C K 3 , C K12 , H E L P , R E C O R D  S E L E C T - E N D
     C*
     C**********           END                                            S01199
     C*
     C** D O    U N T I L   C H A N G E  O F  S C R E E N   - S T A R T
     C*
     C           XTREVI    ENDSR                           ** XTREVI ESR**
     C*
     C*===================================================================
      /EJECT
     C*===================================================================
      **
      ** UPDATE S/R TO PROCESS DETAIL SCREEN AND UPDATE FILE
      ** CALLED FROM MAIN PROCESSING
      ** CALLS: VALIDD, UPDFLS, INITRC, TRSFS, DEFLTS
      **
     C*===================================================================
     C*
     C           UPDATE    BEGSR                           ** UPDATE BSR**
     C*
     C** SET SCREEN INDICATORS - PROTECT KEY, SET OFF ERROR INDS,
     C** POSITION CURSOR
     C*
     C                     MOVEA'1'       *IN,5
     C                     MOVEA'0'       *IN,12
     C                     MOVEA'10000000'*IN,30
     C                     MOVEA'00000000'*IN,38
     C                     MOVEA'000'     *IN,46
      *                                                                                       CSD031
     C           CSD034    IFEQ 'Y'                                                           CSD031
      *                                                                                       CSD031
      ** Screen Display - FF0180F0  (Protect Field Indicator)                                 CSD031
      ** *IN07- Posting Ref. ; *IN29-Effective Date,and Accept to Zone/Centra data            CSD031
      *                                                                                       CSD031
     C                     MOVE *OFF      *IN29                                               CSD031
     C                     MOVE *OFF      *IN07                                               CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C/COPY WNCPYSRC,FF0180C001
     C*
     C** ACCESS FILE RECORD FOR OLD TNLU TO CHECK AT UPDATE TIME
     C** IF NO RECORD PRESENTLY ON FILE, ZEROISE STORED TNLU
     C*
     C                     Z-ADD*ZERO     STNLU   50
      *                                                                                       CSD031
     C           CSD034    IFEQ 'Y'                                                           CSD031
      *                                                                                       CSD031
     C           *INU1     IFEQ *ON                                                           CSD031
     C           FACKYK    CHAINGPFAKYL1             99                                       CSD031
     C                     ELSE                                                               CSD031
     C           WPGEMD    IFEQ 'C'                                                           CSD031
     C           FACKYK    CHAINFACKYX               99                                       CSD031
     C                     ELSE                                                               CSD031
     C           FACKYK    CHAINSDAFAKLX             99                                       CSD031
     C                     ENDIF                                                              CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C                     ELSE                                                               CSD031
     C           FACKYK    CHAINFACKYX               99    *
      *                                                                                       CSD031
      ** EndIF CSD034 = 'Y'                                                                   CSD031
      *                                                                                       CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C           *IN,99    IFEQ '0'
     C                     Z-ADDTNLU      STNLU
     C                     END
      *                                                                                       CSD031
      ** Accept Central Data - Action = X                                                     CSD031
      *                                                                                       CSD031
     C           CSD034    IFEQ 'Y'                                                           CSD031
      *                                                                                       CSD031
     C           ACTN      IFEQ 'X'                                                           CSD031
     C           *INU1     ANDEQ*OFF                                                          CSD031
     C                     EXSR UPDFLS                                                        CSD031
     C                     GOTO XTUPDT                                                        CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
      ** EndIF CSD034 = 'Y'                                                                   CSD031
      *                                                                                       CSD031
     C                     ENDIF                                                              CSD031
     C*
     C** IF INSERT (NEW OR OVER DELETED RECORD)
     C** INITIALIZE ALL FIELDS ON THE RECORD (IE ZEROIZE/BLANK OUT)
     C*
     C           ACTN      IFEQ 'I'
     C                     EXSR INITRC
     C                     END
     C*
     C** IF DELETED RECORD-ENQUIRY ONLY (RECI IS SET TO BLANK FOR INSERTS)
     C*
     C           RECI      IFEQ '*'
     C                     MOVEL'E'       ACTN
     C                     MOVEL'DELETED' DELT    7
     C                     ELSE
     C                     MOVEL*BLANK    DELT
     C                     END
     C*CALCULATION SPECIFICATIONS:KEY BREAK****************************
     C*
     C** TRANSLATE RECORD DETAILS FROM FILE LAYOUT TO SCREEN LAYOUT
     C*
     C                     EXSR TRSFS
     C*
     C** SET UP DEFAULTS (DONE ON BLANK FIELDS)
     C*
     C                     EXSR DEFLTS
     C*
     C** IF DELETE/ENQUIRY PROTECT FIELD INPUT ON S/FF0180F0
     C*
     C           ACTN      IFEQ 'D'
     C           ACTN      OREQ 'E'
     C                     MOVEA'1'       *IN,6
     C                     MOVE *ON       *IN07                                               CSD031
     C           CSD034    IFEQ 'Y'                                                           CSD031
     C                     MOVE *ON       *IN29                                               CSD031
     C                     MOVEA'1'       *IN,7                                               CSD031
     C                     ENDIF                                                              CSD031
     C                     END
      *                                                                                       CSD031
     C           CSD034    IFEQ 'Y'                                                           CSD031
     C           *INU1     IFEQ *OFF                                                          CSD031
     C           ACTN      ANDEQ'A'                                                           CSD031
     C                     MOVEA'1'       *IN,6                                               CSD031
     C                     MOVE *ON       *IN29                                               CSD031
     C                     MOVE *OFF      *IN,7                                               CSD031
     C                     ENDIF                                                              CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C*
     C** D O    U N T I L   C H A N G E  O F  S C R E E N  -  S T A R T
     C*
     C           *IN10     DOUEQ'1'
     C           *IN11     OREQ '1'
     C           *IN12     OREQ '1'
     C*
     C** L O A D    U  P    I N F O M E S S A G E S        -  S T A R T
     C*
     C           INFMSG    IFEQ *BLANK
     C           ACTN      IFEQ 'I'
     C                     MOVELINF,3     INFMSG
     C                     END
     C           ACTN      IFEQ 'A'
     C                     MOVELINF,4     INFMSG
     C                     MOVE *OFF      *IN07                                               CSD031
      *                                                                                       CSD031
     C           CSD034    IFEQ 'Y'                                                           CSD031
     C           *INU1     IFEQ '0'                                                           CSD031
     C                     MOVE *ON       *IN29                                               CSD031
     C                     ENDIF                                                              CSD031
     C           WPGEMD    IFEQ 'A'                                                           CSD031
     C                     MOVE *ON       *IN28                                               CSD031
     C                     ELSE                                                               CSD031
     C                     MOVE *OFF      *IN28                                               CSD031
     C                     ENDIF                                                              CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C                     END
     C           ACTN      IFEQ 'E'
     C                     MOVELINF,5     INFMSG
      *                                                                                       CSD031
     C           CSD034    IFEQ 'Y'                                                           CSD031
     C           WPGEMD    IFEQ 'A'                                                           CSD031
     C                     MOVE *ON       *IN29                                               CSD031
     C                     ENDIF                                                              CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C                     END
     C           ACTN      IFEQ 'D'
     C                     MOVELINF,6     INFMSG
     C                     END
     C                     END
      *                                                                                       CSD031
      ** Display Title                                                                        CSD031
      *                                                                                       CSD031
     C           CSD034    IFEQ 'Y'                                                           CSD031
     C           *INU1     IFEQ *ON                                                           CSD031
     C                     MOVELTITL,1    #1HDR                                               CSD031
     C                     MOVELTITL,8    #TITL                                               CSD031
     C                     ELSE                                                               CSD031
     C           WPGEMD    IFEQ 'C'                                                           CSD031
     C                     MOVELTITL,2    #1HDR                                               CSD031
     C                     MOVELTITL,7    #TITL                                               CSD031
     C                     MOVEL*ON       *IN20                                               CSD031
     C                     ELSE                                                               CSD031
     C                     MOVELTITL,6    #1HDR                                               CSD031
     C                     MOVELTITL,7    #TITL                                               CSD031
     C                     ENDIF                                                              CSD031
     C                     ENDIF                                                              CSD031
     C                     ELSE                                                               CSD031
     C                     MOVELTITL,2    #1HDR                                               CSD031
     C                     MOVELTITL,7    #TITL                                               CSD031
     C                     MOVE *ON       *IN28                                               CSD031
     C                     MOVE *ON       *IN82                                               CSD031
     C                     MOVE *ON       *IN29                                               CSD031
     C                     ENDIF                                                              CSD031
     C*
     C** L O A D    U  P    I N F O M E S S A G E S        -  E N D
     C*
     C** D E T A I L   S C R E E N     O U T P U T         -  S T A R T
     C*
     C                     WRITEFF0180F1
     C**********           WRITEFF0180F0                                                      CAAA03
     C                     WRITEFF0180F2
     C                     WRITEFF0180F0                                                      CAAA03
     C                     READ FF0180F0                 99
     C                     MOVELERRMSG    HERCD
     C                     MOVELWBLNK     HERCD
     C                     MOVEL*BLANK    SCRMSG
     C*
     C** D E T A I L   S C R E E N     O U T P U T         -  E N D
     C*
     C** C K 3 , C K12 , H E L P , R O L L U P / D O W N   -  S T A R T
     C*
     C** Call S/R to move values into AID                                 S01179
     C*                                                                   S01179
     C                     EXSR ASCHGS                                    S01179
     C*                                                                   S01179
     C** CK1 - TERMINATE
     C*
     C           AID       IFEQ '01'
     C                     MOVEA'1'       *IN,12
     C                     END
     C*
     C** CK5 - INITIAL SCREEN
     C*
     C           AID       IFEQ '05'
     C                     MOVEA'1'       *IN,10
     C                     END
     C*
     C** HELP - CALL HELP PROGRAM
     C*
     C********** AID       IFEQ 'HP'                                      S01199
     C**********           MOVELHERCD     ERRMSG                          S01199
     C********** ERR,1     IFNE *BLANK                                    S01199
     C**********           MOVELHI        ERRMSG                          S01199
     C**********           END                                            S01199
     C**********           CALL 'MHELP'                                   S01199
     C**********           PARM           HBPGM                           S01199
     C**********           PARM           HERCD                           S01199
     C**********           END                                            S01199
     C*
     C** PAGE FORWARD TAKEN, READ NEXT RECORD
     C*
     C           AID       IFEQ 'UP'
     C           ACTN      ANDNE'I'
      *                                                                                       CSD031
     C           CSD034    IFEQ 'Y'                                                           CSD031
      *                                                                                       CSD031
     C           *INU1     IFEQ *ON                                                           CSD031
     C                     READ GPFAKYL1                 12                                   CSD031
     C                     ELSE                                                               CSD031
     C           WPGEMD    IFEQ 'C'                                                           CSD031
     C                     READ FACKYX                   12                                   CSD031
     C                     ELSE                                                               CSD031
     C                     READ SDAFAKL1                 12                                   CSD031
     C                     ENDIF                                                              CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C                     ELSE                                                               CSD031
     C                     READ FACKYX                   12
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C*
     C** CHANGE MESSAGE IF END OF FILE REACHED - NO ROLL FWD
     C*
     C           *IN,12    IFEQ '1'
     C                     MOVELINF,7     INFMSG
     C                     ELSE
     C                     MOVEA'1'       *IN,12
     C                     END
     C                     END
     C*
     C** PAGE BACK TAKEN, READ PREVIOUS RECORD
     C*
     C           AID       IFEQ 'DN'
     C           ACTN      ANDNE'I'
      *                                                                                       CSD031
     C           CSD034    IFEQ 'Y'                                                           CSD031
      *                                                                                       CSD031
     C           *INU1     IFEQ *ON                                                           CSD031
     C                     READPGPFAKYL1                 12                                   CSD031
     C                     ELSE                                                               CSD031
     C           WPGEMD    IFEQ 'C'                                                           CSD031
     C                     READPFACKYX                   12                                   CSD031
     C                     ELSE                                                               CSD031
     C                     READPSDAFAKL1                 12                                   CSD031
     C                     ENDIF                                                              CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C                     ELSE                                                               CSD031
     C                     READPFACKYX                   12
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C*
     C** CHANGE MESSAGE IF BEGINNING OF FILE REACHED - NO ROLL BACK
     C*
     C           *IN,12    IFEQ '1'
     C                     MOVELINF,8     INFMSG
     C                     ELSE
     C                     MOVEA'1'       *IN,12
     C                     END
     C                     END
     C*
     C** NOT CK1,CK5,HELP,ROLLUP,ROLLDOWN
     C*
     C*
     C** V A L I D A T E   D E T A I L   S C R E E N   I N P U T
     C*
     C           AID       IFEQ 'RA'
     C           AID       OREQ '04'
     C                     EXSR VALIDD
     C*
     C** N O    D E T A I L   S C R E E N    E R R O R S   -  S T A R T
     C*
     C           SCRMSG    IFEQ *BLANK
     C           AID       ANDEQ'RA'
     C*
     C**FOR REC.ADVANCE DETERMINE WHAT SCREEN TO RETURN TO -  S T A R T
     C*
     C           REVW      IFEQ 'Y'
     C                     MOVELPPAGK     PAGK
     C                     MOVEA'1'       *IN,11
     C                     ELSE
     C                     MOVEA'1'       *IN,10
     C                     END
     C*
     C**FOR REC.ADVANCE DETERMINE WHAT SCREEN TO RETURN TO -  E N D
     C*
     C**     U  P  D  A  T  E      F  I  L  E  S
     C*
     C           ACTN      IFEQ 'I'
     C           ACTN      OREQ 'A'
     C           ACTN      OREQ 'D'
     C                     EXSR UPDFLS
     C                     END
     C*
     C/COPY WNCPYSRC,FF0180C008
     C** N O    D E T A I L   S C R E E N    E R R O R S   -  E N D
     C*
     C                     END
     C*
     C** E N T E R   O R   C M D 10                        -  E N D
     C*
     C                     END
     C*
     C** D O    U N T I L   C H A N G E  O F  S C R E E N  -  E N D
     C*
     C                     END
     C*
     C** RESET PROTECT/NON-DISPLAY INDS
     C*
     C                     MOVEA'00'      *IN,5
     C*
     C           XTUPDT    ENDSR                           ** XTUPDA ESR**
     C*================================================================
      /EJECT
     C*================================================================
      **           ****** AS400 CONVERSION ******                         S01179
      **                                                                  S01179
      ** ASCHGS S/R TO MOVE THE APPROPRIATE VALUES INTO FIELD AID,        S01179
      ** DEPENDING ON WHICH FUNCTION KEY HAS BEEN PRESSED.                S01179
      ** CALLED FROM UPDATE                                               S01179
      **                                                                  S01179
     C*================================================================   S01179
     C*                                                                   S01179
     C           ASCHGS    BEGSR                                          S01179
     C*                                                                   S01179
     C* If ENTER pressed, the VLDCMDKEY indicator will be off             S01179
     C*                                                                   S01179
     C           *IN55     IFEQ '0'                                       S01179
     C                     MOVE 'RA'      AID                             S01179
     C                     END                                            S01179
     C*                                                                   S01179
     C* If F3                                                             S01179
     C*                                                                   S01179
     C           *INKC     IFEQ '1'                                       S01179
     C                     MOVE '01'      AID                             S01179
     C                     MOVE '0'       *INKC                           S01179
     C                     END                                            S01179
     C*                                                                   S01179
     C* If F10                                                            S01179
     C*                                                                   S01179
     C           *INKJ     IFEQ '1'                                       S01179
     C                     MOVE '04'      AID                             S01179
     C                     MOVE '0'       *INKJ                           S01179
     C                     END                                            S01179
     C*                                                                   S01179
     C* If F12                                                            S01179
     C*                                                                   S01179
     C           *INKL     IFEQ '1'                                       S01179
      *                                                                                     BUG11811
      ** Set indicator 05 to *OFF. Action, Account key and Review from                      BUG11811
      **     are now open for input                                                         BUG11811
      *                                                                                     BUG11811
     C                     MOVE *OFF      *IN05                                             BUG11811
     C                     MOVE '05'      AID                             S01179
     C                     MOVE '0'       *INKL                           S01179
      *                                                                                       CSD031
     C           CSD034    IFEQ 'Y'                                                           CSD031
     C           WPGEMD    IFEQ 'A'                                                           CSD031
     C                     MOVEL'C'       WPGEMD                                              CSD031
     C                     MOVEL*OFF      *IN27                                               CSD031
     C                     MOVEL*ON       *IN20                                               CSD031
     C                     MOVEL*ON       *IN11                                               CSD031
     C                     ENDIF                                                              CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C                     END                                            S01179
     C*                                                                   S01179
     C* If ROLLUP pressed                                                 S01179
     C*                                                                   S01179
     C           *IN50     IFEQ '1'                                       S01179
     C                     MOVE 'UP'      AID                             S01179
     C                     MOVE '0'       *IN50                           S01179
     C                     END                                            S01179
     C*                                                                   S01179
     C* If ROLLDOWN pressed                                               S01179
     C*                                                                   S01179
     C           *IN51     IFEQ '1'                                       S01179
     C                     MOVE 'DN'      AID                             S01179
     C                     MOVE '0'       *IN51                           S01179
     C                     END                                            S01179
     C*                                                                   S01179
     C* If HELP key pressed                                               S01179
     C*                                                                   S01179
     C********** *IN52     IFEQ '1'                                S01179 S01199
     C**********           MOVE 'HP'      AID                      S01179 S01199
     C**********           MOVE '0'       *IN52                    S01179 S01199
     C**********           END                                     S01179 S01199
      *                                                                                       CSD031
      ** If F11                                                                               CSD031
      *                                                                                       CSD031
     C           *INU1     IFEQ '0'                                                           CSD031
     C           CSD034    ANDEQ'Y'                                                           CSD031
     C           *INKK     IFEQ *ON                                                           CSD031
     C                     MOVE '06'      AID                                                 CSD031
     C                     MOVE *OFF      *INKK                                               CSD031
     C                     ENDIF                                                              CSD031
     C                     ENDIF                                                              CSD031
     C*                                                                   S01179
     C                     ENDSR                                          S01179
     C*================================================================
      /EJECT
     C*================================================================
      ** VALIDK S/R TO VALIDATE KEY FIELDS
      ** CALLED FROM S/R START, REVIEW
      ** CALLS NO OTHER S/R'S
      **
     C*================================================================
     C*
     C           VALIDK    BEGSR                           ** VALIDK BSR**
     C*
     C** RESET ERROR INDICATORS
     C** SET ERROR ARRAY COUNTER TO ZERO
     C*
     C                     MOVEA'0000'    *IN,21
     C                     Z-ADD*ZERO     EC      40
     C*
     C** A C T I O N    C O D E    I N P U T - MUST BE BLANK,I,A,E,D
     C*
     C           ACTN      IFNE *BLANK
     C           ACTN      ANDNE'I'
     C           ACTN      ANDNE'A'
     C           ACTN      ANDNE'E'
     C           ACTN      ANDNE'D'
     C           ACTN      ANDNE'X'                                                           CSD031
     C                     ADD  1         EC         21
     C                     MOVEL' 100'    ERR,EC
     C*                                                                   S01117
     C                     ELSE                                           S01117
     C*                                                                   S01117
     C** SPF CHECKING ON ACTION CODE                                      S01117
     C*                                                                   S01117
     C           ACTN      IFNE *BLANK                                    S01117
     C*                                                                   S01117
     C** WHEN SINGLE BRANCH                                               S01117
     C           MBIN      IFNE 'Y'                                       S01117
     C*                                                                   S01117
     C                     CALL 'ZVACTU'                                  S01117
     C                     PARM ACTN      @ZACTN  1                       S01117
     C                     PARM           @ERR    10                      S01117
     C           @ERR      IFNE *ZERO                                     S01117
     C                     ADD  1         EC         21                   S01117
     C                     MOVEL' 303'    ERR,EC                          S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     ELSE                                           S01117
     C*                                                                   S01117
     C** WHEN MULTI-BRANCH                                                S01117
     C                     CALL 'ZVACTBU'                                 S01117
     C                     PARM ACTN      @ZACTN  1                       S01117
     C                     PARM USRBCH    @ZBR    3                       S01117
     C                     PARM           @ERR    10                      S01117
     C           @ERR      IFNE *ZERO                                     S01117
     C                     ADD  1         EC         21                   S01117
     C                     MOVEL' 304'    ERR,EC                          S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     END
     C** Action Code Input cannot be 'D' if SSF is on                     128512
     C           ACTN      IFEQ 'D'                                       128512
     C           SSF       ANDEQ'Y'                                       128512
     C                     ADD  1         EC         21                   128512
     C                     MOVEL' 101'    ERR,EC                          128512
     C                     END                                            128512
      *                                                                                       CSD031
     C           CSD034    IFEQ 'Y'                                                           CSD031
     C           ERRMSG    ANDEQ*BLANKS                                                       CSD031
      *                                                                                       CSD031
     C           ACTN      IFEQ 'A'                                                           CSD031
     C           WPGEMD    ANDEQ'A'                                                           CSD031
     C           *INU1     ANDEQ*OFF                                                          CSD031
     C                     ADD  1         EC         21                                       CSD031
     C                     MOVEL' 100'    ERR,EC                                              CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C           ACTN      IFEQ 'X'                                                           CSD031
     C           *INU1     ANDEQ*ON                                                           CSD031
     C                     ADD  1         EC         21                                       CSD031
     C                     MOVEL' 100'    ERR,EC                                              CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C           ACTN      IFEQ 'X'                                                           CSD031
     C           *INU1     ANDEQ*OFF                                                          CSD031
     C           WPGEMD    ANDEQ'C'                                                           CSD031
     C           ERRMSG    ANDEQ*BLANKS                                                       CSD031
     C                     ADD  1         EC         21                                       CSD031
     C                     MOVEL' 100'    ERR,EC                                              CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C           ACTN      IFEQ 'X'                                                           CSD031
     C           *INU1     ANDEQ*OFF                                                          CSD031
     C           ERRMSG    ANDEQ*BLANKS                                                       CSD031
     C           WPGEMD    ANDEQ'C'                                                           CSD031
     C                     ADD  1         EC         21                                       CSD031
     C                     MOVEL' 100'    ERR,EC                                              CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
      ** Endif -CSD034                                                                        CSD031
      *                                                                                       CSD031
     C                     ENDIF                                                              CSD031
     C*
     C** A C T I O N    C O D E    I N P U T - CHECK KEY FIELDS
     C*
     C           *IN,21    IFNE '1'
     C*
     C           ACTN      IFNE *BLANK
     C*CALCULATION SPECIFICATIONS:KEY VALIDATION***********************
     C*
      ** Only characters 0 to 9, A to Z, or blank are allowable
     C*                                                                   S01408
     C/COPY WNCPYSRC,FF0180CCP2                                           S01408
     C*                                                                   S01408
      *
     C                     MOVEAFFKY      AR
      *
     C                     Z-ADD0         X       20
      *
     C           X         DOUEQ14
     C           *IN25     OREQ '0'
      *
     C                     ADD  1         X
     C           AR,X      LOKUPTABACD                   25
      *
     C           *IN25     IFNE '1'
     C                     ADD  1         EC         22
     C                     MOVEA' 106'    ERR,EC
     C*                                                                   S01408
     C/COPY WNCPYSRC,FF0180CCP3                                           S01408
     C*                                                                   S01408
     C                     END
     C                     END
     C*                                                                   S01408
     C/COPY WNCPYSRC,FF0180CCP4                                           S01408
     C*                                                                   S01408
      *
     C                     ELSE
     C*
     C** ACTION CODE BLANK BUT KEY INPUT
     C*
     C           FFKY      IFNE *BLANK
     C*
     C                     ADD  1         EC         21
     C                     MOVEL' 102'    ERR,EC
     C*
     C                     END
     C                     END
     C*
     C                     END
     C*
     C** N O   E R R O R  O N  K E Y  F I E L D S
     C*
     C           *IN,22    IFNE '1'
     C           *IN,21    ANDNE'1'                                       S01117
     C*
     C** A C T I O N    C O D E    I
     C*
     C           ACTN      IFEQ 'I'
      *                                                                                       CSD031
     C           CSD034    IFEQ 'Y'                                                           CSD031
      *                                                                                       CSD031
     C           *INU1     IFEQ *OFF                                                          CSD031
     C           STAT      ANDEQ'D'                                                           CSD031
     C           WPGEMD    ANDEQ'A'                                                           CSD031
     C           WPGEMD    OREQ 'C'                                                           CSD031
     C                     ADD  1         EC         57                                       CSD031
     C                     MOVEL' 100'    ERR,EC                                              CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C           *INU1     IFEQ *OFF                                                          CSD031
     C           WPGEMD    ANDEQ'A'                                                           CSD031
      *                                                                                       CSD031
     C                     ADD  1         EC         57                                       CSD031
     C                     MOVEL' 100'    ERR,EC                                              CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C           *INU1     IFEQ *ON                                                           CSD031
     C           FACKYK    CHAINGPFAKYL1             99                                       CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C                     ELSE                                                               CSD031
     C           FACKYK    CHAINFACKYX               99
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C  N99      RECI      COMP '*'                      99
     C           *IN99     IFEQ '0'
     C           FFKY      OREQ *BLANK
     C                     MOVEA'111'     *IN,22
     C                     ADD  1         EC
     C                     MOVEL' 103'    ERR,EC
     C                     END
     C*
     C** A C T I O N    C O D E    A , D
     C*
     C                     ELSE
     C           ACTN      IFEQ 'A'
     C           ACTN      OREQ 'D'
      *                                                                                       CSD031
     C           CSD034    IFEQ 'Y'                                                           CSD031
      *                                                                                       CSD031
     C           *INU1     IFEQ *ON                                                           CSD031
     C           FACKYK    CHAINGPFFAKLX             99                                       CSD031
     C                     ELSE                                                               CSD031
     C           WPGEMD    IFEQ 'C'                                                           CSD031
     C           FACKYK    CHAINFACKYX               99                                       CSD031
      *                                                                                       CSD031
     C           FACKYK    CHAINSDAFAKLX             70                                       CSD031
     C           *IN70     IFEQ *OFF                                                          CSD031
     C                     ADD  1         EC                                                  CSD031
     C                     MOVEL'CSD0002' MSGNO   7                                           CSD031
     C                     MOVELWMSGQ1    MSGF   10                                           CSD031
     C                     EXSR SRRTTX                                                        CSD031
     C                     MOVELMSGTXT    ERRMSG                                              CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C                     ELSE                                                               CSD031
     C           ACTN      IFEQ 'D'                                                           CSD031
     C           FACKYK    CHAINSDAFAKLX             99                                       CSD031
     C                     ENDIF                                                              CSD031
     C                     ENDIF                                                              CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C                     ELSE                                                               CSD031
     C           FACKYK    CHAINFACKYX               99
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C           CSD034    IFEQ 'Y'                                                           CSD031
     C           *INU1     IFEQ *ON                                                           CSD031
      *                                                                                       CSD031
      ** For Global Zone only:Validation before deletion of record.If Accept to Zone is 'Y'   CSD031
      ** the record cannot be deleted. Display error message.                                 CSD031
      *                                                                                       CSD031
     C           ACTN      IFEQ 'D'                                                           CSD031
     C           AACC      IFEQ 'Y'                                                           CSD031
     C                     ADD  1         EC         57                                       CSD031
     C                     MOVEL' 205'    ERR,EC                                              CSD031
     C                     ENDIF                                                              CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
      ** Endif CSD034                                                                         CSD031
      *                                                                                       CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C           CSD034    IFEQ 'Y'                                                           CSD031
     C           WPGEMD    IFNE 'A'                                                           CSD031
     C  N99      RECI      COMP '*'                      99                                   CSD031
     C           *IN99     IFEQ '1'                                                           CSD031
     C                     MOVEA'111'     *IN,22                                              CSD031
     C                     ADD  1         EC                                                  CSD031
     C                     MOVEL' 104'    ERR,EC                                              CSD031
     C                     ENDIF                                                              CSD031
     C                     ENDIF                                                              CSD031
     C                     ELSE                                                               CSD031
     C  N99      RECI      COMP '*'                      99
     C           *IN99     IFEQ '1'
     C                     MOVEA'111'     *IN,22
     C                     ADD  1         EC
     C                     MOVEL' 104'    ERR,EC
     C                     END
     C                     ENDIF                                                              CSD031
     C*
     C** A C T I O N    C O D E    E
     C*
     C                     ELSE
     C           ACTN      IFEQ 'E'
      *                                                                                       CSD031
     C           CSD034    IFEQ 'Y'                                                           CSD031
      *                                                                                       CSD031
     C           *INU1     IFEQ *ON                                                           CSD031
     C           FACKYK    CHAINGPFAKYL1             99                                       CSD031
     C                     ELSE                                                               CSD031
     C           WPGEMD    IFEQ 'C'                                                           CSD031
     C           FACKYK    CHAINFACKYX               99                                       CSD031
     C                     ELSE                                                               CSD031
     C           FACKYK    CHAINSDAFAKLX             99                                       CSD031
     C                     ENDIF                                                              CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C                     ELSE                                                               CSD031
     C           FACKYK    CHAINFACKYX               99
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C           *IN99     IFEQ '1'
     C                     MOVEA'111'     *IN,22
     C                     ADD  1         EC
     C                     MOVEL' 105'    ERR,EC
     C                     END
      *                                                                                       CSD031
      ** A c t i o n    C o d e    X                                                          CSD031
      *                                                                                       CSD031
     C                     ELSE                                                               CSD031
     C           CSD034    IFEQ 'Y'                                                           CSD031
      *                                                                                       CSD031
     C           *INU1     IFEQ *OFF                                                          CSD031
     C           ACTN      IFEQ 'X'                                                           CSD031
      *                                                                                       CSD031
     C           WPGEMD    IFEQ 'A'                                                           CSD031
     C           FACKYK    CHAINSDAFAKLX             99                                       CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C           *IN99     IFEQ *ON                                                           CSD031
     C                     MOVEA'111'     *IN,22                                              CSD031
     C                     ADD  1         EC                                                  CSD031
     C                     MOVEL' 105'    ERR,EC                                              CSD031
     C                     ENDIF                                                              CSD031
     C                     ENDIF                                                              CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C                     ENDIF                                                              CSD031
     C*
     C                     END
     C                     END
     C                     END
     C*
     C                     END
     C*
     C** ERROR ON SCREEN SO HIGHLIGHT ERROR CODES
     C*
     C           EC        IFNE *ZERO
     C                     MOVELHI        ERRMSG
     C                     MOVEL*BLANK    AID
     C                     END
     C                     ENDSR
     C*================================================================
      /EJECT
     C*================================================================
      **
      ** VALIDD S/R - TO VALIDATE DETAIL SCREEN
      ** CALLED FROM UPDATE S/R
      ** CALLS: DEFLTS; ZEDIT; ZALIGN;
      **
     C*================================================================
     C*
     C           VALIDD    BEGSR
     C*
     C** RESET SCREEN ERROR INDICATORS
     C*
     C                     MOVEA'00000000'*IN,30
     C                     MOVEA'00000000'*IN,38
     C                     MOVEA'000'     *IN,46
     C           CSD034    IFEQ 'Y '                                                          CSD031
     C                     MOVEA'000'     *IN,57                                              CSD031
     C                     ENDIF                                                              CSD031
     C/COPY WNCPYSRC,FF0180C002
     C*
     C** SET ERROR COUNT TO ZERO
     C*
     C                     Z-ADD*ZERO     EC
     C*
     C** ENTER KEY PRESSSED
     C*
     C           AID       IFEQ 'RA'
     C*
     C** ACTION = I OR A
     C*
     C           ACTN      IFEQ 'I'
     C           ACTN      OREQ 'A'
      *                                                                                       CSD031
      ** For Global enhancement                                                               CSD031
      *                                                                                       CSD031
     C           ACTN      OREQ 'X'                                                           CSD031
     C*
     C** DO DEFAULTS
     C*
     C                     EXSR DEFLTS
     C*
     C** VALIDATION OF FIELDS FOR INSERT/AMEND
     C*
     C*
     C*  VALIDATE SACD1
     C*
     C           SACD1     IFNE *BLANKS
      ***********                                                         S01117
      ***If*entered,*the*account*code*must*exist*on*TABTE10               S01117
      ***********                                                         S01117
     C***********          MOVE SACD1     SACD                            S01117
     C***********KEY       CHAINTABTE10F             26                   S01117
     C***********                                                         S01117
     C************IN26     IFEQ '1'                                       S01117
      *                                                                   S01117
      ** If entered, the account code must exist                          S01117
      *                                                                   S01117
      ** Use Global Access Object when it comes from the global layer                         CSD031
      *                                                                                       CSD031
     C           CSD034    IFEQ 'Y'                                                           CSD031
     C           *INU1     ANDEQ*ON                                                           CSD031
     C                     CALL 'AOGACDR0'                                                    CSD031
     C                     PARM *BLANKS   @RTCD                                               CSD031
     C                     PARM '*KEY   ' @OPTN                                               CSD031
     C                     PARM SACD1     @AFNB                                               CSD031
     C           GPACOD    PARM GPACOD    DSSDY                                               CSD031
     C                     ELSE                                                               CSD031
      *                                                                                       CSD031
     C                     CALL 'AOACODR0'                                S01117
     C                     PARM *BLANKS   @RTCD   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C**********           PARM SACD1     @AFNB   4                                    S01117 CGL029
     C                     PARM SACD1     @AFNB  10                                           CGL029
     C********** SDACOD    PARM SDACOD    @DSFDY                                       S01117 CGL029
     C           SDACOD    PARM SDACOD    DSSDY                                               CGL029
      *                                                                                       CSD031
     C                     ENDIF                                                              CSD031
     C*                                                                   S01117
     C           @RTCD     IFNE *BLANK                                    S01117
     C                     MOVE '1'       *IN30
     C                     ADD  1         EC         31
     C                     MOVEL' 200'    ERR,EC
     C                     ELSE
      *
      ** Must be blank if the posting reference = 2
      *
     C           SPRF1     IFEQ '2'
     C                     MOVE '1'       *IN30
     C                     ADD  1         EC         31
     C                     MOVEL' 200'    ERR,EC
     C                     END
     C                     END
     C                     END
      *
      ** If not in error, translate from screen to file layout
      *
     C           *IN31     IFNE '1'
     C           SACD1     IFEQ *BLANKS                                   S01117
     C                     MOVELSACD1     ACD1
     C                     ELSE                                           S01117
      *                                                                                       CSD031
      ** Get the details from the Global Layer                                                CSD031
      *                                                                                       CSD031
     C           CSD034    IFEQ 'Y'                                                           CSD031
     C           *INU1     IFEQ *ON                                                           CSD031
     C                     MOVELACGACD    SACD1                                               CSD031
     C                     MOVELACGACD    ACD1                                                CSD031
     C                     ELSE                                                               CSD031
     C           WPGEMD    IFEQ 'A'                                                           CSD031
     C                     MOVELWACD1     ACD1                                                CSD031
     C                     ENDIF                                                              CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
      ** Get the details from the Zonal Layer                                                 CSD031
      *                                                                                       CSD031
     C                     ELSE                                                               CSD031
     C                     MOVELA5ACCD    SACD1                           S01117
     C                     MOVELA5ACCD    ACD1                            S01117
     C                     ENDIF                                                              CSD031
     C                     END                                            S01117
     C                     END
     C*
     C* VALIDATE SACD2
     C*
     C           SACD2     IFNE *BLANKS
      ***********                                                         S01117
      ***If*entered,*the*account*code*must*exist*on*TABTE10               S01117
      ***********                                                         S01117
     C***********          MOVE SACD2     SACD                            S01117
     C***********KEY       CHAINTABTE10F             26                   S01117
     C***********                                                         S01117
     C************IN26     IFEQ '1'                                       S01117
      *                                                                   S01117
      ** If entered, the account code must exist                          S01117
      *                                                                   S01117
      ** Use Global Access Object when it comes from the global layer                         CSD031
      *                                                                                       CSD031
     C           CSD034    IFEQ 'Y'                                                           CSD031
     C           *INU1     ANDEQ*ON                                                           CSD031
     C                     CALL 'AOGACDR0'                                                    CSD031
     C                     PARM *BLANKS   @RTCD                                               CSD031
     C                     PARM '*KEY   ' @OPTN                                               CSD031
     C                     PARM SACD2     @AFNB                                               CSD031
     C           GPACOD    PARM GPACOD    DSSDY                                               CSD031
     C                     ELSE                                                               CSD031
      *                                                                                       CSD031
     C                     CALL 'AOACODR0'                                S01117
     C                     PARM *BLANKS   @RTCD   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C**********           PARM SACD2     @AFNB   4                                    S01117 CGL029
     C                     PARM SACD2     @AFNB                                               CGL029
     C********** SDACOD    PARM SDACOD    @DSFDY                                       S01117 CGL029
     C           SDACOD    PARM SDACOD    DSSDY                                               CGL029
     C                     ENDIF                                                              CSD031
     C*                                                                   S01117
     C           @RTCD     IFNE *BLANK                                    S01117
     C                     ADD  1         EC         32
     C**********           MOVEL' 203'    ERR,EC                          E22049
     C                     MOVEL' 200'    ERR,EC                          E22049
     C                     ELSE
      *
      ** Must be blank if the posting reference = 2
      *
     C           SPRF2     IFEQ '2'
     C                     ADD  1         EC         32
     C***********          MOVEL' 203'    ERR,EC                          E22049
     C                     MOVEL' 200'    ERR,EC                          E22049
     C                     END
     C                     END
     C                     END
      *
      ** If not in error, translate from screen to file layout
      *
     C           *IN32     IFNE '1'
     C           SACD2     IFEQ *BLANKS                                   S01117
     C                     MOVELSACD2     ACD2
     C                     ELSE                                           S01117
      *                                                                                       CSD031
      ** Get the details from the Global Layer                                                CSD031
      *                                                                                       CSD031
     C           CSD034    IFEQ 'Y'                                                           CSD031
     C           *INU1     IFEQ *ON                                                           CSD031
     C                     MOVELACGACD    SACD2                                               CSD031
     C                     MOVELACGACD    ACD2                                                CSD031
     C                     ELSE                                                               CSD031
     C           WPGEMD    IFEQ 'A'                                                           CSD031
     C                     MOVELWACD2     ACD2                                                CSD031
     C                     ENDIF                                                              CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
      ** Get the details from the Zonal Layer                                                 CSD031
      *                                                                                       CSD031
     C                     ELSE                                                               CSD031
     C                     MOVELA5ACCD    SACD2                           S01117
     C                     MOVELA5ACCD    ACD2                            S01117
     C                     ENDIF                                                              CSD031
     C                     END                                            S01117
     C                     END
     C*
     C* VALIDATE SACD3
     C*
     C           SACD3     IFNE *BLANKS
      ***********                                                         S01117
      ***If*entered,*the*account*code*must*exist*on*TABTE10               S01117
      ***********                                                         S01117
     C***********          MOVE SACD3     SACD                            S01117
     C***********KEY       CHAINTABTE10F             26                   S01117
     C***********                                                         S01117
     C************IN26     IFEQ '1'                                       S01117
      *                                                                   S01117
      ** If entered, the account code must exist                          S01117
      *                                                                   S01117
      ** Use Global Access Object when it comes from the global layer                         CSD031
      *                                                                                       CSD031
     C           CSD034    IFEQ 'Y'                                                           CSD031
     C           *INU1     ANDEQ*ON                                                           CSD031
     C                     CALL 'AOGACDR0'                                                    CSD031
     C                     PARM *BLANKS   @RTCD                                               CSD031
     C                     PARM '*KEY   ' @OPTN                                               CSD031
     C                     PARM SACD3     @AFNB                                               CSD031
     C           GPACOD    PARM GPACOD    DSSDY                                               CSD031
     C                     ELSE                                                               CSD031
      *                                                                                       CSD031
     C                     CALL 'AOACODR0'                                S01117
     C                     PARM *BLANKS   @RTCD   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C**********           PARM SACD3     @AFNB   4                                    S01117 CGL029
     C                     PARM SACD3     @AFNB                                               CGL029
     C********** SDACOD    PARM SDACOD    @DSFDY                                       S01117 CGL029
     C           SDACOD    PARM SDACOD    DSSDY                                               CGL029
     C                     ENDIF                                                              CSD031
     C*                                                                   S01117
     C           @RTCD     IFNE *BLANK                                    S01117
     C                     ADD  1         EC         33
     C***********          MOVEL' 206'    ERR,EC                          E22049
     C                     MOVEL' 200'    ERR,EC                          E22049
     C                     ELSE
      *
      ** Must be blank if the posting reference = 2
      *
     C           SPRF3     IFEQ '2'
     C                     ADD  1         EC         33
     C***********          MOVEL' 206'    ERR,EC                          E22049
     C                     MOVEL' 200'    ERR,EC                          E22049
     C                     END
     C                     END
     C                     END
      *
      ** If not in error, translate from screen to file layout
      *
     C           *IN33     IFNE '1'
     C           SACD3     IFEQ *BLANKS                                   S01117
     C                     MOVELSACD3     ACD3
     C                     ELSE                                           S01117
      *                                                                                       CSD031
      ** Get the details from the Global Layer                                                CSD031
      *                                                                                       CSD031
     C           CSD034    IFEQ 'Y'                                                           CSD031
     C           *INU1     IFEQ *ON                                                           CSD031
     C                     MOVELACGACD    SACD3                                               CSD031
     C                     MOVELACGACD    ACD3                                                CSD031
     C                     ELSE                                                               CSD031
     C           WPGEMD    IFEQ 'A'                                                           CSD031
     C                     MOVELWACD3     ACD3                                                CSD031
     C                     ENDIF                                                              CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
      ** Get the details from the Zonal Layer                                                 CSD031
      *                                                                                       CSD031
     C                     ELSE                                                               CSD031
     C                     MOVELA5ACCD    SACD3                           S01117
     C                     MOVELA5ACCD    ACD3                            S01117
     C                     ENDIF                                                              CSD031
     C                     END                                            S01117
     C                     END
     C*
     C* VALIDATE SACD4
     C*
     C           SACD4     IFNE *BLANKS
      ***********                                                         S01117
      ***If*entered,*the*account*code*must*exist*on*TABTE10               S01117
      ***********                                                         S01117
     C***********          MOVE SACD4     SACD                            S01117
     C***********KEY       CHAINTABTE10F             26                   S01117
     C***********                                                         S01117
     C************IN26     IFEQ '1'                                       S01117
      *                                                                   S01117
      ** If entered, the account code must exist                          S01117
      *                                                                   S01117
      ** Use Global Access Object when it comes from the global layer                         CSD031
      *                                                                                       CSD031
     C           CSD034    IFEQ 'Y'                                                           CSD031
     C           *INU1     ANDEQ*ON                                                           CSD031
     C                     CALL 'AOGACDR0'                                                    CSD031
     C                     PARM *BLANKS   @RTCD                                               CSD031
     C                     PARM '*KEY   ' @OPTN                                               CSD031
     C                     PARM SACD4     @AFNB                                               CSD031
     C           GPACOD    PARM GPACOD    DSSDY                                               CSD031
     C                     ELSE                                                               CSD031
      *                                                                                       CSD031
     C                     CALL 'AOACODR0'                                S01117
     C                     PARM *BLANKS   @RTCD   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C**********           PARM SACD4     @AFNB   4                                    S01117 CGL029
     C                     PARM SACD4     @AFNB                                               CGL029
     C********** SDACOD    PARM SDACOD    @DSFDY                                       S01117 CGL029
     C           SDACOD    PARM SDACOD    DSSDY                                               CGL029
     C                     ENDIF                                                              CSD031
     C*                                                                   S01117
     C           @RTCD     IFNE *BLANK                                    S01117
     C                     ADD  1         EC         34
     C***********          MOVEL' 209'    ERR,EC                          E22049
     C                     MOVEL' 200'    ERR,EC                          E22049
     C                     ELSE
      *
      ** Must be blank if the posting reference = 2
      *
     C           SPRF4     IFEQ '2'
     C                     ADD  1         EC         34
     C***********          MOVEL' 209'    ERR,EC                          E22049
     C                     MOVEL' 200'    ERR,EC                          E22049
     C                     END
     C                     END
     C                     END
      *
      ** If not in error, translate from screen to file layout
      *
     C           *IN34     IFNE '1'
     C           SACD4     IFEQ *BLANKS                                   S01117
     C                     MOVELSACD4     ACD4
     C                     ELSE                                           S01117
      *                                                                                       CSD031
      ** Get the details from the Global Layer                                                CSD031
      *                                                                                       CSD031
     C           CSD034    IFEQ 'Y'                                                           CSD031
     C           *INU1     IFEQ *ON                                                           CSD031
     C                     MOVELACGACD    SACD4                                               CSD031
     C                     MOVELACGACD    ACD4                                                CSD031
     C                     ELSE                                                               CSD031
     C           WPGEMD    IFEQ 'A'                                                           CSD031
     C                     MOVELWACD4     ACD4                                                CSD031
     C                     ENDIF                                                              CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
      ** Get the details from the Zonal Layer                                                 CSD031
      *                                                                                       CSD031
     C                     ELSE                                                               CSD031
     C                     MOVELA5ACCD    SACD4                           S01117
     C                     MOVELA5ACCD    ACD4                            S01117
     C                     ENDIF                                                              CSD031
     C                     END                                            S01117
     C                     END
     C*
     C* VALIDATE SACD5
     C*
     C           SACD5     IFNE *BLANKS
      ***********                                                         S01117
      ***If*entered,*the*account*code*must*exist*on*TABTE10               S01117
      ***********                                                         S01117
     C***********          MOVE SACD5     SACD                            S01117
     C***********KEY       CHAINTABTE10F             26                   S01117
     C***********                                                         S01117
     C************IN26     IFEQ '1'                                       S01117
      *                                                                   S01117
      ** If entered, the account code must exist                          S01117
      *                                                                   S01117
      ** Use Global Access Object when it comes from the global layer                         CSD031
      *                                                                                       CSD031
     C           CSD034    IFEQ 'Y'                                                           CSD031
     C           *INU1     ANDEQ*ON                                                           CSD031
     C                     CALL 'AOGACDR0'                                                    CSD031
     C                     PARM *BLANKS   @RTCD                                               CSD031
     C                     PARM '*KEY   ' @OPTN                                               CSD031
     C                     PARM SACD5     @AFNB                                               CSD031
     C           GPACOD    PARM GPACOD    DSSDY                                               CSD031
     C                     ELSE                                                               CSD031
      *                                                                                       CSD031
     C                     CALL 'AOACODR0'                                S01117
     C                     PARM *BLANKS   @RTCD   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C**********           PARM SACD5     @AFNB   4                                    S01117 CGL029
     C                     PARM SACD5     @AFNB                                               CGL029
     C********** SDACOD    PARM SDACOD    @DSFDY                                       S01117 CGL029
     C           SDACOD    PARM SDACOD    DSSDY                                               CGL029
     C                     ENDIF                                                              CSD031
     C*                                                                   S01117
     C           @RTCD     IFNE *BLANK                                    S01117
     C                     ADD  1         EC         35
     C***********          MOVEL' 212'    ERR,EC                          E22049
     C                     MOVEL' 200'    ERR,EC                          E22049
     C                     ELSE
      *
      ** Must be blank if the posting reference = 2
      *
     C           SPRF5     IFEQ '2'
     C                     ADD  1         EC         35
     C***********          MOVEL' 212'    ERR,EC                          E22049
     C                     MOVEL' 200'    ERR,EC                          E22049
     C                     END
     C                     END
     C                     END
      *
      ** If not in error, translate from screen to file layout
      *
     C           *IN35     IFNE '1'
     C           SACD5     IFEQ *BLANKS                                   S01117
     C                     MOVELSACD5     ACD5
     C                     ELSE                                           S01117
      *                                                                                       CSD031
      ** Get the details from the Global Layer                                                CSD031
      *                                                                                       CSD031
     C           CSD034    IFEQ 'Y'                                                           CSD031
     C           *INU1     IFEQ *ON                                                           CSD031
     C                     MOVELACGACD    SACD5                                               CSD031
     C                     MOVELACGACD    ACD5                                                CSD031
     C                     ELSE                                                               CSD031
     C           WPGEMD    IFEQ 'A'                                                           CSD031
     C                     MOVELWACD5     ACD5                                                CSD031
     C                     ENDIF                                                              CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
      ** Get the details from the Zonal Layer                                                 CSD031
      *                                                                                       CSD031
     C                     ELSE                                                               CSD031
     C                     MOVELA5ACCD    SACD5                           S01117
     C                     MOVELA5ACCD    ACD5                            S01117
     C                     ENDIF                                                              CSD031
     C                     END                                            S01117
     C                     END
     C*
     C* VALIDATE SACD6
     C*
     C           SACD6     IFNE *BLANKS
      ***********                                                         S01117
      ***If*entered,*the*account*code*must*exist*on*TABTE10               S01117
      ***********                                                         S01117
     C***********          MOVE SACD6     SACD                            S01117
     C***********KEY       CHAINTABTE10F             26                   S01117
     C***********                                                         S01117
     C************IN26     IFEQ '1'                                       S01117
      *                                                                   S01117
      ** If entered, the account code must exist                          S01117
      *                                                                   S01117
      ** Use Global Access Object when it comes from the global layer                         CSD031
      *                                                                                       CSD031
     C           CSD034    IFEQ 'Y'                                                           CSD031
     C           *INU1     ANDEQ*ON                                                           CSD031
     C                     CALL 'AOGACDR0'                                                    CSD031
     C                     PARM *BLANKS   @RTCD                                               CSD031
     C                     PARM '*KEY   ' @OPTN                                               CSD031
     C                     PARM SACD6     @AFNB                                               CSD031
     C           GPACOD    PARM GPACOD    DSSDY                                               CSD031
     C                     ELSE                                                               CSD031
      *                                                                                       CSD031
     C                     CALL 'AOACODR0'                                S01117
     C                     PARM *BLANKS   @RTCD   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C**********           PARM SACD6     @AFNB   4                                    S01117 CGL029
     C                     PARM SACD6     @AFNB                                               CGL029
     C********** SDACOD    PARM SDACOD    @DSFDY                                       S01117 CGL029
     C           SDACOD    PARM SDACOD    DSSDY                                               CGL029
     C                     ENDIF                                                              CSD031
     C*                                                                   S01117
     C           @RTCD     IFNE *BLANK                                    S01117
     C                     ADD  1         EC         36
     C***********          MOVEL' 215'    ERR,EC                          E22049
     C                     MOVEL' 200'    ERR,EC                          E22049
     C                     ELSE
      *
      ** Must be blank if the posting reference = 2
      *
     C           SPRF6     IFEQ '2'
     C                     ADD  1         EC         36
     C***********          MOVEL' 215'    ERR,EC                          E22049
     C                     MOVEL' 200'    ERR,EC                          E22049
     C                     END
     C                     END
     C                     END
      *
      ** If not in error, translate from screen to file layout
      *
     C           *IN36     IFNE '1'
     C           SACD6     IFEQ *BLANKS                                   S01117
     C                     MOVELSACD6     ACD6
     C                     ELSE                                           S01117
      *                                                                                       CSD031
      ** Get the details from the Global Layer                                                CSD031
      *                                                                                       CSD031
     C           CSD034    IFEQ 'Y'                                                           CSD031
     C           *INU1     IFEQ *ON                                                           CSD031
     C                     MOVELACGACD    SACD6                                               CSD031
     C                     MOVELACGACD    ACD6                                                CSD031
     C                     ELSE                                                               CSD031
     C           WPGEMD    IFEQ 'A'                                                           CSD031
     C                     MOVELWACD6     ACD6                                                CSD031
     C                     ENDIF                                                              CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
      ** Get the details from the Zonal Layer                                                 CSD031
      *                                                                                       CSD031
     C                     ELSE                                                               CSD031
     C                     MOVELA5ACCD    SACD6                           S01117
     C                     MOVELA5ACCD    ACD6                            S01117
     C                     ENDIF                                                              CSD031
     C                     END                                            S01117
     C                     END
     C*
     C* VALIDATE SNRC1
     C*
      *
      ** Narrative code must not be entered if the posting reference is
      *  blank
     C           SNRC1     IFNE *BLANKS
     C           SPRF1     IFEQ *BLANKS
     C                     ADD  1         EC         37
     C                     MOVEL' 201'    ERR,EC
     C                     ELSE
      *
      ***It*must*be*numeric***********                                    E23097
     C*********************MOVE '0'       WRK3A   3                       E23097
     C*********************MOVELSNRC1     WRK3A                           E23097
     C*********************TESTN          WRK3A      27                   E23097
     C************IN27*****IFEQ '1'                                       E23097
      *
      ** It must exist on TABLETP
      *
     C*********************MOVE SNRC1     SNRC    20                      E23097
     C                     MOVE SNRC1     SNRC    2                       E23097
     C           CSD034    IFEQ 'Y'                                                           CSD031
     C********** *INU1     ANDEQ*ON                                                  CSD031 BUG12272
     C           *INU1     IFEQ *ON                                                         BUG12272
     C********** SNRC      CHAINSDNARRD0             26                              CSD031 MD058769
     C                     CALL 'AONARRR0'                                                  MD058769
     C                     PARM *BLANKS   @RTCD                                             MD058769
     C                     PARM '*KEY    '@OPTN                                             MD058769
     C                     PARM SNRC      @NRCD   2                                         MD058769
     C           SDNARR    PARM SDNARR    @DSFDY                                            MD058769
     C                     SETOF                     26                                     MD058769
     C           @RTCD     IFNE *BLANKS                                                     MD058769
     C                     SETON                     26                                     MD058769
     C                     ENDIF                                                            MD058769
      *                                                                                     MD058769
     C                     ELSE                                                             BUG12272
      ** If CSD034 is *ON, use SDNARRPD instead of TABLETP                                  BUG12272
     C********** SNRC      CHAIN@ALRECZ              26                            BUG12272 MD058769
     C                     CALL 'AONARRR0'                                                  MD058769
     C                     PARM *BLANKS   @RTCD                                             MD058769
     C                     PARM '*KEY    '@OPTN                                             MD058769
     C                     PARM SNRC      @NRCD   2                                         MD058769
     C           SDNARR    PARM SDNARR    @DSFDY                                            MD058769
     C                     SETOF                     26                                     MD058769
     C           @RTCD     IFNE *BLANKS                                                     MD058769
     C                     SETON                     26                                     MD058769
     C                     ENDIF                                                            MD058769
      *                                                                                     MD058769
     C                     ENDIF                                                            BUG12272
      *                                                                                     BUG12272
     C                     ELSE                                                               CSD031
     C********** SNRC      CHAINTABLETPF             26                                     MD058769
     C                     CALL 'AONARRR0'                                                  MD058769
     C                     PARM *BLANKS   @RTCD                                             MD058769
     C                     PARM '*KEY    '@OPTN                                             MD058769
     C                     PARM SNRC      @NRCD   2                                         MD058769
     C           SDNARR    PARM SDNARR    @DSFDY                                            MD058769
     C                     SETOF                     26                                     MD058769
     C           @RTCD     IFNE *BLANKS                                                     MD058769
     C                     SETON                     26                                     MD058769
     C                     ENDIF                                                            MD058769
      *                                                                                     MD058769
     C                     ENDIF                                                              CSD031
     C*
     C           *IN26     IFEQ '1'
     C                     ADD  1         EC         37
     C                     MOVEL' 201'    ERR,EC
     C                     END
      *
     C*********************ELSE*******                                    E23097
      *
      ***or*on*TABNRC*****************                                    E23097
     C***********SNRC1*****LOKUPTABNRC                   25               E23097
     C************IN25*****IFEQ '0'                                       E23097
     C*********************ADD  1         EC         37                   E23097
     C*********************MOVEL' 201'    ERR,EC                          E23097
     C*********************END                                            E23097
     C*********************END                                            E23097
      *
     C                     END
      *
     C                     ELSE
      *
      ** It must be entered if the posting reference has been entered
      *
     C           SPRF1     IFNE *BLANKS
     C                     ADD  1         EC         37
     C                     MOVEL' 201'    ERR,EC
     C                     END
     C                     END
      *
      ** If not in error, translate from screen to file layout
      *
     C           *IN37     IFNE '1'
     C                     MOVELSNRC1     NRC1
     C                     END
     C*
     C* VALIDATE SNRC2
     C*
      *
      ** Narrative code must not be entered if the posting reference is
      *  blank
     C           SNRC2     IFNE *BLANKS
     C           SPRF2     IFEQ *BLANKS
     C                     ADD  1         EC         38
     C***********          MOVEL' 204'    ERR,EC                          E22049
     C                     MOVEL' 201'    ERR,EC                          E22049
     C                     ELSE
      *
      ***It*must*be*numeric********                                       E23097
     C*********************MOVE '0'       WRK3A                           E23097
     C*********************MOVELSNRC2     WRK3A                           E23097
     C*********************TESTN          WRK3A      27                   E23097
     C************IN27*****IFEQ '1'                                       E23097
      *
      ** It must exist on TABLETP
      *
     C                     MOVE SNRC2     SNRC
     C           CSD034    IFEQ 'Y'                                                           CSD031
     C********** *INU1     ANDEQ*ON                                                  CSD031 BUG12272
     C           *INU1     IFEQ *ON                                                         BUG12272
     C********** SNRC      CHAINSDNARRD0             26                              CSD031 MD058769
     C                     CALL 'AONARRR0'                                                  MD058769
     C                     PARM *BLANKS   @RTCD                                             MD058769
     C                     PARM '*KEY    '@OPTN                                             MD058769
     C                     PARM SNRC      @NRCD   2                                         MD058769
     C           SDNARR    PARM SDNARR    @DSFDY                                            MD058769
     C                     SETOF                     26                                     MD058769
     C           @RTCD     IFNE *BLANKS                                                     MD058769
     C                     SETON                     26                                     MD058769
     C                     ENDIF                                                            MD058769
      *                                                                                     MD058769
     C                     ELSE                                                             BUG12272
      ** If CSD034 is *ON, use SDNARRPD instead of TABLETP                                  BUG12272
     C********** SNRC      CHAIN@ALRECZ              26                            BUG12272 MD058769
     C                     CALL 'AONARRR0'                                                  MD058769
     C                     PARM *BLANKS   @RTCD                                             MD058769
     C                     PARM '*KEY    '@OPTN                                             MD058769
     C                     PARM SNRC      @NRCD   2                                         MD058769
     C           SDNARR    PARM SDNARR    @DSFDY                                            MD058769
     C                     SETOF                     26                                     MD058769
     C           @RTCD     IFNE *BLANKS                                                     MD058769
     C                     SETON                     26                                     MD058769
     C                     ENDIF                                                            MD058769
      *                                                                                     MD058769
     C                     ENDIF                                                            BUG12272
      *                                                                                     BUG12272
     C                     ELSE                                                               CSD031
     C********** SNRC      CHAINTABLETPF             26                                     MD058769
     C                     CALL 'AONARRR0'                                                  MD058769
     C                     PARM *BLANKS   @RTCD                                             MD058769
     C                     PARM '*KEY    '@OPTN                                             MD058769
     C                     PARM SNRC      @NRCD   2                                         MD058769
     C           SDNARR    PARM SDNARR    @DSFDY                                            MD058769
     C                     SETOF                     26                                     MD058769
     C           @RTCD     IFNE *BLANKS                                                     MD058769
     C                     SETON                     26                                     MD058769
     C                     ENDIF                                                            MD058769
      *                                                                                     MD058769
     C                     ENDIF                                                              CSD031
     C*
     C           *IN26     IFEQ '1'
     C                     ADD  1         EC         38
     C***********          MOVEL' 204'    ERR,EC                          E22049
     C                     MOVEL' 201'    ERR,EC                          E22049
     C                     END
      *
     C*********************ELSE                                           E23097
      *
      *
      ***or*on*TABNRC***********                                          E23097
     C***********SNRC2*****LOKUPTABNRC                   25               E23097
     C************IN25*****IFEQ '0'                                       E23097
     C*********************ADD  1         EC         38                   E23097
     C*********************MOVEL' 204'    ERR,EC                          E22049
     C*********************MOVEL' 201'    ERR,EC                    E22049E23097
     C*********************END                                            E23097
     C*********************END                                            E23097
     C                     END
     C                     ELSE
      *
      ** It must be entered if the posting reference has been entered
      *
     C           SPRF2     IFNE *BLANKS
     C                     ADD  1         EC         38
     C***********          MOVEL' 204'    ERR,EC                          E22049
     C                     MOVEL' 201'    ERR,EC                          E22049
     C                     END
     C                     END
      *
      ** If not in error, translate from screen to file layout
      *
     C           *IN38     IFNE '1'
     C                     MOVELSNRC2     NRC2
     C                     END
     C*
     C* VALIDATE SNRC3
     C*
      *
      ** Narrative code must not be entered if the posting reference is
      *  blank
     C           SNRC3     IFNE *BLANKS
     C           SPRF3     IFEQ *BLANKS
     C                     ADD  1         EC         39
     C***********          MOVEL' 207'    ERR,EC                          E22049
     C                     MOVEL' 201'    ERR,EC                          E22049
     C                     ELSE
      *
      ***It*must*be*numeric**********                                     E23097
     C*********************MOVE '0'       WRK3A                           E23097
     C*********************MOVELSNRC3     WRK3A                           E23097
     C*********************TESTN          WRK3A      27                   E23097
     C************IN27*****IFEQ '1'                                       E23097
      *
      ** It must exist on TABLETP
      *
     C                     MOVE SNRC3     SNRC
     C           CSD034    IFEQ 'Y'                                                           CSD031
     C********** *INU1     ANDEQ*ON                                                  CSD031 BUG12272
     C           *INU1     IFEQ *ON                                                         BUG12272
     C********** SNRC      CHAINSDNARRD0             26                              CSD031 MD058769
     C                     CALL 'AONARRR0'                                                  MD058769
     C                     PARM *BLANKS   @RTCD                                             MD058769
     C                     PARM '*KEY    '@OPTN                                             MD058769
     C                     PARM SNRC      @NRCD   2                                         MD058769
     C           SDNARR    PARM SDNARR    @DSFDY                                            MD058769
     C                     SETOF                     26                                     MD058769
     C           @RTCD     IFNE *BLANKS                                                     MD058769
     C                     SETON                     26                                     MD058769
     C                     ENDIF                                                            MD058769
      *                                                                                     MD058769
     C                     ELSE                                                             BUG12272
      ** If CSD034 is *ON, use SDNARRPD instead of TABLETP                                  BUG12272
     C********** SNRC      CHAIN@ALRECZ              26                            BUG12272 MD058769
     C                     CALL 'AONARRR0'                                                  MD058769
     C                     PARM *BLANKS   @RTCD                                             MD058769
     C                     PARM '*KEY    '@OPTN                                             MD058769
     C                     PARM SNRC      @NRCD   2                                         MD058769
     C           SDNARR    PARM SDNARR    @DSFDY                                            MD058769
     C                     SETOF                     26                                     MD058769
     C           @RTCD     IFNE *BLANKS                                                     MD058769
     C                     SETON                     26                                     MD058769
     C                     ENDIF                                                            MD058769
      *                                                                                     MD058769
     C                     ENDIF                                                            BUG12272
      *                                                                                     BUG12272
     C                     ELSE                                                               CSD031
     C********** SNRC      CHAINTABLETPF             26                                     MD058769
     C                     CALL 'AONARRR0'                                                  MD058769
     C                     PARM *BLANKS   @RTCD                                             MD058769
     C                     PARM '*KEY    '@OPTN                                             MD058769
     C                     PARM SNRC      @NRCD   2                                         MD058769
     C           SDNARR    PARM SDNARR    @DSFDY                                            MD058769
     C                     SETOF                     26                                     MD058769
     C           @RTCD     IFNE *BLANKS                                                     MD058769
     C                     SETON                     26                                     MD058769
     C                     ENDIF                                                            MD058769
      *                                                                                     MD058769
     C                     ENDIF                                                              CSD031
     C*
     C           *IN26     IFEQ '1'
     C                     ADD  1         EC         39
     C***********          MOVEL' 207'    ERR,EC                          E22049
     C                     MOVEL' 201'    ERR,EC                          E22049
     C                     END
      *
     C*********************ELSE                                           E23097
      *
      ***or*on*TABNRC**********                                           E23097
     C***********SNRC3*****LOKUPTABNRC                   25               E23097
     C************IN25*****IFEQ '0'                                       E23097
     C*********************ADD  1         EC         39                   E23097
      *
     C***********          MOVEL' 207'    ERR,EC                          E22049
     C***********          MOVEL' 201'    ERR,EC                    E22409E20397
     C*********************END                                            E23097
     C*********************END                                            E23097
     C                     END
     C                     ELSE
      *
      ** It must be entered if the posting reference has been entered
      *
     C           SPRF3     IFNE *BLANKS
     C                     ADD  1         EC         39
     C***********          MOVEL' 207'    ERR,EC                          E22049
     C                     MOVEL' 201'    ERR,EC                          E22049
     C                     END
     C                     END
      *
      ** If not in error, translate from screen to file layout
      *
     C           *IN39     IFNE '1'
     C                     MOVELSNRC3     NRC3
     C                     END
     C*
     C* VALIDATE SNRC4
     C*
      *
      ** Narrative code must not be entered if the posting reference is
      *  blank
     C           SNRC4     IFNE *BLANKS
     C           SPRF4     IFEQ *BLANKS
     C                     ADD  1         EC         40
     C***********          MOVEL' 210'    ERR,EC                          E22049
     C                     MOVEL' 201'    ERR,EC                          E22049
     C                     ELSE
      *
      ***It*must*be*numeric**********                                     E23097
     C*********************MOVE '0'       WRK3A                           E23097
     C*********************MOVELSNRC4     WRK3A                           E23097
     C*********************TESTN          WRK3A      27                   E23097
     C************IN27*****IFEQ '1'                                       E23097
      *
      ** It must exist on TABLETP
      *
     C                     MOVE SNRC4     SNRC
     C           CSD034    IFEQ 'Y'                                                           CSD031
     C********** *INU1     ANDEQ*ON                                                  CSD031 BUG12272
     C           *INU1     IFEQ *ON                                                         BUG12272
     C********** SNRC      CHAINSDNARRD0             26                              CSD031 MD058769
     C                     CALL 'AONARRR0'                                                  MD058769
     C                     PARM *BLANKS   @RTCD                                             MD058769
     C                     PARM '*KEY    '@OPTN                                             MD058769
     C                     PARM SNRC      @NRCD   2                                         MD058769
     C           SDNARR    PARM SDNARR    @DSFDY                                            MD058769
     C                     SETOF                     26                                     MD058769
     C           @RTCD     IFNE *BLANKS                                                     MD058769
     C                     SETON                     26                                     MD058769
     C                     ENDIF                                                            MD058769
      *                                                                                     MD058769
     C                     ELSE                                                             BUG12272
      ** If CSD034 is *ON, use SDNARRPD instead of TABLETP                                  BUG12272
     C********** SNRC      CHAIN@ALRECZ              26                            BUG12272 MD058769
     C                     CALL 'AONARRR0'                                                  MD058769
     C                     PARM *BLANKS   @RTCD                                             MD058769
     C                     PARM '*KEY    '@OPTN                                             MD058769
     C                     PARM SNRC      @NRCD   2                                         MD058769
     C           SDNARR    PARM SDNARR    @DSFDY                                            MD058769
     C                     SETOF                     26                                     MD058769
     C           @RTCD     IFNE *BLANKS                                                     MD058769
     C                     SETON                     26                                     MD058769
     C                     ENDIF                                                            MD058769
      *                                                                                     MD058769
     C                     ENDIF                                                            BUG12272
      *                                                                                     BUG12272
     C                     ELSE                                                               CSD031
     C********** SNRC      CHAINTABLETPF             26                                     MD058769
     C                     CALL 'AONARRR0'                                                  MD058769
     C                     PARM *BLANKS   @RTCD                                             MD058769
     C                     PARM '*KEY    '@OPTN                                             MD058769
     C                     PARM SNRC      @NRCD   2                                         MD058769
     C           SDNARR    PARM SDNARR    @DSFDY                                            MD058769
     C                     SETOF                     26                                     MD058769
     C           @RTCD     IFNE *BLANKS                                                     MD058769
     C                     SETON                     26                                     MD058769
     C                     ENDIF                                                            MD058769
      *                                                                                     MD058769
     C                     ENDIF                                                              CSD031
     C*
     C           *IN26     IFEQ '1'
     C                     ADD  1         EC         40
     C***********          MOVEL' 210'    ERR,EC                          E22049
     C                     MOVEL' 201'    ERR,EC                          E22049
     C                     END
      *
     C*********************ELSE*******                                    E23097
      *
      ***or*on*TABNRC*****************                                    E23097
     C***********SNRC4*****LOKUPTABNRC                   25               E23097
     C************IN25*****IFEQ '0'                                       E23097
     C*********************ADD  1         EC         40                   E23097
     C***********          MOVEL' 210'    ERR,EC                          E22049
     C*********************MOVEL' 201'    ERR,EC                    E22049E23097
     C*********************END                                            E23097
     C*********************END                                            E23097
     C                     END
     C                     ELSE
      *
      ** It must be entered if the posting reference has been entered
      *
     C           SPRF4     IFNE *BLANKS
     C                     ADD  1         EC         40
     C***********          MOVEL' 210'    ERR,EC                          E22049
     C                     MOVEL' 201'    ERR,EC                          E22049
     C                     END
     C                     END
      *
      ** If not in error, translate from screen to file layout
      *
     C           *IN40     IFNE '1'
     C                     MOVELSNRC4     NRC4
     C                     END
     C*
     C* VALIDATE SNRC5
     C*
      *
      ** Narrative code must not be entered if the posting reference is
      *  blank
     C           SNRC5     IFNE *BLANKS
     C           SPRF5     IFEQ *BLANKS
     C                     ADD  1         EC         41
     C***********          MOVEL' 213'    ERR,EC                          E22049
     C                     MOVEL' 201'    ERR,EC                          E22049
     C                     ELSE
      *
      ***It*must*be*numeric**********                                     E23097
     C*********************MOVE '0'       WRK3A                           E23097
     C*********************MOVELSNRC5     WRK3A                           E23097
     C*********************TESTN          WRK3A      27                   E23097
     C************IN27*****IFEQ '1'                                       E23097
      *
      ** It must exist on TABLETP
      *
     C                     MOVE SNRC5     SNRC
     C           CSD034    IFEQ 'Y'                                                           CSD031
     C********** *INU1     ANDEQ*ON                                                  CSD031 BUG12272
     C           *INU1     IFEQ *ON                                                         BUG12272
     C********** SNRC      CHAINSDNARRD0             26                              CSD031 MD058769
     C                     CALL 'AONARRR0'                                                  MD058769
     C                     PARM *BLANKS   @RTCD                                             MD058769
     C                     PARM '*KEY    '@OPTN                                             MD058769
     C                     PARM SNRC      @NRCD   2                                         MD058769
     C           SDNARR    PARM SDNARR    @DSFDY                                            MD058769
     C                     SETOF                     26                                     MD058769
     C           @RTCD     IFNE *BLANKS                                                     MD058769
     C                     SETON                     26                                     MD058769
     C                     ENDIF                                                            MD058769
      *                                                                                     MD058769
     C                     ELSE                                                             BUG12272
      ** If CSD034 is *ON, use SDNARRPD instead of TABLETP                                  BUG12272
     C********** SNRC      CHAIN@ALRECZ              26                            BUG12272 MD058769
     C                     CALL 'AONARRR0'                                                  MD058769
     C                     PARM *BLANKS   @RTCD                                             MD058769
     C                     PARM '*KEY    '@OPTN                                             MD058769
     C                     PARM SNRC      @NRCD   2                                         MD058769
     C           SDNARR    PARM SDNARR    @DSFDY                                            MD058769
     C                     SETOF                     26                                     MD058769
     C           @RTCD     IFNE *BLANKS                                                     MD058769
     C                     SETON                     26                                     MD058769
     C                     ENDIF                                                            MD058769
      *                                                                                     MD058769
     C                     ENDIF                                                            BUG12272
      *                                                                                     BUG12272
     C                     ELSE                                                               CSD031
     C********** SNRC      CHAINTABLETPF             26                                     MD058769
     C                     CALL 'AONARRR0'                                                  MD058769
     C                     PARM *BLANKS   @RTCD                                             MD058769
     C                     PARM '*KEY    '@OPTN                                             MD058769
     C                     PARM SNRC      @NRCD   2                                         MD058769
     C           SDNARR    PARM SDNARR    @DSFDY                                            MD058769
     C                     SETOF                     26                                     MD058769
     C           @RTCD     IFNE *BLANKS                                                     MD058769
     C                     SETON                     26                                     MD058769
     C                     ENDIF                                                            MD058769
      *                                                                                     MD058769
     C                     ENDIF                                                              CSD031
     C*
     C           *IN26     IFEQ '1'
     C                     ADD  1         EC         41
     C***********          MOVEL' 213'    ERR,EC                          E22049
     C                     MOVEL' 201'    ERR,EC                          E22049
     C                     END
      *
     C*********************ELSE*******                                    E23097
      *
      ***or*on*TABNRC*****************                                    E23097
     C***********SNRC5*****LOKUPTABNRC                   25               E23097
     C************IN25*****IFEQ '0'                                       E23097
     C*********************ADD  1         EC         41                   E23097
     C*********************MOVEL' 213'    ERR,EC                          E22049
     C*********************MOVEL' 201'    ERR,EC                    E22049E23097
     C*********************END                                            E23097
     C*********************END                                            E23097
     C                     END
     C                     ELSE
      *
      ** It must be entered if the posting reference has been entered
      *
     C           SPRF5     IFNE *BLANKS
     C                     ADD  1         EC         41
     C***********          MOVEL' 213'    ERR,EC                          E22049
     C                     MOVEL' 201'    ERR,EC                          E22049
     C                     END
     C                     END
      *
      ** If not in error, translate from screen to file layout
      *
     C           *IN41     IFNE '1'
     C                     MOVELSNRC5     NRC5
     C                     END
     C*
     C* VALIDATE SNRC6
     C*
      *
      ** Narrative code must not be entered if the posting reference is
      *  blank
     C           SNRC6     IFNE *BLANKS
     C           SPRF6     IFEQ *BLANKS
     C                     ADD  1         EC         42
     C***********          MOVEL' 216'    ERR,EC                          E22049
     C                     MOVEL' 201'    ERR,EC                          E22049
     C                     ELSE
      *
      ***It*must*be*numeric**********                                     E23097
     C*********************MOVE '0'       WRK3A                           E23097
     C*********************MOVELSNRC6     WRK3A                           E23097
     C*********************TESTN          WRK3A      27                   E23097
     C************IN27*****IFEQ '1'                                       E23097
      *
      ** It must exist on TABLETP
      *
     C                     MOVE SNRC6     SNRC
     C           CSD034    IFEQ 'Y'                                                           CSD031
     C********** *INU1     ANDEQ*ON                                                  CSD031 BUG12272
     C           *INU1     IFEQ *ON                                                         BUG12272
     C********** SNRC      CHAINSDNARRD0             26                              CSD031 MD058769
     C                     CALL 'AONARRR0'                                                  MD058769
     C                     PARM *BLANKS   @RTCD                                             MD058769
     C                     PARM '*KEY    '@OPTN                                             MD058769
     C                     PARM SNRC      @NRCD   2                                         MD058769
     C           SDNARR    PARM SDNARR    @DSFDY                                            MD058769
     C                     SETOF                     26                                     MD058769
     C           @RTCD     IFNE *BLANKS                                                     MD058769
     C                     SETON                     26                                     MD058769
     C                     ENDIF                                                            MD058769
      *                                                                                     MD058769
     C                     ELSE                                                             BUG12272
      ** If CSD034 is *ON, use SDNARRPD instead of TABLETP                                  BUG12272
     C********** SNRC      CHAIN@ALRECZ              26                            BUG12272 MD058769
     C                     CALL 'AONARRR0'                                                  MD058769
     C                     PARM *BLANKS   @RTCD                                             MD058769
     C                     PARM '*KEY    '@OPTN                                             MD058769
     C                     PARM SNRC      @NRCD   2                                         MD058769
     C           SDNARR    PARM SDNARR    @DSFDY                                            MD058769
     C                     SETOF                     26                                     MD058769
     C           @RTCD     IFNE *BLANKS                                                     MD058769
     C                     SETON                     26                                     MD058769
     C                     ENDIF                                                            MD058769
      *                                                                                     MD058769
     C                     ENDIF                                                            BUG12272
      *                                                                                     BUG12272
     C                     ELSE                                                               CSD031
     C********** SNRC      CHAINTABLETPF             26                                     MD058769
     C                     CALL 'AONARRR0'                                                  MD058769
     C                     PARM *BLANKS   @RTCD                                             MD058769
     C                     PARM '*KEY    '@OPTN                                             MD058769
     C                     PARM SNRC      @NRCD   2                                         MD058769
     C           SDNARR    PARM SDNARR    @DSFDY                                            MD058769
     C                     SETOF                     26                                     MD058769
     C           @RTCD     IFNE *BLANKS                                                     MD058769
     C                     SETON                     26                                     MD058769
     C                     ENDIF                                                            MD058769
      *                                                                                     MD058769
     C                     ENDIF                                                              CSD031
     C*
     C           *IN26     IFEQ '1'
     C                     ADD  1         EC         42
     C***********          MOVEL' 216'    ERR,EC                          E22049
     C                     MOVEL' 201'    ERR,EC                          E22049
     C                     END
      *
     C*********************ELSE*******                                    E23097
      *
      ***or*on*TABNRC*****************                                    E23097
     C***********SNRC6*****LOKUPTABNRC                   25               E23097
     C************IN25*****IFEQ '0'                                       E23097
     C*********************ADD  1         EC         42                   E23097
     C***********          MOVEL' 216'    ERR,EC                          E22049
     C*********************MOVEL' 201'    ERR,EC                    E22049E23097
     C*********************END                                            E23097
     C*********************END                                            E23097
     C                     END
     C                     ELSE
      *
      ** It must be entered if the posting reference has been entered
      *
     C           SPRF6     IFNE *BLANKS
     C                     ADD  1         EC         42
     C***********          MOVEL' 216'    ERR,EC                          E22049
     C                     MOVEL' 201'    ERR,EC                          E22049
     C                     END
     C                     END
      *
      ** If not in error, translate from screen to file layout
      *
     C           *IN42     IFNE '1'
     C                     MOVELSNRC6     NRC6
     C                     END
     C*
     C* VALIDATE SPRF1
     C*
      *
      ** The posting reference must equal 1 or 3 if an account
      ** reference has been entered
      *
     C           SACD1     IFNE *BLANKS
     C           SPRF1     IFNE '1'
     C           SPRF1     ANDNE'3'
     C                     ADD  1         EC         43
     C                     MOVEL' 202'    ERR,EC
     C                     END
     C                     ELSE
      *
      ** else, the posting reference must equal 2 or blank
      *
     C           SPRF1     IFNE '2'
     C           SPRF1     ANDNE' '
     C                     ADD  1         EC         43
     C                     MOVEL' 202'    ERR,EC
     C                     END
      *                                                                                       CSD031
      ** else, the posting reference must be retain value for CSD034                          CSD031
      *                                                                                       CSD031
     C           CSD034    IFEQ 'Y'                                                           CSD031
     C           *INU1     IFEQ *OFF                                                          CSD031
     C           WPGEMD    ANDEQ'A'                                                           CSD031
     C           ACTN      ANDEQ'X'                                                           CSD031
     C                     MOVE PRF1      SPRF1                                               CSD031
     C                     ENDIF                                                              CSD031
     C                     ENDIF                                                              CSD031
     C*
     C                     END
      *
      ** If not in error, translate from screen to file layout
      *
     C           *IN43     IFNE '1'
     C                     MOVELSPRF1     PRF1
     C                     END
     C*
     C* VALIDATE SPRF2
     C*
      *
      ** The posting reference must equal 1 or 3 if an account
      ** reference has been entered
      *
     C           SACD2     IFNE *BLANKS
     C           SPRF2     IFNE '1'
     C           SPRF2     ANDNE'3'
     C                     ADD  1         EC         44
     C***********          MOVEL' 205'    ERR,EC                          E22049
     C                     MOVEL' 202'    ERR,EC                          E22049
     C                     END
     C                     ELSE
      *
      ** else, the posting reference must equal 2 or blank
      *
     C           SPRF2     IFNE '2'
     C           SPRF2     ANDNE' '
     C                     ADD  1         EC         44
     C***********          MOVEL' 205'    ERR,EC                          E22049
     C                     MOVEL' 202'    ERR,EC                          E22049
     C                     END
      *                                                                                       CSD031
      ** else, the posting reference must be retain value for CSD034                          CSD031
      *                                                                                       CSD031
     C           CSD034    IFEQ 'Y'                                                           CSD031
     C           *INU1     IFEQ *OFF                                                          CSD031
     C           WPGEMD    ANDEQ'A'                                                           CSD031
     C           ACTN      ANDEQ'X'                                                           CSD031
     C                     MOVE PRF2      SPRF2                                               CSD031
     C                     ENDIF                                                              CSD031
     C                     ENDIF                                                              CSD031
     C*
     C                     END
      *
      ** If not in error, translate from screen to file layout
      *
     C           *IN44     IFNE '1'
     C                     MOVELSPRF2     PRF2
     C                     END
     C*
     C* VALIDATE SPRF3
     C*
      *
      ** The posting reference must equal 1 or 3 if an account
      ** reference has been entered
      *
     C           SACD3     IFNE *BLANKS
     C           SPRF3     IFNE '1'
     C           SPRF3     ANDNE'3'
     C                     ADD  1         EC         45
     C***********          MOVEL' 208'    ERR,EC                          E22049
     C                     MOVEL' 202'    ERR,EC                          E22049
     C                     END
     C                     ELSE
      *
      ** else, the posting reference must equal 2 or blank
      *
     C           SPRF3     IFNE '2'
     C           SPRF3     ANDNE' '
     C                     ADD  1         EC         45
     C***********          MOVEL' 208'    ERR,EC                          E22049
     C                     MOVEL' 202'    ERR,EC                          E22049
     C                     END
      *                                                                                       CSD031
      ** else, the posting reference must be retain value for CSD034                          CSD031
      *                                                                                       CSD031
     C           CSD034    IFEQ 'Y'                                                           CSD031
     C           *INU1     IFEQ *OFF                                                          CSD031
     C           WPGEMD    ANDEQ'A'                                                           CSD031
     C           ACTN      ANDEQ'X'                                                           CSD031
     C                     MOVE PRF3      SPRF3                                               CSD031
     C                     ENDIF                                                              CSD031
     C                     ENDIF                                                              CSD031
     C*
     C                     END
      *
      ** If not in error, translate from screen to file layout
      *
     C           *IN45     IFNE '1'
     C                     MOVELSPRF3     PRF3
     C                     END
     C*
     C* VALIDATE SPRF4
     C*
      *
      ** The posting reference must equal 1 or 3 if an account
      ** reference has been entered
      *
     C           SACD4     IFNE *BLANKS
     C           SPRF4     IFNE '1'
     C           SPRF4     ANDNE'3'
     C                     ADD  1         EC         46
     C***********          MOVEL' 211'    ERR,EC                          E22049
     C                     MOVEL' 202'    ERR,EC                          E22049
     C                     END
     C                     ELSE
      *
      ** else, the posting reference must equal 2 or blank
      *
     C           SPRF4     IFNE '2'
     C           SPRF4     ANDNE' '
     C                     ADD  1         EC         46
     C***********          MOVEL' 211'    ERR,EC                          E22049
     C                     MOVEL' 202'    ERR,EC                          E22049
     C                     END
      *                                                                                       CSD031
      ** else, the posting reference must be retain value for CSD034                          CSD031
      *                                                                                       CSD031
     C           CSD034    IFEQ 'Y'                                                           CSD031
     C           *INU1     IFEQ *OFF                                                          CSD031
     C           WPGEMD    ANDEQ'A'                                                           CSD031
     C           ACTN      ANDEQ'X'                                                           CSD031
     C                     MOVE PRF4      SPRF4                                               CSD031
     C                     ENDIF                                                              CSD031
     C                     ENDIF                                                              CSD031
     C*
     C                     END
      *
      ** If not in error, translate from screen to file layout
      *
     C           *IN46     IFNE '1'
     C                     MOVELSPRF4     PRF4
     C                     END
     C*
     C* VALIDATE SPRF5
     C*
      *
      ** The posting reference must equal 1 or 3 if an account
      ** reference has been entered
      *
     C           SACD5     IFNE *BLANKS
     C           SPRF5     IFNE '1'
     C           SPRF5     ANDNE'3'
     C                     ADD  1         EC         47
     C***********          MOVEL' 214'    ERR,EC                          E22049
     C                     MOVEL' 202'    ERR,EC                          E22049
     C                     END
     C                     ELSE
      *
      ** else, the posting reference must equal 2 or blank
      *
     C           SPRF5     IFNE '2'
     C           SPRF5     ANDNE' '
     C                     ADD  1         EC         47
     C***********          MOVEL' 214'    ERR,EC                          E22049
     C                     MOVEL' 202'    ERR,EC                          E22049
     C                     END
      *                                                                                       CSD031
      ** else, the posting reference must be retain value for CSD034                          CSD031
      *                                                                                       CSD031
     C           CSD034    IFEQ 'Y'                                                           CSD031
     C           *INU1     IFEQ *OFF                                                          CSD031
     C           WPGEMD    ANDEQ'A'                                                           CSD031
     C           ACTN      ANDEQ'X'                                                           CSD031
     C                     MOVE PRF5      SPRF5                                               CSD031
     C                     ENDIF                                                              CSD031
     C                     ENDIF                                                              CSD031
     C*
     C                     END
      *
      ** If not in error, translate from screen to file layout
      *
     C           *IN47     IFNE '1'
     C                     MOVELSPRF5     PRF5
     C                     END
     C*
     C* VALIDATE SPRF6
     C*
      *
      ** The posting reference must equal 1 or 3 if an account
      ** reference has been entered
      *
     C           SACD6     IFNE *BLANKS
     C           SPRF6     IFNE '1'
     C           SPRF6     ANDNE'3'
     C                     ADD  1         EC         48
     C***********          MOVEL' 217'    ERR,EC                          E22049
     C                     MOVEL' 202'    ERR,EC                          E22049
     C                     END
     C                     ELSE
      *
      ** else, the posting reference must equal 2 or blank
      *
     C           SPRF6     IFNE '2'
     C           SPRF6     ANDNE' '
     C                     ADD  1         EC         48
     C***********          MOVEL' 217'    ERR,EC                          E22049
     C                     MOVEL' 202'    ERR,EC                          E22049
     C                     END
      *                                                                                       CSD031
      ** else, the posting reference must be retain value for CSD034                          CSD031
      *                                                                                       CSD031
     C           CSD034    IFEQ 'Y'                                                           CSD031
     C           *INU1     IFEQ *OFF                                                          CSD031
     C           WPGEMD    ANDEQ'A'                                                           CSD031
     C           ACTN      ANDEQ'X'                                                           CSD031
     C                     MOVE PRF6      SPRF6                                               CSD031
     C                     ENDIF                                                              CSD031
     C                     ENDIF                                                              CSD031
     C*
     C                     END
      *
      ** If not in error, translate from screen to file layout
      *
     C           *IN48     IFNE '1'
     C                     MOVELSPRF6     PRF6
     C                     END
      *                                                                                       CSD031
      ** For Central Mode - Validation  for ACCEPT TO ZONE field.                             CSD031
      *                                                                                       CSD031
     C           CSD034    IFEQ 'Y'                                                           CSD031
      *                                                                                       CSD031
     C           *INU1     IFEQ *ON                                                           CSD031
      *                                                                                       CSD031
      ** Accept to Zone must be 'Y' or 'N' only.                                              CSD031
      *                                                                                       CSD031
     C           #1GPDT    IFNE *BLANK                                                        CSD031
     C           #1GPDT    ANDNE'Y'                                                           CSD031
     C           #1GPDT    ANDNE'N'                                                           CSD031
     C                     ADD  1         EC         57                                       CSD031
     C                     MOVEL' 203'    ERR,EC                                              CSD031
     C                     MOVE *ON       *IN59                                               CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
      ** Default Value: if 'Accept to Zone' equal to BLANKS                                   CSD031
      *                                                                                       CSD031
     C           #1GPDT    IFEQ *BLANK                                                        CSD031
     C                     MOVEL'N'       #1GPDT                                              CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
      ** Accept to Zone = 'Y' send error message -Effective Date may only be entered          CSD031
      ** if Accept to Zone is 'N'                                                             CSD031
      *                                                                                       CSD031
     C           #1GPDT    IFEQ 'Y'                                                           CSD031
     C           #EACC     ANDNE*ZERO                                                         CSD031
     C                     ADD  1         EC         57                                       CSD031
     C                     MOVEL' 204'    ERR,EC                                              CSD031
     C                     MOVE *ON       *IN58                                               CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
      ** Must be a six digit numeric and a valid date.                                        CSD031
      *                                                                                       CSD031
     C           #EACC     IFNE *ZERO                                                         CSD031
     C           #1GPDT    ANDNE'Y'                                                           CSD031
     C                     MOVE *ZERO     WDATE                                               CSD031
     C                     MOVE *ZERO     #WDATE                                              CSD031
     C                     Z-ADD*ZERO     #DATE   60                                          CSD031
     C                     MOVE #EACC     WDATE                                               CSD031
     C                     MOVE WDATE     #DATE                                               CSD031
     C                     Z-ADD#DATE     ZDATEA                                              CSD031
     C                     MOVE GJDFIN    ZDATFM                                              CSD031
     C                     EXSR ZDATE1                                                        CSD031
      *                                                                                       CSD031
     C           ERRORF    IFNE *BLANKS                                                       CSD031
     C                     ADD  1         EC         57                                       CSD031
     C                     MOVEL' 206'    ERR,EC                                              CSD031
     C                     MOVE *ON       *IN58                                               CSD031
     C                     ENDIF                                                              CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
      ** Accept to Zone is 'Y' and Effective Date is BLANK                                    CSD031
      *                                                                                       CSD031
     C           #1GPDT    IFEQ 'Y'                                                           CSD031
     C           #EACC     ANDEQ*ZERO                                                         CSD031
     C           *IN57     ANDEQ*OFF                                                          CSD031
     C                     MOVEL#1GPDT    AACC                                                CSD031
     C                     MOVEL#1GPDT    SAACC                                               CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
      ** Accept to Zone is 'N' and Effective Date is BLANK                                    CSD031
      *                                                                                       CSD031
     C           #1GPDT    IFEQ 'N'                                                           CSD031
     C           #EACC     ANDEQ*ZERO                                                         CSD031
     C           *IN57     ANDEQ*OFF                                                          CSD031
     C                     MOVEL#1GPDT    AACC                                                CSD031
     C                     MOVEL#1GPDT    SAACC                                               CSD031
     C                     Z-ADD*ZERO     EACC                                                CSD031
     C                     MOVE *ZERO     SEACC                                               CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
      ** If not in error, translate from screen to file layout                                CSD031
      *                                                                                       CSD031
     C           #EACC     IFNE *ZERO                                                         CSD031
     C           #1GPDT    ANDEQ'N'                                                           CSD031
     C           *IN57     ANDEQ*OFF                                                          CSD031
     C                     MOVELZDAYNO    EACC                                                CSD031
     C                     MOVELZDAYNO    SEACC                                               CSD031
     C                     MOVEL#1GPDT    AACC                                                CSD031
     C                     MOVEL#1GPDT    SAACC                                               CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
      ** Move Value of Central data - Default is 'Y' from global mode                         CSD031
      *                                                                                       CSD031
     C                     MOVEL'Y'       GPDT                                                CSD031
     C                     MOVEL'Y'       SGPDT                                               CSD031
      *                                                                                       CSD031
      ** Else if *INU1 is *OFF                                                                CSD031
      *                                                                                       CSD031
     C                     ELSE                                                               CSD031
     C           ACTN      IFEQ 'X'                                                           CSD031
     C           WPGEMD    ANDEQ'A'                                                           CSD031
     C                     MOVE WAACC     AACC                                                CSD031
     C                     MOVE WGPDT     GPDT                                                CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
      ** End *INU1 is *ON                                                                     CSD031
      *                                                                                       CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
      ** End CSD034 indicator                                                                 CSD031
      *                                                                                       CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C/COPY WNCPYSRC,FF0180C003
     C*CALCULATION SPECIFICATIONS:DETAIL VALIDATION(& TRANSLATION)*****
     C                     ELSE
     C*
     C** IF ACTION=D WITH ENTER PRESSED THEN ERROR                         -
     C*
     C           ACTN      IFEQ 'D'
     C                     MOVELINF,9     INFMSG
     C                     END
     C                     END
     C                     ELSE
     C*
     C** IF COMMAND 4 TAKEN
     C*
     C           AID       IFEQ '04'
     C*
     C** COMMAND 4 TAKEN CORRECTLY WHEN ACTION IS D-FORCE 'RECORD ADVANCE'
     C*
     C           ACTN      IFEQ 'D'
     C                     MOVEL'RA'      AID
     C*
     C** COMMAND 4 TAKEN INCORRECTLY WHEN ACTION IS NOT D-HENCE ERROR
     C*
     C                     ELSE
     C                     MOVELINF,10    INFMSG
     C                     END
     C                     END
     C*
     C                     END
     C*
     C** ERROR ON SCREEN SO HIGHLIGHT ERROR CODES
     C*
     C           EC        IFNE *ZERO
     C                     MOVELHI        ERRMSG
     C                     END
     C                     ENDSR
     C*================================================================
      /EJECT
     C*================================================================
      **
      ** DEFLTS S/R TO FORMAT DEFAULT FIELD VALUES FOR INSERT SCREEN ETC
      ** CALLED FROM UPDATE; VALIDD
      ** CALLS NO OTHER S/R'S
      **
     C*================================================================
     C           DEFLTS    BEGSR
     C*
     C** DEFAULTS FOR RECORD
     C*
     C*CALCULATION SPECIFICATIONS:DEFAULTS*****************************
     C                     ENDSR
     C*================================================================
      /EJECT
     C*================================================================
      **
      ** INITRC S/R TO INITIALISE ALL FILE FIELDS TO ZERO/BLANK
      ** CALLED FROM UPDATE; UPDFLS
      ** CALLS NO OTHER S/R'S
      **
     C*================================================================
     C*
     C           INITRC    BEGSR
     C*
     C** INITIALIZE ALL DATA ON RECORD DEFINED IN DETREC (KEY EXCLUDED)
     C*
     C                     MOVEL*BLANK    DETREC
     C                     Z-ADD*ZERO     ACD1
     C                     Z-ADD*ZERO     ACD2
     C                     Z-ADD*ZERO     ACD3
     C                     Z-ADD*ZERO     ACD4
     C                     Z-ADD*ZERO     ACD5
     C                     Z-ADD*ZERO     ACD6
     C                     MOVE *BLANKS   NRC1
     C                     MOVE *BLANKS   NRC2
     C                     MOVE *BLANKS   NRC3
     C                     MOVE *BLANKS   NRC4
     C                     MOVE *BLANKS   NRC5
     C                     MOVE *BLANKS   NRC6
     C                     Z-ADD*ZERO     PRF1
     C                     Z-ADD*ZERO     PRF2
     C                     Z-ADD*ZERO     PRF3
     C                     Z-ADD*ZERO     PRF4
     C                     Z-ADD*ZERO     PRF5
     C                     Z-ADD*ZERO     PRF6
     C                     Z-ADD*ZERO     LCD
     C                     Z-ADD*ZERO     TNLU
     C                     Z-ADD*ZERO     ACD1QQ                                              CSD031
     C                     Z-ADD*ZERO     ACD2QQ                                              CSD031
     C                     Z-ADD*ZERO     ACD3QQ                                              CSD031
     C                     Z-ADD*ZERO     ACD4QQ                                              CSD031
     C                     Z-ADD*ZERO     ACD5QQ                                              CSD031
     C                     Z-ADD*ZERO     ACD6QQ                                              CSD031
     C                     MOVEL*BLANK    AACC                                                CSD031
     C                     Z-ADD*ZERO     EACC                                                CSD031
     C                     MOVEL*BLANK    GPDT                                                CSD031
     C/COPY WNCPYSRC,FF0180C004
     C                     ENDSR
     C*================================================================
      /EJECT                                                                                  CSD031
     C*================================================================                       CSD031
      ** Move the Value to From @1DBRC to DETREC                                              CSD031
     C*================================================================                       CSD031
     C           MDATA     BEGSR                                                              CSD031
     C                     MOVELRECI      W01                                                 CSD031
     C                     MOVELFFKY      W02                                                 CSD031
     C                     MOVELZZ002     W03                                                 CSD031
     C                     MOVELACD1QQ    W04                                                 CSD031
     C                     MOVELACD2QQ    W05                                                 CSD031
     C                     MOVELACD3QQ    W06                                                 CSD031
     C                     MOVELACD4QQ    W07                                                 CSD031
     C                     MOVELACD5QQ    W08                                                 CSD031
     C                     MOVELACD6QQ    W09                                                 CSD031
     C                     MOVELNRC1      W010                                                CSD031
     C                     MOVELNRC2      W011                                                CSD031
     C                     MOVELNRC3      W012                                                CSD031
     C                     MOVELNRC4      W013                                                CSD031
     C                     MOVELNRC5      W014                                                CSD031
     C                     MOVELNRC6      W015                                                CSD031
     C                     MOVELPRF1      W016                                                CSD031
     C                     MOVELPRF2      W017                                                CSD031
     C                     MOVELPRF3      W018                                                CSD031
     C                     MOVELPRF4      W019                                                CSD031
     C                     MOVELPRF5      W020                                                CSD031
     C                     MOVELPRF6      W021                                                CSD031
     C                     MOVELZZ034     W022                                                CSD031
     C                     MOVELLCD       W023                                                CSD031
     C                     MOVELCHTP      W024                                                CSD031
     C                     MOVELTNLU      W025                                                CSD031
     C                     MOVELACD1      W026                                                CSD031
     C                     MOVELACD2      W027                                                CSD031
     C                     MOVELACD3      W028                                                CSD031
     C                     MOVELACD4      W029                                                CSD031
     C                     MOVELACD5      W030                                                CSD031
     C                     MOVELACD6      W031                                                CSD031
     C                     MOVELZONE      W032                                                CSD031
     C                     MOVELIUSR      W033                                                CSD031
     C                     MOVELAUSR      W034                                                CSD031
     C                     MOVELXUSR      W035                                                CSD031
     C                     MOVELAACC      W036                                                CSD031
     C           EACC      IFEQ *ZERO                                                         CSD031
     C           AACC      ANDEQ'Y'                                                           CSD031
     C                     MOVELRUND      W037                                                CSD031
     C                     ELSE                                                               CSD031
     C                     MOVELEACC      W037                                                CSD031
     C                     ENDIF                                                              CSD031
     C                     MOVELGPDT      W038                                                CSD031
     C                     ENDSR                                                              CSD031
     C*================================================================                       CSD031
      /EJECT                                                                                  CSD031
     C*================================================================                       CSD031
      ** Move the Value to From MDATA1 to DETS                                                CSD031
     C*================================================================                       CSD031
     C           MDATA1    BEGSR                                                              CSD031
     C           ACD1      IFNE *ZERO                                                         CSD031
     C                     MOVE ACD1      WACD1                                               CSD031
     C                     ELSE                                                               CSD031
     C                     MOVEL*BLANKS   WACD1                                               CSD031
     C                     ENDIF                                                              CSD031
     C           NRC1      IFNE *ZERO                                                         CSD031
     C                     MOVE NRC1      WNRC1                                               CSD031
     C                     ELSE                                                               CSD031
     C                     MOVEL*BLANKS   WNRC1                                               CSD031
     C                     ENDIF                                                              CSD031
     C           PRF1      IFNE *ZERO                                                         CSD031
     C                     MOVE PRF1      WPRF1                                               CSD031
     C                     ELSE                                                               CSD031
     C                     MOVEL*BLANKS   WPRF1                                               CSD031
     C                     ENDIF                                                              CSD031
     C           ACD2      IFNE *ZERO                                                         CSD031
     C                     MOVE ACD2      WACD2                                               CSD031
     C                     ELSE                                                               CSD031
     C                     MOVEL*BLANKS   WACD2                                               CSD031
     C                     ENDIF                                                              CSD031
     C           NRC2      IFNE *ZERO                                                         CSD031
     C                     MOVE NRC2      WNRC2                                               CSD031
     C                     ELSE                                                               CSD031
     C                     MOVEL*BLANKS   WNRC2                                               CSD031
     C                     ENDIF                                                              CSD031
     C           PRF2      IFNE *ZERO                                                         CSD031
     C                     MOVE PRF2      WPRF2                                               CSD031
     C                     ELSE                                                               CSD031
     C                     MOVEL*BLANKS   WPRF2                                               CSD031
     C                     ENDIF                                                              CSD031
     C           ACD3      IFNE *ZERO                                                         CSD031
     C                     MOVE ACD3      WACD3                                               CSD031
     C                     ELSE                                                               CSD031
     C                     MOVEL*BLANKS   WACD3                                               CSD031
     C                     ENDIF                                                              CSD031
     C           NRC3      IFNE *ZERO                                                         CSD031
     C                     MOVE NRC3      WNRC3                                               CSD031
     C                     ELSE                                                               CSD031
     C                     MOVEL*BLANKS   WNRC3                                               CSD031
     C                     ENDIF                                                              CSD031
     C           PRF3      IFNE *ZERO                                                         CSD031
     C                     MOVE PRF3      WPRF3                                               CSD031
     C                     ELSE                                                               CSD031
     C                     MOVEL*BLANKS   WPRF3                                               CSD031
     C                     ENDIF                                                              CSD031
     C           ACD4      IFNE *ZERO                                                         CSD031
     C                     MOVE ACD4      WACD4                                               CSD031
     C                     ELSE                                                               CSD031
     C                     MOVEL*BLANKS   WACD4                                               CSD031
     C                     ENDIF                                                              CSD031
     C           NRC4      IFNE *ZERO                                                         CSD031
     C                     MOVE NRC4      WNRC4                                               CSD031
     C                     ELSE                                                               CSD031
     C                     MOVEL*BLANKS   WNRC4                                               CSD031
     C                     ENDIF                                                              CSD031
     C           PRF4      IFNE *ZERO                                                         CSD031
     C                     MOVE PRF4      WPRF4                                               CSD031
     C                     ELSE                                                               CSD031
     C                     MOVEL*BLANKS   WPRF4                                               CSD031
     C                     ENDIF                                                              CSD031
     C           ACD5      IFNE *ZERO                                                         CSD031
     C                     MOVE ACD5      WACD5                                               CSD031
     C                     ELSE                                                               CSD031
     C                     MOVEL*BLANKS   WACD5                                               CSD031
     C                     ENDIF                                                              CSD031
     C           NRC5      IFNE *ZERO                                                         CSD031
     C                     MOVE NRC5      WNRC5                                               CSD031
     C                     ELSE                                                               CSD031
     C                     MOVEL*BLANKS   WNRC5                                               CSD031
     C                     ENDIF                                                              CSD031
     C           PRF5      IFNE *ZERO                                                         CSD031
     C                     MOVE PRF5      WPRF5                                               CSD031
     C                     ELSE                                                               CSD031
     C                     MOVEL*BLANKS   WPRF5                                               CSD031
     C                     ENDIF                                                              CSD031
     C           ACD6      IFNE *ZERO                                                         CSD031
     C                     MOVE ACD6      WACD6                                               CSD031
     C                     ELSE                                                               CSD031
     C                     MOVEL*BLANKS   WACD6                                               CSD031
     C                     ENDIF                                                              CSD031
     C           NRC6      IFNE *ZERO                                                         CSD031
     C                     MOVE NRC6      WNRC6                                               CSD031
     C                     ELSE                                                               CSD031
     C                     MOVEL*BLANKS   WNRC6                                               CSD031
     C                     ENDIF                                                              CSD031
     C           PRF6      IFNE *ZERO                                                         CSD031
     C                     MOVE PRF6      WPRF6                                               CSD031
     C                     ELSE                                                               CSD031
     C                     MOVEL*BLANKS   WPRF6                                               CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C                     MOVE AACC      WAACC                                               CSD031
     C                     MOVE GPDT      WGPDT                                               CSD031
     C                     MOVELRECI      WRECI                                               CSD031
     C                     MOVELFFKY      WFFKY                                               CSD031
     C                     MOVELZZ002     WZZ002                                              CSD031
     C                     MOVELACD1QQ    WACD1Q                                              CSD031
     C                     MOVELACD2QQ    WACD2Q                                              CSD031
     C                     MOVELACD3QQ    WACD3Q                                              CSD031
     C                     MOVELACD4QQ    WACD4Q                                              CSD031
     C                     MOVELACD5QQ    WACD5Q                                              CSD031
     C                     MOVELACD6QQ    WACD6Q                                              CSD031
     C                     MOVELLCD       WLCD                                                CSD031
     C                     MOVELCHTP      WCHTP                                               CSD031
     C                     MOVELTNLU      WTNLU                                               CSD031
     C                     MOVELZONE      WZONE                                               CSD031
     C                     MOVELIUSR      WIUSR                                               CSD031
     C                     MOVELAUSR      WAUSR                                               CSD031
     C                     MOVELXUSR      WXUSR                                               CSD031
     C                     ENDSR                                                              CSD031
     C*================================================================                       CSD031
      /EJECT                                                                                  CSD031
     C*================================================================                       CSD031
      ** Move the Value to From MDATA2 to DETS                                                CSD031
     C*================================================================                       CSD031
     C           MDATA2    BEGSR                                                              CSD031
     C           WACD1     IFNE *ZERO                                                         CSD031
     C                     MOVE WACD1     SACD1                                               CSD031
     C                     ELSE                                                               CSD031
     C                     MOVEL*BLANKS   SACD1                                               CSD031
     C                     ENDIF                                                              CSD031
     C           WNRC1     IFNE *BLANKS                                                       CSD031
     C                     MOVELWNRC1     SNRC1                                               CSD031
     C                     ELSE                                                               CSD031
     C                     MOVEL*BLANKS   SNRC1                                               CSD031
     C                     ENDIF                                                              CSD031
     C           WPRF1     IFNE *ZERO                                                         CSD031
     C           PRF1      IFEQ *ZERO                                                         CSD031
     C                     MOVELWPRF1     SPRF1                                               CSD031
     C                     ELSE                                                               CSD031
     C                     MOVE PRF1      SPRF1                                               CSD031
     C                     ENDIF                                                              CSD031
     C                     ELSE                                                               CSD031
     C                     MOVEL*BLANKS   SPRF1                                               CSD031
     C                     ENDIF                                                              CSD031
     C           WACD2     IFNE *ZERO                                                         CSD031
     C                     MOVE WACD2     SACD2                                               CSD031
     C                     ELSE                                                               CSD031
     C                     MOVEL*BLANKS   SACD2                                               CSD031
     C                     ENDIF                                                              CSD031
     C           WNRC2     IFNE *BLANKS                                                       CSD031
     C                     MOVELWNRC2     SNRC2                                               CSD031
     C                     ELSE                                                               CSD031
     C                     MOVEL*BLANKS   SNRC2                                               CSD031
     C                     ENDIF                                                              CSD031
     C           WPRF2     IFNE *ZERO                                                         CSD031
     C           PRF2      IFEQ *ZERO                                                         CSD031
     C                     MOVELWPRF2     SPRF2                                               CSD031
     C                     ELSE                                                               CSD031
     C                     MOVE PRF2      SPRF2                                               CSD031
     C                     ENDIF                                                              CSD031
     C                     ELSE                                                               CSD031
     C                     MOVEL*BLANKS   SPRF2                                               CSD031
     C                     ENDIF                                                              CSD031
     C           WACD3     IFNE *ZERO                                                         CSD031
     C                     MOVE WACD3     SACD3                                               CSD031
     C                     ELSE                                                               CSD031
     C                     MOVEL*BLANKS   SACD3                                               CSD031
     C                     ENDIF                                                              CSD031
     C           WNRC3     IFNE *BLANKS                                                       CSD031
     C                     MOVELWNRC3     SNRC3                                               CSD031
     C                     ELSE                                                               CSD031
     C                     MOVEL*BLANKS   SNRC3                                               CSD031
     C                     ENDIF                                                              CSD031
     C           WPRF3     IFNE *ZERO                                                         CSD031
     C           PRF3      IFEQ *ZERO                                                         CSD031
     C                     MOVELWPRF3     SPRF3                                               CSD031
     C                     ELSE                                                               CSD031
     C                     MOVE PRF3      SPRF3                                               CSD031
     C                     ENDIF                                                              CSD031
     C                     ELSE                                                               CSD031
     C                     MOVEL*BLANKS   SPRF3                                               CSD031
     C                     ENDIF                                                              CSD031
     C           WACD4     IFNE *ZERO                                                         CSD031
     C                     MOVE WACD4     SACD4                                               CSD031
     C                     ELSE                                                               CSD031
     C                     MOVEL*BLANKS   SACD4                                               CSD031
     C                     ENDIF                                                              CSD031
     C           WNRC4     IFNE *ZERO                                                         CSD031
     C                     MOVELWNRC4     SNRC4                                               CSD031
     C                     ELSE                                                               CSD031
     C                     MOVEL*BLANKS   SNRC4                                               CSD031
     C                     ENDIF                                                              CSD031
     C           WPRF4     IFNE *ZERO                                                         CSD031
     C           PRF4      IFEQ *ZERO                                                         CSD031
     C                     MOVELWPRF4     SPRF4                                               CSD031
     C                     ELSE                                                               CSD031
     C                     MOVE PRF4      SPRF4                                               CSD031
     C                     ENDIF                                                              CSD031
     C                     ELSE                                                               CSD031
     C                     MOVEL*BLANKS   SPRF4                                               CSD031
     C                     ENDIF                                                              CSD031
     C           WACD5     IFNE *ZERO                                                         CSD031
     C                     MOVE WACD5     SACD5                                               CSD031
     C                     ELSE                                                               CSD031
     C                     MOVEL*BLANKS   SACD5                                               CSD031
     C                     ENDIF                                                              CSD031
     C           WNRC5     IFNE *BLANKS                                                       CSD031
     C                     MOVELWNRC5     SNRC5                                               CSD031
     C                     ELSE                                                               CSD031
     C                     MOVEL*BLANKS   SNRC5                                               CSD031
     C                     ENDIF                                                              CSD031
     C           WPRF5     IFNE *ZERO                                                         CSD031
     C           PRF5      IFEQ *ZERO                                                         CSD031
     C                     MOVELWPRF5     SPRF5                                               CSD031
     C                     ELSE                                                               CSD031
     C                     MOVE PRF5      SPRF5                                               CSD031
     C                     ENDIF                                                              CSD031
     C                     ELSE                                                               CSD031
     C                     MOVEL*BLANKS   SPRF5                                               CSD031
     C                     ENDIF                                                              CSD031
     C           WACD6     IFNE *ZERO                                                         CSD031
     C                     MOVE WACD6     SACD6                                               CSD031
     C                     ELSE                                                               CSD031
     C                     MOVEL*BLANKS   SACD6                                               CSD031
     C                     ENDIF                                                              CSD031
     C           WNRC6     IFNE *ZERO                                                         CSD031
     C                     MOVELWNRC6     SNRC6                                               CSD031
     C                     ELSE                                                               CSD031
     C                     MOVEL*BLANKS   SNRC6                                               CSD031
     C                     ENDIF                                                              CSD031
     C           WPRF6     IFNE *ZERO                                                         CSD031
     C           PRF6      IFEQ *ZERO                                                         CSD031
     C                     MOVELWPRF6     SPRF6                                               CSD031
     C                     ELSE                                                               CSD031
     C                     MOVE PRF6      SPRF6                                               CSD031
     C                     ENDIF                                                              CSD031
     C                     ELSE                                                               CSD031
     C                     MOVEL*BLANKS   SPRF6                                               CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C                     ENDSR                                                              CSD031
     C*================================================================                       CSD031
      /EJECT
     C*================================================================
      **
      ** TRSFS S/R TO FORMAT RECORD FIELDS FOR SCREEN
      ** CALLED FROM UPDATE
      ** CALLS NO OTHER S/R'S
      **
     C*================================================================
     C*
     C           TRSFS     BEGSR
     C*
     C** TRANSLATE RECORD DETAILS FROM FILE LAYOUT TO SCREEN LAYOUT
     C*
     C*
     C* TRANSLATE ACD1 (#NUMV)
     C*
     C           ACD1      IFNE *ZERO
     C                     MOVELACD1      SACD1
     C                     ELSE
     C                     MOVEL*BLANK    SACD1
     C                     END
     C*
     C* TRANSLATE ACD2 (#NUMV)
     C*
     C           ACD2      IFNE *ZERO
     C                     MOVELACD2      SACD2
     C                     ELSE
     C                     MOVEL*BLANK    SACD2
     C                     END
     C*
     C* TRANSLATE ACD3 (#NUMV)
     C*
     C           ACD3      IFNE *ZERO
     C                     MOVELACD3      SACD3
     C                     ELSE
     C                     MOVEL*BLANK    SACD3
     C                     END
     C*
     C* TRANSLATE ACD4 (#NUMV)
     C*
     C           ACD4      IFNE *ZERO
     C                     MOVELACD4      SACD4
     C                     ELSE
     C                     MOVEL*BLANK    SACD4
     C                     END
     C*
     C* TRANSLATE ACD5 (#NUMV)
     C*
     C           ACD5      IFNE *ZERO
     C                     MOVELACD5      SACD5
     C                     ELSE
     C                     MOVEL*BLANK    SACD5
     C                     END
     C*
     C* TRANSLATE ACD6 (#NUMV)
     C*
     C           ACD6      IFNE *ZERO
     C                     MOVELACD6      SACD6
     C                     ELSE
     C                     MOVEL*BLANK    SACD6
     C                     END
     C*
     C* TRANSLATE NRC1 (#NUMV)
     C*
     C           NRC1      IFNE *ZERO
     C                     MOVELNRC1      SNRC1
     C                     ELSE
     C                     MOVEL*BLANK    SNRC1
     C                     END
     C*
     C* TRANSLATE NRC2 (#NUMV)
     C*
     C           NRC2      IFNE *ZERO
     C                     MOVELNRC2      SNRC2
     C                     ELSE
     C                     MOVEL*BLANK    SNRC2
     C                     END
     C*
     C* TRANSLATE NRC3 (#NUMV)
     C*
     C           NRC3      IFNE *ZERO
     C                     MOVELNRC3      SNRC3
     C                     ELSE
     C                     MOVEL*BLANK    SNRC3
     C                     END
     C*
     C* TRANSLATE NRC4 (#NUMV)
     C*
     C           NRC4      IFNE *ZERO
     C                     MOVELNRC4      SNRC4
     C                     ELSE
     C                     MOVEL*BLANK    SNRC4
     C                     END
     C*
     C* TRANSLATE NRC5 (#NUMV)
     C*
     C           NRC5      IFNE *ZERO
     C                     MOVELNRC5      SNRC5
     C                     ELSE
     C                     MOVEL*BLANK    SNRC5
     C                     END
     C*
     C* TRANSLATE NRC6 (#NUMV)
     C*
     C           NRC6      IFNE *ZERO
     C                     MOVELNRC6      SNRC6
     C                     ELSE
     C                     MOVEL*BLANK    SNRC6
     C                     END
     C*
     C* TRANSLATE PRF1 (#NUMV)
     C*
     C           PRF1      IFNE *ZERO
     C                     MOVELPRF1      SPRF1
     C                     ELSE
     C                     MOVEL*BLANK    SPRF1
     C                     END
     C*
     C* TRANSLATE PRF2 (#NUMV)
     C*
     C           PRF2      IFNE *ZERO
     C                     MOVELPRF2      SPRF2
     C                     ELSE
     C                     MOVEL*BLANK    SPRF2
     C                     END
     C*
     C* TRANSLATE PRF3 (#NUMV)
     C*
     C           PRF3      IFNE *ZERO
     C                     MOVELPRF3      SPRF3
     C                     ELSE
     C                     MOVEL*BLANK    SPRF3
     C                     END
     C*
     C* TRANSLATE PRF4 (#NUMV)
     C*
     C           PRF4      IFNE *ZERO
     C                     MOVELPRF4      SPRF4
     C                     ELSE
     C                     MOVEL*BLANK    SPRF4
     C                     END
     C*
     C* TRANSLATE PRF5 (#NUMV)
     C*
     C           PRF5      IFNE *ZERO
     C                     MOVELPRF5      SPRF5
     C                     ELSE
     C                     MOVEL*BLANK    SPRF5
     C                     END
     C*
     C* TRANSLATE PRF6 (#NUMV)
     C*
     C           PRF6      IFNE *ZERO
     C                     MOVELPRF6      SPRF6
     C                     ELSE
     C                     MOVEL*BLANK    SPRF6
     C                     END
      *                                                                                       CSD031
      ** Translate Accept to Zone=AACC (#NUMV)                                                CSD031
      *                                                                                       CSD031
     C           CSD034    IFEQ 'Y'                                                           CSD031
      *                                                                                       CSD031
     C           *INU1     IFEQ '1'                                                           CSD031
     C           AACC      IFNE *BLANK                                                        CSD031
     C                     MOVELAACC      #1GPDT                                              CSD031
     C                     ELSE                                                               CSD031
     C                     MOVEL*BLANK    #1GPDT                                              CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
      ** Translate Central Data = GPDT (#NUMV)                                                CSD031
      *                                                                                       CSD031
     C                     ELSE                                                               CSD031
     C           GPDT      IFNE *BLANK                                                        CSD031
     C                     MOVELGPDT      #1GPDT                                              CSD031
     C                     ELSE                                                               CSD031
     C                     MOVEL*BLANK    #1GPDT                                              CSD031
     C                     ENDIF                                                              CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
      ** Translate Effective Date = EACC (#NUMV)                                              CSD031
      *                                                                                       CSD031
     C           CSD034    IFEQ 'Y'                                                           CSD031
     C           *INU1     IFEQ '1'                                                           CSD031
     C           EACC      IFNE *ZERO                                                         CSD031
     C                     MOVE EACC      WVLDTE                                              CSD031
     C                     MOVE GJDFIN    WDTFMT                                              CSD031
     C                     EXSR ZDATE2                                                        CSD031
     C                     Z-ADD*ZERO     #EACC                                               CSD031
     C                     Z-ADDWZDATE    #EACC                                               CSD031
      *                                                                                       CSD031
     C                     MOVE WZDATE    #EACC                                               CSD031
      *                                                                                       CSD031
     C                     ELSE                                                               CSD031
     C                     Z-ADD*ZERO     #EACC                                               CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
      ** FOR ZONAL MODE : Effective Date                                                      CSD031
      *                                                                                       CSD031
     C                     ELSE                                                               CSD031
     C           EACC      IFNE *ZERO                                                         CSD031
     C                     MOVE EACC      WVLDTE                                              CSD031
     C                     MOVE GJDFIN    WDTFMT                                              CSD031
     C                     EXSR ZDATE2                                                        CSD031
     C                     Z-ADD*ZERO     #EACC                                               CSD031
     C                     Z-ADDWZDATE    #EACC                                               CSD031
     C                     ELSE                                                               CSD031
     C                     Z-ADD*ZERO     #EACC                                               CSD031
     C                     ENDIF                                                              CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
      ** End - CSD034                                                                         CSD031
      *                                                                                       CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C/COPY WNCPYSRC,FF0180C005
     C*CALCULATION SPECIFICATIONS:FILE TO SCREEN TRANSLATION***********
     C                     ENDSR
     C*================================================================
      /EJECT
     C*================================================================
      **
      ** UPDFLS S/R TO UPDATE FILE RECORDS
      ** CALLED FROM UPDATE
      ** CALLS INITRC; ZTNLU1; INFSR
      **
     C*================================================================
     C           UPDFLS    BEGSR
     C*
     C/COPY WNCPYSRC,FF0180C009
     C** U P D A T E   F I L E S
     C*
     C** INITIALIZE ALL FIELDS ON THE RECORD (IE ZEROIZE/BLANK OUT)
     C*
     C                     EXSR INITRC
     C*
     C** RETRIEVE NEXT TRANSACTION NUMBER
     C*
     C                     EXSR ZTNLU1
     C*
     C** INITIALISE ERROR BAND
     C*
     C                     MOVEL*BLANK    INFMSG
     C*
     C**               I  N  S  E  R  T  S                 -  S T A R T
     C*
     C           ACTN      IFEQ 'I'
      *                                                                                       CSD031
     C           CSD034    IFEQ 'Y'                                                           CSD031
      *                                                                                       CSD031
     C           *INU1     IFEQ *ON                                                           CSD031
     C           FACKYK    CHAINGPFFAKLF             60                                       CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C                     ELSE                                                               CSD031
     C           FACKYK    CHAINFACKYDF              60
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C           TNLU      IFNE STNLU
     C                     EXSR UPDOWS
     C*
     C** IF NO PROCESSING OCCURRED EXIT TO SUPPRESS AUDIT UPDATE
     C*
     C                     GOTO XTUPDF
     C*
     C                     ELSE
     C*
     C** TRANSLATE RECORD DETAILS FROM SCREEN LAYOUT TO FILE LAYOUT
     C*
     C                     EXSR VALIDD
     C                     MOVEL'D'       RECI
     C                     Z-ADDRUND      LCD
     C                     MOVEL'I'       CHTP
     C                     MOVELNATN      TNLU
     C                     END
      *                                                                                       CSD031
     C           CSD034    IFEQ 'Y'                                                           CSD031
      *                                                                                       CSD031
     C           *INU1     IFEQ *ON                                                           CSD031
     C   60                WRITEGPFFAKLF               15                                     CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C                     ELSE                                                               CSD031
     C   60                WRITEFACKYDF                15
     C                     ENDIF                                                              CSD031
     C*
     C** TEST FOR UPDATE BY ANOTHER W/S, OR A TERMINAL ERROR
     C*
     C           *IN15     IFEQ '1'
     C           STATUS    ANDEQ01021
      *                                                                                       CSD031
     C           CSD034    IFEQ 'Y'                                                           CSD031
     C                     MOVELFFKY      FFKY                                                CSD031
      *                                                                                       CSD031
     C           *INU1     IFEQ *ON                                                           CSD031
     C           FACKYK    CHAINGPFFAKLX             15                                       CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C                     ELSE                                                               CSD031
     C           FACKYK    CHAINFACKYX               15
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C           *IN15     IFEQ '0'
     C                     EXSR UPDOWS
     C                     GOTO XTUPDF
     C                     END
     C                     END
     C           *IN15     IFEQ '1'
     C                     EXSR INFSR
     C                     END
     C*
     C           CSD034    IFEQ 'Y'                                                           CSD031
     C           *INU1     IFEQ *ON                                                           CSD031
     C  N60                UPDATGPFFAKLF                                                      CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C                     ELSE                                                               CSD031
     C  N60                UPDATFACKYDF
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C                     ELSE
     C*
     C**               I  N  S  E  R  T  S                 -  E N D
     C*
     C**               A  M  E  N  D  S                    -  S T A R T
     C*
     C           ACTN      IFEQ 'A'
      *                                                                                       CSD031
     C           CSD034    IFEQ 'Y'                                                           CSD031
     C*                                                                                       CSD031
     C                     MOVELFFKY      FFKY                                                CSD031
     C           *INU1     IFEQ *ON                                                           CSD031
     C           FACKYK    CHAINGPFFAKLF             60                                       CSD031
     C                     ELSE                                                               CSD031
     C           WPGEMD    IFEQ 'C'                                                           CSD031
     C           FACKYK    CHAINFACKYDF              60                                       CSD031
     C                     ENDIF                                                              CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C                     ELSE                                                               CSD031
     C           FACKYK    CHAINFACKYDF              60
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C           TNLU      IFNE STNLU
     C                     EXSR UPDOWS
     C*
     C** IF NO PROCESSING OCCURRED EXIT TO SUPPRESS AUDIT UPDATE
     C*
     C                     GOTO XTUPDF
     C*
     C                     ELSE
     C*
     C** TRANSLATE RECORD DETAILS FROM SCREEN LAYOUT TO FILE LAYOUT
     C*
     C                     EXSR VALIDD
     C                     Z-ADDRUND      LCD
     C                     MOVEL'A'       CHTP
     C                     MOVELNATN      TNLU
     C                     END
      *                                                                                       CSD031
     C           CSD034    IFEQ 'Y'                                                           CSD031
      *                                                                                       CSD031
     C           *INU1     IFEQ *ON                                                           CSD031
     C  N60                UPDATGPFFAKLF                                                      CSD031
     C                     ELSE                                                               CSD031
     C           WPGEMD    IFEQ 'C'                                                           CSD031
     C  N60                UPDATFACKYDF                                                       CSD031
     C                     ENDIF                                                              CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C                     ELSE                                                               CSD031
     C  N60                UPDATFACKYDF
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C                     ELSE
     C*
     C**               A  M  E  N  D  S                    -  E N D
     C*
     C**               D  E  L  E  T  E  S                 -  S T A R T
     C*
     C           ACTN      IFEQ 'D'
      *                                                                                       CSD031
     C           CSD034    IFEQ 'Y'                                                           CSD031
      *                                                                                       CSD031
     C*                                                                                       CSD031
     C           *INU1     IFEQ *ON                                                           CSD031
     C           FACKYK    CHAINGPFFAKLF             60                                       CSD031
     C                     ELSE                                                               CSD031
     C           WPGEMD    IFEQ 'C'                                                           CSD031
     C           FACKYK    CHAINFACKYDF              60                                       CSD031
     C                     ELSE                                                               CSD031
     C           FACKYK    CHAINSDAFAKLF             60                                       CSD031
     C                     ENDIF                                                              CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C                     ELSE                                                               CSD031
     C           FACKYK    CHAINFACKYDF              60
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C********** FACKYK    CHAINFACKYDF              60                                     BUG11802
     C           TNLU      IFNE STNLU
     C                     EXSR UPDOWS
     C*
     C** IF NO PROCESSING OCCURRED EXIT TO SUPPRESS AUDIT UPDATE
     C*
     C                     GOTO XTUPDF
     C*
     C                     ELSE
     C                     MOVEL'*'       RECI
     C                     Z-ADDRUND      LCD
     C                     MOVEL'D'       CHTP
     C                     MOVELNATN      TNLU
     C                     END
      *                                                                                       CSD031
     C           CSD034    IFEQ 'Y'                                                           CSD031
     C*                                                                                       CSD031
     C           *INU1     IFEQ *ON                                                           CSD031
     C  N60                UPDATGPFFAKLF                                                      CSD031
     C                     ELSE                                                               CSD031
     C           WPGEMD    IFEQ 'C'                                                           CSD031
     C  N60                UPDATFACKYDF                                                       CSD031
     C                     ELSE                                                               CSD031
     C                     DELETSDAFAKLF                                                      CSD031
     C                     ENDIF                                                              CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C                     ELSE                                                               CSD031
     C  N60                UPDATFACKYDF
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
      ** Action = X - Start                                                                   CSD031
      *                                                                                       CSD031
     C                     ELSE                                                               CSD031
     C           CSD034    IFEQ 'Y'                                                           CSD031
      *                                                                                       CSD031
      ** Actn = 'X'    Amends or Insert - Start                                               CSD031
      *                                                                                       CSD031
     C           ACTN      IFEQ 'X'                                                           CSD031
     C           WPGEMD    ANDEQ'A'                                                           CSD031
      *                                                                                       CSD031
     C           *INU1     IFEQ *OFF                                                          CSD031
     C                     MOVELFFKY      FFKY                                                CSD031
     C           FACKYK    CHAINSDAFAKLF             60                                       CSD031
     C                     EXSR MDATA1                                                        CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C           #1ACTN    IFEQ 'INSERT'                                                      CSD031
     C           #1ACTN    OREQ 'AMEND'                                                       CSD031
      *                                                                                       CSD031
      ** Update the record to Zone file                                                       CSD031
      *                                                                                       CSD031
     C                     MOVEL'RA'      AID                                                 CSD031
      *                                                                                       CSD031
     C                     MOVELWFFKY     FFKY                                                CSD031
     C           FACKYK    CHAINFACKY                61                                       CSD031
     C           *IN61     IFEQ *OFF                                                          CSD031
     C                     MOVE RECI      WRECI   1                                           CSD031
     C                     EXSR MDATA2                                                        CSD031
     C                     EXSR VALIDD                                                        CSD031
     C                     Z-ADDRUND      LCD                                                 CSD031
     C                     MOVELNATN      TNLU                                                CSD031
      *                                                                                       CSD031
      ** Effective date should be the date when the record was accepted by the zonal file     CSD031
      ** Write Record                                                                         CSD031
      *                                                                                       CSD031
     C                     Z-ADDRUND      EACC                                                CSD031
      *                                                                                       CSD031
     C           WRECI     IFEQ '*'                                                           CSD031
     C                     MOVE 'I'       CHTP                                                CSD031
     C                     MOVE 'I'       ACTN                                                CSD031
     C                     MOVE 'D'       RECI                                                CSD031
     C                     ELSE                                                               CSD031
     C                     MOVE 'A'       CHTP                                                CSD031
     C                     MOVE 'A'       ACTN                                                CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C                     MOVEL*BLANKS   ERRMSG                                              CSD031
     C                     UPDATFACKYDF                                                       CSD031
     C                     ELSE                                                               CSD031
     C                     Z-ADDRUND      EACC                                                CSD031
     C                     MOVEL'I'       CHTP                                                CSD031
     C                     MOVEL'I'       ACTN                                                CSD031
     C                     WRITEFACKYDF                                                       CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
      ** End - #1ACTN                                                                         CSD031
      *                                                                                       CSD031
     C           FACKYK    CHAINSDAFAKLF             88                                       CSD031
     C           *IN88     IFEQ *OFF                                                          CSD031
     C                     DELETSDAFAKLF                                                      CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C                     MOVEL*BLANKS   PFFKY                                               CSD031
     C                     MOVEL*BLANKS   PAGK                                                CSD031
     C                     MOVE '1'       *IN11                                               CSD031
      *                                                                                       CSD031
     C                     ELSE                                                               CSD031
     C           #1ACTN    IFEQ 'DELETE'                                                      CSD031
     C                     MOVELFFKY      FFKY                                                CSD031
     C           FACKYK    CHAINSDAFAKLF             88                                       CSD031
     C           *IN88     IFEQ *OFF                                                          CSD031
     C                     DELETSDAFAKLF                                                      CSD031
     C                     ENDIF                                                              CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C           FACKYK    CHAINFACKY                60                                       CSD031
     C                     MOVE RECI      WRECI                                               CSD031
     C                     MOVEL'*'       RECI                                                CSD031
     C                     Z-ADDRUND      LCD                                                 CSD031
     C                     MOVEL'D'       CHTP                                                CSD031
     C                     MOVELNATN      TNLU                                                CSD031
     C           *IN60     IFEQ *OFF                                                          CSD031
     C           WRECI     IFEQ '*'                                                           CSD031
     C           #1ACTN    ANDEQ'DELETE'                                                      CSD031
     C                     MOVE *BLANK    ACTN                                                CSD031
     C                     ELSE                                                               CSD031
     C                     MOVE 'D'       ACTN                                                CSD031
     C                     ENDIF                                                              CSD031
     C                     MOVEL'C'       WPGEMD                                              CSD031
     C                     UPDATFACKYDF                                                       CSD031
     C                     ENDIF                                                              CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C                     MOVEL*BLANKS   PFFKY                                               CSD031
     C                     MOVEL*BLANKS   PAGK                                                CSD031
     C                     MOVEL*BLANKS   @2DBRC                                              CSD031
     C                     MOVE '1'       *IN11                                               CSD031
      *                                                                                       CSD031
      ** Action = 'X'  Amends and Insert - end                                                CSD031
      ** Endif CSD034                                                                         CSD031
      *                                                                                       CSD031
     C                     ENDIF                                                              CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C                     END
     C*
     C**               D  E  L  E  T  E  S                 -  E N D
     C*
     C                     END
     C                     END
     C/COPY WNCPYSRC,FF0180C006
     C*
     C** GET AUDIT RECORD
     C*
      *                                                                                       CSD031
     C           CSD034    IFEQ 'Y'                                                           CSD031
     C           *INU1     ANDEQ*ON                                                           CSD031
     C                     EXSR MDATA                                                         CSD031
     C                     MOVEL@1DBRC    DETREC                                              CSD031
     C                     EXSR SRSDTQ                                                        CSD031
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
     C           CSD034    IFEQ 'N'                                                           CSD031
     C           CSD034    OREQ 'Y'                                                           CSD031
     C           *INU1     ANDEQ*OFF                                                          CSD031
     C           1         CHAINFACKYAF              99
     C*
     C** UPDATE AUDIT RECORD IF FOUND
     C*
     C           *IN99     IFEQ '0'
     C*
     C** FOR INSERT, UPDATE LIVE RECORDS INSERTED TODAY, AND NO. OF LIVE
     C** RECORDS
     C*
     C           ACTN      IFEQ 'I'
     C                     ADD  1         NINS
     C                     ADD  1         NORE
     C                     END
     C*
     C** FOR AMENDS, UPDATE NO. OF RECORDS AMENDED TODAY
     C*
     C           ACTN      IFEQ 'A'
     C                     ADD  1         NAMD
     C                     END
     C*
     C** FOR DELETIONS, UPDATE NO. DELETIONS TODAY, AND NO. OF LIVE RECS
     C*
     C           CSD034    IFEQ 'Y'                                                           CSD031
     C           WPGEMD    IFEQ 'C'                                                           CSD031
     C           ACTN      IFEQ 'D'                                                           CSD031
     C                     ADD  1         NDEL                                                CSD031
     C                     SUB  1         NORE                                                CSD031
     C                     ENDIF                                                              CSD031
     C                     ENDIF                                                              CSD031
     C                     ELSE                                                               CSD031
     C           ACTN      IFEQ 'D'
     C                     ADD  1         NDEL
     C                     SUB  1         NORE
     C                     END
     C                     ENDIF                                                              CSD031
     C*
     C** FORMAT COMIT TEXT
     C*
     C                     TIME           MTIME
     C                     MOVELACTN      ACTNX
     C                     MOVEASCRCTL    DET,01
     C                     MOVEADETS      DET,17
     C*
     C** UPDATE AUDIT RECORD
     C*
     C                     UPDATFACKYAF
     C*
     C***C**O**M**I**T                                                                        CSD031
     C*
     C********** CMTTXT    COMIT                                                              CSD031
     C*
     C** AUDIT RECORD NOT FOUND: DATABASE ERROR
     C*
     C                     ELSE
     C*
     C                     SETON                     U7U8  ***************
     C           *LOCK     IN   LDA                                       S01117
     C***********          MOVEL'02'      DBASE            * DB ERROR 02 *S01117
     C                     Z-ADD2         DBASE            * DB ERROR 02 *S01117
     C                     MOVEL'FACKY'   DBFILE           ***************
     C                     MOVEL'AUDIT'   DBKEY
     C                     OUT  LDA                                       S01117
     C                     EXSR *PSSR                                     S01117
     C                     END
     C*
     C                     ENDIF                                                              CSD031
      *                                                                                       CSD031
      ** Commitment                                                                           CSD031
      *                                                                                       CSD031
     C           CMTTXT    COMIT                                                              CSD031
      *                                                                                       CSD031
     C           XTUPDF    ENDSR
     C*================================================================
      /EJECT
     C*================================================================
      **
      ** UPDOWS S/R TO PROCESS UPDATE BY ANOTHER WORKSTATION
      ** CALLED FROM UPDFLS
      ** CALLS NO OTHER S/R'S
      **
     C*================================================================
     C           UPDOWS    BEGSR
     C**
     C                     ROLBK
     C**
     C**   SET UP NEXT SCREEN TO BE DISPLAYED:
     C**   IF RECORD IS LIVE, ALLOW AMEND PROCESSING;
     C**
     C           RECI      IFEQ 'D'
     C                     MOVEL'A'       ACTN
     C                     ELSE
     C**
     C**   IF RECORD HAS BEEN DELETED, ALLOW ENQUIRY
     C**
     C                     MOVEL'E'       ACTN
     C                     END
     C**
     C**   SET SCREEN PROCESSOR TO UPDATE AND MOVE UPDATE MESSAGE TO ERROR
     C**
     C                     MOVEA'001'     *IN,10
     C                     MOVELINF,11    INFMSG
     C**
     C                     ENDSR
     C**
      /EJECT                                                                                  CSD031
     C*================================================================                       CSD031
     C           SRSDTQ    BEGSR                                                              CSD031
      *                                                                                       CSD031
      ** Setup details and send message to data queue                                         CSD031
      *                                                                                       CSD031
     C                     MOVEL'GPFAKYPD'PDFILE                                              CSD031
     C                     MOVELFFKY      PRANGE                                              CSD031
     C                     MOVELDETREC    PDDATA                                              CSD031
     C           'SD'      CAT  'ACCPDTQ' PDQNAM                                              CSD031
      *                                                                                       CSD031
     C           *LOVAL    SETLLGPZONEL0                                                      CSD031
     C                     READ GPZONEL0                 90                                   CSD031
     C           *IN90     DOWEQ*OFF                                                          CSD031
     C           ZOMSYS    CAT  'DPLIB'   PDQLIB                                              CSD031
     C           ZOMSYS    CAT  PGMB      PGNAM  16                                           CSD031
     C                     CALL PGNAM                                                         CSD031
     C                     PARM           PDQNAM 10                                           CSD031
     C                     PARM           PDQLIB 10                                           CSD031
     C                     PARM           PDQMSG                                              CSD031
     C                     READ GPZONEL0                 90                                   CSD031
     C                     ENDDO                                                              CSD031
     C                     ENDSR                                                              CSD031
      *================================================================                       CSD031
      /EJECT                                                                                  CSD031
      *================================================================                       CSD031
      ** SRRTTX - Retrieve Text for error message                                             CSD031
      *================================================================                       CSD031
     CSR         SRRTTX    BEGSR                                                              CSD031
      *                                                                                       CSD031
     C                     MOVEL*BLANK    WMSGQ1 10                                           CSD031
     C                     MOVEL*BLANK    ERRMSG                                              CSD031
     C           WMSGQ1    IFEQ *BLANK                                                        CSD031
     C           'GB'      CAT  'SDUSRMSG'MSGF                                                CSD031
     C                     END                                                                CSD031
      *                                                                                       CSD031
     C                     CALL 'SDRTVTXT'                                                    CSD031
     C           MSGNO     PARM MSGNO     MSGDNB  7                                           CSD031
     C           MSGF      PARM MSGF      MSGFLE 10                                           CSD031
     C           WUMTXT    PARM WUMTXT    MSGTXT 80                                           CSD031
      *                                                                                       CSD031
     CSR         SREXIT    ENDSR                                                              CSD031
     C*================================================================
     C/COPY WNCPYSRC,FF0180C010
      /EJECT
     C*CALCULATION SPECIFICATIONS:SUBROUTINES**************************
     C*================================================================
     C           ZTNLU1    BEGSR
     C*
     C** GO TO DATA AREA FOR NEXT AVAILABLE TRANSACTION NUMBER
     C*
     C           *NAMVAR   DEFN MNATN     DNATN
     C           *LOCK     IN   DNATN
     C                     MOVE FNATN     NATN    50
     C                     MOVE FNATN     ZZWK05  50
     C                     ADD  1         ZZWK05
     C                     MOVE ZZWK05    FNATN
     C                     OUT  DNATN
     C                     ENDSR
     C*================================================================
      /EJECT
     C*================================================================
     C**
     C**   FILE EXEPTION/ERROR HANDLING SUBROUTINE
     C**
     C           INFSR     BEGSR
     C**
     C** ROLL BACK CHANGES AND CANCEL PROGRAM
     C**
     C                     ROLBK
     C                     MOVE '*CANCL'  EXTTAG  6
     C**
     C                     ENDSREXTTAG
     C*================================================================
      /EJECT                                                                                  CSD031
     C*================================================================                       CSD031
      ** FILE EXEPTION/ERROR HANDLING SUBROUTINE                                              CSD031
     C*================================================================                       CSD031
     C           INFS1     BEGSR                                                              CSD031
      *                                                                                       CSD031
     C** ROLL BACK CHANGES AND CANCEL PROGRAM                                                 CSD031
      *                                                                                       CSD031
     C                     ROLBK                                                              CSD031
     C                     MOVE '*CANCL'  EXTAG   6                                           CSD031
      *                                                                                       CSD031
     C                     ENDSREXTAG                                                         CSD031
     C*================================================================                       CSD031
      /EJECT                                                                                  CSD031
     C*================================================================                       CSD031
      ** FILE EXEPTION/ERROR HANDLING SUBROUTINE                                              CSD031
     C*================================================================                       CSD031
     C           INFS2     BEGSR                                                              CSD031
      *                                                                                       CSD031
     C** ROLL BACK CHANGES AND CANCEL PROGRAM                                                 CSD031
      *                                                                                       CSD031
     C                     ROLBK                                                              CSD031
     C                     MOVE '*CANCL'  EXTAG   6                                           CSD031
      *                                                                                       CSD031
     C                     ENDSR                                                              CSD031
     C*================================================================                       CSD031
      /EJECT                                                                                  CSD031
      *================================================================                       CSD031
     CSR         ZDATE2    BEGSR                                                              CSD031
      *                                                                                       CSD031
      ** Convert Date                                                                         CSD031
      *                                                                                       CSD031
     C                     CALL 'ZDATE2'                                                      CSD031
     C                     PARM           WVLDTE  50                                          CSD031
     C                     PARM           WDTFMT  1                                           CSD031
     C                     PARM           WZDATE  60                                          CSD031
     C                     PARM           WRNDTE  7                                           CSD031
      *                                                                                       CSD031
     CSR                   ENDSR                                                              CSD031
      *================================================================                       CSD031
      /EJECT                                                                                  CSD031
      *================================================================                       CSD031
     CSR         ZDATE1    BEGSR                                                              CSD031
      *                                                                                       CSD031
     C                     CALL 'ZDATE1'                                                      CSD031
     C                     PARM           ERRORF  7                                           CSD031
     C                     PARM           ZDATEA  60                                          CSD031
     C                     PARM           ZDATFM  1                                           CSD031
     C                     PARM           ZDAYNO  50                                          CSD031
      *                                                                                       CSD031
     CSR                   ENDSR                                                              CSD031
     C********************************************************************S01117
      **                                                                  S01117
      ** *PSSR --- SUBROUTINE TO HANDLE ABNORMAL ERROR CONDITIONS         S01117
      ** CALLED FROM: AFTER ABNORMAL OPERATION OCCURS                     S01117
      ** CALLS: NOTHING                                                   S01117
      **                                                                  S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C           *PSSR     BEGSR                           ** *PSSR **    S01117
     C*                                                                   S01117
     C           @RUN      IFEQ *BLANKS                                   S01117
     C                     MOVE 'Y'       @RUN    1                       S01117
     C                     DUMP                                           S01117
     C                     END                                            S01117
     C                     ENDSR                           ** *PSSR **    S01117
     C*                                                                   S01117
     C********************************************************************S01117
      * /104633/ Change
     C/COPY WNCPYSRC,FF0180C007
      * INF,7  DELETION F3:F10 to delete this record:F12:Rollup:Rolldown:help
      * INF,10 F10 is reqiured
      * INF,11 F10 is not reqiured
**  CPY@
(c) Finastra International Limited 2001
** INF
 Enter:Action Code I,A,D,E and selection:Review from point:F3:Help
 Enter:Review from point:Action Code A,D,E:F3:F12.Rollup:Rolldown:     Help
 INSERTION Enter:F3:F12:Help
 AMENDMENT Enter:F3:F12:Rollup:Rolldown:Help
 ENQUIRY Enter:F3:F12:Rollup:Rolldown:Help
 DELETION F3:F10=Delete record:F12:Rollup:Rolldown:Help
 Rollup is not possible
 Rolldown is not possible
 F10=Confirm

 Record has been updated by another workstation
 Action Code I,A,D,E   F3 = Exit   ENTER = Review                                             CSD031
 Action Code A,D,E   F3 = Exit   F12=Previous                Rollup:Rolldown                  CSD031
 Action Code A,D,E   F3 = Exit   ENTER = Review and Acceptance                                CSD031
 Action Code A,D,E  F3=Exit F12=Previous F11=Accept Mode     Rollup:Rolldown                  CSD031
 Action Code X,D,E  F3=Exit F12=Previous F11=Change Mode     Rollup:Rolldown                  CSD031
** TABACD
 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ
** TITL                                                                                       CSD031
CENTRAL FO ACCOUNT KEYS INPUT                                                                 CSD031
FO ACCOUNT KEYS INPUT                                                                         CSD031
CENTRAL FO ACCOUNT KEYS REVIEW                                                                CSD031
FO ACCOUNT KEYS REVIEW                                                                        CSD031
FO ACCOUNT KEYS ACCEPTANCE REVIEW                                                             CSD031
FO ACCOUNT KEYS ACCEPTANCE                                                                    CSD031
Central Data                                                                                  CSD031
Accept To Zone                                                                                CSD031
OVRDBF FILE(GZSDBANK) TOFILE(GZSDBANKL2)                                                      CSD031
