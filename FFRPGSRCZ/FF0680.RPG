     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas FF I/C Term. Check for Active EOCs')
     F********************************************************************
     F*                                                                  *
     F*  Midas - Futures and Options Module
     F*                                                                  *
     F*   FF0680  -  INPUT CYCLE TERMINATION CHECK FOR ACTIVE EOC RUNS   *
     F*                                                                  *
      *  (c) Finastra International Limited 2001                      *
     F*                                                                  *
      *  Last Amend No. MD046248           Date 27Oct17               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *  Prev Amend No. S01456             Date 08Nov93               *
      *                 N00000             Date DDMmmYY               *
     F*                                                                  *
     F*------------------------------------------------------------------*
     F*                                                                  *
      *  MD046248 - Finastra Rebranding                               *
     F*     S01456 - 'FF' MONTHLY P&L ENHANCEMENTS.                      *
     F*              Recompiled due to change to PF/MKCTLD.              *
     F*                                                                  *
     F*------------------------------------------------------------------*
     F*     CREATION REQUIREMENTS                                        *
     F*                                                                  *
     F*     IGNDECERR(*NO)                                               *
     F*                                                                  *
     F********************************************************************
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
     FMKCTLD  IF  E                    DISK
     F********************************************************************
     F*
     F* ID F  C  H  L    FUNCTION OF INDICATORS
     F*
     F*        20     EOF ON MKCTLD
     F*
     F*
     F********************************************************************
     F/SPACE 2
     E                    CPY@    1   1 80
     I*  DATA STRUCTURE FOR COMPILATION  - COPYRIGHT INSERTION
     ICPYR@#      DS
     I                                        1  80 CPY@
     I                                        1  20 CPY@##
     C/EJECT
     C*===================================================================
      **
      ** INITIAL PROCESSING
      ** CALLS MAIN AND END SUBROUTINES.
      **
     C*===================================================================
     C*
     C           *LIKE     DEFN ECAI      OPENIC
     C           *ENTRY    PLIST
     C                     PARM           OPENIC
     C**
     C*
     C** First access of MKCTLD
     C                     READ MKCTLDF                  20
     C/EJECT
     C*===================================================================
      **
      ** MAIN PROCESSING
      ** UPDATES PF/MKCTLD WHEN INPUT CYCLE HAS TERMINATED.
      **
     C*===================================================================
     C*
     C** Check for EOC status indicator while not EOF
     C           *IN20     DOWNE'1'
     C*
     C** If record is live and Market status indicator = E
     C*  update parameter OPENIC to reopen input cycle.
     C           MKCI      IFEQ 'E'
     C           RECI      ANDEQ'D'
     C                     MOVE '1'       OPENIC
     C                     MOVE '1'       *IN20
     C*
     C                     ELSE
     C*
     C* Record is not live with MKCI = 'E'; read next record.
     C                     READ MKCTLDF                  20
     C                     END
     C*
     C                     END
     C*
     C*
     C                     SETON                     LR
     C                     RETRN
     C*================================================================
**  CPY@
(c) Finastra International Limited 2001
