     H        1
     F*****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas FF Instrument type list')                        *
      *****************************************************************
     F*                                                                  *
     F*  Midas - Futures and Options Module
     F*                                                                  *
     F*   FF1140  -  INSTRUMENT TYPE LIST                                *
     F*                                                                  *
      *  (c) Misys International Banking Systems Ltd. 2001            *
     F*                                                                  *
      *  Last Amend No. CAP208             Date 06Dec10               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *  Prev Amend No. BUG11632           Date 28Jun06               *
      *                 CSD027             Date 09Dec05               *
      *                 CER001             Date 25Apr05               *
      * Midas Release 4 --------------- Base -------------------------*
      *                 CFF007             Date 16Feb01               *
      * Midas DBA 3.05 -----------------------------------------------*
      *                 CFF006             Date 28Nov00               *
      * Midas DBA 3.03 -----------------------------------------------*
      *                 150367             Date 07Apr00               *
      * Midas DBA 3.02 -----------------------------------------------*
      *                 CPB001             Date 18Jun99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
     F*                  138028             DATE 10MAY99                 *
     F*                  CPL002             DATE 04MAR99                 *
     F*                  CFF004             DATE 02OCT96                 *
     F*                  S01408             DATE 13AUG96                 *
     F*                  CPM003             DATE 01MAR96                 *
     F*                  S71062             DATE 11DEC95                 *
     F*                  S01408             DATE 09JAN96                 *
     F*                  S01408             DATE 04SEP95                 *
     F*                  073714             DATE 01MAR95                 *
     F*                  S01455             DATE 05NOV93                 *
     F*                  S01393             DATE 30OCT92                 *
     F*                  FUJI-FF0011        DATE 10AUG92                 *
     F*                  AUS022             DATE 10AUG92                 *
     F*                  E026108            DATE 17JUL91                 *
     F*                  FO0033             DATE 14MAR91                 *
     F*                  S01117             DATE 10JAN90                 *
     F*                  E18343             DATE 11NOV89                 *
     F*                  E14963             DATE 10/09/88                *
     F*                                                                  *
     F*------------------------------------------------------------------*
     F*                                                                  *
      *  CAP208 - F&O Market Instrument API (Recompile)               *
      *  BUG11632 - FFC0616 failed                                       *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CER001 - LUX Upgrade to MidasPLus                               *
      *  CFF007 - Futures and Options Enhancement for Private Banking *
      *  CFF006 - Fractional Ticks Enhancement.                       *
      *  150367 - Recompile over changed /copy FFSTDPZ4.                 *
     F*   CPB001 - 'Private Banking' Module                              *
     F*   138028 - Recompiled for changed Printer file.                  *
     F*   CPL002 - Midas-Plato Interface                                 *
     F*   CFF004 - Increase in size of Price Fields,(Recompiled Only)    *
     F*   S01408 - Addition of hooks FF1140FFP1                          *
     F*   CPM003  - Add PM Instrument type                            *
     F*   S71062 - FF/PM Interface (Just recompiled)                     *
     F*   S01408 - Addition of hooks FF1140CCP8                          *
     F*   S01408 - Addition of hooks FF1140CCP1                          *
     F*                              FF1140CCP2                          *
     F*                              FF1140CCP3                          *
     F*                              FF1140CCP4                          *
     F*                              FF1140CCP5                          *
     F*                              FF1140CCP6                          *
     F*                              FF1140CCP7                          *
     F*                              FF1140EEP1                          *
     F*                              FF1140IIP1                          *
     F*   073714  -  OTC ENHANCEMENTS                                    *
     F*   S01455  -  'FF' ACCOUNT KEY ENHANCEMENTS.                      *
     F*              Recompiled due to changes in file TABFF.            *
     F*   S01393  -  RECOMPILED FOR STRATEGIC RISK MANAGEMENT            *
     F* FUJI-FF0011 - The system does not differentiate between          *
     F*               american and european option on exercise           *
     F*               validation and OTC confirmation wording.           *
     F*   AUS022  -  AUSTRALIAN CHANGE : Introduction of Processing      *
     F*              Types 7 and 8.                                      *
     F*   E026108 -  The fields CHTP and LCD associated with the         *
     F*              instrument details read from lf/intyp1 or           *
     F*              pf/jrncgd are overwritten by detail read from       *
     F*              other files because the field names are common.     *
     F*   FO0033  -  REFORMAT THE TICK VALUE SO THAT IT IS DISPLAYED     *
     F*              WITH DECIMAL PLACES EQUAL TO CURRENCIES PLUS TWO    *
     F*   S01117  -  MULTIBRANCHING                                      *
     F*   E18343  -  PROGRAM RE-COMPILED DUE TO CHANGE IN ZSRSRC MEMBER  *
     F*              ZFRPEDZ3                                            *
     F*   E14963  -  IMPROVE OVERFLOW PROCESSING FOR DATABASE ERROR      *
     F*              OR END OF REPORT                                    *
     F*              ALSO RESOLVES CONFLICT OF ZADEC DEFINITION IN       *
     F*              PGM AND ZSRSRC                                      *
     F*                                                                  *
     F*------------------------------------------------------------------*
     F*     CREATION REQUIREMENTS                                        *
     F*                                                                  *
     F******IGNDECERR(*NO)                                               *073714
     F*     IGNDECERR(*YES)                                              *073714
     F*                                                                  *
     F********************************************************************
     FMARKT   IF  E           K        DISK
     FCLINT   IF  E           K        DISK
     F            CLINTCAF                          KIGNORE
     F            CLINTCCF                          KIGNORE
     F            CLINTC1F                          KIGNORE
     FTABFF   IF  E           K        DISK
     F**ICD*1**** TABTB10F                          KIGNORE               S01117
     F            TABTB10F                          KIGNORE               S01117
     F            TABTB11F                          KIGNORE
     F            TABTB20F                          KIGNORE
     F            TABTB40F                          KIGNORE
     F            TABTB80F                          KIGNORE
     F            TABTE10F                          KIGNORE
     F* CCY 1     TABTG10F                          KIGNORE
     F            TABLETHF                          KIGNORE
     F            TABLETLF                          KIGNORE
     F            TABLETRF                          KIGNORE
     F            TABLET2F                          KIGNORE
     FINTYP1  IF  E           K        DISK                           UC
     F*                                                                   S01408
     F/COPY WNCPYSRC,FF1140FFP1                                           S01408
     FFFITX2L0IF  E           K        DISK                           UC                      CER001
     F*                                                                   S01408
     FJRNCGD  IF  E           K        DISK                           U3
     F/COPY WNCPYSRC,FF1140F001
     FFF1140P1O   E                    PRINTER
     F                                              KINFDS SPOOL          S01117
     F***********                                   KINFDS PRINT          S01117
     FFF1140AUO   E                    PRINTER                            S01117
     F                                              KINFDS SPOOLU         S01117
     F********************************************************************
     F*
     F*                FUNCTION OF INDICATORS
     F*
     F*      30      END OF FILE - INTYP1
     F*      40      PORTFOLIO MANAGEMENT MODULE ON                       CPM003
     F*
     F*      50      CHAIN TO CLINT FAILED
     F*      51      CHAIN TO MARKT FAILED
     F*      53      SWITCH U3                                            S01117
     F*      60      CHAIN TO INTYP1 FAILED
     F*      61      LOKUP INDICATOR FOR INSTR PROC TYPE
     F*      62      ON FOR OVER THE COUNTER INSTRUMENTS
      *      70      Print Fractional Ticks Field on the Report       *   CFF006
     F*
     F*      80-89   FF&O STANDARD SUB-ROUTINES
     F*
     F*     NU3      PROCESS INTYP1
     F*      U3      PROCESS JRNCGD (AUDIT)
     F*
     F*******99******READ*TABTB10*****************************************S01117
     F*
     F* U7 & U8      DATABASE ERROR
     F*
     F*****************************************************************
     E                    CPY@    1   1 80
     E*                                                                   S01408
     E/COPY WNCPYSRC,FF1140EEP1                                           S01408
     E                    LUL         7132                                                    CER001
      *                                                                                       CER001
      ** IBLC Extended informations array                                                     CER001
      *                                                                                       CER001
     E                    BLC         3132                                                    CER001
      * IBLC 2002 Extended informations array                                                 CER001
     E*                                                                   S01408
     E/EJECT
     E*****************************************************************
     E*
     E                    MQ         12  1
     E**   MONTHS QUOTED
     E*
     E/COPY ZSRSRC,ZDATE2Z1
     E**   FOR CONVERTING A DAY NUMBER TO A DATE FORMAT
     E*
     E**********          TABINP  1   6  1 0 TABINR 20                    AUS022
     E                    TABINP  1   8  1 0 TABINR 20                    AUS022
     E**   INSTRUMENT PROCESSING TYPES
     E                    MTH        12  3
     E**   MONTHS
     E*
     E                    SWS         8  1
     E**   SWITCHES
     E*
     E*****************************************************************
     E*
     E/COPY ZSRSRC,FFSTDPZ1
     E*
     E**   FOR CURRENCY DECIMAL PLACE SUBROUTINE
     E*
     E*****************************************************************
     E*
     E/COPY ZSRSRC,ZFRPEDZ1
     E*
     E**   FOR REPORT AMOUNT EDIT SUBROUTINE
     E*
     E*****************************************************************
     E*
     E/COPY ZSRSRC,ZEDITZ1
     E*
     E**   FOR REPORT VALUE EDIT SUBROUTINE
     E*
     E*****************************************************************
     E/EJECT
     I*****************************************************************
     I*                                                                   E26108
     I*                                                                   E26108
     I**   Rename LCD and CHTP so that contents are not overwritten       E26108
     I*                                                                   E26108
     IINTYPDF                                                             E26108
     I              LCD                             @LCD                  E26108
     I              CHTP                            @CHTP                 E26108
     I*
     IJOESD     E DSINTYPD
     I              LCD                             @LCD                  E26108
     I              CHTP                            @CHTP                 E26108
     I*
     I** DATA STRUCTURE FOR RECORD LAYOUT
     I*
     I*RINT****** DS                                                      S01117
     ISPOOL       DS                                                      S01117
     I                                       83  92 SFILE                 S01117
     I                                    B 123 1240SFNUM                 S01117
     I                                    B 367 3680LINE
     I*
     I** FILE INFORMATION DATA STRUCTURE - AU
     I*
     ISPOOLU      DS                                                      S01117
     I                                       83  92 SFILEU                S01117
     I                                    B 123 1240SFNUMU                S01117
     I*                                                                   S01117
     I** LOCAL DATA AREA FOR DATABASE ERROR DETAILS                       S01117
     I** *LOCK IN LDA immediately before and OUT LDA immediately          S01117
     I** after each database error handling.                              S01117
     I*                                                                   S01117
     ILDA         DS                            256
     I***********                           134 138 DBFILE                S01117
     I***********                           139 167 DBKEY                 S01117
     I***********                           168 175 DBPGM                 S01117
     I***********                           176 177 DBASE                 S01117
     I                                      134 141 DBFILE                S01117
     I                                      142 170 DBKEY                 S01117
     I                                      171 180 DBPGM                 S01117
     I                                      181 1830DBASE                 S01117
     I**                                                                  S01117
     IRUNDT       DS                                                      S01117
     I** DATA AREA RUNDAT                                                 S01117
     I                                        1   7 RUNA                  S01117
     I                                    P   8  100RUND                  S01117
     I                                       11  11 SSF                   S01117
     I                                       12  12 DATF                  S01117
     I                                       13  13 MBIN                  S01117
     ISDBANK    E DSSDBANKPD                                              S01117
     I** BANK DETAILS                                                     S01117
     I              BJURPT                          TITL                  S01117
     I@MMOD     E DSSDMMODPD                                              CPM003
     I** MIDAS MODULE DETAILS                                             CPM003
     ISDPORT    E DSSDPORTPD                                              CPM003
     I** Portfolio Management ICD                                         CPM003
      *                                                                   CFF006
     ISCSARD    E DSSCSARDPD                                              CFF006
      * SAR File details accessed via access program AOSARDR0             CFF006
      **                                                                  CFF006
     I@DSFDY    E DSDSFDY                                                 S01117
     I*  FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE               S01117
      **                                                                  S01117
     I*                                                                   CFF007
     I** Long data structure for access objects                           CFF007
     I*                                                                   CFF007
     I@DSSDY    E DSDSSDY                                                 CFF007
     I*                                                                   S01408
     I/COPY WNCPYSRC,FF1140IIP1                                           S01408
      *                                                                                       CER001
      ** Define fields narratives                                                             CER001
      *                                                                                       CER001
     I              'OPTION CALCULATION - C         LCAD1                                     CER001
     I              'METHOD:'                                                                 CER001
     I              'SECURITY SHORTNAME:' C         LCAD2                                     CER001
     I              'BROAD-BASED INDEX:'  C         LCAD3                                     CER001
      *                                                                                       CER001
      ** Define Line to print                                                                 CER001
      *                                                                                       CER001
     IRLCAD       DS                            132                                           CER001
     I                                       02  27 RLCAD1                                    CER001
     I                                       30  30 ROPCM                                     CER001
     I                                       38  56 RLCAD2                                    CER001
     I                                       59  68 RSESN                                     CER001
     I                                       95 112 RLCAD3                                    CER001
     I                                      115 115 RBBIX                                     CER001
     IIBFROM      DS                                                                          CER001
      * Extended informations from IBLC 2002                                                  CER001
     I                                        1 132 IBFRO1                                    CER001
     I                                      133 264 IBFRO2                                    CER001
     I                                      265 396 IBFRO3                                    CER001
     I*                                                                   S01408
     IINSTR       DS
     I                                        1   5 ISTTX
     I                                        1   2 MRKT
     I                                        3   5 ISTC
     IDSMTHS      DS
     I                                        1  36 MTHS
     I                                        1   3 MTH1
     I                                        4   6 MTH2
     I                                        7   9 MTH3
     I                                       10  12 MTH4
     I                                       13  15 MTH5
     I                                       16  18 MTH6
     I                                       19  21 MTH7
     I                                       22  24 MTH8
     I                                       25  27 MTH9
     I                                       28  30 MTH10
     I                                       31  33 MTH11
     I                                       34  36 MTH12
     I**
     ICCYDP       DS
     I                                        1  150FFAM
     I                                        1  15 FFAMX
     I**
     ICLNTKY      DS
     I                                        1   7 CLINTF
     I**********                              1   60KCNUM                                     CSD027
     I                                        1   6 KCNUM                                     CSD027
     I                                        7   7 KRCDT
     I**
     IINTYKY      DS
     I                                        1   6 INTYPF
     I                                        1   1 KISTI
     I                                        2   6 KISTT
     I*****************************************************************
     I*
     I/COPY ZSRSRC,FFSTDPZ2
     I*
     I**   FOR CURRENCY DECIMAL PLACE SUBROUTINE
     I*
     I*****************************************************************
     I*
     I/COPY ZSRSRC,ZFRPEDZ2
     I*
     I**   FOR REPORT AMOUNT EDIT SUBROUTINE
     I*
     I*****************************************************************
     I/EJECT
     I*  DATA STRUCTURE FOR COMPILATION  - COPYRIGHT INSERTION
     ICPYR@#      DS
     I                                        1  80 CPY@
     I                                        1  20 CPY@##
     C********************************************************************
     C*
     C**  DEFINE KEY LISTS FOR CHAINING TO CLINT AND INTYP1 FILES
     C*
     C           CLINTK    KLIST
     C                     KFLD           KCNUM
     C                     KFLD           KRCDT
     C*
     C           INTYPK    KLIST
     C                     KFLD           KISTI
     C                     KFLD           KISTT
     C**
     C**   Receive Parameters
     C**
     C           *ENTRY    PLIST
     C                     PARM           SWS
     C                     PARM           SEQ     5        SEQUENCE       S01117
     C********************************************************************
     C/EJECT
     C*================================================================
     C*  P R O G R A M     S T A R T
     C*================================================================
     C*
     C********************************************************************
     C** INDEX OF SUBROUTINES
     C*
     C** INIT              INITIALISATION OF STANDARD FIELDS,
     C**                   RUNDAT                                         S01117
     C*********************ACCESS*OF*ICD1*********************************S01117
     C*
     C** BODY              READ A RECORD AND PROCESS
     C*
     C** END               END PROCESSING
     C*
     C** INTYPR            PREPARE EACH RECORD FOR REPORT
     C*
     C** PAGES             PROCESS REPORT PAGES
     C*
     C** CPDS              PROCESS CURRENCY DEC.PLACES
     C*
     C** ACCESS            READ NEXT VALID RECORD
     C*
     C** ZDATE2            TO CONVERT DAY NUMBER TO DATE FORMATS
     C*
     C** FFSTDP            TO DETERMINE NO.OF CURRENCY DEC.PL.
     C*
     C** ZFRPED            TO EDIT MIDAS AMOUNT FIELDS FOR OUTPUT
     C**                    TO EXTERNALLY DESCRIBED PRINTER FILE
     C*
     C** ZEDIT             TO EDIT TICK VALUE FIELDS FOR OUTPUT
     C**                    TO EXTERNALLY DESCRIBED PRINTER FILE
     C*
     C** FUTURE            TO DETERMINE FUTURE INSTRUMENT NAME
     C*
     C** SWTS              TO RESET SWITCHES
     C*
     C*****************************************************************
     C/EJECT
     C********************************************************************
     C*
     C** MAIN PROCESS
     C*
     C********************************************************************
     C*
     C                     EXSR INIT
     C                     EXSR BODY
     C                     EXSR END
     C*
     C********************************************************************
     C/EJECT
     C*****************************************************************
     C*
     C**   INIT S/R - TO INITIALISE FIELDS,ACESS ICD1
     C**   CALLED ONCE AT START OF PROGRAM FROM MAIN LINE
     C**   CALLS NO OTHER ROUTINES
     C*
     C********************************************************************
     C*
     C           INIT      BEGSR
     C*
     C***************************************************************
     C*
     C/COPY ZSRSRC,FFSTDPZ3
     C*
     C                     Z-ADD0         RECORD
     C*
     C* ZEROISE HASH COUNT                                                S01117
     C*                                                                   S01117
     C                     Z-ADD0         COUNT   50                      S01117
     C*                                                                   S01117
     C                     MOVEL'A'       KRCDT
     C*
     C*
     C* INITIALISING THE SWITCHES
     C*
     C                     MOVE SWS,1     *INU1
     C                     MOVE SWS,2     *INU2
     C                     MOVE SWS,3     *INU3
     C                     MOVE SWS,4     *INU4
     C                     MOVE SWS,5     *INU5
     C                     MOVE SWS,6     *INU6
     C                     MOVE SWS,7     *INU7
     C                     MOVE SWS,8     *INU8
     C*                                                                   S01117
     C**     SWITCH ON/OFF *IN53 DEPENDING ON *INU3                       S01117
     C*                                                                   S01117
     C   U3                SETON                     53                   S01117
     C*                                                                   S01117
     C**     SPOOL BOTH P1 AND AU REPORTS                                 S01117
     C*                                                                   S01117
     C                     EXSR RCFSPL                                    S01117
     C*                                                                   S01117
     C**   IN THE DATAAREA RUNDAT                                         S01117
     C*                                                                   S01117
     C           *NAMVAR   DEFN RUNDAT    RUNDT                           S01117
     C                     IN   RUNDT                                     S01117
     C*
     C*******ACCESS*ICD1*FROM*TABLE*FILE**********************************S01117
     C***********                                                         S01117
     C***********          READ TABTB10F                 99               S01117
     C***********                                                         S01117
     C*****DB*ERROR*IF*RECORD*NOT*FOUND***********************************S01117
     C***********                                                         S01117
     C************IN99     IFEQ '1'                                       S01117
     C***********RECI      ORNE 'D'
     C*
     C*                                                                   S01117
     C**   GET BANK DETAILS                                               S01117
     C*                                                                   S01117
     C                     CALL 'AOBANKR0'                                S01117
     C                     PARM '*MSG   ' @RTCD   7                       S01117
     C                     PARM '*FIRST ' @OPTN   7                       S01117
     C           SDBANK    PARM SDBANK    @DSFDY                          S01117
     C           @RTCD     IFNE *BLANKS                                   S01117
     C                     SETON                     U7U8
     C*
     C**   UPDATE LDA
     C*
     C           *NAMVAR   DEFN           LDA
     C           *LOCK     IN   LDA
     C                     MOVEL'FF1140  'DBPGM
     C                     MOVE *BLANKS   DBKEY
     C                     Z-ADD1         DBASE            ***DBERR 01*** S01117
     C                     MOVE 'SDBANKPD'DBFILE                          S01117
     C                     MOVEL@OPTN     DBOPTN  7                       S01117
     C                     MOVEL@OPTN     DBKEY                           S01117
     C***********          MOVE '01'      DBASE            ***DBERR 01*** S01117
     C***********          MOVE 'TABFF'   DBFILE                          S01117
     C***********          MOVEL'01    '  TABKY  12                       S01117
     C***********          MOVE '    10'  TABKY                           S01117
     C***********          MOVELTABKY     DBKEY                           S01117
     C                     OUT  LDA
     C                     WRITEFMTP101
     C                     WRITEFMTP107
     C                     WRITEFMTAU01                                   S01117
     C                     WRITEFMTAU04                                   S01117
     C                     EXSR SWTS
     C                     EXSR *PSSR                                     S01117
     C                     SETON                     LR
     C                     RETRN
     C                     END
     C*                                                                   S01408
     C/COPY WNCPYSRC,FF1140CCP1                                           S01408
      *                                                                                       CER001
      ** Call access program for Midas modules details.                                       CER001
      *                                                                                       CER001
     C                     CALL 'AOMMODR0'                                                    CER001
     C                     PARM '*MSG    '@RTCD   7                                           CER001
     C                     PARM '*FIRST  '@OPTN   7                                           CER001
     C           @MMOD     PARM @MMOD     @DSFDY                                              CER001
      *                                                                                       CER001
     C           @RTCD     IFNE *BLANKS                                                       CER001
     C                     MOVE 'N'       BGNWST                                              CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
      ** Check if feature is On.                                                              CER001
      *                                                                                       CER001
     C                     CALL 'AOSARDR0'                                                    CER001
     C                     PARM *BLANKS   @RTCD   7                                           CER001
     C                     PARM '*VERIFY' @OPTN   7                                           CER001
     C                     PARM 'ULX004'  @SARD   6                                           CER001
     C                     PARM           @DSFDY                                              CER001
      *                                                                                       CER001
     C           @RTCD     IFEQ *BLANKS                    *B1                                CER001
     C                     MOVE 'Y'       ULX004  1                                           CER001
     C                     OPEN FFITX2L0                                                      CER001
     C                     ELSE                            *X1                                CER001
     C                     MOVE 'N'       ULX004                                              CER001
     C                     ENDIF                           *E1                                CER001
      *                                                                                       CER001
      ** Check if SAR ULX043 is installed                                                     CER001
      *                                                                                       CER001
     C                     MOVE 'N'       ULX043                                              CER001
     C                     CALL 'AOSARDR0'                                                    CER001
     C                     PARM '       ' @RTCD   7                                           CER001
     C                     PARM '*VERIFY' @OPTN   7                                           CER001
     C                     PARM 'ULX043'  @SARD   6                                           CER001
      *                                                                                       CER001
     C           @RTCD     IFEQ *BLANK                                                        CER001
     C                     MOVE 'Y'       ULX043  1                                           CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
     C*                                                                   S01408
     C*                                                                   CPM003
     C**   GET MIDAS MODULE DETAILS                                       CPM003
     C*                                                                   CPM003
     C                     CALL 'AOMMODR0'                                CPM003
     C                     PARM '*MSG   ' @RTCD                           CPM003
     C                     PARM '*FIRST ' @OPTN                           CPM003
     C           @MMOD     PARM @MMOD     @DSFDY                          CPM003
     C           @RTCD     IFNE *BLANKS                                   CPM003
     C                     SETON                     U7U8                 CPM003
     C           *LOCK     IN   LDA                                       CPM003
     C                     MOVEL'FF1140  'DBPGM                           CPM003
     C                     Z-ADD2         DBASE            ***DBERR 02*** CPM003
     C                     MOVE 'SDMMODPD'DBFILE                          CPM003
     C                     OUT  LDA                                       CPM003
     C                     WRITEFMTP101                                   CPM003
     C                     WRITEFMTP107                                   CPM003
     C                     WRITEFMTAU01                                   CPM003
     C                     WRITEFMTAU04                                   CPM003
     C                     EXSR SWTS                                      CPM003
     C                     EXSR *PSSR                                     CPM003
     C                     SETON                     LR                   CPM003
     C                     RETRN                                          CPM003
     C                     ELSE                                           CPM003
     C*                                                                   CPM003
     C           BGPFMG    IFEQ 'Y'                                       CPM003
     C                     CALL 'AOPORTR0'                                CPM003
     C                     PARM *BLANKS   @RTCD                           CPM003
     C                     PARM '*FIRST  '@OPTN                           CPM003
     C           SDPORT    PARM SDPORT    @DSFDY                          CPM003
     C           @RTCD     IFNE *BLANKS                                   CPM003
     C                     SETON                     U7U8                 CPM003
     C           *LOCK     IN   LDA                                       CPM003
     C                     MOVEL'FF1140  'DBPGM                           CPM003
     C                     MOVE *BLANKS   DBKEY            ***************CPM003
     C                     Z-ADD9         DBASE            * DB ERROR 09 *CPM003
     C                     MOVE 'SDPORTPD'DBFILE           ***************CPM003
     C                     OUT  LDA                                       CPM003
     C                     WRITEFMTP101                                   CPM003
     C                     WRITEFMTP107                                   CPM003
     C                     WRITEFMTAU01                                   CPM003
     C                     WRITEFMTAU04                                   CPM003
     C                     EXSR SWTS                                      CPM003
     C                     EXSR *PSSR                                     CPM003
     C                     SETON                     LR                   CPM003
     C                     RETRN                                          CPM003
     C                     END                                            CPM003
     C                     END                                            CPM003
     C           BGPFMG    IFEQ 'Y'                                       CPM003
     C** If Bank Portfolios are supported, treat as if PM off             CPM003
     C           FCPORS    ANDNE'B'                                       CPM003
     C           BGN4ST    OREQ 'Y'                                       CPB001
     C                     SETON                     40                   CPM003
     C                     END                                            CPM003
     C                     END                                            CPM003
      *                                                                   CFF007
      ** Check if switchable feature CFF007 is installed                  CFF007
      *                                                                   CFF007
     C                     CALL 'AOSARDR0'                                CFF007
     C                     PARM '       ' @RTCD                           CFF007
     C                     PARM '*VERIFY' @OPTN                           CFF007
     C                     PARM 'CFF007'  @SARD   6                       CFF007
     C           SCSARD    PARM SCSARD    @DSSDY                          CFF007
     C*                                                                   CFF007
     C           @RTCD     IFNE *BLANKS                                   CFF007
     C           @RTCD     ANDNE'*NRF   '                                 CFF007
     C           *LOCK     IN   LDA                                       CFF007
     C                     Z-ADD11        DBASE              *************CFF007
     C                     MOVE 'SCSARDPD'DBFILE             * DBERR 011 *CFF007
     C                     MOVEL@SARD     DBKEY              *************CFF007
     C                     MOVEL@OPTN     DBOPTN                          CFF007
     C                     EXSR *PSSR                                     CFF007
     C                     ELSE                                           CFF007
     C*                                                                   CFF007
     C           @RTCD     IFEQ *BLANKS                                   CFF007
     C                     MOVE 'Y'       CFF007  1                       CFF007
     C                     ELSE                                           CFF007
     C                     MOVE 'N'       CFF007                          CFF007
     C                     ENDIF                                          CFF007
     C                     ENDIF                                          CFF007
     C*
     C** OPEN INTYP FILE IF U3 IS NOT ON
     C*
     C  NU3                OPEN INTYP1
     C*
     C**   CHECK SYSTEM DATE FORMAT, *IN98 FOR MMDDYY.
     C*
     C           DATF      COMP 'M'                      98
      *                                                                   CFF006
      ** Determine if feature CFF006 is installed.                        CFF006
      *                                                                   CFF006
     C                     MOVE 'N'       CFF006  1                       CFF006
      *                                                                   CFF006
     C                     CALL 'AOSARDR0'                                CFF006
     C                     PARM '       ' PRTCD   7                       CFF006
     C                     PARM '*KEY   ' POPTN   7                       CFF006
     C                     PARM 'CFF006'  PSARD   6                       CFF006
     C           SCSARD    PARM SCSARD    @DSFDY                          CFF006
      *                                                                   CFF006
     C           PRTCD     IFEQ *BLANKS                                   CFF006
     C                     MOVE 'Y'       CFF006                          CFF006
      *                                                                   CFF006
     C                     ELSE                                           CFF006
      *                                                                   CFF006
      ** Else, database error (return code other than *NRF)               CFF006
      *                                                                   CFF006
     C           PRTCD     IFNE '*NRF   '                                 CFF006
     C           *LOCK     IN   LDA                                       CFF006
     C                     Z-ADD10        DBASE            ************   CFF006
     C                     MOVEL'SCSARDPD'DBFILE           * DBERR 10 *   CFF006
     C                     MOVEL'CFF006'  DBKEY            ************   CFF006
     C                     MOVELPOPTN     DBOPTN                          CFF006
     C                     OUT  LDA                                       CFF006
     C                     WRITEFMTP101                                   CFF006
     C                     WRITEFMTP107                                   CFF006
     C                     WRITEFMTAU01                                   CFF006
     C                     WRITEFMTAU04                                   CFF006
     C                     EXSR SWTS                                      CFF006
     C                     EXSR *PSSR                                     CFF006
     C                     MOVE *ON       *INU7                           CFF006
     C                     MOVE *ON       *INU8                           CFF006
     C                     MOVE *ON       *INLR                           CFF006
     C                     RETRN                                          CFF006
     C                     ENDIF                                          CFF006
     C                     ENDIF                                          CFF006
     C*
     C                     ENDSR
     C*
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C*
     C**   BODY S/R TO READ A RECORD AND PROCESS
     C**   CALLED FROM MAIN PROCESSING
     C**   CALLS: ACCESS
     C**          INTYPR
     C*
     C*****************************************************************
     C*
     C           BODY      BEGSR
     C*
     C**   READ A VALID RECORD OR GET END OF FILE
     C*
     C                     EXSR ACCESS
     C*
     C**   IF - END OF FILE, NO VALID RECORDS
     C*
     C           *IN30     IFEQ '1'
     C*
     C**      - OUTPUT HEADINGS AND NO RECORDS TO REPORT TEXT
     C*
     C                     WRITEFMTP101
     C*
     C                     WRITEFMTP105
     C*
     C                     ELSE
     C*
     C*
     C**   SET UP ISTTX FOR MARKET
     C*
     C                     MOVELISTT      ISTTX
     C*
     C**   ACCESS MARKT  FOR MARKET NAME FOR REPORT HEADING
     C**   IF INSTRUMENT IS NOT AN OTC.
     C           ISTI      IFNE 'Y'
     C                     SETOF                     62
     C*
     C           MRKT      CHAINMARKT                51
     C*
     C**   IF RECORD NOT FOUND
     C*
     C           *IN51     IFEQ '1'
     C           RECI      ORNE 'D'
     C                     SETON                     U7U8
     C*
     C**   UPDATE LDA
     C*
     C           *LOCK     IN   LDA
     C                     MOVEL'FF1140  'DBPGM
     C                     MOVE *BLANKS   DBKEY
     C***********          MOVEL'02'      DBASE            ***DBERR 02*** S01117
     C                     Z-ADD2         DBASE            ***DBERR 02*** S01117
     C                     MOVELMRKT      DBKEY
     C                     MOVEL'MARKT'   DBFILE
     C                     OUT  LDA
     C*                                                                   E14963
     C** Check line number and throw a page before writing if             E14963
     C** insufficient space remains.                                      E14963
     C*                                                                   E14963
     C           LINE      IFGE 52                                        E14963
     C                     WRITEFMTP101                                   E14963
     C                     END                                            E14963
     C*                                                                   E14963
     C                     WRITEFMTP107
     C                     WRITEFMTAU01                                   S01117
     C                     WRITEFMTAU04                                   S01117
     C                     EXSR SWTS
     C                     EXSR *PSSR                                     S01117
     C                     SETON                     LR
     C                     RETRN
     C                     END
     C*
     C                     ELSE
     C* SET UP OTC HEADING
     C                     MOVE *BLANK    MRKT
     C                     SETON                     62
     C                     END
     C*
     C**   OUTPUT HEADING FORMAT
     C*
     C                     WRITEFMTP101
     C*
     C**   INITIALISE MARKET WORK FIELD
     C                     MOVE MRKT      MRKTW   2
     C*
     C**   INITIALISE INSTRUMENT INDICATOR WORK FIELD
     C                     MOVE ISTI      ISTIX   1
     C*
     C**   ELSE - SET UP FIELDS FOR OUTPUT
     C*
     C                     EXSR INTYPR
     C*
     C**   END IF/ELSE - NOT END OF FILE
     C*
     C                     END
     C*
     C**   END SUB-ROUTINE - BODY
     C*
     C                     ENDSR
     C*
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C*
     C**   END S/R FOR END PROCESSING
     C**   CALLED FROM MAIN PROCESSING
     C*
     C*****************************************************************
     C*
     C           END       BEGSR
     C*
     C**    OUTPUT END OF REPORT MESSAGE
     C*
     C*                                                                   E14963
     C** Check line number and throw a page before writing if             E14963
     C** insufficient space remains.                                      E14963
     C*                                                                   E14963
     C           LINE      IFGE 57                                        E14963
     C                     WRITEFMTP101                                   E14963
     C                     END                                            E14963
     C*                                                                   E14963
     C                     WRITEFMTP106
     C*                                                                   S01117
     C**    OUTPUT AUDIT REPORT                                           S01117
     C*                                                                   S01117
     C                     WRITEFMTAU01                                   S01117
     C                     WRITEFMTAU02                                   S01117
     C           COUNT     IFEQ 0                                         S01117
     C                     WRITEFMTAU03                                   S01117
     C                     END                                            S01117
     C/COPY WNCPYSRC,FF1140C001
      *                                                                                       CER001
      ** If feature ULX004 is On                                                              CER001
      *                                                                                       CER001
     C           ULX004    IFEQ 'Y'                        *B1                                CER001
      *                                                                                       CER001
     C                     CLOSEFFITX2L0                                                      CER001
      *                                                                                       CER001
     C                     ENDIF                           *E1                                CER001
     C*
     C                     EXSR SWTS
     C                     SETON                     LR
     C*
     C                     RETRN
     C*
     C                     ENDSR
     C*
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C*
     C**    INTYPR S/R TO PREPARE EACH RECORD FOR REPORT
     C**    CALLED FROM SR.BODY
     C**    CALLS: ZDATE2
     C**           PAGES
     C*
     C*****************************************************************
     C*
     C           INTYPR    BEGSR
     C*
     C**   DOW NOT END OF FILE
     C*
     C           *IN30     DOWEQ'0'
     C*
     C**   PROCESS RECORDS FOR EACH PAGE
     C*
     C                     EXSR PAGES
     C*
     C**   IF - NEW PAGE AND NOT END OF FILE
     C*
     C           *IN30     IFNE '1'
     C*
     C**   NEW PAGE NEEDED IF A MARKET IS BEING PROCESSED
     C**   OR IF OTC IS BEING PROCESSED AND 4 RECORDS HAVE
     C**   BEEN OUTPUT OR IF FIRST OTC BEING PROCESSED
     C*                                                                   CPL002
     C**  If Feature on then can only fit 3 records on screen => add 2    CPL002
     C           BGN2ST    IFEQ 'Y'                                       CPL002
     C           CFF007    OREQ 'Y'                                       CFF007
     C           BGN4ST    ANDEQ'Y'                                       CFF007
     C                     Z-ADD2         W#REC   10                      CPL002
     C                     ELSE                                           CPL002
     C                     Z-ADD3         W#REC   10                      CPL002
     C                     ENDIF                                          CPL002
     C           ISTI      IFNE 'Y'
     C*                                                                   S01408
     C/COPY WNCPYSRC,FF1140CCP2                                           S01408
     C*                                                                   S01408
     C***********RECORD    ORGT 3                                         CPL002
     C           RECORD    ORGT W#REC                                     CPL002
     C           ULX043    ANDEQ'N'                                                           CER001
     C           RECORD    ORGT 2                                                             CER001
     C           ULX043    ANDEQ'Y'                                                           CER001
     C*                                                                   S01408
     C/COPY WNCPYSRC,FF1140CCP3                                           S01408
     C*                                                                   S01408
     C           ISTI      ORNE ISTIX
     C*
     C**   IF INSTRUMENT IS NOT AN OTC.
     C           ISTI      IFNE 'Y'
     C                     SETOF                     62
     C*
     C*
     C**   ACCESS MARKT FOR MARKET NAME
     C*
     C           MRKT      CHAINMARKT                51
     C*
     C**   IF RECORD NOT FOUND
     C*
     C           *IN51     IFEQ '1'
     C           RECI      ORNE 'D'
     C                     SETON                     U7U8
     C*
     C**   UPDATE LDA
     C*
     C           *LOCK     IN   LDA
     C                     MOVEL'FF1140  'DBPGM
     C                     MOVE *BLANKS   DBKEY
     C***********          MOVEL'03'      DBASE            ***DBERR 03*** S01117
     C                     Z-ADD03        DBASE            ***DBERR 03*** S01117
     C                     MOVELMRKT      DBKEY
     C                     MOVEL'MARKT'   DBFILE
     C                     OUT  LDA
     C*                                                                   E14963
     C** Check line number and throw a page before writing if             E14963
     C** insufficient space remains.                                      E14963
     C*                                                                   E14963
     C           LINE      IFGE 52                                        E14963
     C                     WRITEFMTP101                                   E14963
     C                     END                                            E14963
     C*                                                                   E14963
     C                     WRITEFMTP107
     C                     WRITEFMTAU01                                   S01117
     C                     WRITEFMTAU04                                   S01117
     C                     EXSR SWTS
     C                     EXSR *PSSR                                     S01117
     C                     SETON                     LR
     C                     RETRN
     C                     END
     C*
     C                     ELSE
     C* SET UP OTC HEADING
     C                     MOVE *BLANK    MRKT
     C                     SETON                     62
     C                     END
     C*
     C*
     C**      - OUTPUT NEW PAGE HEADINGS
     C*
     C                     WRITEFMTP101
     C*
     C                     Z-ADD0         RECORD  10
     C*
     C**    STORE MARKET IN WORK FIELD
     C*
     C                     MOVE MRKT      MRKTW
     C*
     C**    STORE INSTRUMENT INDICATOR IN WORK FIELD
     C*
     C                     MOVE ISTI      ISTIX
     C*
     C**   END IF - NEW PAGE
     C*
     C                     END
     C                     END
     C*
     C**   END DOW - NOT END OF FILE
     C*
     C                     END
     C*
     C**   END SUB-ROUTINE - INTYPR
     C*
     C                     ENDSR
     C*
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C*
     C**   PAGES S/R TO PROCESS REPORT PAGES
     C**   CALLED FROM SR.INTYPR
     C**   CALLS: CPDS
     C**          FUTURE
     C**          ACCESS
     C*
     C*****************************************************************
     C*
     C           PAGES     BEGSR
     C*                                                                   CPL002
     C**  If Feature on then can only fit 3 records on screen => add 2    CPL002
     C           BGN2ST    IFEQ 'Y'                                       CPL002
     C           CFF007    OREQ 'Y'                                       CFF007
     C           BGN4ST    ANDEQ'Y'                                       CFF007
     C                     Z-ADD2         W#REC   10                      CPL002
     C                     ELSE                                           CPL002
     C                     Z-ADD3         W#REC   10                      CPL002
     C                     ENDIF                                          CPL002
     C*
     C**    DOW NOT END OF FILE OR NOT NEW PAGE OR NOT NEW MARKET
     C*
     C           *IN30     DOWNE'1'
     C*                                                                   S01408
     C/COPY WNCPYSRC,FF1140CCP7                                           S01408
     C*                                                                   S01408
     C***********RECORD    ANDLE3                                         CPL002
     C           RECORD    ANDLEW#REC                                     CPL002
     C*                                                                   S01408
     C/COPY WNCPYSRC,FF1140CCP4                                           S01408
     C           ULX043    ANDEQ'N'                                                           CER001
     C           *IN30     ORNE '1'                                                           CER001
     C           RECORD    ANDLE2                                                             CER001
     C           MRKT      ANDEQMRKTW                                                         CER001
     C           ULX043    ANDEQ'Y'                                                           CER001
     C*                                                                   S01408
     C           MRKT      ANDEQMRKTW
     C/COPY WNCPYSRC,FF1140C002
     C*
     C**     CHECK FOR LAST CHANGE TYPE
     C*
     C***********CHTP      IFEQ 'I'                                       E26108
     C           @CHTP     IFEQ 'I'                                       E26108
     C                     MOVE 'INS'     TYPE
     C                     END
     C***********CHTP      IFEQ 'A'                                       E26108
     C           @CHTP     IFEQ 'A'                                       E26108
     C                     MOVE 'AMD'     TYPE
     C                     END
     C***********CHTP      IFEQ 'D'                                       E26108
     C           @CHTP     IFEQ 'D'                                       E26108
     C                     MOVE 'DEL'     TYPE
     C                     END
     C*
     C**  CHECK FOR ENTRY TYPE
     C*
     C                     MOVEL*BLANK    ENTT
     C***********CHTP      IFEQ 'A'                                       E26108
     C           @CHTP     IFEQ 'A'                                       E26108
     C           JOENTT    IFEQ 'UB'
     C                     MOVE 'OLD'     ENTT
     C                     END
     C           JOENTT    IFEQ 'UP'
     C                     MOVE 'NEW'     ENTT
     C                     END
     C                     END
     C*
     C***********LCD       IFNE RUND                                      E26108
     C           @LCD      IFNE RUND                                      E26108
     C***********          MOVE LCD       ZDAYNO                          E26108
     C                     MOVE @LCD      ZDAYNO                          E26108
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    FDATE
     C                     ELSE
     C                     MOVELRUNA      FDATE
     C                     END
     C*
     C**   FOR BROKER:
     C**   IF COMMISSION PATTERN IS BLANK THEN OUTPUT NOTHING
     C**   OTHERWISE PUT OUT THE COMMISSION CODES (STANDARD/SAME DAY)
     C*
     C           BCPT      IFEQ *BLANK
     C                     MOVE *BLANKS   RBCMC
     C                     MOVE ' '       RFLGB
     C                     MOVE *BLANKS   RBCMS
     C                     ELSE
     C                     MOVE BCMC      RBCMC
     C                     MOVE '-'       RFLGB
     C                     MOVE BCMS      RBCMS
     C                     END
     C*
     C**   IF BOTH CHARGE CODES ARE ZERO OUTPUT NOTHING
     C**   OTHERWISE PUT OUT THE CHARGE CODES (PURCHASES/SALES)
     C*
     C           BCGP      IFEQ *ZERO
     C           BCGS      ANDEQ*ZERO
     C                     MOVE *BLANKS   RBCGP
     C                     MOVE ' '       RFLGY
     C                     MOVE *BLANKS   RBCGS
     C                     ELSE
     C                     MOVE BCGP      RBCGP
     C                     MOVE '-'       RFLGY
     C                     MOVE BCGS      RBCGS
     C                     END
     C*
     C**   FOR CUSTOMER:
     C**   IF COMMISSION PATTERN IS BLANK THEN OUTPUT NOTHING
     C**   OTHERWISE PUT OUT THE COMMISSION CODES (STANDARD/SAME DAY)
     C*
     C           CCPT      IFEQ *BLANK
     C                     MOVE *BLANKS   RCCMC
     C                     MOVE ' '       RFLGC
     C                     MOVE *BLANKS   RCCMS
     C                     ELSE
     C                     MOVE CCMC      RCCMC
     C                     MOVE '-'       RFLGC
     C                     MOVE CCMS      RCCMS
     C                     END
     C*
     C**   IF BOTH CHARGE CODES ARE ZERO OUTPUT NOTHING
     C**   OTHERWISE PUT OUT THE CHARGE CODES (PURCHASES/SALES)
     C           CCGP      IFEQ *ZERO
     C           CCGS      ANDEQ*ZERO
     C                     MOVE *BLANKS   RCCGP
     C                     MOVE ' '       RFLGX
     C                     MOVE *BLANKS   RCCGS
     C                     ELSE
     C                     MOVE CCGP      RCCGP
     C                     MOVE '-'       RFLGX
     C                     MOVE CCGS      RCCGS
     C                     END
     C*
     C**   INSTRUMENT PROCESS TYPE
     C*
     C           ISPT      LOKUPTABINP    TABINR         61
     C*
     C**   IF FOUND, MOVE TO PRINTER FILE FIELD
     C*
     C           *IN61     IFEQ '1'
     C                     MOVELTABINR    ISDSC
     C                     END
     C*
     C**    IS DEFAULT-BROKER FIELD BLANK
     C*
     C********** DBRK      IFNE *ZERO                                                         CSD027
     C           DBRK      IFNE *BLANKS                                                       CSD027
     C           DBRK      ANDNE'000000'                                                    BUG11632
     C*
     C**    IF NOT - ACCESS LF/CLINT FOR CUSTOMER NAME
     C*
     C***********          Z-ADDDBRK      KCNUM                           S01117
     C                     MOVE DBRK      KCNUM                           S01117
     C*
     C           CLINTK    CHAINCLINT                50
     C*
     C**   IF - NO VALID RECORD DB ERROR
     C*
     C           *IN50     IFEQ '1'
     C           RECI      ORNE 'D'
     C*
     C**   UPDATE LDA
     C*
     C           *LOCK     IN   LDA
     C                     MOVEL'FF1140  'DBPGM
     C                     MOVE *BLANKS   DBKEY
     C***********          MOVEL'04'      DBASE            ***DBERR 04*** S01117
     C                     Z-ADD04        DBASE            ***DBERR 04*** S01117
     C                     MOVELCLINTF    DBKEY
     C                     MOVEL'CLINT'   DBFILE
     C                     OUT  LDA
     C*                                                                   E14963
     C** Check line number and throw a page before writing if             E14963
     C** insufficient space remains.                                      E14963
     C*                                                                   E14963
     C           LINE      IFGE 52                                        E14963
     C                     WRITEFMTP101                                   E14963
     C                     END                                            E14963
     C*                                                                   E14963
     C                     WRITEFMTP107
     C                     WRITEFMTAU01                                   S01117
     C                     WRITEFMTAU04                                   S01117
     C                     EXSR *PSSR                                     S01117
     C                     SETON                     U7U8LR
     C                     EXSR SWTS
     C                     RETRN
     C*
     C**    END IF - VALID RECORD NOT FOUND, DBERROR
     C*
     C                     END
     C*
     C**    ELSE - DEFAULT-BROKER FIELD BLANK
     C*
     C                     ELSE
     C*
     C                     MOVE *BLANKS   CRNM
     C*
     C**    END IF/ELSE - IS DEFAULT-BROKER FIELD BLANK
     C*
     C                     END
     C*
     C**    EDIT AMOUNT FIELDS WITH RELEVANT DECIMAL PLACES
     C*
     C                     EXSR CDPS
     C*
     C**   TRADE MONTH NAMES
     C*
     C                     MOVEAISMQ      MQ
     C*
     C                     MOVE *BLANK    MTH
     C                     Z-ADD1         Z       20
     C                     Z-ADD0         X       20
     C           X         DOWNE12
     C                     ADD  1         X
     C           MQ,X      IFEQ 'Y'
     C                     MOVELZMNM,X    MTH,Z   3
     C                     ADD  1         Z
     C                     END
     C                     END
     C                     MOVEAMTH       MTHS
     C*                                                                   FF0011
     C**   Option type                                                    FF0011
     C*                                                                   FF0011
     C                     MOVE *BLANK    NARR                            FF0011
     C           AEIN      IFEQ 'A'                                       FF0011
     C                     MOVE 'American'NARR                            FF0011
     C                     END                                            FF0011
     C           AEIN      IFEQ 'E'                                       FF0011
     C                     MOVE 'European'NARR                            FF0011
     C                     END                                            FF0011
     C*                                                                   S01408
     C/COPY WNCPYSRC,FF1140CCP5                                           S01408
      *                                                                                       CER001
      ** Access extension file FFITX2L0 if feature ULX004 is On.                              CER001
      *                                                                                       CER001
     C           ULX004    IFEQ 'Y'                        *B1                                CER001
     C           ISTT      CHAINFFITX2L0             85                                       CER001
     C           *IN85     IFEQ '0'                        *B2                                CER001
     C                     MOVELLCAD1     RLCAD1                                              CER001
     C                     MOVE CBOPCM    ROPCM                                               CER001
     C                     MOVELLCAD2     RLCAD2                                              CER001
     C                     MOVELCBSESN    RSESN                                               CER001
     C                     MOVELLCAD3     RLCAD3                                              CER001
     C                     MOVE CBBBIX    RBBIX                                               CER001
     C                     ELSE                            *X2                                CER001
     C                     MOVELLCAD1     RLCAD1                                              CER001
     C                     MOVE *BLANKS   ROPCM                                               CER001
     C                     MOVELLCAD2     RLCAD2                                              CER001
     C                     MOVEL*BLANKS   RSESN                                               CER001
     C                     MOVELLCAD3     RLCAD3                                              CER001
     C                     MOVE *BLANKS   RBBIX                                               CER001
     C                     ENDIF                           *E2                                CER001
     C                     ENDIF                           *E1                                CER001
      *                                                                                       CER001
      *                                                                                       CER001
      **   When feature is Present , read details if they exist.                              CER001
      *                                                                                       CER001
     C           ULX043    IFEQ 'Y'                                                           CER001
     C           BGNWST    ANDEQ'Y'                                                           CER001
     C                     CALL 'IL0462'                                                      CER001
     C                     PARM ISTT      PISTT   5                                           CER001
     C                     PARM *BLANKS   IBFROM                                              CER001
     C                     MOVEAIBFROM    BLC                                                 CER001
     C                     MOVEL*ON       *IN83                                               CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
     C*                                                                   S01408
     C           BGN2ST    IFEQ 'Y'                                       CPL002
      * Convert Underlying Coupon Rate                                    CPL002
     C           PLMIIT    ANDNE'L'                                       CPL002
     C                     Z-ADD7         ZADEC   10                      CPL002
     C                     MOVE *BLANKS   ZFIELD                          CPL002
     C                     MOVE PLMICP    ZFIELD                          CPL002
     C                     EXSR ZEDIT                                     CPL002
     C                     MOVE *BLANKS   R#MICP                          CPL002
     C                     MOVE ZFIELD    R#MICP                          CPL002
     C                     MOVE '0'       *IN38                           CPL002
     C           PLMIIT    IFEQ 'B'                                       CPL002
     C                     MOVE '1'       *IN38                           CPL002
     C                     MOVE PLMIMD    ZDAYNO                          CPL002
     C                     EXSR ZDATE2                                    CPL002
     C                     MOVE ZDATE     PRMIMD                          CPL002
     C                     ENDIF                                          CPL002
     C                     ELSE                                           CPL002
     C                     MOVE *BLANKS   R#MICP                          CPL002
     C                     MOVE '0'       *IN38                           CPL002
     C                     ENDIF                                          CPL002
     C*
     C**   IF - INSTRUMENT IND IS 'Y', OTC
     C*
     C           ISTI      IFEQ 'Y'
     C*
     C**   CONVERT DAY NUMBERS TO DATES
     C**          1.FINAL TRANSACTION DATE
     C*
     C                     Z-ADDFTDT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    RFTDT
     C*
     C**          2.SETTLEMENT DATE
     C*
     C                     Z-ADDSETD      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    RSETD
     C*
     C**          3.SETTLEMENT DATE
     C*
     C                     Z-ADDSPDT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    RSPDT
     C*
     C**   OUTPUT OTC DETAIL LINE
     C*
     C                     WRITEFMTP104
     C           BGN2ST    IFEQ 'Y'                                       CPL002
     C                     WRITEFMTP108                                   CPL002
     C                     ENDIF                                          CPL002
     C*
     C                     ELSE
     C*
     C**   OUTPUT INSTRUMENT DETAIL LINE
     C*
     C                     WRITEFMTP102
     C*                                                                   CPL002
     C** Midas-Plato Interface Switched on                                CPL002
     C           BGN2ST    IFEQ 'Y'                                       CPL002
     C                     WRITEFMTP108                                   CPL002
     C                     ENDIF                                          CPL002
     C*
     C**        - FIND FUTURE INSTRUMENT NAME
     C**          & OUTPUT FUTURE INSTRUMENT DETAIL LINE
     C*
     C                     EXSR FUTURE
     C*
     C**   END IF/ELSE - INSTRUMENT IND IS `Y`
     C*
     C                     END
     C*                                                                   S01408
     C/COPY WNCPYSRC,FF1140CCP6                                           S01408
     C*                                                                   S01408
      *                                                                   CFF007
      ** IF CFF007 is installed and PB module is on,                      CFF007
      ** print format FMTP109                                             CFF007
      *                                                                   CFF007
     C           CFF007    IFEQ 'Y'                                       CFF007
     C           BGN4ST    ANDEQ'Y'                                       CFF007
     C                     WRITEFMTP109                                   CFF007
     C                     ENDIF                                          CFF007
     C*
     C/COPY WNCPYSRC,FF1140CCML                                                               CER001
      *                                                                                       CER001
      ** If IBLC module is on print IBLC informations.                                        CER001
      *                                                                                       CER001
     C           ULX043    IFEQ 'Y'                                                           CER001
     C           *IN83     IFEQ *ON                                                           CER001
     C                     WRITEFMTP108                                                       CER001
     C                     DO   7         UL      10                                          CER001
     C           LUL,UL    IFNE *BLANKS                                                       CER001
     C                     MOVELLUL,UL    RRLINE                                              CER001
     C                     WRITEFMTPIBLC                                                      CER001
      *                                                                                       CER001
      ** Add one to record count                                                              CER001
      *                                                                                       CER001
     C                     ADD  1         RECORD                                              CER001
     C                     ENDIF                                                              CER001
     C                     ENDDO                                                              CER001
     C                     ENDIF                                                              CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
      ** Write CAD extension details if feature ULX004 is On.                                 CER001
      *                                                                                       CER001
     C           ULX004    IFEQ 'Y'                        *B1                                CER001
      *                                                                                       CER001
     C                     MOVEL*BLANKS   RRLINE                                              CER001
     C                     MOVELRLCAD     RRLINE                                              CER001
      *                                                                                       CER001
     C                     WRITEFMTPIBLC                                                      CER001
      *                                                                                       CER001
     C                     ADD  1         RECORD                                              CER001
      *                                                                                       CER001
     C                     ENDIF                           *E1                                CER001
      *                                                                                       CER001
      ** If Details were read BLC,BL isn't blank, so print it 53lines)                        CER001
      *                                                                                       CER001
     C           ULX043    IFEQ 'Y'                                                           CER001
     C                     DO   3         BL      10       Max 3 lines                        CER001
     C           BLC,BL    IFNE *BLANKS                                                       CER001
     C                     MOVELBLC,BL    RRFROM                                              CER001
      *                                                                                       CER001
      ** Manage overflow                                                                      CER001
      *                                                                                       CER001
     C           LINE      IFGT 55                         Write header                       CER001
     C                     WRITEFMTP101                                                       CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
     C                     WRITEZZIBLC02                                                      CER001
     C                     ENDIF                                                              CER001
     C                     ENDDO                                                              CER001
     C                     ENDIF                                                              CER001
     C           ULX043    IFEQ 'N'                                                           CER001
     C**   ADD ONE TO RECORD COUNT
     C*
     C                     ADD  1         RECORD
     C*                                                                   S01408
     C/COPY WNCPYSRC,FF1140CCP8                                           S01408
     C                     ENDIF                                                              CER001
     C*                                                                   S01408
     C*
     C**   READ NEXT INSTRUMENT
     C*
     C                     EXSR ACCESS
     C*
     C**    SET UP ISTTX FOR MARKET IF RECORDS REMAIN ON FILE
     C*
     C           *IN30     IFEQ '0'
     C                     MOVELISTT      ISTTX
     C                     END
     C*
     C**   IF INSTRUMENT IS AN OTC, SET MARKET CODE EQUAL TO BLANK
     C**   IE. EQUAL TO STORED MARKET CODE SO THAT PROCESSING
     C**   CONTINUES AROUND LOOP UNTIL 4 RECORDS HAVE BEEN OUTPUT
     C*
     C           ISTI      IFEQ 'Y'
     C                     MOVE *BLANK    MRKT
     C                     END
     C*
     C**   END DOW - NOT END OF FILE OR NOT NEW PAGE
     C*
     C                     END
     C*
     C**   END SUB-ROUTINE - BODY
     C*
     C                     ENDSR
     C*
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C*
     C**   CPDS S/R TO PROCESS CURRENCY DEC.PLACES
     C**   CALLED FROM SR.PAGES
     C**   CALLS: FFSTDP
     C**          ZFRPED
     C*
     C*****************************************************************
     C*
     C           CDPS      BEGSR
     C*
     C**   DETERMINE THE NUMBER OF DECIMAL PLACES REQUIRED FOR CURRENCY
     C*
     C                     MOVE ISCY      FFCCY
     C*
     C                     EXSR FFSTDP
     C*
     C           *IN89     IFEQ '1'
     C           *LOCK     IN   LDA
     C                     MOVEL'FF1140  'DBPGM
     C                     MOVE *BLANKS   DBKEY
     C***********          MOVE '05'      DBASE            ***DBERR 05*** S01117
     C                     Z-ADD5         DBASE            ***DBERR 05*** S01117
     C                     MOVELFFCKY     DBKEY
     C                     MOVE 'TABFF'   DBFILE
     C                     OUT  LDA
     C*                                                                   E14963
     C** Check line number and throw a page before writing if             E14963
     C** insufficient space remains.                                      E14963
     C*                                                                   E14963
     C           LINE      IFGE 52                                        E14963
     C                     WRITEFMTP101                                   E14963
     C                     END                                            E14963
     C*                                                                   E14963
     C                     WRITEFMTP107
     C                     WRITEFMTAU01                                   S01117
     C                     WRITEFMTAU04                                   S01117
     C                     EXSR *PSSR                                     S01117
     C                     SETON                     U7U8LR
     C                     EXSR SWTS
     C                     RETRN
     C                     END
     C*
     C** TICK VALUE - DEPENDANT ON INSTRUMENT CCY
     C*
     C*
     C***        FFCDP     ADD  5         ZADEC   20                      E14963
     C           FFCDP     ADD  5         ZADEC   10                      E14963
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE TKVL      ZFIELD
     C                     EXSR ZEDIT
     C*********************MOVE ZFIELD    RTKVL                           FO0033
     C                     MOVELZFIELD    TTKVL  13                       FO0033
     C                     MOVE *BLANKS   RTKVL                           FO0033
     C                     MOVE TTKVL     RTKVL                           FO0033
      *                                                                   CFF006
      ** If Fractional Tick indicator is on, Fractional tick indicator    CFF006
      ** must be shown on the report                                      CFF006
      *                                                                   CFF006
     C           CFF006    IFEQ 'Y'                                       CFF006
     C                     MOVE FRTK      RFRTK                           CFF006
     C                     MOVE *ON       *IN70                           CFF006
     C                     ELSE                                           CFF006
     C                     MOVE *OFF      *IN70                           CFF006
     C                     ENDIF                                          CFF006
     C*
     C*
     C                     Z-ADDFFCDP     ZDECS
     C*
     C**  TO CHECK IF CONTINGENT AMOUNT IS IN OTHER CCY
     C*
     C           OTHC      IFNE *BLANK
     C                     MOVE OTHC      FFCCY
     C*
     C                     EXSR FFSTDP
     C*
     C           *IN89     IFEQ '1'
     C           *LOCK     IN   LDA
     C                     MOVEL'FF1140  'DBPGM
     C                     MOVE *BLANKS   DBKEY
     C***********          MOVE '06'      DBASE            ***DBERR 06*** S01117
     C                     Z-ADD6         DBASE            ***DBERR 06*** S01117
     C                     MOVELFFCKY     DBKEY
     C                     MOVE 'TABFF'   DBFILE
     C                     OUT  LDA
     C*                                                                   E14963
     C** Check line number and throw a page before writing if             E14963
     C** insufficient space remains.                                      E14963
     C*                                                                   E14963
     C           LINE      IFGE 52                                        E14963
     C                     WRITEFMTP101                                   E14963
     C                     END                                            E14963
     C*                                                                   E14963
     C                     WRITEFMTP107
     C                     WRITEFMTAU01                                   S01117
     C                     WRITEFMTAU04                                   S01117
     C                     EXSR *PSSR                                     S01117
     C                     SETON                     U7U8LR
     C                     EXSR SWTS
     C                     RETRN
     C*
     C**   END IF - DBERROR FOR TABTG10, CURRENCY FILE
     C*
     C                     END
     C*
     C                     Z-ADDFFCDP     ZDECS
     C*
     C**   END IF - OTHER CCY NOT BLANK
     C*
     C                     END
     C*
     C**   EDIT OUTPUT FIELD CONTINGENT TO LINE UP DEC PL.
     C*
     C                     Z-ADDCTAM      ZFLD15
     C                     EXSR ZFRPED
     C                     MOVELZOUT25    RCTAM
     C*                                                                   073714
     C**   IF COUNTER CURRENCY DEFINED                                    073714
     C*                                                                   073714
     C           CTCY      IFNE *BLANK                                    073714
     C                     MOVE CTCY      FFCCY                           073714
     C*                                                                   073714
     C                     EXSR FFSTDP                                    073714
     C*                                                                   073714
     C**   DBERROR FOR TABTG10, CURRENCY FILE                             073714
     C*                                                                   073714
     C           *IN89     IFEQ '1'                                       073714
     C           *LOCK     IN   LDA                                       073714
     C                     MOVEL'FF1140  'DBPGM                           073714
     C                     MOVE *BLANKS   DBKEY                           073714
     C                     Z-ADD08        DBASE            ***DBERR 08*** 073714
     C                     MOVELFFCKY     DBKEY                           073714
     C                     MOVE 'TABFF'   DBFILE                          073714
     C                     OUT  LDA                                       073714
     C           LINE      IFGE 52                                        073714
     C                     WRITEFMTP101                                   073714
     C                     END                                            073714
     C                     WRITEFMTP107                                   073714
     C                     WRITEFMTAU01                                   073714
     C                     WRITEFMTAU04                                   073714
     C                     EXSR *PSSR                                     073714
     C                     SETON                     U7U8LR               073714
     C                     EXSR SWTS                                      073714
     C                     RETRN                                          073714
     C                     END                                            073714
     C*                                                                   073714
     C**   EDIT OUTPUT FIELD COUNTER AMOUNT TO LINE UP DEC PL.            073714
     C*                                                                   073714
     C                     Z-ADDFFCDP     ZDECS                           073714
     C                     Z-ADDCCAM      ZFLD15                          073714
     C                     EXSR ZFRPED                                    073714
     C                     MOVELZOUT25    RCCAM                           073714
     C                     ELSE                                           073714
     C                     MOVEL*BLANK    RCCAM                           073714
     C*                                                                   073714
     C**   END IF - COUNTER CURRENCY NOT BLANK                            073714
     C*                                                                   073714
     C                     END                                            073714
     C*
     C                     ENDSR
     C*
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C*
     C**   ACCESS S/R TO READ NEXT VALID RECORD
     C**   CALLED FROM SR.`S - BODY, PAGES
     C*
     C*****************************************************************
     C**
     C*    SUB-ROUTINE ACCESS - READ NEXT VALID RECORD
     C*
     C           ACCESS    BEGSR
     C*
     C  NU3                READ INTYP1                   30
     C   U3                READ JRNCGD                   30
      *                                                                   CFF007
      ** IF CFF007 is installed and PB module is on,                      CFF007
      ** set values of report fields                                      CFF007
      *                                                                   CFF007
     C           CFF007    IFEQ 'Y'                                       CFF007
     C           BGN4ST    ANDEQ'Y'                                       CFF007
     C           TWEI      IFEQ *ZERO                                     CFF007
     C                     MOVE *BLANKS   RTWEI                           CFF007
     C                     ELSE                                           CFF007
     C                     MOVE TWEI      RTWEI                           CFF007
     C                     ENDIF                                          CFF007
     C                     MOVE UNSE      RUNSE                           CFF007
     C                     MOVE TECO      RTECO                           CFF007
     C                     MOVE TNAT      RTNAT                           CFF007
     C                     MOVE CRIK      RCRIK                           CFF007
     C                     MOVE CCYR      RCCYR                           CFF007
     C                     ENDIF                                          CFF007
      *                                                                   CFF007
     C           *IN30     DOWNE'1'
     C           RECI      ANDNE'D'
     C  NU3                READ INTYP1                   30
     C   U3                READ JRNCGD                   30
     C                     END
     C*                                                                   S01117
     C**   MAINTAIN HASH TOTAL                                            S01117
     C*                                                                   S01117
     C           *IN30     IFNE '1'
     C                     ADD  1         COUNT                           S01117
     C                     END
     C*                                                                   S01117
     C                     ENDSR
     C*
     C*****************************************************************
     C/EJECT
     C********************************************************************
     C*
     C**   SUBROUTINE TO  DETERMINE FUTURE INSTRUMENT NAME
     C*
     C**   CALLED FROM SR.PAGES
     C*
     C********************************************************************
     C*
     C           FUTURE    BEGSR
     C*
     C**   IF - FUTURE REFERENCE IS NOT BLANK
     C**   AND JRNCGD (AUDIT) IS NOT BEING ACCESSED
     C*
     C           FTRF      IFNE *BLANK
     C           *INU3     ANDEQ'0'
     C*
     C                     MOVE FTRF      ISTT
     C                     MOVELFTRF      RFTRF
     C*
     C**   SET UP KEY FOR INTYP1
     C*
     C                     MOVE ISTT      KISTT
     C                     MOVE ISTI      KISTI
     C*
     C           INTYPK    CHAININTYP1               60
     C*
     C**   IF - DB ERROR
     C*
     C           *IN60     IFEQ '1'
     C           RECI      ORNE 'D'
     C*
     C                     SETON                     U7U8LR
     C*
     C**   UPDATE LDA
     C*
     C           *LOCK     IN   LDA
     C                     MOVEL'FF1140  'DBPGM
     C***********          MOVEL'07'      DBASE            ***DBERR 07*** S01117
     C                     Z-ADD7         DBASE            ***DBERR 07*** S01117
     C                     MOVELISTT      DBKEY
     C                     MOVEL'INTYP'   DBFILE
     C                     EXSR *PSSR                                     S01117
     C                     OUT  LDA
     C*                                                                   E14963
     C** Check line number and throw a page before writing if             E14963
     C** insufficient space remains.                                      E14963
     C*                                                                   E14963
     C           LINE      IFGE 52                                        E14963
     C                     WRITEFMTP101                                   E14963
     C                     END                                            E14963
     C*                                                                   E14963
     C                     WRITEFMTP107
     C                     WRITEFMTAU01                                   S01117
     C                     WRITEFMTAU04                                   S01117
     C                     EXSR *PSSR                                     S01117
     C                     EXSR SWTS
     C                     RETRN
     C*
     C**   END IF/ELSE - DATABASE ERROR
     C*
     C                     END
     C*
     C**   OUTPUT FUTURE INSTRUMENT DETAIL LINE
     C*
     C                     WRITEFMTP103
     C*
     C**   RESET POINTER TO NEXT INSTRUMENT
     C*
     C                     MOVELISTTX     ISTT
     C*
     C                     MOVE ISTT      KISTT
     C                     MOVE ISTI      KISTI
     C*
     C           INTYPK    SETGTINTYP1
     C*
     C                     ELSE
     C*
     C**   ELSE - NO FUTURE REFERENCE, BLANK OUTPUT
     C*
     C           FTRF      IFNE *BLANK
     C                     MOVELFTRF      RFTRF
     C                     ELSE
     C                     MOVE *BLANK    RFTRF
     C                     END
     C                     MOVE *BLANK    ISTN
     C*
     C**   OUTPUT FUTURE INSTRUMENT DETAIL LINE
     C*
     C                     WRITEFMTP103
     C*
     C**   END IF/ELSE - IS FUTURE REFERENCE BLANK
     C*
     C                     END
     C*
     C**   END SUB-ROUTINE - FUTURE
     C*
     C                     ENDSR
     C*
     C**************************************************************************
     C/EJECT
     C** ZDATE2 TO CONVERT DAY NUMBER TO DATE FORMAT
     C/COPY ZSRSRC,ZDATE2Z2
     C/EJECT
     C/COPY ZSRSRC,FFSTDPZ4
     C/EJECT
     C/COPY ZSRSRC,ZFRPEDZ3
     C/EJECT
     C/COPY ZSRSRC,ZEDITZ2
      /EJECT
     C****************************************************************
     C*
     C*   SWTS-SUBROUTINE TO RESET SWITCHES PARAMETER
     C*
     C*  CALLED  FROM  SR.S INIT, END, PAGES, CPDS, FUTURE
     C*
     C********************************************************************
     C*
     C           SWTS      BEGSR
     C                     MOVE *INU1     SWS,1
     C                     MOVE *INU2     SWS,2
     C                     MOVE *INU3     SWS,3
     C                     MOVE *INU4     SWS,4
     C                     MOVE *INU5     SWS,5
     C                     MOVE *INU6     SWS,6
     C                     MOVE *INU7     SWS,7
     C                     MOVE *INU8     SWS,8
     C                     ENDSR
     C*
     C********************************************************************
     C/SPACE 3                                                            S01117
     C********************************************************************S01117
      **                                                                  S01117
      ** RCFSPL -- SUBROUTINE TO SPOOL BOTH P1 AND AU THROUGH RCF         S01117
      ** CALLED FROM: BEFORE END OF PROGRAM                               S01117
      ** CALLS: NOTHING                                                   S01117
      **                                                                  S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C           RCFSPL    BEGSR                           ** RCFSPL **   S01117
     C*                                                                   S01117
     C**      ENSURE REPORT SPOOL FILE RECORDED BY RCF                    S01117
     C*                                                                   S01117
     C                     Z-ADDSFNUM     ZSNUM   60                      S01117
     C**                                                                  S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ     5                       S01117
     C                     PARM *BLANK    SENTY   3                       S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           ZSNUM                           S01117
     C                     PARM           ZSERR   1                       S01117
     C*                                                                   S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
     C**  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C**      ENSURE TOTAL SPOOL FILE RECORDED BY RCF                     S01117
     C*                                                                   S01117
     C                     Z-ADDSFNUMU    ZSNUMU  60                      S01117
     C**                                                                  S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ     5                       S01117
     C                     PARM *BLANK    SENTY   3                       S01117
     C                     PARM           SFILEU                          S01117
     C                     PARM           ZSNUMU                          S01117
     C                     PARM           ZSERR   1                       S01117
     C*                                                                   S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
     C**  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     ENDSR                                          S01117
     C*                                                                   S01117
     C********************************************************************S01117
     C/SPACE 3                                                            S01117
     C********************************************************************S01117
      **                                                                  S01117
      ** *PSSR --- SUBROUTINE TO HANDLE ABNORMAL ERROR CONDITIONS         S01117
      ** CALLED FROM: AFTER ABNORMAL OPERATION OCCURS                     S01117
      ** CALLS: NOTHING                                                   S01117
      **                                                                  S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C           *PSSR     BEGSR                           ** *PSSR **    S01117
     C*                                                                   S01117
     C           @RUN      IFEQ *BLANKS                                   S01117
     C                     MOVE 'Y'       @RUN    1                       S01117
     C                     DUMP                                           S01117
     C                     END                                            S01117
     C                     ENDSR                           ** *PSSR **    S01117
     C*                                                                   S01117
     C********************************************************************S01117
     C/EJECT                                                              S01117
**  CPY@
(c) Misys International Banking Systems Ltd. 2001
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
**   TABINP/TABINR-INSTR.PROC.TYPE & THEIR DESCRIPTIONS
1INTEREST FUTURES
2FOREX FUTURES
3COMMODITY FUTURES
4INTEREST OPTIONS
5FOREX OPTIONS
6COMMODITY OPTIONS
7CONTRACT FUTURES                                                         AUS022
8CONTRACT OPTIONS                                                         AUS022
