/*********************************************************************/
/*STD    CLPBASEMOD                                                  */
/*EXI    TEXT('Midas FT Reset RFT / CCT id = 0 during COB')          */
/*********************************************************************/
/*                                                                   */
/*       Midas - Funds Transfer Module                               */
/*                                                                   */
/*       FTC1002 - RESET RFT / CCT ID = 0 DURING COB                 */
/*                                                                   */
/*       (c) Misys International Banking Systems Ltd. 2001           */
/*                                                                   */
/*       Last Amend No. CLE134             Date 01Aug12              */
/* Bank Fusion Midas 1.4 Base ---------------------------------------*/
/* Midas Plus 1.4 Base 04 -------------------------------------------*/
/* Midas Plus 1.4 Base ----------------------------------------------*/
/* Midas Plus 1.3 ---------------- Base -----------------------------*/
/* Midas Release 4 --------------- Base -----------------------------*/
/* Midas DBA 3.04 ---------------------------------------------------*/
/*       Prev Amend No. 185698               Date  31Oct2000         */
/* Midas DBA 3.03 ---------------------------------------------------*/
/*                      CFT006               DATE  15JUL99           */
/*                                                                   */
/*********************************************************************/
/*                                                                   */
/*     CLE134 - Past Due Call Loan Processing (Recompile)            */
/*     185698 - Start Commitment Control                             */
/*     CFT006 - RESET RFT / CCT ID = 0 DURING COB                    */
/*                                                                   */
/*********************************************************************/
             PGM        PARM(&RECP &NAM &SEQ)
 
             DCL        VAR(&RECP) TYPE(*CHAR) LEN(1)
             DCL        VAR(&NAM) TYPE(*CHAR) LEN(10)
             DCL        VAR(&SEQ) TYPE(*DEC) LEN(5 0)
 
             DCL        VAR(&DATA) TYPE(*CHAR) LEN(50)
             DCL        VAR(&SEQ) TYPE(*DEC) LEN(5 0)
             DCL        VAR(&RTN_CODE) TYPE(*CHAR) LEN(10)
 
             COPYRIGHT TEXT('(c) Misys International Banking Systems Ltd. +
                          2001')
                                                                                          /*185698*/
/* Add global monitor message */                                                          /*185698*/
             MONMSG     MSGID(CPF0000 MCH0000 RPG0000) EXEC(GOTO +
                          CMDLBL(ABNORMAL))                                               /*185698*/
                                                                                          /*185698*/
/* Start Commitment Control */                                                            /*185698*/
             STRCMTCTL  LCKLVL(*CHG) NFYOBJ(MNTYF (*FILE)) +
                          CMTSCOPE(*JOB)                                                  /*185698*/
             MONMSG     MSGID(CPF8351)                                                    /*185698*/
 
             CHGJOB     SWS(XXXXXX00)
             QSYS/CALLPRC PRC(FT1002) PARM(&RTN_CODE)
 
 
/** .. CHECK FOR DATABASE ERRORS TRAPPED BY THE PROGRAM        **/
 
             IF         COND(%SWITCH(XXXXXX11)) THEN(DO)
             RTVDTAARA  DTAARA(LDA (134 50)) RTNVAR(&DATA)
                SNDPGMMSG  MSGID(MEM0001) MSGF(MIDAS) MSGDTA(&DATA) +
                               TOMSGQ(MRUNQ MOPERQ)
             GOTO       CMDLBL(ABNORMAL)                                                  /*185698*/
             ENDDO
                                                                                          /*185698*/
             GOTO       CMDLBL(END)                                                       /*185698*/
                                                                                          /*185698*/
/* Abnormal processing        */                                                          /*185698*/
                                                                                          /*185698*/
ABNORMAL:                                                                                 /*185698*/
             CHGJOB     SWS(XXXXXX11)                                                     /*185698*/
             MONMSG     MSGID(CPF0000)                                                    /*185698*/
             ROLLBACK                                                                     /*185698*/
             MONMSG     MSGID(CPF0000)                                                    /*185698*/
             DMPCLPGM                                                                     /*185698*/
             MONMSG     MSGID(CPF0000)                                                    /*185698*/
             SNDPGMMSG  MSG('FTC1002 Ended Abnormally') TOMSGQ(MOPERQ)                    /*185698*/
             MONMSG     MSGID(CPF0000)                                                    /*185698*/
                                                                                          /*185698*/
 END:                                                                                     /*185698*/
             ENDPGM
