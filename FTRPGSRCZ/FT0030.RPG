     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas FT Payment charges maintenance')                 *
     F*****************************************************************
     F*                                                               *
     F*  Midas - Funds Transfer Module                            *
     F*                                                               *
     F*  FT0030 - Payment Charges Maintenance                         *
     F*                                                               *
     F*  Function: This program allows charges to be defined by       *
     F*    (I/C)   branch code, customer number, transaction type and *
     F*            subtype and market group.                          *
     F*                                                               *
     F*  The basis of the program is the Release 3 version of FT0035  *
     F*  where the last fix applied is 050453.                        *
     F*                                                               *
      *  (c) Misys International Banking Systems Ltd. 2001            *
     F*                                                               *
      *  Last Amend No. AR1092740          Date 18Apr13               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *  Prev Amend No. CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CSW037A            Date 02May05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CLE025             Date 20Oct03               *
      *                 CGL029             Date 01Sep03               *
      *                 210873             Date 18Dec02               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.03 -----------------------------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 125636             Date 07Jan98               *
      *                 102623             Date 08Apr97               *
     F*                 093336             DATE 06AUG96               *
     F*                 099674             DATE 30MAY96               *
     F*                 074808             DATE 31JUL94               *
     F*                 074809             DATE 31JUL94               *
     F*                 074806             DATE 31JUL94               *
     F*                 074805             DATE 31JUL94
     F*                 074804             DATE 31JUL94
     F*                 074803             DATE 31JUL94
     F*                 S01508             DATE 27JUN94               *
     F*                 S01494             DATE 25MAY94               *
     F*                 S01117             DATE 29JUN90               *
     F*                                                               *
     F*---------------------------------------------------------------*
     F*                                                               *
      *  AR1092740 - Inconsistency on the Function Key Options        *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  210873 - Initialise customer parameter such that correct     *
      *           default charges will be calculated.                 *
     F*  125636 - Allow maximum charge for tariff 5 to be zero when   *
     F*           no entry is made.                                   *
     F*  102623 - PAYMENT CHARGES ENTERED - BUT CHANGES TO INVALID    *
     F*           CUSTOMER NUMBER ON FILE.                            *
     F*  093336 - For Threshold charges, allow entry of a rate of 0,  *
     F*           to allow user to obtain a charge of 0 if the payment*
     F*           amount is less than a specific amount.              *
     F*  099674 - Allow todays deleted records to be re-inserted      *
     F*  074808 - Enquire and delete still validates the data         *
     F*           Fixed during development of S01494                  *
     F*  074809 - Screen data of FX/Change tariff 4 not cleared       *
     F*           Fixed during development of S01494                  *
     F*  074806   Max/Min charge accepted w/o any rate/range entered  *
     F*           Fixed during development of S01494                  *
     F*  074805 - Invalid min/max charge of tariff 5 is accepted      *
     F*           and error (reverse image) carried over to next page *
     F*           Fixed during development of S01494                  *
     F*  074804 - Incorrect error codes are being displayed           *
     F*           Fixed during development of S01494                  *
     F*  074803 - Deletion of a payment charge must only be allowed   *
     F*           Fixed during development of S01508                  *
     F*  S01508 - BLI Extended Payment Charges                        *
     F*           when extended payment charge (S01508) is active     *
     F*  S01494 - BLI Funds Transfer Enhancements                     *
     F*  S01117 - MULTIBRANCHING AND SPF                              *
     F*                                                               *
     F*****************************************************************
     F*                                                               *
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
     F*
     F* ID F  C  H  L    FUNCTION OF INDICATORS
     F*
     F*    04         Calculation field is invalid
     F*    05         Core feature S01508 is switched on
     F*    06         FLDQRY-SR '?' found in LOKUP
     F*    07         Calculation field is invalid
     F*    08         Customer number is invalid
     F*    10         Only the branch is entered as key
     F*    11         Branch code is invalid
     F*    12         Multi-Branching Indicator
     F*    13         Default tariff is invalid
     F*    14         Tariff 1 is invalid
     F*    15         Tariff 2 is invalid
     F*    16         Transaction subtype is invalid
     F*    17         Transaction type is invalid
     F*    19         Customer market code is invalid
     F*    20         ALL INPUT TO DETAIL SCREEN IS VALID
     F*    21         ERROR MESSAGE 004 IS TO BE DISPLAYED
     F*    22         ERROR MESSAGE 005 IS TO BE DISPLAYED
     F*    23         ERROR MESSAGE 006 IS TO BE DISPLAYED
     F*    24         ERROR MESSAGE 007 IS TO BE DISPLAYED
     F*    25         ERROR MESSAGE 008 IS TO BE DISPLAYED
     F*    26         ERROR MESSAGE 009 IS TO BE DISPLAYED
     F*    27         ERROR MESSAGE 010 IS TO BE DISPLAYED
     F*    28         ERROR MESSAGE 011 IS TO BE DISPLAYED
     F*    29         ERROR MESSAGE 012 IS TO BE DISPLAYED
     F*    30         ERROR MESSAGE 013 IS TO BE DISPLAYED
     F*    31         ERROR MESSAGE 014 IS TO BE DISPLAYED
     F*    32         ERROR MESSAGE 015 IS TO BE DISPLAYED
     F*    33         ERROR MESSAGE 016 IS TO BE DISPLAYED
     F*    34         ERROR MESSAGE 017 IS TO BE DISPLAYED
     F*    35         ERROR MESSAGE 018 IS TO BE DISPLAYED
     F*    36         ERROR MESSAGE 183 IS TO BE DISPLAYED
     F*    37         PF/MMODF RECORD NOT PRESENT
     F*    38         BRANCH CODE INVALID
     F*    39         ACCOUNT CODE IN ERROR
     F*    40         ACTION CODE IN ERROR
     F*    41         RESIDENT TO NON-RESIDENT RANGE 1 START IN ERROR
     F*    42         RESIDENT TO NON-RESIDENT RANGE 1 END IN ERROR
     F*    43         RESIDENT TO NON-RESIDENT RANGE 1 RATE IN ERROR
     F*    44         RESIDENT TO NON-RESIDENT RANGE 2 START IN ERROR
     F*    45         RESIDENT TO NON-RESIDENT RANGE 2 END IN ERROR
     F*    46         RESIDENT TO NON-RESIDENT RANGE 2 RATE IN ERROR
     F*    47         RESIDENT TO NON-RESIDENT MINIMUM CHARGE IN ERROR
     F*    48         RESIDENT TO NON-RESIDENT RANGE 3 START IN ERROR
     F*    49         RESIDENT TO NON-RESIDENT RANGE 3 END IN ERROR
     F*    50         RESIDENT TO NON-RESIDENT RANGE 3 RATE IN ERROR
     F*    51         RESIDENT TO NON-RESIDENT MAXIMUM CHARGE IN ERROR
     F*    52         RESIDENT TO RESIDENT RANGE 1 START IN ERROR
     F*    53         RESIDENT TO RESIDENT RANGE 1 END IN ERROR
     F*    54         RESIDENT TO RESIDENT RANGE 1 RATE IN ERROR
     F*    55         RESIDENT TO RESIDENT MINIMUM CHARGE IN ERROR
     F*    56         RESIDENT TO RESIDENT RANGE 2 START IN ERROR
     F*    57         RESIDENT TO RESIDENT RANGE 2 END IN ERROR
     F*    58         RESIDENT TO RESIDENT RANGE 2 RATE IN ERROR
     F*    59         RESIDENT TO RESIDENT MAXIMUM CHARGE IN ERROR
     F*    60         NON-RESIDENT TO NON-RESIDENT RANGE 1 RATE IN ERROR
     F*    61         NON-RESIDENT TO NON-RESIDENT MINIMUM CHARGE IN ERROR
     F*    62         NON-RESIDENT TO NON-RESIDENT MAXIMUM CHARGE IN ERROR
     F*    63         CHEQUE CHARGE IN ERROR
     F*    64         OVERDUE CHEQUE PERIOD IN ERROR
     F*    65         AUDIT THREASHOLD IN ERROR
     F*    66         SWIFT PRIORTY CODE IN ERROR
     F*    67         Transfer Ommission Default not 1 - 5
     F*    68         Tariff 1 Narrative not entered
     F*    69         Tariff 2 Narrative not entered
     F*    71         DISPLAY INITIAL SCREEN
     F*    72         DISPLAY DETAIL SCREEN
     F*    73         PROTECT ALL FIELDS ON DETAIL SCREEN
     F*    74         DISPLAY ERROR CODES LINE 1
     F*    75         DISPLAY ERROR CODES LINE 2
     F*    76         RESIDENT TO NON-RESIDENT 2 MIN CHARGE IN ERROR
     F*    77         RESIDENT TO NON-RESIDENT 3 MIN CHARGE IN ERROR
     F*    78         RESIDENT TO NON-RESIDENT 2 MAX CHARGE IN ERROR
     F*    79         RESIDENT TO NON-RESIDENT 3 MAX CHARGE IN ERROR
     F*    80         RESIDENT TO RESIDENT MIN 2 CHARGE IN ERROR
     F*    81         RESIDENT TO RESIDENT MAX 2 CHARGE IN ERROR
     F*    18         Tariff 3 Narrative not entered
     F*    70         Tariff 4 Narrative not entered
     F*    84         Tariff 5 Narrative not entered
     F*    85         Mature Held Period in error
     F*    86         Percent Rate Discrepancy in error
     F*    87         Must enter a Matured Held Period
     F*    88         Must enter a Percent Rate Discrepancy
     F*    89         GENERAL WORK INDICATOR
     F*    90-97      USED BY STANDARD SUBROUTINE ZALIGN
     F*       98      ZSYSTM, DATE FORMAT MMDDYY IF ON.
     F*       99      ZSYSTM, INSTALLATION CONTROL DATA RECORD NOT FOUND.
     F*       KL      F12, INITIAL SCREEN REQUEST.
     F*       KC      F3, END OF PROGRAM REQUEST.
     F**
     F*     U7 & U8   DATABASE ERROR, REQUIRED RECORDS NOT FOUND.
     F*****************************************************************
     F/EJECT
     FFT0030DFCF  E                    WORKSTN
     F*PYCHGL0UF  E           K        DISK                      A        099674
     F********                                      KCOMIT                099674
     F*PYCHGL1IF  E           K        DISK                               099674
     F*********   PYCHGDDF                          KRENAMEPYCHGDD1       099674
     FPYCHGL2 UF  E           K        DISK                      A        099674
     F                                              KCOMIT                099674
     FPYCHGL3 IF  E           K        DISK                               099674
     F            PYCHGDDF                          KRENAMEPYCHGDD1       099674
     FSDCGRPL1IF  E           K        DISK
     E                    CPY@    1   1 80
     E                    WPAG    5   5  6
     E                    FLDQ       10  1               Question Mark
     E                    ERCD       38  4               ERROR CODE OUTPUT
     E                    WA1        15  1               UIFRMT SR.ARRY
     E                    WA2        16  1               UIFRMT SR.ARRY
     E/COPY WNCPYSRC,FT0030E001
     E/COPY ZSRSRC,ZALIGNZ1
     E** Copy the array for aligning amounts
     E/EJECT
     ICPYR@#      DS
     I** Data structure for compilation  - copyright insertion
     I*
     I                                        1  80 CPY@
     I                                        1  20 CPY@##
     I*
     IPSDS       SDS
     I** Program status data structure - retrieve user id
     I*
     I                                     *PROGRAM ##PGM
     I                                      244 253 WID
     I                                      244 246 WSID
     I                                      254 263 USRID
     I*
     IDLDA        DS                            256
     I** Data area LDA - used in the event of database errors
     I*
     I                                      134 141 DBFILE
     I                                      142 170 DBKEY
     I                                      171 180 DBPGM
     I                                      181 1830DBASE
     I*
     IZMUSER      DS
     I** User / Branch data area
     I                                       11  13 DBRN
     I                                       14  16 DPPT
     I                                       17  17 BANK
     I*
     ICMTTXT      DS
     I** Data structure to provide text on comit entry in journal
     I*
     I                                        1   50TIMEX
     I                                        6   7 MDID
     I                                        8  15 PGMN
     I                                       16  18 WSIDX
     I                                       19  240TIME
     I                                       25  25 ACTCDX
     I                                       26  35 USRIDX
     I                                       51  51 SACTCD
     I                                       52  54 SBRCA
     I                                       55  60 SCNUM
     I                                       61  64 SCGRP
     I                                       65  66 SPYTP
     I                                       67  68 SPYST
     I                                       69  69 STCDF
     I                                       70 104 STNR1
     I                                      105 139 STNR2
     I                                      140 174 STNR5
     I                                      175 188 SNNRT
     I                                      189 200 SNNMN
     I                                      201 212 SNNMX
     I                                      213 224 SCQCH
     I                                      225 236 SSPCH
     I*
     I                                      237 271 STNR3
     I                                      272 283 SRNS1
     I                                      284 295 SRNE1
     I                                      296 309 SRNR1
     I                                      310 321 SRNMN
     I                                      322 333 SRNMX
     I                                      334 345 SRNS2
     I                                      346 357 SRNE2
     I                                      358 371 SRNR2
     I                                      372 383 SRNMN2
     I                                      384 395 SRNMX2
     I                                      396 407 SRNS3
     I                                      408 419 SRNE3
     I                                      420 433 SRNR3
     I                                      434 445 SRNMN3
     I                                      446 457 SRNMX3
     I                                      458 469 SRNS4
     I                                      470 481 SRNE4
     I                                      482 495 SRNR4
     I                                      496 507 SRNMN4
     I                                      508 519 SRNMX4
     I                                      520 531 SRNS5
     I                                      532 543 SRNE5
     I                                      544 557 SRNR5
     I                                      558 569 SRNMN5
     I                                      570 581 SRNMX5
     I                                      582 593 SRNS6
     I                                      594 605 SRNE6
     I                                      606 619 SRNR6
     I                                      620 631 SRNMN6
     I                                      632 643 SRNMX6
     I                                      644 655 SRNS7
     I                                      656 667 SRNE7
     I                                      668 681 SRNR7
     I                                      682 693 SRNMN7
     I                                      694 705 SRNMX7
     I                                      706 717 SRNS8
     I                                      718 729 SRNE8
     I                                      730 743 SRNR8
     I                                      744 755 SRNMN8
     I                                      756 767 SRNMX8
     I                                      768 779 SRNS9
     I                                      780 791 SRNE9
     I                                      792 805 SRNR9
     I                                      806 817 SRNMN9
     I                                      818 829 SRNMX9
     I                                      830 841 SRNS0
     I                                      842 853 SRNE0
     I                                      854 867 SRNR0
     I                                      868 879 SRNMN0
     I                                      880 891 SRNMX0
     I                                      892 892 STR3C
     I*
     I                                      893 904 SCNS1
     I                                      905 916 SCNE1
     I                                      917 930 SCNR1
     I                                      931 942 SCNMN1
     I                                      943 954 SCNMX1
     I                                      955 966 SCNS2
     I                                      967 978 SCNE2
     I                                      979 992 SCNR2
     I                                      9931004 SCNMN2
     I                                     10051016 SCNMX2
     I                                     10171028 SCNS3
     I                                     10291040 SCNE3
     I                                     10411054 SCNR3
     I                                     10551066 SCNMN3
     I                                     10671078 SCNMX3
     I                                     10791090 SCNS4
     I                                     10911102 SCNE4
     I                                     11031116 SCNR4
     I                                     11171128 SCNMN4
     I                                     11291140 SCNMX4
     I                                     11411152 SCNS5
     I                                     11531164 SCNE5
     I                                     11651178 SCNR5
     I                                     11791190 SCNMN5
     I                                     11911202 SCNMX5
     I                                     12031214 SCNS6
     I                                     12151226 SCNE6
     I                                     12271240 SCNR6
     I                                     12411252 SCNMN6
     I                                     12531264 SCNMX6
     I                                     12651276 SCNS7
     I                                     12771288 SCNE7
     I                                     12891302 SCNR7
     I                                     13031314 SCNMN7
     I                                     13151326 SCNMX7
     I                                     13271338 SCNS8
     I                                     13391350 SCNE8
     I                                     13511364 SCNR8
     I                                     13651376 SCNMN8
     I                                     13771388 SCNMX8
     I                                     13891400 SCNS9
     I                                     14011412 SCNE9
     I                                     14131426 SCNR9
     I                                     14271438 SCNMN9
     I                                     14391450 SCNMX9
     I                                     14511462 SCNS0
     I                                     14631474 SCNE0
     I                                     14751488 SCNR0
     I                                     14891500 SCNMN0
     I                                     15011512 SCNMX0
     I                                     15131513 SCH3C
     I*
     I                                     15141548 STNR4
     I                                     15491560 SRRS1
     I                                     15611572 SRRE1
     I                                     15731586 SRRR1
     I                                     15871598 SRRMN
     I                                     15991610 SRRMX
     I                                     16111622 SRRS2
     I                                     16231634 SRRE2
     I                                     16351648 SRRR2
     I                                     16491660 SRRMN2
     I                                     16611672 SRRMX2
     I                                     16731684 SRRS3
     I                                     16851696 SRRE3
     I                                     16971710 SRRR3
     I                                     17111722 SRRMN3
     I                                     17231734 SRRMX3
     I                                     17351746 SRRS4
     I                                     17471758 SRRE4
     I                                     17591772 SRRR4
     I                                     17731784 SRRMN4
     I                                     17851796 SRRMX4
     I                                     17971808 SRRS5
     I                                     18091820 SRRE5
     I                                     18211834 SRRR5
     I                                     18351846 SRRMN5
     I                                     18471858 SRRMX5
     I                                     18591870 SRRS6
     I                                     18711882 SRRE6
     I                                     18831896 SRRR6
     I                                     18971908 SRRMN6
     I                                     19091920 SRRMX6
     I                                     19211932 SRRS7
     I                                     19331944 SRRE7
     I                                     19451958 SRRR7
     I                                     19591970 SRRMN7
     I                                     19711982 SRRMX7
     I                                     19831994 SRRS8
     I                                     19952006 SRRE8
     I                                     20072020 SRRR8
     I                                     20212032 SRRMN8
     I                                     20332044 SRRMX8
     I                                     20452056 SRRS9
     I                                     20572068 SRRE9
     I                                     20692082 SRRR9
     I                                     20832094 SRRMN9
     I                                     20952106 SRRMX9
     I                                     21072118 SRRS0
     I                                     21192130 SRRE0
     I                                     21312144 SRRR0
     I                                     21452156 SRRMN0
     I                                     21572168 SRRMX0
     I                                     21692169 STR4C
     I*
     I                                     21702181 SCRS1
     I                                     21822193 SCRE1
     I                                     21942207 SCRR1
     I                                     22082219 SCRMN1
     I                                     22202231 SCRMX1
     I                                     22322243 SCRS2
     I                                     22442255 SCRE2
     I                                     22562269 SCRR2
     I                                     22702281 SCRMN2
     I                                     22822293 SCRMX2
     I                                     22942305 SCRS3
     I                                     23062317 SCRE3
     I                                     23182331 SCRR3
     I                                     23322343 SCRMN3
     I                                     23442355 SCRMX3
     I                                     23562367 SCRS4
     I                                     23682379 SCRE4
     I                                     23802393 SCRR4
     I                                     23942405 SCRMN4
     I                                     24062417 SCRMX4
     I                                     24182429 SCRS5
     I                                     24302441 SCRE5
     I                                     24422455 SCRR5
     I                                     24562467 SCRMN5
     I                                     24682479 SCRMX5
     I                                     24802491 SCRS6
     I                                     24922503 SCRE6
     I                                     25042517 SCRR6
     I                                     25182529 SCRMN6
     I                                     25302541 SCRMX6
     I                                     25422553 SCRS7
     I                                     25542565 SCRE7
     I                                     25662579 SCRR7
     I                                     25802591 SCRMN7
     I                                     25922603 SCRMX7
     I                                     26042615 SCRS8
     I                                     26162627 SCRE8
     I                                     26282641 SCRR8
     I                                     26422653 SCRMN8
     I                                     26542665 SCRMX8
     I                                     26662677 SCRS9
     I                                     26782689 SCRE9
     I                                     26902703 SCRR9
     I                                     27042715 SCRMN9
     I                                     27162727 SCRMX9
     I                                     27282739 SCRS0
     I                                     27402751 SCRE0
     I                                     27522765 SCRR0
     I                                     27662777 SCRMN0
     I                                     27782789 SCRMX0
     I                                     27902790 SCH4C
     I*
     ISDBANK    E DSSDBANKPD                                              S01494
     I** External data structure for Bank details                         S01494
     I*                                                                   S01494
     ISDBRCH    E DSSDBRCHPD                                              S01494
     I** External data structure for Branch details                       S01494
     I*                                                                   S01494
     ISDCURR    E DSSDCURRPD                                              S01494
     I** External data structure for Currency details                     S01494
     I*                                                                   S01494
     ISDCUST    E DSSDCUSTPD                                              S01494
     I              QQDFAC                          #DFAC1                                    CGL029
     I** External data structure for Currency details                     S01494
     I*                                                                   S01494
     ISDDLST    E DSSDDLSTPD                                              S01494
     I** External data structure for Deal subtypes details                S01494
     I*                                                                   S01494
     ISDGELR    E DSSDGELRPD                                              S01494
     I** External data structure for General Ledger details               S01494
     I*                                                                   S01494
     ISDMMOD    E DSSDMMODPD                                              S01494
     I** External data structure for Midas Modules details                S01494
     I*                                                                   S01494
     ISCSARD    E DSSCSARDPD                                              S01494
     I** External data structure for SAR file details                     S01494
     I*                                                                   S01494
     IDSFDY     E DSDSFDY
     I** Short data structure used by access programs
     I*
     IDSSDY     E DSDSSDY
     I*
     I** Long data structure used by access programs
     I/EJECT
     C*****************************************************************
     C*                 AA-MAINLINE-PROCESSING                        *
     C*                                                               *
     C*  FUNCTION : TO PERFORM INITIAL PROCESSING AND THEN TO CONTROL *
     C*             PROCESSING OF INPUT UNTIL ALL ENTRIES ARE VALID   *
     C*             OR THE PROGRAM IS ABORTED. FINALLY IT COMMITS THE *
     C*             ENTRIES MADE IF THEY ARE ALL VALID.               *
     C*                                                               *
     C*  CALLS :    CADETL                                            *
     C*             UATBCN                                            *
     C*             UEABRT                                            *
     C*             ZSYSTM                                            *
     C*                                                               *
     C*  CALLED BY: NONE                                              *
     C*                                                               *
     C*****************************************************************
     C*
     C                     MOVEACPY@      BIS@   80
     C*
     C           *LIKE     DEFN DBFILE    WDBFIL
     C           *LIKE     DEFN DBKEY     WDBKEY
     C           *LIKE     DEFN DBASE     WDBASE
     C*
     C** Access bank details
     C*
     C                     CALL 'AOBANKR0'
     C                     PARM '*DBERR'  @RTCD   7
     C                     PARM '*FIRST'  @OPTN   7
     C           SDBANK    PARM SDBANK    DSFDY
     C*
     C           BJDFIN    IFEQ 'M'
     C                     SETON                     98
     C                     END
     C*
     C** Access the currency files for the decimal place
     C*
     C                     CALL 'AOCURRR0'
     C                     PARM '*DBERR'  @RTCD   7
     C                     PARM '*KEY  '  @OPTN   7
     C                     PARM           BJCYCD
     C           SDCURR    PARM SDCURR    DSSDY
     C*
     C                     Z-ADDA6NBDP    SVBCDP  10
     C*
     C** Access the midas modules file for the MB indicator
     C*
     C                     CALL 'AOMMODR0'
     C                     PARM '*DBERR'  @RTCD   7
     C                     PARM '*FIRST'  @OPTN   7
     C           SDMMOD    PARM SDMMOD    DSFDY
     C*
     C           BGMBIN    IFEQ 'Y'
     C                     SETON                     12
     C                     END
     C*
     C** If multibranching,
     C*
     C           *IN12     IFEQ '1'                        MB environment
     C**********           CALL 'AOGELRR0'                                                    CGL029
     C                     CALL 'AOGELRR1'                                                    CGL029
     C                     PARM '*DBERR'  @RTCD   7
     C                     PARM '*FIRST'  @OPTN   7
     C********** SDGELR    PARM SDGELR    DSFDY                                               CGL029
     C           SDGELR    PARM SDGELR    DSSDY                                               CGL029
     C*
     C           *NAMVAR   DEFN           ZMUSER           Get DBRN
     C                     IN   ZMUSER
     C                     END
     C*
     C** Access SAR files to determine if FX/Change Commission is on
     C*
     C                     MOVE *BLANK    S01494  1                       S01494
     C                     CALL 'AOSARDR0'                                S01494
     C                     PARM *BLANKS   @RTCD   7                       S01494
     C                     PARM '*VERIFY' @OPTN   7                       S01494
     C                     PARM 'S01494'  @SARD   6                       S01494
     C           SCSARD    PARM SCSARD    DSFDY                           S01494
     C*                                                                   S01494
     C** If core feature is switched ON, set a variable to condition      S01494
     C** the rest of the processing                                       S01494
     C*                                                                   S01494
     C           @RTCD     IFEQ *BLANKS                                   S01494
     C                     MOVE 'Y'       S01494                          S01494
     C                     ELSE                                           S01494
     C*                                                                   S01494
     C** else, database error (return code other than *NRF)               S01494
     C*                                                                   S01494
     C           @RTCD     IFNE '*NRF   '                                 S01494
     C                     MOVEL'SCSARDPD'WDBFIL           ************   S01494
     C                     MOVEL'*VERIFY' WDBKEY           * DBERR 01 *   S01494
     C                     MOVEL'01'      WDBASE           ************   S01494
     C                     EXSR UEABRT                                    S01494
     C                     END                                            S01494
     C                     END                                            S01494
     C*
     C** Access SAR files to determine if Extended Charge is on
     C*
     C                     MOVE *BLANK    S01508  1                       S01494
     C                     CALL 'AOSARDR0'                                S01494
     C                     PARM *BLANKS   @RTCD   7                       S01494
     C                     PARM '*VERIFY' @OPTN   7                       S01494
     C                     PARM 'S01508'  @SARD   6                       S01494
     C           SCSARD    PARM SCSARD    DSFDY                           S01494
     C*                                                                   S01494
     C** If core feature is switched ON, set a variable to condition      S01494
     C** the rest of the processing                                       S01494
     C*                                                                   S01494
     C           @RTCD     IFEQ *BLANKS                                   S01494
     C                     MOVE 'Y'       S01508                          S01494
     C                     ELSE                                           S01494
     C*                                                                   S01494
     C** else, database error (return code other than *NRF)               S01494
     C*                                                                   S01494
     C           @RTCD     IFNE '*NRF   '                                 S01494
     C                     MOVEL'SCSARDPD'WDBFIL           ************   S01494
     C                     MOVEL'*VERIFY' WDBKEY           * DBERR 02 *   S01494
     C                     MOVEL'02'      WDBASE           ************   S01494
     C                     EXSR UEABRT                                    S01494
     C                     END                                            S01494
     C                     END                                            S01494
     C/COPY WNCPYSRC,FT0030C006
     C*
     C** Establish the message file and display the screen
     C*
     C                     MOVE *BLANKS   ZAMSID
     C                     MOVEL'FTUSRMSG'ZAMSGF
     C*
     C** Set up key list for PYCHGDD
     C*
     C           WKPAY     KLIST
     C                     KFLD           SBRCA
     C**********           KFLD           WCNUM   60                                          CSD027
     C                     KFLD           WCNUM   6                                           CSD027
     C                     KFLD           SPYTP
     C                     KFLD           SPYST
     C                     KFLD           SCGRP
     C*
     C** Process screen until all input is valid or input is aborted
     C*
     C           *INKC     DOUEQ'1'
     C                     EXSR CADETL
     C                     END
     C*
     C** Seton last record indicator & end program
     C*
     C                     SETON                     LR
     C*
     C*          *****     ***
     C           AAEND     TAG
     C*          *****     ***
     C*
     C** End of main line processing
     C*
     C/EJECT
     C           CADETL    BEGSR
     C*          ******    *****
     C*
     C*****************************************************************
     C*                 CA-DETAIL-PROCESSING                          *
     C*                                                               *
     C*  FUNCTION : TO PERFORM PROCESSING OF THE INITIAL SCREEN &     *
     C*             WHERE APPROPRIATE TO CONTROL PROCESSING OF THE    *
     C*             DETAIL SCREEN. FINALLY TO CONTROL THE UPDATE OF   *
     C*             THE FILES AS NECCESSARY.                          *
     C*                                                               *
     C*  CALLS :    EAINPT                                            *
     C*             ECINST                                            *
     C*             EEAMND                                            *
     C*             UCPCCN                                            *
     C*             UGTIME                                            *
     C*             UIFRMT                                            *
     C*                                                               *
     C*  CALLED BY: AAMAIN                                            *
     C*                                                               *
     C*****************************************************************
     C*
     C** Clear all screen formats if no error found
     C*
     C           *IN74     IFEQ '0'
     C           WERRM     ANDEQ*BLANK
     C                     EXSR SRCLRM
     C                     MOVEL*BLANKS   ERCD
     C                     CLEARFT0030F1
     C                     CLEARFT0030F2
     C                     CLEARFT0030F3
     C                     CLEARFT0030F4
     C                     CLEARFT0030F5
     C                     CLEARFT0030F6                                  074809
     C                     END
     C*
     C           S01508    IFEQ 'Y'
     C                     MOVE '1'       *IN05
     C                     END
     C*
     C           BGMBIN    IFEQ 'Y'
     C                     MOVE '1'       *IN12
     C                     END
     C*
     C** Initialise the page numbers
     C*
     C                     MOVELWPAG,1    SPAG1
     C                     MOVELWPAG,2    SPAG2
     C                     MOVELWPAG,3    SPAG3
     C                     MOVELWPAG,4    SPAG4
     C                     MOVELWPAG,5    SPAG5
     C*
     C** Execute initial screen
     C*
     C                     MOVEAERCD,1    SERCD1             -ERR MSGS
     C                     EXSR UGTIME                       -GET TIME
     C                     SETON                     7173
     C                     SETOF                     72
     C*
     C                     WRITE#MSGCTL
     C                     EXFMTFT0030F1
     C*
     C** Check if function keys 3 was pressed
     C*
     C           *INKC     IFEQ '1'
     C                     GOTO CAEND
     C                     END
     C*
     C** Check if command 12 was pressed
     C*
     C           *INKL     IFEQ '1'
     C                     SETOF                     74
     C                     MOVE *BLANK    WERRM
     C                     GOTO CAEND
     C                     END
     C*
     C** Resolve ?'s before validation
     C*
     C                     SETOF                     401108
     C                     SETOF                     161719
     C                     SETOF                     7489
     C                     MOVE *BLANKS   WERRM
     C                     EXSR SRCLRM
     C                     EXSR SRFLDQ
     C           *INKC     IFEQ '1'
     C                     GOTO CAEND
     C                     END
     C*
     C** Action code must be 'I','A','E' OR 'D'
     C*
     C           SACTCD    IFNE 'I'
     C           SACTCD    ANDNE'A'
     C           SACTCD    ANDNE'E'
     C           SACTCD    ANDNE'D'
     C                     SETON                     4074
     C                     MOVE '001'     ERCD,1
     C                     GOTO CAEND
     C                     END
     C*
     C** Set the screen branch to the default branch if it is blank
     C** and all the other key fields are blank and multibranching
     C*
     C           *IN12     IFEQ '1'
     C           SBRCA     IFEQ *BLANKS
     C           SCNUM     ANDEQ*BLANKS
     C           SCGRP     ANDEQ*BLANKS
     C           SPYTP     ANDEQ*BLANKS
     C           SPYST     ANDEQ*BLANKS
     C                     MOVE DBRN      SBRCA
     C                     END
     C                     ELSE
     C                     MOVE BJSBRC    SBRCA
     C                     END
     C*                                                                   074803
     C** Do not allow deletion of payment charges for a branch            074803
     C*                                                                   074803
     C           SACTCD    IFEQ 'D'                                       074803
     C           SBRCA     ANDNE*BLANKS                                   074803
     C           SCNUM     ANDEQ*BLANKS                                   074803
     C           SCGRP     ANDEQ*BLANKS                                   074803
     C           SPYTP     ANDEQ*BLANKS                                   074803
     C           SPYST     ANDEQ*BLANKS                                   074803
     C                     SETON                     4011                 074803
     C                     MOVEL'FTM2536' ZAMSID                          074803
     C                     EXSR SRSNDM                                    074803
     C                     GOTO CAEND                                     074803
     C                     END                                            074803
     C*                                                                   074803
     C** Check the key for payment charges
     C*
     C                     EXSR SRVKEY
     C           *IN89     IFEQ '1'
     C                     GOTO CAEND
     C                     END
     C*
     C** If non-multibranching
     C*
     C           *IN12     IFEQ '0'                                       S01117
     C*                                                                   S01117
     C** Validate whether user has authority to the specific              S01117
     C** action code being used.                                          S01117
     C*                                                                   S01117
     C                     CALL 'ZVACTU'                                  S01117
     C                     PARM SACTCD    ZACTN   1                       S01117
     C                     PARM           ERR     10                      S01117
     C*                                                                   S01117
     C** If user does not have authority, display msg and allow input.    S01117
     C*                                                                   S01117
     C           ERR       IFNE 0                                         S01117
     C                     SETON                     4074                 S01117
     C                     MOVE '302'     ERCD,1                          S01117
     C                     GOTO CAEND                                     S01117
     C                     END                                            S01117
     C                     ELSE                            If *IN38 = 1   S01117
     C*
     C** Multibranching environment,
     C*
     C** If branch is originating branch and user validation is required
     C** and action code is not 'E', check user validation.
     C*
     C           BKOBRU    IFEQ 'Y'                        Orig. Branch
     C           BKOBUV    ANDEQ'Y'                        Val. needed
     C           SACTCD    ANDNE'E'
     C                     CALL 'ZVOBU'
     C                     PARM SBRCA     ZOBRX   3
     C                     PARM           ERR     10
     C*
     C           ERR       IFNE 0
     C           ERR       IFEQ 1
     C                     MOVEA'305'     ERCD,1
     C                     ELSE
     C                     MOVEA'306'     ERCD,1
     C                     END
     C                     SETON                     1274
     C                     GOTO CAEND
     C                     END
     C*
     C** If branch is booking branch validate branch code exists
     C*  (with action codes for this menu item)
     C*
     C                     ELSE
     C           BKOBRU    IFEQ 'N'
     C                     CALL 'ZVACTBU'
     C                     PARM           SACTCD
     C                     PARM           SBRCA
     C                     PARM           ERR
     C*
     C           ERR       IFNE 0
     C           ERR       IFEQ 1
     C                     MOVEA'303'     ERCD,1
     C                     ELSE                            If ERR = 2
     C                     MOVEA'304'     ERCD,1
     C                     END
     C                     SETON                     1274
     C                     GOTO CAEND
     C                     END
     C                     END
     C                     END
     C                     END
     C*
     C** Validate if the fields entered meet the required data
     C** for the search
     C*
     C                     MOVE *BLANKS   WVALK
     C                     EXSR SRVSCH
     C           WVALK     IFEQ *BLANKS
     C                     SETON                     111908
     C                     SETON                     1617
     C                     MOVEL'FTM2525' ZAMSID
     C                     EXSR SRSNDM
     C                     GOTO CAEND
     C                     END
     C*
     C** Access payment charges file by customer
     C*
     C** Error if record does not exist & action code is 'A','E' or 'D'
     C*
     C           SACTCD    IFEQ 'A'
     C           SACTCD    OREQ 'E'
     C           SACTCD    OREQ 'D'
     C*
     C*******              MOVE SCNUM     WCNUM                           102623
     C                     MOVE BBCUST    WCNUM                           102623
      *                                                                                       210873
      * If customer not entered then zero                                                     210873
      *                                                                                       210873
     C           SCNUM     IFEQ *BLANKS                                                       210873
     C**********           Z-ADD0         WCNUM                                        210873 CSD027
     C                     MOVE *BLANKS   WCNUM                                               CSD027
     C                     ELSE                                                               210873
     C                     MOVELSCNUM     WCNUM                                               210873
     C                     ENDIF                                                              210873
     C                     EXSR UCPCCN
     C*
     C           *IN89     IFEQ '1'
     C           *IN89     OREQ '0'                                       099674
     C           RECI      ANDEQ'*'                                       099674
     C                     SETON                     081119
     C                     SETON                     1617
     C                     MOVEL'FTM2530' ZAMSID
     C                     EXSR SRSNDM
     C                     GOTO CAEND
     C                     END
     C*
     C                     END
     C*
     C** Skip next few lines of processing if action code is 'I' and
     C** record does not exist (Valid combination)
     C*
     C           SACTCD    IFEQ 'I'
     C*
     C*******              MOVE SCNUM     WCNUM                           102623
     C                     MOVE BBCUST    WCNUM                           102623
      *                                                                                       210873
      * If customer not entered then zero                                                     210873
      *                                                                                       210873
     C           SCNUM     IFEQ *BLANKS                                                       210873
     C**********           Z-ADD0         WCNUM                                        210873 CSD027
     C                     MOVE *BLANKS   WCNUM                                               CSD027
     C                     ELSE                                                               210873
     C                     MOVELSCNUM     WCNUM                                               210873
     C                     ENDIF                                                              210873
     C                     EXSR UCPCCN
     C*
     C           *IN89     IFEQ '0'
     C           RECI      ANDNE'*'                                       099674
     C                     SETON                     081119
     C                     SETON                     1617
     C                     MOVEL'FTM2529' ZAMSID
     C                     EXSR SRSNDM
     C                     GOTO CAEND
     C                     ELSE
     C                     GOTO CA100
     C                     END
     C*
     C                     END
     C*
     C** If action code is 'A', store the last date & time of change
     C*
     C           SACTCD    IFEQ 'A'
     C                     Z-ADDLCD       SVLCD   50
     C                     Z-ADDLCHT      SVLCHT  60
     C                     END
     C*
     C** Format all detail screen fields from payment charges record
     C*
     C                     MOVEL*BLANKS   WFDIN  15
     C                     MOVE RNS1      WFDIN
     C           11        SUB  SVBCDP    WDIG    20
     C                     Z-ADDSVBCDP    WDEC    10
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRNS1
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RNE1      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRNE1
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RNR1      WFDIN
     C                     Z-ADD5         WDIG
     C                     Z-ADD8         WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRNR1
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RNS2      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRNS2
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RNE2      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRNE2
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RNR2      WFDIN
     C                     Z-ADD5         WDIG
     C                     Z-ADD8         WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRNR2
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RNMN      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRNMN
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RNMN2     WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRNMN2
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RNMN3     WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRNMN3
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RNS3      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRNS3
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RNE3      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRNE3
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RNR3      WFDIN
     C                     Z-ADD5         WDIG
     C                     Z-ADD8         WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRNR3
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RNMX      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRNMX
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RNMX2     WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRNMX2
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RNMX3     WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRNMX3
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RRS1      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRRS1
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RRE1      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRRE1
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RRR1      WFDIN
     C                     Z-ADD5         WDIG
     C                     Z-ADD8         WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRRR1
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RRMN      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRRMN
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RRMN2     WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRRMN2
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RRS2      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRRS2
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RRE2      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRRE2
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RRR2      WFDIN
     C                     Z-ADD5         WDIG
     C                     Z-ADD8         WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRRR2
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RRMX      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRRMX
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RRMX2     WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRRMX2
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE NNRT      WFDIN
     C                     Z-ADD5         WDIG
     C                     Z-ADD8         WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SNNRT
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE NNMN      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SNNMN
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE NNMX      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SNNMX
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CQCH      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCQCH
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE SPCH      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SSPCH
     C*
     C                     MOVELDFTRCT    SDFTCR
     C                     MOVELTNR1      STNR1
     C                     MOVELTNR2      STNR2
     C                     MOVELTNR3      STNR3
     C                     MOVELTNR4      STNR4
     C                     MOVELTNR5      STNR5
     C********** PYCNUM    IFEQ *ZEROS                                                        CSD027
     C           PYCNUM    IFEQ *BLANKS                                                       CSD027
     C                     MOVE *BLANKS   SCNUM
     C                     ELSE
     C                     MOVELPYCNUM    SCNUM
     C                     END
     C                     MOVELPYPYTP    SPYTP
     C                     MOVELPYPYST    SPYST
     C                     MOVELPYGPCD    SCGRP
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RNS4      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRNS4
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RNE4      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRNE4
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RNMN4     WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRNMN4
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RNMX4     WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRNMX4
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RNS5      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRNS5
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RNE5      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRNE5
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RNMN5     WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRNMN5
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RNMX5     WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRNMX5
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RNS6      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRNS6
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RNE6      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRNE6
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RNMN6     WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRNMN6
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RNMX6     WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRNMX6
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RNS7      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRNS7
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RNE7      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRNE7
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RNMN7     WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRNMN7
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RNMX7     WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRNMX7
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RNS8      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRNS8
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RNE8      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRNE8
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RNMN8     WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRNMN8
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RNMX8     WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRNMX8
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RNS9      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRNS9
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RNE9      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRNE9
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RNMN9     WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRNMN9
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RNMX9     WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRNMX9
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RNS0      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRNS0
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RNE0      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRNE0
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RNMN0     WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRNMN0
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RNMX0     WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRNMX0
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RRS3      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRRS3
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RRE3      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRRE3
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RRMN3     WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRRMN3
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RRMX3     WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRRMX3
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RRS4      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRRS4
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RRE4      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRRE4
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RRMN4     WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRRMN4
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RRMX4     WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRRMX4
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RRS5      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRRS5
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RRE5      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRRE5
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RRMN5     WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRRMN5
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RRMX5     WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRRMX5
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RRS6      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRRS6
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RRE6      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRRE6
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RRMN6     WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRRMN6
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RRMX6     WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRRMX6
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RRS7      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRRS7
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RRE7      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRRE7
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RRMN7     WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRRMN7
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RRMX7     WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRRMX7
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RRS8      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRRS8
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RRE8      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRRE8
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RRMN8     WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRRMN8
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RRMX8     WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRRMX8
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RRS9      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRRS9
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RRE9      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRRE9
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RRMN9     WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRRMN9
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RRMX9     WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRRMX9
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RRS0      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRRS0
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RRE0      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRRE0
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RRMN0     WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRRMN0
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RRMX0     WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRRMX0
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RNR4      WFDIN
     C                     Z-ADD5         WDIG
     C                     Z-ADD8         WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRNR4
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RNR5      WFDIN
     C                     Z-ADD5         WDIG
     C                     Z-ADD8         WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRNR5
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RNR6      WFDIN
     C                     Z-ADD5         WDIG
     C                     Z-ADD8         WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRNR6
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RNR7      WFDIN
     C                     Z-ADD5         WDIG
     C                     Z-ADD8         WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRNR7
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RNR8      WFDIN
     C                     Z-ADD5         WDIG
     C                     Z-ADD8         WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRNR8
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RNR9      WFDIN
     C                     Z-ADD5         WDIG
     C                     Z-ADD8         WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRNR9
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RNR0      WFDIN
     C                     Z-ADD5         WDIG
     C                     Z-ADD8         WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRNR0
     C*
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RRR3      WFDIN
     C                     Z-ADD5         WDIG
     C                     Z-ADD8         WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRRR3
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RRR4      WFDIN
     C                     Z-ADD5         WDIG
     C                     Z-ADD8         WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRRR4
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RRR5      WFDIN
     C                     Z-ADD5         WDIG
     C                     Z-ADD8         WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRRR5
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RRR6      WFDIN
     C                     Z-ADD5         WDIG
     C                     Z-ADD8         WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRRR6
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RRR7      WFDIN
     C                     Z-ADD5         WDIG
     C                     Z-ADD8         WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRRR7
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RRR8      WFDIN
     C                     Z-ADD5         WDIG
     C                     Z-ADD8         WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRRR8
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RRR9      WFDIN
     C                     Z-ADD5         WDIG
     C                     Z-ADD8         WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRRR9
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RRR0      WFDIN
     C                     Z-ADD5         WDIG
     C                     Z-ADD8         WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SRRR0
     C*
     C                     MOVELCH3C      SCH3C
     C                     MOVELCH4C      SCH4C
     C                     MOVELTR3C      STR3C
     C                     MOVELTR4C      STR4C
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CNS1      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCNS1
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CNE1      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCNE1
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CNMN1     WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCNMN1
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CNMX1     WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCNMX1
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CNS2      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCNS2
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CNE2      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCNE2
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CNMN2     WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCNMN2
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CNMX2     WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCNMX2
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CNS3      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCNS3
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CNE3      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCNE3
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CNMN3     WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCNMN3
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CNMX3     WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCNMX3
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CNS4      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCNS4
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CNE4      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCNE4
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CNMN4     WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCNMN4
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CNMX4     WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCNMX4
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CNS5      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCNS5
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CNE5      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCNE5
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CNMN5     WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCNMN5
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CNMX5     WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCNMX5
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CNS6      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCNS6
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CNE6      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCNE6
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CNMN6     WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCNMN6
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CNMX6     WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCNMX6
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CNS7      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCNS7
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CNE7      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCNE7
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CNMN7     WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCNMN7
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CNMX7     WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCNMX7
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CNS8      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCNS8
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CNE8      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCNE8
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CNMN8     WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCNMN8
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CNMX8     WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCNMX8
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CNS9      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCNS9
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CNE9      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCNE9
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CNMN9     WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCNMN9
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CNMX9     WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCNMX9
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CNS0      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCNS0
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CNE0      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCNE0
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CNMN0     WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCNMN0
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CNMX0     WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCNMX0
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CRS1      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCRS1
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CRE1      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCRE1
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CRMN1     WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCRMN1
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CRMX1     WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCRMX1
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CRS2      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCRS2
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CRE2      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCRE2
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CRMN2     WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCRMN2
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CRMX2     WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCRMX2
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CRS3      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCRS3
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CRE3      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCRE3
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CRMN3     WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCRMN3
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CRMX3     WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCRMX3
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CRS4      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCRS4
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CRE4      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCRE4
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CRMN4     WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCRMN4
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CRMX4     WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCRMX4
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CRS5      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCRS5
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CRE5      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCRE5
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CRMN5     WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCRMN5
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CRMX5     WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCRMX5
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CRS6      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCRS6
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CRE6      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCRE6
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CRMN6     WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCRMN6
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CRMX6     WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCRMX6
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CRS7      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCRS7
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CRE7      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCRE7
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CRMN7     WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCRMN7
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CRMX7     WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCRMX7
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CRS8      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCRS8
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CRE8      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCRE8
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CRMN8     WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCRMN8
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CRMX8     WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCRMX8
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CRS9      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCRS9
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CRE9      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCRE9
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CRMN9     WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCRMN9
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CRMX9     WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCRMX9
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CRS0      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCRS0
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CRE0      WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCRE0
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CRMN0     WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCRMN0
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CRMX0     WFDIN
     C           11        SUB  SVBCDP    WDIG
     C                     Z-ADDSVBCDP    WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCRMX0
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CNR1      WFDIN
     C                     Z-ADD5         WDIG
     C                     Z-ADD8         WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCNR1
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CNR2      WFDIN
     C                     Z-ADD5         WDIG
     C                     Z-ADD8         WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCNR2
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CNR3      WFDIN
     C                     Z-ADD5         WDIG
     C                     Z-ADD8         WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCNR3
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CNR4      WFDIN
     C                     Z-ADD5         WDIG
     C                     Z-ADD8         WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCNR4
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CNR5      WFDIN
     C                     Z-ADD5         WDIG
     C                     Z-ADD8         WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCNR5
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CNR6      WFDIN
     C                     Z-ADD5         WDIG
     C                     Z-ADD8         WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCNR6
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CNR7      WFDIN
     C                     Z-ADD5         WDIG
     C                     Z-ADD8         WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCNR7
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CNR8      WFDIN
     C                     Z-ADD5         WDIG
     C                     Z-ADD8         WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCNR8
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CNR9      WFDIN
     C                     Z-ADD5         WDIG
     C                     Z-ADD8         WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCNR9
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CNR0      WFDIN
     C                     Z-ADD5         WDIG
     C                     Z-ADD8         WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCNR0
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CRR1      WFDIN
     C                     Z-ADD5         WDIG
     C                     Z-ADD8         WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCRR1
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CRR2      WFDIN
     C                     Z-ADD5         WDIG
     C                     Z-ADD8         WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCRR2
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CRR3      WFDIN
     C                     Z-ADD5         WDIG
     C                     Z-ADD8         WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCRR3
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CRR4      WFDIN
     C                     Z-ADD5         WDIG
     C                     Z-ADD8         WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCRR4
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CRR5      WFDIN
     C                     Z-ADD5         WDIG
     C                     Z-ADD8         WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCRR5
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CRR6      WFDIN
     C                     Z-ADD5         WDIG
     C                     Z-ADD8         WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCRR6
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CRR7      WFDIN
     C                     Z-ADD5         WDIG
     C                     Z-ADD8         WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCRR7
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CRR8      WFDIN
     C                     Z-ADD5         WDIG
     C                     Z-ADD8         WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCRR8
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CRR9      WFDIN
     C                     Z-ADD5         WDIG
     C                     Z-ADD8         WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCRR9
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CRR0      WFDIN
     C                     Z-ADD5         WDIG
     C                     Z-ADD8         WDEC
     C                     EXSR UIFRMT
     C                     MOVE WFDOUT    SCRR0
     C*
     C*          *****     ***
     C           CA100     TAG
     C*          *****     ***
     C*
     C** Set off protection indicator for insert and amend modes
     C*
     C           SACTCD    IFEQ 'I'
     C           SACTCD    OREQ 'A'
     C                     SETOF                     73
     C                     END
     C*
     C** Process detail screen until function keys 3 or 12 are pressed
     C** or all input fields are valid
     C*
     C                     SETOF                     20
     C           *INKC     DOUEQ'1'
     C           *INKL     OREQ '1'
     C           *IN20     OREQ '1'
     C                     EXSR EAINPT
     C                     END
     C*
     C** Check if function key 3 was pressed from detail screen
     C*
     C           *INKC     IFEQ '1'
     C                     GOTO CAEND
     C                     END
     C*
     C** Check if function key 12 was pressed from detail screen
     C*
     C           *INKL     IFEQ '1'
     C                     SETOF                     74
     C                     MOVE *BLANK    WERRM
     C                     GOTO CAEND
     C                     END
     C*
     C**  Transfer commission tariff 3
     C*
     C                     SETOF                     20
     C           *INKC     DOUEQ'1'
     C           *INKL     OREQ '1'
     C           *IN20     OREQ '1'
     C                     EXSR EAINP2
     C                     END
     C*
     C** Check if function key 3 was pressed from detail screen
     C*
     C           *INKC     IFEQ '1'
     C                     GOTO CAEND
     C                     END
     C*
     C** Check if function key 12 was pressed from detail screen
     C*
     C           *INKL     IFEQ '1'
     C                     SETOF                     74
     C                     MOVE *BLANK    WERRM                           074804
     C                     GOTO CAEND
     C                     END
     C*
     C** Format the FX/Change Commission tariff 3 if S01494 is active
     C*
     C           S01494    IFEQ 'Y'
     C                     SETOF                     20
     C           *INKC     DOUEQ'1'
     C           *INKL     OREQ '1'
     C           *IN20     OREQ '1'
     C                     EXSR EAINP3
     C                     END
     C                     END
     C*
     C** Check if function key 3 was pressed from detail screen
     C*
     C           *INKC     IFEQ '1'
     C                     GOTO CAEND
     C                     END
     C*
     C** Check if function key 12 was pressed from detail screen
     C*
     C           *INKL     IFEQ '1'
     C                     SETOF                     74
     C                     MOVE *BLANK    WERRM                           074804
     C                     GOTO CAEND
     C                     END
     C/COPY WNCPYSRC,FT0030C002
     C*
     C** Transfer commission tariff 4
     C*
     C           S01494    IFNE 'Y'
     C                     MOVELWPAG,3    SPAG4
     C                     END
     C                     SETOF                     20
     C           *INKC     DOUEQ'1'
     C           *INKL     OREQ '1'
     C           *IN20     OREQ '1'
     C                     EXSR EAINP4
     C                     END
     C*
     C** Check if function key 3 was pressed from detail screen
     C*
     C           *INKC     IFEQ '1'
     C                     GOTO CAEND
     C                     END
     C*
     C** Check if function key 12 was pressed from detail screen
     C*
     C           *INKL     IFEQ '1'
     C                     SETOF                     74
     C                     MOVE *BLANK    WERRM                           074804
     C                     GOTO CAEND
     C                     END
     C*
     C** Format FX/Change Commissions tariff 4 if S01494 is active
     C*
     C           S01494    IFEQ 'Y'
     C                     SETOF                     20
     C           *INKC     DOUEQ'1'
     C           *INKL     OREQ '1'
     C           *IN20     OREQ '1'
     C                     EXSR EAINP5
     C                     END
     C                     END
     C*
     C** Check if function key 3 was pressed from detail screen
     C*
     C           *INKC     IFEQ '1'
     C                     GOTO CAEND
     C                     END
     C*
     C** Check if function key 12 was pressed from detail screen
     C*
     C           *INKL     IFEQ '1'
     C                     SETOF                     74
     C                     MOVE *BLANK    WERRM                           074804
     C                     GOTO CAEND
     C                     END
     C*
     C** Get time for update stamp
     C*
     C                     EXSR UGTIME
     C/COPY WNCPYSRC,FT0030C003
     C*
     C** Process each request
     C*
     C           SACTCD    CASEQ'I'       ECINST
     C           SACTCD    CASEQ'A'       EEAMND
     C           SACTCD    CASEQ'D'       EEDLT
     C                     ENDCS
     C*
     C*          *****     *****
     C           CAEND     ENDSR
     C*          *****     *****
     C/EJECT
     C           EAINPT    BEGSR
     C*          ******    *****
     C*
     C*****************************************************************
     C*                 EA-INPUT-PROCESSING                           *
     C*                                                               *
     C*  FUNCTION : TO PERFORM PROCESSING OF THE DETAIL SCREEN &      *
     C*             TO CONTROIL PROCESSING OF A SUBROUTINE TO         *
     C*             VALIDATE ALL THE INPUT FIELDS.                    *
     C*                                                               *
     C*  CALLS :    GAVALD                                            *
     C*             UGTIME                                            *
     C*                                                               *
     C*  CALLED BY: CADETL                                            *
     C*                                                               *
     C*****************************************************************
     C*
     C** Execute detail screen
     C*
     C                     MOVEAERCD,1    SERCD1             -ERR MSGS
     C                     MOVEAERCD,20   SERCD2
     C                     EXSR UGTIME                       -GET TIME
     C                     SETOF                     71
     C                     SETON                     72
     C/COPY WNCPYSRC,FT0030C007
     C*
     C           SBRCA     IFNE *BLANKS
     C           SCNUM     ANDEQ*BLANKS
     C           SPYTP     ANDEQ*BLANKS
     C           SPYST     ANDEQ*BLANKS
     C           SCGRP     ANDEQ*BLANKS
     C                     MOVE 'Y'       WBRKY   1
     C                     ELSE
     C                     MOVE *BLANK    WBRKY
     C                     END
     C*
     C                     WRITE#MSGCTL
     C********** WBRKY     IFEQ 'Y'                                                        AR1092740
     C**********           EXFMTFT0030F1                                                   AR1092740
     C**********           ELSE                                                            AR1092740
     C                     EXFMTFT0030F2
     C**********           END                                                             AR1092740
     C*
     C** Check if function keys 3 or 12 have been pressed
     C*
     C           *INKC     IFEQ '1'
     C           *INKL     OREQ '1'
     C                     GOTO EAEND
     C                     END
     C*
     C** Call subroutine to validate input if not in enquiry or
     C** delete mode
     C*
     C           SACTCD    IFNE 'E'
     C***********SACTCD    ORNE 'D'                                       074808
     C           SACTCD    ANDNE'D'                                       074808
     C                     EXSR GAVALD
     C                     END
     C*
     C** Check for general error
     C*
     C           *IN74     IFEQ '0'
     C           *IN13     ANDEQ'0'
     C           *IN14     ANDEQ'0'
     C           *IN15     ANDEQ'0'
     C                     SETON                       20
     C                     END
     C*
     C*          *****     *****
     C           EAEND     ENDSR
     C*          *****     *****
     C/EJECT
     C           EAINP2    BEGSR
     C*          ******    *****
     C*
     C*****************************************************************
     C*                 EA-INPUT-PROCESSING                           *
     C*                                                               *
     C*  FUNCTION : TO PERFORM PROCESSING OF THE DETAIL SCREEN &      *
     C*             TO CONTROIL PROCESSING OF A SUBROUTINE TO         *
     C*             VALIDATE ALL THE INPUT FIELDS.                    *
     C*                                                               *
     C*  CALLS :    GAVAL2                                            *
     C*             UGTIME                                            *
     C*                                                               *
     C*  CALLED BY: CADETL                                            *
     C*                                                               *
     C*****************************************************************
     C*
     C** Execute detail screen
     C*
     C                     MOVEAERCD,1    SERCD1             -ERR MSGS
     C                     MOVEAERCD,20   SERCD2
     C                     EXSR UGTIME                       -GET TIME
     C                     SETOF                     71
     C                     SETON                     72
     C*
     C                     WRITE#MSGCTL                                   074804
     C                     EXFMTFT0030F3
     C*
     C** Check if function keys 3 or 12 have been pressed
     C*
     C           *INKC     IFEQ '1'
     C           *INKL     OREQ '1'
     C                     GOTO EAEND2
     C                     END
     C*
     C** Call subroutine to validate input if not in enquiry or
     C** delete mode
     C*
     C           SACTCD    IFNE 'E'
     C***********SACTCD    ORNE 'D'                                       074808
     C           SACTCD    ANDNE'D'                                       074808
     C                     EXSR GAVAL2
     C                     END
     C*
     C** Check for general error
     C*
     C           *IN74     IFEQ '0'
     C           *IN04     ANDEQ'0'                                       074804
     C                     SETON                       20
     C                     END
     C*
     C*          *****     *****
     C           EAEND2    ENDSR
     C*          *****     *****
     C/EJECT
     C           EAINP3    BEGSR
     C*          ******    *****
     C*
     C*****************************************************************
     C*                 EA-INPUT-PROCESSING                           *
     C*                                                               *
     C*  FUNCTION : TO PERFORM PROCESSING OF THE DETAIL SCREEN &      *
     C*             TO CONTROIL PROCESSING OF A SUBROUTINE TO         *
     C*             VALIDATE ALL THE INPUT FIELDS.                    *
     C*                                                               *
     C*  CALLS :    GAVAL3                                            *
     C*             UGTIME                                            *
     C*                                                               *
     C*  CALLED BY: CADETL                                            *
     C*                                                               *
     C*****************************************************************
     C*
     C** Execute detail screen
     C*
     C                     MOVEAERCD,1    SERCD1             -ERR MSGS
     C                     MOVEAERCD,20   SERCD2
     C                     EXSR UGTIME                       -GET TIME
     C                     SETOF                     71
     C                     SETON                     72
     C*
     C                     WRITE#MSGCTL                                   074804
     C                     EXFMTFT0030F4
     C*
     C** Check if function keys 3 or 12 have been pressed
     C*
     C           *INKC     IFEQ '1'
     C           *INKL     OREQ '1'
     C                     GOTO EAEND3
     C                     END
     C*
     C** Call subroutine to validate input if not in enquiry or
     C** delete mode
     C*
     C           SACTCD    IFNE 'E'
     C***********SACTCD    ORNE 'D'                                       074808
     C           SACTCD    ANDNE'D'                                       074808
     C                     EXSR GAVAL3
     C                     END
     C*
     C** Check for general error
     C*
     C           *IN74     IFEQ '0'
     C           *IN04     ANDEQ'0'                                       074804
     C                     SETON                       20
     C                     END
     C*
     C*          *****     *****
     C           EAEND3    ENDSR
     C*          *****     *****
     C/EJECT
     C           EAINP4    BEGSR
     C*          ******    *****
     C*
     C*****************************************************************
     C*                 EA-INPUT-PROCESSING                           *
     C*                                                               *
     C*  FUNCTION : TO PERFORM PROCESSING OF THE DETAIL SCREEN &      *
     C*             TO CONTROIL PROCESSING OF A SUBROUTINE TO         *
     C*             VALIDATE ALL THE INPUT FIELDS.                    *
     C*                                                               *
     C*  CALLS :    GAVAL4                                            *
     C*             UGTIME                                            *
     C*                                                               *
     C*  CALLED BY: CADETL                                            *
     C*                                                               *
     C*****************************************************************
     C*
     C** Execute detail screen
     C*
     C                     MOVEAERCD,1    SERCD1             -ERR MSGS
     C                     MOVEAERCD,20   SERCD2
     C                     EXSR UGTIME                       -GET TIME
     C                     SETOF                     71
     C                     SETON                     72
     C*
     C                     WRITE#MSGCTL                                   074804
     C                     EXFMTFT0030F5
     C*
     C** Check if function keys 3 or 12 have been pressed
     C*
     C           *INKC     IFEQ '1'
     C           *INKL     OREQ '1'
     C                     GOTO EAEND4
     C                     END
     C*
     C** Call subroutine to validate input if not in enquiry or
     C** delete mode
     C*
     C           SACTCD    IFNE 'E'
     C***********SACTCD    ORNE 'D'                                       074808
     C           SACTCD    ANDNE'D'                                       074808
     C                     EXSR GAVAL4
     C                     END
     C*
     C** Check for general error
     C*
     C           *IN74     IFEQ '0'
     C           *IN04     ANDEQ'0'                                       074804
     C                     SETON                       20
     C                     END
     C*
     C*          *****     *****
     C           EAEND4    ENDSR
     C*          *****     *****
     C/EJECT
     C*          *****     *****
     C           EAINP5    BEGSR
     C*          ******    *****
     C*
     C*****************************************************************
     C*                 EA-INPUT-PROCESSING                           *
     C*                                                               *
     C*  FUNCTION : TO PERFORM PROCESSING OF THE DETAIL SCREEN &      *
     C*             TO CONTROIL PROCESSING OF A SUBROUTINE TO         *
     C*             VALIDATE ALL THE INPUT FIELDS.                    *
     C*                                                               *
     C*  CALLS :    GAVAL5                                            *
     C*             UGTIME                                            *
     C*                                                               *
     C*  CALLED BY: CADETL                                            *
     C*                                                               *
     C*****************************************************************
     C*
     C** Execute detail screen
     C*
     C                     MOVEAERCD,1    SERCD1             -ERR MSGS
     C                     MOVEAERCD,20   SERCD2
     C                     EXSR UGTIME                       -GET TIME
     C                     SETOF                     71
     C                     SETON                     72
     C*
     C                     WRITE#MSGCTL                                   074804
     C                     EXFMTFT0030F6
     C*
     C** Check if function keys 3 or 12 have been pressed
     C*
     C           *INKC     IFEQ '1'
     C           *INKL     OREQ '1'
     C                     GOTO EAEND5
     C                     END
     C*
     C** Call subroutine to validate input if not in enquiry or
     C** delete mode
     C*
     C           SACTCD    IFNE 'E'
     C***********SACTCD    ORNE 'D'                                       074808
     C           SACTCD    ANDNE'D'                                       074808
     C                     EXSR GAVAL5
     C                     END
     C*
     C** Check for general error indicator
     C*
     C           *IN74     IFEQ '0'
     C           *IN04     ANDEQ'0'                                       074804
     C                     SETON                       20
     C                     END
     C*
     C*          *****     *****
     C           EAEND5    ENDSR
     C*          *****     *****
     C/EJECT
     C           ECINST    BEGSR
     C*          ******    *****
     C*
     C*****************************************************************
     C*                 EC-INSERT-PROCESSING                          *
     C*                                                               *
     C*  FUNCTION : TO PERFORM PROCESSING REQUIRED TO UPDATE FILES    *
     C*             ETC. WHEN DETAILS OF PAYMENT CHARGES ARE          *
     C*             INSERTED.                                         *
     C*                                                               *
     C*  CALLS :    GCSTUP                                            *
     C*             UEABRT                                            *
     C*                                                               *
     C*  CALLED BY: CADETL                                            *
     C*                                                               *
     C*****************************************************************
     C*
     C** Check that the record does not exist in PYCHGDD
     C*
     C                     MOVE 'Y'       WUPDF
     C*******              MOVELSCNUM     WCNUM                           102623
     C                     MOVELBBCUST    WCNUM                           102623
      *                                                                                       210873
      * If customer not entered then zero                                                     210873
      *                                                                                       210873
     C           SCNUM     IFEQ *BLANKS                                                       210873
     C**********           Z-ADD0         WCNUM                                        210873 CSD027
     C                     MOVE *BLANKS   WCNUM                                               CSD027
     C                     ELSE                                                               210873
     C                     MOVELSCNUM     WCNUM                                               210873
     C                     ENDIF                                                              210873
     C                     EXSR UCPCCN
     C*
     C** Setup fields for payment charges record
     C*
     C                     EXSR GCSTUP
     C*
     C** If record still does not exist write it, else update it
     C*
     C           *IN89     IFEQ '1'
     C                     WRITEPYCHGDDF               89
     C                     ELSE
     C                     UPDATPYCHGDDF               89
     C                     END
     C*
     C** Check for error on write
     C*
     C           *IN89     IFEQ '1'
     C                     SETOF                     2072
     C                     SETON                     7471
     C                     MOVE '068'     ERCD,1
     C                     MOVE *BLANKS   SACTCD
     C                     END
     C                     MOVE TIME      TIMEX
     C                     MOVEL'FT'      MDID
     C                     MOVEL'FT0030'  PGMN
     C                     MOVELWSID      WSIDX
     C                     MOVELSACTCD    ACTCDX
     C                     MOVELUSRID     USRIDX
     C           CMTTXT    COMIT
     C*
     C*          *****     *****
     C           ECEND     ENDSR
     C*          *****     *****
     C/EJECT
     C           EEAMND    BEGSR
     C*          ******    *****
     C*
     C*****************************************************************
     C*                 EE-AMEND-PROCESSING                           *
     C*                                                               *
     C*  FUNCTION : TO PERFORM PROCESSING REQUIRED TO UPDATE FILES    *
     C*             WHEN DETAILS OF PAYMENT CHARGES ARE AMENDED.      *
     C*                                                               *
     C*  CALLS :    GCSTUP                                            *
     C*              CPCCN                                            *
     C*             UEABRT                                            *
     C*                                                               *
     C*  CALLED BY: CADETL                                            *
     C*                                                               *
     C*****************************************************************
     C*
     C** Access payments charges record
     C*
     C                     MOVE 'Y'       WUPDF
     C*******              MOVELSCNUM     WCNUM                           102623
     C                     MOVELBBCUST    WCNUM                           102623
      *                                                                                       210873
      * If customer not entered then zero                                                     210873
      *                                                                                       210873
     C           SCNUM     IFEQ *BLANKS                                                       210873
     C**********           Z-ADD0         WCNUM                                        210873 CSD027
     C                     MOVE *BLANKS   WCNUM                                               CSD027
     C                     ELSE                                                               210873
     C                     MOVELSCNUM     WCNUM                                               210873
     C                     ENDIF                                                              210873
     C                     EXSR UCPCCN
     C*
     C** Check if database error occurred
     C*
     C           *IN89     IFEQ '1'
     C                     MOVEL'PYCHGL0' WDBFIL           ************
     C                     MOVEL*BLANKS   WDBKEY           * DBERR 06 *
     C                     MOVEL'06'      WDBASE           ************
     C                     EXSR UEABRT                     *ABORT PGM*
     C                     END
     C*
     C** Check if data or time stamp is different to that saved
     C** (i.e. has record been updated by another workstation)
     C*
     C           LCD       IFNE SVLCD
     C           LCHT      ORNE SVLCHT
     C                     SETOF                     2072
     C                     SETON                     7174
     C                     MOVE '068'     ERCD,1
     C                     MOVEL*BLANKS   SACTCD
     C                     EXCPTEXPYCH
     C                     GOTO EEEND                      **RLS REC**
     C                     END
     C*
     C** Setup fields for payment charges record
     C*
     C                     EXSR GCSTUP
     C*
     C** Update payment charges record
     C*
     C                     UPDATPYCHGDDF               89
     C*
     C** Check if database error occurred
     C*
     C           *IN89     IFEQ '1'
     C                     MOVEL'PYCHGL0' WDBFIL           ************
     C                     MOVEL*BLANKS   WDBKEY           * DBERR 07 *
     C                     MOVEL'07'      WDBASE           ************
     C                     EXSR UEABRT                     *ABORT PGM*
     C                     END
     C                     MOVE TIME      TIMEX
     C                     MOVEL'FT'      MDID
     C                     MOVEL'FT0030'  PGMN
     C                     MOVELWSID      WSIDX
     C                     MOVELSACTCD    ACTCDX
     C                     MOVELUSRID     USRIDX
     C           CMTTXT    COMIT
     C*
     C*          *****     *****
     C           EEEND     ENDSR
     C*          *****     *****
     C/EJECT
     C           EEDLT     BEGSR
     C*          ******    *****
     C*
     C*****************************************************************
     C*                 EE-DELET-PROCESSING                           *
     C*                                                               *
     C*  FUNCTION : TO PERFORM PROCESSING REQUIRED TO DELETE FILES    *
     C*                                                               *
     C*  CALLED BY: CADETL                                            *
     C*                                                               *
     C*****************************************************************
     C*
     C** Access payments charges record
     C*
     C                     MOVE 'Y'       WUPDF
     C*******              MOVE SCNUM     WCNUM                           102623
     C                     MOVELBBCUST    WCNUM                           102623
      *                                                                                       210873
      * If customer not entered then zero                                                     210873
      *                                                                                       210873
     C           SCNUM     IFEQ *BLANKS                                                       210873
     C**********           Z-ADD0         WCNUM                                        210873 CSD027
     C                     MOVE *BLANKS   WCNUM                                               CSD027
     C                     ELSE                                                               210873
     C                     MOVELSCNUM     WCNUM                                               210873
     C                     ENDIF                                                              210873
     C                     EXSR UCPCCN
     C*
     C** Check if database error occurred
     C*
     C           *IN89     IFEQ '1'
     C                     MOVEL'PYCHGL0' WDBFIL           ************
     C                     MOVEL*BLANKS   WDBKEY           * DBERR 06 *
     C                     MOVEL'06'      WDBASE           ************
     C                     EXSR UEABRT                     *ABORT PGM*
     C                     END
     C*
     C** Mark the record as deleted
     C*
     C                     MOVE '*'       RECI
     C                     MOVE SACTCD    CHTP
     C                     Z-ADDBJRDNB    LCD
     C                     Z-ADDTIME      LCHT
     C                     UPDATPYCHGDDF               89
     C*
     C** Check if database error occurred
     C*
     C           *IN89     IFEQ '1'
     C                     MOVEL'PYCHGL0' WDBFIL           ************
     C                     MOVEL*BLANKS   WDBKEY           * DBERR 07 *
     C                     MOVEL'07'      WDBASE           ************
     C                     EXSR UEABRT                     *ABORT PGM*
     C                     END
     C                     MOVE TIME      TIMEX
     C                     MOVEL'FT'      MDID
     C                     MOVEL'FT0030'  PGMN
     C                     MOVELWSID      WSIDX
     C                     MOVELSACTCD    ACTCDX
     C                     MOVELUSRID     USRIDX
     C           CMTTXT    COMIT
     C*
     C*          ******    *****
     C           EEDLT1    ENDSR
     C*          ******    *****
     C/EJECT
     C           GAVALD    BEGSR
     C*          ******    *****
     C*
     C*****************************************************************
     C*                 GA-VALIDATE-DETAIL-INPUT                      *
     C*                                                               *
     C*  FUNCTION : TO PERFORM VALIDATION OF ALL DETAIL FIELDS        *
     C*             ENTERED,SETON APPROPRIATE INDICATORS AND SETUP    *
     C*             THE ARRAY OF APPROPRIATE ERROR CODES FOR DISPLAY. *
     C*                                                               *
     C*  CALLS :    ZALIGN                                            *
     C*                                                               *
     C*  CALLED BY: EAINPT                                            *
     C*                                                               *
     C*****************************************************************
     C*
     C** Clears message subfile, error indicators and error codes
     C*
     C                     EXSR SRCLRM
     C                     MOVE *BLANK    WERRM
     C                     MOVEL*BLANKS   ERCD
     C*
     C                     MOVEA'000'     *IN,13
     C                     MOVEA'00000000'*IN,21
     C                     MOVEA'00000000'*IN,29
     C                     MOVEA'00000000'*IN,40
     C                     MOVEA'00000000'*IN,48
     C                     MOVEA'00000000'*IN,56
     C                     MOVEA'000000'  *IN,64
     C                     MOVEA*ZERO     *IN,74
     C*
     C*****************************************************
     C** VALIDATE DEFAULT COMMISSION RATE                **
     C*****************************************************
     C** Validation done only when the branch is the only key entered
     C** Field must be in the range 1 - 5
     C*
     C           WBRKY     IFEQ 'Y'
     C           SDFTCR    IFLT '1'
     C           SDFTCR    ORGT '5'
     C                     SETON                     13
     C                     MOVEL'FTM2531' ZAMSID
     C                     EXSR SRSNDM
     C                     END
     C                     END
     C*
     C*****************************************************
     C** VALIDATE TARIFF 1                               **
     C*****************************************************
     C** Validation done only when the branch is the only key entered
     C** Field must not be blank, if branch is the only key field
     C*
     C           WBRKY     IFEQ 'Y'
     C           *BLANK    IFEQ STNR1
     C                     SETON                     15
     C                     MOVEL'FTM2532' ZAMSID
     C                     EXSR SRSNDM
     C                     END
     C                     END
     C*
     C*****************************************************
     C** VALIDATE TARIFF 2                               **
     C*****************************************************
     C** Field must not be blank, if branch is the only key entered
     C*
     C           WBRKY     IFEQ 'Y'
     C           *BLANK    IFEQ STNR2
     C                     SETON                     14
     C                     MOVEL'FTM2533' ZAMSID
     C                     EXSR SRSNDM
     C                     END
     C                     END
     C*
     C*****************************************************
     C** VALIDATE TARIFF 5                               **
     C*****************************************************
     C** Field must not be blank,
     C*
     C           *BLANK    IFEQ STNR5
     C                     SETON                     84
     C                     END
     C*
     C** If range 2 start was not entered, none of the subsequent
     C** RES. TO RES. end & Rate fields may be either
     C*
     C           WRRS2     IFEQ *ZERO
     C           WRRE2     IFNE *ZERO
     C           WRRR2     ORNE *ZERO
     C                     SETON                     5632
     C                     END
     C                     END
     C*
     C************************************************
     C** VALIDATE NON-RESIDENT TO NON-RESIDENT RATE **
     C************************************************
     C** Field must be 13-long numeric with upto 8 D.P.S and upto 5
     C** digits before the decimal point
     C*
     C                     Z-ADD8         ZADEC
     C                     Z-ADD5         ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SNNRT     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WNNRT  138
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     6026
     C                     END
     C*
     C**********************************************************
     C** VALIDATE NON-RESIDENT TO NON-RESIDENT MINIMUM CHARGE **
     C**********************************************************
     C** Field must be 11-long numeric with number of D.P.S dependent
     C** on the base currency
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SNNMN     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WNNMN  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     6121
     C                     END
     C*
     C**********************************************************
     C** VALIDATE NON-RESIDENT TO NON-RESIDENT MAXIMUM CHARGE **
     C**********************************************************
     C** Field must be 11-long numeric with number of D.P.S dependent
     C** on the base currency
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SNNMX     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WNNMX  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     6221
     C                     END
     C*
     C** If entered & numeric, it must be greater than the minimum
     C** charge entered
     C*
     C           *IN61     IFEQ '0'
     C           WNNMX     ANDLEWNNMN
     C           WNNMX     ANDNE*ZERO                                     125636
     C                     SETON                     6230
     C                     END
     C*
     C*****************************************************************
     C** CHECK INTERDEPENDENCIES BETWEEN NON-RES. TO NON-RES. FIELDS **
     C*****************************************************************
     C** If rate was not entered, none of the subsequent
     C** NON-RES. TO NON-RES. fields may be either
     C*
     C           WNNRT     IFEQ *ZERO
     C           WNNMN     IFNE *ZERO
     C           WNNMX     ORNE *ZERO
     C                     SETON                     6033
     C                     END
     C                     END
     C*
     C****************************
     C** VALIDATE CHEQUE CHARGE **
     C****************************
     C** Field must be 11-long numeric with number of D.P.S dependent
     C** on the base currency
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCQCH     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCQCH  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     6321
     C                     END
     C*
     C*********************************
     C** VALIDATE SWIFT PRIORTY CODE **
     C*********************************
     C** Field must be 11-long numeric with number of D.P.S dependent
     C** on the base currency
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SSPCH     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WSPCH  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     6636
     C                     END
     C*
     C**  Setup error code array depending on which indicators have  **
     C**  been set above.                                            **
     C*
     C                     Z-ADD*ZERO     I       30
     C                     MOVEL*BLANKS   ERCD
     C*
     C           *IN21     IFEQ '1'                                       074805
     C                     ADD  1         I                               074805
     C                     MOVE '004'     ERCD,I                          074805
     C                     END                                            074805
     C*
     C           *IN22     IFEQ '1'
     C                     ADD  1         I
     C                     MOVE '005'     ERCD,I
     C                     END
     C*
     C           *IN23     IFEQ '1'
     C                     ADD  1         I
     C                     MOVE '006'     ERCD,I
     C                     END
     C*
     C           *IN24     IFEQ '1'
     C                     ADD  1         I
     C                     MOVE '007'     ERCD,I
     C                     END
     C*
     C           *IN25     IFEQ '1'
     C                     ADD  1         I
     C                     MOVE '008'     ERCD,I
     C                     END
     C*
     C           *IN26     IFEQ '1'
     C                     ADD  1         I
     C                     MOVE '009'     ERCD,I
     C                     END
     C*
     C           *IN27     IFEQ '1'
     C                     ADD  1         I
     C                     MOVE '010'     ERCD,I
     C                     END
     C*
     C           *IN28     IFEQ '1'
     C                     ADD  1         I
     C                     MOVE '011'     ERCD,I
     C                     END
     C*
     C           *IN29     IFEQ '1'
     C                     ADD  1         I
     C                     MOVE '012'     ERCD,I
     C                     END
     C*
     C           *IN30     IFEQ '1'
     C                     ADD  1         I
     C                     MOVE '013'     ERCD,I
     C                     END
     C*
     C           *IN32     IFEQ '1'
     C                     ADD  1         I
     C                     MOVE '015'     ERCD,I
     C                     END
     C*
     C           *IN33     IFEQ '1'
     C                     ADD  1         I
     C                     MOVE '016'     ERCD,I
     C                     END
     C*
     C           *IN36     IFEQ '1'
     C                     ADD  1         I
     C                     MOVE '183'     ERCD,I
     C                     END
      *
     C*
     C           *IN18     IFEQ '1'
     C                     ADD  1         I
     C                     MOVE '377'     ERCD,I
     C                     END
     C*
     C           *IN70     IFEQ '1'
     C                     ADD  1         I
     C                     MOVE '377'     ERCD,I
     C                     END
     C*
     C           *IN84     IFEQ '1'
     C                     ADD  1         I
     C                     MOVE '377'     ERCD,I
     C                     END
     C*
     C** Check if any errors have been found
     C*
     C           I         IFGT *ZERO
     C                     SETON                     74
     C           I         IFGT 19
     C                     SETON                     75
     C                     END
     C                     ELSE
     C           *IN13     IFEQ '0'
     C           *IN14     ANDEQ'0'
     C           *IN15     ANDEQ'0'
     C                     SETON                     20
     C                     END
     C                     END
     C*
     C*          *****     *****
     C           GAEND     ENDSR
     C*          *****     *****
     C/EJECT
     C*          *****     *****
     C           GAVAL2    BEGSR
     C*          ******    *****
     C*
     C*****************************************************************
     C*                 GA-VALIDATE-DETAIL-INPUT                      *
     C*                                                               *
     C*  FUNCTION : TO PERFORM VALIDATION OF ALL DETAIL FIELDS        *
     C*             ENTERED,SETON APPROPRIATE INDICATORS AND SETUP    *
     C*             THE ARRAY OF APPROPRIATE ERROR CODES FOR DISPLAY. *
     C*                                                               *
     C*  CALLS :    ZALIGN                                            *
     C*                                                               *
     C*  CALLED BY: EAINP2                                            *
     C*                                                               *
     C*****************************************************************
     C*
     C** Clears errror indicators and error codes
     C*
     C                     MOVEL*BLANKS   ERCD
     C                     EXSR SRCLRM                                    074804
     C*
     C                     MOVEA'0000'    *IN,01
     C                     MOVEA'00'      *IN,06
     C                     MOVEA'00'      *IN,09
     C                     MOVEA'00000000'*IN,21
     C                     MOVEA'00000000'*IN,29
     C                     MOVEA'000'     *IN,37
     C                     MOVEA'00000000'*IN,40
     C                     MOVEA'00000000'*IN,48
     C                     MOVEA'00000000'*IN,56
     C                     MOVEA'000000'  *IN,64
     C                     MOVEA*ZERO     *IN,74
     C                     MOVEA'00000000'*IN,80
     C                     MOVE '0'       *IN18
     C                     MOVE '0'       *IN70
     C*
     C*****************************************************
     C** VALIDATE TARIFF 3                               **
     C*****************************************************
     C** Field must not be blank
     C*
     C           *BLANK    IFEQ STNR3
     C                     SETON                     18
     C                     END
     C*
     C*****************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 1 START **
     C*****************************************************
     C** Field must be 11-long numeric with number of D.P.S dependent
     C** on the base currency
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRNS1     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRNS1  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     4121
     C                     END
     C*
     C***************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 1 END **
     C***************************************************
     C** Field must be 11-long numeric with number of D.P.S dependent
     C** on the base currency
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRNE1     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRNE1  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     4221
     C                     END
     C*
     C** Field must be entered if range start was
     C*
     C           *IN42     IFEQ '0'
     C           WRNS1     ANDNE*ZERO
     C           WRNE1     ANDEQ*ZERO
     C                     SETON                     4223
     C                     END
     C*
     C** Field must be greater than range start
     C*
     C           *IN41     IFEQ '0'
     C           *IN42     ANDEQ'0'
     C           WRNS1     ANDNE*ZERO
     C           WRNE1     ANDLEWRNS1
     C                     SETON                     4224
     C                     END
     C*
     C****************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 1 RATE **
     C****************************************************
     C** Field must be 13-long numeric with upto 8 D.P.S and upto 5
     C** digits before the decimal point
     C*
     C                     Z-ADD8         ZADEC
     C                     Z-ADD5         ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRNR1     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRNR1  138
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     4326
     C                     END
     C*
     C** FIELD MUST BE ENTERED IF RANGE START WAS
     C*
     C           STR3C     IFEQ '1'                                       093336
     C           *IN43     IFEQ '0'
     C           WRNS1     ANDNE*ZERO
     C           WRNR1     ANDEQ*ZERO
     C                     SETON                     4325
     C                     END
     C                     END                                            093336
     C*
     C*****************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 2 START **
     C*****************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRNS2     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRNS2  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     4421
     C                     END
     C*
     C** IF NUMERIC, IT MUST EQUAL RANGE 1 END + SMALLEST UNIT OF
     C** BASE CURRENCY POSSIBLE
     C*
     C           *IN44     IFEQ '0'
     C           *IN43     ANDEQ'0'
     C           WRNE1     ANDNE*ZERO
     C           WRNS2     ANDNE*ZERO
     C           WRNE1     ADD  1         WN11   110
     C           WN11      IFNE WRNS2
     C                     SETON                     4428
     C                     END
     C                     END
     C*
     C***************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 2 END **
     C***************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRNE2     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRNE2  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     4521
     C                     END
     C*
     C** FIELD MUST BE ENTERED IF RANGE START WAS
     C*
     C           *IN45     IFEQ '0'
     C           WRNS2     ANDNE*ZERO
     C           WRNE2     ANDEQ*ZERO
     C                     SETON                     4523
     C                     END
     C*
     C** FIELD MUST BE GREATER THAN RANGE START
     C*
     C           *IN44     IFEQ '0'
     C           *IN45     ANDEQ'0'
     C           WRNS2     ANDNE*ZERO
     C           WRNE2     ANDLEWRNS2
     C                     SETON                     4524
     C                     END
     C*
     C****************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 2 RATE **
     C****************************************************
     C** FIELD MUST BE 13-LONG NUMERIC WITH UPTO 8 D.P.S AND UPTO 5
     C** DIGITS BEFORE THE DECIMAL POINT
     C*
     C                     Z-ADD8         ZADEC
     C                     Z-ADD5         ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRNR2     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRNR2  138
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     4626
     C                     END
     C*
     C** FIELD MUST BE ENTERED IF RANGE START WAS
     C*
     C           STR3C     IFEQ '1'                                       093336
     C           *IN46     IFEQ '0'
     C           WRNS2     ANDNE*ZERO
     C           WRNR2     ANDEQ*ZERO
     C                     SETON                     4625
     C                     END
     C                     END                                            093336
     C*
     C******************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT MINIMUM CHARGE **
     C******************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRNMN     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRNMN  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     4721
     C                     END
     C*
     C********************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT 2 MINIMUM CHARGE **
     C********************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRNMN2    ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRNMN2 110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     7621
     C                     END
     C*
     C********************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT 3 MINIMUM CHARGE **
     C********************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRNMN3    ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRNMN3 110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     7721
     C                     END
     C*
     C********************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT 4 MINIMUM CHARGE **
     C********************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRNMN4    ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRNMN4 110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     8021
     C                     END
     C*
     C********************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT 5 MINIMUM CHARGE **
     C********************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRNMN5    ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRNMN5 110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     8121
     C                     END
     C*
     C********************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT 6 MINIMUM CHARGE **
     C********************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRNMN6    ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRNMN6 110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     8221
     C                     END
     C*
     C********************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT 7 MINIMUM CHARGE **
     C********************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRNMN7    ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRNMN7 110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     8321
     C                     END
     C*
     C********************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT 8 MINIMUM CHARGE **
     C********************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRNMN8    ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRNMN8 110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     8421
     C                     END
     C*
     C********************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT 9 MINIMUM CHARGE **
     C********************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRNMN9    ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRNMN9 110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     8521
     C                     END
     C*
     C********************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT 10 MINIMUM CHARGE **
     C********************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRNMN0    ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRNMN0 110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     3121
     C                     END
     C*
     C*****************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 3 START **
     C*****************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRNS3     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRNS3  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     4821
     C                     END
     C*
     C** IF NUMERIC, IT MUST EQUAL RANGE 2 END + SMALLEST UNIT OF
     C** BASE CURRENCY POSSIBLE
     C*
     C           *IN48     IFEQ '0'
     C           *IN46     ANDEQ'0'
     C           WRNE2     ANDNE*ZERO
     C           WRNS3     ANDNE*ZERO
     C           WRNE2     ADD  1         WN11
     C           WN11      IFNE WRNS3
     C                     SETON                     4828
     C                     END
     C                     END
     C*
     C***************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 3 END **
     C***************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRNE3     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRNE3  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     4921
     C                     END
     C*
     C** FIELD MUST BE ENTERED IF RANGE START WAS
     C*
     C           *IN49     IFEQ '0'
     C           WRNS3     ANDNE*ZERO
     C           WRNE3     ANDEQ*ZERO
     C***********          SETON                     4928                 074804
     C                     SETON                     4923                 074804
     C                     END
     C*
     C** FIELD MUST BE GREATER THAN RANGE START
     C*
     C           *IN48     IFEQ '0'
     C           *IN49     ANDEQ'0'
     C           WRNS3     ANDNE*ZERO
     C           WRNE3     ANDLEWRNS3
     C                     SETON                     4924
     C                     END
     C*
     C****************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 3 RATE **
     C****************************************************
     C** FIELD MUST BE 13-LONG NUMERIC WITH UPTO 8 D.P.S AND UPTO 5
     C** DIGITS BEFORE THE DECIMAL POINT
     C*
     C                     Z-ADD8         ZADEC
     C                     Z-ADD5         ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRNR3     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRNR3  138
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     5026
     C                     END
     C*
     C** FIELD MUST BE ENTERED IF RANGE START WAS
     C*
     C           STR3C     IFEQ '1'                                       093336
     C           *IN50     IFEQ '0'
     C           WRNS3     ANDNE*ZERO
     C           WRNR3     ANDEQ*ZERO
     C                     SETON                     5025
     C                     END
     C                     END                                            093336
     C*
     C*
     C*****************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 4 START **
     C*****************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRNS4     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRNS4  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     5221
     C                     END
     C*
     C** IF NUMERIC, IT MUST EQUAL RANGE 2 END + SMALLEST UNIT OF
     C** BASE CURRENCY POSSIBLE
     C*
     C           *IN52     IFEQ '0'
     C           *IN50     ANDEQ'0'
     C           WRNE3     ANDNE*ZERO
     C           WRNS4     ANDNE*ZERO
     C           WRNE3     ADD  1         WN11
     C           WN11      IFNE WRNS4
     C                     SETON                     5228
     C                     END
     C                     END
     C*
     C***************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 4 END **
     C***************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRNE4     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRNE4  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     5321
     C                     END
     C*
     C** FIELD MUST BE ENTERED IF RANGE START WAS
     C*
     C           *IN53     IFEQ '0'
     C           WRNS4     ANDNE*ZERO
     C           WRNE4     ANDEQ*ZERO
     C***********          SETON                     5328                 074804
     C                     SETON                     5323                 074804
     C                     END
     C*
     C** FIELD MUST BE GREATER THAN RANGE START
     C*
     C           *IN53     IFEQ '0'
     C           *IN52     ANDEQ'0'
     C           WRNS4     ANDNE*ZERO
     C           WRNE4     ANDLEWRNS4
     C                     SETON                     5324
     C                     END
     C*
     C****************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 4 RATE **
     C****************************************************
     C** FIELD MUST BE 13-LONG NUMERIC WITH UPTO 8 D.P.S AND UPTO 5
     C** DIGITS BEFORE THE DECIMAL POINT
     C*
     C                     Z-ADD8         ZADEC
     C                     Z-ADD5         ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRNR4     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRNR4  138
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     5426
     C                     END
     C*
     C** FIELD MUST BE ENTERED IF RANGE START WAS
     C*
     C           STR3C     IFEQ '1'                                       093336
     C           *IN54     IFEQ '0'
     C           WRNS4     ANDNE*ZERO
     C           WRNR4     ANDEQ*ZERO
     C                     SETON                     5425
     C                     END
     C                     END                                            093336
     C*
     C*
     C*****************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 5 START **
     C*****************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRNS5     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRNS5  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     5521
     C                     END
     C*
     C** IF NUMERIC, IT MUST EQUAL RANGE 2 END + SMALLEST UNIT OF
     C** BASE CURRENCY POSSIBLE
     C*
     C           *IN55     IFEQ '0'
     C           *IN54     ANDEQ'0'
     C           WRNE4     ANDNE*ZERO
     C           WRNS5     ANDNE*ZERO
     C           WRNE4     ADD  1         WN11
     C           WN11      IFNE WRNS5
     C                     SETON                     5528
     C                     END
     C                     END
     C*
     C***************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 5 END **
     C***************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRNE5     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRNE5  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     5621
     C                     END
     C*
     C** FIELD MUST BE ENTERED IF RANGE START WAS
     C*
     C           *IN56     IFEQ '0'
     C           WRNS5     ANDNE*ZERO
     C           WRNE5     ANDEQ*ZERO
     C***********          SETON                     5628                 074804
     C                     SETON                     5623                 074804
     C                     END
     C*
     C** FIELD MUST BE GREATER THAN RANGE START
     C*
     C           *IN55     IFEQ '0'
     C           *IN56     ANDEQ'0'
     C           WRNS5     ANDNE*ZERO
     C           WRNE5     ANDLEWRNS5
     C                     SETON                     5624
     C                     END
     C*
     C****************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 5 RATE **
     C****************************************************
     C** FIELD MUST BE 13-LONG NUMERIC WITH UPTO 8 D.P.S AND UPTO 5
     C** DIGITS BEFORE THE DECIMAL POINT
     C*
     C                     Z-ADD8         ZADEC
     C                     Z-ADD5         ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRNR5     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRNR5  138
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     5726
     C                     END
     C*
     C** FIELD MUST BE ENTERED IF RANGE START WAS
     C*
     C           STR3C     IFEQ '1'                                       093336
     C           *IN57     IFEQ '0'
     C           WRNS5     ANDNE*ZERO
     C           WRNR5     ANDEQ*ZERO
     C                     SETON                     5725
     C                     END
     C                     END                                            093336
     C*
     C*
     C*****************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 6 START **
     C*****************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRNS6     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRNS6  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     5821
     C                     END
     C*
     C** IF NUMERIC, IT MUST EQUAL RANGE 2 END + SMALLEST UNIT OF
     C** BASE CURRENCY POSSIBLE
     C*
     C           *IN57     IFEQ '0'
     C           *IN58     ANDEQ'0'
     C           WRNE5     ANDNE*ZERO
     C           WRNS6     ANDNE*ZERO
     C           WRNE5     ADD  1         WN11
     C           WN11      IFNE WRNS6
     C                     SETON                     5828
     C                     END
     C                     END
     C*
     C***************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 6 END **
     C***************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRNE6     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRNE6  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     5921
     C                     END
     C*
     C** FIELD MUST BE ENTERED IF RANGE START WAS
     C*
     C           *IN59     IFEQ '0'
     C           WRNS6     ANDNE*ZERO
     C           WRNE6     ANDEQ*ZERO
     C***********          SETON                     5928                 074804
     C                     SETON                     5923                 074804
     C                     END
     C*
     C** FIELD MUST BE GREATER THAN RANGE START
     C*
     C           *IN58     IFEQ '0'
     C           *IN59     ANDEQ'0'
     C           WRNS6     ANDNE*ZERO
     C           WRNE6     ANDLEWRNS6
     C                     SETON                     5924
     C                     END
     C*
     C****************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 6 RATE **
     C****************************************************
     C** FIELD MUST BE 13-LONG NUMERIC WITH UPTO 8 D.P.S AND UPTO 5
     C** DIGITS BEFORE THE DECIMAL POINT
     C*
     C                     Z-ADD8         ZADEC
     C                     Z-ADD5         ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRNR6     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRNR6  138
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     6026
     C                     END
     C*
     C** FIELD MUST BE ENTERED IF RANGE START WAS
     C*
     C           STR3C     IFEQ '1'                                       093336
     C           *IN60     IFEQ '0'
     C           WRNS6     ANDNE*ZERO
     C           WRNR6     ANDEQ*ZERO
     C                     SETON                     6025
     C                     END
     C                     END                                            093336
     C*
     C*
     C*****************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 7 START **
     C*****************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRNS7     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRNS7  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     6121
     C                     END
     C*
     C** IF NUMERIC, IT MUST EQUAL RANGE 2 END + SMALLEST UNIT OF
     C** BASE CURRENCY POSSIBLE
     C*
     C           *IN60     IFEQ '0'
     C           *IN61     ANDEQ'0'
     C           WRNE6     ANDNE*ZERO
     C           WRNS7     ANDNE*ZERO
     C           WRNE6     ADD  1         WN11
     C           WN11      IFNE WRNS7
     C                     SETON                     6128
     C                     END
     C                     END
     C*
     C***************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 7 END **
     C***************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRNE7     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRNE7  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     6221
     C                     END
     C*
     C** FIELD MUST BE ENTERED IF RANGE START WAS
     C*
     C           *IN62     IFEQ '0'
     C           WRNS7     ANDNE*ZERO
     C           WRNE7     ANDEQ*ZERO
     C***********          SETON                     6228                 074804
     C                     SETON                     6223                 074804
     C                     END
     C*
     C** FIELD MUST BE GREATER THAN RANGE START
     C*
     C           *IN61     IFEQ '0'
     C           *IN62     ANDEQ'0'
     C           WRNS7     ANDNE*ZERO
     C           WRNE7     ANDLEWRNS7
     C                     SETON                     6224
     C                     END
     C*
     C****************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 7 RATE **
     C****************************************************
     C** FIELD MUST BE 13-LONG NUMERIC WITH UPTO 8 D.P.S AND UPTO 5
     C** DIGITS BEFORE THE DECIMAL POINT
     C*
     C                     Z-ADD8         ZADEC
     C                     Z-ADD5         ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRNR7     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRNR7  138
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     6326
     C                     END
     C*
     C** FIELD MUST BE ENTERED IF RANGE START WAS
     C*
     C           STR3C     IFEQ '1'                                       093336
     C           *IN63     IFEQ '0'
     C           WRNS7     ANDNE*ZERO
     C           WRNR7     ANDEQ*ZERO
     C                     SETON                     6325
     C                     END
     C                     END                                            093336
     C*
     C*
     C*****************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 8 START **
     C*****************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRNS8     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRNS8  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     6421
     C                     END
     C*
     C** IF NUMERIC, IT MUST EQUAL RANGE 2 END + SMALLEST UNIT OF
     C** BASE CURRENCY POSSIBLE
     C*
     C           *IN63     IFEQ '0'
     C           *IN64     ANDEQ'0'
     C           WRNE7     ANDNE*ZERO
     C           WRNS8     ANDNE*ZERO
     C           WRNE7     ADD  1         WN11
     C           WN11      IFNE WRNS8
     C                     SETON                     6428
     C                     END
     C                     END
     C*
     C***************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 8 END **
     C***************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRNE8     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRNE8  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     6521
     C                     END
     C*
     C** FIELD MUST BE ENTERED IF RANGE START WAS
     C*
     C           *IN65     IFEQ '0'
     C           WRNS8     ANDNE*ZERO
     C           WRNE8     ANDEQ*ZERO
     C***********          SETON                     6528                 074804
     C                     SETON                     6523                 074804
     C                     END
     C*
     C** FIELD MUST BE GREATER THAN RANGE START
     C*
     C           *IN64     IFEQ '0'
     C           *IN65     ANDEQ'0'
     C           WRNS8     ANDNE*ZERO
     C           WRNE8     ANDLEWRNS8
     C                     SETON                     6524
     C                     END
     C*
     C****************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 8 RATE **
     C****************************************************
     C** FIELD MUST BE 13-LONG NUMERIC WITH UPTO 8 D.P.S AND UPTO 5
     C** DIGITS BEFORE THE DECIMAL POINT
     C*
     C                     Z-ADD8         ZADEC
     C                     Z-ADD5         ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRNR8     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRNR8  138
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     6626
     C                     END
     C*
     C** FIELD MUST BE ENTERED IF RANGE START WAS
     C*
     C           STR3C     IFEQ '1'                                       093336
     C           *IN66     IFEQ '0'
     C           WRNS8     ANDNE*ZERO
     C           WRNR8     ANDEQ*ZERO
     C                     SETON                     6625
     C                     END
     C                     END                                            093336
     C*
     C*
     C*****************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 9 START **
     C*****************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRNS9     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRNS9  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     6721
     C                     END
     C*
     C** IF NUMERIC, IT MUST EQUAL RANGE 2 END + SMALLEST UNIT OF
     C** BASE CURRENCY POSSIBLE
     C*
     C           *IN66     IFEQ '0'
     C           *IN67     ANDEQ'0'
     C           WRNE8     ANDNE*ZERO
     C           WRNS9     ANDNE*ZERO
     C           WRNE8     ADD  1         WN11
     C           WN11      IFNE WRNS9
     C                     SETON                     6728
     C                     END
     C                     END
     C*
     C***************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 9 END **
     C***************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRNE9     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRNE9  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     6821
     C                     END
     C*
     C** FIELD MUST BE ENTERED IF RANGE START WAS
     C*
     C           *IN68     IFEQ '0'
     C           WRNS9     ANDNE*ZERO
     C           WRNE9     ANDEQ*ZERO
     C***********          SETON                     6828                 074804
     C                     SETON                     6823                 074804
     C                     END
     C*
     C** FIELD MUST BE GREATER THAN RANGE START
     C*
     C           *IN67     IFEQ '0'
     C           *IN68     ANDEQ'0'
     C           WRNS9     ANDNE*ZERO
     C           WRNE9     ANDLEWRNS9
     C                     SETON                     6824
     C                     END
     C*
     C****************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 9 RATE **
     C****************************************************
     C** FIELD MUST BE 13-LONG NUMERIC WITH UPTO 8 D.P.S AND UPTO 5
     C** DIGITS BEFORE THE DECIMAL POINT
     C*
     C                     Z-ADD8         ZADEC
     C                     Z-ADD5         ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRNR9     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRNR9  138
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     6926
     C                     END
     C*
     C** FIELD MUST BE ENTERED IF RANGE START WAS
     C*
     C           STR3C     IFEQ '1'                                       093336
     C           *IN69     IFEQ '0'
     C           WRNS9     ANDNE*ZERO
     C           WRNR9     ANDEQ*ZERO
     C                     SETON                     6925
     C                     END
     C                     END                                            093336
     C*
     C*****************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 10 START **
     C*****************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRNS0     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRNS0  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     0121
     C                     END
     C*
     C** IF NUMERIC, IT MUST EQUAL RANGE 2 END + SMALLEST UNIT OF
     C** BASE CURRENCY POSSIBLE
     C*
     C           *IN69     IFEQ '0'
     C           *IN01     ANDEQ'0'
     C           WRNE9     ANDNE*ZERO
     C           WRNS0     ANDNE*ZERO
     C           WRNE9     ADD  1         WN11
     C           WN11      IFNE WRNS0
     C                     SETON                     0128
     C                     END
     C                     END
     C*
     C***************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 10 END **
     C***************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRNE0     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRNE0  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     0221
     C                     END
     C*
     C** FIELD MUST BE ENTERED IF RANGE START WAS
     C*
     C           *IN02     IFEQ '0'
     C           WRNS0     ANDNE*ZERO
     C           WRNE0     ANDEQ*ZERO
     C***********          SETON                     0226
     C                     SETON                     0223
     C                     END
     C*
     C** FIELD MUST BE GREATER THAN RANGE START
     C*
     C           *IN01     IFEQ '0'
     C           *IN02     ANDEQ'0'
     C           WRNS0     ANDNE*ZERO
     C           WRNE0     ANDLEWRNS0
     C                     SETON                     0224
     C                     END
     C*
     C****************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 10 RATE **
     C****************************************************
     C** FIELD MUST BE 13-LONG NUMERIC WITH UPTO 8 D.P.S AND UPTO 5
     C** DIGITS BEFORE THE DECIMAL POINT
     C*
     C                     Z-ADD8         ZADEC
     C                     Z-ADD5         ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRNR0     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRNR0  138
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     0326
     C                     END
     C*
     C** FIELD MUST BE ENTERED IF RANGE START WAS
     C*
     C           STR3C     IFEQ '1'                                       093336
     C           *IN03     IFEQ '0'
     C           WRNS0     ANDNE*ZERO
     C           WRNR0     ANDEQ*ZERO
     C                     SETON                     0325
     C                     END
     C                     END                                            093336
     C*
     C******************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT MAXIMUM CHARGE **
     C******************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRNMX     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRNMX  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     5121
     C                     END
     C*
     C** IF ENTERED & NUMERIC,IT MUST BE GREATER THAN THE MINIMUM
     C** CHARGE ENTERED
     C*
     C           *IN47     IFEQ '0'
     C           *IN51     ANDEQ'0'
     C           WRNMX     ANDNE*ZERO
     C           WRNMX     ANDLEWRNMN
     C                     SETON                     5130
     C                     END
     C*
     C********************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT 2 MAXIMUM CHARGE **
     C********************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRNMX2    ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRNMX2 110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     7821
     C                     END
     C*
     C** IF ENTERED & NUMERIC,IT MUST BE GREATER THAN THE MINIMUM
     C** CHARGE ENTERED
     C*
     C           *IN76     IFEQ '0'
     C           *IN78     ANDEQ'0'
     C           WRNMX2    ANDNE*ZERO
     C           WRNMX2    ANDLEWRNMN2
     C                     SETON                     7830
     C                     END
     C*
     C********************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT 3 MAXIMUM CHARGE **
     C********************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRNMX3    ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRNMX3 110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     7921
     C                     END
     C*
     C** IF ENTERED & NUMERIC,IT MUST BE GREATER THAN THE MINIMUM
     C** CHARGE ENTERED
     C*
     C           *IN77     IFEQ '0'
     C           *IN79     ANDEQ'0'
     C           WRNMX3    ANDNE*ZERO
     C           WRNMX3    ANDLEWRNMN3
     C                     SETON                     7930
     C                     END
     C*
     C********************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT 4 MAXIMUM CHARGE **
     C********************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRNMX4    ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRNMX4 110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     0621
     C                     END
     C*
     C** IF ENTERED & NUMERIC,IT MUST BE GREATER THAN THE MINIMUM
     C** CHARGE ENTERED
     C*
     C           *IN80     IFEQ '0'
     C           *IN06     ANDEQ'0'
     C           WRNMX4    ANDNE*ZERO
     C           WRNMX4    ANDLEWRNMN4
     C                     SETON                     0630
     C                     END
     C*
     C********************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT 5 MAXIMUM CHARGE **
     C********************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRNMX5    ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRNMX5 110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     0721
     C                     END
     C*
     C** IF ENTERED & NUMERIC,IT MUST BE GREATER THAN THE MINIMUM
     C** CHARGE ENTERED
     C*
     C           *IN81     IFEQ '0'
     C           *IN07     ANDEQ'0'
     C           WRNMX5    ANDNE*ZERO
     C           WRNMX5    ANDLEWRNMN5
     C                     SETON                     0730
     C                     END
     C*
     C********************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT 6 MAXIMUM CHARGE **
     C********************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRNMX6    ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRNMX6 110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     0921
     C                     END
     C*
     C** IF ENTERED & NUMERIC,IT MUST BE GREATER THAN THE MINIMUM
     C** CHARGE ENTERED
     C*
     C           *IN82     IFEQ '0'
     C           *IN09     ANDEQ'0'
     C           WRNMX6    ANDNE*ZERO
     C           WRNMX6    ANDLEWRNMN6
     C                     SETON                     0930
     C                     END
     C*
     C********************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT 7 MAXIMUM CHARGE **
     C********************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRNMX7    ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRNMX7 110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     3721
     C                     END
     C*
     C** IF ENTERED & NUMERIC,IT MUST BE GREATER THAN THE MINIMUM
     C** CHARGE ENTERED
     C*
     C           *IN83     IFEQ '0'
     C           *IN37     ANDEQ'0'
     C           WRNMX7    ANDNE*ZERO
     C           WRNMX7    ANDLEWRNMN7
     C                     SETON                     3730
     C                     END
     C*
     C********************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT 8 MAXIMUM CHARGE **
     C********************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRNMX8    ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRNMX8 110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     3921
     C                     END
     C*
     C** IF ENTERED & NUMERIC,IT MUST BE GREATER THAN THE MINIMUM
     C** CHARGE ENTERED
     C*
     C           *IN84     IFEQ '0'
     C           *IN39     ANDEQ'0'
     C           WRNMX8    ANDNE*ZERO
     C           WRNMX8    ANDLEWRNMN8
     C                     SETON                     3930
     C                     END
     C*
     C********************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT 9 MAXIMUM CHARGE **
     C********************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRNMX9    ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRNMX9 110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     1021
     C                     END
     C*
     C** IF ENTERED & NUMERIC,IT MUST BE GREATER THAN THE MINIMUM
     C** CHARGE ENTERED
     C*
     C           *IN85     IFEQ '0'
     C           *IN10     ANDEQ'0'
     C           WRNMX9    ANDNE*ZERO
     C           WRNMX9    ANDLEWRNMN9
     C                     SETON                     1030
     C                     END
     C*
     C********************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT 10 MAXIMUM CHARGE **
     C********************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRNMX0    ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRNMX0 110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     3821
     C                     END
     C*
     C** IF ENTERED & NUMERIC,IT MUST BE GREATER THAN THE MINIMUM
     C** CHARGE ENTERED
     C*
     C           *IN31     IFEQ '0'
     C           *IN38     ANDEQ'0'
     C           WRNMX0    ANDNE*ZERO
     C           WRNMX0    ANDLEWRNMN0
     C                     SETON                     3830
     C                     END
     C*
     C*************************************************************
     C** CHECK INTERDEPENDENCIES BETWEEN RES. TO NON-RES. FIELDS **
     C*************************************************************
     C** IF RANGE 1 START WAS NOT ENTERED,NONE OF THE SUBSEQUENT
     C** RES. TO NON-RES. FIELDS MAY BE EITHER
     C*
     C           WRNS1     IFEQ *ZERO
     C           WRNE1     IFNE *ZERO
     C           WRNR1     ORNE *ZERO
     C           WRNS2     ORNE *ZERO
     C           WRNE2     ORNE *ZERO
     C           WRNR2     ORNE *ZERO
     C           WRNMN     ORNE *ZERO
     C           WRNMN2    ORNE *ZERO
     C           WRNMN3    ORNE *ZERO
     C           WRNS3     ORNE *ZERO
     C           WRNE3     ORNE *ZERO
     C           WRNR3     ORNE *ZERO
     C           WRNMX     ORNE *ZERO
     C           WRNMX2    ORNE *ZERO
     C           WRNMX3    ORNE *ZERO
     C           WRNS4     ORNE *ZERO
     C           WRNE4     ORNE *ZERO
     C           WRNR4     ORNE *ZERO
     C           WRNMN4    ORNE *ZERO
     C           WRNMX4    ORNE *ZERO
     C           WRNS5     ORNE *ZERO
     C           WRNE5     ORNE *ZERO
     C           WRNR5     ORNE *ZERO
     C           WRNMN5    ORNE *ZERO
     C           WRNMX5    ORNE *ZERO
     C           WRNS6     ORNE *ZERO
     C           WRNE6     ORNE *ZERO
     C           WRNR6     ORNE *ZERO
     C           WRNMN6    ORNE *ZERO
     C           WRNMX6    ORNE *ZERO
     C           WRNS7     ORNE *ZERO
     C           WRNE7     ORNE *ZERO
     C           WRNR7     ORNE *ZERO
     C           WRNMN7    ORNE *ZERO
     C           WRNMX7    ORNE *ZERO
     C           WRNS8     ORNE *ZERO
     C           WRNE8     ORNE *ZERO
     C           WRNR8     ORNE *ZERO
     C           WRNMN8    ORNE *ZERO
     C           WRNMX8    ORNE *ZERO
     C           WRNS9     ORNE *ZERO
     C           WRNE9     ORNE *ZERO
     C           WRNR9     ORNE *ZERO
     C           WRNMN9    ORNE *ZERO
     C           WRNMX9    ORNE *ZERO
     C           WRNS0     ORNE *ZERO
     C           WRNE0     ORNE *ZERO
     C           WRNR0     ORNE *ZERO
     C           WRNMN0    ORNE *ZERO
     C           WRNMX0    ORNE *ZERO
     C                     SETON                     4122
     C                     END
     C                     END
     C*
     C** IF RANGE 2 START WAS NOT ENTERED,NONE OF THE SUBSEQUENT
     C** RES. TO NON-RES. START,END,RATE FIELDS MAY BE EITHER
     C*
     C           WRNS2     IFEQ *ZERO
     C           WRNE2     IFNE *ZERO
     C           WRNR2     ORNE *ZERO
     C           WRNMN2    ORNE *ZERO                                     074806
     C           WRNMX2    ORNE *ZERO                                     074806
     C           WRNS3     ORNE *ZERO
     C           WRNE3     ORNE *ZERO
     C           WRNR3     ORNE *ZERO
     C           WRNMN3    ORNE *ZERO                                     074806
     C           WRNMX3    ORNE *ZERO                                     074806
     C           WRNS4     ORNE *ZERO
     C           WRNE4     ORNE *ZERO
     C           WRNR4     ORNE *ZERO
     C           WRNMN4    ORNE *ZERO                                     074806
     C           WRNMX4    ORNE *ZERO                                     074806
     C           WRNS5     ORNE *ZERO
     C           WRNE5     ORNE *ZERO
     C           WRNR5     ORNE *ZERO
     C           WRNMN5    ORNE *ZERO                                     074806
     C           WRNMX5    ORNE *ZERO                                     074806
     C           WRNS6     ORNE *ZERO
     C           WRNE6     ORNE *ZERO
     C           WRNR6     ORNE *ZERO
     C           WRNMN6    ORNE *ZERO                                     074806
     C           WRNMX6    ORNE *ZERO                                     074806
     C           WRNS7     ORNE *ZERO
     C           WRNE7     ORNE *ZERO
     C           WRNR7     ORNE *ZERO
     C           WRNMN7    ORNE *ZERO                                     074806
     C           WRNMX7    ORNE *ZERO                                     074806
     C           WRNS8     ORNE *ZERO
     C           WRNE8     ORNE *ZERO
     C           WRNR8     ORNE *ZERO
     C           WRNMN8    ORNE *ZERO                                     074806
     C           WRNMX8    ORNE *ZERO                                     074806
     C           WRNS9     ORNE *ZERO
     C           WRNE9     ORNE *ZERO
     C           WRNR9     ORNE *ZERO
     C           WRNMN9    ORNE *ZERO                                     074806
     C           WRNMX9    ORNE *ZERO                                     074806
     C           WRNS0     ORNE *ZERO
     C           WRNE0     ORNE *ZERO
     C           WRNR0     ORNE *ZERO
     C           WRNMN0    ORNE *ZERO                                     074806
     C           WRNMX0    ORNE *ZERO                                     074806
     C                     SETON                     4427
     C                     END
     C                     END
     C*
     C** IF RANGE 3 START WAS NOT ENTERED,NONE OF THE SUBSEQUENT
     C** RES. TO NON-RES. END & RATE FIELDS MAY BE EITHER
     C*
     C           WRNS3     IFEQ *ZERO
     C           WRNE3     IFNE *ZERO
     C           WRNR3     ORNE *ZERO
     C           WRNMN3    ORNE *ZERO                                     074806
     C           WRNMX3    ORNE *ZERO                                     074806
     C           WRNS4     ORNE *ZERO
     C           WRNE4     ORNE *ZERO
     C           WRNR4     ORNE *ZERO
     C           WRNMN4    ORNE *ZERO                                     074806
     C           WRNMX4    ORNE *ZERO                                     074806
     C           WRNS5     ORNE *ZERO
     C           WRNE5     ORNE *ZERO
     C           WRNR5     ORNE *ZERO
     C           WRNMN5    ORNE *ZERO                                     074806
     C           WRNMX5    ORNE *ZERO                                     074806
     C           WRNS6     ORNE *ZERO
     C           WRNE6     ORNE *ZERO
     C           WRNR6     ORNE *ZERO
     C           WRNMN6    ORNE *ZERO                                     074806
     C           WRNMX6    ORNE *ZERO                                     074806
     C           WRNS7     ORNE *ZERO
     C           WRNE7     ORNE *ZERO
     C           WRNR7     ORNE *ZERO
     C           WRNMN7    ORNE *ZERO                                     074806
     C           WRNMX7    ORNE *ZERO                                     074806
     C           WRNS8     ORNE *ZERO
     C           WRNE8     ORNE *ZERO
     C           WRNR8     ORNE *ZERO
     C           WRNMN8    ORNE *ZERO                                     074806
     C           WRNMX8    ORNE *ZERO                                     074806
     C           WRNS9     ORNE *ZERO
     C           WRNE9     ORNE *ZERO
     C           WRNR9     ORNE *ZERO
     C           WRNMN9    ORNE *ZERO                                     074806
     C           WRNMX9    ORNE *ZERO                                     074806
     C           WRNS0     ORNE *ZERO
     C           WRNE0     ORNE *ZERO
     C           WRNR0     ORNE *ZERO
     C           WRNMN0    ORNE *ZERO                                     074806
     C           WRNMX0    ORNE *ZERO                                     074806
     C                     SETON                     4829
     C                     END
     C                     END
     C*
     C           WRNS4     IFEQ *ZERO
     C           WRNE4     IFNE *ZERO
     C           WRNR4     ORNE *ZERO
     C           WRNMN4    ORNE *ZERO                                     074806
     C           WRNMX4    ORNE *ZERO                                     074806
     C           WRNS5     ORNE *ZERO
     C           WRNE5     ORNE *ZERO
     C           WRNR5     ORNE *ZERO
     C           WRNMN5    ORNE *ZERO                                     074806
     C           WRNMX5    ORNE *ZERO                                     074806
     C           WRNS6     ORNE *ZERO
     C           WRNE6     ORNE *ZERO
     C           WRNR6     ORNE *ZERO
     C           WRNMN6    ORNE *ZERO                                     074806
     C           WRNMX6    ORNE *ZERO                                     074806
     C           WRNS7     ORNE *ZERO
     C           WRNE7     ORNE *ZERO
     C           WRNR7     ORNE *ZERO
     C           WRNMN7    ORNE *ZERO                                     074806
     C           WRNMX7    ORNE *ZERO                                     074806
     C           WRNS8     ORNE *ZERO
     C           WRNE8     ORNE *ZERO
     C           WRNR8     ORNE *ZERO
     C           WRNMN8    ORNE *ZERO                                     074806
     C           WRNMX8    ORNE *ZERO                                     074806
     C           WRNS9     ORNE *ZERO
     C           WRNE9     ORNE *ZERO
     C           WRNR9     ORNE *ZERO
     C           WRNMN9    ORNE *ZERO                                     074806
     C           WRNMX9    ORNE *ZERO                                     074806
     C           WRNS0     ORNE *ZERO
     C           WRNE0     ORNE *ZERO
     C           WRNR0     ORNE *ZERO
     C           WRNMN0    ORNE *ZERO                                     074806
     C           WRNMX0    ORNE *ZERO                                     074806
     C                     SETON                     5229
     C                     END
     C                     END
     C*
     C           WRNS5     IFEQ *ZERO
     C           WRNE5     IFNE *ZERO
     C           WRNR5     ORNE *ZERO
     C           WRNMN5    ORNE *ZERO                                     074806
     C           WRNMX5    ORNE *ZERO                                     074806
     C           WRNS6     ORNE *ZERO
     C           WRNE6     ORNE *ZERO
     C           WRNR6     ORNE *ZERO
     C           WRNMN6    ORNE *ZERO                                     074806
     C           WRNMX6    ORNE *ZERO                                     074806
     C           WRNS7     ORNE *ZERO
     C           WRNE7     ORNE *ZERO
     C           WRNR7     ORNE *ZERO
     C           WRNMN7    ORNE *ZERO                                     074806
     C           WRNMX7    ORNE *ZERO                                     074806
     C           WRNS8     ORNE *ZERO
     C           WRNE8     ORNE *ZERO
     C           WRNR8     ORNE *ZERO
     C           WRNMN8    ORNE *ZERO                                     074806
     C           WRNMX8    ORNE *ZERO                                     074806
     C           WRNS9     ORNE *ZERO
     C           WRNE9     ORNE *ZERO
     C           WRNMN9    ORNE *ZERO                                     074806
     C           WRNMX9    ORNE *ZERO                                     074806
     C           WRNS0     ORNE *ZERO
     C           WRNE0     ORNE *ZERO
     C           WRNR0     ORNE *ZERO
     C           WRNMN0    ORNE *ZERO                                     074806
     C           WRNMX0    ORNE *ZERO                                     074806
     C                     SETON                     5529
     C                     END
     C                     END
     C*
     C           WRNS6     IFEQ *ZERO
     C           WRNE6     IFNE *ZERO
     C           WRNR6     ORNE *ZERO
     C           WRNMN6    ORNE *ZERO                                     074806
     C           WRNMX6    ORNE *ZERO                                     074806
     C           WRNS7     ORNE *ZERO
     C           WRNE7     ORNE *ZERO
     C           WRNR7     ORNE *ZERO
     C           WRNMN7    ORNE *ZERO                                     074806
     C           WRNMX7    ORNE *ZERO                                     074806
     C           WRNS8     ORNE *ZERO
     C           WRNE8     ORNE *ZERO
     C           WRNR8     ORNE *ZERO
     C           WRNMN8    ORNE *ZERO                                     074806
     C           WRNMX8    ORNE *ZERO                                     074806
     C           WRNS9     ORNE *ZERO
     C           WRNE9     ORNE *ZERO
     C           WRNR9     ORNE *ZERO
     C           WRNMN9    ORNE *ZERO                                     074806
     C           WRNMX9    ORNE *ZERO                                     074806
     C           WRNS0     ORNE *ZERO
     C           WRNE0     ORNE *ZERO
     C           WRNR0     ORNE *ZERO
     C           WRNMN0    ORNE *ZERO                                     074806
     C           WRNMX0    ORNE *ZERO                                     074806
     C                     SETON                     5829
     C                     END
     C                     END
     C*
     C           WRNS7     IFEQ *ZERO
     C           WRNE7     IFNE *ZERO
     C           WRNR7     ORNE *ZERO
     C           WRNMN7    ORNE *ZERO                                     074806
     C           WRNMX7    ORNE *ZERO                                     074806
     C           WRNS8     ORNE *ZERO
     C           WRNE8     ORNE *ZERO
     C           WRNR8     ORNE *ZERO
     C           WRNMN8    ORNE *ZERO                                     074806
     C           WRNMX8    ORNE *ZERO                                     074806
     C           WRNS9     ORNE *ZERO
     C           WRNE9     ORNE *ZERO
     C           WRNR9     ORNE *ZERO
     C           WRNMN9    ORNE *ZERO                                     074806
     C           WRNMX9    ORNE *ZERO                                     074806
     C           WRNS0     ORNE *ZERO
     C           WRNE0     ORNE *ZERO
     C           WRNR0     ORNE *ZERO
     C           WRNMN0    ORNE *ZERO                                     074806
     C           WRNMX0    ORNE *ZERO                                     074806
     C                     SETON                     6129
     C                     END
     C                     END
     C*
     C           WRNS8     IFEQ *ZERO
     C           WRNE8     IFNE *ZERO
     C           WRNR8     ORNE *ZERO
     C           WRNMN8    ORNE *ZERO                                     074806
     C           WRNMX8    ORNE *ZERO                                     074806
     C           WRNS9     ORNE *ZERO
     C           WRNE9     ORNE *ZERO
     C           WRNR9     ORNE *ZERO
     C           WRNMN9    ORNE *ZERO                                     074806
     C           WRNMX9    ORNE *ZERO                                     074806
     C           WRNS0     ORNE *ZERO
     C           WRNE0     ORNE *ZERO
     C           WRNR0     ORNE *ZERO
     C           WRNMN0    ORNE *ZERO                                     074806
     C           WRNMX0    ORNE *ZERO                                     074806
     C                     SETON                     6429
     C                     END
     C                     END
     C*
     C           WRNS9     IFEQ *ZERO
     C           WRNE9     IFNE *ZERO
     C           WRNR9     ORNE *ZERO
     C           WRNMN9    ORNE *ZERO                                     074806
     C           WRNMX9    ORNE *ZERO                                     074806
     C           WRNS0     ORNE *ZERO
     C           WRNE0     ORNE *ZERO
     C           WRNR0     ORNE *ZERO
     C           WRNMN0    ORNE *ZERO                                     074806
     C           WRNMX0    ORNE *ZERO                                     074806
     C                     SETON                     6729
     C                     END
     C                     END
     C*
     C           WRNS0     IFEQ *ZERO
     C           WRNE0     IFNE *ZERO
     C           WRNR0     ORNE *ZERO
     C           WRNMN0    ORNE *ZERO                                     074806
     C           WRNMX0    ORNE *ZERO                                     074806
     C                     SETON                     0129
     C                     END
     C                     END
     C*
     C           STR3C     IFEQ '1'
     C           STR3C     OREQ '2'
     C                     ELSE
     C                     SETON                     04
     C                     MOVEL'FTM2537' ZAMSID                          074804
     C                     EXSR SRSNDM                                    074804
     C                     END
     C*
     C*****************************************************************
     C**  SETUP ERROR CODE ARRAY DEPENDING ON WHICH INDICATORS HAVE  **
     C**  BEEN SET ABOVE.                                            **
     C*****************************************************************
     C*
     C                     Z-ADD*ZERO     I       30
     C                     MOVEL*BLANKS   ERCD
     C************                                                        074804
     C************IN04     IFEQ '1'                                       074804
     C***********          ADD  1         I                               074804
     C***********          MOVE '377'     ERCD,I                          074804
     C***********          END                                            074804
     C*
     C           *IN21     IFEQ '1'
     C                     ADD  1         I
     C                     MOVE '004'     ERCD,I
     C                     END
     C*
     C           *IN22     IFEQ '1'
     C                     ADD  1         I
     C                     MOVE '005'     ERCD,I
     C                     END
     C*
     C           *IN23     IFEQ '1'
     C                     ADD  1         I
     C                     MOVE '006'     ERCD,I
     C                     END
     C*
     C           *IN24     IFEQ '1'
     C                     ADD  1         I
     C                     MOVE '007'     ERCD,I
     C                     END
     C*
     C           *IN25     IFEQ '1'
     C                     ADD  1         I
     C                     MOVE '008'     ERCD,I
     C                     END
     C*
     C           *IN26     IFEQ '1'
     C                     ADD  1         I
     C                     MOVE '009'     ERCD,I
     C                     END
     C*
     C           *IN27     IFEQ '1'
     C                     ADD  1         I
     C                     MOVE '010'     ERCD,I
     C                     END
     C*
     C           *IN28     IFEQ '1'
     C                     ADD  1         I
     C                     MOVE '011'     ERCD,I
     C                     END
     C*
     C           *IN29     IFEQ '1'
     C                     ADD  1         I
     C                     MOVE '012'     ERCD,I
     C                     END
     C*
     C           *IN30     IFEQ '1'
     C                     ADD  1         I
     C                     MOVE '013'     ERCD,I
     C                     END
     C*
     C           *IN32     IFEQ '1'
     C                     ADD  1         I
     C                     MOVE '015'     ERCD,I
     C                     END
     C*
     C           *IN33     IFEQ '1'
     C                     ADD  1         I
     C                     MOVE '016'     ERCD,I
     C                     END
     C*
     C           *IN34     IFEQ '1'
     C                     ADD  1         I
     C                     MOVE '017'     ERCD,I
     C                     END
     C*
     C           *IN35     IFEQ '1'
     C                     ADD  1         I
     C                     MOVE '018'     ERCD,I
     C                     END
     C*
     C           *IN36     IFEQ '1'
     C                     ADD  1         I
     C                     MOVE '183'     ERCD,I
     C                     END
     C*
     C************IN67     IFEQ '1'                                       074804
     C***********          ADD  1         I                               074804
     C***********          MOVE '375'     ERCD,I                          074804
     C***********          ADD  1         I                               074804
     C***********          MOVE '376'     ERCD,I                          074804
     C***********          END                                            074804
     C***********                                                         074804
     C************IN68     IFEQ '1'                                       074804
     C***********          ADD  1         I                               074804
     C***********          MOVE '377'     ERCD,I                          074804
     C***********          END                                            074804
     C***********                                                         074804
     C************IN69     IFEQ '1'                                       074804
     C***********          ADD  1         I                               074804
     C***********          MOVE '377'     ERCD,I                          074804
     C***********          END                                            074804
     C*
     C           *IN18     IFEQ '1'
     C                     ADD  1         I
     C                     MOVE '377'     ERCD,I
     C                     END
     C*
     C           *IN70     IFEQ '1'
     C                     ADD  1         I
     C                     MOVE '377'     ERCD,I
     C                     END
     C*
     C************IN84     IFEQ '1'                                       074804
     C***********          ADD  1         I                               074804
     C***********          MOVE '377'     ERCD,I                          074804
     C***********          END                                            074804
     C***********                                                         074804
     C************IN85     IFEQ '1'                                       074804
     C***********          ADD  1         I                               074804
     C***********          MOVE '379'     ERCD,I                          074804
     C***********          END                                            074804
     C***********                                                         074804
     C************IN31     IFEQ '1'                                       074804
     C***********          ADD  1         I                               074804
     C***********          MOVE '381'     ERCD,I                          074804
     C***********          END                                            074804
     C***********                                                         074804
     C************IN06     IFEQ '1'                                       074804
     C***********          ADD  1         I                               074804
     C***********          MOVE '378'     ERCD,I                          074804
     C***********          END                                            074804
     C***********                                                         074804
     C************IN07     IFEQ '1'                                       074804
     C***********          ADD  1         I                               074804
     C***********          MOVE '380'     ERCD,I                          074804
     C***********          END                                            074804
     C*
     C** CHECK IF ANY ERRORS HAVE BEEN FOUND
     C*
     C           I         IFGT *ZERO
     C                     SETON                     74
     C           I         IFGT 19
     C                     SETON                     75
     C                     END
     C                     END
     C*
     C*          *****     *****
     C           GAEND2    ENDSR
     C*          *****     *****
     C/EJECT
     C*
     C           GAVAL3    BEGSR
     C*          ******    *****
     C*
     C*****************************************************************
     C*                 GA-VALIDATE-DETAIL-INPUT                      *
     C*                                                               *
     C*  FUNCTION : TO PERFORM VALIDATION OF ALL DETAIL FIELDS        *
     C*             ENTERED,SETON APPROPRIATE INDICATORS AND SETUP    *
     C*             THE ARRAY OF APPROPRIATE ERROR CODES FOR DISPLAY. *
     C*                                                               *
     C*  CALLS :    ZALIGN                                            *
     C*                                                               *
     C*  CALLED BY: EAINP3                                            *
     C*                                                               *
     C*****************************************************************
     C*
     C** CLEAR ERROR INDICATORS & ERROR CODES ARRAY
     C*
     C                     MOVEL*BLANKS   ERCD
     C                     EXSR SRCLRM                                    074804
     C*
     C                     MOVEA'0000'    *IN,01
     C                     MOVEA'00'      *IN,06
     C                     MOVEA'00'      *IN,09
     C                     MOVEA'00000000'*IN,21
     C                     MOVEA'00000000'*IN,29
     C                     MOVEA'000'     *IN,37
     C                     MOVEA'00000000'*IN,40
     C                     MOVEA'00000000'*IN,48
     C                     MOVEA'00000000'*IN,56
     C                     MOVEA'000000'  *IN,64
     C                     MOVEA*ZERO     *IN,74
     C                     MOVEA'00000000'*IN,80
     C                     MOVE '0'       *IN18
     C                     MOVE '0'       *IN70
     C*
     C*
     C*****************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 1 START **
     C*****************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCNS1     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCNS1  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     4121
     C                     END
     C*
     C***************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 1 END **
     C***************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCNE1     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCNE1  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     4221
     C                     END
     C*
     C** FIELD MUST BE ENTERED IF RANGE START WAS
     C*
     C           *IN42     IFEQ '0'
     C           WCNS1     ANDNE*ZERO
     C           WCNE1     ANDEQ*ZERO
     C                     SETON                     4223
     C                     END
     C*
     C** FIELD MUST BE GREATER THAN RANGE START
     C*
     C           *IN41     IFEQ '0'
     C           *IN42     ANDEQ'0'
     C           WCNS1     ANDNE*ZERO
     C           WCNE1     ANDLEWCNS1
     C                     SETON                     4224
     C                     END
     C*
     C****************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 1 RATE **
     C****************************************************
     C** FIELD MUST BE 13-LONG NUMERIC WITH UPTO 8 D.P.S AND UPTO 5
     C** DIGITS BEFORE THE DECIMAL POINT
     C*
     C                     Z-ADD8         ZADEC
     C                     Z-ADD5         ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCNR1     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCNR1  138
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     4326
     C                     END
     C*
     C** FIELD MUST BE ENTERED IF RANGE START WAS
     C*
     C           SCH3C     IFEQ '1'                                       093336
     C           *IN43     IFEQ '0'
     C           WCNS1     ANDNE*ZERO
     C           WCNR1     ANDEQ*ZERO
     C                     SETON                     4325
     C                     END
     C                     END                                            093336
     C*
     C*****************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 2 START **
     C*****************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCNS2     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCNS2  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     4421
     C                     END
     C*
     C** IF NUMERIC, IT MUST EQUAL RANGE 1 END + SMALLEST UNIT OF
     C** BASE CURRENCY POSSIBLE
     C*
     C           *IN44     IFEQ '0'
     C           *IN43     ANDEQ'0'
     C           WCNE1     ANDNE*ZERO
     C           WCNS2     ANDNE*ZERO
     C           WCNE1     ADD  1         WN11   110
     C           WN11      IFNE WCNS2
     C                     SETON                     4428
     C                     END
     C                     END
     C*
     C***************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 2 END **
     C***************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCNE2     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCNE2  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     4521
     C                     END
     C*
     C** FIELD MUST BE ENTERED IF RANGE START WAS
     C*
     C           *IN45     IFEQ '0'
     C           WCNS2     ANDNE*ZERO
     C           WCNE2     ANDEQ*ZERO
     C                     SETON                     4523
     C                     END
     C*
     C** FIELD MUST BE GREATER THAN RANGE START
     C*
     C           *IN44     IFEQ '0'
     C           *IN45     ANDEQ'0'
     C           WCNS2     ANDNE*ZERO
     C           WCNE2     ANDLEWCNS2
     C                     SETON                     4524
     C                     END
     C*
     C****************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 2 RATE **
     C****************************************************
     C** FIELD MUST BE 13-LONG NUMERIC WITH UPTO 8 D.P.S AND UPTO 5
     C** DIGITS BEFORE THE DECIMAL POINT
     C*
     C                     Z-ADD8         ZADEC
     C                     Z-ADD5         ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCNR2     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCNR2  138
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     4626
     C                     END
     C*
     C** FIELD MUST BE ENTERED IF RANGE START WAS
     C*
     C           SCH3C     IFEQ '1'                                       093336
     C           *IN46     IFEQ '0'
     C           WCNS2     ANDNE*ZERO
     C           WCNR2     ANDEQ*ZERO
     C                     SETON                     4625
     C                     END
     C                     END                                            093336
     C*
     C******************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT MINIMUM CHARGE **
     C******************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCNMN1    ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCNMN1 110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     4721
     C                     END
     C*
     C********************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT 2 MINIMUM CHARGE **
     C********************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCNMN2    ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCNMN2 110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     7621
     C                     END
     C*
     C********************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT 3 MINIMUM CHARGE **
     C********************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCNMN3    ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCNMN3 110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     7721
     C                     END
     C*
     C********************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT 4 MINIMUM CHARGE **
     C********************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCNMN4    ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCNMN4 110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     8021
     C                     END
     C*
     C********************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT 5 MINIMUM CHARGE **
     C********************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCNMN5    ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCNMN5 110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     8121
     C                     END
     C*
     C********************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT 6 MINIMUM CHARGE **
     C********************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCNMN6    ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCNMN6 110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     8221
     C                     END
     C*
     C********************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT 7 MINIMUM CHARGE **
     C********************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCNMN7    ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCNMN7 110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     8321
     C                     END
     C*
     C********************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT 8 MINIMUM CHARGE **
     C********************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCNMN8    ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCNMN8 110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     8421
     C                     END
     C*
     C********************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT 9 MINIMUM CHARGE **
     C********************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCNMN9    ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCNMN9 110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     8521
     C                     END
     C*
     C********************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT 10 MINIMUM CHARGE **
     C********************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCNMN0    ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCNMN0 110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     3121
     C                     END
     C*
     C*****************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 3 START **
     C*****************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCNS3     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCNS3  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     4821
     C                     END
     C*
     C** IF NUMERIC, IT MUST EQUAL RANGE 2 END + SMALLEST UNIT OF
     C** BASE CURRENCY POSSIBLE
     C*
     C           *IN48     IFEQ '0'
     C           *IN46     ANDEQ'0'
     C           WCNE2     ANDNE*ZERO
     C           WCNS3     ANDNE*ZERO
     C           WCNE2     ADD  1         WN11
     C           WN11      IFNE WCNS3
     C                     SETON                     4828
     C                     END
     C                     END
     C*
     C***************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 3 END **
     C***************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCNE3     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCNE3  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     4921
     C                     END
     C*
     C** FIELD MUST BE ENTERED IF RANGE START WAS
     C*
     C           *IN49     IFEQ '0'
     C           WCNS3     ANDNE*ZERO
     C           WCNE3     ANDEQ*ZERO
     C***********          SETON                     4928                 074804
     C                     SETON                     4923                 074804
     C                     END
     C*
     C** FIELD MUST BE GREATER THAN RANGE START
     C*
     C           *IN48     IFEQ '0'
     C           *IN49     ANDEQ'0'
     C           WCNS3     ANDNE*ZERO
     C           WCNE3     ANDLEWCNS3
     C                     SETON                     4924
     C                     END
     C*
     C****************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 3 RATE **
     C****************************************************
     C** FIELD MUST BE 13-LONG NUMERIC WITH UPTO 8 D.P.S AND UPTO 5
     C** DIGITS BEFORE THE DECIMAL POINT
     C*
     C                     Z-ADD8         ZADEC
     C                     Z-ADD5         ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCNR3     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCNR3  138
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     5026
     C                     END
     C*
     C** FIELD MUST BE ENTERED IF RANGE START WAS
     C*
     C           SCH3C     IFEQ '1'                                       093336
     C           *IN50     IFEQ '0'
     C           WCNS3     ANDNE*ZERO
     C           WCNR3     ANDEQ*ZERO
     C                     SETON                     5025
     C                     END
     C                     END                                            093336
     C*
     C*
     C*****************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 4 START **
     C*****************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCNS4     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCNS4  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     5221
     C                     END
     C*
     C** IF NUMERIC, IT MUST EQUAL RANGE 2 END + SMALLEST UNIT OF
     C** BASE CURRENCY POSSIBLE
     C*
     C           *IN52     IFEQ '0'
     C           *IN50     ANDEQ'0'
     C           WCNE3     ANDNE*ZERO
     C           WCNS4     ANDNE*ZERO
     C           WCNE3     ADD  1         WN11
     C           WN11      IFNE WCNS4
     C                     SETON                     5228
     C                     END
     C                     END
     C*
     C***************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 4 END **
     C***************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCNE4     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCNE4  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     5321
     C                     END
     C*
     C** FIELD MUST BE ENTERED IF RANGE START WAS
     C*
     C           *IN53     IFEQ '0'
     C           WCNS4     ANDNE*ZERO
     C           WCNE4     ANDEQ*ZERO
     C***********          SETON                     5328                 074804
     C                     SETON                     5323                 074804
     C                     END
     C*
     C** FIELD MUST BE GREATER THAN RANGE START
     C*
     C           *IN53     IFEQ '0'
     C           *IN52     ANDEQ'0'
     C           WCNS4     ANDNE*ZERO
     C           WCNE4     ANDLEWCNS4
     C                     SETON                     5324
     C                     END
     C*
     C****************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 4 RATE **
     C****************************************************
     C** FIELD MUST BE 13-LONG NUMERIC WITH UPTO 8 D.P.S AND UPTO 5
     C** DIGITS BEFORE THE DECIMAL POINT
     C*
     C                     Z-ADD8         ZADEC
     C                     Z-ADD5         ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCNR4     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCNR4  138
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     5426
     C                     END
     C*
     C** FIELD MUST BE ENTERED IF RANGE START WAS
     C*
     C           SCH3C     IFEQ '1'                                       093336
     C           *IN54     IFEQ '0'
     C           WCNS4     ANDNE*ZERO
     C           WCNR4     ANDEQ*ZERO
     C                     SETON                     5425
     C                     END
     C                     END                                            093336
     C*
     C*
     C*****************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 5 START **
     C*****************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCNS5     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCNS5  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     5521
     C                     END
     C*
     C** IF NUMERIC, IT MUST EQUAL RANGE 2 END + SMALLEST UNIT OF
     C** BASE CURRENCY POSSIBLE
     C*
     C           *IN55     IFEQ '0'
     C           *IN54     ANDEQ'0'
     C           WCNE4     ANDNE*ZERO
     C           WCNS5     ANDNE*ZERO
     C           WCNE4     ADD  1         WN11
     C           WN11      IFNE WCNS5
     C                     SETON                     5528
     C                     END
     C                     END
     C*
     C***************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 5 END **
     C***************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCNE5     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCNE5  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     5621
     C                     END
     C*
     C** FIELD MUST BE ENTERED IF RANGE START WAS
     C*
     C           *IN56     IFEQ '0'
     C           WCNS5     ANDNE*ZERO
     C           WCNE5     ANDEQ*ZERO
     C***********          SETON                     5628                 074804
     C                     SETON                     5623                 074804
     C                     END
     C*
     C** FIELD MUST BE GREATER THAN RANGE START
     C*
     C           *IN55     IFEQ '0'
     C           *IN56     ANDEQ'0'
     C           WCNS5     ANDNE*ZERO
     C           WCNE5     ANDLEWCNS5
     C                     SETON                     5624
     C                     END
     C*
     C****************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 5 RATE **
     C****************************************************
     C** FIELD MUST BE 13-LONG NUMERIC WITH UPTO 8 D.P.S AND UPTO 5
     C** DIGITS BEFORE THE DECIMAL POINT
     C*
     C                     Z-ADD8         ZADEC
     C                     Z-ADD5         ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCNR5     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCNR5  138
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     5726
     C                     END
     C*
     C** FIELD MUST BE ENTERED IF RANGE START WAS
     C*
     C           SCH3C     IFEQ '1'                                       093336
     C           *IN57     IFEQ '0'
     C           WCNS5     ANDNE*ZERO
     C           WCNR5     ANDEQ*ZERO
     C                     SETON                     5725
     C                     END
     C                     END                                            093336
     C*
     C*
     C*****************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 6 START **
     C*****************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCNS6     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCNS6  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     5821
     C                     END
     C*
     C** IF NUMERIC, IT MUST EQUAL RANGE 2 END + SMALLEST UNIT OF
     C** BASE CURRENCY POSSIBLE
     C*
     C           *IN57     IFEQ '0'
     C           *IN58     ANDEQ'0'
     C           WCNE5     ANDNE*ZERO
     C           WCNS6     ANDNE*ZERO
     C           WCNE5     ADD  1         WN11
     C           WN11      IFNE WCNS6
     C                     SETON                     5828
     C                     END
     C                     END
     C*
     C***************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 6 END **
     C***************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCNE6     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCNE6  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     5921
     C                     END
     C*
     C** FIELD MUST BE ENTERED IF RANGE START WAS
     C*
     C           *IN59     IFEQ '0'
     C           WCNS6     ANDNE*ZERO
     C           WCNE6     ANDEQ*ZERO
     C***********          SETON                     5928                 074804
     C                     SETON                     5923                 074804
     C                     END
     C*
     C** FIELD MUST BE GREATER THAN RANGE START
     C*
     C           *IN58     IFEQ '0'
     C           *IN59     ANDEQ'0'
     C           WCNS6     ANDNE*ZERO
     C           WCNE6     ANDLEWCNS6
     C                     SETON                     5924
     C                     END
     C*
     C****************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 6 RATE **
     C****************************************************
     C** FIELD MUST BE 13-LONG NUMERIC WITH UPTO 8 D.P.S AND UPTO 5
     C** DIGITS BEFORE THE DECIMAL POINT
     C*
     C                     Z-ADD8         ZADEC
     C                     Z-ADD5         ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCNR6     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCNR6  138
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     6026
     C                     END
     C*
     C** FIELD MUST BE ENTERED IF RANGE START WAS
     C*
     C           SCH3C     IFEQ '1'                                       093336
     C           *IN60     IFEQ '0'
     C           WCNS6     ANDNE*ZERO
     C           WCNR6     ANDEQ*ZERO
     C                     SETON                     6025
     C                     END
     C                     END                                            093336
     C*
     C*
     C*****************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 7 START **
     C*****************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCNS7     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCNS7  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     6121
     C                     END
     C*
     C** IF NUMERIC, IT MUST EQUAL RANGE 2 END + SMALLEST UNIT OF
     C** BASE CURRENCY POSSIBLE
     C*
     C           *IN60     IFEQ '0'
     C           *IN61     ANDEQ'0'
     C           WCNE6     ANDNE*ZERO
     C           WCNS7     ANDNE*ZERO
     C           WCNE6     ADD  1         WN11
     C           WN11      IFNE WCNS7
     C                     SETON                     6128
     C                     END
     C                     END
     C*
     C***************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 7 END **
     C***************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCNE7     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCNE7  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     6221
     C                     END
     C*
     C** FIELD MUST BE ENTERED IF RANGE START WAS
     C*
     C           *IN62     IFEQ '0'
     C           WCNS7     ANDNE*ZERO
     C           WCNE7     ANDEQ*ZERO
     C***********          SETON                     6228                 074804
     C                     SETON                     6223                 074804
     C                     END
     C*
     C** FIELD MUST BE GREATER THAN RANGE START
     C*
     C           *IN61     IFEQ '0'
     C           *IN62     ANDEQ'0'
     C           WCNS7     ANDNE*ZERO
     C           WCNE7     ANDLEWCNS7
     C                     SETON                     6224
     C                     END
     C*
     C****************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 7 RATE **
     C****************************************************
     C** FIELD MUST BE 13-LONG NUMERIC WITH UPTO 8 D.P.S AND UPTO 5
     C** DIGITS BEFORE THE DECIMAL POINT
     C*
     C                     Z-ADD8         ZADEC
     C                     Z-ADD5         ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCNR7     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCNR7  138
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     6326
     C                     END
     C*
     C** FIELD MUST BE ENTERED IF RANGE START WAS
     C*
     C           SCH3C     IFEQ '1'                                       093336
     C           *IN63     IFEQ '0'
     C           WCNS7     ANDNE*ZERO
     C           WCNR7     ANDEQ*ZERO
     C                     SETON                     6325
     C                     END
     C                     END                                            093336
     C*
     C*
     C*****************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 8 START **
     C*****************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCNS8     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCNS8  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     6421
     C                     END
     C*
     C** IF NUMERIC, IT MUST EQUAL RANGE 2 END + SMALLEST UNIT OF
     C** BASE CURRENCY POSSIBLE
     C*
     C           *IN63     IFEQ '0'
     C           *IN64     ANDEQ'0'
     C           WCNE7     ANDNE*ZERO
     C           WCNS8     ANDNE*ZERO
     C           WCNE7     ADD  1         WN11
     C           WN11      IFNE WCNS8
     C                     SETON                     6428
     C                     END
     C                     END
     C*
     C***************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 8 END **
     C***************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCNE8     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCNE8  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     6521
     C                     END
     C*
     C** FIELD MUST BE ENTERED IF RANGE START WAS
     C*
     C           *IN65     IFEQ '0'
     C           WCNS8     ANDNE*ZERO
     C           WCNE8     ANDEQ*ZERO
     C***********          SETON                     6528                 074804
     C                     SETON                     6523                 074804
     C                     END
     C*
     C** FIELD MUST BE GREATER THAN RANGE START
     C*
     C           *IN64     IFEQ '0'
     C           *IN65     ANDEQ'0'
     C           WCNS8     ANDNE*ZERO
     C           WCNE8     ANDLEWCNS8
     C                     SETON                     6524
     C                     END
     C*
     C****************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 8 RATE **
     C****************************************************
     C** FIELD MUST BE 13-LONG NUMERIC WITH UPTO 8 D.P.S AND UPTO 5
     C** DIGITS BEFORE THE DECIMAL POINT
     C*
     C                     Z-ADD8         ZADEC
     C                     Z-ADD5         ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCNR8     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCNR8  138
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     6626
     C                     END
     C*
     C** FIELD MUST BE ENTERED IF RANGE START WAS
     C*
     C           SCH3C     IFEQ '1'                                       093336
     C           *IN66     IFEQ '0'
     C           WCNS8     ANDNE*ZERO
     C           WCNR8     ANDEQ*ZERO
     C                     SETON                     6625
     C                     END
     C                     END                                            093336
     C*
     C*
     C*****************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 9 START **
     C*****************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCNS9     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCNS9  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     6721
     C                     END
     C*
     C** IF NUMERIC, IT MUST EQUAL RANGE 2 END + SMALLEST UNIT OF
     C** BASE CURRENCY POSSIBLE
     C*
     C           *IN66     IFEQ '0'
     C           *IN67     ANDEQ'0'
     C           WCNE8     ANDNE*ZERO
     C           WCNS9     ANDNE*ZERO
     C           WCNE8     ADD  1         WN11
     C           WN11      IFNE WCNS9
     C                     SETON                     6728
     C                     END
     C                     END
     C*
     C***************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 9 END **
     C***************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCNE9     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCNE9  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     6821
     C                     END
     C*
     C** FIELD MUST BE ENTERED IF RANGE START WAS
     C*
     C           *IN68     IFEQ '0'
     C           WCNS9     ANDNE*ZERO
     C           WCNE9     ANDEQ*ZERO
     C***********          SETON                     6828                 074804
     C                     SETON                     6823                 074804
     C                     END
     C*
     C** FIELD MUST BE GREATER THAN RANGE START
     C*
     C           *IN67     IFEQ '0'
     C           *IN68     ANDEQ'0'
     C           WCNS9     ANDNE*ZERO
     C           WCNE9     ANDLEWCNS9
     C                     SETON                     6824
     C                     END
     C*
     C****************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 9 RATE **
     C****************************************************
     C** FIELD MUST BE 13-LONG NUMERIC WITH UPTO 8 D.P.S AND UPTO 5
     C** DIGITS BEFORE THE DECIMAL POINT
     C*
     C                     Z-ADD8         ZADEC
     C                     Z-ADD5         ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCNR9     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCNR9  138
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     6926
     C                     END
     C*
     C** FIELD MUST BE ENTERED IF RANGE START WAS
     C*
     C           SCH3C     IFEQ '1'                                       093336
     C           *IN69     IFEQ '0'
     C           WCNS9     ANDNE*ZERO
     C           WCNR9     ANDEQ*ZERO
     C                     SETON                     6925
     C                     END
     C                     END                                            093336
     C*
     C*****************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 10 START **
     C*****************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCNS0     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCNS0  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     0121
     C                     END
     C*
     C** IF NUMERIC, IT MUST EQUAL RANGE 2 END + SMALLEST UNIT OF
     C** BASE CURRENCY POSSIBLE
     C*
     C           *IN69     IFEQ '0'
     C           *IN01     ANDEQ'0'
     C           WCNE9     ANDNE*ZERO
     C           WCNS0     ANDNE*ZERO
     C           WCNE9     ADD  1         WN11
     C           WN11      IFNE WCNS0
     C                     SETON                     0128
     C                     END
     C                     END
     C*
     C***************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 10 END **
     C***************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCNE0     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCNE0  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     0221
     C                     END
     C*
     C** FIELD MUST BE ENTERED IF RANGE START WAS
     C*
     C           *IN02     IFEQ '0'
     C           WCNS0     ANDNE*ZERO
     C           WCNE0     ANDEQ*ZERO
     C***********          SETON                     0228                 074804
     C                     SETON                     0223                 074804
     C                     END
     C*
     C** FIELD MUST BE GREATER THAN RANGE START
     C*
     C           *IN01     IFEQ '0'
     C           *IN02     ANDEQ'0'
     C           WCNS0     ANDNE*ZERO
     C           WCNE0     ANDLEWCNS0
     C                     SETON                     0224
     C                     END
     C*
     C****************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 10 RATE **
     C****************************************************
     C** FIELD MUST BE 13-LONG NUMERIC WITH UPTO 8 D.P.S AND UPTO 5
     C** DIGITS BEFORE THE DECIMAL POINT
     C*
     C                     Z-ADD8         ZADEC
     C                     Z-ADD5         ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCNR0     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCNR0  138
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     0326
     C                     END
     C*
     C** FIELD MUST BE ENTERED IF RANGE START WAS
     C*
     C           SCH3C     IFEQ '1'                                       093336
     C           *IN03     IFEQ '0'
     C           WCNS0     ANDNE*ZERO
     C           WCNR0     ANDEQ*ZERO
     C                     SETON                     0325
     C                     END
     C                     END                                            093336
     C*
     C******************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT MAXIMUM CHARGE **
     C******************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCNMX1    ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCNMX1 110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     5121
     C                     END
     C*
     C** IF ENTERED & NUMERIC,IT MUST BE GREATER THAN THE MINIMUM
     C** CHARGE ENTERED
     C*
     C           *IN47     IFEQ '0'
     C           *IN51     ANDEQ'0'
     C           WCNMX1    ANDNE*ZERO
     C           WCNMX1    ANDLEWCNMN1
     C                     SETON                     5130
     C                     END
     C*
     C********************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT 2 MAXIMUM CHARGE **
     C********************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCNMX2    ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCNMX2 110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     7821
     C                     END
     C*
     C** IF ENTERED & NUMERIC,IT MUST BE GREATER THAN THE MINIMUM
     C** CHARGE ENTERED
     C*
     C           *IN76     IFEQ '0'
     C           *IN78     ANDEQ'0'
     C           WCNMX2    ANDNE*ZERO
     C           WCNMX2    ANDLEWCNMN2
     C                     SETON                     7830
     C                     END
     C*
     C********************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT 3 MAXIMUM CHARGE **
     C********************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCNMX3    ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCNMX3 110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     7921
     C                     END
     C*
     C** IF ENTERED & NUMERIC,IT MUST BE GREATER THAN THE MINIMUM
     C** CHARGE ENTERED
     C*
     C           *IN77     IFEQ '0'
     C           *IN79     ANDEQ'0'
     C           WCNMX3    ANDNE*ZERO
     C           WCNMX3    ANDLEWCNMN3
     C                     SETON                     7930
     C                     END
     C*
     C********************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT 4 MAXIMUM CHARGE **
     C********************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCNMX4    ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCNMX4 110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     0621
     C                     END
     C*
     C** IF ENTERED & NUMERIC,IT MUST BE GREATER THAN THE MINIMUM
     C** CHARGE ENTERED
     C*
     C           *IN80     IFEQ '0'
     C           *IN06     ANDEQ'0'
     C           WCNMX4    ANDNE*ZERO
     C           WCNMX4    ANDLEWCNMN4
     C                     SETON                     0630
     C                     END
     C*
     C********************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT 5 MAXIMUM CHARGE **
     C********************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCNMX5    ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCNMX5 110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     0721
     C                     END
     C*
     C** IF ENTERED & NUMERIC,IT MUST BE GREATER THAN THE MINIMUM
     C** CHARGE ENTERED
     C*
     C           *IN81     IFEQ '0'
     C           *IN07     ANDEQ'0'
     C           WCNMX5    ANDNE*ZERO
     C           WCNMX5    ANDLEWCNMN5
     C                     SETON                     0730
     C                     END
     C*
     C********************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT 6 MAXIMUM CHARGE **
     C********************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCNMX6    ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCNMX6 110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     0921
     C                     END
     C*
     C** IF ENTERED & NUMERIC,IT MUST BE GREATER THAN THE MINIMUM
     C** CHARGE ENTERED
     C*
     C           *IN82     IFEQ '0'
     C           *IN09     ANDEQ'0'
     C           WCNMX6    ANDNE*ZERO
     C           WCNMX6    ANDLEWCNMN6
     C                     SETON                     0930
     C                     END
     C*
     C********************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT 7 MAXIMUM CHARGE **
     C********************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCNMX7    ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCNMX7 110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     3721
     C                     END
     C*
     C** IF ENTERED & NUMERIC,IT MUST BE GREATER THAN THE MINIMUM
     C** CHARGE ENTERED
     C*
     C           *IN83     IFEQ '0'
     C           *IN37     ANDEQ'0'
     C           WCNMX7    ANDNE*ZERO
     C           WCNMX7    ANDLEWCNMN7
     C                     SETON                     3730
     C                     END
     C*
     C********************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT 8 MAXIMUM CHARGE **
     C********************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCNMX8    ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCNMX8 110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     3921
     C                     END
     C*
     C** IF ENTERED & NUMERIC,IT MUST BE GREATER THAN THE MINIMUM
     C** CHARGE ENTERED
     C*
     C           *IN84     IFEQ '0'
     C           *IN39     ANDEQ'0'
     C           WCNMX8    ANDNE*ZERO
     C           WCNMX8    ANDLEWCNMN8
     C                     SETON                     3930
     C                     END
     C*
     C********************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT 9 MAXIMUM CHARGE **
     C********************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCNMX9    ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCNMX9 110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     1021
     C                     END
     C*
     C** IF ENTERED & NUMERIC,IT MUST BE GREATER THAN THE MINIMUM
     C** CHARGE ENTERED
     C*
     C           *IN85     IFEQ '0'
     C           *IN10     ANDEQ'0'
     C           WCNMX9    ANDNE*ZERO
     C           WCNMX9    ANDLEWCNMN9
     C                     SETON                     1030
     C                     END
     C*
     C********************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT 10 MAXIMUM CHARGE **
     C********************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCNMX0    ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCNMX0 110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     3821
     C                     END
     C*
     C** IF ENTERED & NUMERIC,IT MUST BE GREATER THAN THE MINIMUM
     C** CHARGE ENTERED
     C*
     C           *IN31     IFEQ '0'
     C           *IN38     ANDEQ'0'
     C           WCNMX0    ANDNE*ZERO
     C           WCNMX0    ANDLEWCNMN0
     C                     SETON                     3830
     C                     END
     C*
     C*************************************************************
     C** CHECK INTERDEPENDENCIES BETWEEN RES. TO NON-RES. FIELDS **
     C*************************************************************
     C** IF RANGE 1 START WAS NOT ENTERED,NONE OF THE SUBSEQUENT
     C** RES. TO NON-RES. FIELDS MAY BE EITHER
     C*
     C           WCNS1     IFEQ *ZERO
     C           WCNE1     IFNE *ZERO
     C           WCNR1     ORNE *ZERO
     C           WCNS2     ORNE *ZERO
     C           WCNE2     ORNE *ZERO
     C           WCNR2     ORNE *ZERO
     C           WCNMN1    ORNE *ZERO
     C           WCNMN2    ORNE *ZERO
     C           WCNMN3    ORNE *ZERO
     C           WCNS3     ORNE *ZERO
     C           WCNE3     ORNE *ZERO
     C           WCNR3     ORNE *ZERO
     C           WCNMX1    ORNE *ZERO
     C           WCNMX2    ORNE *ZERO
     C           WCNMX3    ORNE *ZERO
     C           WCNS4     ORNE *ZERO
     C           WCNE4     ORNE *ZERO
     C           WCNR4     ORNE *ZERO
     C           WCNMN4    ORNE *ZERO
     C           WCNMX4    ORNE *ZERO
     C           WCNS5     ORNE *ZERO
     C           WCNE5     ORNE *ZERO
     C           WCNR5     ORNE *ZERO
     C           WCNMN5    ORNE *ZERO
     C           WCNMX5    ORNE *ZERO
     C           WCNS6     ORNE *ZERO
     C           WCNE6     ORNE *ZERO
     C           WCNR6     ORNE *ZERO
     C           WCNMN6    ORNE *ZERO
     C           WCNMX6    ORNE *ZERO
     C           WCNS7     ORNE *ZERO
     C           WCNE7     ORNE *ZERO
     C           WCNR7     ORNE *ZERO
     C           WCNMN7    ORNE *ZERO
     C           WCNMX7    ORNE *ZERO
     C           WCNS8     ORNE *ZERO
     C           WCNE8     ORNE *ZERO
     C           WCNR8     ORNE *ZERO
     C           WCNMN8    ORNE *ZERO
     C           WCNMX8    ORNE *ZERO
     C           WCNS9     ORNE *ZERO
     C           WCNE9     ORNE *ZERO
     C           WCNR9     ORNE *ZERO
     C           WCNMN9    ORNE *ZERO
     C           WCNMX9    ORNE *ZERO
     C           WCNS0     ORNE *ZERO
     C           WCNE0     ORNE *ZERO
     C           WCNR0     ORNE *ZERO
     C           WCNMN0    ORNE *ZERO
     C           WCNMX0    ORNE *ZERO
     C                     SETON                     4122
     C                     END
     C                     END
     C*
     C** IF RANGE 2 START WAS NOT ENTERED,NONE OF THE SUBSEQUENT
     C** RES. TO NON-RES. START,END,RATE FIELDS MAY BE EITHER
     C*
     C           WCNS2     IFEQ *ZERO
     C           WCNE2     IFNE *ZERO
     C           WCNR2     ORNE *ZERO
     C           WCNMN2    ORNE *ZERO                                     074806
     C           WCNMX2    ORNE *ZERO                                     074806
     C           WCNS3     ORNE *ZERO
     C           WCNE3     ORNE *ZERO
     C           WCNR3     ORNE *ZERO
     C           WCNMN3    ORNE *ZERO                                     074806
     C           WCNMX3    ORNE *ZERO                                     074806
     C           WCNS4     ORNE *ZERO
     C           WCNE4     ORNE *ZERO
     C           WCNR4     ORNE *ZERO
     C           WCNMN4    ORNE *ZERO                                     074806
     C           WCNMX4    ORNE *ZERO                                     074806
     C           WCNS5     ORNE *ZERO
     C           WCNE5     ORNE *ZERO
     C           WCNR5     ORNE *ZERO
     C           WCNMX5    ORNE *ZERO                                     074806
     C           WCNS6     ORNE *ZERO
     C           WCNE6     ORNE *ZERO
     C           WCNR6     ORNE *ZERO
     C           WCNMN6    ORNE *ZERO                                     074806
     C           WCNMX6    ORNE *ZERO                                     074806
     C           WCNS7     ORNE *ZERO
     C           WCNE7     ORNE *ZERO
     C           WCNR7     ORNE *ZERO
     C           WCNMN7    ORNE *ZERO                                     074806
     C           WCNMX7    ORNE *ZERO                                     074806
     C           WCNS8     ORNE *ZERO
     C           WCNE8     ORNE *ZERO
     C           WCNR8     ORNE *ZERO
     C           WCNMN8    ORNE *ZERO                                     074806
     C           WCNMX8    ORNE *ZERO                                     074806
     C           WCNS9     ORNE *ZERO
     C           WCNE9     ORNE *ZERO
     C           WCNR9     ORNE *ZERO
     C           WCNMN9    ORNE *ZERO                                     074806
     C           WCNMX9    ORNE *ZERO                                     074806
     C           WCNS0     ORNE *ZERO
     C           WCNE0     ORNE *ZERO
     C           WCNR0     ORNE *ZERO
     C           WCNMN0    ORNE *ZERO                                     074806
     C           WCNMX0    ORNE *ZERO                                     074806
     C                     SETON                     4427
     C                     END
     C                     END
     C*
     C** IF RANGE 3 START WAS NOT ENTERED,NONE OF THE SUBSEQUENT
     C** RES. TO NON-RES. END & RATE FIELDS MAY BE EITHER
     C*
     C           WCNS3     IFEQ *ZERO
     C           WCNE3     IFNE *ZERO
     C           WCNR3     ORNE *ZERO
     C           WCNMN3    ORNE *ZERO                                     074806
     C           WCNMX3    ORNE *ZERO                                     074806
     C           WCNS4     ORNE *ZERO
     C           WCNE4     ORNE *ZERO
     C           WCNR4     ORNE *ZERO
     C           WCNMN4    ORNE *ZERO                                     074806
     C           WCNMX4    ORNE *ZERO                                     074806
     C           WCNS5     ORNE *ZERO
     C           WCNE5     ORNE *ZERO
     C           WCNR5     ORNE *ZERO
     C           WCNMN5    ORNE *ZERO                                     074806
     C           WCNMX5    ORNE *ZERO                                     074806
     C           WCNS6     ORNE *ZERO
     C           WCNE6     ORNE *ZERO
     C           WCNR6     ORNE *ZERO
     C           WCNMN6    ORNE *ZERO                                     074806
     C           WCNMX6    ORNE *ZERO                                     074806
     C           WCNS7     ORNE *ZERO
     C           WCNE7     ORNE *ZERO
     C           WCNR7     ORNE *ZERO
     C           WCNMN7    ORNE *ZERO                                     074806
     C           WCNMX7    ORNE *ZERO                                     074806
     C           WCNS8     ORNE *ZERO
     C           WCNE8     ORNE *ZERO
     C           WCNR8     ORNE *ZERO
     C           WCNMN8    ORNE *ZERO                                     074806
     C           WCNMX8    ORNE *ZERO                                     074806
     C           WCNS9     ORNE *ZERO
     C           WCNE9     ORNE *ZERO
     C           WCNR9     ORNE *ZERO
     C           WCNMN9    ORNE *ZERO                                     074806
     C           WCNMX9    ORNE *ZERO                                     074806
     C           WCNS0     ORNE *ZERO
     C           WCNE0     ORNE *ZERO
     C           WCNR0     ORNE *ZERO
     C           WCNMN0    ORNE *ZERO                                     074806
     C           WCNMX0    ORNE *ZERO                                     074806
     C                     SETON                     4829
     C                     END
     C                     END
     C*
     C           WCNS4     IFEQ *ZERO
     C           WCNE4     IFNE *ZERO
     C           WCNR4     ORNE *ZERO
     C           WCNMN4    ORNE *ZERO                                     074806
     C           WCNMX4    ORNE *ZERO                                     074806
     C           WCNS5     ORNE *ZERO
     C           WCNE5     ORNE *ZERO
     C           WCNR5     ORNE *ZERO
     C           WCNMN5    ORNE *ZERO                                     074806
     C           WCNMX5    ORNE *ZERO                                     074806
     C           WCNS6     ORNE *ZERO
     C           WCNE6     ORNE *ZERO
     C           WCNR6     ORNE *ZERO
     C           WCNMN6    ORNE *ZERO                                     074806
     C           WCNMX6    ORNE *ZERO                                     074806
     C           WCNS7     ORNE *ZERO
     C           WCNE7     ORNE *ZERO
     C           WCNR7     ORNE *ZERO
     C           WCNMN7    ORNE *ZERO                                     074806
     C           WCNMX7    ORNE *ZERO                                     074806
     C           WCNS8     ORNE *ZERO
     C           WCNE8     ORNE *ZERO
     C           WCNR8     ORNE *ZERO
     C           WCNMN8    ORNE *ZERO                                     074806
     C           WCNMX8    ORNE *ZERO                                     074806
     C           WCNS9     ORNE *ZERO
     C           WCNE9     ORNE *ZERO
     C           WCNR9     ORNE *ZERO
     C           WCNMN9    ORNE *ZERO                                     074806
     C           WCNMX9    ORNE *ZERO                                     074806
     C           WCNS0     ORNE *ZERO
     C           WCNE0     ORNE *ZERO
     C           WCNR0     ORNE *ZERO
     C           WCNMN0    ORNE *ZERO                                     074806
     C           WCNMX0    ORNE *ZERO                                     074806
     C                     SETON                     5229
     C                     END
     C                     END
     C*
     C           WCNS5     IFEQ *ZERO
     C           WCNE5     IFNE *ZERO
     C           WCNR5     ORNE *ZERO
     C           WCNMN5    ORNE *ZERO                                     074806
     C           WCNMX5    ORNE *ZERO                                     074806
     C           WCNS6     ORNE *ZERO
     C           WCNE6     ORNE *ZERO
     C           WCNR6     ORNE *ZERO
     C           WCNMN6    ORNE *ZERO                                     074806
     C           WCNMX6    ORNE *ZERO                                     074806
     C           WCNS7     ORNE *ZERO
     C           WCNE7     ORNE *ZERO
     C           WCNR7     ORNE *ZERO
     C           WCNMN7    ORNE *ZERO                                     074806
     C           WCNMX7    ORNE *ZERO                                     074806
     C           WCNS8     ORNE *ZERO
     C           WCNE8     ORNE *ZERO
     C           WCNR8     ORNE *ZERO
     C           WCNMN8    ORNE *ZERO                                     074806
     C           WCNMX8    ORNE *ZERO                                     074806
     C           WCNS9     ORNE *ZERO
     C           WCNE9     ORNE *ZERO
     C           WCNR9     ORNE *ZERO
     C           WCNMN9    ORNE *ZERO                                     074806
     C           WCNMX9    ORNE *ZERO                                     074806
     C           WCNS0     ORNE *ZERO
     C           WCNE0     ORNE *ZERO
     C           WCNR0     ORNE *ZERO
     C           WCNMN0    ORNE *ZERO                                     074806
     C           WCNMX0    ORNE *ZERO                                     074806
     C                     SETON                     5529
     C                     END
     C                     END
     C*
     C           WCNS6     IFEQ *ZERO
     C           WCNE6     IFNE *ZERO
     C           WCNR6     ORNE *ZERO
     C           WCNMN6    ORNE *ZERO                                     074806
     C           WCNMX6    ORNE *ZERO                                     074806
     C           WCNS7     ORNE *ZERO
     C           WCNE7     ORNE *ZERO
     C           WCNR7     ORNE *ZERO
     C           WCNMN7    ORNE *ZERO                                     074806
     C           WCNMX7    ORNE *ZERO                                     074806
     C           WCNS8     ORNE *ZERO
     C           WCNE8     ORNE *ZERO
     C           WCNR8     ORNE *ZERO
     C           WCNMN8    ORNE *ZERO                                     074806
     C           WCNMX8    ORNE *ZERO                                     074806
     C           WCNS9     ORNE *ZERO
     C           WCNE9     ORNE *ZERO
     C           WCNR9     ORNE *ZERO
     C           WCNMN9    ORNE *ZERO                                     074806
     C           WCNMX9    ORNE *ZERO                                     074806
     C           WCNS0     ORNE *ZERO
     C           WCNE0     ORNE *ZERO
     C           WCNR0     ORNE *ZERO
     C           WCNMN0    ORNE *ZERO                                     074806
     C           WCNMX0    ORNE *ZERO                                     074806
     C                     SETON                     5829
     C                     END
     C                     END
     C*
     C           WCNS7     IFEQ *ZERO
     C           WCNE7     IFNE *ZERO
     C           WCNR7     ORNE *ZERO
     C           WCNMN7    ORNE *ZERO                                     074806
     C           WCNMX7    ORNE *ZERO                                     074806
     C           WCNS8     ORNE *ZERO
     C           WCNE8     ORNE *ZERO
     C           WCNR8     ORNE *ZERO
     C           WCNMN8    ORNE *ZERO                                     074806
     C           WCNMX8    ORNE *ZERO                                     074806
     C           WCNS9     ORNE *ZERO
     C           WCNE9     ORNE *ZERO
     C           WCNR9     ORNE *ZERO
     C           WCNMN9    ORNE *ZERO                                     074806
     C           WCNMX9    ORNE *ZERO                                     074806
     C           WCNS0     ORNE *ZERO
     C           WCNE0     ORNE *ZERO
     C           WCNR0     ORNE *ZERO
     C           WCNMN0    ORNE *ZERO                                     074806
     C           WCNMX0    ORNE *ZERO                                     074806
     C                     SETON                     6129
     C                     END
     C                     END
     C*
     C           WCNS8     IFEQ *ZERO
     C           WCNE8     IFNE *ZERO
     C           WCNR8     ORNE *ZERO
     C           WCNMN8    ORNE *ZERO                                     074806
     C           WCNMX8    ORNE *ZERO                                     074806
     C           WCNS9     ORNE *ZERO
     C           WCNE9     ORNE *ZERO
     C           WCNR9     ORNE *ZERO
     C           WCNMN9    ORNE *ZERO                                     074806
     C           WCNMX9    ORNE *ZERO                                     074806
     C           WCNS0     ORNE *ZERO
     C           WCNE0     ORNE *ZERO
     C           WCNR0     ORNE *ZERO
     C           WCNMN0    ORNE *ZERO                                     074806
     C           WCNMX0    ORNE *ZERO                                     074806
     C                     SETON                     6429
     C                     END
     C                     END
     C*
     C           WCNS9     IFEQ *ZERO
     C           WCNE9     IFNE *ZERO
     C           WCNR9     ORNE *ZERO
     C           WCNMN9    ORNE *ZERO                                     074806
     C           WCNMX9    ORNE *ZERO                                     074806
     C           WCNS0     ORNE *ZERO
     C           WCNE0     ORNE *ZERO
     C           WCNR0     ORNE *ZERO
     C           WCNMN0    ORNE *ZERO                                     074806
     C           WCNMX0    ORNE *ZERO                                     074806
     C                     SETON                     6729
     C                     END
     C                     END
     C*
     C           WCNS0     IFEQ *ZERO
     C           WCNE0     IFNE *ZERO
     C           WCNR0     ORNE *ZERO
     C           WCNMN0    ORNE *ZERO                                     074806
     C           WCNMX0    ORNE *ZERO                                     074806
     C                     SETON                     0129
     C                     END
     C                     END
     C*
     C           SCH3C     IFEQ '1'
     C           SCH3C     OREQ '2'
     C                     ELSE
     C                     SETON                     04
     C                     MOVEL'FTM2537' ZAMSID                          074804
     C                     EXSR SRSNDM                                    074804
     C                     END
     C*
     C*****************************************************************
     C**  SETUP ERROR CODE ARRAY DEPENDING ON WHICH INDICATORS HAVE  **
     C**  BEEN SET ABOVE.                                            **
     C*****************************************************************
     C*
     C                     Z-ADD*ZERO     I       30
     C                     MOVEL*BLANKS   ERCD
     C***********                                                         074804
     C************IN04     IFEQ '1'                                       074804
     C***********          ADD  1         I                               074804
     C***********          MOVE '377'     ERCD,I                          074804
     C***********          END                                            074804
     C*
     C           *IN21     IFEQ '1'
     C                     ADD  1         I
     C                     MOVE '004'     ERCD,I
     C                     END
     C*
     C           *IN22     IFEQ '1'
     C                     ADD  1         I
     C                     MOVE '005'     ERCD,I
     C                     END
     C*
     C           *IN23     IFEQ '1'
     C                     ADD  1         I
     C                     MOVE '006'     ERCD,I
     C                     END
     C*
     C           *IN24     IFEQ '1'
     C                     ADD  1         I
     C                     MOVE '007'     ERCD,I
     C                     END
     C*
     C           *IN25     IFEQ '1'
     C                     ADD  1         I
     C                     MOVE '008'     ERCD,I
     C                     END
     C*
     C           *IN26     IFEQ '1'
     C                     ADD  1         I
     C                     MOVE '009'     ERCD,I
     C                     END
     C*
     C           *IN27     IFEQ '1'
     C                     ADD  1         I
     C                     MOVE '010'     ERCD,I
     C                     END
     C*
     C           *IN28     IFEQ '1'
     C                     ADD  1         I
     C                     MOVE '011'     ERCD,I
     C                     END
     C*
     C           *IN29     IFEQ '1'
     C                     ADD  1         I
     C                     MOVE '012'     ERCD,I
     C                     END
     C*
     C           *IN30     IFEQ '1'
     C                     ADD  1         I
     C                     MOVE '013'     ERCD,I
     C                     END
     C*
     C           *IN32     IFEQ '1'
     C                     ADD  1         I
     C                     MOVE '015'     ERCD,I
     C                     END
     C*
     C           *IN33     IFEQ '1'
     C                     ADD  1         I
     C                     MOVE '016'     ERCD,I
     C                     END
     C*
     C           *IN34     IFEQ '1'
     C                     ADD  1         I
     C                     MOVE '017'     ERCD,I
     C                     END
     C*
     C           *IN35     IFEQ '1'
     C                     ADD  1         I
     C                     MOVE '018'     ERCD,I
     C                     END
     C*
     C           *IN36     IFEQ '1'
     C                     ADD  1         I
     C                     MOVE '183'     ERCD,I
     C                     END
     C*
     C************IN67     IFEQ '1'                                       074804
     C***********          ADD  1         I                               074804
     C***********          MOVE '375'     ERCD,I                          074804
     C***********          ADD  1         I                               074804
     C***********          MOVE '376'     ERCD,I                          074804
     C***********          END                                            074804
     C***********                                                         074804
     C************IN68     IFEQ '1'                                       074804
     C***********          ADD  1         I                               074804
     C***********          MOVE '377'     ERCD,I                          074804
     C***********          END                                            074804
     C***********                                                         074804
     C************IN69     IFEQ '1'                                       074804
     C***********          ADD  1         I                               074804
     C***********          MOVE '377'     ERCD,I                          074804
     C***********          END                                            074804
     C*
     C           *IN18     IFEQ '1'
     C                     ADD  1         I
     C                     MOVE '377'     ERCD,I
     C                     END
     C*
     C           *IN70     IFEQ '1'
     C                     ADD  1         I
     C                     MOVE '377'     ERCD,I
     C                     END
     C*
     C************IN84     IFEQ '1'                                       074804
     C***********          ADD  1         I                               074804
     C***********          MOVE '377'     ERCD,I                          074804
     C***********          END                                            074804
     C***********                                                         074804
     C************IN85     IFEQ '1'                                       074804
     C***********          ADD  1         I                               074804
     C***********          MOVE '379'     ERCD,I                          074804
     C***********          END                                            074804
     C***********                                                         074804
     C************IN31     IFEQ '1'                                       074804
     C***********          ADD  1         I                               074804
     C***********          MOVE '381'     ERCD,I                          074804
     C***********          END                                            074804
     C***********                                                         074804
     C************IN06     IFEQ '1'                                       074804
     C***********          ADD  1         I                               074804
     C***********          MOVE '378'     ERCD,I                          074804
     C***********          END                                            074804
     C***********                                                         074804
     C************IN07     IFEQ '1'                                       074804
     C***********          ADD  1         I                               074804
     C***********          MOVE '380'     ERCD,I                          074804
     C***********          END                                            074804
     C*
     C** CHECK IF ANY ERRORS HAVE BEEN FOUND
     C*
     C           I         IFGT *ZERO
     C                     SETON                     74
     C           I         IFGT 19
     C                     SETON                     75
     C                     END
     C                     END
     C*
     C*          *****     *****
     C           GAEND3    ENDSR
     C*          *****     *****
     C/EJECT
     C*
     C           GAVAL4    BEGSR
     C*          ******    *****
     C*
     C*****************************************************************
     C*                 GA-VALIDATE-DETAIL-INPUT                      *
     C*                                                               *
     C*  FUNCTION : TO PERFORM VALIDATION OF ALL DETAIL FIELDS        *
     C*             ENTERED,SETON APPROPRIATE INDICATORS AND SETUP    *
     C*             THE ARRAY OF APPROPRIATE ERROR CODES FOR DISPLAY. *
     C*                                                               *
     C*  CALLS :    ZALIGN                                            *
     C*                                                               *
     C*  CALLED BY: EAINP4                                            *
     C*                                                               *
     C*****************************************************************
     C*
     C** CLEAR ERROR INDICATORS & ERROR CODES ARRAY
     C*
     C                     MOVEL*BLANKS   ERCD
     C                     EXSR SRCLRM                                    074804
     C*
     C                     MOVEA'0000'    *IN,01
     C                     MOVEA'00'      *IN,06
     C                     MOVEA'00'      *IN,09
     C                     MOVEA'00000000'*IN,21
     C                     MOVEA'00000000'*IN,29
     C                     MOVEA'000'     *IN,37
     C                     MOVEA'00000000'*IN,40
     C                     MOVEA'00000000'*IN,48
     C                     MOVEA'00000000'*IN,56
     C                     MOVEA'000000'  *IN,64
     C                     MOVEA*ZERO     *IN,74
     C                     MOVEA'00000000'*IN,80
     C                     MOVE '0'       *IN18
     C                     MOVE '0'       *IN70
     C*
     C*****************************************************
     C** VALIDATE TARIFF 4                               **
     C*****************************************************
     C** FIELD MUST NOT BE BLANK
     C*
     C           *BLANK    IFEQ STNR4
     C                     SETON                     70
     C                     END
     C*
     C*
     C*****************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 1 START **
     C*****************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRRS1     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRRS1  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     4121
     C                     END
     C*
     C***************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 1 END **
     C***************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRRE1     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRRE1  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     4221
     C                     END
     C*
     C** FIELD MUST BE ENTERED IF RANGE START WAS
     C*
     C           *IN42     IFEQ '0'
     C           WRRS1     ANDNE*ZERO
     C           WRRE1     ANDEQ*ZERO
     C                     SETON                     4223
     C                     END
     C*
     C** FIELD MUST BE GREATER THAN RANGE START
     C*
     C           *IN41     IFEQ '0'
     C           *IN42     ANDEQ'0'
     C           WRRS1     ANDNE*ZERO
     C           WRRE1     ANDLEWRRS1
     C                     SETON                     4224
     C                     END
     C*
     C****************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 1 RATE **
     C****************************************************
     C** FIELD MUST BE 13-LONG NUMERIC WITH UPTO 8 D.P.S AND UPTO 5
     C** DIGITS BEFORE THE DECIMAL POINT
     C*
     C                     Z-ADD8         ZADEC
     C                     Z-ADD5         ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRRR1     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRRR1  138
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     4326
     C                     END
     C*
     C** FIELD MUST BE ENTERED IF RANGE START WAS
     C*
     C           STR4C     IFEQ '1'                                       093336
     C           *IN43     IFEQ '0'
     C           WRRS1     ANDNE*ZERO
     C           WRRR1     ANDEQ*ZERO
     C                     SETON                     4325
     C                     END
     C                     END                                            093336
     C*
     C*****************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 2 START **
     C*****************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRRS2     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRRS2  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     4421
     C                     END
     C*
     C** IF NUMERIC, IT MUST EQUAL RANGE 1 END + SMALLEST UNIT OF
     C** BASE CURRENCY POSSIBLE
     C*
     C           *IN44     IFEQ '0'
     C           *IN43     ANDEQ'0'
     C           WRRE1     ANDNE*ZERO
     C           WRRS2     ANDNE*ZERO
     C           WRRE1     ADD  1         WN11   110
     C           WN11      IFNE WRRS2
     C                     SETON                     4428
     C                     END
     C                     END
     C*
     C***************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 2 END **
     C***************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRRE2     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRRE2  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     4521
     C                     END
     C*
     C** FIELD MUST BE ENTERED IF RANGE START WAS
     C*
     C           *IN45     IFEQ '0'
     C           WRRS2     ANDNE*ZERO
     C           WRRE2     ANDEQ*ZERO
     C                     SETON                     4523
     C                     END
     C*
     C** FIELD MUST BE GREATER THAN RANGE START
     C*
     C           *IN44     IFEQ '0'
     C           *IN45     ANDEQ'0'
     C           WRRS2     ANDNE*ZERO
     C           WRRE2     ANDLEWRRS2
     C                     SETON                     4524
     C                     END
     C*
     C****************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 2 RATE **
     C****************************************************
     C** FIELD MUST BE 13-LONG NUMERIC WITH UPTO 8 D.P.S AND UPTO 5
     C** DIGITS BEFORE THE DECIMAL POINT
     C*
     C                     Z-ADD8         ZADEC
     C                     Z-ADD5         ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRRR2     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRRR2  138
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     4626
     C                     END
     C*
     C** FIELD MUST BE ENTERED IF RANGE START WAS
     C*
     C           STR4C     IFEQ '1'                                       093336
     C           *IN46     IFEQ '0'
     C           WRRS2     ANDNE*ZERO
     C           WRRR2     ANDEQ*ZERO
     C                     SETON                     4625
     C                     END
     C                     END                                            093336
     C*
     C******************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT MINIMUM CHARGE **
     C******************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRRMN     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRRMN  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     4721
     C                     END
     C*
     C********************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT 2 MINIMUM CHARGE **
     C********************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRRMN2    ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRRMN2 110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     7621
     C                     END
     C*
     C********************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT 3 MINIMUM CHARGE **
     C********************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRRMN3    ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRRMN3 110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     7721
     C                     END
     C*
     C********************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT 4 MINIMUM CHARGE **
     C********************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRRMN4    ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRRMN4 110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     8021
     C                     END
     C*
     C********************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT 5 MINIMUM CHARGE **
     C********************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRRMN5    ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRRMN5 110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     8121
     C                     END
     C*
     C********************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT 6 MINIMUM CHARGE **
     C********************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRRMN6    ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRRMN6 110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     8221
     C                     END
     C*
     C********************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT 7 MINIMUM CHARGE **
     C********************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRRMN7    ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRRMN7 110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     8321
     C                     END
     C*
     C********************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT 8 MINIMUM CHARGE **
     C********************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRRMN8    ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRRMN8 110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     8421
     C                     END
     C*
     C********************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT 9 MINIMUM CHARGE **
     C********************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRRMN9    ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRRMN9 110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     8521
     C                     END
     C*
     C********************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT 10 MINIMUM CHARGE **
     C********************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRRMN0    ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRRMN0 110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     3121
     C                     END
     C*
     C*****************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 3 START **
     C*****************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRRS3     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRRS3  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     4821
     C                     END
     C*
     C** IF NUMERIC, IT MUST EQUAL RANGE 2 END + SMALLEST UNIT OF
     C** BASE CURRENCY POSSIBLE
     C*
     C           *IN48     IFEQ '0'
     C           *IN46     ANDEQ'0'
     C           WRRE2     ANDNE*ZERO
     C           WRRS3     ANDNE*ZERO
     C           WRRE2     ADD  1         WN11
     C           WN11      IFNE WRRS3
     C                     SETON                     4828
     C                     END
     C                     END
     C*
     C***************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 3 END **
     C***************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRRE3     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRRE3  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     4921
     C                     END
     C*
     C** FIELD MUST BE ENTERED IF RANGE START WAS
     C*
     C           *IN49     IFEQ '0'
     C           WRRS3     ANDNE*ZERO
     C           WRRE3     ANDEQ*ZERO
     C***********          SETON                     4928                 074804
     C                     SETON                     4923                 074804
     C                     END
     C*
     C** FIELD MUST BE GREATER THAN RANGE START
     C*
     C           *IN48     IFEQ '0'
     C           *IN49     ANDEQ'0'
     C           WRRS3     ANDNE*ZERO
     C           WRRE3     ANDLEWRRS3
     C                     SETON                     4924
     C                     END
     C*
     C****************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 3 RATE **
     C****************************************************
     C** FIELD MUST BE 13-LONG NUMERIC WITH UPTO 8 D.P.S AND UPTO 5
     C** DIGITS BEFORE THE DECIMAL POINT
     C*
     C                     Z-ADD8         ZADEC
     C                     Z-ADD5         ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRRR3     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRRR3  138
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     5026
     C                     END
     C*
     C** FIELD MUST BE ENTERED IF RANGE START WAS
     C*
     C           STR4C     IFEQ '1'                                       093336
     C           *IN50     IFEQ '0'
     C           WRRS3     ANDNE*ZERO
     C           WRRR3     ANDEQ*ZERO
     C                     SETON                     5025
     C                     END
     C                     END                                            093336
     C*
     C*
     C*****************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 4 START **
     C*****************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRRS4     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRRS4  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     5221
     C                     END
     C*
     C** IF NUMERIC, IT MUST EQUAL RANGE 2 END + SMALLEST UNIT OF
     C** BASE CURRENCY POSSIBLE
     C*
     C           *IN52     IFEQ '0'
     C           *IN50     ANDEQ'0'
     C           WRRE3     ANDNE*ZERO
     C           WRRS4     ANDNE*ZERO
     C           WRRE3     ADD  1         WN11
     C           WN11      IFNE WRRS4
     C                     SETON                     5228                 074804
     C                     END
     C                     END
     C*
     C***************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 4 END **
     C***************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRRE4     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRRE4  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     5321
     C                     END
     C*
     C** FIELD MUST BE ENTERED IF RANGE START WAS
     C*
     C           *IN53     IFEQ '0'
     C           WRRS4     ANDNE*ZERO
     C           WRRE4     ANDEQ*ZERO
     C***********          SETON                     5328                 074804
     C                     SETON                     5323                 074804
     C                     END
     C*
     C** FIELD MUST BE GREATER THAN RANGE START
     C*
     C           *IN53     IFEQ '0'
     C           *IN52     ANDEQ'0'
     C           WRRS4     ANDNE*ZERO
     C           WRRE4     ANDLEWRRS4
     C                     SETON                     5324
     C                     END
     C*
     C****************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 4 RATE **
     C****************************************************
     C** FIELD MUST BE 13-LONG NUMERIC WITH UPTO 8 D.P.S AND UPTO 5
     C** DIGITS BEFORE THE DECIMAL POINT
     C*
     C                     Z-ADD8         ZADEC
     C                     Z-ADD5         ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRRR4     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRRR4  138
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     5426
     C                     END
     C*
     C** FIELD MUST BE ENTERED IF RANGE START WAS
     C*
     C           STR4C     IFEQ '1'                                       093336
     C           *IN54     IFEQ '0'
     C           WRRS4     ANDNE*ZERO
     C           WRRR4     ANDEQ*ZERO
     C                     SETON                     5425
     C                     END
     C                     END                                            093336
     C*
     C*
     C*****************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 5 START **
     C*****************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRRS5     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRRS5  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     5521
     C                     END
     C*
     C** IF NUMERIC, IT MUST EQUAL RANGE 2 END + SMALLEST UNIT OF
     C** BASE CURRENCY POSSIBLE
     C*
     C           *IN55     IFEQ '0'
     C           *IN54     ANDEQ'0'
     C           WRRE4     ANDNE*ZERO
     C           WRRS5     ANDNE*ZERO
     C           WRRE4     ADD  1         WN11
     C           WN11      IFNE WRRS5
     C                     SETON                     5528
     C                     END
     C                     END
     C*
     C***************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 5 END **
     C***************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRRE5     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRRE5  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     5621
     C                     END
     C*
     C** FIELD MUST BE ENTERED IF RANGE START WAS
     C*
     C           *IN56     IFEQ '0'
     C           WRRS5     ANDNE*ZERO
     C           WRRE5     ANDEQ*ZERO
     C***********          SETON                     5628                 074804
     C                     SETON                     5623                 074804
     C                     END
     C*
     C** FIELD MUST BE GREATER THAN RANGE START
     C*
     C           *IN55     IFEQ '0'
     C           *IN56     ANDEQ'0'
     C           WRRS5     ANDNE*ZERO
     C           WRRE5     ANDLEWRRS5
     C                     SETON                     5624
     C                     END
     C*
     C****************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 5 RATE **
     C****************************************************
     C** FIELD MUST BE 13-LONG NUMERIC WITH UPTO 8 D.P.S AND UPTO 5
     C** DIGITS BEFORE THE DECIMAL POINT
     C*
     C                     Z-ADD8         ZADEC
     C                     Z-ADD5         ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRRR5     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRRR5  138
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     5726
     C                     END
     C*
     C** FIELD MUST BE ENTERED IF RANGE START WAS
     C*
     C           STR4C     IFEQ '1'                                       093336
     C           *IN57     IFEQ '0'
     C           WRRS5     ANDNE*ZERO
     C           WRRR5     ANDEQ*ZERO
     C                     SETON                     5725
     C                     END
     C                     END                                            093336
     C*
     C*
     C*****************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 6 START **
     C*****************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRRS6     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRRS6  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     5821
     C                     END
     C*
     C** IF NUMERIC, IT MUST EQUAL RANGE 2 END + SMALLEST UNIT OF
     C** BASE CURRENCY POSSIBLE
     C*
     C           *IN57     IFEQ '0'
     C           *IN58     ANDEQ'0'
     C           WRRE5     ANDNE*ZERO
     C           WRRS6     ANDNE*ZERO
     C           WRRE5     ADD  1         WN11
     C           WN11      IFNE WRRS6
     C                     SETON                     5828
     C                     END
     C                     END
     C*
     C***************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 6 END **
     C***************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRRE6     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRRE6  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     5921
     C                     END
     C*
     C** FIELD MUST BE ENTERED IF RANGE START WAS
     C*
     C           *IN59     IFEQ '0'
     C           WRRS6     ANDNE*ZERO
     C           WRRE6     ANDEQ*ZERO
     C***********          SETON                     5928                 074804
     C                     SETON                     5923                 074804
     C                     END
     C*
     C** FIELD MUST BE GREATER THAN RANGE START
     C*
     C           *IN58     IFEQ '0'
     C           *IN59     ANDEQ'0'
     C           WRRS6     ANDNE*ZERO
     C           WRRE6     ANDLEWRRS6
     C                     SETON                     5924
     C                     END
     C*
     C****************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 6 RATE **
     C****************************************************
     C** FIELD MUST BE 13-LONG NUMERIC WITH UPTO 8 D.P.S AND UPTO 5
     C** DIGITS BEFORE THE DECIMAL POINT
     C*
     C                     Z-ADD8         ZADEC
     C                     Z-ADD5         ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRRR6     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRRR6  138
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     6026
     C                     END
     C*
     C** FIELD MUST BE ENTERED IF RANGE START WAS
     C*
     C           STR4C     IFEQ '1'                                       093336
     C           *IN60     IFEQ '0'
     C           WRRS6     ANDNE*ZERO
     C           WRRR6     ANDEQ*ZERO
     C                     SETON                     6025
     C                     END
     C                     END                                            093336
     C*
     C*
     C*****************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 7 START **
     C*****************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRRS7     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRRS7  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     6121
     C                     END
     C*
     C** IF NUMERIC, IT MUST EQUAL RANGE 2 END + SMALLEST UNIT OF
     C** BASE CURRENCY POSSIBLE
     C*
     C           *IN60     IFEQ '0'
     C           *IN61     ANDEQ'0'
     C           WRRE6     ANDNE*ZERO
     C           WRRS7     ANDNE*ZERO
     C           WRRE6     ADD  1         WN11
     C           WN11      IFNE WRRS7
     C                     SETON                     6128
     C                     END
     C                     END
     C*
     C***************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 7 END **
     C***************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRRE7     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRRE7  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     6221
     C                     END
     C*
     C** FIELD MUST BE ENTERED IF RANGE START WAS
     C*
     C           *IN62     IFEQ '0'
     C           WRRS7     ANDNE*ZERO
     C           WRRE7     ANDEQ*ZERO
     C***********          SETON                     6228                 074804
     C                     SETON                     6223                 074804
     C                     END
     C*
     C** FIELD MUST BE GREATER THAN RANGE START
     C*
     C           *IN61     IFEQ '0'
     C           *IN62     ANDEQ'0'
     C           WRRS7     ANDNE*ZERO
     C           WRRE7     ANDLEWRRS7
     C                     SETON                     6224
     C                     END
     C*
     C****************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 7 RATE **
     C****************************************************
     C** FIELD MUST BE 13-LONG NUMERIC WITH UPTO 8 D.P.S AND UPTO 5
     C** DIGITS BEFORE THE DECIMAL POINT
     C*
     C                     Z-ADD8         ZADEC
     C                     Z-ADD5         ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRRR7     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRRR7  138
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     6326
     C                     END
     C*
     C** FIELD MUST BE ENTERED IF RANGE START WAS
     C*
     C           STR4C     IFEQ '1'                                       093336
     C           *IN63     IFEQ '0'
     C           WRRS7     ANDNE*ZERO
     C           WRRR7     ANDEQ*ZERO
     C                     SETON                     6325
     C                     END
     C                     END                                            093336
     C*
     C*
     C*****************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 8 START **
     C*****************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRRS8     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRRS8  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     6421
     C                     END
     C*
     C** IF NUMERIC, IT MUST EQUAL RANGE 2 END + SMALLEST UNIT OF
     C** BASE CURRENCY POSSIBLE
     C*
     C           *IN63     IFEQ '0'
     C           *IN64     ANDEQ'0'
     C           WRRE7     ANDNE*ZERO
     C           WRRS8     ANDNE*ZERO
     C           WRRE7     ADD  1         WN11
     C           WN11      IFNE WRRS8
     C                     SETON                     6428
     C                     END
     C                     END
     C*
     C***************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 8 END **
     C***************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRRE8     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRRE8  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     6521
     C                     END
     C*
     C** FIELD MUST BE ENTERED IF RANGE START WAS
     C*
     C           *IN65     IFEQ '0'
     C           WRRS8     ANDNE*ZERO
     C           WRRE8     ANDEQ*ZERO
     C***********          SETON                     6528                 074804
     C                     SETON                     6523                 074804
     C                     END
     C*
     C** FIELD MUST BE GREATER THAN RANGE START
     C*
     C           *IN64     IFEQ '0'
     C           *IN65     ANDEQ'0'
     C           WRRS8     ANDNE*ZERO
     C           WRRE8     ANDLEWRRS8
     C                     SETON                     6524
     C                     END
     C*
     C****************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 8 RATE **
     C****************************************************
     C** FIELD MUST BE 13-LONG NUMERIC WITH UPTO 8 D.P.S AND UPTO 5
     C** DIGITS BEFORE THE DECIMAL POINT
     C*
     C                     Z-ADD8         ZADEC
     C                     Z-ADD5         ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRRR8     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRRR8  138
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     6626
     C                     END
     C*
     C** FIELD MUST BE ENTERED IF RANGE START WAS
     C*
     C           STR4C     IFEQ '1'                                       093336
     C           *IN66     IFEQ '0'
     C           WRRS8     ANDNE*ZERO
     C           WRRR8     ANDEQ*ZERO
     C                     SETON                     6625
     C                     END
     C                     END                                            093336
     C*
     C*
     C*****************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 9 START **
     C*****************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRRS9     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRRS9  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     6721
     C                     END
     C*
     C** IF NUMERIC, IT MUST EQUAL RANGE 2 END + SMALLEST UNIT OF
     C** BASE CURRENCY POSSIBLE
     C*
     C           *IN66     IFEQ '0'
     C           *IN67     ANDEQ'0'
     C           WRRE8     ANDNE*ZERO
     C           WRRS9     ANDNE*ZERO
     C           WRRE8     ADD  1         WN11
     C           WN11      IFNE WRRS9
     C                     SETON                     6728
     C                     END
     C                     END
     C*
     C***************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 9 END **
     C***************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRRE9     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRRE9  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     6821
     C                     END
     C*
     C** FIELD MUST BE ENTERED IF RANGE START WAS
     C*
     C           *IN68     IFEQ '0'
     C           WRRS9     ANDNE*ZERO
     C           WRRE9     ANDEQ*ZERO
     C***********          SETON                     6828                 074804
     C                     SETON                     6823                 074804
     C                     END
     C*
     C** FIELD MUST BE GREATER THAN RANGE START
     C*
     C           *IN67     IFEQ '0'
     C           *IN68     ANDEQ'0'
     C           WRRS9     ANDNE*ZERO
     C           WRRE9     ANDLEWRRS9
     C                     SETON                     6824
     C                     END
     C*
     C****************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 9 RATE **
     C****************************************************
     C** FIELD MUST BE 13-LONG NUMERIC WITH UPTO 8 D.P.S AND UPTO 5
     C** DIGITS BEFORE THE DECIMAL POINT
     C*
     C                     Z-ADD8         ZADEC
     C                     Z-ADD5         ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRRR9     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRRR9  138
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     6926
     C                     END
     C*
     C** FIELD MUST BE ENTERED IF RANGE START WAS
     C*
     C           STR4C     IFEQ '1'                                       093336
     C           *IN69     IFEQ '0'
     C           WRRS9     ANDNE*ZERO
     C           WRRR9     ANDEQ*ZERO
     C                     SETON                     6925
     C                     END
     C                     END                                            093336
     C*
     C*****************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 10 START **
     C*****************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRRS0     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRRS0  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C***********          SETON                     0128                 074804
     C                     SETON                     0121                 074804
     C                     END
     C*
     C** IF NUMERIC, IT MUST EQUAL RANGE 2 END + SMALLEST UNIT OF
     C** BASE CURRENCY POSSIBLE
     C*
     C           *IN69     IFEQ '0'
     C           *IN01     ANDEQ'0'
     C           WRRE9     ANDNE*ZERO
     C           WRRS0     ANDNE*ZERO
     C           WRRE9     ADD  1         WN11
     C           WN11      IFNE WRRS0
     C                     SETON                     0128
     C                     END
     C                     END
     C*
     C***************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 10 END **
     C***************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRRE0     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRRE0  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     0221
     C                     END
     C*
     C** FIELD MUST BE ENTERED IF RANGE START WAS
     C*
     C           *IN02     IFEQ '0'
     C           WRRS0     ANDNE*ZERO
     C           WRRE0     ANDEQ*ZERO
     C***********          SETON                     0228                 074804
     C                     SETON                     0223                 074804
     C                     END
     C*
     C** FIELD MUST BE GREATER THAN RANGE START
     C*
     C           *IN01     IFEQ '0'
     C           *IN02     ANDEQ'0'
     C           WRRS0     ANDNE*ZERO
     C           WRRE0     ANDLEWRRS0
     C                     SETON                     0224
     C                     END
     C*
     C****************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 10 RATE **
     C****************************************************
     C** FIELD MUST BE 13-LONG NUMERIC WITH UPTO 8 D.P.S AND UPTO 5
     C** DIGITS BEFORE THE DECIMAL POINT
     C*
     C                     Z-ADD8         ZADEC
     C                     Z-ADD5         ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRRR0     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRRR0  138
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     0326
     C                     END
     C*
     C** FIELD MUST BE ENTERED IF RANGE START WAS
     C*
     C           STR4C     IFEQ '1'                                       093336
     C           *IN03     IFEQ '0'
     C           WRRS0     ANDNE*ZERO
     C           WRRR0     ANDEQ*ZERO
     C                     SETON                     0325
     C                     END
     C                     END                                            093336
     C*
     C******************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT MAXIMUM CHARGE **
     C******************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRRMX     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRRMX  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     5121
     C                     END
     C*
     C** IF ENTERED & NUMERIC,IT MUST BE GREATER THAN THE MINIMUM
     C** CHARGE ENTERED
     C*
     C           *IN47     IFEQ '0'
     C           *IN51     ANDEQ'0'
     C           WRRMX     ANDNE*ZERO
     C           WRRMX     ANDLEWRRMN
     C                     SETON                     5130
     C                     END
     C*
     C********************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT 2 MAXIMUM CHARGE **
     C********************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRRMX2    ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRRMX2 110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     7821
     C                     END
     C*
     C** IF ENTERED & NUMERIC,IT MUST BE GREATER THAN THE MINIMUM
     C** CHARGE ENTERED
     C*
     C           *IN76     IFEQ '0'
     C           *IN78     ANDEQ'0'
     C           WRRMX2    ANDNE*ZERO
     C           WRRMX2    ANDLEWRRMN2
     C                     SETON                     7830
     C                     END
     C*
     C********************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT 3 MAXIMUM CHARGE **
     C********************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRRMX3    ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRRMX3 110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     7921
     C                     END
     C*
     C** IF ENTERED & NUMERIC,IT MUST BE GREATER THAN THE MINIMUM
     C** CHARGE ENTERED
     C*
     C           *IN77     IFEQ '0'
     C           *IN79     ANDEQ'0'
     C           WRRMX3    ANDNE*ZERO
     C           WRRMX3    ANDLEWRRMN3
     C                     SETON                     7930
     C                     END
     C*
     C********************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT 4 MAXIMUM CHARGE **
     C********************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRRMX4    ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRRMX4 110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     0621
     C                     END
     C*
     C** IF ENTERED & NUMERIC,IT MUST BE GREATER THAN THE MINIMUM
     C** CHARGE ENTERED
     C*
     C           *IN80     IFEQ '0'
     C           *IN06     ANDEQ'0'
     C           WRRMX4    ANDNE*ZERO
     C           WRRMX4    ANDLEWRRMN4
     C                     SETON                     0630
     C                     END
     C*
     C********************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT 5 MAXIMUM CHARGE **
     C********************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRRMX5    ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRRMX5 110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     0721
     C                     END
     C*
     C** IF ENTERED & NUMERIC,IT MUST BE GREATER THAN THE MINIMUM
     C** CHARGE ENTERED
     C*
     C           *IN81     IFEQ '0'
     C           *IN07     ANDEQ'0'
     C           WRRMX5    ANDNE*ZERO
     C           WRRMX5    ANDLEWRRMN5
     C                     SETON                     0730
     C                     END
     C*
     C********************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT 6 MAXIMUM CHARGE **
     C********************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRRMX6    ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRRMX6 110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     0921
     C                     END
     C*
     C** IF ENTERED & NUMERIC,IT MUST BE GREATER THAN THE MINIMUM
     C** CHARGE ENTERED
     C*
     C           *IN82     IFEQ '0'
     C           *IN09     ANDEQ'0'
     C           WRRMX6    ANDNE*ZERO
     C           WRRMX6    ANDLEWRRMN6
     C                     SETON                     0930
     C                     END
     C*
     C********************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT 7 MAXIMUM CHARGE **
     C********************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRRMX7    ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRRMX7 110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     3721
     C                     END
     C*
     C** IF ENTERED & NUMERIC,IT MUST BE GREATER THAN THE MINIMUM
     C** CHARGE ENTERED
     C*
     C           *IN83     IFEQ '0'
     C           *IN37     ANDEQ'0'
     C           WRRMX7    ANDNE*ZERO
     C           WRRMX7    ANDLEWRRMN7
     C                     SETON                     3730
     C                     END
     C*
     C********************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT 8 MAXIMUM CHARGE **
     C********************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRRMX8    ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRRMX8 110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     3921
     C                     END
     C*
     C** IF ENTERED & NUMERIC,IT MUST BE GREATER THAN THE MINIMUM
     C** CHARGE ENTERED
     C*
     C           *IN84     IFEQ '0'
     C           *IN39     ANDEQ'0'
     C           WRRMX8    ANDNE*ZERO
     C           WRRMX8    ANDLEWRRMN8
     C                     SETON                     3930
     C                     END
     C*
     C********************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT 9 MAXIMUM CHARGE **
     C********************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRRMX9    ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRRMX9 110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     1021
     C                     END
     C*
     C** IF ENTERED & NUMERIC,IT MUST BE GREATER THAN THE MINIMUM
     C** CHARGE ENTERED
     C*
     C           *IN85     IFEQ '0'
     C           *IN10     ANDEQ'0'
     C           WRRMX9    ANDNE*ZERO
     C           WRRMX9    ANDLEWRRMN9
     C                     SETON                     1030
     C                     END
     C*
     C********************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT 10 MAXIMUM CHARGE **
     C********************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SRRMX0    ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WRRMX0 110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     3821
     C                     END
     C*
     C** IF ENTERED & NUMERIC,IT MUST BE GREATER THAN THE MINIMUM
     C** CHARGE ENTERED
     C*
     C           *IN31     IFEQ '0'
     C           *IN38     ANDEQ'0'
     C           WRRMX0    ANDNE*ZERO
     C           WRRMX0    ANDLEWRRMN0
     C                     SETON                     3830
     C                     END
     C*
     C*************************************************************
     C** CHECK INTERDEPENDENCIES BETWEEN RES. TO NON-RES. FIELDS **
     C*************************************************************
     C** IF RANGE 1 START WAS NOT ENTERED,NONE OF THE SUBSEQUENT
     C** RES. TO NON-RES. FIELDS MAY BE EITHER
     C*
     C           WRRS1     IFEQ *ZERO
     C           WRRE1     IFNE *ZERO
     C           WRRR1     ORNE *ZERO
     C           WRRS2     ORNE *ZERO
     C           WRRE2     ORNE *ZERO
     C           WRRR2     ORNE *ZERO
     C           WRRMN     ORNE *ZERO
     C           WRRMN2    ORNE *ZERO
     C           WRRMN3    ORNE *ZERO
     C           WRRS3     ORNE *ZERO
     C           WRRE3     ORNE *ZERO
     C           WRRR3     ORNE *ZERO
     C           WRRMX     ORNE *ZERO
     C           WRRMX2    ORNE *ZERO
     C           WRRMX3    ORNE *ZERO
     C           WRRS4     ORNE *ZERO
     C           WRRE4     ORNE *ZERO
     C           WRRR4     ORNE *ZERO
     C           WRRMN4    ORNE *ZERO
     C           WRRMX4    ORNE *ZERO
     C           WRRS5     ORNE *ZERO
     C           WRRE5     ORNE *ZERO
     C           WRRR5     ORNE *ZERO
     C           WRRMN5    ORNE *ZERO
     C           WRRMX5    ORNE *ZERO
     C           WRRS6     ORNE *ZERO
     C           WRRE6     ORNE *ZERO
     C           WRRR6     ORNE *ZERO
     C           WRRMN6    ORNE *ZERO
     C           WRRMX6    ORNE *ZERO
     C           WRRS7     ORNE *ZERO
     C           WRRE7     ORNE *ZERO
     C           WRRR7     ORNE *ZERO
     C           WRRMN7    ORNE *ZERO
     C           WRRMX7    ORNE *ZERO
     C           WRRS8     ORNE *ZERO
     C           WRRE8     ORNE *ZERO
     C           WRRR8     ORNE *ZERO
     C           WRRMN8    ORNE *ZERO
     C           WRRMX8    ORNE *ZERO
     C           WRRS9     ORNE *ZERO
     C           WRRE9     ORNE *ZERO
     C           WRRR9     ORNE *ZERO
     C           WRRMN9    ORNE *ZERO
     C           WRRMX9    ORNE *ZERO
     C           WRRS0     ORNE *ZERO
     C           WRRE0     ORNE *ZERO
     C           WRRR0     ORNE *ZERO
     C           WRRMN0    ORNE *ZERO
     C           WRRMX0    ORNE *ZERO
     C                     SETON                     4122
     C                     END
     C                     END
     C*
     C** IF RANGE 2 START WAS NOT ENTERED,NONE OF THE SUBSEQUENT
     C** RES. TO NON-RES. START,END,RATE FIELDS MAY BE EITHER
     C*
     C           WRRS2     IFEQ *ZERO
     C           WRRE2     IFNE *ZERO
     C           WRRR2     ORNE *ZERO
     C           WRRMN2    ORNE *ZERO                                     074806
     C           WRRMX2    ORNE *ZERO                                     074806
     C           WRRS3     ORNE *ZERO
     C           WRRE3     ORNE *ZERO
     C           WRRR3     ORNE *ZERO
     C           WRRMN3    ORNE *ZERO                                     074806
     C           WRRMX3    ORNE *ZERO                                     074806
     C           WRRS4     ORNE *ZERO
     C           WRRE4     ORNE *ZERO
     C           WRRR4     ORNE *ZERO
     C           WRRMN4    ORNE *ZERO                                     074806
     C           WRRMX4    ORNE *ZERO                                     074806
     C           WRRS5     ORNE *ZERO
     C           WRRE5     ORNE *ZERO
     C           WRRR5     ORNE *ZERO
     C           WRRMN5    ORNE *ZERO                                     074806
     C           WRRMX5    ORNE *ZERO                                     074806
     C           WRRS6     ORNE *ZERO
     C           WRRE6     ORNE *ZERO
     C           WRRR6     ORNE *ZERO
     C           WRRMN6    ORNE *ZERO                                     074806
     C           WRRMX6    ORNE *ZERO                                     074806
     C           WRRS7     ORNE *ZERO
     C           WRRE7     ORNE *ZERO
     C           WRRR7     ORNE *ZERO
     C           WRRMN7    ORNE *ZERO                                     074806
     C           WRRMX7    ORNE *ZERO                                     074806
     C           WRRS8     ORNE *ZERO
     C           WRRE8     ORNE *ZERO
     C           WRRR8     ORNE *ZERO
     C           WRRMN8    ORNE *ZERO                                     074806
     C           WRRMX8    ORNE *ZERO                                     074806
     C           WRRS9     ORNE *ZERO
     C           WRRE9     ORNE *ZERO
     C           WRRR9     ORNE *ZERO
     C           WRRMN9    ORNE *ZERO                                     074806
     C           WRRMX9    ORNE *ZERO                                     074806
     C           WRRS0     ORNE *ZERO
     C           WRRE0     ORNE *ZERO
     C           WRRR0     ORNE *ZERO
     C           WRRMN0    ORNE *ZERO                                     074806
     C           WRRMX0    ORNE *ZERO                                     074806
     C                     SETON                     4427
     C                     END
     C                     END
     C*
     C** IF RANGE 3 START WAS NOT ENTERED,NONE OF THE SUBSEQUENT
     C** RES. TO NON-RES. END & RATE FIELDS MAY BE EITHER
     C*
     C           WRRS3     IFEQ *ZERO
     C           WRRE3     IFNE *ZERO
     C           WRRR3     ORNE *ZERO
     C           WRRMN3    ORNE *ZERO                                     074806
     C           WRRMX3    ORNE *ZERO                                     074806
     C           WRRS4     ORNE *ZERO
     C           WRRE4     ORNE *ZERO
     C           WRRR4     ORNE *ZERO
     C           WRRMN4    ORNE *ZERO                                     074806
     C           WRRMX4    ORNE *ZERO                                     074806
     C           WRRS5     ORNE *ZERO
     C           WRRE5     ORNE *ZERO
     C           WRRR5     ORNE *ZERO
     C           WRRMN5    ORNE *ZERO                                     074806
     C           WRRMX5    ORNE *ZERO                                     074806
     C           WRRS6     ORNE *ZERO
     C           WRRE6     ORNE *ZERO
     C           WRRR6     ORNE *ZERO
     C           WRRMN6    ORNE *ZERO                                     074806
     C           WRRMX6    ORNE *ZERO                                     074806
     C           WRRS7     ORNE *ZERO
     C           WRRE7     ORNE *ZERO
     C           WRRR7     ORNE *ZERO
     C           WRRMN7    ORNE *ZERO                                     074806
     C           WRRMX7    ORNE *ZERO                                     074806
     C           WRRS8     ORNE *ZERO
     C           WRRE8     ORNE *ZERO
     C           WRRR8     ORNE *ZERO
     C           WRRMN8    ORNE *ZERO                                     074806
     C           WRRMX8    ORNE *ZERO                                     074806
     C           WRRS9     ORNE *ZERO
     C           WRRE9     ORNE *ZERO
     C           WRRR9     ORNE *ZERO
     C           WRRMN9    ORNE *ZERO                                     074806
     C           WRRMX9    ORNE *ZERO                                     074806
     C           WRRS0     ORNE *ZERO
     C           WRRE0     ORNE *ZERO
     C           WRRR0     ORNE *ZERO
     C           WRRMN0    ORNE *ZERO                                     074806
     C           WRRMX0    ORNE *ZERO                                     074806
     C                     SETON                     4829
     C                     END
     C                     END
     C*
     C           WRRS4     IFEQ *ZERO
     C           WRRE4     IFNE *ZERO
     C           WRRR4     ORNE *ZERO
     C           WRRMN4    ORNE *ZERO                                     074806
     C           WRRMX4    ORNE *ZERO                                     074806
     C           WRRS5     ORNE *ZERO
     C           WRRE5     ORNE *ZERO
     C           WRRR5     ORNE *ZERO
     C           WRRMN5    ORNE *ZERO                                     074806
     C           WRRMX5    ORNE *ZERO                                     074806
     C           WRRS6     ORNE *ZERO
     C           WRRE6     ORNE *ZERO
     C           WRRR6     ORNE *ZERO
     C           WRRMN6    ORNE *ZERO                                     074806
     C           WRRMX6    ORNE *ZERO                                     074806
     C           WRRS7     ORNE *ZERO
     C           WRRE7     ORNE *ZERO
     C           WRRR7     ORNE *ZERO
     C           WRRMN7    ORNE *ZERO                                     074806
     C           WRRMX7    ORNE *ZERO                                     074806
     C           WRRS8     ORNE *ZERO
     C           WRRE8     ORNE *ZERO
     C           WRRR8     ORNE *ZERO
     C           WRRMN8    ORNE *ZERO                                     074806
     C           WRRMX8    ORNE *ZERO                                     074806
     C           WRRS9     ORNE *ZERO
     C           WRRE9     ORNE *ZERO
     C           WRRR9     ORNE *ZERO
     C           WRRMN9    ORNE *ZERO                                     074806
     C           WRRMX9    ORNE *ZERO                                     074806
     C           WRRS0     ORNE *ZERO
     C           WRRE0     ORNE *ZERO
     C           WRRR0     ORNE *ZERO
     C           WRRMN0    ORNE *ZERO                                     074806
     C           WRRMX0    ORNE *ZERO                                     074806
     C                     SETON                     5229
     C                     END
     C                     END
     C*
     C           WRRS5     IFEQ *ZERO
     C           WRRE5     IFNE *ZERO
     C           WRRR5     ORNE *ZERO
     C           WRRMN5    ORNE *ZERO                                     074806
     C           WRRMX5    ORNE *ZERO                                     074806
     C           WRRS6     ORNE *ZERO
     C           WRRE6     ORNE *ZERO
     C           WRRR6     ORNE *ZERO
     C           WRRMN6    ORNE *ZERO                                     074806
     C           WRRMX6    ORNE *ZERO                                     074806
     C           WRRS7     ORNE *ZERO
     C           WRRE7     ORNE *ZERO
     C           WRRR7     ORNE *ZERO
     C           WRRMN7    ORNE *ZERO                                     074806
     C           WRRMX7    ORNE *ZERO                                     074806
     C           WRRS8     ORNE *ZERO
     C           WRRE8     ORNE *ZERO
     C           WRRR8     ORNE *ZERO
     C           WRRMN8    ORNE *ZERO                                     074806
     C           WRRMX8    ORNE *ZERO                                     074806
     C           WRRS9     ORNE *ZERO
     C           WRRE9     ORNE *ZERO
     C           WRRR9     ORNE *ZERO
     C           WRRMN9    ORNE *ZERO                                     074806
     C           WRRMX9    ORNE *ZERO                                     074806
     C           WRRS0     ORNE *ZERO
     C           WRRE0     ORNE *ZERO
     C           WRRR0     ORNE *ZERO
     C           WRRMN0    ORNE *ZERO                                     074806
     C           WRRMX0    ORNE *ZERO                                     074806
     C                     SETON                     5529
     C                     END
     C                     END
     C*
     C           WRRS6     IFEQ *ZERO
     C           WRRE6     IFNE *ZERO
     C           WRRR6     ORNE *ZERO
     C           WRRMN6    ORNE *ZERO                                     074806
     C           WRRMX6    ORNE *ZERO                                     074806
     C           WRRS7     ORNE *ZERO
     C           WRRE7     ORNE *ZERO
     C           WRRR7     ORNE *ZERO
     C           WRRMN7    ORNE *ZERO                                     074806
     C           WRRMX7    ORNE *ZERO                                     074806
     C           WRRS8     ORNE *ZERO
     C           WRRE8     ORNE *ZERO
     C           WRRR8     ORNE *ZERO
     C           WRRMN8    ORNE *ZERO                                     074806
     C           WRRMX8    ORNE *ZERO                                     074806
     C           WRRS9     ORNE *ZERO
     C           WRRE9     ORNE *ZERO
     C           WRRR9     ORNE *ZERO
     C           WRRMN9    ORNE *ZERO                                     074806
     C           WRRMX9    ORNE *ZERO                                     074806
     C           WRRS0     ORNE *ZERO
     C           WRRE0     ORNE *ZERO
     C           WRRR0     ORNE *ZERO
     C           WRRMN0    ORNE *ZERO                                     074806
     C           WRRMX0    ORNE *ZERO                                     074806
     C                     SETON                     5829
     C                     END
     C                     END
     C*
     C           WRRS7     IFEQ *ZERO
     C           WRRE7     IFNE *ZERO
     C           WRRR7     ORNE *ZERO
     C           WRRMN7    ORNE *ZERO                                     074806
     C           WRRMX7    ORNE *ZERO                                     074806
     C           WRRS8     ORNE *ZERO
     C           WRRE8     ORNE *ZERO
     C           WRRR8     ORNE *ZERO
     C           WRRMN8    ORNE *ZERO                                     074806
     C           WRRMX8    ORNE *ZERO                                     074806
     C           WRRS9     ORNE *ZERO
     C           WRRE9     ORNE *ZERO
     C           WRRR9     ORNE *ZERO
     C           WRRMN9    ORNE *ZERO                                     074806
     C           WRRMX9    ORNE *ZERO                                     074806
     C           WRRS0     ORNE *ZERO
     C           WRRE0     ORNE *ZERO
     C           WRRR0     ORNE *ZERO
     C           WRRMN0    ORNE *ZERO                                     074806
     C           WRRMX0    ORNE *ZERO                                     074806
     C                     SETON                     6129
     C                     END
     C                     END
     C*
     C*
     C           WRRS8     IFEQ *ZERO
     C           WRRE8     IFNE *ZERO
     C           WRRR8     ORNE *ZERO
     C           WRRMN8    ORNE *ZERO                                     074806
     C           WRRMX8    ORNE *ZERO                                     074806
     C           WRRS9     ORNE *ZERO
     C           WRRE9     ORNE *ZERO
     C           WRRR9     ORNE *ZERO
     C           WRRMN9    ORNE *ZERO                                     074806
     C           WRRMX9    ORNE *ZERO                                     074806
     C           WRRS0     ORNE *ZERO
     C           WRRE0     ORNE *ZERO
     C           WRRR0     ORNE *ZERO
     C           WRRMN0    ORNE *ZERO                                     074806
     C           WRRMX0    ORNE *ZERO                                     074806
     C                     SETON                     6429
     C                     END
     C                     END
     C*
     C           WRRS9     IFEQ *ZERO
     C           WRRE9     IFNE *ZERO
     C           WRRR9     ORNE *ZERO
     C           WRRMN9    ORNE *ZERO                                     074806
     C           WRRMX9    ORNE *ZERO                                     074806
     C           WRRS0     ORNE *ZERO
     C           WRRE0     ORNE *ZERO
     C           WRRR0     ORNE *ZERO
     C           WRRMN0    ORNE *ZERO                                     074806
     C           WRRMX0    ORNE *ZERO                                     074806
     C                     SETON                     6729
     C                     END
     C                     END
     C*
     C           WRRS0     IFEQ *ZERO
     C           WRRE0     IFNE *ZERO
     C           WRRR0     ORNE *ZERO
     C           WRRMN0    ORNE *ZERO                                     074806
     C           WRRMX0    ORNE *ZERO                                     074806
     C                     SETON                     0129
     C                     END
     C                     END
     C*
     C*
     C           STR4C     IFEQ '1'
     C           STR4C     OREQ '2'
     C                     ELSE
     C                     SETON                     04
     C                     MOVEL'FTM2537' ZAMSID                          074804
     C                     EXSR SRSNDM                                    074804
     C                     END
     C*
     C*****************************************************************
     C**  SETUP ERROR CODE ARRAY DEPENDING ON WHICH INDICATORS HAVE  **
     C**  BEEN SET ABOVE.                                            **
     C*****************************************************************
     C*
     C                     Z-ADD*ZERO     I       30
     C                     MOVEL*BLANKS   ERCD
     C***********                                                         074804
     C************IN04     IFEQ '1'                                       074804
     C***********          ADD  1         I                               074804
     C***********          MOVE '377'     ERCD,I                          074804
     C***********          END                                            074804
     C*
     C           *IN21     IFEQ '1'
     C                     ADD  1         I
     C                     MOVE '004'     ERCD,I
     C                     END
     C*
     C           *IN22     IFEQ '1'
     C                     ADD  1         I
     C                     MOVE '005'     ERCD,I
     C                     END
     C*
     C           *IN23     IFEQ '1'
     C                     ADD  1         I
     C                     MOVE '006'     ERCD,I
     C                     END
     C*
     C           *IN24     IFEQ '1'
     C                     ADD  1         I
     C                     MOVE '007'     ERCD,I
     C                     END
     C*
     C           *IN25     IFEQ '1'
     C                     ADD  1         I
     C                     MOVE '008'     ERCD,I
     C                     END
     C*
     C           *IN26     IFEQ '1'
     C                     ADD  1         I
     C                     MOVE '009'     ERCD,I
     C                     END
     C*
     C           *IN27     IFEQ '1'
     C                     ADD  1         I
     C                     MOVE '010'     ERCD,I
     C                     END
     C*
     C           *IN28     IFEQ '1'
     C                     ADD  1         I
     C                     MOVE '011'     ERCD,I
     C                     END
     C*
     C           *IN29     IFEQ '1'
     C                     ADD  1         I
     C                     MOVE '012'     ERCD,I
     C                     END
     C*
     C           *IN30     IFEQ '1'
     C                     ADD  1         I
     C                     MOVE '013'     ERCD,I
     C                     END
     C*
     C           *IN32     IFEQ '1'
     C                     ADD  1         I
     C                     MOVE '015'     ERCD,I
     C                     END
     C*
     C           *IN33     IFEQ '1'
     C                     ADD  1         I
     C                     MOVE '016'     ERCD,I
     C                     END
     C*
     C           *IN34     IFEQ '1'
     C                     ADD  1         I
     C                     MOVE '017'     ERCD,I
     C                     END
     C*
     C           *IN35     IFEQ '1'
     C                     ADD  1         I
     C                     MOVE '018'     ERCD,I
     C                     END
     C*
     C           *IN36     IFEQ '1'
     C                     ADD  1         I
     C                     MOVE '183'     ERCD,I
     C                     END
     C*
     C************IN67     IFEQ '1'                                       074804
     C***********          ADD  1         I                               074804
     C***********          MOVE '375'     ERCD,I                          074804
     C***********          ADD  1         I                               074804
     C***********          MOVE '376'     ERCD,I                          074804
     C***********          END                                            074804
     C***********                                                         074804
     C************IN68     IFEQ '1'                                       074804
     C***********          ADD  1         I                               074804
     C***********          MOVE '377'     ERCD,I                          074804
     C***********          END                                            074804
     C***********                                                         074804
     C************IN69     IFEQ '1'                                       074804
     C***********          ADD  1         I                               074804
     C***********          MOVE '377'     ERCD,I                          074804
     C***********          END                                            074804
     C*
     C           *IN18     IFEQ '1'
     C                     ADD  1         I
     C                     MOVE '377'     ERCD,I
     C                     END
     C*
     C           *IN70     IFEQ '1'
     C                     ADD  1         I
     C                     MOVE '377'     ERCD,I
     C                     END
     C*
     C************IN84     IFEQ '1'                                       074804
     C***********          ADD  1         I                               074804
     C***********          MOVE '377'     ERCD,I                          074804
     C***********          END                                            074804
     C***********                                                         074804
     C************IN85     IFEQ '1'                                       074804
     C***********          ADD  1         I                               074804
     C***********          MOVE '379'     ERCD,I                          074804
     C***********          END                                            074804
     C***********                                                         074804
     C************IN31     IFEQ '1'                                       074804
     C***********          ADD  1         I                               074804
     C***********          MOVE '381'     ERCD,I                          074804
     C***********          END                                            074804
     C***********                                                         074804
     C************IN06     IFEQ '1'                                       074804
     C***********          ADD  1         I                               074804
     C***********          MOVE '378'     ERCD,I                          074804
     C***********          END                                            074804
     C***********                                                         074804
     C************IN07     IFEQ '1'                                       074804
     C***********          ADD  1         I                               074804
     C***********          MOVE '380'     ERCD,I                          074804
     C***********          END                                            074804
     C*
     C** CHECK IF ANY ERRORS HAVE BEEN FOUND
     C*
     C           I         IFGT *ZERO
     C                     SETON                     74
     C           I         IFGT 19
     C                     SETON                     75
     C                     END
     C                     END
     C*
     C*          *****     *****
     C           GAEND4    ENDSR
     C*          *****     *****
     C/EJECT
     C           GAVAL5    BEGSR
     C*          ******    *****
     C*
     C*****************************************************************
     C*                 GA-VALIDATE-DETAIL-INPUT                      *
     C*                                                               *
     C*  FUNCTION : TO PERFORM VALIDATION OF ALL DETAIL FIELDS        *
     C*             ENTERED,SETON APPROPRIATE INDICATORS AND SETUP    *
     C*             THE ARRAY OF APPROPRIATE ERROR CODES FOR DISPLAY. *
     C*                                                               *
     C*  CALLS :    ZALIGN                                            *
     C*                                                               *
     C*  CALLED BY: EAINP5                                            *
     C*                                                               *
     C*****************************************************************
     C*
     C** CLEAR ERROR INDICATORS & ERROR CODES ARRAY
     C*
     C                     MOVEL*BLANKS   ERCD
     C                     EXSR SRCLRM                                    074804
     C*
     C                     MOVEA'0000'    *IN,01
     C                     MOVEA'00'      *IN,06
     C                     MOVEA'00'      *IN,09
     C                     MOVEA'00000000'*IN,21
     C                     MOVEA'00000000'*IN,29
     C                     MOVEA'000'     *IN,37
     C                     MOVEA'00000000'*IN,40
     C                     MOVEA'00000000'*IN,48
     C                     MOVEA'00000000'*IN,56
     C                     MOVEA'000000'  *IN,64
     C                     MOVEA*ZERO     *IN,74
     C                     MOVEA'00000000'*IN,80
     C                     MOVE '0'       *IN18
     C                     MOVE '0'       *IN70
     C*
     C*****************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 1 START **
     C*****************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCRS1     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCRS1  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     4121
     C                     END
     C*
     C***************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 1 END **
     C***************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCRE1     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCRE1  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     4221
     C                     END
     C*
     C** FIELD MUST BE ENTERED IF RANGE START WAS
     C*
     C           *IN42     IFEQ '0'
     C           WCRS1     ANDNE*ZERO
     C           WCRE1     ANDEQ*ZERO
     C                     SETON                     4223
     C                     END
     C*
     C** FIELD MUST BE GREATER THAN RANGE START
     C*
     C           *IN41     IFEQ '0'
     C           *IN42     ANDEQ'0'
     C           WCRS1     ANDNE*ZERO
     C           WCRE1     ANDLEWCRS1
     C                     SETON                     4224
     C                     END
     C*
     C****************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 1 RATE **
     C****************************************************
     C** FIELD MUST BE 13-LONG NUMERIC WITH UPTO 8 D.P.S AND UPTO 5
     C** DIGITS BEFORE THE DECIMAL POINT
     C*
     C                     Z-ADD8         ZADEC
     C                     Z-ADD5         ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCRR1     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCRR1  138
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     4326
     C                     END
     C*
     C** FIELD MUST BE ENTERED IF RANGE START WAS
     C*
     C           SCH4C     IFEQ '1'                                       093336
     C           *IN43     IFEQ '0'
     C           WCRS1     ANDNE*ZERO
     C           WCRR1     ANDEQ*ZERO
     C                     SETON                     4325
     C                     END
     C                     END                                            093336
     C*
     C*****************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 2 START **
     C*****************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCRS2     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCRS2  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     4421
     C                     END
     C*
     C** IF NUMERIC, IT MUST EQUAL RANGE 1 END + SMALLEST UNIT OF
     C** BASE CURRENCY POSSIBLE
     C*
     C           *IN44     IFEQ '0'
     C           *IN43     ANDEQ'0'
     C           WCRE1     ANDNE*ZERO
     C           WCRS2     ANDNE*ZERO
     C           WCRE1     ADD  1         WN11   110
     C           WN11      IFNE WCRS2
     C                     SETON                     4428
     C                     END
     C                     END
     C*
     C***************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 2 END **
     C***************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCRE2     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCRE2  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     4521
     C                     END
     C*
     C** FIELD MUST BE ENTERED IF RANGE START WAS
     C*
     C           *IN45     IFEQ '0'
     C           WCRS2     ANDNE*ZERO
     C           WCRE2     ANDEQ*ZERO
     C                     SETON                     4523
     C                     END
     C*
     C** FIELD MUST BE GREATER THAN RANGE START
     C*
     C           *IN44     IFEQ '0'
     C           *IN45     ANDEQ'0'
     C           WCRS2     ANDNE*ZERO
     C           WCRE2     ANDLEWCRS2
     C                     SETON                     4524
     C                     END
     C*
     C****************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 2 RATE **
     C****************************************************
     C** FIELD MUST BE 13-LONG NUMERIC WITH UPTO 8 D.P.S AND UPTO 5
     C** DIGITS BEFORE THE DECIMAL POINT
     C*
     C                     Z-ADD8         ZADEC
     C                     Z-ADD5         ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCRR2     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCRR2  138
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     4626
     C                     END
     C*
     C** FIELD MUST BE ENTERED IF RANGE START WAS
     C*
     C           SCH4C     IFEQ '1'                                       093336
     C           *IN46     IFEQ '0'
     C           WCRS2     ANDNE*ZERO
     C           WCRR2     ANDEQ*ZERO
     C                     SETON                     4625
     C                     END
     C                     END                                            093336
     C*
     C******************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT MINIMUM CHARGE **
     C******************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCRMN1    ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCRMN1 110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     4721
     C                     END
     C*
     C********************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT 2 MINIMUM CHARGE **
     C********************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCRMN2    ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCRMN2 110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     7621
     C                     END
     C*
     C********************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT 3 MINIMUM CHARGE **
     C********************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCRMN3    ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCRMN3 110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     7721
     C                     END
     C*
     C********************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT 4 MINIMUM CHARGE **
     C********************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCRMN4    ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCRMN4 110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     8021
     C                     END
     C*
     C********************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT 5 MINIMUM CHARGE **
     C********************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCRMN5    ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCRMN5 110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     8121
     C                     END
     C*
     C********************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT 6 MINIMUM CHARGE **
     C********************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCRMN6    ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCRMN6 110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     8221
     C                     END
     C*
     C********************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT 7 MINIMUM CHARGE **
     C********************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCRMN7    ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCRMN7 110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     8321
     C                     END
     C*
     C********************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT 8 MINIMUM CHARGE **
     C********************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCRMN8    ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCRMN8 110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     8421
     C                     END
     C*
     C********************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT 9 MINIMUM CHARGE **
     C********************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCRMN9    ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCRMN9 110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     8521
     C                     END
     C*
     C********************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT 10 MINIMUM CHARGE **
     C********************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCRMN0    ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCRMN0 110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     3121
     C                     END
     C*
     C*****************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 3 START **
     C*****************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCRS3     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCRS3  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     4821
     C                     END
     C*
     C** IF NUMERIC, IT MUST EQUAL RANGE 2 END + SMALLEST UNIT OF
     C** BASE CURRENCY POSSIBLE
     C*
     C           *IN48     IFEQ '0'
     C           *IN46     ANDEQ'0'
     C           WCRE2     ANDNE*ZERO
     C           WCRS3     ANDNE*ZERO
     C           WCRE2     ADD  1         WN11
     C           WN11      IFNE WCRS3
     C                     SETON                     4828
     C                     END
     C                     END
     C*
     C***************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 3 END **
     C***************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCRE3     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCRE3  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     4921
     C                     END
     C*
     C** FIELD MUST BE ENTERED IF RANGE START WAS
     C*
     C           *IN49     IFEQ '0'
     C           WCRS3     ANDNE*ZERO
     C           WCRE3     ANDEQ*ZERO
     C***********          SETON                     4928                 074804
     C                     SETON                     4923                 074804
     C                     END
     C*
     C** FIELD MUST BE GREATER THAN RANGE START
     C*
     C           *IN48     IFEQ '0'
     C           *IN49     ANDEQ'0'
     C           WCRS3     ANDNE*ZERO
     C           WCRE3     ANDLEWCRS3
     C                     SETON                     4924
     C                     END
     C*
     C****************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 3 RATE **
     C****************************************************
     C** FIELD MUST BE 13-LONG NUMERIC WITH UPTO 8 D.P.S AND UPTO 5
     C** DIGITS BEFORE THE DECIMAL POINT
     C*
     C                     Z-ADD8         ZADEC
     C                     Z-ADD5         ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCRR3     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCRR3  138
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     5026
     C                     END
     C*
     C** FIELD MUST BE ENTERED IF RANGE START WAS
     C*
     C           SCH4C     IFEQ '1'                                       093336
     C           *IN50     IFEQ '0'
     C           WCRS3     ANDNE*ZERO
     C           WCRR3     ANDEQ*ZERO
     C                     SETON                     5025
     C                     END
     C                     END                                            093336
     C*
     C*
     C*****************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 4 START **
     C*****************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCRS4     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCRS4  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     5221
     C                     END
     C*
     C** IF NUMERIC, IT MUST EQUAL RANGE 2 END + SMALLEST UNIT OF
     C** BASE CURRENCY POSSIBLE
     C*
     C           *IN52     IFEQ '0'
     C           *IN50     ANDEQ'0'
     C           WCRE3     ANDNE*ZERO
     C           WCRS4     ANDNE*ZERO
     C           WCRE3     ADD  1         WN11
     C           WN11      IFNE WCRS4
     C                     SETON                     5228
     C                     END
     C                     END
     C*
     C***************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 4 END **
     C***************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCRE4     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCRE4  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     5321
     C                     END
     C*
     C** FIELD MUST BE ENTERED IF RANGE START WAS
     C*
     C           *IN53     IFEQ '0'
     C           WCRS4     ANDNE*ZERO
     C           WCRE4     ANDEQ*ZERO
     C***********          SETON                     5328                 074804
     C                     SETON                     5323                 074804
     C                     END
     C*
     C** FIELD MUST BE GREATER THAN RANGE START
     C*
     C           *IN53     IFEQ '0'
     C           *IN52     ANDEQ'0'
     C           WCRS4     ANDNE*ZERO
     C           WCRE4     ANDLEWCRS4
     C                     SETON                     5324
     C                     END
     C*
     C****************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 4 RATE **
     C****************************************************
     C** FIELD MUST BE 13-LONG NUMERIC WITH UPTO 8 D.P.S AND UPTO 5
     C** DIGITS BEFORE THE DECIMAL POINT
     C*
     C                     Z-ADD8         ZADEC
     C                     Z-ADD5         ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCRR4     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCRR4  138
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     5426
     C                     END
     C*
     C** FIELD MUST BE ENTERED IF RANGE START WAS
     C*
     C           SCH4C     IFEQ '1'                                       093336
     C           *IN54     IFEQ '0'
     C           WCRS4     ANDNE*ZERO
     C           WCRR4     ANDEQ*ZERO
     C                     SETON                     5425
     C                     END
     C                     END                                            093336
     C*
     C*
     C*****************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 5 START **
     C*****************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCRS5     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCRS5  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     5521
     C                     END
     C*
     C** IF NUMERIC, IT MUST EQUAL RANGE 2 END + SMALLEST UNIT OF
     C** BASE CURRENCY POSSIBLE
     C*
     C           *IN55     IFEQ '0'
     C           *IN54     ANDEQ'0'
     C           WCRE4     ANDNE*ZERO
     C           WCRS5     ANDNE*ZERO
     C           WCRE4     ADD  1         WN11
     C           WN11      IFNE WCRS5
     C                     SETON                     5528
     C                     END
     C                     END
     C*
     C***************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 5 END **
     C***************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCRE5     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCRE5  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     5621
     C                     END
     C*
     C** FIELD MUST BE ENTERED IF RANGE START WAS
     C*
     C           *IN56     IFEQ '0'
     C           WCRS5     ANDNE*ZERO
     C           WCRE5     ANDEQ*ZERO
     C***********          SETON                     5628                 074804
     C                     SETON                     5623                 074804
     C                     END
     C*
     C** FIELD MUST BE GREATER THAN RANGE START
     C*
     C           *IN55     IFEQ '0'
     C           *IN56     ANDEQ'0'
     C           WCRS5     ANDNE*ZERO
     C           WCRE5     ANDLEWCRS5
     C                     SETON                     5624
     C                     END
     C*
     C****************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 5 RATE **
     C****************************************************
     C** FIELD MUST BE 13-LONG NUMERIC WITH UPTO 8 D.P.S AND UPTO 5
     C** DIGITS BEFORE THE DECIMAL POINT
     C*
     C                     Z-ADD8         ZADEC
     C                     Z-ADD5         ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCRR5     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCRR5  138
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     5726
     C                     END
     C*
     C** FIELD MUST BE ENTERED IF RANGE START WAS
     C*
     C           SCH4C     IFEQ '1'                                       093336
     C           *IN57     IFEQ '0'
     C           WCRS5     ANDNE*ZERO
     C           WCRR5     ANDEQ*ZERO
     C                     SETON                     5725
     C                     END
     C                     END                                            093336
     C*
     C*
     C*****************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 6 START **
     C*****************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCRS6     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCRS6  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     5821
     C                     END
     C*
     C** IF NUMERIC, IT MUST EQUAL RANGE 2 END + SMALLEST UNIT OF
     C** BASE CURRENCY POSSIBLE
     C*
     C           *IN57     IFEQ '0'
     C           *IN58     ANDEQ'0'
     C           WCRE5     ANDNE*ZERO
     C           WCRS6     ANDNE*ZERO
     C           WCRE5     ADD  1         WN11
     C           WN11      IFNE WCRS6
     C                     SETON                     5828
     C                     END
     C                     END
     C*
     C***************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 6 END **
     C***************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCRE6     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCRE6  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     5921
     C                     END
     C*
     C** FIELD MUST BE ENTERED IF RANGE START WAS
     C*
     C           *IN59     IFEQ '0'
     C           WCRS6     ANDNE*ZERO
     C           WCRE6     ANDEQ*ZERO
     C***********          SETON                     5921                 074804
     C                     SETON                     5923                 074804
     C                     END
     C*
     C** FIELD MUST BE GREATER THAN RANGE START
     C*
     C           *IN58     IFEQ '0'
     C           *IN59     ANDEQ'0'
     C           WCRS6     ANDNE*ZERO
     C           WCRE6     ANDLEWCRS6
     C                     SETON                     5924
     C                     END
     C*
     C****************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 6 RATE **
     C****************************************************
     C** FIELD MUST BE 13-LONG NUMERIC WITH UPTO 8 D.P.S AND UPTO 5
     C** DIGITS BEFORE THE DECIMAL POINT
     C*
     C                     Z-ADD8         ZADEC
     C                     Z-ADD5         ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCRR6     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCRR6  138
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     6026
     C                     END
     C*
     C** FIELD MUST BE ENTERED IF RANGE START WAS
     C*
     C           SCH4C     IFEQ '1'                                       093336
     C           *IN60     IFEQ '0'
     C           WCRS6     ANDNE*ZERO
     C           WCRR6     ANDEQ*ZERO
     C                     SETON                     6025
     C                     END
     C                     END                                            093336
     C*
     C*
     C*****************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 7 START **
     C*****************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCRS7     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCRS7  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     6121
     C                     END
     C*
     C** IF NUMERIC, IT MUST EQUAL RANGE 2 END + SMALLEST UNIT OF
     C** BASE CURRENCY POSSIBLE
     C*
     C           *IN60     IFEQ '0'
     C           *IN61     ANDEQ'0'
     C           WCRE6     ANDNE*ZERO
     C           WCRS7     ANDNE*ZERO
     C           WCRE6     ADD  1         WN11
     C           WN11      IFNE WCRS7
     C                     SETON                     6128
     C                     END
     C                     END
     C*
     C***************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 7 END **
     C***************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCRE7     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCRE7  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     6221
     C                     END
     C*
     C** FIELD MUST BE ENTERED IF RANGE START WAS
     C*
     C           *IN62     IFEQ '0'
     C           WCRS7     ANDNE*ZERO
     C           WCRE7     ANDEQ*ZERO
     C***********          SETON                     6228                 074804
     C                     SETON                     6223                 074804
     C                     END
     C*
     C** FIELD MUST BE GREATER THAN RANGE START
     C*
     C           *IN61     IFEQ '0'
     C           *IN62     ANDEQ'0'
     C           WCRS7     ANDNE*ZERO
     C           WCRE7     ANDLEWCRS7
     C                     SETON                     6224
     C                     END
     C*
     C****************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 7 RATE **
     C****************************************************
     C** FIELD MUST BE 13-LONG NUMERIC WITH UPTO 8 D.P.S AND UPTO 5
     C** DIGITS BEFORE THE DECIMAL POINT
     C*
     C                     Z-ADD8         ZADEC
     C                     Z-ADD5         ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCRR7     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCRR7  138
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     6326
     C                     END
     C*
     C** FIELD MUST BE ENTERED IF RANGE START WAS
     C*
     C           SCH4C     IFEQ '1'                                       093336
     C           *IN63     IFEQ '0'
     C           WCRS7     ANDNE*ZERO
     C           WCRR7     ANDEQ*ZERO
     C                     SETON                     6325
     C                     END
     C                     END                                            093336
     C*
     C*
     C*****************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 8 START **
     C*****************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCRS8     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCRS8  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     6421
     C                     END
     C*
     C** IF NUMERIC, IT MUST EQUAL RANGE 2 END + SMALLEST UNIT OF
     C** BASE CURRENCY POSSIBLE
     C*
     C           *IN63     IFEQ '0'
     C           *IN64     ANDEQ'0'
     C           WCRE7     ANDNE*ZERO
     C           WCRS8     ANDNE*ZERO
     C           WCRE7     ADD  1         WN11
     C           WN11      IFNE WCRS8
     C                     SETON                     6428
     C                     END
     C                     END
     C*
     C***************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 8 END **
     C***************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCRE8     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCRE8  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     6521
     C                     END
     C*
     C** FIELD MUST BE ENTERED IF RANGE START WAS
     C*
     C           *IN65     IFEQ '0'
     C           WCRS8     ANDNE*ZERO
     C           WCRE8     ANDEQ*ZERO
     C***********          SETON                     6528                 074804
     C                     SETON                     6523                 074804
     C                     END
     C*
     C** FIELD MUST BE GREATER THAN RANGE START
     C*
     C           *IN64     IFEQ '0'
     C           *IN65     ANDEQ'0'
     C           WCRS8     ANDNE*ZERO
     C           WCRE8     ANDLEWCRS8
     C                     SETON                     6524
     C                     END
     C*
     C****************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 8 RATE **
     C****************************************************
     C** FIELD MUST BE 13-LONG NUMERIC WITH UPTO 8 D.P.S AND UPTO 5
     C** DIGITS BEFORE THE DECIMAL POINT
     C*
     C                     Z-ADD8         ZADEC
     C                     Z-ADD5         ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCRR8     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCRR8  138
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     6626
     C                     END
     C*
     C** FIELD MUST BE ENTERED IF RANGE START WAS
     C*
     C           SCH4C     IFEQ '1'                                       093336
     C           *IN66     IFEQ '0'
     C           WCRS8     ANDNE*ZERO
     C           WCRR8     ANDEQ*ZERO
     C                     SETON                     6625
     C                     END
     C                     END                                            093336
     C*
     C*
     C*****************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 9 START **
     C*****************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCRS9     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCRS9  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     6721
     C                     END
     C*
     C** IF NUMERIC, IT MUST EQUAL RANGE 2 END + SMALLEST UNIT OF
     C** BASE CURRENCY POSSIBLE
     C*
     C           *IN66     IFEQ '0'
     C           *IN67     ANDEQ'0'
     C           WCRE8     ANDNE*ZERO
     C           WCRS9     ANDNE*ZERO
     C           WCRE8     ADD  1         WN11
     C           WN11      IFNE WCRS9
     C                     SETON                     6728
     C                     END
     C                     END
     C*
     C***************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 9 END **
     C***************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCRE9     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCRE9  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     6821
     C                     END
     C*
     C** FIELD MUST BE ENTERED IF RANGE START WAS
     C*
     C           *IN68     IFEQ '0'
     C           WCRS9     ANDNE*ZERO
     C           WCRE9     ANDEQ*ZERO
     C***********          SETON                     6828                 074804
     C                     SETON                     6823                 074804
     C                     END
     C*
     C** FIELD MUST BE GREATER THAN RANGE START
     C*
     C           *IN67     IFEQ '0'
     C           *IN68     ANDEQ'0'
     C           WCRS9     ANDNE*ZERO
     C           WCRE9     ANDLEWCRS9
     C                     SETON                     6824
     C                     END
     C*
     C****************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 9 RATE **
     C****************************************************
     C** FIELD MUST BE 13-LONG NUMERIC WITH UPTO 8 D.P.S AND UPTO 5
     C** DIGITS BEFORE THE DECIMAL POINT
     C*
     C                     Z-ADD8         ZADEC
     C                     Z-ADD5         ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCRR9     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCRR9  138
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     6926
     C                     END
     C*
     C** FIELD MUST BE ENTERED IF RANGE START WAS
     C*
     C           SCH4C     IFEQ '1'                                       093336
     C           *IN69     IFEQ '0'
     C           WCRS9     ANDNE*ZERO
     C           WCRR9     ANDEQ*ZERO
     C                     SETON                     6925
     C                     END
     C                     END                                            093336
     C*
     C*****************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 10 START **
     C*****************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCRS0     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCRS0  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     0121
     C                     END
     C*
     C** IF NUMERIC, IT MUST EQUAL RANGE 2 END + SMALLEST UNIT OF
     C** BASE CURRENCY POSSIBLE
     C*
     C           *IN69     IFEQ '0'
     C           *IN01     ANDEQ'0'
     C           WCRE9     ANDNE*ZERO
     C           WCRS0     ANDNE*ZERO
     C           WCRE9     ADD  1         WN11
     C           WN11      IFNE WCRS0
     C                     SETON                     0128
     C                     END
     C                     END
     C*
     C***************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 10 END **
     C***************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCRE0     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCRE0  110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     0221
     C                     END
     C*
     C** FIELD MUST BE ENTERED IF RANGE START WAS
     C*
     C           *IN02     IFEQ '0'
     C           WCRS0     ANDNE*ZERO
     C           WCRE0     ANDEQ*ZERO
     C***********          SETON                     0228                 074804
     C                     SETON                     0223                 074804
     C                     END
     C*
     C** FIELD MUST BE GREATER THAN RANGE START
     C*
     C           *IN01     IFEQ '0'
     C           *IN02     ANDEQ'0'
     C           WCRS0     ANDNE*ZERO
     C           WCRE0     ANDLEWCRS0
     C                     SETON                     0224
     C                     END
     C*
     C****************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT RANGE 10 RATE **
     C****************************************************
     C** FIELD MUST BE 13-LONG NUMERIC WITH UPTO 8 D.P.S AND UPTO 5
     C** DIGITS BEFORE THE DECIMAL POINT
     C*
     C                     Z-ADD8         ZADEC
     C                     Z-ADD5         ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCRR0     ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCRR0  138
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     0326
     C                     END
     C*
     C** FIELD MUST BE ENTERED IF RANGE START WAS
     C*
     C           SCH4C     IFEQ '1'                                       093336
     C           *IN03     IFEQ '0'
     C           WCRS0     ANDNE*ZERO
     C           WCRR0     ANDEQ*ZERO
     C                     SETON                     0325
     C                     END
     C                     END                                            093336
     C*
     C******************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT MAXIMUM CHARGE **
     C******************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCRMX1    ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCRMX1 110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     5121
     C                     END
     C*
     C** IF ENTERED & NUMERIC,IT MUST BE GREATER THAN THE MINIMUM
     C** CHARGE ENTERED
     C*
     C           *IN47     IFEQ '0'
     C           *IN51     ANDEQ'0'
     C           WCRMX1    ANDNE*ZERO
     C           WCRMX1    ANDLEWCRMN1
     C                     SETON                     5130
     C                     END
     C*
     C********************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT 2 MAXIMUM CHARGE **
     C********************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCRMX2    ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCRMX2 110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     7821
     C                     END
     C*
     C** IF ENTERED & NUMERIC,IT MUST BE GREATER THAN THE MINIMUM
     C** CHARGE ENTERED
     C*
     C           *IN76     IFEQ '0'
     C           *IN78     ANDEQ'0'
     C           WCRMX2    ANDNE*ZERO
     C           WCRMX2    ANDLEWCRMN2
     C                     SETON                     7830
     C                     END
     C*
     C********************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT 3 MAXIMUM CHARGE **
     C********************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCRMX3    ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCRMX3 110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     7921
     C                     END
     C*
     C** IF ENTERED & NUMERIC,IT MUST BE GREATER THAN THE MINIMUM
     C** CHARGE ENTERED
     C*
     C           *IN77     IFEQ '0'
     C           *IN79     ANDEQ'0'
     C           WCRMX3    ANDNE*ZERO
     C           WCRMX3    ANDLEWCRMN3
     C                     SETON                     7930
     C                     END
     C*
     C********************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT 4 MAXIMUM CHARGE **
     C********************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCRMX4    ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCRMX4 110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     0621
     C                     END
     C*
     C** IF ENTERED & NUMERIC,IT MUST BE GREATER THAN THE MINIMUM
     C** CHARGE ENTERED
     C*
     C           *IN80     IFEQ '0'
     C           *IN06     ANDEQ'0'
     C           WCRMX4    ANDNE*ZERO
     C           WCRMX4    ANDLEWCRMN4
     C                     SETON                     0630
     C                     END
     C*
     C********************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT 5 MAXIMUM CHARGE **
     C********************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCRMX5    ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCRMX5 110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     0721
     C                     END
     C*
     C** IF ENTERED & NUMERIC,IT MUST BE GREATER THAN THE MINIMUM
     C** CHARGE ENTERED
     C*
     C           *IN81     IFEQ '0'
     C           *IN07     ANDEQ'0'
     C           WCRMX5    ANDNE*ZERO
     C           WCRMX5    ANDLEWCRMN5
     C                     SETON                     0730
     C                     END
     C*
     C********************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT 6 MAXIMUM CHARGE **
     C********************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCRMX6    ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCRMX6 110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     0921
     C                     END
     C*
     C** IF ENTERED & NUMERIC,IT MUST BE GREATER THAN THE MINIMUM
     C** CHARGE ENTERED
     C*
     C           *IN82     IFEQ '0'
     C           *IN09     ANDEQ'0'
     C           WCRMX6    ANDNE*ZERO
     C           WCRMX6    ANDLEWCRMN6
     C                     SETON                     0930
     C                     END
     C*
     C********************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT 7 MAXIMUM CHARGE **
     C********************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCRMX7    ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCRMX7 110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     3721
     C                     END
     C*
     C** IF ENTERED & NUMERIC,IT MUST BE GREATER THAN THE MINIMUM
     C** CHARGE ENTERED
     C*
     C           *IN83     IFEQ '0'
     C           *IN37     ANDEQ'0'
     C           WCRMX7    ANDNE*ZERO
     C           WCRMX7    ANDLEWCRMN7
     C                     SETON                     3730
     C                     END
     C*
     C********************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT 8 MAXIMUM CHARGE **
     C********************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCRMX8    ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCRMX8 110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     3921
     C                     END
     C*
     C** IF ENTERED & NUMERIC,IT MUST BE GREATER THAN THE MINIMUM
     C** CHARGE ENTERED
     C*
     C           *IN84     IFEQ '0'
     C           *IN39     ANDEQ'0'
     C           WCRMX8    ANDNE*ZERO
     C           WCRMX8    ANDLEWCRMN8
     C                     SETON                     3930
     C                     END
     C*
     C********************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT 9 MAXIMUM CHARGE **
     C********************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCRMX9    ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCRMX9 110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     1021
     C                     END
     C*
     C** IF ENTERED & NUMERIC,IT MUST BE GREATER THAN THE MINIMUM
     C** CHARGE ENTERED
     C*
     C           *IN85     IFEQ '0'
     C           *IN10     ANDEQ'0'
     C           WCRMX9    ANDNE*ZERO
     C           WCRMX9    ANDLEWCRMN9
     C                     SETON                     1030
     C                     END
     C*
     C********************************************************
     C** VALIDATE RESIDENT TO NON-RESIDENT 10 MAXIMUM CHARGE **
     C********************************************************
     C** FIELD MUST BE 11-LONG NUMERIC WITH NUMBER OF D.P.S DEPENDENT
     C** ON THE BASE CURRENCY
     C*
     C                     Z-ADDSVBCDP    ZADEC
     C           11        SUB  SVBCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SCRMX0    ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WCRMX0 110
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     3821
     C                     END
     C*
     C** IF ENTERED & NUMERIC,IT MUST BE GREATER THAN THE MINIMUM
     C** CHARGE ENTERED
     C*
     C           *IN31     IFEQ '0'
     C           *IN38     ANDEQ'0'
     C           WCRMX0    ANDNE*ZERO
     C           WCRMX0    ANDLEWCRMN0
     C                     SETON                     3830
     C                     END
     C*
     C*************************************************************
     C** CHECK INTERDEPENDENCIES BETWEEN RES. TO NON-RES. FIELDS **
     C*************************************************************
     C** IF RANGE 1 START WAS NOT ENTERED,NONE OF THE SUBSEQUENT
     C** RES. TO NON-RES. FIELDS MAY BE EITHER
     C*
     C           WCRS1     IFEQ *ZERO
     C           WCRE1     IFNE *ZERO
     C           WCRR1     ORNE *ZERO
     C           WCRS2     ORNE *ZERO
     C           WCRE2     ORNE *ZERO
     C           WCRR2     ORNE *ZERO
     C           WCRMN1    ORNE *ZERO
     C           WCRMN2    ORNE *ZERO
     C           WCRMN3    ORNE *ZERO
     C           WCRS3     ORNE *ZERO
     C           WCRE3     ORNE *ZERO
     C           WCRR3     ORNE *ZERO
     C           WCRMX1    ORNE *ZERO
     C           WCRMX2    ORNE *ZERO
     C           WCRMX3    ORNE *ZERO
     C           WCRS4     ORNE *ZERO
     C           WCRE4     ORNE *ZERO
     C           WCRR4     ORNE *ZERO
     C           WCRMN4    ORNE *ZERO
     C           WCRMX4    ORNE *ZERO
     C           WCRS5     ORNE *ZERO
     C           WCRE5     ORNE *ZERO
     C           WCRR5     ORNE *ZERO
     C           WCRMN5    ORNE *ZERO
     C           WCRMX5    ORNE *ZERO
     C           WCRS6     ORNE *ZERO
     C           WCRE6     ORNE *ZERO
     C           WCRR6     ORNE *ZERO
     C           WCRMN6    ORNE *ZERO
     C           WCRMX6    ORNE *ZERO
     C           WCRS7     ORNE *ZERO
     C           WCRE7     ORNE *ZERO
     C           WCRR7     ORNE *ZERO
     C           WCRMN7    ORNE *ZERO
     C           WCRMX7    ORNE *ZERO
     C           WCRS8     ORNE *ZERO
     C           WCRE8     ORNE *ZERO
     C           WCRR8     ORNE *ZERO
     C           WCRMN8    ORNE *ZERO
     C           WCRMX8    ORNE *ZERO
     C           WCRS9     ORNE *ZERO
     C           WCRE9     ORNE *ZERO
     C           WCRR9     ORNE *ZERO
     C           WCRMN9    ORNE *ZERO
     C           WCRMX9    ORNE *ZERO
     C           WCRS0     ORNE *ZERO
     C           WCRE0     ORNE *ZERO
     C           WCRR0     ORNE *ZERO
     C           WCRMN0    ORNE *ZERO
     C           WCRMX0    ORNE *ZERO
     C                     SETON                     4122
     C                     END
     C                     END
     C*
     C** IF RANGE 2 START WAS NOT ENTERED,NONE OF THE SUBSEQUENT
     C** RES. TO NON-RES. START,END,RATE FIELDS MAY BE EITHER
     C*
     C           WCRS2     IFEQ *ZERO
     C           WCRE2     IFNE *ZERO
     C           WCRR2     ORNE *ZERO
     C           WCRMN2    ORNE *ZERO                                     074806
     C           WCRMX2    ORNE *ZERO                                     074806
     C           WCRS3     ORNE *ZERO
     C           WCRE3     ORNE *ZERO
     C           WCRR3     ORNE *ZERO
     C           WCRMN3    ORNE *ZERO                                     074806
     C           WCRMX3    ORNE *ZERO                                     074806
     C           WCRS4     ORNE *ZERO
     C           WCRE4     ORNE *ZERO
     C           WCRR4     ORNE *ZERO
     C           WCRMN4    ORNE *ZERO                                     074806
     C           WCRMX4    ORNE *ZERO                                     074806
     C           WCRS5     ORNE *ZERO
     C           WCRE5     ORNE *ZERO
     C           WCRR5     ORNE *ZERO
     C           WCRMN5    ORNE *ZERO                                     074806
     C           WCRMX5    ORNE *ZERO                                     074806
     C           WCRS6     ORNE *ZERO
     C           WCRE6     ORNE *ZERO
     C           WCRR6     ORNE *ZERO
     C           WCRMN6    ORNE *ZERO                                     074806
     C           WCRMX6    ORNE *ZERO                                     074806
     C           WCRS7     ORNE *ZERO
     C           WCRE7     ORNE *ZERO
     C           WCRR7     ORNE *ZERO
     C           WCRMN7    ORNE *ZERO                                     074806
     C           WCRMX7    ORNE *ZERO                                     074806
     C           WCRS8     ORNE *ZERO
     C           WCRE8     ORNE *ZERO
     C           WCRR8     ORNE *ZERO
     C           WCRMN8    ORNE *ZERO                                     074806
     C           WCRMX8    ORNE *ZERO                                     074806
     C           WCRS9     ORNE *ZERO
     C           WCRE9     ORNE *ZERO
     C           WCRR9     ORNE *ZERO
     C           WCRMN9    ORNE *ZERO                                     074806
     C           WCRMX9    ORNE *ZERO                                     074806
     C           WCRS0     ORNE *ZERO
     C           WCRE0     ORNE *ZERO
     C           WCRR0     ORNE *ZERO
     C           WCRMN0    ORNE *ZERO                                     074806
     C           WCRMX0    ORNE *ZERO                                     074806
     C                     SETON                     4427
     C                     END
     C                     END
     C*
     C** IF RANGE 3 START WAS NOT ENTERED,NONE OF THE SUBSEQUENT
     C** RES. TO NON-RES. END & RATE FIELDS MAY BE EITHER
     C*
     C           WCRS3     IFEQ *ZERO
     C           WCRE3     IFNE *ZERO
     C           WCRR3     ORNE *ZERO
     C           WCRMN3    ORNE *ZERO                                     074806
     C           WCRMX3    ORNE *ZERO                                     074806
     C           WCRS4     ORNE *ZERO
     C           WCRE4     ORNE *ZERO
     C           WCRR4     ORNE *ZERO
     C           WCRMN4    ORNE *ZERO                                     074806
     C           WCRMX4    ORNE *ZERO                                     074806
     C           WCRS5     ORNE *ZERO
     C           WCRE5     ORNE *ZERO
     C           WCRR5     ORNE *ZERO
     C           WCRMN5    ORNE *ZERO                                     074806
     C           WCRMX5    ORNE *ZERO                                     074806
     C           WCRS6     ORNE *ZERO
     C           WCRE6     ORNE *ZERO
     C           WCRR6     ORNE *ZERO
     C           WCRMN6    ORNE *ZERO                                     074806
     C           WCRMX6    ORNE *ZERO                                     074806
     C           WCRS7     ORNE *ZERO
     C           WCRE7     ORNE *ZERO
     C           WCRR7     ORNE *ZERO
     C           WCRMN7    ORNE *ZERO                                     074806
     C           WCRMX7    ORNE *ZERO                                     074806
     C           WCRS8     ORNE *ZERO
     C           WCRE8     ORNE *ZERO
     C           WCRR8     ORNE *ZERO
     C           WCRMN8    ORNE *ZERO                                     074806
     C           WCRMX8    ORNE *ZERO                                     074806
     C           WCRS9     ORNE *ZERO
     C           WCRE9     ORNE *ZERO
     C           WCRR9     ORNE *ZERO
     C           WCRMN9    ORNE *ZERO                                     074806
     C           WCRMX9    ORNE *ZERO                                     074806
     C           WCRS0     ORNE *ZERO
     C           WCRE0     ORNE *ZERO
     C           WCRR0     ORNE *ZERO
     C           WCRMN0    ORNE *ZERO                                     074806
     C           WCRMX0    ORNE *ZERO                                     074806
     C                     SETON                     4829
     C                     END
     C                     END
     C*
     C           WCRS4     IFEQ *ZERO
     C           WCRE4     IFNE *ZERO
     C           WCRR4     ORNE *ZERO
     C           WCRMN4    ORNE *ZERO                                     074806
     C           WCRMX4    ORNE *ZERO                                     074806
     C           WCRS5     ORNE *ZERO
     C           WCRE5     ORNE *ZERO
     C           WCRR5     ORNE *ZERO
     C           WCRMN5    ORNE *ZERO                                     074806
     C           WCRMX5    ORNE *ZERO                                     074806
     C           WCRS6     ORNE *ZERO
     C           WCRE6     ORNE *ZERO
     C           WCRR6     ORNE *ZERO
     C           WCRMN6    ORNE *ZERO                                     074806
     C           WCRMX6    ORNE *ZERO                                     074806
     C           WCRS7     ORNE *ZERO
     C           WCRE7     ORNE *ZERO
     C           WCRR7     ORNE *ZERO
     C           WCRMN7    ORNE *ZERO                                     074806
     C           WCRMX7    ORNE *ZERO                                     074806
     C           WCRS8     ORNE *ZERO
     C           WCRE8     ORNE *ZERO
     C           WCRR8     ORNE *ZERO
     C           WCRMN8    ORNE *ZERO                                     074806
     C           WCRMX8    ORNE *ZERO                                     074806
     C           WCRS9     ORNE *ZERO
     C           WCRE9     ORNE *ZERO
     C           WCRR9     ORNE *ZERO
     C           WCRMN9    ORNE *ZERO                                     074806
     C           WCRMX9    ORNE *ZERO                                     074806
     C           WCRS0     ORNE *ZERO
     C           WCRE0     ORNE *ZERO
     C           WCRR0     ORNE *ZERO
     C           WCRMN0    ORNE *ZERO                                     074806
     C           WCRMX0    ORNE *ZERO                                     074806
     C                     SETON                     5229
     C                     END
     C                     END
     C*
     C           WCRS5     IFEQ *ZERO
     C           WCRE5     IFNE *ZERO
     C           WCRR5     ORNE *ZERO
     C           WCRMN5    ORNE *ZERO                                     074806
     C           WCRMX5    ORNE *ZERO                                     074806
     C           WCRS6     ORNE *ZERO
     C           WCRE6     ORNE *ZERO
     C           WCRR6     ORNE *ZERO
     C           WCRMN6    ORNE *ZERO                                     074806
     C           WCRMX6    ORNE *ZERO                                     074806
     C           WCRS7     ORNE *ZERO
     C           WCRE7     ORNE *ZERO
     C           WCRR7     ORNE *ZERO
     C           WCRMN7    ORNE *ZERO                                     074806
     C           WCRMX7    ORNE *ZERO                                     074806
     C           WCRS8     ORNE *ZERO
     C           WCRE8     ORNE *ZERO
     C           WCRR8     ORNE *ZERO
     C           WCRMN8    ORNE *ZERO                                     074806
     C           WCRMX8    ORNE *ZERO                                     074806
     C           WCRS9     ORNE *ZERO
     C           WCRE9     ORNE *ZERO
     C           WCRR9     ORNE *ZERO
     C           WCRMN9    ORNE *ZERO                                     074806
     C           WCRMX9    ORNE *ZERO                                     074806
     C           WCRS0     ORNE *ZERO
     C           WCRE0     ORNE *ZERO
     C           WCRR0     ORNE *ZERO
     C           WCRMN0    ORNE *ZERO                                     074806
     C           WCRMX0    ORNE *ZERO                                     074806
     C                     SETON                     5529
     C                     END
     C                     END
     C*
     C           WCRS6     IFEQ *ZERO
     C           WCRE6     IFNE *ZERO
     C           WCRR6     ORNE *ZERO
     C           WCRMN6    ORNE *ZERO                                     074806
     C           WCRMX6    ORNE *ZERO                                     074806
     C           WCRS7     ORNE *ZERO
     C           WCRE7     ORNE *ZERO
     C           WCRR7     ORNE *ZERO
     C           WCRMN7    ORNE *ZERO                                     074806
     C           WCRMX7    ORNE *ZERO                                     074806
     C           WCRS8     ORNE *ZERO
     C           WCRE8     ORNE *ZERO
     C           WCRR8     ORNE *ZERO
     C           WCRMN8    ORNE *ZERO                                     074806
     C           WCRMX8    ORNE *ZERO                                     074806
     C           WCRS9     ORNE *ZERO
     C           WCRE9     ORNE *ZERO
     C           WCRR9     ORNE *ZERO
     C           WCRMN9    ORNE *ZERO                                     074806
     C           WCRMX9    ORNE *ZERO                                     074806
     C           WCRS0     ORNE *ZERO
     C           WCRE0     ORNE *ZERO
     C           WCRR0     ORNE *ZERO
     C           WCRMN0    ORNE *ZERO                                     074806
     C           WCRMX0    ORNE *ZERO                                     074806
     C                     SETON                     5829
     C                     END
     C                     END
     C*
     C           WCRS7     IFEQ *ZERO
     C           WCRE7     IFNE *ZERO
     C           WCRR7     ORNE *ZERO
     C           WCRMN7    ORNE *ZERO                                     074806
     C           WCRMX7    ORNE *ZERO                                     074806
     C           WCRS8     ORNE *ZERO
     C           WCRE8     ORNE *ZERO
     C           WCRR8     ORNE *ZERO
     C           WCRMN8    ORNE *ZERO                                     074806
     C           WCRMX8    ORNE *ZERO                                     074806
     C           WCRS9     ORNE *ZERO
     C           WCRE9     ORNE *ZERO
     C           WCRR9     ORNE *ZERO
     C           WCRMN9    ORNE *ZERO                                     074806
     C           WCRMX9    ORNE *ZERO                                     074806
     C           WCRS0     ORNE *ZERO
     C           WCRE0     ORNE *ZERO
     C           WCRR0     ORNE *ZERO
     C           WCRMN0    ORNE *ZERO                                     074806
     C           WCRMX0    ORNE *ZERO                                     074806
     C                     SETON                     6129
     C                     END
     C                     END
     C*
     C           WCRS8     IFEQ *ZERO
     C           WCRE8     IFNE *ZERO
     C           WCRR8     ORNE *ZERO
     C           WCRMN8    ORNE *ZERO                                     074806
     C           WCRMX8    ORNE *ZERO                                     074806
     C           WCRS9     ORNE *ZERO
     C           WCRE9     ORNE *ZERO
     C           WCRR9     ORNE *ZERO
     C           WCRMN9    ORNE *ZERO                                     074806
     C           WCRMX9    ORNE *ZERO                                     074806
     C           WCRS0     ORNE *ZERO
     C           WCRE0     ORNE *ZERO
     C           WCRR0     ORNE *ZERO
     C           WCRMN0    ORNE *ZERO                                     074806
     C           WCRMX0    ORNE *ZERO                                     074806
     C                     SETON                     6429
     C                     END
     C                     END
     C*
     C           WCRS9     IFEQ *ZERO
     C           WCRE9     IFNE *ZERO
     C           WCRR9     ORNE *ZERO
     C           WCRMN9    ORNE *ZERO                                     074806
     C           WCRMX9    ORNE *ZERO                                     074806
     C           WCRS0     ORNE *ZERO
     C           WCRE0     ORNE *ZERO
     C           WCRR0     ORNE *ZERO
     C           WCRMN0    ORNE *ZERO                                     074806
     C           WCRMX0    ORNE *ZERO                                     074806
     C                     SETON                     6729
     C                     END
     C                     END
     C*
     C           WCRS0     IFEQ *ZERO
     C           WCRE0     IFNE *ZERO
     C           WCRR0     ORNE *ZERO
     C           WCRMN0    ORNE *ZERO                                     074806
     C           WCRMX0    ORNE *ZERO                                     074806
     C                     SETON                     0129
     C                     END
     C                     END
     C*
     C           SCH4C     IFEQ '1'
     C           SCH4C     OREQ '2'
     C                     ELSE
     C                     SETON                     04
     C                     MOVEL'FTM2537' ZAMSID                          074804
     C                     EXSR SRSNDM                                    074804
     C                     END
     C*
     C*****************************************************************
     C**  SETUP ERROR CODE ARRAY DEPENDING ON WHICH INDICATORS HAVE  **
     C**  BEEN SET ABOVE.                                            **
     C*****************************************************************
     C*
     C                     Z-ADD*ZERO     I       30
     C                     MOVEL*BLANKS   ERCD
     C***********                                                         074804
     C************IN04     IFEQ '1'                                       074804
     C***********          ADD  1         I                               074804
     C***********          MOVE '377'     ERCD,I                          074804
     C***********          END                                            074804
     C*
     C           *IN21     IFEQ '1'
     C                     ADD  1         I
     C                     MOVE '004'     ERCD,I
     C                     END
     C*
     C           *IN22     IFEQ '1'
     C                     ADD  1         I
     C                     MOVE '005'     ERCD,I
     C                     END
     C*
     C           *IN23     IFEQ '1'
     C                     ADD  1         I
     C                     MOVE '006'     ERCD,I
     C                     END
     C*
     C           *IN24     IFEQ '1'
     C                     ADD  1         I
     C                     MOVE '007'     ERCD,I
     C                     END
     C*
     C           *IN25     IFEQ '1'
     C                     ADD  1         I
     C                     MOVE '008'     ERCD,I
     C                     END
     C*
     C           *IN26     IFEQ '1'
     C                     ADD  1         I
     C                     MOVE '009'     ERCD,I
     C                     END
     C*
     C           *IN27     IFEQ '1'
     C                     ADD  1         I
     C                     MOVE '010'     ERCD,I
     C                     END
     C*
     C           *IN28     IFEQ '1'
     C                     ADD  1         I
     C                     MOVE '011'     ERCD,I
     C                     END
     C*
     C           *IN29     IFEQ '1'
     C                     ADD  1         I
     C                     MOVE '012'     ERCD,I
     C                     END
     C*
     C           *IN30     IFEQ '1'
     C                     ADD  1         I
     C                     MOVE '013'     ERCD,I
     C                     END
     C*
     C           *IN32     IFEQ '1'
     C                     ADD  1         I
     C                     MOVE '015'     ERCD,I
     C                     END
     C*
     C           *IN33     IFEQ '1'
     C                     ADD  1         I
     C                     MOVE '016'     ERCD,I
     C                     END
     C*
     C           *IN34     IFEQ '1'
     C                     ADD  1         I
     C                     MOVE '017'     ERCD,I
     C                     END
     C*
     C           *IN35     IFEQ '1'
     C                     ADD  1         I
     C                     MOVE '018'     ERCD,I
     C                     END
     C*
     C           *IN36     IFEQ '1'
     C                     ADD  1         I
     C                     MOVE '183'     ERCD,I
     C                     END
     C*
     C************IN67     IFEQ '1'                                       074804
     C***********          ADD  1         I                               074804
     C***********          MOVE '375'     ERCD,I                          074804
     C***********          ADD  1         I                               074804
     C***********          MOVE '376'     ERCD,I                          074804
     C***********          END                                            074804
     C***********                                                         074804
     C************IN68     IFEQ '1'                                       074804
     C***********          ADD  1         I                               074804
     C***********          MOVE '377'     ERCD,I                          074804
     C***********          END                                            074804
     C***********                                                         074804
     C************IN69     IFEQ '1'                                       074804
     C***********          ADD  1         I                               074804
     C***********          MOVE '377'     ERCD,I                          074804
     C***********          END                                            074804
     C*
     C           *IN18     IFEQ '1'
     C                     ADD  1         I
     C                     MOVE '377'     ERCD,I
     C                     END
     C*
     C           *IN70     IFEQ '1'
     C                     ADD  1         I
     C                     MOVE '377'     ERCD,I
     C                     END
     C*
     C************IN84     IFEQ '1'                                       074804
     C***********          ADD  1         I                               074804
     C***********          MOVE '377'     ERCD,I                          074804
     C***********          END                                            074804
     C***********                                                         074804
     C************IN85     IFEQ '1'                                       074804
     C***********          ADD  1         I                               074804
     C***********          MOVE '379'     ERCD,I                          074804
     C***********          END                                            074804
     C***********                                                         074804
     C************IN31     IFEQ '1'                                       074804
     C***********          ADD  1         I                               074804
     C***********          MOVE '381'     ERCD,I                          074804
     C***********          END                                            074804
     C***********                                                         074804
     C************IN06     IFEQ '1'                                       074804
     C***********          ADD  1         I                               074804
     C***********          MOVE '378'     ERCD,I                          074804
     C***********          END                                            074804
     C***********                                                         074804
     C************IN07     IFEQ '1'                                       074804
     C***********          ADD  1         I                               074804
     C***********          MOVE '380'     ERCD,I                          074804
     C***********          END                                            074804
     C*
     C** CHECK IF ANY ERRORS HAVE BEEN FOUND
     C*
     C           I         IFGT *ZERO
     C                     SETON                     74
     C           I         IFGT 19
     C                     SETON                     75
     C                     END
     C                     END
     C*
     C*          *****     *****
     C           GAEND5    ENDSR
     C*          *****     *****
     C/EJECT
     C           GCSTUP    BEGSR
     C*          ******    *****
     C*
     C*****************************************************************
     C*                 GC-SETUP-PYCHGL0-RECORD                       *
     C*                                                               *
     C*  FUNCTION : TO SETUP ALL THE FIELDS REQUIRED FOR OUTPUT TO    *
     C*             THE PAYMENT CHARGES RECORD.                       *
     C*                                                               *
     C*  CALLS :    NONE                                              *
     C*                                                               *
     C*  CALLED BY: ECINST                                            *
     C*             EEAMND                                            *
     C*                                                               *
     C*****************************************************************
     C*
     C** Setup record identifier
     C*
     C                     MOVEL'D'       RECI
     C*
     C** Setup fields input from detail screen
     C*
     C                     Z-ADDWRNS1     RNS1
     C                     Z-ADDWRNE1     RNE1
     C                     Z-ADDWRNR1     RNR1
     C                     Z-ADDWRNS2     RNS2
     C                     Z-ADDWRNE2     RNE2
     C                     Z-ADDWRNR2     RNR2
     C                     Z-ADDWRNMN     RNMN
     C                     Z-ADDWRNMN2    RNMN2
     C                     Z-ADDWRNMN3    RNMN3
     C                     Z-ADDWRNS3     RNS3
     C                     Z-ADDWRNE3     RNE3
     C                     Z-ADDWRNR3     RNR3
     C                     Z-ADDWRNMX     RNMX
     C                     Z-ADDWRNMX2    RNMX2
     C                     Z-ADDWRNMX3    RNMX3
     C                     Z-ADDWRNS4     RNS4
     C                     Z-ADDWRNE4     RNE4
     C                     Z-ADDWRNR4     RNR4
     C                     Z-ADDWRNMN4    RNMN4
     C                     Z-ADDWRNMX4    RNMX4
     C                     Z-ADDWRNS5     RNS5
     C                     Z-ADDWRNE5     RNE5
     C                     Z-ADDWRNR5     RNR5
     C                     Z-ADDWRNMN5    RNMN5
     C                     Z-ADDWRNMX5    RNMX5
     C                     Z-ADDWRNS6     RNS6
     C                     Z-ADDWRNE6     RNE6
     C                     Z-ADDWRNR6     RNR6
     C                     Z-ADDWRNMN6    RNMN6
     C                     Z-ADDWRNMX6    RNMX6
     C                     Z-ADDWRNS7     RNS7
     C                     Z-ADDWRNE7     RNE7
     C                     Z-ADDWRNR7     RNR7
     C                     Z-ADDWRNMN7    RNMN7
     C                     Z-ADDWRNMX7    RNMX7
     C                     Z-ADDWRNS8     RNS8
     C                     Z-ADDWRNE8     RNE8
     C                     Z-ADDWRNR8     RNR8
     C                     Z-ADDWRNMN8    RNMN8
     C                     Z-ADDWRNMX8    RNMX8
     C                     Z-ADDWRNS9     RNS9
     C                     Z-ADDWRNE9     RNE9
     C                     Z-ADDWRNR9     RNR9
     C                     Z-ADDWRNMN9    RNMN9
     C                     Z-ADDWRNMX9    RNMX9
     C                     Z-ADDWRNS0     RNS0
     C                     Z-ADDWRNE0     RNE0
     C                     Z-ADDWRNR0     RNR0
     C                     Z-ADDWRNMN0    RNMN0
     C                     Z-ADDWRNMX0    RNMX0
     C                     Z-ADDWRRS1     RRS1
     C                     Z-ADDWRRE1     RRE1
     C                     Z-ADDWRRR1     RRR1
     C                     Z-ADDWRRMN     RRMN
     C                     Z-ADDWRRMN2    RRMN2
     C                     Z-ADDWRRS2     RRS2
     C                     Z-ADDWRRE2     RRE2
     C                     Z-ADDWRRR2     RRR2
     C                     Z-ADDWRRMX     RRMX
     C                     Z-ADDWRRMX2    RRMX2
     C                     Z-ADDWNNRT     NNRT
     C                     Z-ADDWNNMN     NNMN
     C                     Z-ADDWNNMX     NNMX
     C                     Z-ADDWCQCH     CQCH
     C                     Z-ADDWSPCH     SPCH
     C                     MOVELSDFTCR    DFTRCT
     C                     MOVELSTNR1     TNR1
     C                     MOVELSTNR2     TNR2
     C                     MOVELSTNR3     TNR3
     C                     MOVELSTNR4     TNR4
     C                     MOVELSTNR5     TNR5
     C                     Z-ADDWRRS3     RRS3
     C                     Z-ADDWRRE3     RRE3
     C                     Z-ADDWRRR3     RRR3
     C                     Z-ADDWRRMN3    RRMN3
     C                     Z-ADDWRRMX3    RRMX3
     C                     Z-ADDWRRS4     RRS4
     C                     Z-ADDWRRE4     RRE4
     C                     Z-ADDWRRR4     RRR4
     C                     Z-ADDWRRMN4    RRMN4
     C                     Z-ADDWRRMX4    RRMX4
     C                     Z-ADDWRRS5     RRS5
     C                     Z-ADDWRRE5     RRE5
     C                     Z-ADDWRRR5     RRR5
     C                     Z-ADDWRRMN5    RRMN5
     C                     Z-ADDWRRMX5    RRMX5
     C                     Z-ADDWRRS6     RRS6
     C                     Z-ADDWRRE6     RRE6
     C                     Z-ADDWRRR6     RRR6
     C                     Z-ADDWRRMN6    RRMN6
     C                     Z-ADDWRRMX6    RRMX6
     C                     Z-ADDWRRS7     RRS7
     C                     Z-ADDWRRE7     RRE7
     C                     Z-ADDWRRR7     RRR7
     C                     Z-ADDWRRMN7    RRMN7
     C                     Z-ADDWRRMX7    RRMX7
     C                     Z-ADDWRRS8     RRS8
     C                     Z-ADDWRRE8     RRE8
     C                     Z-ADDWRRR8     RRR8
     C                     Z-ADDWRRMN8    RRMN8
     C                     Z-ADDWRRMX8    RRMX8
     C                     Z-ADDWRRS9     RRS9
     C                     Z-ADDWRRE9     RRE9
     C                     Z-ADDWRRR9     RRR9
     C                     Z-ADDWRRMN9    RRMN9
     C                     Z-ADDWRRMX9    RRMX9
     C                     Z-ADDWRRS0     RRS0
     C                     Z-ADDWRRE0     RRE0
     C                     Z-ADDWRRR0     RRR0
     C                     Z-ADDWRRMN0    RRMN0
     C                     Z-ADDWRRMX0    RRMX0
     C                     MOVE STR3C     TR3C
     C                     MOVE STR4C     TR4C
     C                     MOVE SCH3C     CH3C
     C                     MOVE SCH4C     CH4C
     C                     Z-ADDWCNS1     CNS1
     C                     Z-ADDWCNE1     CNE1
     C                     Z-ADDWCNR1     CNR1
     C                     Z-ADDWCNS2     CNS2
     C                     Z-ADDWCNE2     CNE2
     C                     Z-ADDWCNR2     CNR2
     C                     Z-ADDWCNMN1    CNMN1
     C                     Z-ADDWCNMN2    CNMN2
     C                     Z-ADDWCNMN3    CNMN3
     C                     Z-ADDWCNS3     CNS3
     C                     Z-ADDWCNE3     CNE3
     C                     Z-ADDWCNR3     CNR3
     C                     Z-ADDWCNMX1    CNMX1
     C                     Z-ADDWCNMX2    CNMX2
     C                     Z-ADDWCNMX3    CNMX3
     C                     Z-ADDWCNS4     CNS4
     C                     Z-ADDWCNE4     CNE4
     C                     Z-ADDWCNR4     CNR4
     C                     Z-ADDWCNMN4    CNMN4
     C                     Z-ADDWCNMX4    CNMX4
     C                     Z-ADDWCNS5     CNS5
     C                     Z-ADDWCNE5     CNE5
     C                     Z-ADDWCNR5     CNR5
     C                     Z-ADDWCNMN5    CNMN5
     C                     Z-ADDWCNMX5    CNMX5
     C                     Z-ADDWCNS6     CNS6
     C                     Z-ADDWCNE6     CNE6
     C                     Z-ADDWCNR6     CNR6
     C                     Z-ADDWCNMN6    CNMN6
     C                     Z-ADDWCNMX6    CNMX6
     C                     Z-ADDWCNS7     CNS7
     C                     Z-ADDWCNE7     CNE7
     C                     Z-ADDWCNR7     CNR7
     C                     Z-ADDWCNMN7    CNMN7
     C                     Z-ADDWCNMX7    CNMX7
     C                     Z-ADDWCNS8     CNS8
     C                     Z-ADDWCNE8     CNE8
     C                     Z-ADDWCNR8     CNR8
     C                     Z-ADDWCNMN8    CNMN8
     C                     Z-ADDWCNMX8    CNMX8
     C                     Z-ADDWCNS9     CNS9
     C                     Z-ADDWCNE9     CNE9
     C                     Z-ADDWCNR9     CNR9
     C                     Z-ADDWCNMN9    CNMN9
     C                     Z-ADDWCNMX9    CNMX9
     C                     Z-ADDWCNS0     CNS0
     C                     Z-ADDWCNE0     CNE0
     C                     Z-ADDWCNR0     CNR0
     C                     Z-ADDWCNMN0    CNMN0
     C                     Z-ADDWCNMX0    CNMX0
     C                     Z-ADDWCRS1     CRS1
     C                     Z-ADDWCRE1     CRE1
     C                     Z-ADDWCRR1     CRR1
     C                     Z-ADDWCRMN1    CRMN1
     C                     Z-ADDWCRMN2    CRMN2
     C                     Z-ADDWCRS2     CRS2
     C                     Z-ADDWCRE2     CRE2
     C                     Z-ADDWCRR2     CRR2
     C                     Z-ADDWCRMX1    CRMX1
     C                     Z-ADDWCRMX2    CRMX2
     C                     Z-ADDWCRS3     CRS3
     C                     Z-ADDWCRE3     CRE3
     C                     Z-ADDWCRR3     CRR3
     C                     Z-ADDWCRMN3    CRMN3
     C                     Z-ADDWCRMX3    CRMX3
     C                     Z-ADDWCRS4     CRS4
     C                     Z-ADDWCRE4     CRE4
     C                     Z-ADDWCRR4     CRR4
     C                     Z-ADDWCRMN4    CRMN4
     C                     Z-ADDWCRMX4    CRMX4
     C                     Z-ADDWCRS5     CRS5
     C                     Z-ADDWCRE5     CRE5
     C                     Z-ADDWCRR5     CRR5
     C                     Z-ADDWCRMN5    CRMN5
     C                     Z-ADDWCRMX5    CRMX5
     C                     Z-ADDWCRS6     CRS6
     C                     Z-ADDWCRE6     CRE6
     C                     Z-ADDWCRR6     CRR6
     C                     Z-ADDWCRMN6    CRMN6
     C                     Z-ADDWCRMX6    CRMX6
     C                     Z-ADDWCRS7     CRS7
     C                     Z-ADDWCRE7     CRE7
     C                     Z-ADDWCRR7     CRR7
     C                     Z-ADDWCRMN7    CRMN7
     C                     Z-ADDWCRMX7    CRMX7
     C                     Z-ADDWCRS8     CRS8
     C                     Z-ADDWCRE8     CRE8
     C                     Z-ADDWCRR8     CRR8
     C                     Z-ADDWCRMN8    CRMN8
     C                     Z-ADDWCRMX8    CRMX8
     C                     Z-ADDWCRS9     CRS9
     C                     Z-ADDWCRE9     CRE9
     C                     Z-ADDWCRR9     CRR9
     C                     Z-ADDWCRMN9    CRMN9
     C                     Z-ADDWCRMX9    CRMX9
     C                     Z-ADDWCRS0     CRS0
     C                     Z-ADDWCRE0     CRE0
     C                     Z-ADDWCRR0     CRR0
     C                     Z-ADDWCRMN0    CRMN0
     C                     Z-ADDWCRMX0    CRMX0
     C*
     C** Setup divisor for DAF figures,depending on the number of D.P.S
     C** for base currency
     C*
     C                     SELEC
     C           SVBCDP    WHEQ *ZERO
     C                     Z-ADD1         WDIVSR  40
     C           SVBCDP    WHEQ 1
     C                     Z-ADD10        WDIVSR
     C           SVBCDP    WHEQ 2
     C                     Z-ADD100       WDIVSR
     C                     OTHER
     C                     Z-ADD1000      WDIVSR
     C                     ENDSL
     C*
     C** Calculate DAF Fifures
     C*
     C           RNS1      DIV  WDIVSR    RNS1D     H
     C           RNE1      DIV  WDIVSR    RNE1D     H
     C           RNS2      DIV  WDIVSR    RNS2D     H
     C           RNE2      DIV  WDIVSR    RNE2D     H
     C           RNS3      DIV  WDIVSR    RNS3D     H
     C           RNE3      DIV  WDIVSR    RNE3D     H
     C           RNMN      DIV  WDIVSR    RNMND     H
     C           RNMX      DIV  WDIVSR    RNMXD     H
     C           RRS1      DIV  WDIVSR    RRS1D     H
     C           RRE1      DIV  WDIVSR    RRE1D     H
     C           RRS2      DIV  WDIVSR    RRS2D     H
     C           RRE2      DIV  WDIVSR    RRE2D     H
     C           RRMN      DIV  WDIVSR    RRMND     H
     C           RRMX      DIV  WDIVSR    RRMXD     H
     C           NNMN      DIV  WDIVSR    NNMND     H
     C           NNMX      DIV  WDIVSR    NNMXD     H
     C           CQCH      DIV  WDIVSR    CQCHD     H
     C           SPCH      DIV  WDIVSR    SPCHD     H
     C*
     C** Set up the extended payment charges details
     C*
     C                     MOVELSBRCA     PYBR
     C*******              MOVELSCNUM     PYCNUM                          102623
     C                     MOVELBBCUST    PYCNUM                          102623
      *                                                                                       210873
      * If customer not entered then zero                                                     210873
      *                                                                                       210873
     C           SCNUM     IFEQ *BLANKS                                                       210873
     C**********           Z-ADD0         PYCNUM                                       210873 CSD027
     C                     MOVE *BLANKS   PYCNUM                                              CSD027
     C                     ELSE                                                               210873
     C                     MOVELSCNUM     PYCNUM                                              210873
     C                     ENDIF                                                              210873
     C                     MOVELSPYTP     PYPYTP
     C                     MOVELSPYST     PYPYST
     C                     MOVELSCGRP     PYGPCD
     C*
     C** If action code is 'A' but record was inserted today, do not
     C** change the last change type
     C*
     C           SACTCD    IFNE 'A'
     C           CHTP      ORNE 'I'
     C           LCD       ORNE BJRDNB
     C                     MOVELSACTCD    CHTP
     C                     END
     C*
     C** Setup date & time stamp
     C*
     C                     Z-ADDBJRDNB    LCD
     C                     Z-ADDTIME      LCHT
     C*
     C*          *****     *****
     C           GCEND     ENDSR
     C*          *****     *****
     C/EJECT
     C*          ******    *****
     C           SRVSCH    BEGSR
     C*          ******    *****
     C*
     C*****************************************************************
     C*                                                               *
     C*  SRVSCH   : Validate key structure                            *
     C*                                                               *
     C*  CALLED BY: Main processing                                   *
     C*                                                               *
     C*****************************************************************
     C                     MOVE *BLANK    WVALK
     C*
     C** Allow the key structure if only the customer market code is
     C** blank while the others are non-blank
     C*
     C           SBRCA     IFNE *BLANKS
     C           SCNUM     ANDNE*BLANKS
     C           SPYTP     ANDNE*BLANKS
     C           SPYST     ANDNE*BLANKS
     C           SCGRP     ANDEQ*BLANKS
     C                     MOVE 'Y'       WVALK   1
     C                     END
     C*
     C** Allow the key structure if only the branch code and customer
     C** number are entered
     C*
     C           SBRCA     IFNE *BLANKS
     C           SCNUM     ANDNE*BLANKS
     C           SPYTP     ANDEQ*BLANKS
     C           SPYST     ANDEQ*BLANKS
     C           SCGRP     ANDEQ*BLANKS
     C                     MOVE 'Y'       WVALK   1
     C                     END
     C*
     C** Allow the key structure if only the customer number and
     C** customer market code are not entered
     C*
     C           SBRCA     IFNE *BLANKS
     C           SCNUM     ANDEQ*BLANKS
     C           SPYTP     ANDNE*BLANKS
     C           SPYST     ANDNE*BLANKS
     C           SCGRP     ANDEQ*BLANKS
     C                     MOVE 'Y'       WVALK   1
     C                     END
     C*
     C** Allow the key structure if only the branch code and
     C** transaction type are entered
     C*
     C           SBRCA     IFNE *BLANKS
     C           SCNUM     ANDEQ*BLANKS
     C           SPYTP     ANDNE*BLANKS
     C           SPYST     ANDEQ*BLANKS
     C           SCGRP     ANDEQ*BLANKS
     C                     MOVE 'Y'       WVALK   1
     C                     END
     C*
     C** Allow the key structure if only the branch code and group code
     C** 1 are entered
     C*
     C           SBRCA     IFNE *BLANKS
     C           SCNUM     ANDEQ*BLANKS
     C           SPYTP     ANDEQ*BLANKS
     C           SPYST     ANDEQ*BLANKS
     C           SCGRP     ANDNE*BLANKS
     C*
     C           WKGCD     KLIST
     C                     KFLD           WSETN   1
     C                     KFLD           SCGRP   4
     C                     MOVE '1'       WSETN
     C           WKGCD     CHAINSDCGRPL1             89
     C           *IN89     IFEQ '0'
     C                     MOVE 'Y'       WVALK   1
     C                     END
     C                     END
     C*
     C** Allow the key structure if only the branch code is entered
     C*
     C           SBRCA     IFNE *BLANKS
     C           SCNUM     ANDEQ*BLANKS
     C           SPYTP     ANDEQ*BLANKS
     C           SPYST     ANDEQ*BLANKS
     C           SCGRP     ANDEQ*BLANKS
     C                     MOVE 'Y'       WVALK   1
     C                     END
     C/COPY WNCPYSRC,FT0030C001
     C*
     C*          ******    *****
     C           SRVKSE    ENDSR
     C*          ******    *****
     C/EJECT
     C*          ******    *****
     C           SRVKEY    BEGSR
     C*          ******    *****
     C*
     C*****************************************************************
     C*                                                               *
     C*  SRVKEY : To validate the key for payment charges             *
     C*                                                               *
     C*  Called by: CADETL                                            *
     C*  Calls :    None                                              *
     C*                                                               *
     C*****************************************************************
     C                     SETOF                     89
     C*
     C** Validate the branch code
     C*
     C/COPY WNCPYSRC,FT0030C004
     C**********           CALL 'AOBRCHR0'                                                    CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM *BLANKS   @RTCD   7
     C                     PARM '*KEY'    @OPTN   7
     C                     PARM SBRCA     AJCD    3
     C********** SDBRCH    PARM SDBRCH    DSFDY                                               CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANKS
     C                     SETON                     1189
     C                     MOVEL'FTM2526' ZAMSID
     C                     EXSR SRSNDM
     C                     END
     C/COPY WNCPYSRC,FT0030C005
     C*
     C** Validate the customer if non-blank
     C*
     C           SCNUM     IFNE *BLANKS
     C                     CALL 'AOCUSTR0'
     C                     PARM *BLANKS   @RTCD
     C                     PARM '*KEY'    @OPTN
     C                     PARM SCNUM     @CUST  10
     C                     PARM *BLANKS   @KEYS   7
     C           SDCUST    PARM SDCUST    DSSDY
     C           @RTCD     IFNE *BLANKS
     C           @KEYS     OREQ '*CSHT  '                                                     CSD027
     C                     SETON                     0889
     C                     MOVEL'FTM2527' ZAMSID
     C                     EXSR SRSNDM
     C                     END
     C                     END
     C*
     C** Validate the group code if non-blank, checking if it is of
     C** set number one
     C                     MOVE '1'       WSETN
     C           SCGRP     IFNE *BLANKS
     C           WKGCD     CHAINSDCGRPL1             89
     C           *IN89     IFEQ '1'
     C                     SETON                     19
     C                     MOVEL'FTM2528' ZAMSID
     C                     EXSR SRSNDM
     C                     END
     C                     END
     C*
     C** Validate the transaction type if non-blank
     C*
     C           SPYTP     IFNE *BLANKS
     C           SPYTP     ANDNE'OP'
     C           SPYTP     ANDNE'RP'
     C           SPYTP     ANDNE'IN'
     C           SPYTP     ANDNE'NT'
     C           SPYTP     ANDNE'CC'
     C           SPYTP     ANDNE'CP'
     C                     SETON                     1789
     C                     MOVEL'FTM2534' ZAMSID
     C                     EXSR SRSNDM
     C                     END
     C*
     C** Validate the transaction subtype if non-blank
     C*
     C           SPYST     IFNE *BLANKS
     C                     CALL 'AODLSTR0'
     C                     PARM *BLANKS   @RTCD
     C                     PARM '*KEY'    @OPTN
     C                     PARM SPYST     @DSTC   2
     C           SDDLST    PARM SDDLST    DSFDY
     C           @RTCD     IFNE *BLANKS
     C                     SETON                     1689
     C                     MOVEL'FTM2535' ZAMSID
     C                     EXSR SRSNDM
     C                     END
     C                     END
     C*
     C*          *****     *****
     C           SRVKE     ENDSR
     C*          *****     *****
     C/EJECT
     C*****************************************************************
     C*                                                               *
     C* SRCLRM  -  Clears the message file                            *
     C*                                                               *
     C* Called by: Main routine                                       *
     C* Calls    : Y2CLMSC                                            *
     C*                                                               *
     C*****************************************************************
     C*
     C           SRCLRM    BEGSR
     C*
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGM  10
     C                     PARM '*SAME'   ZAPGRL  5
     C*                                                                   074804
     C                     MOVE *BLANK    WERRM                           074804
     C*
     C                     ENDSR
     C/EJECT
     C*****************************************************************
     C*                                                               *
     C* SRSNDM  -  Sends error messages to the message queue (ZASNMS) *
     C*                                                               *
     C* Called by: Every process that resulted in error               *
     C* Calls    : Y2SNMGC                                            *
     C*                                                               *
     C*****************************************************************
     C*
     C           SRSNDM    BEGSR
     C*
     C**  Send message to program's message queue
     C*
     C                     CALL 'Y2SNMGC'
     C                     PARM ##PGM     ZAPGM  10        PROGRAM QUEUE
     C                     PARM           ZAPGRL  5        REL QUEUE
     C                     PARM           ZAMSID  7        MESSAGE ID
     C                     PARM           ZAMSGF 10        MESSAGE FILE
     C                     PARM           ZAMSDA132        MESSAGE DATA
     C                     PARM           ZAMSTP  7        MESSAGE TYPE
     C*
     C** Clear all fields for default mechanism next time
     C*
     C                     MOVEL*BLANK    ZAPGM            PROGRAM QUEUE
     C                     MOVEL*BLANK    ZAPGRL           REL QUEUE
     C                     MOVEL*BLANK    ZAMSDA           MESSAGE DATA
     C                     MOVEL*BLANK    ZAMSTP           MESSAGE TYPE
     C                     MOVE 'Y'       WERRM   1
     C*
     C                     ENDSR
     C/EJECT
     C*          *****     *****
     C           SRFLDQ    BEGSR
     C*          ******    *****
     C*
     C*****************************************************************
     C*                                                               *
     C*  FUNCTION : TO RESOLVE A '?' ENTRY FOR STANDING DATA FIELDS.  *
     C*             THIS IS PERFORMED AFTER THE FUNCTION KEY          *
     C*             VALIDATION AND PRIOR TO FIELD VALIDATION.         *
     C*                                                               *
     C*  CALLS :    NONE                                              *
     C*                                                               *
     C*  CALLED BY: CADETL                                            *
     C*                                                               *
     C*****************************************************************
     C*
     C                     SETOF                     7406
     C*                                                                   S01194
     C** Do until there exists a '?'
     C*                                                                   S01194
     C           *IN06     DOUEQ'0'
     C                     SETOF                     06                   S01194
     C*                                                                   S01194
     C** Check branch for entry of ?                                      S01194
     C*                                                                   S01194
     C                     MOVEA*BLANKS   FLDQ                            S01194
     C                     MOVEASBRCA     FLDQ                            S01194
     C           '?'       LOKUPFLDQ                     06               S01194
     C*                                                                   S01194
     C** If ? found, seton redisplay ind and call access program          S01194
     C*                                                                   S01194
     C           *IN06     IFEQ '1'                                       S01194
     C                     MOVEL'Y'       WQFND   1
     C**********           CALL 'AOBRCHR0'                                S01194              CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM *BLANKS   @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM '?'       @DSNB   3                       S01194
     C********** SDBRCH    PARM SDBRCH    DSFDY                           S01194              CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C*                                                                   S01194
     C** If selection made, move value to screen field                    S01194
     C*                                                                   S01194
     C           @RTCD     IFEQ *BLANKS                                   S01194
     C                     MOVELA8BRCD    SBRCA                           S01194
     C                     END                                            S01194
     C                     END
     C*                                                                   S01194
     C** Check customer number for entry of '?'                           S01194
     C*                                                                   S01194
     C                     MOVEA*BLANKS   FLDQ                            S01194
     C                     MOVEASCNUM     FLDQ                            S01194
     C           '?'       LOKUPFLDQ                     06               S01194
     C*
     C           *IN06     IFEQ '1'
     C                     MOVEL'Y'       WQFND   1
     C                     CALL 'AOCUSTR0'
     C                     PARM *BLANKS   @RTCD
     C                     PARM '*KEY'    @OPTN
     C                     PARM '?'       @CUST  10
     C                     PARM *BLANKS   @KEYS   7
     C           SDCUST    PARM SDCUST    DSSDY
     C*                                                                   S01194
     C** If selection made, move value to screen field                    S01194
     C*                                                                   S01194
     C           @RTCD     IFEQ *BLANKS                                   S01194
     C           @KEYS     OREQ '*CSHT  '                                                     CSD027
     C                     MOVELBBCUST    SCNUM                           S01194
     C                     END                                            S01194
     C                     END                                            S01194
     C*
     C** Check customer group code for entry of '?'
     C*
     C                     MOVEA*BLANKS   FLDQ                            S01194
     C                     MOVEASCGRP     FLDQ                            S01194
     C           '?'       LOKUPFLDQ                     06               S01194
     C*
     C           *IN06     IFEQ '1'
     C                     MOVEL'Y'       WQFND   1
     C                     CALL 'SD1411S'
     C                     PARM *BLANKS   @RTCD
     C                     PARM '1'       @SETN   1
     C           SCGRP     PARM '?'       @CGRP   4
     C                     END
     C*                                                                   S01194
     C** Check deal subtype for entry of '?'                              S01194
     C*                                                                   S01194
     C                     MOVEA*BLANKS   FLDQ                            S01194
     C                     MOVEASPYST     FLDQ                            S01194
     C           '?'       LOKUPFLDQ                     06               S01194
     C*
     C           *IN06     IFEQ '1'
     C                     MOVEL'Y'       WQFND   1
     C                     CALL 'AODLSTR0'
     C                     PARM *BLANKS   @RTCD
     C                     PARM '*KEY'    @OPTN
     C                     PARM '?'       @DSTC
     C           SDDLST    PARM SDDLST    DSSDY
     C*                                                                   S01194
     C** If selection made, move value to screen field                    S01194
     C*                                                                   S01194
     C           @RTCD     IFEQ *BLANKS                                   S01194
     C                     MOVELASDSTC    SPYST                           S01194
     C                     END                                            S01194
     C                     END                                            S01194
     C*
     C           WQFND     IFEQ 'Y'
     C                     EXFMTFT0030F1
     C                     END
     C*                                                                   S01194
     C                     END
     C*
     C                     ENDSR                                          S01194
     C/EJECT
     C           UCPCCN    BEGSR
     C*          ******    *****
     C*
     C*****************************************************************
     C*                 UC-CHAIN-PAYMENT-CHARGES-FILE                 *
     C*                                                               *
     C*  FUNCTION : TO ATTEMPT TO ACCESS THE RECORD FROM THE PAYMENT  *
     C*             CHARGES FILE.                                     *
     C*                                                               *
     C*  CALLS :    NONE                                              *
     C*                                                               *
     C*  CALLED BY: CADETL                                            *
     C*             EEAMND                                            *
     C*                                                               *
     C*****************************************************************
     C*
     C** If update not required chain to PYCHGL1, otherwise,
     C** to PYCHGL0
     C*
     C***********WUPDF     IFEQ 'Y'                                       099674
     C           WUPDF     IFNE 'Y'                                       099674
     C           WKPAY     CHAINPYCHGDD1             89
     C                     ELSE
     C           WKPAY     CHAINPYCHGDDF             89
     C                     END
     C*
     C** Reset the update flag
     C*
     C                     MOVE ' '       WUPDF   1
     C*
     C*          *****     *****
     C           UCEND     ENDSR
     C*          *****     *****
     C/EJECT
     C           UEABRT    BEGSR
     C*          ******    *****
     C*
     C*****************************************************************
     C*                 UE-ABORT-PROGRAM                              *
     C*                                                               *
     C*  FUNCTION : TO ABORT THE PROGRAM IN THE EVENT OF A DATABASE   *
     C*             ERROR. ALSO TO SETUP THE RELEVANT FIELDS IN THE   *
     C*             DATA AREA LDA FOR THIS ERROR.                     *
     C*                                                               *
     C*  CALLS :    NONE                                              *
     C*                                                               *
     C*  CALLED BY: AAMAIN                                            *
     C*             ECINST                                            *
     C*             EEAMND                                            *
     C*                                                               *
     C*****************************************************************
     C*
     C** Update data area LDA
     C*
     C           *NAMVAR   DEFN LDA       DLDA
     C           *LOCK     IN   DLDA
     C                     MOVEL'FT0030'  DBPGM
     C                     MOVELWDBFIL    DBFILE
     C                     MOVELWDBKEY    DBKEY
     C                     MOVELWDBASE    DBASE
     C                     OUT  DLDA
     C*
     C** Seton indicators to indicate database errors
     C*
     C                     SETON                     U7U8LR
     C*
     C** Produce program dump
     C*
     C                     DUMP
     C*
     C** End program
     C*
     C                     RETRN
     C*
     C*          *****     *****
     C           UEEND     ENDSR
     C*          *****     *****
     C/EJECT
     C           UGTIME    BEGSR
     C*          ******    *****
     C*
     C*****************************************************************
     C*                 UG-GET-TIME                                   *
     C*                                                               *
     C*  FUNCTION : TO OBTAIN THE CURRENT SYSTEM TIME.                *
     C*                                                               *
     C*  CALLS :    NONE                                              *
     C*                                                               *
     C*  CALLED BY: CADETL                                            *
     C*             EAINPT                                            *
     C*                                                               *
     C*****************************************************************
     C*
     C                     TIME           STIME
     C                     MOVELUSRID     SUSRID
     C                     MOVELWID       SWID
     C                     MOVELBJMRDT    SRUNA
     C*
     C*          *****     *****
     C           UGEND     ENDSR
     C*          *****     *****
     C/EJECT
     C           UIFRMT    BEGSR
     C*          ******    *****
     C*
     C*****************************************************************
     C*             UI-FORMAT-FIELD-FOR-OUTPUT-TO-SCREEN              *
     C*                                                               *
     C*  FUNCTION : TO FORMAT A NUMERIC FIELD FROM THE PAYMENT        *
     C*             CHARGES FILE FOR OUTPUT TO THE DETAIL SCREEN.     *
     C*             IT REMOVES LEADING ZEROES & INSERTS A DECIMAL     *
     C*             POINT IN THE APPROPRIATE POSITION.                *
     C*                                                               *
     C*  CALLS :    NONE                                              *
     C*                                                               *
     C*  CALLED BY: CADETL                                            *
     C*                                                               *
     C*****************************************************************
     C*
     C                     MOVEAWFDIN     WA1,1
     C*
     C** Replace leading zeroes (if left of decimal point) with spaces
     C*
     C                     SETOF                     89
     C           15        SUB  WDIG      I                 -START
     C                     SUB  WDEC      I                  POS.
     C*
     C           14        SUB  WDEC      I1      30
     C*
     C           *IN89     DOUEQ'1'
     C                     ADD  1         I
     C           I         IFGT 15                          -CHECK FOR
     C                     SETON                     89      ARRAY END
     C                     ELSE
     C           WA1,I     IFNE '0'                         -CHECK FOR
     C                     SETON                     89      NON-ZERO
     C                     ELSE                              DIGIT.
     C           I         IFLE I1
     C                     MOVEL' '       WA1,I
     C                     END
     C                     END
     C                     END
     C                     END
     C*
     C** Move to output array, inserting a decimal point as appropriate
     C** (unless the input field was all zeros)
     C*
     C           I         IFGT 15
     C                     MOVEL*BLANKS   WFDOUT
     C                     GOTO UIEND
     C                     END
     C*
     C                     MOVEL*BLANKS   WA2
     C*
     C           WDEC      IFEQ *ZERO
     C                     MOVEAWA1,1     WA2,2
     C                     ELSE
     C                     MOVEAWA1,1     WA2,1
     C           16        SUB  WDEC      I
     C           I         ADD  1         I1
     C                     MOVEL'.'       WA2,I
     C                     MOVEAWA1,I     WA2,I1
     C                     END
     C*
     C                     MOVEAWA2,1     WFDOUT 16
     C*
     C*          *****     *****
     C           UIEND     ENDSR
     C*          *****     *****
     C/COPY ZSRSRC,ZALIGNZ2
     C** Copy the ZALIGN subroutine
     C/EJECT
     O*
     O** RELEASE FUNDS TRANSFER RECORD
     O*
     OPYCHGDDFE                EXPYCH
     O/EJECT
** CPY@   **      OBJECT COPYRIGHT
(c) Misys International Banking Systems Ltd. 2001
** PAGE NUMBER
Page 1Page 2Page 3Page 4Page 5
     X/COPY WNCPYSRC,FT0030X001
