     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas FT FT0040   payments maintenance level 1')       *
      *****************************************************************
      *                                                               *
      *  Midas - Funds Transfer Module                                *
      *                                                               *
      *  FT0040 - Outgoing Payments Maint.                            *
      *                                                               *
      *  (c) Finastra International Limited 2001                      *
      *                                                               *
      *  Last Amend No. AR1036310          Date 05Dec12               *
      *  Prev Amend No. AR918975           Date 21Mar12               *
      *                 AR928996A          Date 03May12               *
      *                 AR928996           Date 27Mar12               *
      *                 MD055733           Date 03Jul20               *
      *                 CSW220             Date 09Mar20               *
      *                 MD055612           DATE 09Mar20               *
      *                 MD046248           Date 27Oct17               *
      *                 CFT050             Date 03Jun13               *
      *                 AR895223           Date 19Nov12               *
      *                 CLE134             Date 01Aug12               *
      *                 AR787620           Date 10Jun11               *
      *                 CRE075             Date 06Dec10               *
      *                 CLE064             Date 06Dec10               *
      *                 CER059             Date 19Jul10               *
      *                 CER030             Date 09Jul08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      *                 CAP205             Date 03Mar10               *
      *                 CAP204             Date 09Feb10               *
      *                 BUG24998           Date 17Jul09               *
      *                 CSW209             Date 01Apr09               *
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 CRE026             Date 24May06               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CDL049             Date 06Jul06               *
      *                 CSD031             Date 10Apr06               *
      *                 227243             Date 26Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 BUG433             Date 02Dec05               *
      *                 CDL038             Date 10May05               *
      *                 CSW037A            Date 02May05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 BUG3644            Date 12Jul04               *
      *                 CLE025             Date 20Oct03               *
      *                 TDA035             Date 02Apr04               *
      *                 CSC022             Date 24Feb04               *
      *                 CGL029             Date 01Sep03               *
      *                 CSW203             Date 26May03               *
      *                 CRE008             Date 19Feb02               *
      * Midas Release 4.01 -------------------------------------------*
      *                 164560             Date 21Feb02               *
      *                 202937             Date 12Feb02               *
      * Midas Release 4 --------------- Base -------------------------*
      *                 CPK014             Date 04Oct01               *
      *                 195762             Date 16Jul01               *
      * Midas DBA 3.05 -----------------------------------------------*
      *                 CSD006             Date 11Oct00               *
      *                 CFT009             Date 18Jul00               *
      *                 189639             Date 02Apr01               *
      *                 179420             Date 28Mar01               *
      *                 186059             Date 08Feb01               *
      * Midas DBA 3.04 -----------------------------------------------*
      *                 179685             Date 14Aug00               *
      *                 CFT014             Date 11Aug00               *
      * Midas DBA 3.03 -----------------------------------------------*
      *                 CFT012             Date 08Jun00               *
      *                 175477             Date 24Feb00               *
      *                 175475             Date 24Feb00               *
      *                 175479             Date 08Feb00               *
      *                 175474             Date 21Jan00               *
      *                 175469             Date 19Jan00               *
      *                 181723             DATE 21Jul00               *
      *                 176510             DATE 15MAR00               *
      *                 CFT007             Date 12Nov99               *
      *                 124674             DATE 12NOV97               *
      *                 172367             Date 27Jan00               *
      * Midas DBA 3.02 -----------------------------------------------*
      *                 CAP031             Date 07FEB00               *
      *                 170801             Date 11Nov99               *
      * Midas DBA 3.01 -----------------------------------------------*
      *                 CGL007             Date 26Mar99               *
      *                 CGL009             Date 22JUL99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 CFT003             Date 25NOV98               *
      *                 CFT002             Date 25NOV98               *
      *                 133420             DATE 06OCT98               *
      *                 148229             DATE 23Dec98               *
      *                 145199             DATE 16OCT98               *
      *                 140626             Date 26Aug98               *
      *                 140642             Date 25Aug98               *
      *                 140640             Date 25Aug98               *
      *                 140652             Date 18Aug98               *
      *                 CEU006             Date 23Mar98               *
      *                 124673             DATE 10Jun98               *
      *                 S01408             DATE 17Mar98               *
      *                 099506             Date 23JAN98               *
      *                 098840             Date 22JAN98               *
      *                 120827             Date 06Jul97               *
      *                 100660             Date 06MAY97               *
      *                 096486             DATE 02APR97               *
      *                 CRT002             DATE 01DEB95               *
      *                 S01408             DATE 03OCT96               *
      *                 S01408             DATE 05AUG96               *
      *                 S01408             DATE 22JUL96               *
      *                 CAC001             DATE 01FEB96               *
      *                 073151             DATE 02JUL96               *
      *                 S01408             DATE 26JAN96               *
      *                 095075             DATE 25JAN96               *
      *                 S01408             DATE 22JAN96               *
      *                 093958             DATE 17JAN96               *
      *                 S01408             DATE 09JAN96               *
      *                 S01408             DATE 10NOV95               *
      *                 093926             DATE 30OCT95               *
      *                 087006             DATE 28APR95               *
      *                 S01408             DATE 25MAY95               *
      *                 084499             DATE 18APR95               *
      *                 079911             DATE 24FEB95               *
      *                 081663             DATE 09MAR95               *
      *                 082271             DATE 05MAR95               *
      *                 081043             DATE 06MAR95               *
      *                 079909             DATE 06MAR95               *
      *                 078189             DATE 16NOV94               *
      *                 074811             DATE 01AUG94               *
      *                 074810             DATE 01AUG94               *
      *                 S01508             DATE 27JUN94               *
      *                 S01506             DATE 27JUN94               *
      *                 S01499             DATE 06JUN94               *
      *                 S01494             DATE 25MAY94               *
      *                 S01408             DATE 17MAY94               *
      *                 068347             DATE 18MAR94               *
      *                 068320             DATE 17MAR94               *
      *                 068088             DATE 04JAN94               *
      *                 068092             DATE 03JAN94               *
      *                 064133             DATE 06DEC93               *
      *                 062394             DATE 24OCT93               *
      *                 S01408             DATE 01OCT93               *
      *                 061236             DATE 27SEP93               *
      *                 S01435             DATE 03AUG93               *
      *                 058476             DATE 21JUL93               *
      *                 S01408             DATE 16JUN93               *
      *                 S01408             DATE 14JUN93               *
      *                 056031             DATE 08JUN93               *
      *                 047179             DATE 29APR93               *
      *                 047167             DATE 27APR93               *
      *                 041692             DATE 27APR93               *
      *                 041276             DATE 27APR93               *
      *                 037575             DATE 27APR93               *
      *                 033695             DATE 27APR93               *
      *                 042167             DATE 15APR93               *
      *                 S01414             DATE 05APR93               *
      *                 041693             DATE 04JAN93               *
      *                 045014             DATE 07DEC92               *
      *                 031876             DATE 07DEC92               *
      *                 003352             DATE 13MAR92               *
      *                 051173             DATE 25SEP90               *
      *                 050918             DATE 23JAN91               *
      *                 041634             DATE 11JAN91               *
      *                 E37171             DATE 18MAR92               *
      *                 E35508             DATE 06FEB92               *
      *                 E29970             DATE 20JUN91               *
      *                 E32481             DATE 17JUN91               *
      *                 E32880             DATE 04JUN91               *
      *                 E32885             DATE 03JUN91               *
      *                 E32871             DATE 08MAY91               *
      *                 E32853             DATE 30APR91               *
      *                 E32536             DATE 18APR91               *
      *                 E32543             DATE 18APR91               *
      *                 E32772             DATE 22FEB91               *
      *                 E32553             DATE 22NOV90               *
      *                 S01195             DATE 13SEP90               *
      *                 S01194             DATE 13SEP90               *
      *                 S01117             DATE 13SEP90               *
      *                 E23059             DATE 08AUG90               *
      *                 E22337             DATE 22JUN90               *
      *                 E21458             DATE 14MAY90               *
      *                 S01251             DATE 03FEB90               *
      *                 S01252             DATE 03FEB90               *
      *                 S01241             DATE 08JAN90               *
      *                 S01199             DATE 17/08/89              *
      *                                                               *
      *---------------------------------------------------------------*
      *                                                               *
      *  AR1036310 - It is not possible to enter Instructed currency  *
      *              for a Regular Payment. Comment out the validation*
      *              that prohibits its entry for RP transactions.    *
      *              (Child: AR1036311)                               *
      *  AR918975 - Allow lower case SWIFT characters for STP.        *
      *             (Child: AR919050)                                 *
      *  AR928996A- Data truncation error. Amended PDATA and PDAT2    *
      *             data structure field to have the correct length.  *
      *             (Child: AR928997A)                                *
      *  AR928996 - Data lost due to rate field :36: being truncated. *
      *             (Child: AR928997)                                 *
      *  MD055733 - COB: Multiple UTCHOBJEX calls in LEC06A           *
      *             components.                                       *
      *           - Redeliver of MD050139.                            *
      *  CSW220 - SWIFT Changes 2020 (Recompile)                      *
      *  MD055612 - Compilation Core error                            *
      *  MD046248 - Finastra Rebranding                               *
      *  CFT050 - SWIFTRef Directories upload                         *
      *  AR895223 - Exchange rates should allow 5 digits. Fix is to   *
      *             increase the number of digits to five. Applied    *
      *             fix 257663. (Child: AR895224)                     *
      *  CLE134 - Past Due Call Loan Processing                       *
      *  AR787620 - Hooks Incorporation                               *
      *             WNCPYSRC,FTH00093                                 *
      *             WNCPYSRC,FTH00094                                 *
      *             WNCPYSRC,FTH00095                                 *
      *             WNCPYSRC,FTH00096                                 *
      *  CRE075 - Effective Date for Retail Accounts (Recompile)      *
      *  CLE064 - Enhancement of Lending Frequencies (Recompile)      *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  CER030 - Multicash German Feature (Recompile)                *
      *  CAP205 - Teller Related APIs - Account Balance Check         *
      *  CAP204 - Teller Related APIs - Account Transfer              *
      *  BUG24998 - Bank operation code is missing (Recompile)        *
      *  CSW209 - SWIFT 2009 Changes                                  *
      *  CRE026 - Consumer Banking (Recompile)                        *
      *  CDL049 - Addition of a Reference Rate field (recompile)      *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  227243 - Charge amount fields not reset. Fix is to make sure *
      *           correct charge field values are passed to FT0345    *
      *           during amendment of outgoing payments if switchable *
      *           feature CFT014 is on. Apply fix 223133.             *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  BUG433 - Recompiled due to change in FTXTRHPD & FTPCHGPD     *
      *  CDL038 - Extended Deal Sub Type (Recompile)                  *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  BUG3644 - Serious Error in Collateralised Lending (Recompile)*
      *  CLE025 - Credit Lines (Recompile)                            *
      *  TDA035 - RTS Signon changes for MidasPlus. (Recompile)       *
      *  CSC022 - Commitment Control Changes for MidasPlus            *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  CSW203 - SWIFT 2003 Standards Update                         *
      *  CRE008 - Cash Management                                     *
      *  164560 - Reinitialise the display/non display indicator for  *
      *           'Notified Delivery Ccy/Amt' fields, if returning    *
      *           to the first screen.                                *
      *  202937 - Release 4 packaging:                                *
      *           - A default timestamp string is required for        *
      *             file OPAYXL0 and OTPAY writes.                    *
      *  CPK014 - Release 4 packaging.  Rename of timestamp field.    *
      *  195762 - DBASE error in FTCALCLEV during input.              *
      *           Program FT000985 should not be called if CFT009     *
      *           is off.                                             *
      *  CSD006 - Use long DS with SDCURRPD.                          *
      *  CFT009 - Fees and Charges Development                        *
      *  189639 - Database error during deletion of incomplete Out-   *
      *           going Payment.  Extended fixes 179685 and 176510.   *
      *  179420 - No Error message on Blocked retail account when an  *
      *           Outgoing Payment is processed. Add message file     *
      *           processing. Partly apply fixes 164635 and 144936    *
      *  186059 - Map details of payment from incoming message.       *
      *  179685 - Extend 176510. Dbase/AOCUSTRO as CNUMA not being    *
      *           set up because of 176510. Move RETNUM to CNUM       *
      *  CFT014 - Straight-through Processing Phase 2 MT103           *
      *           Messages Generation for FT.                         *
      *  CFT012 - Cross currency transfers.                           *
      *  175477 - FONTIS : Map beneficiary bank detail                *
      *  175475 - FONTIS : Settlement ccy defaulted by /ORIG/         *
      *  175479 - FONTIS : dealer's reference field                   *
      *  175474 - FONTIS : Invalid A/C in :53a:                       *
      *  175469 - FONTIS : Euro nostro equivalent                     *
      *  181723 - Condition default fields for CFT002 on CFT002       *
      *  176510 - Fixes 162419 (175306) added to core.  This fix is   *
      *           equivalent to fixes 135950, 156861, 162507.         *
      *           Fix profit centre defaulting for 'Ordering Customer'*
      *           field and 'Ordering Bank' field entries.            *
      *           Only process 'Ord Bank' defaulting if the 'Ord Cust'*
      *           field is not equal to 'MT202'.                      *
      *           Profit centre should be defaulted using the         *
      *           'Profit Centre Default Matrix'; If action is INPUT  *
      *           and the profit centre field on the screen is left   *
      *           blank.                                              *
      *           Fix 171062 also added (Assign default profit        *
      *           Centre when Ordering Cust and Bank have been        *
      *           validated) Book Code is also a validated before     *
      *           Profit Centre is assigned.                          *
      *  CFT007 - BIC Database Plus Integration                       *
      *  124674 - Extension to 095075. Move settlement amount into    *
      *           work field when an amendment is made.               *
      *           Apply 093418. Default charges on amendment of       *
      *           exchange rate.                                      *
      *  172367 - Fields P#NDCY and P#NDAM are wrongly filled when    *
      *           CEU006 not switched on.                             *
      *  CAP031 - FT OPAY API - Recompile for changes to OTPAYDD      *
      *  170801 - Midas-Fontis IAT/TPP interface fix.                 *
      *           When redirecting in ccy payments to Euro. default   *
      *           pay delivery currency/amount to the original        *
      *           payment currency.  Also, specify PBRCA to be        *
      *           the ordering customer account branch code.          *
      *  CGL007 - Account Postings Enquiry                            *
      *  CGL009 - FONTIS IAT/TPP interface                            *
      *  CFT003 - FT Batch Authorisation and Settlment Method '14'    *
      *  CFT002 - Straight Through Proccessing Phase 1                *
      *  133420 - 079909 stops user from overriding warning errors.   *
      *  148229 - Changes to /COPY FT0010I001 (Recompile only)        *
      *  145199 - Recompile for changes to MEINCRPD and MEINMPPD made *
      *           in Year 2000 fix 124673.                            *
      *  140626 - Non-display SNDCY and SNDAM when not linked to      *
      *           SWIFT or external network.                          *
      *  140642 - Allow 11 characters for Swift Id.                   *
      *           Display warning W01 if Swift Id entered does not    *
      *           exist.                                              *
      *  140640 - Allow all warnings 'WXX' to be overriden.           *
      *  140652 - This fix avoid wrong warning msg 'W01' from being   *
      *           displayed in case following conditions are not met: *
      *           1.if Pay Delivery ccy entered, Pay ccy must be EUR  *
      *           or IN ccy.                                          *
      *           2.Pay Delivery ccy must be EUR or IN ccy.           *
      *  CEU006 - EMU FT Payments and Settlement.                     *
      *  124673 - Standardise 20th Century cut off date to below 72.  *
      *  S01408 - Moved Hook FT0040C014 to match position in R10.6    *
      *  099506 - Status of payments for OUTGOING PAYMENTS screen     *
      *           incorrectly displayed - remove conditioning on      *
      *           reset of STATUS field.                              *
      *  098840 - Pgm will not allow input of valid SWIFT ID for      *
      *           destination. Amended pgm so that if SWIFT ID is     *
      *           'S', DSADD is set to first 4 chars of SWIFT ID      *
      *           instead of blanks, so error 087 is not displayed.   *
      *  120827 - Profit Centre Accounting defaulting                 *
      *  100660 - Recalculate charges on amendment of settlement      *
      *           amount.                                             *
      *  096486 - Previous fix 065890.                                *
      *           To enable user to enquire on FT payments for FT     *
      *           postings.                                           *
      *  CRT002 - Retail Branch Access.                               *
      *  S01408 - Core hook FT0040CP49  added                         *
      *           Core hook FT0040CP48  added                         *
      *           Core hook FT0040CP47  added                         *
      *           Core hook FT0040CP46  added                         *
      *  S01408 - Core hook FT0040CP45  added                         *
      *           Core hook FT0040CP44  added                         *
      *           Core hook FT0040CP43  added                         *
      *           Core hook FT0040CP42  added                         *
      *           Core hook FT0040CP41  added                         *
      *           Core hook FT0040CP40  added                         *
      *           Core hook FT0040CP39  added                         *
      *           Core hook FT0040CP38  added                         *
      *           Core hook FT0040CP37  added                         *
      *           Core hook FT0040CP36  added                         *
      *           Core hook FT0040CP35  added                         *
      *           Core hook FT0040CP34  added                         *
      *           Core hook FT0040CP33  added                         *
      *           Core hook FT0040CP32  added                         *
      *           Core hook FT0040CP31  added                         *
      *           Core hook FT0040CP30  added                         *
      *           Core hook FT0040CP29  added                         *
      *           Core hook FT0040CP28  added                         *
      *           Core hook FT0040CP27  added                         *
      *  S01408 - Core hook FT0040CP26  added                         *
      *           Core hook FT0040CP25  added                         *
      *           Core hook FT0040CP24  added                         *
      *           Core hook FT0040CP23  added                         *
      *           Core hook FT0040CP22  added                         *
      *           Core hook FT0040CP21  added                         *
      *           Core hook FT0040CP20  added                         *
      *           Core hook FT0040CP19  added                         *
      *  CAC001 - Profit Centre Accounting Development:               *
      *           If Analytical Accounting is installed and there's   *
      *           a change in currencies, amounts or rate and the     *
      *           Margin Information details are not blanks, display  *
      *           Margin Info window if necessary.  Provide another   *
      *           parameter so that margin info details can be passed *
      *           between FT0040 and FT0345.                          *
      *  073151 - Allow Settlement type "02" for MT202 keyword.       *  *
      *  S01408 - Core hook FT0040CP15  added                         *
      *           Core hook FT0040CP16  added                         *
      *           Core hook FT0040CP17  added                         *
      *           Core hook FT0040CP18  added                         *
      *  095075 - Default charges on amendment of settlement amount.  *
      *  S01408 - Core hook FT0040FFP1  added                         *
      *           Core hook FT0040IIP1  added                         *
      *  093958 - Payment input does not check against the payment    *
      *           type sub-type combination table                     *
      *  S01408 - Core hook FT0040CP14  added                         *
      *  S01408 - Core hook FT0040CCP6  added                         *
      *           Core hook FT0040CCP7  added                         *
      *           Core hook FT0040CCP8  added                         *
      *           Core hook FT0040CCP9  added                         *
      *           Core hook FT0040CP10  added                         *
      *           Core hook FT0040CP11  added                         *
      *           Core hook FT0040CP12  added                         *
      *           Core hook FT0040CP13  added                         *
      *  093926 - Error on 084499  causing the base currency details  *
      *           to be ignored.                                      *
      *  087006 - Payment day in month should not be mandatory when   *
      *           Payment frequency is 'B' (last working day)         *
      *  S01408 - Core hook FT0040CCPG  added                         *
      *           Core hook FT0040CCP1  added                         *
      *           Core hook FT0040CCP2  added                         *
      *           Core hook FT0040CCP3  added                         *
      *           Core hook FT0040CCP4  added                         *
      *           Core hook FT0040CCP5  added                         *
      *  084499 - Access SDRETLPD only if RETAIL switched on.         *
      *  079911 - The 'message' on the 1st screen saying what was     *
      *           the reference no. of the last payment input , was   *
      *           not showing when F12 had been taken from FT0345     *
      *  081663 - Program should not revalidate Next payment date and *
      *           Final payment date if a warning is acknowledged that*
      *           these are holiday dates in local currency           *
      *  082271 - Error message 076 showing incorrectly.              *
      *           Was caused by 078189.                               *
      *  081043 - Clear the saved fields for the next payment date    *
      *           and final payment date before validating            *
      *           If in Insert validation the user changed the        *
      *           payment type from 'RP' to 'OP' then the previously  *
      *           validated saved dates were used (incorrectly)       *
      *  079909 - Output information message rather than database     *
      *           error message if no payment/charges record exists   *
      *           this branch.                                        *
      *  078189 - Simplify check on payment frequency - it should be  *
      *           a valid frequency for a regular payment and blank   *
      *           fro a non-regular payment.                          *
      *         - Do not default Next Payment Date, or highlight      *
      *           blank Payment Date/Frequency fields, for a          *
      *           non-regular payment.                                *
      *         - Set up program name correctly for DBERR processing  *
      *  074811 - Reversing of destination, settle date, pay date,    *
      *           next pay date and final pay date ON and OFF         *
      *           Fixed during development of S01494                  *
      *  074810 - After chaining to MUSERDD, check if RECI = 'D'      *
      *           Fixed during development of S01494                  *
      *  S01508 - BLI Extended Payments Charges                       *
      *  S01506 - BLI Payment Charges Enhancements                    *
      *  S01499 - BLI V.A.T. Processing                               *
      *  S01494 - BLI Funds Transfer Enhancements                     *
      *  S01408 - Core hook FT0040EEPG  added                         *
      *           Core hook FT0040OPG added                           *
      *           Core hook FT0040IIPG  added                         *
      *           Core hook FT0040CVKS added                          *
      *  068347 - Suppress Account movement duplicates.               *
      *  068320 - Show charge movements                               *
      *  068230 - Allow SWIFT BIC in Destination                      *
      *  068088 - 091 error only if not bank and not branch network   *
      *  068092 - Allow blanking of Order Bank                        *
      *  064133 - Outward  payment to a nostro which is different to  *
      *           the Sender's correspondent in a cover MT202 is not  *
      *           accepted.                                           *
      *  062394 - Use FT0310 to validate frequencies not table        *
      *  S01408 - Core hook FT0040FPG  added                          *
      *           Core hook FT0040CCBU added                          *
      *  061236 - Missing functionality re: Generation of MT202.      *
      *  S01435 - Incoming Message Management.                        *
      *  058476 - File fields not being initialized on insert.        *
      *  S01408 - Core hook FT0040CL1W added                          *
      *           Core hook FT0040CL1E added                          *
      *  S01408 - Core hook FT0040CVSR added                          *
      *           Core hook FT0040CVSF added                          *
      *  056031 - Change processing for Shadow Post Update.           *
      *           Tag to cover all fixed objects in GEMS              *
      *           Fix covers errors 041693,045014,031876              *
      *  047179 - Allows input of a closed account in the charge      *
      *           account field when the value date is greater than   *
      *           the current processing date.                        *
      *  047167 - The 'Settle Value Date' shown on the screen is      *
      *           sometimes defaulted to the NEXT DAY instead of TODAY*
      *  041692 - Where a payment was being credited to an account in *
      *           the same ccy, the system allowed an exchange rate   *
      *           to be entered. If the ccys are the same, then must  *
      *           validate the rate even if the override is set to 'Y'*
      *  041276 - Add/Deduct Indicator should default to 'A' not 'D'  *
      *           for an outgoing payment.                            *
      *  037575 - Several fields on OTPAYDD are not being initialized *
      *           on insert                                           *
      *  033695 - Sticky indicator (17) causes input inhibited fields *
      *           on insert after an amended payment.                 *
      *  042167 - Include CL program to check for record locking      *
      *  S01414 - Book Code and Profit Centre Incorporation.          *
      *  041693 - Apply 045014 and upgrade to r2.5.                   *
      *  045014 - Apply 031876.                                       *
      *           Do not call AOSPOSU0 if Regular Payment             *
      *           Include primary transaction reference               *
      *           Call FT0005 to get FT Control Data                  *
      *  031876 - Change processing for Shadow Post Update. Call new  *
      *           program AOSPOSU0. This now orders the updates in    *
      *           similar way to FX and MM.                           *
      *  003352 - Pay To Receive Days field PRBD updated incorrectly  *
      *           Ensure calculation of PRBD if receive CCY is valid  *
      *           also save field after validation to stop the        *
      *           overwriting to file.                                *
      *  051173 - Include error handling in windows RETRN code        *
      *           processing.                                         *
      *  050918 - Deal date flag not re-set.                          *
      *  041634 - Allow Sub-Type modification for an OP               *
      *  E37171  -  VALIDATION OF ADDRESS FIELDS INCORRECT            *
      *  E35508  -  VALIDATION BETWEEN ORDERING CUST AND ORDERING     *
      *             BANK INCORRECT                                    *
      *  E29970  -  ENABLE CMD7 WHEN CALLED FROM ENQUIRY SUBFILE      *
      *             TO ALLOW PROGRESSION TO NEXT PAYMENT              *
      *  E32481  -  REMOVAL OF REDUNDANT FLAGS                        *
      *  E32880  -  OUTPUT FULL REF TO RSACMTPD                       *
      *  E32885  -  Payments can be authorised whether or not         *
      *             they have any valid details from level 1 or 2     *
      *             input, since ' ' is used for VALID and never      *
      *             entered (default value).  Change to positive val. *
      *  E32871  -  no. of days between pay and settle can only be    *
      *             calc if pay currency is valid.                    *
      *  E32853  -  DAY IN MONTH FIELD NOT MANDATORY WHEN PAYMENT     *
      *             FREQUENCY IS DAILY, WEEKLY, OR FORTNIGHTLY        *
      *  E32536  -  IF UNALLOCATED NOSTRO NO 00 USED FOR PRONO UPDATE *
      *             REINSTATE REAL NOSTRO NO FOR AMOVTS SR TO STOP    *
      *             DB ERROR IN NOSTRO FILE                           *
      *  E32543  -  WARNING MESSAGE DISPLAYED IF DATE IS A HOLIDAY    *
      *             IN LOCAL CURRENCY                                 *
      *  E32772  -  S01241 causes database error in multitude of FT   *
      *             programs. Ordering customer is allowed to be a    *
      *             shortname but this is treated as a customer no.   *
      *             elsewhere. e.g. shortname 'GENO-LON B' gives a    *
      *             database error in FT0110 with key 755603. The     *
      *             quick ones amongst you will have spotted that this*
      *             is the bottom part of the hex representation of   *
      *             'GENO-L'                                          *
      *  E32553  -  MOVE OSMCY INSTEAD OF SMCY INTO CCY               *
      *  S01195  -  HOLIDAY PROCESSING                                *
      *  S01117  -  RELEASE 10 MULTIBRANCHING CHANGES                 *
      *  E23059  -  THE DEFAULT VALUE FOR THE NEXT PAYMENT DATE       *
      *             WILL  ALWAYS  BE  GREATER THAN THE RUN DATE.      *
      *  E22337  -  ENSURE THAT THE CORRECT HELP TEXT IS              *
      *             DISPLAYED  ON THE FIRST ENTRY SCREEN.             *
      *  E21458  -  REGULAR PAYMENTS GENERATION GENERATES PAYMENTS    *
      *             BACK TO MIDAS DAY 0 .                             *
      *  S01194  -  STANDING DATA CHANGES                             *
      *  S01251  -  SYNON FIELD/PROGRAM NAME CHANGES                  *
      *  S01252  -  ADDITIONAL SPARE WINDOW MANAGER PARAMETER,        *
      *             BLANK RETURN CODE NB. SPARE WINDOW PARAMETER      *
      *             CALLED SPAREE TO AVOID CONFUSION WITH SPARE IN    *
      *             LDA.                                              *
      *  S01241  -  WINDOW INCORPORATION                              *
      *  S01199  - HELP SYSTEM                                        *
      *                                                               *
      *****************************************************************
      *
      *  FUNCTION OF INDICATORS
      *
      *  01    F3 PRESSED - EXIT PROGRAM
      *  02    RECORD UPDATED BY ANOTHER WORKSTATION
      *  03    SAR CEU006 INSTALLED                                       CEU006
      *  04    F10 PRESSED - TO DELETE RECORD
      *  05    F12 PRESSED - RETURN TO INITIAL SCREEN
      *                      (exit if parmeter XPREF non-blank)
      *  06    F21 IS PRESSED WHILE IN THE ENQUIRY MODE                   S01494
      *  07    COMMAND 7 PRESSED FOR NEXT PAYMENT IN SUBFILE ENQ PROG     E29970
      *  08    INVALID NOTIFIED DELIVERY CURRENCY                         CEU006
      *  09    INVALID NOTIFIED DELIVERY AMOUNT                           CEU006
      *  10    INVALID PAY DELIVERY CURRENCY                              CEU006
      *  11    INVALID PAY DELIVERY AMOUNT                                CEU006
      ***11    HELP PRESSED                                               S01199
      *  12    INPUT
      *  13    AMENDMENT
      *  14    DELETION
      *  15    ENQUIRY
      *  16    PAYMENT INCOMPLETE (GENERATED FROM AN INCOMING PAYMENT)
      *  17    PAYMENT GENERATED FROM AN INCOMING ONE
      *  18    INDICATOR TO PROTECT PAYMENT SUBTYPE UNLESS OP FROM IN
      *  19    CALLED FROM SUB-FILE ENQUIRY SCREEN                        E29970
      *  20    INVALID ACTION CODE
      *  21    INVALID PAYMENT REFERENCE
      *  22    INVALID PAYMENT TYPE
      *  23    INVALID PAYMENT SUB-TYPE
      *  24    INVALID DESTINATION
      *  25    INVALID ORDERING CUSTOMER
      *  26    INVALID SENDER'S CORRESPONDENT
      *  27    INVALID ORDERING BANK
      *  28    INVALID SETTLEMENT AMOUNT
      *  29    INVALID SETTLEMENT CURRENCY
      *  30    INVALID SETTLEMENT DATE
      *  31    INVALID RATE
      *  32    INVALID OVERRIDE FLAG
      *  33    INVALID PAY PLUS CHARGES
      *  34    INVALID PAY AMOUNT
      *  35    INVALID PAY CURRENCY
      *  36    INVALID PAY DATE
      *  37    INVALID REGULAR PAYMENT FLAG
      *  38    INVALID PAYMENT FREQUENCY
      *  39    INVALID DAY IN MONTH
      *  40    INVALID FINAL DATE
      *  41    INVALID SETTLEMENT TYPE
      *  42    INVALID SWIFT PRIORITY CODE
      *  43    INVALID MT202 INDICATOR
      *  44    ON AMENDMENT PAYMENT DETAILS HAVE CHANGED
      *  45    INVALID NEXT PAYMENT DATE
      *  46    LAST ENTRY WAS AN INPUT
      ***47****WARNING*ERROR*ON*SETTLEMENT*TYPE*                          E32543
      ***47****Set*off*but*not*used******************************** 031876CEU006
      *  47    Only display notified delivery fields if processing        CEU006
      *        Swift message.                                             CEU006
      ***48****1ST*TIME*THROUGH*FOR*WARNING*ERROR*47*                     E32543
      *  48    Switchable feature CFT014 is installed                 *   CFT014
      ***49****ACCOUNT*NUMBER*NOT*A*NOSTRO**********                      175479
      *  48    SHOW/HIDE FONTIS: DEAL REFERENCE FIELD                     175479
      *  49    Error on Original Rate                                     CFT014
      *  50    INVALID SETTLEMENT IBLC CODE
      *  51    INVALID PAY IBLC CODE
      *  52    INVALID IBLC COUNTRY CODE
      *  53    INVALID MARKET INDICATOR
      *  54    INVALID MT100 CUSTOMER NAME/NUMBER
      *  55    RETAIL ACCOUNT NUMBERS NOT ALLOWED
      *  55    CFT009 installed                                           CFT009
      *  56    INVALID BOOKING BRANCH                                     S01117
      *  57    MULTI BRANCH ENVIRONMENT                                   S01117
      *  58    ORIGINATING BRANCH SCREEN FIELD                            S01117
      *  59    INVALID ORIG BRANCH                                        S01117
      ************                                                        031876
      ************  Remove PRONO OLPOS and MEMOS                          031876
      ************                                                        031876
      ***60****RECORD FROM PRONO WRITTEN TO AME FILE                      031876
      *  60    Chain to MEISOCL1                                          CFT014
      *  60    Chain to ACNUMA                                            CFT014
      ***61****CHAIN TO FPTRNF FOR VERIFICATION OF RETAIL BEING NOSTRO    031876
      *  61    Booking Branch validate in detail processing               S01435
      *  62    REDISPLAY SCREEN IN FQRY                                   S01194
      *  63    USED IN LOKUP IF '?' FOUND                                 S01194
      *  64    IF '?' FOUND IN DESTINATION FIELD                          S01194
      *  65    IF '?' FOUND IN ORD CUSTOMER FIELD                         S01194
      *  66    FINAL PAY DATE IS A HOLIDAY                                E32543
      *  67    NEXT PAY DATE IS A HOLIDAY                                 E32543
      *  68    1ST TIME THROUGH FOR WARNING ERROR 72                      E32543
      ***69****Switchable feature CFT014 is installed                                   CFT014CFT009
      *  69    Invalid Spread Set                                                             CFT009
     F/COPY WNCPYSRC,FT0040F001
      *  70    ITEM NOT FOUND ON LOKUP OPERATION
      *  70    SETLL on FTXTRHL0                                          CFT009
      *  70    SETLL on FTPDOCL0                                          CFT009
      *  71    ITEM FOUND ON LOKUP OPERATION
      *  72    WARNING MSG INDICATOR                                      E32543
      *  73    PAYMENT FREQUENCY IS 'D', 'W', OR 'F'                      E32853
      *  73    Invalid Spread Set                                         CFT009
      *  74    Book Code field     - error/reverse image                  S01414
      ***75****CHAIN*ERROR*CODE*FOR*AMOVTS*SUBROUTINE*                    S01414
      *  75    Profit Centre field - non display/protect                  S01414
      *  76      "       "     "   - allow input                          S01414
      *  77      "       "     "   - error/reverse image                  S01414
      *  78    Used by message subfile                                    S01435
      *  79    Putovr and Overlay on message subfile                      S01435
      *  80    Chain failed on files used for extra information           S01494
      *  81    Used for scanning P72 for /OCMT/                           CEU006
      *  82    Used for check on valid amount chars in Swift string       CEU006
      *  83    CONDITION AVAILABILITY OF F4 AND F16 ON SCREEN             CFT007
      *  84    Error/warning for date offset code                         CFT009
      *  85    ERROR IN DESTINATION ADDRESS
      *  86    ERROR IN ORDERING CUSTOMER ADDRESS
      *  87    NO PAYMENT CHARGES RECORD FOR BRANCH                       133420
      *  88    GENERAL CHAIN ERROR CODE
      *  89    GENERAL ERROR CODE
      *  90-99 STANDARD SUBROUTINE INDICATORS
      *
      *****************************************************************
     FFT0040DFCF  E                    WORKSTN
     F/COPY WNCPYSRC,FT0040F002
     F                                              KINFDS INFDS#         CFT007
     FOTPAY   UF  E           K        DISK                      A
     F                                              KCOMIT
     FOTPAYZZ UF  E                    DISK
     F                                              KCOMIT
      ************                                                        031876
      ************  Remove PRONO OLPOS and MEMOS                          031876
      ************                                                        031876
     F*PRONO***UF**E           K        DISK                          U2  031876
     F************                                  KCOMIT                031876
     F************PRONOHHF                          KIGNORE               031876
     F*OLPOS***UF**E           K        DISK                          U2  031876
     F************                                  KCOMIT                031876
     F************OLPOSHHF                          KIGNORE               031876
     F************OLPOSOBF                          KIGNORE               031876
     F*MEMOS***UF**E                    DISK                          U1  031876
     F************                                  KCOMIT                031876
     F*CLINT***IF**E***********K********DISK                              S01194
     F************CLINTCAF**************************KIGNORE               S01194
     F************CLINTCCF**************************KIGNORE               S01194
     F************CLINT111**************************KIGNORE               S01194
     F*SNAME***IF**E***********K********DISK                              S01194
     F************CLINTCBF**************************KRENAMESNAMEF         S01194
     FACCNT   IF  E           K        DISK
     F            ACCNTAAF                          KIGNORE
     F            ACCNTACF                          KIGNORE
     FACNUMA  IF  E           K        DISK
     F            ACCNTABF                          KRENAMEACNUMAF
     F*TABFP***IF**E***********K********DISK                              S01194
     F************TABTG20F**************************KIGNORE               S01194
     F************TABLETHF**************************KIGNORE               S01194
     F************TABLETRF**************************KIGNORE               S01194
     F************TABLETPF**************************KIGNORE               S01194
     F************TABTE10F**************************KIGNORE               S01194
     F*PYCHGDD*IF**E********************DISK                              S01194
     F*TABTB40*IF**E********************DISK                              S01194
     F*FPRTN***IF**E***********K********DISK                              S01194
     F************TABLETLF**************************KRENAMEFPRTNF         S01194
     FPYCHGDB IF  E           K        DISK                               S01117
      ************                                                        031876
      ************  Remove RSACMTPD                                       031876
      ************                                                        031876
     F*RSACMTPDO***E                    DISK         KCOMIT               031876
     FSDMMODPDIF  E                    DISK                               S01241
     F*                                                                   S01408
     F/COPY WNCPYSRC,FT0040FFP1                                           S01408
     F*                                                                   S01408
     FMUSER   IF  E           K        DISK                               S01494
     FMEINCRL1IF  E           K        DISK                               S01494
     FFDDTSTL1IF  E           K        DISK                               093958
     F** Core hook for externalisation.                                   S01408
     F/COPY FTCPYSRC,SFTSWFTF                                             068230
     F/COPY WNCPYSRC,FT0040FPG                                            S01408
     F/COPY WNCPYSRC,FT0040DFPG                                           S01435
      *                                                                   S01435
      *  /Copy point for File Definition                                  S01435
      *                                                                   S01435
     FOTPAYXL0UF  E           K        DISK                      A    UC  CFT003
     F                                              KCOMIT                CFT003
     F            OTPAYXDF                          KRENAMEOPAYXL0        CFT014
      *                                                                   CFT003
      * Outgoing payment extension file                                   CFT003
     FOTPAYXL2IF  E           K        DISK                           UC  CFT014
     F            @OPYXL2                           KRENAMEOPAYXL2        CFT014
      *                                                                   CFT003
     FMEFNODL1IF  E           K        DISK                           UC  CGL009
      ** Midas FONTIS TPP nostro defaults                                 CGL009
      *                                                                   CGL009
     FSDNOSTL3IF  E           K        DISK                               CGL009
      ** Midas Nostro details                                             CGL009
     FMEISOCL1IF  E           K        DISK                               CFT014
      ** ISO Country Codes file                                           CFT014
      *                                                                   CGL009
     FFTXTRHL0IF  E           K        DISK                               CFT009
     FFTPCHGL0IF  E           K        DISK                               CFT009
     FFTPDOCL0IF  E           K        DISK                               CFT009
      ** Payment date offset codes                                        CFT009
     F/EJECT                                                              S01435
      *                                                                   S01408
     E/COPY WNCPYSRC,FT0040EEPG                                           S01408
      *                                                                   S01408
     E                    CPY@    1   1 80
     E*                                                                   S01194
     E                    FLDQ       10  1                                S01194
     E*                                                                   S01194
     E**********          WRKA       10  1                                             S01194 CGL029
     E                    WRKA       18  1                                                    CGL029
     E*
     E*   TABLES
     E*
     E                    NDY    31  31  2  A            DAY IN MONTH
     E********************PYFQ   13  13  1  A            PAYMENT FREQUE   062394
     E                    ZA1        16  1               ZALIGN SR. ARRAY
     E                    ZA2        16  1               ZALIGN SR. ARRAY
     E                    ZYDY    4   4  4 0             ZDATE1/2 SR.ARRAY
     E                    ZMDY   13  13  3 0             ZDATE1/2 SR.ARRAY
     E                    ZMNM   12  12  3               ZDATE2 SR. ARRAY
     E                    DIG1       13  1               UNEDITED VALUE
     E                    DIG2       14  1               EDITED VALUE
     E                    ERCD       38  4               ERROR CODES
     E                    POWER   1   7  7 3             POWERS TABLE
     E********************ZHC        50  3               ZFREQ SR. ARRAY  S01195
     E                    ZFMD   12  12  2               ZFREQ SR. ARRAY
      ************                                                        031876
      ************  Remove PRONO OLPOS and MEMOS                          031876
      ************                                                        031876
     E************        PDT         5  5 0A            PRONO DATES      031876
     E************        PNV         5 15 0A            PRONO BALANCES   031876
     E************        PNO         5 15 0A            PRONO BALS(OLD)  031876
     E************        OLD        16  5 0A            OLPOS DATES      031876
     E************        OIN        16 15 0A            OLPOS INCOMING   031876
     E************        OUT        16 15 0A            OLPOS OUTGOING   031876
     E********************HCC        25  3               HOLIDAY ARRAY    S01195
     E                    SWCH   47  47  1               SWFT SET
     E                    TST        35  1               WORK ARR
     E                    FLD         1 35               WORK ARR
     E                    POWERS  1   6  7 0             FOR CHARGES
     E                    FCTR    1   4  4 0             FACTORS TABLE
     E                    YA1        15  1               DATE  ARRY       S01435
     E                    @A         15  1               WORK ARR         CEU006
      *                                                                   CGL009
      ** Work array for P72 /RATE/ extraction                             CGL009
      *                                                                   CGL009
     E                    @R1        13  1                                CGL009
      *                                                                   CGL009
      ** Work array to determine null amount                              CGL009
      *                                                                   CGL009
     E                    @NL        15  1                                CGL009
      *                                                                   CGL009
      ** Work array to strip off character '/' from field (35 char)       CGL009
      *                                                                   CGL009
     E                    @I35       35  1               Input table      CGL009
     E                    @O35       35  1               Output table     CGL009
      *                                                                   175479
      ** Work array used in SR CWVAL to store content of tag              175479
      *                                                                   175479
     E                    @CW       256  1                                175479
      *                                                                   175479
      ** Work array used in SR CWVAL to store value extracted             175479
      *                                                                   175479
     E                    @VL       256  1                                175479
      *                                                                   031876
      *  Error texts                                                      031876
      *                                                                   031876
     E                    ERR@    1   1 80                                031876
      *                                                                   031876
      *  Subroutine stack                                                 031876
      *                                                                   031876
     E                    @STK       20 10                                031876
      *                                                                   S01435
      *  Warning check array                                              S01435
      *                                                                   S01435
     E                    WRN@       40  1                                S01435
      ** Work array Multiple Lines of First Line of Pxx fields            CFT014
     E                    LFLT        5 59                                CFT014
      ** Work array Multiple Lines of Charges Amounts                     CFT014
     E                    CGA         5 11 0                              CFT014
      ** Work array Multiple Lines of Charges Currencies                  CFT014
     E                    CGC         5  3                                CFT014
     E                    STAMP   1   1 26                                                    202937
      **                                                                                      CSC022
      ** Array to hold commitment jobs name                                                   CSC022
      **                                                                                      CSC022
     E                    WCMT       10 10                                                    CSC022
      ** Array containing dummy timestamp                                                     202937
     E/COPY ZSRSRC,ZHOLE                                                  S01195
     E/COPY FTCPYSRC,SFTSWFTE                                             068230
     E/COPY WNCPYSRC,FT0040DEPG                                           S01435
      *                                                                   S01435
      *  /Copy point for Arrays                                           S01435
      *                                                                   S01435
     E/EJECT                                                              S01435
     IOTPAYDDF
     I              LCHT                            OTLCHT
     I              LCD                             OTLCD
     I*                                                                   S01414
     I* Rename of ACCNT/ACNUMA Profit Centre to avoid overwriting         S01414
     I*                                                                   S01414
     IACCNTABF                                                            S01414
     I              PRFC                            ACPRFC                S01414
     I              CNUM                            RETNUM                176510
     I*                                                                   S01414
     IACNUMAF                                                             S01414
     I              PRFC                            ACPRFC                S01414
     I              CNUM                            RETNUM                176510
     I/COPY WNCPYSRC,FT0040I003
      /EJECT                                                              CEU006
      *                                                                   CEU006
     I/COPY FTCPYSRC,FT0010I001                                           CEU006
      *                                                                   CEU006
      /EJECT                                                              S01435
      *                                                                   S01435
     I/COPY WNCPYSRC,FT0040DIPG                                           S01435
      *                                                                   S01435
      *  /Copy point for Input specifications                             S01435
     ITRCDE2      DS                                                      CFT002
      *                                                                   CFT002
      *  Break down MIDAS equivalent                                      CFT002
     I                                        1   6 TRCNUM                CFT002
     I                                        7   9 TRCYCD                CFT002
     I**********                             10  13 TRACOD                             CFT002 CGL029
     I**********                             14  15 TRACSQ                             CFT002 CGL029
     I**********                             16  18 TRBRCD                             CFT002 CGL029
     I**********                             10  15 TRCDSQ                             CFT002 CGL029
     I**********                             10  18 TRCSB                              CFT002 CGL029
     I                                       10  19 TRACOD                                    CGL029
     I                                       20  21 TRACSQ                                    CGL029
     I                                       22  24 TRBRCD                                    CGL029
     I                                       10  21 TRCDSQ                                    CGL029
     I                                       10  24 TRCSB                                     CGL029
      *                                                                   S01435
     IINFT      E DSMEINFTPD                                              S01435
      *                                                                   S01435
      *  Define parameters to be passed for FT IMM update                 S01435
      *                                                                   S01435
     I*  DATA STRUCTURE FOR COMPILATION  - COPYRIGHT INSERTION
     ICPYR@#      DS
     I                                        1  80 CPY@
     I                                        1  20 CPY@##
     I*
     I*     DATA AREA DATA STRUCTURE FOR HANDLING DB ERRORS
     I*
     I*DLDA******E*DSLDA                                                  S01194
     IDLDA        DS                            256                       S01194
     I                                      134 141 DBFILE                S01194
     I                                      142 170 DBKEY                 S01194
     I                                      171 180 DBPGM                 S01194
     I                                      181 1830DBASE                 S01194
     I*
     I*     DATA AREA FOR ORDINARY PAYMENT REF NUMBERING
     I*
     I***OTPAYD    E DSOTPAYDA                                                              MD055612
     IOTPAYD      DS                              4                                         MD055612
     I                                        1   40WOTSQ                                   MD055612
     I*
     I*     DATA AREA FOR REGULAR PAYMENT REF NUMBERING
     I*
     IRGPAYD    E DSRGPAYDA
     I*
     I*     DATA AREA TO REDEFINE IPREF FOR INSERTS
     I*
     I            DS
     I                                        1  15 IPREF
     I                                        1   1 P
     I                                        2   70RUND3
     I                                        8  110PRNUM
     I                                       12  13 PYTP
     I                                       14  150STMT
     I/COPY WNCPYSRC,FTH00093
     I*
     I*     DATA AREA TO REDEFINE RETAIL NOSTRO FIELD
     I*
     IRTNO        DS
     I**********                              1   60CNUMN                                     CSD027
     I                                        1   6 CNUMN                                     CSD027
     I                                        7  160ACODNP                                    CGL029
     I                                       17  180ACSQNP                                    CGL029
     I                                       19  21 BRCANP                                    CGL029
     I                                        7   9 CCYN                                      CGL029
     I                                       10  190ACODN                                     CGL029
     I                                       20  210ACSQN                                     CGL029
     I                                       22  24 BRCAN                                     CGL029
     I                                        1  100ACNON
     I**********                              7   9 CCYN                                      CGL029
     I**********                              7  100ACODNP                                    CGL029
     I**********                             11  120ACSQNP                                    CGL029
     I**********                             10  130ACODN                                     CGL029
     I**********                             13  15 BRCANP                             S01117 CGL029
     I**********                             14  150ACSQN                                     CGL029
     I**********                             16  18 BRCAN                              S01117 CGL029
     I*
     I*     DATA AREA FOR PROGRAM STATUS DISK AREA
     I*
     IPSDS       SDS
     I                                        1  10 ##PGM                 S01435
     I**************************************244 253 WID                   S01117
     I                                      244 253 WSID                  S01117
     I                                      254 263 USRID
     I/COPY WNCPYSRC,FT0040I002
     I*
      ************                                                        031876
      ************  Remove PRONO OLPOS and MEMOS                          031876
      ************                                                        031876
     I****DATA*STRUCTURE FOR MEMOS RECORD                                 031876
     I************DS                                                      031876
     I************                            1  150LDBLN                 031876
     I************                            1  150MMLDBL                031876
     I************                           16  300CLBLN                 031876
     I************                           16  300MMCLBL                031876
     I*
     I*     DATA AREA TO REDEFINES FIELDS
     I*
     I            DS
     I                                        1 152 ERCD
     I                                        1  76 ERR1
     I                                       77 152 ERR2
     I                                      153 165 DIG1
     I                                      153 1650DIG1N
     I                                      166 179 DIG2
     I                                      166 179 DIG2A
     I                                      180 1850ZDATE
     I                                      180 181 ZDD
     I                                      182 183 ZMM
     I                                      184 185 ZYY
     I                                      184 1850ZYN
     I**************************************186 187 SSWPC                 S01117
     I**************************************186 1870SSWPCN                S01117
     I**************************************188 192 CURR                  S01117
     I**************************************191 192 CURRN                 S01117
     I************************************P*193 1998SRATE                 S01117
     I************************************P*193 1990SRATE0                S01117
     I**************************************200 2050ODATE                 S01117
     I**************************************200 201 ODD                   S01117
     I**************************************202 203 OMM                   S01117
     I**************************************204 205 OYY                   S01117
     I                                      186 186 SSWPC                 S01117
     I                                      187 191 CURR                  S01117
     I                                      190 191 CURRN                 S01117
     I                                    P 192 1988SRATE                 S01117
     I                                    P 192 1980SRATE0                S01117
     I                                      199 2040ODATE                 S01117
     I                                      199 200 ODD                   S01117
     I                                      201 202 OMM                   S01117
     I                                      203 204 OYY                   S01117
     I            DS                                                      CFT014
     I                                    P   1   78WORTE                 CFT014
     I                                    P   1   70WORTE0                CFT014
      *
     I*
      ************                                                        031876
      ************  Remove PRONO OLPOS and MEMOS                          031876
      ************                                                        031876
     I******DATA*STRUCTURES FOR REDEFINITION OF TABLES                    031876
     I**OLPOS*DATES                                                       031876
     I************DS                                                      031876
     I************                            1  48 ODT                   031876
     I************                        P   1  48 OLD                   031876
     I**OLPOS*INCOMING                                                    031876
     I************DS                                                      031876
     I************                            1 128 OFI                   031876
     I************                        P   1 128 OIN                   031876
     I**OLPOS*OUTGOING                                                    031876
     I************DS                                                      031876
     I************                            1 128 OFO                   031876
     I************                        P   1 128 OUT                   031876
     I**PRONO*DATES                                                       031876
     I************DS                                                      031876
     I************                            1  15 PND                   031876
     I************                        P   1  15 PDT                   031876
     I**PRONO*BALANCE                                                     031876
     I************DS                                                      031876
     I************                            1  40 PNB                   031876
     I************                        P   1  40 PNV                   031876
     I*
     I*     DATA STRUCTURE REDEFINING ACCNT KEY FIELDS
     I*
     I            DS
     I**********                              1   60CNUM                                      CSD027
     I                                        1   6 CNUM                                      CSD027
     I                                        1   6 CNUMA                 S01194
     I                                        7   9 CCY
     I                                       10  190ACOD                                      CGL029
     I                                       10  19 ACODA                                     CGL029
     I                                       20  210ACSQ                                      CGL029
     I                                       20  21 ACSQA                                     CGL029
     I                                       22  24 BRCA                                      CGL029
     I                                        1  24 AKEYF                                     CGL029
     I**********                             10  130ACOD                                      CGL029
     I**********                             10  13 ACODA                              S01194 CGL029
     I**********                             14  150ACSQ                                      CGL029
     I**********                             14  15 ACSQA                              S01194 CGL029
     I**********                             16  18 BRCA                               S01117 CGL029
     I****************************************1  15 AKEYF                 S01117
     I**********                              1  18 AKEYF                              S01117 CGL029
     I*                                                                   S01194
     I*     DATA STRUCTURE REDEFINING NOSTRO NUMBERS                      S01194
     I*                                                                   S01194
     I            DS                                                      S01194
     I                                        1   20NOSN                  S01194
     I                                        1   2 NOSNA                 S01194
     I*
     I*     DATA STRUCTURE REDEFINING ADDRESS  FIELDS
     I*
     I            DS
     I                                        1 175 ADDRSS
     I                                        1  35 ADCHK1
     I                                       36  70 ADCHK2
     I                                       71 105 ADCHK3
     I                                      106 140 ADCHK4
     I                                      141 175 ADCHK5
     I*
     I*     DATA STRUCTURE REDEFINING ORBK FOR KEYS
     I*
     I            DS
     I**********  DS                          1   60ORNUM                                     CGL029
     I**********                              7  100ORCOD                                     CGL029
     I**********                             11  120ORSEQ                                     CGL029
     I**********                             13  150ORBRC                                     CGL029
     I****************************************1  12 ORBKS                 S01194
     I**********                              1  15 ORBKS                              S01194 CGL029
     I*
     I*     DATA STRUCTURE FOR COMMITMENT BOUNDARY IDENTIFIERS
     I*
     ICOMBOU      DS
     I                                        1   50TRANS
     I                                        6   7 MODULE
     I                                        8  15 PROG
     I                                       16  18 WID1
     I                                       19  240TIM
     I                                       25  25 ACTION
     I                                       26  35 USRID1
     I                                       51  60 WID2
     I                                       61  75 PREF
     I*
     I*      DATA STRUCTURE FOR GENERAL REDEFINITION
     I*
     I            DS
     I*  DESTINATION
     I                                        1  35 SDST1
     I                                       36  70 SDST2
     I                                       71 105 SDST3
     I                                      106 140 SDST4
     I                                        1 140 DESTAN
     I                                        1   5 DNOS
     I                                        1   3 NCUR
     I                                        4   5 NNUM                  S01194
     I                                        6 140 D5R
     I                                        7 140 D6R
     I                                        1  10 DRET
     I                                        1  10 DCUS
     I                                       11 140 D10R
     I                                        1   6 DNUM
     I                                        7   9 DSCY
     I                                       10  19 DCOD                                      CGL029
     I                                       20  21 DSEQ                                      CGL029
     I                                       22  24 DBRC                                      CGL029
     I                                       22 140 D15R                                      CGL029
     I                                       25 140 D18R                                      CGL029
     I**********                             10  13 DCOD                                      CGL029
     I**********                             14  15 DSEQ                                      CGL029
     I**********                             16  18 DBRC                               S01194 CGL029
     I**********                             16 140 D15R                                      CGL029
     I**********                             19 140 D18R                               S01194 CGL029
     I/COPY WNCPYSRC,FT0040I006
     I* SENDER'S CORRESPONDENT
     I                                      141 150 SSNCO
     I                                      141 142 SNOS
     I                                      143 150 S2R
     I                                      141 150 SRET
     I*  ORDERING BANK
     I            DS                                                                          CGL029
     I                                        1  18 SORBK                                     CGL029
     I                                        1   2 ORNS                                      CGL029
     I                                        3  18 OR2R                                      CGL029
     I                                        1  10 ORRT                                      CGL029
     I                                       11  18 OR10R                                     CGL029
     I                                        1   6 ORNM                                      CGL029
     I                                        7  16 ORCD                                      CGL029
     I                                       17  18 ORSQ                                      CGL029
     I**********                            151 162 SORBK                                     CGL029
     I**********                            151 152 ORNS                                      CGL029
     I**********                            153 162 OR2R                                      CGL029
     I**********                            151 160 ORRT                                      CGL029
     I**********                            161 162 OR10R                                     CGL029
     I**********                            151 156 ORNM                                      CGL029
     I**********                            157 160 ORCD                                      CGL029
     I**********                            161 162 ORSQ                                      CGL029
     I/COPY WNCPYSRC,FT0040I007
     I* ORDERING CUSTOMER
     I            DS                                                                          CGL029
     I                                        1  35 SORC1                                     CGL029
     I                                       36  70 SORC2                                     CGL029
     I                                       71 105 SORC3                                     CGL029
     I                                      106 140 SORC4                                     CGL029
     I                                        1 140 ORDCST                                    CGL029
     I                                        1   6 ONUM                                      CGL029
     I                                        1   6 ONUM2                                     CGL029
     I                                        7  16 OCOD                                      CGL029
     I                                        1  10 ORET                                      CGL029
     I                                        1  10 OCUS                                      CGL029
     I                                       17  18 OSEQ                                      CGL029
     I                                       19  21 OBRC                                      CGL029
     I                                        7 140 O06R                                      CGL029
     I                                       11 140 O10R                                      CGL029
     I                                       19 140 O12R                                      CGL029
     I                                       22 140 O15R                                      CGL029
     I**********                            163 197 SORC1                                     CGL029
     I**********                            198 232 SORC2                                     CGL029
     I**********                            233 267 SORC3                                     CGL029
     I**********                            268 302 SORC4                                     CGL029
     I**********                            163 302 ORDCST                                    CGL029
     I**********                            163 172 ORET                                      CGL029
     I**********                            163 172 OCUS                                      CGL029
     I**********                            173 302 O10R                                      CGL029
     I**********                            163 168 ONUM                                      CGL029
     I**********                            163 168 ONUM2                              176510 CGL029
     I**********                            169 172 OCOD                                      CGL029
     I**********                            173 174 OSEQ                                      CGL029
     I**********                            175 302 O12R                                      CGL029
     I**********                            175 177 OBRC                               S01194 CGL029
     I**********                            178 302 O15R                               S01194 CGL029
     I**********                            169 302 O06R                               S01241 CGL029
     I/COPY WNCPYSRC,FT0040I011
     I*
     I* DATA STRUCTURE TO REDEFINE DATES
     I*
     I            DS
     I                                        1   6 PYDT
     I                                        1   60PYDTN
     I                                        7  12 PYVD
     I                                        7  120PYVDN
     I                                       13  18 FIND
     I                                       13  180FINDN
     I                                       19  24 NDAT
     I                                       19  240NDATN
     I*
     I* DATA STRUCTURE TO REDEFINE SETTLEMENT TYPE
     I*
     I            DS
     I                                        1   2 SSTTP
     I                                        1   20SSTTPN
     I*
     I****Data*structure*to*redefine*%*as*rate.                           S01194
     I************DS                                                      S01194
     I************                        P   1   32PRTDIS                S01194
     I************                        P   1   34RATDIS                S01194
      *                                                                   CAC001
     ISPAREE      DS                            256                       CAC001
      * Define the data structure to pass data to WN0010 and return pgm   CAC001
      *                                                                   CAC001
     I                                        1   1 WACTN                 CAC001
     I                                    P   2   88WRATE                 CAC001
     I                                        9   9 WPSIN                 CAC001
     I                                       10  12 WPCCY                 CAC001
     I                                       13  15 WSMCY                 CAC001
     I                                    P  16  220WPYAM                 CAC001
     I                                    P  23  290WSMAM                 CAC001
     I                                       30  300WMDIN                 CAC001
     I                                    P  31  342WFXMP                 CAC001
     I                                       35  350WFXMD                 CAC001
     I                                       36  36 WMBSI                 CAC001
     I                                       37  37 WMSIG                 CAC001
     I                                    P  38  440WMAMT                 CAC001
     I                                       45  45 WFRCI                 CAC001
     I/COPY QWINDSRC,FT0040DTA                                            S01241
     I*                                                                   S01195
     I/COPY ZSRSRC,ZHOLI                                                  S01195
     I*                                                                   S01117
     I**  Data structure to retrieve multi branch indicator               S01117
     I*                                                                   S01117
     IRUNDAT      DS                                                      S01117
     I/COPY WNCPYSRC,FT0040I014
     I                                       13  13 @MBIN                 S01117
     I*                                                                   S01117
     I**  Data structure to retrieve default branch                       S01117
     I*                                                                   S01117
     IZMUSER      DS                             17                       S01117
     I*                                                                   S01117
     I**  USER / BRANCH DATA AREA                                         S01117
     I*                                                                   S01117
     I                                       11  13 @DFBR                 S01117
     I                                       14  16 DPPT                  S01414
      *                                                                   031876
      *  Send message data structure                                      031876
     I/COPY WNCPYSRC,FT0040I009
      *                                                                   031876
     IDBDTA       DS                                                      031876
     I                                        1  10 @BPGM                 031876
     I                                       11  20 @BFILE                031876
     I                                       21  50 @BKEY                 031876
     I                                       51  550@BERNB                031876
     I                                       56 135 @BNARR                031876
     I                                      136 145 @BSTK                 031876
     I                                      146 175 @BPREF                045014
      *                                                                   031876
      *  Calling parameter data structure for AOSPOSU0                    031876
      *                                                                   031876
     IC#DTA       DS                            256                       031876
     I                                        1   1 C#ATYP                031876
     I**********                              2  19 C#ACCT                             031876 CGL029
     I                                        2  19 QQACCT                                    CGL029
     I**********                              2   70C#CNU1                             031876 CSD027
     I                                        2   7 C#CNU1                                    CSD027
     I                                        8  10 C#CCY1                031876
     I**********                             11  140C#ACO1                             031876 CGL029
     I                                       11  140QQACO1                                    CGL029
     I                                       15  160C#ACS1                031876
     I                                       17  19 C#BRC1                031876
     I                                        2   30C#NOSN                031876
     I                                        2   6 C#NOS                 031876
     I                                        2  110C#ACNO                031876
     I**********                              2   70C#CNUM                             031876 CSD027
     I                                        2   7 C#CNUM                                    CSD027
     I**********                              8  110C#ACOD                             031876 CGL029
     I                                        8  110QQACOD                                    CGL029
     I                                       12  130C#ACSQ                031876
     I                                       14  16 C#BRCA                031876
     I                                       24  24 C#IO                  031876
     I                                       25  27 C#CCY                 031876
     I                                       28  29 C#TRYP                031876
     I                                       30  59 C#NARR                031876
     I                                       60  670C#CHQN                031876
     I                                       68  82 C#PREF                031876
     I                                       83  88 C#TRN                 031876
     I                                    P  89  960C#AMT                 031876
     I                                       97  97 C#PRON                031876
     I                                       98  98 C#OLPS                031876
     I                                       99  99 C#MEMS                031876
     I                                      100 100 C#RSAC                031876
     I                                      101 102 C#MOD                 031876
     I                                      103 104 C#OLRC                031876
     I                                      105 105 C#FTOV                031876
     I                                    P 106 1080C#VDAT                031876
     I                                    P 109 1110C#PSTD                031876
     I                                      112 112 C#PSTO                031876
     I                                      113 113 C#RPST                068347
     I                                      114 1160C#RPNB                068347
     I                                      117 117 C#RTYP                068347
     I                                      121 1300C#ACO1                                    CGL029
     I                                      131 1400C#ACOD                                    CGL029
     I                                      141 160 C#OTR1                                    CAP204
     I                                      161 161 C#MTYP                                    CAP205
      *                                                                                       CLE134
      ** Exception Reference Id/Number                                                        CLE134
      *                                                                                       CLE134
     I                                      162 164 C#XRFI                                    CLE134
     I                                      165 1740C#XRFN                                    CLE134
      *                                                                                       CGL029
     I            DS                                                                          CGL029
     I                                        1  24 C#ACCT                                    CGL029
     I**********                              1   60W#CNU1                             CGL029 CSD027
     I                                        1   6 W#CNU1                                    CSD027
     I                                        7   9 W#CCY1                                    CGL029
     I                                       10  190W#ACO1                                    CGL029
     I                                       20  210W#ACS1                                    CGL029
     I                                       22  24 W#BRC1                                    CGL029
     I/COPY WNCPYSRC,FT0040I015
      *                                                                   045014
      *  Input parameters data structure from FT0005                      045014
      *                                                                   045014
     IC#CNTL      DS                            256                       045014
     I                                        1   1 C#PDTI                045014
     I                                        2   3 C#CCYI                045014
     I                                        4   4 C#GLUI                045014
     I                                        5   5 C#TPCI                045014
     I*                                                                   S01408
     I/COPY WNCPYSRC,FT0040IIP1                                           S01408
     I*                                                                   S01408
      *                                                                   S01435
     I            DS                                                      S01435
      *  DS to redefine date                                              S01435
      *                                                                   S01435
     I                                        1   6 SWDT                  S01435
     I                                        1   2 SYY                   S01435
     I                                        3   4 SMM                   S01435
     I                                        5   6 SDD                   S01435
      *                                                                   S01435
     I            DS                                                      S01435
     I                                        1  24 DSTDS                                     CGL029
     I                                       25  48 SNCDS                                     CGL029
     I                                       49  72 ORCDS                                     CGL029
     I                                       73  96 ORBDS                                     CGL029
     I**********                              1  18 DSTDS                              S01435 CGL029
     I**********                             19  36 SNCDS                              S01435 CGL029
     I**********                             37  54 ORCDS                              S01435 CGL029
     I**********                             55  72 ORBDS                              S01435 CGL029
     I/COPY WNCPYSRC,FT0040I010
      *                                                                   S01435
     I***IMACNT*     DS                             18                                 S01435 CGL029
     IIMACNT      DS                             24                                           CGL029
      *  Define full account to be passed for FT IMM update               S01435
      *                                                                   S01435
     I**********                              1   60IMCNUM                             S01435 CSD027
     I                                        1   6 IMCNUM                                    CSD027
     I                                        7   9 IMCCY                 S01435
     I**********                             10  130IMACOD                             S01435 CGL029
     I**********                             14  150IMACSQ                             S01435 CGL029
     I**********                             16  18 IMBRCA                             S01435 CGL029
     I                                       10  190IMACOD                                    CGL029
     I                                       20  210IMACSQ                                    CGL029
     I                                       22  24 IMBRCA                                    CGL029
      *                                                                   S01435
     I/COPY MECPYSRC,SME1100P                                             S01435
     I/COPY WNCPYSRC,FT0040I008
     E/COPY FTCPYSRC,SFTVALCS                                             068230
      /EJECT                                                              S01435
     IW8FT        DS                            128                       S01435
      *                                                                   S01435
      * Address data structure                                            S01435
      *                                                                   S01435
      * Currency                                                          S01435
     I                                        1   3 W8CCY                 S01435
      * Settlement Type                                                   S01435
     I                                        4   5 W8STMT                S01435
      * Mandatory Text - convert BIC identifiers                          S01435
     I                                        6   6 W8MTXT                S01435
      * Message Tag                                                       S01435
     I                                        7  11 W8MTAG                S01435
      * Construct of data in field                                        S01435
     I                                       12  12 W8TYPE                S01435
      * Number of Lines available                                         S01435
     I                                       13  140W8NLIN                S01435
      * Network and Message Type                                          S01435
     I                                       15  20 W8NWRK                S01435
     I                                       21  23 W8MTPY                S01435
      * Calling Program                                                   S01435
     I                                       24  33 W8CPGM                S01435
      * Action *PRINT/*ENQ/*MSG GEN                                       S01435
     I                                       34  41 W8ACT                 S01435
      * Critical reporting - Database error if 'Y'                        S01435
      * If no BIC directory and BIC entered no error                      S01435
     I                                       42  42 W8CRIT                S01435
      * Force Midas Address - where possible                              S01435
     I                                       43  43 W8MADD                S01435
      * If Retail get first address from account                          S01435
     I                                       44  44 W8RTAD                S01435
      * Alternative Address                                               S01435
     I                                       45  45 W8ALTN                S01435
      * Address type selected in W0MSG                                    S01435
     I                                       46  46 W8ADTP                S01435
      *                                                                   S01435
     IMSGREF      DS                                                      S01435
      *                                                                   S01435
      *  DS to split msg ref when FT0050 called from enquiry function     S01435
      *                                                                   S01435
     I                                        1   80REFMSG                S01435
     I                                        9  110REFPRT                S01435
     IDSMTR       DS                                                      S01494
      *                                                                   S01494
      *  Define fields for message transalation                           S01494
      *                                                                   S01494
     I                                        1 132 #MSDTA                S01494
     I                                       15  30 #MPREF                S01494
     I                                    P   1   20#MPART                S01494
     I                                      133 264 #MSTX1                S01494
     I#MSTX2      DS                                                      S01494
     I                                        1 256 #MSTXA                S01494
     I                                      257 512 #MSTXB                S01494
     IVATDS       DS                                                      S01499
     I** Calling parameter to AOVATR0                                     S01499
     I                                        1   3 I#BRCA                S01499
     I                                        4   9 I#CUST                S01499
     I                                    P  10  124O#VATR                S01499
     I*                                                                   S01506
     IW0DTA       DS                            256                       S01506
     I*                                                                   S01506
     I** Calling parameter data structure for FT0035                      S01506
     I*                                                                   S01506
     I                                        1   1 I#PT1                 S01506
     I                                        2  36 I#PTY1                S01506
     I                                       37  37 I#PT2                 S01506
     I                                       38  72 I#PTY2                S01506
     I                                       73  75 I#CCY                 S01506
     I                                       76  81 O#CUST                S01506
     I/COPY WNCPYSRC,FT0040I012
     IW3DATA      DS                             14                       CAC001
     I/COPY WNCPYSRC,FT0040I013
      * I : MAP Margin Info Processing                                    CAC001
     I                                    P   1   42W3FXMP                CAC001
     I                                        5   50W3FXMD                CAC001
     I                                        6   6 W3MBSI                CAC001
     I                                        7   7 W3MSIG                CAC001
     I                                    P   8  140W3MAMT                CAC001
     I/COPY WNCPYSRC,FT0040I004
     I*                                                                   S01508
     IW7DATA      DS                            310                       S01508
     I/COPY WNCPYSRC,FT0040I005
     I*                                                                   S01508
     I* Payment type and subtype                                          S01508
     I*                                                                   S01508
     I                                        1   2 W7PYTP                S01508
     I                                        3   4 W7PYST                S01508
      *                                                                   S01508
      * Input currency and charge currency                                S01508
     I                                        5   7 W7ICCY                S01508
     I                                        8  10 W7CCCY                S01508
      *                                                                   S01508
      * Settlement method                                                 S01508
     I                                       11  12 W7STMT                S01508
      *                                                                   S01508
      * Defaults required                                                 S01508
     I                                       13  13 W7DFRQ                S01508
      *                                                                   S01508
      * Charges branch                                                    S01508
     I                                       14  16 W7BRCA                S01508
      *                                                                   S01508
      * Charge currency amount                                            S01508
     I                                       17  290W7CAMT                S01508
      *                                                                   S01508
      * Transfer Commission type                                          S01508
     I                                       30  30 W7TRCT                S01508
      *                                                                   S01508
      * SWIFT priority code                                               S01508
     I                                       31  31 W7SWPC                S01508
      *                                                                   S01508
      * Transfer Commission amount                                        S01508
     I                                       32  420W7TRCD                S01508
     I                                       43  530W7TRCH                S01508
      *                                                                   S01508
      * Telex charge                                                      S01508
     I                                       54  640W7TXCD                S01508
     I                                       65  750W7TXCH                S01508
      *                                                                   S01508
      * Cheque Charge                                                     S01508
     I                                       76  860W7CQCD                S01508
     I                                       87  970W7CQCH                S01508
      *                                                                   S01508
      * Costs Abroad                                                      S01508
     I                                       98 1080W7CSTD                S01508
     I                                      109 1190W7CSTA                S01508
      *                                                                   S01508
      * SWIFT Priority Charge                                             S01508
     I                                      120 1300W7SPCD                S01508
     I                                      131 1410W7SPCH                S01508
      *                                                                   S01508
      * Miscellaneous charge                                              S01508
     I                                      142 1520W7MSCD                S01508
     I                                      153 1630W7MSCH                S01508
      *                                                                   S01508
      * Advice Charge                                                     S01508
     I                                      164 1740W7ADCD                S01508
     I                                      175 1850W7ADCH                S01508
      *                                                                   S01508
      * Telephone Charge                                                  S01508
     I                                      186 1960W7TLCD                S01508
     I                                      197 2070W7TLCH                S01508
      *                                                                   S01508
      * Collection Charge                                                 S01508
     I                                      208 2180W7COLD                S01508
     I                                      219 2290W7COLL                S01508
      *                                                                   S01508
      * Payment amount currency                                           S01508
     I                                      230 232 W7PCCY                S01508
     I*                                                                   S01508
     I** Other currency                                                   S01508
     I                                      233 235 W7OCCY                S01508
     I*                                                                   S01508
     I** FX/Change commission (input ccy)                                 S01508
     I                                      236 2460W7CHCD                S01508
     I*                                                                   S01508
     I** FX/Change commission (charge ccy)                                S01508
     I                                      247 2570W7CHCM                S01508
     I*                                                                   S01508
     I** Our deductions (input ccy)                                       S01508
     I                                      258 2680W7DEDD                S01508
     I*                                                                   S01508
     I** Our deductions (charge ccy)                                      S01508
     I                                      269 2790W7DEDS                S01508
     I*                                                                   S01508
     I** Correspondent charge (input ccy)                                 S01508
     I                                      280 2900W7COCD                S01508
     I*                                                                   S01508
     I** Correspondent charge (charge ccy)                                S01508
     I                                      291 3010W7COCH                S01508
     I*                                                                   S01508
     I** Default type (HDR or DET or " ")                                 S01508
     I                                      302 304 W7DFTT                S01508
     I*                                                                   S01508
     I** Customer to be debited the charge                                S01508
     I                                      305 310 W7CUST                S01508
      *                                                                   S01435
      *                                                                   S01408
     I/COPY WNCPYSRC,FT0040IIPG                                           S01408
      *                                                                   S01408
     I***CSHDTA*     DS                            512                                 CRT002 CGL029
     ICSHDTA      DS                            522                                           CGL029
      **  Define CASH data area                                           CRT002
      *                                                                   CRT002
     I**********                             21  240DACACD                             CRT002 CGL029
     I                                      513 5220DACACD                                    CGL029
      *                                                                   CRT002
     ISWDT2       DS                              6                       CRT002
      **  Data structure for date change                                  CRT002
      *                                                                   CRT002
     I                                        1   2 DDS                   CRT002
     I                                        3   4 MM                    CRT002
     I                                        5   6 YY                    CRT002
     I            DS                                                      176510
     I**********                              1   60ORDRET                             176510 CSD027
     I                                        1   6 ORDRET                                    CSD027
     I                                        1   6 RETNXX                176510
     I            DS                                                      176510
     I**********                              1   60ORBNUM                             176510 CSD027
     I                                        1   6 ORBNUM                                    CSD027
     I                                        1   6 ORBCHR                176510
      *                                                                   CGL009
      ** Data Structure to hold NOSTRO number                             CGL009
      *                                                                   CGL009
     IDSNOST      DS                                                      CGL009
     I                                        1   3 WNOCCY                CGL009
     I                                        4   5 WNONUM                CGL009
      *                                                                   CGL009
      ** Data Structure to hold partial account number                    CGL009
      *                                                                   CGL009
     IDSPTAC      DS                                                      CGL009
     I                                        1   6 WPTCST                CGL009
     I**********                              7  10 WPTACD                             CGL009 CGL029
     I**********                             11  12 WPTSQN                             CGL009 CGL029
     I**********                             13  15 WPTBCH                             CGL009 CGL029
     I                                        7  16 WPTACD                                    CGL029
     I                                       17  18 WPTSQN                                    CGL029
     I                                       19  21 WPTBCH                                    CGL029
      *                                                                   CGL009
     II35         DS                                                      CGL009
     I                                        1  35 @I35                  CGL009
     IO35         DS                                                      CGL009
     I                                        1  35 @O35                  CGL009
     IR1          DS                                                      CGL009
     I                                        1  13 @R1                   CGL009
      ** Lines of first line of tag                                       CFT014
     ILFLTDS      DS                                                      CFT014
     I                                        1 295 LFLT                  CFT014
     I                                        1  24 BG1                   CFT014
     I                                       25  59 TV1                   CFT014
     I                                       60  83 BG2                   CFT014
     I                                       84 118 TV2                   CFT014
     I                                      119 142 BG3                   CFT014
     I                                      143 177 TV3                   CFT014
     I                                      178 201 BG4                   CFT014
     I                                      202 236 TV4                   CFT014
     I                                      237 260 BG5                   CFT014
     I                                      261 295 TV5                   CFT014
      ** Sender's charges amounts                                         CFT014
     IDSSCHD      DS                                                      CFT014
     I                                        1  550CGA                   CFT014
     I                                        1  110MGSCH1                CFT014
     I                                       12  220MGSCH2                CFT014
     I                                       23  330MGSCH3                CFT014
     I                                       34  440MGSCH4                CFT014
     I                                       45  550MGSCH5                CFT014
      * Sender's charges currencies                                       CFT014
     IDSSCCD      DS                                                      CFT014
     I                                        1  15 CGC                   CFT014
     I                                        1   3 MGSCC1                CFT014
     I                                        4   6 MGSCC2                CFT014
     I                                        7   9 MGSCC3                CFT014
     I                                       10  12 MGSCC4                CFT014
     I                                       13  15 MGSCC5                CFT014
      *                                                                   CGL009
     I              '0123456789.'         C         @CHK                  CGL009
     I              '123456789'           C         @NUL                  CGL009
     I*                                                                   S01194
     I**DATA STRUCTURES USED BY ACCESS PROGRAMS                           S01194
     I*                                                                   S01194
     IDSFDY     E DSDSFDY                                                 S01194
     IDSSDY     E DSDSSDY                                                 S01194
     I*                                                                   S01194
     ISCSARD    E DSSCSARDPD                                              S01506
     ISDRETL    E DSSDRETLPD                                              S01194
     ISDCURR    E DSSDCURRPD                                              S01194
     ISDTRAD    E DSSDTRADPD                                              S01194
     I              QQACCD                          QQACC1                                    CGL029
     ISDBANK    E DSSDBANKPD                                              S01194
     ISDGELR    E DSSDGELRPD                                              S01194
     I              QQACCD                          QQACC2                                    CGL029
     ISDFTFR    E DSSDFTFRPD                                              S01194
     I                                       44  484RATDIS                S01194
     ISDNOST    E DSSDNOSTPD                                              S01194
     I              QQACCD                          QQACC3                                    CGL029
     I**                                Nostro location code              S01195
     I                                       29  31 NLOC                  S01195
     ISDCUST    E DSSDCUSTPD                                              S01194
     ISDCNST    E DSSDCNSTPD                                              068230
     IMEBICD    E DSMEBICDPD                                              068230
     ISDDLST    E DSSDDLSTPD                                              S01194
     ISDBRCH    E DSSDBRCHPD                                              S01194
     I              QQDFAC                          QQDFA1                                    CGL029
     ISDBOOK    E DSSDBOOKPD                                              S01414
     ISDPRFC    E DSSDPRFCPD                                              S01414
     ISDFONT    E DSSDFONTPD                                              CGL009
     ISDCTRY    E DSSDCTRYPD                                              CFT014
      ** Country codes file format data structure                         CFT014
     ISDLOCN    E DSSDLOCNPD                                              CFT014
      ** Location codes file format data structure                        CFT014
     IACCINF    E DSACCNTAB                                               CGL009
     I              RECI                            IFRECI                CGL009
     I              CNUM                            IFCNUM                CGL009
     I              CCY                             IFCCY                 CGL009
     I              ACOD                            IFACOD                CGL009
     I              ACSQ                            IFACSQ                CGL009
     I              ZZ006                           IFZZ06                CGL009
     I              BRCA                            IFBRCA                CGL009
     I              ATYP                            IFATYP                CGL009
     I              STYP                            IFSTYP                CGL009
     I              MFFQ                            IFMFFQ                CGL009
     I              ACST                            IFACST                CGL009
     I              DACO                            IFDACO                CGL009
     I              DACC                            IFDACC                CGL009
     I              ANAM                            IFANAM                CGL009
     I              LDBL                            IFLDBL                CGL009
     I              CLBL                            IFCLBL                CGL009
     I              STFQ                            IFSTFQ                CGL009
     I              STDY                            IFSTDY                CGL009
     I              LSTD                            IFLSTD                CGL009
     I              NSTD                            IFNSTD                CGL009
     I              LSTP                            IFLSTP                CGL009
     I              CFSB                            IFCFSB                CGL009
     I              LMVD                            IFLMVD                CGL009
     I              EPLB                            IFEPLB                CGL009
     I              EPCB                            IFEPCB                CGL009
     I              YTDB                            IFYTDB                CGL009
     I              GLBT                            IFGLBT                CGL009
     I              ADREF1                          IFARF1                CGL009
     I              PRFC                            IFPRFC                CGL009
     I              ZZ004                           IFZZ04                CGL009
     I              ORED                            IFORED                CGL009
     I              DLIM                            IFDLIM                CGL009
     I              LRCR                            IFLRCR                CGL009
     I              RTCB                            IFRTCB                CGL009
     I              RTLB                            IFRTLB                CGL009
     I              DITM                            IFDITM                CGL009
     I              CITM                            IFCITM                CGL009
     I              ADREF2                          IFREF2                CGL009
     I              ZZ002                           IFZZ02                CGL009
     I              CDIR                            IFCDIR                CGL009
     I              CCIR                            IFCCIR                CGL009
     I              ACNO                            IFACNO                CGL009
     I              RETB                            IFRETB                CGL009
     I              ODSC                            IFODSC                CGL009
     I              ODLN                            IFODLN                CGL009
     I              ODED                            IFODED                CGL009
     I              DIOD                            IFDIOD                CGL009
     I              FACT                            IFFACT                CGL009
     I              FCNO                            IFFCNO                CGL009
     I              EFAC                            IFEFAC                CGL009
     I              HELD                            IFHELD                CGL009
     I              MINB                            IFMINB                CGL009
     I              LACD                            IFLACD                CGL009
     I              LISP                            IFLISP                CGL009
     I              RRNM                            IFRRNM                CGL009
     I              DRIB                            IFDRIB                CGL009
     I              DRIS                            IFDRIS                CGL009
     I              DRCD                            IFDRCD                CGL009
     I              DRIC                            IFDRIC                CGL009
     I              DRIF                            IFDRIF                CGL009
     I              DRDY                            IFDRDY                CGL009
     I              NDID                            IFNDID                CGL009
     I              LDID                            IFLDID                CGL009
     I              LDIA                            IFLDIA                CGL009
     I              SDAP                            IFSDAP                CGL009
     I              LPAR                            IFLPAR                CGL009
     I              DIIE                            IFDIIE                CGL009
     I              DAIC                            IFDAIC                CGL009
     I              MADI                            IFMADI                CGL009
     I              GADI                            IFGADI                CGL009
     I              DDIS                            IFDDIS                CGL009
     I              DDIA                            IFDDIA                CGL009
     I              OLDR                            IFOLDR                CGL009
     I              OLDB                            IFOLDB                CGL009
     I              OLDS                            IFOLDS                CGL009
     I              CRIB                            IFCRIB                CGL009
     I              CRIS                            IFCRIS                CGL009
     I              CRCD                            IFCRCD                CGL009
     I              CRIC                            IFCRIC                CGL009
     I              CRIF                            IFCRIF                CGL009
     I              CRDY                            IFCRDY                CGL009
     I              NCID                            IFNCID                CGL009
     I              LCID                            IFLCID                CGL009
     I              LCIA                            IFLCIA                CGL009
     I              SCAP                            IFSCAP                CGL009
     I              LPAP                            IFLPAP                CGL009
     I              CIIE                            IFCIIE                CGL009
     I              CAIC                            IFCAIC                CGL009
     I              MACI                            IFMACI                CGL009
     I              GACI                            IFGACI                CGL009
     I              CDIS                            IFCDIS                CGL009
     I              DCIA                            IFDCIA                CGL009
     I              OLCR                            IFOLCR                CGL009
     I              OLCB                            IFOLCB                CGL009
     I              OLCS                            IFOLCS                CGL009
     I              LCD                             IFLCD                 CGL009
     I              CHTP                            IFCHTP                CGL009
     I              TNLU                            IFTNLU                CGL009
     I              BRTCA                           IFBRTA                CGL009
     I              NACSG                           IFNACG                CGL009
     I              R4ACNT                          IFR4AC                CGL009
     I              ENOC                            IFENOC                CGL009
     I              EPNO                            IFEPNO                CGL009
     I              ECFB                            IFECFB                CGL009
     I              LTAB                            IFLTAB                CGL009
     I              LTAC                            IFLTAC                CGL009
     I              LTAS                            IFLTAS                CGL009
     I              HCFB                            IFHCFB                CGL009
     I              PTFR                            IFPTFR                CGL009
     I              HLEX                            IFHLEX                CGL009
     I              A5TIAC                          IFA5TA                CGL009
     I              A5TIAN                          IFA5TN                CGL009
     I              A5TIAS                          IFA5TS                CGL009
     I              EUSB                            IFEUSB                CGL009
     I/COPY WNCPYSRC,FT0040I001
      *                                                                   CFT007
     IINFDS#    E DSY2I#DSP                                               CFT007
      * Display file information data structure                           CFT007
      *                                                                   CFT007
     I@OADD       DS                            175                       CFT007
      * Output Data Structure for BIC reformatted address                 CFT007
     I                                        1  35 OADD1                 CFT007
     I                                       36  70 OADD2                 CFT007
     I                                       71 105 OADD3                 CFT007
     I                                      106 140 OADD4                 CFT007
     I                                      141 175 OADD5                 CFT007
      *                                                                   CFT009
      *  Transaction details file parameter for FT000980                  CFT009
      *                                                                   CFT009
     ITRNDET      DS                           3000                       CFT009
      *                                                                   CFT009
      *  Transaction details extension file parameter for FT000980        CFT009
      *                                                                   CFT009
     ITRNEXT      DS                           3000                       CFT009
      *                                                                   CFT009
      *  Outgoing Payments Details data structure                         CFT009
      *                                                                   CFT009
     IOTPYDS    E DSOTPAYDD                                               CFT009
     I              RECI                            OTRECI                CFT009
     I              PREF                            OTPREF                CFT009
     I              PYTP                            OTPYTP                CFT009
     I              STMT                            OTSTMT                CFT009
     I              LCD                             OTLCD                 CFT009
     I              BRCA                            OTBRCA                CFT009
     I              FRNT                            OTFRNT                CFT009
     I              REPA                            OTREPA                CFT009
     I              ADDC                            OTADDC                CFT009
     I              RPAY                            OTRPAY                CFT009
     I              OPVAT1                          OTVAT1                CFT009
     I              OPVAT2                          OTVAT2                CFT009
     I              OPVAT3                          OTVAT3                CFT009
     I              OPVAT4                          OTVAT4                CFT009
     I              OPVAT5                          OTVAT5                CFT009
     I              OPVAT6                          OTVAT6                CFT009
     I              OPVAT7                          OTVAT7                CFT009
     I              OPVATR                          OTVATR                CFT009
     I              OPVATT                          OTVATT                CFT009
     I              TRCM                            OTTRCM                CFT009
     I              TRCMD                           OTRCMD                CFT009
     I              TXCH                            OTTXCH                CFT009
     I              TXCHD                           OTXCHD                CFT009
     I              CQCH                            OTCQCH                CFT009
     I              CQCHD                           OCQCHD                CFT009
     I              CSTA                            OTCSTA                CFT009
     I              CSTAD                           OCSTAD                CFT009
     I              SPCH                            OTSPCH                CFT009
     I              SPCHD                           OSPCHD                CFT009
     I              MSCH                            OTMSCH                CFT009
     I              MSCHD                           OMSCHD                CFT009
     I              OPCHCM                          OTCHCM                CFT009
     I              DUMA1                           ODUMA1                CFT009
     I              DUMA2                           ODUMA2                CFT009
     I              DUMA3                           ODUMA3                CFT009
     I              DUMA4                           ODUMA4                CFT009
     I              DUMA5                           ODUMA5                CFT009
     I              DUMA6                           ODUMA6                CFT009
     I              OPDUM7                          OTDUM7                CFT009
     I              OPDUM8                          OTDUM8                CFT009
     I              TMST                            OTTMST                                    CPK014
      *                                                                   CFT009
      *  Outgoing Payments Details Extension data structure               CFT009
      *                                                                   CFT009
     IOTPXDS    E DSOTPAYXPD                                              CFT009
     I              TLXCDE                          OTLXCD                CFT009
     I              CHQCHC                          OCHQCH                CFT009
     I              CACHCD                          OCACHC                CFT009
     I              SSTCCD                          OSSTCC                CFT009
     I              SPRCCD                          OSPRCC                CFT009
     I              MSCHC                           OMSCHC                CFT009
     I              MSCHC1                          OMSCH1                CFT009
     I              MSCHC2                          OMSCH2                CFT009
     I              MSCHC3                          OMSCH3                CFT009
     I              MSCHC4                          OMSCH4                CFT009
     I              MSCHC5                          OMSCH5                CFT009
     I              TFCCCD                          OTFCCD                CFT009
     I              FXCACC                          OFXCAC                CFT009
     I              VTSWSC                          OVTSWS                CFT009
     I              VMIC1                           OVMIC1                CFT009
     I              VMIC2                           OVMIC2                CFT009
     I              VMIC3                           OVMIC3                CFT009
     I              VMIC4                           OVMIC4                CFT009
     I              VMIC5                           OVMIC5                CFT009
     I              MISC01                          OMISC1                CFT009
     I              MISC02                          OMISC2                CFT009
     I              MISC03                          OMISC3                CFT009
     I              MISC04                          OMISC4                CFT009
     I              MISC05                          OMISC5                CFT009
     I              SWSCHG                          OSWSCH                CFT009
     I              DATNED                          ODATNE                CFT009
     I              DATNAO                          ODATNA                CFT009
     I              CUNFLA                          OCUNFL                CFT009
     I              OPCHRT                          OTCHRT                CFT009
     I              OPCHGC                          OTCHGC                CFT009
     I              MISCC1                          CMISC1                CFT009
     I              MISCC2                          CMISC2                CFT009
     I              MISCC3                          CMISC3                CFT009
     I              MISCC4                          CMISC4                CFT009
     I              MISCC5                          CMISC5                CFT009
     I              SWSCCC                          CSWSCH                CFT009
     I*                                                                   S01194
      *                                                                                       CRE008
      ** DS for message data for overdraft limit check                                        CRE008
      *                                                                                       CRE008
     IWOLTXT      DS                                                                          CRE008
     I**********                              1  22 WMDTA1                             CRE008 CGL029
     I**********                              1  33 WMDTA2                             CRE008 CGL029
     I                                        1  28 WMDTA1                                    CRE008
     I                                        1  39 WMDTA2                                    CRE008
     I                                        1   3 WBRCDE                                    CRE008
     I                                        4   4 WDASH1                                    CRE008
     I                                        5  10 WCUSTN                                    CRE008
     I                                       11  11 WDASH2                                    CRE008
     I                                       12  14 WCURR                                     CRE008
     I                                       15  15 WDASH3                                    CRE008
     I**********                             16  19 WACOD                              CRE008 CGL029
     I**********                             20  20 WDASH4                             CRE008 CGL029
     I**********                             21  22 WACSQ                              CRE008 CGL029
     I**********                             23  23 WSLSH                              CRE008 CGL029
     I**********                             24  33 WRETN                              CRE008 CGL029
     I                                       16  25 WACOD                                     CGL029
     I                                       26  26 WDASH4                                    CGL029
     I                                       27  28 WACSQ                                     CGL029
     I                                       29  29 WSLSH                                     CGL029
     I                                       30  39 WRETN                                     CGL029
      *                                                                                       CRE008
      **                                                                                      CSC022
     ISCCMT       DS                            256                                           CSC022
     I                                        1   30WCMTNO                                    CSC022
     I                                        4 103 WCJOBS                                    CSC022
      ** Commitment Control dataarea                                                          CSC022
      **                                                                                      CSC022
     C                     MOVEACPY@      BIS@   80
     C/EJECT
     C************************************************************
     C* MAIN SECTION
     C************************************************************
     C           *ENTRY    PLIST
     C/COPY WNCPYSRC,FT0040C263
     C                     PARM           @SORT   1
     C           SPREF     PARM           XPREF
     C                     PARM           @RTCD   1
     C/COPY WNCPYSRC,FT0040C040
     C           *LIKE     DEFN PREF      XPREF
     C/COPY WNCPYSRC,FT0040C097
      *
      ** If reference passed...
      *
     C           XPREF     IFNE *BLANKS
      **                 ... amendment assumed.
     C                     MOVE @SORT     ACTION
      **                 ... linkage to FT0045 enforced.
     C                     MOVE 'Y'       WLINK
     C                     END
     C/COPY WNCPYSRC,FT0040C245
     C*                                                                   096486
     C**  If program is called by GL4442, then initialise fields.         096486
     C*                                                                   096486
     C                     MOVE *BLANK    @GL442  1                       096486
     C           @RTCD     IFEQ 'G'                                       096486
     C                     MOVE 'Y'       @GL442                          096486
     C                     MOVE *BLANK    @RTCD                           096486
     C                     END                                            096486
      *
     C*
     C* PERFORM INITIAL SECTION TO GET ICD RECORDS
     C*
     C                     EXSR INITL
     C                     Z-ADD1         Z                SUBSCRIPT
     C*                                                                   081663
     C** Initialise no update indicator, re-display, warning array        081663
     C** and warning message sent                                         081663
     C*                                                                   081663
     C                     MOVEL*BLANKS   FTNOUP  1                       081663
     C                     MOVEL*BLANKS   FTRSND  1                       081663
     C                     MOVEL*BLANKS   FTWARN  1                       081663
     C                     MOVEL*BLANKS   WRN@                            081663
      *
      * DO UNTIL F3 HAS BEEN PRESSED
      ** Or Function 3 returned from FT0045.
      ** Or F7 PRESSED ON FIRST SCREEN                                    E29970
      ** Or Function 12 ret'nd from FT0045 and *ENTRY parameter passed .
      ** Or F12 pressed and *ENTRY parameter passed.
      ** Or no Function returned from FT0045 but *ENTRY parameter
      **                     of PREF passed .
      *
     C           *IN01     DOUEQ'1'                        B001
      *
     C           *IN07     OREQ '1'                                       E29970
      *
     C           *IN05     OREQ '1'
     C           XPREF     ANDNE*BLANKS
      *
     C           PCMD      OREQ '5'
     C           XPREF     ANDNE*BLANKS
      *
     C           PCMD      OREQ '1'
      *
     C           PCMD      OREQ *BLANK
     C           XPREF     ANDNE*BLANKS
     C           *IN89     ANDEQ'0'                                       S01435
     C           *IN87     ANDEQ'0'                                       133420
     C/COPY WNCPYSRC,FT0040C121
      *
      ** Bypass initial screen if requested
      ** ....from FTC0045 or PREF passed non-blank from FTC0040
      ** ....& no errors.. (only do once).
      *
     C           PCMD      IFNE *BLANK
     C           PCMD      ANDNE'5'
     C           *IN89     ANDEQ'0'
     C           *IN87     ANDEQ'0'                                       133420
      *
     C           XPREF     ORNE *BLANKS
     C           *IN89     ANDEQ'0'
     C           *IN87     ANDEQ'0'                                       133420
     C/COPY WNCPYSRC,FT0040C041
     C                     MOVE *BLANK    PCMD
      *
     C                     ELSE
      *
     C*  If no errors, clear fields, error codes,FQRY not used etc        S01194
      *
     C**N89****************DO                                             S01194
     C  N89N62             DO                                             S01194
     C                     MOVEA*BLANK    ERCD             ERROR CODES
     C                     MOVE *BLANK    SPREF            PAY REF
     C                     MOVE *BLANK    ACTION           ACTION
     C                     MOVE *BLANK    SBRCA                           S01117
     C                     Z-ADD1         Z                SUBSCRIPT
     C                     SETOF                     202189INDICATORS
     C                     SETOF                     56                   S01117
     C/COPY WNCPYSRC,FT0040C011
     C                     END                             E002
      *                                                                   042167
      * Call CL program to deallocate dataarea ONLY prior to processing   042167
      * the initial screen and if not called from an enquiry function     042167
      *                                                                   042167
     C           XPREF     IFEQ *BLANK                                    042167
     C                     EXSR DALLOC                                    042167
     C                     END                                            042167
      *                                                                   S01435
      * Display message subfile                                           S01435
      *                                                                   S01435
     C                     MOVEL'1'       *IN79                           S01435
     C/COPY WNCPYSRC,FT0040C246
     C                     WRITE#MSGCTL                                   S01435
     C/COPY WNCPYSRC,FT0040C042
      *
     C                     WRITEFT0040F1                   SCREEN 1
      *
     C* LOOP FOR HELP REDISPLAY
     C/COPY WNCPYSRC,FT0040C005
     C**         *IN11     DOUEQ'0'                        B002           S01199
     C                     READ FT0040F1                 88SCREEN 1
     C/COPY WNCPYSRC,FT0040C247
     C                     SETOF                     46                   079911
     C/COPY WNCPYSRC,FT0040C248
      *                                                                   CFT009
     C           SPREF     IFNE PREF                                      CFT009
     C                     MOVE 'N'       FLAG12                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      *                                                                   S01435
      * Clear message subfile                                             S01435
      *                                                                   S01435
     C                     CALL 'Y2CLMSC'                                 S01435
     C                     PARM ##PGM     FTPGMQ 10                       S01435
     C                     PARM '*SAME'   FTPGRL  5                       S01435
     C/COPY WNCPYSRC,FT0040C249
      *                                                                   S01435
      * Reset message sent flag                                           S01435
      *                                                                   S01435
     C                     MOVEL'N'       FTMSGS  1                       S01435
      *                                                                   CAC001
     C/COPY WNCPYSRC,FT0040C043
      ** Initialise first pass indicator to 'Y'                           CAC001
      *                                                                   CAC001
     C                     MOVEL'Y'       FIRST   1                       CAC001
      *                                                                   CAC001
      ** If Analytical Accounting is installed, initialise margin         CAC001
      ** info work fields.                                                CAC001
      *                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C                     Z-ADD*ZEROS    W3FXMP                          CAC001
     C                     Z-ADD*ZEROS    W3FXMD                          CAC001
     C                     MOVE *BLANKS   W3MBSI                          CAC001
     C                     MOVE *BLANKS   W3MSIG                          CAC001
     C                     Z-ADD*ZEROS    W3MAMT                          CAC001
     C                     ENDIF                                          CAC001
      *                                                                   S01435
      *
     C***11****************EXSR HELP                       HELP           S01199
     C*********************END                             E002           S01199
      *
     C                     END
     C/COPY WNCPYSRC,FT0040C264
      *
     C* IF NOT F3 OR F12 VALIDATE
     C  N01N05             DO                              B002
     C**************************************                              S01194
     C*   RESOLVE ?'S BEFORE VALIDATION    *                              S01194
     C**************************************                              S01194
     C                     EXSR FQRY1                                     S01194
     C*                                                                   S01194
     C                     EXSR VALONE                     VALIDATE
     C/COPY WNCPYSRC,FT0040C250
     C* If no errors and no selection made form FQRY                      S01194
     C**N89****************EXSR STORE                      STORE ORIGS    S01117
     C**N89****************EXSR SCRN2                      SCREEN 2       S01117
     C  N89N62             EXSR STORE                      STORE ORIGS    S01117
      *                                                                   S01435
      * If action code 'I' and FT0040 called from enquiry function, and   S01435
      * no errors, set up the detail screen fields from swift message     S01435
      *                                                                   S01435
     C           *IN89     IFEQ '0'                                       S01435
     C           *IN62     ANDEQ'0'                                       S01435
     C           ACTION    IFEQ 'I'                                       S01435
     C           XPREF     ANDNE*BLANKS                                   S01435
     C/COPY WNCPYSRC,FT0040C295
     C                     EXSR EISWFT                                    S01435
     C/COPY WNCPYSRC,FT0040C296
     C                     END                                            S01435
     C                     END                                            S01435
      *                                                                   S01414
      *  Determine attributes for the Profit Centre field                 S01414
      *                                                                   S01414
     C  N89N62             EXSR SRPRFA                                    S01414
     C  N89N62             EXSR SCRN2                      SCREEN 2       S01117
     C*
     C** BLANK ERROR CODES IF F12 AND ERRORS ON VALIDATION
     C*
     C/COPY WNCPYSRC,FT0040C054
     C   05                SETOF                     89
     C                     SETOF                     666772               E32543
     C                     SETOF                     68                   E32543
      *
      ** If No errors or F keys - proceed.
     C           *IN89     IFEQ '0'
     C           *IN87     ANDEQ'0'                                       133420
     C           *IN01     ANDEQ'0'
     C           *IN02     ANDEQ'0'
     C           *IN05     ANDEQ'0'
     C           *IN07     ANDEQ'0'                                       E29970
     C           *IN62     ANDEQ'0'                                       S01194
     C/COPY WNCPYSRC,FT0040C113
      *
      ** If program linked with FT0045 & Action not Delete.
     C           WLINK     IFEQ 'Y'
     C           ACTION    ANDNE'D'
     C           XPREF     ORNE *BLANKS
     C           ACTION    ANDNE'D'
     C/COPY WNCPYSRC,FT0040C058
      *
      ** RESET ACTION TO 'I' IF NO LEVEL 2 DETAILS HAVE BEEN ENTERED
     C***********BNC1      IFEQ *BLANKS                                   S01435
     C           LVL2      IFNE 'Y'                                       S01435
     C           ACTION    ANDNE'E'
     C                     MOVE 'I'       ACTION
     C                     END
     C/COPY WNCPYSRC,FT0040C059
     C*                                                                   096486
     C** Set action code to 'G' to tell in FT0345 that the enquiry is     096486
     C** triggered from Account  Movements menu option (GL4442).          096486
     C*                                                                   096486
     C           @GL442    IFEQ 'Y'                                       096486
     C                     MOVE 'G'       ACTION                          096486
     C                     ENDIF                                          096486
      *
      ** set up parameters for FT0045 replacing initial screen...
     C           ACTION    IFEQ 'I'
     C                     MOVELPREF      SPREF
     C                     END
      *
      *                                                                   S01435
      *  Replace call to FTC0045 to new FT controlling Component          S01435
      *                                                                   S01435
     C************         CALL 'FTC0045'                                 S01435
     C************         PARM           ACTION                          S01435
     C************         PARM           SPREF                           S01435
      ************                                                        S01435
      ***...*and*receive back from FT0045 the last function key.          S01435
     C************         PARM           PCMD    1        Function       S01435
     C************         PARM           WLINK   1        Set to Y.      S01435
     C/COPY WNCPYSRC,FT0040C009
      *                                                                   S01435
     C                     MOVELWLINK     WLINK   1                       S01435
     C                     MOVEL*BLANKS   W3FTCT                          S01435
     C           XPREF     IFNE *BLANKS                                   S01435
     C           @GL442    ANDNE'Y'                                       096486
     C                     MOVEL'Y'       W3FTCT                          S01435
     C                     END                                            S01435
      *                                                                   S01435
     C/COPY WNCPYSRC,FT0040C006
     C                     CALL 'FTC0310'                                 S01435
     C/COPY WNCPYSRC,FT0040C044
     C                     PARM *BLANKS   W3RTN   7                       S01435
     C/COPY WNCPYSRC,FT0040C045
     C                     PARM 'FT0345'  W3PGM  10                       S01435
     C***********          PARM ACTION    W3ACTC  1                S01435 096486
     C           ACTION    PARM ACTION    W3ACTC  1                       096486
     C                     PARM SPREF     W3PREF 15                       S01435
     C                     PARM           W3FTCT 64                       S01435
     C                     PARM           W3DATA                          CAC001
     C                     PARM           FLAG12  1                       CFT009
     C/COPY WNCPYSRC,FT0040C007
      *                                                                   S01435
      *  Set PCMD depending on W3RTN                                      S01435
      *                                                                   S01435
     C                     SELEC                                          S01435
     C           W3RTN     WHEQ 'Y2U9999'                                 S01435
     C                     MOVEL'1'       PCMD    1                       S01435
     C           W3RTN     WHEQ 'USR0790'                                 S01435
     C                     MOVEL'2'       PCMD                            S01435
     C           W3RTN     WHEQ 'FTM2005'                                 S01435
     C                     MOVEL'1'       *IN07                           S01435
     C                     MOVEL'7'       PCMD                            S01435
     C                     OTHER                                          S01435
     C                     MOVEL*BLANKS   PCMD                            S01435
     C                     ENDSL                                          S01435
     C/COPY WNCPYSRC,FT0040C046
      *
     C* IF F12 RETURNED FROM FT0045, AND INSERT ORIGINALLY, CHANGE        S01117
     C* FUNCTION TO AMEND AS FILE WILL HAVE BEEN UPDATED BEFORE           S01117
     C* ACCESS OF FT0045                                                  S01117
      *
     C                     MOVE *BLANKS   F12     1                       CFT009
      *                                                                   CFT009
     C           PCMD      IFEQ '2'
     C           ACTION    ANDEQ'I'
     C                     MOVE 'A'       ACTION
     C                     MOVE 'Y'       F12                             CFT009
     C                     END
     C*                                                                   S01117
     C* IF F12 RETURNED FROM FT0045, BLANK OUT SCREEN BRANCH CODE         S01117
     C* - THIS ENSURES NO ERROR WHEN VALIDATION OF FT0040F1 SCREEN        S01117
     C* VALUES REOCCUR                                                    S01117
     C*                                                                   S01117
     C           PCMD      IFEQ '2'                                       S01117
     C                     MOVE *BLANKS   SBRCA                           S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C/COPY WNCPYSRC,FT0040CP14                                           S01408
     C*                                                                   S01117
     C                     END
     C/COPY WNCPYSRC,FT0040C082
      *
      ** If no function key (from FT0045) or not linked...
     C           PCMD      IFEQ *BLANK
     C           PCMD      OREQ '5'
     C           WLINK     ORNE 'Y'
      *
      ** ...blank fields on screen.
     C                     MOVEL*BLANKS   ACTION
     C                     MOVEL*BLANKS   SPREF
     C                     MOVEL*BLANKS   SORBR                           S01117
     C/COPY WNCPYSRC,FT0040C149
      *
     C* IF UPDATED BY ANOTHER WORKSTATION
     C   02                SETOF                     02
     C                     END
     C/COPY WNCPYSRC,FT0040C083
      *
     C                     END
     C                     END                             E002
     C*
     C** BLANK ERROR CODES IF F12 AND ERRORS ON VALIDATION
     C*
     C   05                SETOF                     89
     C*
     C                     END                             E001
     C   01                MOVE '1'       @RTCD
     C   05                MOVE '5'       @RTCD
     C   07                MOVE '7'       @RTCD                           E29970
     C** IF CMDS 3,7 AND 12 NOT PRESSED ON 1ST SCREEN                     E29970
     C           *IN01     IFNE '1'                                       E29970
     C           *IN05     ANDNE'1'                                       E29970
     C           *IN07     ANDNE'1'                                       E29970
     C                     MOVE PCMD      @RTCD                           E29970
     C                     END                                            E29970
     C**N01N05*************MOVE PCMD      @RTCD                           E29970
     C/COPY WNCPYSRC,FT0040C118
     C                     SETON                     LR
     C/COPY WNCPYSRC,FT0040C134
     C*
     C************************************************************
     C* END OF MAIN SECTION
     C************************************************************
     C************************************************************
     C* KLISTS FOR ACCNT , OLPOS , PRONO AND CLINT
     C************************************************************
     C*
     C           AKEY      KLIST
     C                     KFLD           CNUM
     C                     KFLD           CCY
     C                     KFLD           ACOD
     C                     KFLD           ACSQ
     C                     KFLD           BRCA                            S01117
     C*
     C           @DTSTK    KLIST                                          093958
     C                     KFLD           SPYTP                           093958
     C                     KFLD           SPYST                           093958
      ************                                                        031876
      ************  Remove PRONO OLPOS and MEMOS                          031876
      ************                                                        031876
     C***********OKEY      KLIST                                          031876
     C************         KFLD           BRCA                            S01117
     C************         KFLD           CCY                             031876
     C************         KFLD           RECN                            031876
     C************                                                        031876
     C***********PKEY      KLIST                                          031876
     C************         KFLD           CCY                             031876
     C************         KFLD           NOSN                            031876
     C*
     C************************************************************
     C* END OF KLISTS
     C************************************************************
     C/EJECT
     C************************************************************
     C* INITL SR.
     C* READ ICD RECORDS 1 2 AND 3
     C*
     C           INITL     BEGSR
     C*
     C* SET UP PROGRAM NAME CORRECTLY FOR DATABASE ERROR PROCESSING       078189
     C                     MOVE *BLANKS   DBPGM                           078189
     C                     MOVE 'FT0040  'DBPGM                           078189
     C*                                                                   078189
     C* DATA STRUCTURES THAT ARE EXTERNALLY DESCRIBED
     C           *NAMVAR   DEFN LDA       DLDA
     C           *NAMVAR   DEFN OTPAYDA   OTPAYD
     C           *NAMVAR   DEFN RGPAYDA   RGPAYD
     C           *NAMVAR   DEFN           RUNDAT                          S01117
     C                     IN   RUNDAT                                    S01117
     C           *NAMVAR   DEFN           ZMUSER                          S01117
     C                     IN   ZMUSER                                    S01117
     C/COPY WNCPYSRC,FT0040C031
      *                                                                   CRT002
      **  Get CASH information.                                           CRT002
      *                                                                   CRT002
     C           *NAMVAR   DEFN CASH      CSHDTA                          CRT002
     C                     IN   CSHDTA                                    CRT002
      *                                                                   061236
      * Set up MT202 compare variable                                     061236
      *                                                                   061236
     C                     MOVEL*BLANKS   ORCFLD                          061236
     C                     MOVEL'MT202'   ORCFLD 35                       061236
     C/COPY WNCPYSRC,FT0040C251
      *                                                                   S01435
      * Clear message subfile                                             S01435
      *                                                                   S01435
     C                     CALL 'Y2CLMSC'                                 S01435
     C                     PARM ##PGM     FTPGMQ 10                       S01435
     C                     PARM '*SAME'   FTPGRL  5                       S01435
     C/COPY WNCPYSRC,FT0040C252
      *                                                                   S01435
      * Reset message sent flag                                           S01435
      *                                                                   S01435
     C                     MOVEL'N'       FTMSGS  1                       S01435
      *
      ** Initialize constant.
     C                     MOVE 'P'       P
     C*                                                                   S01117
     C***********1*********CHAINPYCHGDD              99    Get defaults.  S01117
     C************IN99*****IFEQ '1'                                       S01117
     C************LOCK*****IN   DLDA                                      S01117
     C*********************MOVE 'FT0040  'DBPGM                           S01117
     C*********************MOVE 'PYCHG'   DBFILE           ***************S01117
     C*********************Z-ADD44        DBASE            * DB ERROR 44 *S01117
     C*********************MOVEL'1'       DBKEY            ***************S01117
     C*********************OUT  DLDA                                      S01117
     C*********************SETON                     U7U8LR               S01117
     C*********************DUMP                                           S01117
     C*********************RETRN                                          S01117
     C*********************END                                            S01117
     C*********************CLOSEPYCHGDD                                   S01117
      *********************                                               S01117
      ***Convert*rate*%*discrepancy to higher & lower rate margins.       S01117
     C***********1*********ADD  RATDIS    UPMARG  74                      S01117
     C***********1*********SUB  RATDIS    LWMARG  74                      S01117
      *
     C* SETUP STANDARD FIELDS FOR ERRORS AND COMIT
     C                     MOVE 'FT'      MODULE
     C*********************MOVELWID       WID1                            S01117
     C*********************MOVE WID       WID2                            S01117
     C                     MOVELWSID      WID1                            S01117
     C                     MOVE WSID      WID2                            S01117
     C                     MOVE USRID     USRID1
     C                     MOVE 'FT0040'  PROG
     C*                                                                   S01194
     C**READ*INSTALLATION*CONTROL*RECORD*1                                S01194
     C*********************MOVE *BLANK    KEY                             S01194
     C*********************MOVEL'01'      KEY                             S01194
     C*********************MOVE '10'      KEY                             S01194
     C***********KEY*******CHAINTABTB10F             88                   S01194
     C**N88******RECI******COMP 'D'                  8888                 S01194
     C***88****************DO                              B001           S01194
     C************LOCK*****IN   DLDA                                      S01194
     C*********************MOVE 'FT0040  'DBPGM                           S01194
     C*********************MOVE 'TABLE'   DBFILE           ***************S01194
     C*********************Z-ADD1         DBASE            * DB ERROR 01 *S01194
     C*********************MOVELKEY       DBKEY            ***************S01194
     C*********************OUT  DLDA                                      S01194
     C*********************SETON                     U7U8LR               S01194
     C*********************DUMP                                           S01194
     C*********************RETRN                                          S01194
     C*********************END                             E001           S01194
     C*                                                                   S01194
     C** Extract bank details                                             S01194
     C*                                                                   S01194
     C                     CALL 'AOBANKR0'                                S01194
     C                     PARM '*DBERR'  RTCD    7                       S01194
     C                     PARM '*FIRST'  @OPTN   7                       S01194
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
     C*                                                                   S01117
     C** Setup RUNDATE                                                    S01117
     C*                                                                   S01117
     C                     MOVELBJCYCD    BCCY    3                       CFT009
     C                     MOVE BJMRDT    SRUNA                           S01117
     C                     MOVE BJDFIN    WUDFF   1                       CRT002
     C                     TIME           TIME                            S01117
     C*                                                                   S01117
     C** If multi branched set on indicator to display branch field.      S01117
     C** Else move single branch code to BRCA                             S01117
     C*                                                                   S01117
     C           @MBIN     IFEQ 'Y'                                       S01117
     C                     SETON                     57                   S01117
     C                     ELSE                                           S01117
     C                     MOVE BJSBRC    BRCA                            S01117
     C                     END                                            S01117
     C*                                                                   S01194
     C***********DATF******COMP 'M'                      98               S01194
     C           BJDFIN    COMP 'M'                      98               S01194
     C* Convert RUN DATE to DDMMYY format
     C*********************Z-ADDRUND      ZDAYNO                          S01194
     C                     Z-ADDBJRDNB    ZDAYNO                          S01194
     C                     EXSR ZDATE2
     C                     Z-ADDZDATE     RUNN    60
     C                     MOVE RUNN      ZDATE
     C* FORMAT DATE FOR D3
     C           *IN98     IFEQ '0'                        B001
     C                     MOVE ZDD       OYY
     C                     MOVE ZMM       OMM
     C                     MOVE ZYY       ODD
     C                     ELSE                            X001
     C                     MOVE ZDD       OMM
     C                     MOVE ZMM       OYY
     C                     MOVE ZYY       ODD
     C                     END                             E001
     C                     Z-ADDODATE     RUND3
     C*                                                                   S01194
     C**READ*INSTALLATION*CONTROL RECORD TWO.                             S01194
     C*********************MOVE '11'      KEY                             S01194
     C***********KEY*******CHAINTABTB11F             88                   S01194
     C**N88******RECI******COMP 'D'                  8888                 S01194
     C***88****************DO                              B001           S01194
     C************LOCK*****IN   DLDA                                      S01194
     C*********************MOVE 'FT0040  'DBPGM                           S01194
     C*********************MOVE 'TABLE'   DBFILE           ***************S01194
     C*********************Z-ADD2         DBASE            * DB ERROR 02 *S01194
     C*********************MOVELKEY       DBKEY            ***************S01194
     C*********************OUT  DLDA                                      S01194
     C*********************SETON                     U7U8LR               S01194
     C*********************DUMP                                           S01194
     C*********************RETRN                                          S01194
     C*********************END                             E001           S01194
     C*                                                                   S01194
     C** Extract general ledger details from SDGELRPD                     S01194
     C*                                                                   S01194
     C**********           CALL 'AOGELRR0'                                             S01194 CGL029
     C                     CALL 'AOGELRR1'                                                    CGL029
     C                     PARM '*DBERR'  RTCD                            S01194
     C                     PARM '*FIRST'  @OPTN                           S01194
     C********** SDGELR    PARM SDGELR    DSFDY                                        S01194 CGL029
     C           SDGELR    PARM SDGELR    DSSDY                                               CGL029
      *                                                                   S01414
      * If return code is not blank - process for a database error        S01414
      *                                                                   S01414
     C           RTCD      IFNE *BLANKS                                   S01414
     C                     MOVEL'SDGELRPD'W0FILE           *************  S01414
     C                     Z-ADD45        W0ERNB           * DBERR 45  *  S01414
     C                     MOVEL@OPTN     W0KEY            *************  S01414
     C                     EXSR SRERR                                     S01414
     C                     END                                            S01414
     C*                                                                   S01194
     C** If originating branch used flag = 'Y'                            S01117
     C*                                                                   S01117
     C           BKOBRU    IFEQ 'Y'                                       S01117
     C                     SETON                     58                   S01117
     C                     END                                            S01117
     C*                                                                   S01194
     C** Read SDFTFRPD                                                    S01194
     C*                                                                   S01194
     C                     CALL 'AOFTFRR0'                                S01194
     C                     PARM '*DBERR'  RTCD                            S01194
     C                     PARM '*FIRST'  @OPTN                           S01194
     C           SDFTFR    PARM SDFTFR    DSFDY                           S01194
      *
      ** Check wether linkage to FT0045 enforced.
     C***********FTLJ******IFEQ 'Y'                                       S01194
     C           BTLVJN    IFEQ 'Y'                                       S01194
     C                     MOVE 'Y'       WLINK
     C                     END
     C/COPY WNCPYSRC,FT0040C135
      *
     C* CALCULATE BACK VALUE DATE
     C***********RUND******SUB  BVLP      BVLD    50                      S01194
     C           BJRDNB    SUB  BJBVPD    BVLD    50                      S01194
     C*                                                                   S01194
     C**READ*TABLE*FILE*FOR*RETAIL*ACCOUNT*NOS*IND.                       S01194
     C*********************MOVE '20'      KEY                             S01194
     C***********KEY*******CHAINTABTB20F             88                   S01194
     C**N88******RECI******COMP 'D'                  8888                 S01194
     C***88****************DO                              B001           S01194
     C************LOCK*****IN   DLDA                                      S01194
     C*********************MOVE 'FT0040  'DBPGM                           S01194
     C*********************MOVE 'TABLE'   DBFILE           ***************S01194
     C*********************Z-ADD3         DBASE            * DB ERROR 03 *S01194
     C*********************MOVELKEY       DBKEY            ***************S01194
     C*********************OUT  DLDA                                      S01194
     C*********************SETON                     U7U8LR               S01194
     C*********************DUMP                                           S01194
     C*********************RETRN                                          S01194
     C*********************END                             E001           S01194
     C*                                                                   S01194
      * SEE IF WINDOW REQUIRED                                            084499
      *                                                                   084499
     C           1         SETLLSDMMODPD                                  084499
     C                     READ SDMMODPD               8888               084499
     C           *IN88     IFEQ '1'                                       084499
     C                     MOVE 'FT0040  'DBPGM                           084499
     C                     MOVEL'SDMMOD'  DBFILE           ************** 084499
     C                     Z-ADD99        DBASE            ** DBASE 99 ** 084499
     C                     MOVEL'FRT'     DBKEY            ************** 084499
     C                     SETON                     U7U8LR               084499
     C/COPY WNCPYSRC,FT0040C136
     C                     DUMP                                           084499
     C*                                                                   093926
      *                                                                   093926
      *  Allocate dataarea to blanks                                      093926
      *                                                                   093926
     C                     EXSR DALLOC                                    093926
      *                                                                   093926
     C                     RETRN                                          093926
     C                     END                                            093926
     C*                                                                   093926
     C** Read SDRETLPD for retail account nos. indicator                  S01194
     C** Only if RETAIL switched on.                                      084499
     C*                                                                   S01194
     C           BGRTBN    IFEQ 'Y'                                       084499
     C                     CALL 'AORETLR0'                                S01194
     C                     PARM '*DBERR'  RTCD                            S01194
     C                     PARM '*FIRST'  @OPTN                           S01194
     C           SDRETL    PARM SDRETL    DSFDY                           S01194
     C                     END                                            084499
     C*                                                                   S01194
     C**READ*TABLE*FILE*FOR*BASE*CURRENCY                                 S00194
     C*********************MOVE *BLANK    KEY                             S01194
     C*********************MOVEL'20'      KEY                             S01194
     C*********************MOVELBCCY      SCCY    4                       S01194
     C*********************MOVE '1'       SCCY                            S01194
     C*                                                                   S01194
     C** Read SDCURRPD for base currency                                  S01194
     C*                                                                   S01194
     C                     MOVE BJCYCD    @K101   3                       S01194
     C                     EXSR TG1RED
     C* STORE BASE CURRENCY DECIMAL PLACES
     C*********************Z-ADDCDP       BCDP    10                      S01194
     C                     Z-ADDA6NBDP    BCDP    10                      S01194
     C*                                                                   S01194
     C**READ*TABTB40*FOR*STERLING CURRENCY CODE                           S01194
     C***********1*********CHAINTABTB40F             99    Get defaults.  S01194
     C**N99******RECI******COMP 'D'                  9999                 S01194
     C***99****************DO                                             S01194
     C************LOCK*****IN   DLDA                                      S01194
     C*********************MOVE 'FT0040  'DBPGM                           S01194
     C*********************MOVE 'TAB40'   DBFILE           ***************S01194
     C*********************Z-ADD94        DBASE            * DB ERROR 94 *S01194
     C*********************MOVEL'1'       DBKEY            ***************S01194
     C*********************OUT  DLDA                                      S01194
     C*********************SETON                     U7U8LR               S01194
     C*********************DUMP                                           S01194
     C*********************RETRN                                          S01194
     C*********************END                                            S01194
     C*                                                                   S01194
     C** Read SDTRADPD for sterling currency code                         S01194
     C*                                                                   S01194
     C                     CALL 'AOTRADR0'                                S01194
     C                     PARM '*DBERR'  RTCD                            S01194
     C                     PARM '*FIRST'  @OPTN                           S01194
     C           SDTRAD    PARM SDTRAD    DSFDY                           S01194
      *                                                                   S01241
      ** MOVE CODE TO BEFORE ACCESS OF RETAIL ICD FILE                    084499
      **SEE*IF*WINDOW REQUIRED                                    S01241  084499
      ******                                                      S01241  084499
     C******     1         SETLLSDMMODPD                          S01241  084499
     C******               READ SDMMODPD               8888       S01241  084499
     C******     *IN88     IFEQ '1'                               S01241  084499
     C******               MOVE 'FT0040  'DBPGM                   S01241  084499
     C******               MOVEL'SDMMOD'  DBFILE           *******S01241  084499
     C******               Z-ADD99        DBASE            ** DBASS01241  084499
     C******               MOVEL'FRT'     DBKEY            *******S01241  084499
     C******               SETON                     U7U8LR       S01241  084499
     C******               DUMP                                   S01241  084499
     C***********                                                         093926
      ***********                                                   042167093926
      ***Allocate dataarea to blanks                                042167093926
      ***********                                                   042167093926
     C***********          EXSR DALLOC                              042167093926
      ***********                                                   042167093926
     C***********          RETRN                                    S01241093926
     C***********          END                                      S01241093926
     C***********                                                   S01241093926
     C*                                                                   S01494
     C** Access SAR details file to determine if S01494 is switched ON    S01494
     C*                                                                   S01494
     C                     MOVE *BLANK    S01494  1                       S01494
     C                     CALL 'AOSARDR0'                                S01494
     C                     PARM *BLANKS   @RTRN   7                       S01494
     C                     PARM '*VERIFY' @OPTN   7                       S01494
     C                     PARM 'S01494'  @SARD   6                       S01494
     C           SCSARD    PARM SCSARD    DSFDY                           S01494
     C*                                                                   S01494
     C** If core feature is switched ON, set a variable field to          S01494
     C** condition the rest of the processing                             S01494
     C*                                                                   S01494
     C           @RTRN     IFEQ *BLANKS                                   S01494
     C                     MOVE 'Y'       S01494                          S01494
     C                     ELSE                                           S01494
     C*                                                                   S01494
     C** else, database error (return code other than *NRF)               S01494
     C*                                                                   S01494
     C           @RTRN     IFNE '*NRF   '                                 S01494
     C                     MOVEL'SCSARDPD'W0FILE           ************   S01494
     C                     MOVEL'*VERIFY' W0KEY            * DBERR 01 *   S01494
     C                     Z-ADD1         W0ERNB           ************   S01494
     C                     EXSR SRERR                      *ABORT PGM*    S01494
     C                     END                                            S01494
     C                     END                                            S01494
     C*                                                                   S01499
     C** Access SAR details file to determine if S01499 is switched ON    S01499
     C*                                                                   S01499
     C                     MOVE *BLANKS   S01499  1                       S01499
     C                     CALL 'AOSARDR0'                                S01499
     C                     PARM *BLANKS   @RTRN   7                       S01499
     C                     PARM '*VERIFY' @OPTN   7                       S01499
     C                     PARM 'S01499'  @SARD   6                       S01499
     C           SCSARD    PARM SCSARD    DSFDY                           S01499
     C*                                                                   S01499
     C** If core feature is switched ON, set a variable field to          S01499
     C** condition the rest of the processing                             S01499
     C*                                                                   S01499
     C           @RTRN     IFEQ *BLANKS                                   S01499
     C                     MOVE 'Y'       S01499                          S01499
     C                     ELSE                                           S01499
     C*                                                                   S01499
     C** else, database error (return code other than *NRF)               S01499
     C*                                                                   S01499
     C           @RTRN     IFNE '*NRF   '                                 S01499
     C                     MOVEL'SCSARDPD'W0FILE           ************   S01499
     C                     MOVEL'*VERIFY' W0KEY            * DBERR 02 *   S01499
     C                     Z-ADD2         W0ERNB           ************   S01499
     C                     EXSR SRERR                      *ABORT PGM*    S01499
     C                     END                                            S01499
     C                     END                                            S01499
      *                                                                   CEU006
      ** Access SAR details file to determine if CEU006 is switched ON    CEU006
      *                                                                   CEU006
     C                     MOVE *BLANKS   CEU006  1                       CEU006
     C                     CALL 'AOSARDR0'                                CEU006
     C                     PARM *BLANKS   @RTRN   7                       CEU006
     C                     PARM '*VERIFY' @OPTN   7                       CEU006
     C                     PARM 'CEU006'  @SARD   6                       CEU006
     C           SCSARD    PARM SCSARD    DSFDY                           CEU006
      *                                                                   CEU006
      ** If core feature is switched ON, set a variable field to          CEU006
      ** condition the rest of the processing                             CEU006
      *                                                                   CEU006
     C           @RTRN     IFEQ *BLANKS                                   CEU006
     C                     MOVE 'Y'       CEU006                          CEU006
     C                     MOVE *ON       *IN03                           CEU006
     C                     ELSE                                           CEU006
      *                                                                   CEU006
      ** else, database error (return code other than *NRF)               CEU006
      *                                                                   CEU006
     C           @RTRN     IFNE '*NRF   '                                 CEU006
     C                     MOVEL'SCSARDPD'W0FILE           ************   CEU006
     C                     MOVEL'*VERIFY' W0KEY            * DBERR 42 *   CEU006
     C                     Z-ADD42        W0ERNB           ************   CEU006
     C                     EXSR SRERR                      *ABORT PGM*    CEU006
     C                     END                                            CEU006
     C                     END                                            CEU006
     C*                                                                   S01499
      *  Access SAR details file to see if CFT007 is installed.           CFT007
      *                                                                   CFT007
     C                     CALL 'AOSARDR0'                                CFT007
     C                     PARM *BLANKS   P@RTCD  7                       CFT007
     C                     PARM '*VERIFY' P@OPTN  7                       CFT007
     C                     PARM 'CFT007'  @SARD   6                       CFT007
     C           SCSARD    PARM *BLANKS   DSFDY                           CFT007
      *                                                                   CFT007
      *  Allow BIC Database Plus Integration                              CFT007
      *                                                                   CFT007
     C           P@RTCD    IFEQ *BLANKS                                   CFT007
     C                     MOVEL'CFT007'  CFT007  6                       CFT007
     C                     MOVE *ON       *IN83                           CFT007
     C                     ENDIF                                          CFT007
      *                                                                                       CFT050
      ** Access SAR file to determine if CFT050 (SWIFTRef Directories                         CFT050
      ** upload) is installed.                                                                CFT050
      *                                                                                       CFT050
     C                     CALL 'AOSARDR0'                                                    CFT050
     C                     PARM *BLANKS   PRTCD                                               CFT050
     C                     PARM '*VERIFY' POPTN                                               CFT050
     C                     PARM 'CFT050'  PSARD                                               CFT050
      *                                                                                       CFT050
      ** CFT007 process will take place when CFT050 is switched on                            CFT050
      *                                                                                       CFT050
     C           PRTCD     IFEQ *BLANKS                                                       CFT050
     C                     MOVEL'CFT007'  CFT007                                              CFT050
     C                     MOVE *ON       *IN83                                               CFT050
     C                     ENDIF                                                              CFT050
      *                                                                   CFT009
      ** Determine if SAR CFT010 is installed                             CFT009
      *                                                                   CFT009
     C                     CALL 'AOSARDR0'                                CFT009
     C                     PARM *BLANKS   P@RTCD                          CFT009
     C                     PARM '*VERIFY 'P@OPTN                          CFT009
     C                     PARM 'CFT010'  P@SARD                          CFT009
     C           SCSARD    PARM SCSARD    DSFDY                           CFT009
      *                                                                   CFT009
     C           P@RTCD    IFNE *BLANKS                                   CFT009
     C           P@RTCD    ANDNE'*NRF   '                                 CFT009
     C                     MOVEL'SCSARDPD'DBFILE                          CFT009
     C                     Z-ADD62        DBASE                           CFT009
     C                     MOVEL'CFT010'  DBKEY                           CFT009
     C                     EXSR SRERR                                     CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C           P@RTCD    IFEQ *BLANKS                                   CFT009
     C                     MOVE 'Y'       CFT010  1                       CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       CFT010                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT007
     C** If V.A.T. is active, access file for V.A.T rate                  S01499
     C*                                                                   S01499
     C           S01499    IFEQ 'Y'                                       S01499
     C           CFT010    OREQ 'Y'                                       CFT009
     C                     CALL 'AOVATR0'              9090               S01499
     C                     PARM '*MSG   ' P@RTCD  7        B:Return code  S01499
     C                     PARM '*FIRST ' P@OPTN  7        I:Option       S01499
     C                     PARM           VATDS                           S01499
     C*                                                                   S01499
     C** If return with an error (LR seton in called program) then        S01499
     C** process for database error.                                      S01499
     C*                                                                   S01499
     C           *IN90     IFEQ '1'                                       S01499
     C           P@RTCD    OREQ '*ERROR*'                                 S01499
     C                     MOVEL'ABSFI101'W0FILE           ************   S01499
     C                     MOVEL'*FIRST ' W0KEY            * DBERR 05 *   S01499
     C                     Z-ADD5         W0ERNB           ************   S01499
     C                     EXSR SRERR                      *ABORT PGM*    S01499
     C                     ELSE                                           S01499
     C                     Z-ADDO#VATR    WVATR   54                      S01499
     C                     END                                            S01499
     C                     END                                            S01499
     C*                                                                   S01506
     C** Access SAR details file to determine if S01506 is switched ON    S01506
     C*                                                                   S01506
     C                     MOVE *BLANK    S01506  1                       S01506
     C                     CALL 'AOSARDR0'                                S01506
     C                     PARM *BLANKS   @RTRN   7                       S01506
     C                     PARM '*VERIFY' @OPTN   7                       S01506
     C                     PARM 'S01506'  @SARD   6                       S01506
     C           SCSARD    PARM SCSARD    DSFDY                           S01506
     C*                                                                   S01506
     C** If core feature is switched ON, set a variable field to          S01506
     C** condition the rest of the processing                             S01506
     C*                                                                   S01506
     C           @RTRN     IFEQ *BLANKS                                   S01506
     C                     MOVE 'Y'       S01506                          S01506
     C                     ELSE                                           S01506
     C*                                                                   S01506
     C** else, database error (return code other than *NRF)               S01506
     C*                                                                   S01506
     C           @RTRN     IFNE '*NRF   '                                 S01506
     C                     MOVEL'SCSARDPD'W0FILE           ************   S01506
     C                     MOVEL'*VERIFY' W0KEY            * DBERR 03 *   S01506
     C                     Z-ADD3         W0ERNB           ************   S01506
     C                     EXSR SRERR                      *ABORT PGM*    S01506
     C                     END                                            S01506
     C                     END                                            S01506
     C*                                                                   S01508
     C** Access SAR details file to determine if S01508 is switched ON    S01508
     C*                                                                   S01508
     C                     MOVE *BLANKS   S01508  1                       S01508
     C                     CALL 'AOSARDR0'                                S01508
     C                     PARM *BLANKS   @RTRN   7                       S01508
     C                     PARM '*VERIFY' @OPTN   7                       S01508
     C                     PARM 'S01508'  @SARD   6                       S01508
     C           SCSARD    PARM SCSARD    DSFDY                           S01508
     C*                                                                   S01508
     C** If core feature is switched ON, set a variable field to          S01508
     C** condition the rest of the processing                             S01508
     C*                                                                   S01508
     C           @RTRN     IFEQ *BLANKS                                   S01508
     C                     MOVE 'Y'       S01508                          S01508
     C                     ELSE                                           S01508
     C*                                                                   S01508
     C** else, database error (return code other than *NRF)               S01508
     C*                                                                   S01508
     C           @RTRN     IFNE '*NRF   '                                 S01508
     C                     MOVEL'SCSARDPD'W0FILE           ************   S01508
     C                     MOVEL'*VERIFY' W0KEY            * DBERR 04 *   S01508
     C                     Z-ADD4         W0ERNB           ************   S01508
     C                     EXSR SRERR                      *ABORT PGM*    S01508
     C                     END                                            S01508
     C                     END                                            S01508
     C*                                                                   S01241
     C/COPY WNCPYSRC,FT0040C047
      *                                                                   CGL007
      ** Access SAR details to determine if CGL007 is installed           CGL007
      *                                                                   CGL007
     C                     CALL 'AOSARDR0'                                CGL007
     C                     PARM *BLANKS   PRTCD   7                       CGL007
     C                     PARM '*VERIFY' POPTN   7                       CGL007
     C                     PARM 'CGL007'  PSARD   6                       CGL007
     C           SCSARD    PARM SCSARD    DSFDY                           CGL007
      *                                                                   CGL007
     C           PRTCD     IFEQ *BLANKS                                   CGL007
     C                     MOVE 'Y'       CGL007  1                       CGL007
     C                     MOVE *BLANKS   GL0090  1                       CGL007
      *                                                                   CGL007
      ** If program is called by GL0090, @RTCD contains 'Z'               CGL007
      *                                                                   CGL007
     C           @RTCD     IFEQ 'Z'                                       CGL007
     C                     MOVE 'Y'       GL0090                          CGL007
     C                     MOVE *BLANKS   @RTCD                           CGL007
     C                     ENDIF                                          CGL007
     C                     ELSE                                           CGL007
     C           PRTCD     IFNE '*NRF   '                                 CGL007
     C                     MOVEL'SCSARDPD'W0FILE           ************   CGL007
     C                     MOVEL'*VERIFY' W0KEY            * DBERR 06 *   CGL007
     C                     Z-ADD6         W0ERNB           ************   CGL007
     C                     EXSR SRERR                                     CGL007
     C                     ELSE                                           CGL007
     C                     MOVE 'N'       CGL007                          CGL007
     C                     ENDIF                                          CGL007
     C                     ENDIF                                          CGL007
      *                                                                   CFT012
      ** Access SAR details file to determine if CFT012 is switched ON    CFT012
      *                                                                   CFT012
     C                     MOVE 'N'       CFT012  1                       CFT012
     C                     CALL 'AOSARDR0'                                CFT012
     C                     PARM *BLANKS   @RTRN   7                       CFT012
     C                     PARM '*VERIFY' @OPTN   7                       CFT012
     C                     PARM 'CFT012'  @SARD   6                       CFT012
     C           SCSARD    PARM SCSARD    DSFDY                           CFT012
      *                                                                   CFT012
      ** If core feature is switched ON, set a variable field to          CFT012
      ** condition the rest of the processing                             CFT012
      *                                                                   CFT012
     C           @RTRN     IFEQ *BLANKS                                   CFT012
     C                     MOVE 'Y'       CFT012                          CFT012
     C                     ELSE                                           CFT012
      *                                                                   CFT012
      ** else, database error (return code other than *NRF)               CFT012
      *                                                                   CFT012
     C           @RTRN     IFNE '*NRF   '                                 CFT012
     C                     MOVEL'SCSARDPD'W0FILE           ************   CFT012
     C                     MOVEL'*VERIFY' W0KEY            * DBERR 79 *   CFT012
     C                     Z-ADD79        W0ERNB           ************   CFT012
     C                     EXSR SRERR                      *ABORT PGM*    CFT012
     C                     END                                            CFT012
     C                     END                                            CFT012
      *                                                                                       CSW203
      ** Check if SWIFT Changes 2003 (CSW203) is installed                                    CSW203
      *                                                                                       CSW203
     C                     CALL 'SWIF2003'                                                    CSW203
     C                     PARM *BLANKS   PRTCD                                               CSW203
      *                                                                                       CSW203
     C           PRTCD     IFEQ 'CSW2003'                                                     CSW203
     C                     MOVE 'Y'       CSW203  1                                           CSW203
     C                     ELSE                                                               CSW203
     C                     MOVE 'N'       CSW203                                              CSW203
     C                     ENDIF                                                              CSW203
      *                                                                   CGL007
     C* SETUP FIELD SETOFF TO SETOF ERROR INDS
     C                     MOVE *ZERO     SETOFF 26
     C*
      *                                                                   045014
      * Access FT Control data                                            045014
      *                                                                   045014
     C                     CALL 'FT0005'               9090               045014
     C           R#RTN     PARM *BLANKS   O#RTN   7                       045014
     C           C#CNTL    PARM           O#DTA 256                       045014
      *                                                                   045014
     C           *IN90     IFEQ '1'                                       045014
     C           R#RTN     ORNE *BLANKS                                   045014
     C                     Z-ADD1         Q                               045014
     C                     MOVEL'INITL '  @STK,Q                          045014
     C                     MOVEL'*CALL   'W0FILE                          045014
     C                     MOVEL'FT0005'  W0KEY                           045014
     C                     Z-ADD905       W0ERNB                          045014
     C                     MOVELERR@,1    W0NARR                          045014
     C                     EXSR SRERR                                     045014
     C                     END                                            045014
      *                                                                   045014
      * Set up FT override for General Ledger Balances                    045014
      *                                                                   045014
     C           C#GLUI    IFEQ 'I'                                       045014
     C                     MOVEL'Y'       ##FTOV  1                       045014
     C                     ELSE                                           045014
     C                     MOVEL*BLANKS   ##FTOV                          045014
     C                     END                                            045014
     C/COPY WNCPYSRC,FT0040C104
     C*                                                                   S01494
     C** Retrieve the text for FTM2510 using MEC1150                      S01494
     C*                                                                   S01494
     C                     CALL 'MEC1150'              9090               S01494
     C                     PARM 'FTM2510' #MSGID                          S01494
     C                     PARM 'FTUSRMSG'#MSGF                           S01494
     C                     PARM           #MSDTA                          S01494
     C                     PARM *BLANKS   #MSTX1                          S01494
     C                     PARM *BLANKS   #MSTX2                          S01494
     C*                                                                   S01494
     C                     MOVEL#MSTX1    WM2510 28                       S01494
     C*                                                                   S01494
     C** Retrieve the text for FTM2519 using MEC1150                      S01494
     C*                                                                   S01494
     C                     CALL 'MEC1150'              9090               S01494
     C                     PARM 'FTM2519' #MSGID                          S01494
     C                     PARM 'FTUSRMSG'#MSGF                           S01494
     C                     PARM           #MSDTA                          S01494
     C                     PARM *BLANKS   #MSTX1                          S01494
     C                     PARM *BLANKS   #MSTX2                          S01494
     C*                                                                   S01494
     C                     MOVEL#MSTX1    WM2519 28                       S01494
      *                                                                   S01435
      *  /Copy point for Initialisation                                   S01435
      *                                                                   S01435
     C/COPY WNCPYSRC,FT0040INIT                                           S01435
      *                                                                   CFT002
      * Access SAR details file to see if CFT002 is installed.            CFT002
      *                                                                   CFT002
     C                     CALL 'AOSARDR0'                                CFT002
     C                     PARM *BLANKS   P@RTCD  7                       CFT002
     C                     PARM '*VERIFY' P@OPTN  7                       CFT002
     C                     PARM 'CFT002'  @SARD   6                       CFT002
     C           SCSARD    PARM *BLANKS   DSFDY                           CFT002
      *                                                                   CFT002
      * Allow decode processing                                           CFT002
      *                                                                   CFT002
     C           P@RTCD    IFEQ *BLANKS                                   CFT002
     C                     MOVEL'CFT002'  CFT002  6                       CFT002
     C                     ENDIF                                          CFT002
      *                                                                   CFT002
      * Access SAR details file to see if CFT003 is installed.            CFT003
      *                                                                   CFT003
     C                     CALL 'AOSARDR0'                                CFT003
     C                     PARM *BLANKS   P@RTCD  7                       CFT003
     C                     PARM '*VERIFY' P@OPTN  7                       CFT003
     C                     PARM 'CFT003'  @SARD   6                       CFT003
     C           SCSARD    PARM *BLANKS   DSFDY                           CFT003
      *                                                                   CFT003
      * Allow Batch Authorisation processing                              CFT003
      *                                                                   CFT003
     C           P@RTCD    IFEQ *BLANKS                                   CFT003
     C           CFT003    ANDEQ*BLANKS                                   CFT003
     C                     MOVEL'CFT003'  CFT003  6                       CFT003
     C                     OPEN OTPAYXL0                                  CFT003
     C                     ENDIF                                          CFT003
      *                                                                   CGL009
      *-------------------------------------------------------------------CGL009
      *  Access SAR details file to see if CGL009 is allowed.             CGL009
      *                                                                   CGL009
     C                     CALL 'AOSARDR0'                 Rtv SAR DetailsCGL009
     C                     PARM *BLANKS   P@RTCD  7        -B:Return Code CGL009
     C                     PARM '*VERIFY' P@OPTN  7        -I:Option      CGL009
     C                     PARM 'CGL009'  P@SARD  6        -I:SAR Id      CGL009
     C           SCSARD    PARM *BLANKS   DSFDY            -O:Format      CGL009
      *                                                                   CGL009
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -CGL009
      *  Allow FONTIS processing                                          CGL009
      *                                                                   CGL009
     C           P@RTCD    IFEQ *BLANKS                     If Feature On CGL009
     C                     OPEN MEFNODL1                                  CGL009
      *  Show Deal reference field                                        175479
     C                     SETON                     48                   175479
     C                     MOVE 'Y'       CGL009  1          Set Flag     CGL009
      *                                                                   CGL009
      *  Get Fontis TPP process information                               CGL009
      *                                                                   CGL009
     C                     CALL 'AOFONTR0'                                CGL009
     C                     PARM           P@RTCD  7                       CGL009
     C                     PARM '*FIRST'  @OPTN   7                       CGL009
     C           SDFONT    PARM SDFONT    DSFDY                           CGL009
     C           P@RTCD    IFNE *BLANKS                                   CGL009
     C                     MOVEL'AOFONTR0'W0FILE                          CGL009
     C                     MOVEL'*CALL'   W0KEY            ***************CGL009
     C                     Z-ADD70        W0ERNB           * DB ERROR 70 *CGL009
     C                     EXSR SRERR                      ***************CGL009
     C                     END                                            CGL009
      *  CGL009 not found                                                 CGL009
     C                     ELSE                             Else          CGL009
     C                     MOVE 'N'       CGL009             Set Flag     CGL009
      *  Hide Deal reference field                                        175479
     C                     SETOF                     48                   175479
     C                     END                              End If        CGL009
      ** Determine if SAR CFT014 MT103 Message Generation is ins -        CFT014
      ** talled.                                                          CFT014
     C                     CALL 'AOSARDR0'                                CFT014
     C                     PARM *BLANKS   P@RTCD                          CFT014
     C                     PARM '*VERIFY 'P@OPTN                          CFT014
     C                     PARM 'CFT014'  P@SARD                          CFT014
     C           SCSARD    PARM SCSARD    DSFDY                           CFT014
     C           P@RTCD    IFNE *BLANKS                                   CFT014
     C           P@RTCD    ANDNE'*NRF   '                                 CFT014
     C                     MOVEL'SCSARDPD'DBFILE                          CFT014
     C                     Z-ADD60        DBASE                           CFT014
     C                     MOVEL'CFT014'  DBKEY                           CFT014
     C                     EXSR SRERR                                     CFT014
     C                     ENDIF                                          CFT014
     C           P@RTCD    IFEQ *BLANKS                                   CFT014
     C           CFT003    IFEQ *BLANKS                                   CFT014
     C                     OPEN OTPAYXL0                                  CFT014
     C                     ENDIF                                          CFT014
     C                     OPEN OTPAYXL2                                  CFT014
     C                     MOVE 'Y'       CFT014  1                       CFT014
     C                     MOVE *ON       *IN69                           CFT014
     C                     ELSE                                           CFT014
     C                     MOVE 'N'       CFT014                          CFT014
     C                     MOVE *OFF      *IN69                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT009
      ** Determine if SAR CFT009 is installed                             CFT009
      *                                                                   CFT009
     C                     CALL 'AOSARDR0'                                CFT009
     C                     PARM *BLANKS   P@RTCD                          CFT009
     C                     PARM '*VERIFY 'P@OPTN                          CFT009
     C                     PARM 'CFT009'  P@SARD                          CFT009
     C           SCSARD    PARM SCSARD    DSFDY                           CFT009
      *                                                                   CFT009
     C           P@RTCD    IFNE *BLANKS                                   CFT009
     C           P@RTCD    ANDNE'*NRF   '                                 CFT009
     C                     MOVEL'SCSARDPD'DBFILE                          CFT009
     C                     Z-ADD61        DBASE                           CFT009
     C                     MOVEL'CFT009'  DBKEY                           CFT009
     C                     EXSR SRERR                                     CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C           P@RTCD    IFEQ *BLANKS                                   CFT009
     C           CFT003    IFEQ *BLANKS                                   CFT009
     C                     OPEN OTPAYXL0                                  CFT009
     C                     ENDIF                                          CFT009
     C           CFT014    IFEQ 'N'                                       CFT009
     C                     OPEN OTPAYXL2                                  CFT009
     C                     ENDIF                                          CFT009
     C                     MOVE 'Y'       CFT009  1                       CFT009
     C                     MOVE *ON       *IN55                           CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       CFT009                          CFT009
     C                     MOVE *OFF      *IN55                           CFT009
     C                     ENDIF                                          CFT009
      *                                                                   045014
     C                     MOVE 'N'       CRE008  1                                           CRE008
     C                     CALL 'AOSARDR0'                                                    CRE008
     C                     PARM *BLANKS   P@RTCD                                              CRE008
     C                     PARM '*VERIFY 'P@OPTN                                              CRE008
     C                     PARM 'CRE008'  P@SARD                                              CRE008
     C           SCSARD    PARM SCSARD    DSFDY                                               CRE008
      *                                                                                       CRE008
     C           P@RTCD    IFNE *BLANKS                                                       CRE008
     C           P@RTCD    ANDNE'*NRF   '                                                     CRE008
     C                     MOVEL'SCSARDPD'DBFILE                                              CRE008
     C                     Z-ADD72        DBASE                                               CRE008
     C                     MOVEL'CRE008'  DBKEY                                               CRE008
     C                     EXSR SRERR                                                         CRE008
     C                     ENDIF                                                              CRE008
      *                                                                                       CRE008
     C           P@RTCD    IFEQ *BLANKS                                                       CRE008
     C                     MOVE 'Y'       CRE008                                              CRE008
     C                     ENDIF                                                              CRE008
      *                                                                                       CAP205
      ** Determine if SAR CAP205 is installed                                                 CAP205
      *                                                                                       CAP205
     C                     MOVE 'N'       CAP205  1                                           CAP205
     C                     CALL 'AOSARDR0'                                                    CAP205
     C                     PARM *BLANKS   P@RTCD                                              CAP205
     C                     PARM '*VERIFY 'P@OPTN                                              CAP205
     C                     PARM 'CAP205'  P@SARD                                              CAP205
     C           SCSARD    PARM SCSARD    DSFDY                                               CAP205
      *                                                                                       CAP205
     C           P@RTCD    IFNE *BLANKS                                                       CAP205
     C           P@RTCD    ANDNE'*NRF   '                                                     CAP205
     C                     MOVEL'SCSARDPD'DBFILE                                              CAP205
     C                     Z-ADD74        DBASE                                               CAP205
     C                     MOVEL'CAP205'  DBKEY                                               CAP205
     C                     EXSR SRERR                                                         CAP205
     C                     ENDIF                                                              CAP205
      *                                                                                       CAP205
     C           P@RTCD    IFEQ *BLANKS                                                       CAP205
     C                     MOVE 'Y'       CAP205                                              CAP205
     C                     ENDIF                                                              CAP205
      *                                                                                       CRE008
      **                                                                                      CSC022
      ** Initialize CSC022 and Skip Commit/Rollback flags                                     CSC022
      **                                                                                      CSC022
     C                     MOVE 'N'       CSC022  1                                           CSC022
     C                     MOVE 'N'       WCRSKP  1                                           CSC022
      **                                                                                      CSC022
      ** Access SAR details file to determine if CSC022 switchable feature                    CSC022
      ** is switched on                                                                       CSC022
      **                                                                                      CSC022
     C                     CALL 'AOSARDR0'                                                    CSC022
     C                     PARM *BLANKS   P@RTCD                                              CSC022
     C                     PARM '*VERIFY 'P@OPTN                                              CSC022
     C                     PARM 'CSC022'  P@SARD                                              CSC022
     C           SCSARD    PARM SCSARD    DSFDY                                               CSC022
      **                                                                                      CSC022
     C           P@RTCD    IFEQ *BLANKS                                                       CSC022
     C                     MOVE 'Y'       CSC022                                              CSC022
      **                                                                                      CSC022
      ** Get Jobs currently running i batch mode using SCCMRJOB dataarea                      CSC022
      **                                                                                      CSC022
     C           *NAMVAR   DEFN SCCMTJOB  SCCMT                                               CSC022
     C                     IN   SCCMT                                                         CSC022
      **                                                                                      CSC022
     C           WCMTNO    IFGT 0                                                             CSC022
      ** Move committed jobs to arrary for checking                                           CSC022
     C                     MOVEAWCJOBS    WCMT                                                CSC022
      ** Verify if job running exists in array                                                CSC022
     C           WSID      LOKUPWCMT                     50                                   CSC022
     C           *IN50     IFEQ *ON                                                           CSC022
     C                     MOVE 'Y'       WCRSKP                                              CSC022
     C                     ENDIF                                                              CSC022
     C                     ENDIF                                                              CSC022
      **                                                                                      CSC022
     C                     ELSE                                                               CSC022
      ** Execute *PSSR if CSC022 is not found or Database error                               CSC022
     C           P@RTCD    IFNE '*NRF'                                                        CSC022
     C                     MOVEL'CSC022'  DBKEY                                               CSC022
     C                     MOVEL'SCSARDPD'DBFILE                                              CSC022
     C                     Z-ADD73        DBASE                                               CSC022
     C                     EXSR SRERR                                                         CSC022
     C                     ENDIF                                                              CSC022
      **                                                                                      CSC022
     C                     ENDIF                                                              CSC022
      **                                                                                      CSC022
     C                     ENDSR
     C*
     C************************************************************
     C* END OF INITIAL SUBROUTINE
     C************************************************************
      /EJECT                                                              S01194
      *****************************************************************   S01194
     C           FQRY1     BEGSR                                          S01194
      *----------------------------------------------------------------   S01194
      * Subroutine to resolve entry of ? for standing data fields.        S01194
      * Performed after function key validation and prior to field        S01194
      * validation                                                        S01194
      *                                                                   S01194
      * Indicators used:                                                  S01194
      *  62       on then redisplay screen                                S01194
      *  63       used in LOKUP, on if ? found                            S01194
      *----------------------------------------------------------------   S01194
     C                     SETOF                     62                   S01194
     C*                                                                   S01194
     C*BLANK OUT BOOKING BRANCH SELECTION WORK FIELD                      S01194
     C                     MOVE *BLANKS   BRSEL                           S01194
      *                                                                   S01194
      * check branch for entry of ?                                       S01194
     C                     MOVEA*BLANKS   FLDQ                            S01194
     C                     MOVELSBRCA     FLDQ                            S01194
     C                     SETOF                     63                   S01194
     C           '?'       LOKUPFLDQ                     63               S01194
      *                                                                   S01194
      * if ? found seton redisplay ind and call access program            S01194
     C           *IN63     IFEQ '1'                                       S01194
     C                     SETON                     62                   S01194
     C**********           CALL 'AOBRCHR0'                                             S01194 CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM *BLANKS   RTCD                            S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM '?'       @BRCD   3                       S01194
     C********** SDBRCH    PARM SDBRCH    DSFDY                                        S01194 CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
      *                                                                   S01194
      * if selection made move value to screen field                      S01194
     C           RTCD      IFEQ *BLANKS                                   S01194
     C                     MOVELA8BRCD    SBRCA                           S01194
     C                     ELSE                                           S01194
     C                     MOVEL'NOSEL'   BRSEL   5                       S01194
     C                     MOVEL*BLANKS   SBRCA                           S01194
     C                     END                                            S01194
      *                                                                   S01194
     C                     END                                            S01194
      *                                                                   S01194
     C                     ENDSR                                          S01194
     C************************************************************        S01194
     C**  END OF FQRY1 SUBROUTINE                                *        S01194
     C************************************************************        S01194
     C/EJECT
     C************************************************************
     C* VALONE SR.
     C* TO VALIDATE THE FIRST SCREEN ENTRIES
     C*
     C           VALONE    BEGSR
     C*
     C* CLEAR ERROR CODES AND SET OFF INDICATORS
     C                     SETOF                     202189
     C                     SETOF                     8586
     C                     SETOF                     56                   S01117
     C                     MOVEA'0000'    *IN,12
     C                     MOVE *IN46     SV46    1                       079911
     C**********           MOVE *IN47     SV47    1                CEU006 164560
     C                     MOVEASETOFF    *IN,22
     C                     MOVE SV46      *IN46                           079911
     C**********           MOVE SV47      *IN47                    CEU006 164560
     C                     MOVEA'00000'   *IN,50
     C                     MOVE *OFF      *IN49                           CFT014
     C                     MOVE '0'       *IN59                           S01414
     C                     MOVE '0'       *IN61                           S01435
     C                     MOVE '0'       *IN74                           S01414
     C                     MOVE '0'       *IN77                           S01414
     C                     MOVEA'0000'    *IN,08                          CEU006
     C                     MOVE *OFF      *IN73                           CFT009
     C                     MOVE *OFF      *IN84                           CFT009
     C                     MOVEA*BLANK    ERCD
     C                     Z-ADD1         Z       30
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0040CP10                                           S01408
     C*                                                                   S01408
     C* ACTION CODE MUST BE I, A, D OR E
     C           ACTION    IFEQ 'I'                        B001
     C                     SETON                     12    INSERT
     C                     ELSE                            X001
     C           ACTION    IFEQ 'A'                        B002
     C                     SETON                     13    AMEND
     C                     ELSE                            X002
     C           ACTION    IFEQ 'D'                        B003
     C                     SETON                     14    DELETE
     C                     ELSE                            X003
     C           ACTION    IFEQ 'E'                        B004
     C                     SETON                     15    ENQUIRE
     C                     ELSE                            X004
     C                     SETON                     2089  ERROR
     C*********************MOVEA' 084'    ERCD,Z                          S01117
     C                     MOVEA' 002'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     END                             E004
     C                     END                             E003
     C                     END                             E002
     C                     END                             E001
      *                                                                   S01435
      * If action code 'I' and FT0040 called from swift enquiry           S01435
      * function,than blank out SPREF and move message ref. to DS PHEAD   S01435
      * Also - seton IN47 to display Notified delivery fields.            CEU006
      *                                                                   S01435
     C           ACTION    IFEQ 'I'                                       S01435
     C           XPREF     ANDNE*BLANKS                                   S01435
     C                     MOVE *ON       *IN47                           CEU006
     C                     MOVEL*BLANKS   SPREF                           S01435
     C/COPY WNCPYSRC,FT0040C297
     C                     MOVELXPREF     MSGREF                          S01435
     C                     Z-ADDREFMSG    PHMSGR                          S01435
     C                     Z-ADDREFPRT    PHPART                          S01435
     C                     MOVEL*BLANKS   PHMIR                           S01435
     C                     MOVEL*BLANKS   PHMOR                           S01435
     C/COPY WNCPYSRC,FT0040C298
     C                     END                                            S01435
     C*                                                                   S01117
     C** If multi branched...                                             S01117
     C*                                                                   S01117
     C           *IN57     IFEQ '1'                        B001           S01117
     C*                                                                   S01117
     C** and not called from enquiry screen                               S01117
     C*                                                                   S01117
     C           XPREF     ANDEQ*BLANKS                                   S01117
     C*                                                                   S01117
     C*IF MB,AND NOT INSERT BOOKING BRANCH ENTRY NOT ALLOWED              S01117
     C*                                                                   S01117
     C           *IN12     IFNE '1'                                       S01117
     C           SBRCA     ANDNE*BLANKS                                   S01117
     C                     SETON                     5689                 S01117
     C                     MOVEA' 007'    ERCD,Z                          S01117
     C                     ADD  1         Z                               S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C** If booking branch blank F3  pressed in FQRY and Insert           S01117
     C*                                                                   S01117
     C           SBRCA     IFEQ *BLANKS                                   S01117
     C           BRSEL     ANDNE'NOSEL'                                   S01117
     C           *IN12     ANDEQ'1'                                       S01117
     C                     MOVE @DFBR     SBRCA                           S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C** Read SDBRCHPD to validate screen branch code,for insert          S01117
     C*                                                                   S01117
     C           *IN12     IFEQ '1'                                       S01117
     C**********           CALL 'AOBRCHR0'                                             S01117 CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM *BLANKS   RTCD                            S01117
     C                     PARM '*KEY   ' @OPTN                           S01117
     C                     PARM SBRCA     @BRCD   3                       S01117
     C********** SDBRCH    PARM SDBRCH    DSFDY                                        S01117 CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C*                                                                   S01117
     C           RTCD      IFNE *BLANKS                                   S01117
     C                     SETON                     5689                 S01117
     C                     MOVEA' 006'    ERCD,Z                          S01117
     C                     ADD  1         Z                               S01117
     C                     END                                            S01117
     C*
     C                     END                                            S01117
     C*                                                                   S01117
     C                     END                             E001           S01117
     C*                                                                   S01117
     C* PAYMENT REF MUST BE BLANK IF INSERT OTHERWISE NOT
     C*
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0040CP46                                           S01408
     C*                                                                   S01408
     C           SPREF     IFNE *BLANK                     B001
     C           *IN12     ANDEQ'1'
     C                     SETON                     2189
     C****************     MOVEA' 020'    ERCD,Z                          E22337
     C*********************MOVEA' 021'    ERCD,Z                    E22337S01117
     C                     MOVEA' 004'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0040CP47                                           S01408
     C*                                                                   S01408
     C                     ELSE                            X001
     C*
     C* IF NOT INSERT CHECK PAY REF ON FILE
     C*
     C  N12                DO                              B002
     C           SPREF     CHAINOTPAYDDF             88
     C   88                SETON                     21
     C/COPY WNCPYSRC,FT0040C065
     C*
     C* IF NOT ENQUIRY MUST BE LIVE RECORD
     C*
     C  N21N15   RECI      COMP 'D'                  2121
     C*
     C           *IN21     IFEQ '1'                        B003
     C/COPY WNCPYSRC,FT0040C091
     C           CGL007    IFEQ 'Y'                                       CGL007
     C           GL0090    ANDEQ'Y'                                       CGL007
     C                     MOVE 'E'       @RTCD                           CGL007
     C                     MOVE '1'       *INLR                           CGL007
     C                     RETRN                                          CGL007
     C                     END                                            CGL007
      *                                                                   CGL007
     C                     SETON                     89
     C****************     MOVEA' 021'    ERCD,Z                          E22337
     C*********************MOVEA' 020'    ERCD,Z                    E22337S01117
     C                     MOVEA' 003'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C           @GL442    IFEQ 'Y'                                       096486
     C                     MOVE 'E'       @RTCD                           096486
     C                     MOVE '1'       *INLR                           096486
     C/COPY WNCPYSRC,FT0040C137
     C                     RETRN                                          096486
     C                     END                                            096486
     C                     ELSE                            X003
      ** Access extension file when CFT014 is installed.                  CFT014
     C           CFT014    IFEQ 'Y '                                      CFT014
     C           CFT009    OREQ 'Y'                                       CFT009
     C           SPREF     CHAINOTPAYXL2             88                   CFT014
     C                     ENDIF                                          CFT014
     C*
     C* IF FULLY AUTHORISED
     C*
     C           PYTP      IFNE 'RP'                       B004
     C*
     C  N15      AUIN      IFEQ 'Y'                        B005
     C                     SETON                     2189
     C*********************MOVEA' 022'    ERCD,Z                          S01117
     C                     MOVEA' 005'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C/COPY WNCPYSRC,FT0040C253
     C                     END                             E005
     C*
     C                     END                             E004
     C*
     C                     END                             E003
     C*                                                                   S01117
     C  N88                EXCPTOUTPAY
     C                     END                             E002
      *                                                                   042167
      * Call CL program to check for other users only if                  042167
      * - action 'A' or 'D' (not 'I' as ref. then is still blank)         042167
      * - AND if program is not called from an enquiry function (as       042167
      *   allocation processing would already have been done)             042167
      *                                                                   042167
     C           ACTION    IFEQ 'A'                                       042167
     C           XPREF     ANDEQ*BLANK                                    042167
      *                                                                   042167
     C           ACTION    OREQ 'D'                                       042167
     C           XPREF     ANDEQ*BLANK                                    042167
      *                                                                   042167
     C                     MOVE *BLANKS   @RTCDE  7                       042167
     C                     MOVE 'FT'      @MODLE  2                       042167
     C                     MOVE SPREF     @TREF  15                       042167
     C                     MOVE *BLANKS   @RTINF 80                       042167
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0040CP20                                           S01408
     C*                                                                   S01408
      *                                                                   042167
     C                     CALL 'AOC8000'                                 042167
     C                     PARM           @RTCDE                          042167
     C                     PARM           @MODLE                          042167
     C                     PARM           @TREF                           042167
     C                     PARM           @RTINF                          042167
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0040CP21                                           S01408
     C*                                                                   S01408
     C                     END                                            042167
      *                                                                   042167
      *  If 'IN USE' then redisplay subfile with error message            042167
      *  for record lock                                                  042167
      *                                                                   042167
     C           @RTCDE    IFEQ '*IN USE'                                 042167
     C                     SETON                     2189                 042167
     C                     MOVEL' 600'    ERCD,Z                          042167
     C                     ADD  1         Z                               042167
     C                     END                                            042167
     C*                                                                   042167
      * If action code 'I' and FT0040 called from enquiry function,       S01435
      * use default branch                                                S01435
      *                                                                   S01435
     C           ACTION    IFEQ 'I'                                       S01435
     C           XPREF     ANDNE*BLANKS                                   S01435
     C           SBRCA     IFEQ *BLANKS                                   S01435
     C                     MOVE @DFBR     SBRCA                           S01435
     C                     END                                            S01435
     C                     END                                            S01435
      *                                                                   S01435
     C**  Use program ZVACTBU to validate whether user                    S01117
     C**  is authorised to that booking branch and menu item              S01117
     C**  (if valid branch code entered)                                  S01117
     C*                                                                   S01117
     C*                                                                   S01117
     C           *IN89     IFEQ '0'                                       S01117
     C*                                                                   S01117
     C                     Z-ADD0         ERR                             096486
     C*                                                                   S01117
     C           @MBIN     IFEQ 'Y'                                       S01117
     C           *IN56     IFEQ '0'                        B002           S01117
     C*                                                                   S01117
     C           *IN12     IFEQ '1'                                       S01117
     C                     MOVE SBRCA     @BRCD                           S01117
     C                     ELSE                                           S01117
     C                     MOVE BRCA      @BRCD                           S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C**  If FT0040 is called from GL4442, bypass validation.             096486
     C*                                                                   096486
     C/COPY WNCPYSRC,FT0040C254
     C           @GL442    IFNE 'Y'                                       096486
     C                     CALL 'ZVACTBU'                                 S01117
     C                     PARM ACTION    @ACTN   1                       S01117
     C                     PARM           @BRCD   3                       S01117
     C                     PARM 0         ERR     10                      S01117
     C                     ENDIF                                          096486
     C/COPY WNCPYSRC,FT0040C060
     C*                                                                   S01117
     C           ERR       IFEQ 1                                         S01117
     C                     SETON                     5689                 S01117
     C                     MOVEA' 303'    ERCD,Z                          S01117
     C                     ADD  1         Z                               S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C           ERR       IFEQ 2                                         S01117
     C                     SETON                     5689                 S01117
     C                     MOVEA' 304'    ERCD,Z                          S01117
     C                     ADD  1         Z                               S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C* IF MB,NOT INSERT,ERROR ON BRANCH AUTHTY SET UP BRANCH SCN FLD     S01117
     C*                                                                   S01117
     C           *IN56     IFEQ '1'                                       S01117
     C                     MOVE @BRCD     SBRCA                           S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C** If originating branch validation required,MB and                 S01117
     C** not insert,validate authority to orig branch                     S01117
     C*                                                                   S01117
     C           *IN21     IFEQ '0'                                       S01117
     C           BKOBUV    ANDEQ'Y'                                       S01117
     C           *IN12     ANDEQ'0'                                       S01117
     C                     CALL 'ZVOBU'                                   S01117
     C                     PARM ORBR      ZOBRX   3                       S01117
     C                     PARM 0         ERR                             S01117
     C*                                                                   S01117
     C           ERR       IFEQ 1                                         S01117
     C                     SETON                     2189                 S01117
     C                     MOVEA' 305'    ERCD,Z                          S01117
     C                     ADD  1         Z                               S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C           ERR       IFEQ 2                                         S01117
     C                     SETON                     2189                 S01117
     C                     MOVEA' 306'    ERCD,Z                          S01117
     C                     ADD  1         Z                               S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     END                             E002           S01117
     C*                                                                   S01117
     C** If non multi branched...                                         S01117
     C*                                                                   S01117
     C                     ELSE                            X001           S01117
     C*                                                                   S01117
     C*                                                                   096486
     C**  If FT0040 is called from GL4442, bypass validation.             096486
     C*                                                                   096486
     C/COPY WNCPYSRC,FT0040C255
     C           @GL442    IFNE 'Y'                                       096486
     C                     CALL 'ZVACTU'                                  S01117
     C                     PARM ACTION    @ZACTN  1                       S01117
     C                     PARM 0         @ERR    10                      S01117
     C                     ENDIF                                          096486
     C/COPY WNCPYSRC,FT0040C256
     C*                                                                   S01117
     C           @ERR      IFNE 0                                         S01117
     C                     SETON                     2089                 S01117
     C                     MOVEA' 302'    ERCD,Z                          S01117
     C                     ADD  1         Z                               S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     END                             E001
     C* SET UP STATUS FLAG FOR DISPLAY
     C***12******          MOVE *BLANK    STATUS                          099506
     C                     MOVE *BLANK    STATUS                          099506
     C  N12      RECI      IFEQ 'D'                        B001
     C           AUIN      IFEQ 'Y'                        B002
     C                     MOVEL'AUTHORIZ'STATUS
     C                     MOVE 'ED'      STATUS
     C                     ELSE                            X002
     C                     MOVE *BLANK    STATUS
     C                     END                             E002
     C                     ELSE                            X001
     C           RECI      IFEQ 'M'                        B002
     C                     MOVEL'MATURED' STATUS
     C                     ELSE                            X002
     C           RECI      IFEQ 'C'                        B003
     C                     MOVEL'DELETED' STATUS
     C                     ELSE                            X003
     C                     MOVE *BLANK    STATUS
     C                     END                             E003
     C                     END                             E002
     C                     END                             E001
      *                                                                   S01408
     C/COPY WNCPYSRC,FT0040CVKS                                           S01408
      *                                                                   S01408
     C*                                                                   S01117
     C*IF NO ERRORS SET UP SCREEN BRANCH FIELD                            S01117
     C*                                                                   S01117
     C           @MBIN     IFEQ 'Y'                                       S01117
     C           *IN89     ANDEQ'0'                                       S01117
     C                     MOVE @BRCD     SBRCA                           S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     ENDSR
     C*
     C************************************************************
     C* END OF VALIDATION OF SCREEN ONE
     C************************************************************
     C/EJECT
     C************************************************************
     C* SCRN2 SR.
     C* DISPLAY SCREEN TO AND EXECUTE VALIDATION
     C*
     C           SCRN2     BEGSR
     C/COPY WNCPYSRC,FT0040C098
      *                                                                   S01435
      * Initialise no update indicator, re-display, warning array         S01435
      * and warning message sent                                          S01435
      *                                                                   S01435
     C                     MOVEL*BLANKS   FTNOUP                          S01435
     C                     MOVEL*BLANKS   FTRSND                          S01435
     C                     MOVEL*BLANKS   FTWARN  1                       S01435
     C                     MOVEL*BLANKS   WRN@                            S01435
     C*
     C**KEEP*SCREEN*UNTIL*F3,*F12*OR*INVALID*UPDATE                       S01194
     C* Keep screen until F3, F12 F7 invalid update & FQRY not used       S01194
     C           *IN01     DOUEQ'1'                        B001
     C           *IN02     OREQ '1'
     C           *IN05     OREQ '1'
     C           *IN07     OREQ '1'                                       E29970
     C           *IN89     OREQ '0'
     C           *IN87     ANDEQ'0'                                       133420
     C           *IN06     ANDEQ'0'                                       S01494
     C           *IN62     ANDEQ'0'                                       S01194
     C           FTNOUP    ANDEQ*BLANKS                                   S01435
     C* IF AMEND AND LEVEL 1 INCOMPLETE ALLOW AMENDMENT OF SETTLEMENT
     C* TYPE
     C   13      LVL1      COMP 'N'                      16
      *
      * On an AMEND and if the payment has been generated from an
      * Incoming payment -
      *
     C           OPIN      IFEQ 'Y'
     C           *IN13     ANDEQ'1'
      *
      * Protect amount and currency fields on screen so that they may
      * not be changed if the payment has been generated from an I/P
      *
     C                     SETON                     17
     C                     ELSE                                           033695
     C                     SETOF                     17                   033695
     C                     END
      *                                                                   CEU006
      ** If amend and originally a Swift message then allow edit          CEU006
      ** of notified delivery fields                                      CEU006
      *                                                                   CEU006
     C           *IN13     IFEQ *ON                                       CEU006
     C           OPMSGR    ANDNE0                                         CEU006
     C                     MOVE *ON       *IN47                           CEU006
     C                     ENDIF                                          CEU006
      *                                                                   CEU006
     C*
     C***PROTECT*SUBTYPE*IF*OP*IS*NOT*GENERATED*FROM*INCOMING*PAYMENT*    041634
     C***(WHEN AMEND)*                                                    041634
     C*                                                                   041634
     C************IN13     IFEQ '1'                                       041634
     C***********PYST      ANDNE*BLANKS                                   041634
     C***********          SETON                     18                   041634
     C***********          ELSE                                           041634
     C***********          SETOF                     18                   041634
     C***********          END                                            041634
     C*                                                                   041634
     C**IF CALLED FROM SUB-FILE ENQUIRY PROGRAM ENABLE F7                 E29970
     C           XPREF     IFNE *BLANKS                                   E29970
     C           @GL442    ANDNE'Y'                                       096486
     C                     SETON                     19                   E29970
     C                     END                                            E29970
     C/COPY WNCPYSRC,FT0040C092
     C           XPREF     IFNE *BLANKS                                   CGL007
     C           CGL007    ANDEQ'Y'                                       CGL007
     C           GL0090    ANDEQ'Y'                                       CGL007
     C                     MOVE *OFF      *IN19                           CGL007
     C                     END                                            CGL007
      *                                                                   S01435
      * If action code 'I' and FT0040 called from enquiry function        S01435
      * (XPREF filled with message ref.), than allow validation of        S01435
      * Booking Branch on detail screen.                                  S01435
      *                                                                   S01435
     C           ACTION    IFEQ 'I'                                       S01435
     C           XPREF     ANDNE*BLANKS                                   S01435
     C                     SETON                     61                   S01435
     C                     END                                            S01435
      *                                                                   S01435
     C/COPY WNCPYSRC,FT0040C066
      * Display message subfile                                           S01435
      *                                                                   S01435
     C                     MOVEL'1'       *IN79                           S01435
     C                     MOVEL*BLANKS   FTWARN                          S01435
     C/COPY WNCPYSRC,FT0040C257
     C                     WRITE#MSGCTL                                   S01435
     C/COPY WNCPYSRC,FT0040C258
     C*                                                                   079909
     C* IF ERROR CODES ARRRAY IS NOT BLANK, SET ON *IN81 TO DISPLAY       079909
     C           Z         IFGT 1                                         079909
     C                     SETON                     81                   079909
     C                     ELSE                                           079909
     C                     SETOF                     81                   079909
     C                     END                                            079909
     C*
     C           CFT007    IFEQ 'CFT007'                                  CFT007
     C           ACTION    ANDEQ'I'                                       CFT007
     C           CFT007    OREQ 'CFT007'                                  CFT007
     C           ACTION    ANDEQ'A'                                       CFT007
     C                     MOVE *ON       *IN83                           CFT007
     C                     ELSE                                           CFT007
     C                     MOVE *OFF      *IN83                           CFT007
     C                     ENDIF                                          CFT007
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0040CP26                                           S01408
     C*                                                                   S01408
     C           CSW203    IFEQ 'Y'                                                           CSW203
     C                     MOVE *ON       *IN71                                               CSW203
     C                     ELSE                                                               CSW203
     C                     MOVE *OFF      *IN71                                               CSW203
     C                     ENDIF                                                              CSW203
     C                     WRITEFT0040F2                   SCREEN 2
     C/COPY WNCPYSRC,FT0040C290
     C* LOOP FOR HELP REDISPLAY
     C**         *IN11     DOUEQ'0'                        B002           S01199
     C                     READ FT0040F2                 88SCREEN 2
     C/COPY WNCPYSRC,FT0040C048
      *                                                                   S01435
      * Clear message subfile                                             S01435
      *                                                                   S01435
     C                     CALL 'Y2CLMSC'                                 S01435
     C                     PARM ##PGM     FTPGMQ 10                       S01435
     C                     PARM '*SAME'   FTPGRL  5                       S01435
     C/COPY WNCPYSRC,FT0040C259
      *                                                                   S01435
      * Reset message sent flag and warning flag                          S01435
      *                                                                   S01435
     C                     MOVEL'N'       FTMSGS  1                       S01435
     C                     MOVEL*BLANKS   FTWARN                          S01435
     C                     MOVEL*BLANKS   FTNOUP                          S01435
     C/COPY WNCPYSRC,FT0040C117
      *                                                                   S01435
     C** 11                EXSR HELP                       HELP           S01199
     C**                   END                             E002           S01199
     C**N01N05*************DO                              B002           E29970
     C  N01N05N07          DO                              B002           E29970
     C  N14N15             DO                              B003
     C/COPY WNCPYSRC,FT0040C053
     C*                                                                   S01194
      * BIC Database update prompt and search processing                  CFT007
      *                                                                   CFT007
      * If F4 or F16 is pressed                                           CFT007
      *                                                                   CFT007
     C           *INKD     IFEQ *ON                                       CFT007
     C           *INKQ     OREQ *ON                                       CFT007
      *                                                                   CFT007
      * Redisplay screen after BIC processing                             CFT007
      *                                                                   CFT007
     C                     MOVE 'Y'       FTNOUP                          CFT007
     C*                                                                   CFT007
     C* Determine whether cursor is on an allowed field                   CFT007
     C*                                                                   CFT007
     C                     Z-ADD@#RWCL    WKSCPS  50                      CFT007
      *                                                                   CFT007
      * Note: If these screen fields move then these values will          CFT007
      *       need changing.                                              CFT007
      *                                                                   CFT007
      *       The value is cursor row number * 256 + column number        CFT007
      *                                                                   CFT007
      * Destination line 1                                                CFT007
      *                                                                   CFT007
     C                     MOVE *OFF      LINE1D  1                       CFT007
     C           WKSCPS    IFGE 1794                                      CFT007
     C           WKSCPS    ANDLE1828                                      CFT007
     C                     MOVE *ON       LINE1D                          CFT007
     C                     ENDIF                                          CFT007
     C*                                                                   CFT007
     C* Destination line 2                                                CFT007
     C*                                                                   CFT007
     C                     MOVE *OFF      LINE2D  1                       CFT007
     C           WKSCPS    IFGE 1837                                      CFT007
     C           WKSCPS    ANDLE1871                                      CFT007
     C                     MOVE *ON       LINE2D                          CFT007
     C                     ENDIF                                          CFT007
     C*                                                                   CFT007
     C* Ordering customer line 1                                          CFT007
     C*                                                                   CFT007
     C                     MOVE *OFF      LINE1O  1                       CFT007
     C           WKSCPS    IFGE 2562                                      CFT007
     C           WKSCPS    ANDLE2596                                      CFT007
     C                     MOVE *ON       LINE1O                          CFT007
     C                     ENDIF                                          CFT007
     C*                                                                   CFT007
     C* Ordering customer line 2                                          CFT007
     C*                                                                   CFT007
     C                     MOVE *OFF      LINE2O  1                       CFT007
     C           WKSCPS    IFGE 2605                                      CFT007
     C           WKSCPS    ANDLE2639                                      CFT007
     C                     MOVE *ON       LINE2O                          CFT007
     C                     ENDIF                                          CFT007
     C*                                                                   CFT007
     C* If cursor is not on an allowed field, error                       CFT007
     C*                                                                   CFT007
     C           LINE1D    IFNE *ON                                       CFT007
     C           LINE2D    ANDNE*ON                                       CFT007
     C           LINE1O    ANDNE*ON                                       CFT007
     C           LINE2O    ANDNE*ON                                       CFT007
     C*                                                                   CFT007
     C* Error message:                                                    CFT007
     C                     MOVEL'FTM2614' FTMSID                          CFT007
     C                     EXSR FTSNMS                                    CFT007
     C*                                                                   CFT007
     C                     ELSE                                           CFT007
     C*                                                                   CFT007
     C* In-line prompt mode, capture search criteria from screen field    CFT007
     C*                                                                   CFT007
     C           *INKD     IFEQ *ON                        111            CFT007
     C                     MOVE 'P'       @IMODE                          CFT007
      *                                                                   CFT007
     C           LINE1D    IFEQ *ON                                       CFT007
     C                     MOVE SDST1     @ICRIT                          CFT007
     C                     ENDIF                                          CFT007
      *                                                                   CFT007
     C           LINE2D    IFEQ *ON                                       CFT007
     C                     MOVE SDST2     @ICRIT                          CFT007
     C                     ENDIF                                          CFT007
      *                                                                   CFT007
     C           LINE1O    IFEQ *ON                                       CFT007
     C                     MOVE SORC1     @ICRIT                          CFT007
     C                     ENDIF                                          CFT007
      *                                                                   CFT007
     C           LINE2O    IFEQ *ON                                       CFT007
     C                     MOVE SORC2     @ICRIT                          CFT007
     C                     ENDIF                                          CFT007
      *                                                                   CFT007
     C                     ENDIF                                          CFT007
     C*                                                                   CFT007
     C* In-line search mode, capture search criteria from screen field    CFT007
     C*                                                                   CFT007
     C           *INKQ     IFEQ *ON                                       CFT007
     C                     MOVE 'F'       @IMODE                          CFT007
      *                                                                   CFT007
     C           LINE1D    IFEQ *ON                                       CFT007
     C                     MOVE SDST1     @ICRIT                          CFT007
     C                     ENDIF                                          CFT007
      *                                                                   CFT007
     C           LINE2D    IFEQ *ON                                       CFT007
     C                     MOVE SDST2     @ICRIT                          CFT007
     C                     ENDIF                                          CFT007
      *                                                                   CFT007
     C           LINE1O    IFEQ *ON                                       CFT007
     C                     MOVE SORC1     @ICRIT                          CFT007
     C                     ENDIF                                          CFT007
      *                                                                   CFT007
     C           LINE2O    IFEQ *ON                                       CFT007
     C                     MOVE SORC2     @ICRIT                          CFT007
     C                     ENDIF                                          CFT007
      *                                                                   CFT007
     C                     ENDIF                                          CFT007
     C*                                                                   CFT007
     C* Call BIC Plus enquiry program                                     CFT007
     C*                                                                   CFT007
     C                     CALL 'FT0900'                                  CFT007
     C                     PARM           @IMODE  1                       CFT007
     C                     PARM           @ICRIT 35                       CFT007
     C                     PARM *BLANKS   @OADD 175                       CFT007
     C                     PARM *BLANKS   @OCHIP 10                       CFT007
     C                     PARM *BLANKS   @OUTCD  2                       CFT007
     C                     PARM *BLANKS   @ORTCD  7                       CFT007
     C                     MOVEL*BLANKS   @ICRIT                          CFT007
      *                                                                   CFT007
      *  F3 pressed - exit program                                        CFT007
      *                                                                   CFT007
     C           @ORTCD    IFEQ 'F3'                                      CFT007
     C                     MOVEL'Y'       FTNOUP                          CFT007
     C                     MOVE *ON       *IN01                           CFT007
     C                     END                                            CFT007
      *                                                                   CFT007
     C           @ORTCD    IFEQ *BLANKS                                   CFT007
      *                                                                   CFT007
      * If a CHIPS code exists and relevant currency is USD, replace      CFT007
      * clearing code with CHIPS code                                     CFT007
      *                                                                   CFT007
     C           @OCHIP    IFNE *BLANKS                                   CFT007
     C           @OUTCD    ANDNE'AC'                                      CFT007
      *                                                                   CFT007
     C           SSMCY     IFEQ BLUSCY                                    CFT007
     C           LINE1O    ANDEQ*ON                                       CFT007
     C           SPCCY     OREQ BLUSCY                                    CFT007
     C           LINE1D    ANDEQ*ON                                       CFT007
     C*                                                                   CFT007
      * If clearing code is not present, move details down to             CFT007
      * create space for CHIPS code                                       CFT007
      *                                                                   CFT007
     C           @OUTCD    IFNE 'BC'                                      CFT007
     C           @OUTCD    ANDNE'DC'                                      CFT007
     C                     MOVE @OADD     WKADD1210                       CFT007
     C                     MOVELWKADD1    @OADD                           CFT007
     C                     ENDIF                                          CFT007
     C*                                                                   CFT007
     C                     MOVEL*BLANKS   WKCOCH 14                       CFT007
     C                     MOVEL*BLANKS   OADD1                           CFT007
     C                     MOVEL'//CH'    WKCOCH                          CFT007
     C                     MOVE @OCHIP    WKCOCH                          CFT007
     C                     MOVELWKCOCH    OADD1                           CFT007
     C                     ENDIF                                          CFT007
     C*                                                                   CFT007
     C                     ENDIF                                          CFT007
     C*                                                                   CFT007
      * If command key pressed on 2nd line, remove clearing               CFT007
      * code from details                                                 CFT007
     C*                                                                   CFT007
     C           LINE2D    IFEQ *ON                                       CFT007
     C           @OUTCD    ANDEQ'BC'                                      CFT007
     C           LINE2D    OREQ *ON                                       CFT007
     C           @OUTCD    ANDEQ'DC'                                      CFT007
     C           LINE2O    OREQ *ON                                       CFT007
     C           @OUTCD    ANDEQ'BC'                                      CFT007
     C           LINE2O    OREQ *ON                                       CFT007
     C           @OUTCD    ANDEQ'DC'                                      CFT007
     C           @OUTCD    OREQ 'AC'                                      CFT007
     C                     MOVE @OADD     WKADD2140                       CFT007
     C                     MOVE *BLANKS   @OADD                           CFT007
     C                     MOVELWKADD2    @OADD                           CFT007
     C                     ENDIF                                          CFT007
     C*                                                                   CFT007
      * Move details to screen                                            CFT007
      *                                                                   CFT007
     C           LINE1D    IFEQ *ON                                       CFT007
     C                     MOVELOADD1     SDST1                           CFT007
     C                     MOVELOADD2     SDST2                           CFT007
     C                     MOVELOADD3     SDST3                           CFT007
     C                     MOVELOADD4     SDST4                           CFT007
     C                     ENDIF                                          CFT007
     C*                                                                   CFT007
     C           LINE1O    IFEQ *ON                                       CFT007
     C                     MOVELOADD1     SORC1                           CFT007
     C                     MOVELOADD2     SORC2                           CFT007
     C                     MOVELOADD3     SORC3                           CFT007
     C                     MOVELOADD4     SORC4                           CFT007
     C                     ENDIF                                          CFT007
     C*                                                                   CFT007
     C           LINE2D    IFEQ *ON                                       CFT007
     C                     MOVELOADD1     SDST2                           CFT007
     C                     MOVELOADD2     SDST3                           CFT007
     C                     MOVELOADD3     SDST4                           CFT007
     C                     ENDIF                                          CFT007
     C*                                                                   CFT007
     C           LINE2O    IFEQ *ON                                       CFT007
     C                     MOVELOADD1     SORC2                           CFT007
     C                     MOVELOADD2     SORC3                           CFT007
     C                     MOVELOADD3     SORC4                           CFT007
     C                     ENDIF                                          CFT007
     C*                                                                   CFT007
     C                     ENDIF                                          CFT007
     C*                                                                   CFT007
     C                     ENDIF                                          CFT007
     C*                                                                   CFT007
     C                     ENDIF                                          CFT007
     C*                                                                   CFT007
     C**************************************                              S01194
     C*   RESOLVE ?'S BEFORE VALIDATION    *                              S01194
     C**************************************                              S01194
     C                     EXSR FQRY2                                     S01194
     C*                                                                   S01194
     C*00/Copy member FT0040INAR - INITIALISE ARRAYS                      S01435
     C/COPY WNCPYSRC,FT0040INAR                                           S01435
     C                     EXSR VALTWO                     VALIDATE
     C/COPY WNCPYSRC,FT0040C067
     C* CHECK IF WARNING ERROR                                            E32543
     C           *IN72     IFEQ '1'                                       E32543
     C* IF ENTER PRESSED AND FIELDS UNCHANGED ASSUME ACCEPTANCE           E32543
     C           *IN68     IFEQ '1'                                       E32543
     C           *IN30     IFEQ '1'                                       E32543
     C           PYDT      ANDEQSLDTO                                     E32543
     C                     MOVEL'Y'       FTRSND                          081663
     C***********          SETOF                     30            E32543 074811
     C                     SUB  1         Z                               E32543
     C                     END                                            E32543
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0040CP12                                           S01408
     C*                                                                   S01408
     C           *IN36     IFEQ '1'                                       E32543
     C           PYVD      ANDEQPVDTO                                     E32543
     C                     MOVEL'Y'       FTRSND                          081663
     C***********          SETOF                     36            E32543 074811
     C                     SUB  1         Z                               E32543
     C                     END                                            E32543
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0040CP13                                           S01408
     C*                                                                   S01408
     C           *IN66     IFEQ '1'                                       E32543
     C           FIND      ANDEQFDATO                                     E32543
     C                     MOVEL'Y'       FTRSND                          081663
     C***********          SETOF                     66            E32543 074811
     C                     SUB  1         Z                               E32543
     C                     END                                            E32543
     C           *IN67     IFEQ '1'                                       E32543
     C           NDAT      ANDEQNPDTO                                     E32543
     C                     MOVEL'Y'       FTRSND                          081663
     C***********          SETOF                     67            E32543 074811
     C                     SUB  1         Z                               E32543
     C                     END                                            E32543
     C           *IN24     IFEQ '1'                                       E32543
     C           DESTAN    ANDEQDESTO                                     E32543
     C                     MOVEL'Y'       FTRSND                          081663
     C***********          SETOF                     24            E32543 074811
     C                     SUB  1         Z                               E32543
     C                     END                                            E32543
      *                                                                                       CRE008
     C           *LIKE     DEFN SORC1     PSORC1                                              CRE008
     C           *LIKE     DEFN SSMAM     PSSMAM                                              CRE008
     C           *IN25     IFEQ '1'                                                           CRE008
     C           *IN28     ANDEQ'1'                                                           CRE008
     C           SORC1     ANDEQPSORC1                                                        CRE008
     C           SSMAM     ANDEQPSSMAM                                                        CRE008
     C                     MOVEL'Y'       FTRSND                                              CRE008
     C                     MOVE '0'       *IN25                                               CRE008
     C                     MOVE '0'       *IN28                                               CRE008
     C                     ENDIF                                                              CRE008
      *                                                                                       CRE008
     C           PYDT      IFEQ SLDTO                                     E32543
     C           PYVD      ANDEQPVDTO                                     E32543
     C           FIND      ANDEQFDATO                                     E32543
     C           NDAT      ANDEQNPDTO                                     E32543
     C           DESTAN    ANDEQDESTO                                     E32543
     C           Z         ANDEQ1                                         074811
     C           SORC1     ANDEQPSORC1                                                        CRE008
     C           SSMAM     ANDEQPSSMAM                                                        CRE008
     C                     SETOF                     6872                 E32543
     C                     SETOF                     243036               074811
     C                     SETOF                     6667                 074811
     C                     ELSE                                           E32543
     C                     MOVE PYDT      SLDTO                           E32543
     C                     MOVE PYVD      PVDTO                           E32543
     C                     MOVE FIND      FDATO                           E32543
     C                     MOVE NDAT      NPDTO                           E32543
     C                     MOVE DESTAN    DESTO                           E32543
     C                     MOVE SORC1     PSORC1                                              CRE008
     C                     MOVE SSMAM     PSSMAM                                              CRE008
     C                     END                                            E32543
     C* ASSUME FIRST DISPLAY OF WARNING ERROR                             E32543
     C                     ELSE                                           E32543
     C                     SETON                     68                   E32543
     C                     MOVE PYDT      SLDTO   6                       E32543
     C                     MOVE PYVD      PVDTO   6                       E32543
     C                     MOVE FIND      FDATO   6                       E32543
     C                     MOVE NDAT      NPDTO   6                       E32543
     C                     MOVE DESTAN    DESTO 140                       E32543
     C                     MOVE SORC1     PSORC1                                              CRE008
     C                     MOVE SSMAM     PSSMAM                                              CRE008
     C                     END                                            E32543
     C                     END                                            E32543
     C/COPY WNCPYSRC,FT0040C099
     C**CHECK*IF*WARNING*ERROR**                                          E32543
     C************IN47*****IFEQ '1'                        B004           E32543
     C**IF*ENTERED*PRESS*AND*FIELDS*UNCHANGED*ASSUME*ACCEPTANCE*          E32543
     C************IN48*****IFEQ '1'                        B005           E32543
     C***********Z*********ANDLT3                                         E32543
     C***********DESTAN****ANDEQDESTO                                     E32543
     C*********************SETOF                     244748               E32543
     C*********************SETOF                     89                   E32543
     C*********************MOVEA*BLANK    ERCD                            E32543
     C*********************Z-ADD1         Z                               E32543
     C**ASSUME*FIRST*DISPLAY*OF*WARNING*ERROR*                            E32543
     C*********************ELSE                            X005           E32543
     C*********************SETON                     48                   E32543
     C*********************MOVE DESTAN    DESTO 140                       E32543
     C*********************END                             E005           E32543
     C*********************END                             E004           E32543
     C*                                                                   E32543
     C           Z         IFEQ 1                                         E32543
     C           RESULT    ANDEQ0                                         140640
     C           EUX       ANDEQ'Y'                                       140640
     C           PHW       IFEQ *ZERO                                     CFT014
     C/COPY WNCPYSRC,FT0040C274
     C                     SETOF                     89                   140640
     C                     ENDIF                                          CFT014
     C***********          SETOF                     89             E32543079909
     C                     MOVEA*BLANK    ERCD                            E32543
     C                     END                                            E32543
     C/COPY WNCPYSRC,FT0040C275
     C*                                                                   E32543
     C                     END                             E003
     C/COPY WNCPYSRC,FT0040C119
      *                                                                   S01435
      *  If warning sent with no errors allow update                      S01435
      *                                                                   S01435
     C           *IN89     IFEQ '0'                                       S01435
     C           FTWARN    IFEQ 'Y'                                       S01435
     C           FTRSND    ANDEQ*BLANKS                                   S01435
     C           FTNOUP    ANDEQ*BLANKS                                   S01435
     C                     MOVEL'Y'       FTRSND                          S01435
     C                     MOVEL'Y'       FTNOUP  1                       S01435
     C                     END                                            S01435
     C                     ELSE                                           S01435
     C                     MOVEL*BLANKS   FTRSND  1                       S01435
     C                     END                                            S01435
      *                                                                   CAC001
      **  If Analytical Accounting is installed, in amend mode,           CAC001
      **  ENTER was pressed, FQRY not used, no errors, update             CAC001
      **  is allowed, either currencies, rate or amounts were             CAC001
      **  changed, and there is a margin info, call window pgm            CAC001
      *                                                                   CAC001
     C           BGWDPR    IFEQ 'Y'                        B003           CAC001
     C           BGN0ST    ANDEQ'Y'                                       CAC001
     C           *IN13     ANDEQ'1'                                       CAC001
     C           *IN62     ANDEQ'0'                                       CAC001
     C           *IN89     ANDEQ'0'                                       CAC001
     C           FTNOUP    ANDEQ*BLANKS                                   CAC001
      *                                                                   CAC001
     C           SSMCY     IFNE OSMCY                      B004           CAC001
     C           SPCCY     ORNE OPCCY                                     CAC001
     C           SMAMA     ORNE SMAMAO                                    CAC001
     C           PYAMA     ORNE PYAMAO                                    CAC001
     C           RATEA     ORNE RATEAO                                    CAC001
      *                                                                   CAC001
      ** If margin information details exist, set up call to window       CAC001
      *                                                                   CAC001
     C           W3MBSI    IFNE *BLANKS                    B005           CAC001
     C           W3MSIG    ORNE *BLANKS                                   CAC001
      *                                                                   CAC001
     C                     MOVE 'KT'      KEY                             CAC001
     C                     MOVE ACTION    ACTN                            CAC001
     C                     MOVE ACTION    WACTN                           CAC001
     C                     Z-ADDSRATE     WRATE                           CAC001
     C                     MOVE 'P'       WPSIN                           CAC001
     C                     MOVE SPCCY     WPCCY                           CAC001
     C                     MOVE SSMCY     WSMCY                           CAC001
     C                     Z-ADDSPYAM     WPYAM                           CAC001
     C                     Z-ADDSSMAM     WSMAM                           CAC001
     C                     Z-ADDSMDIN     WMDIN                           CAC001
     C                     Z-ADDW3FXMP    WFXMP                           CAC001
     C                     Z-ADDW3FXMD    WFXMD                           CAC001
     C                     MOVE W3MBSI    WMBSI                           CAC001
     C                     MOVE W3MSIG    WMSIG                           CAC001
     C                     Z-ADDW3MAMT    WMAMT                           CAC001
     C                     MOVE 'Y'       WFRCI                           CAC001
      *                                                                   CAC001
      ** If record id is not 'D', change value of action parameter        CAC001
      ** sent as 'E' as no changes are allowed for matured/authorised     CAC001
      ** deals for amend mode                                             CAC001
      *                                                                   CAC001
     C           ACTION    IFEQ 'A'                        B006           CAC001
     C           RECI      ANDNE'D'                                       CAC001
     C                     MOVE 'E'       ACTN                            CAC001
     C                     ENDIF                           E006           CAC001
      *                                                                   CAC001
      **  Call window manager WN0010                                      CAC001
      *                                                                   CAC001
     C/COPY WNCPYSRC,FT0040C105
     C                     CALL 'WN0010'                                  CAC001
     C                     PARM 'FT0040'  #PGM   10                       CAC001
     C                     PARM           KEY     2                       CAC001
     C                     PARM           ACTN    1                       CAC001
     C                     PARM           DATA                            CAC001
     C                     PARM *BLANK    #RTRN   7                       CAC001
     C                     PARM           SPAREE256                       CAC001
      *                                                                   CAC001
      **  Check  return code. Return code is *User QUIT requested         CAC001
     C/COPY WNCPYSRC,FT0040C107
      *                                                                   CAC001
     C           #RTRN     IFEQ 'Y2U9999'                  B006           CAC001
     C                     MOVE '1'       *IN01                           CAC001
     C                     MOVE 'Y'       FTNOUP                          CAC001
     C                     ENDIF                           E006           CAC001
      *                                                                   CAC001
     C           #RTRN     IFNE *BLANK                     B006           CAC001
     C                     CALL 'SNDERMSG'                                CAC001
     C                     PARM 'FT0040'  ZAPGM  10        Program queue  CAC001
     C                     PARM           ZAPGRL  5        Rel queue      CAC001
     C                     PARM #RTRN     ZAMSID  7        Msg Id.        CAC001
     C                     PARM 'WNMSGF'  ZAMSGF 10        Msg file.      CAC001
     C                     PARM           ZAMSDA132        Message data.  CAC001
     C                     PARM           ZAMSTP  7        Message type.  CAC001
      *                                                                   CAC001
      **  Clear all fields                                                CAC001
      *                                                                   CAC001
     C                     MOVEL*BLANK    ZAPGM            Program queue  CAC001
     C                     MOVEL*BLANK    ZAPGRL           Rel queue      CAC001
     C                     MOVEL*BLANK    ZAMSID           Message Id.    CAC001
     C                     MOVEL*BLANK    ZAMSGF           Message file.  CAC001
     C                     MOVEL*BLANK    ZAMSDA           Message data.  CAC001
     C                     MOVEL*BLANK    ZAMSTP           Message type.  CAC001
     C                     MOVE 'Y'       FTNOUP                          CAC001
      *                                                                   CAC001
      **  If ENTER pressed from window, update margin info work fields    CAC001
      *                                                                   CAC001
     C                     ELSE                                           CAC001
     C                     Z-ADDWFXMP     W3FXMP                          CAC001
     C                     Z-ADDWFXMD     W3FXMD                          CAC001
     C                     MOVELWMBSI     W3MBSI                          CAC001
     C                     MOVELWMSIG     W3MSIG                          CAC001
     C                     Z-ADDWMAMT     W3MAMT                          CAC001
     C                     MOVEL*BLANKS   FTNOUP                          CAC001
     C                     ENDIF                           E006           CAC001
     C                     ENDIF                           E005           CAC001
     C                     ENDIF                           E004           CAC001
     C                     ENDIF                           E003           CAC001
      *                                                                   S01435
     C*                                                                   S01408
     C** Core hook for externalisation.                                   S01408
     C/COPY WNCPYSRC,FT0040CL1W                                           S01408
     C*                                                                   S01408
     C* IF DELETION AND F10 NOT PRESSED CHANGE TO ENQUIRY
     C  N04 14             MOVEA'01'      *IN,14
     C**IF*NOT*ENQUIRY*AND*VALID*UPDATE*FILES                             S01194
     C* IF NOT ENQUIRY AND VALID AND FQRY NOT USED UPDATE FILES           S01194
     C**N89N15*************EXSR UPDATE                     UPDATE         S01194
     C           FTNOUP    IFEQ ' '                                       S01435
     C/COPY WNCPYSRC,FT0040C100
     C**N89N15N62          EXSR UPDATE                     UPDATE  S01194 133420
     C  N89N15N62                                                         133420
     CANN87                EXSR UPDATE                                    133420
     C/COPY WNCPYSRC,FT0040C101
     C                     END                                            S01435
     C                     END                             E002
     C*                                                                   S01494
     C** If in the enquiry mode F21 is pressed, process the display       S01494
     C** of the additional information                                    S01494
     C*                                                                   S01494
     C           *IN06     IFEQ '1'                                       S01494
     C                     EXSR #LADDI                                    S01494
     C                     END                                            S01494
     C/COPY WNCPYSRC,FT0040C072
     C                     END                             E001
     C*                                                                   S01408
     C** Core hook for externalisation.                                   S01408
     C/COPY WNCPYSRC,FT0040CL1E                                           S01408
     C*                                                                   S01408
      *                                                                   S01435
      * Reinitialise re-display field                                     S01435
      *                                                                   S01435
     C                     MOVEL*BLANKS   FTRSND                          S01435
     C                     MOVEL*BLANKS   WRN@                            S01435
      *                                                                   S01435
     C/COPY WNCPYSRC,FT0040C260
      * Clear message subfile                                             S01435
      *                                                                   S01435
     C                     CALL 'Y2CLMSC'                                 S01435
     C                     PARM ##PGM     FTPGMQ 10                       S01435
     C                     PARM '*SAME'   FTPGRL  5                       S01435
     C/COPY WNCPYSRC,FT0040C261
     C*
     C                     ENDSR
     C*
     C************************************************************
     C* END OF SCREEN TWO SUBROUTINE
     C************************************************************
     C/EJECT
     C************************************************************
     C           FQRY2     BEGSR                                          S01194
      *----------------------------------------------------------------   S01194
      * Subroutine to resolve entry of ? for standing data fields.        S01194
      * Performed after function key validation and prior to field        S01194
      * validation for screen 2.                                          S01194
      *                                                                   S01194
      * Indicators used:                                                  S01194
      *  62       on then redisplay screen                                S01194
      *  63       used in LOKUP, on if ? found                            S01194
      *----------------------------------------------------------------   S01194
     C                     SETOF                     62                   S01194
      *                                                                   S01435
      *blank out Booking Branch selection work field                      S01435
     C                     MOVE *BLANKS   BRSEL                           S01435
      *                                                                   S01435
      * check branch for entry of ?                                       S01435
     C                     MOVEA*BLANKS   FLDQ                            S01435
     C                     MOVELSBRCA     FLDQ                            S01435
     C                     SETOF                     63                   S01435
     C           '?'       LOKUPFLDQ                     63               S01435
      *                                                                   S01435
      * if ? found seton redisplay ind and call access program            S01435
     C           *IN63     IFEQ '1'                                       S01435
     C                     SETON                     62                   S01435
     C**********           CALL 'AOBRCHR0'                                             S01435 CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM *BLANKS   RTCD                            S01435
     C                     PARM '*KEY   ' @OPTN   7                       S01435
     C                     PARM '?'       @BRCD   3                       S01435
     C********** SDBRCH    PARM SDBRCH    DSFDY                                        S01435 CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
      *                                                                   S01435
      * if selection made move value to screen field                      S01435
     C           RTCD      IFEQ *BLANKS                                   S01435
     C                     MOVELA8BRCD    SBRCA                           S01435
     C                     ELSE                                           S01435
     C                     MOVEL'NOSEL'   BRSEL   5                       S01435
     C                     MOVEL*BLANKS   SBRCA                           S01435
     C                     END                                            S01435
      *                                                                   S01435
     C                     END                                            S01435
     C*                                                                   S01135
     C*BLANK OUT ORIGINATING BRANCH SELECTION WORK FLD                    S01194
     C*                                                                   S01194
     C                     MOVE *BLANKS   ORSEL   5                       S01194
      *                                                                   S01194
      * check branch for entry of ?                                       S01194
     C                     MOVEA*BLANKS   FLDQ                            S01194
     C                     MOVEASORBR     FLDQ                            S01194
     C                     SETOF                     63                   S01194
     C           '?'       LOKUPFLDQ                     63               S01194
      *                                                                   S01194
      * if ? found seton redisplay ind and call access program            S01194
     C           *IN63     IFEQ '1'                                       S01194
     C                     SETON                     62                   S01194
     C*                                                                   S01194
     C** If command 3 pressed blank out orig branch field                 S01194
     C*                                                                   S01194
     C**********           CALL 'AOBRCHR0'                                             S01194 CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM *BLANKS   RTCD                            S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM '?'       @BRCD                           S01194
     C********** SDBRCH    PARM SDBRCH    DSFDY                                        S01194 CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
      *                                                                   S01194
      * if selection made move value to screen field                      S01194
     C           RTCD      IFEQ *BLANKS                                   S01194
     C                     MOVELA8BRCD    SORBR                           S01194
     C                     ELSE                                           S01194
     C                     MOVEL'NOSEL'   ORSEL                           S01194
     C                     MOVEL*BLANKS   SORBR                           S01194
     C                     END                                            S01194
      *                                                                   S01194
     C                     END                                            S01194
      * check payment sub-type for entry of ?                             S01194
      *                                                                   S01194
     C                     MOVEA*BLANKS   FLDQ                            S01194
     C                     MOVEASPYST     FLDQ                            S01194
     C                     SETOF                     63                   S01194
     C           '?'       LOKUPFLDQ                     63               S01194
      *                                                                   S01194
      * if ? found seton redisplay ind and call access program            S01194
     C           *IN63     IFEQ '1'                                       S01194
     C                     SETON                     62                   S01194
     C                     CALL 'AODLSTR0'                                S01194
     C                     PARM *BLANKS   RTCD                            S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM '?'       @DSTC   2                       S01194
     C           SDDLST    PARM SDDLST    DSFDY                           S01194
      *                                                                   S01194
      * if selection made move value to screen field                      S01194
     C           RTCD      IFEQ *BLANKS                                   S01194
     C                     MOVELASDSTC    SPYST                           S01194
     C                     ELSE                                           S01194
     C                     MOVEL*BLANKS   SPYST                           S01194
     C                     END                                            S01194
      *                                                                   S01194
     C                     END                                            S01194
      *                                                                   S01194
      *                                                                   S01194
      * check for entry of ? in settle currency field                     S01194
     C                     MOVEA*BLANKS   FLDQ                            S01194
     C                     MOVEASSMCY     FLDQ                            S01194
     C                     SETOF                     63                   S01194
     C           '?'       LOKUPFLDQ                     63               S01194
      *                                                                   S01194
      * if ? found seton redisplay ind and call access program            S01194
     C           *IN63     IFEQ '1'                                       S01194
     C                     SETON                     62                   S01194
     C                     CALL 'AOCURRR0'                                S01194
     C                     PARM *BLANKS   RTCD                            S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM '?'       @CYCD                           S01194
     C           SDCURR    PARM SDCURR    DSSDY                           S01194
      *                                                                   S01194
      * if selection made move value to screen field                      S01194
     C           RTCD      IFEQ *BLANKS                                   S01194
     C                     MOVE A6CYCD    SSMCY                           S01194
     C                     ELSE                                           S01194
     C                     MOVEL*BLANKS   SSMCY                           S01194
     C                     END                                            S01194
      *                                                                   S01194
     C                     END                                            S01194
      *                                                                   S01194
      * check for entry of ? in pay currency field                        S01194
     C                     MOVEA*BLANKS   FLDQ                            S01194
     C                     MOVEASPCCY     FLDQ                            S01194
     C                     SETOF                     63                   S01194
     C           '?'       LOKUPFLDQ                     63               S01194
      *                                                                   S01194
      * if ? found seton redisplay ind and call access program            S01194
     C           *IN63     IFEQ '1'                                       S01194
     C                     SETON                     62                   S01194
     C                     CALL 'AOCURRR0'                                S01194
     C                     PARM *BLANKS   RTCD                            S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM '?'       @CYCD                           S01194
     C           SDCURR    PARM SDCURR    DSSDY                           S01194
      *                                                                   S01194
      * if selection made move value to screen field                      S01194
     C           RTCD      IFEQ *BLANKS                                   S01194
     C                     MOVE A6CYCD    SPCCY                           S01194
     C                     ELSE                                           S01194
     C                     MOVEL*BLANKS   SPCCY                           S01194
     C                     END                                            S01194
      *                                                                   S01194
     C                     END                                            S01194
      *                                                                   S01194
      * check for entry of ? in book code field                           S01414
     C                     MOVEA*BLANKS   FLDQ                            S01414
     C                     MOVEASBOKC     FLDQ                            S01414
     C                     SETOF                     63                   S01414
     C           '?'       LOKUPFLDQ                     63               S01414
      *                                                                   S01414
      * if ? found seton redisplay ind and call access program            S01414
     C           *IN63     IFEQ '1'                                       S01414
     C                     SETON                     62                   S01414
     C                     CALL 'AOBOOKR0'                                S01414
     C                     PARM *BLANKS   U#RTCD  7                       S01414
     C                     PARM '*KEY   ' U#OPTN  7                       S01414
     C                     PARM '?'       U#BOKC  2                       S01414
     C           SDBOOK    PARM SDBOOK    DSFDY                           S01414
      *                                                                   S01414
      * if selection made move value to screen field                      S01414
     C           U#RTCD    IFEQ *BLANKS                                   S01414
     C                     MOVELSDBOOK    SBOKC                           S01414
     C                     ELSE                                           S01414
     C                     MOVEL*BLANKS   SBOKC                           S01414
     C                     END                                            S01414
      *                                                                   S01414
     C                     END                                            S01414
      *                                                                   S01414
      * check for entry of ? in profit centre field                       S01414
     C                     MOVEA*BLANKS   FLDQ                            S01414
     C                     MOVEASPRFC     FLDQ                            S01414
     C                     SETOF                     63                   S01414
     C           '?'       LOKUPFLDQ                     63               S01414
      *                                                                   S01414
      * if ? found seton redisplay ind and call access program            S01414
     C           *IN63     IFEQ '1'                                       S01414
     C                     SETON                     62                   S01414
     C                     CALL 'AOPRFCR0'                                S01414
     C                     PARM *BLANKS   U#RTCD  7                       S01414
     C                     PARM '*KEY   ' U#OPTN  7                       S01414
     C                     PARM '?'       U#PRFC  4                       S01414
     C           SDPRFC    PARM SDPRFC    DSFDY                           S01414
      *                                                                   S01414
      * if selection made move value to screen field                      S01414
     C           U#RTCD    IFEQ *BLANKS                                   S01414
     C                     MOVELSDPRFC    SPRFC                           S01414
     C                     ELSE                                           S01414
     C                     MOVEL*BLANKS   SPRFC                           S01414
     C                     END                                            S01414
      *                                                                   S01414
     C                     END                                            S01414
     C                     ENDSR                                          S01194
     C************************************************************        S01194
     C*  END FQRY2 SUBROUTINE                                             S01194
     C************************************************************        S01194
     C/EJECT                                                              S01194
     C************************************************************        S01194
     C* STORE SR.
     C* MOVE READ RECORD TO STORED RECORD AND EDIT FIELDS FOR DISP
     C*
     C           STORE     BEGSR
     C*
     C* IF INSERT CLEAR FILE FIELDS
     C   12                DO                              B001
     C                     MOVE 'D'       RECI
     C                     MOVE *BLANK    PREF
     C                     MOVE *BLANK    SORBR                           S01117
     C                     MOVE 'OP'      PYTP
     C                     MOVE *BLANK    PYST
     C                     MOVE *BLANK    DSTT
     C                     MOVE *BLANK    DST1
     C                     MOVE *BLANK    DST2
     C                     MOVE *BLANK    DST3
     C                     MOVE *BLANK    DST4
     C                     MOVE *BLANK    SNCT
     C***********          Z-ADD0         SNCO                                                CSD027
     C                     MOVE *BLANKS   SNCO                                                CSD027
     C                     MOVE *BLANK    ORBT
     C***********          Z-ADD0         ORBK                                                CSD027
     C                     MOVE *BLANKS   ORBK                                                CSD027
     C                     MOVE *BLANK    SORBB                           S01117
     C                     MOVE *BLANK    ORCT
     C                     MOVE *BLANK    ORC1
     C                     MOVE *BLANK    ORC2
     C                     MOVE *BLANK    ORC3
     C                     MOVE *BLANK    ORC4
     C                     Z-ADD0         SMAM
     C                     Z-ADD0         SMAMD
     C                     MOVE *BLANK    SMCY
     C                     Z-ADD0         MDIN
     C                     Z-ADD0         RATE
     C                     Z-ADD0         RATED
     C                     MOVE *BLANK    OVRD
     C                     Z-ADD0         PYAM
     C                     Z-ADD0         PYAMD
     C                     MOVE *BLANK    PCCY
     C                     Z-ADD0         SLDT
     C                     Z-ADD0         SLDTD1
     C                     Z-ADD0         SLDTD2
     C                     Z-ADD0         SLDTD3
     C                     Z-ADD0         PVDT
     C                     MOVEL*BLANK    FDLR                            175479
     C                     Z-ADD0         PVDTD1
     C                     Z-ADD0         PVDTD2
     C                     Z-ADD0         PVDTD3
     C*********************MOVE 'D'       ADDC                            041276
     C/COPY WNCPYSRC,FT0040C093
     C                     MOVE 'A'       ADDC                            041276
     C/COPY WNCPYSRC,FT0040C094
     C                     MOVE 'N'       RPAY
     C                     MOVE *BLANK    PAYF
     C                     Z-ADD0         DYIM
     C                     Z-ADD0         FDAT
     C                     Z-ADD0         FDATD1
     C                     Z-ADD0         FDATD2
     C                     Z-ADD0         FDATD3
     C                     Z-ADD2         SWPC
     C                     Z-ADD0         STMT
     C                     MOVE *BLANK    SNMT
     C                     MOVE *BLANK    RCRT
     C                     MOVE *BLANK    RCO1
     C                     MOVE *BLANK    RCO2
     C                     MOVE *BLANK    RCO3
     C                     MOVE *BLANK    RCO4
     C                     MOVE *BLANK    RCO5
     C                     MOVE *BLANK    ACBT
     C                     MOVE *BLANK    ACB1
     C                     MOVE *BLANK    ACB2
     C                     MOVE *BLANK    ACB3
     C                     MOVE *BLANK    ACB4
     C                     MOVE *BLANK    ACB5
     C                     MOVE *BLANK    BNCT
     C                     MOVE *BLANK    BNC1
     C                     MOVE *BLANK    BNC2
     C                     MOVE *BLANK    BNC3
     C                     MOVE *BLANK    BNC4
     C                     MOVE *BLANK    BNC5
     C                     MOVE *BLANK    DTP1
     C                     MOVE *BLANK    DTP2
     C                     MOVE *BLANK    DTP3
     C                     MOVE *BLANK    DTP4
     C                     MOVE *BLANK    DTCH
     C                     MOVE *BLANK    BBI1
     C                     MOVE *BLANK    BBI2
     C                     MOVE *BLANK    BBI3
     C                     MOVE *BLANK    BBI4
     C                     MOVE *BLANK    BBI5
     C                     MOVE *BLANK    BBI6
     C                     MOVE *BLANK    DNBC
     C                     MOVE *BLANK    TRCT
     C*                                                                   S01499
     C           S01499    IFEQ 'Y'                                       S01499
     C                     MOVE 'Y'       OPVAT1                          S01499
     C                     MOVE 'Y'       OPVAT2                          S01499
     C                     MOVE 'Y'       OPVAT3                          S01499
     C                     MOVE 'Y'       OPVAT4                          S01499
     C                     MOVE 'Y'       OPVAT5                          S01499
     C                     MOVE 'Y'       OPVAT6                          S01499
     C                     MOVE 'Y'       OPVAT7                          S01499
     C                     END                                            S01499
     C*                                                                   S01499
     C                     Z-ADD0         TRCM
     C                     Z-ADD0         TRCMD
     C                     Z-ADD0         TXCH
     C                     Z-ADD0         TXCHD
     C                     Z-ADD0         CQCH                            037575
     C                     Z-ADD0         CQCHD
     C                     Z-ADD0         CSTA
     C                     Z-ADD0         CSTAD
     C                     Z-ADD0         SPCH                            037575
     C                     Z-ADD0         SPCHD
     C                     Z-ADD0         MSCH
     C                     Z-ADD0         MSCHD
     C*                                                                   S01494
     C           S01494    IFEQ 'Y'                                       S01494
     C                     Z-ADD0         OPCHCM                          S01494
     C                     END                                            S01494
     C           S01499    IFEQ 'Y'                                       S01499
     C                     Z-ADD0         OPVATT                          S01499
     C                     Z-ADD0         OPVATR                          S01499
     C                     END                                            S01499
     C*                                                                   S01499
     C                     MOVE *BLANK    CDRT
     C***********          Z-ADD0         CDRO                                                CSD027
     C                     MOVE *BLANKS   CDRO                                                CSD027
     C                     Z-ADD0         OTLCHT
     C                     Z-ADD0         OTLCD
     C                     MOVE *BLANK    CHTP
     C                     MOVE *BLANK    AUP1
     C                     MOVE *BLANK    AUP2
     C                     MOVE *BLANK    AUIN
     C                     MOVE *BLANK    SACG
     C                     MOVE *BLANK    PACG
     C                     MOVE *BLANK    IACG                            050918
     C                     MOVE *BLANK    SMSG
     C                     MOVE *BLANK    PMSG
     C                     Z-ADD0         OEDT
     C                     Z-ADD0         OEDTD1
     C                     Z-ADD0         OEDTD2
     C                     Z-ADD0         OEDTD3
     C                     Z-ADD0         NPDT
     C                     Z-ADD0         NPDTD1
     C                     Z-ADD0         NPDTD2
     C                     Z-ADD0         NPDTD3
     C*********************MOVE *BLANK    PRBD                            003352
     C                     Z-ADD0         PRBD                            003352
     C                     MOVE *BLANK    FAIN
     C                     MOVE *BLANK    ADIN
     C                     MOVE *BLANK    CQIN
     C                     MOVE *BLANK    PRIN
     C                     MOVE *BLANK    MT100
     C                     MOVE *BLANK    MT202
     C*********************MOVE *BLANK    MT400                           E32481
     C*********************MOVE *BLANK    MT200                           E32481
     C                     MOVE *BLANK    TXIN
     C                     MOVE *BLANK    BAIN
     C                     MOVE *BLANK    ISIN
     C                     MOVE *BLANK    MPYI
     C                     MOVE *BLANK    RLPR                            037575
     C                     MOVE *BLANK    INBT                            037575
     C                     MOVE *BLANK    INB1                            037575
     C                     MOVE *BLANK    INB2                            037575
     C                     MOVE *BLANK    INB3                            037575
     C                     MOVE *BLANK    INB4                            037575
     C                     MOVE *BLANK    INB5                            037575
     C                     Z-ADD0         CHAP                            037575
     C                     MOVE *BLANK    LVL1                            037575
     C                     MOVE *BLANK    LVL2                            037575
     C                     Z-ADD0         SBCQ                            037575
     C                     Z-ADD0         PBCQ                            037575
     C                     MOVE *BLANKS   ODMT
     C                     MOVE *BLANK    OPIN
     C                     MOVE *BLANK    OXPREF                          037575
     C                     MOVE *BLANK    AMTS                            037575
     C                     MOVE *BLANK    SVDT                            037575
     C                     MOVE *BLANK    NSTR                            037575
     C                     MOVE *BLANK    TSKS                            037575
     C                     MOVE *BLANK    INUSR1                          037575
     C                     MOVE *BLANK    INUSR2                          037575
     C                     Z-ADD0         DUMA1                           037575
     C                     Z-ADD0         DUMA2                           037575
     C                     Z-ADD0         DUMA3                           037575
     C                     Z-ADD0         DUMA4                           037575
     C                     Z-ADD0         DUMA5                           037575
     C                     Z-ADD0         DUMA6                           037575
     C*                                                                   S01494
     C           S01494    IFEQ 'Y'                                       S01494
     C                     Z-ADD0         OPDUM7                          S01494
     C                     END                                            S01494
     C           S01499    IFEQ 'Y'                                       S01499
     C                     Z-ADD0         OPDUM8                          S01499
     C                     END                                            S01499
     C*                                                                   S01499
     C                     MOVE *BLANK    BOKC                            S01414
     C                     MOVE *BLANK    PRFC                            S01414
     C                     MOVE *BLANK    CDBR                            058476
     C                     MOVE *BLANK    MT202C                          058476
     C                     MOVE *BLANK    OPORBT                          058476
     C                     MOVE *BLANK    OPORB1                          058476
     C                     MOVE *BLANK    OPORB2                          058476
     C                     MOVE *BLANK    OPORB3                          058476
     C                     MOVE *BLANK    OPORB4                          058476
     C                     MOVE *BLANK    OPORB5                          058476
     C                     Z-ADD*ZERO     OPMSGR                          S01435
     C                     Z-ADD*ZERO     OPKPRT                          S01435
     C                     Z-ADD*ZERO     FXMP                            CAC001
     C                     Z-ADD*ZERO     FXMD                            CAC001
     C                     MOVE *BLANK    MBSI                            CAC001
     C                     MOVE *BLANK    MSIG                            CAC001
     C                     Z-ADD*ZERO     MAMT                            CAC001
      *                                                                   CEU006
     C                     MOVE *BLANKS   NDCY                            CEU006
     C                     Z-ADD*ZERO     NDAM                            CEU006
     C                     MOVE *BLANKS   PDCY                            CEU006
     C                     MOVE *BLANKS   PYDT                            CFT009
     C                     MOVE *BLANKS   FLAG12                          CFT009
     C                     Z-ADD*ZERO     PDAM                            CEU006
      ** Initialise MT103 fields                                          CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
     C                     MOVE *BLANK    OPBOCD                          CFT014
     C                     MOVE *BLANK    OPICD1                          CFT014
     C                     MOVE *BLANK    OPICD2                          CFT014
     C                     MOVE *BLANK    OPICD3                          CFT014
     C                     MOVE *BLANK    OPICD4                          CFT014
     C                     MOVE *BLANK    OPICD5                          CFT014
     C                     MOVE *BLANK    OPTTCD                          CFT014
     C                     MOVE *BLANK    OPTRIT                          CFT014
     C                     MOVE *BLANK    OPTRI1                          CFT014
     C                     MOVE *BLANK    OPTRI2                          CFT014
     C                     MOVE *BLANK    OPTRI3                          CFT014
     C                     MOVE *BLANK    OPTRI4                          CFT014
     C                     MOVE *BLANK    OPTRI5                          CFT014
     C                     MOVE *BLANK    OPRRP1                          CFT014
     C                     MOVE *BLANK    OPRRP2                          CFT014
     C                     MOVE *BLANK    OPRRP3                          CFT014
     C                     MOVE *BLANK    OPFRNT                          CFT014
     C                     MOVE *BLANK    OPREPA                          CFT014
     C                     MOVE *BLANK    OPSCC1                          CFT014
     C                     MOVE *BLANK    OPSCC2                          CFT014
     C                     MOVE *BLANK    OPSCC3                          CFT014
     C                     MOVE *BLANK    OPSCC4                          CFT014
     C                     MOVE *BLANK    OPSCC5                          CFT014
     C                     Z-ADD*ZERO     OPOEXR                          CFT014
     C                     Z-ADD*ZERO     OPSCH1                          CFT014
     C                     Z-ADD*ZERO     OPSCH2                          CFT014
     C                     Z-ADD*ZERO     OPSCH3                          CFT014
     C                     Z-ADD*ZERO     OPSCH4                          CFT014
     C                     Z-ADD*ZERO     OPSCH5                          CFT014
     C                     Z-ADD*ZERO     OPRCRM                          CFT014
     C                     Z-ADD*ZERO     OPRBCQ                          CFT014
     C                     Z-ADD*ZERO     OPRCSC                          CFT014
     C                     Z-ADD*ZERO     OPRCSQ                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT009
      ** Initialise fees & charges fields                                 CFT009
      *                                                                   CFT009
     C           CFT009    IFEQ 'Y'                                       CFT009
     C                     MOVE *BLANK    OTPDOF                          CFT009
     C                     MOVE *BLANK    SOFCD                           CFT009
     C                     MOVE *BLANK    FXSRSC                          CFT009
     C                     MOVE *BLANK    TLXCDE                          CFT009
     C                     MOVE *BLANK    CHQCHC                          CFT009
     C                     MOVE *BLANK    CACHCD                          CFT009
     C                     MOVE *BLANK    SSTCCD                          CFT009
     C                     MOVE *BLANK    SPRCCD                          CFT009
     C                     MOVE *BLANK    MSCHC                           CFT009
     C                     MOVE *BLANK    MSCHC1                          CFT009
     C                     MOVE *BLANK    MSCHC2                          CFT009
     C                     MOVE *BLANK    MSCHC3                          CFT009
     C                     MOVE *BLANK    MSCHC4                          CFT009
     C                     MOVE *BLANK    MSCHC5                          CFT009
     C                     MOVE *BLANK    TFCCCD                          CFT009
     C                     MOVE *BLANK    FXCACC                          CFT009
     C                     MOVE *BLANK    VTSWSC                          CFT009
     C                     MOVE *BLANK    VMIC1                           CFT009
     C                     MOVE *BLANK    VMIC2                           CFT009
     C                     MOVE *BLANK    VMIC3                           CFT009
     C                     MOVE *BLANK    VMIC4                           CFT009
     C                     MOVE *BLANK    VMIC5                           CFT009
     C                     Z-ADD*ZERO     MISC01                          CFT009
     C                     Z-ADD*ZERO     MISC02                          CFT009
     C                     Z-ADD*ZERO     MISC03                          CFT009
     C                     Z-ADD*ZERO     MISC04                          CFT009
     C                     Z-ADD*ZERO     MISC05                          CFT009
     C                     Z-ADD*ZERO     SWSCHG                          CFT009
     C                     Z-ADD*ZERO     DATNED                          CFT009
     C                     Z-ADD*ZERO     DATNAO                          CFT009
     C                     MOVE *BLANK    CUNFLA                          CFT009
     C                     Z-ADD*ZERO     OPCHRT                          CFT009
     C                     MOVE *BLANK    OPCHGC                          CFT009
     C                     Z-ADD*ZERO     MISCC1                          CFT009
     C                     Z-ADD*ZERO     MISCC2                          CFT009
     C                     Z-ADD*ZERO     MISCC3                          CFT009
     C                     Z-ADD*ZERO     MISCC4                          CFT009
     C                     Z-ADD*ZERO     MISCC5                          CFT009
     C                     Z-ADD*ZERO     SWSCCC                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CEU006
     C/COPY WNCPYSRC,FT0040C024
     C                     END                             E001
     C*
     C* SETUP DISPLAY FIELDS
     C* AND SOME STORE FOR COMPARISON
     C*
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0040CP48                                           S01408
     C*                                                                   S01408
     C                     MOVE PREF      SPREF
     C                     MOVE PYTP      SPYTP
     C                     MOVE PYST      SPYST
     C                     MOVE *BLANK    SDSTT   1
     C*                                                                   S01117
     C** If full account and not multi branched                           S01117
     C*                                                                   S01117
     C           DSTT      IFEQ 'G'                                       S01117
     C           @MBIN     ANDEQ'N'                                       S01117
     C**********           MOVELDST1      DSTNM  15                                    S01117 CGL029
     C                     MOVELDST1      DSTNM  21                                           CGL029
     C                     MOVELDSTNM     SDST1                           S01117
     C                     ELSE                                           S01117
     C                     MOVE DST1      SDST1
     C                     END                                            S01117
     C                     MOVE DST2      SDST2
     C                     MOVE DST3      SDST3
     C                     MOVE DST4      SDST4
     C                     MOVE *BLANK    SSNCT   1
     C                     MOVE *BLANK    SSNCO
     C/COPY WNCPYSRC,FT0040C228
     C  N12      SNCT      IFEQ 'N'                        B001
     C                     MOVELSNCO      SNOS
     C                     ELSE                            X001
     C           SNCT      IFEQ 'R'                        B002
     C                     MOVE SNCO      SSNCO
     C                     END                             E002
     C                     END                             E001
     C/COPY WNCPYSRC,FT0040C229
     C                     MOVE *BLANK    SORBK
     C                     MOVE *BLANK    SORBB                           S01117
     C  N12      ORBT      IFEQ 'N'                        B001
     C                     MOVELORBK      ORNS
     C                     ELSE                            X001
     C           ORBT      IFEQ 'R'                        B002
     C                     MOVELORBK      ORRT
     C                     ELSE                            X002
     C           ORBT      IFEQ 'P'                        B003
     C                     MOVE ORBK      SORBK
     C           @MBIN     IFEQ 'Y'                                       S01117
     C                     MOVE ORBB      SORBB                           S01117
     C                     END                                            S01117
     C/COPY WNCPYSRC,FT0040C161
     C                     END                             E003
     C                     END                             E002
     C                     END                             E001
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0040CP49                                           S01408
     C*                                                                   S01408
     C*                                                                   S01117
     C**  set up screen fields for booking/originating branch             S01117
     c*                                                                   S01117
     C  N12 57             MOVE BRCA      SBRCA                           S01117
     C  N12 58             MOVE ORBR      SORBR                           S01117
     C*                                                                   S01117
     C                     MOVE *BLANK    SORBT   1
     C                     MOVE *BLANK    SORCT   1
     C           ORCT      IFEQ 'P'                                       S01117
     C           @MBIN     ANDEQ'N'                                       S01117
     C**********           MOVELORC1      ORCNM  12                                    S01117 CGL029
     C                     MOVELORC1      ORCNM  18                                           CGL029
     C                     MOVELORCNM     SORC1                           S01117
     C/COPY WNCPYSRC,FT0040C032
     C                     ELSE                                           S01117
     C                     MOVE ORC1      SORC1
     C/COPY WNCPYSRC,FT0040C033
     C                     END                                            S01117
     C           SORC1     IFEQ ORCFLD                                    061236
     C                     MOVE OPORB1    SORC2                           061236
     C                     MOVE OPORB2    SORC3                           061236
     C                     MOVE OPORB3    SORC4                           061236
     C                     ELSE                                           061236
     C                     MOVE ORC2      SORC2
     C                     MOVE ORC3      SORC3
     C                     MOVE ORC4      SORC4
     C                     END                                            061236
     C/COPY WNCPYSRC,FT0040C049
      *                                                                   S01435
      *  If enquiry then format for screen                                S01435
      *                                                                   S01435
     C           ACTION    IFEQ 'E'                                       S01435
      *                                                                   S01435
      *  Set up general parameters                                        S01435
      *                                                                   S01435
     C                     CLEARW8FT                                      S01435
     C                     MOVEL*BLANKS   W8STMT                          S01435
     C                     MOVELSMCY      W8CCY                           S01435
     C                     MOVEL##PGM     W8CPGM                          S01435
     C                     MOVEL'*SCR  '  W8ACT                           S01435
     C                     Z-ADD4         W8NLIN                          S01435
      *                                                                   S01435
      *  Set up parameters                                                S01435
      *                                                                   S01435
     C           ORCT      IFNE 'A'                                       S01435
     C           SORC1     ORNE ORCFLD                                    061236
     C                     MOVELORCT      W8TYPE                          S01435
     C                     MOVEL*BLANKS   W8LINS                          S01435
     C                     MOVEL*BLANKS   ADDRSS                          S01435
     C                     MOVELORC1      ADCHK1                          S01435
     C/COPY WNCPYSRC,FT0040C034
     C                     MOVELORC2      ADCHK2                          S01435
     C                     MOVELORC3      ADCHK3                          S01435
     C                     MOVELORC4      ADCHK4                          S01435
     C                     MOVELADDRSS    W8LINS                          S01435
      *                                                                   S01435
      * Call expansion program                                            S01435
      *                                                                   S01435
     C                     CALL 'FT0315'               8989               S01435
     C                     PARM           W8RTN   7                       S01435
     C                     PARM           W8FT                            S01435
     C                     PARM           W8LINS256                       S01435
     C                     PARM           W8RPT 256                       S01435
     C                     PARM           W8MSG 256                       S01435
     C                     PARM           W8SCR 256                       S01435
      *                                                                   S01435
      ** Check if database error occurred                                 S01435
      *                                                                   S01435
     C           *IN89     IFEQ '1'                                       S01435
     C           W8RTN     ORNE *BLANKS                                   S01435
     C                     MOVEL'FT0315'  W0FILE                          S01435
     C                     MOVEL'*CALL'   W0KEY                           S01435
     C                     Z-ADD100       W0ERNB                          S01435
     C                     EXSR SRERR                      *ABORT PGM*    S01435
     C                     END                                            S01435
      *                                                                   S01435
     C           35        SUBSTW8SCR:1   SORC1                           S01435
     C           35        SUBSTW8SCR:36  SORC2                           S01435
     C           35        SUBSTW8SCR:71  SORC3                           S01435
     C           35        SUBSTW8SCR:106 SORC4                           S01435
     C                     END                                            S01435
      *                                                                   S01435
      *  Set up general parameters                                        S01435
      *                                                                   S01435
     C                     CLEARW8FT                                      S01435
     C                     MOVEL*BLANKS   W8STMT                          S01435
     C                     MOVELPCCY      W8CCY                           S01435
     C                     MOVEL##PGM     W8CPGM                          S01435
     C                     MOVEL'*SCR  '  W8ACT                           S01435
     C                     Z-ADD4         W8NLIN                          S01435
      *                                                                   S01435
      *  Set up parameters                                                S01435
      *                                                                   S01435
     C                     MOVELDSTT      W8TYPE                          S01435
     C                     MOVEL*BLANKS   W8LINS                          S01435
     C                     MOVEL*BLANKS   ADDRSS                          S01435
     C                     MOVELDST1      ADCHK1                          S01435
     C                     MOVELDST2      ADCHK2                          S01435
     C                     MOVELDST3      ADCHK3                          S01435
     C                     MOVELDST4      ADCHK4                          S01435
     C                     MOVELADDRSS    W8LINS                          S01435
      *                                                                   S01435
      * Call expansion program                                            S01435
      *                                                                   S01435
     C                     CALL 'FT0315'               8989               S01435
     C                     PARM           W8RTN   7                       S01435
     C                     PARM           W8FT                            S01435
     C                     PARM           W8LINS256                       S01435
     C                     PARM           W8RPT 256                       S01435
     C                     PARM           W8MSG 256                       S01435
     C                     PARM           W8SCR 256                       S01435
      *                                                                   S01435
      ** Check if database error occurred                                 S01435
      *                                                                   S01435
     C           *IN89     IFEQ '1'                                       S01435
     C           W8RTN     ORNE *BLANKS                                   S01435
     C                     MOVEL'FT0315'  W0FILE                          S01435
     C                     MOVEL'*CALL'   W0KEY                           S01435
     C                     Z-ADD101       W0ERNB                          S01435
     C                     EXSR SRERR                      *ABORT PGM*    S01435
     C                     END                                            S01435
      *                                                                   S01435
     C           35        SUBSTW8SCR:1   SDST1                           S01435
     C           35        SUBSTW8SCR:36  SDST2                           S01435
     C           35        SUBSTW8SCR:71  SDST3                           S01435
     C           35        SUBSTW8SCR:106 SDST4                           S01435
     C                     END                                            S01435
     C/COPY WNCPYSRC,FT0040C276
      *                                                                   S01435
     C                     MOVE NDCY      SNDCY                           CEU006
     C                     Z-ADDNDAM      SNDAM  130                      CEU006
     C                     MOVE PDCY      SPDCY                           CEU006
     C                     Z-ADDPDAM      SPDAM  130                      CEU006
     C           CFT014    IFEQ 'Y'                                       CFT014
     C                     Z-ADDOPOEXR    WORTE                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CEU006
     C                     Z-ADDSMAM      SSMAM  130
     C                     MOVE SMCY      SSMCY
     C                     Z-ADDMDIN      SMDIN   10
     C                     Z-ADDRATE      SRATE  138
     C                     MOVE OVRD      SOVRD
     C                     Z-ADDPYAM      SPYAM  130
     C                     MOVE PCCY      SPCCY
     C                     Z-ADDSLDT      SSLDT   50
     C                     Z-ADDSLDTD1    SSLDT1  60
     C                     Z-ADDSLDTD2    SSLDT2  20
     C                     Z-ADDSLDTD3    SSLDT3  60
     C                     Z-ADDPVDT      SPYDT   50
     C                     Z-ADDPVDTD1    SPYDT1  60
     C                     Z-ADDPVDTD2    SPYDT2  20
     C                     Z-ADDPVDTD3    SPYDT3  60
     C                     MOVE ADDC      SADDC
     C                     MOVE BOKC      SBOKC                           S01414
     C                     MOVE PRFC      SPRFC                           S01414
     C                     MOVE RPAY      SRPAY
     C                     MOVE FDLR      SFDLR                           175479
     C                     MOVE PAYF      SPAYF
     C           DYIM      IFEQ 0                          B001
     C                     MOVE *BLANK    SDYIM
     C                     ELSE                            X001
     C                     MOVE DYIM      SDYIM
     C                     END                             E001
     C                     Z-ADDFDAT      SFDAT   50
     C                     Z-ADDFDATD1    SFDAT1  60
     C                     Z-ADDFDATD2    SFDAT2  20
     C                     Z-ADDFDATD3    SFDAT3  60
     C           SWPC      IFEQ 0                          B001
     C                     MOVE *BLANK    SSWPC
     C                     ELSE                            X001
     C*********************MOVE SWPC      SSWPC                           S01117
     C           SWPC      IFEQ 1                          B002           S01117
     C                     MOVE 'U'       SSWPC                           S01117
     C                     ELSE                            X002           S01117
     C           SWPC      IFEQ 2                          B003           S01117
     C                     MOVE 'N'       SSWPC                           S01117
     C                     END                             E003           S01117
     C                     END                             E002           S01117
     C                     END                             E001
     C           STMT      IFNE 0                          B001
     C           *IN12     ORNE '1'
     C                     MOVE STMT      SSTTP
     C/COPY WNCPYSRC,FT0040C012
     C                     ELSE                            X001
     C                     MOVE '  '      SSTTP
     C                     END                             E001
     C                     MOVE SNMT      SSNMT
     C**********           Z-ADDCDRO      SCDRO  120                                          CGL029
     C***********          Z-ADDCDRO      SCDRO  180                                   CGL029 CSD027
     C                     MOVE *BLANKS   SCDRO  18                                           CSD027
     C                     MOVE ADDC      SADDC
     C                     Z-ADDSMAM      OSMAM  130
     C                     Z-ADDPYAM      OPYAM  130
     C                     Z-ADDRATE      ORATE  138
     C                     MOVE OVRD      OOVRD   1
     C                     MOVE SMCY      OSMCY   3
     C                     MOVE PCCY      OPCCY   3
     C                     Z-ADDOTLCD     SLCD    50
     C                     Z-ADDOTLCHT    SLCHT   60
     C                     Z-ADDNPDT      SNPDT   50
     C                     Z-ADDNPDTD1    SNPDT1  60
     C                     Z-ADDNPDTD2    SNPDT2  20
     C                     Z-ADDNPDTD3    SNPDT3  60
     C                     Z-ADDPRBD      SPRBD   30                      003352
     C           SLDTD1    IFEQ 0                          B001
     C  N12                MOVE *BLANK    PYDT
     C***12*************** MOVE ZDATE     PYDT                            047167
     C           CFT009    IFEQ 'N'                                       CFT009
     C   12                MOVE RUNN      PYDT                            047167
     C                     ENDIF                                          CFT009
     C                     ELSE                            X001
     C           CFT009    IFEQ 'N'                                       CFT009
     C                     Z-ADDSLDTD1    PYDTN
     C                     ENDIF                                          CFT009
     C                     END                             E001
     C           PVDTD1    IFEQ 0                          B001
     C                     MOVE *BLANK    PYVD
     C                     ELSE                            X001
     C                     Z-ADDPVDTD1    PYVDN
     C                     END                             E001
     C           FDATD1    IFEQ 0                          B001
     C                     MOVE *BLANK    FIND
     C                     ELSE                            X001
     C                     Z-ADDFDATD1    FINDN
     C                     END                             E001
     C           NPDTD1    IFEQ 0                          B001
     C                     MOVE *BLANK    NDAT
     C                     ELSE                            X001
     C                     Z-ADDNPDTD1    NDATN
     C                     END                             E001
     C           ODMT      IFEQ *BLANKS                    B001
     C                     MOVEL*BLANKS   SODMT             001
     C                     ELSE                            X001
     C                     MOVEL*BLANKS   SODMT             001
     C                     MOVELODMT      SODMT             001
     C                     END                             E001
     C* CLEAR VALUE FIELDS
     C/COPY WNCPYSRC,FT0040C050
     C                     MOVE *BLANK    SMAMA
     C                     MOVE *BLANK    PYAMA
     C                     MOVE *BLANK    RATEA
      *                                                                   CEU006
     C                     MOVE *BLANK    NDAMA                           CEU006
     C                     MOVE *BLANK    PDAMA                           CEU006
     C           CFT014    IFEQ 'Y'                                       CFT014
     C                     MOVE *BLANK    SORTE                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT009
     C           CFT009    IFEQ 'Y'                                       CFT009
     C                     MOVE *BLANK    SPDSET                          CFT009
     C           F12       IFNE 'Y'                                       CFT009
     C                     MOVE *BLANK    SOFCD                           CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CEU006
     C/COPY WNCPYSRC,FT0040C051
      *                                                                   CAC001
      ** Set up Margin Information parameter fields.                      CAC001
      *                                                                   CAC001
     C           FIRST     IFEQ 'Y'                                       CAC001
     C                     Z-ADDFXMP      W3FXMP                          CAC001
     C                     Z-ADDFXMD      W3FXMD                          CAC001
     C                     MOVELMBSI      W3MBSI                          CAC001
     C                     MOVELMSIG      W3MSIG                          CAC001
     C                     Z-ADDMAMT      W3MAMT                          CAC001
     C                     MOVEL'N'       FIRST                           CAC001
     C                     ENDIF                                          CAC001
      *                                                                   CAC001
     C* IF INSERT MISS OUT EDIT OF FIELDS
     C   12                GOTO STORND
     C* EDIT NUMERIC FIELDS WITH DECIMAL POINTS ETC
     C* SETTLEMENT AMOUNT
     C*                                                                   S01194
     C*********************MOVE *BLANK    KEY                             S01194
     C*********************MOVEL'20'      KEY                             S01194
     C*********************MOVELSSMCY     SCCY    4                       S01194
     C*********************MOVE '1'       SCCY                            S01194
     C*********************MOVE SCCY      KEY                             S01194
     C                     MOVE SSMCY     @K101                           S01194
     C/COPY WNCPYSRC,FT0040C001
     C                     EXSR TG1RED
     C*********************Z-ADDCDP       PCDP    10                      S01194
     C                     Z-ADDA6NBDP    PCDP    10                      S01194
     C/COPY WNCPYSRC,FT0040C002
     C                     MOVE *BLANK    DIG1
     C                     Z-ADDSSMAM     DIG1N
     C                     EXSR EDIT
     C                     MOVEADIG2      SMAMA
     C* PAY AMOUNT
     C*********************MOVE *BLANK    KEY                             S01194
     C*********************MOVEL'20'      KEY                             S01194
     C*********************MOVELSPCCY     SCCY    4                       S01194
     C*********************MOVE '1'       SCCY                            S01194
     C*********************MOVE SCCY      KEY                             S01194
     C                     MOVE SPCCY     @K101                           S01194
     C/COPY WNCPYSRC,FT0040C003
     C                     EXSR TG1RED
     C*********************Z-ADDCDP       RCDP    10                      S01194
     C                     Z-ADDA6NBDP    RCDP    10                      S01194
     C/COPY WNCPYSRC,FT0040C004
     C           SPYAM     IFNE 0
     C                     MOVE *BLANK    DIG1
     C                     Z-ADDSPYAM     DIG1N
     C                     EXSR EDIT
     C                     MOVEADIG2      PYAMA
     C                     END
     C* RATE
     C*********************Z-ADD8         CDP                             S01194
     C                     Z-ADD8         A6NBDP                          S01194
     C                     MOVE *BLANK    DIG1
     C                     Z-ADDSRATE0    DIG1N
     C                     EXSR EDIT
     C                     MOVEADIG2      RATEA
     C                     MOVE SMAMA     SMAMAO 14
     C                     MOVE PYAMA     PYAMAO 14
     C                     MOVE RATEA     RATEAO 14
      ** Setup original rate                                              CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
     C           WORTE0    ANDNE*ZERO                                     CFT014
     C                     Z-ADD8         A6NBDP                          CFT014
     C                     MOVE *BLANK    DIG1                            CFT014
     C                     Z-ADDWORTE0    DIG1N                           CFT014
     C                     EXSR EDIT                                      CFT014
     C                     MOVEADIG2      SORTE                           CFT014
     C                     ENDIF                                          CFT014
      * NOTIFIED DELIVERY AMOUNT                                          CEU006
      *                                                                   CEU006
     C           SNDCY     IFNE *BLANKS                                   CEU006
     C                     MOVE SNDCY     @K101                           CEU006
     C                     EXSR TG1RED                                    CEU006
     C                     MOVE *BLANK    DIG1                            CEU006
     C                     Z-ADDSNDAM     DIG1N                           CEU006
     C                     EXSR EDIT                                      CEU006
     C                     MOVEADIG2      NDAMA                           CEU006
     C                     ENDIF                                          CEU006
      *                                                                   CEU006
      * PAY DELIVERY AMOUNT                                               CEU006
      *                                                                   CEU006
     C           SPDCY     IFNE *BLANKS                                   CEU006
     C                     MOVE SPDCY     @K101                           CEU006
     C                     EXSR TG1RED                                    CEU006
     C                     MOVE *BLANK    DIG1                            CEU006
     C                     Z-ADDSPDAM     DIG1N                           CEU006
     C                     EXSR EDIT                                      CEU006
     C                     MOVEADIG2      PDAMA                           CEU006
     C                     ENDIF                                          CEU006
      *                                                                   CFT009
      ** FX spread set                                                    CFT009
      *                                                                   CFT009
     C           CFT009    IFEQ 'Y'                                       CFT009
     C                     MOVELFXSRSC    SPDSET                          CFT009
      ** ... and date offset code.                                        CFT009
     C           F12       IFNE 'Y'                                       CFT009
     C                     MOVELOTPDOF    SOFCD                           CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CEU006
     C           STORND    TAG                             ** STORND
     C*
     C/COPY WNCPYSRC,FT0040C068
     C                     ENDSR
     C*
     C************************************************************
     C* END OF STORE SUBROUTINE
     C************************************************************
     C/EJECT                                                              S01435
     C*****************************************************************   S01435
      *                                                               *   S01435
      *  EISWFT   : To access the swift message and set up the detail *   S01435
      *             screen fields from this message                   *   S01435
      *                                                               *   S01435
      *  CALLED BY: Main section                                      *   S01435
      *                                                               *   S01435
      *  CALLS    : *NONE                                             *   S01435
      *                                                               *   S01435
     C*****************************************************************   S01435
     CSR         EISWFT    BEGSR                                          S01435
      *                                                                   S01435
      *  Set up subroutine stack name                                     S01435
      *                                                                   S01435
     C                     ADD  1         Q                               S01435
     C                     MOVEL'EISWFT'  @STK,Q                          S01435
      * Settlement amt currency number of decimal positions               CFT014
      *                                                                   CGL009
     C           *LIKE     DEFN WCYNDP    SCNBDP                          CGL009
      * Payment amt currency number of decimal positions                  CFT014
     C           *LIKE     DEFN WCYNDP    PCNBDP                          CGL009
      * Notify delivery amt currency number of decimal positions          CFT014
     C           *LIKE     DEFN WCYNDP    PDNBDP                          CGL009
      * EURO currency number of decimal positions                         CFT014
     C           *LIKE     DEFN WCYNDP    EUNBDP                          CGL009
      * Sender's charges currency number of decimal positions             CFT014
     C           *LIKE     DEFN WCYNDP    CHNBDP                          CFT014
      * Receiver's charges currency number of decimal positions           CFT014
     C           *LIKE     DEFN WCYNDP    RCNBDP                          CFT014
      * Transaction amt currency number of decimal positions              CFT014
     C           *LIKE     DEFN WCYNDP    TRNBDP                          CFT014
      *                                                                   S01435
      * Call ME1100 to translate the data of the messages for FT fields   S01435
      *                                                                   S01435
     C                     CALL 'ME1100'               8080               S01435
     C                     PARM '*TRANS  '#ACT    8        Action         S01435
     C                     PARM           PHEAD            General DetailsS01435
     C                     PARM *BLANKS   PDATA            Message DetailsS01435
     C                     PARM *BLANKS   PDAT2            MsgDetlExt'n                       CSW209
     C                     PARM *BLANKS   RTN     7        Return Code    S01435
     C/COPY WNCPYSRC,FT0040C222
      *                                                                   S01435
      *  If call to program resulted in an error then end program.        S01435
      *                                                                   S01435
     C           RTN       IFEQ '*ERROR*'                                 S01435
     C           *IN80     OREQ '1'                                       S01435
     C                     Z-ADD50        W0ERNB           ************   S01435
     C                     MOVEL'*CALL   'W0FILE           *DB ERR 50 *   S01435
     C                     MOVEL*BLANKS   W0KEY            ************   S01435
     C                     MOVEL'ME1100'  W0KEY                           S01435
     C                     MOVELERR@,1    W0NARR                          S01435
     C                     EXSR SRERR                                     S01435
     C                     END                                            S01435
      *                                                                   S01435
      * Set up the detail screen fields from the message.                 S01435
      *                                                                   S01435
      **Destination*                                                S01435CGL009
      ***************                                               S01435CGL009
      **If*Intermediary*Bank*is*blank,*use*'A/c*with*Institution'   S01435CGL009
      **details,*otherwise*use*Intermediary*Bank*details*           S01435CGL009
      ***************                                               S01435CGL009
     C***********P56       IFEQ *BLANKS                             S01435CGL009
      ***************                                               S01435CGL009
     C***********P57       IFNE *BLANKS                             S01435CGL009
     C*********************MOVELP57       DSTRAN                    S01435CGL009
     C*********************MOVELTMLIN1    SDST1                     S01435CGL009
     C*********************MOVELTMLIN2    SDST2                     S01435CGL009
     C*********************MOVELTMLIN3    SDST3                     S01435CGL009
     C*********************MOVELTMLIN4    SDST4                     S01435CGL009
     C*********************ELSE                                     S01435CGL009
     C*********************MOVELP58       DSTRAN                    S01435CGL009
     C*********************MOVELTMLIN1    SDST1                     S01435CGL009
     C*********************MOVELTMLIN2    SDST2                     S01435CGL009
     C*********************MOVELTMLIN3    SDST3                     S01435CGL009
     C*********************MOVELTMLIN4    SDST4                     S01435CGL009
     C*********************END                                      S01435CGL009
      *********************                                         S01435CGL009
     C*********************ELSE                                     S01435CGL009
      *********************                                         S01435CGL009
      **Intermediary*Bank*entered********                           S01435CGL009
      *********************                                         S01435CGL009
     C*********************MOVELP56       DSTRAN                    S01435CGL009
     C*********************MOVELTMLIN1    SDST1                     S01435CGL009
     C*********************MOVELTMLIN2    SDST2                     S01435CGL009
     C*********************MOVELTMLIN3    SDST3                     S01435CGL009
     C*********************MOVELTMLIN4    SDST4                     S01435CGL009
      *********************                                         S01435CGL009
      **Account*with*Bank*(only*filled*if*Intermediary*Bank*exist)  S01435CGL009
      *********************                                         S01435CGL009
     C***********P57       IFNE *BLANKS                             S01435CGL009
     C*********************MOVELP57       DSTRAN                    S01435CGL009
     C*********************MOVELTMLIN1    ACB1                      S01435CGL009
     C*********************MOVELTMLIN2    ACB2                      S01435CGL009
     C*********************MOVELTMLIN3    ACB3                      S01435CGL009
     C*********************MOVELTMLIN4    ACB4                      S01435CGL009
     C*********************MOVELTMLIN5    ACB5                      S01435CGL009
     C*********************END                                      S01435CGL009
      *********************                                         S01435CGL009
     C*********************END                                      S01435CGL009
      *                                                                   S01435
      * Ordering Customer                                                 S01435
      *                                                                   S01435
     C                     SELEC                                          CGL009
      ** Special rule for FONTIS                                          CGL009
      ** - Ordering customer is mapped with mapped with the A/C to be     CGL009
      ** debited                                                          CGL009
      ** - Ordering bank is blank                                         CGL009
     C           PNWRK     WHEQ 'FONTIS'                                  CGL009
     C                     MOVELP53       DSTRAN                          CGL009
     C                     MOVEATMLIN1    @I35                            CGL009
     C                     EXSR SLSH35                                    CGL009
     C                     MOVEA@O35      WAC                             CGL009
     C                     MOVEL'N'       WACDMP                          CGL009
     C                     EXSR RTACNT                                    CGL009
     C           WACRTN    IFEQ *BLANK                                    175474
      ** If it is a G/L account we format it in a way it is               CGL009
      ** interpreted as a partial account in the validation modules.      CGL009
      ** If it is a retail one, we don't format it                        CGL009
     C           WACLN     IFEQ 10                                        CGL009
     C                     MOVEA@O35      SORC1                           CGL009
     C                     ELSE                                           CGL009
     C           3         SUBSTO35:1     WPTBCH                          CGL009
     C           6         SUBSTO35:4     WPTCST                          CGL009
     C********** 4         SUBSTO35:13    WPTACD                                       CGL009 CGL029
     C********** 2         SUBSTO35:17    WPTSQN                                       CGL009 CGL029
     C           10        SUBSTO35:13    WPTACD                                              CGL029
     C           2         SUBSTO35:23    WPTSQN                                              CGL029
     C                     MOVELDSPTAC    SORC1                           CGL009
     C                     ENDIF                                          CGL009
     C************LIKE     DEFN WACCY     W53CCY                    CGL009175475
     C*********************MOVELWACCY     W53CCY                    CGL009175475
     C                     MOVELWACBCH    SBRCA                           CGL009
     C                     MOVELWACBCH    PBRCA                           170801
     C                     ELSE                                           175474
      ** If no valid account in tag 53 we concatenate line of             175474
      ** 53 (A/C debited)  + first lines of 50 (Ord Cust)                 175474
     C                     MOVEA@O35      SORC1                           175474
     C                     MOVELP50       DSTRAN                          175474
     C                     MOVELTMLIN1    SORC2                           175474
     C                     MOVELTMLIN2    SORC3                           175474
     C                     MOVELTMLIN3    SORC4                           175474
     C*********************MOVEL*BLANK    W53CCY                    175474175475
      ** End of account validation                                        175474
     C                     ENDIF                                          175474
      *                                                                   CGL009
      ** Other Networks                                                   CGL009
     C                     OTHER                                          CGL009
      *                                                                   CGL009
     C/COPY WNCPYSRC,FT0040C131
     C           P50       IFNE *BLANKS                                   S01435
     C                     MOVELP50       DSTRAN                          S01435
     C                     MOVELTMLIN1    SORC1                           S01435
     C                     MOVELTMLIN2    SORC2                           S01435
     C                     MOVELTMLIN3    SORC3                           S01435
     C                     MOVELTMLIN4    SORC4                           S01435
     C                     END                                            S01435
      *                                                                   CGL009
     C                     ENDSL                                          CGL009
      *                                                                   S01435
      * Ordering Bank file fields                                         S01435
      *                                                                   S01435
     C                     SELEC                                          CGL009
      *                                                                   CGL009
      ** Special rule for FONTIS                                          CGL009
     C           PNWRK     WHEQ 'FONTIS'                                  CGL009
      ** Ordering bank is never filled with FONTIS                        CGL009
      *                                                                   CGL009
      ** Other networks                                                   CGL009
     C                     OTHER                                          CGL009
      *                                                                   S01435
      * If Ordering Institution not blank, use it                         S01435
      * otherwise use Sender details                                      S01435
      *                                                                   S01435
     C           P52       IFNE *BLANKS                                   S01435
     C                     MOVELP52       DSTRAN                          S01435
     C                     MOVELTMLIN1    OPORB1                          S01435
     C                     MOVELTMLIN2    OPORB2                          S01435
     C                     MOVELTMLIN3    OPORB3                          S01435
     C                     MOVELTMLIN4    OPORB4                          S01435
     C                     MOVELTMLIN5    OPORB5                          S01435
      *                                                                   S01435
      * If network is swift, find field type                              S01435
      * otherwise default it to 'A'.                                      S01435
      *                                                                   S01435
     C           PNWRK     IFEQ 'SWIFT '                                  S01435
      *                                                                   S01435
      * Set up field type, if A->S, B->A, D->A                            S01435
      *                                                                   S01435
     C           1         SUBSTTRTAG:4   #WK1    1                       S01435
     C           #WK1      IFEQ 'A'                                       S01435
     C                     MOVEL'S'       OPORBT                          S01435
     C                     ELSE                                           S01435
      *                                                                   S01435
     C           #WK1      IFEQ 'B'                                       S01435
     C                     MOVEL'A'       OPORBT                          S01435
     C                     ELSE                                           S01435
     C                     MOVEL'A'       OPORBT                          S01435
     C                     END                                            S01435
     C                     END                                            S01435
      *                                                                   S01435
     C                     ELSE                                           S01435
      *                                                                   S01435
      * network is not swift                                              S01435
     C                     MOVEL'A'       OPORBT                          S01435
     C                     END                                            S01435
      *                                                                   S01435
     C                     ELSE                                           S01435
      * Sender details                                                    S01435
      *                                                                   S01435
     C                     MOVELPSNDR     OPORB1                          S01435
      *                                                                   S01435
      * If network is swift, set up field type to 'S'                     S01435
      * otherwise default it to 'A'.                                      S01435
      *                                                                   S01435
     C           PNWRK     IFEQ 'SWIFT '                                  S01435
     C                     MOVEL'S'       OPORBT                          S01435
     C                     ELSE                                           S01435
     C                     MOVEL'A'       OPORBT                          S01435
     C                     END                                            S01435
      *                                                                   S01435
     C                     END                                            S01435
      *                                                                   S01435
      * If pay message from SWIFT move MT202 to order cust1               S01435
      * and OPORB* fields to fields 2 3 and 4.                            S01435
      *                                                                   S01435
     C           P52       IFNE *BLANKS                                   S01435
     C           SORC1     ANDEQ*BLANKS                                   S01435
     C           PNWRK     ANDEQ'SWIFT '                                  S01435
     C           PMTPY     IFEQ '200'                                     S01435
     C           PMTPY     OREQ '201'                                     S01435
     C           PMTPY     OREQ '202'                                     S01435
     C           PMTPY     OREQ '203'                                     S01435
     C           PMTPY     OREQ '204'                                     CFT003
     C           PMTPY     OREQ '205'                                     S01435
     C                     MOVELORCFLD    SORC1                           S01435
     C                     MOVELTMLIN1    SORC2                           S01435
     C                     MOVELTMLIN2    SORC3                           S01435
     C                     MOVELTMLIN3    SORC4                           S01435
     C                     END                                            S01435
     C                     END                                            S01435
      *                                                                   S01435
      **Receiver's*Correspondent***********************************S01435 CFT014
      * Ordering Bank                                                     CFT014
      * If Third Reimbursement Institution is not blank, use it           CFT014
      * otherwise                                                         CFT014
      *                                                                   S01435
      * If Receivers Correspondent is not blank, use it                   S01435
      * otherwise use Senders Correspondent. If both are blank            S01435
      * use Sender details.                                               S01435
     C           P55       IFNE *BLANKS                                   CFT014
     C                     MOVELP55       DSTRAN                          CFT014
     C                     MOVELTMLIN1    SORBK                           CFT014
     C                     ELSE                                           CFT014
      *                                                                   S01435
     C           P54       IFNE *BLANKS                                   S01435
      *                                                                   S01435
     C                     MOVELP54       DSTRAN                          S01435
     C                     MOVELTMLIN1    SORBK                           S01435
      *                                                                   S01435
     C                     ELSE                                           S01435
      *                                                                   S01435
     C           P53       IFNE *BLANKS                                   S01435
     C                     MOVELP53       DSTRAN                          S01435
     C                     MOVELTMLIN1    SORBK                           S01435
      *                                                                   S01435
     C                     ELSE                                           S01435
      *                                                                   S01435
     C                     MOVELPSNDR     SORBK                           S01435
      *                                                                   S01435
     C                     END                                            S01435
     C                     END                                            S01435
     C                     ENDIF                                          CFT014
      *                                                                   CGL009
     C                     ENDSL                                          CGL009
      *                                                                   S01435
      * Beneficiary                                                       S01435
      *                                                                   S01435
      * If Beneficiary Customer is not blank, use it                      S01435
      * otherwise use Beneficiary Institution details                     S01435
      *                                                                   S01435
     C           P59       IFNE *BLANKS                                   S01435
      *                                                                   S01435
     C                     MOVELP59       DSTRAN                          S01435
     C                     MOVELTMLIN1    BNC1                            S01435
     C                     MOVELTMLIN2    BNC2                            S01435
     C                     MOVELTMLIN3    BNC3                            S01435
     C                     MOVELTMLIN4    BNC4                            S01435
     C                     MOVELTMLIN5    BNC5                            S01435
      *                                                                   S01435
     C                     ELSE                                           S01435
      *                                                                   S01435
     C           P58       IFNE *BLANKS                                   S01435
     C                     MOVELP58       DSTRAN                          S01435
     C                     MOVELTMLIN1    BNC1                            S01435
     C                     MOVELTMLIN2    BNC2                            S01435
     C                     MOVELTMLIN3    BNC3                            S01435
     C                     MOVELTMLIN4    BNC4                            S01435
     C                     MOVELTMLIN5    BNC5                            S01435
     C                     END                                            S01435
      *                                                                   S01435
     C                     END                                            S01435
      *                                                                   S01435
      * Msg Unique Reference                                              S01435
     C                     Z-ADDPHMSGR    OPMSGR                          S01435
      *                                                                   S01435
      * Part Number                                                       S01435
     C                     Z-ADDPHPART    OPKPRT                          S01435
      *                                                                   S01435
      * Swift Priority Code                                               S01435
     C                     MOVE PMPRY     SSWPC                           S01435
      *                                                                   S01435
      * Branch Code                                                       S01435
     C           PBRCA     IFNE *BLANKS                                   S01435
     C                     MOVELPBRCA     SBRCA                           S01435
     C                     END                                            S01435
      *                                                                   S01435
      * Related Reference                                                 S01435
      *                                                                   S01435
      * If MT100 type of message use Transaction Reference no.            S01435
      * otherwise use related referance.                                  S01435
      *                                                                   S01435
     C           PMTPY     IFEQ '100'                                     S01435
      *                                                                   S01435
     C           P20       IFNE *BLANKS                                   S01435
     C                     MOVELP20       DSTRAN                          S01435
     C                     MOVELTTREF     RLPR                            S01435
     C                     END                                            S01435
      *                                                                   S01435
     C                     ELSE                                           S01435
      *                                                                   S01435
     C           P21       IFNE *BLANKS                                   S01435
     C                     MOVELP21       DSTRAN                          S01435
     C                     MOVELTTREF     RLPR                            S01435
     C                     END                                            S01435
      *                                                                   S01435
     C                     END                                            S01435
     C           CFT014    IFEQ 'Y'                                       CFT014
      ** Sender's Charge field                                            CFT014
     C           P71FX     IFNE *BLANKS                                   CFT014
     C                     MOVEL*BLANK    DSTRAN                          CFT014
     C                     MOVELP71FX     DSTRAN                          CFT014
     C                     Z-ADD1         I                               CFT014
     C                     MOVEL*BLANK    LFLT                            CFT014
     C                     MOVELTMLIN1    TV1                             CFT014
     C                     MOVELTMLIN2    TV2                             CFT014
     C                     MOVELTMLIN3    TV3                             CFT014
     C                     MOVELTMLIN4    TV4                             CFT014
     C                     MOVELTMLIN5    TV5                             CFT014
     C           I         DOWLE5                                         CFT014
     C           LFLT,I    ANDNE*BLANK                                    CFT014
     C                     MOVEL*BLANK    DSTRAN                          CFT014
     C                     MOVELLFLT,I    DSTRAN                          CFT014
     C                     EXSR RTPCA                                     CFT014
     C                     MOVELWCACY     WCYCCY                          CFT014
     C                     MOVEL'N'       WCYDMP                          CFT014
     C                     EXSR RTCCYD                                    CFT014
     C           WCYRTN    IFEQ *BLANK                                    CFT014
     C                     MOVE WCAAM     ZFIELD                          CFT014
     C           13        SUB  WCYNDP    ZADIG                           CFT014
     C                     Z-ADDWCYNDP    ZADEC                           CFT014
     C                     EXSR ZALIGN                                    CFT014
     C                     MOVE ZFIELD    CGA,I                           CFT014
     C                     MOVELWCACY     CGC,I                           CFT014
     C                     ENDIF                                          CFT014
     C                     ADD  1         I                               CFT014
     C                     ENDDO                                          CFT014
     C                     ENDIF                                          CFT014
      ** Receiver's Charge field                                          CFT014
     C           P71G      IFNE *BLANKS                                   CFT014
     C                     MOVEL*BLANK    DSTRAN                          CFT014
     C                     MOVEL'N'       MGRCUS                          CFT014
     C                     MOVELP71G      DSTRAN                          CFT014
     C                     EXSR RTPCA                                     CFT014
     C           *LIKE     DEFN WCACY     WRCHCY                          CFT014
     C           *LIKE     DEFN WCAAM     WRCHAM                          CFT014
      ** Memorize receiver's charges currency / amount                    CFT014
      ** to pass as input parameter to S/R OV32AM                         CFT014
     C                     MOVELWCACY     WRCHCY                          CFT014
     C                     MOVELWCAAM     WRCHAM                          CFT014
     C                     MOVELWCACY     WCYCCY                          CFT014
     C                     MOVEL'N'       WCYDMP                          CFT014
     C                     EXSR RTCCYD                                    CFT014
     C           WCYRTN    IFEQ *BLANK                                    CFT014
     C                     MOVE WCAAM     ZFIELD                          CFT014
     C           13        SUB  WCYNDP    ZADIG                           CFT014
     C                     Z-ADDWCYNDP    ZADEC                           CFT014
     C                     EXSR ZALIGN                                    CFT014
     C                     MOVE ZFIELD    MGRCNW                          CFT014
     C                     MOVELWCACY     MGRCCN                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   S01435
      * Value Date/Ccy/Amount                                             S01435
      *                                                                   S01435
     C           PDCA      IFNE *BLANKS                                   S01435
     C                     SELEC                                          CGL009
      ** Special rule for FONTIS                                          CGL009
     C           PNWRK     WHEQ 'FONTIS'                                  CGL009
     C                     MOVELPDCA      DSTRAN                          CGL009
     C                     EXSR RTPDCA                                    CGL009
     C                     MOVELW32CY     SPCCY                           CGL009
     C                     MOVELW32CY     SPCCY                           CGL009
     C                     MOVELW32AM     WNLAM                           CGL009
     C                     EXSR TSNULL                                    CGL009
     C           WNLNUL    IFEQ 'N'                                       CGL009
     C                     MOVELW32AM     PYAMA                           CGL009
     C                     ELSE                                           CGL009
     C                     MOVEL*BLANK    PYAMA                           CGL009
     C                     ENDIF                                          CGL009
     C           *LIKE     DEFN W32DYN    WVLDT                           CGL009
     C                     Z-ADDW32DYN    WVLDT                           CGL009
     C                     MOVE W32DT     PYVD                            CGL009
     C                     MOVE W32DT     PYDT                            CGL009
      *                                                                   CGL009
      ** Other Networks                                                   CGL009
     C                     OTHER                                          CGL009
     C                     MOVELPDCA      DSTRAN                          S01435
      *                                                                   S01435
      * MMDDYY format display                                             S01435
      *                                                                   S01435
     C           *IN98     IFEQ '1'                                       S01435
     C                     MOVELTVVDAT    SWDT                            S01435
     C                     MOVE SDD       DD      20                      S01435
     C                     MOVE SYY       SDD                             S01435
     C                     MOVE SMM       SYY                             S01435
     C                     MOVE DD        SMM                             S01435
     C                     MOVE SWDT      PYDT                            S01435
     C                     ELSE                                           S01435
      *                                                                   S01435
      * DDMMYY format display                                             S01435
      *                                                                   S01435
     C                     MOVELTVVDAT    SWDT                            S01435
     C                     MOVE SDD       DD                              S01435
     C                     MOVE SYY       SDD                             S01435
     C                     MOVE DD        SYY                             S01435
     C                     MOVE SWDT      PYDT                            S01435
     C                     END                                            S01435
      *                                                                   S01435
      * Currency                                                          S01435
      *                                                                   S01435
     C           CFT012    IFEQ 'N'                                       CFT012
     C                     MOVELTVCCY     SSMCY                           S01435
     C                     ELSE                                           CFT012
     C                     MOVELTVCCY     SPCCY                           CFT012
     C                     END                                            CFT012
      * Amount                                                            S01435
      *                                                                   S01435
      * Format amount field (change ',' decimal point to '.').            S01435
      *                                                                   S01435
     C                     MOVEATVAMT     YA1                             S01435
     C                     Z-ADD1         C       30                      S01435
      *                                                                   S01435
     C           C         DOUGT15                                        S01435
      *                                                                   S01435
     C           YA1,C     IFEQ ','                                       S01435
     C                     MOVE '.'       YA1,C                           S01435
     C                     Z-ADD16        C                               S01435
     C                     ELSE                                           S01435
     C                     ADD  1         C                               S01435
     C                     END                                            S01435
      *                                                                   S01435
     C                     END                                            S01435
      *                                                                   S01435
     C                     MOVEAYA1       AMT    15                       S01435
     C           CFT012    IFEQ 'N'                                       CFT012
     C           CFT014    IFEQ 'Y'                                       CFT014
     C           P71G      ANDNE*BLANK                                    CFT014
      ** Need to overwrite transaction amount to allow for the            CFT014
      ** receiver's charges                                               CFT014
     C                     MOVELSWDT      ZDATE                           CFT014
     C                     EXSR ZDATE1                                    CFT014
     C                     Z-ADDZDAYNO    WOVVLD                          CFT014
     C                     MOVELSSMCY     WOVICY                          CFT014
     C                     MOVELAMT       WOVIAM                          CFT014
     C                     MOVELWRCHCY    WOVRCY                          CFT014
     C                     MOVELWRCHAM    WOVRAM                          CFT014
     C                     MOVEL'*SUB'    WOVOPR                          CFT014
     C                     EXSR OV32AM                                    CFT014
     C                     MOVELWOVAMT    SMAMA                           CFT014
     C                     ELSE                                           CFT014
     C                     MOVELAMT       SMAMA                           S01435
     C                     ENDIF                                          CFT014
     C                     ELSE                                           CFT012
     C           CFT014    IFEQ 'Y'                                       CFT014
     C           P71G      ANDNE*BLANK                                    CFT014
     C                     MOVEL*BLANK    SMAMA                           CFT014
      ** Need to overwrite transaction amount to allow for the            CFT014
      ** receiver's charges                                               CFT014
     C                     MOVELSWDT      ZDATE                           CFT014
     C                     EXSR ZDATE1                                    CFT014
     C                     Z-ADDZDAYNO    WOVVLD                          CFT014
     C                     MOVELSPCCY     WOVICY                          CFT014
     C                     MOVELAMT       WOVIAM                          CFT014
     C                     MOVELWRCHCY    WOVRCY                          CFT014
     C                     MOVELWRCHAM    WOVRAM                          CFT014
     C                     MOVEL'*SUB'    WOVOPR                          CFT014
     C                     EXSR OV32AM                                    CFT014
     C                     MOVELWOVAMT    PYAMA                           CFT014
     C                     ELSE                                           CFT012
     C                     MOVEL*BLANK    SMAMA                           CFT012
     C                     MOVELAMT       PYAMA                           CFT012
     C                     ENDIF                                          CFT014
     C                     END                                            CFT012
      *                                                                   CGL009
     C                     ENDSL                                          CGL009
      *                                                                   CGL009
     C                     END                                            S01435
      *                                                                   S01435
      * Details of Charges                                                S01435
      *                                                                   S01435
     C           P71       IFNE *BLANKS                                   S01435
     C                     MOVELP71       DSTRAN                          S01435
     C                     MOVELTTREF     DTCH                            S01435
     C           PNWRK     IFEQ 'FONTIS'                                  CGL009
     C           TTREF     IFEQ 'OUR'                                     CGL009
     C                     MOVEL'A'       SADDC                           CGL009
     C                     ELSE                                           CGL009
     C                     MOVEL'D'       SADDC                           CGL009
     C                     ENDIF                                          CGL009
     C                     ELSE                                           CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
     C           TTREF     IFEQ 'OUR'                                     CFT014
     C                     MOVEL'A'       SADDC                           CFT014
     C                     ELSE                                           CFT014
     C                     MOVEL'D'       SADDC                           CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
     C                     ELSE                                           CGL009
      *                                                                   CGL009
     C           PNWRK     IFEQ 'FONTIS'                                  CGL009
     C                     MOVEL'D'       SADDC                           CGL009
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
     C                     END                                            S01435
      *                                                                   CGL009
      *                                                                   CRT002
      **  Additional Mapping for CASHIER.                                 CRT002
      *                                                                   CRT002
      **  Draft Currency, Draft Amount.                                   CRT002
      *                                                                   CRT002
     C           SDCA      IFNE *BLANKS                                   CRT002
     C                     Z-ADD0         TVVDAT                          CRT002
     C                     MOVELSDCA      DSTRAN                          CRT002
      *                                                                   CRT002
     C           TVVDAT    IFNE 0                                         CRT002
      *                                                                   CRT002
      **  MMDDYY format display.                                          CRT002
      *                                                                   CRT002
     C           WUDFF     IFEQ 'M'                                       CRT002
     C                     MOVELTVVDAT    SWDT1   6                       CRT002
     C           2         SUBSTSWDT1:5   MM                              CRT002
     C           2         SUBSTSWDT1:3   DDS                             CRT002
     C           2         SUBSTSWDT1:1   YY                              CRT002
     C                     MOVELSWDT2     SPYDT                           CRT002
     C                     ELSE                                           CRT002
      *                                                                   CRT002
      **  DDMMYY format display.                                          CRT002
      *                                                                   CRT002
     C                     MOVELTVVDAT    SWDT1   6                       CRT002
     C           2         SUBSTSWDT1:5   DDS                             CRT002
     C           2         SUBSTSWDT1:3   MM                              CRT002
     C           2         SUBSTSWDT1:1   YY                              CRT002
     C                     MOVELSWDT2     SPYDT                           CRT002
     C                     END                                            CRT002
     C                     END                                            CRT002
      *                                                                   CRT002
      **  Currency.                                                       CRT002
      *                                                                   CRT002
     C                     MOVELTVCCY     SPCCY                           CRT002
      *                                                                   CRT002
      **  Format amount field (change ',' decimal point to '.').          CRT002
      *                                                                   CRT002
     C                     MOVEA*BLANKS   YA1                             CRT002
     C                     MOVEATVAMT     YA1                             CRT002
     C                     Z-ADD1         C       30                      CRT002
      *                                                                   CRT002
     C           C         DOUGT15                                        CRT002
     C           YA1,C     IFEQ ','                                       CRT002
     C                     MOVE '.'       YA1,C                           CRT002
     C                     Z-ADD16        C                               CRT002
     C                     ELSE                                           CRT002
     C                     ADD  1         C                               CRT002
     C                     END                                            CRT002
     C                     END                                            CRT002
      *                                                                   CRT002
     C                     MOVEAYA1       AMT    15                       CRT002
     C                     MOVELAMT       SPYAM                           CRT002
     C                     END                                            CRT002
      *                                                                   CRT002
      **  Funding Currency, Funding Amount.                               CRT002
      *                                                                   CRT002
     C           PDC2      IFNE *BLANKS                                   CRT002
     C                     Z-ADD0         TVVDAT                          CRT002
     C                     MOVELPDC2      DSTRAN                          CRT002
      *                                                                   CRT002
     C           TVVDAT    IFNE 0                                         CRT002
      *                                                                   CRT002
      **  MMDDYY format display.                                          CRT002
      *                                                                   CRT002
     C           WUDFF     IFEQ 'M'                                       CRT002
     C                     MOVELTVVDAT    SWDT1   6                       CRT002
     C           2         SUBSTSWDT1:5   MM                              CRT002
     C           2         SUBSTSWDT1:3   DDS                             CRT002
     C           2         SUBSTSWDT1:1   YY                              CRT002
     C                     MOVELSWDT2     SSLDT                           CRT002
     C                     ELSE                                           CRT002
      *                                                                   CRT002
      **  DDMMYY format display.                                          CRT002
      *                                                                   CRT002
     C                     MOVELTVVDAT    SWDT1   6                       CRT002
     C           2         SUBSTSWDT1:5   DDS                             CRT002
     C           2         SUBSTSWDT1:3   MM                              CRT002
     C           2         SUBSTSWDT1:1   YY                              CRT002
     C                     MOVELSWDT2     SSLDT                           CRT002
     C                     END                                            CRT002
     C                     END                                            CRT002
      *                                                                   CRT002
      **  Currency.                                                       CRT002
      *                                                                   CRT002
     C                     MOVELTVCCY     SSMCY                           CRT002
      *                                                                   CRT002
      **  Format amount field (change ',' decimal point to '.').          CRT002
      *                                                                   CRT002
     C                     MOVEA*BLANKS   YA1                             CRT002
     C                     MOVEATVAMT     YA1                             CRT002
     C                     Z-ADD1         C       30                      CRT002
      *                                                                   CRT002
     C           C         DOUGT15                                        CRT002
     C           YA1,C     IFEQ ','                                       CRT002
     C                     MOVE '.'       YA1,C                           CRT002
     C                     Z-ADD16        C                               CRT002
     C                     ELSE                                           CRT002
     C                     ADD  1         C                               CRT002
     C                     END                                            CRT002
     C                     END                                            CRT002
      *                                                                   CRT002
     C                     MOVEAYA1       AMT    15                       CRT002
     C                     MOVELAMT       SSMAM                           CRT002
     C                     END                                            CRT002
     C/COPY WNCPYSRC,FT0040C116
      *                                                                   CGL009
      * Bank to Bank Information                                          CGL009
      *                                                                   CGL009
     C                     SELEC                                          CGL009
      ** Special rule for FONTIS                                          CGL009
     C           PNWRK     WHEQ 'FONTIS'                                  CGL009
     C           P72       IFEQ *BLANKS                                   CGL009
      ***Settlement*CCY*will*be*the*same*as*the*account*to*be*debiteCGL009175475
     C*********************MOVELW53CCY    SSMCY                     CGL009175475
      ** Should never happen because FONTIS is supposed to send the       175475
      ** settlement currency via :72: /ORIG/                              175475
     C                     MOVEL*BLANKS   BBI1                            CGL009
     C                     MOVEL*BLANKS   BBI2                            CGL009
     C                     MOVEL*BLANKS   BBI3                            CGL009
     C                     MOVEL*BLANKS   BBI4                            CGL009
     C                     MOVEL*BLANKS   BBI5                            CGL009
     C                     MOVEL*BLANKS   BBI6                            CGL009
     C                     ELSE                                           CGL009
      *                                                                   CGL009
     C                     MOVELP72       DSFONT                          CGL009
     C                     MOVEL'/ORIG/'  WCW                             CGL009
     C                     MOVELFONT72    WCWLIN                          CGL009
     C                     EXSR CWAMCY                                    CGL009
     C           WCWCY     IFNE *BLANK                                    CGL009
     C                     MOVELWCWCY     SSMCY                           CGL009
     C                     ELSE                                           CGL009
      ** Should never happen because FONTIS is supposed to send the       175475
      ** settlement currency via :72: /ORIG/                              175475
     C*********************MOVELW53CCY    SSMCY                     CGL009175475
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
     C                     MOVEL'/REF/'   WCW                             175479
     C                     MOVELFONT72    WCWLIN                          175479
     C                     Z-ADD30        WCWLEN                          175479
     C                     EXSR CWVAL                                     175479
     C           WCWVAL    IFNE *BLANK                                    175479
     C                     MOVELWCWVAL    SFDLR                           175479
     C                     ENDIF                                          175479
      *                                                                   175479
     C                     MOVELWCWAM     WNLAM                           CGL009
     C                     EXSR TSNULL                                    CGL009
     C           WNLNUL    IFEQ 'N'                                       CGL009
     C                     MOVELWCWAM     SMAMA                           CGL009
     C                     ELSE                                           CGL009
     C                     MOVEL*BLANK    SMAMA                           CGL009
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
     C           CEU006    IFEQ 'Y'                                       CGL009
      **  Retrieve notified delivery currency and amount                  CGL009
     C                     MOVEL'/OCMT/'  WCW                             CGL009
     C                     MOVELFONT72    WCWLIN                          CGL009
     C                     EXSR CWAMCY                                    CGL009
     C           WCWCY     IFNE *BLANK                                    CGL009
     C                     MOVELWCWCY     SPDCY                           CGL009
     C                     ENDIF                                          CGL009
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
     C                     MOVEL'/RATE/'  WCW                             CGL009
     C                     MOVELFONT72    WCWLIN                          CGL009
     C                     EXSR CWRATE                                    CGL009
     C                     MOVELWCWRT     WNLAM                           CGL009
     C                     EXSR TSNULL                                    CGL009
     C           WNLNUL    IFEQ 'Y'                                       CGL009
     C                     MOVEL*BLANK    WCWRT                           CGL009
     C                     ELSE                                           CGL009
      ** Decimal places in FT are stored on 8 digits                      CGL009
      ** => truncated if greater                                          CGL009
     C           WCWDPT    IFGT 8                                         CGL009
     C           '.'       SCAN WCWRT     I       20                      CGL009
      ** Extract Digits + comma                                           CGL009
     C           I         SUBSTWCWRT:1   #014A  14 P                     CGL009
     C                     ADD  1         I       20                      CGL009
      ** Extract Decimals after comma                                     CGL009
     C           8         SUBSTWCWRT:I   #008A   8 P                     CGL009
     C           #014A     CAT  #008A:0   WCWRT     P                     CGL009
     C                     ENDIF                                          CGL009
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
     C           WCWRT     IFNE *BLANK                                    CGL009
      *                                                                   CGL009
     C                     MOVE WCWRT     RATEA     P                     CGL009
      ** code work /RATE/ found in Bank to Bank information               CGL009
     C                     ENDIF                                          CGL009
     C*                                                                   CGL009
     C                     EXSR ICCHK                                     CGL009
     C*                                                                   CGL009
     C           FOUND     IFEQ 'Y'                                       CGL009
     C                     MOVEL*BLANK    BBI6                            CGL009
     C                     MOVELFN72L2    BBI1                            CGL009
     C                     MOVELFN72L3    BBI2                            CGL009
     C                     MOVELFN72L4    BBI3                            CGL009
     C                     MOVELFN72L5    BBI4                            CGL009
     C                     MOVELFN72L6    BBI5                            CGL009
     C                     ELSE                                           CGL009
     C                     MOVELFN72L1    BBI1                            CGL009
     C                     MOVELFN72L2    BBI2                            CGL009
     C                     MOVELFN72L3    BBI3                            CGL009
     C                     MOVELFN72L4    BBI4                            CGL009
     C                     MOVELFN72L5    BBI5                            CGL009
     C                     MOVELFN72L6    BBI6                            CGL009
     C                     ENDIF                                          CGL009
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
      ** Other Networks                                                   CGL009
     C                     OTHER                                          CGL009
      *                                                                   CEU006
      **  Retrieve notified delivery currency and amount                  CEU006
      *                                                                   CEU006
     C*********************MOVEL'012345'  @CHK   11                 CEU006CGL009
     C*********************MOVE '6789.'   @CHK                      CEU006CGL009
      *                                                                   CEU006
     C           '/OCMT/'  SCAN P72:1     @F      30     81               CEU006
      *                                                                   CEU006
     C           *IN81     IFEQ *ON                                       CEU006
      *                                                                   CEU006
      * Map currency code -> SNDCY                                        CEU006
     C                     ADD  6         @F                              CEU006
     C           3         SUBSTP72:@F    SNDCY                           CEU006
      * Map amount -> NDAMA                                               CEU006
      * Move possible 15 chars to work array and work string              CEU006
     C                     ADD  3         @F                              CEU006
     C           15        SUBSTP72:@F    @S     15                       CEU006
     C                     MOVEA@S        @A                              CEU006
     C                     CLEAR@S                                        CEU006
      *                                                                   CEU006
      * If ',' in amount string @S change to '.'                          CEU006
      * Only need to check valid chars till one ',' found                 CEU006
     C                     Z-ADD1         @C      30                      CEU006
     C                     MOVE *BLANKS   @T      1                       CEU006
      *                                                                   CEU006
     C           1         DO   15        @C                              CEU006
     C                     MOVE @A,@C     @T                              CEU006
     C           @T        IFEQ ','                                       CEU006
     C                     MOVE '.'       @A,@C                           CEU006
     C                     LEAVE                                          CEU006
     C                     ENDIF                                          CEU006
     C                     ENDDO                                          CEU006
      *                                                                   CEU006
     C                     Z-ADD1         @C                              CEU006
     C                     MOVE *BLANKS   @T      1                       CEU006
     C                     MOVEA@A        @S                              CEU006
      * Get amount - upto 15 chars possible                               CEU006
     C           @C        DOUGT15                                        CEU006
     C                     MOVE @A,@C     @T                              CEU006
     C           @CHK      CHECK@T        @F             82               CEU006
      *                                                                   CEU006
      * Char not valid must be end of amount                              CEU006
     C           *IN82     IFEQ *ON                                       CEU006
     C           @C        IFNE 1                                         CEU006
     C           @C        SUB  1         @F                              CEU006
     C           @F        SUBST@S:1      NDAMA                           CEU006
     C                     ENDIF                                          CEU006
     C                     LEAVE                                          CEU006
     C                     ENDIF                                          CEU006
      * All chars in string ok                                            CEU006
     C           @C        IFEQ 15                                        CEU006
     C                     MOVEL@S        NDAMA                           CEU006
     C                     ENDIF                                          CEU006
      *                                                                   CEU006
     C                     ADD  1         @C                              CEU006
      *                                                                   CEU006
     C                     ENDDO                                          CEU006
     C/COPY WNCPYSRC,FT0040C120
      *                                                             CEU006CFT003
     C*********************ELSE                                     CEU006CFT003
      **Check*if*message*ccy is an 'In' ccy                         CEU006CFT003
     C*********************CALL 'AOCURRR0'                          CEU006CFT003
     C*********************PARM *BLANKS   @RETC   7                 CEU006CFT003
     C*********************PARM '*KEY   ' @OPTN   7                 CEU006CFT003
     C*********************PARM SSMCY     @CURR   3                 CEU006CFT003
     C***********SDCURR****PARM SDCURR    DSSDY                     CEU006CFT003
      *********************                                         CEU006CFT003
     C***********@RETC*****IFNE *BLANKS                             CEU006CFT003
     C*********************MOVEL'AOCURRR0'DBFILE                    CEU006CFT003
     C*********************MOVEL'*CALL'   DBKEY                     CEU006CFT003
     C*********************Z-ADD40        DBASE                     CEU006CFT003
     C*********************EXSR SRERR                               CEU006CFT003
     C*********************ENDIF                                    CEU006CFT003
      **If*'In'*ccy********                                         CEU006CFT003
     C***********A6INCY****IFEQ 'Y'                                 CEU006CFT003
     C***********A6TPSD****ANDLEBJRDNB                              CEU006CFT003
     C*********************MOVE TVCCY     SNDCY                     CEU006CFT003
     C*********************MOVE SMAMA     NDAMA                     CEU006CFT003
     C*********************ENDIF                                    CEU006CFT003
      *                                                                   CEU006
     C                     ENDIF                                          CEU006
      *                                                                   CGL009
     C                     ENDSL                                          CGL009
      *                                                                   CEU006
      * Destination                                                       CGL009
     C                     SELEC                                          CGL009
      *                                                                   CGL009
      ** Special rule for FONTIS                                          CGL009
     C           PNWRK     WHEQ 'FONTIS'                                  CGL009
      *                                                                   CGL009
      ** If 56 present, use this to derive Destination, else 57           CGL009
     C           P56       IFNE *BLANK                                    CGL009
     C                     MOVELP56       DSTRAN                          CGL009
      ** Also, along the way, always default Int Bank to 56               CGL009
     C                     MOVELTMLIN1    INB1                            CGL009
     C                     MOVELTMLIN2    INB2                            CGL009
     C                     MOVELTMLIN3    INB3                            CGL009
     C                     MOVELTMLIN4    INB4                            CGL009
     C                     MOVELTMLIN5    INB5                            CGL009
     C                     ELSE                                           CGL009
     C                     MOVELP57       DSTRAN                          CGL009
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
     C           1         SUBSTTRTAG:4   #001A   1                       CGL009
      ** Only applicable :56A:                                            CGL009
     C           #001A     IFEQ 'A'                                       CGL009
     C                     MOVELTMLIN1    #001A                           CGL009
     C           #001A     IFEQ '/'                                       CGL009
     C                     MOVEATMLIN2    @I35                            CGL009
     C                     ELSE                                           CGL009
     C                     MOVEATMLIN1    @I35                            CGL009
     C                     ENDIF                                          CGL009
     C                     EXSR SLSH35                                    CGL009
     C           8         SUBSTO35:1     W9BICC                          CGL009
     C           3         SUBSTO35:9     W9BICB                          CGL009
      *                                                                   CGL009
     C                     CALL 'ME1400'                                  CGL009
     C                     PARM *BLANKS   W9RTN   7                       CGL009
     C                     PARM           W9BICC  8                       CGL009
     C                     PARM           W9BICB  3                       CGL009
     C                     PARM           SDCUST                          CGL009
     C                     PARM           SDCNST                          CGL009
     C                     PARM           MEBICD                          CGL009
     C                     PARM *BLANKS   W9CUST  1                       CGL009
     C                     PARM *BLANKS   W9CNST  1                       CGL009
     C                     PARM *BLANKS   W9BICD  1                       CGL009
      *                                                                   CGL009
      * If Customer details found                                         CGL009
      *                                                                   CGL009
     C           W9CUST    IFEQ 'Y'                                       CGL009
     C           KNOST3    KLIST                                          CGL009
     C                     KFLD           SPCCY                           CGL009
     C                     KFLD           BBCUST                          CGL009
     C           KNOST3    CHAINSDNOSTL3             90                   CGL009
     C           *IN90     IFEQ '0'                                       CGL009
     C                     MOVELA7CYCD    WNOCCY                          CGL009
     C                     MOVELA7NONB    WNONUM                          CGL009
     C                     MOVELDSNOST    SDST1                           CGL009
     C                     ENDIF                                          CGL009
     C                     ENDIF                                          CGL009
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
     C           SDST1     IFEQ *BLANK                                    CGL009
     C           SPCCY     CHAINMEFNODL1             90                   CGL009
     C           *IN90     IFEQ '0'                                       CGL009
     C           CEU006    IFEQ 'Y'                                       CGL009
     C           FHEURO    IFEQ 'Y'                                       CGL009
     C***********BKEURO    CHAINMEFNODL1             90             CGL009175469
     C************IN90     IFEQ '0'                                 CGL009175469
     C           FHEUNO    IFNE *BLANK                                    175469
      ** The rate in /RATE/ is no longer applicable between Settlmt and   CGL009
      ** Payment amounts (now converted in BKEURO)                        CGL009
     C                     MOVEL*BLANK    RATEA                           CGL009
      ** /OCMT/ is redundant                                              CGL009
     C                     MOVEL*BLANK    SPDCY                           CGL009
     C                     MOVEL*BLANK    PDAMA                           CGL009
      *                                                                   CGL009
     C           SMAMA     IFNE *BLANK                                    CGL009
      ** Payment will be computed by the validation programm              CGL009
     C                     MOVE *BLANK    PYAMA                           CGL009
      ** Destination changes => payment currency changes                  CGL009
     C                     MOVELBKEURO    SPCCY                           CGL009
      *                                                                   CGL009
     C                     ELSE                                           CGL009
      *                                                                   CGL009
      ** Convert the old payment amount into the EURO currency            CGL009
     C                     CLEARP#0010                                    CGL009
      *                                                                   CGL009
      ** Retrieve details of payment currency                             CGL009
     C                     MOVELSPCCY     WCYCCY                          CGL009
     C                     MOVEL'N'       WCYDMP                          CGL009
     C                     EXSR RTCCYD                                    CGL009
     C           WCYRTN    IFNE *BLANK                                    CGL009
      ** Blank the amount to make the validation fail.                    CGL009
      ** (Unknown currency or both amounts null)                          CGL009
     C                     MOVE *BLANK    PYAMA                           CGL009
     C                     ELSE                                           CGL009
     C                     Z-ADDWCYNDP    PCNBDP                          CGL009
      *                                                                   CGL009
      ** Retrieve details of BKEURO currency                              CGL009
     C                     MOVELBKEURO    WCYCCY                          CGL009
     C                     MOVEL'N'       WCYDMP                          CGL009
     C                     EXSR RTCCYD                                    CGL009
     C           WCYRTN    IFNE *BLANK                                    CGL009
     C                     MOVELBKEURO    SPCCY                           CGL009
     C                     MOVE *BLANK    PYAMA                           CGL009
     C                     ELSE                                           CGL009
     C                     Z-ADDWCYNDP    EUNBDP                          CGL009
      *                                                                   CGL009
      ** Format payment amount for FT0010                                 CGL009
     C                     MOVEL*BLANK    ZFIELD                          CGL009
     C                     MOVE PYAMA     ZFIELD                          CGL009
     C           13        SUB  PCNBDP    ZADIG                           CGL009
     C                     Z-ADDPCNBDP    ZADEC                           CGL009
     C                     EXSR ZALIGN                                    CGL009
     C                     MOVE ZFIELD    P#FRAM                          CGL009
     C                     MOVELSPCCY     P#FRCY                          CGL009
      *                                                                   CGL009
     C                     Z-ADDWVLDT     P#FRDT                          CGL009
     C                     Z-ADDWVLDT     P#TODT                          CGL009
     C                     MOVELBKEURO    P#TOCY                          CGL009
     C                     Z-ADD0         P#TOAM                          CGL009
     C                     Z-ADD0         P#RATE                          CGL009
     C/COPY WNCPYSRC,FT0040C288
     C                     CALL 'FT0010'                                  CGL009
     C                     PARM           P#0010                          CGL009
      *                                                                   CGL009
     C           P#RTCD    IFNE *BLANK                                    CGL009
     C                     MOVEL'FT0010  'W0FILE           ***************CGL009
     C                     MOVEL'*CALL  ' W0KEY            * DB ERROR 77 *CGL009
     C                     Z-ADD77        W0ERNB           ***************CGL009
     C                     EXSR SRERR                                     CGL009
     C                     ELSE                                           CGL009
      *                                                                   CGL009
      * Move the original payment ccy and amount to pay delivery          170801
      * currency and amount                                               170801
     C                     MOVE SPCCY     SPDCY                           170801
     C                     MOVE PYAMA     PDAMA                           170801
     C*                                                                   170801
      ** Format BKEURO amount                                             CGL009
     C                     MOVEL*BLANK    ZFIELD                          CGL009
     C                     MOVE P#TOAM    ZFIELD                          CGL009
     C                     Z-ADDEUNBDP    ZADEC                           CGL009
     C                     EXSR ZEDIT                                     CGL009
     C                     MOVE ZFIELD    PYAMA                           CGL009
     C                     MOVELPYAMA     WNLAM                           CGL009
     C                     EXSR TSNULL                                    CGL009
     C           WNLNUL    IFEQ 'Y'                                       CGL009
     C                     MOVEL*BLANK    PYAMA                           CGL009
     C                     ENDIF                                          CGL009
     C                     MOVELBKEURO    SPCCY                           CGL009
      *                                                                   CGL009
      ** The amount has been successfully converted in BKEURO             CGL009
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
      ** Details of BKEURO ccy found                                      CGL009
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
      ** Details of payment currency found                                CGL009
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
      ** Settlement amount is not blank                                   CGL009
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
      ** Default EURO nostro found                                        CGL009
     C                     MOVELBKEURO    WNOCCY                          175469
     C                     MOVELFHEUNO    WNONUM                          175469
     C                     ELSE                                           175469
      ** Default EURO nostro not found                                    175469
     C                     MOVELFHCYCD    WNOCCY                          175469
     C                     MOVELFHNOSN    WNONUM                          175469
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
      ** Default nostro is marked as EURO                                 CGL009
     C                     ELSE                                           175469
      ** Default nostro is not marked as EURO                             175469
     C                     MOVELFHCYCD    WNOCCY                          175469
     C                     MOVELFHNOSN    WNONUM                          175469
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
      ** CEU006 is on                                                     CGL009
     C                     ENDIF                                          CGL009
     C*********************MOVELFHCYCD    WNOCCY                    CGL009175469
     C*********************MOVELFHNOSN    WNONUM                    CGL009175469
     C                     MOVELDSNOST    SDST1                           CGL009
      *                                                                   CGL009
      ** Default nostro found                                             CGL009
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
      ** Destination is still not filled                                  CGL009
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
      * Account with Bank (always filled)                                 CGL009
      *                                                                   CGL009
     C                     MOVELP57       DSTRAN                          CGL009
      ** Format FONTIS branch code                                        175477
     C                     EXSR FONBNK                                    175477
     C                     MOVELTMLIN1    ACB1                            CGL009
     C                     MOVELTMLIN2    ACB2                            CGL009
     C                     MOVELTMLIN3    ACB3                            CGL009
     C                     MOVELTMLIN4    ACB4                            CGL009
     C                     MOVELTMLIN5    ACB5                            CGL009
      ** Alter the existing tag value in case non translated part is      175477
      ** used in S/R SROSWT SROCLR                                        175477
     C                     MOVELDSTRAN    P57                             175477
      *                                                                   CGL009
      ** Other networks                                                   CGL009
     C                     OTHER                                          CGL009
      *                                                                   CGL009
      * If Intermediary Bank is blank, use 'A/c with Institution'         CGL009
      * details, otherwise use Intermediary Bank details                  CGL009
      *                                                                   CGL009
     C           P56       IFEQ *BLANKS                                   CGL009
      *                                                                   CGL009
     C           P57       IFNE *BLANKS                                   CGL009
     C                     MOVELP57       DSTRAN                          CGL009
     C                     MOVELTMLIN1    SDST1                           CGL009
     C                     MOVELTMLIN2    SDST2                           CGL009
     C                     MOVELTMLIN3    SDST3                           CGL009
     C                     MOVELTMLIN4    SDST4                           CGL009
     C/COPY WNCPYSRC,FT0040C266
     C                     ELSE                                           CGL009
     C                     MOVELP58       DSTRAN                          CGL009
     C                     MOVELTMLIN1    SDST1                           CGL009
     C                     MOVELTMLIN2    SDST2                           CGL009
     C                     MOVELTMLIN3    SDST3                           CGL009
     C                     MOVELTMLIN4    SDST4                           CGL009
     C                     END                                            CGL009
      *                                                                   CGL009
     C                     ELSE                                           CGL009
      *                                                                   CGL009
      * Intermediary Bank entered                                         CGL009
      *                                                                   CGL009
     C                     MOVELP56       DSTRAN                          CGL009
     C                     MOVELTMLIN1    SDST1                           CGL009
     C                     MOVELTMLIN2    SDST2                           CGL009
     C                     MOVELTMLIN3    SDST3                           CGL009
     C                     MOVELTMLIN4    SDST4                           CGL009
      *                                                                   CGL009
      * Account with Bank (only filled if Intermediary Bank exist)        CGL009
      *                                                                   CGL009
     C           P57       IFNE *BLANKS                                   CGL009
     C                     MOVELP57       DSTRAN                          CGL009
     C                     MOVELTMLIN1    ACB1                            CGL009
     C                     MOVELTMLIN2    ACB2                            CGL009
     C                     MOVELTMLIN3    ACB3                            CGL009
     C                     MOVELTMLIN4    ACB4                            CGL009
     C                     MOVELTMLIN5    ACB5                            CGL009
     C                     END                                            CGL009
      *                                                                   CGL009
     C                     END                                            CGL009
      *                                                                   CGL009
     C                     ENDSL                                          CGL009
      *                                                                   CGL009
      ****Map*details*of*payment*for*Fontis*network*only********** CGL009 186059
      ** Map details of payment                                           186059
      *                                                                   CGL009
     C***********PNWRK     IFEQ 'FONTIS'                           CGL009 186059
     C/COPY WNCPYSRC,FT0040C265
     C***********P70       ANDNE*BLANKS                            CGL009 186059
     C           P70       IFNE *BLANKS                                   186059
     C                     MOVELP70       DSTRAN                          CGL009
     C                     MOVELTMLIN1    DTP1                            CGL009
     C                     MOVELTMLIN2    DTP2                            CGL009
     C                     MOVELTMLIN3    DTP3                            CGL009
     C                     MOVELTMLIN4    DTP4                            CGL009
     C                     ELSE                                           186059
     C                     MOVEL*BLANKS   DTP1                            186059
     C                     MOVEL*BLANKS   DTP2                            186059
     C                     MOVEL*BLANKS   DTP3                            186059
     C                     MOVEL*BLANKS   DTP4                            186059
     C                     END                                            CGL009
      *                                                                   CRT002
      **  Rate.                                                           CRT002
      *                                                                   CRT002
     C           SPYAM     IFNE 0                                         CRT002
     C           SSMAM     ANDNE0                                         CRT002
     C           RATEA     ANDEQ*BLANK                                    CGL009
      *                                                                   CRT002
      **  Get the numeric value of SPYAM.                                 CRT002
      *                                                                   CRT002
     C                     CALL 'AOCURRR0'                                CRT002
     C                     PARM *BLANKS   @RETC   7                       CRT002
     C                     PARM '*KEY   ' @OPTN   7                       CRT002
     C                     PARM SPCCY     @CURR   3                       CRT002
     C           SDCURR    PARM SDCURR    DSSDY                           CRT002
      *                                                                   CRT002
     C           @RETC     IFNE *BLANKS                                   CRT002
     C                     MOVEL'AOCURRR0'DBFILE                          CRT002
     C                     MOVEL'*CALL'   DBKEY                           CRT002
     C                     Z-ADD36        DBASE                           CRT002
     C                     EXSR SRERR                                     CRT002
     C                     END                                            CRT002
     C                     Z-ADDA6NBDP    WPNBDP  10                      CRT002
     C                     MOVELA6MDIN    WPMDIN  1                       CFT009
      *                                                                   CRT002
      **  Align amount.                                                   CRT002
      *                                                                   CRT002
     C                     Z-ADDWPNBDP    ZADEC                           CRT002
     C           11        SUB  WPNBDP    ZADIG                           CRT002
     C                     MOVEL*BLANK    ZFIELD                          CRT002
     C                     MOVE SPYAM     ZFIELD                          CRT002
     C                     EXSR ZALIGN                                    CRT002
     C                     MOVE ZFIELD    WPYAM2 110                      CRT002
      *                                                                   CRT002
      **  Get the numeric value of SSMAM.                                 CRT002
      *                                                                   CRT002
     C                     CALL 'AOCURRR0'                                CRT002
     C                     PARM *BLANKS   @RETC   7                       CRT002
     C                     PARM '*KEY   ' @OPTN   7                       CRT002
     C                     PARM SSMCY     @CURR   3                       CRT002
     C           SDCURR    PARM SDCURR    DSSDY                           CRT002
      *                                                                   CRT002
     C           @RETC     IFNE *BLANKS                                   CRT002
     C                     MOVEL'AOCURRR0'DBFILE                          CRT002
     C                     MOVEL'*CALL'   DBKEY                           CRT002
     C                     Z-ADD37        DBASE                           CRT002
     C                     EXSR SRERR                                     CRT002
     C                     END                                            CRT002
     C                     Z-ADDA6NBDP    WSNBDP  10                      CRT002
     C                     MOVELA6MDIN    WSMDIN  1                       CFT009
      *                                                                   CRT002
      **  Align amount.                                                   CRT002
      *                                                                   CRT002
     C                     Z-ADDWSNBDP    ZADEC                           CRT002
     C           11        SUB  WSNBDP    ZADIG                           CRT002
     C                     MOVEL*BLANK    ZFIELD                          CRT002
     C                     MOVE SSMAM     ZFIELD                          CRT002
     C                     EXSR ZALIGN                                    CRT002
     C                     MOVE ZFIELD    WSMAM2 110                      CRT002
      *                                                                   CRT002
     C           WPYAM2    IFNE 0                                         CRT002
     C           WSMAM2    ANDNE0                                         CRT002
      *                                                                   CRT002
      **  Calculate the rate by dividing the larger amt by the smaller amtCRT002
      *                                                                   CRT002
     C           WPYAM2    IFGE WSMAM2                                    CRT002
     C           WPYAM2    DIV  WSMAM2    WRATE2 117                      CRT002
     C                     MOVE 0         SSMAM                           CRT002
     C                     END                                            CRT002
     C           WSMAM2    IFGT WPYAM2                                    CRT002
     C           WPYAM2    DIV  WSMAM2    WRATE2                          CRT002
     C                     MOVE 0         SPYAM                           CRT002
     C                     END                                            CRT002
      *                                                                   CRT002
      **  Format rate field.                                              CRT002
      *                                                                   CRT002
     C                     MOVE WRATE2    ZFIELD                          CRT002
     C                     Z-ADD7         ZADEC                           CRT002
     C                     EXSR ZEDIT                                     CRT002
     C                     MOVE ZFIELD    SRATE                           CRT002
     C                     END                                            CRT002
      *                                                                   CRT002
     C                     END                                            CRT002
      *                                                                   CRT002
     C           PNWRK     IFEQ 'CASHV8'                                  CRT002
      *                                                                   CRT002
      **  Receiver Correspondent and Ordering Bank.                       CRT002
      *                                                                   CRT002
     C           P54       IFNE *BLANKS                                   CRT002
     C                     MOVELP54       DSTRAN                          CRT002
     C                     MOVEL*BLANKS   RCO1                            CRT002
     C                     MOVELTMLIN     RCO1                            CRT002
     C                     MOVEL*BLANKS   SORBK                           CRT002
     C                     MOVELTMLIN     SORBK                           CRT002
      *                                                                   CRT002
     C                     ELSE                                           CRT002
      *                                                                   CRT002
      **  Use the default account code from CASH dataarea and build the   CRT002
      **  account number.                                                 CRT002
      *                                                                   CRT002
      **  Get branch internal customer.                                   CRT002
      *                                                                   CRT002
     C/COPY WNCPYSRC,FT0040C162
     C**********           CALL 'AOBRCHR0'                                             CRT002 CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM *BLANKS   @RTCD                           CRT002
     C                     PARM '*KEY   ' @OPTN                           CRT002
     C                     PARM SBRCA     #BRCA   3                       CRT002
     C********** SDBRCH    PARM SDBRCH    DSFDY                                        CRT002 CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
      *                                                                   CRT002
      **  If record not found.                                            CRT002
      *                                                                   CRT002
     C           @RTCD     IFNE *BLANK                                    CRT002
     C                     MOVEL'AOBRCHR0'DBFILE                          CRT002
     C                     MOVEL'*CALL'   DBKEY                           CRT002
     C                     Z-ADD38        DBASE                           CRT002
     C                     EXSR SRERR                                     CRT002
     C                     END                                            CRT002
     C/COPY WNCPYSRC,FT0040C163
      *                                                                   CRT002
      **  Retrieve retail account number.                                 CRT002
      *                                                                   CRT002
     C                     MOVE A8BICN    CNUM                            CRT002
     C                     MOVELSSMCY     CCY                             CRT002
     C                     MOVE DACACD    ACOD                            CRT002
     C                     Z-ADD1         ACSQ                            CRT002
     C                     MOVELSBRCA     BRCA                            CRT002
      *                                                                   CRT002
     C           AKEY      CHAINACCNT                90                   CRT002
     C           *IN90     IFEQ '0'                                                           189639
     C           RECI      ANDEQ'D'                                                           189639
     C**********           Z-ADDRETNUM    CNUM                                         189639 CSD027
     C                     MOVE RETNUM    CNUM                                                CSD027
     C                     ENDIF                                                              189639
      *                                                                   CRT002
      **  If record not found.                                            CRT002
      *                                                                   CRT002
     C           *IN90     IFEQ '1'                                       CRT002
     C                     MOVEL'ACCNT'   DBFILE                          CRT002
     C                     MOVELAKEYF     DBKEY                           CRT002
     C                     Z-ADD39        DBASE                           CRT002
     C                     EXSR SRERR                                     CRT002
     C                     END                                            CRT002
      *                                                                   CRT002
      ** Move retail account number to receiver's correspondent           CRT002
      *                                                                   CRT002
     C                     MOVEL*BLANKS   RCO1                            CRT002
     C                     MOVE ACNO      RCO1                            CRT002
      *                                                                   CRT002
     C                     END                                            CRT002
      *                                                                   CRT002
      ** Account with Institution and Destination                         CRT002
      *                                                                   CRT002
     C           P57       IFNE *BLANKS                                   CRT002
     C                     MOVELP57       DSTRAN                          CRT002
     C                     MOVEL*BLANKS   WREAC  10                       CRT002
     C                     MOVELTMLIN     WREAC                           CRT002
     C                     MOVEL*BLANKS   ACB1                            CRT002
     C                     MOVELWREAC     ACB1                            CRT002
     C                     MOVEL*BLANKS   DST1                            CRT002
     C                     MOVELWREAC     DST1                            CRT002
     C                     END                                            CRT002
      *                                                                   CRT002
     C                     MOVEL'N'       OPIN                            CRT002
      *                                                                   CRT002
     C                     END                                            CRT002
     C           CFT014    IFEQ 'Y'                                       CFT014
      ** Bank Operation Code                                              CFT014
     C           P23B      IFNE *BLANKS                                   CFT014
     C                     MOVEL*BLANK    DSTRAN                          CFT014
     C                     MOVELP23B      DSTRAN                          CFT014
     C                     MOVELTTREF     MGBOCD                          CFT014
     C                     ENDIF                                          CFT014
      ** Instruction Code                                                 CFT014
     C           P23E      IFNE *BLANKS                                   CFT014
     C                     MOVEL*BLANK    DSTRAN                          CFT014
     C                     MOVELP23E      DSTRAN                          CFT014
     C                     MOVELTMLIN1    MGICD1                          CFT014
     C                     MOVELTMLIN2    MGICD2                          CFT014
     C                     MOVELTMLIN3    MGICD3                          CFT014
     C                     MOVELTMLIN4    MGICD4                          CFT014
     C                     MOVELTMLIN5    MGICD5                          CFT014
     C                     ENDIF                                          CFT014
      ** Transaction Code                                                 CFT014
     C           P26T      IFNE *BLANKS                                   CFT014
     C                     MOVEL*BLANK    DSTRAN                          CFT014
     C                     MOVELP26T      DSTRAN                          CFT014
     C                     MOVELTTREF     MGTTCD                          CFT014
     C                     ENDIF                                          CFT014
      ** Instructed Currency/Amount                                       CFT014
     C           P33B      IFNE *BLANKS                                   CFT014
     C                     MOVEL*BLANK    DSTRAN                          CFT014
     C                     MOVELP33B      DSTRAN                          CFT014
     C                     EXSR RTPCA                                     CFT014
     C                     MOVELWCACY     SPDCY                           CFT014
     C                     MOVELWCAAM     PDAMA                           CFT014
     C                     ENDIF                                          CFT014
      ** Original Rate Currency/Amount                                    CFT014
     C           P36       IFNE *BLANKS                                   CFT014
     C                     MOVEL*BLANK    DSTRAN                          CFT014
     C                     MOVELP36       DSTRAN                          CFT014
     C                     EXSR RT36                                      CFT014
     C                     MOVELW36RT     SORTE                           CFT014
     C                     ENDIF                                          CFT014
      ** Regulatory Reporting                                             CFT014
     C           P77B      IFNE *BLANKS                                   CFT014
     C                     MOVEL*BLANK    DSTRAN                          CFT014
     C                     MOVELP77B      DSTRAN                          CFT014
     C                     MOVELTMLIN1    MGRRP1                          CFT014
     C                     MOVELTMLIN2    MGRRP2                          CFT014
     C                     MOVELTMLIN3    MGRRP3                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   S01435
      * /Copy for analysis/decoding process                               S01435
      *                                                                   S01435
     C/COPY WNCPYSRC,FT0040CDC1                                           S01408
      *                                                                   CGL009
     C                     SELEC                                          CGL009
      * DEFAULT MAPPING                                                   CGL009
      *                                                                   CGL009
      ** Special rule for FONTIS                                          CGL009
     C           PNWRK     WHEQ 'FONTIS'                                  CGL009
      *                                                                   CGL009
      *  Payment subtype, Book code & Profit centre                       CGL009
     C                     MOVE F8OPST    SPYST                           CGL009
     C                     MOVE F8TBKC    SBOKC                           CGL009
      *  Originating branch                                               CGL009
     C           SORBR     IFEQ *BLANKS                                   CGL009
     C                     MOVE SBRCA     SORBR                           CGL009
     C                     END                                            CGL009
      *  Profit center                                                    CGL009
     C                     MOVEL'OP'      WPYTP                           CGL009
     C                     MOVELF8OPST    WPYST                           CGL009
     C                     MOVELF8TBKC    WBOKC                           CGL009
     C                     MOVELSBRCA     WBRCA                           CGL009
     C                     EXSR RTPRFC                                    CGL009
     C           WPRFC     IFNE *BLANK                                    CGL009
     C                     MOVE WPRFC     SPRFC                           CGL009
     C                     ELSE                                           CGL009
     C                     MOVE F8TPFC    SPRFC                           CGL009
     C                     ENDIF                                          CGL009
      *  Settlement method                                                CGL009
     C                     MOVE F8STMT    SSTTP                           CGL009
      *                                                                   CFT002
      ** Other Network                                                    CGL009
     C                     OTHER                                          CGL009
      *                                                                   181723
     C           CFT002    IFEQ 'CFT002'                                  181723
      *                                                                   CFT002
      ***Default*in*BOOK*CODE******                                CFT002 181723
     C*********************MOVE 'FT'      BOKC                     CFT002 181723
     C*********************MOVE 'FT'      SBOKC                    CFT002 181723
      *  Default in PAY CURRENCY                                          CFT002
     C           CFT012    IFEQ 'N'                                       CFT012
     C                     MOVE SSMCY     PCCY                            CFT002
     C                     MOVE SSMCY     SPCCY                           CFT002
     C                     MOVE SSMCY     OPCCY                           CFT002
     C                     ENDIF                                          CFT012
      *  Default in VALUE DATE                                            CFT002
     C                     MOVE PYDT      PYVD                            CFT002
     C                     MOVE SLDT      PVDT                            CFT002
      *                                                                   181723
     C                     ENDIF                                          181723
      *                                                                   CGL009
     C                     ENDSL                                          CGL009
      *                                                                   CGL009
      * Default to clearing mapping                                       CFT002
     C           CFT002    IFEQ 'CFT002'                                  181723
     C                     MOVEL'Y'       ##CLRM  1                       CFT002
     C                     ENDIF                                          181723
      *                                                                   CFT002
      * Decode data if feature installed                                  CFT002
      *                                                                   CFT002
     C           CFT002    IFEQ 'CFT002'                                  CFT002
      *                                                                   CFT002
      * Call ME1580 to translate the data of the messages for FT fields   CFT002
      *                                                                   CFT002
     C                     CALL 'ME1580'               8080               CFT002
     C                     PARM '*TRANS  '#ACT    8        Action         CFT002
     C                     PARM           PHEAD            General DatailsCFT002
     C                     PARM           PDATA            Message DatailsCFT002
     C                     PARM           PDAT2            MsgDetlExt'n                       CSW209
     C/COPY WNCPYSRC,FT0040C223
     C                     PARM *BLANKS   RTN     7        Return Code    CFT002
     C/COPY WNCPYSRC,FT0040C230
      *                                                                   CFT002
      *  If call to program resulted in an error then end program.        CFT002
     C           RTN       IFEQ '*ERROR*'                                 CFT002
     C                     MOVEL'*CALL   'W0FILE                          CFT002
     C                     MOVEL*BLANKS   W0KEY                           CFT002
     C                     MOVEL'ME1580'  W0KEY                           CFT002
     C                     Z-ADD61        W0ERNB                          CFT002
     C                     MOVELERR@,1    W0NARR                          CFT002
     C                     EXSR SRERR                                     CFT002
     C                     ENDIF                                          CFT002
     C/COPY WNCPYSRC,FT0040C164
      *                                                                   CFT002
      *  If Clearing then copy else map like FT0060                       CFT002
      *                                                                   CFT002
     C           ##CLRM    IFEQ 'Y'                                       CFT002
     C/COPY WNCPYSRC,FT0040C122
     C                     EXSR SROCLR                                    CFT002
     C/COPY WNCPYSRC,FT0040C123
     C                     ELSE                                           CFT002
     C                     EXSR SROSWT                                    CFT002
     C                     ENDIF                                          CFT002
      *                                                                   CFT002
     C                     ENDIF                                          CFT002
      *                                                                   CFT012
      * Default settlement currency for other network than FONTIS         CFT012
      * (provided settlement currency is still blank)                     CFT012
     C           CFT012    IFEQ 'Y'                                       CFT012
     C           PNWRK     IFNE 'FONTIS'                                  CFT012
     C           SSMCY     IFEQ *BLANK                                    CFT012
     C                     EXSR SRDSCY                                    CFT012
     C                     ENDIF                                          CFT012
     C                     ENDIF                                          CFT012
     C                     ENDIF                                          CFT012
      *                                                                   S01435
      *  Unwind subroutine stack name                                     S01435
      *                                                                   S01435
     C/COPY WNCPYSRC,FT0040C160
     C***********EXSWFT    TAG                                      S01435068230
     C           EXSWFC    TAG                                            068230
     C                     MOVEA*BLANKS   @STK,Q                          S01435
     C                     SUB  1         Q       50                      S01435
      *                                                                   S01435
     CSR                   ENDSR                                          S01435
      *                                                                   S01435
     C************************************************************        S01435
     C* End of EISWFT Subroutine                                          S01435
     C************************************************************        S01435
     C/COPY WNCPYSRC,FT0040C080
     C/EJECT
      *****************************************************************   S01414
      *                                                               *   S01414
      *  SRPRFA   : Determine if Profit Centres are Used              *   S01414
      *                                                               *   S01414
      *  CALLED BY:                                                   *   S01414
      *                                                               *   S01414
      *  CALLS    : *NONE                                             *   S01414
      *                                                               *   S01414
      *****************************************************************   S01414
     CSR         SRPRFA    BEGSR                                          S01414
      *                                                                   S01414
      *  Set up subroutine stack name                                     S01414
      *                                                                   S01414
     C                     ADD  1         Q                               S01414
     C                     MOVEL'SRPRFA'  @STK,Q                          S01414
      *                                                                   S01414
      *  Check if Profit Centres are used and set screen attributes       S01414
      *                                                                   S01414
     C           BKPRCU    IFEQ 'Y'                                       S01414
      *                                                                   S01414
      *  If Profit Centres are used determine if field is amendable.      S01414
      *                                                                   S01414
      *  If Insert it is always amendable. If Amend it is only            S01414
      *  amendable if the Profit Centres Amendable flag is set to 'Y'.    S01414
      *  If Enquire or Delete it is not amendable.                        S01414
      *                                                                   S01414
     C           ACTION    IFEQ 'I'                                       S01414
     C           ACTION    OREQ 'A'                                       S01414
     C           BKPRCA    ANDEQ'Y'                                       S01414
     C                     MOVEA'010'     *IN,75           Amendable      S01414
     C                     ELSE                                           S01414
     C                     MOVEA'000'     *IN,75           Protect        S01414
     C                     END                                            S01414
      *                                                                   S01414
      *  If Profit Centres NOT Used - non display field                   S01414
      *                                                                   S01414
     C                     ELSE                                           S01414
     C                     MOVEA'100'     *IN,75           Non-display    S01414
     C                     END                                            S01414
      *                                                                   S01414
      *  Unwind subroutine stack name                                     S01414
      *                                                                   S01414
     C           EXPRFA    TAG                                            S01414
     C                     MOVEA*BLANKS   @STK,Q                          S01414
     C                     SUB  1         Q       50                      S01414
      *                                                                   S01414
     CSR                   ENDSR                                          S01414
      *                                                                   S01414
     C************************************************************        S01414
     C* End of SRPRFA Subroutine                                          S01414
     C************************************************************        S01414
     C/EJECT
     C************************************************************
     C* VALTWO SR.
     C* EXECUTE SUBROUTINES TO VALIDATE SCREEN TWO
     C*
     C           VALTWO    BEGSR
     C*
     C* SETOFF INDICATORS AND CLEAR ERROR FIELD
     C                     SETOF                     89
     C                     SETOF                     56                   S01435
     C                     SETOF                     59                   S01117
     C                     MOVE '0'       *IN74                           S01414
     C                     MOVE '0'       *IN77                           S01414
     C/COPY WNCPYSRC,FT0040C008
     C* SETOF DEST + ORD CUST (FIELDS 2 - 4) ERROR INDICATORS
     C                     SETOF                     8586
     C                     MOVE *IN47     SV47    1                       CEU006
     C                     MOVE *IN46     SV46    1                       079911
     C                     MOVEASETOFF    *IN,22
     C                     MOVE SV46      *IN46                           079911
     C                     MOVE SV47      *IN47                           CEU006
     C                     MOVEA'0000'    *IN,08                          CEU006
     C                     MOVEA*BLANK    ERCD
     C                     MOVE *OFF      *IN49                           CFT014
     C                     MOVE *OFF      *IN73                           CFT009
     C                     Z-ADD1         Z
     C                     Z-ADD0         PHW     50                      140640
     C                     MOVE *BLANKS   EUX     1                       140640
     C                     MOVE *BLANKS   SWIIND                          140642
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0040CP11                                           S01408
     C*                                                                   S01408
     C* SEE IF PAYMENT DETAILS HAVE CHANGED
      * If the payment has been entered by the user, the settlement
      *  cannot be changed, but if the amount, currency, rate or
      *  override ind is changed, then the amounts will be re-calculat-
      *  ed.
      * If the payment has been generated from an incoming payment, the
      *  amounts, currencies, rate and override ind cannot be changed,
      *  but the settlement type must be entered.  This will cause the
      *  receive amount, which is zero when the payment is generated,
      *  to be calculated from the pay amount.
      *
     C   13                DO                              B001
     C           SSMCY     IFEQ OSMCY                      B002
     C           SPCCY     ANDEQOPCCY
     C           SMAMA     ANDEQSMAMAO
     C           RATEA     ANDEQRATEAO
     C           PYAMA     ANDEQPYAMAO
     C           SOVRD     ANDEQOOVRD
     C           SSTTPN    ANDEQSTMT
     C                     SETON                     44
     C                     END                             E002
     C                     END                             E001
     C*                                                                   S01408
     C** Core hook for externalisation.                                   S01408
     C/COPY WNCPYSRC,FT0040CVSF                                           S01408
     C*                                                                   S01408
      * Validate Booking Branch if                                        S01435
      * Multibranching environment, action code I and FT0040 called       S01435
      * from swift enquiry function.                                      S01435
      *                                                                   S01435
     C   57 61             EXSR SRBRCA                                    S01435
     C   57 58             EXSR ORBRCH                                    S01117
     C           CFT009    IFEQ 'N'                                       CFT009
     C  N59                EXSR PAYCHG                                    S01117
     C                     ENDIF                                          CFT009
     C                     EXSR TYPE                       TYPE
     C                     EXSR SUBTYP                     SUB-TYPE
     C/COPY WNCPYSRC,FT0040C013
     C                     EXSR DESTIN                     DESTINATION
     C/COPY WNCPYSRC,FT0040C014                                           S01408
     C                     EXSR ORDCUS                     ORDERING CUS
     C*C*PY*WN*PY*RC*FT0040C014****************************************   S01408
     C/COPY WNCPYSRC,FT0040C062
     C                     EXSR SNDCOR                     SENDER'S COR
     C/COPY WNCPYSRC,FT0040C063
     C                     EXSR ORDBNK                     ORDERING BNK
     C/COPY WNCPYSRC,FT0040C064
      ** Only access Notified Delivery currency and amount if SAR         CFT014
      ** CEU006 is installed. Pay Delivery currency and amount must       CFT014
      ** be access if either of the two switchable feature is             CFT014
      ** ON (CEU006 or CFT014)                                            CFT014
      *                                                                   CEU006
     C           CEU006    IFEQ 'Y'                                       CEU006
     C           CFT014    OREQ 'Y'                                       CFT014
     C           CEU006    IFEQ 'Y'                                       CFT014
     C                     EXSR NTDLCY                                    CEU006
     C                     EXSR NTDLAM                                    CEU006
     C                     ENDIF                                          CFT014
     C                     EXSR PYDLCY                                    CEU006
     C                     EXSR PYDLAM                                    CEU006
     C                     ENDIF                                          CEU006
      *                                                                   CEU006
     C                     EXSR SETCUR                     SET CURRENCY
     C  N44                EXSR SETAMT                     SET AMOUNT
      *                                                                                       CRE008
      ** Check overdraft limit if CRE008 is installed                                         CRE008
      *                                                                                       CRE008
     C           CRE008    IFEQ 'Y'                                                           CRE008
     C           *IN25     ANDEQ'0'                                                           CRE008
     C           *IN28     ANDEQ'0'                                                           CRE008
     C           SORCT     IFEQ 'R'                                                           CRE008
     C           SORCT     OREQ 'P'                                                           CRE008
     C                     EXSR OVDRLT                                                        CRE008
     C                     ENDIF                                                              CRE008
     C                     ENDIF                                                              CRE008
      *                                                                                       CRE008
     C                     EXSR PAYCUR                     PAY CURRENCY
     C  N44                EXSR PAYAMT                     PAY AMOUNT
      ** Validate original exchange rate if MT103 message generation      CFT014
      ** is installed.                                                    CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
     C                     EXSR SRORTE                                    CFT014
     C                     ENDIF                                          CFT014
     C*
     C** IF NO CHANGES TO AMOUNTS, FIXED AMOUNT INDICATOR NEEDS TO BE
     C** STORED IN WORK FIELD SFAIN FOR LATER FILE UPDATE.
     C*
     C   44                MOVE FAIN      SFAIN
     C*
     C**N28N29N32*****                                                    CEU006
     C**ANN34N35N44***     EXSR RATES                      RATE           CEU006
     C  N44                EXSR OVRRDE                     OVERRIDE
     C                     EXSR SETDAT                     SET DATE
     C                     EXSR PPLCHG                     PAY PLUS CHG
     C/COPY WNCPYSRC,FT0040C087
     C                     EXSR PVDTAT                     PAY DATE
     C           CFT009    IFEQ 'Y'                                       CFT009
     C                     EXSR DFTDAT                                    CFT009
     C                     EXSR DFTSPR                                    CFT009
     C                     ENDIF                                          CFT009
     C/COPY WNCPYSRC,FT0040C088
      *                                                                   CEU006
      * Process SR EUXCHK if no error encountered or if only warnings.    140640
      *                                                                   140640
     C********** *IN89     IFEQ *OFF                               CEU006 140640
     C           PHW       IFEQ 0                                         140640
     C/COPY WNCPYSRC,FT0040C114
     C                     EXSR EUXCHK                                    CEU006
     C/COPY WNCPYSRC,FT0040C115
     C                     ENDIF                                          CEU006
      *                                                                   S01414
      *  Validate the Book Code.                                          S01414
      *                                                                   S01414
     C                     EXSR SRBOOK                     Book Code      S01414
      *                                                                   S01414
      *  Validate the Profit Centre if Used.                              S01414
      *                                                                   S01414
     C           BKPRCU    IFEQ 'Y'                                       S01414
     C                     EXSR SRPRFC                     Profit Centre  S01414
     C                     END                                            S01414
     C                     EXSR REGPAY                     REGULAR PAY
     C                     EXSR PAYFRQ                     PAY FREQUENC
     C                     EXSR DAYMTH                     DAY IN MONTH
     C                     EXSR FINDAT                     FINAL DATE
     C                     EXSR NXTDAT                     NEXT DATE
     C                     EXSR SETTYP                     SETTLEMENT
     C***********          EXSR SWIFT                      SWIFT CODE     068230
     C                     EXSR SWIFTC                     SWIFT CODE     068230
     C                     EXSR SM202                      MT202 IND
     C                     EXSR ODMTX                      MT100 CUSTOMER
      *                                                                   CFT009
      ** Validate spread set and default charges                          CFT009
      *                                                                   CFT009
     C           CFT009    IFEQ 'Y'                                       CFT009
     C                     EXSR KYFCHG                                    CFT009
     C           *IN89     IFEQ *OFF                                      CFT009
     C           *IN26     ANDEQ*OFF                                      CFT009
     C                     EXSR SRSPST                                    CFT009
      *                                                                   CFT009
      ** Validate rates and amounts again after 980 called, to trap       CFT009
      ** the defaulted rate being out of tolerence range.                 CFT009
      *                                                                   CFT009
     C           PHW       IFEQ 0                                         CFT009
     C                     EXSR EUXCHK                                    CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CEU006
     C                     ENDIF                                          CFT009
     C*                                                                   S01408
     C** Core hook for externalisation.                                   S01408
     C/COPY WNCPYSRC,FT0040CVSR                                           S01408
     C*
     C                     ENDSR
     C*
     C************************************************************
     C* END OF CONTROL SECTION FOR VALIDATION OF SCREEN TWO
     C************************************************************
     C/EJECT
     C************************************************************
     C* PAYCHG SR.                                                        S01117
     C* ACCESSES PYCHGDD                                                  S01117
     C*                                                                   S01117
     C           PAYCHG    BEGSR                                          S01117
     C*                                                                   S01117
     C** If single branch....                                             S01117
     C*                                                                   S01117
     C           @MBIN     IFEQ 'N'                                       S01117
     C                     MOVE BJSBRC    PYBR                            S01117
     C*                                                                   S01117
     C** Else,if multi branched...                                        S01117
     C*                                                                   S01117
     C                     ELSE                                           S01117
     C           @MBIN     IFEQ 'Y'                                       S01117
     C           BKOBRU    ANDEQ'Y'                                       S01117
     C                     MOVE SORBR     PYBR                            S01117
     C                     ELSE                                           S01117
     C                     MOVE SBRCA     PYBR                            S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C                     SETOF                     87                   133420
     C*                                                                   S01117
     C           PYBR      CHAINPYCHGDB              99                   S01117
     C*                                                                   079909
     C** Error if payment/charges record not found for branch             079909
     C           *IN99     IFEQ '1'                                       S01117
     C*                                                                   079909
     C**  Set on error flag                                               079909
     C                     SETON                     89                   079909
     C                     SETON                     87                   133420
     C*                                                                   079909
     C** If multi branch, highlight originating branch or booking branch  079909
     C           @MBIN     IFEQ 'Y'                                       079909
     C           BKOBRU    ANDEQ'Y'                                       079909
     C                     SETON                     59                   079909
     C                     ELSE                                           079909
     C                     SETON                     56                   079909
     C                     END                                            079909
     C*                                                                   079909
     C** Send error message to screen                                     079909
     C                     MOVELPYBR      FTMSDT                          079909
     C                     MOVEL'FTM2001' FTMSID                          079909
     C                     EXSR FTSNMS                                    079909
     C************LOCK     IN   DLDA                                S01117079909
     C************         MOVEL'FT0040  'DBPGM                     S01117079909
     C************         MOVE 'PYCHG  ' DBFILE     ***************S01117079909
     C************         Z-ADD44        DBASE      * DB ERROR 44 *S01117079909
     C************         MOVELPYBR      DBKEY      ***************S01117079909
     C************         OUT  DLDA                                S01117079909
     C************         SETON                     U7U8LR         S01117079909
     C************         DUMP                                     S01117079909
      ************                                                  042167079909
      *  Allocate dataarea to blanks                                042167079909
      *                                                             042167079909
     C*************        EXSR DALLOC                              042167079909
     C*************        RETRN                                    S01117079909
     C                     END                                            S01117
     C*                                                                   S01117
     C*  Convert rate % discrepancy to higher & lower rate margins.       S01117
     C           1         ADD  RATDIS    UPMARG  74                      S01117
     C           1         SUB  RATDIS    LWMARG  74                      S01117
     C*                                                                   S01117
     C                     ENDSR                                          S01117
     C*                                                                   S01117
     C************************************************************        S01117
     C* END OF PAYCHG SUBROUTINE                                          S01117
     C************************************************************        S01117
     C/EJECT                                                              S01117
     C************************************************************        S01117
     C* UPDATE SR.
     C* UPDATE RELEVENT FILES
     C*
     C           UPDATE    BEGSR
      *                                                                   031876
      *  Set up subroutine stack name                                     031876
      *                                                                   031876
     C                     ADD  1         Q                               031876
     C                     MOVEL'UPDATE'  @STK,Q                          031876
      *                                                                   045014
      *  Clear stored values                                              045014
      *                                                                   045014
     C                     EXSR SRCLR                                     045014
     C/COPY WNCPYSRC,FT0040C299
     C*
     C***DONT*USE*DEFAULT*CHARGE*IF*SWPC*NOT*ENTERED*AS*01*               S01117
     C** DONT USE DEFAULT CHARGE IF SWPC NOT ENTERED AS 'U'               S01117
     C*
     C***********SSWPC*****IFNE '01'                                      S01117
     C***********SSWPC*****ANDNE'11'                                      S01117
     C           SSWPC     IFNE 'U'                                       S01117
     C                     Z-ADD0         SPCH
     C                     Z-ADD0         SPCHD
     C                     END
     C*
     C** DONT USE DEFAULT CHEQUE CHARRGE IF NOT SETTLED BY CHEQUE
     C*
     C           SSTTP     IFNE '12'
     C           SSTTP     ANDNE'13'
     C                     Z-ADD0         CQCH
     C                     Z-ADD0         CQCHD
     C                     END
     C*
     C                     EXSR OLDBIT
      *
     C* IF INSERT
      *
     C   12                DO                              B001
      *                                                                   CFT009
     C                     EXSR MOVES
      *
     C* SETUP ORIGINAL ENTRY DATE
      *
     C*********************Z-ADDRUND      OEDT                            S01194
     C                     Z-ADDBJRDNB    OEDT                            S01194
     C                     MOVE RUNN      OEDTD1
     C                     MOVE RUNN      ZDATE
      *
     C* FORMAT DATE FOR D3
      *
     C           *IN98     IFEQ '0'                        B001
     C                     MOVE ZDD       OYY
     C                     MOVE ZMM       OMM
     C                     MOVE ZYY       ODD
     C                     ELSE                            X001
     C                     MOVE ZDD       OMM
     C                     MOVE ZMM       OYY
     C                     MOVE ZYY       ODD
     C                     END                             E001
      *
     C                     Z-ADDODATE     OEDTD3
      *
     C* FIND CENTURY
      *
     C***********ZYN       IFLT 71                         B001           124673
     C           ZYN       IFLT 72                         B001           124673
     C                     MOVE '20'      OEDTD2
     C                     ELSE                            X001
     C                     MOVE '19'      OEDTD2
     C                     END                             E001
      *
     C* FORMAT PAYMENT REFERENCE
      *
     C/COPY WNCPYSRC,FT0040C075
     C           PYTP      IFEQ 'RP'                       B002
     C           *LOCK     IN   RGPAYD
     C                     Z-ADDRSQNM     PRNUM
     C                     ADD  1         RSQNM
     C                     OUT  RGPAYD
     C                     ELSE                            X002
      *
     C/COPY WNCPYSRC,FTH00094
     C           *LOCK     IN   OTPAYD
     C**********           Z-ADDOSQNM     PRNUM                                             MD055612
     C**********           ADD  1         OSQNM                                             MD055612
     C                     MOVELWOTSQ     PRNUM                                             MD055612
     C                     ADD  1         WOTSQ                                             MD055612
     C                     OUT  OTPAYD
     C/COPY WNCPYSRC,FTH00095
     C                     END                             E002
     C/COPY WNCPYSRC,FT0040C076
      *
     C                     MOVE IPREF     PREF
     C/COPY WNCPYSRC,FTH00096
     C                     TIME           OTLCHT
     C*********************Z-ADDRUND      OTLCD                           S01194
     C                     Z-ADDBJRDNB    OTLCD                           S01194
     C                     MOVE 'I'       CHTP
     C                     SETON                     46
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0040CP19                                           S01408
     C*                                                                   S01408
     C*
     C** SET UP VALUE OF INPUT USER FOR LATER AUTHORISATION CHECK
     C*
     C                     MOVE USRID     INUSR1 10
      *                                                                   S01435
      *  /COPY for additional processing before writing OTPAYDD           S01435
      *                                                                   S01435
     C/COPY WNCPYSRC,FT0040WRIT                                           S01435
      *                                                                   CFT003
      *  If Batch Authorsation update/add record                          CFT003
      *                                                                   CFT003
     C           CFT003    IFEQ 'CFT003'                                  CFT003
     C/COPY WNCPYSRC,FT0040C280
     C           CFT014    OREQ 'Y'                                       CFT014
     C           CFT009    OREQ 'Y'                                       CFT009
      *                                                                   CFT003
      ** Update extension record to include the Auto-generated            CFT003
      ** indicator                                                        CFT003
      *                                                                   CFT003
     C           PREF      CHAINOTPAYXL0             90                   CFT003
      *                                                                   CFT003
      * If no existing extension record, insert new one                   CFT003
      *                                                                   CFT003
     C           *IN90     IFEQ '1'                        B001           CFT003
     C                     MOVEL'D'       OPRECI                          CFT003
     C                     MOVELPREF      OPPREF                          CFT003
     C                     MOVEL*BLANK    OPBJPR                          CFT003
     C                     MOVEL'N'       OPAUTO                          CFT003
     C                     MOVELSTMT      OPSETM                          CFT003
      *                                                                   CFT009
      ** Move new charges before writing                                  CFT009
      *                                                                   CFT009
     C           CFT009    IFEQ 'Y'                                       CFT009
     C                     EXSR MOVCHG                                    CFT009
     C                     ENDIF                                          CFT009
     C/COPY WNCPYSRC,FT0040C281
      *                                                                   CFT003
     C           CFT014    IFEQ 'Y'                                       CFT014
     C                     EXSR SRSETF                                    CFT014
     C                     EXSR FLHIZO                                    CFT014
     C                     Z-ADDWORTE     OPOEXR                          CFT014
     C                     ENDIF                                          CFT014
     C***********          WRITEOTPAYXDF                           CFT003 CFT014
     C                     MOVEASTAMP,1   OPTMST           Default Timestamp                  202937
     C                     WRITEOPAYXL0                                   CFT014
      *                                                                   CFT003
      * If existing extension record, update                              CFT003
      *                                                                   CFT003
     C                     ELSE                                           CFT003
     C           CFT014    IFNE 'Y'                                       CFT014
     C***********CFT009    ANDNE'Y'                                       CFT009
      *                                                                   CFT009
      ** Default VAT flags, total VAT, VAT rate, file DAF format for      CFT009
      ** charges, entry charges                                           CFT009
      *                                                                   CFT009
     C           CFT009    IFEQ 'Y'                                       CFT009
     C                     EXSR CHGVAT                                    CFT009
     C           ACTION    IFEQ 'I'                                       CFT009
     C           KEYCHG    OREQ 'Y'                                       CFT009
     C           *IN89     ANDEQ*OFF                                      CFT009
     C                     EXSR MOVODS                                    CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     MOVEL'N'       OPAUTO                          CFT003
     C/COPY WNCPYSRC,FT0040C282
     C***********          UPDATOTPAYXDF                           CFT003 CFT014
     C                     UPDATOPAYXL0                                   CFT014
     C                     ELSE                                           CFT014
     C                     MOVEL'OTPAYXL0'DBFILE                          CFT014
     C                     Z-ADD64        DBASE                           CFT014
     C                     MOVELPREF      DBKEY                           CFT014
     C                     EXSR SRERR                                     CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT003
      *                                                                   CFT003
     C                     ENDIF                                          CFT003
      *                                                                   S01435
     C** Core hook for externalisation.                                   S01408
     C/COPY WNCPYSRC,FT0040CCBU                                           S01408
     C                     MOVEASTAMP,1   TMST             Default Timestamp                  202937
     C                     WRITEOTPAYDDF               88
      *
     C   88                DO                              B002
     C           *LOCK     IN   DLDA
     C                     MOVE 'FT0040  'DBPGM
     C                     MOVE 'OTPAY'   DBFILE           ***************
     C                     Z-ADD4         DBASE            * DB ERROR 04 *
     C                     MOVELPREF      DBKEY            ***************
     C                     OUT  DLDA
     C                     SETON                     U7U8LR
     C/COPY WNCPYSRC,FT0040C138
     C                     DUMP
      *                                                                   042167
      *  Allocate dataarea to blanks                                      042167
      *                                                                   042167
     C                     EXSR DALLOC                                    042167
      *                                                                   042167
     C                     RETRN
     C                     END                             E002
     C/COPY WNCPYSRC,FT0040C052
      *                                                                   042167
      * Call CL program to allocate this reference to a dataarea          042167
      *                                                                   042167
     C                     MOVE *BLANKS   @RTCDE                          042167
     C                     MOVE 'FT'      @MODLE                          042167
     C                     MOVE PREF      @TREF                           042167
     C                     MOVE *BLANKS   @RTINF                          042167
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0040CP22                                           S01408
     C*                                                                   S01408
     C                     CALL 'AOC8000'                                 042167
     C                     PARM           @RTCDE                          042167
     C                     PARM           @MODLE                          042167
     C                     PARM           @TREF                           042167
     C                     PARM           @RTINF                          042167
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0040CP23                                           S01408
     C*                                                                   S01408
      *                                                                   045014
      *  Process shadow post if new addition and not regular payment      045014
      *  Or level incomplete i.e. insert of generated payment             045014
      *                                                                   045014
     C           PYTP      IFNE 'RP'                                      045014
     C                     Z-ADDSMAM      ##SMAM                          031876
     C                     Z-ADDPYAM      ##PYAM                          031876
     C           CFT014    IFEQ 'Y'                                       CFT014
     C           OPRCRM    ANDNE*ZERO                                     CFT014
     C                     ADD  OPRCRM    ##PYAM                          CFT014
     C                     ENDIF                                          CFT014
     C/COPY WNCPYSRC,FT0040C165
     C                     EXSR SRADD                                     045014
     C                     END                                            045014
      *                                                                   045014
      * Update Incoming Message FT Transaction Status File record         S01435
      *                                                                   S01435
     C           OPMSGR    IFNE 0                                         S01435
      *                                                                   S01435
     C                     MOVEL'MIN0030' W0FLAG  7                       S01435
     C                     MOVEL'MIN0190' W0LMSG  7                       S01435
      *                                                                   S01435
     C                     EXSR SRINFT                                    S01435
      *                                                                   S01435
     C                     END                                            S01435
     C                     END                             E001
      *
     C* NOT INSERT
      *
     C**N12**************  DO                              B001           CFT009
     C           *IN12     IFEQ *OFF                       B001           CFT009
     C                     MOVE SPREF     PREF
     C           PREF      CHAINOTPAYDDF             88
     C/COPY WNCPYSRC,FT0040C069
     C   88                DO                              B002
     C           *LOCK     IN   DLDA
     C                     MOVE 'FT0040  'DBPGM
     C                     MOVE 'OTPAY'   DBFILE           ***************
     C                     Z-ADD5         DBASE            * DB ERROR 05 *
     C                     MOVELPREF      DBKEY            ***************
     C                     OUT  DLDA
     C                     SETON                     U7U8LR
     C/COPY WNCPYSRC,FT0040C139
     C                     DUMP
      *                                                                   042167
      *  Allocate dataarea to blanks                                      042167
      *                                                                   042167
     C                     EXSR DALLOC                                    042167
      *                                                                   042167
     C                     RETRN
     C                     END                             E002
     C* IF HAS BEEN UPDATED BY ANOTHER WORKSTATION
     C           OTLCD     IFNE SLCD                       B001
     C           OTLCHT    ORNE SLCHT
     C                     SETON                     0289
     C*********************MOVEA' 068'    ERCD,Z                          S01117
     C                     MOVEA' 001'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     EXCPTOUTPAY
     C                     GOTO UPDEND
     C                     END                             E002
     C*                                                                   S01506
     C** If S01508 is installed, check if debit customer has changed      S01506
     C*                                                                   S01506
     C           S01508    IFEQ 'Y'                                       S01506
     C           *IN13     ANDEQ'1'                                       S01506
     C                     MOVE *BLANKS   WDCUS1                          S01506
     C                     MOVE *BLANKS   WDCUS2                          S01506
     C                     MOVE *BLANK    WRDFTC                          S01506
     C*                                                                   S01506
     C** Determine the original debit customer by calling FT0035          S01506
     C** ...if S01506 is intalled, use ordering customer details          S01506
     C** ... if add/deduct is 'A', use ordering customer and bank         S01506
     C** ... if add/deduct is 'D', use destination and sender's corres.   S01506
     C*                                                                   S01506
     C                     CLEARW0DTA                                     S01506
     C                     SELEC                                          S01506
     C*                                                                   S01506
     C           S01506    WHEQ 'Y'                                       S01506
     C                     MOVELORCT      I#PT1                           S01506
     C                     MOVELORC1      I#PTY1                          S01506
     C/COPY WNCPYSRC,FT0040C035
     C                     MOVELSMCY      I#CCY                           S01506
     C*                                                                   S01506
     C           ADDC      WHEQ 'A'                                       S01506
     C                     MOVELORCT      I#PT1                           S01506
     C                     MOVELORC1      I#PTY1                          S01506
     C/COPY WNCPYSRC,FT0040C036
     C                     MOVELSMCY      I#CCY                           S01506
     C***********ORBK      IFNE *ZEROS                                    S01506              CSD027
     C           ORBK      IFNE *BLANKS                                                       CSD027
     C**********           MOVE *BLANKS   WORBKC 15                                    S01506 CGL029
     C**********           MOVELORBK      WFLDO  12                                    S01506 CGL029
     C                     MOVE *BLANKS   WORBKC 21                                           CGL029
     C                     MOVELORBK      WFLDO  18                                           CGL029
     C           WFLDO     CAT  ORBB      WORBKC                          S01506
     C                     MOVELORBT      I#PT2                           S01506
     C                     MOVELWORBKC    I#PTY2                          S01506
     C                     END                                            S01506
     C/COPY WNCPYSRC,FT0040C231
     C*                                                                   S01506
     C           ADDC      WHEQ 'D'                                       S01506
     C                     MOVELDSTT      I#PT1                           S01506
     C                     MOVELDST1      I#PTY1                          S01506
     C                     MOVELPCCY      I#CCY                           S01506
     C***********SNCO      IFNE *ZEROS                                    S01506              CSD027
     C           SNCO      IFNE *BLANKS                                                       CSD027
     C                     MOVELSNCT      I#PT2                           S01506
     C                     MOVELSNCO      I#PTY2                          S01506
     C                     END                                            S01506
     C/COPY WNCPYSRC,FT0040C232
     C                     ENDSL                                          S01506
     C/COPY WNCPYSRC,FT0040C166
     C*                                                                   S01506
     C                     CALL 'FT0035'               9090               S01506
     C                     PARM *BLANKS   @RTRN                           S01506
     C                     PARM           W0DTA                           S01506
     C                     PARM           W0MSG 256                       S01506
     C           *IN90     IFEQ '1'                                       S01506
     C           @RTRN     ORNE *BLANKS                                   S01506
     C                     MOVEL'FT0035  'W0FILE           ************   S01506
     C                     MOVEL'*CALL   'W0KEY            * DBERR 33 *   S01506
     C                     Z-ADD33        W0ERNB           ************   S01506
     C                     EXSR SRERR                                     S01506
     C                     ELSE                                           S01506
     C                     MOVELO#CUST    WDCUS1  6                       S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C** Determine the new debit customer by calling FT0035
     C** ... if S01506 is intalled, use ordering customer details         S01506
     C** ... if add/deduct is 'A', use ordering customer and bank         S01506
     C** ... if add/deduct is 'D', use destination and sender's corres.   S01506
     C*                                                                   S01506
     C                     CLEARW0DTA                                     S01506
     C                     SELEC                                          S01506
     C*                                                                   S01506
     C           S01506    WHEQ 'Y'                                       S01506
     C                     MOVELSORCT     I#PT1                           S01506
     C           @MBIN     IFEQ 'N'                                       S01506
     C           SORCT     ANDEQ'P'                                       S01506
     C**********           MOVE *BLANKS   WFLD1  15                                    S01506 CGL029
     C                     MOVE *BLANKS   WFLD1  21                                           CGL029
     C                     MOVELSORC1     WFLD1                           S01506
     C                     MOVE BJSBRC    WFLD1                           S01506
     C                     MOVELWFLD1     I#PTY1                          S01506
     C                     ELSE                                           S01506
     C                     MOVELSORC1     I#PTY1                          S01506
     C                     END                                            S01506
     C                     MOVELSSMCY     I#CCY                           S01506
     C*                                                                   S01506
     C           SADDC     WHEQ 'A'                                       S01506
     C                     MOVELSORCT     I#PT1                           S01506
     C           @MBIN     IFEQ 'N'                                       S01506
     C           SORCT     ANDEQ'P'                                       S01506
     C**********           MOVE *BLANKS   WFLD1  15                                    S01506 CGL029
     C                     MOVE *BLANKS   WFLD1                                               CGL029
     C                     MOVELSORC1     WFLD1                           S01506
     C                     MOVE BJSBRC    WFLD1                           S01506
     C                     MOVELWFLD1     I#PTY1                          S01506
     C                     ELSE                                           S01506
     C                     MOVELSORC1     I#PTY1                          S01506
     C                     END                                            S01506
     C                     MOVELSSMCY     I#CCY                           S01506
     C                     MOVE *BLANKS   WORBKC                          S01506
     C           SORBK     CAT  SORBB     WORBKC                          S01506
     C                     MOVELSORBT     I#PT2                           S01506
     C                     MOVELWORBKC    I#PTY2                          S01506
     C/COPY WNCPYSRC,FT0040C233
     C*                                                                   S01506
     C           SADDC     WHEQ 'D'                                       S01506
     C                     MOVELSDSTT     I#PT1                           S01506
     C           @MBIN     IFEQ 'N'                                       S01506
     C           SDSTT     ANDEQ'G'                                       S01506
     C**********           MOVE *BLANKS   WFLD2  18                                    S01506 CGL029
     C                     MOVE *BLANKS   WFLD2  24                                           CGL029
     C                     MOVELSDST1     WFLD2                           S01506
     C                     MOVE BJSBRC    WFLD2                           S01506
     C                     MOVELWFLD2     I#PTY1                          S01506
     C                     ELSE                                           S01506
     C                     MOVELSDST1     I#PTY1                          S01506
     C                     END                                            S01506
     C                     MOVELSPCCY     I#CCY                           S01506
     C                     MOVELSSNCT     I#PT2                           S01506
     C                     MOVELSSNCO     I#PTY2                          S01506
     C/COPY WNCPYSRC,FT0040C234
     C                     ENDSL                                          S01506
     C*                                                                   S01506
     C/COPY WNCPYSRC,FT0040C167
     C                     CALL 'FT0035'               9090               S01506
     C                     PARM *BLANKS   @RTRN                           S01506
     C                     PARM           W0DTA                           S01506
     C                     PARM           W0MSG 256                       S01506
     C           *IN90     IFEQ '1'                                       S01506
     C           @RTRN     ORNE *BLANKS                                   S01506
     C                     MOVEL'FT0035  'W0FILE           ************   S01506
     C                     MOVEL'*CALL   'W0KEY            * DBERR 34 *   S01506
     C                     Z-ADD34        W0ERNB           ************   S01506
     C                     EXSR SRERR                                     S01506
     C                     ELSE                                           S01506
     C                     MOVELO#CUST    WDCUS2  6                       S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C** Check if recalculation of charges must take place                S01506
     C*                                                                   S01506
     C           S01506    IFEQ 'Y'                                       S01506
     C           WDCUS1    IFNE WDCUS2                                    S01506
     C           SSMCY     ORNE SMCY                                      S01506
     C           SMAM      ORNE SSMAM                                     095075
     C           RATE      ORNE SRATE                                     124674
     C                     MOVE 'Y'       WRDFTC  1                       S01506
     C                     END                                            S01506
     C                     ELSE                                           S01508
     C           WDCUS1    IFNE WDCUS2                                    S01508
     C           SPYTP     ORNE PYTP                                      S01508
     C           SPYST     ORNE PYST                                      S01508
     C           SMAM      ORNE SSMAM                                     095075
     C           RATE      ORNE SRATE                                     124674
     C                     MOVE 'Y'       WRDFTC  1                       S01508
     C                     END                                            S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C                     END                                            S01506
      *                                                                   045014
      *  Process shadow post if new addition and not regular payment      045014
      *  Or level incomplete i.e. insert of generated payment             045014
      *                                                                   045014
     C                     MOVEL*BLANKS   ##ACHG                          068320
      *                                                                   068320
     C           PYTP      IFNE 'RP'                                      045014
     C           LVL1      ANDEQ'Y'                                       045014
     C/COPY WNCPYSRC,FT0040C168
     C                     Z-SUBSMAM      ##SMAM                          031876
     C                     Z-SUBPYAM      ##PYAM                          031876
     C           CFT014    IFEQ 'Y'                                       CFT014
     C           OPRCRM    ANDNE*ZERO                                     CFT014
     C                     SUB  OPRCRM    ##PYAM                          CFT014
     C                     ENDIF                                          CFT014
     C                     EXSR SRADD                                     045014
      *                                                                   068320
      * If charges to be recalulated then reverse them out                068320
      *                                                                   068320
     C***********CDRO      IFEQ 0                                         068320              CSD027
     C           CDRO      IFEQ *BLANKS                                                       CSD027
     C           ACTION    OREQ 'D'                                       068320
     C/COPY WNCPYSRC,FT0040C302
     C           ACTION    IFEQ 'D'                                       068320
     C           SADDC     ORNE ADDC                                      068320
     C           SMCY      ANDNEPCCY                                      068320
     C           SADDC     ORNE ADDC                                      068320
     C           SSMCY     ANDNESPCCY                                     068320
     C           SPCCY     ORNE PCCY                                      068320
     C           SADDC     ANDEQ'D'                                       068320
     C           SSMCY     ORNE SMCY                                      068320
     C           SADDC     ANDEQ'A'                                       068320
     C           WRDFTC    OREQ 'Y'                                       S01506
     C/COPY WNCPYSRC,FT0040C303
      *                                                                   068320
      *  Only mark as add charges after update if not delete              068320
      *                                                                   068320
     C           ACTION    IFNE 'D'                                       068320
     C                     MOVEL'Y'       ##ACHG  1                       068320
     C                     END                                            068320
      *                                                                   068320
      * Calculate charge amount (always debit)                            068320
      *                                                                   068320
     C           TXCH      ADD  CQCH      ##CHGS                          068320
     C/COPY WNCPYSRC,FT0040C267
     C                     ADD  CSTA      ##CHGS                          068320
     C/COPY WNCPYSRC,FT0040C268
     C                     ADD  SPCH      ##CHGS                          068320
     C                     ADD  MSCH      ##CHGS                          068320
     C                     ADD  TRCM      ##CHGS                          068320
     C*                                                                   S01494
     C           S01494    IFEQ 'Y'                                       S01494
     C                     ADD  OPCHCM    ##CHGS                          S01494
     C                     END                                            S01494
     C*                                                                   S01499
     C           S01499    IFEQ 'Y'                                       S01499
     C           CFT010    OREQ 'Y'                                       CFT009
     C                     ADD  OPVATT    ##CHGS                          S01499
     C                     END                                            S01499
      ** Include Receiver's Charges remitted, if present                  CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
     C                     SELEC                                          CFT014
     C***********CDRO      WHNE *ZERO                                     CFT014              CSD027
     C           CDRO      WHNE *BLANKS                                                       CSD027
     C                     ADD  OPRBCQ    ##CHGS                          CFT014
     C           ADDC      WHEQ 'A'                                       CFT014
     C                     ADD  OPRCSC    ##CHGS                          CFT014
     C                     ENDSL                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   068320
     C           CFT009    IFEQ 'Y'                                       CFT009
     C           PREF      CHAINOTPAYXL2             88                   CFT009
     C                     ADD  MISC01    ##CHGS                          CFT009
     C                     ADD  MISC02    ##CHGS                          CFT009
     C                     ADD  MISC03    ##CHGS                          CFT009
     C                     ADD  MISC04    ##CHGS                          CFT009
     C                     ADD  MISC05    ##CHGS                          CFT009
     C                     ADD  SWSCHG    ##CHGS                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C           ##CHGS    IFNE 0                                         068320
     C                     Z-SUB##CHGS    ##CHGS                          068320
     C                     EXSR SRSCHG                                    068320
     C                     END                                            068320
     C                     END                                            068320
     C                     END                                            068320
      *                                                                   068320
     C                     END                                            045014
      *                                                                   045014
     C* IF AMEND AND ADD/DEDUCT INDICATOR HAS CHANGED,THEN
     C* CONVERT CHARGE VALUES IF NEEDED(ONLY IF CDRO BLANK) AND PAY
     C* AND SETTLE CCY DIFFER.
     C*
     C           CFT009    IFEQ 'N'                                       CFT009
     C           *IN13     IFEQ '1'
     C***********CDRO      ANDEQ0                                                             CSD027
     C           CDRO      ANDEQ*BLANKS                                                       CSD027
     C           SADDC     IFNE ADDC
     C           SMCY      ANDNEPCCY
     C*
     C           SPCCY     ORNE PCCY
     C           SADDC     ANDEQ'D'
     C*
     C           SSMCY     ORNE SMCY
     C           SADDC     ANDEQ'A'
     C*
     C           WRDFTC    OREQ 'Y'                                       S01506
     C           SMAM      ORNE SSMAM                                     095075
     C           RATE      ORNE SRATE                                     124674
     C                     EXSR CHARGE
     C                     END
     C                     END
     C                     ENDIF                                          CFT009
     C* AMEND
     C   13                EXSR MOVES
     C* DELETE
     C   14                MOVE 'C'       RECI
     C   14                MOVE 'C'       OPRECI                          CFT009
     C                     TIME           OTLCHT
     C*********************Z-ADDRUND      OTLCD                           S01194
     C                     Z-ADDBJRDNB    OTLCD                           S01194
     C* IF DELETE, CALL WINDOW PROGRAM TO DELETE ASSOCIATED RECORD        S01241
     C********** BGL5ST****IFEQ 'Y'                                 S01241S01251
     C           BGWDPR    IFEQ 'Y'                                       S01251
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0040CP45                                           S01408
     C*                                                                   S01408
     C*                                                                   S01241
     C           *IN14     IFEQ '1'                                       S01241
      *    /copy to move data into the data structure fields passed       S01241
      *     as a parameter to the window controller                       S01241
      /COPY WNCPYSRC,FT0040MOV1                                           S01241
     C/COPY WNCPYSRC,FT0040C140
      *                                                                   S01241
     C                     MOVEL'D'       #ACTN   1                       S01241
     C                     MOVE *BLANKS   RTNCDE  7                       S01241
     C                     MOVE *BLANKS   ##CMD   2                       S01241
     C                     MOVEL'FT0040'  ##PGM  10                       S01241
     C                     CALL 'WN0010'                                  S01241
     C                     PARM           ##PGM                           S01241
     C                     PARM           ##CMD                           S01241
     C                     PARM           #ACTN                           S01241
     C                     PARM           DATA                            S01241
     C**********           PARM           RTNCDE                    S01241S01252
     C                     PARM *BLANKS   RTNCDE                          S01252
     C                     PARM           SPAREE256                       S01252
      *                                                                   051173
      *   KL or DATA BASE error                                           051173
      *                                                                   051173
     C/COPY WNCPYSRC,FT0040C079
     C           RTNCDE    IFNE *BLANKS                                   051173
     C                     EXCPTOUTPAY                                    051173
     C                     GOTO UPDEND                                    051173
     C/COPY WNCPYSRC,FT0040C010
     C                     END                                            051173
     C/COPY WNCPYSRC,FT0040C300
      *                                                                   051173
     C                     END                                            S01241
     C*                                                                   S01241
     C                     END                                            S01241
     C* AMEND
     C   13                MOVE 'A'       CHTP
     C* DELETE
     C   14                MOVE 'D'       CHTP
     C* IF AMEND CLEAR AUTHORISE PROF 1
     C                     MOVE *BLANK    AUP1
     C*
     C** SET UP VALUE OF INPUT USER FOR LATER AUTHORISATION CHECK
     C*
     C                     MOVE USRID     INUSR1 10
     C*
      *                                                                   S01435
      *  /COPY for additional processing before updating OTPAYDD          S01435
      *                                                                   S01435
     C/COPY WNCPYSRC,FT0040UPDT                                           S01435
      *                                                                   CFT003
      *  If Batch Authorsation update/add record                          CFT003
      *                                                                   CFT003
     C           CFT003    IFEQ 'CFT003'                                  CFT003
     C/COPY WNCPYSRC,FT0040C283
     C           CFT014    OREQ 'Y'                                       CFT014
     C           CFT009    OREQ 'Y'                                       CFT009
      *                                                                   CFT003
      ** Update extension record to include the Auto-generated            CFT003
      ** indicator                                                        CFT003
      *                                                                   CFT003
     C           PREF      CHAINOTPAYXL0             90                   CFT003
      *                                                                   CFT009
      ** If the screen offset code is not blank, restore it here to       CFT009
      ** prevent overwrite                                                CFT009
      *                                                                   CFT009
     C           SOFCD     IFNE *BLANKS                                   CFT009
     C                     MOVELSOFCD     OTPDOF                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Restore the screen spread set, to prevent overwrite from the     CFT009
      ** chain                                                            CFT009
      *                                                                   CFT009
     C                     MOVELSPDSET    FXSRSC    P                     CFT009
      *                                                                   CFT003
      * If no existing extension record, insert new one                   CFT003
      *                                                                   CFT003
     C           *IN90     IFEQ '1'                                       CFT003
     C                     MOVELPREF      OPPREF                          CFT003
     C                     MOVEL*BLANK    OPBJPR                          CFT003
     C                     MOVEL'N'       OPAUTO                          CFT003
     C                     MOVELSTMT      OPSETM                          CFT003
     C/COPY WNCPYSRC,FT0040C284
      *                                                                   CFT003
     C           CFT014    IFNE 'Y'                                       CFT014
     C           CFT009    ANDNE'Y'                                       CFT009
     C                     EXSR SRSETF                                    CFT014
     C***********          WRITEOTPAYXDF                           CFT003 CFT014
     C                     MOVEASTAMP,1   OPTMST           Default Timestamp                  202937
     C                     WRITEOPAYXL0                                   CFT014
     C                     ELSE                                           CFT014
     C                     MOVEL'OTPAYXL0'DBFILE                          CFT014
     C                     Z-ADD65        DBASE                           CFT014
     C                     MOVELPREF      DBKEY                           CFT014
     C                     EXSR SRERR                                     CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT003
      * If existing extension record, update                              CFT003
      *                                                                   CFT003
     C                     ELSE                                           CFT003
     C           CFT014    IFEQ 'Y'                                       CFT014
     C                     Z-ADDWORTE     OPOEXR                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT009
      ** Move new charges before writing                                  CFT009
      *                                                                   CFT009
     C           CFT009    IFEQ 'Y'                                       CFT009
     C           F12       IFEQ *BLANKS                                   CFT009
     C                     MOVELSPDSET    FXSRSC                          CFT009
     C                     MOVELSOFCD     OTPDOF                          CFT009
     C                     ELSE                                           CFT009
      *                                                                   CFT009
     C           KEYCHG    IFEQ 'Y'                                       CFT009
      *** Also do if F12 has been pressed                                 CFT009
     C           FLAG12    OREQ 'N'                                       CFT009
     C                     EXSR CHGVAT                                    CFT009
     C                     EXSR MOVCHG                                    CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C           ACTION    IFEQ 'D'                                       CFT009
     C                     MOVE 'C'       OPRECI                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT003
     C                     MOVEL'N'       OPAUTO                          CFT003
     C                     MOVEL'N'       OPAUTO                          CFT003
     C/COPY WNCPYSRC,FT0040C285
     C***********          UPDATOTPAYXDF                                  CFT003
      *                                                                   CFT009
      ** Change to ensure changes in amend mode get to file.              CFT009
      *                                                                   CFT009
     C           ACTION    IFEQ 'A'                                       CFT009
     C           CFT009    ANDEQ'Y'                                                           227243
      *                                                                   CFT009
     C           KEYCHG    IFEQ 'Y'                                       CFT009
     C           FLAG12    OREQ 'N'                                       CFT009
     C                     EXSR CHGVAT                                    CFT009
     C                     EXSR MOVCHG                                    CFT009
     C                     Z-ADD0         DUMA1                           CFT009
     C                     Z-ADD0         DUMA2                           CFT009
     C                     Z-ADD0         DUMA3                           CFT009
     C                     Z-ADD0         DUMA4                           CFT009
     C                     Z-ADD0         DUMA5                           CFT009
     C                     Z-ADD0         DUMA6                           CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Set up screen field into file field, in case the user has        CFT009
      ** blanked out the date offset code on screen after pressing F12.   CFT009
      *                                                                   CFT009
     C           F12       IFEQ 'Y'                                       CFT009
     C                     MOVELSOFCD     OTPDOF                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     UPDATOPAYXL0                                   CFT014
     C                     ENDIF                                          CFT003
      *                                                                   CFT003
     C                     ENDIF                                          CFT003
      *                                                                   CFT003
      *                                                                   S01435
     C                     UPDATOTPAYDDF
     C/COPY WNCPYSRC,FT0040C262
      *                                                                   045014
      *  Process shadow post if reversal and not regular payment          045014
      *                                                                   045014
     C           PYTP      IFNE 'RP'                                      045014
     C           *IN14     ANDNE'1'                                       045014
     C/COPY WNCPYSRC,FT0040C169
     C                     Z-ADDSMAM      ##SMAM                          031876
     C                     Z-ADDPYAM      ##PYAM                          031876
     C           CFT014    IFEQ 'Y'                                       CFT014
     C           OPRCRM    ANDNE*ZERO                                     CFT014
     C                     ADD  OPRCRM    ##PYAM                          CFT014
     C                     ENDIF                                          CFT014
     C                     EXSR SRADD                                     045014
      *                                                                   068320
      * If charges to be recalulated then add them in                     068320
      *                                                                   068320
     C           ##ACHG    IFEQ 'Y'                                       068320
      *                                                                   068320
      * Calculate charge amount (always debit)                            068320
      *                                                                   068320
     C           TXCH      ADD  CQCH      ##CHGS                          068320
     C/COPY WNCPYSRC,FT0040C269
     C                     ADD  CSTA      ##CHGS                          068320
     C/COPY WNCPYSRC,FT0040C270
     C                     ADD  SPCH      ##CHGS                          068320
     C                     ADD  MSCH      ##CHGS                          068320
     C                     ADD  TRCM      ##CHGS                          068320
     C*                                                                   S01494
     C           S01494    IFEQ 'Y'                                       S01494
     C                     ADD  OPCHCM    ##CHGS                          S01494
     C                     END                                            S01494
     C*                                                                   S01499
     C           S01494    IFEQ 'Y'                                       S01499
     C           CFT010    OREQ 'Y'                                       CFT009
     C                     ADD  OPVATT    ##CHGS                          S01499
     C                     END                                            S01499
      *                                                                   CFT009
     C           CFT009    IFEQ 'Y'                                       CFT009
     C                     ADD  MISC01    ##CHGS                          CFT009
     C                     ADD  MISC02    ##CHGS                          CFT009
     C                     ADD  MISC03    ##CHGS                          CFT009
     C                     ADD  MISC04    ##CHGS                          CFT009
     C                     ADD  MISC05    ##CHGS                          CFT009
     C                     ADD  SWSCHG    ##CHGS                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Include Receiver's Charges remitted, if present                  CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
     C                     SELEC                                          CFT014
     C***********CDRO      WHNE *ZERO                                     CFT014              CSD027
     C           CDRO      WHNE *BLANKS                                                       CSD027
     C                     ADD  OPRBCQ    ##CHGS                          CFT014
     C           ADDC      WHEQ 'A'                                       CFT014
     C                     ADD  OPRCSC    ##CHGS                          CFT014
     C                     ENDSL                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   068320
     C           ##CHGS    IFNE 0                                         068320
     C                     EXSR SRSCHG                                    068320
     C                     END                                            068320
     C                     END                                            068320
      *                                                                   068320
     C                     END                                            045014
      *                                                                   S01435
      * Update Incoming Message FT Transaction Status File record         S01435
      *                                                                   S01435
     C           OPMSGR    IFNE 0                                         S01435
      *                                                                   S01435
     C           *IN13     IFEQ '1'                                       S01435
     C                     MOVEL'MIN0030' W0FLAG                          S01435
     C                     MOVEL'MIN0191' W0LMSG                          S01435
     C                     ELSE                                           S01435
     C                     MOVEL'MIN0031' W0FLAG                          S01435
     C                     MOVEL'MIN0192' W0LMSG                          S01435
     C                     END                                            S01435
     C                     MOVEL*BLANKS   PNWRK                           S01435
      *                                                                   S01435
     C                     EXSR SRINFT                                    S01435
      *                                                                   S01435
     C                     END                                            S01435
     C                     ELSE                                           CFT009
      * =========   Start AOSPOS for insert =========                     CFT009
      *                                                                   CFT009
     C           TXCH      ADD  CQCH      ##CHGS                          CFT009
     C                     ADD  CSTA      ##CHGS                          CFT009
     C                     ADD  SPCH      ##CHGS                          CFT009
     C                     ADD  MSCH      ##CHGS                          CFT009
     C                     ADD  TRCM      ##CHGS                          CFT009
      *                                                                   CFT009
     C                     SELEC                                          CFT009
     C***********CDRO      WHNE *ZEROS                                    CFT009              CSD027
     C           CDRO      WHNE *BLANKS                                                       CSD027
     C                     MOVELBCCY      CURCY                           CFT009
     C           ADDC      WHEQ 'A'                                       CFT009
     C                     MOVELSMCY      CURCY                           CFT009
     C                     OTHER                                          CFT009
     C                     MOVELPCCY      CURCY                           CFT009
     C                     ENDSL                                          CFT009
      *                                                                   CFT009
     C                     Z-ADDTXCH      INPCHG                          CFT009
     C                     EXSR FT0985                                    CFT009
     C                     ADD  LEVCHG    ##CHGS                          CFT009
      *                                                                   CFT009
     C                     Z-ADDCQCH      INPCHG                          CFT009
     C                     EXSR FT0985                                    CFT009
     C                     ADD  LEVCHG    ##CHGS                          CFT009
      *                                                                   CFT009
     C                     Z-ADDCSTA      INPCHG                          CFT009
     C                     EXSR FT0985                                    CFT009
     C                     ADD  LEVCHG    ##CHGS                          CFT009
      *                                                                   CFT009
     C                     Z-ADDSPCH      INPCHG                          CFT009
     C                     EXSR FT0985                                    CFT009
     C                     ADD  LEVCHG    ##CHGS                          CFT009
      *                                                                   CFT009
     C                     Z-ADDMSCH      INPCHG                          CFT009
     C                     EXSR FT0985                                    CFT009
     C                     ADD  LEVCHG    ##CHGS                          CFT009
      *                                                                   CFT009
     C                     Z-ADDTRCM      INPCHG                          CFT009
     C                     EXSR FT0985                                    CFT009
     C                     ADD  LEVCHG    ##CHGS                          CFT009
     C*                                                                   CFT009
     C*                                                                   CFT009
     C           S01494    IFEQ 'Y'                                       CFT009
     C                     Z-ADDOPCHCM    ##CHGS                          CFT009
     C                     ENDIF                                          CFT009
     C*                                                                   CFT009
     C           S01499    IFEQ 'Y'                                       CFT009
     C           CFT010    OREQ 'Y'                                       CFT009
     C                     EXSR CHGVAT                                    CFT009
     C                     Z-ADDOPVATT    INPCHG                          CFT009
     C                     EXSR FT0985                                    CFT009
     C                     ADD  LEVCHG    ##CHGS                          CFT009
     C                     ENDIF                                          CFT009
      ** Include Receiver's Charges remitted, if present                  CFT009
     C           CFT014    IFEQ 'Y'                                       CFT009
     C                     SELEC                                          CFT009
     C***********CDRO      WHNE *ZERO                                     CFT009              CSD027
     C           CDRO      WHNE *BLANKS                                                       CSD027
     C                     Z-ADDOPRBCQ    ##CHGS                          CFT009
     C           ADDC      WHEQ 'A'                                       CFT009
     C                     Z-ADDOPRCSC    ##CHGS                          CFT009
     C                     ENDSL                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C           CFT009    IFEQ 'Y'                                       CFT009
     C           PREF      CHAINOTPAYXL2             88                   CFT009
     C                     ADD  MISC01    ##CHGS                          CFT009
     C                     ADD  MISC02    ##CHGS                          CFT009
     C                     ADD  MISC03    ##CHGS                          CFT009
     C                     ADD  MISC04    ##CHGS                          CFT009
     C                     ADD  MISC05    ##CHGS                          CFT009
     C                     ADD  SWSCHG    ##CHGS                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C           ##CHGS    IFNE 0                                         CFT009
     C                     EXSR SRSCHG                                    CFT009
     C                     ENDIF                                          CFT009
      * =========   End AOSPOS Update for insert ============             CFT009
     C                     END                             E001
      *                                                                   045014
      *  Update database with changes                                     045014
      *                                                                   045014
     C                     EXSR SRUPD                                     045014
      *                                                                   045014
     C* NOT DELETE UPDATE TRAILER
     C  N14                DO                              B001
     C           1         CHAINOTPAYZZF             88
     C   88                DO                              B002
     C           *LOCK     IN   DLDA
     C                     MOVE 'FT0040  'DBPGM
     C                     MOVE 'OTPAY'   DBFILE           ***************
     C                     Z-ADD6         DBASE            * DB ERROR 06 *
     C                     MOVEL'1'       DBKEY            ***************
     C                     OUT  DLDA
     C                     SETON                     U7U8LR
     C/COPY WNCPYSRC,FT0040C141
     C                     DUMP
      *                                                                   042167
      *  Allocate dataarea to blanks                                      042167
      *                                                                   042167
     C                     EXSR DALLOC                                    042167
      *                                                                   042167
     C                     RETRN
     C                     END                             E002
     C                     Z-ADDHRWN      ZZTOTI
     C                     Z-ADDHRDC      ZZTOTD
     C   12                ADD  1         NORE1
     C   12      SSMAM     DIV  1000      ZZAMT
     C   13                DO                              B002
     C           SSMAM     DIV  1000      ZZAMT1 153
     C           OSMAM     DIV  -1000     ZZAMT
     C                     ADD  ZZAMT1    ZZAMT
     C                     END                             E002
     C                     EXSR GLZADD
     C                     Z-ADDZZTOTI    HRWN
     C                     Z-ADDZZTOTD    HRDC
     C                     UPDATOTPAYZZF
     C                     END                             E001
      ************                                                        031876
      ************  Remove PRONO OLPOS and MEMOS                          031876
      ************                                                        031876
     C***U1*******         EXSR MEMO                                      031876
     C***U2*******         EXSR PROPO                                     031876
     C/COPY WNCPYSRC,FT0040C073
      **                                                                                      CSC022
      ** Execute commit if SAR CSC022 is not enrolled or                                      CSC022
      **   job is not currently running in batch mode                                         CSC022
      **                                                                                      CSC022
     C           CSC022    IFEQ 'N'                                                           CSC022
     C           CSC022    OREQ 'Y'                                                           CSC022
     C           WCRSKP    ANDEQ'N'                                                           CSC022
     C           COMBOU    COMIT
     C                     ENDIF                                                              CSC022
      *                                                                   045014
      *  Clear stored values                                              045014
      *                                                                   045014
     C           UPDEND    TAG                                            031876
     C                     EXSR SRCLR                                     045014
     C*
     C/COPY WNCPYSRC,FT0040C074
      *                                                                   031876
      *  Unwind subroutine stack name                                     031876
      *                                                                   031876
     C                     MOVEA*BLANKS   @STK,Q                          031876
     C                     SUB  1         Q       50                      031876
      *                                                                   031876
     C***********UPDEND    ENDSR                           ** UPDEND      031876
     C                     ENDSR                           ** UPDEND      031876
     C*
     C************************************************************
     C* END OF UPDATE SUBROUTINE
      *****************************************************************   CFT014
      * FT0985 SR.                                                        CFT009
      * CALL PROGRAM FT0985 TO CALCULATE LEVIED CHARGE                    CFT009
      *                                                                   CFT009
     C           FT0985    BEGSR                                          CFT009
     C                     Z-ADD0         LEVCHG                          CFT009
      *                                                                                       195762
     C           CFT009    IFEQ 'Y'                                                           195762
      *                                                                                       195762
     C                     CALL 'FT000985'                                CFT009
     C                     PARM           RET985 10                       CFT009
     C                     PARM           INPCHG 130                      CFT009
     C                     PARM           PCCY                            CFT009
     C                     PARM           SMCY                            CFT009
     C                     PARM           OPCHGC                          CFT009
     C                     PARM           CURCY   3                       CFT009
     C                     PARM           OPCHRT                          CFT009
     C                     PARM           LEVCHG 130                      CFT009
     C                     PARM           LEVFMT 16                       CFT009
      *                                                                                       195762
     C                     ENDIF                                                              195762
      *                                                                                       195762
     C                     ENDSR                                          CFT009
      *                                                                   CFT009
      *****************************************************************   CFT009
      /TITLE SR/SRSETF                                                    CFT014
      *****************************************************************   CFT014
      *                                                               *   CFT014
      *  SRSETF - Reset MT103 additional new fields                   *   CFT014
      *                                                               *   CFT014
      *  Called By: UPDATE Subroutine                                 *   CFT014
      *                                                               *   CFT014
      *  Calls: None                                                  *   CFT014
      *                                                               *   CFT014
      *****************************************************************   CFT014
     C           SRSETF    BEGSR                           *** SRSETF *** CFT014
     C                     MOVE *BLANK    OPBOCD                          CFT014
     C                     MOVE *BLANK    OPICD1                          CFT014
     C                     MOVE *BLANK    OPICD2                          CFT014
     C                     MOVE *BLANK    OPICD3                          CFT014
     C                     MOVE *BLANK    OPICD4                          CFT014
     C                     MOVE *BLANK    OPICD5                          CFT014
     C                     MOVE *BLANK    OPTTCD                          CFT014
     C                     MOVE *BLANK    OPTRIT                          CFT014
     C                     MOVE *BLANK    OPTRI1                          CFT014
     C                     MOVE *BLANK    OPTRI2                          CFT014
     C                     MOVE *BLANK    OPTRI3                          CFT014
     C                     MOVE *BLANK    OPTRI4                          CFT014
     C                     MOVE *BLANK    OPTRI5                          CFT014
     C                     MOVE *BLANK    OPRRP1                          CFT014
     C                     MOVE *BLANK    OPRRP2                          CFT014
     C                     MOVE *BLANK    OPRRP3                          CFT014
     C                     MOVE *BLANK    OPFRNT                          CFT014
     C                     MOVE *BLANK    OPREPA                          CFT014
     C                     MOVE *BLANK    OPSCC1                          CFT014
     C                     MOVE *BLANK    OPSCC2                          CFT014
     C                     MOVE *BLANK    OPSCC3                          CFT014
     C                     MOVE *BLANK    OPSCC4                          CFT014
     C                     MOVE *BLANK    OPSCC5                          CFT014
     C                     MOVE *BLANK    OPRCCN                          CFT014
     C                     Z-ADD*ZERO     OPOEXR                          CFT014
     C                     Z-ADD*ZERO     OPSCH1                          CFT014
     C                     Z-ADD*ZERO     OPSCH2                          CFT014
     C                     Z-ADD*ZERO     OPSCH3                          CFT014
     C                     Z-ADD*ZERO     OPSCH4                          CFT014
     C                     Z-ADD*ZERO     OPSCH5                          CFT014
     C           CFT009    IFNE 'Y'                                       CFT009
     C                     Z-ADD*ZERO     OPRCRM                          CFT014
     C                     ENDIF                                          CFT009
     C                     Z-ADD*ZERO     OPRBCQ                          CFT014
     C                     Z-ADD*ZERO     OPRCSC                          CFT014
     C                     Z-ADD*ZERO     OPRCSQ                          CFT014
     C                     Z-ADD*ZERO     OPRCNW                          CFT014
     C                     ENDSR                                          CFT014
      *****************************************************************   CFT014
      * End of Resetting MT103 additional fields                          CFT014
      *****************************************************************   CFT014
      *                                                               *   CFT014
      *  FLHIZO - Fill  MT103 additional new fields coming from       *   CFT014
      *  routed message                                               *   CFT014
      *                                                               *   CFT014
      *  Called By: UPDATE Subroutine                                 *   CFT014
      *                                                               *   CFT014
      *  Calls: None                                                  *   CFT014
      *                                                               *   CFT014
      *****************************************************************   CFT014
     C           FLHIZO    BEGSR                                          CFT014
      *  Set up subroutine stack name                                     CFT014
     C                     ADD  1         Q                               CFT014
     C                     MOVEL'FLHIZO'  @STK,Q                          CFT014
      ** Hidden zones are supposed to be filled only in EISWFT            CFT014
     C           OPMSGR    IFEQ 0                                         CFT014
     C                     GOTO EXFHZO                                    CFT014
     C                     ENDIF                                          CFT014
      ** Hidden zones filled by routing an incoming MT103 message         CFT014
      ** These zones belong to other parts of the transaction             CFT014
      ** They will be validated by the screen they belong to              CFT014
     C           *LIKE     DEFN OPBOCD    MGBOCD                          CFT014
     C           *LIKE     DEFN OPICD1    MGICD1                          CFT014
     C           *LIKE     DEFN OPICD2    MGICD2                          CFT014
     C           *LIKE     DEFN OPICD3    MGICD3                          CFT014
     C           *LIKE     DEFN OPICD4    MGICD4                          CFT014
     C           *LIKE     DEFN OPICD5    MGICD5                          CFT014
     C           *LIKE     DEFN OPTTCD    MGTTCD                          CFT014
     C           *LIKE     DEFN OPTRIT    MGTRIT                          CFT014
     C           *LIKE     DEFN OPTRI1    MGTRI1                          CFT014
     C           *LIKE     DEFN OPTRI2    MGTRI2                          CFT014
     C           *LIKE     DEFN OPTRI3    MGTRI3                          CFT014
     C           *LIKE     DEFN OPTRI4    MGTRI4                          CFT014
     C           *LIKE     DEFN OPTRI5    MGTRI5                          CFT014
     C           *LIKE     DEFN OPRRP1    MGRRP1                          CFT014
     C           *LIKE     DEFN OPRRP2    MGRRP2                          CFT014
     C           *LIKE     DEFN OPRRP3    MGRRP3                          CFT014
     C           *LIKE     DEFN OPRCCN    MGRCCN                          CFT014
     C           *LIKE     DEFN OPRCNW    MGRCNW                          CFT014
     C           *LIKE     DEFN OPRCUS    MGRCUS                          CFT014
     C                     MOVELMGBOCD    OPBOCD                          CFT014
     C                     MOVELMGICD1    OPICD1                          CFT014
     C                     MOVELMGICD2    OPICD2                          CFT014
     C                     MOVELMGICD3    OPICD3                          CFT014
     C                     MOVELMGICD4    OPICD4                          CFT014
     C                     MOVELMGICD5    OPICD5                          CFT014
     C                     MOVELMGTTCD    OPTTCD                          CFT014
     C                     MOVELMGTRIT    OPTRIT                          CFT014
     C                     MOVELMGTRI1    OPTRI1                          CFT014
     C                     MOVELMGTRI2    OPTRI2                          CFT014
     C                     MOVELMGTRI3    OPTRI3                          CFT014
     C                     MOVELMGTRI4    OPTRI4                          CFT014
     C                     MOVELMGTRI5    OPTRI5                          CFT014
     C                     MOVELMGRRP1    OPRRP1                          CFT014
     C                     MOVELMGRRP2    OPRRP2                          CFT014
     C                     MOVELMGRRP3    OPRRP3                          CFT014
     C                     MOVELMGSCC1    OPSCC1                          CFT014
     C                     MOVELMGSCC2    OPSCC2                          CFT014
     C                     MOVELMGSCC3    OPSCC3                          CFT014
     C                     MOVELMGSCC4    OPSCC4                          CFT014
     C                     MOVELMGSCC5    OPSCC5                          CFT014
     C                     MOVELMGRCCN    OPRCCN                          CFT014
     C                     Z-ADDMGSCH1    OPSCH1                          CFT014
     C                     Z-ADDMGSCH2    OPSCH2                          CFT014
     C                     Z-ADDMGSCH3    OPSCH3                          CFT014
     C                     Z-ADDMGSCH4    OPSCH4                          CFT014
     C                     Z-ADDMGSCH5    OPSCH5                          CFT014
     C                     Z-ADDMGRCNW    OPRCNW                          CFT014
     C                     MOVELMGRCUS    OPRCUS                          CFT014
     C                     MOVEL*BLANK    MGBOCD                          CFT014
     C                     MOVEL*BLANK    MGICD1                          CFT014
     C                     MOVEL*BLANK    MGICD2                          CFT014
     C                     MOVEL*BLANK    MGICD3                          CFT014
     C                     MOVEL*BLANK    MGICD4                          CFT014
     C                     MOVEL*BLANK    MGICD5                          CFT014
     C                     MOVEL*BLANK    MGTTCD                          CFT014
     C                     MOVEL*BLANK    MGTRIT                          CFT014
     C                     MOVEL*BLANK    MGTRI1                          CFT014
     C                     MOVEL*BLANK    MGTRI2                          CFT014
     C                     MOVEL*BLANK    MGTRI3                          CFT014
     C                     MOVEL*BLANK    MGTRI4                          CFT014
     C                     MOVEL*BLANK    MGTRI5                          CFT014
     C                     MOVEL*BLANK    MGRRP1                          CFT014
     C                     MOVEL*BLANK    MGRRP2                          CFT014
     C                     MOVEL*BLANK    MGRRP3                          CFT014
     C                     MOVEL*BLANK    MGSCC1                          CFT014
     C                     MOVEL*BLANK    MGSCC2                          CFT014
     C                     MOVEL*BLANK    MGSCC3                          CFT014
     C                     MOVEL*BLANK    MGSCC4                          CFT014
     C                     MOVEL*BLANK    MGSCC5                          CFT014
     C                     MOVEL*BLANK    MGRCCN                          CFT014
     C                     Z-ADD0         MGSCH1                          CFT014
     C                     Z-ADD0         MGSCH2                          CFT014
     C                     Z-ADD0         MGSCH3                          CFT014
     C                     Z-ADD0         MGSCH4                          CFT014
     C                     Z-ADD0         MGSCH5                          CFT014
     C                     Z-ADD0         MGRCNW                          CFT014
     C                     MOVEL*BLANK    MGRCUS                          CFT014
      *  Unwind subroutine stack name                                     CFT014
     C           EXFHZO    TAG                                            CFT014
     C                     MOVEA*BLANKS   @STK,Q                          CFT014
     C                     SUB  1         Q       50                      CFT014
     C                     ENDSR                                          CFT014
      *****************************************************************   CFT014
      * End of Resetting MT103 additional fields                          CFT014
     C************************************************************
     C/EJECT                                                              031876
      *****************************************************************   031876
      *                                                               *   031876
      *  SRCLR    : Clear all positions in store                      *   031876
      *                                                               *   031876
      *  CALLED BY: UPDATE - Update database                          *   031876
      *                                                               *   031876
      *  CALLS    : SRERR - Report errors                             *   031876
      *                                                               *   031876
      *****************************************************************   031876
     CSR         SRCLR     BEGSR                                          031876
      *                                                                   031876
      *  Set up subroutine stack name                                     031876
      *                                                                   031876
     C                     ADD  1         Q                               031876
     C                     MOVEL'SRCLR'   @STK,Q                          031876
      *                                                                   031876
      *  Clear arrays in AOSPOSU0                                         031876
      *                                                                   031876
     C                     CLEARC#DTA                                     031876
     C                     CALL 'AOSPOSU0'             9090               031876
     C           R#RTN     PARM *BLANKS   O#RTN   7                       031876
     C                     PARM '*CLEAR  'W0ACT   8                       031876
     C                     PARM C#DTA     O#DTA 256                       031876
      *                                                                   031876
     C           *IN90     IFEQ '1'                                       031876
     C           R#RTN     ORNE *BLANKS                                   031876
     C                     MOVEL'*CALL   'W0FILE                          031876
     C                     MOVEL'AOSPOSU0'W0KEY                           031876
     C                     Z-ADD901       W0ERNB                          031876
     C                     MOVELERR@,1    W0NARR                          031876
     C                     EXSR SRERR                                     031876
     C                     END                                            031876
     C/COPY WNCPYSRC,FT0040C291
      *                                                                   031876
      *  Unwind subroutine stack name                                     031876
      *                                                                   031876
     C           EXCLR     TAG                                            031876
     C                     MOVEA*BLANKS   @STK,Q                          031876
     C                     SUB  1         Q       50                      031876
      *                                                                   031876
     CSR                   ENDSR                                          031876
     C/EJECT                                                              031876
      *****************************************************************   031876
      *                                                               *   031876
      *  SRADD    : Add shadow positions to store                     *   031876
      *                                                               *   031876
      *  CALLED BY: UPDATE - Update database                          *   031876
      *                                                               *   031876
      *  CALLS    : SRERR - Report errors                             *   031876
      *                                                               *   031876
      *****************************************************************   031876
     CSR         SRADD     BEGSR                                          031876
      *                                                                   031876
      *  Set up subroutine stack name                                     031876
      *                                                                   031876
     C                     ADD  1         Q                               031876
     C                     MOVEL'SRADD'   @STK,Q                          031876
      *                                                                   031876
      *  Define settle and pay amounts                                    031876
      *                                                                   031876
     C           *LIKE     DEFN SMAM      ##SMAM                          031876
     C           *LIKE     DEFN PYAM      ##PYAM                          031876
      *                                                                   031876
      *  Move fields to C#DTA structure and call AOSPOSU0                 031876
      *                                                                   031876
      *         S E T T L E    I N S T R U C T I O N S                    031876
      *                                                                   031876
      *  Only execute if Outgoing Payment not generated                   031876
      *                                                                   031876
     C           OPIN      IFNE 'Y'                                       031876
     C                     CLEARC#DTA                                     031876
     C           ORBT      IFNE *BLANKS                                   031876
     C/COPY WNCPYSRC,FT0040C170
     C                     MOVELORBT      C#ATYP                          031876
     C                     MOVELORBK      C#ACCT                          031876
     C                     EXSR SRACCT                                                        CGL029
     C                     MOVELORBB      C#BRCA                          031876
     C/COPY WNCPYSRC,FT0040C061
     C                     ELSE                                           031876
     C                     MOVELORCT      C#ATYP                          031876
     C                     MOVELORC1      C#ACCT                          031876
     C                     EXSR SRACCT                                                        CGL029
     C/COPY WNCPYSRC,FT0040C037
     C                     END                                            031876
     C/COPY WNCPYSRC,FT0040C235
     C                     Z-ADDSLDT      C#VDAT                          031876
      *                                                                   045014
      * Set posting date according to FT Control Data                     045014
      *                                                                   045014
     C           C#PDTI    IFEQ 'I'                                       045014
     C                     Z-ADDBJRDNB    C#PSTD                          045014
     C                     ELSE                                           045014
     C           C#PDTI    IFEQ 'E'                                       045014
     C                     Z-ADDSLDT      C#PSTD                          045014
     C                     ELSE                                           045014
     C           SLDT      IFLT PVDT                                      045014
     C                     Z-ADDSLDT      C#PSTD                          045014
     C                     ELSE                                           045014
     C                     Z-ADDPVDT      C#PSTD                          045014
     C                     END                                            045014
     C                     END                                            045014
     C                     END                                            045014
      *                                                                   045014
     C***********          Z-ADDSLDT      C#PSTD                    031876045014
     C                     MOVEL'I'       C#IO                            031876
     C                     MOVELSMCY      C#CCY                           031876
     C                     MOVELPYTP      C#TRYP                          031876
     C                     MOVELPREF      C#PREF                          031876
     C                     Z-ADD##SMAM    C#AMT                           031876
     C                     MOVEL'FT'      C#MOD                           031876
     C                     MOVEL'01'      C#OLRC                          031876
     C***********          MOVEL'Y'       C#FTOV                    031876045014
     C                     MOVEL##FTOV    C#FTOV                          045014
     C                     MOVEL'Y'       C#RPST                          068347
     C                     Z-ADD10        C#RPNB                          068347
     C                     MOVEL'D'       C#RTYP                          068347
     C           CAP205    IFEQ 'Y'                                                           CAP205
     C                     MOVEL'F'       C#MTYP                                              CAP205
     C                     ENDIF                                                              CAP205
      *                                                                   031876
      *  Call AOSPOSU0                                                    031876
      *                                                                   031876
     C/COPY WNCPYSRC,FT0040C077
     C                     CALL 'AOSPOSU0'             9090               031876
     C           R#RTN     PARM *BLANKS   O#RTN   7                       031876
     C                     PARM '*ADD    'W0ACT   8                       031876
     C                     PARM C#DTA     O#DTA 256                       031876
      *                                                                   031876
     C           *IN90     IFEQ '1'                                       031876
     C           R#RTN     ORNE *BLANKS                                   031876
     C                     MOVEL'*CALL   'W0FILE                          031876
     C                     MOVEL'AOSPOSU0'W0KEY                           031876
     C                     Z-ADD902       W0ERNB                          031876
     C                     MOVELERR@,1    W0NARR                          031876
     C                     EXSR SRERR                                     031876
     C                     END                                            031876
     C                     END                                            031876
     C/COPY WNCPYSRC,FT0040C292
      *                                                                   031876
      *         P A Y          I N S T R U C T I O N S                    031876
      *                                                                   031876
     C                     CLEARC#DTA                                     031876
     C           SNCT      IFNE *BLANKS                                   031876
     C/COPY WNCPYSRC,FT0040C171
     C                     MOVELSNCT      C#ATYP                          031876
     C                     MOVELSNCO      C#ACCT                          031876
     C                     EXSR SRACCT                                                        CGL029
     C/COPY WNCPYSRC,FT0040C172
     C                     ELSE                                           031876
     C                     MOVELDSTT      C#ATYP                          031876
     C                     MOVELDST1      C#ACCT                          031876
     C                     EXSR SRACCT                                                        CGL029
     C                     END                                            031876
     C/COPY WNCPYSRC,FT0040C236
     C                     Z-ADDPVDT      C#VDAT                          031876
      *                                                                   045014
      * Set posting date according to FT Control Data                     045014
      *                                                                   045014
     C           C#PDTI    IFEQ 'I'                                       045014
     C                     Z-ADDBJRDNB    C#PSTD                          045014
     C                     ELSE                                           045014
     C           C#PDTI    IFEQ 'E'                                       045014
     C                     Z-ADDPVDT      C#PSTD                          045014
     C                     ELSE                                           045014
     C           SLDT      IFLT PVDT                                      045014
     C                     Z-ADDSLDT      C#PSTD                          045014
     C                     ELSE                                           045014
     C                     Z-ADDPVDT      C#PSTD                          045014
     C                     END                                            045014
     C                     END                                            045014
     C                     END                                            045014
      *                                                                   045014
     C***********          Z-ADDPVDT      C#PSTD                    031876045014
     C                     MOVEL'O'       C#IO                            031876
     C                     MOVELPCCY      C#CCY                           031876
     C                     MOVELPYTP      C#TRYP                          031876
     C                     MOVELPREF      C#PREF                          031876
     C                     Z-SUB##PYAM    C#AMT                           031876
     C                     MOVEL'FT'      C#MOD                           031876
     C                     MOVEL'01'      C#OLRC                          031876
     C***********          MOVEL'Y'       C#FTOV                    031876045014
     C                     MOVEL##FTOV    C#FTOV                          045014
     C                     MOVEL'Y'       C#RPST                          068347
     C                     Z-ADD20        C#RPNB                          068347
     C                     MOVEL'C'       C#RTYP                          068347
     C           CAP205    IFEQ 'Y'                                                           CAP205
     C                     MOVEL'F'       C#MTYP                                              CAP205
     C                     ENDIF                                                              CAP205
      *                                                                   031876
      *  Call AOSPOSU0                                                    031876
      *                                                                   031876
     C/COPY WNCPYSRC,FT0040C078
     C                     CALL 'AOSPOSU0'             9090               031876
     C           R#RTN     PARM *BLANKS   O#RTN   7                       031876
     C                     PARM '*ADD    'W0ACT   8                       031876
     C                     PARM C#DTA     O#DTA 256                       031876
      *                                                                   031876
     C           *IN90     IFEQ '1'                                       031876
     C           R#RTN     ORNE *BLANKS                                   031876
     C                     MOVEL'*CALL   'W0FILE                          031876
     C                     MOVEL'AOSPOSU0'W0KEY                           031876
     C                     Z-ADD903       W0ERNB                          031876
     C                     MOVELERR@,1    W0NARR                          031876
     C                     EXSR SRERR                                     031876
     C                     END                                            031876
     C/COPY WNCPYSRC,FT0040C293
      *                                                                   031876
      *  Unwind subroutine stack name                                     031876
      *                                                                   031876
     C           EXADD     TAG                                            031876
     C                     MOVEA*BLANKS   @STK,Q                          031876
     C                     SUB  1         Q       50                      031876
      *                                                                   031876
     CSR                   ENDSR                                          031876
     C/EJECT                                                              068320
      *****************************************************************   068320
      *                                                               *   068320
      *  SRSCHG   : Reverse charges from database                     *   068320
      *                                                               *   068320
      *  CALLED BY: EEAMND - Amendtaarecordd                          *   068320
      *             EGDELT - Delete a record                          *   068320
      *                                                               *   068320
      *  CALLS    : SRERR - Report errors                             *   068320
      *                                                               *   068320
      *****************************************************************   068320
     CSR         SRSCHG    BEGSR                                          068320
      *                                                                   068320
      *  Set up subroutine stack name                                     068320
      *                                                                   068320
     C                     ADD  1         Q                               068320
     C                     MOVEL'SRSCHG'  @STK,Q                          068320
      *                                                                   068320
      *  Move fields to C#DTA structure and call AOSPOSU0                 068320
      *                                                                   068320
     C                     CLEARC#DTA                                     068320
      *                                                                   068320
      *  If add use Receiver's Correspondent and Sender                   068320
      *                                                                   068320
     C                     SELEC                                          068320
     C           CDRT      WHNE *BLANKS                                   068320
     C                     MOVELCDRT      C#ATYP                          068320
     C                     MOVELCDRO      C#ACCT                          068320
     C                     EXSR SRACCT                                                        CGL029
     C                     MOVELCDBR      C#BRCA                          068320
     C                     MOVELBJCYCD    C#CCY                           068320
     C/COPY WNCPYSRC,FT0040C070
     C           ADDC      IFEQ 'A'                                       068320
     C                     Z-ADDSLDT      C#VDAT                          068320
     C                     ELSE                                           068320
     C                     Z-ADDPVDT      C#VDAT                          068320
     C                     END                                            068320
     C           ADDC      WHEQ 'A'                                       068320
     C                     MOVELSMCY      C#CCY                           068320
     C           ORBT      IFNE *BLANKS                                   068320
     C                     MOVELORBT      C#ATYP                          068320
     C                     MOVELORBK      C#ACCT                          068320
     C                     EXSR SRACCT                                                        CGL029
     C                     MOVELORBB      C#BRCA                          068320
     C/COPY WNCPYSRC,FT0040C173
     C                     ELSE                                           068320
     C                     MOVELORCT      C#ATYP                          068320
     C                     MOVELORC1      C#ACCT                          068320
     C                     EXSR SRACCT                                                        CGL029
     C/COPY WNCPYSRC,FT0040C038
     C                     END                                            068320
     C/COPY WNCPYSRC,FT0040C237
     C                     Z-ADDSLDT      C#VDAT                          068320
     C                     OTHER                                          068320
      *                                                                   068320
      *  If deduct use Account with Bank and Beneficiary                  068320
      *                                                                   068320
     C                     MOVELPCCY      C#CCY                           068320
     C           SNCT      IFNE *BLANKS                                   068320
     C                     MOVELSNCT      C#ATYP                          068320
     C                     MOVELSNCO      C#ACCT                          068320
     C                     EXSR SRACCT                                                        CGL029
     C/COPY WNCPYSRC,FT0040C174
     C                     ELSE                                           068320
     C                     MOVELDSTT      C#ATYP                          068320
     C                     MOVELDST1      C#ACCT                          068320
     C                     EXSR SRACCT                                                        CGL029
     C                     END                                            068320
     C/COPY WNCPYSRC,FT0040C238
     C                     Z-ADDPVDT      C#VDAT                          068320
     C                     END                                            068320
      *                                                                   068320
      * Set posting date according to FT Control Data                     068320
      *                                                                   068320
     C           C#PDTI    IFEQ 'I'                                       068320
     C                     Z-ADDBJRDNB    C#PSTD                          068320
     C                     ELSE                                           068320
     C           C#PDTI    IFEQ 'E'                                       068320
     C           ADDC      IFEQ 'A'                                       068320
     C                     Z-ADDSLDT      C#PSTD                          068320
     C                     ELSE                                           068320
     C                     Z-ADDPVDT      C#PSTD                          068320
     C                     END                                            068320
     C                     ELSE                                           068320
     C           SLDT      IFLT PVDT                                      068320
     C                     Z-ADDSLDT      C#PSTD                          068320
     C                     ELSE                                           068320
     C                     Z-ADDPVDT      C#PSTD                          068320
     C                     END                                            068320
     C                     END                                            068320
     C                     END                                            068320
      *                                                                   068320
     C                     MOVEL'I'       C#IO                            068320
     C                     MOVELPYTP      C#TRYP                          068320
     C                     MOVELPREF      C#PREF                          068320
     C                     MOVEL'FT'      C#MOD                           068320
     C                     MOVEL'01'      C#OLRC                          068320
     C                     MOVEL##FTOV    C#FTOV                          068320
     C           *LIKE     DEFN C#AMT     ##CHGS                          068320
     C                     Z-ADD##CHGS    C#AMT                           068320
     C                     MOVEL'Y'       C#RPST                          068347
     C                     Z-ADD30        C#RPNB                          068347
     C                     MOVEL'D'       C#RTYP                          068347
     C           CAP205    IFEQ 'Y'                                                           CAP205
     C                     MOVEL'F'       C#MTYP                                              CAP205
     C                     ENDIF                                                              CAP205
      *                                                                   068320
      *  Call AOSPOSU0                                                    068320
      *                                                                   068320
     C/COPY WNCPYSRC,FT0040C106
     C                     CALL 'AOSPOSU0'             9090               068320
     C           R#RTN     PARM *BLANKS   O#RTN   7                       068320
     C                     PARM '*ADD    'W0ACT   8                       068320
     C                     PARM C#DTA     O#DTA 256                       068320
      *                                                                   068320
     C           *IN90     IFEQ '1'                                       068320
     C           R#RTN     ORNE *BLANKS                                   068320
     C                     MOVEL'*CALL   'W0FILE                          068320
     C                     MOVEL'AOSPOSU0'W0KEY                           068320
     C                     Z-ADD942       W0ERNB                          068320
     C                     MOVELERR@,1    W0NARR                          068320
     C                     EXSR SRERR                                     068320
     C                     END                                            068320
      *                                                                   068320
     C/COPY WNCPYSRC,FT0040C271
      *  Unwind subroutine stack name                                     068320
      *                                                                   068320
     C           EXSCHG    TAG                                            068320
     C                     MOVEA*BLANKS   @STK,Q                          068320
     C                     SUB  1         Q       50                      068320
      *                                                                   068320
     CSR                   ENDSR                                          068320
     C/EJECT                                                              031876
      *****************************************************************   031876
      *                                                               *   031876
      *  SRUPD    : Update database with shadow positions             *   031876
      *                                                               *   031876
      *  CALLED BY: UPDATE - Update database                          *   031876
      *                                                               *   031876
      *  CALLS    : SRERR - Report errors                             *   031876
      *                                                               *   031876
      *****************************************************************   031876
     CSR         SRUPD     BEGSR                                          031876
      *                                                                   031876
      *  Set up subroutine stack name                                     031876
      *                                                                   031876
     C                     ADD  1         Q                               031876
     C                     MOVEL'SRUPD'   @STK,Q                          031876
      *                                                                   031876
      *  Call AOSPOSU0 to update database                                 031876
      *                                                                   031876
     C                     CALL 'AOSPOSU0'             9090               031876
     C           R#RTN     PARM *BLANKS   O#RTN   7                       031876
     C                     PARM '*UPDATE 'W0ACT   8                       031876
     C                     PARM C#DTA     O#DTA 256                       031876
      *                                                                   031876
     C           *IN90     IFEQ '1'                                       031876
     C           R#RTN     ORNE *BLANKS                                   031876
     C                     MOVEL'*CALL   'W0FILE                          031876
     C                     MOVEL'AOSPOSU0'W0KEY                           031876
     C                     Z-ADD904       W0ERNB                          031876
     C                     MOVELERR@,1    W0NARR                          031876
     C                     EXSR SRERR                                     031876
     C                     END                                            031876
     C/COPY WNCPYSRC,FT0040C294
      *                                                                   031876
      *  Unwind subroutine stack name                                     031876
      *                                                                   031876
     C           EXUPD     TAG                                            031876
     C                     MOVEA*BLANKS   @STK,Q                          031876
     C                     SUB  1         Q                               031876
      *                                                                   031876
     CSR                   ENDSR                                          031876
     C/EJECT                                                              S01435
      *****************************************************************   S01435
      *                                                               *   S01435
      *  SRINFT   : Update Incoming Message FT Transaction Status     *   S01435
      *             File record                                       *   S01435
      *  CALLS    : SRERR   - report error and close down program     *   S01435
      *                                                               *   S01435
      *                                                               *   S01435
      *  CALLED BY: DESTIN  - validation of destination               *   S01435
      *             ORDCUS  - validation of ordering customer         *   S01435
      *             SNDCOR  - validation of sender's correspondent    *   S01435
      *             ORDBNK  - validation of ordering bank             *   S01435
      *                                                               *   S01435
      *****************************************************************   S01435
     CSR         SRINFT    BEGSR                                          S01435
      *                                                                   S01435
      *  Set up subroutine stack name                                     S01435
      *                                                                   S01435
     C                     ADD  1         Q                               S01435
     C                     MOVEL'SRINFT'  @STK,Q                          S01435
      *                                                                   S01435
      *  Fill record format data structure with available data            S01435
      *                                                                   S01435
     C                     CLEARINFT                                      S01435
      *                                                                   S01435
     C           ORBT      IFNE *BLANKS                                   S01435
     C**********           MOVELORBDS     FTFRWR 18                                    S01435 CGL029
     C                     MOVELORBDS     FTFRWR 24                                           CGL029
     C                     ELSE                                           S01435
     C                     MOVELORCDS     FTFRWR                          S01435
     C                     END                                            S01435
     C           SNCT      IFNE *BLANKS                                   S01435
     C**********           MOVELSNCDS     FTTOWR 18                                    S01435 CGL029
     C                     MOVELSNCDS     FTTOWR 24                                           CGL029
     C                     ELSE                                           S01435
     C                     MOVELDSTDS     FTTOWR                          S01435
     C                     END                                            S01435
     C/COPY WNCPYSRC,FT0040C175
      *                                                                   S01435
     C                     Z-ADDOPMSGR    FTMSGR           Unique Ref.    S01435
     C                     Z-ADDOPKPRT    FTKPRT           Part No.       S01435
     C                     MOVELBRCA      FTBRCA           Branch Code    S01435
     C                     MOVELW0FLAG    FTOTFG           Outgoing Flag  S01435
     C                     MOVELPREF      FTOPRF           Outg. Pay. Ref S01435
     C                     MOVELFTFRWR    FTFRGL           Funds From     S01435
     C                     MOVELFTTOWR    FTTOGL           Funds To       S01435
      *                                                                   S01435
     C                     MOVELW0LMSG    W2LMSG           Log file Msg IDS01435
     C                     MOVELPNWRK     W2NWRK           Network        S01435
      *                                                                   S01435
      *  N.B. Audit Stamp details are determined in called program        S01435
      *                                                                   S01435
      *                                                                   S01435
      *  Set up data to be passed using the rcd format data structure     S01435
      *                                                                   S01435
     C                     CALL 'ME1050'               90                 S01435
     C                     PARM '*FT OUT 'W2ACT   8                       S01435
     C                     PARM ##PGM     W2CPGM 10                       S01435
     C                     PARM           W2NWRK  6                       S01435
     C                     PARM           W2LMSG  7                       S01435
     C                     PARM           INFT                            S01435
     C                     PARM *BLANKS   W2RTN   7                       S01435
      *                                                                   S01435
      *  If return with an error (LR seton in called program) then        S01435
      *  process for database error.                                      S01435
      *                                                                   S01435
     C           *IN90     IFEQ '1'                                       S01435
     C           W2RTN     OREQ '*ERROR*'                                 S01435
     C                     MOVEL'ME1050  'W0FILE           ***************S01435
     C                     MOVEL'*CALL'   W0KEY            * DB ERROR 905*S01435
     C                     Z-ADD905       W0ERNB           ***************S01435
     C                     EXSR SRERR                                     S01435
     C                     END                                            S01435
      *                                                                   S01435
      *  Unwind subroutine stack name                                     S01435
      *                                                                   S01435
     C           EXLOG     TAG                                            S01435
     C                     MOVEA*BLANKS   @STK,Q                          S01435
     C                     SUB  1         Q                               S01435
      *                                                                   S01435
     CSR                   ENDSR                                          S01435
     C/EJECT                                                              S01494
      *****************************************************************   S01494
      *                                                               *   S01494
      *  #LADDI   : Display the additional information for the        *   S01494
      *             transaction                                       *   S01494
      *  CALLED BY: SCRN2  -  Display screen 2 and execute validation *   S01494
      *                                                               *   S01494
      *****************************************************************   S01494
     C           #LADDI    BEGSR                                          S01494
     C*                                                                   S01494
     C** Initilise screen fields                                          S01494
     C*                                                                   S01494
     C                     MOVE *BLANKS   SUSRP1                          S01494
     C                     MOVE *BLANKS   SUSER1                          S01494
     C                     MOVE *BLANKS   SUSRP2                          S01494
     C                     MOVE *BLANKS   SUSER2                          S01494
     C                     MOVE *BLANKS   SAUP1                           S01494
     C                     MOVE *BLANKS   SAUT1                           S01494
     C                     MOVE *BLANKS   SAUP2                           S01494
     C                     MOVE *BLANKS   SAUT2                           S01494
     C                     MOVE *BLANKS   SNMIR                           S01494
     C                     MOVE *BLANKS   SNMOR                           S01494
     C*                                                                   S01494
     C** Retrieve the user profile names of the input users 1 & 2 and     S01494
     C** authorising users 1 & 2 from MUSERDD                             S01494
     C*                                                                   S01494
     C                     MOVELINUSR1    SUSRP1                          S01494
     C           INUSR1    IFNE *BLANKS                                   S01494
     C           INUSR1    CHAINMUSER                81                   S01494
     C           *IN81     IFEQ '1'                                       S01494
     C           *IN81     OREQ '0'                                       074810
     C           RECI      ANDNE'D'                                       074810
     C                     MOVELWM2510    SUSER1                          S01494
     C                     ELSE                                           S01494
     C                     MOVELUSER1     SUSER1                          S01494
     C                     END                                            S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C                     MOVELINUSR2    SUSRP2                          S01494
     C           INUSR2    IFNE *BLANKS                                   S01494
     C           INUSR2    CHAINMUSER                81                   S01494
     C           *IN81     IFEQ '1'                                       S01494
     C           *IN81     OREQ '0'                                       074810
     C           RECI      ANDNE'D'                                       074810
     C                     MOVELWM2510    SUSER2                          S01494
     C                     ELSE                                           S01494
     C                     MOVELUSER1     SUSER2                          S01494
     C                     END                                            S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C                     MOVELAUP1      SAUP1                           S01494
     C           AUP1      IFNE *BLANKS                                   S01494
     C           AUP1      CHAINMUSER                81                   S01494
     C           *IN81     IFEQ '1'                                       S01494
     C           *IN81     OREQ '0'                                       074810
     C           RECI      ANDNE'D'                                       074810
     C                     MOVELWM2510    SAUT1                           S01494
     C                     ELSE                                           S01494
     C                     MOVELUSER1     SAUT1                           S01494
     C                     END                                            S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C                     MOVELAUP2      SAUP2                           S01494
     C           AUP2      IFNE *BLANKS                                   S01494
     C           AUP2      CHAINMUSER                81                   S01494
     C           *IN81     IFEQ '1'                                       S01494
     C           *IN81     OREQ '0'                                       074810
     C           RECI      ANDNE'D'                                       074810
     C                     MOVELWM2510    SAUT2                           S01494
     C                     ELSE                                           S01494
     C                     MOVELUSER1     SAUT2                           S01494
     C                     END                                            S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C** Retrieve MIR and MOR of the transaction from MEINCRPD            S01494
     C*                                                                   S01494
     C           OPMSGR    IFNE *ZEROS                                    S01494
     C           OPMSGR    CHAINMEINCRL1             81                   S01494
     C           *IN81     IFEQ '1'                                       S01494
     C                     MOVELWM2519    SNMIR                           S01494
     C                     MOVELWM2519    SNMOR                           S01494
     C                     ELSE                                           S01494
     C                     MOVELCRMIR     SNMIR                           S01494
     C                     MOVELCRMIR     SNMOR                           S01494
     C                     END                                            S01494
     C/COPY WNCPYSRC,FT0040C150
     C                     END                                            S01494
     C*                                                                   S01494
     C                     EXFMTFT0040F3                                  S01494
     C*                                                                   S01494
     C           *IN05     IFEQ '1'                                       S01494
     C                     MOVE '0'       *IN05                           S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C                     ENDSR                                          S01494
     C/EJECT                                                              031876
      *****************************************************************   031876
      *                                                               *   031876
      *  SRERR    : Report error and close down program               *   031876
      *                                                               *   031876
      *  CALLED BY: SRCLR - Clear arrays                              *   031876
      *             SRUPD - Update Database with shadow positions     *   031876
      *             SRADD - Add shadow positions to store             *   031876
      *             INITL - Initation subroutine                      *   031876
      *             SRBOOK- Validate Book code field                  *   031876
      *             SRPRFC- Validate Profit Centre field              *   031876
      *                                                               *   031876
      *  CALLS    : *NONE                                             *   031876
      *                                                               *   031876
      *****************************************************************   031876
     CSR         SRERR     BEGSR                                          031876
      *                                                                   031876
      *  Define work variables                                            031876
      *                                                                   031876
     C           *LIKE     DEFN @BKEY     W0KEY                           031876
     C           *LIKE     DEFN @BERNB    W0ERNB                          031876
     C           *LIKE     DEFN @BFILE    W0FILE                          031876
     C           *LIKE     DEFN @BNARR    W0NARR                          031876
      *                                                                   031876
      *  Dump program                                                     031876
      *                                                                   031876
     C                     DUMP                                           031876
      **                                                                                      CSC022
      ** Execute rollback if SAR CSC022 is not enrolled or                                    CSC022
      **   job is not currently running in batch mode                                         CSC022
      **                                                                                      CSC022
     C           CSC022    IFEQ 'N'                                                           CSC022
     C           CSC022    OREQ 'Y'                                                           CSC022
     C           WCRSKP    ANDEQ'N'                                                           CSC022
     C                     ROLBK                                          031876
     C                     ENDIF                                                              CSC022
      *                                                                   031876
      *  Send message to MOPERQ                                           031876
      *                                                                   031876
     C                     MOVEL*BLANKS   DBDTA                           031876
4    C                     MOVEL'FT0040  '@BPGM                           031876
     C***********          MOVEL'UPDATE'  @BSTK                     031876045014
     C           Q         IFGT 1                                         031876
     C           Q         ANDLT21                                        031876
     C                     MOVEL@STK,Q    @BSTK                           031876
     C                     ELSE                                           031876
     C                     MOVEL'*Nostkin'@BSTK                           031876
     C                     END                                            031876
     C                     MOVELW0KEY     @BKEY                           031876
     C                     MOVELW0ERNB    @BERNB                          031876
     C                     MOVELW0FILE    @BFILE                          031876
     C                     MOVELPREF      @BPREF                          045014
     C           W0NARR    IFEQ *BLANKS                                   031876
     C                     MOVELERR@,1    @BNARR                          031876
     C                     ELSE                                           031876
     C                     MOVELW0NARR    @BNARR                          031876
     C                     END                                            031876
      *                                                                   031876
     C                     CALL 'AOCREPT'              9090               031876
     C                     PARM 'MEM5000' #MSGID  7                       031876
     C                     PARM 'MIDAS  ' #MSGF  10                       031876
     C                     PARM *BLANKS   #MSGFL 10                       031876
     C                     PARM DBDTA     #MSGDT256                       031876
     C                     PARM '*PRV'    #MSGR   5                       031876
     C                     PARM '*'       #PRGM  10                       031876
     C                     PARM 'MOPERQ ' #MSGQ  10                       031876
     C                     PARM '*INFO  ' #MSGT   7                       031876
      *                                                                   031876
      *  Close down program                                               031876
      *                                                                   031876
     C           *LOCK     IN   DLDA                                      031876
     C                     MOVE 'FT0040  'DBPGM                           031876
     C                     MOVELW0FILE    DBFILE           ***************031876
     C                     Z-ADDW0ERNB    DBASE            * DB ERROR 86 *031876
     C                     MOVELW0KEY     DBKEY            ***************031876
     C                     OUT  DLDA                                      031876
     C                     SETON                     U7U8LR               031876
     C/COPY WNCPYSRC,FT0040C142
      *                                                                   042167
      *  Allocate dataarea to blanks                                      042167
      *                                                                   042167
     C                     EXSR DALLOC                                    042167
      *                                                                   042167
     C                     RETRN                                          031876
     C                     MOVEL*BLANKS   R#RTN   7                       031876
      *                                                                   031876
     CSR         EXERR     ENDSR                                          031876
     C/EJECT                                                              S01435
      *****************************************************************   S01435
      *                                                               *   S01435
      *  FTSNMS   : Send message to program's message queue           *   S01435
      *                                                               *   S01435
      *  CALLED BY: UPDATE                                            *   S01435
      *                                                               *   S01435
      *  CALLS    : *NONE                                             *   S01435
      *                                                               *   S01435
      *****************************************************************   S01435
     CSR         FTSNMS    BEGSR                                          S01435
      *                                                                   S01435
      * If no program send to FT0040                                      S01435
      *                                                                   S01435
     C           FTPGMQ    IFEQ *BLANK                                    S01435
     C                     MOVEL##PGM     FTPGMQ                          S01435
     C                     END                                            S01435
      *                                                                   S01435
      * If level to send is blanks default to *SAME                       S01435
      *                                                                   S01435
     C           FTPGRL    IFEQ *BLANK                                    S01435
     C                     MOVEL'*SAME'   FTPGRL                          S01435
     C                     END                                            S01435
      *                                                                   S01435
      * If no message file specified, use default                         S01435
      *                                                                   S01435
     C           FTMSGF    IFEQ *BLANK                                    S01435
     C                     MOVEL'FTUSRMSG'FTMSGF                          S01435
     C                     END                                            S01435
      *                                                                   S01435
     C                     CALL 'AOCREPT'                                 S01435
     C                     PARM           FTMSID  7                       S01435
     C                     PARM           FTMSGF 10                       S01435
     C                     PARM           FTMSFL 10                       S01435
     C                     PARM           FTMSDT256                       S01435
     C                     PARM           FTPGRL  5                       S01435
     C                     PARM           FTPGMQ 10                       S01435
     C                     PARM           FTMSGQ 10                       S01435
     C                     PARM           FTMSGT  7                       S01435
      *                                                                   S01435
     C                     MOVEL'Y'       FTMSGS  1                       S01435
      *                                                                   S01435
      * Clear all fields for default mechanism next time                  S01435
      *                                                                   S01435
     C                     MOVEL*BLANK    FTMSID                          S01435
     C                     MOVEL*BLANK    FTMSGF                          S01435
     C                     MOVEL*BLANK    FTMSFL                          S01435
     C                     MOVEL*BLANK    FTMSDT                          S01435
     C                     MOVEL*BLANK    FTPGRL                          S01435
     C                     MOVEL*BLANK    FTPGMQ                          S01435
     C                     MOVEL*BLANK    FTMSGQ                          S01435
     C                     MOVEL*BLANK    FTMSGT                          S01435
      *================================================================   S01435
     CSR         FTEXIT    ENDSR                                          S01435
     C/EJECT
     C************************************************************
     C* CHARGE CONVERSION SUBROUTINE
     C************************************************************
     C*
     C           CHARGE    BEGSR
     C*                                                                   S01508
     C** If recalculation for extended payments is necessary, set up      S01508
     C** parameters for FT0320                                            S01508
     C*                                                                   S01508
     C           WRDFTC    IFEQ 'Y'                                       S01508
     C                     CLEARW7DATA                                    S01508
     C*                                                                   S01508
     C** Payment type and subtype                                         S01508
     C*                                                                   S01508
     C                     MOVELSPYTP     W7PYTP                          S01508
     C                     MOVELSPYST     W7PYST                          S01508
     C*                                                                   S01508
     C** Input currency and charge currency                               S01508
     C*                                                                   S01508
     C                     SELEC                                          S01508
     C           BTCHCY    WHEQ 'C'                                       S01508
     C           SADDC     IFEQ 'A'                                       S01508
     C                     MOVE SSMCY     W7ICCY                          S01508
     C                     ELSE                                           S01508
     C                     MOVE SPCCY     W7ICCY                          S01508
     C                     END                                            S01508
     C           BTCHCY    WHEQ 'L'                                       S01508
     C                     MOVE BJLCCY    W7ICCY                          S01508
     C                     OTHER                                          S01508
     C                     MOVE BJCYCD    W7ICCY                          S01508
     C                     ENDSL                                          S01508
     C*                                                                   S01508
     C           SADDC     IFEQ 'A'                                       S01508
     C                     MOVELSSMCY     W7CCCY                          S01508
     C                     ELSE                                           S01508
     C                     MOVELSPCCY     W7CCCY                          S01508
     C                     END                                            S01508
     C*                                                                   S01508
     C** Settlement method                                                S01508
     C*                                                                   S01508
     C                     MOVELSTMT      W7STMT                          S01508
     C*                                                                   S01508
     C** Defaults required                                                S01508
     C*                                                                   S01508
     C                     MOVEL'Y'       W7DFRQ                          S01508
     C*                                                                   S01508
     C* Charges branch                                                    S01508
     C                     MOVELPYBR      W7BRCA                          S01508
     C*                                                                   S01508
     C* Charge currency amount                                            S01508
     C*                                                                   S01508
     C                     SELEC                                          S01508
     C*                                                                   S01508
     C           SADDC     WHEQ 'A'                                       S01508
     C                     Z-ADDSMAM      W7CAMT                          S01508
     C***13******          Z-ADDSSMAM     W7CAMT                   095075 124674
     C           ACTION    IFEQ 'A'                                       124674
     C                     Z-ADDSSMAM     W7CAMT                          124674
     C                     ENDIF                                          124674
     C                     MOVELSSMCY     W7PCCY                          S01508
     C*                                                                   S01508
     C                     OTHER                                          S01508
     C                     Z-ADDPYAM      W7CAMT                          S01508
     C***13******          Z-ADDSPYAM     W7CAMT                   095075 124674
     C           ACTION    IFEQ 'A'                                       124674
     C                     Z-ADDSPYAM     W7CAMT                          124674
     C                     ENDIF                                          124674
     C                     MOVELSPCCY     W7PCCY                          S01508
     C                     ENDSL                                          S01508
     C*                                                                   S01508
     C** Transfer Commission type                                         S01508
     C*                                                                   S01508
     C                     MOVELTRCT      W7TRCT                          S01508
     C*                                                                   S01508
     C** SWIFT priority code                                              S01508
     C*                                                                   S01508
     C           SWPC      IFEQ 1                                         S01508
     C                     MOVEL'U'       W7SWPC                          S01508
     C                     ELSE                                           S01508
     C                     MOVEL'N'       W7SWPC                          S01508
     C                     END                                            S01508
     C*                                                                   S01508
     C** Transfer Commission amount                                       S01508
     C*                                                                   S01508
     C                     Z-ADDDUMA1     W7TRCD                          S01508
     C                     Z-ADDTRCM      W7TRCH                          S01508
     C*                                                                   S01508
     C** Telex charge                                                     S01508
     C*                                                                   S01508
     C                     Z-ADDDUMA2     W7TXCD                          S01508
     C                     Z-ADDTXCH      W7TXCH                          S01508
     C*                                                                   S01508
     C** Cheque Charge                                                    S01508
     C*                                                                   S01508
     C                     Z-ADDDUMA3     W7CQCD                          S01508
     C                     Z-ADDCQCH      W7CQCH                          S01508
     C*                                                                   S01508
     C** Costs Abroad                                                     S01508
     C*                                                                   S01508
     C                     Z-ADDDUMA4     W7CSTD                          S01508
     C                     Z-ADDCSTA      W7CSTA                          S01508
     C*                                                                   S01508
     C** SWIFT Priority Charge                                            S01508
     C*                                                                   S01508
     C                     Z-ADDDUMA5     W7SPCD                          S01508
     C                     Z-ADDSPCH      W7SPCH                          S01508
     C*                                                                   S01508
     C** Miscellaneous charge                                             S01508
     C*                                                                   S01508
     C                     Z-ADDDUMA6     W7MSCD                          S01508
     C                     Z-ADDMSCH      W7MSCH                          S01508
     C*                                                                   S01494
     C** FX/Change Commission                                             S01494
     C*                                                                   S01494
     C           S01494    IFEQ 'Y'                                       S01494
     C                     Z-ADDOPDUM7    W7CHCD                          S01494
     C                     Z-ADDOPCHCM    W7CHCM                          S01494
     C                     END                                            S01494
     C*                                                                   S01508
     C** Advice Charge                                                    S01508
     C*                                                                   S01508
     C                     Z-ADD0         W7ADCD                          S01508
     C                     Z-ADD0         W7ADCH                          S01508
     C*                                                                   S01508
     C** Telephone Charge                                                 S01508
     C*                                                                   S01508
     C                     Z-ADD0         W7TLCD                          S01508
     C                     Z-ADD0         W7TLCH                          S01508
     C*                                                                   S01508
     C** Collection Charge                                                S01508
     C*                                                                   S01508
     C                     Z-ADD0         W7COLD                          S01508
     C                     Z-ADD0         W7COLL                          S01508
     C*                                                                   S01508
     C                     MOVEL*BLANKS   W7ACT                           S01508
     C                     MOVEL'OP'      W7ACT                           S01508
     C*                                                                   S01508
     C**  Other currency                                                  S01508
     C*                                                                   S01508
     C           SADDC     IFEQ 'D'                                       S01508
     C                     MOVE SSMCY     W7OCCY                          S01508
     C                     ELSE                                           S01508
     C                     MOVE SPCCY     W7OCCY                          S01508
     C                     END                                            S01508
     C*                                                                   S01508
     C** Customer to be debited                                           S01508
     C*                                                                   S01508
     C                     MOVELWDCUS2    W7CUST                          S01508
     C/COPY WNCPYSRC,FT0040C109
     C*                                                                   S01508
     C** Call defaults program                                            S01508
     C*                                                                   S01508
     C                     CALL 'FT0320'               9090               S01508
     C                     PARM *BLANKS   W7RTN   7                       S01508
     C                     PARM           W7ACT   8                       S01508
     C                     PARM           W7DATA                          S01508
      *                                                                   100660
      ** Re-apply old charges if only sett.amt has changed                100660
     C           SPCCY     IFEQ PCCY                                      100660
     C           SSMCY     ANDEQSMCY                                      100660
     C           WRDFTC    ANDEQ'Y'                                       100660
     C           SSMAM     ANDNESMAM                                      100660
     C                     Z-ADDDUMA2     W7TXCD                          100660
     C                     Z-ADDDUMA3     W7CQCD                          100660
     C                     Z-ADDDUMA4     W7CSTD                          100660
     C                     Z-ADDDUMA5     W7SPCD                          100660
     C                     Z-ADDDUMA6     W7MSCD                          100660
     C                     END                                            100660
     C*                                                                   S01508
     C           *IN90     IFEQ '1'                                       S01508
     C           W7RTN     ORNE *BLANKS                                   S01508
     C                     MOVEL'FT0320  'W0FILE           ***************S01508
     C                     MOVEL'*CALL   'W0KEY            * DB ERROR 35 *S01508
     C                     Z-ADD35        W0ERNB           ***************S01508
     C                     EXSR SRERR                                     S01508
     C                     END                                            S01508
     C*                                                                   S01508
     C** Transfer Commission amount                                       S01508
     C*                                                                   S01508
     C                     Z-ADDW7TRCD    DUMA1                           S01508
     C                     Z-ADDW7TRCH    TRCM                            S01508
     C*                                                                   S01508
     C* Telex charge                                                      S01508
     C*                                                                   S01508
     C                     Z-ADDW7TXCD    DUMA2                           S01508
     C                     Z-ADDW7TXCH    TXCH                            S01508
     C*                                                                   S01508
     C** Cheque Charge                                                    S01508
     C*                                                                   S01508
     C                     Z-ADDW7CQCD    DUMA3                           S01508
     C                     Z-ADDW7CQCH    CQCH                            S01508
     C*                                                                   S01508
     C** Costs Abroad                                                     S01508
     C*                                                                   S01508
     C                     Z-ADDW7CSTD    DUMA4                           S01508
     C                     Z-ADDW7CSTA    CSTA                            S01508
     C*                                                                   S01508
     C** SWIFT Priority Charge                                            S01508
     C*                                                                   S01508
     C                     Z-ADDW7SPCD    DUMA5                           S01508
     C                     Z-ADDW7SPCH    SPCH                            S01508
     C*                                                                   S01508
     C** Miscellaneous charge                                             S01508
     C*                                                                   S01508
     C                     Z-ADDW7MSCD    DUMA6                           S01508
     C                     Z-ADDW7MSCH    MSCH                            S01508
     C*                                                                   S01494
     C** FX/Change Commission                                             S01494
     C*                                                                   S01494
     C           S01494    IFEQ 'Y'                                       S01494
     C                     Z-ADDW7CHCD    OPDUM7                          S01494
     C                     Z-ADDW7CHCM    OPCHCM                          S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C                     END                                            S01494
     C*
     C* IF CHARGES TO THE DEBIT OF IS 0,USE PAY OR SETTLE
     C* BASED ON FTCC (BTCHCY) INDICATOR                                  S01194
     C*
     C***********FTCC******IFEQ 'C'                        ** B001        S01194
     C           BTCHCY    IFEQ 'C'                        ** B001        S01194
     C*
     C           ADDC      IFEQ 'A'                        ** B002
     C                     MOVE SMCY      SCCCY   3
     C                     ELSE                            ** X002
     C                     MOVE PCCY      SCCCY
     C                     END                             ** E002
     C*
     C                     ELSE                            ** X001
     C*
     C***********FTCC******IFEQ 'L'                        ** B002        S01194
     C           BTCHCY    IFEQ 'L'                        ** B002        S01194
     C*********************MOVE LOCY      SCCCY                           S01194
     C                     MOVE BJLCCY    SCCCY                           S01194
     C                     ELSE                            ** X002
     C*********************MOVE BCCY      SCCCY                           S01194
     C                     MOVE BJCYCD    SCCCY                           S01194
     C                     END                             ** E002
     C*
     C                     END                             ** E001
     C*
     C* ONLY CONVERT IF ENTRY CHARGE CCY NOT BASE
     C*
     C***********SCCCY*****IFNE BCCY                       ** B001        S01194
     C           SCCCY     IFNE BJCYCD                     ** B001        S01194
     C*                                                                   S01194
     C* ACCESS DETAILS OF FILE CHARGE CCY FOR CHARGE CALCULATIONS         S01194
     C*                                                                   S01194
     C*********************MOVEL'20      'TABKEY 12                       S01194
     C*********************MOVE '1'       WK4     4                       S01194
     C*********************MOVELSCCCY     WK4                             S01194
     C*********************MOVE WK4       TABKEY                          S01194
     C***********TABKEY****CHAINTABTG10F             88                   S01194
     C**N88******RECI******COMP 'D'                  8888                 S01194
     C************IN88*****IFEQ '1'                        ** B002        S01194
     C************LOCK*****IN   DLDA                                      S01194
     C*********************MOVE 'FT0040'  DBPGM                           S01194
     C*********************MOVE 'TABTG10' DBFILE           ************   S01194
     C*********************MOVELTABKEY    DBKEY            * DB ERROR 50  S01194
     C*********************Z-ADD50        DBASE            ************   S01194
     C*********************OUT  DLDA                                      S01194
     C*********************SETON                     U7U8LR               S01194
     C*********************DUMP                                           S01194
     C*********************RETRN                                          S01194
     C*********************END                             ** E002        S01194
     C                     CALL 'AOCURRR0'                                S01194
     C                     PARM '*DBERR ' RTCD                            S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM SCCCY     @K101                           S01194
     C           SDCURR    PARM SDCURR    DSSDY                           S01194
     C*                                                                   S01194
     C** Move new standing data field into field used in program          S01194
     C*                                                                   S01194
     C           A6MDIN    IFEQ 'M'                                       S01194
     C                     Z-ADD1         MDIN                            S01194
     C                     ELSE                                           S01194
     C                     Z-ADD0         MDIN                            S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C*
     C* N IS DIFFERENCE BETWEEN DECIMALS FOR BASE AND DECIMALS FOR FILE
     C* CURRENCY - FOLLOWING CALCS FIND TRUE RATE(TSPOT)TO CONVERT FILE
     C* CURRENCY TO BASE
     C*
     C***********BCDP******SUB  CDP       N       10                      S01194
     C           BCDP      SUB  A6NBDP    N       10                      S01194
     C           MDIN      IFEQ 1                          ** B002
     C           N         IFGT 0                          ** B003
     C***********SPOT******MULT POWERS,N  TSPOT  159                      S01194
     C           A6SPRT    MULT POWERS,N  TSPOT  159                      S01194
     C                     ELSE                            ** X003
     C           N         IFLT 0                          ** B004
     C                     Z-SUBN         N
     C***********SPOT******DIV  POWERS,N  TSPOT                           S01194
     C           A6SPRT    DIV  POWERS,N  TSPOT                           S01194
     C                     ELSE                            ** X004
     C*********************Z-ADDSPOT      TSPOT                           S01194
     C                     Z-ADDA6SPRT    TSPOT                           S01194
     C                     END                             ** E004
     C                     END                             ** E003
     C                     END                             ** E002
     C           MDIN      IFEQ 0                          ** B002
     C           N         IFGT 0                          ** B003
     C***********SPOT******DIV  POWERS,N  TSPOT                           S01194
     C           A6SPRT    DIV  POWERS,N  TSPOT                           S01194
     C                     ELSE                            ** X003
     C           N         IFLT 0                          ** B004
     C                     Z-SUBN         N
     C***********SPOT******MULT POWERS,N  TSPOT                           S01194
     C           A6SPRT    MULT POWERS,N  TSPOT                           S01194
     C                     ELSE                            ** X004
     C*********************Z-ADDSPOT      TSPOT                           S01194
     C                     Z-ADDA6SPRT    TSPOT                           S01194
     C                     END                             ** E004
     C                     END                             ** E003
     C                     END                             ** E002
     C*
     C* NOW USE RATE TO CALCULATE VALUE FOR AMENDMENT IN BASE
     C*
     C           MDIN      IFEQ 1                          ** B002
     C* TRANSFER COMMISSION
     C           DUMA1     MULT TSPOT     TRCMB  110H
     C* TELEX CHARGE
     C           DUMA2     MULT TSPOT     TXCHB  110H
     C* CHEQUE CHARGE
     C           DUMA3     MULT TSPOT     CQCHB  110H
     C* COSTS ABROAD
     C           DUMA4     MULT TSPOT     CSTAB  110H
     C* SWIFT PRIORITY CHARGE
     C           DUMA5     MULT TSPOT     SPCHB  110H
     C* MISCELLANEOUS CHARGE
     C           DUMA6     MULT TSPOT     MSCHB  110H
     C*                                                                   S01494
     C           S01494    IFEQ 'Y'                                       S01494
     C           OPDUM7    MULT TSPOT     CHCMB  110H                     S01494
     C                     END                                            S01494
     C*                                                                   S01499
     C           S01499    IFEQ 'Y'                                       S01499
     C           OPDUM8    MULT TSPOT     VATTB  110H                     S01499
     C                     END                                            S01499
     C                     END                             ** E002
     C*
     C           MDIN      IFEQ 0                          ** B002
     C* TRANSFER COMMISSION
     C           DUMA1     DIV  TSPOT     TRCMB     H
     C* TELEX CHARGE
     C           DUMA2     DIV  TSPOT     TXCHB     H
     C* CHEQUE CHARGE
     C           DUMA3     DIV  TSPOT     CQCHB     H
     C* COSTS ABROAD
     C           DUMA4     DIV  TSPOT     CSTAB     H
     C* SWIFT PRIORITY CHARGE
     C           DUMA5     DIV  TSPOT     SPCHB     H
     C* MISCELLANEOUS CHARGE
     C           DUMA6     DIV  TSPOT     MSCHB     H
     C*                                                                   S01494
     C** For FX/Change commission                                         S01494
     C*                                                                   S01494
     C           S01494    IFEQ 'Y'                                       S01494
     C           OPDUM7    DIV  TSPOT     CHCMB  110H                     S01494
     C                     END                                            S01494
     C                     END                             ** E002
     C*
     C                     ELSE                            ** X001
     C                     Z-ADDDUMA1     TRCMB
     C                     Z-ADDDUMA2     TXCHB
     C                     Z-ADDDUMA3     CQCHB
     C                     Z-ADDDUMA4     CSTAB
     C                     Z-ADDDUMA5     SPCHB
     C                     Z-ADDDUMA6     MSCHB
     C*                                                                   S01494
     C** FX/Change commission                                             S01494
     C*                                                                   S01494
     C           S01494    IFEQ 'Y'                                       S01494
     C                     Z-ADDOPDUM7    CHCMB                           S01494
     C                     END                                            S01494
     C                     END                             ** E001
     C*
     C           SADDC     IFEQ 'A'                        ** B001
     C                     MOVE SSMCY     SCCCY
     C                     ELSE                            ** X001
     C                     MOVE SPCCY     SCCCY
     C                     END                             ** E001
     C*
     C* ONLY CONVERT IF NEW CHARGE CCY NOT BASE
     C*
     C***********SCCCY*****IFNE BCCY                       ** B001        S01194
     C           SCCCY     IFNE BJCYCD                     ** B001        S01194
     C*                                                                   S01194
     C*********************MOVEL'20      'TABKEY 12                       S01194
     C*********************MOVE '1'       WK4     4                       S01194
     C*********************MOVELSCCCY     WK4                             S01194
     C*********************MOVE WK4       TABKEY                          S01194
     C***********TABKEY****CHAINTABTG10F             88                   S01194
     C**N88******RECI******COMP 'D'                  8888                 S01194
     C************IN88*****IFEQ '1'                        ** B002        S01194
     C************LOCK*****IN   DLDA                                      S01194
     C*********************MOVE 'FT0040'  DBPGM                           S01194
     C*********************MOVE 'TABTG10' DBFILE           ************   S01194
     C*********************MOVELTABKEY    DBKEY            * DB ERROR 51  S01194
     C*********************Z-ADD51        DBASE            ************   S01194
     C*********************OUT  DLDA                                      S01194
     C*********************SETON                     U7U8LR               S01194
     C*********************DUMP                                           S01194
     C*********************RETRN                                          S01194
     C*********************END                             ** E002        S01194
     C                     CALL 'AOCURRR0'                                S01194
     C                     PARM '*DBERR ' RTCD                            S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM SCCCY     @K101                           S01194
     C           SDCURR    PARM SDCURR    DSSDY                           S01194
     C*                                                                   S01194
     C** Move new standing data field into field used in program          S01194
     C*                                                                   S01194
     C           A6MDIN    IFEQ 'M'                                       S01194
     C                     Z-ADD1         MDIN                            S01194
     C                     ELSE                                           S01194
     C                     Z-ADD0         MDIN                            S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C*
     C* N IS DIFFERENCE BETWEEN DECIMALS FOR BASE AND DECIMALS FOR
     C* CHARGE CURRENCY - FOLLOWING CALCS FIND TRUE RATE(TSPOT)TO
     C* CONVERT BASE CURRENCY BACK TO NEW CHARGE CCY
     C*
     C***********CDP*******SUB  BCDP      N       10                      S01194
     C           A6NBDP    SUB  BCDP      N       10                      S01194
     C           MDIN      IFEQ 1                          ** B002
     C           N         IFGT 0                          ** B003
     C***********SPOT******DIV  POWERS,N  TSPOT  159                      S01194
     C           A6SPRT    DIV  POWERS,N  TSPOT  159                      S01194
     C                     ELSE                            ** X003
     C           N         IFLT 0                          ** B004
     C                     Z-SUBN         N
     C***********SPOT******MULT POWERS,N  TSPOT                           S01194
     C           A6SPRT    MULT POWERS,N  TSPOT                           S01194
     C                     ELSE                            ** X004
     C*********************Z-ADDSPOT      TSPOT                           S01194
     C                     Z-ADDA6SPRT    TSPOT                           S01194
     C                     END                             ** E004
     C                     END                             ** E003
     C                     END                             ** E002
     C           MDIN      IFEQ 0                          ** B002
     C           N         IFGT 0                          ** B003
     C***********SPOT******MULT POWERS,N  TSPOT                           S01194
     C           A6SPRT    MULT POWERS,N  TSPOT                           S01194
     C                     ELSE                            ** X003
     C           N         IFLT 0                          ** B004
     C                     Z-SUBN         N
     C***********SPOT******DIV  POWERS,N  TSPOT                           S01194
     C           A6SPRT    DIV  POWERS,N  TSPOT                           S01194
     C                     ELSE                            ** X004
     C*********************Z-ADDSPOT      TSPOT                           S01194
     C                     Z-ADDA6SPRT    TSPOT                           S01194
     C                     END                             ** E004
     C                     END                             ** E003
     C                     END                             ** E002
     C*
     C* NOW USE RATE TO CALCULATE NEW CHARGE VALUES
     C*
     C           MDIN      IFEQ 1                          ** B002
     C* TRANSFER COMMISSION
     C           TRCMB     DIV  TSPOT     TRCM      H
     C* TELEX CHARGE
     C           TXCHB     DIV  TSPOT     TXCH      H
     C* CHEQUE CHARGE
     C           CQCHB     DIV  TSPOT     CQCH      H
     C* COSTS ABROAD
     C           CSTAB     DIV  TSPOT     CSTA      H
     C* SWIFT PRIORITY CHARGE
     C           SPCHB     DIV  TSPOT     SPCH      H
     C* MISCELLANEOUS CHARGE
     C           MSCHB     DIV  TSPOT     MSCH      H
     C*                                                                   S01494
     C** For FX/Change commission                                         S01494
     C*                                                                   S01494
     C           S01494    IFEQ 'Y'                                       S01494
     C           CHCMB     DIV  TSPOT     OPCHCM    H                     S01494
     C                     END                                            S01494
     C                     END                             ** E002
     C*
     C           MDIN      IFEQ 0                          ** B002
     C* TRANSFER COMMISSION
     C           TRCMB     MULT TSPOT     TRCM      H
     C* TELEX CHARGE
     C           TXCHB     MULT TSPOT     TXCH      H
     C* CHEQUE CHARGE
     C           CQCHB     MULT TSPOT     CQCH      H
     C* COSTS ABROAD
     C           CSTAB     MULT TSPOT     CSTA      H
     C* SWIFT PRIORITY CHARGE
     C           SPCHB     MULT TSPOT     SPCH      H
     C* MISCELLANEOUS CHARGE
     C           MSCHB     MULT TSPOT     MSCH      H
     C*                                                                   S01494
     C** For FX/Change Commission                                         S01494
     C*                                                                   S01494
     C           S01494    IFEQ 'Y'                                       S01494
     C           CHCMB     MULT TSPOT     OPCHCM    H                     S01494
     C                     END                                            S01494
     C                     END                             ** E002
     C*
     C                     ELSE                            ** X001
     C                     Z-ADDTRCMB     TRCM
     C                     Z-ADDTXCHB     TXCH
     C                     Z-ADDCQCHB     CQCH
     C                     Z-ADDCSTAB     CSTA
     C                     Z-ADDSPCHB     SPCH
     C                     Z-ADDMSCHB     MSCH
     C*                                                                   S01494
     C** For FX/Change commission                                         S01494
     C*                                                                   S01494
     C           S01494    IFEQ 'Y'                                       S01494
     C                     Z-ADDCHCMB     OPCHCM                          S01494
     C                     END                                            S01494
     C                     END                             ** E001
     C*
     C* FILE DAF FORMAT(NOT LIKE REAL DAF)
     C*
     C***********SCCCY*****IFNE BCCY                       ** B001        S01194
     C           SCCCY     IFNE BJCYCD                     ** B001        S01194
     C*********************Z-ADDCDP       FCDP                            S01194
     C                     Z-ADDA6NBDP    FCDP                            S01194
     C                     ELSE                            ** X001
     C                     Z-ADDBCDP      FCDP
     C                     END                             ** E001
     C*
     C* TRANSFER COMMISSION
     C           FCDP      ADD  1         W       10
     C           TRCM      DIV  FCTR,W    TRCMD
     C* TELEX CHARGE
     C           FCDP      ADD  1         W
     C           TXCH      DIV  FCTR,W    TXCHD
     C* CHEQUE CHARGE
     C           FCDP      ADD  1         W
     C           CQCH      DIV  FCTR,W    CQCHD
     C* COSTS ABROAD
     C           FCDP      ADD  1         W
     C           CSTA      DIV  FCTR,W    CSTAD
     C* SWIFT PRIORITY CHARGE
     C           FCDP      ADD  1         W
     C           SPCH      DIV  FCTR,W    SPCHD
     C* MISCELLANEOUS CHARGE
     C           FCDP      ADD  1         W
     C           MSCH      DIV  FCTR,W    MSCHD
     C*
     C***********FTCC******IFEQ 'C'                        B001           S01194
     C           BTCHCY    IFEQ 'C'                        B001           S01194
     C*
     C* OR,IF *F*T*C*C* BTCHCY IS SET TO 'B' FOR BASE CURRENCY,AND        S01194
     C* DEFAULT CHARGE CCY IS BASE                                        S01194
     C*
     C***********FTCC******OREQ 'B'                                       S01194
     C           BTCHCY    OREQ 'B'                                       S01194
     C***********SCCCY*****ANDEQBCCY                                      S01194
     C           SCCCY     ANDEQBJCYCD                                    S01194
     C*
     C* OR,IF *F*T*C*C* BTCHCY IS SET TO 'L' FOR LOCAL CURRENCY           S01194
     C* AND LOCAL IS THE SAME CCY AS BASE,AND DEFAULT CCY IS BASE         S01194
     C*
     C***********FTCC******OREQ 'L'                                       S01194
     C           BTCHCY    OREQ 'L'                                       S01194
     C***********BCCY******ANDEQLOCY                                      S01194
     C           BJCYCD    ANDEQBJLCCY                                    S01194
     C***********SCCCY*****ANDEQBCCY                                      S01194
     C           SCCCY     ANDEQBJCYCD                                    S01194
     C*
     C* OR,IF *F*T*C*C* BTCHCY IS SET TO 'L' FOR LOCAL CURRENCY,AND       S01194
     C* DEFAULT CHARGE CURRENCY IS THE SAME AS LOCAL CCY                  S01194
     C*
     C***********FTCC******OREQ 'L'                                       S01194
     C           BTCHCY    OREQ 'L'                                       S01194
     C***********SCCCY*****ANDEQLOCY                                      S01194
     C           SCCCY     ANDEQBJLCCY                                    S01194
     C*
     C                     Z-ADDTRCM      DUMA1
     C                     Z-ADDTXCH      DUMA2
     C                     Z-ADDCQCH      DUMA3
     C                     Z-ADDCSTA      DUMA4
     C                     Z-ADDSPCH      DUMA5
     C                     Z-ADDMSCH      DUMA6
     C*                                                                   S01494
     C** For FX/Change commission                                         S01494
     C*                                                                   S01494
     C           S01494    IFEQ 'Y'                                       S01494
     C                     Z-ADDOPCHCM    OPDUM7                          S01494
     C                     END                                            S01494
     C*
     C                     ELSE                            X001
     C*
     C* INPUT CAPABLE CHARGE FIELD MAY BE BASE
     C* WITH RIGHT HAND SIDE NOT BASE - HERE USE BASE COMMISSION
     C* CHARGE ALREADY CALCULATED
     C*
     C***********FTCC******IFEQ 'B'                        B002           S01194
     C           BTCHCY    IFEQ 'B'                        B002           S01194
     C***********SCCCY*****ANDNEBCCY                                      S01194
     C           SCCCY     ANDNEBJCYCD                                    S01194
     C*
     C***********FTCC******OREQ 'L'                                       S01194
     C           BTCHCY    OREQ 'L'                                       S01194
     C***********LOCY******ANDEQBCCY                                      S01194
     C           BJLCCY    ANDEQBJCYCD                                    S01194
     C*
     C                     Z-ADDTRCMB     DUMA1
     C                     Z-ADDTXCHB     DUMA2
     C                     Z-ADDCQCHB     DUMA3
     C                     Z-ADDCSTAB     DUMA4
     C                     Z-ADDSPCHB     DUMA5
     C                     Z-ADDMSCHB     DUMA6
     C*                                                                   S01494
     C** For FX/Change commission                                         S01494
     C*                                                                   S01494
     C           S01494    IFEQ 'Y'                                       S01494
     C                     Z-ADDCHCMB     OPDUM7                          S01494
     C                     END                                            S01494
     C*
     C                     ELSE                            X002
     C*
     C                     Z-ADDTRCMB     AMNTB  110
     C                     EXSR CHGLT
     C                     MOVE AMNTE     DUMA1
     C*
     C                     Z-ADDTXCHB     AMNTB
     C                     EXSR CHGLT
     C                     MOVE AMNTE     DUMA2
     C*
     C                     Z-ADDCQCHB     AMNTB
     C                     EXSR CHGLT
     C                     MOVE AMNTE     DUMA3
     C*
     C                     Z-ADDCSTAB     AMNTB
     C                     EXSR CHGLT
     C                     MOVE AMNTE     DUMA4
     C*
     C                     Z-ADDSPCHB     AMNTB
     C                     EXSR CHGLT
     C                     MOVE AMNTE     DUMA5
     C*
     C                     Z-ADDMSCHB     AMNTB
     C                     EXSR CHGLT
     C                     MOVE AMNTE     DUMA6
     C*                                                                   S01494
     C** For FX/Change commission                                         S01494
     C*                                                                   S01494
     C           S01494    IFEQ 'Y'                                       S01494
     C                     Z-ADDCHCMB     AMNTB                           S01494
     C                     EXSR CHGLT                                     S01494
     C                     MOVE AMNTE     OPDUM7                          S01494
     C                     END                                            S01494
     C*
     C                     END                             E002
     C*
     C                     END                             E001
     C*                                                                   S01499
     C** If S01499 is active, calculate V.A.T. charges                    S01499
     C*                                                                   S01499
     C           S01499    IFEQ 'Y'                                       S01499
     C                     Z-ADDWVATR     OPVATR                          S01499
     C                     MOVE *ZEROS    OPDUM8                          S01499
     C                     MOVE *ZEROS    OPVATT                          S01499
     C**                                                                  S01499
     C** .... Transfer commission                                         S01499
     C*                                                                   S01499
     C           OPVAT1    IFEQ 'Y'                                       S01499
     C           DUMA1     MULT WVATR     WVATE  130H                     S01499
     C           TRCM      MULT WVATR     WVATC  130H                     S01499
     C                     ADD  WVATE     OPDUM8                          S01499
     C                     ADD  WVATC     OPVATT                          S01499
     C                     END                                            S01499
     C*                                                                   S01499
     C** .... Telex                                                       S01499
     C*                                                                   S01499
     C           OPVAT2    IFEQ 'Y'                                       S01499
     C           DUMA2     MULT WVATR     WVATE     H                     S01499
     C           TXCH      MULT WVATR     WVATC     H                     S01499
     C                     ADD  WVATE     OPDUM8                          S01499
     C                     ADD  WVATC     OPVATT                          S01499
     C                     END                                            S01499
     C*                                                                   S01499
     C** .... Cheque                                                      S01499
     C*                                                                   S01499
     C           OPVAT3    IFEQ 'Y'                                       S01499
     C           DUMA3     MULT WVATR     WVATE     H                     S01499
     C           CQCH      MULT WVATR     WVATC     H                     S01499
     C                     ADD  WVATE     OPDUM8                          S01499
     C                     ADD  WVATC     OPVATT                          S01499
     C                     END                                            S01499
     C*                                                                   S01499
     C** .... Costs                                                       S01499
     C*                                                                   S01499
     C           OPVAT4    IFEQ 'Y'                                       S01499
     C           DUMA4     MULT WVATR     WVATE     H                     S01499
     C           CSTA      MULT WVATR     WVATC     H                     S01499
     C                     ADD  WVATE     OPDUM8                          S01499
     C                     ADD  WVATC     OPVATT                          S01499
     C                     END                                            S01499
     C*                                                                   S01499
     C** .... SWIFT                                                       S01499
     C*                                                                   S01499
     C           OPVAT5    IFEQ 'Y'                                       S01499
     C           DUMA5     MULT WVATR     WVATE     H                     S01499
     C           SPCH      MULT WVATR     WVATC     H                     S01499
     C                     ADD  WVATE     OPDUM8                          S01499
     C                     ADD  WVATC     OPVATT                          S01499
     C                     END                                            S01499
     C*                                                                   S01499
     C** .... Miscellaneous                                               S01499
     C*                                                                   S01499
     C           OPVAT6    IFEQ 'Y'                                       S01499
     C           DUMA6     MULT WVATR     WVATE     H                     S01499
     C           MSCH      MULT WVATR     WVATC     H                     S01499
     C                     ADD  WVATE     OPDUM8                          S01499
     C                     ADD  WVATC     OPVATT                          S01499
     C                     END                                            S01499
     C*                                                                   S01499
     C** .... FX/Change commission                                        S01499
     C*                                                                   S01499
     C           OPVAT7    IFEQ 'Y'                                       S01499
     C           S01494    ANDEQ'Y'                                       S01499
     C           OPDUM7    MULT WVATR     WVATE     H                     S01499
     C           OPCHCM    MULT WVATR     WVATC     H                     S01499
     C                     ADD  WVATE     OPDUM8                          S01499
     C                     ADD  WVATC     OPVATT                          S01499
     C                     END                                            S01499
     C*                                                                   S01499
     C                     END                                            S01499
     C*
     C                     ENDSR
     C*
     C************************************************************
     C* END OF CHARGES SUBROUTINE
     C************************************************************
     C*/EJECT
     C************************************************************
     C*  CHGLT SUBROUTINE TO CONVERT FOR LOCY AMOUNTS
     C************************************************************
     C           CHGLT     BEGSR
     C*                                                                   S01194
     C*********************MOVEL'20      'TABKEY 12                       S01194
     C*********************MOVE '1'       WK4     4                       S01194
     C*********************MOVELLOCY      WK4                             S01194
     C*********************MOVE WK4       TABKEY                          S01194
     C***********TABKEY****CHAINTABTG10F             88                   S01194
     C************IN88*****IFEQ '1'                        ** B001        S01194
     C************LOCK*****IN   DLDA                                      S01194
     C*********************MOVE 'FT0040  'DBPGM                           S01194
     C*********************MOVEL'TABTG10' DBFILE                          S01194
     C*********************MOVELTABKEY    DBKEY            ************   S01194
     C*********************Z-ADD23        DBASE            * DBERR 23     S01194
     C*********************OUT  DLDA                       ************   S01194
     C*********************SETON                     U7U8LR               S01194
     C*********************DUMP                                           S01194
     C*********************RETRN                                          S01194
     C*********************END                             ** E001        S01194
     C                     CALL 'AOCURRR0'                                S01194
     C                     PARM '*DBERR ' RTCD                            S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM BJLCCY    @K101                           S01194
     C***********SDCURR    PARM SDCURR    DSFDY                           S01194              CSD006
     C           SDCURR    PARM SDCURR    DSSDY                                               CSD006
     C*                                                                   S01194
     C** Move new standing data field into field used in program          S01194
     C*                                                                   S01194
     C           A6MDIN    IFEQ 'M'                                       S01194
     C                     Z-ADD1         MDIN                            S01194
     C                     ELSE                                           S01194
     C                     Z-ADD0         MDIN                            S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C*                                                                   S01194
     C*********************Z-ADDCDP       LCDP    10                      S01194
     C                     Z-ADDA6NBDP    LCDP    10                      S01194
     C                     Z-ADDMDIN      LMDIN   10
     C*********************Z-ADDSPOT      LSPOT  138                      S01194
     C                     Z-ADDA6SPRT    LSPOT  138                      S01194
     C*
     C* M IS DIFFERENCE BETWEEN DECIMALS FOR BASE AND DECIMALS FOR
     C* LOCAL CURRENCY - FOLLOWING CALCS FIND TRUE RATE(LSPOT)TO
     C* CONVERT BASE CURRENCY TO LOCAL
     C*
     C           LCDP      SUB  BCDP      M       10
     C           LMDIN     IFEQ 1                          ** B001
     C           M         IFGT 0                          ** B002
     C           LSPOT     DIV  POWERS,M  TSPOT  159
     C                     ELSE                            ** X002
     C           M         IFLT 0                          ** B003
     C                     Z-SUBM         M
     C           LSPOT     MULT POWERS,M  TSPOT
     C                     ELSE                            ** X003
     C                     Z-ADDLSPOT     TSPOT
     C                     END                             ** E003
     C                     END                             ** E002
     C                     END                             ** E001
     C           LMDIN     IFEQ 0                          ** B001
     C           M         IFGT 0                          ** B002
     C           LSPOT     MULT POWERS,M  TSPOT
     C                     ELSE                            ** X002
     C           M         IFLT 0                          ** B003
     C                     Z-SUBM         M
     C           LSPOT     DIV  POWERS,M  TSPOT
     C                     ELSE                            ** X003
     C                     Z-ADDLSPOT     TSPOT
     C                     END                             ** E003
     C                     END                             ** E002
     C                     END                             ** E001
     C*
     C* NOW USE RATE TO CALCULATE DEFAULT VALUE IN LOCAL CURRENCY
     C*
     C           LMDIN     IFEQ 1                          ** B001
     C           AMNTB     DIV  TSPOT     AMNTE  110H
     C                     END                             ** E001
     C*
     C           LMDIN     IFEQ 0                          ** B001
     C           AMNTB     MULT TSPOT     AMNTE  110H
     C                     END                             ** E001
     C*
     C                     ENDSR
     C*
     C************************************************************
     C/EJECT
      ************                                                        031876
      ************  Remove PRONO OLPOS and MEMOS                          031876
      ************                                                        031876
     C************************************************************        031876
     C**MEMO*SR.**                                                        031876
     C**TO*UPDATE*MEMOS FILE                                              031876
     C************                                                        031876
     C***********MEMO      BEGSR                                          031876
     C************                                                        031876
     C**IF*INSERT*GO TO MEMINS                                            031876
     C***12*******         GOTO MEMINS                                    031876
     C**IF*SENDER'S CORRESPONDENT IS NOSTRO                               031876
     C***********OSNCT     IFEQ 'N'                        B001           031876
     C*********************MOVELOPCCY     CURR                            S01194
     C************         MOVELOSNCO     CURRN                           S01194
     C*********************MOVEL*BLANK    KEYR                            S01194
     C*********************MOVEL'70'Y     KEYR                            S01194
     C*********************MOVELCURRY     KEYR                            S01194
     C************         MOVELOPCCY     @CYCD                           S01194
     C************         MOVE CURRN     @NONB   2                       S01194
     C*********************EXSR TTLRED                   **READ*TABLETL** S01194
     C************         EXSR TTLRED                     READ SDNOSTPD  S01194
     C************         EXSR ACCRED                     READ ACCNT     031876
     C***********ATYP      IFEQ 'R'                        B002           031876
     C**IF*ACCOUNT IS RETAIL                                              031876
     C************         EXSR MEMRED                     READ MEMOS     031876
     C************         MOVE MMLDBL    LDBLWK 150                      031876
     C************         ADD  OPYAM     MMLDBL                          031876
     C************                                                        031876
     C***********OPYDT*****IFLT DNWD                                      S01194
     C***********OPYDT     IFLT BJDNWD                                    S01194
     C************         ADD  OPYAM     MMCLBL                          031876
     C************         END                                            031876
     C************                                                        031876
     C************         UPDATMEMOSMDF                                  031876
     C************                                                        031876
     C***IF*DEALING MOD. NOT PRESENT,UPDATE AME HERE                      031876
     C************                                                        031876
     C************INU2     IFEQ '0'                        B003           031876
     C************         Z-ADDOPYDT     VUDT                            031876
     C************         Z-ADDOPYAM     MVAM                            031876
     C************                                                        S01195
     C***Set*up*location with nostro location code                        S01195
     C************         MOVE NLOC      ZLOC                            S01195
     C************         MOVE 'N'       NOWRK                           S01195
     C************                                                        S01195
     C************         EXSR AMOVTS                                    031876
     C************         END                             E003           031876
     C************         END                             E002           031876
     C************         ELSE                            X001           031876
     C***********OSNCT     IFEQ 'R'                        B002           031876
     C**IF*SENDER'S CORRESPONDENT IS RETAIL                               031876
     C************         MOVELOSNCO     ACNO                            031876
     C************         EXSR ANMRED                     READ ACCNUMA   031876
     C************         EXSR MEMRED                     READ MEMOS     031876
     C************         MOVE MMLDBL    LDBLWK                          031876
     C************         ADD  OPYAM     MMLDBL                          031876
     C************                                                        031876
     C***********OPYDT*****IFLT DNWD                                      S01194
     C***********OPYDT     IFLT BJDNWD                                    S01194
     C************         ADD  OPYAM     MMCLBL                          031876
     C************         END                                            031876
     C************                                                        031876
     C************         UPDATMEMOSMDF                                  031876
     C************                                                        031876
     C**WRITE*TO*ACCOUNT MOVEMENTS FILE,IF RETAIL IS NOT A NOSTRO         031876
     C************                                                        031876
     C***********AKEY******CHAINFPRTNF               61                   S01194
     C************                                                        S01194
     C************         CALL 'AONOSTR0'                                S01194
     C************         PARM *BLANKS   RTCD                            S01194
     C************         PARM '*KEY   ' @OPTN                           S01194
     C************         PARM CNUMA     @CUST   6                       S01194
     C************         PARM CCY       @CYCD   3                       S01194
     C************         PARM ACODA     @ACCD   4                       S01194
     C************         PARM ACSQA     @ACSN   2                       S01194
     C************         PARM *BLANKS   @NONB                           S01194
     C************         PARM BRCA      @BRCD                           S01194
     C************         PARM *BLANKS   @CSSN  10                       S01194
     C************         PARM *BLANKS   @PNOI   1                       S01194
     C***********SDNOST    PARM SDNOST    DSFDY                           S01194
     C************                                                        S01194
     C***********RTCD      CASEQ*BLANKS   MVFPRT     6161                 S01194
     C************         END                                            S01194
     C************                                                        S01194
     C**N61******RECI******COMP 'D'                  6161                 S01194
     C************IN61     IFEQ '1'                        B003           031876
     C************                                                        S01195
     C****If*dealing module not present and account is a nostro           S01195
     C************                                                        S01195
     C************IN61     OREQ '0'                                       S01195
     C************INU2     ANDEQ'0'                                       S01195
     C************                                                        S01195
     C****Set*up*holiday location. If not a nostro use sytem              S01195
     C****location else use nostro location code                          S01195
     C************                                                        S01195
     C************IN61     IFEQ '1'                                       S01195
     C************         MOVE BJSLCD    ZLOC                            S01195
     C************         MOVE 'S'       NOWRK                           S01195
     C************         ELSE                                           S01195
     C************         MOVE NLOC      ZLOC                            S01195
     C************         MOVE 'N'       NOWRK                           S01195
     C************         END                                            S01195
     C************                                                        S01195
     C************         Z-ADDOPYDT     VUDT                            031876
     C************         Z-ADDOPYAM     MVAM                            031876
     C************         EXSR AMOVTS                                    031876
     C************         END                             E003           031876
     C************         END                             E002           031876
     C************         END                             E001           031876
     C***********ODSTT     IFEQ 'F'                        B001           031876
     C***********OSNCT     ANDEQ' '                                       031876
     C**IF*DESTINATION IF FULL NOSTRO                                     031876
     C************         MOVELODST1     CURR                            031876
     C************         MOVELODST1     @CYCD                           S01194
     C************         MOVE CURRN     @NONB                           S01194
     C*********************MOVE *BLANK    KEY                             S01194
     C*********************MOVEL'70'      KEY                             S01194
     C*********************MOVE CURR      KEY                             S01194
     C*********************MOVELODST1     @CYCD                           S01194
     C*********************MOVE CURRN     @NONB                           S01194
     C*********************EXSR TTLRED                   **READ*TABLETL** S01194
     C************         EXSR TTLRED                     READ SDNOSTPD  S01194
     C************         EXSR ACCRED                     READ ACCNT     031876
     C***********ATYP      IFEQ 'R'                        B002           031876
     C**IF*ACCOUNT IS RETAIL                                              031876
     C************         EXSR MEMRED                     READ MEMOS     031876
     C************         MOVE MMLDBL    LDBLWK                          031876
     C************         ADD  OPYAM     MMLDBL                          031876
     C************                                                        031876
     C***********OPYDT*****IFLT DNWD                                      S01194
     C***********OPYDT     IFLT BJDNWD                                    S01194
     C************         ADD  OPYAM     MMCLBL                          031876
     C************         END                                            031876
     C************                                                        031876
     C************         UPDATMEMOSMDF                                  031876
     C************                                                        031876
     C***IF*DEALING MOD. NOT PRESENT,UPDATE RTS HERE                      031876
     C************                                                        031876
     C************INU2     IFEQ '0'                        B003           031876
     C************         Z-ADDOPYDT     VUDT                            031876
     C************         Z-ADDOPYAM     MVAM                            031876
     C************                                                        S01195
     C***Set*up*location with nostro location code                        S01195
     C************         MOVE NLOC      ZLOC                            S01195
     C************         MOVE 'N'       NOWRK                           S01195
     C************                                                        S01195
     C************         EXSR AMOVTS                                    031876
     C************         END                             E003           031876
     C************         END                             E002           031876
     C************         ELSE                            X001           031876
     C***********ODSTT     IFEQ 'R'                        B002           031876
     C***********OSNCT     ANDEQ' '                                       031876
     C**IF*DESTINATION IF RETAIL                                          031876
     C************         MOVELODST1     ACNO                            031876
     C************         EXSR ANMRED                     READ ACNUMA    031876
     C************         EXSR MEMRED                     READ MEMOS     031876
     C************         MOVE MMLDBL    LDBLWK                          031876
     C************         ADD  OPYAM     MMLDBL                          031876
     C************                                                        031876
     C***********OPYDT*****IFLT DNWD                                      S01194
     C***********OPYDT     IFLT BJDNWD                                    S01194
     C************         ADD  OPYAM     MMCLBL                          031876
     C************         END                                            031876
     C************                                                        031876
     C************         UPDATMEMOSMDF                                  031876
     C************                                                        031876
     C**WRITE*TO*ACCOUNT MOVEMENTS FILE,IF RETAIL IS NOT A NOSTRO         031876
     C************                                                        031876
     C***********AKEY******CHAINFPRTNF               61                   S01194
     C************         CALL 'AONOSTR0'                                S01194
     C************         PARM *BLANKS   RTCD                            S01194
     C************         PARM '*KEY   ' @OPTN                           S01194
     C************         PARM CNUMA     @CUST                           S01194
     C************         PARM CCY       @CYCD                           S01194
     C************         PARM ACODA     @ACCD                           S01194
     C************         PARM ACSQA     @ACSN                           S01194
     C************         PARM *BLANKS   @NONB                           S01194
     C************         PARM BRCA      @BRCD                           S01194
     C************         PARM *BLANKS   @CSSN                           S01194
     C************         PARM *BLANKS   @PNOI                           S01194
     C***********SDNOST    PARM SDNOST    DSFDY                           S01194
     C************                                                        S01194
     C***********RTCD      CASEQ*BLANKS   MVFPRT     6161                 S01194
     C************         END                                            S01194
     C************                                                        S01194
     C**N61******RECI******COMP 'D'                  6161                 S01194
     C************IN61     IFEQ '1'                        B003           031876
     C************                                                        S01195
     C****If*dealing module not present and account is a nostro           S01195
     C************                                                        S01195
     C************IN61     OREQ '0'                                       S01195
     C************INU2     ANDEQ'0'                                       S01195
     C************                                                        S01195
     C************         Z-ADDOPYDT     VUDT                            031876
     C************         Z-ADDOPYAM     MVAM                            031876
     C************                                                        S01195
     C****Set*up*holiday location. If not a nostro use sytem              S01195
     C****location else use nostro location code                          S01195
     C************                                                        S01195
     C************IN61     IFEQ '1'                                       S01195
     C************         MOVE BJSLCD    ZLOC                            S01195
     C************         MOVE 'S'       NOWRK                           S01195
     C************         ELSE                                           S01195
     C************         MOVE NLOC      ZLOC                            S01195
     C************         MOVE 'N'       NOWRK                           S01195
     C************         END                                            S01195
     C************                                                        S01195
     C************         EXSR AMOVTS                                    031876
     C************         END                             E003           031876
     C************         ELSE                            X002           031876
     C**IF*DESTINATION IS FULL ACCOUNT NUMBER                             031876
     C***********ODSTT     IFEQ 'G'                        B003           031876
     C***********OSNCT     ANDEQ' '                                       031876
     C************         MOVELODST1     AKEYF                           031876
     C************         EXSR ACCRED                     READ ACCNT     031876
     C***********ATYP      IFEQ 'R'                        B004           031876
     C************         EXSR MEMRED                     READ MEMOS     031876
     C************         MOVE MMLDBL    LDBLWK                          031876
     C************         ADD  OPYAM     MMLDBL                          031876
     C************                                                        031876
     C***********OPYDT*****IFLT DNWD                                      S01194
     C***********OPYDT     IFLT BJDNWD                                    S01194
     C************         ADD  OPYAM     MMCLBL                          031876
     C************         END                                            031876
     C************                                                        031876
     C************         UPDATMEMOSMDF                                  031876
     C************                                                        031876
     C**WRITE*TO*ACCOUNT MOVEMENTS FILE,IF RETAIL IS NOT A NOSTRO         031876
     C************                                                        031876
     C***********AKEY******CHAINFPRTNF               61                   S01194
     C************         CALL 'AONOSTR0'                                S01194
     C************         PARM *BLANKS   RTCD                            S01194
     C************         PARM '*KEY   ' @OPTN                           S01194
     C************         PARM CNUMA     @CUST                           S01194
     C************         PARM CCY       @CYCD                           S01194
     C************         PARM ACODA     @ACCD                           S01194
     C************         PARM ACSQA     @ACSN                           S01194
     C************         PARM *BLANKS   @NONB                           S01194
     C************         PARM BRCA      @BRCD                           S01194
     C************         PARM *BLANKS   @CSSN                           S01194
     C************         PARM *BLANKS   @PNOI                           S01194
     C***********SDNOST    PARM SDNOST    DSFDY                           S01194
     C************                                                        S01194
     C***********RTCD      CASEQ*BLANKS   MVFPRT     6161                 S01194
     C************         END                                            S01194
     C************                                                        S01194
     C**N61******RECI******COMP 'D'                  6161                 S01194
     C************IN61     IFEQ '1'                        B005           S01194
     C************                                                        S01195
     C****If*dealing module not present and account is a nostro           S01195
     C************                                                        S01195
     C************IN61     OREQ '0'                                       S01195
     C************INU2     ANDEQ'0'                                       S01195
     C************                                                        S01195
     C************         Z-ADDOPYDT     VUDT                            031876
     C************         Z-ADDOPYAM     MVAM                            031876
     C************                                                        S01195
     C****Set*up*holiday location. If not a nostro use sytem              S01195
     C****location else use nostro location code                          S01195
     C************                                                        S01195
     C************IN61     IFEQ '1'                                       S01195
     C************         MOVE BJSLCD    ZLOC                            S01195
     C************         MOVE 'S'       NOWRK                           S01195
     C************         ELSE                                           S01195
     C************         MOVE NLOC      ZLOC                            S01195
     C************         MOVE 'N'       NOWRK                           S01195
     C************         END                                            S01195
     C************                                                        S01195
     C************         EXSR AMOVTS                                    031876
     C************         END                             E005           031876
     C************         END                             E004           031876
     C************         END                             E003           031876
     C************         END                             E002           031876
     C************         END                             E001           031876
      ************                                                        031876
      ***If*payment has been generated from an incoming one, don't make   031876
      ****postings for pay amount                                         031876
      ************                                                        031876
     C***********OPIN      IFEQ 'Y'                                       031876
     C************         GOTO MEMINS                                    031876
     C************         END                                            031876
     C**IF*ORDERING BANK IS NOSTRO                                        031876
     C***********OORBT     IFEQ 'N'                        B001           031876
     C*********************MOVELOSMCY     CURR                            S01194
     C************         MOVELOORBK     CURRN                           031876
     C*********************MOVE *BLANK    KEY                             S01194
     C*********************MOVEL'70'      KEY                             S01194
     C*********************MOVE CURR      KEY                             S01194
     C************         MOVELOSMCY     @CYCD                           S01194
     C************         MOVE CURRN     @NONB                           S01194
     C************         EXSR TTLRED                     READ TABLETL   031876
     C************         EXSR ACCRED                     READ ACCNT     031876
     C**IF*ACCOUNT ID RETAIL                                              031876
     C***********ATYP      IFEQ 'R'                        B002           031876
     C************         EXSR MEMRED                     READ MEMOS     031876
     C************         MOVE MMLDBL    LDBLWK                          031876
     C************         SUB  OSMAM     MMLDBL                          031876
     C************                                                        031876
     C***********OSLDT*****IFLT DNWD                                      S01194
     C***********OSLDT     IFLT BJDNWD                                    S01194
     C************         SUB  OSMAM     MMCLBL                          031876
     C************         END                                            031876
     C************                                                        031876
     C************         UPDATMEMOSMDF                                  031876
     C************                                                        031876
     C***IF*DEALING MOD. NOT PRESENT,UPDATE AME HERE                      031876
     C************                                                        031876
     C************INU2     IFEQ '0'                        B003           031876
     C************         Z-ADDOSLDT     VUDT                            031876
     C************         Z-ADDOSMAM     MVAM                            031876
     C************                                                        S01195
     C***Set*up*location with nostro location code                        S01195
     C************         MOVE NLOC      ZLOC                            S01195
     C************         MOVE 'N'       NOWRK                           S01195
     C************                                                        S01195
     C************         EXSR AMOVTS                                    031876
     C************         END                             E003           031876
     C************         END                             E002           031876
     C************         ELSE                            X001           031876
     C**IF*ORDERING BANK IS RETAIL                                        031876
     C***********OORBT     IFEQ 'R'                        B002           031876
     C************         MOVELOORBK     ACNO                            031876
     C************         EXSR ANMRED                     READ ACNUMA    031876
     C************         EXSR MEMRED                     READ MEMOS     031876
     C************         MOVE MMLDBL    LDBLWK                          031876
     C************         SUB  OSMAM     MMLDBL                          031876
     C************                                                        031876
     C***********OSLDT*****IFLT DNWD                                      S01194
     C***********OSLDT     IFLT BJDNWD                                    S01194
     C************         SUB  OSMAM     MMCLBL                          031876
     C************         END                                            031876
     C************                                                        031876
     C************         UPDATMEMOSMDF                                  031876
     C************                                                        031876
     C**WRITE*TO*ACCOUNT MOVEMENTS FILE,IF RETAIL IS NOT A NOSTRO         031876
     C************                                                        031876
     C***********AKEY******CHAINFPRTNF               61                   S01194
     C**N61******RECI******COMP 'D'                  6161                 S01194
     C************         CALL 'AONOSTR0'                                S01194
     C************         PARM *BLANKS   RTCD                            S01194
     C************         PARM '*KEY   ' @OPTN                           S01194
     C************         PARM CNUMA     @CUST                           S01194
     C************         PARM CCY       @CYCD                           S01194
     C************         PARM ACODA     @ACCD                           S01194
     C************         PARM ACSQA     @ACSN                           S01194
     C************         PARM *BLANKS   @NONB                           S01194
     C************         PARM BRCA      @BRCD                           S01194
     C************         PARM *BLANKS   @CSSN                           S01194
     C************         PARM *BLANKS   @PNOI                           S01194
     C***********SDNOST    PARM SDNOST    DSFDY                           S01194
     C************                                                        S01194
     C***********RTCD      CASEQ*BLANKS   MVFPRT     6161                 S01194
     C************         END                                            S01194
     C************                                                        S01194
     C************IN61     IFEQ '1'                        B003           031876
     C************                                                        S01195
     C****If*dealing module not present and account is a nostro           S01195
     C************                                                        S01195
     C************IN61     OREQ '0'                                       S01195
     C************INU2     ANDEQ'0'                                       S01195
     C************                                                        S01195
     C************         Z-ADDOSLDT     VUDT                            031876
     C************         Z-ADDOSMAM     MVAM                            031876
     C************                                                        S01195
     C****Set*up*holiday location. If not a nostro use sytem              S01195
     C****location else use nostro location code                          S01195
     C************                                                        S01195
     C************IN61     IFEQ '1'                                       S01195
     C************         MOVE BJSLCD    ZLOC                            S01195
     C************         MOVE 'S'       NOWRK                           S01195
     C************         ELSE                                           S01195
     C************         MOVE NLOC      ZLOC                            S01195
     C************         MOVE 'N'       NOWRK                           S01195
     C************         END                                            S01195
     C************                                                        S01195
     C************         EXSR AMOVTS                                    031876
     C************         END                             E003           031876
     C************         ELSE                            X002           031876
     C**IF*ORDERING BANK IS PARTIAL ACCOUNT CODE                          031876
     C***********OORBT     IFEQ 'P'                        B003           031876
     C************         MOVELOORBK     ORBKS                           031876
     C************         Z-ADDORNUM     CNUM                            031876
     C*********************MOVE SMCY      CCY                             E32553
     C************         MOVE OSMCY     CCY                             E32553
     C************         Z-ADDORCOD     ACOD                            031876
     C************         Z-ADDORSEQ     ACSQ                            031876
     C************         MOVE OORBB     BRCA                            S01194
     C************         EXSR ACCRED                     READ ACCNT     031876
     C**IF*ACCOUNT IS RETAIL                                              031876
     C***********ATYP      IFEQ 'R'                        B004           031876
     C************         EXSR MEMRED                     READ MEMOS     031876
     C************         MOVE MMLDBL    LDBLWK                          031876
     C************         SUB  OSMAM     MMLDBL                          031876
     C************                                                        031876
     C***********OSLDT*****IFLT DNWD                                      S01194
     C***********OSLDT     IFLT BJDNWD                                    S01194
     C************         SUB  OSMAM     MMCLBL                          031876
     C************         END                                            031876
     C************                                                        031876
     C************         UPDATMEMOSMDF                                  031876
     C************                                                        031876
     C**WRITE*TO*ACCOUNT MOVEMENTS FILE,IF RETAIL IS NOT A NOSTRO         031876
     C************                                                        031876
     C***********AKEY******CHAINFPRTNF               61                   S01194
     C**N61******RECI******COMP 'D'                  6161                 S01194
     C************         CALL 'AONOSTR0'                                S01194
     C************         PARM *BLANKS   RTCD                            S01194
     C************         PARM '*KEY   ' @OPTN                           S01194
     C************         PARM CNUMA     @CUST                           S01194
     C************         PARM CCY       @CYCD                           S01194
     C************         PARM ACODA     @ACCD                           S01194
     C************         PARM ACSQA     @ACSN                           S01194
     C************         PARM *BLANKS   @NONB                           S01194
     C************         PARM BRCA      @BRCD                           S01194
     C************         PARM *BLANKS   @CSSN                           S01194
     C************         PARM *BLANKS   @PNOI                           S01194
     C***********SDNOST    PARM SDNOST    DSFDY                           S01194
     C************                                                        S01194
     C***********RTCD      CASEQ*BLANKS   MVFPRT     6161                 S01194
     C************         END                                            S01194
     C************                                                        S01194
     C************IN61     IFEQ '1'                        B005           031876
     C************                                                        S01195
     C****If*dealing module not present and account is a nostro           S01195
     C************                                                        S01195
     C************IN61     OREQ '0'                                       S01195
     C************INU2     ANDEQ'0'                                       S01195
     C************                                                        S01195
     C************         Z-ADDOSLDT     VUDT                            031876
     C************         Z-ADDOSMAM     MVAM                            031876
     C************                                                        S01195
     C****Set*up*holiday location. If not a nostro use sytem              S01195
     C****location else use nostro location code                          S01195
     C************                                                        S01195
     C************IN61     IFEQ '1'                                       S01195
     C************         MOVE BJSLCD    ZLOC                            S01195
     C************         MOVE 'S'       NOWRK                           S01195
     C************         ELSE                                           S01195
     C************         MOVE NLOC      ZLOC                            S01195
     C************         MOVE 'N'       NOWRK                           S01195
     C************         END                                            S01195
     C************                                                        S01195
     C************         EXSR AMOVTS                                    031876
     C************         END                             E005           031876
     C************         END                             E004           031876
     C************         END                             E003           031876
     C************         END                             E002           031876
     C************         END                             E001           031876
     C**IF*ORDERING CUSTOMER IS RETAIL AND ORDERING BANK IF BLANK         031876
     C***********OORCT     IFEQ 'R'                        B001           031876
     C***********OORBT     ANDEQ' '                                       031876
     C************         MOVELOORC1     ACNO                            031876
     C************         EXSR ANMRED                     READ ACNUMA    031876
     C************         EXSR MEMRED                     READ MEMOS     031876
     C************         MOVE MMLDBL    LDBLWK                          031876
     C************         SUB  OSMAM     MMLDBL                          031876
     C************                                                        031876
     C***********OSLDT*****IFLT DNWD                                      S01194
     C***********OSLDT     IFLT BJDNWD                                    S01194
     C************         SUB  OSMAM     MMCLBL                          031876
     C************         END                                            031876
     C************                                                        031876
     C************         UPDATMEMOSMDF                                  031876
     C************                                                        031876
     C**WRITE*TO*ACCOUNT MOVEMENTS FILE,IF ACCOUNT IS NOT A NOSTRO        031876
     C************                                                        031876
     C***********AKEY******CHAINFPRTNF               61                   S01194
     C**N61******RECI******COMP 'D'                  6161                 S01194
     C************         CALL 'AONOSTR0'                                S01194
     C************         PARM *BLANKS   RTCD                            S01194
     C************         PARM '*KEY   ' @OPTN                           S01194
     C************         PARM CNUMA     @CUST                           S01194
     C************         PARM CCY       @CYCD                           S01194
     C************         PARM ACODA     @ACCD                           S01194
     C************         PARM ACSQA     @ACSN                           S01194
     C************         PARM *BLANKS   @NONB                           S01194
     C************         PARM BRCA      @BRCD                           S01194
     C************         PARM *BLANKS   @CSSN                           S01194
     C************         PARM *BLANKS   @PNOI                           S01194
     C***********SDNOST    PARM SDNOST    DSFDY                           S01194
     C************                                                        S01194
     C***********RTCD      CASEQ*BLANKS   MVFPRT     6161                 S01194
     C************         END                                            S01194
     C************                                                        S01194
     C************IN61     IFEQ '1'                        B002           031876
     C************                                                        S01195
     C****If*dealing module not present and account is a nostro           S01195
     C************                                                        S01195
     C************IN61     OREQ '0'                                       S01195
     C************INU2     ANDEQ'0'                                       S01195
     C************                                                        S01195
     C************         Z-ADDOSLDT     VUDT                            031876
     C************         Z-ADDOSMAM     MVAM                            031876
     C************                                                        S01195
     C****Set*up*holiday location. If not a nostro use sytem              S01195
     C****location else use nostro location code                          S01195
     C************                                                        S01195
     C************IN61     IFEQ '1'                                       S01195
     C************         MOVE BJSLCD    ZLOC                            S01195
     C************         MOVE 'S'       NOWRK                           S01195
     C************         ELSE                                           S01195
     C************         MOVE NLOC      ZLOC                            S01195
     C************         MOVE 'N'       NOWRK                           S01195
     C************         END                                            S01195
     C************                                                        S01195
     C************         EXSR AMOVTS                                    031876
     C************         END                             E002           031876
     C************         ELSE                            X001           031876
     C***********OORCT     IFEQ 'P'                        B002           031876
     C***********OORBT     ANDEQ' '                                       031876
     C**IF*ORDERING CUSTOMER IS PARTIAL ACCOUNT                           031876
     C************         MOVELOORC1     ORBKS                           031876
     C************         Z-ADDORNUM     CNUM                            031876
     C*********************MOVE SMCY      CCY                             E32553
     C************         MOVE OSMCY     CCY                             E32553
     C************         Z-ADDORCOD     ACOD                            031876
     C************         Z-ADDORSEQ     ACSQ                            031876
     C************         MOVE ORBRC     BRCA                            S01194
     C************         EXSR ACCRED                     READ ACCNT     031876
     C**IF*ACCOUNT IS RETAIL                                              031876
     C***********ATYP      IFEQ 'R'                        B003           031876
     C************         EXSR MEMRED                     READ MEMOS     031876
     C************         MOVE MMLDBL    LDBLWK                          031876
     C************         SUB  OSMAM     MMLDBL                          031876
     C************                                                        031876
     C***********OSLDT*****IFLT DNWD                                      S01194
     C***********OSLDT     IFLT BJDNWD                                    S01194
     C************         SUB  OSMAM     MMCLBL                          031876
     C************         END                                            031876
     C************                                                        031876
     C************         UPDATMEMOSMDF                                  031876
     C************                                                        031876
     C**WRITE*TO*ACCOUNT MOVEMENTS FILE,IF ACCOUNT IS NOT A NOSTRO        031876
     C************                                                        031876
     C***********AKEY******CHAINFPRTNF               61                   S01194
     C**N61******RECI******COMP 'D'                  6161                 S01194
     C************         CALL 'AONOSTR0'                                S01194
     C************         PARM *BLANKS   RTCD                            S01194
     C************         PARM '*KEY   ' @OPTN                           S01194
     C************         PARM CNUMA     @CUST                           S01194
     C************         PARM CCY       @CYCD                           S01194
     C************         PARM ACODA     @ACCD                           S01194
     C************         PARM ACSQA     @ACSN                           S01194
     C************         PARM *BLANKS   @NONB                           S01194
     C************         PARM BRCA      @BRCD                           S01194
     C************         PARM *BLANKS   @CSSN                           S01194
     C************         PARM *BLANKS   @PNOI                           S01194
     C***********SDNOST    PARM SDNOST    DSFDY                           S01194
     C************                                                        S01194
     C***********RTCD      CASEQ*BLANKS   MVFPRT     6161                 S01194
     C************         END                                            S01194
     C************                                                        S01194
     C************IN61     IFEQ '1'                        B004           031876
     C************                                                        S01195
     C****If*dealing module not present and account is a nostro           S01195
     C************                                                        S01195
     C************IN61     OREQ '0'                                       S01195
     C************INU2     ANDEQ'0'                                       S01195
     C************                                                        S01195
     C************         Z-ADDOSLDT     VUDT                            031876
     C************         Z-ADDOSMAM     MVAM                            031876
     C************                                                        S01195
     C****Set*up*holiday location. If not a nostro use sytem              S01195
     C****location else use nostro location code                          S01195
     C************                                                        S01195
     C************IN61     IFEQ '1'                                       S01195
     C************         MOVE BJSLCD    ZLOC                            S01195
     C************         MOVE 'S'       NOWRK                           S01195
     C************         ELSE                                           S01195
     C************         MOVE NLOC      ZLOC                            S01195
     C************         MOVE 'N'       NOWRK                           S01195
     C************         END                                            S01195
     C************                                                        S01195
     C************         EXSR AMOVTS                                    031876
     C************         END                             E004           031876
     C************         END                             E003           031876
     C************         END                             E002           031876
     C************         END                             E001           031876
     C***********MEMINS    TAG                             ** MEMINS      031876
     C**IF*DELETION                                                       031876
     C***14*******         GOTO MEMEND                                    031876
     C**IF*SENDER'S CORRESPONDENT IF NOSTRO                               031876
     C***********SSNCT     IFEQ 'N'                        B001           031876
     C*********************MOVELSPCCY     CURR                            S01194
     C*********************MOVELSSNCO     CURRN                           S01194
     C*********************MOVE *BLANK    KEY                             S01194
     C*********************MOVEL'70'      KEY                             S01194
     C*********************MOVE CURR      KEY                             S01194
     C************         MOVELSPCCY     @CYCD                           S01194
     C************         MOVELSSNCO     @NONB                           S01194
     C*********************EXSR TTLRED                   **READ*TABLETL** S01194
     C************         EXSR TTLRED                     READ SDNOSTPD  S01194
     C************         EXSR ACCRED                     READ ACCNT     031876
     C**IF*ACCOUNT TYPE IS RETAIL                                         031876
     C***********ATYP      IFEQ 'R'                        B002           031876
     C************         EXSR MEMRED                     READ MEMOS     031876
     C************         MOVE MMLDBL    LDBLWK                          031876
     C************         SUB  SPYAM     MMLDBL                          031876
     C************                                                        031876
     C***********SPYDT*****IFLT DNWD                                      S01194
     C***********SPYDT     IFLT BJDNWD                                    S01194
     C************         SUB  SPYAM     MMCLBL                          031876
     C************         END                                            031876
     C************                                                        031876
     C************         UPDATMEMOSMDF                                  031876
     C************                                                        031876
     C***IF*DEALING MOD. NOT PRESENT,UPDATE AME HERE                      031876
     C************                                                        031876
     C************INU2     IFEQ '0'                        B003           031876
     C************         Z-ADDSPYDT     VUDT                            031876
     C************         Z-ADDSPYAM     MVAM                            031876
     C************                                                        S01195
     C***Set*up*location with nostro location code                        S01195
     C************         MOVE NLOC      ZLOC                            S01195
     C************         MOVE 'N'       NOWRK                           S01195
     C************                                                        S01195
     C************         EXSR AMOVTS                                    031876
     C************         END                             E003           031876
     C************         END                             E002           031876
     C************         ELSE                            X001           031876
     C**IF*SENDER'S CORRESPONDENT IF RETAIL                               031876
     C***********SSNCT     IFEQ 'R'                        B002           031876
     C************         MOVELSSNCO     ACNO                            031876
     C************         EXSR ANMRED                     READ ACNUMA    031876
     C************         EXSR MEMRED                     READ MEMOS     031876
     C************         MOVE MMLDBL    LDBLWK                          031876
     C************         SUB  SPYAM     MMLDBL                          031876
     C************                                                        031876
     C***********SPYDT*****IFLT DNWD                                      S01194
     C***********SPYDT     IFLT BJDNWD                                    S01194
     C************         SUB  SPYAM     MMCLBL                          031876
     C************         END                                            031876
     C************                                                        031876
     C************         UPDATMEMOSMDF                                  031876
     C************                                                        031876
     C**WRITE*TO*ACCOUNT MOVEMENTS FILE,IF ACCOUNT IS NOT A NOSTRO        031876
     C************                                                        031876
     C***********AKEY******CHAINFPRTNF               61                   S01194
     C**N61******RECI******COMP 'D'                  6161                 S01194
     C************         CALL 'AONOSTR0'                                S01194
     C************         PARM *BLANKS   RTCD                            S01194
     C************         PARM '*KEY   ' @OPTN                           S01194
     C************         PARM CNUMA     @CUST                           S01194
     C************         PARM CCY       @CYCD                           S01194
     C************         PARM ACODA     @ACCD                           S01194
     C************         PARM ACSQA     @ACSN                           S01194
     C************         PARM *BLANKS   @NONB                           S01194
     C************         PARM BRCA      @BRCD                           S01194
     C************         PARM *BLANKS   @CSSN                           S01194
     C************         PARM *BLANKS   @PNOI                           S01194
     C***********SDNOST    PARM SDNOST    DSFDY                           S01194
     C************                                                        S01194
     C***********RTCD      CASEQ*BLANKS   MVFPRT     6161                 S01194
     C************         END                                            S01194
     C************                                                        S01194
     C************IN61     IFEQ '1'                        B003           031876
     C************                                                        S01195
     C****If*dealing module not present and account is a nostro           S01195
     C************                                                        S01195
     C************IN61     OREQ '0'                                       S01195
     C************INU2     ANDEQ'0'                                       S01195
     C************                                                        S01195
     C************         Z-ADDSPYDT     VUDT                            031876
     C************         Z-ADDSPYAM     MVAM                            031876
     C************                                                        S01195
     C****Set*up*holiday location. If not a nostro use sytem              S01195
     C****location else use nostro location code                          S01195
     C************                                                        S01195
     C************IN61     IFEQ '1'                                       S01195
     C************         MOVE BJSLCD    ZLOC                            S01195
     C************         MOVE 'S'       NOWRK                           S01195
     C************         ELSE                                           S01195
     C************         MOVE NLOC      ZLOC                            S01195
     C************         MOVE 'N'       NOWRK                           S01195
     C************         END                                            S01195
     C************                                                        S01195
     C************         EXSR AMOVTS                                    031876
     C************         END                             E003           031876
     C************         END                             E002           031876
     C************         END                             E001           031876
     C**IF*DESTINATION IS FULL NOSTRO                                     031876
     C***********SDSTT     IFEQ 'F'                        B001           031876
     C***********SSNCT     ANDEQ' '                                       031876
     C************         MOVELSDST1     CURR                            031876
     C*********************MOVE *BLANK    KEY                             S01194
     C*********************MOVEL'70'      KEY                             S01194
     C*********************MOVE CURR      KEY                             S01194
     C*********************EXSR TTLRED                   **READ*TABLETL** S01194
     C************         MOVELSDST1     @CYCD                           S01194
     C************         MOVE CURRN     @NONB                           S01194
     C************         EXSR TTLRED                     READ SDNOSTPD  S01194
     C************         EXSR ACCRED                     READ ACCNT     031876
     C**IF*ACCOUNT IS RETAIL                                              031876
     C***********ATYP      IFEQ 'R'                        B002           031876
     C************         EXSR MEMRED                     READ MEMOS     031876
     C************         MOVE MMLDBL    LDBLWK                          031876
     C************         SUB  SPYAM     MMLDBL                          031876
     C************                                                        031876
     C***********SPYDT*****IFLT DNWD                                      S01194
     C***********SPYDT     IFLT BJDNWD                                    S01194
     C************         SUB  SPYAM     MMCLBL                          031876
     C************         END                                            031876
     C************                                                        031876
     C************         UPDATMEMOSMDF                                  031876
     C************                                                        031876
     C***IF*DEALING MOD. NOT PRESENT,UPDATE AME HERE                      031876
     C************                                                        031876
     C************INU2     IFEQ '0'                        B003           031876
     C************         Z-ADDSPYDT     VUDT                            031876
     C************         Z-ADDSPYAM     MVAM                            031876
     C************                                                        S01195
     C***Set*up*location with nostro location code                        S01195
     C************         MOVE NLOC      ZLOC                            S01195
     C************         MOVE 'N'       NOWRK                           S01195
     C************                                                        S01195
     C************         EXSR AMOVTS                                    031876
     C************         END                             E003           031876
     C************         END                             E002           031876
     C************         ELSE                            X001           031876
     C**IF*DESTINATION IS RETAIL                                          031876
     C***********SDSTT     IFEQ 'R'                        B002           031876
     C***********SSNCT     ANDEQ' '                                       031876
     C************         MOVELSDST1     ACNO                            031876
     C************         EXSR ANMRED                     READ ACNUMA    031876
     C************         EXSR MEMRED                     READ MEMOS     031876
     C************         MOVE MMLDBL    LDBLWK                          031876
     C************         SUB  SPYAM     MMLDBL                          031876
     C************                                                        031876
     C***********SPYDT*****IFLT DNWD                                      S01194
     C***********SPYDT     IFLT BJDNWD                                    S01194
     C************         SUB  SPYAM     MMCLBL                          031876
     C************         END                                            031876
     C************                                                        031876
     C************         UPDATMEMOSMDF                                  031876
     C************                                                        031876
     C**WRITE*TO*ACCOUNT MOVEMENTS FILE,IF ACCOUNT IS NOT A NOSTRO        031876
     C************                                                        031876
     C***********AKEY******CHAINFPRTNF               61                   S01194
     C**N61******RECI******COMP 'D'                  6161                 S01194
     C************         CALL 'AONOSTR0'                                S01194
     C************         PARM *BLANKS   RTCD                            S01194
     C************         PARM '*KEY   ' @OPTN                           S01194
     C************         PARM CNUMA     @CUST                           S01194
     C************         PARM CCY       @CYCD                           S01194
     C************         PARM ACODA     @ACCD                           S01194
     C************         PARM ACSQA     @ACSN                           S01194
     C************         PARM *BLANKS   @NONB                           S01194
     C************         PARM BRCA      @BRCD                           S01194
     C************         PARM *BLANKS   @CSSN                           S01194
     C************         PARM *BLANKS   @PNOI                           S01194
     C***********SDNOST    PARM SDNOST    DSFDY                           S01194
     C************                                                        S01194
     C***********RTCD      CASEQ*BLANKS   MVFPRT     6161                 S01194
     C************         END                                            S01194
     C************                                                        S01194
     C************IN61     IFEQ '1'                        B003           031876
     C************                                                        S01195
     C****If*dealing module not present and account is a nostro           S01195
     C************                                                        S01195
     C************IN61     OREQ '0'                                       S01195
     C************INU2     ANDEQ'0'                                       S01195
     C************                                                        S01195
     C************         Z-ADDSPYDT     VUDT                            031876
     C************         Z-ADDSPYAM     MVAM                            031876
     C************                                                        S01195
     C****Set*up*holiday location. If not a nostro use sytem              S01195
     C****location else use nostro location code                          S01195
     C************                                                        S01195
     C************IN61     IFEQ '1'                                       S01195
     C************         MOVE BJSLCD    ZLOC                            S01195
     C************         MOVE 'S'       NOWRK                           S01195
     C************         ELSE                                           S01195
     C************         MOVE NLOC      ZLOC                            S01195
     C************         MOVE 'N'       NOWRK                           S01195
     C************         END                                            S01195
     C************                                                        S01195
     C************         EXSR AMOVTS                                    031876
     C************         END                             E003           031876
     C************         ELSE                            X002           031876
     C**IF*DESTINATION IF FULL ACCOUNT CODE                               031876
     C***********SDSTT     IFEQ 'G'                        B003           031876
     C***********SSNCT     ANDEQ' '                                       031876
     C************         MOVELSDST1     AKEYF                           031876
     C************                                                        S01117
     C***If*non*multi branched set up branch field with single branch     S01117
     C************                                                        S01117
     C***********@MBIN     IFEQ 'N'                                       S01117
     C************         MOVE BJSBRC    BRCA                            S01117
     C************         END                                            S01117
     C************         EXSR ACCRED                     READ ACCNT     031876
     C***********ATYP      IFEQ 'R'                        B004           031876
     C************         EXSR MEMRED                     READ MEMOS     031876
     C************         MOVE MMLDBL    LDBLWK                          031876
     C************         SUB  SPYAM     MMLDBL                          031876
     C************                                                        031876
     C***********SPYDT*****IFLT DNWD                                      S01194
     C***********SPYDT     IFLT BJDNWD                                    S01194
     C************         SUB  SPYAM     MMCLBL                          031876
     C************         END                                            031876
     C************                                                        031876
     C************         UPDATMEMOSMDF                                  031876
     C************                                                        031876
     C**WRITE*TO*ACCOUNT MOVEMENTS FILE,IF ACCOUNT IS NOT A NOSTRO        031876
     C************                                                        031876
     C***********AKEY******CHAINFPRTNF               61                   S01194
     C**N61******RECI******COMP 'D'                  6161                 S01194
     C************         CALL 'AONOSTR0'                                S01194
     C************         PARM *BLANKS   RTCD                            S01194
     C************         PARM '*KEY   ' @OPTN                           S01194
     C************         PARM CNUMA     @CUST                           S01194
     C************         PARM CCY       @CYCD                           S01194
     C************         PARM ACODA     @ACCD                           S01194
     C************         PARM ACSQA     @ACSN                           S01194
     C************         PARM *BLANKS   @NONB                           S01194
     C************         PARM BRCA      @BRCD                           S01194
     C************         PARM *BLANKS   @CSSN                           S01194
     C************         PARM *BLANKS   @PNOI                           S01194
     C***********SDNOST    PARM SDNOST    DSFDY                           S01194
     C************                                                        S01194
     C***********RTCD      CASEQ*BLANKS   MVFPRT     6161                 S01194
     C************         END                                            S01194
     C************                                                        S01194
     C************IN61     IFEQ '1'                        B005           031876
     C************                                                        S01195
     C****If*dealing module not present and account is a nostro           S01195
     C************                                                        S01195
     C************IN61     OREQ '0'                                       S01195
     C************INU2     ANDEQ'0'                                       S01195
     C************                                                        S01195
     C************         Z-ADDSPYDT     VUDT                            031876
     C************         Z-ADDSPYAM     MVAM                            031876
     C************                                                        S01195
     C****Set*up*holiday location. If not a nostro use sytem              S01195
     C****location else use nostro location code                          S01195
     C************                                                        S01195
     C************IN61     IFEQ '1'                                       S01195
     C************         MOVE BJSLCD    ZLOC                            S01195
     C************         MOVE 'S'       NOWRK                           S01195
     C************         ELSE                                           S01195
     C************         MOVE NLOC      ZLOC                            S01195
     C************         MOVE 'N'       NOWRK                           S01195
     C************         END                                            S01195
     C************                                                        S01195
     C************         EXSR AMOVTS                                    031876
     C************         END                             E005           031876
     C************         END                             E004           031876
     C************         END                             E003           031876
     C************         END                             E002           031876
     C************         END                             E001           031876
      ************                                                        031876
      ***If*payment has been generated from an incoming one, don't make   031876
      ****postings for pay amount                                         031876
      ************                                                        031876
     C***********OPIN      IFEQ 'Y'                                       031876
     C************         GOTO MEMEND                                    031876
     C************         END                                            031876
     C************                                                        031876
     C**IF*ORDERING BANK IS NOSTRO                                        031876
     C***********SORBT     IFEQ 'N'                        B001           031876
     C*********************MOVELSSMCY     CURR                            S01194
     C************         MOVELSORBK     CURRN                           031876
     C*********************MOVE *BLANK    KEY                             S01194
     C*********************MOVEL'70'      KEY                             S01194
     C*********************MOVE CURR      KEY                             S01194
     C*********************EXSR TTLRED                   **READ*TABLETL** S01194
     C************         MOVELSSMCY     @CYCD                           S01194
     C************         MOVE CURRN     @NONB   2                       S01194
     C************         EXSR TTLRED                     READ SDNOSTPD  S01194
     C************         EXSR ACCRED                     READ ACCNT     031876
     C**IF*ACCOUNT IS RETAIL                                              031876
     C***********ATYP      IFEQ 'R'                        B002           031876
     C************         EXSR MEMRED                     READ MEMOS     031876
     C************         MOVE MMLDBL    LDBLWK                          031876
     C************         ADD  SSMAM     MMLDBL                          031876
     C************                                                        031876
     C***********SSLDT*****IFLT DNWD                                      S01194
     C***********SSLDT     IFLT BJDNWD                                    S01194
     C************         ADD  SSMAM     MMCLBL                          031876
     C************         END                                            031876
     C************                                                        031876
     C************         UPDATMEMOSMDF                                  031876
     C************                                                        031876
     C***IF*DEALING MOD. NOT PRESENT,UPDATE AME HERE                      031876
     C************                                                        031876
     C************INU2     IFEQ '0'                        B003           031876
     C************         Z-ADDSSLDT     VUDT                            031876
     C************         Z-ADDSSMAM     MVAM                            031876
     C************                                                        S01195
     C***Set*up*location with nostro location code                        S01195
     C************         MOVE NLOC      ZLOC                            S01195
     C************         MOVE 'N'       NOWRK                           S01195
     C************                                                        S01195
     C************         EXSR AMOVTS                                    031876
     C************         END                             E003           031876
     C************         END                             E002           031876
     C************         ELSE                            X001           031876
     C**IF*ORDERING BANK IS RETAIL                                        031876
     C***********SORBT     IFEQ 'R'                        B002           031876
     C************         MOVELSORBK     ACNO                            031876
     C************         EXSR ANMRED                     READ ACCNT     031876
     C************         EXSR MEMRED                     READ MEMOS     031876
     C************         MOVE MMLDBL    LDBLWK                          031876
     C************         ADD  SSMAM     MMLDBL                          031876
     C************                                                        031876
     C***********SSLDT*****IFLT DNWD                                      S01194
     C***********SSLDT     IFLT BJDNWD                                    S01194
     C************         ADD  SSMAM     MMCLBL                          031876
     C************         END                                            031876
     C************                                                        031876
     C************         UPDATMEMOSMDF                                  031876
     C************                                                        031876
     C**WRITE*TO*ACCOUNT MOVEMENTS FILE,IF ACCOUNT IS NOT A NOSTRO        031876
     C************                                                        031876
     C***********AKEY******CHAINFPRTNF               61                   S01194
     C**N61******RECI******COMP 'D'                  6161                 S01194
     C************         CALL 'AONOSTR0'                                S01194
     C************         PARM *BLANKS   RTCD                            S01194
     C************         PARM '*KEY   ' @OPTN                           S01194
     C************         PARM CNUMA     @CUST                           S01194
     C************         PARM CCY       @CYCD                           S01194
     C************         PARM ACODA     @ACCD                           S01194
     C************         PARM ACSQA     @ACSN                           S01194
     C************         PARM *BLANKS   @NONB                           S01194
     C************         PARM BRCA      @BRCD                           S01194
     C************         PARM *BLANKS   @CSSN                           S01194
     C************         PARM *BLANKS   @PNOI                           S01194
     C***********SDNOST    PARM SDNOST    DSFDY                           S01194
     C************                                                        S01194
     C***********RTCD      CASEQ*BLANKS   MVFPRT     6161                 S01194
     C************         END                                            S01194
     C************                                                        S01194
     C************IN61     IFEQ '1'                        B003           031876
     C************                                                        S01195
     C****If*dealing module not present and account is a nostro           S01195
     C************                                                        S01195
     C************IN61     OREQ '0'                                       S01195
     C************INU2     ANDEQ'0'                                       S01195
     C************                                                        S01195
     C************         Z-ADDSSLDT     VUDT                            031876
     C************         Z-ADDSSMAM     MVAM                            031876
     C************                                                        S01195
     C****Set*up*holiday location. If not a nostro use sytem              S01195
     C****location else use nostro location code                          S01195
     C************                                                        S01195
     C************IN61     IFEQ '1'                                       S01195
     C************         MOVE BJSLCD    ZLOC                            S01195
     C************         MOVE 'S'       NOWRK                           S01195
     C************         ELSE                                           S01195
     C************         MOVE NLOC      ZLOC                            S01195
     C************         MOVE 'N'       NOWRK                           S01195
     C************         END                                            S01195
     C************                                                        S01195
     C************         EXSR AMOVTS                                    031876
     C************         END                             E003           031876
     C************         ELSE                            X002           031876
     C**IF*ORDERING BANK IS PARTIAL ACCOUNT CODE                          031876
     C***********SORBT     IFEQ 'P'                        B003           031876
     C************         MOVELSORBK     ORBKS                           031876
     C************         Z-ADDORNUM     CNUM                            031876
     C************         MOVE SSMCY     CCY                             031876
     C************         Z-ADDORCOD     ACOD                            031876
     C************         Z-ADDORSEQ     ACSQ                            031876
     C************         MOVE SORBB     BRCA                            S01194
     C************         EXSR ACCRED                     READ ACCNT     031876
     C**IF*ACCOUNT IS RETAIL                                              031876
     C***********ATYP      IFEQ 'R'                        B004           031876
     C************         EXSR MEMRED                     READ MEMOS     031876
     C************         MOVE MMLDBL    LDBLWK                          031876
     C************         ADD  SSMAM     MMLDBL                          031876
     C************                                                        031876
     C***********SSLDT*****IFLT DNWD                                      S01194
     C***********SSLDT     IFLT BJDNWD                                    S01194
     C************         ADD  SSMAM     MMCLBL                          031876
     C************         END                                            031876
     C************                                                        031876
     C************         UPDATMEMOSMDF                                  031876
     C************                                                        031876
     C**WRITE*TO*ACCOUNT MOVEMENTS FILE IF ACCOUNT IS NOT A NOSTRO        031876
     C************                                                        031876
     C***********AKEY******CHAINFPRTNF               61                   S01194
     C**N61******RECI******COMP 'D'                  6161                 S01194
     C************         CALL 'AONOSTR0'                                S01194
     C************         PARM *BLANKS   RTCD                            S01194
     C************         PARM '*KEY   ' @OPTN                           S01194
     C************         PARM CNUMA     @CUST                           S01194
     C************         PARM CCY       @CYCD                           S01194
     C************         PARM ACODA     @ACCD                           S01194
     C************         PARM ACSQA     @ACSN                           S01194
     C************         PARM *BLANKS   @NONB                           S01194
     C************         PARM BRCA      @BRCD                           S01194
     C************         PARM *BLANKS   @CSSN                           S01194
     C************         PARM *BLANKS   @PNOI                           S01194
     C***********SDNOST    PARM SDNOST    DSFDY                           S01194
     C************                                                        S01194
     C***********RTCD      CASEQ*BLANKS   MVFPRT     6161                 S01194
     C************         END                                            S01194
     C************                                                        S01194
     C************IN61     IFEQ '1'                        B005           031876
     C************                                                        S01195
     C****If*dealing module not present and account is a nostro           S01195
     C************                                                        S01195
     C************IN61     OREQ '0'                                       S01195
     C************INU2     ANDEQ'0'                                       S01195
     C************                                                        S01195
     C************         Z-ADDSSLDT     VUDT                            031876
     C************         Z-ADDSSMAM     MVAM                            031876
     C************                                                        S01195
     C****Set*up*holiday location. If not a nostro use sytem              S01195
     C****location else use nostro location code                          S01195
     C************                                                        S01195
     C************IN61     IFEQ '1'                                       S01195
     C************         MOVE BJSLCD    ZLOC                            S01195
     C************         MOVE 'S'       NOWRK                           S01195
     C************         ELSE                                           S01195
     C************         MOVE NLOC      ZLOC                            S01195
     C************         MOVE 'N'       NOWRK                           S01195
     C************         END                                            S01195
     C************                                                        S01195
     C************         EXSR AMOVTS                                    031876
     C************         END                             E005           031876
     C************         END                             E004           031876
     C************         END                             E003           031876
     C************         END                             E002           031876
     C************         END                             E001           031876
     C************                                                        031876
     C***********SORCT     IFEQ 'R'                        B001           031876
     C***********SORBT     ANDEQ' '                                       031876
     C************         MOVELSORC1     ACNO                            031876
     C************         EXSR ANMRED                     READ ACNUMA    031876
     C************         EXSR MEMRED                     READ MEMOS     031876
     C************         MOVE MMLDBL    LDBLWK                          031876
     C************         ADD  SSMAM     MMLDBL                          031876
     C************                                                        031876
     C***********SSLDT*****IFLT DNWD                                      S01194
     C***********SSLDT     IFLT BJDNWD                                    S01194
     C************         ADD  SSMAM     MMCLBL                          031876
     C************         END                                            031876
     C************                                                        031876
     C************         UPDATMEMOSMDF                                  031876
     C************                                                        031876
     C**WRITE*TO*ACCOUNT MOVEMENTS FILE,IF ACCOUNT IS NOT A NOSTRO        031876
     C************                                                        031876
     C***********AKEY******CHAINFPRTNF               61                   S01194
     C**N61******RECI******COMP 'D'                  6161                 S01194
     C************         CALL 'AONOSTR0'                                S01194
     C************         PARM *BLANKS   RTCD                            S01194
     C************         PARM '*KEY   ' @OPTN                           S01194
     C************         PARM CNUMA     @CUST                           S01194
     C************         PARM CCY       @CYCD                           S01194
     C************         PARM ACODA     @ACCD                           S01194
     C************         PARM ACSQA     @ACSN                           S01194
     C************         PARM *BLANKS   @NONB                           S01194
     C************         PARM BRCA      @BRCD                           S01194
     C************         PARM *BLANKS   @CSSN                           S01194
     C************         PARM *BLANKS   @PNOI                           S01194
     C***********SDNOST    PARM SDNOST    DSFDY                           S01194
     C************                                                        S01194
     C***********RTCD      CASEQ*BLANKS   MVFPRT     6161                 S01194
     C************         END                                            S01194
     C************                                                        S01194
     C************IN61     IFEQ '1'                        B002           031876
     C************                                                        S01195
     C****If*dealing module not present and account is a nostro           S01195
     C************                                                        S01195
     C************IN61     OREQ '0'                                       S01195
     C************INU2     ANDEQ'0'                                       S01195
     C************                                                        S01195
     C************         Z-ADDSSLDT     VUDT                            031876
     C************         Z-ADDSSMAM     MVAM                            031876
     C************                                                        S01195
     C****Set*up*holiday location. If not a nostro use sytem              S01195
     C****location else use nostro location code                          S01195
     C************                                                        S01195
     C************IN61     IFEQ '1'                                       S01195
     C************         MOVE BJSLCD    ZLOC                            S01195
     C************         MOVE 'S'       NOWRK                           S01195
     C************         ELSE                                           S01195
     C************         MOVE NLOC      ZLOC                            S01195
     C************         MOVE 'N'       NOWRK                           S01195
     C************         END                                            S01195
     C************                                                        S01195
     C************         EXSR AMOVTS                                    031876
     C************         END                             E002           031876
     C************         ELSE                            X001           031876
     C**IF*ORDERING CUSTOMER IS PARTIAL ACCOUNT                           031876
     C***********SORCT     IFEQ 'P'                        B002           031876
     C***********SORBT     ANDEQ' '                                       031876
     C************         MOVELSORC1     ORBKS                           031876
     C************                                                        S01117
     C***If*non*multi branched set up branch feild with single branch     S01117
     C************                                                        S01117
     C***********@MBIN     IFEQ 'N'                                       S01117
     C************         MOVE BJSBRC    ORBRC                           S01117
     C************         END                                            S01117
     C************         Z-ADDORNUM     CNUM                            031876
     C************         MOVE SSMCY     CCY                             031876
     C************         Z-ADDORCOD     ACOD                            031876
     C************         Z-ADDORSEQ     ACSQ                            031876
     C************         MOVE ORBRC     BRCA                            S01194
     C************         EXSR ACCRED                     READ ACCNT     031876
     C**IF*ACCOUNT IS RETAIL                                              031876
     C***********ATYP      IFEQ 'R'                        B003           031876
     C************         EXSR MEMRED                     READ MEMOS     031876
     C************         MOVE MMLDBL    LDBLWK                          031876
     C************         ADD  SSMAM     MMLDBL                          031876
     C************                                                        031876
     C***********SSLDT*****IFLT DNWD                                      S01194
     C***********SSLDT     IFLT BJDNWD                                    S01194
     C************         ADD  SSMAM     MMCLBL                          031876
     C************         END                                            031876
     C************                                                        031876
     C************         UPDATMEMOSMDF                                  031876
     C************                                                        031876
     C**WRITE*TO*ACCOUNT MOVEMENTS FILE,IF ACCOUNT IS NOT A NOSTRO        031876
     C************                                                        031876
     C***********AKEY******CHAINFPRTNF               61                   S01194
     C**N61******RECI******COMP 'D'                  6161                 S01194
     C************         CALL 'AONOSTR0'                                S01194
     C************         PARM *BLANKS   RTCD                            S01194
     C************         PARM '*KEY   ' @OPTN                           S01194
     C************         PARM CNUMA     @CUST                           S01194
     C************         PARM CCY       @CYCD                           S01194
     C************         PARM ACODA     @ACCD                           S01194
     C************         PARM ACSQA     @ACSN                           S01194
     C************         PARM *BLANKS   @NONB                           S01194
     C************         PARM BRCA      @BRCD                           S01194
     C************         PARM *BLANKS   @CSSN                           S01194
     C************         PARM *BLANKS   @PNOI                           S01194
     C***********SDNOST    PARM SDNOST    DSFDY                           S01194
     C************                                                        S01194
     C***********RTCD      CASEQ*BLANKS   MVFPRT     6161                 S01194
     C************         END                                            S01194
     C************                                                        S01194
     C************IN61     IFEQ '1'                        B004           031876
     C************                                                        S01195
     C****If*dealing module not present and account is a nostro           S01195
     C************                                                        S01195
     C************IN61     OREQ '0'                                       S01195
     C************INU2     ANDEQ'0'                                       S01195
     C************                                                        S01195
     C************         Z-ADDSSLDT     VUDT                            031876
     C************         Z-ADDSSMAM     MVAM                            031876
     C************                                                        S01195
     C****Set*up*holiday location. If not a nostro use sytem              S01195
     C****location else use nostro location code                          S01195
     C************                                                        S01195
     C************IN61     IFEQ '1'                                       S01195
     C************         MOVE BJSLCD    ZLOC                            S01195
     C************         MOVE 'S'       NOWRK                           S01195
     C************         ELSE                                           S01195
     C************         MOVE NLOC      ZLOC                            S01195
     C************         MOVE 'N'       NOWRK                           S01195
     C************         END                                            S01195
     C************                                                        S01195
     C************         EXSR AMOVTS                                    031876
     C************         END                             E004           031876
     C************         END                             E003           031876
     C************         END                             E002           031876
     C************         END                             E001           031876
     C************                                                        031876
     C***********MEMEND    ENDSR                           ** MEMEND      031876
     C************                                                        031876
     C************************************************************        031876
     C**END*OF*MEMOS FILE UPDATE                                          031876
     C************************************************************        031876
     C*/EJECT******                                                       031876
     C************************************************************        031876
     C**PROPO*SR.*                                                        031876
     C**TO*UPDATE*PRONO AND OLPOS                                         031876
     C**OLPOS*THEN PRONO                                                  031876
     C**ORIGINAL*VALUES ARE REVERSED FIRST (DELETION AND AMENDMENT)       031876
     C**THEN*ENTERED VALUES ARE APPLIED (INSERTION AND AMENDMENT)         031876
     C************                                                        031876
     C***********PROPO     BEGSR                                          031876
     C************                                                        031876
     C**IF*INSERT*GO TO OPLENB                                            031876
     C***12*******         GOTO OLPENB                                    031876
      ************                                                        031876
      ***If*payment has been generated from an incoming one, don't make   031876
      ****postings for pay amount                                         031876
      ************                                                        031876
     C***********OPIN      IFEQ 'Y'                                       031876
     C************         GOTO OLPENA                                    031876
     C************         END                                            031876
     C************         MOVE OSMCY     CCY                             031876
     C************         MOVE '01'      RECN                            031876
     C************                                                        S01117
     C***********@MBIN     IFEQ 'Y'                                       S01117
     C************         MOVE SBRCA     BRCA                            S01117
     C************         ELSE                                           S01117
     C************         MOVE BJSBRC    BRCA                            S01117
     C************         END                                            S01117
     C************                                                        S01117
     C***********OKEY      CHAINOLPOSOAF             88                   031876
     C**IF*NO*RECORD FOUND CURRENCY ENTERED TODAY IGNORE                  031876
     C***88*******         GOTO OLPENA                                    031876
     C***********OSLDT     IFLT OLD,1                      B001           031876
     C************         EXCPTROLPOS                                    031876
     C************         GOTO OLPENA                                    031876
     C************         END                             E001           031876
     C**IF*SETTLE*DATE GREATER THAN 16TH DATE SUBTRACT FROM 16TH TOTAL    031876
     C***********OSLDT     IFGT OLD,16                     B001           031876
     C************         SUB  OSMAM     OIN,16                          031876
     C************         ELSE                            X001           031876
     C************         Z-ADD1         Q       30                      031876
     C***********OSLDT     LOKUPOLD,Q                70  71               031876
     C***70******Q         IFGT 1                          B002           031876
     C************         SUB  1         Q                               031876
     C************         END                             E002           031876
     C**SUBTRACT*SETTLE AMOUNT FROM TOTAL FOR THE DATE LESS THAN OR       031876
     C**EQUAL*TO*SETTLEMENT DATE                                          031876
     C************         SUB  OSMAM     OIN,Q                           031876
     C************         END                             E001           031876
     C************         UPDATOLPOSOAF                                  031876
     C***********OLPENA    TAG                             ** OLPENA      031876
     C************         MOVE OPCCY     CCY                             031876
     C************         MOVE '01'      RECN                            031876
     C************                                                        S01117
     C***********@MBIN     IFEQ 'Y'                                       S01117
     C************         MOVE SBRCA     BRCA                            S01117
     C************         ELSE                                           S01117
     C************         MOVE BJSBRC    BRCA                            S01117
     C************         END                                            S01117
     C************                                                        S01117
     C***********OKEY      CHAINOLPOSOAF             88                   031876
     C***88*******         GOTO OLPENB                                    031876
     C***********OPYDT     IFLT OLD,1                      B001           031876
     C************         EXCPTROLPOS                                    031876
     C************         GOTO OLPENB                                    031876
     C************         END                             E001           031876
     C**IF*NO*RECORD FOUND CURRENCY ENTERED TODAY IGNORE                  031876
     C***********OPYDT     IFGT OLD,16                     B001           031876
     C**IF*PAY*DATE GREATER THAN 16TH DATE SUBTRACT FROM 16TH TOTAL       031876
     C************         SUB  OPYAM     OUT,16                          031876
     C************         ELSE                            X001           031876
     C************         Z-ADD1         Q       30                      031876
     C***********OPYDT     LOKUPOLD,Q                70  71               031876
     C***70******Q         IFGT 1                          B002           031876
     C************         SUB  1         Q                               031876
     C************         END                             E002           031876
     C**SUBTRACT*PAY AMOUNT FROM TOTAL FOR THE DATE LESS THAN OR EQUAL    031876
     C**PAY*DATE**                                                        031876
     C************         SUB  OPYAM     OUT,Q                           031876
     C************         END                             E001           031876
     C************         UPDATOLPOSOAF                                  031876
     C***********OLPENB    TAG                             ** OLPENB      031876
     C**IF*DELETE*GO TO OPEND                                             031876
     C***14*******         GOTO OPEND                                     031876
      ************                                                        031876
      ***If*payment has been generated from an incoming one, don't make   031876
      ****postings for pay amount                                         031876
      ************                                                        031876
     C***********OPIN      IFEQ 'Y'                                       031876
     C************         GOTO OLPENC                                    031876
     C************         END                                            031876
     C************         MOVE SSMCY     CCY                             031876
     C************         MOVE '01'      RECN                            031876
     C************         SETOF                     88                   031876
     C************                                                        S01117
     C***********@MBIN     IFEQ 'Y'                                       S01117
     C************         MOVE SBRCA     BRCA                            S01117
     C************         ELSE                                           S01117
     C************         MOVE BJSBRC    BRCA                            S01117
     C************         END                                            S01117
     C************                                                        S01117
     C***********OKEY      CHAINOLPOSOAF             88                   031876
     C**IF*NO*RECORD FOUND CURRENCY ENTERED TODAY IGNORE                  031876
     C***88*******         GOTO OLPENC                                    031876
     C***********SSLDT     IFLT OLD,1                      B001           031876
     C************         EXCPTROLPOS                                    031876
     C************         GOTO OLPENC                                    031876
     C************         END                             E001           031876
     C**IF*SETTLE*DATE GREATER THAN 16TH DATE ADD TO 16TH TOTAL           031876
     C***********SSLDT     IFGT OLD,16                     B001           031876
     C************         ADD  SSMAM     OIN,16                          031876
     C************         ELSE                            X001           031876
     C************         Z-ADD1         Q       30                      031876
     C***********SSLDT     LOKUPOLD,Q                70  71               031876
     C***70******Q         IFGT 1                          B002           031876
     C************         SUB  1         Q                               031876
     C************         END                             E002           031876
     C**ADD*SETTLEMENT AMOUNT FROM TOTAL FOR THE DATE LESS THAN OR        031876
     C**SETTLE*DATE                                                       031876
     C************         ADD  SSMAM     OIN,Q                           031876
     C************         END                             E001           031876
     C************         UPDATOLPOSOAF                                  031876
     C***********OLPENC    TAG                             ** OLPENC      031876
     C************         MOVE SPCCY     CCY                             031876
     C************         MOVE '01'      RECN                            031876
     C************                                                        S01117
     C***********@MBIN     IFEQ 'Y'                                       S01117
     C************         MOVE SBRCA     BRCA                            S01117
     C************         ELSE                                           S01117
     C************         MOVE BJSBRC    BRCA                            S01117
     C************         END                                            S01117
     C************                                                        S01117
     C***********OKEY      CHAINOLPOSOAF             88                   031876
     C**IF*NO*RECORD FOUND CURRENCY ENTERED TODAY IGNORE                  031876
     C***88*******         GOTO OPEND                                     031876
     C***********SPYDT     IFLT OLD,1                      B001           031876
     C************         EXCPTROLPOS                                    031876
     C************         GOTO OPEND                                     031876
     C************         END                             E001           031876
     C**IF*PAY*DATE GREATER THAN 16TH DATE ADD TO 16TH TOTAL              031876
     C***********SPYDT     IFGT OLD,16                     B001           031876
     C************         ADD  SPYAM     OUT,16                          031876
     C************         ELSE                            X001           031876
     C************         Z-ADD1         Q       30                      031876
     C***********SPYDT     LOKUPOLD,Q                70  71               031876
     C***70******Q         IFGT 1                          B002           031876
     C************         SUB  1         Q                               031876
     C************         END                             E002           031876
     C**ADD*PAY*AMOUNT FROM TOTAL FOR THE DATE LESS THAN OR EQUAL         031876
     C**PAY*DATE**                                                        031876
     C************         ADD  SPYAM     OUT,Q                           031876
     C************         END                             E001           031876
     C************         UPDATOLPOSOAF                                  031876
     C**END*OF*OLPOS UPDATE                                               031876
     C***********OPEND     TAG                             ** OPEND       031876
     C**IF*INSERT*GO TO PRENE                                             031876
     C***12*******         GOTO PRENDE                                    031876
     C**IF*SENDER'S CORRESPONDENT IS NOT NOSTRO GO TO PRENDO              031876
     C***********OSNCT     IFNE 'N'                        B001           031876
     C**CHECK*FOR*POSSIBLE ACCOUNT NUMBER NOSTROS                         031876
     C************         MOVE OSNCT     NTYPE   1                       031876
     C************         MOVELOSNCO     RTNO                            031876
     C************         MOVE OPCCY     NCCY    3                       031876
     C************         EXSR NOSTRO                                    031876
     C************         ELSE                            X001           031876
     C************         SETON                     49                   031876
     C************         MOVE OPCCY     CCY                             031876
     C************         MOVELOSNCO     NOSN                            031876
     C************         END                             E001           031876
     C**IF*NOSTRO*CHAIN TO PRONO                                          031876
     C***49*******         DO                              B001           031876
     C***STORE*ORIGINAL NOSTRO NO. IN CASE UNALLOCATED NOSTRO NO USED     E32536
     C************                                                        E32536
     C************         Z-ADDNOSN      NOSOR   20                      E32536
     C***********PKEY      CHAINPRONOPNF             88                   031876
     C**IF*NOSTRO*NOT ON FILE READ '00' NUMBER RECORD                     031876
     C***88*******         DO                              B001           031876
     C************         MOVE '00'      NOSN                            031876
     C***********PKEY      CHAINPRONOPNF             88                   031876
     C**IF*NOT*ON*FILE CURRENCY HAS BEEN ENTERED TODAY IGNORE             031876
     C***88*******         GOTO PRENDO                                    031876
     C************         END                             E001           031876
     C**IF*PAY*DATE GREATER THAN DATE 5 IGNORE                            031876
     C***********OPYDT     IFGT PDT,5                      B001           031876
     C************         EXCPTRPRONO                                    031876
     C************         GOTO PRENDO                                    031876
     C************         END                             E001           031876
     C**USE*LOKUP*TO FIND DATE TO START FROM                              031876
     C************         Z-ADD1         Q       30                      031876
     C***********OPYDT     LOKUPPDT,Q                70  71               031876
     C***70******Q         IFGT 1                          B002           031876
     C************         SUB  1         Q                               031876
     C************         END                             E002           031876
     C************         Z-ADDPNV       PNO                             031876
     C***********Q         DOUGT5                          B002           031876
     C************         ADD  OPYAM     PNV,Q                           031876
     C************         ADD  1         Q                               031876
     C************         END                             E002           031876
     C************         UPDATPRONOPNF                                  031876
     C************         Z-ADDOPYDT     VUDT                            031876
     C************         Z-ADDOPYAM     MVAM                            031876
     C************         SETON                     60                   031876
     C************                                                        S01195
     C***Set*up*location from nostro location                             S01195
     C************                                                        S01195
     C************         MOVE NLOC      ZLOC                            S01195
     C************         MOVE 'N'       NOWRK                           S01195
     C************                                                        S01195
     C***IN*CASE*UNALLOCATED NOSTRO USED FOR PRONO REINSTATE ORIGINAL     E32536
     C***NOSTRO*NUMBER TO PREVENT DB ERROR                                E32536
     C************                                                        E32536
     C************         Z-ADDNOSOR     NOSN                            E32536
     C************                                                        E32536
     C************         EXSR AMOVTS                                    031876
     C************                                                        031876
     C************         END                             E001           031876
     C************                                                        031876
     C**IF*SENDER'S CORRESPONDENT NOT BLANK GO TO PRENDO                  031876
     C***********OSNCT     IFNE *BLANK                     B001           031876
     C************         GOTO PRENDO                                    031876
     C************         END                             E001           031876
     C***********ODSTT     IFNE 'F'                        B001           031876
     C**CHECK*FOR*POSSIBLE ACCOUNT NUMBER NOSTROS                         031876
     C************         MOVE ODSTT     NTYPE   1                       031876
     C************         MOVELODST1     RTNO                            031876
     C************         MOVE OPCCY     NCCY    3                       031876
     C************         EXSR NOSTRO                                    031876
     C************         ELSE                            X001           031876
     C************         SETON                     49                   031876
     C************         MOVELODST1     CURR                            031876
     C************         MOVELCURR      CCY                             031876
     C************         MOVE CURR      NOSN                            031876
     C************         END                             E001           031876
     C***49*******         DO                              B001           031876
     C***STORE*ORIGINAL NOSTRO NO. IN CASE UNALLOCATED NOSTRO NO USED     E32536
     C************                                                        E32536
     C************         Z-ADDNOSN      NOSOR                           E32536
     C***********PKEY      CHAINPRONOPNF             88                   031876
     C**IF*NOSTRO*NOT ON FILE READ '00' NUMBER RECORD                     031876
     C***88*******         DO                              B001           031876
     C************         MOVE '00'      NOSN                            031876
     C***********PKEY      CHAINPRONOPNF             88                   031876
     C***88*******         GOTO PRENDO                                    031876
     C************         END                             E001           031876
     C**IF*SETTLE*DATE GREATER THAN DATE 5 IGNORE                         031876
     C***********OPYDT     IFGT PDT,5                      B001           031876
     C************         EXCPTRPRONO                                    031876
     C************         GOTO PRENDO                                    031876
     C************         END                             E001           031876
     C**USE*LOKUP*TO FIND DATE TO START FROM                              031876
     C************         Z-ADD1         Q       30                      031876
     C***********OPYDT     LOKUPPDT,Q                70  71               031876
     C***70******Q         IFGT 1                          B002           031876
     C************         SUB  1         Q                               031876
     C************         END                             E002           031876
     C************         Z-ADDPNV       PNO                             031876
     C***********Q         DOUGT5                          B002           031876
     C************         ADD  OPYAM     PNV,Q                           031876
     C************         ADD  1         Q                               031876
     C************         END                             E002           031876
     C************         UPDATPRONOPNF                                  031876
     C************         Z-ADDOPYDT     VUDT                            031876
     C************         Z-ADDOPYAM     MVAM                            031876
     C************         SETON                     60                   031876
     C************                                                        S01195
     C***Set*up*location from nostro location                             S01195
     C************                                                        S01195
     C************         MOVE NLOC      ZLOC                            S01195
     C************         MOVE 'N'       NOWRK                           S01195
     C************                                                        S01195
     C************                                                        S01195
     C***IN*CASE*UNALLOCATED NOSTRO USED FOR PRONO REINSTATE ORIGINAL     E32536
     C***NOSTRO*NUMBER TO PREVENT DB ERROR IN AMOVTS                      E32536
     C************                                                        E32536
     C************         Z-ADDNOSOR     NOSN                            E32536
     C************         EXSR AMOVTS                                    031876
     C************         END                             E001           031876
     C***********PRENDO    TAG                             ** PRENDO      031876
      ************                                                        031876
      ***If*payment has been generated from an incoming one, don't make   031876
      ****postings for pay amount                                         031876
      ************                                                        031876
     C***********OPIN      IFEQ 'Y'                                       031876
     C************         GOTO PRENDE                                    031876
     C************         END                                            031876
     C***********OORBT     IFNE 'N'                        B001           031876
     C**CHECK*FOR*POSSIBLE ACCOUNT NUMBER NOSTROS                         031876
     C************         MOVE OORBT     NTYPE   1                       031876
     C************         MOVELOORBK     RTNO                            031876
     C************         MOVE OSMCY     NCCY    3                       031876
     C************         MOVE OORBB     BRCANP                          S01117
     C************         EXSR NOSTRO                                    031876
     C************         ELSE                            X001           031876
     C************         SETON                     49                   031876
     C************         MOVE OSMCY     CCY                             031876
     C************         MOVELOORBK     NOSN                            031876
     C************         END                             E001           031876
     C***49*******         DO                              B001           031876
     C***STORE*ORIGINAL NOSTRO NO. IN CASE UNALLOCATED NOSTRO NO USED     E32536
     C************                                                        E32536
     C************         Z-ADDNOSN      NOSOR                           E32536
     C***********PKEY      CHAINPRONOPNF             88                   031876
     C**IF*NOSTRO*NOT ON FILE READ '00' NUMBER RECORD                     031876
     C***88*******         DO                              B001           031876
     C************         MOVE '00'      NOSN                            031876
     C***********PKEY      CHAINPRONOPNF             88                   031876
     C***88*******         GOTO PRNDEA                                    031876
     C************         END                             E001           031876
     C**IF*SETTLE*DATE GREATER THAN DATE 5 IGNORE                         031876
     C***********OSLDT     IFGT PDT,5                      B001           031876
     C************         EXCPTRPRONO                                    031876
     C************         GOTO PRNDEA                                    031876
     C************         END                             E001           031876
     C**USE*LOKUP*TO FIND DATE TO START FROM                              031876
     C************         Z-ADD1         Q       30                      031876
     C***********OSLDT     LOKUPPDT,Q                70  71               031876
     C***70******Q         IFGT 1                          B002           031876
     C************         SUB  1         Q                               031876
     C************         END                             E002           031876
     C************         Z-ADDPNV       PNO                             031876
     C***********Q         DOUGT5                          B002           031876
     C************         SUB  OSMAM     PNV,Q                           031876
     C************         ADD  1         Q                               031876
     C************         END                             E002           031876
     C************         UPDATPRONOPNF                                  031876
     C************         Z-ADDOSLDT     VUDT                            031876
     C************         Z-ADDOSMAM     MVAM                            031876
     C************         SETON                     60                   031876
     C************                                                        S01194
     C***Set*up*location from nostro location                             S01194
     C************                                                        S01194
     C************         MOVE NLOC      ZLOC                            S01194
     C************                                                        S01194
     C************                                                        S01195
     C***IN*CASE*UNALLOCATED NOSTRO USED FOR PRONO REINSTATE ORIGINAL     E32536
     C***NOSTRO*NUMBER TO PREVENT DB ERROR IN AMOVTS                      E32536
     C************                                                        E32536
     C************         Z-ADDNOSOR     NOSN                            E32536
     C************         EXSR AMOVTS                                    031876
     C************         END                             E001           031876
     C***********PRNDEA    TAG                             ** PRNDEA      031876
     C***********OORBT     IFEQ *BLANK                     B001           031876
     C**CHECK*FOR*POSSIBLE ACCOUNT NUMBER NOSTROS                         031876
     C************         MOVE OORCT     NTYPE   1                       031876
     C************         MOVELOORC1     RTNO                            031876
     C************         MOVE OSMCY     NCCY    3                       031876
     C************         EXSR NOSTRO                                    031876
     C***49*******         DO                              B002           031876
     C***STORE*ORIGINAL NOSTRO NO. IN CASE UNALLOCATED NOSTRO NO USED     E32536
     C************                                                        E32536
     C************         Z-ADDNOSN      NOSOR                           E32536
     C***********PKEY      CHAINPRONOPNF             88                   031876
     C**IF*NOSTRO*NOT ON FILE READ '00' NUMBER RECORD                     031876
     C***88*******         DO                              B003           031876
     C************         MOVE '00'      NOSN                            031876
     C************         SETOF                     88                   031876
     C***********PKEY      CHAINPRONOPNF             88                   031876
     C***88*******         GOTO PRENDE                                    031876
     C************         END                             E003           031876
     C**IF*SETTLE*DATE GREATER THAN DATE 5 IGNORE                         031876
     C***********OSLDT     IFGT PDT,5                      B003           031876
     C************         EXCPTRPRONO                                    031876
     C************         GOTO PRENDE                                    031876
     C************         END                             E003           031876
     C**USE*LOKUP*TO FIND DATE TO START FROM                              031876
     C************         Z-ADD1         Q       30                      031876
     C***********OSLDT     LOKUPPDT,Q                70  71               031876
     C***70******Q         IFGT 1                          B003           031876
     C************         SUB  1         Q                               031876
     C************         END                             E002           031876
     C************         Z-ADDPNV       PNO                             031876
     C***********Q         DOUGT5                          B003           031876
     C************         SUB  OSMAM     PNV,Q                           031876
     C************         ADD  1         Q                               031876
     C************         END                             E002           031876
     C************         UPDATPRONOPNF                                  031876
     C************         Z-ADDOSLDT     VUDT                            031876
     C************         Z-ADDOSMAM     MVAM                            031876
     C************         SETON                     60                   031876
     C************                                                        S01195
     C***Set*up*location from nostro location                             S01195
     C************                                                        S01195
     C************         MOVE NLOC      ZLOC                            S01195
     C************                                                        S01195
     C************                                                        S01195
     C***IN*CASE*UNALLOCATED NOSTRO USED FOR PRONO REINSTATE ORIGINAL     E32536
     C***NOSTRO*NUMBER TO PREVENT DB ERROR IN AMOVTS                      E32536
     C************                                                        E32536
     C************         Z-ADDNOSOR     NOSN                            E32536
     C************         EXSR AMOVTS                                    031876
     C************         END                             E002           031876
     C************         END                             E001           031876
     C***********PRENDE    TAG                             ** PRENDE      031876
     C**DELETION*GO TO PREND                                              031876
     C***14*******         GOTO PREND                                     031876
     C**IF*SENDER'S CORRESPONDENT IS NOT NOSTRO GO TO PRENIO              031876
     C***********SSNCT     IFNE 'N'                        B001           031876
     C**CHECK*FOR*POSSIBLE ACCOUNT NUMBER NOSTROS                         031876
     C************         MOVE SSNCT     NTYPE   1                       031876
     C************         MOVELSSNCO     RTNO                            031876
     C************         MOVE SPCCY     NCCY    3                       031876
     C************         EXSR NOSTRO                                    031876
     C************         ELSE                            X001           031876
     C************         SETON                     49                   031876
     C************         MOVE SPCCY     CCY                             031876
     C************         MOVELSSNCO     NOSN                            031876
     C************         END                             E001           031876
     C***49*******         DO                              B001           031876
     C***STORE*ORIGINAL NOSTRO NO. IN CASE UNALLOCATED NOSTRO NO USED     E32536
     C************                                                        E32536
     C************         Z-ADDNOSN      NOSOR                           E32536
     C***********PKEY      CHAINPRONOPNF             88                   031876
     C**IF*NOSTRO*NOT ON FILE READ '00' NUMBER RECORD                     031876
     C***88*******         DO                              B001           031876
     C************         MOVE '00'      NOSN                            031876
     C***********PKEY      CHAINPRONOPNF             88                   031876
     C***88*******         GOTO PRENIO                                    031876
     C************         END                             E001           031876
     C**IF*PAY*DATE GREATER THAN DATE 5 IGNORE                            031876
     C***********SPYDT     IFGT PDT,5                      B001           031876
     C************         EXCPTRPRONO                                    031876
     C************         GOTO PRENIO                                    031876
     C************         END                             E001           031876
     C**USE*LOKUP*TO FIND DATE TO START FROM                              031876
     C************         Z-ADD1         Q       30                      031876
     C***********SPYDT     LOKUPPDT,Q                70  71               031876
     C***70******Q         IFGT 1                          B002           031876
     C************         SUB  1         Q                               031876
     C************         END                             E002           031876
     C************         Z-ADDPNV       PNO                             031876
     C***********Q         DOUGT5                          B002           031876
     C************         SUB  SPYAM     PNV,Q                           031876
     C************         ADD  1         Q                               031876
     C************         END                             E002           031876
     C************         UPDATPRONOPNF                                  031876
     C************         Z-ADDSPYDT     VUDT                            031876
     C************         Z-ADDSPYAM     MVAM                            031876
     C************         SETON                     60                   031876
     C************                                                        S01195
     C***Set*up*location from nostro location                             S01195
     C************                                                        S01195
     C************         MOVE NLOC      ZLOC                            S01195
     C************                                                        S01195
     C************                                                        S01195
     C***IN*CASE*UNALLOCATED NOSTRO USED FOR PRONO REINSTATE ORIGINAL     E32536
     C***NOSTRO*NUMBER TO PREVENT DB ERROR IN AMOVTS                      E32536
     C************                                                        E32536
     C************         Z-ADDNOSOR     NOSN                            E32536
     C************         EXSR AMOVTS                                    031876
     C************         END                             E001           031876
     C************                                                        031876
     C***********PREN2     TAG                                            031876
     C************                                                        031876
     C**IF*SENDER'S CORRESPONDENT IS NOT BLANK GO TO PRENIO               031876
     C***********SSNCT     IFNE *BLANK                     B001           031876
     C************         GOTO PRENIO                                    031876
     C************         END                             E001           031876
     C***********SDSTT     IFNE 'F'                        B001           031876
     C**CHECK*FOR*POSSIBLE ACCOUNT NUMBER NOSTROS                         031876
     C************         MOVE SDSTT     NTYPE   1                       031876
     C************         MOVELSDST1     RTNO                            031876
     C************                                                        S01117
     C***If*non*multi branched and full account,set up branch field       S01117
     C***with*single branch                                               S01117
     C************                                                        S01117
     C***********@MBIN     IFEQ 'N'                                       S01117
     C***********SDSTT     ANDEQ'G'                                       S01117
     C************         MOVE BJSBRC    BRCAN                           S01117
     C************         END                                            S01117
     C************         MOVE SPCCY     NCCY    3                       031876
     C************         EXSR NOSTRO                                    031876
     C************         ELSE                            X001           031876
     C************         SETON                     49                   031876
     C************         MOVELSDST1     CURR                            031876
     C************         MOVELCURR      CCY                             031876
     C************         MOVE CURR      NOSN                            031876
     C************         END                             E001           031876
     C***49*******         DO                              B001           031876
     C***STORE*ORIGINAL NOSTRO NO. IN CASE UNALLOCATED NOSTRO NO USED     E32536
     C************                                                        E32536
     C************         Z-ADDNOSN      NOSOR                           E32536
     C***********PKEY      CHAINPRONOPNF             88                   031876
     C**IF*NOSTRO*NOT ON FILE READ '00' NUMBER RECORD                     031876
     C***88*******         DO                              B001           031876
     C************         MOVE '00'      NOSN                            031876
     C***********PKEY      CHAINPRONOPNF             88                   031876
     C***88*******         GOTO PRENIO                                    031876
     C************         END                             E001           031876
     C**IF*RECEIVE DATE GREATER THAN DATE 5 IGNORE                        031876
     C***********SPYDT     IFGT PDT,5                      B001           031876
     C************         EXCPTRPRONO                                    031876
     C************         GOTO PRENIO                                    031876
     C************         END                             E001           031876
     C**USE*LOKUP*TO FIND DATE TO START FROM                              031876
     C************         Z-ADD1         Q       30                      031876
     C***********SPYDT     LOKUPPDT,Q                70  71               031876
     C***70******Q         IFGT 1                          B002           031876
     C************         SUB  1         Q                               031876
     C************         END                             E002           031876
     C************         Z-ADDPNV       PNO                             031876
     C***********Q         DOUGT5                          B002           031876
     C************         SUB  SPYAM     PNV,Q                           031876
     C************         ADD  1         Q                               031876
     C************         END                             E002           031876
     C************         UPDATPRONOPNF                                  031876
     C************         Z-ADDSPYDT     VUDT                            031876
     C************         Z-ADDSPYAM     MVAM                            031876
     C************         SETON                     60                   031876
     C************                                                        S01195
     C***Set*up*location from nostro location                             S01195
     C************                                                        S01195
     C************         MOVE NLOC      ZLOC                            S01195
     C************                                                        S01195
     C************                                                        S01195
     C***IN*CASE*UNALLOCATED NOSTRO USED FOR PRONO REINSTATE ORIGINAL     E32536
     C***NOSTRO*NUMBER TO PREVENT DB ERROR IN AMOVTS                      E32536
     C************                                                        E32536
     C************         Z-ADDNOSOR     NOSN                            E32536
     C************         EXSR AMOVTS                                    031876
     C************         END                             E001           031876
     C***********PRENIO    TAG                             ** PRENIO      031876
      ************                                                        031876
      ***If*payment has been generated from an incoming one, don't make   031876
      ****postings for pay amount                                         031876
      ************                                                        031876
     C***********OPIN      IFEQ 'Y'                                       031876
     C************         GOTO PREND                                     031876
     C************         END                                            031876
     C**IF*ORDERING BANK IS NOT NOSTRO GO TO PRENDE                       031876
     C***********SORBT     IFNE 'N'                        B001           031876
     C**CHECK*FOR*POSSIBLE ACCOUNT NUMBER NOSTROS                         031876
     C************         MOVE SORBT     NTYPE   1                       031876
     C************         MOVELSORBK     RTNO                            031876
     C************         MOVE SSMCY     NCCY    3                       031876
     C************         MOVE SORBB     BRCANP                          S01117
     C************         EXSR NOSTRO                                    031876
     C************         ELSE                            X001           031876
     C************         SETON                     49                   031876
     C************         MOVE SSMCY     CCY                             031876
     C************         MOVELSORBK     NOSN                            031876
     C************         END                             E001           031876
     C***49*******         DO                              B001           031876
     C***STORE*ORIGINAL NOSTRO NO. IN CASE UNALLOCATED NOSTRO NO USED     E32536
     C************                                                        E32536
     C************         Z-ADDNOSN      NOSOR                           E32536
     C***********PKEY      CHAINPRONOPNF             88                   031876
     C**IF*NOSTRO*NOT ON FILE READ '00' NUMBER RECORD                     031876
     C***88*******         DO                              B001           031876
     C************         MOVE '00'      NOSN                            031876
     C***********PKEY      CHAINPRONOPNF             88                   031876
     C***88*******         GOTO PRNDA                                     031876
     C************         END                             E001           031876
     C**IF*SETTLE*DATE GREATER THAN DATE 5 IGNORE                         031876
     C***********SSLDT     IFGT PDT,5                      B001           031876
     C************         EXCPTRPRONO                                    031876
     C************         GOTO PRNDA                                     031876
     C************         END                             E001           031876
     C**USE*LOKUP*TO FIND DATE TO START FROM                              031876
     C************         Z-ADD1         Q       30                      031876
     C***********SSLDT     LOKUPPDT,Q                70  71               031876
     C***70******Q         IFGT 1                          B002           031876
     C************         SUB  1         Q                               031876
     C************         END                             E002           031876
     C************         Z-ADDPNV       PNO                             031876
     C***********Q         DOUGT5                          B002           031876
     C************         ADD  SSMAM     PNV,Q                           031876
     C************         ADD  1         Q                               031876
     C************         END                             E002           031876
     C************         UPDATPRONOPNF                                  031876
     C************         Z-ADDSSLDT     VUDT                            031876
     C************         Z-ADDSSMAM     MVAM                            031876
     C************         SETON                     60                   031876
     C************                                                        S01195
     C***Set*up*location from nostro location                             S01195
     C************                                                        S01195
     C************         MOVE NLOC      ZLOC                            S01195
     C************                                                        S01195
     C************                                                        S01195
     C***IN*CASE*UNALLOCATED NOSTRO USED FOR PRONO REINSTATE ORIGINAL     E32536
     C***NOSTRO*NUMBER TO PREVENT DB ERROR IN AMOVTS                      E32536
     C************                                                        E32536
     C************         Z-ADDNOSOR     NOSN                            E32536
     C************         EXSR AMOVTS                                    031876
     C************         END                             E001           031876
     C***********PRNDA     TAG                             ** PRNDA       031876
     C**IF*ORDERING BANK IS BLANK USE ORDERING CUSTOMER                   031876
     C***********SORBT     IFNE *BLANK                     B001           031876
     C************         GOTO PREND                                     031876
     C************         END                             E001           031876
     C**CHECK*FOR*POSSIBLE ACCOUNT NUMBER NOSTROS                         031876
     C************         MOVE SORCT     NTYPE   1                       031876
     C************         MOVELSORC1     RTNO                            031876
     C************                                                        S01117
     C***If*non*multi branched and partial account,set up branch          S01117
     C***field*with single branch                                         S01117
     C************                                                        S01117
     C***********@MBIN     IFEQ 'N'                                       S01117
     C***********SORCT     ANDEQ'P'                                       S01117
     C************         MOVE BJSBRC    BRCANP                          S01117
     C************         END                                            S01117
     C************         MOVE SSMCY     NCCY    3                       031876
     C************         EXSR NOSTRO                                    031876
     C***49*******         DO                              B001           031876
     C***STORE*ORIGINAL NOSTRO NO. IN CASE UNALLOCATED NOSTRO NO USED     E32536
     C************                                                        E32536
     C************         Z-ADDNOSN      NOSOR                           E32536
     C***********PKEY      CHAINPRONOPNF             88                   031876
     C**IF*NOSTRO*NOT ON FILE READ '00' NUMBER RECORD                     031876
     C***88*******         DO                              B002           031876
     C************         MOVE '00'      NOSN                            031876
     C************         SETOF                     88                   031876
     C***********PKEY      CHAINPRONOPNF             88                   031876
     C***88*******         GOTO PREND                                     031876
     C************         END                             E002           031876
     C**IF*SETTLE*DATE GREATER THAN DATE 5 IGNORE                         031876
     C***********SSLDT     IFGT PDT,5                      B002           031876
     C************         EXCPTRPRONO                                    031876
     C************         GOTO PREND                                     031876
     C************         END                             E002           031876
     C**USE*LOKUP*TO FIND DATE TO START FROM                              031876
     C************         Z-ADD1         Q       30                      031876
     C***********SSLDT     LOKUPPDT,Q                70  71               031876
     C***70******Q         IFGT 1                          B002           031876
     C************         SUB  1         Q                               031876
     C************         END                             E002           031876
     C************         Z-ADDPNV       PNO                             031876
     C***********Q         DOUGT5                          B002           031876
     C************         ADD  SSMAM     PNV,Q                           031876
     C************         ADD  1         Q                               031876
     C************         END                             E002           031876
     C************         UPDATPRONOPNF                                  031876
     C************         Z-ADDSSLDT     VUDT                            031876
     C************         Z-ADDSSMAM     MVAM                            031876
     C************         SETON                     60                   031876
     C************                                                        S01195
     C***Set*up*location from nostro location                             S01195
     C************                                                        S01195
     C************         MOVE NLOC      ZLOC                            S01195
     C************                                                        S01195
     C************                                                        S01195
     C***IN*CASE*UNALLOCATED NOSTRO USED FOR PRONO REINSTATE ORIGINAL     E32536
     C***NOSTRO*NUMBER TO PREVENT DB ERROR IN AMOVTS                      E32536
     C************                                                        E32536
     C************         Z-ADDNOSOR     NOSN                            E32536
     C************         EXSR AMOVTS                                    031876
     C************         END                             E001           031876
     C************                                                        031876
     C***********PREND     ENDSR                           ** PREND       031876
     C************                                                        031876
     C************************************************************        031876
     C**END*OF*UPDATES OF PRONO AND OLPOS                                 031876
     C************************************************************        031876
     C/EJECT
     C*****************************************************************
     C*
     C*  ADCHK SUBROUTINE - TO VALIDATE ADDRESS FIELDS
     C*
     C*****************************************************************
     C*
     C           ADCHK     BEGSR
     C*
     C* THERE SHOULD BE NO EMBEDDED SPACES
     C*
     C           ADCHK1    IFEQ *BLANK                                    E37171
     C           ADCHK2    ANDNE*BLANK                                    E37171
     C*                                                                   E37171
     C           ADCHK1    OREQ *BLANK                                    E37171
     C           ADCHK3    ANDNE*BLANK                                    E37171
     C*                                                                   E37171
     C           ADCHK1    OREQ *BLANK                                    E37171
     C           ADCHK4    ANDNE*BLANK                                    E37171
     C*                                                                   E37171
     C           ADCHK1    OREQ *BLANK                                    E37171
     C           ADCHK5    ANDNE*BLANK                                    E37171
     C*                                                                   E37171
     C***********ADCHK2    IFEQ *BLANK                                    E37171
     C***********ADCHK3    ANDNE*BLANK                                    E37171
     C***********                                                         E37171
     C           ADCHK2    OREQ *BLANK                                    E37171
     C           ADCHK3    ANDNE*BLANK                                    E37171
     C*                                                                   E37171
     C           ADCHK2    OREQ *BLANK
     C           ADCHK4    ANDNE*BLANK
     C*
     C           ADCHK2    OREQ *BLANK
     C           ADCHK5    ANDNE*BLANK
     C*
     C           ADCHK3    OREQ *BLANK
     C           ADCHK4    ANDNE*BLANK
     C*
     C           ADCHK3    OREQ *BLANK
     C           ADCHK5    ANDNE*BLANK
     C*
     C           ADCHK4    OREQ *BLANK
     C           ADCHK5    ANDNE*BLANK
     C*
     C                     SETON                     92
     C*
     C                     END
     C*
     C** CHECK FOR NON-VALID SWIFT CHARACTERS
     C*
     C           ADCHK1    IFNE *BLANKS
     C                     MOVEA*BLANKS   FLD
     C                     MOVE ADCHK1    FLD
     C                     EXSR SWSET
     C           *IN94     IFEQ '0'
     C*********************MOVEA' 500'    ERCD,Z                          S01117
     C                     MOVEA' 025'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     Z-ADD1         PHW     50                      140640
     C                     SETON                     93
     C                     END
     C                     END
     C**
     C           ADCHK2    IFNE *BLANKS
     C                     MOVEA*BLANKS   FLD
     C                     MOVE ADCHK2    FLD
     C                     EXSR SWSET
     C           *IN94     IFEQ '0'
     C*********************MOVEA' 501'    ERCD,Z                          S01117
     C                     MOVEA' 026'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     Z-ADD1         PHW     50                      140640
     C                     SETON                     93
     C                     END
     C                     END
     C**
     C           ADCHK3    IFNE *BLANKS
     C                     MOVEA*BLANKS   FLD
     C                     MOVE ADCHK3    FLD
     C                     EXSR SWSET
     C           *IN94     IFEQ '0'
     C*********************MOVEA' 502'    ERCD,Z                          S01117
     C                     MOVEA' 027'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     Z-ADD1         PHW     50                      140640
     C                     SETON                     93
     C                     END
     C                     END
     C**
     C           ADCHK4    IFNE *BLANKS
     C                     MOVEA*BLANKS   FLD
     C                     MOVE ADCHK4    FLD
     C                     EXSR SWSET
     C           *IN94     IFEQ '0'
     C*********************MOVEA' 503'    ERCD,Z                          S01117
     C                     MOVEA' 028'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     Z-ADD1         PHW     50                      140640
     C                     SETON                     93
     C                     END
     C                     END
     C**
     C           ADCHK5    IFNE *BLANKS
     C                     MOVEA*BLANKS   FLD
     C                     MOVE ADCHK5    FLD
     C                     EXSR SWSET
     C           *IN94     IFEQ '0'
     C                     SETON                     93
     C*********************MOVEA' 504'    ERCD,Z                          S01117
     C                     MOVEA' 029'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     Z-ADD1         PHW     50                      140640
     C                     END
     C                     END
     C*
     C                     ENDSR
     C*
     C************************************************************
     C/EJECT
     C************************************************************
     C* SUBROUTINE SWSET CHECK FOR VALID SWIFT CHARACTER USED
     C*   IND '19' IS SET BY AN INVALID CHARACTER IN SWCH
     C*
     C           SWSET     BEGSR                           *** SWSET ****
     C*
     C                     Z-ADD1         R       20
     C                     MOVE '1'       *IN94
     C*
     C                     MOVEA*BLANK    TST
     C*
     C           FLD,1     IFNE *BLANK                     B002
     C                     MOVEAFLD       TST
     C                     Z-ADD1         R
     C*
     C           R         DOWLE35                         B003
     C*
     C           TST,R     IFNE ' '                        B004
     C           TST,R     LOKUPSWCH                     94
     C*
     C           *IN94     IFEQ '0'                        B005
     C                     GOTO ENDLP
     C                     END                             E005
     C                     END                             E004
     C                     ADD  1         R
     C                     END                             E003
     C                     END                             E002
     C           ENDLP     TAG
     C*
     C                     ENDSR
     C*
     C********************************************************************
     C/EJECT
      ************                                                        031876
      ************  Remove PRONO OLPOS and MEMOS                          031876
      ************                                                        031876
     C************************************************************        031876
     C**AMOVT*SUBROUTINE - TO WRITE TO ACCOUNT MOVEMENTS FILE             031876
     C************************************************************        031876
     C************                                                        031876
     C***********AMOVTS    BEGSR                                          031876
     C************                                                        031876
     C***IF*PRONO*RECORD PROCESSED                                        031876
     C************                                                        031876
     C************IN60     IFEQ '1'                        B001           031876
     C************                                                        031876
     C***ACCESS*FULL A/C DETAILS                                          031876
     C************                                                        031876
     C*********************MOVE *BLANK    KEY                             S01194
     C*********************MOVEL'70'      KEY                             S01194
     C*********************MOVELCCY       NOSWRK  5                       S01194
     C*********************MOVE NOSN      NOSWRK                          S01194
     C*********************MOVE NOSWRK    KEY                             S01194
     C***********KEY*******CHAINTABLETLF             75                   S01194
     C**N75******RECI******COMP 'D'                  7575                 S01194
     C*********************                                               S01194
     C************IN75*****IFEQ '1'                                       S01194
     C************LOCK*****IN   DLDA                                      S01194
     C*********************MOVE 'FT0040  'DBPGM                           S01194
     C*********************MOVE 'TABLETL' DBFILE           ***************S01194
     C*********************Z-ADD33        DBASE            * DB ERROR 33 *S01194
     C*********************MOVELZTABKY    DBKEY            *********** ***S01194
     C*********************OUT  DLDA                                      S01194
     C*********************SETON                     U7U8LR               S01194
     C*********************DUMP                                           S01194
     C*********************RETRN                                          S01194
     C*********************END                             E002           S01194
     C************                                                        S01194
     C************         CALL 'AONOSTR0'                                S01194
     C************         PARM '*DBERR ' RTCD                            S01194
     C************         PARM '*KEY   ' @OPTN                           S01194
     C************         PARM *BLANKS   @CUST                           S01194
     C************         PARM CCY       @CYCD                           S01194
     C************         PARM *BLANKS   @ACCD                           S01194
     C************         PARM *BLANKS   @ACSN                           S01194
     C************         PARM NOSNA     @NONB                           S01194
     C************         PARM *BLANKS   @BRCD                           S01194
     C************         PARM *BLANKS   @CSSN                           S01194
     C************         PARM *BLANKS   @PNOI                           S01194
     C***********SDNOST    PARM SDNOST    DSFDY                           S01194
     C************                                                        S01194
     C************         EXSR MVNOST                                    S01194
     C************         MOVE NLOC      ZLOC                            S01194
     C************                                                        S01194
     C************                                                        031876
     C************         XFOOTPNO       TOT1   150                      031876
     C************         XFOOTPNV       TOT2   150                      031876
     C**IF*NOSTRO*BALANCES INCREASED                                      031876
     C***********TOT1      IFLT TOT2                       B002           031876
     C************         MOVE '0'       DORC                            031876
     C************         ELSE                            X002           031876
     C**IF*NOSTRO*BALANCES DECREASED                                      031876
     C***********TOT1      IFGT TOT2                       B003           031876
     C************         MOVE '1'       DORC                            031876
     C************         END                             E003           031876
     C************         END                             E002           031876
     C************                                                        031876
     C***IF*MEMO*RECORD PROCESSED                                         031876
     C************                                                        031876
     C************         ELSE                            X001           031876
     C**IF*LEDGER*BALANCE INCREASED                                       031876
     C***********LDBLWK    IFLT MMLDBL                     B002           031876
     C************         MOVE '0'       DORC                            031876
     C************         ELSE                            X002           031876
     C**IF*LEDGER*BALANCE DECREASED                                       031876
     C***********LDBLWK    IFGT MMLDBL                     B003           031876
     C************         MOVE '1'       DORC                            031876
     C************         END                             E003           031876
     C************         END                             E002           031876
     C************         END                             E001           031876
     C************                                                        031876
     C************         MOVE VUDT      PTDT                            031876
     C**SETUP*VALUE DATE OF ENTRY                                         031876
     C************IN94*****DOUNE'1'                        B001           S01194
     C*********************SETOF                       9394               S01194
     C*********************MOVEL'22    '  ZTABKY                          S01194
     C*********************MOVELPTDT      ZWRK6                           S01194
     C*********************MOVE 1         ZWRK6                           S01194
     C*********************MOVE ZWRK6     ZTABKY                          S01194
     C***********ZTABKY****CHAINTABLETJF             93                   S01194
     C**N93******RECI******COMP '*'                      93               S01194
     C************IN93*****IFEQ '0'                        B002           S01194
     C*********************SUB  1         PTDT                            S01194
     C*********************MOVEAHCCY      HCC                             S01194
     C***********CCY*******LOKUPHCC,1                    94               S01194
     C************IN94*****IFEQ '1'                        B003           S01194
     C**IF*THE*PARTY INVOLVED IS A NOSTRO (EITHER DIRECTLY ENTERED        S01195
     C**OR*BACKGROUND) USE RELEVANT CCY AND NOSTRO LOCATION CODE, ELSE    S01195
     C**USE*SYSTEM LOCATION AND LOCAL CURRENCY                            S01195
     C************                                                        S01195
     C***********NOWRK     IFEQ 'N'                                       S01195
     C************IN60     OREQ '1'                                       S01195
     C************         MOVE CCY       ZCCY                            S01195
     C************         ELSE                                           S01195
     C************         MOVE BJLCCY    ZCCY                            S01195
     C************         END                                            S01195
     C************                                                        S01195
     C***********ZIND      DOUNE'H'                                       S01194
     C************         MOVE PTDT      ZDAYNO                          S01194
     C************         EXSR ZCHKH                                     S01194
     C***********ZIND      IFEQ 'H'                                       S01194
     C************         SUB  1         PTDT                            S01194
     C************         END                             E003           031876
     C*********************END                             E002           S01194
     C************         END                             E001           031876
     C************         Z-ADDCNUM      CUSN                            031876
     C************         MOVE CCY       CCYD                            031876
     C************         Z-ADDACOD      ACDE                            031876
     C************         Z-ADDACSQ      ASNC                            031876
     C************         MOVE PYTP      TRYP                            031876
     C************         MOVE PREF      TNMR                            031876
     C************         MOVE PREF      FUND                            E32880
     C**WRITE*DETAILS TO FILE                                             031876
     C************                                                        031876
     C**AS*DORC*CONTROLS DEBIT/CREDIT,ENTRY MUST ALWAYS BE                031876
     C**INHERENTLY POSITIVE                                               031876
     C************                                                        031876
     C***********MVAM      IFLT *ZERO                                     031876
     C************         Z-SUBMVAM      MVAM                            031876
     C************         END                                            031876
     C************         WRITERSACMTPO                                  031876
     C************         SETOF                     609394               031876
     C************                                                        031876
     C************         ENDSR                                          031876
     C************                                                        031876
     C************************************************************        031876
     C/EJECT
     C************************************************************
     C* TYPE SR.
     C* TO VALIDATE PAYMENT TYPE
     C* MANDATORY MUST BE 'OP' OR 'RP'
     C*
     C           TYPE      BEGSR
     C*
     C           SPYTP     IFEQ *BLANK                     B001
     C                     SETON                     2289
     C*********************MOVEA' 136'    ERCD,Z                          S01117
     C                     MOVEA' 010'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     Z-ADD1         PHW     50                      140640
     C                     ELSE                            X001
     C           SPYTP     IFNE 'OP'                       B002
     C           SPYTP     ANDNE'RP'
     C                     SETON                     2289
     C*********************MOVEA' 023'    ERCD,Z                          S01117
     C                     MOVEA' 009'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     Z-ADD1         PHW     50                      140640
     C                     END                             E002
     C                     END                             E001
     C*
     C                     ENDSR
     C*
     C************************************************************
     C* END OF VALIDATION OF PAYMENT TYPE
     C************************************************************
     C/EJECT
     C************************************************************
     C* SUBTYP SR.
     C* VALIDATION OF PAYMENT SUB-TYPE
     C* MANDATORY MUST BE AS FOUND IN *T*A*B*L*E*T*5* SDDLSTPD            S01194
     C*
     C           SUBTYP    BEGSR
     C*
     C           SPYST     IFEQ *BLANK                     B001
     C                     SETON                     2389
     C*********************MOVEA' 137'    ERCD,Z                          S01117
     C                     MOVEA' 012'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     Z-ADD1         PHW     50                      140640
     C                     ELSE                            X001
     C*********************MOVE *BLANK    KEY                             S01194
     C*********************MOVEL'42'      KEY                             S01194
     C*********************MOVE SPYST     KEY                             S01194
     C***********KEY*******CHAINTABLET5F             23                   S01194
     C**N23******RECI******COMP 'D'                  2323                 S01194
     C*                                                                   S01194
     C                     CALL 'AODLSTR0'                                S01194
     C                     PARM *BLANKS   RTCD                            S01194
     C                     PARM '*VERIFY' @OPTN                           S01194
     C                     PARM SPYST     @DSTC                           S01194
     C           SDDLST    PARM *BLANKS   DSFDY                           S01194
     C*                                                                   S01194
     C           RTCD      COMP *BLANKS              2323                 S01194
     C*                                                                   S01194
     C           *IN23     IFEQ '0'                                       093958
     C*                                                                   093958
     C** Check in Deal type/Sub type file if combination exists           093958
     C*                                                                   093958
     C           @DTSTK    CHAINFDDTSTL1             23                   093958
     C           *IN23     IFEQ '0'                                       093958
     C           RCID11    ANDEQ'*'                                       093958
     C                     MOVE '1'       *IN23                           093958
     C                     END                                            093958
     C                     END                                            093958
     C*                                                                   093958
     C   23                DO                              B002
     C                     SETON                     89
     C*********************MOVEA' 024'    ERCD,Z                          S01117
     C                     MOVEA' 011'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     Z-ADD1         PHW     50                      140640
     C                     END                             E002
     C                     END                             E001
     C*
     C                     ENDSR
     C*
     C************************************************************
     C* END OF VALIDATION OF PAYMENT SUB-TYPE
     C************************************************************
     C/EJECT                                                              S01435
      *****************************************************************   S01435
      *                                                               *   S01435
      *  SRBRCA   : Validate Booking Branch on detail screen          *   S01435
      *                                                               *   S01435
      *  CALLED BY: VALTWO                                            *   S01435
      *                                                               *   S01435
      *  CALLS    : AOBRCHR0                                          *   S01435
      *             ZVACTBU                                           *   S01435
      *                                                               *   S01435
      *****************************************************************   S01435
     CSR         SRBRCA    BEGSR                                          S01435
      *                                                                   S01435
      *  Set up subroutine stack name                                     S01435
      *                                                                   S01435
     C                     ADD  1         Q                               S01435
     C                     MOVEL'SRBRCA'  @STK,Q                          S01435
      *                                                                   S01435
     C           SBRCA     IFEQ *BLANKS                                   S01435
     C           BRSEL     ANDNE'NOSEL'                                   S01435
     C                     MOVE @DFBR     SBRCA                           S01435
     C                     END                                            S01435
      *                                                                   S01435
      * Read SDBRCHPD to validate screen branch code                      S01435
      *                                                                   S01435
     C**********           CALL 'AOBRCHR0'                                             S01435 CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM *BLANKS   RTCD                            S01435
     C                     PARM '*KEY   ' @OPTN                           S01435
     C                     PARM SBRCA     @BRCD   3                       S01435
     C********** SDBRCH    PARM SDBRCH    DSFDY                                        S01435 CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C*                                                                   S01435
     C           RTCD      IFNE *BLANKS                                   S01435
     C                     SETON                     5689                 S01435
     C                     MOVEA' 006'    ERCD,Z                          S01435
     C                     ADD  1         Z                               S01435
     C                     Z-ADD1         PHW     50                      140640
     C                     ELSE                                           S01435
      *                                                                   S01435
      * Check user is authorised to perform action code on Booking branch S01435
      *                                                                   S01435
     C                     CALL 'ZVACTBU'                                 S01435
     C                     PARM ACTION    @ACTN   1                       S01435
     C                     PARM SBRCA     @BRCD   3                       S01435
     C                     PARM 0         ERR     10                      S01435
      *                                                                   S01435
      * User not authorised to any action codes for this item and branch  S01435
      *                                                                   S01435
     C           ERR       IFEQ 1                                         S01435
     C                     SETON                     5689                 S01435
     C                     MOVEA' 303'    ERCD,Z                          S01435
     C                     ADD  1         Z                               S01435
     C                     Z-ADD1         PHW     50                      140640
     C                     END                                            S01435
      *                                                                   S01435
      * User not authorised to action code for this particular item       S01435
      * and branch                                                        S01435
      *                                                                   S01435
     C           ERR       IFEQ 2                                         S01435
     C                     SETON                     5689                 S01435
     C                     MOVEA' 304'    ERCD,Z                          S01435
     C                     ADD  1         Z                               S01435
     C                     Z-ADD1         PHW     50                      140640
     C                     END                                            S01435
      *                                                                   S01435
     C                     END                                            S01435
      *                                                                   S01435
      *  Unwind subroutine stack name                                     S01435
      *                                                                   S01435
     C           EXBRCA    TAG                                            S01435
     C                     MOVEA*BLANKS   @STK,Q                          S01435
     C                     SUB  1         Q       50                      S01435
      *                                                                   S01435
     CSR                   ENDSR                                          S01435
      *                                                                   S01435
     C/EJECT
     C************************************************************
     C* ORBRCH SR.                                                        S01117
     C* Validation of originating branch entry (SORBR)                    S01117
     C* and user authority to it                                          S01117
     C*                                                                   S01117
     C           ORBRCH    BEGSR                                          S01117
     C*                                                                   S01117
     C           SORBR     IFEQ *BLANKS                                   S01117
     C           ORSEL     ANDNE'NOSEL'                                   S01195
     C                     MOVE SBRCA     SORBR                           S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C** Validate SORBR entry is valid branch                             S01117
     C*                                                                   S01117
     C**********           CALL 'AOBRCHR0'                                             S01117 CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM *BLANKS   RTCD                            S01117
     C                     PARM '*KEY   ' @OPTN                           S01117
     C                     PARM SORBR     @BRCD                           S01117
     C********** SDBRCH    PARM SDBRCH    DSFDY                                        S01117 CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C*                                                                   S01117
     C** If error......                                                   S01117
     C*                                                                   S01117
     C           RTCD      IFNE *BLANKS                                   S01117
     C                     SETON                     5989                 S01117
     C                     MOVEA' 008'    ERCD,Z                          S01117
     C                     ADD  1         Z                               S01117
     C                     Z-ADD1         PHW     50                      140640
     C                     END                                            S01117
     C*                                                                   S01117
     C** If originating branch validation required and no                 S01117
     C** error on branch code input                                       S01117
     C*                                                                   S01117
     C           *IN59     IFEQ '0'                                       S01117
     C           BKOBUV    ANDEQ'Y'                                       S01117
     C                     CALL 'ZVOBU'                                   S01117
     C                     PARM SORBR     ZOBRX   3                       S01117
     C                     PARM 0         ERR                             S01117
     C*                                                                   S01117
     C           ERR       IFEQ 1                                         S01117
     C                     SETON                     5989                 S01117
     C                     MOVEA' 305'    ERCD,Z                          S01117
     C                     ADD  1         Z                               S01117
     C                     Z-ADD1         PHW     50                      140640
     C                     END                                            S01117
     C*                                                                   S01117
     C           ERR       IFEQ 2                                         S01117
     C                     SETON                     5989                 S01117
     C                     MOVEA' 306'    ERCD,Z                          S01117
     C                     ADD  1         Z                               S01117
     C                     Z-ADD1         PHW     50                      140640
     C                     END                                            S01117
     C*                                                                   S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     ENDSR                                          S01117
     C*                                                                   S01117
     C************************************************************        S01117
     C* END OF ORBRCH SUBROUTINE                                          S01117
     C************************************************************        S01117
     C/EJECT                                                              S01117
     C************************************************************        S01117
     C* DESTIN SR.
     C* VALIDATE DESTINATION
     C*
     C** If '?' found do not validate, display error code.                S01194
     C*                                                                   S01194
     C           DESTIN    BEGSR
     C/COPY WNCPYSRC,FT0040C084
     C                     MOVEA*BLANKS   WRKA                            S01117
     C                     MOVEASDST1     WRKA                            S01117
     C                     SETOF                     64                   S01117
     C           '?'       LOKUPWRKA                     64               S01117
     C*                                                                   S01117
     C           *IN64     IFNE '1'                                       S01117
     C/COPY WNCPYSRC,FT0040C130
     C*
     C                     MOVE *BLANK    SDSTT
     C                     MOVE *BLANK    ACST1   1                       047179
     C                     Z-ADD0         DSOPN   50
     C*
     C* IF NOT ENTERED MOVE NOSTRO OF PAY CURRENCY '01'
     C*
     C           SPCCY     IFNE *BLANK                     B002
     C                     MOVELSPCCY     NCURR   3
     C                     ELSE                            X002
     C                     MOVELSSMCY     NCURR
     C                     END                             E002
      *                                                                   S01408
     C/COPY WNCPYSRC,FT0040CCPG                                           S01408
      *                                                                   S01408
      *
      * If settlement type 13 Destination must be NOSTRO.
      *
     C           SSTTP     IFEQ '13'                       B001
     C           D5R       ANDNE*BLANK
     C                     SETON                     2489
     C*********************MOVEA' 382'    ERCD,Z                          S01117
     C                     MOVEA' 023'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     Z-ADD1         PHW     50                      140640
     C                     GOTO DESEND
     C                     END                             E001
      *                                                                   S01408
     C/COPY WNCPYSRC,FT0040CCP1                                           S01408
      *                                                                   S01408
     C*
     C*  IF MORE THAN 5 CHAR ENTERED CANNOT BE A NOSTRO
     C           D5R       IFNE *BLANK                     B001
     C                     GOTO DESNUM
     C                     END                             E001
     C*********************MOVE *BLANK    KEY                             S01194
     C*********************MOVEL'70'      KEY                             S01194
     C*********************MOVE DNOS      KEY                             S01194
     C***********KEY*******CHAINTABLETLF             88                   S01194
     C**N88******RECI******COMP 'D'                  8888                 S01194
     C*                                                                   S01194
     C                     CALL 'AONOSTR0'                                S01194
     C                     PARM *BLANKS   RTCD                            S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM *BLANKS   @CUST                           S01194
     C                     PARM NCUR      @CYCD                           S01194
     C                     PARM *BLANKS   @ACCD                           S01194
     C                     PARM *BLANKS   @ACSN                           S01194
     C***********          PARM NNUM      @NONB                           S01194
     C                     PARM NNUM      @NONB   2                 S01194031876
     C                     PARM *BLANKS   @BRCD                           031876
     C                     PARM *BLANKS   @CSSN                           S01194
     C                     PARM *BLANKS   @PNOI                           S01194
     C           SDNOST    PARM SDNOST    DSFDY                           S01194
     C*                                                                   S01194
     C           RTCD      CASEQ*BLANKS   MVNOST     8888                 S01194
     C                     END                                            S01194
     C/COPY WNCPYSRC,FT0040C176
     C*                                                                   S01194
      *
      ** If settlement type 13 Destination must be NOSTRO.
     C           SSTTP     IFEQ '13'
     C           *IN88     ANDEQ'1'
     C                     SETON                     2489
     C*********************MOVEA' 382'    ERCD,Z                          S01117
     C                     MOVEA' 023'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     Z-ADD1         PHW     50                      140640
     C                     GOTO DESEND
     C                     END
     C*
     C* NOT A NOSTRO BUT MAYBE THE NAME GO TO DESNAM
      *                                                                   S01408
     C/COPY WNCPYSRC,FT0040CCP2                                           S01408
      *                                                                   S01408
     C   88                GOTO DESNAM
     C*
     C* IS A NOSTRO
     C/COPY WNCPYSRC,FT0040C025
     C* IF SENDER'S CORRESPONDENT IS BLANK CURRENCY MUST EQUAL PAY
     C* CURRENCY
     C* FIND IF RETAIL
     C                     MOVELDNOS      CCY
     C                     EXSR ACCRED
     C                     MOVE ACST      ACST1                           047179
      *
     C           ATYP      IFEQ 'R'                        B001
     C                     Z-ADDDACO      DSOPN
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0040CP29                                           S01408
     C*                                                                   S01408
     C                     END                             E001
     C                     MOVE RETB      DRETB                           179420
      *
     C           SSNCO     IFEQ *BLANK                     B001
     C           NCUR      ANDNENCURR
     C/COPY WNCPYSRC,FT0040C177
     C                     SETON                     2489
     C*********************MOVEA' 026'    ERCD,Z                          S01117
     C                     MOVEA' 013'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     Z-ADD1         PHW     50                      140640
     C                     ELSE                            X001
     C                     MOVE 'F'       SDSTT
     C                     END                             E001
      *
     C                     GOTO DESEND
      *
     C           DESNUM    TAG                             ** DESNUM
      *                                                                   S01408
     C/COPY WNCPYSRC,FT0040CCP3                                           S01408
      *                                                                   S01408
     C* IF MORE THAN 6 CHAR HAVE BEEN ENTERED CANNOT BE A CUST NUMBER
      *
     C           D6R       IFNE *BLANK                     B001
     C                     GOTO DESRET
     C                     END                             E001
      *
     C                     MOVELDNUM      NUML    70
     C                     MOVELNUML      NUMA    6
     C           DNUM      IFNE NUMA                       B001
     C                     SETON                     24
     C                     ELSE                            X001
     C                     MOVE DNUM      CNUM
     C*                                                                   S01194
     C***********CNUM******CHAINCLINTCBF             24                   S01194
     C*********************END                             E001           S01194
     C**N24******RECI******COMP 'D'                  2424                 S01194
     C                     CALL 'AOCUSTR0'                                S01194
     C                     PARM *BLANKS   RTCD                            S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM CNUMA     @KEY1                           S01194
     C                     PARM *BLANKS   @KYST                           S01194
     C           SDCUST    PARM SDCUST    DSSDY                           S01194
     C*                                                                   S01194
     C           RTCD      COMP *BLANKS              2424                 S01194
     C*                                                                   S01194
     C           @KYST     IFNE '*CNUM  '                                 S01194
     C                     SETON                     24                   S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C                     END                             E001           S01194
     C*
     C           *IN24     IFEQ '1'                        B001
     C                     SETON                     89
     C*********************MOVEA' 031'    ERCD,Z                          S01117
     C                     MOVEA' 018'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     Z-ADD1         PHW     50                      140640
     C                     ELSE                            X001
      *                                                                   S01408
     C/COPY WNCPYSRC,FT0040CCP4                                           S01408
      *                                                                   S01408
     C                     MOVE 'C'       SDSTT
     C                     EXSR MVCUST                                    S01194
     C                     END                             E001
     C*                                                                   S01194
     C/COPY WNCPYSRC,FT0040C026
     C                     GOTO DESEND
     C           DESRET    TAG                             ** DESRET
     C* IF MORE THAN 10 CHAR HAVE BEEN ENTERED CANNOT BE A RETAIL NUMB
     C           D10R      IFNE *BLANK                     B001
     C                     GOTO DESACC
     C                     END                             E001
     C*
     C                     MOVELDRET      RETL
     C                     MOVELRETL      RETA
     C           DCUS      IFEQ RETA                       B001
     C*
     C** CHECK TO SEE WHETHER A RETAIL ACCOUNT NUMBER IS ALLOWED
     C*
     C***********RACN******IFEQ 'N'                                       S01194
     C           BMRANR    IFEQ 'N'                                       S01194
     C                     SETON                     2489
     C*********************MOVEA' 414'    ERCD,Z                          S01117
     C                     MOVEA' 020'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     Z-ADD1         PHW     50                      140640
     C                     ELSE
     C*
     C                     MOVE DRET      ACNO
     C           ACNO      CHAINACNUMAF              24
     C  N24      RECI      COMP 'D'                  2424
     C           *IN24     IFEQ '0'                                                           189639
     C**********           Z-ADDRETNUM    CNUM                                         189639 CSD027
     C                     MOVE RETNUM    CNUM                                                CSD027
     C                     ENDIF                                                              189639
     C           *IN24     IFEQ '1'                        B002
     C                     SETON                     89
     C*********************MOVEA' 027'    ERCD,Z                          S01117
     C                     MOVEA' 014'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     Z-ADD1         PHW     50                      140640
     C                     ELSE                            X002
     C* STORE VALUE FOR USE WITH SENDER'S CORRESPONDENT CHECK IN
     C* SNDCOR SUBROUTINE
     C                     MOVE CCY       CCYSTO  3
     C* IF SENDER'S CORRESPONDENT IS BLANK CURRENCY MUST EQUAL PAY
     C* CURRENCY
     C           SPCCY     IFEQ *BLANK
     C                     MOVE SSMCY     SPCCY
     C                     END
     C           SSNCO     IFEQ *BLANK                     B003
     C           CCY       ANDNESPCCY
     C/COPY WNCPYSRC,FT0040C178
     C                     SETON                     2489
     C*********************MOVEA' 028'    ERCD,Z                          S01117
     C                     MOVEA' 015'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     Z-ADD1         PHW     50                      140640
     C                     END                             E003
     C                     END                             E002
      *
     C  N24                MOVE 'R'       SDSTT
     C  N24                MOVE ACST      ACST1                           047179
      *
     C  N24      ATYP      IFEQ 'R'                        B001
     C                     Z-ADDDACO      DSOPN
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0040CP30                                           S01408
     C*                                                                   S01408
     C                     END                             E001
      *                                                                   179420
     C           *IN24     IFEQ '0'                                       179420
     C                     MOVE RETB      DRETB   1                       179420
     C                     ENDIF                                          179420
      *
     C                     END
      *
     C                     GOTO DESEND
     C                     END                             E001
      *
     C           DESNAM    TAG                             ** DESNAM
     C* CHECK IF NAME
     C                     MOVE DCUS      CSNM
     C***********CSNM******CHAINSNAMEF               24                   S01194
     C**N24******RECI******COMP 'D'                  2424                 S01194
     C                     CALL 'AOCUSTR0'                                S01194
     C                     PARM *BLANKS   RTCD                            S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM CSNM      @KEY1  10                       S01194
     C                     PARM *BLANKS   @KYST   7                       S01194
     C           SDCUST    PARM SDCUST    DSSDY                           S01194
     C*                                                                   S01194
     C           RTCD      COMP *BLANKS              2424                 S01194
     C*                                                                   S01194
     C           *IN24     IFEQ '1'                        B001
     C           @KYST     ORNE '*CSHT  '                                 S01194
      *                                                                   068230
      * Check that it is not a SWIFT address                              068230
      *                                                                   068230
     C**********           MOVELSDST1     CLSWTK 12                                    068230 CGL029
     C                     MOVELSDST1     CLSWTK 18                                           CGL029
     C                     MOVEA*IN,31    ##002   2                       068230
      *                                                                   068230
     C                     EXSR SWIFT                                     068230
      *                                                                   068230
     C           ##CSID    IFEQ 'Y'                                       068230
     C           *IN31     ANDEQ'0'                                       068230
     C           *IN32     ANDEQ'0'                                       068230
     C                     MOVEL'S'       SDSTT                           068230
     C                     MOVEL'0'       *IN24                           068230
     C                     MOVEA##002     *IN,31                          068230
     C                     GOTO DESEND                                    068230
     C                     END                                            068230
      *                                                                   068230
     C                     MOVEA##002     *IN,31                          068230
      *                                                                   068230
     C                     SETON                     89
     C*********************MOVEA' 031'    ERCD,Z                          S01117
     C                     MOVEA' 018'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     Z-ADD1         PHW     50                      140640
     C                     ELSE                            X001
      *                                                                   S01408
     C/COPY WNCPYSRC,FT0040CCP5                                           S01408
      *                                                                   S01408
     C                     EXSR MVCUST                                    S01194
     C                     MOVE *BLANK    DESTAN
     C                     MOVELCNUM      DESTAN
     C                     MOVE 'C'       SDSTT
     C                     END                             E001
     C*                                                                   S01194
     C                     GOTO DESEND
     C           DESACC    TAG                             ** DESACC
      *                                                                   068230
      * Check that it is not a SWIFT address                              068230
      *                                                                   068230
     C                     MOVELSDST1     CLSWTK                          068230
     C                     MOVEA*IN,31    ##002   2                       068230
      *                                                                   068230
     C                     EXSR SWIFT                                     068230
      *                                                                   068230
     C           ##CSID    IFEQ 'Y'                                       068230
     C           *IN31     ANDEQ'0'                                       068230
     C           *IN32     ANDEQ'0'                                       068230
      * If Swift Id not found, allow it and display warning message.      140642
     C           ##CSID    OREQ 'Y'                                       140642
     C           *IN32     ANDEQ'1'                                       140642
     C                     MOVEL'*NFND'   SWIIND  5                       140642
     C                     MOVEL'S'       SDSTT                           068230
     C                     MOVEA##002     *IN,31                          068230
     C                     GOTO DESEND                                    068230
     C                     END                                            068230
      *                                                                   068230
     C                     MOVEA##002     *IN,31                          068230
      *                                                                   068230
     C***IF*15*CHARS*HAVE*BEEN*ENTERED*IS*A*FULL*ACCOUNT                  S01194
     C*                                                                   S01194
     C** If 18 chars have been entered and multi branched , or            S01194
     C** 15 long and single branch , is a full account.                   S01194
     C*                                                                   S01194
     C***********D15R******IFEQ *BLANK                     B001           S01194
     C           @MBIN     IFEQ 'Y'                                       S01117
     C           D18R      ANDEQ*BLANKS                                   S01117
     C           @MBIN     OREQ 'N'                                       S01117
     C           D15R      ANDEQ*BLANKS                                   S01117
     C                     MOVELDNUM      NUML
     C                     MOVELNUML      NUMA
     C**********           MOVELDCOD      CODL    50                                          CGL029
     C**********           MOVELCODL      CODA    4                                           CGL029
     C                     MOVELDCOD      CODL   110                                          CGL029
     C                     MOVELCODL      CODA   10                                           CGL029
     C                     MOVELDSEQ      SEQL    30
     C                     MOVELSEQL      SEQA    2
     C           DNUM      IFNE NUMA                       B002
     C           DCOD      ORNE CODA
     C           DSEQ      ORNE SEQA
     C                     SETON                     24
     C                     ELSE                            X002
     C                     MOVE DNUM      CNUM
     C                     MOVE DSCY      CCY
     C                     MOVE DCOD      ACOD
     C                     MOVE DSEQ      ACSQ
     C           @MBIN     IFEQ 'Y'                                       S01117
     C                     MOVE DBRC      BRCA                            S01117
     C                     ELSE                                           S01117
     C                     MOVE BJSBRC    BRCA                            S01117
     C                     END                                            S01117
     C           AKEY      CHAINACCNTABF             24
     C                     END                             E002
     C  N24      RECI      COMP 'D'                  2424
     C           *IN24     IFEQ '0'                                                           189639
     C**********           Z-ADDRETNUM    CNUM                                         189639 CSD027
     C                     MOVE RETNUM    CNUM                                                CSD027
     C                     ENDIF                                                              189639
     C           *IN24     IFEQ '1'                        B002
     C                     SETON                     89
     C*********************MOVEA' 029'    ERCD,Z                          S01117
     C                     MOVEA' 016'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     Z-ADD1         PHW     50                      140640
     C                     ELSE                            X002
     C* IF SENDER'S CORRESPONDENT IS BLANK CURRENCY MUST EQUAL PAY
     C* CURRENCY
     C           SPCCY     IFEQ *BLANK
     C                     MOVE SSMCY     SPCCY
     C                     END
     C           SSNCO     IFEQ *BLANK                     B003
     C           CCY       ANDNESPCCY
     C/COPY WNCPYSRC,FT0040C179
     C                     SETON                     2489
     C*********************MOVEA' 030'    ERCD,Z                          S01117
     C                     MOVEA' 017'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     Z-ADD1         PHW     50                      140640
     C                     END                             E003
     C                     END                             E002
      *
     C  N24                MOVE 'G'       SDSTT
     C  N24                MOVE ACST      ACST1                           047179
      *
     C  N24      ATYP      IFEQ 'R'                        B002
     C                     Z-ADDDACO      DSOPN
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0040CP31                                           S01408
     C*                                                                   S01408
     C                     END                             E002
     C           *IN24     IFEQ '0'                                       179420
     C                     MOVE RETB      DRETB                           179420
     C                     ENDIF                                          179420
      *
     C                     END                             E001
      *
     C           DESEND    TAG                             ** DESEND
     C* IF NOTHING ELSE MUST BE AN ADDRESS
     C  N24      SDSTT     IFEQ *BLANK                     B001
     C                     MOVE 'A'       SDSTT
     C                     END                             E001
     C*
     C** EXTRA VALIDATION OF ADDRESS FIELDS
     C*
     C           SDSTT     IFEQ 'A'
     C*
     C                     SETOF                     919293
     C                     SETOF                     9485
     C*
     C                     MOVE *BLANKS   ADDRSS
     C*
     C                     MOVELSDST1     ADCHK1
     C                     MOVELSDST2     ADCHK2
     C                     MOVELSDST3     ADCHK3
     C                     MOVELSDST4     ADCHK4
     C*
     C*   NO FIFTH FIELD, SO MOVE *BLANKS INTO ADCHK5 AND EXSR ADCHK
     C*
     C                     MOVE *BLANKS   ADCHK5
     C                     EXSR ADCHK
     C*
     C** DEPENDING ON THE INDICATORS, HIGHLIGHT THE FIELD IN ERROR
     C** ERROR AND PRODUCE THE ERROR MESSAGE
     C*
     C           *IN92     IFEQ '1'
     C                     SETON                     248589
     C*********************MOVEA' 470'    ERCD,Z                          S01117
     C                     MOVEA' 024'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     Z-ADD1         PHW     50                      140640
     C                     END
     C*
     C           *IN93     IFEQ '1'
     C                     SETON                     248589
     C                     END
     C*
     C                     END
     C*
     C** If destination is a NOSTRO set pay location to nostro location   S01195
     C** Else use system location                                         S01195
     C           SDSTT     IFEQ 'G'                                       S01195
     C           SDSTT     OREQ 'R'                                       S01195
     C                     CALL 'AONOSTR0'                                S01195
     C                     PARM *BLANKS   RTCD                            S01195
     C                     PARM '*KEY   ' @OPTN                           S01195
     C                     PARM CNUMA     @CUST   6                       S01195
     C                     PARM CCY       @CYCD   3                       S01195
     C**********           PARM ACODA     @ACCD   4                                    S01195 CGL029
     C                     PARM ACODA     @ACCD  10                                           CGL029
     C                     PARM ACSQA     @ACSN   2                       S01195
     C                     PARM *BLANKS   @NONB                           S01195
     C                     PARM BRCA      @BRCD                           S01195
     C                     PARM *BLANKS   @CSSN  10                       S01195
     C                     PARM *BLANKS   @PNOI   1                       S01195
     C           SDNOST    PARM SDNOST    DSFDY                           S01195
     C*                                                                   S01195
     C           RTCD      IFEQ *BLANKS                                   S01195
     C                     MOVE NLOC      PLOC                            S01195
     C                     MOVE 'N'       NOWRK                           S01195
     C*00/Copy member FT0040VDS1 - Validate Destination -retail,full accntS01435
     C/COPY WNCPYSRC,FT0040VDS1                                           S01435
     C                     END                                            S01195
     C                     ELSE                                           S01195
     C           SDSTT     IFEQ 'F'                                       S01195
     C                     MOVE NLOC      PLOC                            S01195
     C                     MOVE 'N'       NOWRK                           S01195
     C                     ELSE                                           S01195
     C                     MOVE BJSLCD    PLOC                            S01195
     C                     MOVE 'S'       NOWRK                           S01195
     C                     END                                            S01195
     C                     END                                            S01195
     C*00/Copy member FT0040VDS2 - Validate Destination-if BOJNET nostro  S01435
     C/COPY WNCPYSRC,FT0040VDS2                                           S01435
     C*                                                                   S01194
     C** Else,if a '?' found ....                                         S01194
     C*                                                                   S01194
     C                     ELSE                                           S01194
     C                     MOVEA' 019'    ERCD,Z                          S01194
     C                     ADD  1         Z                               S01194
     C                     Z-ADD1         PHW     50                      140640
     C                     SETON                     2489                 S01194
     C                     END                                            S01194
     C*                                                                   S01194
      * If a valid account has been entered,                              S01435
      * store full account details for FT Transaction Status File         S01435
      * record update.                                                    S01435
     C           *IN24     IFEQ '0'                                       S01435
     C           SDSTT     IFEQ 'F'                                       S01435
     C           SDSTT     OREQ 'R'                                       S01435
     C           SDSTT     OREQ 'G'                                       S01435
     C**********           Z-ADDCNUM      IMCNUM                          S01435              CSD027
     C                     MOVE CNUM      IMCNUM                                              CSD027
     C                     MOVE CCY       IMCCY                           S01435
     C                     Z-ADDACOD      IMACOD                          S01435
     C                     Z-ADDACSQ      IMACSQ                          S01435
     C                     MOVE BRCA      IMBRCA                          S01435
     C                     MOVELIMACNT    DSTDS                           S01435
     C/COPY WNCPYSRC,FT0040C027
     C                     END                                            S01435
     C                     END                                            S01435
     C/COPY WNCPYSRC,FT0040C180
      *                                                                   S01435
     C                     ENDSR
     C*
     C************************************************************
     C* END OF DESTINATION VALIDATION
     C************************************************************
     C/EJECT
     C/COPY WNCPYSRC,FT0040C015
     C************************************************************
     C* ORDCUS SR.
     C* VALIDATION OF ORDERING CUSTOMER
     C*
     C           ORDCUS    BEGSR
     C/COPY WNCPYSRC,FT0040C085
     C*                                                                   S01117
     C** Check for entry of '?'                                           S01117
     C*                                                                   S01117
     C                     MOVEA*BLANKS   WRKA                            S01117
     C                     MOVEASORC1     WRKA                            S01117
     C                     SETOF                     65                   S01117
     C           '?'       LOKUPWRKA                     65               S01117
     C*                                                                   S01117
     C           *IN65     IFNE '1'                                       S01117
     C*
     C                     MOVE *BLANK    SORCT
     C                     MOVE *BLANK    ACST3   1                       047179
     C                     Z-ADD0         OCOPN   50
     C*
     C*  ORDERING CUSTOMER IS MANDATORY
     C*
     C           ORDCST    IFEQ *BLANK
     C                     SETON                     2589
     C*********************MOVEA' 036'    ERCD,Z                          S01117
     C                     MOVEA' 038'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     Z-ADD1         PHW     50                      140640
     C                     GOTO ORDEND
     C                     END
     C/COPY WNCPYSRC,FT0040C110
     C*********************                                               E32772
     C**IF*SIX*CHARACTERS,*CHECK FOR CUST NO                       S01241 E32772
     C***********O06R******IFEQ *BLANK                     B001    S01241 E32772
     C*********************MOVELORDCST    CKEY    60               S01241 E32772
     C***********CKEY******CHAINCLINTCBF             88            S01241 E32772
     C*********************                                               E32772
     C************IN88*****IFEQ '0'                                S01241 E32772
     C*********************MOVE 'C'       SORCT                    S01241 E32772
     C*********************GOTO ORDEND                             S01241 E32772
     C*********************END                                     S01241 E32772
     C*********************END                                     S01241 E32772
     C* IF MORE THAN 10 CHAR HAVE BEEN ENTERED CANNOT BE A RETAIL NUMB
     C           O10R      IFNE *BLANK                     B001
     C                     GOTO ORDACC
     C                     END                             E001
     C* IF FULL ADDRESS,DO NOT VALIDATE FOR A/C
     C           SORC2     IFNE *BLANKS                    B001
     C           SORC3     ORNE *BLANKS
     C           SORC4     ORNE *BLANKS
     C                     GOTO ORDEND
     C                     END                             E001
      *                                                                   S01435
      * Validate for Ordering Customer Number and shortname               S01435
      *                                                                   S01435
     C                     MOVELSORC1     @KEY1                           S01435
     C                     CALL 'AOCUSTR0'                                S01435
     C                     PARM *BLANKS   RTCD                            S01435
     C                     PARM '*KEY   ' @OPTN                           S01435
     C                     PARM           @KEY1                           S01435
     C                     PARM *BLANKS   @KYST                           S01435
     C           SDCUST    PARM *BLANKS   DSSDY                           S01435
      *                                                                   S01435
      * If return code is blanks set to customer and translate to         S01435
      * customer number                                                   S01435
      *                                                                   S01435
     C           RTCD      IFEQ *BLANKS                                   S01435
     C                     MOVEL*BLANKS   ORDCST                          S01435
     C                     MOVELBBCUST    ORDCST                          S01435
     C                     MOVEL'C'       SORCT                           S01435
     C/COPY WNCPYSRC,FT0040C181
     C                     GOTO ORDEND                                    S01435
     C                     END                                            S01435
      *                                                                   S01435
     C**IF*TEN*CHARACTERS,*CHECK FOR SHORTNAME                     S01241 E32772
     C*********************MOVELORDCST    CSNM                     S01241 E32772
     C***********CSNM******CHAINSNAMEF               88            S01241 E32772
     C*********************                                               E32772
     C************IN88*****IFEQ '0'                                S01241 E32772
     C*********************MOVE 'C'       SORCT                    S01241 E32772
     C*********************GOTO ORDEND                             S01241 E32772
     C*********************END                                     S01241 E32772
     C*********************                                               E32772
     C                     MOVELORET      RETL
     C                     MOVELRETL      RETA
     C           OCUS      IFEQ RETA                       B001
     C*
     C** CHECK TO SEE WHETHER A RETAIL ACCOUNT NUMBER IS ALLOWED
     C*
     C***********RACN******IFEQ 'N'                        B002           S01194
     C           BMRANR    IFEQ 'N'                                       S01194
     C*********************MOVEA' 414'    ERCD,Z                          S01117
     C                     MOVEA' 020'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     Z-ADD1         PHW     50                      140640
     C                     SETON                     2589
     C                     ELSE                            X002
     C*
     C                     MOVE ORET      ACNO
     C           ACNO      CHAINACNUMAF              25
     C  N25      RECI      COMP 'D'                  2525
     C* Store Retail Number for Later Use                                 176510
     C           *IN25     IFEQ '0'                                       176510
     C                     MOVE RETNUM    ORDRET                          176510
     C**********           Z-ADDRETNUM    CNUM                                         189639 CSD027
     C                     MOVE RETNUM    CNUM                                                CSD027
     C                     ELSE                                           176510
     C**********           MOVE *ZEROS    ORDRET                                       176510 CSD027
     C                     MOVE *BLANKS   ORDRET                                              CSD027
     C                     ENDIF                                          176510
     C           *IN25     IFEQ '1'                        B003
     C                     SETON                     89
     C*********************MOVEA' 037'    ERCD,Z                          S01117
     C                     MOVEA' 039'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     Z-ADD1         PHW     50                      140640
     C                     ELSE                            X003
     C* IF ORDERING BANK IS BLANK CURRENCY MUST EQUAL SETTLE CURRENCY
     C           SORBK     IFEQ *BLANK                     B004
     C           CCY       ANDNESSMCY
     C                     SETON                     2589
     C*********************MOVEA' 038'    ERCD,Z                          S01117
     C                     MOVEA' 040'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     Z-ADD1         PHW     50                      140640
     C                     END                             E004
     C                     END                             E003
     C  N25                MOVE 'R'       SORCT
     C  N25                MOVE ACST      ACST3                           047179
      *
     C  N25      ATYP      IFEQ 'R'                        B003
     C                     Z-ADDDACO      OCOPN
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0040CP32                                           S01408
     C*                                                                   S01408
     C                     END                             E002
      *                                                                   179420
     C           *IN25     IFEQ '0'                                       179420
     C                     MOVE RETB      OCRETB  1                       179420
     C                     ENDIF                                          179420
      *                                                                   179420
     C                     END                             E001
      *
     C                     GOTO ORDEND
     C                     END                             E001
      *
     C           ORDACC    TAG                             ** ORDACC
     C***IF*12*CHAR*HAVE*BEEN*ENTERED*MUST*BE*A*PARTIAL*ACCOUNT           S01194
     C*                                                                   S01194
     C** If 15 char have been entered and multi branched , or             S01194
     C** 12 characters and single branch , must be a partial account.     S01194
     C*                                                                   S01194
     C***********O12R******IFEQ *BLANK                     B001           S01194
     C           @MBIN     IFEQ 'Y'                                       S01117
     C           O15R      ANDEQ*BLANKS                                   S01117
     C           @MBIN     OREQ 'N'                                       S01117
     C           O12R      ANDEQ*BLANKS                                   S01117
     C                     MOVELONUM      NUML
     C                     MOVELNUML      NUMA
     C**********           MOVELOCOD      CODL    50                                          CGL029
     C**********           MOVELCODL      CODA    4                                           CGL029
     C                     MOVELOCOD      CODL                                                CGL029
     C                     MOVELCODL      CODA                                                CGL029
     C                     MOVELOSEQ      SEQL    30
     C                     MOVELSEQL      SEQA    2
     C           ONUM      IFEQ NUMA                       B002
     C           OCOD      ANDEQCODA
     C           OSEQ      ANDEQSEQA
     C                     MOVE ONUM      CNUM
     C                     MOVE SSMCY     CCY
     C                     MOVE OCOD      ACOD
     C                     MOVE OSEQ      ACSQ
     C           @MBIN     IFEQ 'Y'                                       S01195
     C                     MOVE OBRC      BRCA                            S01195
     C                     ELSE                                           S01195
     C                     MOVE BJSBRC    BRCA                            S01195
     C                     END                                            S01195
     C           AKEY      CHAINACCNTABF             25
     C  N25      RECI      COMP 'D'                  2525
     C           *IN25     IFEQ '0'                                                           189639
     C**********           Z-ADDRETNUM    CNUM                                         189639 CSD027
     C                     MOVE RETNUM    CNUM                                                CSD027
     C                     ENDIF                                                              189639
     C           *IN25     IFEQ '1'                        B003
     C                     SETON                     89
     C*********************MOVEA' 039'    ERCD,Z                          S01117
     C                     MOVEA' 041'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     Z-ADD1         PHW     50                      140640
     C                     END                             E003
      *
     C  N25                MOVE 'P'       SORCT
     C  N25                MOVE ACST      ACST3                           047179
     C                     END                             E002
      *
     C  N25      ATYP      IFEQ 'R'                        B002
     C                     Z-ADDDACO      OCOPN
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0040CP33                                           S01408
     C*                                                                   S01408
     C                     END                             E002
      *                                                                   179420
     C           *IN25     IFEQ '0'                                       179420
     C                     MOVE RETB      OCRETB                          179420
     C                     ENDIF                                          179420
      *                                                                   179420
     C                     END                             E001
     C* IF NOTHING ELSE MUST BE AN ADDRESS
     C  N25      SORCT     IFEQ *BLANK                     B001
     C           SORC1     IFNE *BLANKS                    B002
     C           SORC2     ORNE *BLANKS
     C           SORC3     ORNE *BLANKS
     C           SORC4     ORNE *BLANKS
     C                     MOVE 'A'       SORCT
     C                     END                             E002        33
     C                     END                             E001
      *                                                                   061236
      *  MT202 keyword may only be used in Ordering Customer field 1      061236
      *  if the settlement type is '01' or '08'.                          061236
      *                                                                   061236
      *  or the settlement type is '02'                                   073151
      *                                                                   073151
     C           SORC1     IFEQ ORCFLD                                    061236
     C           SSTTP     ANDNE'01'                                      061236
     C           SSTTP     ANDNE'02'                                      073151
     C           SSTTP     ANDNE'08'                                      061236
     C                     SETON                     2589                 061236
     C                     MOVEA' 090'    ERCD,Z                          061236
     C                     ADD  1         Z                               061236
     C                     Z-ADD1         PHW     50                      140640
     C                     END                                            061236
     C*
     C** EXTRA VALIDATION OF ADDRESS FIELDS
     C*
     C           SORCT     IFEQ 'A'
     C*
     C                     SETOF                     919293
     C                     SETOF                     9486
     C*
     C                     MOVE *BLANKS   ADDRSS
     C*
     C                     MOVELSORC1     ADCHK1
     C                     MOVELSORC2     ADCHK2
     C                     MOVELSORC3     ADCHK3
     C                     MOVELSORC4     ADCHK4
     C*
     C*   NO FIFTH FIELD, SO MOVE *BLANKS INTO ADCHK5 AND EXSR ADCHK
     C*
     C                     MOVE *BLANKS   ADCHK5
     C                     EXSR ADCHK
     C*
     C** DEPENDING ON THE INDICATORS, HIGHLIGHT THE FIELD IN ERROR
     C** ERROR AND PRODUCE THE ERROR MESSAGE
     C*
     C           *IN92     IFEQ '1'
     C                     SETON                     258689
     C*********************MOVEA' 472'    ERCD,Z                          S01117
     C                     MOVEA' 044'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     Z-ADD1         PHW     50                      140640
     C                     END
     C*
     C           *IN93     IFEQ '1'
     C                     SETON                     258689
     C                     END
     C*
     C                     END
     C           ORDEND    TAG                             ** ORDEND
     C*
     C** Else,if '?' found....                                            S01194
     C*                                                                   S01194
     C                     ELSE                                           S01194
     C                     MOVEA' 045'    ERCD,Z                          S01194
     C                     ADD  1         Z                               S01194
     C                     Z-ADD1         PHW     50                      140640
     C                     SETON                     2589                 S01194
     C                     END                                            S01194
     C/COPY WNCPYSRC,FT0040C095
     C*                                                                   S01194
      * If a valid account has been entered,                              S01435
      * store full account details for FT Transaction Status File         S01435
      * record update.                                                    S01435
     C           *IN25     IFEQ '0'                                       S01435
     C           SORCT     IFEQ 'R'                                       S01435
     C           SORCT     OREQ 'P'                                       S01435
     C**********           Z-ADDCNUM      IMCNUM                                       S01435 CSD027
     C                     MOVE CNUM      IMCNUM                                              CSD027
     C                     MOVE CCY       IMCCY                           S01435
     C                     Z-ADDACOD      IMACOD                          S01435
     C                     Z-ADDACSQ      IMACSQ                          S01435
     C                     MOVE BRCA      IMBRCA                          S01435
     C                     MOVELIMACNT    ORCDS                           S01435
     C/COPY WNCPYSRC,FT0040C028
     C                     END                                            S01435
     C/COPY WNCPYSRC,FT0040C272
     C                     END                                            S01435
     C/COPY WNCPYSRC,FT0040C182
      ** Move key fields to variable if CRE008 is installed.                                  CRE008
      *                                                                                       CRE008
     C           CRE008    IFEQ 'Y'                                                           CRE008
     C           *IN25     ANDEQ'0'                                                           CRE008
     C           SORCT     IFEQ 'R'                                                           CRE008
     C           SORCT     OREQ 'P'                                                           CRE008
     C                     MOVE BRCA      PIBRCH  3                                           CRE008
     C**********           Z-ADDCNUM      PICUST  60                                   CRE008 CSD027
     C                     MOVE CNUM      PICUST  6                                           CSD027
     C                     MOVE CCY       PICURR  3                                           CRE008
     C**********           Z-ADDACOD      PIACOD  40                                   CRE008 CGL029
     C                     Z-ADDACOD      PIACOD 100                                          CGL029
     C                     Z-ADDACSQ      PIACSQ  20                                          CRE008
     C                     ENDIF                                                              CRE008
     C                     ENDIF                                                              CRE008
      *                                                                                       CRE008
      *                                                                   S01435
     C                     ENDSR
     C*
     C************************************************************
     C* END OF ORDERING CUSTOMER VALIDATION
     C************************************************************
     C/EJECT
     C************************************************************
     C* SNDCOR SR.
     C* VALIDATION OF SENDER'S CORRESPONDENT
     C*
     C           SNDCOR    BEGSR
     C*00/Copy member FT0040VSNC - Validate Sender's Correspondent        S01435
     C/COPY WNCPYSRC,FT0040VSNC                                           S01435
     C*
     C                     MOVE *BLANK    SSNCT
     C                     MOVE *BLANK    ACST2   1                       047179
     C                     Z-ADD0         SCOPN   50
      *
     C           SSNCO     IFEQ *BLANK                     B001
      *
     C* IF BLANK AND DESTINATION IS OF TYPE C OR A ERROR
     C           SDSTT     IFEQ 'C'                        B002
     C           SDSTT     OREQ 'A'
     C           SDSTT     OREQ 'S'                                       S01435
     C/COPY WNCPYSRC,FT0040C183
     C                     SETON                     2689
     C*********************MOVEA' 032'    ERCD,Z                          S01117
     C                     MOVEA' 030'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     Z-ADD1         PHW     50                      140640
     C/COPY WNCPYSRC,FT0040C239
     C                     END                             E002
     C/COPY WNCPYSRC,FT0040C184
     C                     MOVE ' '       SSNCT
     C                     GOTO SNDEND
     C*
     C                     ELSE
     C** NO ENTRY ALLOWED IF DESTINATION IS FULL ACCOUNT, NOSTRO OR
     C** RETAIL ACCOUNT NUMBER, AND PAY CCY = DSTT CCY
     C           SDSTT     IFEQ 'F'
     C           SPCCY     ANDEQNCUR
     C           SDSTT     OREQ 'R'
     C           SPCCY     ANDEQCCYSTO
     C           SDSTT     OREQ 'G'
     C           SPCCY     ANDEQDSCY
     C                     SETON                     2689
     C*********************MOVEA' 497'    ERCD,Z                          S01117
     C                     MOVEA' 037'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     Z-ADD1         PHW     50                      140640
     C                     MOVE ' '       SSNCT
     C                     GOTO SNDEND
     C                     END
     C                     END                             E001
     C* IF ONLY 2 CHAR ENTERED MUST BE A NOSTRO NUMBER
     C           S2R       IFEQ *BLANK                     B001
     C           SPCCY     IFEQ *BLANK
     C                     MOVE SSMCY     SPCCY
     C                     END
     C                     MOVELSPCCY     CURR                            064133
     C                     MOVE SNOS      CURR                            064133
     C*********************MOVELSPCCY     CURR    5                       S01194
     C*********************MOVE SNOS      CURR                            S01194
     C*********************MOVE *BLANK    KEY                             S01194
     C*********************MOVEL'70'      KEY                             S01194
     C*********************MOVE CURR      KEY                             S01194
     C***********KEY*******CHAINTABLETLF             26                   S01194
     C**N26******RECI******COMP 'D'                  2626                 S01194
     C*                                                                   S01194
     C                     CALL 'AONOSTR0'                                S01194
     C                     PARM *BLANKS   RTCD                            S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM *BLANKS   @CUST                           S01194
     C                     PARM SPCCY     @CYCD                           S01194
     C                     PARM *BLANKS   @ACCD                           S01194
     C                     PARM *BLANKS   @ACSN                           S01194
     C                     PARM SNOS      @NONB                           S01194
     C                     PARM *BLANKS   @BRCD                           S01194
     C                     PARM *BLANKS   @CSSN                           S01194
     C                     PARM *BLANKS   @PNOI                           S01194
     C           SDNOST    PARM SDNOST    DSFDY                           S01194
     C*                                                                   S01194
     C           RTCD      CASEQ*BLANKS   MVNOST     2626                 S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C   26                DO                              B002
     C                     SETON                     89
     C*********************MOVEA' 033'    ERCD,Z                          S01117
     C                     MOVEA' 031'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     Z-ADD1         PHW     50                      140640
     C                     END                             E002
     C  N26                MOVE 'N'       SSNCT
     C*00/Copy member FT0040VDS3 - Check if BOJ YENKSI nostro Account     S01435
     C/COPY WNCPYSRC,FT0040VDS3                                           S01435
     C           CURR      IFEQ DESTAN
     C                     SETON                     26
     C   26                DO
     C                     SETON                     89
     C*********************MOVEA' 123'    ERCD,Z                          S01117
     C                     MOVEA' 036'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     Z-ADD1         PHW     50                      140640
     C                     END
     C                     END
     C* FIND IF RETAIL
      *
     C  N26                MOVE SPCCY     CCY
     C  N26                EXSR ACCRED
     C  N26                MOVE ACST      ACST2                           047179
      *
     C  N26      ATYP      IFEQ 'R'                        B002
     C                     Z-ADDDACO      SCOPN
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0040CP34                                           S01408
     C*                                                                   S01408
     C                     END                             E002
      *                                                                   179420
     C           *IN26     IFEQ '0'                                       179420
     C                     MOVE RETB      SCRETB                          179420
     C                     ENDIF                                          179420
      *                                                                   179420
     C                     ELSE                            X001
     C/COPY WNCPYSRC,FT0040C185
     C*
     C* MUST BE A RETAIL NUMBER
     C*
     C                     MOVELSRET      RETL   110
     C                     MOVELRETL      RETA   10
     C           SRET      IFNE RETA                       B002
     C                     SETON                     26
     C                     ELSE                            X002
     C                     MOVE SRET      ACNO
     C           ACNO      CHAINACNUMAF              26
     C                     END                             E002
     C*
     C** CHECK TO SEE WHETHER A RETAIL ACCOUNT NUMBER IS ALLOWED
     C*
     C***********RACN******IFEQ 'N'                                       S01194
     C           BMRANR    IFEQ 'N'                                       S01194
     C*********************MOVEA' 414'    ERCD,Z                          S01117
     C                     MOVEA' 020'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     Z-ADD1         PHW     50                      140640
     C                     SETON                     2689
     C                     ELSE
     C  N26      RECI      COMP 'D'                  2626
     C           *IN26     IFEQ '0'                                                           189639
     C**********           Z-ADDRETNUM    CNUM                                         189639 CSD027
     C                     MOVE RETNUM    CNUM                                                CSD027
     C                     ENDIF                                                              189639
     C           *IN26     IFEQ '1'                        B002
     C                     SETON                     89
     C*********************MOVEA' 034'    ERCD,Z                          S01117
     C                     MOVEA' 032'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     Z-ADD1         PHW     50                      140640
     C                     ELSE                            X002
     C           SPCCY     IFEQ *BLANK
     C                     MOVE SSMCY     SPCCY
     C                     END
     C           CCY       IFNE SPCCY                      B003
     C                     SETON                     2689
     C*********************MOVEA' 035'    ERCD,Z                          S01117
     C                     MOVEA' 033'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     Z-ADD1         PHW     50                      140640
     C                     END                             E003
      *
     C                     END                             E002
      *
     C  N26                MOVE 'R'       SSNCT
     C  N26                MOVE ACST      ACST2                           047179
      *
     C  N26      ATYP      IFEQ 'R'                        B002
     C                     Z-ADDDACO      SCOPN
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0040CP35                                           S01408
     C*                                                                   S01408
     C                     END                             E002
      *                                                                   179420
     C           *IN26     IFEQ '0'                                       179420
     C                     MOVE RETB      SCRETB  1                       179420
     C                     ENDIF                                          179420
      *
     C                     END                             E001
     C                     END                             E001
      ** CFT014 installed, Sender' Correspondent cannot be blank as       CFT014
      ** Third Reimbursement Institution is present.                      CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
     C           WLINK     ANDNE'Y'                                       CFT014
     C           SSNCO     IFEQ *BLANK                                    CFT014
     C           OPTRI1    ANDNE*BLANK                                    CFT014
     C                     MOVE *ON       *IN49                           CFT014
     C                     MOVE *ON       *IN89                           CFT014
     C                     MOVEL'FTM3100' FTMSID                          CFT014
     C                     Z-ADD1         PHW                             CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
     C*
     C** If senders correspondent is a NOSTRO set pay location            S01195
     C** to nostro location.Else use system location                      S01195
     C*                                                                   S01195
     C           SSNCT     IFEQ 'R'                                       S01195
     C                     CALL 'AONOSTR0'                                S01195
     C                     PARM *BLANKS   RTCD                            S01195
     C                     PARM '*KEY   ' @OPTN                           S01195
     C                     PARM CNUMA     @CUST   6                       S01195
     C                     PARM CCY       @CYCD   3                       S01195
     C**********           PARM ACODA     @ACCD   4                                    S01195 CGL029
     C                     PARM ACODA     @ACCD                                               CGL029
     C                     PARM ACSQA     @ACSN   2                       S01195
     C                     PARM *BLANKS   @NONB                           S01195
     C                     PARM BRCA      @BRCD                           S01195
     C                     PARM *BLANKS   @CSSN  10                       S01195
     C                     PARM *BLANKS   @PNOI   1                       S01195
     C           SDNOST    PARM SDNOST    DSFDY                           S01195
     C*                                                                   S01195
     C           RTCD      IFEQ *BLANKS                                   S01195
     C                     MOVE NLOC      PLOC                            S01195
     C                     MOVE 'N'       NOWRK   1                       S01195
     C                     END                                            S01195
     C                     ELSE                                           S01195
     C           SSNCT     IFEQ 'N'                                       S01195
     C                     MOVE NLOC      PLOC    3                       S01195
     C                     MOVE 'N'       NOWRK                           S01195
     C                     ELSE                                           S01195
     C                     MOVE BJSLCD    PLOC                            S01195
     C                     MOVE 'S'       NOWRK                           S01195
     C                     END                                            S01195
     C                     END                                            S01195
     C*                                                                   S01195
     C           SNDEND    TAG                                            S01435
     C/COPY WNCPYSRC,FT0040C186
      *                                                                   S01435
      * If a valid account has been entered,                              S01435
      * store full account details for FT Transaction Status File         S01435
      * record update.                                                    S01435
     C           *IN26     IFEQ '0'                                       S01435
     C/COPY WNCPYSRC,FT0040C187
     C           SSNCT     IFEQ 'N'                                       S01435
     C           SSNCT     OREQ 'R'                                       S01435
     C**********           Z-ADDCNUM      IMCNUM                                       S01435 CSD027
     C                     MOVE CNUM      IMCNUM                                              CSD027
     C                     MOVE CCY       IMCCY                           S01435
     C                     Z-ADDACOD      IMACOD                          S01435
     C                     Z-ADDACSQ      IMACSQ                          S01435
     C                     MOVE BRCA      IMBRCA                          S01435
     C                     MOVELIMACNT    SNCDS                           S01435
     C/COPY WNCPYSRC,FT0040C029
     C                     END                                            S01435
     C                     END                                            S01435
     C/COPY WNCPYSRC,FT0040C188
      *                                                                   S01435
     C***********SNDEND    ENDSR                           ** SNDEND      S01435
     C                     ENDSR                                          S01435
     C*
     C************************************************************
     C* END OF SENDER'S CORRESPONDENT VALIDATION
     C************************************************************
     C/EJECT
     C************************************************************
     C* ORDBNK SR.
     C* ORDERING BANK VALIDATION
     C*
     C           ORDBNK    BEGSR
     C/COPY WNCPYSRC,FT0040C086
     C*                                                                   S01117
     C** Check for entry of '?'                                           S01117
     C*                                                                   S01117
     C**********           Z-ADD0         ORBNUM                                       176510 CSD027
     C                     MOVE *BLANKS   ORBNUM                                              CSD027
     C                     MOVEA*BLANKS   WRKA                            S01117
     C                     MOVEASORBK     WRKA                            S01117
     C                     SETOF                     65                   S01117
     C           '?'       LOKUPWRKA                     65               S01117
     C*                                                                   S01117
     C           *IN65     IFNE '1'                                       S01117
     C*
     C                     MOVE *BLANK    SORBT
     C                     MOVE *BLANK    ACST4   1                       047179
     C                     Z-ADD0         OBOPN   50
      *
     C           SORBK     IFEQ *BLANK                     B001
      *
     C* IF BLANK AND ORDERING BANK NOT OF TYPE A ERROR
      *
     C           SORCT     IFEQ 'A'                        B002
     C           SORCT     OREQ 'C'                                       E35508
     C           SORCT     OREQ 'S'                                       S01435
     C/COPY WNCPYSRC,FT0040C189
     C                     SETON                     2789
     C*********************MOVEA' 040'    ERCD,Z                          S01117
     C                     MOVEA' 047'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     Z-ADD1         PHW     50                      140640
     C/COPY WNCPYSRC,FT0040C240
     C                     END                             E002
     C/COPY WNCPYSRC,FT0040C190
     C                     MOVE ' '       SORBT
     C                     GOTO OREND
     C                     END                             E001
     C* IF MORE THAN 2 CHAR ENTERED CANNOT BE A NOSTRO NUMBER
     C           OR2R      IFNE *BLANK                     B001
     C           SORBB     ORNE *BLANK                                    S01117
     C                     GOTO ORRET
     C                     END                             E001
     C*********************MOVELSSMCY     CURR
     C*********************MOVE ORNS      CURR
     C*********************MOVE *BLANK    KEY                             S01194
     C*********************MOVEL'70'      KEY                             S01194
     C*********************MOVE CURR      KEY                             S01194
     C***********KEY*******CHAINTABLETLF             27                   S01194
     C**N27******RECI******COMP 'D'                  2727                 S01194
     C*                                                                   S01194
     C                     CALL 'AONOSTR0'                                S01194
     C                     PARM *BLANKS   RTCD                            S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM *BLANKS   @CUST                           S01194
     C                     PARM SSMCY     @CYCD                           S01194
     C                     PARM *BLANKS   @ACCD                           S01194
     C                     PARM *BLANKS   @ACSN                           S01194
     C                     PARM ORNS      @NONB                           S01194
     C                     PARM *BLANKS   @BRCD                           S01194
     C                     PARM *BLANKS   @CSSN                           S01194
     C                     PARM *BLANKS   @PNOI                           S01194
     C           SDNOST    PARM SDNOST    DSFDY                           S01194
     C*                                                                   S01194
     C           RTCD      CASEQ*BLANKS   MVNOST     2727                 S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C   27                DO                              B001
     C                     SETON                     89
     C*********************MOVEA' 041'    ERCD,Z                          S01117
     C                     MOVEA' 049'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     Z-ADD1         PHW     50                      140640
     C                     END                             E001
      *
     C  N27                MOVE 'N'       SORBT
      *
     C* FIND IF RETAIL
      *
     C  N27                MOVE SSMCY     CCY
     C  N27                EXSR ACCRED
     C  N27                MOVE ACST      ACST4                           047179
      *
     C  N27      ATYP      IFEQ 'R'                        B002
     C                     Z-ADDDACO      OBOPN
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0040CP36                                           S01408
     C*                                                                   S01408
     C                     END                             E002
      *                                                                   179420
     C           *IN27     IFEQ '0'                                       179420
     C                     MOVE RETB      OBRETB                          179420
     C                     ENDIF                                          179420
      *
     C                     GOTO OREND
      *
     C           ORRET     TAG                             ** ORRET
     C/COPY WNCPYSRC,FT0040C191
      *
     C* IF 10 CHAR ENTERED MUST BE A RETAIL NUMBER
      *
     C           OR10R     IFEQ *BLANK                     B001
     C           SORBB     ANDEQ*BLANK                                    S01117
     C*
     C                     MOVELORRT      RETL   110
     C                     MOVELRETL      RETA   10
     C           ORRT      IFNE RETA                       B002
     C                     SETON                     27
     C                     ELSE                            X002
     C                     MOVE ORRT      ACNO
     C           ACNO      CHAINACNUMAF              27
     C                     END                             E002
     C*
     C** CHECK TO SEE WHETHER A RETAIL ACCOUNT NUMBER IS ALLOWED
     C*
     C***********RACN******IFEQ 'N'                                       S01194
     C           BMRANR    IFEQ 'N'                                       S01194
     C*********************MOVEA' 414'    ERCD,Z                          S01117
     C                     MOVEA' 020'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     Z-ADD1         PHW     50                      140640
     C                     SETON                     2789
     C                     ELSE
     C  N27      RECI      COMP 'D'                  2727
     C           *IN27     IFEQ '0'                                                           189639
     C**********           Z-ADDRETNUM    CNUM                                         189639 CSD027
     C                     MOVE RETNUM    CNUM                                                CSD027
     C                     ENDIF                                                              189639
     C           *IN27     IFEQ '1'                        B002
     C                     SETON                     89
     C*********************MOVEA' 042'    ERCD,Z                          S01117
     C                     MOVEA' 050'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     Z-ADD1         PHW     50                      140640
     C                     ELSE                            X002
     C           CCY       IFNE SSMCY                      B003
     C                     SETON                     2789
     C*********************MOVEA' 043'    ERCD,Z                          S01117
     C                     MOVEA' 051'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     Z-ADD1         PHW     50                      140640
     C                     END                             E003
     C                     END                             E002
      *
     C  N27                MOVE 'R'       SORBT
     C  N27                MOVE ACST      ACST4                           047179
      *
     C  N27      ATYP      IFEQ 'R'                        B002
     C                     Z-ADDDACO      OBOPN
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0040CP37                                           S01408
     C*                                                                   S01408
     C                     END                             E002
      *                                                                   179420
     C           *IN27     IFEQ '0'                                       179420
     C                     MOVE RETB      OBRETB  1                       179420
     C                     ENDIF                                          179420
      *
     C                     END                             E002
      *
     C                     ELSE                            X001
      *
     C* MUST BE A PARTIAL ACCOUNT
     C                     MOVELORNM      NUML
     C                     MOVELNUML      NUMA
     C**********           MOVELORCD      CODL    50                                          CGL029
     C**********           MOVELCODL      CODA    4                                           CGL029
     C                     MOVELORCD      CODL                                                CGL029
     C                     MOVELCODL      CODA                                                CGL029
     C                     MOVELORSQ      SEQL    30
     C                     MOVELSEQL      SEQA    2
     C           ORNM      IFNE NUMA                       B002
     C           ORCD      ORNE CODA
     C           ORSQ      ORNE SEQA
     C                     SETON                     27
     C                     ELSE                            X002
     C                     MOVE ORNM      CNUM
     C                     MOVE SSMCY     CCY
     C                     MOVE ORCD      ACOD
     C                     MOVE ORSQ      ACSQ
     C           @MBIN     IFEQ 'Y'                                       S01117
     C                     MOVE SORBB     BRCA                            S01117
     C                     ELSE                                           S01117
     C                     MOVE BJSBRC    BRCA                            S01117
     C                     MOVE BJSBRC    SORBB                           S01117
     C                     END                                            S01117
     C           AKEY      CHAINACCNTABF             27
     C                     END                             E002
     C  N27      RECI      COMP 'D'                  2727
     C           *IN27     IFEQ '0'                                                           189639
     C**********           Z-ADDRETNUM    CNUM                                         189639 CSD027
     C                     MOVE RETNUM    CNUM                                                CSD027
     C                     ENDIF                                                              189639
     C   27                DO                              B002
     C                     SETON                     89
     C*********************MOVEA' 025'    ERCD,Z                          S01117
     C                     MOVEA' 048'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     Z-ADD1         PHW     50                      140640
     C                     END                             E002
      *
     C  N27                MOVE 'P'       SORBT
     C  N27                MOVE ACST      ACST4                           047179
      *
     C  N27      ATYP      IFEQ 'R'                        B002
     C                     Z-ADDDACO      OBOPN
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0040CP38                                           S01408
     C*                                                                   S01408
     C                     END                             E002
      *                                                                   179420
     C           *IN27     IFEQ '0'                                       179420
     C                     MOVE RETB      OBRETB                          179420
     C                     ENDIF                                          179420
      *
     C                     END                             E001
     C*
     C** Else,if '?' found....                                            S01194
     C*                                                                   S01194
     C                     ELSE                                           S01194
     C                     MOVEA' 054'    ERCD,Z                          S01194
     C                     ADD  1         Z                               S01194
     C                     Z-ADD1         PHW     50                      140640
     C                     SETON                     2789                 S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C           OREND     TAG                                            S01435
     C/COPY WNCPYSRC,FT0040C192
      *                                                                   S01435
      * If a valid account has been entered,                              S01435
      *                                                                   S01435
      * store full account details for FT Transaction Status File         S01435
      * record update.                                                    S01435
     C           *IN27     IFEQ '0'                                       S01435
      *                                                                   S01435
     C           SORBT     IFEQ 'N'                                       S01435
     C           SORBT     OREQ 'R'                                       S01435
     C           SORBT     OREQ 'P'                                       S01435
     C**********           Z-ADDCNUM      ORBNUM                                       176510 CSD027
     C**********           Z-ADDCNUM      IMCNUM                                       S01435 CSD027
     C                     MOVE CNUM      ORBNUM                                              CSD027
     C                     MOVE CNUM      IMCNUM                                              CSD027
     C                     MOVE CCY       IMCCY                           S01435
     C                     Z-ADDACOD      IMACOD                          S01435
     C                     Z-ADDACSQ      IMACSQ                          S01435
     C                     MOVE BRCA      IMBRCA                          S01435
     C                     MOVELIMACNT    ORBDS                           S01435
     C/COPY WNCPYSRC,FT0040C030
     C                     END                                            S01435
     C/COPY WNCPYSRC,FT0040C193
      *                                                                   061236
      * If MT202 keyword exists in field 1 of Ordering Customer then the  061236
      * Ordering Bank must have an account whose customer is a bank.      061236
      *                                                                   061236
      * ONLY required if Ordering Bank no typed into SORC2/3/4            061236
      *                                                                   061236
     C           SORC1     IFEQ ORCFLD                                    061236
     C           SORC2     ANDEQ*BLANKS                                   061236
     C           SORBT     IFEQ 'N'                                       061236
     C           SORBT     OREQ 'R'                                       061236
     C           SORBT     OREQ 'P'                                       061236
      *                                                                   061236
     C                     CALL 'AOCUSTR0'                                061236
     C                     PARM *BLANKS   RTCD                            061236
     C                     PARM '*KEY   ' @OPTN                           061236
     C                     PARM CNUMA     @KEY1                           061236
     C                     PARM *BLANKS   @KYST                           061236
     C           SDCUST    PARM SDCUST    DSSDY                           061236
      *                                                                   061236
     C           RTCD      IFNE *BLANKS                                   061236
     C                     MOVEL'SDCUSTPD'W0FILE           *************  061236
     C                     Z-ADD49        W0ERNB           * DBERR 49  *  061236
     C                     MOVEL@OPTN     W0KEY            *************  061236
     C                     EXSR SRERR                                     061236
     C                     ELSE                                           061236
      *                                                                   061236
      * Check the bank/non-bank indicator.                                061236
      * and customer not part of the branch network                       068088
      *                                                                   061236
     C           BBBNBI    IFNE 'Y'                                       061236
     C           BBBSIN    ANDEQ*BLANKS                                   068088
     C                     SETON                     2789                 061236
     C                     MOVEA' 091'    ERCD,Z                          061236
     C                     ADD  1         Z                               061236
     C                     Z-ADD1         PHW     50                      140640
     C                     END                                            061236
     C                     END                                            061236
      *                                                                   061236
     C                     END                                            061236
     C/COPY WNCPYSRC,FT0040C194
     C                     END                                            061236
      *                                                                   061236
     C                     END                                            S01435
      *                                                                   S01435
     C***********OREND     ENDSR                           ** OREND       S01435
      *                                                                   S01435
      * If Ordering Bank entered and Ordering Customer an                 S01435
      * account then error.                                               S01435
      *                                                                   S01435
     C           *IN25     IFEQ '0'                                       S01435
     C           *IN27     ANDEQ'0'                                       S01435
     C           SORBT     ANDNE*BLANKS                                   S01435
      *                                                                   S01435
      * If not Address, Customer or SWIFT error                           S01435
      *                                                                   S01435
     C           SORCT     IFNE 'A'                                       S01435
     C           SORCT     ANDNE'S'                                       S01435
     C           SORCT     ANDNE'C'                                       S01435
     C                     MOVEL'FTM2352' FTMSID                          S01435
     C                     EXSR FTSNMS                                    S01435
     C                     SETON                     2527                 S01435
     C                     MOVEL'Y'       FTNOUP                          S01435
     C                     END                                            S01435
     C                     END                                            S01435
      *                                                                   S01435
     C                     ENDSR                                          S01435
     C*
     C************************************************************
     C* END OF ORDERING BANK VALIDATION
     C************************************************************
     C/EJECT
      ************************************************************        CEU006
      * NTDLCY SR.                                                        CEU006
      * NOTIFIED DELIVERY CURRENCY VALIDATION                             CEU006
      * OPTIONAL - MUST BE EUROS OR 'IN' CURRENCY                         CEU006
      *            NOT ALLOWED FOR REGULAR PAYMENT                        CEU006
      ************************************************************        CEU006
      *                                                                   CEU006
     C           NTDLCY    BEGSR                                          CEU006
      *                                                                   CEU006
     C                     MOVE *BLANKS   N#INEU  1                       CEU006
     C           *LIKE     DEFN A6TPSD    N#TPSD                          CEU006
     C                     Z-ADD0         N#TPSD                          CEU006
      *                                                                   CEU006
     C           SNDCY     IFNE *BLANKS                                   CEU006
      *                                                                   CEU006
     C           SPYTP     IFEQ 'RP'                                      CEU006
      * Send error to screen                                              CEU006
     C                     MOVE *ON       *IN89                           CEU006
     C                     MOVE *ON       *IN08                           CEU006
     C                     MOVEL'FTM2561' FTMSID                          CEU006
     C                     Z-ADD1         PHW     50                      140640
     C                     EXSR FTSNMS                                    CEU006
     C                     ELSE                                           CEU006
      *                                                                   CEU006
      ** access currency file                                             CEU006
      *                                                                   CEU006
     C                     CALL 'AOCURRR0'                                CEU006
     C                     PARM *BLANKS   @RETC   7                       CEU006
     C                     PARM '*KEY   ' @OPTN   7                       CEU006
     C                     PARM SNDCY     @CURR   3                       CEU006
     C           SDCURR    PARM SDCURR    DSSDY                           CEU006
      *                                                                   CEU006
     C           @RETC     IFNE *BLANKS                                   CEU006
     C           A6INCY    ORNE 'Y'                                       CEU006
     C           SNDCY     ANDNEBKEURO                                    CEU006
      * Send error to screen                                              CEU006
     C                     MOVE *ON       *IN89                           CEU006
     C                     MOVE *ON       *IN08                           CEU006
     C                     MOVEL'FTM2562' FTMSID                          CEU006
     C                     Z-ADD1         PHW     50                      140640
     C                     EXSR FTSNMS                                    CEU006
     C                     ELSE                                           CEU006
     C           *LIKE     DEFN A6NBDP    N#CDP                           CEU006
     C                     Z-ADDA6NBDP    N#CDP                           CEU006
     C           A6INCY    IFEQ 'Y'                                       CEU006
     C                     MOVE 'I'       N#INEU                          CEU006
     C                     Z-ADDA6TPSD    N#TPSD                          CEU006
     C                     ELSE                                           CEU006
     C                     MOVE 'E'       N#INEU                          CEU006
     C                     ENDIF                                          CEU006
     C                     ENDIF                                          CEU006
     C                     ENDIF                                          CEU006
     C                     ENDIF                                          CEU006
      *                                                                   CEU006
     C                     ENDSR                                          CEU006
      *                                                                   CEU006
      ************************************************************        CEU006
      * END OF NOTIFIED DELIVERY CURRENCY VALIDATION                      CEU006
      ************************************************************        CEU006
     C/EJECT                                                              CEU006
      ************************************************************        CEU006
      * PYDLCY SR.                                                        CEU006
      * PAY DELIVERY CURRENCY VALIDATION                                  CEU006
      * OPTIONAL - MUST BE EUROS OR 'IN' CURRENCY                         CEU006
      ************************************************************        CEU006
      *                                                                   CEU006
     C           PYDLCY    BEGSR                                          CEU006
      *                                                                   CEU006
     C                     MOVE *BLANKS   P#INEU  1                       CEU006
     C           *LIKE     DEFN A6TPSD    P#TPSD                          CEU006
     C                     Z-ADD0         P#TPSD                          CEU006
      *                                                                   CEU006
     C           SPDCY     IFNE *BLANKS                                   CEU006
      *                                                                   CEU006
     C********** SPYTP     IFEQ 'RP'                                                CEU006 AR1036310
      **Send*error*to*screen*******************************************             CEU006 AR1036310
     C**********           MOVE *ON       *IN89                                     CEU006 AR1036310
     C**********           MOVE *ON       *IN10                                     CEU006 AR1036310
     C***********          MOVEL'FTM2563' FTMSID                   CEU006 CFT014
     C**********           MOVEL'FTM3247' FTMSID                                    CFT014 AR1036310
     C**********           Z-ADD1         PHW     50                                140640 AR1036310
     C**********           EXSR FTSNMS                                              CEU006 AR1036310
     C**********           ELSE                                                     CEU006 AR1036310
      *                                                                   CEU006
      ** access currency file                                             CEU006
      *                                                                   CEU006
     C                     CALL 'AOCURRR0'                                CEU006
     C                     PARM *BLANKS   @RETC   7                       CEU006
     C                     PARM '*KEY   ' @OPTN   7                       CEU006
     C                     PARM SPDCY     @CURR   3                       CEU006
     C           SDCURR    PARM SDCURR    DSSDY                           CEU006
     C           CFT014    IFNE 'Y'                                       CFT014
      *                                                                   CEU006
     C           @RETC     IFNE *BLANKS                                   CEU006
     C           A6INCY    ORNE 'Y'                                       CEU006
     C           SPDCY     ANDNEBKEURO                                    CEU006
      * Send error to screen                                              CEU006
     C                     MOVE *ON       *IN89                           CEU006
     C                     MOVE *ON       *IN10                           CEU006
     C***********          MOVEL'FTM2564' FTMSID                   CEU006 CFT014
     C                     MOVEL'FTM3248' FTMSID                          CFT014
     C                     Z-ADD1         PHW     50                      140640
     C                     EXSR FTSNMS                                    CEU006
     C                     ELSE                                           CEU006
     C           *LIKE     DEFN A6NBDP    P#CDP                           CEU006
     C                     Z-ADDA6NBDP    P#CDP                           CEU006
     C           A6INCY    IFEQ 'Y'                                       CEU006
     C                     MOVE 'I'       P#INEU                          CEU006
     C                     Z-ADDA6TPSD    P#TPSD                          CEU006
     C                     ELSE                                           CEU006
     C                     MOVE 'E'       P#INEU                          CEU006
     C                     ENDIF                                          CEU006
     C                     ENDIF                                          CEU006
      ** CFT014 is active                                                 CFT014
     C                     ELSE                                           CFT014
      ** Entry is not a valid currency code.                              CFT014
     C           @RETC     IFNE *BLANKS                                   CFT014
     C                     MOVE *ON       *IN10                           CFT014
     C                     MOVE *ON       *IN89                           CFT014
     C                     MOVEL'FTM3101' FTMSID                          CFT014
     C                     Z-ADD1         PHW                             CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     ELSE                                           CFT014
     C                     Z-ADDA6NBDP    P#CDP                           CFT014
      ** Currency is an 'In' currency.                                    CFT014
     C           CEU006    IFEQ 'Y'                                       CFT014
     C           A6INCY    ANDEQ'Y'                                       CFT014
     C                     MOVE 'I'       P#INEU                          CFT014
     C                     Z-ADDA6TPSD    P#TPSD                          CFT014
     C                     ELSE                                           CFT014
      ** Currency is a Euro currency.                                     CFT014
     C           CEU006    IFEQ 'Y'                                       CFT014
     C           SPDCY     ANDEQBKEURO                                    CFT014
     C                     MOVE 'E'       P#INEU                          CFT014
     C                     ELSE                                           CFT014
      ** Otherwise, an 'Out' currency.                                    CFT014
     C                     MOVE 'O'       P#INEU                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
     C**********           ENDIF                                                    CEU006 AR1036310
     C                     ENDIF                                          CEU006
      *                                                                   CEU006
     C                     ENDSR                                          CEU006
      *                                                                   CEU006
      ************************************************************        CEU006
      * END OF PAY DELIVERY CURRENCY VALIDATION                           CEU006
      ************************************************************        CEU006
     C/EJECT                                                              CEU006
     C************************************************************
     C* SETCUR SR.
     C* VALIDATION OF SETTLE CURRENCY
     C* MANDATORY - MUST BE OF TABLE TABTG10
     C*
     C           SETCUR    BEGSR
     C*                                                                   S01194
     C*********************MOVE *BLANK    KEY                             S01194
     C*********************MOVEL'20'      KEY                             S01194
     C*********************MOVELSSMCY     SCCY    4                       S01194
     C*********************MOVE '1'       SCCY                            S01194
     C*********************MOVE SCCY      KEY                             S01194
     C***********KEY*******CHAINTABTG10F             29                   S01194
     C**N29******RECI******COMP 'D'                  2929                 S01194
     C*                                                                   S01194
      *                                                                   CEU006
     C/COPY WNCPYSRC,FT0040C244
     C           SSMCY     IFEQ *BLANKS                                   CEU006
     C           N#INEU    ANDEQ'I'                                       CEU006
     C                     MOVE BKEURO    SSMCY                           CEU006
     C                     ENDIF                                          CEU006
      *                                                                   CEU006
     C                     CALL 'AOCURRR0'                                S01194
     C                     PARM *BLANKS   RTCD                            S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM SSMCY     @K101                           S01194
     C           SDCURR    PARM SDCURR    DSSDY                           S01194
     C*                                                                   S01194
     C           RTCD      COMP *BLANKS              2929                 S01194
     C*                                                                   S01194
     C           *IN29     IFEQ '1'                        B001
     C                     SETON                     89
     C*********************MOVEA' 047'    ERCD,Z                          S01117
     C                     MOVEA' 057'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     Z-ADD1         PHW     50                      140640
     C* IF NOT ON FILE MUST SET UP DECIMAL PLACES ETC
     C* FOR VALIDATION OF OTHER FIELD
     C                     Z-ADD0         PCDP    10
     C                     Z-ADD1         PSPOT  138
     C                     Z-ADD0         PMDIN   10
     C                     ELSE                            X001
      ** Determine if settlement currency is an 'In' or Euro currency     CFT014
     C                     MOVE *BLANK    WSINEU  1                       CFT014
      *                                                                   CEU006
     C           A6INCY    IFEQ 'Y'                                       CEU006
     C                     MOVE 'I'       WSINEU                          CFT014
     C                     Z-ADDA6TPSD    N#TPSD                          CEU006
     C                     ENDIF                                          CEU006
     C           SSMCY     IFEQ BKEURO                                    CFT014
     C                     MOVE 'E'       WSINEU                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CEU006
     C           N#INEU    IFEQ 'I'                                       CEU006
     C           SSMCY     ANDNEBKEURO                                    CEU006
     C           N#INEU    OREQ 'E'                                       CEU006
     C           A6INCY    ANDNE'Y'                                       CEU006
      * Send error to screen                                              CEU006
     C                     MOVE *ON       *IN89                           CEU006
     C                     MOVE *ON       *IN29                           CEU006
     C                     MOVEL'FTM2565' FTMSID                          CEU006
     C                     Z-ADD1         PHW     50                      140640
     C                     EXSR FTSNMS                                    CEU006
     C                     ENDIF                                          CEU006
      *                                                                   CEU006
     C*                                                                   S01194
     C** Move new standing data field into field used in program          S01194
     C*                                                                   S01194
     C           A6MDIN    IFEQ 'M'                                       S01194
     C                     Z-ADD1         MDIN    10                      S01194
     C                     ELSE                                           S01194
     C                     Z-ADD0         MDIN                            S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C*
     C* STORE DECIMAL PLACES SPOT RATE MULIPLY/DIVIDE IND
     C*********************Z-ADDCDP       PCDP                            S01194
     C                     Z-ADDA6NBDP    PCDP                            S01194
     C*********************Z-ADDSPOT      PSPOT                           S01194
     C                     Z-ADDA6SPRT    PSPOT                           S01194
     C                     Z-ADDMDIN      PMDIN
     C*********************MOVE '4'       KEY                             S01194
     C*********************MOVE SSMCY     @K101                           S01194
     C**READ*TABTG40                                                      S01194
     C*********************EXSR TG2RED                                    S01194
     C/COPY WNCPYSRC,FT0040C016
     C* CHANGE SPOT RATE BY BUY SPREAD
     C***********BSSG******IFEQ '+'                        B002           S01194
     C           A6BYSS    IFEQ '+'                        B002           S01194
     C***********SPOT******ADD  BSPR      PBRAT  138                      S01194
     C           A6SPRT    ADD  A6BYSR    PBRAT  138                      S01194
     C                     ELSE                            X002
     C***********SPOT******SUB  BSPR      PBRAT                           S01194
     C           A6SPRT    SUB  A6BYSR    PBRAT                           S01194
     C                     END                             E002
     C* CHANGE SPOT RATE BY SELL SPREAD
     C***********SSSG******IFEQ '+'                        B002           S01194
     C           A6SLSS    IFEQ '+'                        B002           S01194
     C***********SPOT******ADD  SSPR      PSRAT  138                      S01194
     C           A6SPRT    ADD  A6SLSR    PSRAT  138                      S01194
     C                     ELSE                            X002
     C***********SPOT******SUB  SSPR      PSRAT                           S01194
     C           A6SPRT    SUB  A6SLSR    PSRAT                           S01194
     C                     END                             E002
     C/COPY WNCPYSRC,FT0040C241
     C                     END                             E001
     C/COPY WNCPYSRC,FT0040C017
     C* IF SETTLEMENT TYPE IS 10 MUST BE STERLING
     C           SSTTP     IFEQ '10'                       B001
     C***********SSMCY*****ANDNESTCY                                      S01194
     C           SSMCY     ANDNEBLCYCD                                    S01194
     C                     SETON                     2989
     C*********************MOVEA' 396'    ERCD,Z                          S01117
     C                     MOVEA' 058'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     Z-ADD1         PHW     50                      140640
     C                     END                             E001
     C*
     C                     ENDSR
     C*
     C************************************************************
     C* END OF SETTLE CURRENCY VALIDATION
     C************************************************************
     C/EJECT
     C************************************************************
     C* SETAMT SR.
     C* VALIDATION OF SETTLE AMOUNT
     C*
     C           SETAMT    BEGSR
     C*
     C* MANDATORY IF PAY AMOUNT NOT ENTERED
     C* OTHERWISE NOT PERMITTED
     C           SPYTP     IFEQ 'RP'                                      CEU006
     C           SMAMA     IFEQ *BLANK                     B001
     C           PYAMA     ANDEQ*BLANK
     C           SMAMA     ORNE *BLANK
     C           PYAMA     ANDNE*BLANK
     C           RATEA     ANDEQ*BLANK                                    CFT009
     C                     SETON                     2889
     C*********************MOVEA' 045'    ERCD,Z                          S01117
     C                     MOVEA' 055'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     Z-ADD1         PHW     50                      140640
     C                     GOTO PYAEND
     C                     END                             E001
     C                     ENDIF                                          CEU006
     C* IF ENTERED VALIDATE
     C           SMAMA     IFNE *BLANK                     B001
     C                     MOVE *BLANK    ZFIELD
     C                     MOVE SMAMA     ZFIELD
     C           13        SUB  PCDP      ZADIG
     C                     Z-ADDPCDP      ZADEC
     C                     EXSR ZALIGN
     C           *IN99     IFEQ '1'                        B002
     C                     SETON                     2889
     C*********************MOVEA' 046'    ERCD,Z                          S01117
     C                     MOVEA' 056'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     Z-ADD1         PHW     50                      140640
     C                     ELSE                            X002
     C                     MOVE ZFIELD    SSMAM
     C/COPY WNCPYSRC,FT0040C151
     C                     MOVE 'P'       SFAIN   1
     C/COPY WNCPYSRC,FT0040C152
     C                     END                             E002
     C/COPY WNCPYSRC,FT0040C273
     C                     ELSE                            X001
     C                     Z-ADD0         SSMAM
     C                     END                             E001
     C*
      ** Move key fields to variable if CRE008 is installed.                                  CRE008
      *                                                                                       CRE008
     C           CRE008    IFEQ 'Y'                                                           CRE008
     C           *IN28     ANDEQ'0'                                                           CRE008
     C                     MOVE SSMAM     PSETAM 150                                          CRE008
     C                     ENDIF                                                              CRE008
      *                                                                                       CRE008
     C           PYAEND    ENDSR                           ** PYAEND
     C*
     C************************************************************
     C* END OF SETTLE AMOUNT VALIDATION
     C************************************************************
     C/EJECT
     C************************************************************
     C* PAYCUR SR.
     C* VALIDATION OF PAY CURRENCY
     C*
     C           PAYCUR    BEGSR
     C*
     C* MANDATORY - MUST BE ON TABLE TABTG10
     C           SPCCY     IFEQ *BLANK                     B001
     C           P#INEU    IFEQ 'I'                                       CEU006
     C                     MOVE BKEURO    SPCCY                           CEU006
     C                     ELSE                                           CEU006
     C                     MOVE SSMCY     SPCCY
     C                     ENDIF                                          CEU006
     C                     END                             E001
     C*********************MOVE *BLANK    KEY                             S01194
     C*********************MOVEL'20'      KEY                             S01194
     C*********************MOVELSPCCY     SCCY    4                       S01194
     C*********************MOVE '1'       SCCY                            S01194
     C*********************MOVE SCCY      KEY                             S01194
     C***********KEY*******CHAINTABTG10F             35                   S01194
     C**N35******RECI******COMP 'D'                  3535                 S01194
     C                     CALL 'AOCURRR0'                                S01194
     C                     PARM *BLANKS   RTCD                            S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM SPCCY     @K101                           S01194
     C           SDCURR    PARM SDCURR    DSSDY                           S01194
     C*                                                                   S01194
     C           RTCD      COMP *BLANKS              3535                 S01194
     C*                                                                   S01194
     C           *IN35     IFEQ '1'                        B001
     C                     SETON                     89
     C*********************MOVEA' 053'    ERCD,Z                          S01117
     C                     MOVEA' 066'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     Z-ADD1         PHW     50                      140640
     C* IF NOT ON FILE MUST SET UP DECIMAL PLACES ETC
     C* FOR VALIDATION OF OTHER FIELD
     C                     Z-ADD0         RCDP    10
     C                     Z-ADD1         RSPOT  138
     C                     Z-ADD0         RMDIN   10
     C                     ELSE                            X001
      ** Determine if pay currency is an 'In' or Euro currency            CFT014
     C                     MOVE *BLANK    WPINEU  1                       CFT014
      *                                                                   CEU006
     C           A6INCY    IFEQ 'Y'                                       CEU006
     C                     MOVE 'I'       WPINEU                          CFT014
     C                     Z-ADDA6TPSD    P#TPSD                          CEU006
     C                     ENDIF                                          CEU006
     C           SPCCY     IFEQ BKEURO                                    CFT014
     C                     MOVE 'E'       WPINEU                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CEU006
     C           P#INEU    IFEQ 'I'                                       CEU006
     C           SPCCY     ANDNEBKEURO                                    CEU006
     C           CFT014    ANDNE'Y'                                       CFT014
     C           P#INEU    OREQ 'E'                                       CEU006
     C           A6INCY    ANDNE'Y'                                       CEU006
     C           CFT014    ANDNE'Y'                                       CFT014
      * Send error to screen                                              CEU006
     C                     MOVE *ON       *IN89                           CEU006
     C                     MOVE *ON       *IN35                           CEU006
     C                     MOVE *ON       *IN10                           140652
     C***********          MOVEL'FTM2566' FTMSID                   CEU006 CFT014
     C                     MOVEL'FTM3249' FTMSID                          CFT014
     C                     Z-ADD1         PHW     50                      140640
     C                     EXSR FTSNMS                                    CEU006
     C                     ENDIF                                          CEU006
      *                                                                   CEU006
     C* STORE DECIMAL PLACES SPOT RATE MULIPLY/DIVIDE IND
     C*********************Z-ADDCDP       RCDP                            S01194
     C*********************Z-ADDSPOT      RSPOT                           S01194
     C*********************Z-ADDMDIN      RMDIN                           S01194
     C                     Z-ADDA6NBDP    RCDP                            S01194
     C                     Z-ADDA6SPRT    RSPOT                           S01194
     C*                                                                   S01194
     C** Move new standing data field into field used in program          S01194
     C*                                                                   S01194
     C           A6MDIN    IFEQ 'M'                                       S01194
     C                     Z-ADD1         RMDIN                           S01194
     C                     ELSE                                           S01194
     C                     Z-ADD0         RMDIN                           S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C*********************MOVE '4'       KEY                             S01194
     C**READ*CURRENCY*RECORD*TO*FOR*SPREAD                                S01194
     C*********************EXSR TG2RED                                    S01194
     C/COPY WNCPYSRC,FT0040C018
     C* CHANGE SPOT RATE BY SELL SPREAD
     C***********SSSG******IFEQ '+'                        B002           S01194
     C           A6SLSS    IFEQ '+'                        B002           S01194
     C***********SPOT******ADD  SSPR      RSRAT  138                      S01194
     C           A6SPRT    ADD  A6SLSR    RSRAT  138                      S01194
     C                     ELSE                            X002
     C***********SPOT******SUB  SSPR      RSRAT                           S01194
     C           A6SPRT    SUB  A6SLSR    RSRAT                           S01194
     C                     END                             E002
     C* CHANGE SPOT RATE BY BUY SPREAD
     C***********BSSG******IFEQ '+'                        B002           S01194
     C           A6BYSS    IFEQ '+'                        B002           S01194
     C***********SPOT******ADD  BSPR      RBRAT  138                      S01194
     C           A6SPRT    ADD  A6BYSR    RBRAT  138                      S01194
     C                     ELSE                            X002
     C***********SPOT******SUB  BSPR      RBRAT                           S01194
     C           A6SPRT    SUB  A6BYSR    RBRAT                           S01194
     C                     END                             E002
     C/COPY WNCPYSRC,FT0040C195
     C                     END                             E001
     C*
     C/COPY WNCPYSRC,FT0040C019
     C                     ENDSR
     C*
     C************************************************************
     C* END OF VALIDATION OF PAY CURRENCY
     C************************************************************
     C/EJECT
     C************************************************************
     C* PAYAMT SR.
     C* VALIDATION OF PAY AMOUNT
     C*
     C           PAYAMT    BEGSR
     C*
     C* MANDATORY IF SETTLE AMOUNT NOT ENTERED
     C* OTHERWISE NOT PERMITTED
     C           SPYTP     IFEQ 'RP'                                      CEU006
     C           SMAMA     IFEQ *BLANK                     B001
     C           PYAMA     ANDEQ*BLANK
     C           SMAMA     ORNE *BLANK
     C           PYAMA     ANDNE*BLANK
     C           RATEA     ANDEQ*BLANK                                    CFT009
     C                     SETON                     3489
     C*********************MOVEA' 050'    ERCD,Z                          S01117
     C                     MOVEA' 064'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     Z-ADD1         PHW     50                      140640
     C                     GOTO REAEND
     C                     END                             E001
     C                     ENDIF                                          CEU006
     C* IF ENTERED VALIDATE
     C           PYAMA     IFNE *BLANK                     B001
     C                     MOVE *BLANK    ZFIELD
     C                     MOVE PYAMA     ZFIELD
     C           13        SUB  RCDP      ZADIG
     C                     Z-ADDRCDP      ZADEC
     C                     EXSR ZALIGN
     C           *IN99     IFEQ '1'                        B002
     C                     SETON                     3489
     C*********************MOVEA' 052'    ERCD,Z                          S01117
     C                     MOVEA' 065'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     Z-ADD1         PHW     50                      140640
     C                     ELSE                            X002
     C                     MOVE ZFIELD    SPYAM
     C/COPY WNCPYSRC,FT0040C153
     C                     MOVE 'R'       SFAIN   1
     C/COPY WNCPYSRC,FT0040C154
     C                     END                             E002
     C                     ELSE                            X001
     C                     Z-ADD0         SPYAM
     C                     END                             E001
     C*
     C           REAEND    ENDSR                           ** REAEND
     C*
     C************************************************************
     C* END OF SETTLE AMOUNT VALIDATION
     C************************************************************
     C/EJECT
      ************************************************************        CEU006
      * NTDLAM SR.                                                        CEU006
      * VALIDATION OF NOTIFIED DELIVERY AMOUNT                            CEU006
      ************************************************************        CEU006
      *                                                                   CEU006
     C           NTDLAM    BEGSR                                          CEU006
      *                                                                   CEU006
     C                     SELEC                                          CEU006
      *                                                                   CEU006
     C           NDAMA     WHEQ *BLANK                                    CEU006
     C                     Z-ADD0         SNDAM                           CEU006
     C           SNDCY     WHEQ *BLANK                                    CEU006
      * Send error to screen                                              CEU006
     C                     MOVE *ON       *IN89                           CEU006
     C                     MOVE *ON       *IN08                           CEU006
     C                     MOVEL'FTM2567' FTMSID                          CEU006
     C                     Z-ADD1         PHW     50                      140640
     C                     EXSR FTSNMS                                    CEU006
     C           *IN08     WHEQ *OFF                                      CEU006
     C                     MOVE *BLANK    ZFIELD                          CEU006
     C                     MOVE NDAMA     ZFIELD                          CEU006
     C           13        SUB  N#CDP     ZADIG                           CEU006
     C                     Z-ADDN#CDP     ZADEC                           CEU006
     C                     EXSR ZALIGN                                    CEU006
     C           *IN99     IFEQ '1'                        B002           CEU006
      * Send error to screen                                              CEU006
     C                     MOVE *ON       *IN89                           CEU006
     C                     MOVE *ON       *IN09                           CEU006
     C                     MOVEL'FTM2568' FTMSID                          CEU006
     C                     Z-ADD1         PHW     50                      140640
     C                     EXSR FTSNMS                                    CEU006
     C                     ELSE                            X002           CEU006
     C                     MOVE ZFIELD    SNDAM                           CEU006
     C/COPY WNCPYSRC,FT0040C155
     C                     MOVE 'P'       SFAIN   1                       CEU006
     C/COPY WNCPYSRC,FT0040C156
     C                     ENDIF                           E002           CEU006
      *                                                                   CEU006
     C                     ENDSL                                          CEU006
      *                                                                   CEU006
     C                     ENDSR                                          CEU006
      *                                                                   CEU006
     C************************************************************        CEU006
     C* END OF SETTLE AMOUNT VALIDATION                                   CEU006
     C************************************************************        CEU006
     C/EJECT                                                              CEU006
      ************************************************************        CEU006
      * PYDLAM SR.                                                        CEU006
      * VALIDATION OF PAY DELIVERY AMOUNT                                 CEU006
      ************************************************************        CEU006
      *                                                                   CEU006
     C           PYDLAM    BEGSR                                          CEU006
      *                                                                   CEU006
     C                     SELEC                                          CEU006
      *                                                                   CEU006
     C           PDAMA     WHEQ *BLANK                                    CEU006
     C                     Z-ADD0         SPDAM                           CEU006
     C           SPDCY     WHEQ *BLANK                                    CEU006
      * Send error to screen                                              CEU006
     C                     MOVE *ON       *IN89                           CEU006
     C                     MOVE *ON       *IN10                           CEU006
     C***********          MOVEL'FTM2569' FTMSID                   CEU006 CFT014
     C                     MOVEL'FTM3250' FTMSID                          CFT014
     C                     Z-ADD1         PHW     50                      140640
     C                     EXSR FTSNMS                                    CEU006
     C           *IN10     WHEQ *OFF                                      CEU006
     C                     MOVE *BLANK    ZFIELD                          CEU006
     C                     MOVE PDAMA     ZFIELD                          CEU006
     C           13        SUB  P#CDP     ZADIG                           CEU006
     C                     Z-ADDP#CDP     ZADEC                           CEU006
     C                     EXSR ZALIGN                                    CEU006
     C           *IN99     IFEQ '1'                        B002           CEU006
      * Send error to screen                                              CEU006
     C                     MOVE *ON       *IN89                           CEU006
     C                     MOVE *ON       *IN11                           CEU006
     C***********          MOVEL'FTM2570' FTMSID                   CEU006 CFT014
     C                     MOVEL'FTM3251' FTMSID                          CFT014
     C                     Z-ADD1         PHW     50                      140640
     C                     EXSR FTSNMS                                    CEU006
     C                     ELSE                            X002           CEU006
     C                     MOVE ZFIELD    SPDAM                           CEU006
     C/COPY WNCPYSRC,FT0040C157
     C                     MOVE 'R'       SFAIN   1                       CEU006
     C/COPY WNCPYSRC,FT0040C158
     C                     ENDIF                           E002           CEU006
      *                                                                   CEU006
     C                     ENDSL                                          CEU006
      *                                                                   CEU006
     C                     ENDSR                                          CEU006
      *                                                                   CEU006
     C************************************************************        CEU006
     C* END OF PAY DELIVERY AMOUNT VALIDATION                             CEU006
     C************************************************************        CEU006
     C/EJECT                                                              CEU006
      ************************************************************        CEU006
      * EUXCHK SR.                                                        CEU006
      * CHECKS ENTERED AMOUNTS AGREE AND ALSO CALCULATES AN               CEU006
      * AMOUNT WHICH HAS BEEN LEFT BLANK.                                 CEU006
      * CURRENCIES AND AMOUNTS SHOULD BE VALID BEFORE CALLING             CEU006
      * THIS ROUTINE.                                                     CEU006
      ************************************************************        CEU006
      *                                                                   CEU006
     C           EUXCHK    BEGSR                                          CEU006
      *                                                                   CEU006
      ** Set paramaters for call to FT0010                                CEU006
      *                                                                   CEU006
     C                     CLEARP#0010                                    CEU006
      *                                                                   CEU006
     C                     MOVEL'FT0040'  P#PMSQ                          CEU006
      *                                                                   CEU006
     C                     MOVE SNDCY     P#NDCY                          CEU006
     C                     Z-ADDSNDAM     P#NDAM                          CEU006
     C*                                                                   172367
     C           CEU006    IFNE 'Y'                                       172367
     C                     MOVE *BLANKS   P#NDCY                          172367
     C                     Z-ADD0         P#NDAM                          172367
     C                     ENDIF                                          172367
     C*                                                                   172367
     C                     MOVE SSMCY     P#DBCY                          CEU006
     C                     Z-ADDSSMAM     P#DBAM                          CEU006
     C                     MOVE SSLDT     P#DBDT                          CEU006
     C                     MOVE SPCCY     P#CRCY                          CEU006
     C                     Z-ADDSPYAM     P#CRAM                          CEU006
     C           CFT014    IFEQ 'N'                                       CFT014
     C                     MOVE SPDCY     P#PDCY                          CEU006
     C                     Z-ADDSPDAM     P#PDAM                          CEU006
     C                     ENDIF                                          CFT014
     C                     MOVE SPYDT     P#CRDT                          CEU006
      *                                                                   CEU006
     C                     MOVE *BLANK    ZFIELD                          CEU006
     C                     MOVE RATEA     ZFIELD                          CEU006
     C**********           Z-ADD4         ZADIG                                      CEU006 AR895223
     C                     Z-ADD5         ZADIG                                             AR895223
     C                     Z-ADD8         ZADEC                           CEU006
     C                     EXSR ZALIGN                                    CEU006
      *                                                                   CEU006
     C           *IN99     IFEQ '1'                                       CEU006
     C                     SETON                     3189                 CEU006
     C                     MOVEA' 062'    ERCD,Z                          CEU006
     C                     ADD  1         Z                               CEU006
     C                     Z-ADD1         PHW     50                      140640
     C                     ELSE                                           CEU006
     C                     MOVE ZFIELD    SRATE                           CEU006
     C                     Z-ADDSRATE     P#RATE                          CEU006
     C                     MOVE SOVRD     P#OVRT                          CEU006
     C                     MOVE 'Y'       P#SDIN                          CEU006
     C                     Z-ADDRATDIS    P#RTDS                          CEU006
      *                                                                   CFT009
      ** If rate field is blank or 0, flag on default rate flag           CFT009
      *                                                                   CFT009
     C           SRATE0    IFEQ *ZEROS                                    CFT009
     C                     MOVE 'Y'       DEFRAT  1                       CFT009
     C                     ELSE                                           CFT009
     C                     MOVE *BLANKS   DEFRAT                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** If settle amount is blank , move '*CALCSET' into return code,    CFT009
      ** otherwise move '*CALCPAY' into return code for call of           CFT009
      ** FT000980                                                         CFT009
      *                                                                   CFT009
     C           SSMAM     IFEQ *ZEROS                                    CFT009
     C                     MOVEL'*CALCSET'RTN980                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVEL'*CALCPAY'RTN980                          CFT009
     C                     ENDIF                                          CFT009
     C/COPY WNCPYSRC,FT0040C129
      *                                                                   CEU006
     C                     CALL 'FT0010'                                  CEU006
     C                     PARM           P#0010                          CEU006
      *                                                                   CEU006
     C           P#RTCD    IFNE *BLANK                                    CEU006
     C                     MOVEL'AOCURRR0'DBFILE                          CEU006
     C                     MOVEL'*CALL'   DBKEY                           CEU006
     C                     Z-ADD41        DBASE                           CEU006
     C                     EXSR SRERR                                     CEU006
     C                     ENDIF                                          CEU006
      *                                                                   CEU006
      * Set Notified delivery amount (Formatted for screen)               CEU006
     C           SNDCY     IFNE *BLANK                                    CEU006
     C                     MOVE SNDCY     @K101                           CEU006
     C                     EXSR TG1RED                                    CEU006
     C                     MOVE *BLANK    DIG1                            CEU006
     C                     Z-ADDP#NDAM    DIG1N                           CEU006
     C                     Z-ADDP#NDAM    SNDAM                           CEU006
     C                     EXSR EDIT                                      CEU006
     C                     MOVEADIG2      NDAMA                           CEU006
     C                     ELSE                                           CEU006
     C                     MOVE *BLANKS   NDAMA                           CEU006
     C                     ENDIF                                          CEU006
      * Set Settle amount (Formatted for screen)                          CEU006
     C           SSMCY     IFNE *BLANK                                    CEU006
     C                     MOVE SSMCY     @K101                           CEU006
     C                     EXSR TG1RED                                    CEU006
     C                     MOVE *BLANK    DIG1                            CEU006
     C                     Z-ADDP#DBAM    DIG1N                           CEU006
     C                     Z-ADDP#DBAM    SSMAM                           CEU006
     C                     EXSR EDIT                                      CEU006
     C                     MOVEADIG2      SMAMA                           CEU006
     C                     ELSE                                           CEU006
     C                     MOVE *BLANKS   SMAMA                           CEU006
     C                     ENDIF                                          CEU006
      * Set Pay amount (Formatted for screen)                             CEU006
     C           SPCCY     IFNE *BLANK                                    CEU006
     C                     MOVE SPCCY     @K101                           CEU006
     C                     EXSR TG1RED                                    CEU006
     C                     MOVE *BLANK    DIG1                            CEU006
     C                     Z-ADDP#CRAM    DIG1N                           CEU006
     C                     Z-ADDP#CRAM    SPYAM                           CEU006
     C                     EXSR EDIT                                      CEU006
     C                     MOVEADIG2      PYAMA                           CEU006
     C                     ELSE                                           CEU006
     C                     MOVE *BLANKS   PYAMA                           CEU006
     C                     ENDIF                                          CEU006
      * Set Pay delivery amount (Formatted for screen)                    CEU006
     C           CFT014    IFNE 'Y'                                       CFT014
     C           SPDCY     IFNE *BLANK                                    CEU006
     C                     MOVE SPDCY     @K101                           CEU006
     C                     EXSR TG1RED                                    CEU006
     C                     MOVE *BLANK    DIG1                            CEU006
     C                     Z-ADDP#PDAM    DIG1N                           CEU006
     C                     Z-ADDP#PDAM    SPDAM                           CEU006
     C                     EXSR EDIT                                      CEU006
     C                     MOVEADIG2      PDAMA                           CEU006
     C                     ELSE                                           CEU006
     C                     MOVE *BLANKS   PDAMA                           CEU006
     C                     ENDIF                                          CEU006
     C                     ENDIF                                          CFT014
      * Set Rate (Formatted for screen)                                   CEU006
     C                     MOVE P#RATE    SRATE0                          CEU006
     C                     Z-ADDP#RATE    SRATE                           CEU006
     C                     Z-ADD8         A6NBDP                          CEU006
     C                     MOVE *BLANK    DIG1                            CEU006
     C                     Z-ADDSRATE0    DIG1N                           CEU006
     C                     EXSR EDIT                                      CEU006
     C                     MOVEADIG2      RATEA                           CEU006
      * Set multiply divide indicator (for file update)                   CEU006
     C                     Z-ADDP#MDIN    SMDIN                           CEU006
      *                                                                   CEU006
      * Set screen error indicator                                        CEU006
     C           '1'       SCAN P#INDC:1  RESULT  10                      CEU006
      *                                                                   CEU006
     C           RESULT    IFGT 0                                         CEU006
     C                     MOVE *ON       *IN89                           CEU006
     C                     Z-ADD1         PHW     50                      140640
     C                     ENDIF                                          CEU006
      * Set var. EUX to 'Y' if SR EUXCHK is processed.                    140640
     C                     MOVEL'Y'       EUX     1                       140640
      *                                                                   CEU006
      * Set screen indicators - Notified delivery amount                  CEU006
     C           1         SUBSTP#INDC:1  *IN09                           CEU006
      * Set screen indicator  - Settle amount                             CEU006
     C           1         SUBSTP#INDC:2  *IN28                           CEU006
      * Set screen indicator  - Pay amount                                CEU006
     C           1         SUBSTP#INDC:3  *IN34                           CEU006
      * Set screen indicator  - Pay delivery amount                       CEU006
     C           1         SUBSTP#INDC:4  *IN11                           CEU006
      * Set screen indicator  - Rate                                      CEU006
     C           1         SUBSTP#INDC:5  *IN31                           CEU006
      ** Default Instructed Amount if not entered.                        CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
      ** Setup FT0010 parameters to calculate instructed amount when      CFT014
      ** currency is entered while the amount is not.                     CFT014
     C           SPDCY     IFNE *BLANK                                    CFT014
     C           PDAMA     ANDEQ*BLANK                                    CFT014
     C           SPDCY     ORNE *BLANK                                    CFT014
     C           SPDAM     ANDEQ*ZERO                                     CFT014
     C                     CLEARP#0010                                    CFT014
     C                     MOVE SPCCY     P#FRCY                          CFT014
     C                     Z-ADDSPYAM     P#FRAM                          CFT014
     C                     MOVE SPDCY     P#TOCY                          CFT014
      ** Calculate Instructed amount via FT0010                           CFT014
     C                     CALL 'FT0010'                                  CFT014
     C                     PARM           P#0010                          CFT014
      ** Error calling FT0010                                             CFT014
     C           P#RTCD    IFEQ '*ERROR*'                                 CFT014
     C                     MOVEL'FT0010  'DBFILE                          CFT014
     C                     Z-ADD63        DBASE                           CFT014
     C                     MOVEL'*CALL '  DBKEY                           CFT014
     C                     EXSR SRERR                                     CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      ** Set Instructed amount (Formatted for screen)                     CFT014
     C           SPDCY     IFNE *BLANK                                    CFT014
     C                     MOVE SPDCY     @K101                           CFT014
     C                     EXSR TG1RED                                    CFT014
     C                     MOVE *BLANK    DIG1                            CFT014
     C           PDAMA     IFEQ *BLANK                                    CFT014
     C           SPDAM     OREQ *ZERO                                     CFT014
     C                     Z-ADDP#TOAM    DIG1N                           CFT014
     C                     Z-ADDP#TOAM    SPDAM                           CFT014
     C                     ELSE                                           CFT014
     C                     Z-ADDSPDAM     DIG1N                           CFT014
     C                     ENDIF                                          CFT014
     C                     EXSR EDIT                                      CFT014
     C                     MOVEADIG2      PDAMA                           CFT014
     C                     ENDIF                                          CFT014
      ** When Instructed currency/amount is blank, must be defaulted      CFT014
      ** to be the same as Pay currency and amount given that the sen     CFT014
      ** der and the receiver both support charge transparency            CFT014
     C           SPDCY     IFEQ *BLANK                                    CFT014
     C           PDAMA     ANDEQ*BLANK                                    CFT014
     C           SPYTP     ANDNE'RP'                                      CFT014
      ** Find out first the sender/receiver ISO Country Code to be        CFT014
      ** use in getting charge transparency indicator                     CFT014
     C                     EXSR SRRISO                                    CFT014
     C                     EXSR SRSISO                                    CFT014
      ** Access ISO country codes via LF/MEISOCL1 to get receiver         CFT014
      ** charge tranparency flag                                          CFT014
     C                     MOVELWRISOC    WISOC   2                       CFT014
     C                     EXSR SRISOC                                    CFT014
      ** Receiver charge transparency flag is 'Y', set 'Y' to receiver    CFT014
      ** transparency work field, otherwise 'N'.                          CFT014
     C           WTRANS    IFEQ 'Y'                                       CFT014
     C                     MOVE 'Y'       WRTRAN  1                       CFT014
     C                     ELSE                                           CFT014
     C                     MOVE 'N'       WRTRAN                          CFT014
     C                     ENDIF                                          CFT014
      ** Access ISO country codes via LF/MEISOCL1 to get sender           CFT014
      ** charge tranparency flag                                          CFT014
     C                     MOVELWSISOC    WISOC                           CFT014
     C                     EXSR SRISOC                                    CFT014
      ** Sender charge transparency flag is 'Y', set 'Y' to sender        CFT014
      ** transparency work field, otherwise 'N'.                          CFT014
     C           WTRANS    IFEQ 'Y'                                       CFT014
     C                     MOVE 'Y'       WSTRAN  1                       CFT014
     C                     ELSE                                           CFT014
     C                     MOVE 'N'       WSTRAN                          CFT014
     C                     ENDIF                                          CFT014
     C           WRTRAN    IFEQ 'Y'                                       CFT014
     C           WSTRAN    ANDEQ'Y'                                       CFT014
     C                     MOVELSPCCY     SPDCY                           CFT014
     C                     MOVELPYAMA     PDAMA                           CFT014
     C                     Z-ADDSPYAM     SPDAM                           CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      ** Validate original rate if entered.                               CFT014
     C           SORTE     IFNE *BLANK                                    CFT014
     C           WORTE     ANDNE*ZERO                                     CFT014
      ** Original Rate entry not allowed if Instructed Amount not         CFT014
      ** entered.                                                         CFT014
     C           PDAMA     IFEQ *BLANK                                    CFT014
     C           WORTE     ANDNE*ZERO                                     CFT014
     C           SPDAM     OREQ *ZERO                                     CFT014
     C           WORTE     ANDNE*ZERO                                     CFT014
     C                     MOVE *ON       *IN49                           CFT014
     C                     MOVE *ON       *IN89                           CFT014
     C                     MOVEL'FTM3103' FTMSID                          CFT014
     C                     Z-ADD1         PHW                             CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     ENDIF                                          CFT014
      ** Original Rate not entered.                                       CFT014
     C                     ELSE                                           CFT014
      ** Initialise original rate workfield                               CFT014
     C                     Z-ADD*ZERO     WORTE                           CFT014
     C           *IN35     IFEQ *OFF                                      CFT014
     C           SPCCY     ANDNE*BLANK                                    CFT014
     C           *IN34     ANDEQ*OFF                                      CFT014
     C           SPYAM     ANDNE*ZERO                                     CFT014
     C           *IN10     ANDEQ*OFF                                      CFT014
     C           SPDCY     ANDNE*BLANK                                    CFT014
     C           *IN11     ANDEQ*OFF                                      CFT014
     C           SPDAM     ANDNE*ZERO                                     CFT014
      ** Setup FT0010 parameters                                          CFT014
     C                     CLEARP#0010                                    CFT014
     C                     MOVE SPCCY     P#FRCY                          CFT014
     C                     Z-ADDSPYAM     P#FRAM                          CFT014
     C                     MOVE SPDCY     P#TOCY                          CFT014
     C                     Z-ADDSPDAM     P#TOAM                          CFT014
      ** Get multiply/divide indicator via FT0010                         CFT014
     C                     CALL 'FT0010'                                  CFT014
     C                     PARM           P#0010                          CFT014
      ** Error calling FT0010                                             CFT014
     C           P#RTCD    IFEQ '*ERROR*'                                 CFT014
     C                     MOVEL'FT0010  'DBFILE                          CFT014
     C                     Z-ADD62        DBASE                           CFT014
     C                     MOVEL'*CALL '  DBKEY                           CFT014
     C                     EXSR SRERR                                     CFT014
     C                     ENDIF                                          CFT014
      ** Get instructed amount decimal places                             CFT014
     C                     MOVELSPDCY     @K101                           CFT014
     C                     EXSR TG1RED                                    CFT014
     C                     Z-ADDWDECP     WPDDEC  10                      CFT014
      ** Get payment currency decimal places                              CFT014
     C                     MOVELSPCCY     @K101                           CFT014
     C                     EXSR TG1RED                                    CFT014
     C                     Z-ADDWDECP     WPYDEC  10                      CFT014
     C           WPDDEC    SUB  WPYDEC    N                               CFT014
     C                     SELEC                                          CFT014
      ** Same number of decimal places, set workfield same as amounts     CFT014
     C           N         WHEQ 0                                         CFT014
     C                     Z-ADDSPDAM     WPDAMT 110                      CFT014
     C                     Z-ADDSPYAM     WPYAMT 110                      CFT014
      ** Instructed amount dec. greater than the payment amount dec.,     CFT014
      ** align payment amount to instructed amount.                       CFT014
     C           N         WHGT 0                                         CFT014
     C           SPYAM     DIV  POWER,N   WPYAMT                          CFT014
     C                     Z-ADDSPDAM     WPDAMT                          CFT014
      ** Instructed amount dec. less  than the payment amount dec.,       CFT014
      ** align instructed amount to payment amount.                       CFT014
     C           N         WHLT 0                                         CFT014
     C                     Z-SUBN         N                               CFT014
     C           SPDAM     DIV  POWER,N   WPDAMT                          CFT014
     C                     Z-ADDSPYAM     WPYAMT                          CFT014
     C                     ENDSL                                          CFT014
      ** Calculate original rate depending on mult/div indicator          CFT014
      ** (1 = Multiply otherwise, Divide) and set result as default.      CFT014
     C           P#MDIN    IFEQ 1                                         CFT014
     C           WPDAMT    DIV  WPYAMT    WORTE                           CFT014
     C                     ELSE                                           CFT014
     C           WPYAMT    DIV  WPDAMT    WORTE                           CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      ** Set original rate screen field                                   CFT014
     C           SORTE     IFNE *BLANK                                    CFT014
     C           SORTE     OREQ *BLANK                                    CFT014
     C           WORTE0    ANDNE*ZERO                                     CFT014
     C                     Z-ADD8         A6NBDP                          CFT014
     C                     MOVE *BLANK    DIG1                            CFT014
     C                     Z-ADDWORTE0    DIG1N                           CFT014
     C                     EXSR EDIT                                      CFT014
     C                     MOVEADIG2      SORTE                           CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CEU006
      *                                                                   CEU006
     C                     ENDSR                                          CEU006
      *                                                                   CEU006
     C************************************************************        CEU006
     C* END OF CHECK ON ENTERED AMOUNTS                                   CEU006
      *****************************************************************   CFT014
      /TITLE SR/SRRISO                                                    CFT014
      *****************************************************************   CFT014
      *                                                               *   CFT014
      *  SRRISO - Find out Receiver ISO Country Code                  *   CFT014
      *                                                               *   CFT014
      *  Called By: EUXCHK Subroutine                                 *   CFT014
      *                                                               *   CFT014
      *  Calls:                                                       *   CFT014
      *  SRACCS   - Access standing data detail file                  *   CFT014
      *                                                               *   CFT014
      *****************************************************************   CFT014
     C           SRRISO    BEGSR                           *** SRRISO *** CFT014
     C                     MOVE *BLANK    WRISOC  2                       CFT014
     C                     SELEC                                          CFT014
      ** Destination type is SWIFT                                        CFT014
     C           SDSTT     WHEQ 'S'                                       CFT014
     C           2         SUBSTSDST1:5   WRISOC                          CFT014
      ** Destination type is Customer, Full Nostro, Retail and GL         CFT014
     C           SDSTT     WHEQ 'C'                                       CFT014
     C           SDSTT     OREQ 'F'                                       CFT014
     C           SDSTT     OREQ 'R'                                       CFT014
     C           SDSTT     OREQ 'G'                                       CFT014
     C                     SELEC                                          CFT014
      ** Full nostro, access nostro file to get customer number           CFT014
     C           SDSTT     WHEQ 'F'                                       CFT014
     C           3         SUBSTSDST1:1   WCYCD                           CFT014
     C           2         SUBSTSDST1:4   WNONB                           CFT014
     C                     MOVE *BLANKS   WCUSN                           CFT014
     C                     MOVE *BLANKS   WACCN                           CFT014
     C                     MOVE *BLANKS   WACSN                           CFT014
     C                     MOVE *BLANKS   WBRCD                           CFT014
     C                     MOVE *BLANKS   WCSSN                           CFT014
     C                     MOVE *BLANKS   WPNOI                           CFT014
     C                     MOVE 'N'       WACCS   1                       CFT014
     C                     EXSR SRACCS                                    CFT014
     C           WACOK     IFEQ 'Y'                                       CFT014
     C                     MOVELA7CUST    WCNUM  10                       CFT014
     C                     ENDIF                                          CFT014
      ** Customer, might be a customer name or a customer number.         CFT014
     C           SDSTT     WHEQ 'C'                                       CFT014
     C           10        SUBSTSDST1:1   WCNUM                           CFT014
      ** Retail, or GL, get customer number.                              CFT014
     C           SDSTT     WHEQ 'R'                                       CFT014
     C           10        SUBSTSDST1:1   WALN10 10                       CFT014
     C                     MOVE WALN10    ACNO                            CFT014
     C           ACNO      CHAINACNUMAF              60                   CFT014
     C           *IN60     IFEQ '0'                                       CFT014
     C           RECI      ANDEQ'D'                                       CFT014
     C                     MOVE RETNUM    WCNUM6  6                       CFT014
     C                     MOVELWCNUM6    WCNUM                           CFT014
     C                     ENDIF                                          CFT014
     C           SDSTT     WHEQ 'G'                                       CFT014
     C           6         SUBSTSDST1:1   WCNUM                           CFT014
     C                     ENDSL                                          CFT014
      ** Access customer's file to get SWIFT id                           CFT014
     C                     MOVE 'C'       WACCS                           CFT014
     C                     EXSR SRACCS                                    CFT014
     C           WACOK     IFEQ 'Y'                                       CFT014
     C           BBCSID    IFNE *BLANK                                    CFT014
     C                     MOVELBBCSID    WSWIFT 12                       CFT014
     C           2         SUBSTWSWIFT:5  WRISOC                          CFT014
     C                     ELSE                                           CFT014
      ** No SWIFT id, get country code                                    CFT014
     C                     MOVELBBCOLC    WCNCD   2                       CFT014
      ** Get ISO Country Code via access object AOCTRYR0                  CFT014
     C                     MOVE 'O'       WACCS                           CFT014
     C                     EXSR SRACCS                                    CFT014
     C           WACOK     IFEQ 'Y'                                       CFT014
     C                     MOVELA4ISOC    WRISOC                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDSL                                          CFT014
     C                     ENDSR                                          CFT014
      ************************************************************        CFT014
      * End of Receiver ISO Code                                          CFT014
      *****************************************************************   CFT014
      /TITLE SR/SRSISO                                                    CFT014
      *****************************************************************   CFT014
      *                                                               *   CFT014
      *  SRSISO - Find out Sender ISO Country Code                    *   CFT014
      *                                                               *   CFT014
      *  Called By: EUXCHK Subroutine                                 *   CFT014
      *                                                               *   CFT014
      *  Calls:                                                       *   CFT014
      *  SRACCS   - Access to standing data detail file               *   CFT014
      *                                                               *   CFT014
      *****************************************************************   CFT014
     C           SRSISO    BEGSR                           *** SRSISO *** CFT014
     C                     MOVE *BLANK    WSISOC  2                       CFT014
      ** If multi-branching environment access branch file thru           CFT014
      ** booking branch, otherwise thru single branch code                CFT014
     C           *IN57     IFEQ *ON                                       CFT014
     C                     MOVELSBRCA     WMBRCA  3                       CFT014
     C                     ELSE                                           CFT014
     C                     MOVELBJSBRC    WMBRCA                          CFT014
     C                     ENDIF                                          CFT014
      ** Get SWIFT Id via access object AOBRCHR0                          CFT014
     C                     MOVE 'B'       WACCS                           CFT014
     C                     EXSR SRACCS                                    CFT014
     C           WACOK     IFEQ 'Y'                                       CFT014
      ** Get ISO Country code via SWIFT Id.                               CFT014
     C                     SELEC                                          CFT014
     C           A8BTID    WHNE *BLANK                                    CFT014
     C           2         SUBSTA8BTID:5  WSISOC                          CFT014
      ** No SWIFT Id., get ISO Country code via location code.            CFT014
     C           A8LCCD    WHNE *BLANK                                    CFT014
     C                     MOVELA8LCCD    WLCCD   3                       CFT014
      ** Get country code via access object AOLOCNR0                      CFT014
     C                     MOVE 'L'       WACCS                           CFT014
     C                     EXSR SRACCS                                    CFT014
     C           WACOK     IFEQ 'Y'                                       CFT014
     C                     MOVELDVCNCD    WCNCD                           CFT014
      ** Get ISO Country Code via access object AOCTRYR0                  CFT014
     C                     MOVE 'O'       WACCS                           CFT014
     C                     EXSR SRACCS                                    CFT014
     C           WACOK     IFEQ 'Y'                                       CFT014
     C                     MOVELA4ISOC    WSISOC                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      ** Otherwise, use customer number to derive the ISO Country Code.   CFT014
     C                     OTHER                                          CFT014
     C                     MOVELA8BICN    WCNUM                           CFT014
      ** Access customer's file to get SWIFT id                           CFT014
     C                     MOVE 'C'       WACCS                           CFT014
     C                     EXSR SRACCS                                    CFT014
     C           WACOK     IFEQ 'Y'                                       CFT014
     C           BBCSID    IFNE *BLANK                                    CFT014
     C                     MOVELBBCSID    WSWIFT                          CFT014
     C           2         SUBSTWSWIFT:5  WSISOC                          CFT014
     C                     ELSE                                           CFT014
      ** No SWIFT id, get country code                                    CFT014
     C                     MOVELBBCOLC    WCNCD                           CFT014
      ** Get ISO Country Code via access object AOCTRYR0                  CFT014
     C                     MOVE 'O'       WACCS                           CFT014
     C                     EXSR SRACCS                                    CFT014
     C           WACOK     IFEQ 'Y'                                       CFT014
     C                     MOVELA4ISOC    WSISOC                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDSL                                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDSR                                          CFT014
      ************************************************************        CFT014
      * End of Sender ISO Code                                            CFT014
      ************************************************************        CFT014
      /TITLE SR/SRACCS                                                    CFT014
      *****************************************************************   CFT014
      *                                                               *   CFT014
      *  SRACCS - Accesses Customer, Nostro, Location, Country Code   *   CFT014
      *           and Branch code detail file.                        *   CFT014
      *                                                               *   CFT014
      *  Called By: SRRISO and SRSISO subroutines                     *   CFT014
      *                                                               *   CFT014
      *  Calls:                                                       *   CFT014
      *  AOCUSTR0 - Access to customer's file                         *   CFT014
      *  AOLOCNR0 - Access to location code's file                    *   CFT014
      *  AONOSTR0 - Access to Nostro file                             *   CFT014
      *  AOCTRYR0 - Access to country code's file                     *   CFT014
      *  AOBRCHR0 - Access to Branch code                             *   CFT014
      *                                                               *   CFT014
      *****************************************************************   CFT014
     C           SRACCS    BEGSR                           *** SRACCS *** CFT014
      ** Initialise access OK indicator                                   CFT014
     C                     MOVE 'N'       WACOK   1                       CFT014
      ** Access detail file according to access indicator                 CFT014
     C                     SELEC                                          CFT014
      ** Customer                                                         CFT014
     C           WACCS     WHEQ 'C'                                       CFT014
     C                     CALL 'AOCUSTR0'             9090               CFT014
     C                     PARM *BLANKS   WRTRN   7                       CFT014
     C                     PARM '*KEY   ' WOPTN   7                       CFT014
     C                     PARM WCNUM     WKEY1  10                       CFT014
     C                     PARM *BLANKS   WKYST   7                       CFT014
     C           SDCUST    PARM SDCUST    DSSDY                           CFT014
     C           WRTRN     IFEQ *BLANK                                    CFT014
     C           *IN90     ANDEQ*OFF                                      CFT014
     C                     MOVE 'Y'       WACOK                           CFT014
     C                     ELSE                                           CFT014
     C                     MOVEL'SDCUSTPD'W0FILE                          CFT014
     C                     Z-ADD200       W0ERNB                          CFT014
     C                     MOVELWCNUM     W0KEY                           CFT014
     C                     ENDIF                                          CFT014
      ** Nostro                                                           CFT014
     C           WACCS     WHEQ 'N'                                       CFT014
     C                     CALL 'AONOSTR0'             9090               CFT014
     C                     PARM *BLANKS   WRTRN                           CFT014
     C                     PARM '*KEY   ' WOPTN                           CFT014
     C                     PARM           WCUSN   6                       CFT014
     C                     PARM           WCYCD   3                       CFT014
     C**********           PARM           WACCN   4                                    CFT014 CGL029
     C                     PARM           WACCN  10                                           CGL029
     C                     PARM           WACSN   2                       CFT014
     C                     PARM           WNONB   2                       CFT014
     C                     PARM           WBRCD   3                       CFT014
     C                     PARM           WCSSN  10                       CFT014
     C                     PARM           WPNOI   1                       CFT014
     C           SDNOST    PARM SDNOST    DSFDY                           CFT014
     C           WRTRN     IFEQ *BLANK                                    CFT014
     C           *IN90     ANDEQ*OFF                                      CFT014
     C                     MOVE 'Y'       WACOK                           CFT014
     C                     ELSE                                           CFT014
     C                     MOVEL'SDNOSTPD'W0FILE                          CFT014
     C                     Z-ADD201       W0ERNB                          CFT014
     C                     MOVELWOPTN     W0KEY                           CFT014
     C                     ENDIF                                          CFT014
      ** Location                                                         CFT014
     C           WACCS     WHEQ 'L'                                       CFT014
     C                     CALL 'AOLOCNR0'             9090               CFT014
     C                     PARM *BLANKS   WRTRN                           CFT014
     C                     PARM '*KEY   ' WOPTN                           CFT014
     C                     PARM WLCCD     WLOCN   3                       CFT014
     C           SDLOCN    PARM SDLOCN    DSFDY                           CFT014
     C           WRTRN     IFEQ *BLANK                                    CFT014
     C           *IN90     ANDEQ*OFF                                      CFT014
     C                     MOVE 'Y'       WACOK                           CFT014
     C                     ELSE                                           CFT014
     C                     MOVEL'SDLOCNPD'W0FILE                          CFT014
     C                     Z-ADD202       W0ERNB                          CFT014
     C                     MOVELWLCCD     W0KEY                           CFT014
     C                     ENDIF                                          CFT014
      ** Country Code                                                     CFT014
     C           WACCS     WHEQ 'O'                                       CFT014
     C                     CALL 'AOCTRYR0'             9090               CFT014
     C                     PARM *BLANKS   WRTRN                           CFT014
     C                     PARM '*KEY   ' WOPTN                           CFT014
     C                     PARM WCNCD     WCTCD   2                       CFT014
     C           SDCTRY    PARM SDCTRY    DSFDY                           CFT014
     C           WRTRN     IFEQ *BLANK                                    CFT014
     C           *IN90     ANDEQ*OFF                                      CFT014
     C                     MOVE 'Y'       WACOK                           CFT014
     C                     ELSE                                           CFT014
     C                     MOVEL'SDCTRYPD'W0FILE                          CFT014
     C                     Z-ADD203       W0ERNB                          CFT014
     C                     MOVELWCNCD     W0KEY                           CFT014
     C                     ENDIF                                          CFT014
      ** Branch                                                           CFT014
     C           WACCS     WHEQ 'B'                                       CFT014
     C**********           CALL 'AOBRCHR0'                                             CFT014 CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM *BLANKS   WRTRN                           CFT014
     C                     PARM '*KEY   ' WOPTN                           CFT014
     C                     PARM WMBRCA    WBRCD   3                       CFT014
     C********** SDBRCH    PARM SDBRCH    DSFDY                                        CFT014 CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C           WRTRN     IFEQ *BLANK                                    CFT014
     C           *IN90     ANDEQ*OFF                                      CFT014
     C                     MOVE 'Y'       WACOK                           CFT014
     C                     ELSE                                           CFT014
     C                     MOVEL'SDBRCHPD'W0FILE                          CFT014
     C                     Z-ADD204       W0ERNB                          CFT014
     C                     MOVELWMBRCA    W0KEY                           CFT014
     C                     ENDIF                                          CFT014
     C                     ENDSL                                          CFT014
     C                     ENDSR                                          CFT014
      ************************************************************        CFT014
      * End of Access Subroutine                                          CFT014
      ************************************************************        CFT014
      /TITLE SR/SRISOC                                                    CFT014
      *****************************************************************   CFT014
      *                                                               *   CFT014
      *  SRISOC - Access to ISO Country Codes file                    *   CFT014
      *                                                               *   CFT014
      *  Called By: EUXCHK Subroutine                                 *   CFT014
      *                                                               *   CFT014
      *  Calls: None                                                  *   CFT014
      *                                                               *   CFT014
      *****************************************************************   CFT014
     C           SRISOC    BEGSR                           *** SRISOC *** CFT014
     C                     MOVE *OFF      *IN60                           CFT014
     C                     MOVE *BLANK    WTRANS  1                       CFT014
     C           WISOC     CHAINMEISOCL1             60                   CFT014
     C           *IN60     IFEQ *OFF                                      CFT014
     C                     MOVELM3SCHT    WTRANS                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDSR                                          CFT014
      ************************************************************        CFT014
      * End of Sender ISO Code                                            CFT014
      ************************************************************        CFT014
     C************************************************************        CEU006
     C/EJECT                                                              CEU006
     C************************************************************
     C* OVRRDE SR.
     C* VALIDATION OF OVERRIDE FLAG
     C* OPTIONAL DEFAULT OF 'N'
     C* IF ENTERED MUST EQUAL 'N' OR 'Y'
     C*
     C           OVRRDE    BEGSR
     C*
     C           SOVRD     IFEQ *BLANK                     B001
     C                     MOVE 'N'       SOVRD
     C                     END                             E001
     C/COPY WNCPYSRC,FT0040C127
     C           SOVRD     IFNE 'N'                        B001
     C           SOVRD     ANDNE'Y'
     C/COPY WNCPYSRC,FT0040C103
     C                     SETON                     3289
     C*********************MOVEA' 049'    ERCD,Z                          S01117
     C                     MOVEA' 063'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     Z-ADD1         PHW     50                      140640
     C                     END                             E001
     C/COPY WNCPYSRC,FT0040C128
     C*
     C                     ENDSR
     C*
     C************************************************************
     C* END OF VALIDATION OF OVERRIDE FLAG
     C************************************************************
     C/EJECT
     C************************************************************
     C* RATES SR.
     C* VALIDAION OF RATE
     C* OPTIONAL DEFAULTS TO CROSS RATE
     C* IF REGULAR PAYMENT NOT PERMITTED
     C*
     C           RATES     BEGSR
     C*
     C* CHECK IF SETTLE OR PAY CCY AMENDED AND RATE NOT ALTERED.
     C*
     C           ACTION    IFEQ 'A'
      *
     C           SSMCY     IFNE OSMCY
     C           SPCCY     ORNE OPCCY
      *
     C           RATEA     IFEQ RATEAO
     C                     SETON                     3189
     C*********************MOVEA' 423'    ERCD,Z                          S01117
     C                     MOVEA' 059'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     Z-ADD1         PHW     50                      140640
     C                     END
      *
     C                     END
      *
     C                     END
     C*
     C/COPY WNCPYSRC,FT0040C022
     C                     EXSR RATDEF
     C/COPY WNCPYSRC,FT0040C023
      *
     C           RATEA     IFEQ *BLANK                     B001
     C                     Z-ADDDRATE     SRATE
     C                     Z-ADDDMDIN     SMDIN
     C                     ELSE                            X001
      *
     C* CHECK IF VALID NUMERIC
      *
     C                     MOVE *BLANK    ZFIELD
     C                     MOVE RATEA     ZFIELD
     C**********           Z-ADD4         ZADIG                                             AR895223
     C                     Z-ADD5         ZADIG                                             AR895223
     C                     Z-ADD8         ZADEC
     C                     EXSR ZALIGN
      *
     C           *IN99     IFEQ '1'                        B002
     C                     SETON                     3189
     C*********************MOVEA' 120'    ERCD,Z                          S01117
     C                     MOVEA' 062'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     Z-ADD1         PHW     50                      140640
     C                     ELSE                            X002
     C                     MOVE ZFIELD    SRATE
      *
     C           DRATE     IFGT 1                          B003
     C           SRATE     ANDGT1
     C           DRATE     ORLE 1
     C           SRATE     ANDLE1
     C                     Z-ADDDMDIN     SMDIN
     C                     ELSE                            X003
     C           1         SUB  DMDIN     SMDIN
     C                     END                             E003
      *
     C           SOVRD     IFNE 'Y'                        B003
     C           SSMCY     OREQ SPCCY                                     041692
     C           SOVRD     ANDEQ'Y'                                       041692
     C                     EXSR RATVAL
     C                     END                             E003
      *
     C                     END                             E002
      *
     C                     END                             E001
      *
     C/COPY WNCPYSRC,FT0040C056
     C           CEU006    IFNE 'Y'                                       CEU006
     C  N31                EXSR RATCAL
     C                     ENDIF                                          CEU006
     C/COPY WNCPYSRC,FT0040C057
     C*
     C                     ENDSR
     C*
     C************************************************************
     C* END OF RATE VALIDATION
     C************************************************************
     C/EJECT
     C************************************************************
     C* RATDEF SR.
     C* DEFAULT RATE CALCULATION
     C*
     C           RATDEF    BEGSR
     C*
     C* SETUP TO AND FROM RATES
     C           SSMAM     IFEQ 0                          B001
     C                     MOVE SSMCY     TCCY    3
     C                     MOVE SPCCY     FCCY    3
     C                     Z-ADDPBRAT     TSRAT  138
     C                     Z-ADDPMDIN     TMDIN   10
     C                     Z-ADDPCDP      TCDP    10
     C                     Z-ADDRSRAT     FBRAT  138
     C                     Z-ADDRMDIN     FMDIN   10
     C                     Z-ADDRSRAT     FSRAT  138
     C                     Z-ADDRCDP      FCDP    10
     C                     ELSE                            X001
     C                     MOVE SSMCY     FCCY
     C                     MOVE SPCCY     TCCY
     C                     Z-ADDPBRAT     FBRAT  138
     C                     Z-ADDPMDIN     FMDIN
     C                     Z-ADDPCDP      FCDP    10
     C                     Z-ADDPBRAT     FSRAT
     C                     Z-ADDRSRAT     TSRAT  138
     C                     Z-ADDRMDIN     TMDIN
     C                     Z-ADDRCDP      TCDP    10
     C                     END                             E001
     C* IF CURRENCIES EQUAL RATE IS 1.0
     C           FCCY      IFEQ TCCY                       B001
     C                     Z-ADD1         DRATE  138
     C                     Z-ADD0         DMDIN   10
     C                     ELSE                            X001
     C* IF FROM CURRENCY IS BASE RATE IS TO CURRENCY
     C***********FCCY******IFEQ BCCY                       B002           S01194
     C           FCCY      IFEQ BJCYCD                     B002           S01194
     C                     Z-ADDTSRAT     DRATE
     C           1         SUB  TMDIN     DMDIN
     C                     ELSE                            X002
     C* IF TO CURRENCY IS BASE RATE IS FROM CURRENCY
     C***********TCCY******IFEQ BCCY                       B003           S01194
     C           TCCY      IFEQ BJCYCD                     B003           S01194
     C                     Z-ADDFSRAT     DRATE
     C                     Z-ADDFMDIN     DMDIN
     C                     ELSE                            X003
     C* IF NEITHER CURRENCY IS BASE
     C* IF BOTH DIVIDE CURRENCIES
     C           FMDIN     IFEQ 0                          B004
     C           TMDIN     IFEQ 0                          B005
     C* RATE IS TO SELL RATE DIVIDE BY FROM BUY RATE
     C           TSRAT     DIV  FBRAT     DRATE     H
     C                     Z-ADD1         DMDIN
     C           DRATE     IFLT 1                          B006
     C           FBRAT     DIV  TSRAT     DRATE     H
     C                     Z-ADD0         DMDIN
     C                     END                             E006
     C                     ELSE                            X005
     C           FBRAT     MULT TSRAT     DRATE     H
     C                     Z-ADD0         DMDIN
     C           DRATE     IFLT 1                          B006
     C           1         DIV  DRATE     DRATE     H
     C                     Z-ADD1         DMDIN
     C                     END                             E006
     C                     END                             E005
     C                     ELSE                            X004
     C           TMDIN     IFEQ 0                          B005
     C           TSRAT     MULT FBRAT     DRATE     H
     C                     Z-ADD1         DMDIN
     C           DRATE     IFLT 1                          B006
     C           1         DIV  DRATE     DRATE     H
     C                     Z-ADD0         DMDIN
     C                     END                             E006
     C                     ELSE                            X005
     C           FBRAT     DIV  TSRAT     DRATE     H
     C                     Z-ADD1         DMDIN
     C           DRATE     IFLT 1                          B006
     C           TSRAT     DIV  FBRAT     DRATE     H
     C                     Z-ADD0         DMDIN
     C                     END                             E006
     C                     END                             E005
     C                     END                             E004
     C                     END                             E003
     C                     END                             E002
     C                     END                             E001
     C*
     C                     ENDSR
     C*
     C************************************************************
     C* END DEFAULT RATE CALCULATION
     C************************************************************
     C/EJECT
     C************************************************************
     C* RATCAL SR.
     C* UNENTERED VALUE CALCULATION
     C*
     C           RATCAL    BEGSR
     C*
     C           SSMAM     IFEQ 0                          B001
     C           RCDP      SUB  PCDP      N       10
     C                     ADD  4         N
     C           SMDIN     IFEQ 1                          B002
     C           SRATE     DIV  POWER,N   WK159  159H
     C           SPYAM     MULT WK159     SSMAM     H
     C                     ELSE                            X002
     C           SRATE     MULT POWER,N   WK159     H
     C           SPYAM     DIV  WK159     SSMAM     H
     C                     END                             E002
     C                     ELSE                            X001
     C           PCDP      SUB  RCDP      N       10
     C                     ADD  4         N
     C           SMDIN     IFEQ 1                          B002
     C           SRATE     DIV  POWER,N   WK159  159H
     C           SSMAM     MULT WK159     SPYAM     H
     C                     ELSE                            X002
     C           SRATE     MULT POWER,N   WK159     H
     C           SSMAM     DIV  WK159     SPYAM     H
     C                     END                             E002
     C                     END                             E001
     C*
     C                     ENDSR
     C*
     C************************************************************
     C* END UNENTERED VALUE CALCULATION
     C************************************************************
     C/EJECT
     C************************************************************
     C* RATVAL SR.
     C* VALIDATE RATE WHEN ENTERED
     C*
     C           RATVAL    BEGSR
     C*
     C           SRPAY     IFEQ 'Y'                        B001
     C                     SETON                     3189
     C*********************MOVEA' 282'    ERCD,Z                          S01117
     C                     MOVEA' 061'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     Z-ADD1         PHW     50                      140640
     C                     ELSE                            X001
     C           SSMCY     IFEQ SPCCY                      B002
     C           SRATE     IFNE 1                          B003
     C                     SETON                     3189
     C*********************MOVEA' 048'    ERCD,Z                          S01117
     C                     MOVEA' 060'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     Z-ADD1         PHW     50                      140640
     C                     END                             E003
     C                     ELSE                            X002
      *
      ** Upper and lower limits are determined by % rate discrepancy
      **     from payment charges file .
     C           DRATE     MULT UPMARG    UPRATE 138H
     C           DRATE     MULT LWMARG    DORATE 138H
     C           SRATE     IFLT DORATE                     B002
     C           SRATE     ORGT UPRATE
      *
      ** Entered rate may be Pay ccy/Receive ccy or vice versa
      **     (whichever is nearer the default rate(DRATE) is assumed)
     C           1         DIV  DRATE     DRATE
     C           DRATE     MULT UPMARG    UPRATE 138H
     C           DRATE     MULT LWMARG    DORATE 138H
     C           SRATE     IFLT DORATE                     B004
     C           SRATE     ORGT UPRATE
     C                     SETON                     3189
     C*********************MOVEA' 048'    ERCD,Z                          S01117
     C                     MOVEA' 060'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     Z-ADD1         PHW     50                      140640
     C                     END                             E004
     C                     END                             E003
     C                     END                             E002
     C                     END                             E001
     C*
     C                     ENDSR
     C*
     C************************************************************
     C* END OF ENTERED RATE VALIDATION
     C************************************************************
     C/EJECT
     C************************************************************
     C* SETDAT SR.
     C* VALIDATION OF SETTLE DATE
     C* OPTIONAL DEFAULTS TO RUN DATE
     C*
     C           SETDAT    BEGSR
     C*
     C                     SETOF                     99
     C/COPY WNCPYSRC,FT0040C089
     C           PYDT      IFEQ *BLANK                     B001
     C*********************Z-ADDRUND      ZDAYNO                          S01194
     C                     Z-ADDBJRDNB    ZDAYNO                          S01194
     C                     MOVE RUNN      ZDATE
      *                                                                   CFT009
      ** Check for key change if CFT009 is on.                            CFT009
      *                                                                   CFT009
     C           CFT009    IFEQ 'Y'                                       CFT009
     C                     MOVEL'Y'       NODFLT  1                       CFT009
     C           *IN13     IFEQ '1'                                       CFT009
     C***********CDRO      ANDEQ0                                         CFT009              CSD027
     C           CDRO      ANDEQ*BLANKS                                                       CSD027
     C           SADDC     IFNE ADDC                                      CFT009
     C           SMCY      ANDNEPCCY                                      CFT009
     C           SPCCY     ORNE PCCY                                      CFT009
     C           SADDC     ANDEQ'D'                                       CFT009
     C           SSMCY     ORNE SMCY                                      CFT009
     C           SADDC     ANDEQ'A'                                       CFT009
     C           WRDFTC    OREQ 'Y'                                       CFT009
     C           SMAM      ORNE SSMAM                                     CFT009
     C           RATE      ORNE SRATE                                     CFT009
     C                     MOVEL'N'       NODFLT                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C           CFT009    IFEQ 'N'                                       CFT009
      * Doesn't set up date if F12 and remove dates & offset code         CFT009
     C           F12       OREQ 'Y'                                       CFT009
     C           PYDT      ANDEQ*BLANKS                                   CFT009
     C           SOFCD     ANDEQ*BLANKS                                   CFT009
     C           NODFLT    ANDEQ'Y'                                       CFT009
     C                     MOVE RUNN      PYDT
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Default flag for settle date                                     CFT009
      *                                                                   CFT009
     C                     MOVE 'Y'       DFSDAT                          CFT009
     C                     ELSE                            X001
     C                     MOVE 'N'       DFSDAT  1                       CFT009
     C* CHECK IF DATE IS NUMERIC
     C                     MOVELPYDT      DATEL   70
     C                     MOVELDATEL     DATES   6
     C           PYDT      IFNE DATES                      B002
     C                     SETON                     99
     C                     ELSE                            X002
     C                     MOVE PYDT      ZDATE
     C                     EXSR ZDATE1
      *
      ** THE SETTLE DATE MUST NOT BE A HOLIDAY IN LOCAL CURRENCY          E32543
      *                                                                   E32543
     C                     MOVE BJLCCY    ZCCY                            E32543
     C                     EXSR ZCHKH                                     E32543
      *                                                                   E32543
      ** if ZIND = 'H' then the date is a holiday                         E32543
     C           ZIND      IFEQ 'H'                                       E32543
     C                     SETON                     723089               E32543
     C*********************MOVEA' W10'    ERCD,Z                    E32543S01117
     C                     MOVEA' W02'    ERCD,Z                          S01117
     C                     ADD  1         Z                               E32543
     C                     END                                            E32543
     C                     END                             E002
     C                     END                             E001
     C           *IN99     IFEQ '1'                        B001
     C                     SETON                     3089
     C*********************MOVEA' 054'    ERCD,Z                          S01117
     C                     MOVEA' 067'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     Z-ADD1         PHW     50                      140640
     C                     ELSE                            X001
     C/COPY WNCPYSRC,FT0040C090
     C***12******ZDAYNO****IFLT RUND                       B002           S01194
     C   12      ZDAYNO    IFLT BJRDNB                                    S01194
     C           SPYTP     ANDEQ'RP'
     C                     SETON                     3089
     C*********************MOVEA' 374'    ERCD,Z                          S01117
     C                     MOVEA' 068'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     Z-ADD1         PHW     50                      140640
     C                     END                             E002
     C                     MOVE ZDATE     SSLDT1
     C                     Z-ADDZDAYNO    SSLDT
     C* FORMAT DATE FOR D3
     C           *IN98     IFEQ '0'                        B002
     C                     MOVE ZDD       OYY
     C                     MOVE ZMM       OMM
     C                     MOVE ZYY       ODD
     C                     ELSE                            X002
     C                     MOVE ZDD       OMM
     C                     MOVE ZMM       OYY
     C                     MOVE ZYY       ODD
     C                     END                             E002
     C                     Z-ADDODATE     SSLDT3
     C* FIND CENTURY
     C***********ZYN       IFLT 71                         B002           124673
     C           ZYN       IFLT 72                         B002           124673
     C                     MOVE '20'      SSLDT2
     C                     ELSE                            X002
     C                     MOVE '19'      SSLDT2
     C                     END                             E002
     C                     END                             E001
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0040CCP8                                           S01408
     C*                                                                   S01408
      *                                                                   047179
      *  Check if settle date is in the future and if the                 047179
      *  account is closing today                                         047179
      *                                                                   047179
     C           SSLDT     IFGT BJRDNB                                    047179
     C           ACST3     ANDEQ'C'                                       047179
     C                     SETON                     2589                 047179
     C                     MOVEA' 603'    ERCD,Z                          047179
     C                     ADD  1         Z                               047179
     C                     Z-ADD1         PHW     50                      140640
     C                     END                                            047179
      *                                                                   047179
     C           SSLDT     IFGT BJRDNB                                    047179
     C           ACST4     ANDEQ'C'                                       047179
     C                     SETON                     2789                 047179
     C                     MOVEA' 604'    ERCD,Z                          047179
     C                     ADD  1         Z                               047179
     C                     Z-ADD1         PHW     50                      140640
     C                     END                                            047179
     C*                                                                   047179
     C           SPYTP     IFNE 'RP'                       B001
     C* FOR BACK VALUE IF RETAIL OPEN DATE WILL BE NON-ZERO
     C           OBOPN     IFEQ 0                          B002
     C           OCOPN     IFNE 0                          B003
     C           SSLDT     IFLT OCOPN                      B004
     C                     SETON                     2589
     C*********************MOVEA' 346'    ERCD,Z                          S01117
     C                     MOVEA' 042'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     Z-ADD1         PHW     50                      140640
     C                     END                             E004
     C           SSLDT     IFLT BVLD                       B004
     C                     SETON                     2589
     C*********************MOVEA' 361'    ERCD,Z                          S01117
     C                     MOVEA' 043'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     Z-ADD1         PHW     50                      140640
     C                     END                             E004
      *                                                                   179420
      ** Check for a Blocked Debit Account                                179420
      *                                                                   179420
     C                     TESTB'2'       OCRETB         48               179420
     C           *IN48     IFEQ '1'                                       179420
     C                     MOVE '1'       *IN25                           179420
     C                     MOVEL'FTM0014' FTMSID                          179420
     C                     MOVEL'Y'       FTNOUP                          179420
     C                     EXSR FTSNMS                                    179420
     C                     ENDIF                                          179420
      *                                                                   179420
     C/COPY WNCPYSRC,FT0040C108
     C                     END                             E003
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0040CP39                                           S01408
     C*                                                                   S01408
     C                     ELSE                            X002
     C           SSLDT     IFLT OBOPN                      B003
     C                     SETON                     2789
     C*********************MOVEA' 347'    ERCD,Z                          S01117
     C                     MOVEA' 052'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     Z-ADD1         PHW     50                      140640
     C                     END                             E003
     C           SSLDT     IFLT BVLD                       B003
     C                     SETON                     2789
     C*********************MOVEA' 362'    ERCD,Z                          S01117
     C                     MOVEA' 053'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     Z-ADD1         PHW     50                      140640
     C                     END                             E003
      *                                                                   179420
      ** Check for a Blocked Debit Account                                179420
      *                                                                   179420
     C                     TESTB'2'       OBRETB         48               179420
     C           *IN48     IFEQ '1'                                       179420
     C                     MOVE '1'       *IN27                           179420
     C                     MOVEL'FTM0014' FTMSID                          179420
     C                     MOVEL'Y'       FTNOUP                          179420
     C                     EXSR FTSNMS                                    179420
     C                     ENDIF                                          179420
      *                                                                   179420
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0040CP40                                           S01408
     C*                                                                   S01408
     C                     END                             E002
     C                     END                             E001
      *                                                                   CEU006
     C           SNDCY     IFNE *BLANKS                                   CEU006
     C           N#TPSD    ANDGTSSLDT                                     CEU006
      * Send error to screen                                              CEU006
     C                     MOVE *ON       *IN89                           CEU006
     C                     MOVE *ON       *IN30                           CEU006
     C                     MOVEL'FTM2571' FTMSID                          CEU006
     C                     Z-ADD1         PHW     50                      140640
     C                     EXSR FTSNMS                                    CEU006
     C                     ENDIF                                          CEU006
      *                                                                   CEU006
     C*
     C/COPY WNCPYSRC,FT0040C055
     C                     ENDSR
     C*
     C************************************************************
     C* END OF SETTLE DATE VALIDATION
     C************************************************************
     C/EJECT
     C************************************************************
     C* PVDTAT SR.
     C* VALIDATION OF PAY DATE
     C* OPTIONAL
     C* IF PAY CURRENCY = BASE CURRENCY DEFAULTS TO SETTLE DATE + 1
     C* OTHERWISE DEFAULTS TO SETTLE DATE + 2
     C*
     C           PVDTAT    BEGSR
      *                                                                   S01435
      *  /COPY for additional pay value date processing                   S01435
      *                                                                   S01435
     C/COPY WNCPYSRC,FT0040PVDT                                           S01435
     C*
     C                     SETOF                     99
     C           PYVD      IFEQ *BLANK                     B001
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0040CCP6                                           S01408
     C*                                                                   S01408
     C                     MOVE 'D'       ZFREQ
     C           NOWRK     IFEQ 'N'                                       S01195
     C                     MOVE SPCCY     ZCCY
     C                     ELSE                                           S01195
     C                     MOVE BJLCCY    ZCCY                            S01195
     C                     END                                            S01195
     C*********************Z-ADDRUND      ZDAYNO                          S01194
     C                     Z-ADDBJRDNB    ZDAYNO                          S01194
     C                     MOVE PLOC      ZLOC                            S01195
     C* FIND RUN DATE PLUS 1
     C                     EXSR ZFREQB
     C***99****************DO                              B002           S01195
     C           ZZERR@    IFNE *BLANKS                                   S01195
     C           *LOCK     IN   DLDA
     C                     MOVE 'FT0040  'DBPGM
     C                     MOVE 'ZFREQB'  DBFILE           ***************
     C                     Z-ADD7         DBASE            * DB ERROR 07 *
     C*********************MOVELZTABKY    DBKEY            *********** ***S01195
     C                     MOVELZCCY      DBKEY                           S01195
     C                     OUT  DLDA
     C                     SETON                     U7U8LR
     C/COPY WNCPYSRC,FT0040C143
     C                     DUMP
      *                                                                   042167
      *  Allocate dataarea to blanks                                      042167
      *                                                                   042167
     C                     EXSR DALLOC                                    042167
      *                                                                   042167
     C                     RETRN
     C                     END                             E002
     C* IF NOT BASE CURRENCY FIND RUN DATE PLUS 2
     C***********SPCCY*****CASNEBCCY      ZFREQB           B001           S01194
     C           SPCCY     CASNEBJCYCD    ZFREQB           B001           S01194
     C                     END                             E002
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0040CCP7                                           S01408
     C*                                                                   S01408
      ** Default flag for pay date                                        CFT009
      *                                                                   CFT009
     C                     MOVE 'Y'       DFPDAT                          CFT009
     C                     ELSE                            X001
     C                     MOVE 'N'       DFPDAT  1                       CFT009
     C* CHECK IF DATE IS NUMERIC
     C                     MOVELPYVD      DATEL
     C                     MOVELDATEL     DATES
     C           PYVD      IFNE DATES                      B002
     C                     SETON                     99
     C                     ELSE                            X002
     C                     MOVE PYVD      ZDATE
     C                     EXSR ZDATE1
      *
      ** THE PAY DATE MUST NOT BE A HOLIDAY IN LOCAL CURRENCY             E32543
      *                                                                   E32543
     C                     MOVE BJLCCY    ZCCY                            E32543
     C                     EXSR ZCHKH                                     E32543
      *                                                                   E32543
      ** if ZIND = 'H' then the date is a holiday                         E32543
     C           ZIND      IFEQ 'H'                                       E32543
     C                     SETON                     723689               E32543
     C*********************MOVEA' W11'    ERCD,Z                    E32543S01117
     C                     MOVEA' W03'    ERCD,Z                          S01117
     C                     ADD  1         Z                               E32543
     C                     END                                            E32543
     C                     END                             E002
     C                     END                             E001
     C           *IN99     IFEQ '1'                        B001
     C* IF TYPE EQUALS RP CANNOT BE LESS THAN SETTLE DATE
     C           ZDAYNO    ORLT SSLDT
     C           SPYTP     ANDEQ'RP'
     C                     SETON                     3689
     C***99****************MOVEA' 055'    ERCD,Z                          S01117
     C   99                MOVEA' 069'    ERCD,Z                          S01117
     C**N99****************MOVEA' 056'    ERCD,Z                          S01117
     C  N99                MOVEA' 070'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     Z-ADD1         PHW     50                      140640
     C                     ELSE                            X001
     C                     EXSR ZDATE2
     C                     MOVE ZDATE     SPYDT1
     C                     Z-ADDZDAYNO    SPYDT
     C* FORMAT DATE FOR D3
     C           *IN98     IFEQ '0'                        B002
     C                     MOVE ZDD       OYY
     C                     MOVE ZMM       OMM
     C                     MOVE ZYY       ODD
     C                     ELSE                            X002
     C                     MOVE ZDD       OMM
     C                     MOVE ZMM       OYY
     C                     MOVE ZYY       ODD
     C                     END                             E002
     C                     Z-ADDODATE     SPYDT3
     C* FIND CENTURY
     C***********ZYN       IFLT 71                         B002           124673
     C           ZYN       IFLT 72                         B002           124673
     C                     MOVE '20'      SPYDT2
     C                     ELSE                            X002
     C                     MOVE '19'      SPYDT2
     C                     END                             E002
      *                                                                   CFT009
     C           CFT009    IFEQ 'N'                                       CFT009
     C                     MOVE ZDATE     PYVD
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C* FIND THE NUMBER OF DAYS BETWEEN SETTLE AND PAY DATES
     C*  IF AND ONLY IF BOTH DATES ARE VALID
     C           *IN30     IFEQ '0'                        B002
     C           *IN36     ANDEQ'0'
     C           *IN35     ANDEQ'0'                                       E32871
     C                     Z-ADD0         PRBD
     C                     MOVE 'D'       ZFREQ
     C                     MOVE SPCCY     ZCCY
     C           SSLDT     IFLT SPYDT                      B003
     C                     Z-ADDSSLDT     DAYNO1
     C                     Z-ADDSPYDT     DAYNO2
     C                     ELSE
     C                     Z-ADDSPYDT     DAYNO1  50
     C                     Z-ADDSSLDT     DAYNO2  50
     C                     END                             E003
     C                     Z-ADDDAYNO1    ZDAYNO
     C                     MOVE PLOC      ZLOC                            S01195
     C           ZDAYNO    DOWLTDAYNO2                     B003
     C                     EXSR ZFREQB
     C                     ADD  1         PRBD
     C                     END                             E003
     C                     END                             E002
     C           SSLDT     IFGT SPYDT                      B002
     C                     MULT -1        PRBD
     C                     END                             E002
     C                     Z-ADDPRBD      SPRBD                           003352
     C                     END                             E001
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0040CCP9                                           S01408
     C*                                                                   S01408
      *                                                                   047179
      *  Check if pay date is in the future and if the account is         047179
      *  closing today                                                    047179
      *                                                                   047179
     C           SPYDT     IFGT BJRDNB                                    047179
     C           ACST1     ANDEQ'C'                                       047179
     C                     SETON                     2489                 047179
     C                     MOVEA' 601'    ERCD,Z                          047179
     C                     ADD  1         Z                               047179
     C                     Z-ADD1         PHW     50                      140640
     C                     END                                            047179
      *                                                                   047179
     C           SPYDT     IFGT BJRDNB                                    047179
     C           ACST2     ANDEQ'C'                                       047179
     C                     SETON                     2689                 047179
     C                     MOVEA' 602'    ERCD,Z                          047179
     C                     ADD  1         Z                               047179
     C                     Z-ADD1         PHW     50                      140640
     C                     END                                            047179
     C*                                                                   047179
     C           SPYTP     IFNE 'RP'                       B001
     C* FOR BACK VALUE IF RETAIL OPEN DATE WILL BE NON-ZERO
     C           SCOPN     IFEQ 0                          B002
     C           DSOPN     IFNE 0                          B003
     C           SPYDT     IFLT DSOPN                      B004
     C                     SETON                     2489
     C*********************MOVEA' 344'    ERCD,Z                          S01117
     C                     MOVEA' 021'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     Z-ADD1         PHW     50                      140640
     C                     END                             E004
      *
     C           SPYDT     IFLT BVLD                       B004
     C                     SETON                     2489
     C*********************MOVEA' 358'    ERCD,Z                          S01117
     C                     MOVEA' 022'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     Z-ADD1         PHW     50                      140640
     C                     END                             E004
      *                                                                   179420
      ** Check for a Blocked Credit Account                               179420
      *                                                                   179420
     C                     TESTB'3'       DRETB          48               179420
     C           *IN48     IFEQ '1'                                       179420
     C                     MOVE '1'       *IN24                           179420
     C                     MOVEL'FTM0019' FTMSID                          179420
     C                     MOVEL'Y'       FTNOUP                          179420
     C                     EXSR FTSNMS                                    179420
     C                     ENDIF                                          179420
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0040CP41                                           S01408
     C*                                                                   S01408
      *
     C                     END                             E003
      *
     C                     ELSE                            X002
     C           SPYDT     IFLT SCOPN                      B003
     C                     SETON                     2689
     C*********************MOVEA' 373'    ERCD,Z                          S01117
     C                     MOVEA' 035'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     Z-ADD1         PHW     50                      140640
     C                     END                             E003
      *
     C           SPYDT     IFLT BVLD                       B003
     C                     SETON                     2689
     C*********************MOVEA' 360'    ERCD,Z                          S01117
     C                     MOVEA' 034'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     Z-ADD1         PHW     50                      140640
     C                     END                             E003
      *                                                                   179420
      ** Check for a Blocked Credit Account                               179420
      *                                                                   179420
     C                     TESTB'3'       SCRETB         48               179420
     C           *IN48     IFEQ '1'                                       179420
     C                     MOVE '1'       *IN26                           179420
     C                     MOVEL'FTM0019' FTMSID                          179420
     C                     MOVEL'Y'       FTNOUP                          179420
     C                     EXSR FTSNMS                                    179420
     C                     ENDIF                                          179420
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0040CP42                                           S01408
     C*                                                                   S01408
      *
     C                     END                             E002
     C                     END                             E001
     C*
     C           SPDCY     IFNE *BLANKS                                   CEU006
     C/COPY WNCPYSRC,FT0040C102
     C           P#TPSD    ANDGTSPYDT                                     CEU006
     C           CFT014    IFNE 'Y'                                       CFT014
     C           P#INEU    OREQ 'I'                                       CFT014
      * Send error to screen                                              CEU006
     C                     MOVE *ON       *IN89                           CEU006
     C                     MOVE *ON       *IN36                           CEU006
     C                     MOVEL'FTM2571' FTMSID                          CEU006
     C                     Z-ADD1         PHW     50                      140640
     C                     EXSR FTSNMS                                    CEU006
     C                     ENDIF                                          CFT014
     C/COPY WNCPYSRC,FT0040C196
     C                     ENDIF                                          CEU006
     C/COPY WNCPYSRC,FT0040C224
      *                                                                   CEU006
     C                     ENDSR
     C*
     C************************************************************
     C* END OF PAY DATE VALIDATION
     C************************************************************
     C/EJECT
     C************************************************************
     C* PPLCHG SR.
     C* TO VALIDATE SETTLE PLUS CHARGES INDICATOR
     C* OPTIONAL IF ENTERED MUST BE 'Y'
     C*
     C           PPLCHG    BEGSR
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0040CP43                                           S01408
     C*                                                                   S01408
     C*
     C           SADDC     IFEQ *BLANK                     B001
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0040CP44                                           S01408
     C*                                                                   S01408
     C                     MOVE 'A'       SADDC
     C                     END                             E001
     C/COPY WNCPYSRC,FT0040C096
     C           SADDC     IFNE 'D'                        B001
     C           SADDC     ANDNE'A'
     C                     SETON                     3389
     C*********************MOVEA' 057'    ERCD,Z                          S01117
     C                     MOVEA' 071'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     Z-ADD1         PHW     50                      140640
     C                     END
     C*
     C                     ENDSR
     C*
     C************************************************************
     C* END OF SETTLE PLUS CHARGE VALIDATION
     C************************************************************
     C/EJECT
      *****************************************************************   S01414
      *                                                               *   S01414
      *  SRBOOK   : Validate Book Code                                *   S01414
      *                                                               *   S01414
      *  CALLED BY:                                                   *   S01414
      *                                                               *   S01414
      *  CALLS    : AOBOOKR0                                          *   S01414
      *             FTSNMS                                            *   S01414
      *                                                               *   S01414
      *****************************************************************   S01414
     CSR         SRBOOK    BEGSR                                          S01414
      *                                                                   S01414
      *  Set up subroutine stack name                                     S01414
      *                                                                   S01414
     C                     ADD  1         Q                               S01414
     C                     MOVEL'SRBOOK'  @STK,Q                          S01414
     C/COPY WNCPYSRC,FT0040C197
      *                                                                   S01414
      *  Book Code must be entered                                        S01414
      *                                                                   S01414
     C           SBOKC     IFEQ *BLANKS                                   S01414
     C                     MOVE '1'       *IN74                           S01414
     C                     MOVE '1'       *IN89                           S01414
     C                     MOVEA' 400'    ERCD,Z                          S01414
     C                     ADD  1         Z                               S01414
     C                     Z-ADD1         PHW     50                      140640
     C                     END                                            S01414
      *                                                                   S01414
      *  Access the Book Code file for validation if an Insert OR         S01414
      *  if an Amend and the Book Code has been changed                   S01414
      *                                                                   S01414
     C           SBOKC     IFNE *BLANKS                                   S01414
     C           SBOKC     ANDNEBOKC                                      S01414
      *                                                                   S01414
     C                     CALL 'AOBOOKR0'             90                 S01414
     C                     PARM *BLANKS   U#RTCD  7                       S01414
     C                     PARM '*KEY   ' U#OPTN  7                       S01414
     C                     PARM SBOKC     U#BOKC  2                       S01414
     C           SDBOOK    PARM SDBOOK    DSFDY                           S01414
      *                                                                   S01414
      *  If error on CALL - process as database error                     S01414
      *                                                                   S01414
     C           *IN90     IFEQ '1'                                       S01414
     C                     MOVEL'*CALL  ' W0FILE           ************   S01414
     C                     MOVEL'AOBOOKR' W0KEY            * DBERR 046*   S01414
     C                     Z-ADD46        W0ERNB           ************   S01414
     C                     EXSR SRERR                                     S01414
     C                     END                                            S01414
      *                                                                   S01414
      * If return code is not blank - process for an error                S01414
      * else map the book code from the data structure to screen field    S01414
      *                                                                   S01414
     C           U#RTCD    IFNE *BLANKS                                   S01414
     C                     MOVE '1'       *IN74                           S01414
     C                     MOVE '1'       *IN89                           S01414
     C                     MOVEA' 400'    ERCD,Z                          S01414
     C                     ADD  1         Z                               S01414
     C                     Z-ADD1         PHW     50                      140640
      *                                                                   S01414
     C                     ELSE                                           S01414
     C                     MOVELBDBKCD    SBOKC                           S01414
     C                     END                                            S01414
      *                                                                   S01414
     C                     END                                            S01414
      *                                                                   S01414
      *  Unwind subroutine stack name                                     S01414
      *                                                                   S01414
     C           EXBOOK    TAG                                            S01414
     C                     MOVEA*BLANKS   @STK,Q                          S01414
     C                     SUB  1         Q       50                      S01414
      *                                                                   S01414
     CSR                   ENDSR                                          S01414
      *                                                                   S01414
      *****************************************************************   S01414
      * End of Book Code Validation                                       S01414
      *****************************************************************   S01414
     C/EJECT                                                              S01414
      *****************************************************************   S01414
      *                                                               *   S01414
      *  SRPRFC   : Validation Of Profit Centre                       *   S01414
      *                                                               *   S01414
      *  CALLED BY:                                                   *   S01414
      *                                                               *   S01414
      *  CALLS    : FTSNMS                                            *   S01414
      *             AOPRFMR0                                          *   S01414
      *             AOPRFCR0                                          *   S01414
      *                                                               *   S01414
      *****************************************************************   S01414
     CSR         SRPRFC    BEGSR                                          S01414
      *                                                                   S01414
      *  Set up subroutine stack name                                     S01414
      *                                                                   S01414
     C                     ADD  1         Q                               S01414
     C                     MOVEL'SRPRFC'  @STK,Q                          S01414
      *                                                                   S01414
      *  Profit Centre is Optional input.                                 S01414
      *                                                                   S01414
      *  If the profit centre field is blank set to a default only if     S01414
      *  the Profit Centre Defaults Used flag is set to 'Y'.              S01414
      *  This could only happen on an Insert.                             S01414
      *  Do not default if an error was found in Ordering Customer,       176510
      *  Ordering Bank or Book Code.                                      176510
      *                                                                   S01414
     C           ACTION    IFEQ 'I'                                       S01414
     C           SPRFC     ANDEQ*BLANKS                                   S01414
     C           BKPCDU    ANDEQ'Y'                                       S01414
     C           *IN25     ANDNE'1'                                       176510
     C           *IN27     ANDNE'1'                                       176510
     C           *IN74     ANDNE'1'                                       176510
      **                                                                  176510
      * Retrieve the Ordering Customer details.                           176510
     C           *LIKE     DEFN BBACOC    BBACOZ                          176510
     C                     MOVEL*BLANKS   BBACOZ                          176510
     C                     MOVEL*BLANKS   @KEY1                           176510
     C                     MOVEL*BLANKS   CUST                            176510
      * If Retail account, then use retail customer no.                   176510
     C********** ORDRET    IFNE 0                                                      176510 CSD027
     C           ORDRET    IFNE *BLANKS                                                       CSD027
     C                     MOVELRETNXX    @KEY1                           176510
     C                     MOVELRETNXX    CUST    6                       176510
     C                     ELSE                                           176510
     C                     MOVELONUM2     @KEY1                           176510
     C                     MOVELONUM2     CUST    6                       176510
     C                     END                                            176510
     C*                                                                   176510
     C                     CALL 'AOCUSTR0'                                176510
     C                     PARM *BLANKS   RTCD                            176510
     C                     PARM '*KEY   ' @OPTN                           176510
     C                     PARM           @KEY1                           176510
     C                     PARM *BLANKS   @KYST                           176510
     C           SDCUST    PARM *BLANKS   DSSDY                           176510
      *                                                                   176510
     C           RTCD      IFEQ *BLANKS                                   176510
     C                     MOVE BBACOC    BBACOZ                          176510
     C                     ENDIF                                          176510
      **                                                                  176510
     C*If Ordering customer has not been set up with a default            176510
     C*Account Officer, determine the default from the 'Ordering          176510
     C*Bank' entry.                                                       176510
     C*Only process 'Ord Bank' if 'Ord Cust' is Not 'MT202'.              176510
     C           BBACOZ    IFEQ *BLANKS                                   176510
     C*                                                                   176510
     C           ORBCHR    IFNE *BLANKS                                   176510
     C           SORC1     ANDNEORCFLD                                    176510
     C                     MOVELORBCHR    @KEY1                           176510
     C*                                                                   176510
     C                     CALL 'AOCUSTR0'                                176510
     C                     PARM *BLANKS   RTCD                            176510
     C                     PARM '*KEY   ' @OPTN                           176510
     C                     PARM           @KEY1                           176510
     C                     PARM *BLANKS   @KYST                           176510
     C           SDCUST    PARM *BLANKS   DSSDY                           176510
     C*                                                                   176510
     C           RTCD      IFEQ *BLANKS                                   176510
     C                     MOVE BBACOC    BBACOZ                          176510
     C                     END                                            176510
     C*                                                                   176510
     C                     ENDIF                                          176510
     C                     ENDIF                                          176510
      *                                                                   S01414
      *  Determine parameters to be passed                                S01414
      *                                                                   S01414
      ***For*Outgoing*Payments*the*Customer*and*Account*Officer*willS01414176510
      ***be blank.**************************************************S01414176510
      *                                                                   S01414
      *                                                                   S01414
     C*******************  MOVEL*BLANKS   CUST    6        Customer S01414176510
     C*******************  MOVEL*BLANKS   ACOF    2        Account  S01414176510
     C                     MOVELBBACOZ    ACOF    2        Account        176510
     C                     MOVELSPYTP     TRTP    5        Transaction TypS01414
      *                                                                   S01414
      *  Get default profit centre                                        S01414
      *                                                                   S01414
     C                     CALL 'AOPRFMR0'             90                 S01414
     C                     PARM *BLANKS   U#RTCD  7        Return Code    S01414
     C                     PARM SBOKC     U#BOKC  2        Book Code      S01414
     C                     PARM TRTP      U#TRTP  5        Transaction TypS01414
     C                     PARM SPYST     U#SUTP  2        Sub Type       S01414
     C                     PARM SBRCA     U#BRAN  3        Branch Code    S01414
     C                     PARM DPPT      U#DEPT  3        Department CodeS01414
     C                     PARM USRID     U#USER 10        User           S01414
     C                     PARM ACOF      U#ACOF  2        Account OfficerS01414
     C                     PARM CUST      U#CUST  6        Customer NumberS01414
     C           SPRFC     PARM *BLANKS   U#PRFC  4        Profit Centre  S01414
      *                                                                   S01414
      *  If error on CALL - process as database error                     S01414
      *                                                                   S01414
     C           *IN90     IFEQ '1'                                       S01414
     C                     MOVEL'*CALL  ' W0FILE           ************   S01414
     C                     MOVEL'AOPRFMR' W0KEY            * DBERR 047*   S01414
     C                     Z-ADD47        W0ERNB           ************   S01414
     C                     EXSR SRERR                                     S01414
     C                     END                                            S01414
      *                                                                   S01414
      * If return code is not blank - process for an error                S01414
      * If no error then the screen field is filled by passed parameter   S01414
      *                                                                   S01414
     C           U#RTCD    IFEQ '2'                                       S01414
     C                     MOVE '1'       *IN77                           S01414
     C                     MOVE '1'       *IN89                           S01414
     C                     MOVEA' 410'    ERCD,Z                          S01414
     C                     ADD  1         Z                               S01414
     C                     Z-ADD1         PHW     50                      140640
     C                     GOTO EXPRFC                                    S01414
     C                     END                                            S01414
      *                                                                   S01414
     C                     END                                            S01414
      *                                                                   S01414
      *                                                                   S01414
      *  Validate Profit Centre                                           S01414
      *                                                                   S01414
     C           ACTION    IFEQ 'I'                                       S01414
     C           SPRFC     ANDNE*BLANKS                                   S01414
     C           ACTION    OREQ 'A'                                       S01414
     C           SPRFC     ANDNE*BLANKS                                   S01414
     C           ACTION    OREQ 'I'                                       120827
     C           BGN0ST    ANDEQ'Y'                                       120827
     C           ACTION    OREQ 'A'                                       120827
     C           BGN0ST    ANDEQ'Y'                                       120827
      *                                                                   S01414
     C                     CALL 'AOPRFCR0'             90                 S01414
     C                     PARM *BLANKS   U#RTCD  7                       S01414
     C                     PARM '*KEY'    U#OPTN  7                       S01414
     C                     PARM SPRFC     U#PRFC  4                       S01414
     C           SDPRFC    PARM SDPRFC    DSFDY                           S01414
      *                                                                   S01414
      *  If error on CALL - process as database error                     S01414
      *                                                                   S01414
     C           *IN90     IFEQ '1'                                       S01414
     C                     MOVEL'*CALL  ' W0FILE           ************   S01414
     C                     MOVEL'AOPRFCR' W0KEY            * DBERR 48 *   S01414
     C                     Z-ADD48        W0ERNB           ************   S01414
     C                     EXSR SRERR                                     S01414
     C                     END                                            S01414
      *                                                                   S01414
      * If return code is not blank - process for an error                S01414
      *                                                                   S01414
     C           U#RTCD    IFNE *BLANKS                                   S01414
     C                     MOVE '1'       *IN77                           S01414
     C                     MOVE '1'       *IN89                           S01414
     C                     MOVEA' 410'    ERCD,Z                          S01414
     C                     ADD  1         Z                               S01414
     C                     Z-ADD1         PHW     50                      140640
      *                                                                   S01414
     C                     ELSE                                           S01414
     C                     MOVELDSPCCD    SPRFC                           S01414
     C                     END                                            S01414
      *                                                                   S01414
     C                     END                                            S01414
      *                                                                   S01414
      *  Unwind subroutine stack name                                     S01414
      *                                                                   S01414
     C           EXPRFC    TAG                                            S01414
     C                     MOVEA*BLANKS   @STK,Q                          S01414
     C                     SUB  1         Q       50                      S01414
      *                                                                   S01414
     CSR                   ENDSR                                          S01414
      *                                                                   S01414
      *****************************************************************   S01414
      * End of Profit Centre Validation                                   S01414
      *****************************************************************   S01414
      /TITLE SR/SRORTE                                                    CFT014
      *****************************************************************   CFT014
      *                                                               *   CFT014
      *  SRORTE - Validate Original Rate                              *   CFT014
      *                                                               *   CFT014
      *  Called By: VALTWO Subroutine                                 *   CFT014
      *                                                               *   CFT014
      *  Calls:                                                       *   CFT014
      *  FT0010   - Validate and calculate currencies                 *   CFT014
      *  ZEDIT    - Edits numeric field to screen format              *   CFT014
      *                                                               *   CFT014
      *****************************************************************   CFT014
     C           SRORTE    BEGSR                           *** SRORTE *** CFT014
      ** Validate original rate if entered.                               CFT014
     C           SORTE     IFNE *BLANK                                    CFT014
     C                     MOVE *BLANK    ZFIELD                          CFT014
     C                     MOVE SORTE     ZFIELD                          CFT014
     C                     Z-ADD8         ZADEC                           CFT014
     C**********           Z-ADD4         ZADIG                                      CFT014 AR895223
     C                     Z-ADD5         ZADIG                                             AR895223
     C                     EXSR ZALIGN                                    CFT014
      ** Invalid original rate.                                           CFT014
     C           *IN99     IFEQ *ON                                       CFT014
     C                     MOVE *ON       *IN49                           CFT014
     C                     MOVE *ON       *IN89                           CFT014
     C                     MOVEL'FTM3102' FTMSID                          CFT014
     C                     Z-ADD1         PHW                             CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     ELSE                                           CFT014
     C                     MOVE ZFIELD    WORTE                           CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDSR                                          CFT014
      *****************************************************************   CFT014
      * End of Original Rate Validation                                   CFT414
      *****************************************************************   S01414
     C/EJECT
     C************************************************************
     C* REGPAY SR.
     C* VALIDATION OF REGULAR PAYMENT FLAG
     C* OPTIONAL DEFAULT OF 'N'
     C* MUST BE 'Y' OR 'N'
     C*
     C           REGPAY    BEGSR
     C*
     C           SRPAY     IFEQ *BLANK                     B001
     C           SPYTP     IFEQ 'RP'                       B002
     C                     MOVE 'Y'       SRPAY
     C                     ELSE                            X002
     C                     MOVE 'N'       SRPAY
     C                     END                             E002
     C                     END                             E001
     C           SPYTP     IFEQ 'RP'                       B001
     C           SRPAY     IFNE 'Y'                        B002
     C                     SETON                     3789
     C                     END                             E002
     C                     ELSE                            X001
     C           SRPAY     IFNE 'N'                        B002
     C                     SETON                     3789
     C                     END                             E002
     C                     END                             E001
     C   37                DO                              B001
     C*********************MOVEA' 058'    ERCD,Z                          S01117
     C                     MOVEA' 072'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     Z-ADD1         PHW     50                      140640
     C                     END                             E001
     C*
     C                     ENDSR
     C*
     C************************************************************
     C* END OF REGULAR PAYMENT VALIDATION
     C************************************************************
     C/EJECT
     C************************************************************
     C* PAYFRQ SR.
     C* VALIDATION OF PAYMENT FREQUENCY
     C* MANDATORY IF A REGULAR PAYMENT
      *                                                                   062394
      * Valid frequencies now kept by FT0310                              062394
      *                                                                   062394
     C**MUST*BE*ONE*OF*ENTRIES*IN*TABLE*PYFQ                              062394
     C*
     C           PAYFRQ    BEGSR
     C*
     C* If Payment Type is RP (Regular Payment), check that Payment       078189
     C* Frequency is valid.                                               078189
     C*                                                                   078189
     C***********SPAYF     IFEQ *BLANK                     B001           078189
     C***********SRPAY     IFEQ 'Y'                        B002           078189
     C           SPYTP     IFEQ 'RP'                                      078189
     C*                                                                   078189
     C* If Regular Payment, frequency must be input                       078189
     C           SPAYF     IFEQ *BLANK                     B002           078189
     C                     SETON                     3889
     C*********************MOVEA' 139'    ERCD,Z                          S01117
     C                     MOVEA' 074'    ERCD,Z                          S01117
     C                     Z-ADD1         PHW     50                      140640
     C                     ADD  1         Z
     C************         END                             E002           078189
     C*                                                                   078189
     C                     ELSE                            X001
     C***********SPAYF     LOKUPPYFQ                     71               062394
      *                                                                   062394
      * Check frequency is valid                                          062394
      *                                                                   062394
     C                     CALL 'FT0310'               9090               062394
     C                     PARM *BLANKS   ZZERR@  7                       062394
     C                     PARM '*VERIFY 'W0ACT   8                       062394
     C                     PARM SPAYF     W0FREQ  1                       062394
     C                     PARM 0         W0RDNB  50                      062394
     C                     PARM 0         W0MDAY  20                      062394
     C                     PARM *BLANKS   W0CCY   3                       062394
     C                     PARM *BLANKS   W0LOC   3                       062394
      *                                                                   062394
      *  If error on call                                                 062394
      *                                                                   062394
     C           ZZERR@    IFNE *BLANKS                                   062394
     C           ZZERR@    ANDNE'FTM2002'                                 062394
     C           *IN90     OREQ '1'                                       062394
     C           *LOCK     IN   *NAMVAR                                   062394
     C                     MOVE 'FT0040  'DBPGM            ***************062394
     C                     MOVE 'FT0310'  DBFILE           * DB ERROR 21 *062394
     C                     Z-ADD801       DBASE            ***************062394
     C                     MOVEL'*CALL'   DBKEY                           062394
     C                     OUT  *NAMVAR                                   062394
     C                     SETON                     U7U8LR               062394
     C/COPY WNCPYSRC,FT0040C144
     C                     DUMP                                           062394
      *                                                                   062394
      *  Allocate dataarea to blanks                                      062394
      *                                                                   062394
     C                     EXSR DALLOC                                    062394
      *                                                                   062394
     C*                    RETRN                                          062394
     C                     END                                            062394
      *                                                                   062394
     C           ZZERR@    IFEQ 'FTM2002'                                 062394
     C**N71******          DO                              B002           062394
     C                     SETON                     3889
     C*********************MOVEA' 058'    ERCD,Z                          S01117
     C                     MOVEA' 073'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     Z-ADD1         PHW     50                      140640
     C                     END                             E002
     C                     END                             E001
     C*                                                                   078189
     C                     END                                            078189
     C*                                                                   078189
     C* Else, if this is a non-regular payment, payment frequency         078189
     C*  must be blank                                                    078189
     C*                                                                   078189
     C           SPYTP     IFEQ 'OP'                       B001           078189
     C           SPAYF     ANDNE*BLANK                                    078189
     C                     SETON                     3889                 078189
     C                     MOVEA' 075'    ERCD,Z                          078189
     C                     ADD  1         Z                               078189
     C                     Z-ADD1         PHW     50                      140640
     C                     END                                            078189
      *                                                                   078189
     C***********SRPAY     IFEQ 'N'                        B001           078189
     C***********SPAYF     ANDNE*BLANK                                    078189
     C***********SPYTP     OREQ 'OP'                                      078189
     C***********SPAYF     ANDNE*BLANK                                    078189
     C***********          SETON                     3889                 078189
     C************IN39     IFNE '1'                                       078189
     C************IN40     ANDNE'1'                                       078189
     C************IN45     ANDNE'1'                                       078189
     C*********************MOVEA' 450'    ERCD,Z                          S01117
     C************         MOVEA' 075'    ERCD,Z           E001     S01117078189
     C************         ADD  1         Z                E001           078189
     C************         END                             E001           078189
     C************         END                             E001           078189
     C*
     C***********SPAYF     IFEQ 'D'                                 E32853078189
     C***********SPAYF     OREQ 'W'                                 E32853078189
     C***********SPAYF     OREQ 'F'                                 E32853078189
     C***********          SETON                     73             E32853078189
     C***********          ELSE                                     E32853078189
     C***********          SETOF                     73             E32853078189
     C***********          END                                      E32853078189
     C*
     C                     ENDSR
     C*
     C************************************************************
     C* END OF PAYMENT FREQUENCY VALIDATION
     C************************************************************
     C/EJECT
     C************************************************************
     C* DAYMTH SR.
     C* VALIDATION OF DAY IN MONTH
     C* MANDATORY IF A REGULAR PAYMENT
     C* MUST BE 1-31
     C*
     C           DAYMTH    BEGSR
     C*
     C           SPYTP     IFEQ 'RP'                                      078189
     C*                                                                   078189
     C           SDYIM     IFEQ *BLANK                     B001
     C***********SRPAY     IFEQ 'Y'                        B002           078189
     C***********SPAYF     ANDNE'D'                                 078189082271
     C           SPAYF     IFNE 'D'                                       082271
     C           SPAYF     ANDNE'W'                                       078189
     C           SPAYF     ANDNE'F'                                       078189
     C           SPAYF     ANDNE'B'                                       087006
     C************IN73     ANDNE'1'                                 E32853078189
     C                     SETON                     3989
     C*********************MOVEA' 140'    ERCD,Z                          S01117
     C                     MOVEA' 077'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     Z-ADD1         PHW     50                      140640
     C***********          END                             E002           078189
     C                     END                             E002           082271
     C                     ELSE                            X001
     C           SDYIM     LOKUPNDY                      71
     C  N71                DO                              B002
     C                     SETON                     3989
     C*********************MOVEA' 060'    ERCD,Z                          S01117
     C                     MOVEA' 076'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     Z-ADD1         PHW     50                      140640
     C                     END                             E002
     C                     END                             E001
     C***********SRPAY     IFEQ 'N'                        B001           078189
     C***********SDYIM     ANDNE*BLANK                                    078189
     C***********SPYTP     OREQ 'OP'                                      078189
     C***********SDYIM     ANDNE*BLANK                                    078189
     C***********          SETON                     3989                 078189
     C************IN38     IFNE '1'                                       078189
     C************IN40     ANDNE'1'                                       078189
     C************IN45     ANDNE'1'                                       078189
     C*                                                                   078189
     C                     ELSE                                           078189
     C           SPYTP     IFEQ 'OP'                                      078189
     C           SDYIM     ANDNE*BLANK                                    078189
     C                     SETON                     3989
     C*********************MOVEA' 450'    ERCD,Z                          S01117
     C                     MOVEA' 075'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     Z-ADD1         PHW     50                      140640
     C                     END
     C                     END                             E001
     C*
     C                     ENDSR
     C*
     C************************************************************
     C* END OF DAY IN MONTH VALIDATION
     C************************************************************
     C/EJECT
     C************************************************************
     C* FINDAT SR.
     C* VALIDATION OF FINAL DATE
     C* MANDATORY IF A REGULAR PAYMENT
     C* MUST BE GREATER THAN SETTLE DATE
     C*
     C           FINDAT    BEGSR
     C*
      * Before validating clear the saved fields from previous            081043
      * validation                                                        081043
     C                     CLEARSFDAT                                     081043
     C                     CLEARSFDAT1                                    081043
     C                     CLEARSFDAT2                                    081043
     C                     CLEARSFDAT3                                    081043
      *                                                                   081043
     C           SPYTP     IFEQ 'RP'                                      078189
     C*                                                                   078189
     C           FIND      IFEQ *BLANK                     B001
     C***********SRPAY     IFEQ 'Y'                        B002           078189
     C                     SETON                     4089
     C*********************MOVEA' 141'    ERCD,Z                          S01117
     C                     MOVEA' 083'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     Z-ADD1         PHW     50                      140640
     C***********          ELSE                            X002           078189
     C***********          Z-ADD0         SFDAT                           078189
     C***********          Z-ADD0         SFDAT1                          078189
     C***********          Z-ADD0         SFDAT2                          078189
     C***********          Z-ADD0         SFDAT3                          078189
     C***********          END                             E002           078189
     C                     ELSE                            X001
     C                     MOVE FIND      ZDATE
     C                     EXSR ZDATE1
      *
      ** THE FINAL PAYMENT DATE MUST NOT BE A HOLIDAY IN LOCAL            E32543
      *  CURRENCY                                                         E32543
     C                     MOVE BJLCCY    ZCCY                            E32543
     C                     EXSR ZCHKH                                     E32543
      *                                                                   E32543
      ** if ZIND = 'H' then the date is a holiday                         E32543
     C           ZIND      IFEQ 'H'                                       E32543
     C**********           SETON                     726689         E32543081663
     C*********************MOVEA' W13'    ERCD,Z                    E32543S01117
     C**********           MOVEA' W05'    ERCD,Z                    S01117081663
     C**********           ADD  1         Z                         E32543081663
     C**********           ELSE                                     E32543081663
     C**********           SETOF                     66             E32543081663
     C**********           END                                      E32543081663
     C** Make sure warning is displayed at least once                     081663
     C*                                                                   081663
     C                     MOVEL'Y'       FTWARN  1                       081663
     C           WRN@,2    IFEQ *BLANKS                                   081663
     C                     MOVEL*BLANKS   FTRSND                          081663
     C                     MOVEA'Y'       WRN@,2                          081663
     C                     END                                            081663
     C*                                                                   081663
     C** Send message                                                     081663
     C*                                                                   081663
     C                     SETON                     66                   081663
     C                     MOVEL'FTM0027' FTMSID                          081663
     C                     EXSR FTSNMS                                    081663
     C                     ELSE                                           081663
     C*                                                                   081663
     C** Warning not sent                                                 081663
     C*                                                                   081663
     C                     SETOF                     66                   081663
     C                     MOVEA' '       WRN@,2                          081663
     C                     END                                            081663
      *
     C           *IN99     IFEQ '1'                        B002
     C           ZDAYNO    ORLE SSLDT
     C                     SETON                     4089
     C***99****************MOVEA' 061'    ERCD,Z                          S01117
     C   99                MOVEA' 081'    ERCD,Z                          S01117
     C**N99****************MOVEA' 062'    ERCD,Z                          S01117
     C  N99                MOVEA' 082'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     Z-ADD1         PHW     50                      140640
     C                     ELSE                            X002
     C                     MOVE ZDATE     SFDAT1
     C                     Z-ADDZDAYNO    SFDAT
     C           *IN98     IFEQ '0'                        B003
     C                     MOVE ZDD       OYY
     C                     MOVE ZMM       OMM
     C                     MOVE ZYY       ODD
     C                     ELSE                            X003
     C                     MOVE ZDD       OMM
     C                     MOVE ZMM       OYY
     C                     MOVE ZYY       ODD
     C                     END                             E003
     C                     MOVE ODATE     SFDAT3
     C* FIND CENTURY
     C***********ZYN       IFLT 71                         B003           124673
     C           ZYN       IFLT 72                         B003           124673
     C                     MOVE '20'      SFDAT2
     C                     ELSE                            X003
     C                     MOVE '19'      SFDAT2
     C                     END                             E003
     C                     END                             E002
     C                     END                             E001
     C                     ELSE                                           078189
     C*
     C***********SRPAY     IFEQ 'N'                        B001           078189
     C           SPYTP     IFEQ 'OP'                                      078189
     C           FIND      ANDNE*BLANK                                    078189
     C***********SPYTP     OREQ 'OP'                                      078189
     C***********FIND      ANDNE*BLANK                                    078189
     C                     SETON                     4089
     C************IN38     IFNE '1'                                       078189
     C************IN39     ANDNE'1'                                       078189
     C************IN45     ANDNE'1'                                       078189
     C*********************MOVEA' 450'    ERCD,Z                          S01117
     C                     MOVEA' 075'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     Z-ADD1         PHW     50                      140640
     C                     END
     C                     END                             E001
     C*
     C                     ENDSR
     C*
     C************************************************************
     C* END OF FINAL PAYMENT DATE VALIDATION
     C************************************************************
     C/EJECT
     C************************************************************
     C* NXTDAT SR.
     C* VALIDATION OF NEXT PAYMENT DATE
     C* MANDATORY IF REGULAR PAYMENT
     C* IF  BLANK  AND AN INSERT, DEFAULTS TO SETTLE DATE IF              E23059
     C* THIS IS GREATER THAN THE RUN DATE; THE RUN DATE PLUS              E23059
     C* ONE WORKING DAY IN THE SETTLE CURRENCY OTHERWISE.                 E23059
     C* THE NEXT PAYMENT DATE MUST BE GREATER THAN THE RUN DATE           E23059
     C* AND LESS THAN THE FINAL DATE.                                     E23059
     C*                                                                   E23059
     C**IF*BLANK*AND*AN*INSERT*DEFAULTS*TO*SETTLE*DATE********            E23059
     C**MUST*BE**GEATER*THAN*RUN*DATE*AND*LESS*THAN*FINAL*DATE            E23059
     C*
     C           NXTDAT    BEGSR
     C*
      * Before validating clear the saved fields from previous            081043
      * validation                                                        081043
     C                     CLEARSNPDT                                     081043
     C                     CLEARSNPDT1                                    081043
     C                     CLEARSNPDT2                                    081043
     C                     CLEARSNPDT3                                    081043
      *                                                                   081043
     C           SPYTP     IFEQ 'RP'                                      078189
     C*                                                                   078189
     C           NDAT      IFEQ *BLANK                     B001
     C***********SRPAY     IFEQ 'Y'                        B002           078189
     C           ACTION    IFEQ 'I'                        B003
     C                     MOVE PYDT      NDAT
      *                                                                   E21458
      *  NEXT PAYMENT DATE NOT SET UP IF SETTLE VALUE DATE                E21458
      *  BLANK AND PAY VALUE DATE ENTERED                                 E21458
      *                                                                   E21458
     C           SSLDT     IFLE BJRDNB                     B004           E23059
     C                     MOVE BJRDNB    ZDAYNO                          E23059
     C                     MOVE SMCY      ZCCY                            E23059
     C                     MOVE 'D'       ZFREQ                           E23059
     C                     EXSR ZFREQB                                    E23059
     C                     MOVE ZDAYNO    SNPDT                           E23059
     C                     EXSR ZDATE2                                    E23059
     C                     MOVE ZDATE     SNPDT1                          E23059
     C*                                                                   E23059
     C           *IN98     IFEQ '0'                        B005           E23059
     C                     MOVE ZDD       OYY                             E23059
     C                     MOVE ZMM       OMM                             E23059
     C                     MOVE ZYY       ODD                             E23059
     C*                                                                   E23059
     C                     ELSE                            X005           E23059
     C                     MOVE ZDD       OMM                             E23059
     C                     MOVE ZMM       OYY                             E23059
     C                     MOVE ZYY       ODD                             E23059
     C                     END                             E005           E23059
     C                     Z-ADDODATE     SNPDT3                          E23059
     C*                                                                   E23059
     C***********ZYN       IFLT 71                         B005    E23059 124673
     C           ZYN       IFLT 72                         B005           124673
     C                     MOVE '20'      SNPDT2                          E23059
     C                     ELSE                                           E23059
     C                     MOVE '19'      SNPDT2                          E23059
     C                     END                             E005           E23059
     C*                                                                   E23059
     C                     ELSE                            X004           E23059
     C                     MOVE SSLDT     SNPDT                           E21458
     C                     MOVE SSLDT1    SNPDT1                          E21458
     C                     MOVE SSLDT2    SNPDT2                          E21458
     C                     MOVE SSLDT3    SNPDT3                          E21458
     C                     END                             E004           E23059
     C*                                                                   E23059
     C                     MOVE SNPDT1    NDAT                            E23059
      *                                                                   E21458
     C                     ELSE                            X003
     C                     SETON                     4589
     C*********************MOVEA' 284'    ERCD,Z                          S01117
     C                     MOVEA' 078'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     Z-ADD1         PHW     50                      140640
     C                     END                             E003
     C***********          ELSE                            X002           078189
     C***********          Z-ADD0         SNPDT                           078189
     C***********          Z-ADD0         SNPDT1                          078189
     C***********          Z-ADD0         SNPDT2                          078189
     C***********          Z-ADD0         SNPDT3                          078189
     C***********          ENDD           SNPDT            E002           078189
     C*                                                                   078189
     C* IF DATE NOT BLANK, VALIDATE IT                                    078189
     C                     ELSE                            X001
     C                     MOVE NDAT      ZDATE
     C                     EXSR ZDATE1
      *
      ** THE NEXT PAYMENT DATE MUST NOT BE A HOLIDAY IN LOCAL             E32543
      *  CURRENCY                                                         E32543
     C                     MOVE BJLCCY    ZCCY                            E32543
     C                     EXSR ZCHKH                                     E32543
      *                                                                   E32543
      ** if ZIND = 'H' then the date is a holiday                         E32543
     C           ZIND      IFEQ 'H'                                       E32543
     C**********           SETON                     726789         E32543081663
     C*********************MOVEA' W12'    ERCD,Z                    E32543S01117
     C**********           MOVEA' W04'    ERCD,Z                    S01117081663
     C**********           ADD  1         Z                         E32543081663
     C**********           ELSE                                     E32543081663
     C**********           SETOF                     67             E32543081663
     C**********           END                                      E32543081663
     C** Make sure warning is displayed at least once                     081663
     C*                                                                   081663
     C                     MOVEL'Y'       FTWARN  1                       081663
     C           WRN@,1    IFEQ *BLANKS                                   081663
     C                     MOVEL*BLANKS   FTRSND                          081663
     C                     MOVEA'Y'       WRN@,1                          081663
     C                     END                                            081663
     C*                                                                   081663
     C** Send message                                                     081663
     C*                                                                   081663
     C                     SETON                     67                   081663
     C                     MOVEL'FTM0026' FTMSID                          081663
     C                     EXSR FTSNMS                                    081663
     C                     ELSE                                           081663
     C*                                                                   081663
     C** Warning not sent                                                 081663
     C*                                                                   081663
     C                     SETOF                     67                   081663
     C                     MOVEA' '       WRN@,1                          081663
     C                     END                                            081663
      *
     C           *IN99     IFEQ '1'                        B002
     C***********ZDAYNO****ORLE RUND                                      S01194
     C           ZDAYNO    ORLE BJRDNB                                    S01194
     C           ZDAYNO    ORGT SFDAT
     C                     SETON                     4589
     C***99****************MOVEA' 285'    ERCD,Z                          S01117
     C   99                MOVEA' 079'    ERCD,Z                          S01117
     C**N99****************MOVEA' 286'    ERCD,Z                          S01117
     C  N99                MOVEA' 080'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     Z-ADD1         PHW     50                      140640
     C                     ELSE                            X002
     C                     MOVE ZDATE     SNPDT1
     C                     Z-ADDZDAYNO    SNPDT
     C           *IN98     IFEQ '0'                        B003
     C                     MOVE ZDD       OYY
     C                     MOVE ZMM       OMM
     C                     MOVE ZYY       ODD
     C                     ELSE                            X003
     C                     MOVE ZDD       OMM
     C                     MOVE ZMM       OYY
     C                     MOVE ZYY       ODD
     C                     END                             E003
     C                     MOVE ODATE     SNPDT3
     C* FIND CENTURY
     C***********ZYN       IFLT 71                         B003           124673
     C           ZYN       IFLT 72                         B003           124673
     C                     MOVE '20'      SNPDT2
     C                     ELSE                            X003
     C                     MOVE '19'      SNPDT2
     C                     END                             E003
     C                     END                             E002
     C                     END                             E001
     C                     ELSE                                           079189
     C*
     C* IF THIS IS A NON-REGULAR PAYMENT, NEXT PAYMENT DATE MUST BE BLANK 078189
     C***********SRPAY     IFEQ 'N'                        B001           078189
     C           SPYTP     IFEQ 'OP'                                      078189
     C           NDAT      ANDNE*BLANK
     C***********SPYTP     OREQ 'OP'                                      078189
     C***********NDAT      ANDNE*BLANK                                    078189
     C                     SETON                     4589
     C************IN38     IFNE '1'                                       078189
     C************IN39     ANDNE'1'                                       078189
     C************IN40     ANDNE'1'                                       078189
     C*********************MOVEA' 450'    ERCD,Z                          S01117
     C                     MOVEA' 075'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     Z-ADD1         PHW     50                      140640
     C                     END
     C                     END                             E001
     C*
     C                     ENDSR
     C*
     C************************************************************
     C* END OF NEXT PAYMENT DATE VALIDATION
     C************************************************************
     C/EJECT
     C************************************************************
     C* SWIFT SR.
     C* VALIDATION OF SWIFT PRIORITY CODE
     C**OPTIONAL*DEFAULT*OF*02*                                           S01117
     C* OPTIONAL DEFAULT OF 'N'                                           S01117
     C*
     C***********SWIFT     BEGSR                                          068230
     C           SWIFTC    BEGSR                                          068230
     C*
     C           SSWPC     IFEQ *BLANK                     B001
     C*********************MOVE '02'      SSWPC                           S01117
     C                     MOVE 'N'       SSWPC                           S01117
     C                     END                             E001
     C***********SSWPC*****IFNE '01'                       B001           S01117
     C***********SSWPC*****ANDNE'02'                                      S01117
     C***********SSWPC*****ANDNE'11'                                      S01117
     C***********SSWPC*****ANDNE'12'                                      S01117
     C           SSWPC     IFNE 'U'                        B001           S01117
     C           SSWPC     ANDNE'N'                                       S01117
     C                     SETON                     4289
     C*********************MOVEA' 063'    ERCD,Z                          S01117
     C                     MOVEA' 084'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     Z-ADD1         PHW     50                      140640
     C                     END                             E001
     C*
     C                     ENDSR
     C*
     C************************************************************
     C* END OF VALIDATION OF SWIFT PRIORITY CODE
     C************************************************************
     C/EJECT
     C************************************************************
     C* SETTYP SR.
     C* VALIDATION OF SETTLEMENT TYPE
     C* MANDATORY
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0040CP15                                           S01408
     C*                                                                   S01408
     C* MUST BE ONE OF 01,02,08,10,12,13
     C*
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0040CP16                                           S01408
     C*                                                                   S01408
     C           SETTYP    BEGSR
     C*
     C*00/Copy member FT0040VSM1 - Validate Settlement type               S01435
     C/COPY WNCPYSRC,FT0040VSM1                                           S01435
     C           SSTTP     IFEQ *BLANK                     B001
     C                     SETON                     4189
     C*********************MOVEA' 142'    ERCD,Z                          S01117
     C                     MOVEA' 086'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     Z-ADD1         PHW     50                      140640
     C                     ELSE                            X001
     C********** SSTTP     IFNE '01'                                      CFT003
     C           CFT003    IFNE 'CFT003'                                  CFT003
     C/COPY WNCPYSRC,FT0040C286
     C           SSTTP     ANDNE'01'                                      CFT003
     C           SSTTP     ANDNE'02'
     C           SSTTP     ANDNE'08'
     C           SSTTP     ANDNE'10'
     C           SSTTP     ANDNE'12'
     C           SSTTP     ANDNE'13'
     C/COPY WNCPYSRC,FT0040C225
     C*                                                                   CFT003
     C           CFT003    OREQ 'CFT003'                                  CFT003
     C/COPY WNCPYSRC,FT0040C287
     C           SSTTP     ANDNE'01'                                      CFT003
     C           SSTTP     ANDNE'02'                                      CFT003
     C           SSTTP     ANDNE'08'                                      CFT003
     C           SSTTP     ANDNE'10'                                      CFT003
     C           SSTTP     ANDNE'12'                                      CFT003
     C           SSTTP     ANDNE'13'                                      CFT003
     C           SSTTP     ANDNE'14'                                      CFT003
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0040CP17                                           S01408
     C*                                                                   S01408
     C                     SETON                     4189
     C*********************MOVEA' 064'    ERCD,Z                          S01117
     C                     MOVEA' 085'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     Z-ADD1         PHW     50                      140640
     C                     END                             E002
     C                     END                             E001
     C*00/Copy member FT0040VSM2 - Validate Settlement type               S01435
     C/COPY WNCPYSRC,FT0040VSM2                                           S01435
     C*
     C* IF SETTLEMENT TYPE 08 DESTINATION MUST BE SWIFT OR WARNING
     C           SSTTP     IFEQ '08'                       B001
     C* IF FULL ADDRESS OR SWIFT ADDRESS OR BLANK IGNORE
     C* OR DETINATION INVALID OR INVALID PAY CURRENCY
     C           SDSTT     IFEQ 'A'                        B002
     C           SDSTT     OREQ 'S'
     C           SDSTT     OREQ ' '
     C           *IN24     OREQ '1'
     C********** *IN35     OREQ '1'                                       140652
     C                     MOVE *BLANK    CSID
     C                     GOTO STADD
     C                     END                             E002
     C* IF FULL NOSTRO(F)
     C           SDSTT     IFEQ 'F'                        B002
     C                     MOVELSDST1     CURR
     C**READ*TABLETL*FOR*CUSTOMER*NUMBER                                  S01194
     C*********************MOVE *BLANK    KEY                             S01194
     C*********************MOVEL'70'      KEY                             S01194
     C*********************MOVE CURR      KEY                             S01194
     C***********KEY*******CHAINTABLETLF             88                   S01194
     C**N88******RECI******COMP 'D'                  8888                 S01194
     C***88****************DO                              B003           S01194
     C************LOCK*****IN   *NAMVAR                                   S01194
     C*********************MOVE 'FT0040  'DBPGM            ***************S01194
     C*********************MOVE 'TABLE'   DBFILE           * DB ERROR 20 *S01194
     C*********************Z-ADD20        DBASE            ***************S01194
     C*********************MOVELKEY       DBKEY                           S01194
     C*********************OUT  *NAMVAR                                   S01194
     C*********************SETON                     U7U8LR               S01194
     C*********************DUMP                                           S01194
     C*********************RETRN                                          S01194
     C*********************END                             E003           S01194
     C*                                                                   S01194
     C** Read SDNOSTPD for customer number                                S01194
     C*                                                                   S01194
     C                     CALL 'AONOSTR0'                                S01194
     C                     PARM '*DBERR ' RTCD                            S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM *BLANKS   @CUST                           S01194
     C                     PARM CURR      @CYCD                           S01194
     C                     PARM *BLANKS   @ACCD                           S01194
     C                     PARM *BLANKS   @ACSN                           S01194
     C                     PARM CURRN     @NONB                           S01194
     C                     PARM *BLANKS   @BRCD                           S01194
     C                     PARM *BLANKS   @CSSN                           S01194
     C                     PARM *BLANKS   @PNOI                           S01194
     C           SDNOST    PARM SDNOST    DSFDY                           S01194
     C*                                                                   S01194
     C           RTCD      CASEQ*BLANKS   MVNOST     8888                 S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C                     ELSE                            X002
     C* IF RETAIL NUMBER(R) READ ACNUMA FOR CUSTOMER NUMBER
     C           SDSTT     IFEQ 'R'                        B003
     C                     MOVELSDST1     ACNO
     C           ACNO      CHAINACNUMAF              88
     C  N88      RECI      COMP 'D'                  8888
     C**N88*****           Z-ADDRETNUM    CNUM                                         179685 CSD027
     C  N88                MOVE RETNUM    CNUM                                                CSD027
     C   88                DO                              B004
     C           *LOCK     IN   *NAMVAR
     C                     MOVE 'FT0040  'DBPGM            ***************
     C                     MOVE 'ACNUM'   DBFILE           * DB ERROR 21 *
     C                     Z-ADD21        DBASE            ***************
     C                     MOVELACNO      DBKEY
     C                     OUT  *NAMVAR
     C                     SETON                     U7U8LR
     C/COPY WNCPYSRC,FT0040C145
     C                     DUMP
      *                                                                   042167
      *  Allocate dataarea to blanks                                      042167
      *                                                                   042167
     C                     EXSR DALLOC                                    042167
      *                                                                   042167
     C                     RETRN
     C                     END                             E004
     C                     ELSE                            X003
     C* ELSE CUSTOMER NUMBER IS AT START OF INAD
     C                     MOVELSDST1     CNUM
     C                     END                             E003
     C                     END                             E002
     C**READ*CLINT*FOR*SWIFT*ADDRESS                                      S01194
     C***********CNUM******CHAINCLINTCBF             88                   S01194
     C**N88******RECI******COMP 'D'                  8888                 S01194
     C***88****************DO                              B002           S01194
     C************LOCK*****IN   *NAMVAR                                   S01194
     C*********************MOVE 'FT0040  'DBPGM            ***************S01194
     C*********************MOVE 'CLINT'   DBFILE           * DB ERROR 22 *S01194
     C*********************Z-ADD22        DBASE            ***************S01194
     C*********************MOVELCNUM      DBKEY                           S01194
     C*********************OUT  *NAMVAR                                   S01194
     C*********************SETON                     U7U8LR               S01194
     C*********************DUMP                                           S01194
     C*********************RETRN                                          S01194
     C*********************END                             E002           S01194
     C*                                                                   S01194
     C** Read SDCUSTPD for swift address                                  S01194
     C*                                                                   S01194
     C                     CALL 'AOCUSTR0'                                S01194
     C                     PARM '*DBERR'  RTCD                            S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM CNUMA     @KEY1                           S01194
     C                     PARM *BLANKS   @KYST                           S01194
     C           SDCUST    PARM SDCUST    DSSDY                           S01194
     C*                                                                   S01194
     C           RTCD      CASEQ*BLANKS   MVCUST     8888                 S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C           STADD     TAG                             TAG** STADD
     C           CSID      IFEQ *BLANK                     B002
     C           SDSTT     ANDNE'S'                        B002           068230
     C           CSID      OREQ *BLANK                                    140642
     C           SWIIND    ANDEQ'*NFND'                                   140642
     C*********************SETON                     244789               E32543
     C                     SETON                     247289               E32543
     C                     MOVEA' W01'    ERCD,Z
     C                     ADD  1         Z
     C                     END                             E002
     C                     END                             E001
      *                                                                   CFT003
      * For Settlement type '14' Destination must be entered as           CFT003
      * Retail account and sender's correspondent must be blank.          CFT003
      *                                                                   CFT003
     C           SSTTP     IFEQ '14'                                      CFT003
     C           CFT003    ANDEQ'CFT003'                                  CFT003
     C           SDSTT     IFNE 'R'                                       CFT003
     C           SDSTT     OREQ 'R'                                       CFT003
     C           SSNCO     ANDNE*BLANK                                    CFT003
     C                     MOVE *ON       *IN41                           CFT003
     C                     MOVEL'FTM0025' FTMSID                          CFT003
     C                     MOVEL'Y'       FTNOUP                          CFT003
     C                     EXSR FTSNMS                                    CFT003
     C                     ENDIF                                          CFT003
     C                     ENDIF                                          CFT003
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0040CP18                                           S01408
     C*                                                                   S01408
     C*
     C                     ENDSR
     C*
     C************************************************************
     C* END OF SETTLEMENT TYPE VALIDATION
     C************************************************************
     C/EJECT
     C************************************************************
     C* SM202 SR.
     C* VALIDATION OF SWIFT MT202 INDICATOR
     C* DEFAULT DEPENDENT ON SENDER'S CORRESPONDENT
     C* MUST EQUAL 'Y' OR 'N'
     C*
     C           SM202     BEGSR
     C*
     C           SSNMT     IFEQ *BLANK                     B001
     C           SSNCO     IFEQ *BLANK                     B002
     C                     MOVE 'N'       SSNMT
     C                     ELSE                            X002
     C                     MOVE 'Y'       SSNMT
     C                     END                             E002
     C/COPY WNCPYSRC,FT0040C198
     C                     END                             E001
     C           SSNMT     IFNE 'Y'                        B001
     C           SSNMT     ANDNE'N'
     C                     SETON                     4389
     C*********************MOVEA' 067'    ERCD,Z                          S01117
     C                     MOVEA' 089'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     Z-ADD1         PHW     50                      140640
     C                     END                             E001
     C           SSNMT     IFEQ 'Y'                        B001
     C           SSNCO     ANDEQ*BLANK
     C/COPY WNCPYSRC,FT0040C199
     C                     SETON                     4389
     C*********************MOVEA' 066'    ERCD,Z                          S01117
     C                     MOVEA' 088'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     Z-ADD1         PHW     50                      140640
     C                     END                             E001
     C*IF SENDER'S CORRESPONDENT IS BLANK GO TO END
     C           SSNCO     IFEQ *BLANK                     B001
     C                     GOTO SNEND
     C                     END                             E001
     C* IF SENDER'S COR OR DEST INVALID IGNORE
     C   24
     COR 26
     COR 35                GOTO SNEND
     C**IF*FULL*ADDRESS*OR*SWIFT*ADDRESS*OR*BLANK*IGNORE
     C* IF FULL ADDRESS OR BLANK IGNORE                                   098840
     C           SDSTT     IFEQ 'A'                        B001
     C***********SDSTT     OREQ 'S'                        B001           098840
     C           SDSTT     OREQ ' '
     C/COPY WNCPYSRC,FT0040C277
     C                     MOVE *BLANK    DSADD   4
     C                     GOTO SNADD
     C                     END                             E001
     C           SDSTT     IFEQ 'S'                                       098840
     C                     MOVELSDST1     DSADD                           098840
     C                     GOTO SNADD                                     098840
     C                     END                                            098840
     C* IF FULL NOSTRO(F)
     C           SDSTT     IFEQ 'F'                        B001
     C                     MOVELSDST1     CURR
     C**READ*TABLETL*FOR*CUSTOMER*NUMBER                                  S01194
     C*********************MOVE *BLANK    KEY                             S01194
     C*********************MOVEL'70'      KEY                             S01194
     C*********************MOVE CURR      KEY                             S01194
     C***********KEY*******CHAINTABLETLF             88                   S01194
     C**N88******RECI******COMP 'D'                  8888                 S01194
     C***88****************DO                              B002           S01194
     C************LOCK*****IN   *NAMVAR                                   S01194
     C*********************MOVE 'FT0040  'DBPGM            ***************S01194
     C*********************MOVE 'TABLE'   DBFILE           * DB ERROR 08 *S01194
     C*********************Z-ADD8         DBASE            ***************S01194
     C*********************MOVELKEY       DBKEY                           S01194
     C*********************OUT  *NAMVAR                                   S01194
     C*********************SETON                     U7U8LR               S01194
     C*********************DUMP                                           S01194
     C*********************RETRN                                          S01194
     C*********************END                             E002           S01194
     C*                                                                   S01194
     C** Read SDNOSTPD for customer number                                S01194
     C*                                                                   S01194
     C                     CALL 'AONOSTR0'                                S01194
     C                     PARM '*DBERR'  RTCD                            S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM *BLANKS   @CUST                           S01194
     C                     PARM CURR      @CYCD                           S01194
     C                     PARM *BLANKS   @ACCD                           S01194
     C                     PARM *BLANKS   @ACSN                           S01194
     C                     PARM CURRN     @NONB                           S01194
     C                     PARM *BLANKS   @BRCD                           S01194
     C                     PARM *BLANKS   @CSSN                           S01194
     C                     PARM *BLANKS   @PNOI                           S01194
     C           SDNOST    PARM SDNOST    DSFDY                           S01194
     C*                                                                   S01194
     C                     EXSR MVNOST                                    S01194
     C*                                                                   S01194
     C                     ELSE                            X001
     C* IF RETAIL NUMBER(R) READ ACNUMA FOR CUSTOMER NUMBER
     C           SDSTT     IFEQ 'R'                        B002
     C                     MOVELSDST1     ACNO
     C           ACNO      CHAINACNUMAF              88
     C  N88      RECI      COMP 'D'                  8888
     C**N88*****           Z-ADDRETNUM    CNUM                                         179685 CSD027
     C  N88                MOVE RETNUM    CNUM                                                CSD027
     C   88                DO                              B003
     C           *LOCK     IN   *NAMVAR
     C                     MOVE 'FT0040  'DBPGM            ***************
     C                     MOVE 'ACNUM'   DBFILE           * DB ERROR 09 *
     C                     Z-ADD9         DBASE            ***************
     C                     MOVELACNO      DBKEY
     C                     OUT  *NAMVAR
     C                     SETON                     U7U8LR
     C/COPY WNCPYSRC,FT0040C146
     C                     DUMP
      *                                                                   042167
      *  Allocate dataarea to blanks                                      042167
      *                                                                   042167
     C                     EXSR DALLOC                                    042167
      *                                                                   042167
     C                     RETRN
     C                     END                             E003
     C                     ELSE                            X002
     C* ELSE CUSTOMER NUMBER IS AT START OF INAD
     C                     MOVELSDST1     CNUM
     C                     END                             E002
     C                     END                             E001
     C**READ*CLINT*FOR*SWIFT*ADDRESS                                      S01194
     C***********CNUM******CHAINCLINTCBF             88                   S01194
     C**N88******RECI******COMP 'D'                  8888                 S01194
     C***88****************DO                              B001           S01194
     C************LOCK*****IN   *NAMVAR                                   S01194
     C*********************MOVE 'FT0040  'DBPGM            ***************S01194
     C*********************MOVE 'CLINT'   DBFILE           * DB ERROR 10 *S01194
     C*********************Z-ADD10        DBASE            ***************S01194
     C*********************MOVELCNUM      DBKEY                           S01194
     C*********************OUT  *NAMVAR                                   S01194
     C*********************SETON                     U7U8LR               S01194
     C*********************DUMP                                           S01194
     C*********************RETRN                                          S01194
     C*********************END                             E001           S01194
     C*                                                                   S01194
     C** Read SDCUSTPD for swift address                                  S01194
     C*                                                                   S01194
     C                     CALL 'AOCUSTR0'                                S01194
     C                     PARM '*DBERR ' RTCD                            S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM CNUMA     @KEY1                           S01194
     C                     PARM *BLANKS   @KYST                           S01194
     C           SDCUST    PARM SDCUST    DSSDY                           S01194
     C*                                                                   S01194
     C                     EXSR MVCUST                                    S01194
     C*                                                                   S01194
     C                     MOVELCSID      DSADD
     C           SNADD     TAG                             TAG** SNADD
     C           SSNCT     IFNE 'N'                        B001
     C           SSNCT     ANDNE'R'
     C                     MOVE *BLANK    SSADD   4
     C                     GOTO ENADD
     C                     END                             E001
     C* IF NOSTRO(N)
     C           SSNCT     IFEQ 'N'                        B001
     C                     MOVELSSNCO     CURRN
     C                     MOVELSPCCY     CURR
     C**READ*TABLETL*FOR*CUSTOMER*NUMBER                                  S01194
     C*********************MOVE *BLANK    KEY                             S01194
     C*********************MOVEL'70'      KEY                             S01194
     C*********************MOVE CURR      KEY                             S01194
     C***********KEY*******CHAINTABLETLF             88                   S01194
     C**N88******RECI******COMP 'D'                  8888                 S01194
     C***88****************DO                              B002           S01194
     C************LOCK*****IN   *NAMVAR                                   S01194
     C*********************MOVE 'FT0040  'DBPGM            ***************S01194
     C*********************MOVE 'TABLE'   DBFILE           * DB ERROR 11 *S01194
     C*********************Z-ADD11        DBASE            ***************S01194
     C*********************MOVELKEY       DBKEY                           S01194
     C*********************OUT  *NAMVAR                                   S01194
     C*********************SETON                     U7U8LR               S01194
     C*********************DUMP                                           S01194
     C*********************RETRN                                          S01194
     C*********************END                             E002           S01194
     C*                                                                   S01194
     C** Read SDNOSTPD for customer number                                S01194
     C*                                                                   S01194
     C                     CALL 'AONOSTR0'                                S01194
     C                     PARM '*DBERR ' RTCD                            S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM *BLANKS   @CUST                           S01194
     C                     PARM CURR      @CYCD                           S01194
     C                     PARM *BLANKS   @ACCD                           S01194
     C                     PARM *BLANKS   @ACSN                           S01194
     C                     PARM CURRN     @NONB                           S01194
     C                     PARM *BLANKS   @BRCD                           S01194
     C                     PARM *BLANKS   @CSSN                           S01194
     C                     PARM *BLANKS   @PNOI                           S01194
     C           SDNOST    PARM SDNOST    DSFDY                           S01194
     C*                                                                   S01194
     C                     EXSR MVNOST                                    S01194
     C*                                                                   S01194
     C                     ELSE                            X001
     C* IF RETAIL NUMBER(R) READ ACNUMA FOR CUSTOMER NUMBER
     C           SSNCT     IFEQ 'R'                        B002
     C                     MOVELSSNCO     ACNO
     C           ACNO      CHAINACNUMAF              88
     C  N88      RECI      COMP 'D'                  8888
     C**N88*****           Z-ADDRETNUM    CNUM                                         179685 CSD027
     C  N88                MOVE RETNUM    CNUM                                                CSD027
     C   88                DO                              B003
     C           *LOCK     IN   *NAMVAR
     C                     MOVE 'FT0040  'DBPGM            ***************
     C                     MOVE 'ACNUM'   DBFILE           * DB ERROR 12 *
     C                     Z-ADD12        DBASE            ***************
     C                     MOVELACNO      DBKEY
     C                     OUT  *NAMVAR
     C                     SETON                     U7U8LR
     C/COPY WNCPYSRC,FT0040C147
     C                     DUMP
      *                                                                   042167
      *  Allocate dataarea to blanks                                      042167
      *                                                                   042167
     C                     EXSR DALLOC                                    042167
      *                                                                   042167
     C                     RETRN
     C                     END                             E003
     C                     END                             E002
     C                     END                             E001
     C**READ*CLINT*FOR*SWIFT*ADDRESS                                      S01194
     C***********CNUM******CHAINCLINTCBF             88                   S01194
     C**N88******RECI******COMP 'D'                  8888                 S01194
     C***88****************DO                              B001           S01194
     C************LOCK*****IN   *NAMVAR                                   S01194
     C*********************MOVE 'FT0040  'DBPGM            ***************S01194
     C*********************MOVE 'CLINT'   DBFILE           * DB ERROR 13 *S01194
     C*********************Z-ADD13        DBASE            ***************S01194
     C*********************MOVE *BLANK    DBKEY                           S01194
     C*********************MOVELCNUM      DBKEY                           S01194
     C*********************OUT  *NAMVAR                                   S01194
     C*********************SETON                     U7U8LR               S01194
     C*********************DUMP                                           S01194
     C*********************RETRN                                          S01194
     C*********************END                             E001           S01194
     C*                                                                   S01194
     C** Read SDCUSTPD for swift address                                  S01194
     C*                                                                   S01194
     C                     CALL 'AOCUSTR0'                                S01194
     C                     PARM '*DBERR ' RTCD                            S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM CNUMA     @KEY1                           S01194
     C                     PARM *BLANKS   @KYST                           S01194
     C           SDCUST    PARM SDCUST    DSSDY                           S01194
     C*                                                                   S01194
     C                     EXSR MVCUST                                    S01194
     C*                                                                   S01194
     C                     MOVELCSID      SSADD
     C           ENADD     TAG                             TAG** ENADD
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0040CP27                                           S01408
     C*                                                                   S01408
     C* FOR ENTRY TO 'Y'
     C* SWIFT ADDRESSES FIRST 4 CHARACTERS MUST BE NON-BLANK
     C* AND EQUAL
     C           SSNMT     IFEQ 'N'                        B001
     C           DSADD     IFEQ *BLANK                     B002
     C           SSADD     OREQ *BLANK
     C           DSADD     ORNE SSADD
     C***********SPCCY*****IFNE BCCY                       B003           S01194
     C           SPCCY     IFNE BJCYCD                     B003           S01194
     C                     SETON                     4389
     C*********************MOVEA' 065'    ERCD,Z                          S01117
     C                     MOVEA' 087'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     Z-ADD1         PHW     50                      140640
     C                     END                             E003
     C                     END                             E002
     C                     END                             E001
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0040CP28                                           S01408
     C*                                                                   S01408
     C*
     C           SNEND     ENDSR                           ***TAG SNEND
     C/COPY WNCPYSRC,FT0040C200
     C*
     C************************************************************
     C* END OF MT202 VALIDATION
     C************************************************************
     C/EJECT
     C************************************************************
     C* OLDBIT SR.
     C* SAVE OLD VALUES BEFORE UPDATING
     C*
     C           OLDBIT    BEGSR
     C*
     C                     MOVE DSTT      ODSTT   1
     C                     MOVE DST1      ODST1  35
     C                     MOVE SNCT      OSNCT   1
     C***********          MOVELSNCO      OSNCO  100                                          CSD027
     C                     MOVELSNCO      OSNCO  10                                           CSD027
     C                     MOVE ORBT      OORBT   1
     C**********           MOVELORBK      OORBK  120                                          CGL029
     C***********          MOVELORBK      OORBK  180                                   CGL029 CSD027
     C                     MOVELORBK      OORBK  18                                           CSD027
     C                     MOVE ORBB      OORBB   3                       S01117
     C                     MOVE ORCT      OORCT   1
     C                     MOVE ORC1      OORC1  35
     C/COPY WNCPYSRC,FT0040C039
      *                                                                   CEU006
     C                     Z-ADDNDAM      ONDAM  130                      CEU006
     C                     MOVE NDCY      ONDCY   3                       CEU006
     C                     Z-ADDPDAM      OPDAM  130                      CEU006
     C                     MOVE PDCY      OPDCY   3                       CEU006
      *                                                                   CEU006
     C                     Z-ADDSMAM      OSMAM  130
     C                     MOVE SMCY      OSMCY   3
     C                     Z-ADDMDIN      OMDIN   10
     C                     Z-ADDRATE      ORATE  138
     C                     MOVE OVRD      OOVRD   1
     C                     Z-ADDPYAM      OPYAM  130
     C                     MOVE PCCY      OPCCY   3
     C                     Z-ADDSLDT      OSLDT   50
     C                     Z-ADDPVDT      OPYDT   50
     C*
     C                     ENDSR
     C*
     C************************************************************
     C* END OF OLD BIT SAVES
     C************************************************************
     C/EJECT
     C************************************************************
     C* ODMTX SR.
     C* VALIDATION OF MT100 CUSTOMER
     C* OPTIONAL - IF ENTRY - MUST BE A SIX DIGIT CUSTOMER NO.
     C*          - OR A TEN DIGIT CUSTOMER NAME. IF A VALID NAME
     C*          - IS ENTERED IT IS CONVERTED TO A NUMBER.
     C*
     C           ODMTX     BEGSR
     C*
     C                     SETOF                     54                   S01194
     C           SODMT     IFNE *BLANK                     B001           S01194
     C*********************Z-ADD*ZERO     CNUM              001           S01194
     C*********************MOVELSODMT     CNUM              001           S01194
     C*********************MOVE 'A'       RCDT              001           S01194
     C***********CNUM******CHAINCLINTCBF             88     001           S01194
     C                     CALL 'AOCUSTR0'                                S01194
     C                     PARM *BLANKS   RTCD                            S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM SODMT     @KEY1                           S01194
     C                     PARM *BLANKS   @KYST                           S01194
     C           SDCUST    PARM SDCUST    DSSDY                           S01194
     C*                                                                   S01194
     C           RTCD      COMP *BLANKS              8888                 S01194
     C           *IN88     IFEQ '1'                                       S01194
     C                     SETON                     5489                 S01194
     C                     MOVEA' 046'    ERCD,Z                          S01194
     C                     ADD  1         Z                               S01194
     C                     Z-ADD1         PHW     50                      140640
     C                     ELSE                                           S01194
     C                     EXSR MVCUST                                    S01194
     C                     MOVE *BLANKS   SODMT                           S01194
     C                     MOVELBBCUST    SODMT                           S01194
     C                     END                                            S01194
     C                     END                             E001           S01194
     C**N88******RECI******COMP 'D'                  8888   001           S01194
     C************IN88     IFEQ '1'                        B002           S01194
     C*********************SETOF                     88     002           S01194
     C*********************MOVELSODMT     CSNM              002           S01194
     C***********CSNM******CHAINSNAMEF               88     002           S01194
     C**N88******RECI******COMP 'D'                  8888   002           S01194
     C************IN88*****IFEQ '1'                        B003           S01194
     C*********************SETON                     5489   003           S01194
     C*********************MOVEA' 130'    ERCD,Z            003           S01194
     C*********************ADD  1         Z                 003           S01194
     C*********************ELSE                            X003           S01194
     C*********************ELSE                            X002           S01194
     C*********************MOVE *BLANK    SODMT             003           S01194
     C*********************MOVELCNUM      SODMT             003           S01194
     C*********************END                             E003           S01194
     C*********************END                             E002           S01194
     C*********************END                             E001           S01194
     C/COPY WNCPYSRC,FT0040C126
     C*
     C                     ENDSR
     C*
     C************************************************************
     C* END OF VALIDATION OF MT100 CUSTOMER
     C************************************************************
     C/EJECT                                                              CFT009
      *****************************************************************   CFT009
      *                                                               *   CFT009
      *  SRSPST   : Validate spread set and default charges           *   CFT009
      *                                                               *   CFT009
      *  CALLED BY: VALTWO                                            *   CFT009
      *                                                               *   CFT009
      *  CALLS    : *NONE                                             *   CFT009
      *                                                               *   CFT009
      *****************************************************************   CFT009
     CSR         SRSPST    BEGSR                                          CFT009
      *                                                                   CFT009
      *  Set up subroutine stack name                                     CFT009
      *                                                                   CFT009
     C                     ADD  1         Q                               CFT009
     C                     MOVEL'SRSPST'  @STK,Q                          CFT009
      *                                                                   CFT009
      ** Spread set must be blank, if settle currency = pay currency      CFT009
      *                                                                   CFT009
     C           SSMCY     IFEQ SPCCY                                     CFT009
     C           SSMCY     ANDNE*BLANKS                                   CFT009
     C           SPCCY     ANDNE*BLANKS                                   CFT009
      *                                                                   CFT009
     C           SPDSET    IFNE *BLANKS                                   CFT009
     C                     MOVE *ON       *IN73                           CFT009
     C                     MOVE *ON       *IN89                           CFT009
     C                     MOVEL'FTF3157' FTMSID                          CFT009
     C                     Z-ADD1         PHW                             CFT009
     C                     EXSR FTSNMS                                    CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
      *                                                                   CFT009
      ** Must be a valid spread set if not blank                          CFT009
      *                                                                   CFT009
     C           SPDSET    IFNE *BLANKS                                   CFT009
     C           SPDSET    SETLLFTXTRHL0                 70               CFT009
      *                                                                   CFT009
     C           *IN70     IFEQ *OFF                                      CFT009
     C                     MOVE *ON       *IN73                           CFT009
     C                     MOVE *ON       *IN89                           CFT009
     C                     MOVEL'FTF3152' FTMSID                          CFT009
     C                     Z-ADD1         PHW                             CFT009
     C                     EXSR FTSNMS                                    CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Default charges                                                  CFT009
      *                                                                   CFT009
     C           *IN73     IFEQ *OFF                                      CFT009
     C           ACTION    ANDEQ'I'                                       CFT009
     C           *IN73     OREQ *OFF                                      CFT009
     C           ACTION    ANDEQ'A'                                       CFT009
     C           *IN73     OREQ *OFF                                      CFT009
     C           F12       ANDEQ'Y'                                       CFT009
      * Extra conditions to ensure re-default of charges                  CFT009
     C           *IN73     OREQ *ON                                       CFT009
     C           ACTION    ANDEQ'I'                                       CFT009
     C           KEYCHG    ANDEQ'Y'                                       CFT009
     C           *IN73     OREQ *ON                                       CFT009
     C           ACTION    ANDEQ'A'                                       CFT009
     C           KEYCHG    ANDEQ'Y'                                       CFT009
     C           *IN73     OREQ *ON                                       CFT009
     C           F12       ANDEQ'Y'                                       CFT009
     C           KEYCHG    ANDEQ'Y'                                       CFT009
     C                     CLEAROTPYDS                                    CFT009
     C                     CLEAROTPXDS                                    CFT009
     C                     CLEARTRNDET                                    CFT009
     C                     CLEARTRNEXT                                    CFT009
      *                                                                   CFT009
      * Move details into outgoing payment details DS                     CFT009
      *                                                                   CFT009
     C                     EXSR MOVES                                     CFT009
     C                     EXSR MOVODS                                    CFT009
      *                                                                   CFT009
     C                     MOVELOTPYDS    TRNDET                          CFT009
     C                     MOVELOTPXDS    TRNEXT                          CFT009
      *                                                                   CFT009
     C                     CALL 'FT000980'                                CFT009
     C                     PARM           RTN980 10                       CFT009
     C                     PARM           TRNDET                          CFT009
     C                     PARM           TRNEXT                          CFT009
     C                     PARM 'OP'      TRNTYP  2                       CFT009
     C                     PARM 'M'       PRCMTD  1                       CFT009
     C                     PARM *BLANKS   MESTYP  3                       CFT009
     C                     PARM *BLANKS   SETNUM  3                       CFT009
      *                                                                   CFT009
     C                     MOVELTRNDET    OTPYDS                          CFT009
     C                     MOVELTRNEXT    OTPXDS                          CFT009
      *                                                                   CFT009
      *                                                                   CFT009
     C                     MOVELOTLXCD    TLXCDE                          CFT009
     C                     MOVELOCHQCH    CHQCHC                          CFT009
     C                     MOVELOCACHC    CACHCD                          CFT009
     C                     MOVELOSSTCC    SSTCCD                          CFT009
     C                     MOVELOSPRCC    SPRCCD                          CFT009
     C                     MOVELOMSCHC    MSCHC                           CFT009
     C                     MOVELOMSCH1    MSCHC1                          CFT009
     C                     MOVELOMSCH2    MSCHC2                          CFT009
     C                     MOVELOMSCH3    MSCHC3                          CFT009
     C                     MOVELOMSCH4    MSCHC4                          CFT009
     C                     MOVELOMSCH5    MSCHC5                          CFT009
     C                     MOVELOTFCCD    TFCCCD                          CFT009
     C                     MOVELOFXCAC    FXCACC                          CFT009
      *                                                                   CFT009
     C           *LIKE     DEFN OTPDOF    DFTPDO                          CFT009
     C                     MOVE OTPDOF    DFTPDO                          CFT009
      *                                                                   CFT009
      ** If screen spread set <> defaulted spread set, issue warning      CFT009
      ** message else if screen spread set is blank and pay ccy <>        CFT009
      ** settle ccy, move it into screen field                            CFT009
      *                                                                   CFT009
     C           SPDSET    IFNE *BLANKS                                   CFT009
      *                                                                   CFT009
     C           SPDSET    IFNE FXSRSC                                    CFT009
     C                     MOVE *ON       *IN73                           CFT009
     C                     MOVEL'Y'       FTWARN                          CFT009
     C                     MOVEL'FTF3154' FTMSID                          CFT009
     C                     EXSR FTSNMS                                    CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
      *                                                                   CFT009
     C           SSMCY     IFNE SPCCY                                     CFT009
     C                     MOVE FXSRSC    SPDSET                          CFT009
     C                     ELSE                                           CFT009
      *                                                                   CFT009
      ** If currencies are the same, ensure spread set is blanked         CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   FXSRSC                          CFT009
     C                     MOVE *BLANKS   SPDSET                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** If screen rate <> calculated rate, issue warning message         CFT009
      ** else if screen rate is blank, move calculated rate in and        CFT009
      ** calculated pay amount                                            CFT009
      *                                                                   CFT009
     C           DEFRAT    IFEQ *BLANKS                                   CFT009
     C                     MOVEL*BLANK    ZFIELD                          CFT009
     C                     MOVE RATE      ZFIELD                          CFT009
     C                     Z-ADD8         ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    C#RATE 14                       CFT009
      *                                                                   CFT009
     C           C#RATE    IFNE RATEA                                     CFT009
     C                     MOVE *ON       *IN31                           CFT009
     C                     MOVEL'Y'       FTWARN                          CFT009
     C                     MOVEL'FTF0012' FTMSID                          CFT009
     C                     EXSR FTSNMS                                    CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
      *                                                                   CFT009
      ** Rate                                                             CFT009
     C                     MOVEL*BLANK    ZFIELD                          CFT009
     C                     MOVE RATE      ZFIELD                          CFT009
     C                     Z-ADD8         ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    RATEA                           CFT009
      *                                                                   CFT009
     C           RATE      IFNE 0                                         CFT009
     C                     Z-ADDRATE      SRATE                           CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Pay amount                                                       CFT009
      *                                                                   CFT009
     C                     CALL 'AOCURRR0'                                CFT009
     C                     PARM *BLANKS   @RETC   7                       CFT009
     C                     PARM '*KEY   ' @OPTN   7                       CFT009
     C                     PARM SPCCY     @CURR   3                       CFT009
     C           SDCURR    PARM SDCURR    DSSDY                           CFT009
      *                                                                   CFT009
     C           @RETC     IFNE *BLANKS                                   CFT009
     C                     MOVEL'AOCURRR0'DBFILE                          CFT009
     C                     MOVEL'*CALL'   DBKEY                           CFT009
     C                     Z-ADD36        DBASE                           CFT009
     C                     EXSR SRERR                                     CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     MOVEL*BLANK    ZFIELD                          CFT009
     C                     MOVE PYAM      ZFIELD                          CFT009
     C                     Z-ADDA6NBDP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    PYAMA                           CFT009
      *                                                                   CFT009
     C                     Z-ADDPYAM      SPYAM                           CFT009
      *                                                                   CFT009
      ** Settle amount                                                    CFT009
      *                                                                   CFT009
     C                     CALL 'AOCURRR0'                                CFT009
     C                     PARM *BLANKS   @RETC   7                       CFT009
     C                     PARM '*KEY   ' @OPTN   7                       CFT009
     C                     PARM SSMCY     @CURR   3                       CFT009
     C           SDCURR    PARM SDCURR    DSSDY                           CFT009
      *                                                                   CFT009
     C           @RETC     IFNE *BLANKS                                   CFT009
     C                     MOVEL'AOCURRR0'DBFILE                          CFT009
     C                     MOVEL'*CALL'   DBKEY                           CFT009
     C                     Z-ADD37        DBASE                           CFT009
     C                     EXSR SRERR                                     CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     MOVEL*BLANK    ZFIELD                          CFT009
     C                     MOVE SMAM      ZFIELD                          CFT009
     C                     Z-ADDA6NBDP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    SMAMA                           CFT009
      *                                                                   CFT009
     C                     Z-ADDSMAM      SSMAM                           CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** If screen settle date <> defaulted date, issue warning           CFT009
      ** message else if screen settle date is blank, move defaulted      CFT009
      ** date into screen field                                           CFT009
      *                                                                   CFT009
     C           PYDT      IFNE *BLANKS                                   CFT009
     C                     MOVE WPYDT     C#DATS  6                       CFT009
      *                                                                   CFT009
     C           C#DATS    IFNE PYDT                                      CFT009
      *                                                                   CFT009
     C           *IN72     IFEQ *OFF                                      CFT009
     C           *IN30     OREQ *OFF                                      CFT009
     C                     ADD  1         Z                               CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     MOVE *ON       *IN72                           CFT009
     C                     MOVE *ON       *IN30                           CFT009
     C                     MOVEL'Y'       FTWARN                          CFT009
     C                     MOVEL'FTF3156' FTMSID                          CFT009
     C                     EXSR FTSNMS                                    CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
     C                     MOVE SLDTD1    PYDT                            CFT009
      *                                                                   CFT009
      ** Convert settle date into various formats                         CFT009
      *                                                                   CFT009
     C                     Z-ADDSLDTD1    SSLDT1                          CFT009
     C                     MOVE SLDTD1    ZDATE                           CFT009
     C                     EXSR ZDATE1                                    CFT009
     C                     Z-ADDZDAYNO    SSLDT                           CFT009
      *                                                                   CFT009
      ** Format date for D3                                               CFT009
      *                                                                   CFT009
     C           *IN98     IFEQ *OFF                                      CFT009
     C                     MOVE ZDD       OYY                             CFT009
     C                     MOVE ZMM       OMM                             CFT009
     C                     MOVE ZYY       ODD                             CFT009
     C                     ELSE                                           CFT009
     C                     MOVE ZDD       OMM                             CFT009
     C                     MOVE ZMM       OYY                             CFT009
     C                     MOVE ZYY       ODD                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     Z-ADDODATE     SSLDT3                          CFT009
      *                                                                   CFT009
      ** Find century                                                     CFT009
      *                                                                   CFT009
     C           ZYN       IFLT 72                                        CFT009
     C                     MOVE '20'      SSLDT2                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVE '19'      SSLDT2                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** If screen pay date <> defaulted date, issue warning              CFT009
      ** message else if screen pay date is blank, move defaulted         CFT009
      ** date into screen field                                           CFT009
      *                                                                   CFT009
     C           PYVD      IFNE *BLANKS                                   CFT009
     C                     MOVE WPYVD     C#DATS  6                       CFT009
     C           C#DATS    IFNE PYVD                                      CFT009
      *                                                                   CFT009
     C           *IN72     IFEQ *OFF                                      CFT009
     C           *IN36     OREQ *OFF                                      CFT009
     C                     ADD  1         Z                               CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     MOVE *ON       *IN72                           CFT009
     C                     MOVE *ON       *IN36                           CFT009
     C                     MOVEL'Y'       FTWARN                          CFT009
     C                     MOVEL'FTF3155' FTMSID                          CFT009
     C                     EXSR FTSNMS                                    CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
     C                     MOVE PVDTD1    PYVD                            CFT009
      *                                                                   CFT009
      ** Convert pay date into various formats                            CFT009
      *                                                                   CFT009
     C                     Z-ADDPVDTD1    SPYDT1                          CFT009
     C                     MOVE PVDTD1    ZDATE                           CFT009
     C                     EXSR ZDATE1                                    CFT009
     C                     Z-ADDZDAYNO    SPYDT                           CFT009
      *                                                                   CFT009
      ** Format date for D3                                               CFT009
      *                                                                   CFT009
     C           *IN98     IFEQ *OFF                                      CFT009
     C                     MOVE ZDD       OYY                             CFT009
     C                     MOVE ZMM       OMM                             CFT009
     C                     MOVE ZYY       ODD                             CFT009
     C                     ELSE                                           CFT009
     C                     MOVE ZDD       OMM                             CFT009
     C                     MOVE ZMM       OYY                             CFT009
     C                     MOVE ZYY       ODD                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     Z-ADDODATE     SPYDT3                          CFT009
      *                                                                   CFT009
      ** Find century                                                     CFT009
      *                                                                   CFT009
     C           ZYN       IFLT 72                                        CFT009
     C                     MOVE '20'      SPYDT2                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVE '19'      SPYDT2                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C           DFSDAT    IFEQ 'Y'                                       CFT009
     C           DFPDAT    OREQ 'Y'                                       CFT009
      *                                                                   CFT009
     C                     Z-ADD0         PRBD                            CFT009
     C                     MOVE 'D'       ZFREQ                           CFT009
     C                     MOVE SPCCY     ZCCY                            CFT009
      *                                                                   CFT009
     C           SSLDT     IFLT SPYDT                                     CFT009
     C                     Z-ADDSSLDT     DAYNO1                          CFT009
     C                     Z-ADDSPYDT     DAYNO2                          CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADDSPYDT     DAYNO1  50                      CFT009
     C                     Z-ADDSSLDT     DAYNO2  50                      CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     Z-ADDDAYNO1    ZDAYNO                          CFT009
     C                     MOVE PLOC      ZLOC                            CFT009
      *                                                                   CFT009
     C           ZDAYNO    DOWLTDAYNO2                                    CFT009
     C                     EXSR ZFREQB                                    CFT009
     C                     ADD  1         PRBD                            CFT009
     C                     ENDDO                                          CFT009
      *                                                                   CFT009
     C           SSLDT     IFGT SPYDT                                     CFT009
     C                     MULT -1        PRBD                            CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     Z-ADDPRBD      SPRBD                           CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Must be a valid date offset code, if not blank                   CFT009
      *                                                                   CFT009
     C           SOFCD     IFNE *BLANKS                                   CFT009
     C           SOFCD     SETLLFTPDOCL0                 70               CFT009
      *                                                                   CFT009
     C           *IN70     IFEQ *OFF                                      CFT009
     C                     MOVE *ON       *IN84                           CFT009
     C                     MOVE *ON       *IN89                           CFT009
     C                     MOVEL'FTF3223' FTMSID                          CFT009
     C                     Z-ADD1         PHW                             CFT009
     C                     EXSR FTSNMS                                    CFT009
     C                     ELSE                                           CFT009
     C                     MOVE *OFF      *IN84                           CFT009
     C                     ENDIF                                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVE *OFF      *IN84                           CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** If screen date offset code is a valid one, check to see if       CFT009
      ** it is the same as the defaulted offset code. If not, issue a     CFT009
      ** warning message else, if screen offset code is blank move        CFT009
      ** the default code into screen field.                              CFT009
      *                                                                   CFT009
     C           *IN84     IFEQ *OFF                                      CFT009
      *                                                                   CFT009
     C           SOFCD     IFNE *BLANKS                                   CFT009
      *                                                                   CFT009
     C           SOFCD     IFNE DFTPDO                                    CFT009
     C                     MOVE *ON       *IN84                           CFT009
     C                     MOVEL'Y'       FTWARN                          CFT009
     C                     MOVEL'FTF3222' FTMSID                          CFT009
     C                     EXSR FTSNMS                                    CFT009
     C                     MOVE SOFCD     OTPDOF                          CFT009
     C                     MOVE SOFCD     SVDCDE  5                       CFT009
     C                     ELSE                                           CFT009
     C                     MOVE SOFCD     OTPDOF                          CFT009
     C                     MOVE *OFF      *IN84                           CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
      *                                                                   CFT009
     C                     MOVE OTPDOF    SOFCD                           CFT009
     C                     MOVE *OFF      *IN84                           CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      * Receivers Charges Remitted                                        CFT009
      *                                                                   CFT009
     C           *LIKE     DEFN OPRCRM    DFTRCM                          CFT009
     C                     Z-ADDOPRCRM    DFTRCM                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      *  Unwind subroutine stack name                                     CFT009
      *                                                                   CFT009
     C                     MOVEA*BLANKS   @STK,Q                          CFT009
     C                     SUB  1         Q       50                      CFT009
      *                                                                   CFT009
     CSR                   ENDSR                                          CFT009
     C/EJECT                                                              CFT009
      *****************************************************************   CFT009
      *                                                               *   CFT009
      *  CHGVAT   : Default VAT flags, total VAT, VAT rate, file DAF  *   CFT009
      *             format for charges, entry charges                 *   CFT009
      *                                                               *   CFT009
      *  CALLED BY: UPDATE                                            *   CFT009
      *                                                               *   CFT009
      *  CALLS    : *NONE                                             *   CFT009
      *                                                               *   CFT009
      *****************************************************************   CFT009
     CSR         CHGVAT    BEGSR                                          CFT009
      *                                                                   CFT009
      *  Set up subroutine stack name                                     CFT009
      *                                                                   CFT009
     C                     ADD  1         Q                               CFT009
     C                     MOVEL'CHGVAT'  @STK,Q                          CFT009
      *                                                                   CFT009
      ** Default VAT flags                                                CFT009
      *                                                                   CFT009
     C           CFT010    IFEQ 'Y'                                       CFT009
      *                                                                   CFT009
      ** VAT rate                                                         CFT009
      *                                                                   CFT009
     C                     Z-ADDWVATR     OTVATR                          CFT009
      *                                                                   CFT009
      ** Telex VAT flag                                                   CFT009
      *                                                                   CFT009
     C           OTLXCD    IFNE *BLANKS                                   CFT009
     C           OTLXCD    CHAINFTPCHGL0             88                   CFT009
      *                                                                   CFT009
     C           VATLIN    IFEQ 'Y'                                       CFT009
     C                     MOVE 'Y'       OTVAT2                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       OTVAT2                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       OTVAT2                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Cheque VAT flag                                                  CFT009
      *                                                                   CFT009
     C           OCHQCH    IFNE *BLANKS                                   CFT009
     C           OCHQCH    CHAINFTPCHGL0             88                   CFT009
      *                                                                   CFT009
     C           VATLIN    IFEQ 'Y'                                       CFT009
     C                     MOVE 'Y'       OTVAT3                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       OTVAT3                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       OTVAT3                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Costs Abroad VAT flag                                            CFT009
      *                                                                   CFT009
     C           OCACHC    IFNE *BLANKS                                   CFT009
     C           OCACHC    CHAINFTPCHGL0             88                   CFT009
      *                                                                   CFT009
     C           VATLIN    IFEQ 'Y'                                       CFT009
     C                     MOVE 'Y'       OTVAT4                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       OTVAT4                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       OTVAT4                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** SWIFT standard Abroad VAT flag                                   CFT009
      *                                                                   CFT009
     C           OSSTCC    IFNE *BLANKS                                   CFT009
     C           OSSTCC    CHAINFTPCHGL0             88                   CFT009
      *                                                                   CFT009
     C           VATLIN    IFEQ 'Y'                                       CFT009
     C                     MOVE 'Y'       OVTSWS                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       OVTSWS                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       OVTSWS                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** SWIFT priority VAT flag                                          CFT009
      *                                                                   CFT009
     C           OSPRCC    IFNE *BLANKS                                   CFT009
     C           OSPRCC    CHAINFTPCHGL0             88                   CFT009
      *                                                                   CFT009
     C           VATLIN    IFEQ 'Y'                                       CFT009
     C                     MOVE 'Y'       OTVAT5                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       OTVAT5                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       OTVAT5                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Miscellaneous VAT flag                                           CFT009
      *                                                                   CFT009
     C           OMSCHC    IFNE *BLANKS                                   CFT009
     C           OMSCHC    CHAINFTPCHGL0             88                   CFT009
      *                                                                   CFT009
     C           VATLIN    IFEQ 'Y'                                       CFT009
     C                     MOVE 'Y'       OTVAT6                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       OTVAT6                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       OTVAT6                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Miscellaneous 1 VAT flag                                         CFT009
      *                                                                   CFT009
     C           OMSCH1    IFNE *BLANKS                                   CFT009
     C           OMSCH1    CHAINFTPCHGL0             88                   CFT009
      *                                                                   CFT009
     C           VATLIN    IFEQ 'Y'                                       CFT009
     C                     MOVE 'Y'       OVMIC1                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       OVMIC1                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       OVMIC1                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Miscellaneous 2 VAT flag                                         CFT009
      *                                                                   CFT009
     C           OMSCH2    IFNE *BLANKS                                   CFT009
     C           OMSCH2    CHAINFTPCHGL0             88                   CFT009
      *                                                                   CFT009
     C           VATLIN    IFEQ 'Y'                                       CFT009
     C                     MOVE 'Y'       OVMIC2                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       OVMIC2                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       OVMIC2                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Miscellaneous 3 VAT flag                                         CFT009
      *                                                                   CFT009
     C           OMSCH3    IFNE *BLANKS                                   CFT009
     C           OMSCH3    CHAINFTPCHGL0             88                   CFT009
      *                                                                   CFT009
     C           VATLIN    IFEQ 'Y'                                       CFT009
     C                     MOVE 'Y'       OVMIC3                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       OVMIC3                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       OVMIC3                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Miscellaneous 4 VAT flag                                         CFT009
      *                                                                   CFT009
     C           OMSCH4    IFNE *BLANKS                                   CFT009
     C           OMSCH4    CHAINFTPCHGL0             88                   CFT009
      *                                                                   CFT009
     C           VATLIN    IFEQ 'Y'                                       CFT009
     C                     MOVE 'Y'       OVMIC4                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       OVMIC4                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       OVMIC4                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Miscellaneous 5 VAT flag                                         CFT009
      *                                                                   CFT009
     C           OMSCH5    IFNE *BLANKS                                   CFT009
     C           OMSCH5    CHAINFTPCHGL0             88                   CFT009
      *                                                                   CFT009
     C           VATLIN    IFEQ 'Y'                                       CFT009
     C                     MOVE 'Y'       OVMIC5                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       OVMIC5                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       OVMIC5                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Transfer Commission VAT flag                                     CFT009
      *                                                                   CFT009
     C           OTFCCD    IFNE *BLANKS                                   CFT009
     C           OTFCCD    CHAINFTPCHGL0             88                   CFT009
      *                                                                   CFT009
     C           VATLIN    IFEQ 'Y'                                       CFT009
     C                     MOVE 'Y'       OTVAT1                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       OTVAT1                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       OTVAT1                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** FX/change VAT flag                                               CFT009
      *                                                                   CFT009
     C           OFXCAC    IFNE *BLANKS                                   CFT009
     C           OFXCAC    CHAINFTPCHGL0             88                   CFT009
      *                                                                   CFT009
     C           VATLIN    IFEQ 'Y'                                       CFT009
     C                     MOVE 'Y'       OTVAT7                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       OTVAT7                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       OTVAT7                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
      *                                                                   CFT009
      ** Set all VAT flags to 'N'                                         CFT009
      *                                                                   CFT009
     C                     MOVE 'N'       OTVAT2                          CFT009
     C                     MOVE 'N'       OTVAT3                          CFT009
     C                     MOVE 'N'       OTVAT4                          CFT009
     C                     MOVE 'N'       OVTSWS                          CFT009
     C                     MOVE 'N'       OTVAT5                          CFT009
     C                     MOVE 'N'       OTVAT6                          CFT009
     C                     MOVE 'N'       OVMIC1                          CFT009
     C                     MOVE 'N'       OVMIC2                          CFT009
     C                     MOVE 'N'       OVMIC3                          CFT009
     C                     MOVE 'N'       OVMIC4                          CFT009
     C                     MOVE 'N'       OVMIC5                          CFT009
     C                     MOVE 'N'       OTVAT1                          CFT009
     C                     MOVE 'N'       OTVAT7                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** VAT totals                                                       CFT009
      *                                                                   CFT009
     C           OTVAT1    IFEQ 'Y'                                       CFT009
     C                     Z-ADDOTTRCM    SUMVAT 150                      CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT    150                      CFT009
     C                     Z-ADD0         SUMVAT                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C           OTVAT7    IFEQ 'Y'                                       CFT009
     C                     Z-ADDOTCHCM    VAT                             CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
      *                                                                   CFT009
     C           OTVAT3    IFEQ 'Y'                                       CFT009
     C                     Z-ADDOTCQCH    VAT                             CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
      *                                                                   CFT009
     C           OTVAT4    IFEQ 'Y'                                       CFT009
     C                     Z-ADDOTCSTA    VAT                             CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
      *                                                                   CFT009
     C           OTVAT2    IFEQ 'Y'                                       CFT009
     C                     Z-ADDOTTXCH    VAT                             CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
      *                                                                   CFT009
     C           OTVAT5    IFEQ 'Y'                                       CFT009
     C                     Z-ADDOTSPCH    VAT                             CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
      *                                                                   CFT009
     C           OVTSWS    IFEQ 'Y'                                       CFT009
     C                     Z-ADDSWSCCC    VAT                             CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
      *                                                                   CFT009
     C           OTVAT6    IFEQ 'Y'                                       CFT009
     C                     Z-ADDOTMSCH    VAT                             CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
      *                                                                   CFT009
     C           OVMIC1    IFEQ 'Y'                                       CFT009
     C                     Z-ADDCMISC1    VAT                             CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
      *                                                                   CFT009
     C           OVMIC2    IFEQ 'Y'                                       CFT009
     C                     Z-ADDCMISC2    VAT                             CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
      *                                                                   CFT009
     C           OVMIC3    IFEQ 'Y'                                       CFT009
     C                     Z-ADDCMISC3    VAT                             CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
      *                                                                   CFT009
     C           OVMIC4    IFEQ 'Y'                                       CFT009
     C                     Z-ADDCMISC4    VAT                             CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
      *                                                                   CFT009
     C           OVMIC5    IFEQ 'Y'                                       CFT009
     C                     Z-ADDCMISC5    VAT                             CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
      *                                                                   CFT009
      ** Calculate total VAT at end to avoid rounding errors.             CFT009
      *                                                                   CFT009
     C           OTVATR    MULT SUMVAT    VAT       H                     CFT009
     C                     Z-ADDVAT       SUMVAT                          CFT009
      *                                                                   CFT009
     C                     Z-ADDSUMVAT    OTVATT                          CFT009
      *                                                                   CFT009
      ** File DAF Format                                                  CFT009
      *                                                                   CFT009
     C           SADDC     IFEQ 'A'                                       CFT009
     C                     MOVE SSMCY     SCCCY                           CFT009
     C                     ELSE                                           CFT009
     C                     MOVE SPCCY     SCCCY                           CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C           SCCCY     IFNE BJCYCD                                    CFT009
     C                     CALL 'AOCURRR0'                                CFT009
     C                     PARM '*DBERR ' RTCD                            CFT009
     C                     PARM '*KEY   ' @OPTN                           CFT009
     C                     PARM SCCCY     @K101                           CFT009
     C           SDCURR    PARM SDCURR    DSSDY                           CFT009
      *                                                                   CFT009
     C                     Z-ADDA6NBDP    FCDP                            CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADDBCDP      FCDP                            CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C           FCDP      ADD  1         W       10                      CFT009
      *                                                                   CFT009
      * Transfer Commission                                               CFT009
     C           OTTRCM    DIV  FCTR,W    OTRCMD                          CFT009
      * Telex Charge                                                      CFT009
     C           OTTXCH    DIV  FCTR,W    OTXCHD                          CFT009
      * Cheque Charge                                                     CFT009
     C           OTCQCH    DIV  FCTR,W    OCQCHD                          CFT009
      * Costs Abroad                                                      CFT009
     C           OTCSTA    DIV  FCTR,W    OCSTAD                          CFT009
      * SWIFT Priority charge                                             CFT009
     C           OTSPCH    DIV  FCTR,W    OSPCHD                          CFT009
      * Miscellaneous Charge                                              CFT009
     C           OTMSCH    DIV  FCTR,W    OMSCHD                          CFT009
      *                                                                   CFT009
      *  Entry charges                                                    CFT009
      *                                                                   CFT009
     C                     SELEC                                          CFT009
     C***********CDRO      WHNE *ZEROS                                    CFT009              CSD027
     C           CDRO      WHNE *BLANKS                                   CFT009              CSD027
     C                     MOVELBCCY      SAVCCY  3                       CFT009
     C           SADDC     WHEQ 'A'                                       CFT009
     C                     MOVELSSMCY     SAVCCY                          CFT009
     C                     OTHER                                          CFT009
     C                     MOVELSPCCY     SAVCCY                          CFT009
     C                     ENDSL                                          CFT009
      *                                                                   CFT009
      * Save LEVIED currency                                              CFT009
     C                     MOVELSAVCCY    LEVIED  3                       CFT009
      *                                                                   CFT009
      * Transfer Commission                                               CFT009
     C                     CLEARP#0010                                    CFT009
     C                     Z-ADDOTTRCM    P#FRAM                          CFT009
     C                     MOVE OTCHGC    P#FRCY                          CFT009
     C                     MOVE SAVCCY    P#TOCY                          CFT009
      *                                                                   CFT009
      ** Calculate Instructed amount via FT0010                           CFT009
      *                                                                   CFT009
     C                     CALL 'FT0010'                                  CFT009
     C                     PARM           P#0010                          CFT009
      *                                                                   CFT009
      ** Error calling FT0010                                             CFT009
      *                                                                   CFT009
     C           P#RTCD    IFEQ '*ERROR*'                                 CFT009
     C                     MOVEL'FT0010  'DBFILE                          CFT009
     C                     Z-ADD1         DBASE                           CFT009
     C                     MOVEL'*CALL '  DBKEY                           CFT009
     C                     EXSR SRERR                                     CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     MOVE P#TOAM    ODUMA1                          CFT009
      *                                                                   CFT009
      * Telex Charge                                                      CFT009
     C                     CLEARP#0010                                    CFT009
     C                     Z-ADDOTTXCH    P#FRAM                          CFT009
     C                     MOVE OTCHGC    P#FRCY                          CFT009
     C                     MOVE SAVCCY    P#TOCY                          CFT009
      *                                                                   CFT009
      ** Calculate Instructed amount via FT0010                           CFT009
      *                                                                   CFT009
     C                     CALL 'FT0010'                                  CFT009
     C                     PARM           P#0010                          CFT009
      *                                                                   CFT009
      ** Error calling FT0010                                             CFT009
      *                                                                   CFT009
     C           P#RTCD    IFEQ '*ERROR*'                                 CFT009
     C                     MOVEL'FT0010  'DBFILE                          CFT009
     C                     Z-ADD2         DBASE                           CFT009
     C                     MOVEL'*CALL '  DBKEY                           CFT009
     C                     EXSR SRERR                                     CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     MOVE P#TOAM    ODUMA2                          CFT009
      *                                                                   CFT009
      * Cheque Charge                                                     CFT009
     C                     CLEARP#0010                                    CFT009
     C                     Z-ADDOTCQCH    P#FRAM                          CFT009
     C                     MOVE OTCHGC    P#FRCY                          CFT009
     C                     MOVE SAVCCY    P#TOCY                          CFT009
      *                                                                   CFT009
      ** Calculate Instructed amount via FT0010                           CFT009
      *                                                                   CFT009
     C                     CALL 'FT0010'                                  CFT009
     C                     PARM           P#0010                          CFT009
      *                                                                   CFT009
      ** Error calling FT0010                                             CFT009
      *                                                                   CFT009
     C           P#RTCD    IFEQ '*ERROR*'                                 CFT009
     C                     MOVEL'FT0010  'DBFILE                          CFT009
     C                     Z-ADD3         DBASE                           CFT009
     C                     MOVEL'*CALL '  DBKEY                           CFT009
     C                     EXSR SRERR                                     CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     MOVE P#TOAM    ODUMA3                          CFT009
      *                                                                   CFT009
      * Costs Abroad                                                      CFT009
     C                     CLEARP#0010                                    CFT009
     C                     Z-ADDOTCSTA    P#FRAM                          CFT009
     C                     MOVE OTCHGC    P#FRCY                          CFT009
     C                     MOVE SAVCCY    P#TOCY                          CFT009
      *                                                                   CFT009
      ** Calculate Instructed amount via FT0010                           CFT009
      *                                                                   CFT009
     C                     CALL 'FT0010'                                  CFT009
     C                     PARM           P#0010                          CFT009
      *                                                                   CFT009
      ** Error calling FT0010                                             CFT009
      *                                                                   CFT009
     C           P#RTCD    IFEQ '*ERROR*'                                 CFT009
     C                     MOVEL'FT0010  'DBFILE                          CFT009
     C                     Z-ADD10        DBASE                           CFT009
     C                     MOVEL'*CALL '  DBKEY                           CFT009
     C                     EXSR SRERR                                     CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     MOVE P#TOAM    ODUMA4                          CFT009
      *                                                                   CFT009
      * SWIFT Priority charge                                             CFT009
     C                     CLEARP#0010                                    CFT009
     C                     Z-ADDOTSPCH    P#FRAM                          CFT009
     C                     MOVE OTCHGC    P#FRCY                          CFT009
     C                     MOVE SAVCCY    P#TOCY                          CFT009
      *                                                                   CFT009
      ** Calculate Instructed amount via FT0010                           CFT009
      *                                                                   CFT009
     C                     CALL 'FT0010'                                  CFT009
     C                     PARM           P#0010                          CFT009
      *                                                                   CFT009
      ** Error calling FT0010                                             CFT009
      *                                                                   CFT009
     C           P#RTCD    IFEQ '*ERROR*'                                 CFT009
     C                     MOVEL'FT0010  'DBFILE                          CFT009
     C                     Z-ADD11        DBASE                           CFT009
     C                     MOVEL'*CALL '  DBKEY                           CFT009
     C                     EXSR SRERR                                     CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     MOVE P#TOAM    ODUMA5                          CFT009
      *                                                                   CFT009
      * Miscellaneous Charge                                              CFT009
     C                     CLEARP#0010                                    CFT009
     C                     Z-ADDOTMSCH    P#FRAM                          CFT009
     C                     MOVE OTCHGC    P#FRCY                          CFT009
     C                     MOVE SAVCCY    P#TOCY                          CFT009
      *                                                                   CFT009
      ** Calculate Instructed amount via FT0010                           CFT009
      *                                                                   CFT009
     C                     CALL 'FT0010'                                  CFT009
     C                     PARM           P#0010                          CFT009
      *                                                                   CFT009
      ** Error calling FT0010                                             CFT009
      *                                                                   CFT009
     C           P#RTCD    IFEQ '*ERROR*'                                 CFT009
     C                     MOVEL'FT0010  'DBFILE                          CFT009
     C                     Z-ADD8         DBASE                           CFT009
     C                     MOVEL'*CALL '  DBKEY                           CFT009
     C                     EXSR SRERR                                     CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     MOVE P#TOAM    ODUMA6                          CFT009
      *                                                                   CFT009
      ** FX/Change                                                        CFT009
     C                     CLEARP#0010                                    CFT009
     C                     Z-ADDOTCHCM    P#FRAM                          CFT009
     C                     MOVE OTCHGC    P#FRCY                          CFT009
     C                     MOVE SAVCCY    P#TOCY                          CFT009
      *                                                                   CFT009
      ** Calculate Instructed amount via FT0010                           CFT009
      *                                                                   CFT009
     C                     CALL 'FT0010'                                  CFT009
     C                     PARM           P#0010                          CFT009
      *                                                                   CFT009
      ** Error calling FT0010                                             CFT009
      *                                                                   CFT009
     C           P#RTCD    IFEQ '*ERROR*'                                 CFT009
     C                     MOVEL'FT0010  'DBFILE                          CFT009
     C                     Z-ADD13        DBASE                           CFT009
     C                     MOVEL'*CALL '  DBKEY                           CFT009
     C                     EXSR SRERR                                     CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     MOVE P#TOAM    OTDUM7                          CFT009
      *                                                                   CFT009
      ** VAT                                                              CFT009
     C                     CLEARP#0010                                    CFT009
     C                     MOVE SAVCCY    P#FRCY                          CFT009
     C                     Z-ADDOTVATT    P#FRAM                          CFT009
     C                     MOVE OTCHGC    P#TOCY                          CFT009
      *                                                                   CFT009
      ** Calculate Instructed amount via FT0010                           CFT009
      *                                                                   CFT009
     C                     CALL 'FT0010'                                  CFT009
     C                     PARM           P#0010                          CFT009
      *                                                                   CFT009
      ** Error calling FT0010                                             CFT009
      *                                                                   CFT009
     C           P#RTCD    IFEQ '*ERROR*'                                 CFT009
     C                     MOVEL'FT0010  'DBFILE                          CFT009
     C                     Z-ADD14        DBASE                           CFT009
     C                     MOVEL'*CALL '  DBKEY                           CFT009
     C                     EXSR SRERR                                     CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     MOVE P#TOAM    OTDUM8                          CFT009
      *                                                                   CFT009
      *  Unwind subroutine stack name                                     CFT009
      *                                                                   CFT009
     C                     MOVEA*BLANKS   @STK,Q                          CFT009
     C                     SUB  1         Q       50                      CFT009
      *                                                                   CFT009
     CSR                   ENDSR                                          CFT009
     C/EJECT                                                              CFT009
      *****************************************************************   CFT009
      *                                                               *   CFT009
      *  MOVCHG   : Move new charges before writing                   *   CFT009
      *                                                               *   CFT009
      *  CALLED BY: UPDATE                                            *   CFT009
      *                                                               *   CFT009
      *  CALLS    : *NONE                                             *   CFT009
      *                                                               *   CFT009
      *****************************************************************   CFT009
     CSR         MOVCHG    BEGSR                                          CFT009
      *                                                                   CFT009
      *  Set up subroutine stack name                                     CFT009
      *                                                                   CFT009
     C                     ADD  1         Q                               CFT009
     C                     MOVEL'MOVCHG'  @STK,Q                          CFT009
      *                                                                   CFT009
     C                     MOVELOTVAT1    OPVAT1                          CFT009
     C                     MOVELOTVAT2    OPVAT2                          CFT009
     C                     MOVELOTVAT3    OPVAT3                          CFT009
     C                     MOVELOTVAT4    OPVAT4                          CFT009
     C                     MOVELOTVAT5    OPVAT5                          CFT009
     C                     MOVELOTVAT6    OPVAT6                          CFT009
     C                     MOVELOTVAT7    OPVAT7                          CFT009
     C                     MOVELOTVATR    OPVATR                          CFT009
     C                     MOVELOTVATT    OPVATT                          CFT009
     C                     Z-ADDOTTRCM    DUMA1                           CFT009
     C                     Z-ADDOTTXCH    DUMA2                           CFT009
     C                     Z-ADDOTCQCH    DUMA3                           CFT009
     C                     Z-ADDOTCSTA    DUMA4                           CFT009
     C                     Z-ADDOTSPCH    DUMA5                           CFT009
     C                     Z-ADDOTMSCH    DUMA6                           CFT009
     C                     Z-ADDOTCHCM    OPDUM7                          CFT009
     C                     MOVELOTLXCD    TLXCDE                          CFT009
     C                     MOVELOCHQCH    CHQCHC                          CFT009
     C                     MOVELOCACHC    CACHCD                          CFT009
     C                     MOVELOSSTCC    SSTCCD                          CFT009
     C                     MOVELOSPRCC    SPRCCD                          CFT009
     C                     MOVELOMSCHC    MSCHC                           CFT009
     C                     MOVELOMSCH1    MSCHC1                          CFT009
     C                     MOVELOMSCH2    MSCHC2                          CFT009
     C                     MOVELOMSCH3    MSCHC3                          CFT009
     C                     MOVELOMSCH4    MSCHC4                          CFT009
     C                     MOVELOMSCH5    MSCHC5                          CFT009
     C                     MOVELOTFCCD    TFCCCD                          CFT009
     C                     MOVELOFXCAC    FXCACC                          CFT009
     C                     MOVELOVTSWS    VTSWSC                          CFT009
     C                     MOVELOVMIC1    VMIC1                           CFT009
     C                     MOVELOVMIC2    VMIC2                           CFT009
     C                     MOVELOVMIC3    VMIC3                           CFT009
     C                     MOVELOVMIC4    VMIC4                           CFT009
     C                     MOVELOVMIC5    VMIC5                           CFT009
     C                     Z-ADDCMISC1    MISCC1                          CFT009
     C                     Z-ADDCMISC2    MISCC2                          CFT009
     C                     Z-ADDCMISC3    MISCC3                          CFT009
     C                     Z-ADDCMISC4    MISCC4                          CFT009
     C                     Z-ADDCMISC5    MISCC5                          CFT009
     C                     Z-ADDCSWSCH    SWSCCC                          CFT009
      *                                                                   CFT009
     C                     SELEC                                          CFT009
     C***********CDRO      WHNE *ZEROS                                    CFT009              CSD027
     C           CDRO      WHNE *BLANKS                                   CFT009              CSD027
     C                     MOVELBCCY      CURCY                           CFT009
     C           ADDC      WHEQ 'A'                                       CFT009
     C                     MOVELSMCY      CURCY                           CFT009
     C                     OTHER                                          CFT009
     C                     MOVELPCCY      CURCY                           CFT009
     C                     ENDSL                                          CFT009
      *                                                                   CFT009
     C                     Z-ADDDUMA1     INPCHG                          CFT009
     C                     EXSR FT0985                                    CFT009
     C                     Z-ADDLEVCHG    TRCM                            CFT009
      *                                                                   CFT009
     C                     Z-ADDDUMA2     INPCHG                          CFT009
     C                     EXSR FT0985                                    CFT009
     C                     Z-ADDLEVCHG    TXCH                            CFT009
      *                                                                   CFT009
     C                     Z-ADDDUMA3     INPCHG                          CFT009
     C                     EXSR FT0985                                    CFT009
     C                     Z-ADDLEVCHG    CQCH                            CFT009
      *                                                                   CFT009
     C                     Z-ADDDUMA4     INPCHG                          CFT009
     C                     EXSR FT0985                                    CFT009
     C                     Z-ADDLEVCHG    CSTA                            CFT009
      *                                                                   CFT009
     C                     Z-ADDDUMA5     INPCHG                          CFT009
     C                     EXSR FT0985                                    CFT009
     C                     Z-ADDLEVCHG    SPCH                            CFT009
      *                                                                   CFT009
     C                     Z-ADDDUMA6     INPCHG                          CFT009
     C                     EXSR FT0985                                    CFT009
     C                     Z-ADDLEVCHG    MSCH                            CFT009
      *                                                                   CFT009
     C                     Z-ADDOPDUM7    INPCHG                          CFT009
     C                     EXSR FT0985                                    CFT009
     C                     Z-ADDLEVCHG    OPCHCM                          CFT009
      *                                                                   CFT009
     C                     Z-ADDMISCC1    INPCHG                          CFT009
     C                     EXSR FT0985                                    CFT009
     C                     Z-ADDLEVCHG    MISC01                          CFT009
      *                                                                   CFT009
     C                     Z-ADDMISCC2    INPCHG                          CFT009
     C                     EXSR FT0985                                    CFT009
     C                     Z-ADDLEVCHG    MISC02                          CFT009
      *                                                                   CFT009
     C                     Z-ADDMISCC3    INPCHG                          CFT009
     C                     EXSR FT0985                                    CFT009
     C                     Z-ADDLEVCHG    MISC03                          CFT009
      *                                                                   CFT009
     C                     Z-ADDMISCC4    INPCHG                          CFT009
     C                     EXSR FT0985                                    CFT009
     C                     Z-ADDLEVCHG    MISC04                          CFT009
      *                                                                   CFT009
     C                     Z-ADDMISCC5    INPCHG                          CFT009
     C                     EXSR FT0985                                    CFT009
     C                     Z-ADDLEVCHG    MISC05                          CFT009
      *                                                                   CFT009
     C                     Z-ADDSWSCCC    INPCHG                          CFT009
     C                     EXSR FT0985                                    CFT009
     C                     Z-ADDLEVCHG    SWSCHG                          CFT009
      *                                                                   CFT009
     C                     Z-ADDODATNE    DATNED                          CFT009
     C                     Z-ADDODATNA    DATNAO                          CFT009
     C                     MOVELOCUNFL    CUNFLA                          CFT009
     C                     Z-ADDOTCHRT    OPCHRT                          CFT009
     C                     MOVELOTCHGC    OPCHGC                          CFT009
     C                     Z-ADDDFTRCM    OPRCRM                          CFT009
      *                                                                   CFT009
      * If using exchange rate from transaction, move in the correct      CFT009
      *  rate.                                                            CFT009
     C           CHTRCY    IFEQ 'Y'                                       CFT009
     C           SMCY      IFEQ OPCHGC                                    CFT009
     C           PCCY      ANDEQLEVIED                                    CFT009
     C           SMCY      OREQ LEVIED                                    CFT009
     C           PCCY      ANDEQOPCHGC                                    CFT009
     C           SMCY      OREQ BCCY                                      CFT009
     C           PCCY      ANDEQOPCHGC                                    CFT009
     C           SMCY      OREQ BCCY                                      CFT009
     C           PCCY      ANDEQLEVIED                                    CFT009
     C           SMCY      OREQ OPCHGC                                    CFT009
     C           PCCY      ANDEQBCCY                                      CFT009
     C                     Z-ADDRATE      OPCHRT                          CFT009
     C                     Z-ADDRATE      OTCHRT                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      *  Unwind subroutine stack name                                     CFT009
      *                                                                   CFT009
     C                     MOVEA*BLANKS   @STK,Q                          CFT009
     C                     SUB  1         Q       50                      CFT009
      *                                                                   CFT009
     CSR                   ENDSR                                          CFT009
     C/EJECT                                                              CFT009
      *****************************************************************   CFT009
      *                                                               *   CFT009
      *  MOVODS   : Move fields into outgoing DS                      *   CFT009
      *                                                               *   CFT009
      *  CALLED BY: SRSPST                                            *   CFT009
      *                                                               *   CFT009
      *  CALLS    : *NONE                                             *   CFT009
      *                                                               *   CFT009
      *****************************************************************   CFT009
     CSR         MOVODS    BEGSR                                          CFT009
      *                                                                   CFT009
      *  Set up subroutine stack name                                     CFT009
      *                                                                   CFT009
     C                     ADD  1         Q                               CFT009
     C                     MOVEL'MOVODS'  @STK,Q                          CFT009
      *                                                                   CFT009
     C                     MOVE ADDC      OTADDC                          CFT009
     C                     MOVE PREF      OTPREF                          CFT009
     C                     MOVE PYTP      OTPYTP                          CFT009
     C                     MOVE STMT      OTSTMT                          CFT009
     C                     MOVE BRCA      OTBRCA                          CFT009
     C                     MOVELSPDSET    FXSRSC                          CFT009
     C                     MOVELSOFCD     OTPDOF                          CFT009
     C                     Z-ADDDFTRCM    OPRCRM                          CFT009
      *                                                                   CFT009
      ** Dates                                                            CFT009
      *                                                                   CFT009
     C           DFSDAT    IFEQ 'N'                                       CFT009
     C                     MOVE RUNN      SLDTD1                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C           DFPDAT    IFEQ 'N'                                       CFT009
     C                     MOVE 'D'       ZFREQ                           CFT009
      *                                                                   CFT009
     C           NOWRK     IFEQ 'N'                                       CFT009
     C                     MOVE SPCCY     ZCCY                            CFT009
     C                     ELSE                                           CFT009
     C                     MOVE BJLCCY    ZCCY                            CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     Z-ADDBJRDNB    ZDAYNO                          CFT009
     C                     MOVE PLOC      ZLOC                            CFT009
      *                                                                   CFT009
      * FIND RUN DATE PLUS 1                                              CFT009
      *                                                                   CFT009
     C                     EXSR ZFREQB                                    CFT009
      *                                                                   CFT009
     C           ZZERR@    IFNE *BLANKS                                   CFT009
     C           *LOCK     IN   DLDA                                      CFT009
     C                     MOVE 'FT0040  'DBPGM                           CFT009
     C                     MOVE 'ZFREQB'  DBFILE           ***************CFT009
     C                     Z-ADD7         DBASE            * DB ERROR 07 *CFT009
     C                     MOVELZCCY      DBKEY            ***************CFT009
     C                     OUT  DLDA                                      CFT009
     C                     SETON                     U7U8LR               CFT009
     C                     DUMP                                           CFT009
      *                                                                   CFT009
      *  Allocate dataarea to blanks                                      CFT009
      *                                                                   CFT009
     C                     EXSR DALLOC                                    CFT009
      *                                                                   CFT009
     C                     RETRN                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** IF NOT BASE CURRENCY FIND RUN DATE PLUS 2                        CFT009
      *                                                                   CFT009
     C           SPCCY     CASNEBJCYCD    ZFREQB                          CFT009
     C                     ENDCS                                          CFT009
      *                                                                   CFT009
     C                     EXSR ZDATE2                                    CFT009
     C                     MOVE ZDATE     PVDTD1                          CFT009
     C                     ENDIF                                          CFT009
     C*                                                                   CFT009
     C** Input currency and charge currency                               CFT009
     C*                                                                   CFT009
     C                     SELEC                                          CFT009
CH1  C***********CDRO      WHNE *ZEROS                                    CFT009              CSD027
CH1  C           CDRO      WHNE *BLANKS                                   CFT009              CSD027
CH1  C                     MOVE BJCYCD    W7ICCY                          CFT009
     C           BTCHCY    WHEQ 'C'                                       CFT009
     C           SADDC     IFEQ 'A'                                       CFT009
     C                     MOVE SSMCY     W7ICCY                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVE SPCCY     W7ICCY                          CFT009
     C                     END                                            CFT009
     C           BTCHCY    WHEQ 'L'                                       CFT009
     C                     MOVE BJLCCY    W7ICCY                          CFT009
     C           BTCHCY    WHEQ 'F'                                       CFT009
     C                     MOVE FCHCCY    W7ICCY                          CFT009
     C           BTCHCY    WHEQ 'B'                                       CFT009
     C                     MOVE BJCYCD    W7ICCY                          CFT009
     C                     OTHER                                          CFT009
     C                     Z-ADD70        DBASE                           CFT009
     C                     MOVELW7ICCY    DBKEY                           CFT009
     C                     EXSR SRERR                                     CFT009
     C                     ENDSL                                          CFT009
      *                                                                   CFT009
      * Move charges currency to OTPAYXPD                                 CFT009
      *                                                                   CFT009
     C                     MOVELW7ICCY    OTCHGC                          CFT009
     C                     MOVELW7ICCY    OPCHGC                          CFT009
      *                                                                   CFT009
     C           ACTION    IFEQ 'A'                                       CFT009
     C           PREF      CHAINOTPAYXL0             99                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      * RESET DEFAULTS AMOUNTS                                            CFT009
     C                     Z-ADD*ZEROS    OTTRCM                          CFT009
     C                     Z-ADD*ZEROS    TRCM                            CFT009
      *                                                                   CFT009
     C                     Z-ADD*ZEROS    OTRCMD                          CFT009
     C                     Z-ADD*ZEROS    TRCMD                           CFT009
      *                                                                   CFT009
     C                     Z-ADD*ZEROS    OTTXCH                          CFT009
     C                     Z-ADD*ZEROS    TXCH                            CFT009
      *                                                                   CFT009
     C                     Z-ADD*ZEROS    OTXCHD                          CFT009
     C                     Z-ADD*ZEROS    TXCHD                           CFT009
      *                                                                   CFT009
     C                     Z-ADD*ZEROS    OTCQCH                          CFT009
     C                     Z-ADD*ZEROS    CQCH                            CFT009
      *                                                                   CFT009
     C                     Z-ADD*ZEROS    OCQCHD                          CFT009
     C                     Z-ADD*ZEROS    CQCHD                           CFT009
      *                                                                   CFT009
     C                     Z-ADD*ZEROS    OTCSTA                          CFT009
     C                     Z-ADD*ZEROS    CSTA                            CFT009
      *                                                                   CFT009
     C                     Z-ADD*ZEROS    OCSTAD                          CFT009
     C                     Z-ADD*ZEROS    CSTAD                           CFT009
      *                                                                   CFT009
     C                     Z-ADD*ZEROS    OTSPCH                          CFT009
     C                     Z-ADD*ZEROS    SPCH                            CFT009
      *                                                                   CFT009
     C                     Z-ADD*ZEROS    OSPCHD                          CFT009
     C                     Z-ADD*ZEROS    SPCHD                           CFT009
      *                                                                   CFT009
     C                     Z-ADD*ZEROS    OTMSCH                          CFT009
     C                     Z-ADD*ZEROS    MSCH                            CFT009
      *                                                                   CFT009
     C                     Z-ADD*ZEROS    OMSCHD                          CFT009
     C                     Z-ADD*ZEROS    MSCHD                           CFT009
      *                                                                   CFT009
     C                     Z-ADD*ZEROS    OTCHCM                          CFT009
     C                     Z-ADD*ZEROS    OPCHCM                          CFT009
      *                                                                   CFT009
     C                     Z-ADD*ZEROS    ODUMA1                          CFT009
     C                     Z-ADD*ZEROS    DUMA1                           CFT009
      *                                                                   CFT009
     C                     Z-ADD*ZEROS    ODUMA2                          CFT009
     C                     Z-ADD*ZEROS    DUMA2                           CFT009
      *                                                                   CFT009
     C                     Z-ADD*ZEROS    ODUMA3                          CFT009
     C                     Z-ADD*ZEROS    DUMA3                           CFT009
      *                                                                   CFT009
     C                     Z-ADD*ZEROS    ODUMA4                          CFT009
     C                     Z-ADD*ZEROS    DUMA4                           CFT009
      *                                                                   CFT009
     C                     Z-ADD*ZEROS    ODUMA5                          CFT009
     C                     Z-ADD*ZEROS    DUMA5                           CFT009
      *                                                                   CFT009
     C                     Z-ADD*ZEROS    ODUMA6                          CFT009
     C                     Z-ADD*ZEROS    DUMA6                           CFT009
      *                                                                   CFT009
     C                     Z-ADD*ZEROS    OPDUM7                          CFT009
     C                     Z-ADD*ZEROS    OTDUM7                          CFT009
      *                                                                   CFT009
     C                     Z-ADD*ZEROS    OTDUM8                          CFT009
     C                     Z-ADD*ZEROS    OPDUM8                          CFT009
      *                                                                   CFT009
      * NEW CHARGES                                                       CFT009
     C                     Z-ADD*ZEROS    OMISC1                          CFT009
     C                     Z-ADD*ZEROS    MISC01                          CFT009
      *                                                                   CFT009
     C                     Z-ADD*ZEROS    OMISC2                          CFT009
     C                     Z-ADD*ZEROS    MISC02                          CFT009
      *                                                                   CFT009
     C                     Z-ADD*ZEROS    OMISC3                          CFT009
     C                     Z-ADD*ZEROS    MISC03                          CFT009
      *                                                                   CFT009
     C                     Z-ADD*ZEROS    OMISC4                          CFT009
     C                     Z-ADD*ZEROS    MISC04                          CFT009
      *                                                                   CFT009
     C                     Z-ADD*ZEROS    OMISC5                          CFT009
     C                     Z-ADD*ZEROS    MISC05                          CFT009
      *                                                                   CFT009
     C                     Z-ADD*ZEROS    SWSCHG                          CFT009
     C                     Z-ADD*ZEROS    OSWSCH                          CFT009
      *                                                                   CFT009
     C                     Z-ADD*ZEROS    MISCC1                          CFT009
     C                     Z-ADD*ZEROS    CMISC1                          CFT009
      *                                                                   CFT009
     C                     Z-ADD*ZEROS    MISCC2                          CFT009
     C                     Z-ADD*ZEROS    CMISC2                          CFT009
      *                                                                   CFT009
     C                     Z-ADD*ZEROS    MISCC3                          CFT009
     C                     Z-ADD*ZEROS    CMISC3                          CFT009
      *                                                                   CFT009
     C                     Z-ADD*ZEROS    MISCC4                          CFT009
     C                     Z-ADD*ZEROS    CMISC4                          CFT009
      *                                                                   CFT009
     C                     Z-ADD*ZEROS    MISCC5                          CFT009
     C                     Z-ADD*ZEROS    CMISC5                          CFT009
      *                                                                   CFT009
     C                     Z-ADD*ZEROS    CSWSCH                          CFT009
     C                     Z-ADD*ZEROS    SWSCCC                          CFT009
      *                                                                   CFT009
      * RESET DEFAULT CODES                                               CFT009
     C                     MOVEL*BLANKS   OTLXCD                          CFT009
     C                     MOVEL*BLANKS   TLXCDE                          CFT009
      *                                                                   CFT009
     C                     MOVEL*BLANKS   OCHQCH                          CFT009
     C                     MOVEL*BLANKS   CHQCHC                          CFT009
      *                                                                   CFT009
     C                     MOVEL*BLANKS   OCACHC                          CFT009
     C                     MOVEL*BLANKS   CACHCD                          CFT009
      *                                                                   CFT009
     C                     MOVEL*BLANKS   OSSTCC                          CFT009
     C                     MOVEL*BLANKS   SSTCCD                          CFT009
      *                                                                   CFT009
     C                     MOVEL*BLANKS   OSPRCC                          CFT009
     C                     MOVEL*BLANKS   SPRCCD                          CFT009
      *                                                                   CFT009
     C                     MOVEL*BLANKS   OMSCHC                          CFT009
     C                     MOVEL*BLANKS   MSCHC                           CFT009
      *                                                                   CFT009
     C                     MOVEL*BLANKS   OMSCH1                          CFT009
     C                     MOVEL*BLANKS   MSCHC1                          CFT009
      *                                                                   CFT009
     C                     MOVEL*BLANKS   OMSCH2                          CFT009
     C                     MOVEL*BLANKS   MSCHC2                          CFT009
      *                                                                   CFT009
     C                     MOVEL*BLANKS   OMSCH3                          CFT009
     C                     MOVEL*BLANKS   MSCHC3                          CFT009
      *                                                                   CFT009
     C                     MOVEL*BLANKS   OMSCH4                          CFT009
     C                     MOVEL*BLANKS   MSCHC4                          CFT009
      *                                                                   CFT009
     C                     MOVEL*BLANKS   OMSCH5                          CFT009
     C                     MOVEL*BLANKS   MSCHC5                          CFT009
      *                                                                   CFT009
     C                     MOVEL*BLANKS   OTFCCD                          CFT009
     C                     MOVEL*BLANKS   TFCCCD                          CFT009
      *                                                                   CFT009
     C                     MOVEL*BLANKS   OFXCAC                          CFT009
     C                     MOVEL*BLANKS   FXCACC                          CFT009
      *                                                                   CFT009
      * RESET VAT FLAGS                                                   CFT009
     C                     MOVEL*BLANKS   OTVAT1                          CFT009
     C                     MOVEL*BLANKS   OTVAT2                          CFT009
     C                     MOVEL*BLANKS   OTVAT3                          CFT009
     C                     MOVEL*BLANKS   OTVAT4                          CFT009
     C                     MOVEL*BLANKS   OTVAT5                          CFT009
     C                     MOVEL*BLANKS   OTVAT6                          CFT009
     C                     MOVEL*BLANKS   OTVAT7                          CFT009
     C                     MOVEL*BLANKS   OTVATR                          CFT009
     C                     MOVEL*BLANKS   OTVATT                          CFT009
     C                     MOVEL*BLANKS   OVTSWS                          CFT009
     C                     MOVEL*BLANKS   OVMIC1                          CFT009
     C                     MOVEL*BLANKS   OVMIC2                          CFT009
     C                     MOVEL*BLANKS   OVMIC3                          CFT009
     C                     MOVEL*BLANKS   OVMIC4                          CFT009
     C                     MOVEL*BLANKS   OVMIC5                          CFT009
      *                                                                   CFT009
      ** If a change has occurred in the key, reset the spread set        CFT009
      *                                                                   CFT009
     C           ACTION    IFEQ 'A'                                       CFT009
     C           KEYCHG    ANDEQ'Y'                                       CFT009
     C                     MOVELSPDSET    FXSRSC    P                     CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     Z-ADD*ZEROS    ODATNE                          CFT009
     C                     Z-ADD*ZEROS    ODATNA                          CFT009
     C           ACTION    IFEQ 'A'                                       CFT009
      * Only update if a keychange has occurred                           CFT009
     C           KEYCHG    IFEQ 'Y'                                       CFT009
     C                     UPDATOPAYXL0                                   CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     MOVELCUNFLA    OCUNFL                          CFT009
     C                     Z-ADDOPCHRT    OTCHRT                          CFT009
     C                     Z-ADDP#MDIN    MDIN                            CFT009
      *                                                                   CFT009
      * If using exchange rate from transaction, move in the correct      CFT009
      *  rate.                                                            CFT009
     C           CHTRCY    IFEQ 'Y'                                       CFT009
     C                     Z-ADDRATE      OPCHRT                          CFT009
     C                     Z-ADDRATE      OTCHRT                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      *  Unwind subroutine stack name                                     CFT009
      *                                                                   CFT009
     C                     MOVEA*BLANKS   @STK,Q                          CFT009
     C                     SUB  1         Q       50                      CFT009
      *                                                                   CFT009
     CSR                   ENDSR                                          CFT009
     C/EJECT
     C************************************************************
     C* MOVES SR.
     C* MOVE FIELDS BACK BEFORE WRITING
     C*
     C           MOVES     BEGSR
     C*
     C***Clear*level*1*Valid*indicator.                                   E32885
     C***********          MOVE *BLANK    LVL1                            E32885
     C** Set level 1 Valid indicator.                                     E32885
     C                     MOVE 'Y'       LVL1                            E32885
     C*
     C                     MOVE SPREF     PREF
     C                     MOVE SPYTP     PYTP
     C                     MOVE SPYST     PYST
     C                     MOVE SDSTT     DSTT
     C*                                                                   S01117
     C           @MBIN     IFEQ 'N'                                       S01117
     C           SDSTT     ANDEQ'G'                                       S01117
     C                     MOVE *BLANKS   DST1                            S01117
     C**********           MOVELSDST1     DST18  18                                    S01117 CGL029
     C                     MOVELSDST1     DST18  24                                           CGL029
     C                     MOVE BJSBRC    DST18                           S01117
     C                     MOVELDST18     DST1                            S01117
     C                     ELSE                                           S01117
     C/COPY WNCPYSRC,FT0040C278
     C                     MOVE SDST1     DST1
     C                     END                                            S01117
     C/COPY WNCPYSRC,FT0040C279
     C*                                                                   S01117
     C                     MOVE SDST2     DST2
     C                     MOVE SDST3     DST3
     C                     MOVE SDST4     DST4
     C                     MOVE SSNCT     SNCT
     C                     MOVE SSNCO     SNCO
     C                     MOVE SORBT     ORBT
     C/COPY WNCPYSRC,FT0040C201
     C                     MOVE SORBK     ORBK
     C                     MOVE SORBB     ORBB                            S01117
     C/COPY WNCPYSRC,FT0040C202
     C                     MOVE SORCT     ORCT
     C/COPY WNCPYSRC,FT0040C111
     C           @MBIN     IFEQ 'N'                                       S01117
     C           SORCT     ANDEQ'P'                                       S01117
     C                     MOVE *BLANKS   ORC1                            S01117
     C**********           MOVELSORC1     ORC15  15                                    S01117 CGL029
     C                     MOVELSORC1     ORC15  21                                           CGL029
     C                     MOVE BJSBRC    ORC15                           S01117
     C                     MOVELORC15     ORC1                            S01117
     C                     ELSE                                           S01117
     C                     MOVE SORC1     ORC1
     C                     END                                            S01117
      *                                                                   061236
      * If MT202 in Ordering Customer                                     061236
      *                                                                   061236
     C           SORC1     IFEQ ORCFLD                                    061236
      *                                                                   068092
      * If lines 2 to 4 now blank blank out ordering information          068092
      *                                                                   068092
     C           SORC2     IFEQ *BLANKS                                   068092
     C           SORC3     ANDEQ*BLANKS                                   068092
     C           SORC4     ANDEQ*BLANKS                                   068092
     C           OPIN      ANDNE'Y'                                       068092
     C           OPMSGR    ANDEQ0                                         068092
     C                     MOVE *BLANKS   OPORBT                          068092
     C                     MOVE *BLANKS   OPORB1                          068092
     C                     MOVE *BLANKS   OPORB2                          068092
     C                     MOVE *BLANKS   OPORB3                          068092
     C                     MOVE *BLANKS   OPORB4                          068092
     C                     MOVE *BLANKS   OPORB5                          068092
     C                     END                                            068092
      *                                                                   061236
      * Only blank out fields 4 and 5 if information changed              061236
      * and information has altered                                       061236
      *                                                                   061236
     C           SORC2     IFNE *BLANKS                                   061236
     C           SORC3     ORNE *BLANKS                                   061236
     C           SORC4     ORNE *BLANKS                                   061236
      *                                                                   061236
      * Fill from order cust fields                                       061236
      *                                                                   061236
     C           SORC2     IFNE OPORB1                                    061236
     C           SORC3     ORNE OPORB2                                    061236
     C           SORC4     ORNE OPORB3                                    061236
     C                     MOVE *BLANKS   OPORB4                          061236
     C                     MOVE *BLANKS   OPORB5                          061236
     C                     MOVE 'A'       OPORBT                          061236
     C/COPY WNCPYSRC,FT0040C112
     C                     END                                            061236
      *                                                                   061236
     C                     MOVE SORC2     OPORB1                          061236
     C                     MOVE SORC3     OPORB2                          061236
     C                     MOVE SORC4     OPORB3                          061236
     C                     MOVE *BLANKS   ORC2                            061236
     C                     MOVE *BLANKS   ORC3                            061236
     C                     MOVE *BLANKS   ORC4                            061236
     C                     END                                            061236
      *                                                                   061236
     C/COPY WNCPYSRC,FT0040C071
     C                     ELSE                                           061236
      *                                                                   061236
      * Ordering Customer entered                                         061236
      *                                                                   061236
     C                     MOVE SORC2     ORC2
     C                     MOVE SORC3     ORC3
     C                     MOVE SORC4     ORC4
      *                                                                   061236
      * Only blank fields if not generated from Incoming Payment          061236
      *                                                                   061236
     C           OPIN      IFNE 'Y'                                       061236
     C           OPMSGR    ANDEQ0                                         061236
     C                     MOVE *BLANKS   OPORBT                          061236
     C                     MOVE *BLANKS   OPORB1                          061236
     C                     MOVE *BLANKS   OPORB2                          061236
     C                     MOVE *BLANKS   OPORB3                          061236
     C                     MOVE *BLANKS   OPORB4                          061236
     C                     MOVE *BLANKS   OPORB5                          061236
     C                     END                                            061236
     C                     END                                            061236
      *                                                                   061236
     C                     Z-ADDSSMAM     SMAM
      *                                                                   CEU006
      ** Notified delivery fields                                         CEU006
      *                                                                   CEU006
     C                     MOVE SNDCY     NDCY                            CEU006
     C                     Z-ADDSNDAM     NDAM                            CEU006
      *                                                                   CEU006
      ** Pay delivery fields                                              CEU006
      *                                                                   CEU006
     C                     MOVE SPDCY     PDCY                            CEU006
     C                     Z-ADDSPDAM     PDAM                            CEU006
      *                                                                   CEU006
     C*                                                                   S01117
     C** If multi branched                                                S01117
     C*                                                                   S01117
     C           *IN57     IFEQ '1'                                       S01117
     C                     MOVE SBRCA     BRCA                            S01117
     C*                                                                   S01117
     C** If originating branch used                                       S01117
     C*                                                                   S01117
     C           *IN58     IFEQ '1'                                       S01117
     C                     MOVE SORBR     ORBR                            S01117
     C                     ELSE                                           S01117
     C                     MOVE SBRCA     ORBR                            S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C** If non multi branched                                            S01117
     C*                                                                   S01117
     C                     ELSE                                           S01117
     C                     MOVE BJSBRC    BRCA                            S01117
     C                     MOVE BRCA      ORBR                            S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C* CALCULATE BASE CURRENCY EQUIV
     C           PCDP      SUB  BCDP      N       10
     C                     ADD  4         N
     C           PMDIN     IFEQ 0                          B001
     C           PSPOT     MULT POWER,N   WK159     H
     C           SSMAM     DIV  WK159     SBCQ      H
     C                     ELSE                            X001
     C           PSPOT     DIV  POWER,N   WK159  159H
     C           SSMAM     MULT WK159     SBCQ      H
     C                     END                             E001
     C                     MOVE SSMCY     SMCY
     C                     Z-ADDSRATE     RATE
     C                     MOVE SOVRD     OVRD
     C                     Z-ADDSPYAM     PYAM
     C* CALCULATE BASE CURRENCY EQUIV
     C           RCDP      SUB  BCDP      N       10
     C                     ADD  4         N
     C           RMDIN     IFEQ 0                          B001
     C           RSPOT     MULT POWER,N   WK159     H
     C           SPYAM     DIV  WK159     PBCQ      H
     C                     ELSE                            X001
     C           RSPOT     DIV  POWER,N   WK159  159H
     C           SPYAM     MULT WK159     PBCQ      H
     C                     END                             E001
     C/COPY WNCPYSRC,FT0040C132
     C*
     C*  MAKE BASE CURRENCY EQUIVS EQUAL
     C*
     C***********SPCCY*****IFEQ BCCY                       B001           S01194
     C           SPCCY     IFEQ BJCYCD                     B001           S01194
     C                     Z-ADDPBCQ      SBCQ
     C                     ELSE                            X001
     C                     Z-ADDSBCQ      PBCQ
     C                     END                             E001
     C/COPY WNCPYSRC,FT0040C133
     C                     MOVE SPCCY     PCCY
     C                     Z-ADDSSLDT     SLDT
     C                     Z-ADDSSLDT1    SLDTD1
     C                     Z-ADDSSLDT2    SLDTD2
     C                     Z-ADDSSLDT3    SLDTD3
     C                     Z-ADDSPYDT     PVDT
     C                     Z-ADDSPYDT1    PVDTD1
     C                     Z-ADDSPYDT2    PVDTD2
     C                     Z-ADDSPYDT3    PVDTD3
     C                     MOVE SADDC     ADDC
     C                     MOVE SBOKC     BOKC                            S01414
     C                     MOVE SPRFC     PRFC                            S01414
     C                     MOVE SRPAY     RPAY
     C                     MOVE SFDLR     FDLR                            175479
     C                     MOVE SPAYF     PAYF
     C                     MOVE SDYIM     DYIM
     C                     Z-ADDSFDAT     FDAT
     C                     Z-ADDSFDAT1    FDATD1
     C                     Z-ADDSFDAT2    FDATD2
     C                     Z-ADDSFDAT3    FDATD3
     C*********************MOVE SSWPC     SWPC                            S01117
     C           SSWPC     IFEQ 'U'                        B001           S01117
     C                     Z-ADD1         SWPC                            S01117
     C                     ELSE                            X001           S01117
     C           SSWPC     IFEQ 'N'                        B002           S01117
     C                     Z-ADD2         SWPC                            S01117
     C                     END                             E002           S01117
     C                     END                             E001           S01117
     C                     MOVE SSTTP     STMT
     C/COPY WNCPYSRC,FT0040C020
     C                     MOVE SSNMT     SNMT
     C                     MOVE SFAIN     FAIN
     C* FORMAT SETTLE AMOUNT FOR DAF FIELD
     C*                                                                   S01194
     C*********************MOVE *BLANK    KEY                             S01194
     C*********************MOVEL'20'      KEY                             S01194
     C*********************MOVELSMCY      SCCY                            S01194
     C*********************MOVE '1'       SCCY                            S01194
     C*********************MOVE SCCY      KEY                             S01194
     C                     MOVE SMCY      @K101                           S01194
     C                     EXSR TG1RED
     C***********CDP*******IFEQ 0                          B001           S01194
     C           A6NBDP    IFEQ 0                          B001           S01194
     C                     Z-ADDSSMAM     SMAMD
     C                     ELSE                            X001
     C***********CDP*******IFEQ 1                          B002           S01194
     C           A6NBDP    IFEQ 1                          B002           S01194
     C           SSMAM     DIV  10        SMAMD
     C                     ELSE                            X002
     C***********CDP*******IFEQ 2                          B003           S01194
     C           A6NBDP    IFEQ 2                          B003           S01194
     C           SSMAM     DIV  100       SMAMD
     C                     ELSE                            X003
     C           SSMAM     DIV  1000      SMAMD
     C                     END                             E003
     C                     END                             E002
     C                     END                             E001
     C* FORMAT PAY AMOUNT FOR DAF FIELD
     C*********************                                               S01194
     C*********************MOVE *BLANK    KEY                             S01194
     C*********************MOVEL'20'      KEY                             S01194
     C*********************MOVELPCCY      SCCY                            S01194
     C*********************MOVE '1'       SCCY                            S01194
     C*********************MOVE SCCY      KEY                             S01194
     C                     MOVE PCCY      @K101                           S01194
     C                     EXSR TG1RED
     C***********CDP*******IFEQ 0                          B001           S01194
     C           A6NBDP    IFEQ 0                          B001           S01194
     C                     Z-ADDSPYAM     PYAMD
     C                     ELSE                            X001
     C***********CDP*******IFEQ 1                          B002           S01194
     C           A6NBDP    IFEQ 1                          B002           S01194
     C           SPYAM     DIV  10        PYAMD
     C                     ELSE                            X002
     C***********CDP*******IFEQ 2                          B003           S01194
     C           A6NBDP    IFEQ 2                          B003           S01194
     C           SPYAM     DIV  100       PYAMD
     C                     ELSE                            X003
     C           SPYAM     DIV  1000      PYAMD
     C                     END                             E003
     C                     END                             E002
     C                     END                             E001
     C                     Z-ADDSMDIN     MDIN
     C           SMDIN     IFEQ 1                          B001
     C                     Z-ADDRATE      RATED
     C                     ELSE                            X001
     C           1         DIV  RATE      RATED
     C                     END                             E001
     C                     Z-ADDSNPDT     NPDT
     C                     Z-ADDSNPDT1    NPDTD1
     C                     Z-ADDSNPDT2    NPDTD2
     C                     Z-ADDSNPDT3    NPDTD3
     C                     Z-ADDSPRBD     PRBD                            003352
     C*
     C           SODMT     IFEQ *BLANKS                    B001
     C                     MOVE *BLANKS   ODMT              001
     C                     ELSE                            X001
     C                     MOVELSODMT     ODMT              001
     C                     END                             E001
     C*                                                                   CAC001
     C* Restore updated values of Margin Info fields                      CAC001
     C*                                                                   CAC001
     C                     Z-ADDW3FXMP    FXMP                            CAC001
     C                     Z-ADDW3FXMD    FXMD                            CAC001
     C                     MOVELW3MBSI    MBSI                            CAC001
     C                     MOVELW3MSIG    MSIG                            CAC001
     C                     Z-ADDW3MAMT    MAMT                            CAC001
     C*
     C* RESET AUTHORISATION INDICATORS IF AMEND FOR REG PAYMENT
     C*
     C           *IN13     IFEQ '1'                        B001
     C           SPYTP     ANDEQ'RP'
     C                     MOVE *BLANKS   AUIN
     C                     MOVE *BLANKS   AUP1
     C                     MOVE *BLANKS   AUP2
     C                     END                             E001
     C/COPY WNCPYSRC,FT0040C203
     C*
     C                     ENDSR
     C*
     C************************************************************
     C* END OF MOVE SUBROUTINE
     C************************************************************
     C/EJECT
     C************************************************************
     C* EDIT SR.
     C* EDIT VALUE FIELDS FOR LEADINGS ZEROS AND DECIMAL POINT
     C*
     C           EDIT      BEGSR
     C*
     C* FIND WHERE DECIMAL POINT SHOULD BE
     C***********13********SUB  CDP       DP      30                      S01194
     C           13        SUB  A6NBDP    DP      30                      S01194
     C                     Z-ADD14        X       30
     C                     Z-ADD13        Y       30
     C* IF NO DECIMAL PLACES RIGHT JUSTIFY FIELD
     C***********CDP*******IFEQ 0                          B001           S01194
     C           A6NBDP    IFEQ 0                          B001           S01194
     C                     Z-ADD14        DP
     C                     Z-ADD0         Y
     C                     MOVEADIG1,1    DIG2,2
     C                     END                             E001
     C* LOOP TO MOVE DIGITS TO EDITED FIELD
     C           Y         DOWGT0                          B001
     C           Y         IFEQ DP                         B002
     C                     MOVE '.'       DIG2,X
     C                     SUB  1         X
     C                     END                             E002
     C                     MOVE DIG1,Y    DIG2,X
     C                     SUB  1         X
     C                     SUB  1         Y
     C                     END                             E001
     C                     Z-ADD1         X
     C* LOOP TO SUPPRESS LEADING ZEROS
     C           X         DOUEQDP                         B001
     C           DIG2,X    IFEQ ' '                        B002
     C           DIG2,X    OREQ '0'
     C                     MOVE ' '       DIG2,X
     C                     ADD  1         X
     C                     ELSE                            X002
     C                     Z-ADDDP        X
     C                     END                             E002
     C                     END                             E001
     C*
     C                     ENDSR
     C*
     C************************************************************
     C* END OF EDIT SUBROUTINE
     C************************************************************
     C/EJECT
     C************************************************************
     C* HELP SR.
     C* CALLS HELP  PROGRAM
     C*
     C**         HELP      BEGSR                                          S01199
     C*
     C**                   MOVEAERCD      HERCD 160                       S01199
     C**                   MOVEL'FT0000'  HBPGM   6                       S01199
     C**                   CALL 'MHELP'                                   S01199
     C**                   PARM           HBPGM                           S01199
     C**                   PARM           HERCD                           S01199
     C**                   SETOF                     01                   S01199
     C*
     C**                   ENDSR                                          S01199
     C*
     C************************************************************
     C* END OF HELP SUBROUTINE
     C************************************************************
     C/EJECT
      ************                                                        031876
      ************  Remove PRONO OLPOS and MEMOS                          031876
      ************                                                        031876
     C************************************************************        031876
     C**NOSTRO*SR.                                                        031876
     C**CHECKS*FOR ACCOUNT ENTRIES BEING NOSTROS                          031876
     C************                                                        031876
     C***********NOSTRO    BEGSR                                          031876
     C************                                                        031876
     C************         SETOF                     49                   031876
     C**IF*TYPE*NOT R,P OR G IGNORE                                       031876
     C***********NTYPE     IFEQ 'R'                        B001           031876
     C***********NTYPE     OREQ 'P'                                       031876
     C***********NTYPE     OREQ 'G'                                       031876
     C**IF*RETAIL*NUMBER READ ACNUMA TO GET ACCOUNT DETAILS               031876
     C***********NTYPE     IFEQ 'R'                        B002           031876
     C************         Z-ADDACNON     ACNO                            031876
     C***********ACNO      CHAINACNUMA               88                   031876
     C**N88******RECI      COMP 'D'                  8888                 031876
     C***88*******         DO                              B003           031876
     C************LOCK     IN   DLDA                                      031876
     C************         MOVE 'FT0040  'DBPGM                           031876
     C************         MOVE *BLANK    DBKEY                           031876
     C************         MOVE 'ACNUM'   DBFILE           ***************031876
     C************         Z-ADD32        DBASE            * DB ERROR 32 *031876
     C************         MOVELACNO      DBKEY            ***************031876
     C************         OUT  DLDA                                      031876
     C************         SETON                     U7U8LR               031876
     C************         DUMP                                           031876
     C************         RETRN                                          031876
     C************         END                             E003           031876
     C************         END                             E002           031876
     C**IF*PARTIAL ACCOUNT FORMAT ACCOUNT NUMBER                          031876
     C***********NTYPE     IFEQ 'P'                        B002           031876
     C************         MOVE BRCANP    BRCA                            S01117
     C************         Z-ADDCNUMN     CNUM                            031876
     C************         MOVE NCCY      CCY                             031876
     C************         Z-ADDACODNP    ACOD                            031876
     C************         Z-ADDACSQNP    ACSQ                            031876
     C************         END                             E002           031876
     C**IF*FULL*ACCOUNT FORMAT ACCOUNT NUMBER                             031876
     C***********NTYPE     IFEQ 'G'                        B002           031876
     C************         MOVE BRCAN     BRCA                            S01194
     C************         Z-ADDCNUMN     CNUM                            031876
     C************         MOVE CCYN      CCY                             031876
     C************         Z-ADDACODN     ACOD                            031876
     C************         Z-ADDACSQN     ACSQ                            031876
     C************         END                             E002           031876
     C**READ*TABLETL*TO*SEE*IF*A*NOSTRO                                   S01194
     C***********AKEY******CHAINFPRTNF               88                   S01194
     C**N88******RECI******COMP 'D'                  8888                 S01194
     C**N88****************SETON                     49                   S01194
     C************                                                        S01194
     C***Read*SDNOSTPD to see if a nostro                                 S01194
     C************                                                        S01194
     C************         CALL 'AONOSTR0'                                S01194
     C************         PARM *BLANKS   RTCD                            S01194
     C************         PARM '*KEY   ' @OPTN                           S01194
     C************         PARM CNUMA     @CUST                           S01194
     C************         PARM CCY       @CYCD                           S01194
     C************         PARM ACODA     @ACCD                           S01194
     C************         PARM ACSQA     @ACSN                           S01194
     C************         PARM *BLANKS   @NONB                           S01194
     C************         PARM BRCA      @BRCD                           S01194
     C************         PARM *BLANKS   @CSSN                           S01194
     C************         PARM *BLANKS   @PNOI                           S01194
     C***********SDNOST    PARM SDNOST    DSFDY                           S01194
     C************                                                        S01194
     C***********RTCD      CASEQ*BLANKS   MVFPRT     888849               S01194
     C************         END                                            S01194
     C************                                                        S01194
     C************         END                             E001           031876
     C************                                                        031876
     C************         ENDSR                                          031876
     C************                                                        031876
     C************************************************************        031876
     C**END*OF*NOSTRO SUBROUTINE                                          031876
     C************************************************************        031876
     C/EJECT
     C************************************************************
     C* ACCRED SR.
     C* READ ACCNT FILE
     C*
     C           ACCRED    BEGSR
     C*
     C/COPY WNCPYSRC,FT0040C304
     C           AKEY      CHAINACCNTABF             88
     C  N88      RECI      COMP 'D'                  8888
     C**N88*****           Z-ADDRETNUM    CNUM                                         179685 CSD027
     C  N88                MOVE RETNUM    CNUM                                                CSD027
     C   88                DO                              B002
     C           *LOCK     IN   DLDA
     C                     MOVE 'FT0040  'DBPGM
     C                     MOVE 'ACCNT  ' DBFILE           ***************
     C                     Z-ADD14        DBASE            * DB ERROR 14 *
     C                     MOVELAKEYF     DBKEY            ***************
     C                     OUT  DLDA
     C                     SETON                     U7U8LR
     C/COPY WNCPYSRC,FT0040C148
     C                     DUMP
      *                                                                   042167
      *  Allocate dataarea to blanks                                      042167
      *                                                                   042167
     C                     EXSR DALLOC                                    042167
      *                                                                   042167
     C                     RETRN
     C                     END                             E002
     C*
     C                     ENDSR
     C*
     C************************************************************
     C* END OF ACCNT READ SECTION
     C************************************************************
     C/EJECT
      ************                                                        031876
      ************  Remove PRONO OLPOS and MEMOS                          031876
      ************                                                        031876
     C************************************************************        031876
     C**ANMRED*SR.                                                        031876
     C**READ*ACNUM FILE                                                   031876
     C************                                                        031876
     C***********ANMRED    BEGSR                                          031876
     C************                                                        031876
     C***********ACNO      CHAINACNUMAF              88                   031876
     C**N88******RECI      COMP 'D'                  8888                 031876
     C***88*******         DO                              B002           031876
     C************LOCK     IN   DLDA                                      031876
     C************         MOVE 'FT0040  'DBPGM                           031876
     C************         MOVE 'ACNUM'   DBFILE           ***************031876
     C************         Z-ADD15        DBASE            * DB ERROR 15 *031876
     C************         MOVELACNO      DBKEY            ***************031876
     C************         OUT  DLDA                                      031876
     C************         SETON                     U7U8LR               031876
     C************         DUMP                                           031876
     C************         RETRN                                          031876
     C************         END                             E002           031876
     C************                                                        031876
     C************         ENDSR                                          031876
     C************                                                        031876
     C************************************************************        031876
     C**END*OF*ACNUM READ SECTION                                         031876
     C************************************************************        031876
     C/EJECT
      ************                                                        031876
      ************  Remove PRONO OLPOS and MEMOS                          031876
      ************                                                        031876
     C************************************************************        031876
     C**MEMRED*SR.                                                        031876
     C**READ*MEMOS FILE                                                   031876
     C************                                                        031876
     C***********MEMRED    BEGSR                                          031876
     C************                                                        031876
     C***********RRNM      CHAINMEMOS                88                   031876
     C**N88******RECI      COMP 'D'                  8888                 031876
     C***88*******         DO                              B003           031876
     C************LOCK     IN   DLDA                                      031876
     C************         MOVE 'FT0040  'DBPGM                           031876
     C************         MOVE 'MEMOS'   DBFILE           ***************031876
     C************         Z-ADD16        DBASE            * DB ERROR 16 *031876
     C************         MOVELRRNM      DBKEY            ***************031876
     C************         OUT  DLDA                                      031876
     C************         SETON                     U7U8LR               031876
     C************         DUMP                                           031876
     C************         RETRN                                          031876
     C************         END                             E003           031876
     C************                                                        031876
     C************         ENDSR                                          031876
     C************                                                        031876
     C************************************************************        031876
     C* END OF MEMOS READ SECTION
     C************************************************************
     C/EJECT
     C************************************************************
     C* TG1RED SR.
     C**READ*TABTG10*FILE                                                 S01194
     C* Read SDCURRPD file                                                S01194
     C*
     C           TG1RED    BEGSR
     C*                                                                   S01194
     C***********KEY*******CHAINTABTG10F             88                   S01194
     C**N88******RECI******COMP 'D'                  8888                 S01194
     C***88****************DO                              B001           S01194
     C************LOCK*****IN   DLDA                                      S01194
     C*********************MOVE 'FT0040  'DBPGM                           S01194
     C*********************MOVE 'TABLE'   DBFILE           ***************S01194
     C*********************Z-ADD17        DBASE            * DB ERROR 17 *S01194
     C*********************MOVELKEY       DBKEY            ***************S01194
     C*********************OUT  DLDA                                      S01194
     C*********************SETON                     U7U8LR               S01194
     C*********************DUMP                                           S01194
     C*********************RETRN                                          S01194
     C*********************END                             E001           S01194
     C*
     C                     CALL 'AOCURRR0'                                S01194
     C                     PARM '*DBERR ' RTCD                            S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM           @K101                           S01194
     C           SDCURR    PARM SDCURR    DSSDY                           S01194
     C*                                                                   S01194
     C** Move new standing data field into field used in program          S01194
     C*                                                                   S01194
     C           A6MDIN    IFEQ 'M'                                       S01194
     C                     Z-ADD1         MDIN                            S01194
     C                     ELSE                                           S01194
     C                     Z-ADD0         MDIN                            S01194
     C                     END                                            S01194
      ** Store number of decimal places to work - field                   CFT014
     C                     Z-ADDA6NBDP    WDECP   10                      CFT014
     C*                                                                   S01194
     C*                                                                   S01194
     C                     ENDSR
     C*
     C************************************************************
     C* END OF TABTG10 READ SECTION
     C************************************************************
     C/EJECT
     C************************************************************
     C*                                                                   S01194
     C**TG2RED*SR.*********                                               S01194
     C**READ*TABTG20*FILE**                                               S01194
     C*********************                                               S01194
     C***********TG2RED****BEGSR                                          S01194
     C*********************                                               S01194
     C***********KEY*******CHAINTABTG40F             88                   S01194
     C**N88******RECI******COMP 'D'                  8888                 S01194
     C***88****************DO                              B001           S01194
     C************LOCK*****IN   DLDA                                      S01194
     C*********************MOVE 'FT0040  'DBPGM                           S01194
     C*********************MOVE 'TABLE'   DBFILE           ***************S01194
     C*********************Z-ADD18        DBASE            * DB ERROR 18 *S01194
     C*********************MOVELKEY       DBKEY            ***************S01194
     C*********************OUT  DLDA                                      S01194
     C*********************SETON                     U7U8LR               S01194
     C*********************DUMP                                           S01194
     C*********************RETRN                                          S01194
     C*********************END                             E001           S01194
     C*********************                                               S01194
     C*********************ENDSR                                          S01194
     C*                                                                   S01194
     C************************************************************
     C* END OF TABTG20 READ SECTION
     C************************************************************
     C/EJECT
      ************                                                        031876
      ************  Remove PRONO OLPOS and MEMOS                          031876
      ************                                                        031876
     C************************************************************        031876
     C**TTLRED*SR.                                                        031876
     C**READ*TABLETL FILE                                                 031876
     C************                                                        031876
     C***********TTLRED    BEGSR                                          031876
     C************                                                        S01194
     C***********KEY*******CHAINTABLETLF             88                   S01194
     C**N88******RECI******COMP 'D'                  8888                 S01194
     C***88****************DO                              B002           S01194
     C************LOCK*****IN   DLDA                                      S01194
     C*********************MOVE 'FT0040  'DBPGM                           S01194
     C*********************MOVE 'TABLE'   DBFILE           ***************S01194
     C*********************Z-ADD19        DBASE            * DB ERROR 19 *S01194
     C*********************MOVELKEY       DBKEY            ***************S01194
     C*********************OUT  DLDA                                      S01194
     C*********************SETON                     U7U8LR               S01194
     C*********************DUMP                                           S01194
     C*********************RETRN                                          S01194
     C*********************END                             E002           S01194
     C************         CALL 'AONOSTR0'                                S01194
     C************         PARM '*DBERR ' RTCD                            S01194
     C************         PARM '*KEY   ' @OPTN                           S01194
     C************         PARM *BLANKS   @CUST                           S01194
     C************         PARM           @CYCD                           S01194
     C************         PARM *BLANKS   @ACCD                           S01194
     C************         PARM *BLANKS   @ACSN                           S01194
     C************         PARM           @NONB                           S01194
     C************         PARM *BLANKS   @BRCD                           S01194
     C************         PARM *BLANKS   @CSSN                           S01194
     C************         PARM *BLANKS   @PNOI                           S01194
     C***********SDNOST    PARM SDNOST    DSFDY                           S01194
     C************                                                        S01194
     C************         EXSR MVNOST                                    S01194
     C************                                                        S01194
     C**MOVE*CURRENCY TO CCY FOR READ OF ACCNT                            031876
     C*********************MOVELCURR      CCY                             031876
     C************         MOVE @CYCD     CCY                             S01194
     C************                                                        031876
     C************         ENDSR                                          031876
     C************                                                        031876
     C************************************************************        031876
     C**END*OF*TABLETL READ SECTION                                       031876
     C************************************************************        031876
     C/EJECT
     C/COPY WNCPYSRC,FT0040C021
     C******************************************************************* S01194
     C* Subroutine to move new SYNON field names to old field names       S01194
     C           MVNOST    BEGSR                                          S01194
     C**********           MOVE A7CUST    CNUM    60                                   S01194 CSD027
     C                     MOVE A7CUST    CNUM    6                                           CSD027
     C**********           MOVE A7ACCD    ACOD    40                                   S01194 CGL029
     C                     MOVE A7ACCD    ACOD                                                CGL029
     C                     MOVE A7ACSN    ACSQ    20                      S01194
     C                     MOVE A7BRCD    BRCA    3                       S01194
     C                     ENDSR                                          S01194
     C******************************************************************* S01194
     C* END OF MVNOST SUBROUTINE                                        * S01194
     C******************************************************************* S01194
     C/EJECT                                                              S01194
      ************                                                        031876
      ************  Remove PRONO OLPOS and MEMOS                          031876
      ************                                                        031876
     C******************************************************************* S01194
     C**Subroutine to move new SYNON field names to old field names       S01194
     C***********MVFPRT    BEGSR                                          S01194
     C************         MOVE A7ACCD    ACOD    40                      S01194
     C************         MOVE A7ACSN    ACSQ    20                      S01194
     C************         MOVE A7CYCD    CCY     3                       S01194
     C************         MOVE A7CUST    CNUM    60                      S01194
     C************         MOVE A7NOSN    CSNM   10                       S01194
     C************         MOVE A7NONB    NOSN    20                      S01194
     C************         MOVE A7BRCD    BRCA    3                       S01194
     C************         ENDSR                                          S01194
     C******************************************************************* S01194
     C* END OF MVFPRT SUBROUTINE                                        * S01194
     C******************************************************************* S01194
     C/EJECT                                                              S01194
     C******************************************************************* S01194
     C* Subroutine to move new SYNON field names to old field names       S01194
     C           MVCUST    BEGSR                                          S01194
     C**********           MOVE BBCUST    CNUM    60                                   S01194 CSD027
     C                     MOVE BBCUST    CNUM    6                                           CSD027
     C                     MOVE BBCSID    CSID   12                       S01194
     C                     MOVE BBCSSN    CSNM   10                       S01194
     C                     ENDSR                                          S01194
     C*                                                                   S01194
     C******************************************************************* S01194
     C* END OF MVCUST SUBROUTINE                                        * S01194
     C******************************************************************* S01194
     C/EJECT
     C********************************************************************042167
     C* SUBROUTINE TO DEALLOCATE DATAAREA                                 042167
     C*                                                                   042167
     C           DALLOC    BEGSR                           *** DALLOC ****042167
      *                                                                   042167
      * Call CL program to de-allocate                                    042167
      *                                                                   042167
     C                     MOVE *BLANKS   @RTCDE                          042167
     C                     MOVE 'FT'      @MODLE                          042167
     C                     MOVE *BLANKS   @TREF                           042167
     C                     MOVE *BLANKS   @RTINF                          042167
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0040CP24                                           S01408
     C*                                                                   S01408
     C                     CALL 'AOC8000'                                 042167
     C                     PARM           @RTCDE                          042167
     C                     PARM           @MODLE                          042167
     C                     PARM           @TREF                           042167
     C                     PARM           @RTINF                          042167
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0040CP25                                           S01408
     C*                                                                   S01408
      *                                                                   042167
     C                     ENDSR                                          042167
      *                                                                   042167
     C/COPY WNCPYSRC,FT0040C301
     C*                                                                   042167
     C/EJECT
     C*******************************************************************
     C**
     C**   ZDATE1 SR. TO VALIDATE DATES SUBMITTED AND
     C**              CONVERT TO A NUMBER OF DAYS.
     C**
     C**   THE YEAR 2000, BEING DIVISIBLE BY 400, IS A LEAP YEAR.
     C**
     C           ZDATE1    BEGSR                           *** ZDATE1 ***
     C**
     C**   CLEAR DAY NUMBER.
     C                     Z-ADD0         ZDAYNO  50
     C**
     C**   CALCULATION TO DEFINE INPUT DATE FIELD.
     C                     Z-ADDZDATE     ZDATE   60
     C**
     C**   GET INDIVIDUAL DAY, MONTH AND YEAR FIELDS.
     C                     MOVE ZDATE     ZYEAR   20
     C  N98                MOVELZDATE     ZDAY    20
     C   98                MOVELZDATE     ZMTH    20
     C                     MOVE ZDATE     ZWRK4   40
     C  N98                MOVELZWRK4     ZMTH
     C   98                MOVELZWRK4     ZDAY
     C**
     C**   ENSURE MONTH IS VALID.
     C           ZMTH      COMP 0                      9999
     C  N99      ZMTH      COMP 12                   99
     C   99                GOTO ZDEND1                     BYPASS IF ERROR
     C**
     C**   CHECK FOR 30 DAY MONTHS.
     C           ZMTH      COMP 4                        90IF 90 ON, 30
     C  N90      ZMTH      COMP 6                        90DAY MONTH.
     C  N90      ZMTH      COMP 9                        90
     C  N90      ZMTH      COMP 11                       90
     C**
     C**   ENSURE DAY IS VALID.
     C           ZDAY      COMP 0                      9999
     C   90N99   ZDAY      COMP 30                   99
     C  N90N99   ZDAY      COMP 31                   99
     C   99                GOTO ZDEND1                     BYPASS IF ERROR
     C**
     C**   CHECK FOR LEAP YEAR AND FEBRUARY.
     C           ZYEAR     ADD  28        ZYEAR
     C           ZYEAR     DIV  4         ZLYR    20
     C                     MVR            ZLY     10     91LEAP YR, 91 ON
     C           ZMTH      COMP 2                    93  92FEB., 92 ON
     C**                                                   PAST FEB, 93 ON
     C**   IF FEBUARY FURTHER VALIDATE DAY.
     C  N91 92   ZDAY      COMP 28                   99
     C   91 92   ZDAY      COMP 29                   99
     C   99                GOTO ZDEND1                     BYPASS IF ERROR
     C**
     C**   DETERMINE NUMBER OF DAYS FROM 31/12/1971.     NO.OF 4 YR. SPANS
     C           ZLYR      MULT 1461      ZDAYNO           X DAYS IN SPAN.
     C  N91      ZDAYNO    ADD  ZYDY,ZLY  ZDAYNO           SINCE LAST L.YR
     C   91 93   ZDAYNO    ADD  1         ZDAYNO           L.YR.,PAST FEB.
     C           ZDAYNO    ADD  ZMDY,ZMTH ZDAYNO           DAYS THIS YEAR
     C           ZDAYNO    ADD  ZDAY      ZDAYNO           DAYS THIS MONTH
     C**
     C           ZDEND1    ENDSR                           * ZDEND1 ENDSR*
     C**
     C**
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C**   ZALIGN SR. TO VALIDATE AND RIGHT-ALIGN NUMERIC FIELDS.
     C**
     C           ZALIGN    BEGSR                           *** ZALIGN ***
     C**
     C                     SETOF                     929399
     C**
     C**   SAVE INPUT FIELD IN ARRAY, ZA1.
     C                     MOVEAZFIELD    ZA1
     C**
     C**   CALCULATION TO DEFINE NUMBER STRUCTURE CONTROL FIELDS.
     C                     Z-ADDZADIG     ZADIG   20
     C                     Z-ADDZADEC     ZADEC   10
     C**
     C**   CALCULATIONS TO DEFINE/CLEAR FIELDS.
     C                     MOVE ' '       ZA2
     C                     MOVEAZA2       ZFIELD 16
     C                     Z-ADD0         ZX      20
     C                     Z-ADD0         ZY      20
     C**
     C**   ENSURE REQUIRED STRUCTURE OF FIELD IS VALID.
     C           ZADIG     ADD  ZADEC     ZZ      20
     C           ZZ        COMP 15                   99
     C   99                GOTO ZAEND
     C**
     C**   LOOP TO FIND DECIMAL POINT, BLANKS AND CHARACTERS.
     C           ZATAG1    TAG                             ** ZATAG1 TAG *
     C           ZX        ADD  1         ZX
     C**
     C**   CHECK FOR DECIMAL POINT. ERROR IF SECOND DECIMAL POINT.
     C           ZA1,ZX    COMP '.'                      90
     C   90 93             SETON                     99
     C   99                GOTO ZAEND
     C**
     C**
     C**   CHECK FOR 'M' CONSTANT. ERROR IF NOT LAST CHARACTER ENTERED
     C           ZA1,ZX    COMP 'M'                      96
     C   96                DO
     C           ZX        COMP 15                   99  99
     C   99                GOTO ZAEND
     C           ZX        ADD  1         ZX
     C           ZA1,ZX    COMP ' '                  9999
     C   99                GOTO ZAEND
     C           ZX        SUB  1         ZX
     C           ZX        COMP 9                    99
     C   99                GOTO ZAEND
     C                     END
     C**
     C**   CHECK FOR 'T' CONSTANT. ERROR IF NOT LAST CHARACTER ENTERED
     C           ZA1,ZX    COMP 'T'                      97
     C   97                DO
     C           ZX        COMP 15                   99  99
     C   99                GOTO ZAEND
     C           ZX        ADD  1         ZX
     C           ZA1,ZX    COMP ' '                  9999
     C   99                GOTO ZAEND
     C           ZX        SUB  1         ZX
     C           ZX        COMP 12                   99
     C   99                GOTO ZAEND
     C                     END
     C**
     C**   CLEAR ALPHAMERIC CONSTANT FROM ZA1
     C   96
     COR 97                MOVE ' '       ZA1,ZX
     C**
     C**   CHECK FOR BLANKS. BYPASS FOR FIRST BLANK AFTER A DIGIT.
     C           ZA1,ZX    COMP ' '                      91
     C   91 92             GOTO ZATAG2
     C**
     C**   CHECK FOR NUMERIC, IF NOT '.' OR ' '.
     C  N90N91   ZA1,ZX    COMP '0'                    99
     C  N90N91N99ZA1,ZX    COMP '9'                  99
     C   99                GOTO ZAEND                      NOT NUMERIC
     C**
     C**   STORE DIGITS IN ARRAY AND HOW MANY.
     C**   ZY, TOTAL OF DIGITS IN THE INPUT FIELD.
     C**   ZZ, TOTAL OF DIGITS TO THE LEFT OF DECIMAL POINT.
     C  N90N91   ZY        ADD  1         ZY         92
     C  N90N91             MOVE ZA1,ZX    ZA2,ZY
     C   90                Z-ADDZY        ZZ         93  93
     C**
     C           ZX        COMP 16                     94  CHECK IF ALL
     C   94                GOTO ZATAG1
     C**
     C           ZATAG2    TAG                             ** ZATAG2 TAG *
     C**
     C**   IF 'M' SPECIFIED, MULTIPLY ZA1 BY 1 MILLION
     C   96      ZZ        ADD  6         ZZ
     C**
     C**   IF 'T' SPECIFIED, MULTIPLY ZA1 BY 1 THOUSAND
     C   97      ZZ        ADD  3         ZZ
     C**
     C**   FILL IN ZEROS IN ANY BLANKS LEFT OF DECIMAL POINT
     C   96 93
     COR 97 93   ZZ        DOWGTZY
     C           ZY        ADD  1         ZY
     C                     MOVE '0'       ZA2,ZY
     C                     END
     C**
     C**   IF CONSTANT SPECIFIED WITH NO DECIMAL POINT ZEROISE BLANKS
     C   96N93             DO   6
     C           ZY        ADD  1         ZY
     C                     MOVE '0'       ZA2,ZY
     C                     END
     C**
     C   97N93             DO   3
     C           ZY        ADD  1         ZY
     C                     MOVE '0'       ZA2,ZY
     C                     END
     C**
     C**   IF NO DECIMAL POINT FOUND, SET TOTAL FIELD ZZ.
     C  N93                Z-ADDZY        ZZ
     C**
     C**   CHECK FOR EMBEDDED BLANKS.
     C   91 92             MOVEAZA1,ZX    ZFIELD
     C   91 92   ZFIELD    COMP ' '                  9999
     C   99                GOTO ZAEND                      EMBEDDED BLANK
     C**
     C**   ENSURE THAT NUMBER OF DIGITS ENTERED EITHER SIDE
     C**   OF DECIMAL POINT ARE NOT MORE THAN ALLOWED.
     C           ZZ        COMP ZADIG                99
     C           ZY        SUB  ZZ        ZX
     C  N99      ZADEC     SUB  ZX        ZX           9995
     C   99                GOTO ZAEND
     C   95                GOTO ZATAG4                     NO TRAILING
     C**                                                   BLANKS.
     C**   FILL THE TRAILING BLANKS WITH ZEROS.
     C           ZY        ADD  ZX        ZZ
     C           ZATAG3    TAG                             ** ZATAG3 TAG *
     C           ZY        ADD  1         ZY
     C                     MOVE '0'       ZA2,ZY
     C           ZY        COMP ZZ                     94
     C   94                GOTO ZATAG3
     C**
     C**   RIGHT-ALIGN THE VALUE BY MOVING BACK TO ARRAY, ZA1.
     C           ZATAG4    TAG                             ** ZATAG4 TAG *
     C                     MOVE '0'       ZA1
     C                     Z-ADD16        ZX
     C           ZATAG5    TAG                             ** ZATAG5 TAG *
     C           ZY        COMP 0                        94
     C   94                GOTO ZATAG6
     C                     MOVE ZA2,ZY    ZA1,ZX
     C           ZY        SUB  1         ZY
     C           ZX        SUB  1         ZX
     C                     GOTO ZATAG5
     C           ZATAG6    TAG                             ** ZATAG6 TAG *
     C**
     C**   MOVE VALIDATED AND RIGHT-ALIGNED NUMBER BACK INTO ZFIELD.
     C                     MOVEAZA1       ZFIELD
     C**
     C                     SETOF                     9697
     C**
     C           ZAEND     ENDSR                           * ZAEND ENDSR *
     C**
     C**
     C********************************************************************
     C/EJECT
     C************************************************************
     C/COPY ZSRSRC,ZFREQBZ2                                               S01195
     C*********************                                               S01195
     C*****ZFREQB-SR.*TO*INCREMENT A DAY NUMBER DATE BY A                 S01195
     C***************PERIOD VALUE DETERMINED BY A CODE.                   S01195
     C*********************                                               S01195
     C***********ZFREQB****BEGSR                           *** ZFREQB *** S01195
     C*********************                                               S01195
     C*****CALCULATIONS*TO*DEFINE/CLEAR FIELDS.                           S01195
     C*********************SETOF                     99                   S01195
     C*********************MOVE ZFREQ     ZFREQ   1                       S01195
     C*********************Z-ADDZDAYNO    ZDAYNO  50                      S01195
     C*********************Z-ADDZMDAY     ZMDAY   20                      S01195
     C*********************MOVE ZCCY      ZCCY    3                       S01195
     C*********************                                               S01195
     C*********************MOVE '   '     ZHC                             S01195
     C*********************MOVE ' '       ZTABKY 12                       S01195
     C*********************                                               S01195
     C*************FIELDS*USED FOR PERIOD CODES M,T,Q,X,Y                 S01195
     C*********************                                               S01195
     C*********************MOVE '  '      ZINDE   2                       S01195
     C*********************Z-ADD0         ZINTO   20                      S01195
     C*********************                                               S01195
     C*****CONVERT*DAY*NUMBER TO DATE.                                    S01195
     C*********************EXSR ZDATE2                                    S01195
     C*********************SETOF                     90                   S01195
     C*********************                                               S01195
     C*****CHECK*FOR*AND*INCREMENT FOR CODE D-DAILY-WORKING DAY.          S01195
     C***********ZFREQ*****COMP 'D'                      91               S01195
     C***91******ZDAYNO****ADD  1         ZDAYNO                          S01195
     C***91****************GOTO ZFHCHK                                    S01195
     C*********************                                               S01195
     C*****CHECK*FOR*AND*INCREMENT FOR CODE W-WEEKLY.                     S01195
     C***********ZFREQ*****COMP 'W'                      91               S01195
     C***91******ZDAYNO****ADD  7         ZDAYNO                          S01195
     C***91****************GOTO ZFEND                                     S01195
     C*********************                                               S01195
     C*****CHECK*FOR*AND*INCREMENT FOR CODE F-FORTNIGHTLY.                S01195
     C***********ZFREQ*****COMP 'F'                      91               S01195
     C***91******ZDAYNO****ADD  14        ZDAYNO                          S01195
     C***91****************GOTO ZFEND                                     S01195
     C*********************                                               S01195
     C*****CHECK*FOR*AND*INCREMENT FOR CODE S-SEMI-MONTHLY.               S01195
     C***********ZFREQ*****COMP 'S'                      91               S01195
     C***91******ZDAY******COMP 15                   939292               S01195
     C***91*92*************Z-ADD31        ZDAY                            S01195
     C***91*93*************Z-ADD15        ZDAY                            S01195
     C***91*93***ZMTH******ADD  1         ZMTH                            S01195
     C***91****************GOTO ZFDATE                                    S01195
     C*********************                                               S01195
     C*****CHECK*FOR*AND*INCREMENT FOR CODE M-MONTHLY.                    S01195
     C***********ZFREQ*****COMP 'M'                      91               S01195
     C***91****************MOVE 'IN'      ZINDE                           S01195
     C***91****************Z-ADDZMDAY     ZDAY                            S01195
     C***91******ZMTH******ADD  1         ZMTH                            S01195
     C***91****************GOTO ZFDATE                                    S01195
     C*********************                                               S01195
     C*****CHECK*FOR*AND*INCREMENT FOR CODE R-SIX DAYS BEFORE END OF MONTHS01195
     C***********ZFREQ*****COMP 'R'                      91               S01195
     C***91****************Z-ADD31        ZDAY                            S01195
     C***91******ZMTH******ADD  1         ZMTH                            S01195
     C***91****************GOTO ZFDATE                                    S01195
     C*********************                                               S01195
     C*****CHECK*FOR*AND*INCREMENT FOR CODE T-BIMONTHLY.                  S01195
     C***********ZFREQ*****COMP 'T'                      91               S01195
     C***91****************MOVE 'IN'      ZINDE                           S01195
     C***91****************Z-ADDZMDAY     ZDAY                            S01195
     C***91******ZMTH******ADD  2         ZMTH                            S01195
     C***91****************GOTO ZFDATE                                    S01195
     C*********************                                               S01195
     C*****CHECK*FOR*AND*INCREMENT FOR CODE Q-QUARTERLY.                  S01195
     C***********ZFREQ*****COMP 'Q'                      91               S01195
     C***91****************MOVE 'IN'      ZINDE                           S01195
     C***91****************Z-ADDZMDAY     ZDAY                            S01195
     C***91******ZMTH******ADD  3         ZMTH                            S01195
     C***91****************GOTO ZFDATE                                    S01195
     C*********************                                               S01195
     C*****CHECK*FOR*AND*INCREMENT FOR CODE X-SIX MONTHLY.                S01195
     C***********ZFREQ*****COMP 'X'                      91               S01195
     C***91****************MOVE 'IN'      ZINDE                           S01195
     C***91****************Z-ADDZMDAY     ZDAY                            S01195
     C***91******ZMTH******ADD  6         ZMTH                            S01195
     C***91****************GOTO ZFDATE                                    S01195
     C*********************                                               S01195
     C*****CHECK*FOR*AND*INCREMENT FOR CODE Y-YEARLY.                     S01195
     C***********ZFREQ*****COMP 'Y'                      91               S01195
     C***91****************MOVE 'IN'      ZINDE                           S01195
     C***91****************Z-ADDZMDAY     ZDAY                            S01195
     C***91******ZYEAR*****ADD  1         ZYEAR                           S01195
     C***91****************GOTO ZFDATE                                    S01195
     C*********************                                               S01195
     C*****CHECK*FOR*AND*INCREMENT FOR CODE L-LAST CALENDAR DAY OF MONTH. S01195
     C***********ZFREQ*****COMP 'L'                      91               S01195
     C***91****************Z-ADD31        ZDAY                            S01195
     C***91******ZMTH******ADD  1         ZMTH                            S01195
     C***91****************GOTO ZFDATE                                    S01195
     C*********************                                               S01195
     C*****CHECK*FOR*AND*INCREMENT FOR CODE B-LAST WORKING DAY OF MONTH.  S01195
     C***********ZFREQ*****COMP 'B'                      91               S01195
     C***91****************Z-ADD31        ZDAY                            S01195
     C***91******ZMTH******ADD  1         ZMTH                            S01195
     C***91****************GOTO ZFDATE                                    S01195
     C*********************                                               S01195
     C*****CHECK*FOR*AND*INCREMENT FOR CODE A-MONTHLY ACCRUAL/PROFIT DATE.S01195
     C***********ZFREQ*****COMP 'A'                      91               S01195
     C*********************MOVEL'01    '  ZTABKY                          S01195
     C***91****************MOVEL'01    '  ZTABKY                          S01195
     C***91****************MOVE '    11'  ZTABKY                          S01195
     C***91******ZTABKY****CHAINTABLETJF             99    ON NOT THERE   S01195
     C**N99******RECI******COMP '*'                      99               S01195
     C***91N99*************Z-ADDAPDA      ZDAYNO                          S01195
     C***91N99*************Z-ADDBKAPDT    ZDAYNO                          S01195
     C*********************                                               S01195
     C*****BYPASS*IF*ZFREQ*IS 'A' OR ANY OTHER VALUE                      S01195
     C*********************GOTO ZFEND                                     S01195
     C*********************                                               S01195
     C*********************                                               S01195
     C*****REFORMAT*DATE*AND ENSURE VALID.                                S01195
     C***********ZFDATE****TAG                             ** ZFDATE TAG* S01195
     C*********************                                               S01195
     C*****VALIDATE*MONTH.*                                               S01195
     C***********ZMTH******COMP 12                   91                   S01195
     C***91******ZMTH******SUB  12        ZMTH                            S01195
     C***91******ZYEAR*****ADD  1         ZYEAR                           S01195
     C*********************                                               S01195
     C*****CHECK*FOR*LEAP*YEAR.                                           S01195
     C***********ZYEAR*****DIV  4         ZLYR    20                      S01195
     C*********************MVR            ZLY     10     92LEAP YEAR-92 ONS01195
     C*********************                                               S01195
     C*****VALIDATE*DAY*NUMBER.                                           S01195
     C*********************MOVE ZFMD,ZMTH ZWRK2   20                      S01195
     C***********ZMTH******COMP 2                        93               S01195
     C***92*93*************Z-ADD29        ZWRK2                           S01195
     C*********************                                               S01195
     C***********ZDAY******COMP ZWRK2                94                   S01195
     C***94****************Z-ADDZWRK2     ZDAY                            S01195
     C*********************                                               S01195
     C*****CHECK*IF*CODE*R, TO SUBTRACT 6 DAYS.                           S01195
     C***********ZFREQ*****COMP 'R'                      91               S01195
     C***91******ZDAY******SUB  6         ZDAY                            S01195
     C*********************                                               S01195
     C*****REFORMAT*DATE,*DDMMYY OR MMDDYY, AND CONVERT TO DAY NUMBER.    S01195
     C*********************MOVELZDAY      ZWRK4   40                      S01195
     C*********************MOVE ZMTH      ZWRK4                           S01195
     C***98****************MOVELZMTH      ZWRK4                           S01195
     C***98****************MOVE ZDAY      ZWRK4                           S01195
     C*********************MOVELZWRK4     ZDATE                           S01195
     C*********************MOVE ZYEAR     ZDATE                           S01195
     C*********************EXSR ZDATE1                                    S01195
     C*********************                                               S01195
     C*****CHECK*IF*CODE*B, OR M,T,Q,X,Y TO BE CHECKED FOR HOLIDAY.       S01195
     C***********ZFREQ*****COMP 'B'                      91               S01195
     C***********ZINDE*****COMP 'IN'                     92               S01195
     C***92N99*************                                               S01195
     C*OR91N99*************GOTO ZFHCHK                                    S01195
     C*********************                                               S01195
     C*********************GOTO ZFEND                                     S01195
     C*********************                                               S01195
     C*****CHECK*IF*DAY*NUMBER IS A HOLIDAY.                              S01195
     C*********************                                               S01195
     C***********ZFHCHK****TAG                             ** ZFHCHK TAG *S01195
     C*********************SETOF                     94                   S01195
     C***********ZFREQ*****COMP 'D'                      91               S01195
     C***********ZFREQ*****COMP 'B'                      92               S01195
     C***91****************                                               S01195
     C*OR92****************GOTO ZSETK                                     S01195
     C*********************                                               S01195
     C****FOR*CODES*M,T,Q,X,Y, CHECK ZINDE - 'IN' TO INCREMENT,           S01195
     C*********************                - 'DE' TO DECREMENT            S01195
     C*********************                                               S01195
     C***********ZINDE*****COMP 'IN'                     90               S01195
     C***********ZINDE*****COMP 'IN'                     91               S01195
     C***********ZINDE*****COMP 'DE'                     92               S01195
     C*********************                                               S01195
     C*****SET*KEY*FOR*FIRST HOLIDAY RECORD.                              S01195
     C***********ZSETK*****TAG                             ** ZSETK TAG **S01195
     C*********************MOVEL'22    '  ZTABKY                          S01195
     C*********************MOVELZDAYNO    ZWRK6   6                       S01195
     C*********************MOVE 1         ZWRK6                           S01195
     C*********************MOVE ZWRK6     ZTABKY                          S01195
     C*********************                                               S01195
     C*****GET*HOLIDAY*RECORD.                                            S01195
     C***********ZFHCHN****TAG                             ** ZFHCHN TAG* S01195
     C***********ZTABKY****CHAINTABLETJF             93    ON NOT THERE   S01195
     C*********************                                               S01195
     C**N93******RECI******COMP '*'                      93               S01195
     C**N94****************MOVE '   '     ZHC                             S01195
     C*********************                                               S01195
     C*****STORE*CURRENCIES IF RECORD FOUND.                              S01195
     C**N94N93*************MOVEAHCCY      ZHC,1                           S01195
     C***94N93*************MOVEAHCCY      ZHC,26                          S01195
     C*********************                                               S01195
     C*****GET*SECOND*RECORD, IF NOT ALREADY DONE.                        S01195
     C*********************MOVE ZTABKY    ZWRK1N  10                      S01195
     C***********ZWRK1N****COMP 1                        94               S01195
     C*********************MOVE '2'       ZTABKY                          S01195
     C***94N93*************GOTO ZFHCHN                                    S01195
     C*********************                                               S01195
     C*****BYPASS*TO*END*IF NO FIRST RECORD FOUND.                        S01195
     C***93*94*************GOTO ZFEND                                     S01195
     C*********************                                               S01195
     C*****DETERMINE*HOLIDAY RECORD TYPE.                                 S01195
     C***********INEX******COMP 'E'                      95               S01195
     C***********INEX******COMP 'I'                      96               S01195
     C*********************                                               S01195
     C*****CHECK*IF*CURRENCY ON HOLIDAY.                                  S01195
     C***********ZCCY******LOKUPZHC                      97               S01195
     C*********************                                               S01195
     C*****BYPASS*IF*NOT*HOLIDAY FOR CURRENCY.                            S01195
     C***95*97*************                                EXCLUDE FOUND  S01195
     C*OR96N97*************GOTO ZFEND                      INCL. NOT FOUNDS01195
     C*********************                                               S01195
     C*********************                                               S01195
     C***92****************GOTO ZDECR                                     S01195
     C*********************                                               S01195
     C*****INCREMENT*OR*DECREMENT DAY NUMBER AS REQUIRED.                 S01195
     C***91******ZDAYNO****ADD  1         ZDAYNO                          S01195
     C*********************                                               S01195
     C*****ONLY*FOR*PERIOD*CODE = M,T,Q,X OR Y, IF INCREMENTATION         S01195
     C*****TAKES*THE*OUTPUT DATE INTO THE FOLLOWING MONTH, RETURN TO      S01195
     C*****THE*INPUT*DATE*AND DECREMENT - 92 ON.                          S01195
     C*********************                                               S01195
     C***90*91***ZINTO*****ADD  1         ZINTO                           S01195
     C***90*91***ZINTO*****ADD  ZDAY      ZINTOT  20                      S01195
     C***90*91*************MOVE ZINTOT    ZINTOA  2                       S01195
     C***ALLOW*29*FEB*ON*LEAP YEARS TO PASS                               S01195
     C*********************SETOF                     93                   S01195
     C***90*91***ZYEAR*****DIV  4         ZLYR                            S01195
     C***90*91*************MVR            ZLY            92               S01195
     C***90*91*92ZMTH******COMP 2                        93               S01195
     C***93******ZINTOA****COMP '29'                 92                   S01195
     C***90*91N93ZINTOA****COMP ZFMD,ZMTH            92                   S01195
     C***90*91*92ZDAYNO****SUB  ZINTO     ZDAYNO                          S01195
     C***90*91*92**********MOVE 'DE'      ZINDE                           S01195
     C*********************                                               S01195
     C***********ZDECR*****TAG                             ** ZDECR TAG **S01195
     C***92*95N97**********                                EXCL. NOT FOUNDS01195
     C*OR92 96 97ZDAYNO    SUB  1         ZDAYNO           INCLUDE FOUND  S01195
     C*********************GOTO ZFHCHK                                    S01195
     C*********************                                               S01195
     C***********ZFEND*****ENDSR                           * ZFEND ENDSR *S01195
     C*********************                                               S01195
     C********************************************************************
     C/EJECT
     C**
     C********************************************************************
     C**
     C**   ZDATE2 SR. TO CONVERT A DAY NUMBER TO DATE FORMATS.
     C**
     C**   THE YEAR 2000, BEING DIVISIBLE BY 400, IS A LEAP YEAR.
     C**
     C           ZDATE2    BEGSR                           *** ZDATE2 ***
     C**
     C**   CLEAR DATE FIELDS.
     C                     Z-ADD0         ZDATE   60
     C                     MOVEL'       ' ZADATE  7
     C**
     C**   CALCULATION TO DEFINE INPUT DAY NUMBER.
     C                     Z-ADDZDAYNO    ZDAYNO  50
     C**
     C**   DETERMINE YEAR NUMBER.
     C**
     C**   ADJUST DAY NUMBER IN CASE LAST DAY OF YEAR.
     C           ZDAYNO    SUB  1         ZDAYN1  50   99
     C   99                GOTO ZDEND2
     C**
     C**   CALCULATE NUMBER OF 4 YEAR SPANS SINCE 31/12/1971.
     C           ZDAYN1    DIV  1461      ZLYR    20
     C                     MVR            ZDAYN1           SAVE REMAINING
     C**                                                   DAYS
     C**   CALCULATE NUMBER OF REMAINING YEARS.
     C                     Z-ADD1         ZWRK2   20
     C           ZDTAG1    TAG                             ** ZDTAG1 TAG *
     C           ZDAYN1    COMP ZYDY,ZWRK2             90
     C  N90      ZWRK2     ADD  1         ZWRK2
     C  N90                GOTO ZDTAG1
     C           ZWRK2     SUB  1         ZWRK2          91LEAP YR, 91 ON
     C**
     C**   DECREMENT DAY NO. BY DAYS IN REMAINING YEARS.
     C  N91      ZDAYN1    SUB  ZYDY,ZWRK2ZDAYN1
     C**
     C**   CALCULATE ACTUAL YEAR NUMBER.
     C           ZLYR      MULT 4         ZWRK3   30
     C           ZWRK3     ADD  72        ZWRK3            BASE IS 1972
     C                     Z-ADDZWRK3     ZYEAR   20
     C           ZYEAR     ADD  ZWRK2     ZYEAR            YEAR
     C**
     C**   DETERMINE MONTH NUMBER.
     C**
     C**   ADJUST DAY NO. IN CASE LAST DAY OF LEAP YEAR FEBRUARY.
     C                     SETOF                     9293
     C   91      ZDAYN1    COMP 59                     9293
     C   91N92   ZDAYN1    SUB  1         ZDAYN1
     C**
     C**   CALCULATE MONTH NUMBER.
     C                     Z-ADD2         ZWRK2
     C           ZDTAG2    TAG                             ** ZDTAG2 TAG *
     C           ZDAYN1    COMP ZMDY,ZWRK2             94
     C  N94      ZWRK2     ADD  1         ZWRK2
     C  N94                GOTO ZDTAG2
     C           ZWRK2     SUB  1         ZWRK2
     C**
     C                     Z-ADDZWRK2     ZMTH    20       MONTH
     C**
     C**   DETERMINE DAY OF MONTH.
     C**
     C**   ADD BACK LAST DAY OF YEAR ADJUSTMENT.
     C           ZDAYN1    ADD  1         ZDAYN1
     C**
     C**   CALCULATE DAY OF MONTH.
     C           ZDAYN1    SUB  ZMDY,ZWRK2ZDAY    20       DAY
     C**
     C**   ADD BACK LEAP YEAR 29TH FEBUARY ADJUSTMENT, IF REQUIRED.
     C   93      ZDAY      ADD  1         ZDAY
     C**
     C**   FORMAT DATE, DDMMYY OR MMDDYY.
     C  N98                MOVELZDAY      ZWRK4   40
     C   98                MOVE ZDAY      ZWRK4
     C  N98                MOVE ZMTH      ZWRK4
     C   98                MOVELZMTH      ZWRK4
     C                     MOVELZWRK4     ZDATE
     C                     MOVE ZYEAR     ZDATE
     C**
     C**   FORMAT ALPHA DATE, DDMMMYY.
     C           ZDAY      COMP 10                     95
     C                     MOVELZDAY      ZWRK5   5
     C   95                MOVEL' '       ZWRK5
     C                     MOVE ZMNM,ZMTH ZWRK5
     C                     MOVELZWRK5     ZADATE
     C                     MOVE ZYEAR     ZADATE
     C**
     C           ZDEND2    ENDSR                           * ZDEND2 ENDSR*
     C************************************************************
     C/EJECT
     C********************************************************************
     C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
     C*   IND '99' IS SET BY AN OVERFLOW ERROR
     C*
     C           GLZADD    BEGSR                           *** GLZADD ****
     C*
     C                     Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT
     C   91                GOTO ZZAEND                     AMT = 0.BYPASS
     C*
     C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
     C                     Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
     C                     MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD
     C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
     C*
     C                     EXSR GLZSUM
     C           ZZAEND    ENDSR                           ** ZZAEND TAG *
     C*
     C********************************************************************
     C/EJECT
     C********************************************************************
     C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
     C*                        GLZADD, GLZSUB, GLZCMP.
     C*          PARAMETERS PASSED -
     C*                     I/P ZZAMTI ZZAMTD
     C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
     C*
     C           GLZSUM    BEGSR                           *** GLZSUM ****
     C*
     C                     Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
     C                     Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
     C                     SETOF                     919293
     C                     SETOF                     949599
     C*
     C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
     C           ZZAMTI    COMP 0                      9293
     C   93      ZZAMTD    COMP 0                      9293
     C   93                GOTO ZZSEND                     ZERO BYPASS
     C*
     C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
     C           ZZTOTI    COMP 0                      9193
     C   93      ZZTOTD    COMP 0                      9193
     C*
     C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
     C   93                Z-ADDZZAMTI    ZZTOTI
     C   93                Z-ADDZZAMTD    ZZTOTD
     C   93                GOTO ZZSEND                     ZERO BYPASS
     C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
     C   91N92
     CORN91 92             GOTO ZZOFPS
     C*
     C           ZZAMTD    ADD  ZZTOTD    ZZWK2   40
     C           ZZWK2     COMP 999                  93    '93' = CARRY
     C  N93      ZZWK2     COMP -999                   93    INTO INTEGER.
     C*
     C   93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
     C      93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
     C   93      ZZTOTI    ADD  ZZWK3     ZZWK3
     C  N93      ZZTOTI    ADD  ZZAMTI    ZZWK3
     C*
     C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
     C  N92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
     C   92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
     C  N99                Z-ADDZZWK2     ZZTOTD
     C  N99                Z-ADDZZWK3     ZZTOTI
     C*
     C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
     C   99                Z-ADD0         ZZAMT  153
     C                     GOTO ZZSEND
     C*
     C* THE 'SIGNS' ARE DIFFERENT
     C           ZZOFPS    TAG                             ** ZZOFPS TAG**
     C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
     C*
     C   92                Z-SUBZZAMTI    ZZAMTI 150
     C   92                Z-SUBZZAMTD    ZZAMTD  30
     C*
     C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
     C*
     C   91                Z-SUBZZTOTI    ZZTOTI
     C   91                Z-SUBZZTOTD    ZZTOTD
     C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
     C*
     C           ZZTOTI    COMP ZZAMTI               93  95
     C   95      ZZTOTD    COMP ZZAMTD               93  95
     C*
     C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
     C   95                Z-ADD0         ZZTOTI
     C   95                Z-ADD0         ZZTOTD
     C   95                GOTO ZZSEND
     C*
     C* IF ZZTOT GT. ZZAMT.
     C   93      ZZAMTD    COMP ZZTOTD               94
     C   93 94   ZZTOTI    SUB  1         ZZTOTI
     C   93 94   ZZTOTD    ADD  1000      ZZWK2
     C   93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
     C   93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
     C   93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
     C*
     C* IF ZZAMT GT. ZZTOT.
     C  N93      ZZTOTD    COMP ZZAMTD               94
     C  N93 94   ZZAMTI    SUB  1         ZZWK3  150
     C  N93 94   ZZAMTD    ADD  1000      ZZWK2
     C  N93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
     C  N93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
     C  N93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
     C  N93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
     C*
     C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
     C                     SETOF                     94
     C   93 91
     CORN93 92             SETON                     94
     C   94                Z-SUBZZTOTI    ZZTOTI
     C   94                Z-SUBZZTOTD    ZZTOTD
     C**
     C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
     C   92                Z-SUBZZAMTI    ZZAMTI
     C   92                Z-SUBZZAMTD    ZZAMTD
     C           ZZSEND    TAG                             ** ZZSEND TAG *
     C**
     C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
     C                     SETOF                     96
     C           ZZTOTD    COMP 0                        91
     C   91      ZZTOTI    COMP 0                      96
     C   96                MOVE '.000-'   ZZNEGD  5
     C                     ENDSR                             ** ENDSR **
     C********************************************************************
     C/COPY WNCPYSRC,FT0040C081
     C/COPY ZSRSRC,ZACCH                                                  S01195
     C/COPY ZSRSRC,ZCHKH                                                  S01195
      *                                                                   CRT002
     C/COPY ZSRSRC,ZEDITZ2                                                CRT002
      **  SR.ZEDIT subroutine                                             CRT002
      *                                                                   CRT002
     C/COPY FTCPYSRC,SFTSWFTC                                             068230
     C/COPY WNCPYSRC,FT0040DCPG                                           S01435
      *                                                                   S01435
      *  /Copy point for Calculations                                     S01435
      *                                                                   S01435
      *  Map Translated data for Outgoing BOJ messages                    CFT002
      *================================================================   CFT002
      *                                                                   CFT002
     C           SROCLR    BEGSR                                          CFT002
      *                                                                   CFT012
      ** In cross currency transfer the settlement currency is            CFT012
      ** defaulted therefore, unknown.                                    CFT012
      ** So all the tags candidate for the CR part of the translation     CFT012
      ** need to be tested against the PAYMENT currency.                  CFT012
      ** In all the tags candidate for the DR part of the translation     CFT012
      ** we removed tests against the SETTLEMENT currency                 CFT012
     C           *LIKE     DEFN SSMCY     WMGCCY                          CFT012
     C           CFT012    IFEQ 'Y'                                       CFT012
     C                     MOVELSPCCY     WMGCCY                          CFT012
     C                     ELSE                                           CFT012
     C                     MOVELSSMCY     WMGCCY                          CFT012
     C                     ENDIF                                          CFT012
      *                                                                   CFT002
      * Set up the detail screen fields from the message.                 CFT002
      *                                                                   CFT002
      *                                                                   CGL009
      * Ordering Customer                                                 CGL009
      *                                                                   CGL009
     C                     SELEC                                          CGL009
      *                                                                   CGL009
     C           PNWRK     WHEQ 'FONTIS'                                  CGL009
      ** Translation is not working for ordering customer                 CGL009
      ** Use part translated of P53 to map SORC                           CGL009
      ** Do something                                                     CGL009
     C                     OTHER                                          CGL009
     C           P50       IFNE *BLANKS                                   CGL009
      ** Do something                                                     CGL009
     C                     ENDIF                                          CGL009
     C                     ENDSL                                          CGL009
      *                                                                   CFT002
      * If no Intermediary Bank then copy over P57 to Account with        CFT002
      * bank                                                              CFT002
      *                                                                   CFT002
     C           P56       IFEQ *BLANKS                                   CFT002
     C           P57       ANDNE*BLANKS                                   CFT002
     C                     MOVELP57       DSTRAN                          CFT002
     C                     MOVELTMLIN1    ACB1                            CFT002
     C                     MOVELTMLIN2    ACB2                            CFT002
     C                     MOVELTMLIN3    ACB3                            CFT002
     C                     MOVELTMLIN4    ACB4                            CFT002
     C                     MOVELTMLIN5    ACB5                            CFT002
     C                     END                                            CFT002
      *                                                                   CFT002
      * If Intermediary Bank then copy over P56 to Intermediary           CFT002
      * bank                                                              CFT002
      *                                                                   CFT002
     C           P56       IFNE *BLANKS                                   CFT002
     C                     MOVELP56       DSTRAN                          CFT002
     C                     MOVELTMLIN1    INB1                            CFT002
     C                     MOVELTMLIN2    INB2                            CFT002
     C                     MOVELTMLIN3    INB3                            CFT002
     C                     MOVELTMLIN4    INB4                            CFT002
     C                     MOVELTMLIN5    INB5                            CFT002
     C                     END                                            CFT002
      *                                                                   CFT002
      * Destination                                                       CFT002
      *                                                                   CFT002
      * Intermediary Bank                                                 CFT002
      *                                                                   CFT002
     C           P56       IFNE *BLANKS                                   CFT002
     C                     MOVELP56       DSTRAN                          CFT002
     C           TRCODE    IFNE *BLANKS                                   CFT002
     C                     MOVE TRCODE    TRCDE2                          CFT002
     C                     MOVELINB1      INBCH1  1                       CFT002
     C           INBCH1    IFEQ '/'                                       CFT002
     C                     MOVELTRCNUM    INB2                            CFT002
     C                     ELSE                                           CFT002
     C                     MOVE *BLANKS   INB1                            CFT002
     C                     MOVELTRCNUM    INB1                            CFT002
     C                     MOVE *BLANKS   INB2                            CFT002
     C                     END                                            CFT002
     C                     MOVE *BLANKS   INB3                            CFT002
     C                     MOVE *BLANKS   INB4                            CFT002
     C                     END                                            CFT002
     C                     END                                            CFT002
      *                                                                   CFT002
      * Account with Bank - use A/C with bank if entered else use         CFT002
      * Intermediary bank if entered else use Beneficiary                 CFT002
      *                                                                   CFT002
     C                     MOVE *BLANKS   DSTRAN                          CFT002
     C           P57       IFNE *BLANKS                                   CFT002
     C                     MOVELP57       DSTRAN                          CFT002
     C                     ELSE                                           CFT002
     C           P56       IFNE *BLANKS                                   CFT002
     C                     MOVELP56       DSTRAN                          CFT002
     C                     ELSE                                           CFT002
     C           P58       IFNE *BLANKS                                   CFT002
     C                     MOVELP58       DSTRAN                          CFT002
     C                     END                                            CFT002
     C                     END                                            CFT002
     C                     END                                            CFT002
      *                                                                   CFT002
     C           DSTRAN    IFNE *BLANKS                                   CFT002
     C           TRCODE    ANDNE*BLANKS                                   CFT002
     C                     MOVE TRCODE    TRCDE2                          CFT002
     C                     MOVELTMLIN1    ACBCH1  1                       CFT002
     C           ACBCH1    IFEQ '/'                                       CFT002
     C                     MOVELTRCNUM    ACB2                            CFT002
     C                     ELSE                                           CFT002
     C                     MOVE *BLANKS   ACB1                            CFT002
     C                     MOVELTRCNUM    ACB1                            CFT002
     C                     MOVE *BLANKS   ACB2                            CFT002
     C                     END                                            CFT002
     C                     MOVE *BLANK    ACB3                            CFT002
     C                     MOVE *BLANK    ACB4                            CFT002
     C                     MOVE *BLANK    ACB5                            CFT002
     C                     END                                            CFT002
      *                                                                   CFT002
      * Ordering Bank                                                     CFT002
     C                     SELEC                                          CGL009
      ** Special case for FONTIS                                          CGL009
     C           PNWRK     WHEQ 'FONTIS'                                  CGL009
      ** Ordering bank is never filled  in FONTIS                         CGL009
      *                                                                   CGL009
      ** Other Networks                                                   CGL009
     C                     OTHER                                          CGL009
      * If Third Reimbursement Institution is not blank, use it           CFT014
      * otherwise                                                         CFT014
      *                                                                   CFT002
      * If Receivers Correspondent is not blank, use it                   CFT002
      * otherwise use Senders Correspondent. If both are blank            CFT002
      * use Sender details.                                               CFT002
      * Use Third Reimb Institution details                               CFT014
     C           P55       IFNE *BLANKS                                   CFT014
     C                     MOVELP55       DSTRAN                          CFT014
     C                     MOVEL*BLANKS   SORBB                           CFT014
     C           TRCODE    IFNE *BLANKS                                   CFT014
     C                     MOVE TRCODE    TRCDE2                          CFT014
     C           TRCYCD    IFEQ *BLANKS                                   CFT014
     C                     MOVE *BLANKS   SORBK                           CFT014
     C                     MOVELTRCNUM    SORBK                           CFT014
     C                     ELSE                                           CFT014
      ** Translate to nostro and retail account numbers                   CFT014
     C                     EXSR SRTRAN                                    CFT014
     C                     SELEC                                          CFT014
      ** If local and account currency local then use retail number       CFT014
      ** Save if CFT012 is on                                             CFT014
     C           BJLCCY    WHEQ SSMCY                                     CFT014
     C           TRCYCD    ANDEQSSMCY                                     CFT014
     C           ##ACNO    ANDNE0                                         CFT014
     C           CFT012    ANDEQ'N'                                       CFT014
     C                     MOVEL*BLANKS   SORBK                           CFT014
     C                     MOVEL##ACNO    SORBK                           CFT014
     C           ##ACNO    WHNE 0                                         CFT014
     C           CFT012    ANDEQ'Y'                                       CFT014
     C                     MOVEL*BLANKS   SORBK                           CFT014
     C                     MOVEL##ACNO    SORBK                           CFT014
     C                     MOVELTRCYCD    SSMCY                           CFT014
      ** If currency the same as settle and nostro, use nostro            CFT014
      ** Save if CFT012 on                                                CFT014
     C           ##NCCY    WHEQ SSMCY                                     CFT014
     C           ##NONB    ANDNE*BLANKS                                   CFT014
     C           CFT012    ANDEQ'N'                                       CFT014
     C                     MOVEL*BLANKS   SORBK                           CFT014
     C                     MOVEL##NONB    SORBK                           CFT014
     C           ##NONB    WHNE *BLANKS                                   CFT014
     C           CFT012    ANDEQ'Y'                                       CFT014
     C                     MOVEL*BLANKS   SORBK                           CFT014
     C                     MOVEL##NONB    SORBK                           CFT014
     C                     MOVEL##NCCY    SSMCY                           CFT014
      ** If currency the same use GL Account                              CFT014
      ** Save if CFT012 on                                                CFT014
     C           TRCYCD    WHEQ SSMCY                                     CFT014
     C           CFT012    ANDEQ'N'                                       CFT014
     C           TRCNUM    CAT  TRCDSQ    SORBK                           CFT014
     C           @MBIN     IFEQ 'Y'                                       CFT014
     C                     MOVE TRBRCD    SORBB                           CFT014
     C                     ENDIF                                          CFT014
     C           CFT012    WHEQ 'Y'                                       CFT014
     C           TRCYCD    ANDNE*BLANK                                    CFT014
     C           TRCDSQ    ANDNE*BLANK                                    CFT014
     C           TRCNUM    CAT  TRCDSQ    SORBK                           CFT014
     C           @MBIN     IFEQ 'Y'                                       CFT014
     C                     MOVE TRBRCD    SORBB                           CFT014
     C                     ENDIF                                          CFT014
     C                     MOVELTRCYCD    SSMCY                           CFT014
      ** Use customer number                                              CFT014
     C                     OTHER                                          CFT014
     C                     MOVEL*BLANKS   SORBK                           CFT014
     C                     MOVELTRCODE    TRCDE2                          CFT014
     C                     MOVELTRCNUM    SORBK                           CFT014
     C                     ENDSL                                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
     C                     ELSE                                           CFT014
      ** Use Receiver's Correspondant details                             CFT014
      *                                                                   CFT002
     C           P54       IFNE *BLANKS                                   CFT002
      *                                                                   CFT002
     C                     MOVELP54       DSTRAN                          CFT002
     C           TRCODE    IFNE *BLANKS                                   CFT002
     C                     MOVE TRCODE    TRCDE2                          CFT002
     C           TRCYCD    IFEQ *BLANKS                                   CFT002
     C                     MOVE *BLANKS   SORBK                           CFT002
     C                     MOVELTRCNUM    SORBK                           CFT002
     C                     ELSE                                           CFT002
      *                                                                   CFT002
      * Translate to nostro and retail account numbers                    CFT002
      *                                                                   CFT002
     C                     EXSR SRTRAN                                    CFT002
     C                     SELEC                                          CFT002
      *                                                                   CFT002
      * If local and account currency local then use retail number        CFT002
      * Save if CFT012 is on                                              CFT012
      *                                                                   CFT002
     C           BJLCCY    WHEQ SSMCY                                     CFT002
     C           TRCYCD    ANDEQSSMCY                                     CFT002
     C           ##ACNO    ANDNE0                                         CFT002
     C           CFT012    ANDEQ'N'                                       CFT012
     C                     MOVE *BLANKS   SORBK                           CFT002
     C                     MOVEL##ACNO    SORBK                           CFT002
      *                                                                   CFT012
     C           ##ACNO    WHNE 0                                         CFT012
     C           CFT012    ANDEQ'Y'                                       CFT012
     C                     MOVEL*BLANKS   SORBK                           CFT012
     C                     MOVEL##ACNO    SORBK                           CFT012
     C                     MOVELTRCYCD    SSMCY                           CFT012
      *                                                                   CFT002
      * If currency the same as settle and nostro, use nostro             CFT002
      * Save if CFT012 is on                                              CFT012
      *                                                                   CFT002
     C           ##NCCY    WHEQ SSMCY                                     CFT002
     C           ##NONB    ANDNE*BLANKS                                   CFT002
     C           CFT012    ANDEQ'N'                                       CFT012
     C                     MOVE *BLANKS   SORBK                           CFT002
     C                     MOVEL##NONB    SORBK                           CFT002
      *                                                                   CFT012
     C           ##NONB    WHNE *BLANKS                                   CFT012
     C           CFT012    ANDEQ'Y'                                       CFT012
     C                     MOVEL*BLANKS   SORBK                           CFT012
     C                     MOVEL##NONB    SORBK                           CFT012
     C                     MOVEL##NCCY    SSMCY                           CFT012
      *                                                                   CFT002
      * If currency the same use GL Account                               CFT002
      * Save if CFT012 is on                                              CFT012
      *                                                                   CFT002
     C           TRCYCD    WHEQ SSMCY                                     CFT002
     C           CFT012    ANDEQ'N'                                       CFT012
     C           TRCNUM    CAT  TRCDSQ    SORBK                           CFT002
     C           @MBIN     IFEQ 'Y'                                       CFT002
     C                     MOVE TRBRCD    SORBB                           CFT002
     C                     END                                            CFT002
      *                                                                   CFT012
     C           CFT012    WHEQ 'Y'                                       CFT012
     C           TRCYCD    ANDNE*BLANK                                    CFT012
     C           TRCDSQ    ANDNE*BLANK                                    CFT012
     C           TRCNUM    CAT  TRCDSQ    SORBK                           CFT012
     C           @MBIN     IFEQ 'Y'                                       CFT012
     C                     MOVE TRBRCD    SORBB                           CFT012
     C                     ENDIF                                          CFT012
     C                     MOVELTRCYCD    SSMCY                           CFT012
      *                                                                   CFT002
      * Use customer number                                               CFT002
      *                                                                   CFT002
     C                     OTHER                                          CFT002
     C                     MOVE *BLANKS   SORBK                           CFT002
     C                     MOVE TRCODE    TRCDE2                          CFT002
     C                     MOVELTRCNUM    SORBK                           CFT002
     C                     ENDSL                                          CFT002
     C/COPY WNCPYSRC,FT0040C204
     C                     END                                            CFT002
     C                     END                                            CFT002
     C/COPY WNCPYSRC,FT0040C205
      *                                                                   CFT002
     C                     ELSE                                           CFT002
     C/COPY WNCPYSRC,FT0040C206
      *                                                                   CFT002
     C           P53       IFNE *BLANKS                                   CFT002
     C                     MOVELP53       DSTRAN                          CFT002
     C           TRCODE    IFNE *BLANKS                                   CFT002
     C                     MOVE TRCODE    TRCDE2                          CFT002
     C           TRCYCD    IFEQ *BLANKS                                   CFT002
     C                     MOVE *BLANKS   SORBK                           CFT002
     C                     MOVELTRCNUM    SORBK                           CFT002
     C                     ELSE                                           CFT002
      *                                                                   CFT002
      * Translate to nostro and retail account numbers                    CFT002
      *                                                                   CFT002
     C                     EXSR SRTRAN                                    CFT002
     C                     SELEC                                          CFT002
      *                                                                   CFT002
      * If local and account currency local then use retail number        CFT002
      * Save if CFT012 is on                                              CFT012
      *                                                                   CFT002
     C           BJLCCY    WHEQ SSMCY                                     CFT002
     C           TRCYCD    ANDEQSSMCY                                     CFT002
     C           ##ACNO    ANDNE0                                         CFT002
     C           CFT012    ANDEQ'N'                                       CFT012
     C                     MOVE *BLANKS   SORBK                           CFT002
     C                     MOVEL##ACNO    SORBK                           CFT002
      *                                                                   CFT012
     C           ##ACNO    WHNE 0                                         CFT012
     C           CFT012    ANDEQ'Y'                                       CFT012
     C                     MOVEL*BLANKS   SORBK                           CFT012
     C                     MOVEL##ACNO    SORBK                           CFT012
     C                     MOVELTRCYCD    SSMCY                           CFT012
      *                                                                   CFT002
      * If currency the same as settle and nostro, use nostro             CFT002
      * Save if CFT012 is on                                              CFT012
      *                                                                   CFT002
     C           ##NCCY    WHEQ SSMCY                                     CFT002
     C           ##NONB    ANDNE*BLANKS                                   CFT002
     C           CFT012    ANDEQ'N'                                       CFT012
     C                     MOVE *BLANKS   SORBK                           CFT002
     C                     MOVEL##NONB    SORBK                           CFT002
      *                                                                   CFT012
     C           ##NONB    WHNE *BLANKS                                   CFT012
     C           CFT012    ANDEQ'Y'                                       CFT012
     C                     MOVEL*BLANKS   SORBK                           CFT012
     C                     MOVEL##NONB    SORBK                           CFT012
     C                     MOVEL##NCCY    SSMCY                           CFT012
      *                                                                   CFT002
      * If currency the same use GL Account                               CFT002
      * Save if CFT012 is on                                              CFT012
      *                                                                   CFT002
     C           TRCYCD    WHEQ SSMCY                                     CFT002
     C           CFT012    ANDEQ'N'                                       CFT012
     C           TRCNUM    CAT  TRCDSQ    SORBK                           CFT002
     C           @MBIN     IFEQ 'Y'                                       CFT002
     C                     MOVE TRBRCD    SORBB                           CFT002
     C                     END                                            CFT002
      *                                                                   CFT012
     C           CFT012    WHEQ 'Y'                                       CFT012
     C           TRCYCD    ANDNE*BLANK                                    CFT012
     C           TRCDSQ    ANDNE*BLANK                                    CFT012
     C           TRCNUM    CAT  TRCDSQ    SORBK                           CFT012
     C           @MBIN     IFEQ 'Y'                                       CFT012
     C                     MOVELTRBRCD    SORBB                           CFT012
     C                     ENDIF                                          CFT012
     C                     MOVELTRCYCD    SSMCY                           CFT012
      *                                                                   CFT002
      * Use customer number                                               CFT002
      *                                                                   CFT002
     C                     OTHER                                          CFT002
     C                     MOVE *BLANKS   SORBK                           CFT002
     C                     MOVE TRCODE    TRCDE2                          CFT002
     C                     MOVELTRCNUM    SORBK                           CFT002
     C                     ENDSL                                          CFT002
     C/COPY WNCPYSRC,FT0040C207
     C                     END                                            CFT002
     C                     ELSE                                           CFT002
      *                                                                   CFT002
      * If TRTAG is :53B: and no account map account from sender          CFT002
      *                                                                   CFT002
     C           TRTAG     IFEQ ':53B:'                                   CFT002
     C           PNWRK     ANDEQ'SWIFT'                                   CFT002
     C           PSN       IFNE *BLANKS                                   CFT002
     C                     MOVELPSN       DSTRAN                          CFT002
     C           TRCODE    IFNE *BLANKS                                   CFT002
     C                     MOVE TRCODE    TRCDE2                          CFT002
     C           TRCYCD    IFEQ *BLANKS                                   CFT002
     C                     MOVE *BLANKS   SORBK                           CFT002
     C                     MOVELTRCNUM    SORBK                           CFT002
     C                     ELSE                                           CFT002
      *                                                                   CFT002
      * Translate to nostro and retail account numbers                    CFT002
      *                                                                   CFT002
     C                     EXSR SRTRAN                                    CFT002
     C                     SELEC                                          CFT002
      *                                                                   CFT002
      * If local and account currency local then use retail number        CFT002
      * Save if CFT012 is on                                              CFT012
      *                                                                   CFT002
     C           BJLCCY    WHEQ SSMCY                                     CFT002
     C           TRCYCD    ANDEQSSMCY                                     CFT002
     C           ##ACNO    ANDNE0                                         CFT002
     C           CFT012    ANDEQ'N'                                       CFT012
     C                     MOVE *BLANKS   SORBK                           CFT002
     C                     MOVEL##ACNO    SORBK                           CFT002
      *                                                                   CFT012
     C           ##ACNO    WHNE 0                                         CFT012
     C           CFT012    ANDEQ'Y'                                       CFT012
     C                     MOVEL*BLANKS   SORBK                           CFT012
     C                     MOVEL##ACNO    SORBK                           CFT012
     C                     MOVELTRCYCD    SSMCY                           CFT012
      *                                                                   CFT002
      * If currency the same as settle and nostro, use nostro             CFT002
      * Save if CFT012 is on                                              CFT012
      *                                                                   CFT002
     C           ##NCCY    WHEQ SSMCY                                     CFT002
     C           ##NONB    ANDNE*BLANKS                                   CFT002
     C           CFT012    ANDEQ'N'                                       CFT012
     C                     MOVE *BLANKS   SORBK                           CFT002
     C                     MOVEL##NONB    SORBK                           CFT002
      *                                                                   CFT012
     C           ##NONB    WHNE *BLANKS                                   CFT012
     C           CFT012    ANDEQ'Y'                                       CFT012
     C                     MOVEL*BLANKS   SORBK                           CFT012
     C                     MOVEL##NONB    SORBK                           CFT012
     C                     MOVEL##NCCY    SSMCY                           CFT012
      *                                                                   CFT002
      * If currency the same use GL Account                               CFT002
      * Save if CFT012 is on                                              CFT012
      *                                                                   CFT002
     C           TRCYCD    WHEQ SSMCY                                     CFT002
     C           CFT012    ANDEQ'N'                                       CFT012
     C           TRCNUM    CAT  TRCDSQ    SORBK                           CFT002
     C           @MBIN     IFEQ 'Y'                                       CFT002
     C                     MOVE TRBRCD    SORBB                           CFT002
     C                     END                                            CFT002
      *                                                                   CFT012
     C           CFT012    WHEQ 'Y'                                       CFT012
     C           TRCYCD    ANDNE*BLANK                                    CFT012
     C           TRCDSQ    ANDNE*BLANK                                    CFT012
     C           TRCNUM    CAT  TRCDSQ    SORBK                           CFT012
     C           @MBIN     IFEQ 'Y'                                       CFT012
     C                     MOVELTRBRCD    SORBB                           CFT012
     C                     ENDIF                                          CFT012
     C                     MOVELTRCYCD    SSMCY                           CFT012
      *                                                                   CFT002
      * Use customer number                                               CFT002
      *                                                                   CFT002
     C                     OTHER                                          CFT002
     C                     MOVE *BLANKS   SORBK                           CFT002
     C                     MOVE TRCODE    TRCDE2                          CFT002
     C                     MOVELTRCNUM    SORBK                           CFT002
     C                     ENDSL                                          CFT002
     C/COPY WNCPYSRC,FT0040C208
     C                     END                                            CFT002
     C                     END                                            CFT002
     C                     ELSE                                           CFT002
     C                     MOVE *BLANKS   SORBK                           CFT002
     C                     MOVELPSNDR     SORBK                           CFT002
     C                     END                                            CFT002
     C                     END                                            CFT002
     C                     END                                            CFT002
     C/COPY WNCPYSRC,FT0040C209
      *                                                                   CFT002
     C                     ELSE                                           CFT002
     C/COPY WNCPYSRC,FT0040C210
      ** Use Sender details                                               CFT014
      *                                                                   CFT002
     C           PSN       IFNE *BLANKS                                   CFT002
     C                     MOVELPSN       DSTRAN                          CFT002
     C/COPY WNCPYSRC,FT0040C226
     C           TRCODE    IFNE *BLANKS                                   CFT002
     C                     MOVE TRCODE    TRCDE2                          CFT002
     C           TRCYCD    IFEQ *BLANKS                                   CFT002
     C                     MOVE *BLANKS   SORBK                           CFT002
     C                     MOVELTRCNUM    SORBK                           CFT002
     C                     ELSE                                           CFT002
      *                                                                   CFT002
      * Translate to nostro and retail account numbers                    CFT002
      *                                                                   CFT002
     C                     EXSR SRTRAN                                    CFT002
     C                     SELEC                                          CFT002
      *                                                                   CFT002
      * If local and account currency local then use retail number        CFT002
      * Save if CFT012 is on                                              CFT012
      *                                                                   CFT002
     C           BJLCCY    WHEQ SSMCY                                     CFT002
     C           TRCYCD    ANDEQSSMCY                                     CFT002
     C           ##ACNO    ANDNE0                                         CFT002
     C           CFT012    ANDEQ'N'                                       CFT012
     C                     MOVE *BLANKS   SORBK                           CFT002
     C                     MOVEL##ACNO    SORBK                           CFT002
      *                                                                   CFT012
     C           ##ACNO    WHNE 0                                         CFT012
     C           CFT012    ANDEQ'Y'                                       CFT012
     C                     MOVEL*BLANKS   SORBK                           CFT012
     C                     MOVEL##ACNO    SORBK                           CFT012
     C                     MOVELTRCYCD    SSMCY                           CFT012
      *                                                                   CFT002
      * If currency the same as settle and nostro, use nostro             CFT002
      * Save if CFT012 is on                                              CFT012
      *                                                                   CFT002
     C           ##NCCY    WHEQ SSMCY                                     CFT002
     C           ##NONB    ANDNE*BLANKS                                   CFT002
     C           CFT012    ANDEQ'N'                                       CFT012
     C                     MOVE *BLANKS   SORBK                           CFT002
     C                     MOVEL##NONB    SORBK                           CFT002
      *                                                                   CFT012
     C           ##NONB    WHNE *BLANKS                                   CFT012
     C           CFT012    ANDEQ'Y'                                       CFT012
     C                     MOVEL*BLANKS   SORBK                           CFT012
     C                     MOVEL##NONB    SORBK                           CFT012
     C                     MOVEL##NCCY    SSMCY                           CFT012
      *                                                                   CFT002
      * If currency the same use GL Account                               CFT002
      * Save if CFT012 is on                                              CFT012
      *                                                                   CFT002
     C           TRCYCD    WHEQ SSMCY                                     CFT002
     C           CFT012    ANDEQ'N'                                       CFT012
     C           TRCNUM    CAT  TRCDSQ    SORBK                           CFT002
     C           @MBIN     IFEQ 'Y'                                       CFT002
     C                     MOVE TRBRCD    SORBB                           CFT002
     C                     END                                            CFT002
      *                                                                   CFT002
     C           CFT012    WHEQ 'Y'                                       CFT012
     C           TRCYCD    ANDNE*BLANK                                    CFT012
     C           TRCDSQ    ANDNE*BLANK                                    CFT012
     C           TRCNUM    CAT  TRCDSQ    SORBK                           CFT012
     C           @MBIN     IFEQ 'Y'                                       CFT012
     C                     MOVELTRBRCD    SORBB                           CFT012
     C                     ENDIF                                          CFT012
     C                     MOVELTRCYCD    SSMCY                           CFT012
      *                                                                   CFT002
      * Use customer number                                               CFT002
      *                                                                   CFT002
     C                     OTHER                                          CFT002
     C                     MOVE *BLANKS   SORBK                           CFT002
     C                     MOVE TRCODE    TRCDE2                          CFT002
     C                     MOVELTRCNUM    SORBK                           CFT002
     C                     ENDSL                                          CFT002
     C                     END                                            CFT002
     C                     END                                            CFT002
     C                     ELSE                                           CFT002
     C                     MOVE *BLANKS   SORBK                           CFT002
     C                     MOVELPSNDR     SORBK                           CFT002
     C                     END                                            CFT002
     C                     END                                            CFT002
     C/COPY WNCPYSRC,FT0040C211
     C                     END                                            CFT002
     C/COPY WNCPYSRC,FT0040C212
     C                     ENDIF                                          CFT014
      *                                                                   CGL009
     C                     ENDSL                                          CGL009
      *                                                                   CFT002
      *  Beneficiary Institution/ Beneficiary Customer                    CFT002
      *                                                                   CFT002
     C           P58       IFNE *BLANKS                                   CFT002
     C                     MOVELP58       DSTRAN                          CFT002
     C           TRCODE    IFNE *BLANKS                                   CFT002
     C                     MOVELTMLIN1    BNCTAG  1                       CFT002
     C           BNCTAG    IFEQ '/'                                       CFT002
     C                     MOVE *BLANKS   BNC1                            CFT002
     C                     MOVELTMLIN1    BNC1                            CFT002
     C                     MOVE *BLANKS   BNC2                            CFT002
     C                     MOVE TRCODE    TRCDE2                          CFT002
     C                     MOVELTRCNUM    BNC2                            CFT002
     C                     ELSE                                           CFT002
     C                     MOVE *BLANKS   BNC1                            CFT002
     C                     MOVE TRCODE    TRCDE2                          CFT002
     C                     MOVELTRCNUM    BNC1                            CFT002
     C                     MOVEL*BLANKS   BNC2                            CFT002
     C                     END                                            CFT002
     C                     MOVEL*BLANKS   BNC3                            CFT002
     C                     MOVEL*BLANKS   BNC4                            CFT002
     C                     MOVEL*BLANKS   BNC5                            CFT002
     C                     END                                            CFT002
     C                     END                                            CFT002
      *                                                                   CFT002
     C           P59       IFNE *BLANKS                                   CFT002
     C                     MOVELP59       DSTRAN                          CFT002
     C           TRCODE    IFNE *BLANKS                                   CFT002
     C                     MOVELTMLIN1    BNCTAG  1                       CFT002
     C           BNCTAG    IFEQ '/'                                       CFT002
     C                     MOVE *BLANKS   BNC1                            CFT002
     C                     MOVELTMLIN1    BNC1                            CFT002
     C                     MOVE *BLANKS   BNC2                            CFT002
     C                     MOVE TRCODE    TRCDE2                          CFT002
     C                     MOVELTRCNUM    BNC2                            CFT002
     C                     ELSE                                           CFT002
     C                     MOVE *BLANKS   BNC1                            CFT002
     C                     MOVE TRCODE    TRCDE2                          CFT002
     C                     MOVELTRCNUM    BNC1                            CFT002
     C                     MOVEL*BLANKS   BNC2                            CFT002
     C                     END                                            CFT002
     C                     MOVEL*BLANKS   BNC3                            CFT002
     C                     MOVEL*BLANKS   BNC4                            CFT002
     C                     MOVEL*BLANKS   BNC5                            CFT002
     C                     END                                            CFT002
     C                     END                                            CFT002
      *                                                                   CFT002
      * Bank to Bank Information                                          CFT002
      *                                                                   CFT002
      * If through payment, the bank to bank information has to be        CFT002
      * carried forward to next outgoing message.                         CFT002
      * (For Swift network only)                                          CFT002
      * (For Fontis network only)                                         CGL009
      *                                                                   CFT002
     C                     MOVE *BLANK    W0BTOB  1                       CFT002
     C           PNWRK     IFEQ 'SWIFT'                                   CFT002
     C           PNWRK     OREQ 'FONTIS'                                  CGL009
     C/COPY WNCPYSRC,FT0040C124
     C                     MOVE 'Y'       W0BTOB                          CFT002
     C                     END                                            CFT002
      *                                                                   CFT002
     C           W0BTOB    IFEQ 'Y'                                       CFT002
     C           P72       IFNE *BLANKS                                   CFT002
      *                                                                   CFT002
     C                     SELEC                                          CGL009
      ** Special rule for FONTIS                                          CGL009
     C           PNWRK     WHEQ 'FONTIS'                                  CGL009
     C*                                                                   CGL009
     C                     EXSR ICCHK                                     CGL009
     C*                                                                   CGL009
     C                     MOVELP72       DSFONT                          CGL009
     C           FOUND     IFEQ 'Y'                                       CGL009
     C                     MOVEL*BLANK    BBI6                            CGL009
     C                     MOVELFN72L2    BBI1                            CGL009
     C                     MOVELFN72L3    BBI2                            CGL009
     C                     MOVELFN72L4    BBI3                            CGL009
     C                     MOVELFN72L5    BBI4                            CGL009
     C                     MOVELFN72L6    BBI5                            CGL009
     C                     ELSE                                           CGL009
     C                     MOVELFN72L1    BBI1                            CGL009
     C                     MOVELFN72L2    BBI2                            CGL009
     C                     MOVELFN72L3    BBI3                            CGL009
     C                     MOVELFN72L4    BBI4                            CGL009
     C                     MOVELFN72L5    BBI5                            CGL009
     C                     MOVELFN72L6    BBI6                            CGL009
     C                     ENDIF                                          CGL009
      ** Other Networks                                                   CGL009
     C                     OTHER                                          CGL009
     C                     MOVELP72       DSTRAN                          CFT002
     C                     MOVELTMLIN1    BBI1                            CFT002
     C                     MOVELTMLIN2    BBI2                            CFT002
     C                     MOVELTMLIN3    BBI3                            CFT002
     C                     MOVELTMLIN4    BBI4                            CFT002
     C                     MOVELTMLIN5    BBI5                            CFT002
     C                     MOVELTMLIN6    BBI6                            CFT002
      *                                                                   CGL009
     C                     ENDSL                                          CGL009
      *                                                                   CFT002
     C                     END                                            CFT002
     C           P70       IFNE *BLANKS                                   CFT002
      *                                                                   CFT002
     C                     MOVELP70       DSTRAN                          CFT002
     C                     MOVELTMLIN1    DTP1                            CFT002
     C                     MOVELTMLIN2    DTP2                            CFT002
     C                     MOVELTMLIN3    DTP3                            CFT002
     C                     MOVELTMLIN4    DTP4                            CFT002
      *                                                                   CFT002
     C                     END                                            CFT002
     C                     END                                            CFT002
      *                                                                   CFT002
      *                                                                   CFT002
     C           EXOCLR    ENDSR                                          CFT002
      *================================================================   CFT002
      *                                                                   CFT002
      /EJECT                                                              CFT002
      *================================================================   CFT002
      *  Map translated data for Outgoing SWIFT messages                  CFT002
      *================================================================   CFT002
      *                                                                   CFT002
     C           SROSWT    BEGSR                                          CFT002
      *                                                                   CFT012
      ** In cross currency transfer the settlement currency is            CFT012
      ** defaulted therefore, unknown.                                    CFT012
      ** So all the tags candidate for the CR part of the translation     CFT012
      ** need to be tested against the PAYMENT currency.                  CFT012
      ** In all the tags candidate for the DR part of the translation     CFT012
      ** we removed tests against the SETTLEMENT currency                 CFT012
     C           CFT012    IFEQ 'Y'                                       CFT012
     C                     MOVELSPCCY     WMGCCY                          CFT012
     C                     ELSE                                           CFT012
     C                     MOVELSSMCY     WMGCCY                          CFT012
     C                     ENDIF                                          CFT012
      *                                                                   CFT002
      * Set up the detail screen fields from the message.                 CFT002
      *                                                                   CFT002
      * Destination                                                       CFT002
      *                                                                   CFT002
     C                     SELEC                                          CGL009
      ** Special case for FONTIS                                          CGL009
     C           PNWRK     WHEQ 'FONTIS'                                  CGL009
      * If Intermediary Bank is blank, use 'A/c with Institution'         CGL009
     C                     SELEC                                          CGL009
      *                                                                   CGL009
      * Intermediary Bank entered                                         CGL009
      *                                                                   CGL009
     C           P56       WHNE *BLANK                                    CGL009
     C                     MOVELP56       DSTRAN                          CGL009
     C           TRCODE    IFNE *BLANKS                                   CGL009
     C                     MOVE *BLANKS   SDST1                           CGL009
      *                                                                   CGL009
      * Translate to nostro and retail account numbers                    CGL009
      *                                                                   CGL009
     C                     EXSR SRTRAN                                    CGL009
     C                     SELEC                                          CGL009
      *                                                                   CGL009
      * If local and account currency local then use retail number        CGL009
      *                                                                   CGL009
     C           BJLCCY    WHEQ SSMCY                                     CGL009
     C           TRCYCD    ANDEQSSMCY                                     CGL009
     C           ##ACNO    ANDNE0                                         CGL009
     C           CFT012    ANDEQ'N'                                       CFT012
     C                     MOVE *BLANKS   SDST1                           CGL009
     C                     MOVE *BLANKS   SDST2                           CGL009
     C                     MOVE *BLANKS   SDST3                           CGL009
     C                     MOVE *BLANKS   SDST4                           CGL009
     C                     MOVEL##ACNO    SDST1                           CGL009
      *                                                                   CFT012
     C           BJLCCY    WHEQ WMGCCY                                    CFT012
     C           TRCYCD    ANDEQWMGCCY                                    CFT012
     C           ##ACNO    ANDNE0                                         CFT012
     C           CFT012    ANDEQ'Y'                                       CFT012
     C                     MOVE *BLANKS   SDST1                           CFT012
     C                     MOVE *BLANKS   SDST2                           CFT012
     C                     MOVE *BLANKS   SDST3                           CFT012
     C                     MOVE *BLANKS   SDST4                           CFT012
     C                     MOVEL##ACNO    SDST1                           CFT012
      *                                                                   CGL009
      * If currency the same as settle and nostro, use nostro             CGL009
      *                                                                   CGL009
     C           ##NCCY    WHEQ SSMCY                                     CGL009
     C           ##NONB    ANDNE*BLANKS                                   CGL009
     C           CFT012    ANDEQ'N'                                       CFT012
     C                     MOVE *BLANKS   SDST1                           CGL009
     C                     MOVE *BLANKS   SDST2                           CGL009
     C                     MOVE *BLANKS   SDST3                           CGL009
     C                     MOVE *BLANKS   SDST4                           CGL009
     C           ##NCCY    CAT  ##NONB    SDST1     P                     CGL009
      *                                                                   CFT012
      * If currency the same as msg and nostro, use nostro                CFT012
      *                                                                   CFT012
     C           ##NCCY    WHEQ WMGCCY                                    CFT012
     C           ##NONB    ANDNE*BLANKS                                   CFT012
     C           CFT012    ANDEQ'Y'                                       CFT012
     C                     MOVE *BLANKS   SDST1                           CFT012
     C                     MOVE *BLANKS   SDST2                           CFT012
     C                     MOVE *BLANKS   SDST3                           CFT012
     C                     MOVE *BLANKS   SDST4                           CFT012
     C           ##NCCY    CAT  ##NONB    SDST1     P                     CFT012
      *                                                                   CGL009
      * If currency the same use GL Account                               CGL009
      *                                                                   CGL009
     C           TRCYCD    WHEQ SSMCY                                     CGL009
     C           CFT012    ANDEQ'N'                                       CFT012
     C                     MOVE *BLANKS   SDST1                           CGL009
     C                     MOVE *BLANKS   SDST2                           CGL009
     C                     MOVE *BLANKS   SDST3                           CGL009
     C                     MOVE *BLANKS   SDST4                           CGL009
     C           @MBIN     IFNE 'Y'                                       CGL009
     C                     MOVE '   '     TRCODE                          CGL009
     C                     END                                            CGL009
     C                     MOVELTRCODE    SDST1                           CGL009
      *                                                                   CFT012
     C           TRCYCD    WHEQ WMGCCY                                    CFT012
     C           CFT012    ANDEQ'Y'                                       CFT012
     C                     MOVE *BLANKS   SDST1                           CFT012
     C                     MOVE *BLANKS   SDST2                           CFT012
     C                     MOVE *BLANKS   SDST3                           CFT012
     C                     MOVE *BLANKS   SDST4                           CFT012
     C           BGMBIN    IFNE 'Y'                                       CFT012
     C                     MOVE '   '     TRCODE                          CFT012
     C                     END                                            CFT012
     C                     MOVELTRCODE    SDST1                           CFT012
      *                                                                   CGL009
      * Use customer number                                               CGL009
      *                                                                   CGL009
     C                     OTHER                                          CGL009
     C                     MOVE *BLANKS   SDST1                           CGL009
     C                     MOVE *BLANKS   SDST2                           CGL009
     C                     MOVE *BLANKS   SDST3                           CGL009
     C                     MOVE *BLANKS   SDST4                           CGL009
     C                     MOVE TRCODE    TRCDE2                          CGL009
     C                     MOVELTRCNUM    SDST1                           CGL009
     C                     ENDSL                                          CGL009
     C                     END                                            CGL009
      *                                                                   CGL009
      * Account w/ Bank entered                                           CGL009
      *                                                                   CGL009
     C           P57       WHNE *BLANK                                    CGL009
     C                     MOVELP57       DSTRAN                          CGL009
     C           TRCODE    IFNE *BLANKS                                   CGL009
      *                                                                   CGL009
      * Translate to nostro and retail account numbers                    CGL009
      *                                                                   CGL009
     C                     EXSR SRTRAN                                    CGL009
     C                     SELEC                                          CGL009
      *                                                                   CGL009
      * If local and account currency local then use retail number        CGL009
      *                                                                   CGL009
     C           BJLCCY    WHEQ SSMCY                                     CGL009
     C           TRCYCD    ANDEQSSMCY                                     CGL009
     C           ##ACNO    ANDNE0                                         CGL009
     C           CFT012    ANDEQ'N'                                       CFT012
     C                     MOVE *BLANKS   SDST1                           CGL009
     C                     MOVE *BLANKS   SDST2                           CGL009
     C                     MOVE *BLANKS   SDST3                           CGL009
     C                     MOVE *BLANKS   SDST4                           CGL009
     C                     MOVEL##ACNO    SDST1                           CGL009
      *                                                                   CFT012
     C           BJLCCY    WHEQ WMGCCY                                    CFT012
     C           TRCYCD    ANDEQWMGCCY                                    CFT012
     C           ##ACNO    ANDNE0                                         CFT012
     C           CFT012    ANDEQ'Y'                                       CFT012
     C                     MOVE *BLANKS   SDST1                           CFT012
     C                     MOVE *BLANKS   SDST2                           CFT012
     C                     MOVE *BLANKS   SDST3                           CFT012
     C                     MOVE *BLANKS   SDST4                           CFT012
     C                     MOVEL##ACNO    SDST1                           CFT012
      *                                                                   CGL009
      * If currency the same as settle and nostro, use nostro             CGL009
      *                                                                   CGL009
     C           ##NCCY    WHEQ SSMCY                                     CGL009
     C           ##NONB    ANDNE*BLANKS                                   CGL009
     C           CFT012    ANDEQ'N'                                       CFT012
     C                     MOVE *BLANKS   SDST1                           CGL009
     C                     MOVE *BLANKS   SDST2                           CGL009
     C                     MOVE *BLANKS   SDST3                           CGL009
     C                     MOVE *BLANKS   SDST4                           CGL009
     C           ##NCCY    CAT  ##NONB    SDST1     P                     CGL009
      *                                                                   CFT012
      * If currency the same as msg and nostro, use nostro                CFT012
      *                                                                   CFT012
     C           ##NCCY    WHEQ WMGCCY                                    CFT012
     C           ##NONB    ANDNE*BLANKS                                   CFT012
     C           CFT012    ANDEQ'Y'                                       CFT012
     C                     MOVE *BLANKS   SDST1                           CFT012
     C                     MOVE *BLANKS   SDST2                           CFT012
     C                     MOVE *BLANKS   SDST3                           CFT012
     C                     MOVE *BLANKS   SDST4                           CFT012
     C           ##NCCY    CAT  ##NONB    SDST1     P                     CFT012
      *                                                                   CGL009
      * If currency the same use GL Account                               CGL009
      *                                                                   CGL009
     C           TRCYCD    WHEQ SSMCY                                     CGL009
     C           CFT012    ANDEQ'N'                                       CFT012
     C                     MOVE *BLANKS   SDST1                           CGL009
     C                     MOVE *BLANKS   SDST2                           CGL009
     C                     MOVE *BLANKS   SDST3                           CGL009
     C                     MOVE *BLANKS   SDST4                           CGL009
     C           @MBIN     IFNE 'Y'                                       CGL009
     C                     MOVE '   '     TRCODE                          CGL009
     C                     END                                            CGL009
     C                     MOVELTRCODE    SDST1                           CGL009
      *                                                                   CFT012
     C           TRCYCD    WHEQ WMGCCY                                    CFT012
     C           CFT012    ANDEQ'Y'                                       CFT012
     C                     MOVE *BLANKS   SDST1                           CFT012
     C                     MOVE *BLANKS   SDST2                           CFT012
     C                     MOVE *BLANKS   SDST3                           CFT012
     C                     MOVE *BLANKS   SDST4                           CFT012
     C           BGMBIN    IFNE 'Y'                                       CFT012
     C                     MOVE '   '     TRCODE                          CFT012
     C                     END                                            CFT012
     C                     MOVELTRCODE    SDST1                           CFT012
      *                                                                   CGL009
      * Use customer number                                               CGL009
      *                                                                   CGL009
     C                     OTHER                                          CGL009
     C                     MOVE *BLANKS   SDST1                           CGL009
     C                     MOVE *BLANKS   SDST2                           CGL009
     C                     MOVE *BLANKS   SDST3                           CGL009
     C                     MOVE *BLANKS   SDST4                           CGL009
     C                     MOVE TRCODE    TRCDE2                          CGL009
     C                     MOVELTRCNUM    SDST1                           CGL009
     C                     ENDSL                                          CGL009
     C                     END                                            CGL009
      *                                                                   CGL009
     C                     ENDSL                                          CGL009
      *                                                                   CGL009
      ** Other Networks                                                   CGL009
     C                     OTHER                                          CGL009
     C/COPY WNCPYSRC,FT0040C242
      * If Intermediary Bank is blank, use 'A/c with Institution'         CFT002
      * details if not blank, otherwise use Beneficiary  details          CFT002
      * if not blank, otherwise use Intermediary Bank details             CFT002
      *                                                                   CFT002
     C           P56       IFEQ *BLANKS                                   CFT002
      *                                                                   CFT002
     C           P57       IFNE *BLANKS                                   CFT002
     C                     MOVELP57       DSTRAN                          CFT002
     C           TRCODE    IFNE *BLANKS                                   CFT002
      *                                                                   CFT002
      * Translate to nostro and retail account numbers                    CFT002
      *                                                                   CFT002
     C                     EXSR SRTRAN                                    CFT002
     C                     SELEC                                          CFT002
      *                                                                   CFT002
      * If local and account currency local then use retail number        CFT002
      *                                                                   CFT002
     C           BJLCCY    WHEQ SSMCY                                     CFT002
     C           TRCYCD    ANDEQSSMCY                                     CFT002
     C           ##ACNO    ANDNE0                                         CFT002
     C           CFT012    ANDEQ'N'                                       CFT012
     C                     MOVE *BLANKS   SDST1                           CFT002
     C                     MOVE *BLANKS   SDST2                           CFT002
     C                     MOVE *BLANKS   SDST3                           CFT002
     C                     MOVE *BLANKS   SDST4                           CFT002
     C                     MOVEL##ACNO    SDST1                           CFT002
      *                                                                   CFT012
     C           BJLCCY    WHEQ WMGCCY                                    CFT012
     C           TRCYCD    ANDEQWMGCCY                                    CFT012
     C           ##ACNO    ANDNE0                                         CFT012
     C           CFT012    ANDEQ'Y'                                       CFT012
     C                     MOVE *BLANKS   SDST1                           CFT012
     C                     MOVE *BLANKS   SDST2                           CFT012
     C                     MOVE *BLANKS   SDST3                           CFT012
     C                     MOVE *BLANKS   SDST4                           CFT012
     C                     MOVEL##ACNO    SDST1                           CFT012
      *                                                                   CFT002
      * If currency the same as settle and nostro, use nostro             CFT002
      *                                                                   CFT002
     C           ##NCCY    WHEQ SSMCY                                     CFT002
     C           ##NONB    ANDNE*BLANKS                                   CFT002
     C           CFT012    ANDEQ'N'                                       CFT012
     C                     MOVE *BLANKS   SDST1                           CFT002
     C                     MOVE *BLANKS   SDST2                           CFT002
     C                     MOVE *BLANKS   SDST3                           CFT002
     C                     MOVE *BLANKS   SDST4                           CFT002
     C           ##NCCY    CAT  ##NONB    SDST1     P                     CFT002
      *                                                                   CFT012
      * If currency the same as msg and nostro, use nostro                CFT012
      *                                                                   CFT012
     C           ##NCCY    WHEQ WMGCCY                                    CFT012
     C           ##NONB    ANDNE*BLANKS                                   CFT012
     C           CFT012    ANDEQ'Y'                                       CFT012
     C                     MOVE *BLANKS   SDST1                           CFT012
     C                     MOVE *BLANKS   SDST2                           CFT012
     C                     MOVE *BLANKS   SDST3                           CFT012
     C                     MOVE *BLANKS   SDST4                           CFT012
     C           ##NCCY    CAT  ##NONB    SDST1     P                     CFT012
      *                                                                   CFT002
      * If currency the same use GL Account                               CFT002
      *                                                                   CFT002
     C           TRCYCD    WHEQ SSMCY                                     CFT002
     C           CFT012    ANDEQ'N'                                       CFT012
     C                     MOVE *BLANKS   SDST1                           CFT002
     C                     MOVE *BLANKS   SDST2                           CFT002
     C                     MOVE *BLANKS   SDST3                           CFT002
     C                     MOVE *BLANKS   SDST4                           CFT002
     C           @MBIN     IFNE 'Y'                                       CFT002
     C                     MOVE '   '     TRCODE                          CFT002
     C                     END                                            CFT002
     C                     MOVELTRCODE    SDST1                           CFT002
      *                                                                   CFT012
     C           TRCYCD    WHEQ WMGCCY                                    CFT012
     C           CFT012    ANDEQ'Y'                                       CFT012
     C                     MOVEL*BLANKS   SDST1                           CFT012
     C                     MOVEL*BLANKS   SDST2                           CFT012
     C                     MOVEL*BLANKS   SDST3                           CFT012
     C                     MOVEL*BLANKS   SDST4                           CFT012
     C           BGMBIN    IFNE 'Y'                                       CFT012
     C                     MOVE '   '     TRCODE                          CFT012
     C                     END                                            CFT012
     C                     MOVELTRCODE    SDST1                           CFT012
      *                                                                   CFT002
      * Use customer number                                               CFT002
      *                                                                   CFT002
     C                     OTHER                                          CFT002
     C                     MOVE *BLANKS   SDST1                           CFT002
     C                     MOVE *BLANKS   SDST2                           CFT002
     C                     MOVE *BLANKS   SDST3                           CFT002
     C                     MOVE *BLANKS   SDST4                           CFT002
     C                     MOVE TRCODE    TRCDE2                          CFT002
     C                     MOVELTRCNUM    SDST1                           CFT002
     C                     ENDSL                                          CFT002
     C                     END                                            CFT002
     C                     ELSE                                           CFT002
     C                     MOVELP58       DSTRAN                          CFT002
     C           TRCODE    IFNE *BLANKS                                   CFT002
     C                     MOVE *BLANKS   SDST1                           CFT002
      *                                                                   CFT002
      * Translate to nostro and retail account numbers                    CFT002
      *                                                                   CFT002
     C                     EXSR SRTRAN                                    CFT002
     C                     SELEC                                          CFT002
      *                                                                   CFT002
      * If local and account currency local then use retail number        CFT002
      *                                                                   CFT002
     C           BJLCCY    WHEQ SSMCY                                     CFT002
     C           TRCYCD    ANDEQSSMCY                                     CFT002
     C           ##ACNO    ANDNE0                                         CFT002
     C           CFT012    ANDEQ'N'                                       CFT012
     C                     MOVE *BLANKS   SDST1                           CFT002
     C                     MOVE *BLANKS   SDST2                           CFT002
     C                     MOVE *BLANKS   SDST3                           CFT002
     C                     MOVE *BLANKS   SDST4                           CFT002
     C                     MOVEL##ACNO    SDST1                           CFT002
      *                                                                   CFT012
     C           BJLCCY    WHEQ WMGCCY                                    CFT012
     C           TRCYCD    ANDEQWMGCCY                                    CFT012
     C           ##ACNO    ANDNE0                                         CFT012
     C           CFT012    ANDEQ'Y'                                       CFT012
     C                     MOVEL*BLANKS   SDST1                           CFT012
     C                     MOVEL*BLANKS   SDST2                           CFT012
     C                     MOVEL*BLANKS   SDST3                           CFT012
     C                     MOVEL*BLANKS   SDST4                           CFT012
     C                     MOVEL##ACNO    SDST1                           CFT012
      *                                                                   CFT002
      * If currency the same as settle and nostro, use nostro             CFT002
      *                                                                   CFT002
     C           ##NCCY    WHEQ SSMCY                                     CFT002
     C           ##NONB    ANDNE*BLANKS                                   CFT002
     C           CFT012    ANDEQ'N'                                       CFT012
     C                     MOVE *BLANKS   SDST1                           CFT002
     C                     MOVE *BLANKS   SDST2                           CFT002
     C                     MOVE *BLANKS   SDST3                           CFT002
     C                     MOVE *BLANKS   SDST4                           CFT002
     C           ##NCCY    CAT  ##NONB    SDST1     P                     CFT002
      *                                                                   CFT012
      * If currency the same as msg and nostro, use nostro                CFT012
      *                                                                   CFT012
     C           ##NCCY    WHEQ WMGCCY                                    CFT012
     C           ##NONB    ANDNE*BLANKS                                   CFT012
     C           CFT012    ANDEQ'Y'                                       CFT012
     C                     MOVEL*BLANKS   SDST1                           CFT012
     C                     MOVEL*BLANKS   SDST2                           CFT012
     C                     MOVEL*BLANKS   SDST3                           CFT012
     C                     MOVEL*BLANKS   SDST4                           CFT012
     C           ##NCCY    CAT  ##NONB    SDST1     P                     CFT012
      *                                                                   CFT002
      * If currency the same use GL Account                               CFT002
      *                                                                   CFT002
     C           TRCYCD    WHEQ SSMCY                                     CFT002
     C           CFT012    ANDEQ'N'                                       CFT012
     C                     MOVE *BLANKS   SDST1                           CFT002
     C                     MOVE *BLANKS   SDST2                           CFT002
     C                     MOVE *BLANKS   SDST3                           CFT002
     C                     MOVE *BLANKS   SDST4                           CFT002
     C           @MBIN     IFNE 'Y'                                       CFT002
     C                     MOVE '   '     TRCODE                          CFT002
     C                     END                                            CFT002
     C                     MOVELTRCODE    SDST1                           CFT002
      *                                                                   CFT012
     C           TRCYCD    WHEQ WMGCCY                                    CFT012
     C           CFT012    ANDEQ'Y'                                       CFT012
     C                     MOVEL*BLANKS   SDST1                           CFT012
     C                     MOVEL*BLANKS   SDST2                           CFT012
     C                     MOVEL*BLANKS   SDST3                           CFT012
     C                     MOVEL*BLANKS   SDST4                           CFT012
     C           BGMBIN    IFNE 'Y'                                       CFT012
     C                     MOVE '   '     TRCODE                          CFT012
     C                     END                                            CFT012
     C                     MOVELTRCODE    SDST1                           CFT012
      *                                                                   CFT002
      * Use customer number                                               CFT002
      *                                                                   CFT002
     C                     OTHER                                          CFT002
     C                     MOVE *BLANKS   SDST1                           CFT002
     C                     MOVE *BLANKS   SDST2                           CFT002
     C                     MOVE *BLANKS   SDST3                           CFT002
     C                     MOVE *BLANKS   SDST4                           CFT002
     C                     MOVE TRCODE    TRCDE2                          CFT002
     C                     MOVELTRCNUM    SDST1                           CFT002
     C                     ENDSL                                          CFT002
     C                     END                                            CFT002
     C                     END                                            CFT002
      *                                                                   CFT002
     C                     ELSE                                           CFT002
      *                                                                   CFT002
      * Intermediary Bank entered                                         CFT002
      *                                                                   CFT002
     C                     MOVELP56       DSTRAN                          CFT002
     C           TRCODE    IFNE *BLANKS                                   CFT002
     C                     MOVE *BLANKS   SDST1                           CFT002
      *                                                                   CFT002
      * Translate to nostro and retail account numbers                    CFT002
      *                                                                   CFT002
     C                     EXSR SRTRAN                                    CFT002
     C                     SELEC                                          CFT002
      *                                                                   CFT002
      * If local and account currency local then use retail number        CFT002
      *                                                                   CFT002
     C           BJLCCY    WHEQ SSMCY                                     CFT002
     C           TRCYCD    ANDEQSSMCY                                     CFT002
     C           ##ACNO    ANDNE0                                         CFT002
     C           CFT012    ANDEQ'N'                                       CFT012
     C                     MOVE *BLANKS   SDST1                           CFT002
     C                     MOVE *BLANKS   SDST2                           CFT002
     C                     MOVE *BLANKS   SDST3                           CFT002
     C                     MOVE *BLANKS   SDST4                           CFT002
     C                     MOVEL##ACNO    SDST1                           CFT002
      *                                                                   CFT012
     C           BJLCCY    WHEQ WMGCCY                                    CFT012
     C           TRCYCD    ANDEQWMGCCY                                    CFT012
     C           ##ACNO    ANDNE0                                         CFT012
     C           CFT012    ANDEQ'Y'                                       CFT012
     C                     MOVEL*BLANKS   SDST1                           CFT012
     C                     MOVEL*BLANKS   SDST2                           CFT012
     C                     MOVEL*BLANKS   SDST3                           CFT012
     C                     MOVEL*BLANKS   SDST4                           CFT012
     C                     MOVEL##ACNO    SDST1                           CFT012
      *                                                                   CFT002
      * If currency the same as settle and nostro, use nostro             CFT002
      *                                                                   CFT002
     C           ##NCCY    WHEQ SSMCY                                     CFT002
     C           ##NONB    ANDNE*BLANKS                                   CFT002
     C           CFT012    ANDEQ'N'                                       CFT012
     C                     MOVE *BLANKS   SDST1                           CFT002
     C                     MOVE *BLANKS   SDST2                           CFT002
     C                     MOVE *BLANKS   SDST3                           CFT002
     C                     MOVE *BLANKS   SDST4                           CFT002
     C           ##NCCY    CAT  ##NONB    SDST1     P                     CFT002
      *                                                                   CFT012
      * If currency the same as msg and nostro, use nostro                CFT012
      *                                                                   CFT012
     C           ##NCCY    WHEQ WMGCCY                                    CFT012
     C           ##NONB    ANDNE*BLANKS                                   CFT012
     C           CFT012    ANDEQ'Y'                                       CFT012
     C                     MOVEL*BLANKS   SDST1                           CFT012
     C                     MOVEL*BLANKS   SDST2                           CFT012
     C                     MOVEL*BLANKS   SDST3                           CFT012
     C                     MOVEL*BLANKS   SDST4                           CFT012
     C           ##NCCY    CAT  ##NONB    SDST1     P                     CFT012
      *                                                                   CFT002
      * If currency the same use GL Account                               CFT002
      *                                                                   CFT002
     C           TRCYCD    WHEQ SSMCY                                     CFT002
     C           CFT012    ANDEQ'N'                                       CFT012
     C                     MOVE *BLANKS   SDST1                           CFT002
     C                     MOVE *BLANKS   SDST2                           CFT002
     C                     MOVE *BLANKS   SDST3                           CFT002
     C                     MOVE *BLANKS   SDST4                           CFT002
     C           @MBIN     IFNE 'Y'                                       CFT002
     C                     MOVE '   '     TRCODE                          CFT002
     C                     END                                            CFT002
     C                     MOVELTRCODE    SDST1                           CFT002
      *                                                                   CFT012
     C           TRCYCD    WHEQ WMGCCY                                    CFT012
     C           CFT012    ANDEQ'Y'                                       CFT012
     C                     MOVEL*BLANKS   SDST1                           CFT012
     C                     MOVEL*BLANKS   SDST2                           CFT012
     C                     MOVEL*BLANKS   SDST3                           CFT012
     C                     MOVEL*BLANKS   SDST4                           CFT012
     C           BGMBIN    IFNE 'Y'                                       CFT012
     C                     MOVE '   '     TRCODE                          CFT012
     C                     END                                            CFT012
     C                     MOVELTRCODE    SDST1                           CFT012
      *                                                                   CFT002
      * Use customer number                                               CFT002
      *                                                                   CFT002
     C                     OTHER                                          CFT002
     C                     MOVE *BLANKS   SDST1                           CFT002
     C                     MOVE *BLANKS   SDST2                           CFT002
     C                     MOVE *BLANKS   SDST3                           CFT002
     C                     MOVE *BLANKS   SDST4                           CFT002
     C                     MOVE TRCODE    TRCDE2                          CFT002
     C                     MOVELTRCNUM    SDST1                           CFT002
     C                     ENDSL                                          CFT002
     C                     END                                            CFT002
     C                     END                                            CFT002
     C/COPY WNCPYSRC,FT0040C243
      *                                                                   CGL009
     C                     ENDSL                                          CGL009
      *                                                                   CFT002
      * Ordering Bank                                                     CFT002
      *                                                                   CFT002
     C                     SELEC                                          CGL009
      ** Special case for FONTIS                                          CGL009
     C           PNWRK     WHEQ 'FONTIS'                                  CGL009
      ** Ordering bank is never filled  in FONTIS                         CGL009
      *                                                                   CGL009
      ** Other Networks                                                   CGL009
     C                     OTHER                                          CGL009
      * If Third Reimbursement Institution is not blank, use it           CFT014
      * otherwise                                                         CFT014
      *                                                                   CFT002
      * If Receivers Correspondent is not blank, use it                   CFT002
      * otherwise use Senders Correspondent. If both are blank            CFT002
      * use Sender details.                                               CFT002
      * Use Third Reimb Institution details                               CFT014
     C           P55       IFNE *BLANKS                                   CFT014
     C                     MOVELP55       DSTRAN                          CFT014
     C                     MOVEL*BLANKS   SORBB                           CFT014
     C           TRCODE    IFNE *BLANKS                                   CFT014
     C                     MOVE TRCODE    TRCDE2                          CFT014
     C           TRCYCD    IFEQ *BLANKS                                   CFT014
     C                     MOVE *BLANKS   SORBK                           CFT014
     C                     MOVELTRCNUM    SORBK                           CFT014
     C                     ELSE                                           CFT014
      ** Translate to nostro and retail account numbers                   CFT014
     C                     EXSR SRTRAN                                    CFT014
     C                     SELEC                                          CFT014
      ** If local and account currency local then use retail number       CFT014
      ** Save if CFT012 is on                                             CFT014
     C           BJLCCY    WHEQ SSMCY                                     CFT014
     C           TRCYCD    ANDEQSSMCY                                     CFT014
     C           ##ACNO    ANDNE0                                         CFT014
     C           CFT012    ANDEQ'N'                                       CFT014
     C                     MOVEL*BLANKS   SORBK                           CFT014
     C                     MOVEL##ACNO    SORBK                           CFT014
     C           ##ACNO    WHNE 0                                         CFT014
     C           CFT012    ANDEQ'Y'                                       CFT014
     C                     MOVEL*BLANKS   SORBK                           CFT014
     C                     MOVEL##ACNO    SORBK                           CFT014
     C                     MOVELTRCYCD    SSMCY                           CFT014
      ** If currency the same as settle and nostro, use nostro            CFT014
      ** Save if CFT012 on                                                CFT014
     C           ##NCCY    WHEQ SSMCY                                     CFT014
     C           ##NONB    ANDNE*BLANKS                                   CFT014
     C           CFT012    ANDEQ'N'                                       CFT014
     C                     MOVEL*BLANKS   SORBK                           CFT014
     C                     MOVEL##NONB    SORBK                           CFT014
     C           ##NONB    WHNE *BLANKS                                   CFT014
     C           CFT012    ANDEQ'Y'                                       CFT014
     C                     MOVEL*BLANKS   SORBK                           CFT014
     C                     MOVEL##NONB    SORBK                           CFT014
     C                     MOVEL##NCCY    SSMCY                           CFT014
      ** If currency the same use GL Account                              CFT014
      ** Save if CFT012 on                                                CFT014
     C           TRCYCD    WHEQ SSMCY                                     CFT014
     C           CFT012    ANDEQ'N'                                       CFT014
     C           TRCNUM    CAT  TRCDSQ    SORBK                           CFT014
     C           @MBIN     IFEQ 'Y'                                       CFT014
     C                     MOVE TRBRCD    SORBB                           CFT014
     C                     ENDIF                                          CFT014
     C           CFT012    WHEQ 'Y'                                       CFT014
     C           TRCYCD    ANDNE*BLANK                                    CFT014
     C           TRCDSQ    ANDNE*BLANK                                    CFT014
     C           TRCNUM    CAT  TRCDSQ    SORBK                           CFT014
     C           @MBIN     IFEQ 'Y'                                       CFT014
     C                     MOVE TRBRCD    SORBB                           CFT014
     C                     ENDIF                                          CFT014
     C                     MOVELTRCYCD    SSMCY                           CFT014
      ** Use customer number                                              CFT014
     C                     OTHER                                          CFT014
     C                     MOVEL*BLANKS   SORBK                           CFT014
     C                     MOVELTRCODE    TRCDE2                          CFT014
     C                     MOVELTRCNUM    SORBK                           CFT014
     C                     ENDSL                                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
     C                     ELSE                                           CFT014
      ** Use Receiver's Correspondant details                             CFT014
      *                                                                   CFT002
     C                     MOVELP54       DSTRAN                          CFT002
     C                     MOVE TRCODE    TRCDE2                          CFT002
     C           P54       IFNE *BLANKS                                   CFT002
      *                                                                   CFT002
     C                     MOVELP54       DSTRAN                          CFT002
     C           TRCODE    IFNE *BLANKS                                   CFT002
     C                     MOVE TRCODE    TRCDE2                          CFT002
     C           TRCYCD    IFEQ *BLANKS                                   CFT002
     C                     MOVE *BLANKS   SORBK                           CFT002
     C                     MOVELTRCNUM    SORBK                           CFT002
     C                     ELSE                                           CFT002
      *                                                                   CFT002
      * Translate to nostro and retail account numbers                    CFT002
      *                                                                   CFT002
     C                     EXSR SRTRAN                                    CFT002
     C                     SELEC                                          CFT002
      *                                                                   CFT002
      * If local and account currency local then use retail number        CFT002
      * Save if CFT012 is on                                              CFT012
      *                                                                   CFT002
     C           BJLCCY    WHEQ SSMCY                                     CFT002
     C           TRCYCD    ANDEQSSMCY                                     CFT002
     C           ##ACNO    ANDNE0                                         CFT002
     C           CFT012    ANDEQ'N'                                       CFT012
     C                     MOVE *BLANKS   SORBK                           CFT002
     C                     MOVEL##ACNO    SORBK                           CFT002
      *                                                                   CFT002
     C           ##ACNO    WHNE 0                                         CFT012
     C           CFT012    ANDEQ'Y'                                       CFT012
     C                     MOVEL*BLANKS   SORBK                           CFT012
     C                     MOVEL##ACNO    SORBK                           CFT012
     C                     MOVELTRCYCD    SSMCY                           CFT012
      *                                                                   CFT012
      * If currency the same as settle and nostro, use nostro             CFT002
      * Save if CFT012 on                                                 CFT012
      *                                                                   CFT002
     C           ##NCCY    WHEQ SSMCY                                     CFT002
     C           ##NONB    ANDNE*BLANKS                                   CFT002
     C           CFT012    ANDEQ'N'                                       CFT012
     C                     MOVE *BLANKS   SORBK                           CFT002
     C                     MOVEL##NONB    SORBK                           CFT002
      *                                                                   CFT012
     C           ##NONB    WHNE *BLANKS                                   CFT012
     C           CFT012    ANDEQ'Y'                                       CFT012
     C                     MOVEL*BLANKS   SORBK                           CFT012
     C                     MOVEL##NONB    SORBK                           CFT012
     C                     MOVEL##NCCY    SSMCY                           CFT012
      *                                                                   CFT002
      * If currency the same use GL Account                               CFT002
      * Save if CFT012 on                                                 CFT012
      *                                                                   CFT002
     C           TRCYCD    WHEQ SSMCY                                     CFT002
     C           CFT012    ANDEQ'N'                                       CFT012
     C           TRCNUM    CAT  TRCDSQ    SORBK                           CFT002
     C           @MBIN     IFEQ 'Y'                                       CFT002
     C                     MOVE TRBRCD    SORBB                           CFT002
     C                     END                                            CFT002
      *                                                                   CFT012
     C           CFT012    WHEQ 'Y'                                       CFT012
     C           TRCYCD    ANDNE*BLANK                                    CFT012
     C           TRCDSQ    ANDNE*BLANK                                    CFT012
     C           TRCNUM    CAT  TRCDSQ    SORBK                           CFT012
     C           @MBIN     IFEQ 'Y'                                       CFT012
     C                     MOVE TRBRCD    SORBB                           CFT012
     C                     ENDIF                                          CFT012
     C                     MOVELTRCYCD    SSMCY                           CFT012
      *                                                                   CFT002
      * Use customer number                                               CFT002
      *                                                                   CFT002
     C                     OTHER                                          CFT002
     C                     MOVE *BLANKS   SORBK                           CFT002
     C                     MOVE TRCODE    TRCDE2                          CFT002
     C                     MOVELTRCNUM    SORBK                           CFT002
     C                     ENDSL                                          CFT002
     C/COPY WNCPYSRC,FT0040C213
     C                     END                                            CFT002
     C                     END                                            CFT002
     C/COPY WNCPYSRC,FT0040C214
      *                                                                   CFT002
     C                     ELSE                                           CFT002
     C/COPY WNCPYSRC,FT0040C215
      *                                                                   CFT002
     C                     MOVELP53       DSTRAN                          CFT002
     C                     MOVE TRCODE    TRCDE2                          CFT002
     C           P53       IFNE *BLANKS                                   CFT002
     C                     MOVELP53       DSTRAN                          CFT002
     C           TRCODE    IFNE *BLANKS                                   CFT002
     C                     MOVE *BLANKS   SORBK                           CFT002
     C                     MOVE TRCODE    TRCDE2                          CFT002
     C           TRCYCD    IFEQ *BLANKS                                   CFT002
     C                     MOVELTRCNUM    SORBK                           CFT002
     C                     ELSE                                           CFT002
      *                                                                   CFT002
      * Translate to nostro and retail account numbers                    CFT002
      *                                                                   CFT002
     C                     EXSR SRTRAN                                    CFT002
     C                     SELEC                                          CFT002
      *                                                                   CFT002
      * If local and account currency local then use retail number        CFT002
      * Save if CFT012 is on                                              CFT012
      *                                                                   CFT002
     C           BJLCCY    WHEQ SSMCY                                     CFT002
     C           TRCYCD    ANDEQSSMCY                                     CFT002
     C           ##ACNO    ANDNE0                                         CFT002
     C           CFT012    ANDEQ'N'                                       CFT012
     C                     MOVE *BLANKS   SORBK                           CFT002
     C                     MOVEL##ACNO    SORBK                           CFT002
      *                                                                   CFT012
     C           ##ACNO    WHNE 0                                         CFT012
     C           CFT012    ANDEQ'Y'                                       CFT012
     C                     MOVEL*BLANKS   SORBK                           CFT012
     C                     MOVEL##ACNO    SORBK                           CFT012
     C                     MOVELTRCYCD    SSMCY                           CFT012
      *                                                                   CFT002
      * If currency the same as settle and nostro, use nostro             CFT002
      * Save if CFT012 is on                                              CFT012
      *                                                                   CFT002
     C           ##NCCY    WHEQ SSMCY                                     CFT002
     C           ##NONB    ANDNE*BLANKS                                   CFT002
     C           CFT012    ANDEQ'N'                                       CFT012
     C                     MOVE *BLANKS   SORBK                           CFT002
     C                     MOVEL##NONB    SORBK                           CFT002
      *                                                                   CFT012
     C           ##NONB    WHNE *BLANKS                                   CFT012
     C           CFT012    ANDEQ'Y'                                       CFT012
     C                     MOVEL*BLANKS   SORBK                           CFT012
     C                     MOVEL##NONB    SORBK                           CFT012
     C                     MOVEL##NCCY    SSMCY                           CFT012
      *                                                                   CFT002
      * If currency the same use GL Account                               CFT002
      *                                                                   CFT002
     C           TRCYCD    WHEQ SSMCY                                     CFT002
     C           CFT012    ANDEQ'N'                                       CFT012
     C           TRCNUM    CAT  TRCDSQ    SORBK                           CFT002
     C           @MBIN     IFEQ 'Y'                                       CFT002
     C                     MOVE TRBRCD    SORBB                           CFT002
     C                     END                                            CFT002
      *                                                                   CFT012
     C           CFT012    WHEQ 'Y'                                       CFT012
     C           TRCYCD    ANDNE*BLANK                                    CFT012
     C           TRCDSQ    ANDNE*BLANK                                    CFT012
     C           TRCNUM    CAT  TRCDSQ    SORBK                           CFT012
     C           @MBIN     IFEQ 'Y'                                       CFT012
     C                     MOVELTRBRCD    SORBB                           CFT012
     C                     ENDIF                                          CFT012
     C                     MOVELTRCYCD    SSMCY                           CFT012
      *                                                                   CFT002
      * Use customer number                                               CFT002
      *                                                                   CFT002
     C                     OTHER                                          CFT002
     C                     MOVE *BLANKS   SORBK                           CFT002
     C                     MOVE TRCODE    TRCDE2                          CFT002
     C                     MOVELTRCNUM    SORBK                           CFT002
     C                     ENDSL                                          CFT002
     C/COPY WNCPYSRC,FT0040C216
     C                     END                                            CFT002
     C                     ELSE                                           CFT002
      *                                                                   CFT002
      * If TRTAG is :53B: and no account map account from sender          CFT002
      *                                                                   CFT002
     C           TRTAG     IFEQ ':53B:'                                   CFT002
     C           PNWRK     ANDEQ'SWIFT'                                   CFT002
     C           PSN       IFNE *BLANKS                                   CFT002
     C                     MOVELPSN       DSTRAN                          CFT002
     C           TRCODE    IFNE *BLANKS                                   CFT002
     C                     MOVE TRCODE    TRCDE2                          CFT002
     C           TRCYCD    IFEQ *BLANKS                                   CFT002
     C                     MOVE *BLANKS   SORBK                           CFT002
     C                     MOVELTRCNUM    SORBK                           CFT002
     C                     ELSE                                           CFT002
      *                                                                   CFT002
      * Translate to nostro and retail account numbers                    CFT002
      *                                                                   CFT002
     C                     EXSR SRTRAN                                    CFT002
     C                     SELEC                                          CFT002
      *                                                                   CFT002
      * If local and account currency local then use retail number        CFT002
      * Save if CFT012 is on                                              CFT012
      *                                                                   CFT002
     C           BJLCCY    WHEQ SSMCY                                     CFT002
     C           TRCYCD    ANDEQSSMCY                                     CFT002
     C           ##ACNO    ANDNE0                                         CFT002
     C           CFT012    ANDEQ'N'                                       CFT012
     C                     MOVE *BLANKS   SORBK                           CFT002
     C                     MOVEL##ACNO    SORBK                           CFT002
      *                                                                   CFT012
     C           ##ACNO    WHNE 0                                         CFT012
     C           CFT012    ANDEQ'Y'                                       CFT012
     C                     MOVEL*BLANKS   SORBK                           CFT012
     C                     MOVEL##ACNO    SORBK                           CFT012
     C                     MOVELTRCYCD    SSMCY                           CFT012
      *                                                                   CFT002
      * If currency the same as settle and nostro, use nostro             CFT002
      * Save if CFT012 is on                                              CFT012
      *                                                                   CFT002
     C           ##NCCY    WHEQ SSMCY                                     CFT002
     C           ##NONB    ANDNE*BLANKS                                   CFT002
     C           CFT012    ANDEQ'N'                                       CFT012
     C                     MOVE *BLANKS   SORBK                           CFT002
     C                     MOVEL##NONB    SORBK                           CFT002
      *                                                                   CFT012
     C           ##NONB    WHNE *BLANKS                                   CFT012
     C           CFT012    ANDEQ'Y'                                       CFT012
     C                     MOVEL*BLANKS   SORBK                           CFT012
     C                     MOVEL##NONB    SORBK                           CFT012
     C                     MOVEL##NCCY    SSMCY                           CFT012
      *                                                                   CFT002
      * If currency the same use GL Account                               CFT002
      * Save if CFT012 is on                                              CFT012
      *                                                                   CFT002
     C           TRCYCD    WHEQ SSMCY                                     CFT002
     C           CFT012    ANDEQ'N'                                       CFT012
     C           TRCNUM    CAT  TRCDSQ    SORBK                           CFT002
     C           @MBIN     IFEQ 'Y'                                       CFT002
     C                     MOVE TRBRCD    SORBB                           CFT002
     C                     END                                            CFT002
      *                                                                   CFT012
     C           CFT012    WHEQ 'Y'                                       CFT012
     C           TRCYCD    ANDNE*BLANK                                    CFT012
     C           TRCDSQ    ANDNE*BLANK                                    CFT012
     C           TRCNUM    CAT  TRCDSQ    SORBK                           CFT012
     C           @MBIN     IFEQ 'Y'                                       CFT012
     C                     MOVELTRBRCD    SORBB                           CFT012
     C                     ENDIF                                          CFT012
     C                     MOVELTRCYCD    SSMCY                           CFT012
      *                                                                   CFT002
      * Use customer number                                               CFT002
      *                                                                   CFT002
     C                     OTHER                                          CFT002
     C                     MOVE *BLANKS   SORBK                           CFT002
     C                     MOVE TRCODE    TRCDE2                          CFT002
     C                     MOVELTRCNUM    SORBK                           CFT002
     C/COPY WNCPYSRC,FT0040C217
     C                     ENDSL                                          CFT002
     C                     END                                            CFT002
     C                     END                                            CFT002
     C                     ELSE                                           CFT002
     C                     MOVE *BLANKS   SORBK                           CFT002
     C                     MOVELPSNDR     SORBK                           CFT002
     C                     END                                            CFT002
     C                     END                                            CFT002
     C                     END                                            CFT002
     C/COPY WNCPYSRC,FT0040C218
      *                                                                   CFT002
     C                     ELSE                                           CFT002
     C/COPY WNCPYSRC,FT0040C219
      ** Use Sender details                                               CFT014
      *                                                                   CFT002
     C           PNWRK     IFEQ 'SWIFT '                                  CFT002
     C           PSN       IFNE *BLANKS                                   CFT002
     C                     MOVELPSN       DSTRAN                          CFT002
     C           TRCODE    IFNE *BLANKS                                   CFT002
     C                     MOVE TRCODE    TRCDE2                          CFT002
     C           TRCYCD    IFEQ *BLANKS                                   CFT002
     C                     MOVE *BLANKS   SORBK                           CFT002
     C                     MOVE TRCODE    TRCDE2                          CFT002
     C                     MOVELTRCNUM    SORBK                           CFT002
     C                     ELSE                                           CFT002
      *                                                                   CFT002
      * Translate to nostro and retail account numbers                    CFT002
      *                                                                   CFT002
     C                     EXSR SRTRAN                                    CFT002
     C                     SELEC                                          CFT002
      *                                                                   CFT002
      * If local and account currency local then use retail number        CFT002
      * Save if CFT012 is on                                              CFT012
      *                                                                   CFT002
     C           BJLCCY    WHEQ SSMCY                                     CFT002
     C           TRCYCD    ANDEQSSMCY                                     CFT002
     C           ##ACNO    ANDNE0                                         CFT002
     C           CFT012    ANDEQ'N'                                       CFT012
     C                     MOVE *BLANKS   SORBK                           CFT002
     C                     MOVEL##ACNO    SORBK                           CFT002
      *                                                                   CFT012
     C           ##ACNO    WHNE 0                                         CFT012
     C           CFT012    ANDEQ'Y'                                       CFT012
     C                     MOVEL*BLANKS   SORBK                           CFT012
     C                     MOVEL##ACNO    SORBK                           CFT012
     C                     MOVELTRCYCD    SSMCY                           CFT012
      *                                                                   CFT002
      * If currency the same as settle and nostro, use nostro             CFT002
      * Save if CFT012 is on                                              CFT012
      *                                                                   CFT002
     C           ##NCCY    WHEQ SSMCY                                     CFT002
     C           ##NONB    ANDNE*BLANKS                                   CFT002
     C           CFT012    ANDEQ'N'                                       CFT012
     C                     MOVE *BLANKS   SORBK                           CFT002
     C                     MOVEL##NONB    SORBK                           CFT002
      *                                                                   CFT012
     C           ##NONB    WHNE *BLANKS                                   CFT012
     C           CFT012    ANDEQ'Y'                                       CFT012
     C                     MOVEL*BLANKS   SORBK                           CFT012
     C                     MOVEL##NONB    SORBK                           CFT012
     C                     MOVEL##NCCY    SSMCY                           CFT012
      *                                                                   CFT002
      * If currency the same use GL Account                               CFT002
      * Save if CFT012 is on                                              CFT012
      *                                                                   CFT002
     C           TRCYCD    WHEQ SSMCY                                     CFT002
     C           CFT012    ANDEQ'N'                                       CFT012
     C           TRCNUM    CAT  TRCDSQ    SORBK                           CFT002
     C           @MBIN     IFEQ 'Y'                                       CFT002
     C                     MOVE TRBRCD    SORBB                           CFT002
     C                     END                                            CFT002
      *                                                                   CFT012
     C           CFT012    WHEQ 'Y'                                       CFT012
     C           TRCYCD    ANDNE*BLANK                                    CFT012
     C           TRCDSQ    ANDNE*BLANK                                    CFT012
     C           TRCNUM    CAT  TRCDSQ    SORBK                           CFT012
     C           @MBIN     IFEQ 'Y'                                       CFT012
     C                     MOVELTRBRCD    SORBB                           CFT012
     C                     ENDIF                                          CFT012
     C                     MOVELTRCYCD    SSMCY                           CFT012
      *                                                                   CFT002
      * Use customer number                                               CFT002
      *                                                                   CFT002
     C                     OTHER                                          CFT002
     C                     MOVE *BLANKS   SORBK                           CFT002
     C                     MOVE TRCODE    TRCDE2                          CFT002
     C                     MOVELTRCNUM    SORBK                           CFT002
     C                     ENDSL                                          CFT002
     C                     END                                            CFT002
     C                     ELSE                                           CFT002
     C                     MOVE *BLANKS   SORBK                           CFT002
     C                     MOVELPSNDR     SORBK                           CFT002
     C                     END                                            CFT002
     C                     END                                            CFT002
     C                     ELSE                                           CFT002
      *                                                                   CFT002
     C                     END                                            CFT002
     C                     END                                            CFT002
     C/COPY WNCPYSRC,FT0040C220
     C                     END                                            CFT002
     C/COPY WNCPYSRC,FT0040C221
     C                     ENDIF                                          CFT014
      *                                                                   CGL009
     C                     ENDSL                                          CGL009
      *                                                                   CGL009
      * Ordering Customer                                                 CGL009
      *                                                                   CGL009
     C                     SELEC                                          CGL009
     C           PNWRK     WHEQ 'FONTIS'                                  CGL009
      ** Translation is not working for ordering customer                 CGL009
      ** Use part translated of P53 to map S4ORC                          CGL009
      ** Do something                                                     CGL009
     C                     OTHER                                          CGL009
      ** Do something                                                     CGL009
     C                     SELEC                                          CGL009
      *                                                                   CGL009
     C           P50       WHNE *BLANKS                                   CGL009
     C           P52       WHNE *BLANKS                                   CGL009
     C                     ENDSL                                          CGL009
      *                                                                   CGL009
     C                     ENDSL                                          CGL009
      *                                                                   CFT002
      * Bank to Bank Information                                          CFT002
      *                                                                   CFT002
      * If through payment, the bank to bank information has to be        CFT002
      * carried forward to next outgoing message.                         CFT002
      * (For Swift network only)                                          CFT002
      * (For Fontis network only)                                         CGL009
      *                                                                   CFT002
     C                     MOVE *BLANK    W0BTOB  1                       CFT002
     C           PNWRK     IFEQ 'SWIFT'                                   CFT002
     C           PNWRK     OREQ 'FONTIS'                                  CGL009
     C/COPY WNCPYSRC,FT0040C125
     C                     MOVE 'Y'       W0BTOB                          CFT002
     C                     END                                            CFT002
      *                                                                   CFT002
     C           W0BTOB    IFEQ 'Y'                                       CFT002
     C           P72       IFNE *BLANKS                                   CFT002
      *                                                                   CFT002
     C                     SELEC                                          CGL009
      ** Special rule for FONTIS                                          CGL009
     C           PNWRK     WHEQ 'FONTIS'                                  CGL009
     C*                                                                   CGL009
     C                     EXSR ICCHK                                     CGL009
     C*                                                                   CGL009
     C                     MOVELP72       DSFONT                          CGL009
     C           FOUND     IFEQ 'Y'                                       CGL009
     C                     MOVEL*BLANK    BBI6                            CGL009
     C                     MOVELFN72L2    BBI1                            CGL009
     C                     MOVELFN72L3    BBI2                            CGL009
     C                     MOVELFN72L4    BBI3                            CGL009
     C                     MOVELFN72L5    BBI4                            CGL009
     C                     MOVELFN72L6    BBI5                            CGL009
     C                     ELSE                                           CGL009
     C                     MOVELFN72L1    BBI1                            CGL009
     C                     MOVELFN72L2    BBI2                            CGL009
     C                     MOVELFN72L3    BBI3                            CGL009
     C                     MOVELFN72L4    BBI4                            CGL009
     C                     MOVELFN72L5    BBI5                            CGL009
     C                     MOVELFN72L6    BBI6                            CGL009
     C                     ENDIF                                          CGL009
      ** Other Networks                                                   CGL009
     C                     OTHER                                          CGL009
      *                                                                   CFT002
     C                     MOVELP72       DSTRAN                          CFT002
     C                     MOVELTMLIN1    BBI1                            CFT002
     C                     MOVELTMLIN2    BBI2                            CFT002
     C                     MOVELTMLIN3    BBI3                            CFT002
     C                     MOVELTMLIN4    BBI4                            CFT002
     C                     MOVELTMLIN5    BBI5                            CFT002
     C                     MOVELTMLIN6    BBI6                            CFT002
      *                                                                   CGL009
     C                     ENDSL                                          CGL009
      *                                                                   CFT002
     C                     END                                            CFT002
     C           P70       IFNE *BLANKS                                   CFT002
      *                                                                   CFT002
     C                     MOVELP70       DSTRAN                          CFT002
     C                     MOVELTMLIN1    DTP1                            CFT002
     C                     MOVELTMLIN2    DTP2                            CFT002
     C                     MOVELTMLIN3    DTP3                            CFT002
     C                     MOVELTMLIN4    DTP4                            CFT002
      *                                                                   CFT002
     C                     END                                            CFT002
     C                     END                                            CFT002
      *                                                                   CFT002
     C           EXOSWT    ENDSR                                          CFT002
      *                                                                   CFT002
      *================================================================   CFT002
      /EJECT                                                              CFT002
      *================================================================   CFT002
      *  Translate to retail and nostro code                              CFT002
      *================================================================   CFT002
      *                                                                   CFT002
     C           SRTRAN    BEGSR                                          CFT002
      *                                                                   CFT002
      * Clear Retail number and nostro code                               CFT002
      *                                                                   CFT002
     C           *LIKE     DEFN ACNO      ##ACNO                          CFT002
     C                     Z-ADD0         ##ACNO                          CFT002
     C           *LIKE     DEFN A7CYCD    ##NCCY                          CFT002
     C                     MOVEL*BLANKS   ##NCCY                          CFT002
     C           *LIKE     DEFN A7NONB    ##NONB                          CFT002
     C                     MOVEL*BLANKS   ##NONB                          CFT002
      *                                                                   CFT002
      * If TRCODE has no currency exit                                    CFT002
      *                                                                   CFT002
     C                     MOVELTRCODE    TRCDE2                          CFT002
     C           TRCYCD    CABEQ*BLANKS   EXTRAN                          CFT002
      *                                                                   CFT002
      * Find Account details                                              CFT002
      *                                                                   CFT002
     C                     MOVELTRCODE    AKEYF                           CFT002
     C           AKEY      CHAINACCNTABF             80                   CFT002
     C           *IN80     IFEQ '0'                                       CFT002
     C           RECI      ANDEQ'D'                                       CFT002
     C**********           Z-ADDRETNUM    CNUM                                         189639 CSD027
     C                     MOVE RETNUM    CNUM                                                CSD027
     C********** ATYP      ANDEQ'R'                                                    CFT002 189639
     C           ATYP      IFEQ 'R'                                                           189639
     C                     Z-ADDACNO      ##ACNO                          CFT002
     C                     ENDIF                                                              189639
     C                     END                                            CFT002
      *                                                                   CFT002
      * Find Nostro details                                               CFT002
      *                                                                   CFT002
     C                     CALL 'AONOSTR0'                                CFT002
     C                     PARM *BLANKS   RTCD                            CFT002
     C                     PARM '*KEY   ' @OPTN                           CFT002
     C                     PARM CNUMA     @CUST                           CFT002
     C                     PARM CCY       @CYCD                           CFT002
     C                     PARM ACODA     @ACCD                           CFT002
     C                     PARM ACSQA     @ACSN                           CFT002
     C                     PARM *BLANKS   @NONB                           CFT002
     C                     PARM BRCA      @BRCD                           CFT002
     C                     PARM *BLANKS   @CSSN                           CFT002
     C                     PARM *BLANKS   @PNOI                           CFT002
     C           SDNOST    PARM *BLANKS   DSFDY                           CFT002
      *                                                                   CFT002
     C           RTCD      IFEQ *BLANKS                                   CFT002
     C                     MOVELA7CYCD    ##NCCY                          CFT002
     C                     MOVELA7NONB    ##NONB                          CFT002
     C                     END                                            CFT002
      *                                                                   CFT002
     C           EXTRAN    ENDSR                                          CFT002
     C/COPY WNCPYSRC,FT0040C159
      *================================================================   CGL009
      *  Profit center retrieval                                          CGL009
      *================================================================   CGL009
     C           RTPRFC    BEGSR                                          CGL009
      *                                                                   CGL009
      *  Set up subroutine stack name                                     CGL009
      *                                                                   CGL009
     C                     ADD  1         Q                               CGL009
     C                     MOVEL'RTPRFC'  @STK,Q                          CGL009
      *                                                                   CGL009
      ** Inputs                                                           CGL009
      ** ------                                                           CGL009
     C           *LIKE     DEFN U#TRTP    WPYTP                           CGL009
     C           *LIKE     DEFN U#SUTP    WPYST                           CGL009
     C           *LIKE     DEFN U#BOKC    WBOKC                           CGL009
     C           *LIKE     DEFN U#BRAN    WBRCA                           CGL009
     C           *LIKE     DEFN U#DEPT    WDEPT                           CGL009
     C           *LIKE     DEFN U#USER    WUSER                           CGL009
     C           *LIKE     DEFN U#ACOF    WACOF                           CGL009
     C           *LIKE     DEFN U#CUST    WCUST                           CGL009
      ** Outputs                                                          CGL009
      ** -------                                                          CGL009
     C           *LIKE     DEFN U#PRFC    WPRFC                           CGL009
      *                                                                   CGL009
     C                     MOVEL*BLANK    WPRFC                           CGL009
      *                                                                   CGL009
      *  If the profit centre field is blank set to a default only if     CGL009
      *  the Profit Centre Defaults Used flag is set to 'Y'.              CGL009
      *                                                                   CGL009
     C           BKPCDU    IFEQ 'Y'                                       CGL009
      *                                                                   CGL009
      *  Determine parameters to be passed                                CGL009
      *                                                                   CGL009
      *  For Outgoing Payments the Customer and Account Officer will      CGL009
      *  be blank.                                                        CGL009
      *                                                                   CGL009
      *  Get default profit centre                                        CGL009
      *                                                                   CGL009
     C                     CALL 'AOPRFMR0'             90                 CGL009
     C                     PARM *BLANKS   U#RTCD  7        Return Code    CGL009
     C                     PARM WBOKC     U#BOKC  2        Book Code      CGL009
     C                     PARM WPYTP     U#TRTP  5        Transaction TypCGL009
     C                     PARM WPYST     U#SUTP  2        Sub Type       CGL009
     C                     PARM WBRCA     U#BRAN  3        Branch Code    CGL009
     C                     PARM WDEPT     U#DEPT  3        Department CodeCGL009
     C                     PARM WUSER     U#USER 10        User           CGL009
     C                     PARM WACOF     U#ACOF  2        Account OfficerCGL009
     C                     PARM WCUST     U#CUST  6        Customer NumberCGL009
     C           WPRFC     PARM *BLANKS   U#PRFC  4        Profit Centre  CGL009
      *                                                                   CGL009
      *  If error on CALL - process as database error                     CGL009
      *                                                                   CGL009
     C           *IN90     IFEQ '1'                                       CGL009
     C                     MOVEL'AOPRFMR0'W0FILE           ***************CGL009
     C                     MOVEL'*CALL  ' W0KEY            * DB ERROR 70 *CGL009
     C                     Z-ADD70        W0ERNB           ***************CGL009
     C                     EXSR SRERR                                     CGL009
     C                     END                                            CGL009
      *                                                                   CGL009
      * If return code is not blank - exit                                CGL009
      * If no error then the screen field is filled by passed parameter   CGL009
      *                                                                   CGL009
     C           U#RTCD    IFEQ '2'                                       CGL009
     C                     MOVEL*BLANK    WPRFC                           CGL009
     C                     GOTO EXRTPC                                    CGL009
     C                     END                                            CGL009
      *                                                                   CGL009
      *  Validate Profit Centre                                           CGL009
      *                                                                   CGL009
     C                     CALL 'AOPRFCR0'             90                 CGL009
     C                     PARM *BLANKS   U#RTCD  7                       CGL009
     C                     PARM '*KEY'    U#OPTN  7                       CGL009
     C                     PARM WPRFC     U#PRFC  4                       CGL009
     C           SDPRFC    PARM *BLANKS   DSFDY                           CGL009
      *                                                                   CGL009
      *  If error on CALL - process as database error                     CGL009
      *                                                                   CGL009
     C           *IN90     IFEQ '1'                                       CGL009
     C                     MOVEL'AOPRFCR0'W0FILE           ***************CGL009
     C                     MOVEL'*CALL  ' W0KEY            * DB ERROR 72 *CGL009
     C                     Z-ADD71        W0ERNB           ***************CGL009
     C                     EXSR SRERR                                     CGL009
     C                     END                                            CGL009
      *                                                                   CGL009
      * If return code is not blank - exit                                CGL009
      *                                                                   CGL009
     C           U#RTCD    IFNE *BLANKS                                   CGL009
     C                     MOVEL*BLANK    WPRFC                           CGL009
     C                     GOTO EXRTPC                                    CGL009
     C                     END                                            CGL009
      *                                                                   CGL009
     C                     MOVELDSPCCD    WPRFC                           CGL009
      *                                                                   CGL009
     C                     END                                            CGL009
      *                                                                   CGL009
     C           EXRTPC    TAG                                            CGL009
      *                                                                   CGL009
      ** Reset input variables                                            CGL009
     C                     MOVEL*BLANK    WPYTP                           CGL009
     C                     MOVEL*BLANK    WPYST                           CGL009
     C                     MOVEL*BLANK    WBOKC                           CGL009
     C                     MOVEL*BLANK    WBRCA                           CGL009
     C                     MOVEL*BLANK    WDEPT                           CGL009
     C                     MOVEL*BLANK    WUSER                           CGL009
     C                     MOVEL*BLANK    WACOF                           CGL009
     C                     MOVEL*BLANK    WCUST                           CGL009
      *                                                                   CGL009
      *  Unwind subroutine stack name                                     CGL009
      *                                                                   CGL009
     C                     MOVEA*BLANKS   @STK,Q                          CGL009
     C                     SUB  1         Q       50                      CGL009
      *                                                                   CGL009
     C                     ENDSR                                          CGL009
      /EJECT                                                              CGL009
      *================================================================   CGL009
      *  Remove character '/' (for 35 chars)                              CGL009
      *================================================================   CGL009
     C           SLSH35    BEGSR                                          CGL009
      *                                                                   CGL009
      *  Set up subroutine stack name                                     CGL009
      *                                                                   CGL009
     C                     ADD  1         Q                               CGL009
     C                     MOVEL'SLSH35'  @STK,Q                          CGL009
      ** Inputs                                                           CGL009
      ** ------                                                           CGL009
      **                                  @I35                            CGL009
      ** Outputs                                                          CGL009
      ** -------                                                          CGL009
      **                                  @O35                            CGL009
      *                                                                   CGL009
      ** The field must begin with a '/'                                  CGL009
     C           @I35,1    IFNE '/'                                       CGL009
     C                     MOVEA@I35      @O35                            CGL009
     C                     GOTO EXSH35                                    CGL009
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
     C                     MOVEL*BLANK    @O35                            CGL009
     C                     Z-ADD1         I       20                      CGL009
     C           *LIKE     DEFN I         J                               CGL009
      *                                                                   CGL009
     C                     DO   34                                        CGL009
     C           I         ADD  1         J                               CGL009
     C                     MOVEA@I35,J    @O35,I                          CGL009
     C                     ADD  1         I                               CGL009
      ** 10 chars : retail account                                        CGL009
      ** 18 chars : GL account                                            CGL009
     C           @I35,I    IFEQ *BLANK                                    CGL009
     C                     LEAVE                                          CGL009
     C                     ENDIF                                          CGL009
     C                     ENDDO                                          CGL009
      *                                                                   CGL009
     C           EXSH35    TAG                                            CGL009
     C                     MOVEL*BLANK    @I35                            CGL009
      *                                                                   CGL009
      *  Unwind subroutine stack name                                     CGL009
      *                                                                   CGL009
     C                     MOVEA*BLANKS   @STK,Q                          CGL009
     C                     SUB  1         Q       50                      CGL009
      *                                                                   CGL009
     C                     ENDSR                                          CGL009
      *================================================================   CGL009
      *  Retrieve the amount and currency for a given code work /XXXX/    CGL009
      *  inside multiple code work lines                                  CGL009
      *================================================================   CGL009
     C           CWAMCY    BEGSR                                          CGL009
      *                                                                   CGL009
      *  Set up subroutine stack name                                     CGL009
      *                                                                   CGL009
     C                     ADD  1         Q                               CGL009
     C                     MOVEL'CWAMCY'  @STK,Q                          CGL009
      ** Inputs                                                           CGL009
      ** ------                                                           CGL009
      ** Code work lines                                                  CGL009
      **                                  WCWLIN                          CGL009
      ** Code work                                                        CGL009
      **                                  WCW                             CGL009
      ** Outputs                                                          CGL009
      ** -------                                                          CGL009
      ** Currency                                                         CGL009
     C           *LIKE     DEFN SNDCY     WCWCY                           CGL009
      ** Amount                                                           CGL009
     C           *LIKE     DEFN PDAMA     WCWAM                           CGL009
      *                                                                   CGL009
     C                     MOVEL*BLANK    WCWCY                           CGL009
     C                     MOVEL*BLANK    WCWAM                           CGL009
      *                                                                   CGL009
     C           WCW       SCAN WCWLIN:1  @F      30     81               CGL009
     C           *IN81     IFEQ *ON                                       CGL009
      *                                                                   CGL009
     C                     ADD  6         @F                              CGL009
     C           3         SUBSTWCWLIN:@F WCWCY                           CGL009
      * Map amount                                                        CGL009
      * Move possible 15 chars to work array and work string              CGL009
     C                     ADD  3         @F                              CGL009
     C           15        SUBSTWCWLIN:@F @S     15                       CGL009
     C                     MOVEA@S        @A                              CGL009
     C                     CLEAR@S                                        CGL009
      *                                                                   CGL009
      * If ',' in amount string @S change to '.'                          CGL009
      * Only need to check valid chars till one ',' found                 CGL009
     C                     Z-ADD1         @C      30                      CGL009
     C                     MOVE *BLANKS   @T      1                       CGL009
      *                                                                   CGL009
     C           1         DO   15        @C                              CGL009
     C                     MOVE @A,@C     @T                              CGL009
     C           @T        IFEQ ','                                       CGL009
     C                     MOVE '.'       @A,@C                           CGL009
     C                     LEAVE                                          CGL009
     C                     ENDIF                                          CGL009
     C                     ENDDO                                          CGL009
      *                                                                   CGL009
     C                     Z-ADD1         @C                              CGL009
     C                     MOVE *BLANKS   @T      1                       CGL009
     C                     MOVEA@A        @S                              CGL009
      * Get amount - upto 15 chars possible                               CGL009
     C           @C        DOUGT15                                        CGL009
     C                     MOVE @A,@C     @T                              CGL009
     C           @CHK      CHECK@T        @F             82               CGL009
      *                                                                   CGL009
      * Char not valid must be end of amount                              CGL009
     C           *IN82     IFEQ *ON                                       CGL009
     C           @C        IFNE 1                                         CGL009
     C           @C        SUB  1         @F                              CGL009
     C           @F        SUBST@S:1      WCWAM                           CGL009
     C                     ENDIF                                          CGL009
     C                     LEAVE                                          CGL009
     C                     ENDIF                                          CGL009
      * All chars in string ok                                            CGL009
     C           @C        IFEQ 15                                        CGL009
     C                     MOVEL@S        WCWAM                           CGL009
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
     C                     ADD  1         @C                              CGL009
      *                                                                   CGL009
     C                     ENDDO                                          CGL009
      *                                                                   CGL009
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
      ** Reset input variables                                            CGL009
     C                     MOVEL*BLANKS   WCWLIN256                       CGL009
     C                     MOVEL*BLANKS   WCW     6                       CGL009
      *                                                                   CGL009
      *  Unwind subroutine stack name                                     CGL009
      *                                                                   CGL009
     C           EXAMCY    TAG                                            CGL009
     C                     MOVEA*BLANKS   @STK,Q                          CGL009
     C                     SUB  1         Q       50                      CGL009
      *                                                                   CGL009
     C                     ENDSR                                          CGL009
      *================================================================   CGL009
      *  Test if an amount is null                                        CGL009
      *================================================================   CGL009
     C           TSNULL    BEGSR                                          CGL009
      *                                                                   CGL009
      *  Set up subroutine stack name                                     CGL009
      *                                                                   CGL009
     C                     ADD  1         Q                               CGL009
     C                     MOVEL'TSNULL'  @STK,Q                          CGL009
      ** Inputs                                                           CGL009
      ** ------                                                           CGL009
      ** Amount                                                           CGL009
      **                                  WNLAM                           CGL009
      ** Outputs                                                          CGL009
      ** -------                                                          CGL009
      ** Flag Null ? (Y/N)                                                CGL009
      **                                  WNLNUL                          CGL009
      *                                                                   CGL009
     C                     MOVEL'Y'       WNLNUL  1                       CGL009
      *                                                                   CGL009
     C           WNLAM     IFNE *BLANK                                    CGL009
     C                     MOVEAWNLAM     @NL                             CGL009
     C                     DO   15        I                               CGL009
     C           @NUL      CHECK@NL,I                    82               CGL009
     C           *IN82     IFEQ *OFF                                      CGL009
     C                     MOVEL'N'       WNLNUL                          CGL009
     C                     LEAVE                                          CGL009
     C                     ENDIF                                          CGL009
     C                     ENDDO                                          CGL009
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
     C                     MOVEL*BLANK    WNLAM  15                       CGL009
     C                     MOVEL*BLANK    @NL     1                       CGL009
      *                                                                   CGL009
      *  Unwind subroutine stack name                                     CGL009
      *                                                                   CGL009
     C           EXNULL    TAG                                            CGL009
     C                     MOVEA*BLANKS   @STK,Q                          CGL009
     C                     SUB  1         Q       50                      CGL009
      *                                                                   CGL009
     C                     ENDSR                                          CGL009
      *================================================================   175479
      *  Retrieve FONTIS alphanumeric field identified by presence        175479
      *  of codework /XXXX/                                               175479
      *================================================================   175479
     C           CWVAL     BEGSR                                          175479
      *                                                                   175479
      *  Set up subroutine stack name                                     175479
      *                                                                   175479
     C                     ADD  1         Q                               175479
     C                     MOVEL'CWVAL'   @STK,Q                          175479
      ** Inputs                                                           175479
      ** ------                                                           175479
      ** Code work lines                                                  175479
      **                                  WCWLIN                          175479
      ** Code work                                                        175479
      **                                  WCW                             175479
      ** Code work length                                                 175479
      **                                  WCWLEN                          175479
      ** Outputs                                                          175479
      ** -------                                                          175479
      ** An alphanumeric field of max 256 length                          175479
     C           *LIKE     DEFN WCWLIN    WCWVAL                          175479
      *                                                                   175479
      ** Reset temporary variables                                        175479
     C                     MOVEL*BLANK    @CW                             175479
     C                     MOVEL*BLANK    @VL                             175479
     C                     MOVEL*BLANK    WCWVAL                          175479
     C                     Z-ADD0         LN      20                      175479
     C                     Z-ADD0         VL      30                      175479
     C           *LIKE     DEFN VL        LNCW                            175479
     C           *LIKE     DEFN VL        WT                              175479
     C                     Z-ADD0         WT                              175479
     C                     Z-ADD0         LNCW                            175479
      *                                                                   175479
      ** Length of tag containing the code works                          175479
     C           ' '       CHEKRWCWLIN    LNCW                            175479
      *                                                                   175479
      ** Length of search argument                                        175479
     C           ' '       CHEKRWCW       LN                              175479
      *                                                                   175479
     C           WCW:LN    SCAN WCWLIN:1  VL             81               175479
     C           *IN81     IFEQ *ON                                       175479
     C                     MOVEAWCWLIN    @CW                             175479
     C           VL        ADD  LN        VL                              175479
      *                                                                   175479
      ** We start to extract the value right after the code work          175479
      ** (so we need to know the length of the code work)                 175479
      ** We stop extracting when                                          175479
      ** - another / (and therefore another code work) has been found     175479
      ** - we reached the length to extract                               175479
      ** - we reached the length of the tag                               175479
     C           WT        DOWLTWCWLEN                                    175479
     C           VL        ANDLELNCW                                      175479
     C           @CW,VL    ANDNE'/'                                       175479
     C                     ADD  1         WT                              175479
     C                     MOVEL@CW,VL    @VL,WT                          175479
     C                     ADD  1         VL                              175479
     C                     ENDDO                                          175479
     C                     MOVEA@VL       WCWVAL                          175479
     C                     ENDIF                                          175479
      *                                                                   175479
      ** Reset input variables                                            175479
     C                     MOVEL*BLANKS   WCWLIN256                       175479
     C                     MOVEL*BLANKS   WCW     6                       175479
     C                     Z-ADD0         WCWLEN  30                      175479
      *                                                                   175479
      *  Unwind subroutine stack name                                     175479
      *                                                                   175479
     C           EXCWVL    TAG                                            175479
     C                     MOVEA*BLANKS   @STK,Q                          175479
     C                     SUB  1         Q       50                      175479
      *                                                                   175479
     C                     ENDSR                                          175479
      *================================================================   CGL009
      *  Retrieve the rate and the multiply/divide indicator /XXXX/       CGL009
      *  inside multiple code work lines                                  CGL009
      *================================================================   CGL009
     C           CWRATE    BEGSR                                          CGL009
      *                                                                   CGL009
      *  Set up subroutine stack name                                     CGL009
      *                                                                   CGL009
     C                     ADD  1         Q                               CGL009
     C                     MOVEL'CWRATE'  @STK,Q                          CGL009
      *                                                                   CGL009
      ** Inputs                                                           CGL009
      ** ------                                                           CGL009
      ** Code work lines                                                  CGL009
      **                                  WCWLIN                          CGL009
      ** Code work                                                        CGL009
      **                                  WCW                             CGL009
      ** Outputs                                                          CGL009
      ** -------                                                          CGL009
      ** Rate                                                             CGL009
     ***                                  WCWRT                           CGL009
      ** Decimal Position Truncated                                       CGL009
     C           *LIKE     DEFN A6NBDP    WCWDPT                          CGL009
      ** Decimal Position                                                 CGL009
     C           *LIKE     DEFN A6NBDP    WCWDP + 1                       CGL009
      *                                                                   CGL009
     C                     MOVEL*BLANK    WCWRT  14                       CGL009
     C                     Z-ADD0         WCWDPT                          CGL009
     C                     Z-ADD0         WCWDP                           CGL009
      *                                                                   CGL009
     C           WCW       SCAN WCWLIN:1  @F      30     81               CGL009
     C           *IN81     IFEQ *ON                                       CGL009
      *                                                                   CGL009
     C                     ADD  6         @F                              CGL009
      * Map Rate                                                          CGL009
      * Move possible 13 chars to work array and work string              CGL009
     C           13        SUBSTWCWLIN:@F @R     13                       CGL009
     C                     MOVEA@R        @R1                             CGL009
     C                     CLEAR@R                                        CGL009
      *                                                                   CGL009
      * If ',' in rate string @R change to '.'                            CGL009
      * Only need to check valid chars till one ',' found                 CGL009
     C                     Z-ADD1         @C      30                      CGL009
     C                     MOVE *BLANKS   @T      1                       CGL009
      *                                                                   CGL009
     C           1         DO   13        @C                              CGL009
     C           @R1,@C    IFEQ ','                                       CGL009
     C                     MOVE '.'       @R1,@C                          CGL009
      * Retrieve the number of decimal position                           CGL009
     C           @CHK      CHECKR1        @F      30                      CGL009
     C           @F        IFNE 0                                         CGL009
     C           @F        SUB  1         @F                              CGL009
     C           @F        SUB  @C        WCWDP                           CGL009
     C                     ELSE                                           CGL009
     C           13        SUB  @C        WCWDP                           CGL009
     C                     ENDIF                                          CGL009
      ** Decimal position can be handled only on one 1 digit              CGL009
      ** => range 0-9  (otherwise truncated to 9)                         CGL009
     C           WCWDP     IFGT 9                                         CGL009
     C                     Z-ADD9         WCWDPT                          CGL009
     C                     ELSE                                           CGL009
     C                     Z-ADDWCWDP     WCWDPT                          CGL009
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
     C                     LEAVE                                          CGL009
     C                     ENDIF                                          CGL009
     C                     ENDDO                                          CGL009
      *                                                                   CGL009
     C                     Z-ADD1         @C                              CGL009
     C                     MOVE *BLANKS   @T      1                       CGL009
     C                     MOVEA@R1       @R                              CGL009
      * Get amount - upto 13 chars possible                               CGL009
     C           @C        DOUGT13                                        CGL009
     C                     MOVE @R1,@C    @T                              CGL009
     C           @CHK      CHECK@T        @F             82               CGL009
      *                                                                   CGL009
      * Char not valid must be end of rate                                CGL009
     C           *IN82     IFEQ *ON                                       CGL009
     C           @C        IFNE 1                                         CGL009
     C           @C        SUB  1         @F                              CGL009
     C           @F        SUBST@R:1      WCWRT                           CGL009
     C                     ENDIF                                          CGL009
     C                     LEAVE                                          CGL009
     C                     ENDIF                                          CGL009
      * All chars in string ok                                            CGL009
     C           @C        IFEQ 13                                        CGL009
     C                     MOVEL@R        WCWRT                           CGL009
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
     C                     ADD  1         @C                              CGL009
      *                                                                   CGL009
     C                     ENDDO                                          CGL009
      *                                                                   CGL009
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
      ** Reset input variables                                            CGL009
     C                     MOVEL*BLANKS   WCWLIN                          CGL009
     C                     MOVEL*BLANKS   WCW                             CGL009
      *                                                                   CGL009
      *  Unwind subroutine stack name                                     CGL009
      *                                                                   CGL009
     C           EXCWRT    TAG                                            CGL009
     C                     MOVEA*BLANKS   @STK,Q                          CGL009
     C                     SUB  1         Q       50                      CGL009
      *                                                                   CGL009
     C                     ENDSR                                          CGL009
      *================================================================   CGL009
      *  Retrieve the default multiply/divide indicator and rate          CGL009
      *================================================================   CGL009
      *  Retrieve currency details                                        CGL009
      *================================================================   CGL009
     C           RTCCYD    BEGSR                                          CGL009
      *                                                                   CGL009
      *  Set up subroutine stack name                                     CGL009
      *                                                                   CGL009
     C                     ADD  1         Q       50                      CGL009
     C                     MOVEL'RTCCYD'  @STK,Q                          CGL009
      ** Inputs                                                           CGL009
      ** ------                                                           CGL009
      ** Currency                                                         CGL009
     C           *LIKE     DEFN A6CYCD    WCYCCY                          CGL009
      ** Dump flag (Y/N)                                                  CGL009
     C           *LIKE     DEFN WACDMP    WCYDMP                          CGL009
      ** Outputs                                                          CGL009
      ** -------                                                          CGL009
      ** Decimal positions                                                CGL009
     C           *LIKE     DEFN A6NBDP    WCYNDP                          CGL009
      ** Return code                                                      CGL009
     C           *LIKE     DEFN P@RTCD    WCYRTN                          CGL009
      *                                                                   CGL009
     C                     MOVEL*BLANK    WCYNDP                          CGL009
     C                     MOVEL*BLANK    WCYRTN                          CGL009
      *                                                                   CGL009
     C                     CALL 'AOCURRR0'             9090               CGL009
     C                     PARM *BLANKS   RTCD    7                       CGL009
     C                     PARM '*KEY   ' @OPTN                           CGL009
     C                     PARM WCYCCY    @K101   3                       CGL009
     C           SDCURR    PARM *BLANKS   DSSDY                           CGL009
      *                                                                   CGL009
      *  If error on call                                                 CGL009
      *                                                                   CGL009
     C           *IN90     IFEQ '1'                                       CGL009
     C           RTCD      ORNE *BLANKS                                   CGL009
     C                     MOVEL'*ERROR'  WCYRTN                          CGL009
      *                                                                   CGL009
     C           WCYDMP    IFNE 'Y'                                       CGL009
     C                     GOTO EXRCYD                                    CGL009
     C                     ELSE                                           CGL009
      *                                                                   CGL009
     C           *IN90     IFEQ '1'                                       CGL009
     C                     MOVEL'AOCURRR0'W0FILE           ***************CGL009
     C                     MOVEL'*CALL'   W0KEY            * DB ERROR 75 *CGL009
     C                     Z-ADD75        W0ERNB           ***************CGL009
     C                     EXSR SRERR                                     CGL009
     C                     END                                            CGL009
      *                                                                   CGL009
     C           RTCD      IFNE *BLANKS                                   CGL009
     C                     MOVEL'AOCURRR0'W0FILE           ***************CGL009
     C                     MOVELWCYCCY    W0KEY            * DB ERROR 76 *CGL009
     C                     Z-ADD76        W0ERNB           ***************CGL009
     C                     EXSR SRERR                                     CGL009
     C                     END                                            CGL009
      *                                                                   CGL009
     C                     END                                            CGL009
      *                                                                   CGL009
     C                     END                                            CGL009
      *                                                                   CGL009
      *  Move new standing data field into field used in program          CGL009
      *                                                                   CGL009
      *                                                                   CGL009
      * Store Decimal Places Spot Rate                                    CGL009
      *                                                                   CGL009
     C                     Z-ADDA6NBDP    WCYNDP                          CGL009
      *                                                                   CGL009
     C           EXRCYD    TAG                                            CGL009
      *                                                                   CGL009
      ** Reset input variables                                            CGL009
     C                     MOVEL*BLANK    WCYCCY                          CGL009
     C                     MOVEL*BLANK    WCYDMP                          CGL009
      *                                                                   CGL009
      *  Unwind subroutine stack name                                     CGL009
      *                                                                   CGL009
     C                     MOVEA*BLANKS   @STK,Q                          CGL009
     C                     SUB  1         Q       50                      CGL009
      *                                                                   CGL009
     C                     ENDSR                                          CGL009
      *================================================================   CGL009
      *  Retrieve the amount , currency and date in PDCA (tag :32:)       CGL009
      *================================================================   CGL009
     C           RTPDCA    BEGSR                                          CGL009
      *                                                                   CGL009
      *  Set up subroutine stack name                                     CGL009
      *                                                                   CGL009
     C                     ADD  1         Q                               CGL009
     C                     MOVEL'RTPDCA'  @STK,Q                          CGL009
      *                                                                   CGL009
      ** Inputs                                                           CGL009
      ** ------                                                           CGL009
      ** DS for tags  (will NOT be blanked at the end of the S/R)         CGL009
      **                                  DSTRAN                          CGL009
      ** Outputs                                                          CGL009
      ** -------                                                          CGL009
      ** Currency                                                         CGL009
     C           *LIKE     DEFN TVCCY     W32CY                           CGL009
      ** Amount                                                           CGL009
     C           *LIKE     DEFN SMAMA     W32AM                           CGL009
      ** Date                                                             CGL009
     C           *LIKE     DEFN SWDT      W32DT                           CGL009
      ** Day Number                                                       CGL009
     C           *LIKE     DEFN ZDAYNO    W32DYN                          CGL009
      *                                                                   CGL009
     C                     MOVEL*BLANK    W32CY                           CGL009
     C                     MOVEL*BLANK    W32AM                           CGL009
     C                     MOVEL*BLANK    W32DT                           CGL009
     C                     Z-ADD0         W32DYN                          CGL009
      *                                                                   CGL009
      * MMDDYY format display                                             CGL009
      *                                                                   CGL009
     C           *IN98     IFEQ '1'                                       CGL009
     C                     MOVELTVVDAT    SWDT                            CGL009
     C                     MOVE SDD       DD                              CGL009
     C                     MOVE SYY       SDD                             CGL009
     C                     MOVE SMM       SYY                             CGL009
     C                     MOVE SWDT      W32DT                           CGL009
     C                     ELSE                                           CGL009
      *                                                                   CGL009
      * DDMMYY format display                                             CGL009
      *                                                                   CGL009
     C                     MOVELTVVDAT    SWDT                            CGL009
     C                     MOVE SDD       DD                              CGL009
     C                     MOVE SYY       SDD                             CGL009
     C                     MOVE DD        SYY                             CGL009
     C                     MOVE SWDT      W32DT                           CGL009
     C                     END                                            CGL009
      *                                                                   CGL009
     C                     MOVE W32DT     ZDATE                           CGL009
      * Convert it in Midas day number                                    CGL009
     C                     CALL 'ZDATE1'               9090               CGL009
     C                     PARM *BLANKS   ZERR    7                       CGL009
     C                     PARM           ZDATE   60                      CGL009
     C                     PARM WUDFF     ZDATFM  1                       CGL009
     C                     PARM *ZEROS    ZDAYNO  50                      CGL009
      *                                                                   CGL009
      *  If error on call                                                 CGL009
      *                                                                   CGL009
     C           *IN90     IFEQ '1'                                       CGL009
     C                     MOVEL'ZDATE1  'W0FILE           ***************CGL009
     C                     MOVEL'*CALL'   W0KEY            * DB ERROR 78 *CGL009
     C                     Z-ADD78        W0ERNB           ***************CGL009
     C                     EXSR SRERR                                     CGL009
     C                     END                                            CGL009
      *                                                                   CGL009
      * Date invalid => default it (Will be rejected by validation pgm)   CGL009
      *                                                                   CGL009
     C           ZERR      IFEQ '*ERROR*'                                 CGL009
     C                     Z-ADDBJRDNB    W32DYN                          CGL009
     C                     ELSE                                           CGL009
     C                     Z-ADDZDAYNO    W32DYN                          CGL009
     C                     END                                            CGL009
      *                                                                   CGL009
      * Currency                                                          CGL009
      *                                                                   CGL009
     C                     MOVELTVCCY     W32CY                           CGL009
      * Amount                                                            CGL009
      *                                                                   CGL009
      * Format amount field (change ',' decimal point to '.').            CGL009
      *                                                                   CGL009
     C                     MOVEATVAMT     YA1                             CGL009
     C                     Z-ADD1         C       30                      CGL009
      *                                                                   CGL009
     C           C         DOUGT15                                        CGL009
      *                                                                   CGL009
     C           YA1,C     IFEQ ','                                       CGL009
     C                     MOVE '.'       YA1,C                           CGL009
     C                     Z-ADD16        C                               CGL009
     C                     ELSE                                           CGL009
     C                     ADD  1         C                               CGL009
     C                     END                                            CGL009
      *                                                                   CGL009
     C                     END                                            CGL009
      *                                                                   CGL009
     C                     MOVEAYA1       AMT    15                       CGL009
     C                     MOVELAMT       W32AM                           CGL009
      *                                                                   CGL009
      *  Unwind subroutine stack name                                     CGL009
      *                                                                   CGL009
     C           EXPDCA    TAG                                            CGL009
     C                     MOVEA*BLANKS   @STK,Q                          CGL009
     C                     SUB  1         Q       50                      CGL009
      *                                                                   CGL009
     C                     ENDSR                                          CGL009
      *================================================================   175477
      *  Format FONTIS branch bank information                            175477
      *================================================================   175477
     C           FONBNK    BEGSR                                          175477
      *                                                                   175477
      ** Inputs                                                           175477
      ** ------                                                           175477
      ****                                DSTRAN                          175477
      ** Outputs                                                          175477
      ** -------                                                          175477
      ****                                DSTRAN                          175477
      *                                                                   175477
      *  Set up subroutine stack name                                     175477
      *                                                                   175477
     C                     ADD  1         Q                               175477
     C                     MOVEL'FONBNK'  @STK,Q                          175477
      *                                                                   175477
     C                     MOVEL*BLANK    @I35                            175477
      *                                                                   175477
      * If first line is blank we shift the rest of the lines to the      175477
      * top                                                               175477
     C           TMLIN1    IFEQ *BLANK                                    175477
     C                     MOVELTMLIN2    TMLIN1                          175477
     C                     MOVELTMLIN3    TMLIN2                          175477
     C                     MOVELTMLIN4    TMLIN3                          175477
     C                     MOVELTMLIN5    TMLIN4                          175477
     C                     MOVELTMLIN6    TMLIN5                          175477
     C                     ENDIF                                          175477
      *                                                                   175477
      ** Check if the first line can be a swift adress                    175477
      ** If not we leave the procedure                                    175477
     C           ' '       CHEKRTMLIN1    WTMLEN  20                      175477
     C           WTMLEN    IFGT 11                                        175477
     C                     GOTO EXFNBK                                    175477
     C                     ENDIF                                          175477
      *                                                                   175477
     C                     MOVEATMLIN1    @I35                            175477
     C           8         SUBSTI35:1     W9BICC                          175477
     C           3         SUBSTI35:9     W9BICB                          175477
      *                                                                   175477
     C           W9BICB    IFEQ 'XXX'                                     175477
     C                     MOVEL*BLANK    W9BICB                          175477
     C                     ENDIF                                          175477
      *                                                                   175477
     C                     CALL 'ME1400'                                  175477
     C                     PARM *BLANKS   W9RTN   7                       175477
     C                     PARM           W9BICC  8                       175477
     C                     PARM           W9BICB  3                       175477
     C                     PARM           SDCUST                          175477
     C                     PARM           SDCNST                          175477
     C                     PARM           MEBICD                          175477
     C                     PARM *BLANKS   W9CUST  1                       175477
     C                     PARM *BLANKS   W9CNST  1                       175477
     C                     PARM *BLANKS   W9BICD  1                       175477
      *                                                                   175477
      ** If SWIFT ID found, drop the name and address                     175477
      *                                                                   175477
     C           W9RTN     IFEQ *BLANKS                                   175477
     C                     MOVEL*BLANK    TMLIN1                          175477
     C                     MOVELW9BICC    TMLIN1                          175477
     C                     MOVEL*BLANK    TMLIN2                          175477
     C                     MOVEL*BLANK    TMLIN3                          175477
     C                     MOVEL*BLANK    TMLIN4                          175477
     C                     MOVEL*BLANK    TMLIN5                          175477
     C                     MOVEL*BLANK    TMLIN6                          175477
     C                     ENDIF                                          175477
      *                                                                   175477
      *  Unwind subroutine stack name                                     175477
      *                                                                   175477
     C           EXFNBK    TAG                                            175477
     C                     MOVEA*BLANKS   @STK,Q                          175477
     C                     SUB  1         Q       50                      175477
      *                                                                   175477
     C                     ENDSR                                          175477
      *================================================================   CGL009
      *  Retrieve the data of an account                                  CGL009
      *================================================================   CGL009
     C           RTACNT    BEGSR                                          CGL009
      *                                                                   CGL009
      *  Set up subroutine stack name                                     CGL009
      *                                                                   CGL009
     C                     ADD  1         Q                               CGL009
     C                     MOVEL'RTCYAC'  @STK,Q                          CGL009
      *                                                                   CGL009
      ** Inputs                                                           CGL009
      ** ------                                                           CGL009
     C********** *LIKE     DEFN TRCODE    WAC                                          CGL009 CGL029
     C                     MOVE *BLANKS   WAC    24                                           CGL029
      ****                                WACDMP                          CGL009
      ** Outputs                                                          CGL009
      ** -------                                                          CGL009
     C           *LIKE     DEFN IFCCY     WACCY                           CGL009
     C           *LIKE     DEFN IFBRCA    WACBCH                          CGL009
      **                                  WACLN                           CGL009
     C           *LIKE     DEFN P@RTCD    WACRTN                          CGL009
      *                                                                   CGL009
     C                     MOVEL*BLANK    WACCY                           CGL009
     C                     MOVEL*BLANK    WACBCH                          CGL009
     C                     Z-ADD0         WACLN   20                      CGL009
     C                     MOVEL*BLANK    WACRTN                          CGL009
      ** Compute length                                                   CGL009
     C           ' '       CHEKRWAC       WACLN                           CGL009
      ** It is a retail number                                            CGL009
     C           WACLN     IFEQ 10                                        CGL009
     C                     MOVELWAC       P@RETL                          CGL009
     C                     MOVEL*BLANK    P@CNUM                          CGL009
     C                     MOVEL*BLANK    P@CUCD                          CGL009
     C                     MOVEL*BLANK    P@ACCD                          CGL009
     C                     MOVEL*BLANK    P@ACSQ                          CGL009
     C                     MOVEL*BLANK    P@BRCA                          CGL009
     C                     ELSE                                           CGL009
      ** It is a G/L account number                                       CGL009
     C                     MOVEL*BLANK    P@RETL                          CGL009
     C           3         SUBSTWAC:1     P@BRCA                          CGL009
     C           6         SUBSTWAC:4     P@CNUM                          CGL009
     C           3         SUBSTWAC:10    P@CUCD                          CGL009
     C********** 4         SUBSTWAC:13    P@ACCD                                       CGL009 CGL029
     C********** 2         SUBSTWAC:17    P@ACSQ                                       CGL009 CGL029
     C           10        SUBSTWAC:13    P@ACCD                                              CGL029
     C           2         SUBSTWAC:23    P@ACSQ                                              CGL029
     C                     ENDIF                                          CGL009
     C                     CALL 'AOACCTR0'             90                 CGL009
     C                     PARM           P@RTCD  7                       CGL009
     C                     PARM '*KEY   ' P@OPTN  7                       CGL009
     C                     PARM           P@RETL 10                       CGL009
     C                     PARM           P@CNUM  6                       CGL009
     C                     PARM           P@CUCD  3                       CGL009
     C**********           PARM           P@ACCD  4                                    CGL009 CGL029
     C                     PARM           P@ACCD 10                                           CGL029
     C                     PARM           P@ACSQ  2                       CGL009
     C                     PARM           P@BRCA  3                       CGL009
     C                     PARM           ACCINF                          CGL009
      *                                                                   CGL009
     C           P@RTCD    IFNE *BLANK                                    CGL009
     C           *IN90     OREQ '1'                                       CGL009
     C                     MOVEL'*ERROR'  WACRTN                          CGL009
     C           WACDMP    IFEQ 'Y'                                       CGL009
     C                     MOVEL'AOACCTR0'W0FILE                          CGL009
      ** It is a retail number                             ***************CGL009
     C           WACLN     IFEQ 10                         * DB ERROR 74 *CGL009
     C                     MOVELP@RETL    W0KEY     P      ***************CGL009
      ** It is a G/L account number                                       CGL009
     C                     ELSE                                           CGL009
     C                     MOVEL*BLANK    W0KEY                           CGL009
     C           W0KEY     CAT  P@BRCA:0  W0KEY                           CGL009
     C           W0KEY     CAT  P@CNUM:0  W0KEY                           CGL009
     C           W0KEY     CAT  P@CUCD:0  W0KEY                           CGL009
     C           W0KEY     CAT  P@ACCD:0  W0KEY                           CGL009
     C           W0KEY     CAT  P@ACSQ:0  W0KEY                           CGL009
     C                     ENDIF                                          CGL009
     C                     Z-ADD74        W0ERNB                          CGL009
     C                     EXSR SRERR                                     CGL009
     C                     ENDIF                                          CGL009
     C                     ELSE                                           CGL009
     C                     MOVELIFCCY     WACCY                           CGL009
     C                     MOVELIFBRCA    WACBCH                          CGL009
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
      ** Reset input variables                                            CGL009
     C                     MOVEL*BLANK    WAC                             CGL009
     C                     MOVEL*BLANK    WACDMP  1                       CGL009
      *                                                                   CGL009
      *  Unwind subroutine stack name                                     CGL009
      *                                                                   CGL009
     C           EXRTAC    TAG                                            CGL009
     C                     MOVEA*BLANKS   @STK,Q                          CGL009
     C                     SUB  1         Q       50                      CGL009
      *                                                                   CGL009
     C                     ENDSR                                          CGL009
      *                                                                   CGL009
      *================================================================   CGL009
      *  Scan for /OCMT/, /ORIG/, /RATE/                                  CGL009
      *================================================================   CGL009
     C           ICCHK     BEGSR                                          CGL009
     C*                                                                   CGL009
     C                     MOVEL*BLANKS   FOUND   1                       CGL009
     C*                                                                   CGL009
     C           '/RATE/'  SCAN P72:1     @X      30     81               CGL009
     C           *IN81     IFEQ *OFF                                      CGL009
     C           '/ORIG/'  SCAN P72:1     @X             81               CGL009
     C           *IN81     IFEQ *OFF                                      CGL009
     C           '/OCMT/'  SCAN P72:1     @X             81               CGL009
     C                     ENDIF                                          CGL009
     C                     ENDIF                                          CGL009
     C*                                                                   CGL009
     C           *IN81     IFEQ *ON                                       CGL009
     C                     MOVE 'Y'       FOUND                           CGL009
     C                     ENDIF                                          CGL009
     C*                                                                   CGL009
     C                     ENDSR                                          CGL009
     C/COPY WNCPYSRC,FT0040C227
     C*                                                                   CFT012
      *================================================================   CFT012
      *  Default the Settlement Currency                                  CFT012
      *================================================================   CFT012
      *                                                                   CFT012
     C           SRDSCY    BEGSR                                          CFT012
      *                                                                   CFT012
     C           SSMCY     IFEQ *BLANK                                    CFT012
     C                     MOVELSORC1     WAC                             CFT012
     C                     MOVEL'N'       WACDMP                          CFT012
     C                     EXSR RTACNT                                    CFT012
     C           WACRTN    IFEQ *BLANK                                    CFT012
     C                     MOVELIFCCY     SSMCY                           CFT012
     C                     ENDIF                                          CFT012
     C                     ENDIF                                          CFT012
      *                                                                   CFT012
     C           SSMCY     IFEQ *BLANK                                    CFT012
     C                     MOVELOPORB1    WAC                             CFT012
     C                     MOVEL'N'       WACDMP                          CFT012
     C                     EXSR RTACNT                                    CFT012
     C           WACRTN    IFEQ *BLANK                                    CFT012
     C                     MOVELIFCCY     SSMCY                           CFT012
     C                     ENDIF                                          CFT012
     C                     ENDIF                                          CFT012
      *                                                                   CFT012
     C           SSMCY     IFEQ *BLANK                                    CFT012
     C                     MOVELSPCCY     SSMCY                           CFT012
     C                     ENDIF                                          CFT012
      *                                                                   CFT012
     C                     ENDSR                                          CFT012
      *================================================================   CGL009
      *  Overwrite transaction amount                                     CFT014
      *================================================================   CFT014
     C           OV32AM    BEGSR                                          CFT014
      *  Set up subroutine stack name                                     CFT014
     C                     ADD  1         Q                               CFT014
     C                     MOVEL'OV32AM'  @STK,Q                          CFT014
      ** Inputs                                                           CFT014
      ** ------                                                           CFT014
      ** Input amount                                                     CFT014
     C           *LIKE     DEFN W32AM     WOVIAM                          CFT014
      ** Input currency                                                   CFT014
     C           *LIKE     DEFN W32CY     WOVICY                          CFT014
      ** Receiver's Charges amount                                        CFT014
     C           *LIKE     DEFN W32AM     WOVRAM                          CFT014
      ** Receiver's Charges currency                                      CFT014
     C           *LIKE     DEFN W32CY     WOVRCY                          CFT014
      ** Operation                                                        CFT014
     ***                                  WOVOPR                          CFT014
      ** Value date                                                       CFT014
     C           *LIKE     DEFN W32DYN    WOVVLD                          CFT014
      ** Outputs                                                          CFT014
      ** -------                                                          CFT014
      ** Amount overwritten                                               CFT014
     C           *LIKE     DEFN W32AM     WOVAMT                          CFT014
      ** Temporary variables                                              CFT014
      ** -------------------                                              CFT014
      ** Transaction amount numeric format                                CFT014
     C           *LIKE     DEFN P#TOAM    WOVTAN                          CFT014
      ** Receiver's charges amount numeric format                         CFT014
     C           *LIKE     DEFN P#TOAM    WOVRCN                          CFT014
      ** Reset output parameters and temporary variables                  CFT014
     C                     MOVEL*BLANK    WOVAMT                          CFT014
     C                     Z-ADD0         WOVTAN                          CFT014
     C                     Z-ADD0         WOVRCN                          CFT014
      ** If both currencies are the same, we don't need to perform        CFT014
      ** currency conversion before doing operation on the amounts        CFT014
     C           WOVICY    IFEQ WOVRCY                                    CFT014
      ** Retrieve details of transaction currency                         CFT014
     C                     MOVELWOVICY    WCYCCY                          CFT014
     C                     MOVEL'N'       WCYDMP                          CFT014
     C                     EXSR RTCCYD                                    CFT014
     C           WCYRTN    IFEQ *BLANK                                    CFT014
     C                     Z-ADDWCYNDP    TRNBDP                          CFT014
     C                     Z-ADDWCYNDP    RCNBDP                          CFT014
     C                     ENDIF                                          CFT014
      ** Format charges amount                                            CFT014
     C                     MOVEL*BLANK    ZFIELD                          CFT014
     C                     MOVELWOVRAM    ZFIELD                          CFT014
     C           13        SUB  RCNBDP    ZADIG                           CFT014
     C                     Z-ADDRCNBDP    ZADEC                           CFT014
     C                     EXSR ZALIGN                                    CFT014
     C                     MOVE ZFIELD    WOVRCN                          CFT014
      ** Format input amount                                              CFT014
     C                     MOVEL*BLANK    ZFIELD                          CFT014
     C                     MOVELWOVIAM    ZFIELD                          CFT014
     C           13        SUB  TRNBDP    ZADIG                           CFT014
     C                     Z-ADDTRNBDP    ZADEC                           CFT014
     C                     EXSR ZALIGN                                    CFT014
     C                     MOVE ZFIELD    WOVTAN                          CFT014
     C                     SELEC                                          CFT014
     C           WOVOPR    WHEQ '*SUB'                                    CFT014
      ** Final amount = Input amount - Charges amount                     CFT014
     C           WOVTAN    SUB  WOVRCN    WOVTAN                          CFT014
     C           WOVOPR    WHEQ '*ADD'                                    CFT014
      ** Final amount = Input amount + Charges amount                     CFT014
     C           WOVTAN    ADD  WOVRCN    WOVTAN                          CFT014
     C                     ENDSL                                          CFT014
      ** Format Final amount                                              CFT014
     C                     MOVEL*BLANK    ZFIELD                          CFT014
     C                     MOVE WOVTAN    ZFIELD                          CFT014
     C                     Z-ADDTRNBDP    ZADEC                           CFT014
     C                     EXSR ZEDIT                                     CFT014
     C                     MOVE ZFIELD    WOVAMT                          CFT014
     C                     ELSE                                           CFT014
      ** Currencies are different                                         CFT014
      ** Begin to fill parameters for FT0010 (currency conversion)        CFT014
     C                     CLEARP#0010                                    CFT014
     C                     MOVELWOVRCY    P#FRCY                          CFT014
      ** Retrieve details of transaction currency                         CFT014
     C                     MOVELWOVICY    P#TOCY                          CFT014
     C                     MOVELWOVICY    WCYCCY                          CFT014
     C                     MOVEL'N'       WCYDMP                          CFT014
     C                     EXSR RTCCYD                                    CFT014
     C           WCYRTN    IFEQ *BLANK                                    CFT014
     C                     Z-ADDWCYNDP    TRNBDP                          CFT014
     C                     ENDIF                                          CFT014
     C                     Z-ADDWOVVLD    P#FRDT                          CFT014
     C                     Z-ADDWOVVLD    P#TODT                          CFT014
      ** Retrieve details of currency of Receiver's Charges               CFT014
     C                     MOVELWOVRCY    WCYCCY                          CFT014
     C                     MOVEL'N'       WCYDMP                          CFT014
     C                     EXSR RTCCYD                                    CFT014
     C           WCYRTN    IFEQ *BLANK                                    CFT014
     C                     Z-ADDWCYNDP    RCNBDP                          CFT014
      ** Format charges amount                                            CFT014
     C                     MOVEL*BLANK    ZFIELD                          CFT014
     C                     MOVELWOVRAM    ZFIELD                          CFT014
     C           13        SUB  RCNBDP    ZADIG                           CFT014
     C                     Z-ADDRCNBDP    ZADEC                           CFT014
     C                     EXSR ZALIGN                                    CFT014
     C                     MOVE ZFIELD    P#FRAM                          CFT014
      ** Convert the :71G: amount into the :32A: currency                 CFT014
     C                     CALL 'FT0010'                                  CFT014
     C                     PARM           P#0010                          CFT014
     C           P#RTCD    IFNE *BLANK                                    CFT014
     C                     MOVEL'FT0010  'W0FILE           ***************CFT014
     C                     MOVEL'*CALL  ' W0KEY            * DB ERROR 79 *CFT014
     C                     Z-ADD79        W0ERNB           ***************CFT014
     C                     EXSR SRERR                                     CFT014
     C                     ELSE                                           CFT014
     C                     Z-ADDP#TOAM    WOVRCN                          CFT014
      ** Format input amount                                              CFT014
     C                     MOVEL*BLANK    ZFIELD                          CFT014
     C                     MOVELWOVIAM    ZFIELD                          CFT014
     C           13        SUB  TRNBDP    ZADIG                           CFT014
     C                     Z-ADDTRNBDP    ZADEC                           CFT014
     C                     EXSR ZALIGN                                    CFT014
     C                     MOVE ZFIELD    WOVTAN                          CFT014
     C                     SELEC                                          CFT014
     C           WOVOPR    WHEQ '*SUB'                                    CFT014
      ** Final amount = Input amount - Charges amount                     CFT014
     C           WOVTAN    SUB  WOVRCN    WOVTAN                          CFT014
     C           WOVOPR    WHEQ '*ADD'                                    CFT014
      ** Final amount = Input amount + Charges amount                     CFT014
     C           WOVTAN    ADD  WOVRCN    WOVTAN                          CFT014
     C                     ENDSL                                          CFT014
      ** Format Final amount                                              CFT014
     C                     MOVEL*BLANK    ZFIELD                          CFT014
     C                     MOVE WOVTAN    ZFIELD                          CFT014
     C                     Z-ADDTRNBDP    ZADEC                           CFT014
     C                     EXSR ZEDIT                                     CFT014
     C                     MOVE ZFIELD    WOVAMT                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      ** Reset input parameters                                           CFT014
     C                     MOVEL*BLANK    WOVIAM                          CFT014
     C                     MOVEL*BLANK    WOVICY                          CFT014
     C                     MOVEL*BLANK    WOVRAM                          CFT014
     C                     MOVEL*BLANK    WOVRCY                          CFT014
     C                     MOVEL*BLANK    WOVOPR  4                       CFT014
     C                     Z-ADD0         WOVVLD                          CFT014
      ** Unwind subroutine stack name                                     CFT014
     C           EXOV32    TAG                                            CFT014
     C                     MOVEA*BLANKS   @STK,Q                          CFT014
     C                     SUB  1         Q                               CFT014
     C                     ENDSR                                          CFT014
      *================================================================   CFT014
      *  Retrieve the amount , currency in P33B (tag :33B:)               CFT014
      *================================================================   CFT014
     C           RTPCA     BEGSR                                          CFT014
      ** Set up subroutine stack name                                     CFT014
     C                     ADD  1         Q                               CFT014
     C                     MOVEL'RTPCA'   @STK,Q                          CFT014
      ** Inputs                                                           CFT014
      ** ------                                                           CFT014
      ** DS for tags  (will NOT be blanked at the end of the S/R)         CFT014
      **                                  DSTRAN                          CFT014
      ** Outputs                                                          CFT014
      ** -------                                                          CFT014
      ** Currency                                                         CFT014
     C           *LIKE     DEFN TVCCY     WCACY                           CFT014
      ** Amount                                                           CFT014
     C           *LIKE     DEFN SMAMA     WCAAM                           CFT014
     C                     MOVEL*BLANK    WCACY                           CFT014
     C                     MOVEL*BLANK    WCAAM                           CFT014
      ** Currency                                                         CFT014
     C                     MOVELTTCCY     WCACY                           CFT014
      ** Amount                                                           CFT014
      ** Format amount field (change ',' decimal point to '.').           CFT014
     C                     MOVEATTAMT     YA1                             CFT014
     C                     Z-ADD1         C       30                      CFT014
     C           C         DOUGT15                                        CFT014
     C           YA1,C     IFEQ ','                                       CFT014
     C                     MOVE '.'       YA1,C                           CFT014
     C                     Z-ADD16        C                               CFT014
     C                     ELSE                                           CFT014
     C                     ADD  1         C                               CFT014
     C                     ENDIF                                          CFT014
     C                     ENDDO                                          CFT014
     C                     MOVEAYA1       AMT    15                       CFT014
     C                     MOVELAMT       WCAAM                           CFT014
      ** Unwind subroutine stack name                                     CFT014
     C           EX33B     TAG                                            CFT014
     C                     MOVEA*BLANKS   @STK,Q                          CFT014
     C                     SUB  1         Q       50                      CFT014
     C                     ENDSR                                          CFT014
      *================================================================   CFT014
      *  Retrieve the rate of tag :36:                                    CFT014
      *================================================================   CFT014
     C           RT36      BEGSR                                          CFT014
      ** Set up subroutine stack name                                     CFT014
     C                     ADD  1         Q                               CFT014
     C                     MOVEL'RT36'    @STK,Q                          CFT014
      ** Inputs                                                           CFT014
      ** ------                                                           CFT014
      ** Code work lines                                                  CFT014
      **                                  DSTRAN                          CFT014
      ** Outputs                                                          CFT014
      ** -------                                                          CFT014
      ** Rate                                                             CFT014
     C           *LIKE     DEFN SORTE     W36RT                           CFT014
      ** Decimal Position Truncated                                       CFT014
     C           *LIKE     DEFN A6NBDP    W36DPT                          CFT014
      ** Decimal Position                                                 CFT014
     C           *LIKE     DEFN A6NBDP    W36DP + 1                       CFT014
     C                     MOVEL*BLANK    W36RT                           CFT014
     C                     Z-ADD0         W36DPT                          CFT014
     C                     Z-ADD0         W36DP                           CFT014
      ** Map Rate                                                         CFT014
      ** Move possible 12 chars to work array and work string             CFT014
     C           12        SUBSTTMLIN1:1  @R     13                       CFT014
     C                     MOVEA@R        @R1                             CFT014
     C                     CLEAR@R                                        CFT014
      ** If ',' in rate string @R change to '.'                           CFT014
      ** Only need to check valid chars till one ',' found                CFT014
     C                     Z-ADD1         @C      30                      CFT014
     C                     MOVE *BLANKS   @T      1                       CFT014
     C           1         DO   12        @C                              CFT014
     C           @R1,@C    IFEQ ','                                       CFT014
     C                     MOVE '.'       @R1,@C                          CFT014
      ** Retrieve the number of decimal position                          CFT014
     C           @CHK      CHECKR1        @F      30                      CFT014
     C           @F        IFNE 0                                         CFT014
     C           @F        SUB  1         @F                              CFT014
     C           @F        SUB  @C        W36DP                           CFT014
     C                     ELSE                                           CFT014
     C           12        SUB  @C        W36DP                           CFT014
     C                     ENDIF                                          CFT014
      ** Decimal position can be handled only on one 1 digit              CFT014
      ** => range 0-9  (otherwise truncated to 9)                         CFT014
     C           W36DP     IFGT 9                                         CFT014
     C                     Z-ADD9         W36DPT                          CFT014
     C                     ELSE                                           CFT014
     C                     Z-ADDW36DP     W36DPT                          CFT014
     C                     ENDIF                                          CFT014
     C                     LEAVE                                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDDO                                          CFT014
     C                     Z-ADD1         @C                              CFT014
     C                     MOVE *BLANKS   @T      1                       CFT014
     C                     MOVEA@R1       @R                              CFT014
      ** Get amount - upto 12 chars possible                              CFT014
     C           @C        DOUGT12                                        CFT014
     C                     MOVE @R1,@C    @T                              CFT014
     C           @CHK      CHECK@T        @F             82               CFT014
      ** Char not valid must be end of rate                               CFT014
     C           *IN82     IFEQ *ON                                       CFT014
     C           @C        IFNE 1                                         CFT014
     C           @C        SUB  1         @F                              CFT014
     C           @F        SUBST@R:1      W36RT                           CFT014
     C                     ENDIF                                          CFT014
     C                     LEAVE                                          CFT014
     C                     ENDIF                                          CFT014
      ** All chars in string ok                                           CFT014
     C           @C        IFEQ 12                                        CFT014
     C                     MOVEL@R        W36RT                           CFT014
     C                     ENDIF                                          CFT014
     C                     ADD  1         @C                              CFT014
     C                     ENDDO                                          CFT014
      ** Unwind subroutine stack name                                     CFT014
     C           EXRT36    TAG                                            CFT014
     C                     MOVEA*BLANKS   @STK,Q                          CFT014
     C                     SUB  1         Q       50                      CFT014
     C                     ENDSR                                          CFT014
      *================================================================   CGL009
     C           KYFCHG    BEGSR                                          CFT009
      *                                                                   CFT009
     C                     MOVEL'N'       KEYCHG  1                       CFT009
      *                                                                   CFT009
     C           *IN13     IFEQ '1'                                       CFT009
     C***********CDRO      ANDEQ0                                         CFT009              CSD027
     C           CDRO      ANDEQ*BLANKS                                                       CSD027
     C           SADDC     IFNE ADDC                                      CFT009
     C           SMCY      ANDNEPCCY                                      CFT009
      *                                                                   CFT009
     C           SPCCY     ORNE PCCY                                      CFT009
     C           SADDC     ANDEQ'D'                                       CFT009
     C*                                                                   CFT009
     C           SSMCY     ORNE SMCY                                      CFT009
     C           SADDC     ANDEQ'A'                                       CFT009
     C*                                                                   CFT009
     C           WRDFTC    OREQ 'Y'                                       CFT009
     C           SMAM      ORNE SSMAM                                     CFT009
     C           RATE      ORNE SRATE                                     CFT009
     C                     MOVEL'Y'       KEYCHG                          CFT009
     C                     MOVEL'N'       FLAG12                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDSR                                          CFT009
      *================================================================   CFT009
     C           DFTDAT    BEGSR                                          CFT009
      *                                                                   CFT009
     C           SOFCD     IFNE SVDCDE                                    CFT009
     C           PYDT      OREQ *BLANKS                                   CFT009
     C           PYVD      OREQ *BLANKS                                   CFT009
      *                                                                   CFT009
     C           SOFCD     IFNE *BLANKS                                   CFT009
     C           SOFCD     SETLLFTPDOCL0                 70               CFT009
     C           *IN70     IFEQ *ON                                       CFT009
      *                                                                   CFT009
      *                                                                   CFT009
     C                     MOVE RUNN      WPYDT   6                       CFT009
     C                     MOVE RUNN      WPYVD   6                       CFT009
      *                                                                   CFT009
     C                     MOVELSORBK     ORBK                            CFT009
     C                     MOVELSORBT     ORBT                            CFT009
     C                     MOVELSDSTT     DSTT                            CFT009
     C                     MOVELSDST1     DST1                            CFT009
     C                     MOVELSSNCT     SNCT                            CFT009
     C                     MOVELSSNCO     SNCO                            CFT009
     C                     MOVELSORCT     ORCT                            CFT009
     C                     MOVELSORC1     ORC1                            CFT009
     C                     MOVELSPCCY     PCCY                            CFT009
     C                     MOVELSSMCY     SMCY                            CFT009
      *                                                                   CFT009
     C                     MOVELOTPYDS    TRNDET                          CFT009
     C                     MOVELOTPXDS    TRNEXT                          CFT009
      *                                                                   CFT009
     C                     CALL 'FTRTVLOC'                                CFT009
     C                     PARM *BLANKS   RETCDE 10                       CFT009
     C                     PARM 'OP'      TRNTYP  2                       CFT009
     C                     PARM           TRNDET                          CFT009
     C                     PARM           TRNEXT                          CFT009
     C                     PARM *BLANKS   SETLOC  3                       CFT009
     C                     PARM *BLANKS   PAYLOC  3                       CFT009
      *                                                                   CFT009
     C                     CALL 'FT000983'                                CFT009
     C                     PARM           RETCDE                          CFT009
     C                     PARM           SOFCD                           CFT009
     C                     PARM           WPYDT                           CFT009
     C                     PARM           WPYVD                           CFT009
     C                     PARM           SMCY                            CFT009
     C                     PARM           PCCY                            CFT009
     C                     PARM           SETLOC                          CFT009
     C                     PARM           PAYLOC                          CFT009
      *                                                                   CFT009
     C           WPYDT     IFNE *BLANKS                                   CFT009
     C           PYDT      ANDEQ*BLANKS                                   CFT009
     C                     MOVE WPYDT     PYDT                            CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C           WPYVD     IFNE *BLANKS                                   CFT009
     C           PYVD      ANDEQ*BLANKS                                   CFT009
     C                     MOVE WPYVD     PYVD                            CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      *                                                                   CFT009
      ** If screen date offset code is a valid one, check to see if       CFT009
      ** it is the same as the defaulted offset code. If not, issue a     CFT009
      ** warning message else, if screen offset code is blank move        CFT009
      ** the default code into screen field.                              CFT009
      *                                                                   CFT009
     C           SOFCD     IFNE *BLANKS                                   CFT009
      *                                                                   CFT009
     C           SOFCD     IFNE DFTPDO                                    CFT009
     C                     MOVE *ON       *IN84                           CFT009
     C                     MOVEL'Y'       FTWARN                          CFT009
     C                     MOVEL'FTF3222' FTMSID                          CFT009
     C                     EXSR FTSNMS                                    CFT009
     C                     MOVE SOFCD     OTPDOF                          CFT009
     C                     MOVE SOFCD     SVDCDE  5                       CFT009
     C                     ELSE                                           CFT009
     C                     MOVE SOFCD     OTPDOF                          CFT009
     C                     MOVE *OFF      *IN84                           CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
      *                                                                   CFT009
     C                     MOVE OTPDOF    SOFCD                           CFT009
     C                     MOVE *OFF      *IN84                           CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDSR                                          CFT009
      *================================================================   CFT009
     C           DFTSPR    BEGSR                                          CFT009
      *                                                                   CFT009
      ** If screen spread set <> defaulted spread set, issue warning      CFT009
      ** message else if screen spread set is blank and pay ccy <>        CFT009
      ** settle ccy, move it into screen field                            CFT009
      *                                                                   CFT009
     C           SPDSET    IFNE *BLANKS                                   CFT009
     C           RATEA     OREQ *BLANKS                                   CFT009
      *                                                                   CFT009
     C           *LIKE     DEFN RATE      WRKRAT                          CFT009
      *                                                                   CFT009
     C           SPDSET    IFNE FXSRSC                                    CFT009
     C           SPDSET    SETLLFTXTRHL0                 70               CFT009
      *                                                                   CFT009
     C           *IN70     IFEQ *ON                                       CFT009
      *                                                                   CFT009
     C                     Z-ADDRATE      WRKRAT                          CFT009
      *                                                                   CFT009
     C                     CALL 'FT000982'                                CFT009
     C                     PARM           RETCDE                          CFT009
     C                     PARM           SPDSET                          CFT009
     C                     PARM           PCCY                            CFT009
     C                     PARM           SMCY                            CFT009
     C                     PARM           WRKRAT                          CFT009
     C                     PARM 'M'       STP     1                       CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C           SPDSET    IFNE FXSRSC                                    CFT009
     C                     MOVE *ON       *IN73                           CFT009
     C                     MOVEL'Y'       FTWARN                          CFT009
     C                     MOVEL'FTF3154' FTMSID                          CFT009
     C                     EXSR FTSNMS                                    CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C           RATEA     IFEQ *BLANKS                                   CFT009
     C                     MOVEL*BLANK    ZFIELD                          CFT009
     C                     MOVE WRKRAT    ZFIELD                          CFT009
     C                     Z-ADD8         ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    RATEA                           CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** If screen rate <> calculated rate, issue warning message         CFT009
      ** else if screen rate is blank, move calculated rate in and        CFT009
      ** calculated pay amount                                            CFT009
      *                                                                   CFT009
     C           DEFRAT    IFEQ *BLANKS                                   CFT009
     C                     MOVEL*BLANK    ZFIELD                          CFT009
     C                     MOVE RATE      ZFIELD                          CFT009
     C                     Z-ADD8         ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    C#RATE 14                       CFT009
      *                                                                   CFT009
     C           C#RATE    IFNE RATEA                                     CFT009
     C           RATEA     ANDNE*BLANKS                                   CFT009
     C                     MOVE *ON       *IN31                           CFT009
     C                     MOVEL'Y'       FTWARN                          CFT009
     C                     MOVEL'FTF0012' FTMSID                          CFT009
     C                     EXSR FTSNMS                                    CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      *                                                                   CFT009
     C           RATE      IFNE 0                                         CFT009
     C                     Z-ADDRATE      SRATE                           CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      * If not default code AND rate = blank, set to current default      CFT009
     C           RATEA     IFEQ *BLANKS                                   CFT009
      *                                                                   CFT009
      ** If screen rate is blank, AND we're not amending then change      CFT009
      ** RATEA, otherwise leave it as it is.                              CFT009
      *                                                                   CFT009
     C           ACTION    ANDNE'A'                                       CFT009
      *                                                                   CFT009
     C                     Z-ADDSRATE0    RATE                            CFT009
     C                     MOVEL*BLANK    ZFIELD                          CFT009
     C                     MOVE SRATE0    ZFIELD                          CFT009
     C                     Z-ADD8         ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    RATEA                           CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDSR                                          CFT009
      *****************************************************************                       CGL029
      /EJECT                                                                                  CGL029
      *****************************************************************                       CGL029
      *                                                               *                       CGL029
      *  SRACCT - Moves relevant account data.                        *                       CGL029
      *                                                               *                       CGL029
      *****************************************************************                       CGL029
     C           SRACCT    BEGSR                                                              CGL029
      *                                                                                       CGL029
     C                     MOVE W#CNU1    C#CNU1                                              CGL029
     C                     MOVE W#CCY1    C#CCY1                                              CGL029
     C                     MOVE W#ACO1    C#ACO1                                              CGL029
     C                     MOVE W#ACS1    C#ACS1                                              CGL029
     C                     MOVE W#BRC1    C#BRC1                                              CGL029
      *                                                                                       CGL029
     C                     ENDSR                                                              CGL029
      *****************************************************************                       CGL029
      /EJECT                                                                                  CGL029
      *================================================================   CFT009
     C/EJECT                                                                                  CRE008
      *****************************************************************                       CRE008
      *                                                               *                       CRE008
      *  OVDRLT - Check group account overdraft limit                 *                       CRE008
      *                                                               *                       CRE008
      *****************************************************************                       CRE008
      *                                                                                       CRE008
     C           OVDRLT    BEGSR                                                              CRE008
      *                                                                                       CRE008
     C                     MOVEL'RE10'    WPGM    8                                           CRE008
     C                     MOVE '1901'    WPGM                                                CRE008
     C                     CALL WPGM                                                          CRE008
      ** Input parameters                                                                     CRE008
     C                     PARM *BLANKS   PRCODE  7                                           CRE008
     C                     PARM           PIBRCH                                              CRE008
     C                     PARM           PICUST                                              CRE008
     C                     PARM           PICURR                                              CRE008
     C                     PARM           PIACOD                                              CRE008
     C                     PARM           PIACSQ                                              CRE008
     C                     PARM           PSETAM                                              CRE008
      ** Output parameters                                                                    CRE008
     C                     PARM           POBRCH  3                                           CRE008
     C**********           PARM           POCUST  60                                   CRE008 CSD027
     C                     PARM           POCUST  6                                           CSD027
     C                     PARM           POCURR  3                                           CRE008
     C**********           PARM           POACOD  40                                   CRE008 CGL029
     C                     PARM           POACOD 100                                          CGL029
     C                     PARM           POACSQ  20                                          CRE008
     C                     PARM           PORETN 100                                          CRE008
      *                                                                                       CRE008
     C           PRCODE    IFEQ '*ODLMTX'                                                     CRE008
     C                     SETON                     252872                                   CRE008
     C                     MOVE 'Y'       FTWARN                                              CRE008
     C                     MOVE POBRCH    WBRCDE                                              CRE008
     C                     MOVE '-'       WDASH1                                              CRE008
     C                     MOVE POCUST    WCUSTN                                              CRE008
     C                     MOVE '-'       WDASH2                                              CRE008
     C                     MOVE POCURR    WCURR                                               CRE008
     C                     MOVE '-'       WDASH3                                              CRE008
     C                     MOVE POACOD    WACOD                                               CRE008
     C                     MOVE '-'       WDASH4                                              CRE008
     C                     MOVE POACSQ    WACSQ                                               CRE008
     C                     MOVE '/'       WSLSH                                               CRE008
     C                     MOVE PORETN    WRETN                                               CRE008
      *                                                                                       CRE008
     C           PORETN    IFEQ *ZERO                                                         CRE008
     C                     MOVELWMDTA1    PMSGDT                                              CRE008
     C                     ELSE                                                               CRE008
     C                     MOVELWMDTA2    PMSGDT                                              CRE008
     C                     ENDIF                                                              CRE008
      *                                                                                       CRE008
     C                     CALL 'ZA0350'                                                      CRE008
     C                     PARM 'FTUSRMSG'PMSGFL 10                                           CRE008
     C                     PARM 'FTA0131' PMSGID 10                                           CRE008
     C                     PARM           PMSGDT 45                                           CRE008
     C                     ENDIF                                                              CRE008
      *                                                                                       CRE008
     C                     ENDSR                                                              CRE008
      *****************************************************************                       CRE008
     C/EJECT                                                              S01435
     C/COPY WNCPYSRC,FT0040C289
     OOTPAYDDFE                OUTPAY
      ************                                                        031876
      ************  Remove PRONO OLPOS and MEMOS                          031876
      ************                                                        031876
     O*PRONOPNFE***             RPRONO                                    031876
     O*OLPOSOAFE***             ROLPOS                                    031876
     O/COPY WNCPYSRC,FT0040DOPG                                           S01435
      *                                                                   S01435
      *  /Copy point for Outputs                                          S01435
      *                                                                   S01435
     O/EJECT                                                              S01435
     O**   PYFQ - PAYMENT FREQUENCY VALUES                                062394
     O*ABDFLMQRSTWXY                                                      062394
      *                                                                   S01408
     O/COPY WNCPYSRC,FT0040OPG                                            S01408
      *                                                                   S01408
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
**   NDY  - DAY IN MONTH TABLE
01020304050607080910111213141516171819202122232425262728293031
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
**   POWER - ARRAY OF POWERS OF 10 FOR CURRENCY CONVERSIONS
0000001
0000010
0000100
0001000
0010000
0100000
1000000
**   ZFMD  -  NUMBER OF DAYS IN THE MONTH
312831303130313130313031
**   SWCH  - ARRAY OF VALID SWIFT CHARACTER
ABCDEFGHIJKLMNOPQRSTUVWXYZ 1234567890/-?:().,'+
**   POWERS(FOR CHARGES CONVERSION ROUTINES)
0000010
0000100
0001000
0010000
0100000
1000000
**   FCTR - ARRAY OF POWERS OF 10 FOR DAF CONVERSIONS
0001
0010
0100
1000
**  Error text                                                            031876
Error occurred on call to program - see dumps for further details
** STAMP - Dummy timestamp                                                                    202937
0001-01-01-00.00.00.000000                                                                    202937
