     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas FT FT0050   payments maintenance level 1')       *
      *****************************************************************
      *                                                               *
      *  Midas - Funds Transfer Module                                *
      *                                                               *
      *  FT0050 - Incoming Payments Maintenance                       *
      *                                                               *
      *  (c) Finastra International Limited 2001                      *
      *                                                               *
      *  Last Amend No. AR928996A          Date 03May12               *
      *  Prev Amend No. AR928996           Date 27Mar12               *
      *                 CSW220             Date 09Mar20               *
      *                 MD046248           Date 27Oct17               *
      *                 CFT050             Date 03Jun13               *
      *                 AR895223           Date 19Nov12               *
      *                 CLE134             Date 01Aug12               *
      *                 AR787620           Date 10Jun11               *
      *                 CRE075             Date 06Dec10               *
      *                 CER059             Date 19Jul10               *
      *                 CER047             Date 19May08               *
      *                 CER030             Date 09Jul08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      *                 CAP205             Date 03Mar10               *
      *                 CAP204             Date 09Feb10               *
      *                 BUG24998           Date 17Jul09               *
      *                 CSW209             Date 01Apr09               *
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 CRE026             Date 24May06               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CFT032             Date 11Sep06               *
      *                 CSD031             Date 10Apr06               *
      *                 BUG433             Date 02Dec05               *
      *                 CDL049             Date 06Jul06               *
      *                 CDL038             Date 10May05               *
      *                 CSD027             Date 09Dec05               *
      *                 CSW037A            Date 02May05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 BUG3644            Date 12Jul04               *
      *                 CTI004             Date 27May04               *
      *                 CLE025             Date 20Oct03               *
      *                 TDA035             Date 02Apr04               *
      *                 CSC022             Date 24Feb04               *
      *                 CGL029             Date 01Sep03               *
      *                 CRE008             Date 19Feb02               *
      * Midas Release 4.01.02 ----------------------------------------*
      *                 203825             Date 07Oct02               *
      * Midas Release 4.01 -------------------------------------------*
      *                 CPK015             Date 17Jun02               *
      * Midas Release 4 --------------- Base -------------------------*
      *                 CPK014             Date 04Oct01               *
      * Midas DBA 3.05 -----------------------------------------------*
      *                 CFT009             Date 14Aug00               *
      *                 189639             Date 02Apr01               *
      *                 179420             Date 28Mar01               *
      * Midas DBA 3.04 -----------------------------------------------*
      *                 186787             Date 08Dec00               *
      *                 183200             Date 31Aug00               *
      *                 CFT014             Date 25May00               *
      * Midas DBA 3.03 -----------------------------------------------*
      *                 CFT012             Date 08Jun00               *
      *                 CAP136             Date 15Nov99               *
      *                 175475             Date 21Jan00               *
      *                 175479             Date 21Jan00               *
      *                 175474             Date 21Jan00               *
      *                 181723             DATE 21Jul00               *
      *                 179732             DATE 15Mar00               *
      *                 CFT007             Date 03Nov99               *
      *                 124674             DATE 12Nov97               *
      * Midas DBA 3.02 -----------------------------------------------*
      *                 CPB001             Date 25Feb00               *
      *                 CAP035             Date 25Feb00               *
      *                 156473             Date 04Oct99               *
      *                 CFT004             DATE 27Jul99               *
      * Midas DBA 3.01 -----------------------------------------------*
      *                 CGL007             Date 26Mar99               *
      *                 CGL009             Date 18May99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 149316             Date 27Apr99               *
      *                 CFT003             Date 25Nov98               *
      *                 CFT002             Date 25Nov98               *
      *                 133420             DATE 06OCT98               *
      *                 148229             DATE 13DEC98               *
      *                 150204             DATE 09DEC98               *
      *                 145199             DATE 16OCT98               *
      *                 145900             DATE 23OCT98               *
      *                 140623             DATE 18SEP98               *
      *                 140655             DATE 18Aug98               *
      *                 CEU006             DATE 24MAR98               *
      *                 113477             DATE 19Feb98               *
      *                 112287             DATE 19FEB98               *
      *                 106208             DATE 22MAY97               *
      *                 120827             Date 06Jul97               *
      *                 100660             DATE 06MAY97               *
      *                 103715             DATE 17APR97               *
      *                 097263             DATE 10APR97               *
      *                 096486             DATE 02APR97               *
      *                 CRT002             DATE 01DEC95               *
      *                 CAC001             DATE 01FEB96               *
      *                 095075             DATE 23JAN96               *
      *                 093958             DATE 17JAN96               *
      *                 094824             DATE 29OCT95               *
      *                 S01408             DATE 10NOV95               *
      *                 084499             DATE 18APR95               *
      *                 S01408             DATE 10MAR95               *
      *                 079909             DATE 05DEC94               *
      *                 074813             DATE 01AUG94               *
      *                 074810             DATE 01AUG94               *
      *                 074812             DATE 01AUG94               *
      *                 S01508             DATE 27JUN94               *
      *                 S01506             DATE 27JUN94               *
      *                 S01499             DATE 06JUN94               *
      *                 S01494             DATE 25MAY94               *
      *                 068347             DATE 18MAR94               *
      *                 068320             DATE 17MAR94               *
      *                 068230             DATE 22JAN94               *
      *                 068093             DATE 22DEC93               *
      *                 S01435             DATE 23JUL93               *
      *                 S01428             DATE 23JUN93               *
      *                 S01408             DATE 01OCT93               *
      *                 046303             DATE 16JAN94               *
      *                 060108             DATE 23JUN93               *
      *                 S01408             DATE 16JUN93               *
      *                 S01408             DATE 14JUN93               *
      *                 053418             DATE 03JUN93               *
      *                 056031             DATE 01JUN93               *
      *                 053348             DATE 27MAY93               *
      *                 055293             DATE 14MAY93               *
      *                 055201             DATE 12MAY93               *
      *                 046270             DATE 07MAY93               *
      *                 047179             DATE 29APR93               *
      *                 042167             DATE 15APR93               *
      *                 S01414             DATE 07APR93               *
      *                 051173             DATE 17OCT90               *
      *                 034175             DATE 22FEB93               *
      *                 034119             DATE 22FEB93               *
      *                 E38323             DATE 30JUL92               *
      *                 E37529             DATE 23MAR92               *
      *                 E37171             DATE 18MAR92               *
      *                 E36197             DATE 20FEB92               *
      *                 S01259             DATE 24OCT91               *
      *                 E29970             DATE 20JUN91               *
      *                 E32878             DATE 05JUN91               *
      *                 E32880             DATE 04JUN91               *
      *                 E32531             DATE 19APR91               *
      *                 E32532             DATE 19APR91               *
      *                 E32536             DATE 18JAN91               *
      *                 E32543             DATE 18APR91               *
      *                 E29837             DATE 23NOV90               *
      *                 E23768             DATE 04OCT90               *
      *                 E23411             DATE 06SEP90               *
      *                 E23285             DATE 13AUG90               *
      *                 E22989             DATE 31JUL90               *
      *                 E22881             DATE 20JUL90               *
      *                 S01195             DATE 10JUL90               *
      *                 S01117             DATE 22JUN90               *
      *                 S01194             DATE 22JUN90               *
      *                 E21888             DATE 31MAY90               *
      *                 E21453             DATE 23APR90               *
      *                 E21452             DATE 09APR90               *
      *                 E16603             DATE 03FEB90               *
      *                 S01252             DATE 03FEB90               *
      *                 S01251             DATE 03FEB90               *
      *                 E16366             DATE 30JAN90               *
      *                 E20864             DATE 25JAN90               *
      *                 S01241             DATE 08JAN90               *
      *                 S01199             DATE 17/08/89              *
      *                                                               *
      *---------------------------------------------------------------*
      *                                                               *
      *  AR928996A- Data truncation error. Amended PDATA and PDAT2    *
      *             data structure field to have the correct length.  *
      *             (Child: AR928997A)                                *
      *  AR928996 - Data lost due to rate field :36: being truncated. *
      *             (Child: AR928997)                                 *
      *  CSW220 - SWIFT Changes 2020 (Recompile)                      *
      *  MD046248 - Finastra Rebranding                               *
      *  CFT050 - SWIFTRef Directories upload                         *
      *  AR895223 - Exchange rates should allow 5 digits. Fix is to   *
      *             increase the number of digits to five. Applied    *
      *             fix 257663. (Child: AR895224)                     *
      *  CLE134 - Past Due Call Loan Processing                       *
      *  AR787620 - Hooks Incorporation                               *
      *             WNCPYSRC,FTH00097                                 *
      *             WNCPYSRC,FTH00098                                 *
      *  CRE075 - Effective Date for Retail Accounts                  *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  CER047 - German Features LF037-00 Reporting §24c KWG         *
      *  CER030 - Multicash German Feature (Recompile)                *
      *  CAP205 - Teller Related APIs - Account Balance Check         *
      *  CAP204 - Teller Related APIs - Account Transfer              *
      *  BUG24998 - Bank operation code is missing (Recompile)        *
      *  CSW209 - SWIFT 2009 Changes                                  *
      *  CRE026 - Consumer Banking (Recompile)                        *
      *  CFT032 - Account Line in Field 50X in MT103                  *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  BUG433 - Recompiled due to change in FTXTRHPD & FTPCHGPD     *
      *  CDL049 - Addition of a Reference Rate field (recompile)      *
      *  CDL038 - Extended Deal Sub Type                              *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  BUG3644 - Serious Error in Collateralised Lending (Recompile)*
      *  CTI004 - MidasPlus TI Integration Enhancements               *
      *  CLE025 - Credit Lines                                        *
      *  TDA035 - RTS Signon changes for MidasPlus. (Recompile)       *
      *  CSC022 - Commitment Control Changes for MidasPlus            *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  CRE008 - Cash Management                                     *
      *  203825 - Recompiled due to changes made in DSPF/FT0050DF.    *
      *  CPK015 - Release 4.01 Packaging:                             *
      *         - Additional timestamp processing.                    *
      *  CPK014 - Release 4 packaging.  Rename of timestamp field.    *
      *           - A default timestamp string is required for        *
      *             file INPAYXPD write.                              *
      *  CFT009 - Fees and Charges Development                        *
      *  189639 - Database error during deletion of incomplete        *
      *           Incoming Payment.  Extended fix 179732.             *
      *  179420 - No Error message on Blocked retail account when an  *
      *           Incoming Payment is processed. Add message file     *
      *           processing. Partly apply fixes 164635 and 144936.   *
      *  186787 - Error on FT0050, I/O operation was applied to       *
      *           closed file INPAYXL0.                               *
      *  183200 - Shadow posting for Charges not reversed out.        *
      *  CFT014 - Straight-through Processing Phase 2 MT103           *
      *           Messages Generation for FT.                         *
      *  CFT012 - Cross currency transfers                            *
      *  CAP136 - Conversion of FT Incoming Payment inputs into       *
      *           modular structure to use as APIs.                   *
      *           Recompiled due to changes to file INPAYDD.          *
      *  175475 - FONTIS : Settlement ccy defaulted by /ORIG/         *
      *  175479 - FONTIS : dealer's reference field                   *
      *  175474 - FONTIS : Invalid A/C in :53a:                       *
      *  181723 - Condition default fields for CFT002 on CFT002       *
      *  179732 - Duplicate of 176510                                 *
      *           Based on Fixes 162419 (175306) added to core. These *
      *           consist of fixes 162507, 156861 and 135950. These   *
      *           Fix profit centre defaulting for 'Beneficiary'      *
      *           field and 'Account with Bank' field entries.        *
      *           Only process 'A/c with Bank' defaulting if the      *
      *           Beneficiary is not equal to 'MT202'.                *
      *           Profit centre should be defaulted using the         *
      *           'Profit Centre Default Matrix'; If action is INPUT  *
      *           and the profit centre field on the screen is left   *
      *           blank.                                              *
      *           Also Fix 171062 which assigns the default           *
      *           profit centre when beneficiary and account with     *
      *           bank is validated. Defaulting only when Book Code   *
      *           valid also added                                    *
      *  CFT007 - BIC Database Plus Integration                       *
      *  124674 - Extension of 095075. Allow execution of charge      *
      *           conversion subroutine when amendment is made.       *
      *           Apply 093418. Default charges on amendment of       *
      *           exchange rate.                                      *
      *  CPB001 - Rename new field in ACCNTAB and ACCNT:              *
      *           (REPI)                                              *
      *  CAP035 - Rename new fields in ACCNTAB and ACCNT:             *
      *           (FRNT, AFRT and REPA)                               *
      *  156473 - Remove *in51 and *in57 before geting the default    *
      *           rate. Applied fix 150874.                           *
      *  CFT004 - International Bank Account Number                   *
      *           Check if Beneficiary is a valid IBAN                *
      *  CGL007 - Account Postings Enquiry                            *
      *  CGL009 - Midas-Fontis Inter-Account Transfers (IAT) and      *
      *           Third Party Payments (TPP) Interface                *
      *  149316 - Notified Delivery currency amount not being         *
      *           initialised.                                        *
      *  CFT003 - FT Batch Authorisation and Settlement Method '14'   *
      *  CFT002 - Straight Through Processing Phase 1                 *
      *  133420 - 079909 stops user from overriding warning errors.   *
      *  148229 - Changes to /COPY FT0010I001 (Recompile only)        *
      *  150204 - Alter call to AOCURRPD to prevent database error    *
      *           when SWIFT routed currencies are not on Midas       *
      *           database.                                           *
      *  145199 - Recompile for changes to MEINCRPD and MEINMPPD made *
      *           in Year 2000 fix 124673.                            *
      *  145900 - Addition to CEU006                                  *
      *  140623 - Extract /OCMT/ correctly from field 72. This was    *
      *           failing if /OCMT/ was not in the first line.        *
      *  140655 - PSNAR always defaulted in sender address line 2.    *
      *           Do this defaulting only if the sender is CASHIER.   *
      *  CEU006 - EMU funds transfer Enhancements                     *
      *  113477 - Allow reciprocal rate to be entered.                *
      *  112287 - If Rate calculed is LT 1 and rate entered is GT 1   *
      *           or vice versa, do not reverse Mult/Divide ind.      *
      *  120827 - Profit Centre Accounting defaulting                 *
      *  106208 - Rename CQCH when reading PYCHGDB, otherwise extra   *
      *           RSACMTPD posting is produced by FT0355, due to CQCH *
      *           in INPAYDD being incorrectly entered.               *
      *  100660 - Recalculate charges if the settlement amount        *
      *           has changed.                                        *
      *  103715 - WHITE BAND UNDER PAYMENT ON THE SCREEN FOR ACTION   *
      *           CODES A,E AND D.                                    *
      *  097263 - Selecting several electronic messages (after '?'    *
      *           in SWIFT ref.), the first selected message is       *
      *           repeatedly displayed for processing.                *
      *  096486 - Previous fix. 065890.                               *
      *           To enable user to enquire on FT payments for FT     *
      *           postings.                                           *
      *  CRT002 - Retail Branch Access.                               *
      *  CAC001 - Profit Centre Accounting Development:               *
      *           If Analytical Accounting is installed and there's   *
      *           a change in currencies, amounts or rate and the     *
      *           Margin Information details are not blanks, display  *
      *           Margin Info window if necessary.  Provide another   *
      *           parameter so that margin info details can be passed *
      *           between FT0040 and FT0345.                          *
      *  095075 - Recalculate charges if the settlement amount        *
      *           has changed.                                        *
      *  093958 - Payment input does not check against the payment    *
      *           type sub-type combination table                     *
      *  094824 - Incoming payment input: error reported when rate    *
      *           entered was within the allowed range                *
      *  S01408 - Core hook FT0050CCP2  added                         *
      *           Core hook FT0050CCP3  added                         *
      *           Core hook FT0050CCP4  added                         *
      *           Core hook FT0050CCP5  added                         *
      *           Core hook FT0050CCP6  added                         *
      *           Core hook FT0050CCP7  added                         *
      *           Core hook FT0050CCP8  added                         *
      *  084499 - Access SDRETLPD only if RETAIL switched on.         *
      *  S01408 - Addition of Core Hooks  FT0050CCPG                  *
      *                                   FT0050CCP1                  *
      *  079909 - Output information message rather than database     *
      *           error message if no payment/charges record exists   *
      *           this branch.                                        *
      *  074813 - Beneficiary remains highlighted after pressing F12  *
      *           if the field was previously in error                *
      *           Fixed during development of S01494                  *
      *  074810 - After chaining to MUSERDD, check if RECI = 'D'      *
      *           Fixed during development of S01494                  *
      *  074812 - EXFMT of first screen removed from #LADDI subroutine*
      *           Fixed during development of S01494                  *
      *  S01508 - BLI Extended Payments Charges                       *
      *  S01506 - BLI Payments Charges Enhancements                   *
      *  S01499 - BLI V.A.T. Processing                               *
      *  S01494 - BLI Funds Transfer Enhancements                     *
      *         - Command keys must be loaded from message files      *
      *           for multi-language purposes                         *
      *  068347 - Suppress Account movement duplicates.               *
      *  068320 - Show charge movements                               *
      *  068230 - Allow SWIFT address in Sender                       *
      *  068093 - CQCHD being used from PYCHGDB                       *
      *  S01435 - Incoming Message Management.                        *
      *  046303 - /COPY source subr. ZFWDT amended to prevent array   *
      *           error if no holiday record found - fixed by S01434. *
      *           Program recompiled.                                 *
      *  S01408 - Core hook FT0050CL1W MOVED                          *
      *           Core hook FT0050FPG  added                          *
      *           Core hook FT0050CCBU added                          *
      *  060108 - Apply S01428                                        *
      *  S01428 - Include Incoming Electronic Messages Enquiry        *
      *           and Select processing.                              *
      *  S01408 - Core hook FT0050CL1W added                          *
      *  S01408 - Core hook FT0050CVSR added                          *
      *           Core hook FT0050CVSF added                          *
      *  053418 - Incoming payments not appearing on projected        *
      *           account movements enquiry.                          *
      *  056031 - Change processing for Shadow Post Update. Call new  *
      *           program AOSPOSU0. This now orders the updates in    *
      *           similar way to FX and MM.                           *
      *           Include primary transaction reference               *
      *           Call FT0005 to get FT Control Data                  *
      *           Fix covers errors 041693,045014,031876              *
      *  053348 - Settle amount is defaulted incorrectly.             *
      *           Extension of fix 046270.                            *
      *  055293 - Resolve mapping problems between Swift Messages and *
      *           Incoming Payments and also for Outgoing Payments    *
      *           that are generated from an Incoming Payment.        *
      *  055201 - Where a payment was being credited to an account in *
      *           the same ccy, the system allowed an exchange rate   *
      *           to be entered. If the ccys are the same, then must  *
      *           validate the rate even if the override is set to 'Y'*
      *  046270 - User input Settle CCY, Pay Amount, Pay CCY, Rate    *
      *           and expected Settle Amount to be calculated.        *
      *           ERROR: Unentered value calculation for Settle       *
      *           amount is the same as that for Pay Amount, hence    *
      *           amount calculated is very small (less than 1) and   *
      *           therefore not displayed.  FIX: Reverse calculation  *
      *           of pay amount for settle amount when WMDIN = 0.     *
      *  047179 - Allows input of a closed account in the charge      *
      *           account field when the value date is greater than   *
      *           the current processing date.                        *
      *  042167 - Include CL program to check for record locking      *
      *  S01414 - Book Code and Profit Centre Incorporation.          *
      *  051173 - Include error handling in windows RETRN code        *
      *             processing.                                       *
      *  034175 -   REMOVE INVALID INDICATOR CONDITIONING ON BENEFIC. *
      *             CUSTOMER TYPE FIELD. THIS CAUSES FIELD TO BE LEFT *
      *             BLANK AND CAUSES A/C KEY PROBLEMS IN E.O.D        *
      *  034119  -  ADD CODING TO EXTRACT FIELD 71A WHEN PROCESSING   *
      *             SWIFT MESSAGE. IF VALUE IS 'OUR', THEN CHARGES    *
      *             INDICATOR SHOULD DEFAULT TO 'A' (ADD)             *
      *  E38323  -  Recompiled due to change in copy source ZFWDT     *
      *             subroutine                                        *
      *  E37529  -  DUMA FIELDS NOT ZEROISED FOR INSERT               *
      *  E37171  -  ADDRESS FIELD VALIDATION IS INCORRECT             *
      *  E36197  -  ERROR NUMBER E21888 IS INCORRECT. CUSTOMER NUMBER *
      *             SHOULD BE VALID ENTRY FOR BENEFICIARY CUSTOMER.   *
      *             CODE REINSTATED AND INSTRUCTION MANUAL CHANGED.   *
      *  S01259  -  INCORPORATION OF SWIFT II CHANGES                 *
      *  E29970  -  ENABLE COMMAND 7 FOR NEXT PAYMENT IF CALLED       *
      *             VIA ENQUIRY SUBFILE PROGRAM                       *
      *  E32878  -  RSACMTPD PROCESSING INCOMPLETE                    *
      *  E32880  -  OUTPUT FULL REF TO RSACMTPD                       *
      *  E32531  -  ALLOW MORE THAN ONE PAYMENT TO BE MADE WITHOUT    *
      *             EXITING TO MENU AND THEN RETURNING INTO PGM       *
      *  E32532  -  Tries later to access table file with blank ccy   *
      *             when defaulted pay currency                       *
      *  E32536  -  IF UNALLOCATED NOSTRO NO 00 USED FOR PRONO        *
      *             REINSTATE REAL NOSTRO NO FOR AMOVTS SR TO STOP    *
      *             DB ERROR IN NOSTRO FILE                           *
      *  E32543  -  WARNING MESSAGE DISPLAYED IF DATE IS A HOLIDAY    *
      *             IN LOCAL CURRENCY                                 *
      *  E29837  -  SWIFT PROCESSING CHANGES - CODING TO PROCESS      *
      *             MULTIPLE MESSAGES CORRECTLY                       *
      *  E23768  -  IF PAY CURRENCY IS BLANKED OUT DURING AN AMEND    *
      *             A DATABASE ERROR IN TABTG10 AT 61 OCCURS          *
      *  E23411  -  MODI1 WAS CHECKED IN BIT 2 TO SEE IF RETAIL 1 WAS *
      *             SWITCHED ON.  THIS IS NOW OBSOLETE AND BGRTBN     *
      *             AND BGIOAC SHOULD NOW BE CHECKED FOR RETAIL 2     *
      *             INTEREST ON ACCOUNTS.                             *
      *  E23285  -  WHEN BENEFICIARY FIELD IS BLANK, ERROR CODE 115   *
      *             SHOULD BE SHOWN RATHER THAN 395.                  *
      *  E22989  -  IF USE IS MADE OF A NOSTRO ENTERED TODAY,         *
      *             THE PROGRAM HAS TO USE DEFAULT NOSTRO 00          *
      *             TO ACCESS PRONO.  IT IS ENSURED THAT THE          *
      *             ORIGINAL NOSTRO IS USED FOR OTHER NOSTRO          *
      *             PROCESSING  TO  PREVENT A DATABASE ERROR.         *
      *  E22881  -  SHOULD NOT ALLOW INPUT OF CUSTOMER NO.,           *
      *             SHORTNAME, OR SWIFT ADDRESS FOR BENEFICIARY       *
      *             UNLESS ACCOUNT WITH BANK IS ENTERED               *
      *  S01195  -  HOLIDAY PROCESSING                                *
      *  S01117  -  RELEASE 10 MULTIBRANCHING CHANGES                 *
      *  S01194  -  STANDING DATA CHANGES                             *
      *  E21888  -  CUSTOMER NUMBER SHOULD NOT BE VALID ENTRY FOR     *
      *             BENEFICIARY FIELD                                 *
      *  E21453  -  DEFAULT PAY AMOUNTS MULT/DIV WRONG WAY ROUND      *
      *  E21452  -  MSIME IS OPENED TO PREVENT A DATABASE             *
      *             ERROR OCCURING DURING ACCESS.                     *
      *  E16603  -  FIFTH LINE OF SENDER'S CORRESPONDENT IS           *
      *             BLANKED FOR INPUT ON SCREEN TWO, LEVEL TWO.       *
      *  S01252  -  ADDITIONAL SPARE WINDOW MANAGER PARAMETER,        *
      *             BLANK RETURN CODE                                 *
      *  S01251  -  SYNON FIELD/PROGRAM NAME CHANGES                  *
      *  E16366  -  ENSURES THAT THE CORRECT ERROR TEXT IS PULLED UP  *
      *             WHEN ENTERING RATES.                              *
      *  E20864  -  PREVENTS PROBLEMS WITH INCOMING SWIFT MESSAGES.   *
      *             PROGRAM NOW ADDRESSES A NEW FIELD, FTPF, WHICH    *
      *             ACTS AS THE INCOMING MESSAGE TO BE PROCESSED      *
      *             FLAG FOR FUNDS TRANSFER; IT IS NOT USED BY SWIFT. *
      *  S01241  -  WINDOW INCORPORATION                              *
      *  S01199  - HELP SYSTEM                                        *
      *                                                               *
      *****************************************************************
      *
      *    04         Date offset code error/warning                      CFT009
      *    06         F21 is pressed from the enquiry mode                S01494
      *    07         COMMAND 7 PRESSED                                   E29970
      *    08         COMMAND 4 PRESSED                                   CFT007
      *    09         CMD12 PRESSED FROM FTC0055                          S01117
      *    10         MULTIBRANCHING ON                                   S01117
      *    11         ORIGINATING BRANCH USED                             S01117
      *    12         BOOKING BRANCH INVALID                              S01117
      *    13         COMMAND 16 PRESSED                                  CFT007
      *    14         ORIGINATING BRANCH INVALID                          S01117
      *    16         ON- REDISPLAY SCREEN IN FIELD QUERY SUBROUTINES     S01194
      *    17         USED IN LOKUP, ON IF '?' FOUND                      S01194
      *    18         USED IN LOKUP TO SUPPRESS ? IN FIELDS, ON IF FOUND  S01194
      *    19         COMMAND 7 ENABLED FOR NEXT PAYMENT IN SUBFILE    D  E29970
      *    20         ALL INPUT TO DETAIL SCREEN IS VALID
      *    21         'A/C WITH BANK' IS NON-BLANK AND A BANK
      *    22         FIRST TIME THROUGH FOR WARNING ERROR 19             E32543
      *    23         WARNING MESSAGE DATE IS A HOLIDAY                   E32543
      *    24         Invalid Spread Set                                  CFT009
      *    26         Used by message subfile                             S01435
      *    27         Putovr and Overlay on message subfile               S01435
      *    30         PRONO FILE HAS BEEN OPENED (DL MODULE PRESENT)
      *    31         OLPOS FILE HAS BEEN OPENED (DL MODULE PRESENT)
      *    32         MEMOS FILE HAS BEEN OPENED (RE MODULE PRESENT)
      *    33         RETAIL ACCOUNT NUMBERS ARE USED
      *    34         ENTRY TO SENDER FIELD IS A NOSTRO
      *    35         ENTRY TO SENDER FIELD IS A CUSTOMER
      *    36         ENTRY TO SENDER FIELD IS A RETAIL ACCOUNT
      *    37         ENTRY TO SENDER FIELD IS A FULL ACCOUNT
      *    38         ENTRY TO SENDER FIELD IS A SHORTNAME
      *    39         CFT009 installed                                    CFT009
      *    40         ACTION CODE IN ERROR
      *    41         PAYMENT REFERENCE IN ERROR
      *    42         SWIFT TRN IN ERROR
      *    43         PAYMENT TYPE IN ERROR
      *    44         PAYMENT SUBTYPE IN ERROR
      *    45         SENDER IN ERROR
      *    46         BENEFICIARY CUSTOMER IN ERROR
      *    47         A/C WITH BANK IN ERROR
      *    48         RECEIVER'S CORRESPONDENT IN ERROR
      *    49         SETTLE AMOUNT IN ERROR
      *    50         SETTLE CURRENCY IN ERROR
      *    51         SETTLE VALUE DATE IN ERROR
      *    52         RATE IN ERROR
      *    53         OVERRIDE IN ERROR
      *    54         ADD/DEDUCT CHARGES INDICATOR IN ERROR
      *    55         PAY AMOUNT IN ERROR
      *    56         PAY CURRENCY IN ERROR
      *    57         PAY VALUE DATE IN ERROR
      *    58         SWIFT PRIORITY CODE IN ERROR
      *    59         HIGHLIGHT SWIFT SEQUENCE NO. ERROR.
      *****60*********ERROR*CODE*112*IS*TO*BE*DISPLAYED*                  S01117
      *****61*********ERROR*CODE*102*IS*TO*BE*DISPLAYED*                  S01117
      *    60         ERROR CODE 041 IS TO BE DISPLAYED                   S01117
      *    61         ERROR CODE 024 IS TO BE DISPLAYED                   S01117
      *****62*********ERROR*CODE*174*IS*TO*BE*DISPLAYED*                  S01117
      *    63         LAST INPUT WAS A SUCCESSFUL INSERT
      *****64*********LOKUP*INDICATOR*FOR*SWIFT*******                    175479
      *    64         SHOW/HIDE FONTIS: DEAL REFERENCE                    175479
      *    65         ACCOUNT NUMBER NOT A NOSTRO
      *****66         Indicator conditioning PUTOVR                 S01414S01435
      *    66         Booking Branch validate in detail processing        S01435
      *****67*********CHAIN TO FPTRNF FOR VERIFICATION OF RETAIL          056031
      *               BEING NOSTRO
      *    67         Receiver's Correspondent lines 2-5 in error         CFT014
      *    67         Invalid Spread Set                                  CFT009
      *    68         Profit Centre field - non display/protect           S01414
      *    69           "       "     "   - allow input                   S01414
      *    70           "       "     "   - error/reverse image           S01414
      ***  70         HELP KEY PRESSED                                    S01199
      *    71         DISPLAY INITIAL SCREEN
      *    72         DISPLAY DETAIL SCREEN
      *    73         PROTECT ALL FIELDS ON DETAIL SCREEN
      *    74         ENABLE DELETE FUNCTION
      *****75*********DISPLAY ERROR CODES LINE 1                          079909
      *    75         GENERAL ERROR CODE - REDISPLAY SCREEN               079909
      *****76*********DISPLAY ERROR CODES LINE 2                          079909
      *    76         DISPLAY ERROR CODES (BOTH LINES)                    079909
      *****77*********END*O *FILE*FOR*LF/MSIME*                           S01259
      *****77*********END OF FILE FOR LF/MSMSI2L9                   S01259S01435
      *    77         CFT014 - STP Phase 2 MT103 Messages Generation      CFT014
      *               for FT is installed                                 CFT014
      *    78         RECORD UPDATED BY ANOTHER WORKSTATION.
      *****79*********CHAIN*FAIL*TO*TABLE*FOR*RTS*                        S01414
      *    79         Book Code field     - error/reverse image           S01414
      *    80         CHAIN FAIL FOR A/C WITH BANK
      *           AND CALL FAIL FOR FTEMSGU0, FTEMSGV0                    S01428
      *****81******** END OF SCAN FOR FIELD 20 (NOT USED)           E29837140623
      *    81         USED IN SCAN FOR /OCMT/ AND /CHGS/                  140623
      *    82         CHAIN FAILED ON FILES USED FOR EXTRA INFORMATION    S01494
      *    83         Third Reimbursement Institution in error            CFT014
      *    84         NO PYCHG RECORD FOR THIS BRANCH                     133420
      *    85         CONDITION AVAILABILITY OF F4 AND F16 ON SCREEN      CFT007
      *    86         Original Exchange Rate in error                     CFT014
      *    87         GENERAL WORK INDICATOR
      *    88         GENERAL WORK INDICATOR
      *    89         GENERAL WORK INDICATOR
      *    90-97      USED BY STANDARD SUBROUTINE ZALIGN
      *       98      ZSYSTM, DATE FORMAT MMDDYY IF ON.
      *       99      ZSYSTM, INSTALLATION CONTROL DATA RECORD NOT FOUND.
      **
      *       KC      F3, END OF PROGRAM REQUEST.
      *       KJ      F10, DELETE RECORD REQUEST.
      *       KL      F12, INITIAL SCREEN REQUEST.
      **
      *     U7 & U8   DATABASE ERROR, REQUIRED RECORDS NOT FOUND.
      *****************************************************************
      *                  DATE BASE ERROR LIST
      *
      *  ERROR No     FILE ACCESSED
      *
      *     1            TABTB10
      ******2            MEMOS                                            056031
      ******3            OLPOS                                            056031
      ******4            PRONO                                            056031
      *     5            TABTB11
      *     6            TABTG10
      *     7            TABTG10
      *     8            TABTG10
      *     9            INPAY
      *    10            INPAY
      *    14            INPAY
      *****15            OLPOS                                            056031
      *****16            OLPOS                                            056031
      *****17            PRONO                                            056031
      *****18            PRONO                                            056031
      *****19            PRONO                                            056031
      *    20            TABLETR
      *    21            ACCNT
      *****22            MEMOS                                            056031
      *****23            MEMOS                                            056031
      *    24            ACNUMA
      *****25            MEMOS                                            056031
      *****26            MEMOS                                            056031
      *    27            TABLETL
      *    28            ACCNT
      *****29            MEMOS                                            056031
      *****30            MEMOS                                            056031
      **   31            ACNUMA
      **   32            ACCNT
      **   33            MEMOS
      *****34            MEMOS                                            056031
      *    35            TABLETL
      *    36            ACCNT
      *****37            MEMOS                                            056031
      *****38            MEMOS                                            056031
      *    39            ACNUMA
      *    40            ACCNT
      *****41            MEMOS                                            056031
      *****42            MEMOS                                            056031
      **   43            ACNUMA
      **   44            ACCNT
      **   45            MEMOS
      *****46            MEMOS                                            056031
      *    47            ACCNT
      *    48            ACNUM
      *    49            TABTB11
      *    50            PYCHGDD
      *    51            TABTG10
      *****52************MSIME                                            S01259
      *****52            MSMSI2L9                                   S01259S01435
      *
      *****************************************************************
      *
     F/EJECT
     F/COPY WNCPYSRC,FT0050F003
     FFT0050DFCF  E                    WORKSTN
     F/COPY WNCPYSRC,FT0050F004
     F                                              KINFDS INFDS#         CFT007
     FINPAY   UF  E           K        DISK                      A
     F                                              KCOMIT
     F/COPY WNCPYSRC,FT0050F002
     FINPAYZZ UF  E                    DISK
     F                                              KCOMIT
     FFDDTSTL1IF  E           K        DISK                               093958
      ************                                                        056031
      ************  Remove PRONO OLPOS and MEMOS processing               056031
      ************                                                        056031
     F*MEMOS***UF**E                    DISK                          UC  056031
     F************                                  KCOMIT                056031
     F*OLPOS***UF**E           K        DISK                          UC  056031
     F************OLPOSHHF                          KIGNORE               056031
     F************OLPOSOBF                          KIGNORE               056031
     F************                                  KCOMIT                056031
     F*PRONO***UF**E           K        DISK                          UC  056031
     F************PRONOHHF                          KIGNORE               056031
     F************                                  KCOMIT                056031
     F*TABFP   IF  E           K        DISK                              S01194
     F*********** TABLETPF                          KIGNORE               S01194
     F*********** TABTE10F                          KIGNORE               S01194
     F*********** TABTG20F                          KIGNORE               S01194
     FACCNT   IF  E           K        DISK
     F            ACCNTAAF                          KIGNORE
     F            ACCNTACF                          KIGNORE
     FACNUMA  IF  E           K        DISK
     F            ACCNTABF                          KRENAMEACNUMABF
     F*SNAME   IF  E           K        DISK                              S01194
     F*********** CLINTCBF                          KRENAMESNAMECBF       S01194
     F*CLINT   IF  E           K        DISK                              S01194
     F*********** CLINTCAF                          KIGNORE               S01194
     F*********** CLINTCCF                          KIGNORE               S01194
     F*MSIME***UF**E           K        DISK                           UC S01259
     F*************                                 KCOMIT                S01259
     F*SMSI2L9UF* E           K        DISK                           UC59S01435
     F***********                                   KCOMIT          S01259S01435
     F*FPRTN   IF  E           K        DISK                              S01194
     F*********** TABLETLF                          KRENAMEFPRTNF         S01194
     F*PYCHGDD IF  E                    DISK                              S01117
     FPYCHGDB IF  E           K        DISK                               S01117
     F*CLSWT   IF  E           K        DISK                              S01194
     F*           CLINTCBF                          KRENAMECLSWTF         S01194
     F*SDCUSTL7IF**E**         K        DISK                              068230
     F/COPY WNCPYSRC,FT0050F001
      ************                                                        056031
      ************  Remove PRONO OLPOS and MEMOS processing               056031
      ************                                                        056031
     F*RSACMTPDO** E                    DISK         KCOMIT               056031
     F*SDMMODPDIF**E********************DISK                        S01241S01194
     FMUSER   IF  E           K        DISK                               S01494
     FMEINCRL1IF  E           K        DISK                               S01494
     F**
     F/COPY FTCPYSRC,SFTSWFTF                                             068230
     F/COPY WNCPYSRC,FT0050DFPG                                           S01435
      *                                                                   S01435
      *  /Copy point for File Definition                                  S01435
      *                                                                   S01435
     FINPAYXL0UF  E           K        DISK                      A    UC  CFT003
     F                                              KCOMIT                CFT003
      *                                                                   CFT003
      * Incoming payment extension file                                   CFT003
      *                                                                   CFT003
     FINPAYXL2IF  E           K        DISK                           UC  CFT014
      ** Incoming Payments Details Extension retrieval index              CFT014
      *                                                                   CFT014
     FMEISOCL1IF  E           K        DISK                           UC  CFT014
      ** SWIFT ISO Country Codes retrieval index                          CFT014
     FFTXTRHL0IF  E           K        DISK                               CFT009
     FFTPCHGL0IF  E           K        DISK                               CFT009
     FFTPDOCL0IF  E           K        DISK                               CFT009
      ** Payment date offset codes                                        CFT009
      *                                                                   CFT014
     F*                                                                   S01408
     F** Core hook for externalisation.                                   S01408
     F/COPY WNCPYSRC,FT0050FPG                                            S01408
     F/EJECT                                                              S01435
     E                    CPY@    1   1 80
     E                    ERCD       38  4               ERROR CODE OUTPUT
     E                    POWER   1   7  7 3             POWERS TABLE
     E                    ZA1        16  1               ZALIGN SR. ARRAY
     E                    ZA2        16  1               ZALIGN SR. ARRAY
     E                    ZYDY    4   4  4 0             ZDATE1/2 SR.ARRAY
     E                    ZMDY   13  13  3 0             ZDATE1/2 SR.ARRAY
     E                    ZMNM   12  12  3               ZDATE2 SR. ARRAY
     E********************ZACY       25  3               ZDATE3 SR. ARRAY S01195
     E                    YA1        15  1               UIFRMT SR.ARRY
     E                    YA2        16  1               UIFRMT SR.ARRY
     E********************YA3        15  1               GAVALD SR.ARRY   S01117
     E**********          YA3        18  1               GAVALD SR.ARRY                S01117 CGL029
     E                    YA3        24  1                                                    CGL029
      ************                                                        056031
      ************  Remove PRONO OLPOS and MEMOS processing               056031
      ************                                                        056031
     E************        YPB         5 15 0             PRONO BALANCES   056031
     E************        YPO         5 15 0             PRONO BALANCES(OL056031
     E************        YPD         5  5 0A            PRONO DATES      056031
     E************        YOI        16 15 0             OLPOS IN BALS    056031
     E************        YOO        16 15 0             OLPOS OUT BALS   056031
     E                    SD        259  1               SCAN DATA        E29837
     E************        YOD        16  5 0A            OLPOS DATES      056031
     E                    SDT        10256               SWIFT DATA
     E                    ARA       768  1               SPLIT SEARCH
     E                    AR        768  1               SPLIT SEARCH     E29837
     E                    FLD        46  1               FLD FOR SWIFT
     E                    SW         12  1               SWIFT ALPHANU
     E                    SWCH   47  47  1               SWFT SET
     E                    TST        35  1               WORK ARR
     E                    #FLD        1 35               WORK ARR
     E                    HCC        25  3               HOLIDAY ARRAY
     E                    POWERS  1   6  7 0             FOR CHARGES
     E                    FCTR    1   4  4 0             FACTORS TABLE
     E********            FTPS       10  1               FT PROCESSED TAB7S01435
     E*                                                                   S01194
     E                    FLDQ       10  1               USED IN SR FLD1/2S01194
     E*                                                                   S01194
     E                    QUERY      35  1                                S01194
     E                    @A         15  1               WORK ARR         140623
     E                    @R1        13  1                                CGL009
      *                                                                   175479
      ** Work array used in SR CWVAL to store content of tag              175479
      *                                                                   175479
     E                    @CW       256  1                                175479
      *                                                                   175479
      ** Work array used in SR CWVAL to store value extracted             175479
      *                                                                   175479
     E                    @VL       256  1                                175479
      *                                                                   056031
      *  Error texts                                                      056031
      *                                                                   056031
     E                    ERR@    1   1 80                                056031
      *                                                                   056031
     E                    PSNAR   1   1 35                                CRT002
      *                                                                   CRT002
     E                    @STK       20 10                                056031
      *                                                                   S01435
      *  Warning check array                                              S01435
      *                                                                   S01435
     E                    WRN@       40  1                                S01435
      *                                                                   CFT014
      ** Work array Multiple Lines of First Line of Pxx fields            CFT014
      *                                                                   CFT014
     E                    LFLT        5 59                                CFT014
      *                                                                   CFT014
      ** Work array Multiple Lines of Charges Amounts                     CFT014
      *                                                                   CFT014
     E                    CGA         5 11 0                              CFT014
      *                                                                   CFT014
      ** Work array Multiple Lines of Charges Currencies                  CFT014
      *                                                                   CFT014
     E                    CGC         5  3                                CFT014
      *********                                                     S01428S01435
      ***Swift*Reservation messages                                 S01428S01435
      *********                                                     S01428S01435
     E*********           EMSG    1  11 76               Error Messages428S01435
      *Error Indicators returned for FT0010                               CEU006
     E                    IND         5  1                                CEU006
      *Alphabetic array                                                   CFT004
     E                    ALPH   26  26  1                                CFT004
      *Numeric                                                            CFT004
     E                    NUMC   10  10  1                                CFT004
      *                                                                   S01428
     E                    STAMP   1   1 26                                                    CPK014
      ** Array containing dummy timestamp                                                     CPK014
      **                                                                                      CSC022
      ** Array to hold commitment jobs name                                                   CSC022
      **                                                                                      CSC022
     E                    WCMT       10 10                                                    CSC022
     E/COPY ZSRSRC,ZHOLE                                                  S01195
     E/COPY FTCPYSRC,SFTSWFTE                                             068230
     E/COPY WNCPYSRC,FT0050DEPG                                           S01435
      *                                                                   S01435
      *  /Copy point for Arrays                                           S01435
      *                                                                   S01435
     E/EJECT
     I** RENAME FILE LCD TO AVOID CORRUPTION OF DATA
     I*
     IINPAYDDF
     I              LCD                             INLCD
     I              TMST                            INTMST                                    CPK015
     I*                                                                   S01414
     I* Rename of ACCNT/ACNUMA Profit Centre to avoid overwriting         S01414
     I*                                                                   S01414
     IACCNTABF                                                            S01414
     I              PRFC                            ACPRFC                S01414
     I              CNUM                            RETNUM                179732
     I              FRNT                            ACFRNA                CAP035
     I              AFRT                            ACAFRT                CAP035
     I              REPA                            ACREPA                CAP035
     I              REPI                            ACREPI                CPB001
     I*                                                                   S01414
     IACNUMABF                                                            S01414
     I              PRFC                            ACPRFC                S01414
     I              CNUM                            RETNUM                179732
     I*                                                                   S01414
     I**MSIMSPFF                                                          S01259
     I**************RCVD                            RCDY                  S01259
      *                                                                   068093
      * Rename Cheque Charge to stop over-write                           068093
      *                                                                   068093
     IPYCHGDDF                                                            068093
     I              CQCH                            PYCQCA                106208
     I              CQCHD                           PYCQCH                068093
      /EJECT                                                              S01435
      *                                                                   S01435
     I/COPY WNCPYSRC,FT0050DIPG                                           S01435
      *                                                                   S01435
      *  /Copy point for Input specifications                             S01435
      *                                                                   S01435
      *  Break down MIDAS equivalent                                      CFT002
     ITRCDE2      DS                                                      CFT002
     I                                        1   6 TRCNUM                CFT002
     I                                        7   9 TRCYCD                CFT002
     I**********                             10  13 TRACOD                             CFT002 CGL029
     I**********                             14  15 TRACSQ                             CFT002 CGL029
     I**********                             16  18 TRBRCD                             CFT002 CGL029
     I**********                             10  15 TRCDSQ                             CFT002 CGL029
     I**********                             10  18 TRCSB                              CFT002 CGL029
     I                                       10  19 TRACOD                                    CGL029
     I                                       20  21 TRACSQ                                    CGL029
     I                                       22  24 TRBRCD                                    CGL029
     I                                       10  21 TRCDSQ                                    CGL029
     I                                       10  24 TRCSB                                     CGL029
      *                                                                   CFT014
      ** Data Structure for Receiver Correspondant                        CFT014
      *                                                                   CFT014
     ISRCCO       DS                                                      CFT014
     I                                        1  35 SRCO1                 CFT014
     I                                       36  70 SRCO2                 CFT014
     I                                       71 105 SRCO3                 CFT014
     I                                      106 140 SRCO4                 CFT014
     I                                      141 175 SRCO5                 CFT014
      *                                                                   CFT014
      ** Data Structure for Third Reimbursement Institution               CFT014
      *                                                                   CFT014
     IRMBR        DS                                                      CFT014
     I                                        1  34 W34RMB                CFT014
     I                                        1   1 W01T                  CFT014
     I                                        1   3 W0103T                CFT014
     I                                        1   6 W0106T                CFT014
     I                                        1  10 W0110T                CFT014
     I                                        4   5 W0405T                CFT014
     I                                        5   5 W05T                  CFT014
     I                                        7   9 W0709T                CFT014
     I                                       10  10 W10T                  CFT014
     I                                       10  19 W1013T                                    CGL029
     I                                       10  21 W1015T                                    CGL029
     I                                       20  21 W1415T                                    CGL029
     I                                       22  24 W1618T                                    CGL029
     I                                       11  34 W1134T                                    CGL029
     I                                       22  34 W1634T                                    CGL029
     I                                       25  34 W1934T                                    CGL029
     I**********                             10  13 W1013T                             CFT014 CGL029
     I**********                             10  15 W1015T                             CFT014 CGL029
     I**********                             14  15 W1415T                             CFT014 CGL029
     I**********                             16  18 W1618T                             CFT014 CGL029
     I**********                             11  34 W1134T                             CFT014 CGL029
     I**********                             16  34 W1634T                             CFT014 CGL029
     I**********                             19  34 W1934T                             CFT014 CGL029
     I                                        6  34 W0634T                CFT014
      *                                                                   CFT014
      ** Data Structure for Receiver's Correspondent                      CFT014
      *                                                                   CFT014
     IRECV        DS                                                      CFT014
     I                                        1 175 W175RC                CFT014
     I                                        3  10 W0310C                CFT014
     I                                        6  10 W0610C                CFT014
     I                                        7  10 W0710C                CFT014
     I                                       11 175 W11175                CFT014
     I                                       12 175 W12175                CFT014
     I                                       16 175 W16175                CFT014
     I                                       19 175 W19175                CFT014
     I                                       12  18 W1218                 CFT014
     I                                       12  15 W1215                 CFT014
     I                                        1   1 W01C                  CFT014
     I                                        2   2 W02C                  CFT014
     I                                        5   5 W05C                  CFT014
     I                                        6   6 W06C                  CFT014
     I                                       10  10 W10C                  CFT014
     I                                       11  11 W11C                  CFT014
     I                                        1  35 WSRCO1                CFT014
     I                                       36  70 WSRCO2                CFT014
     I                                       71 105 WSRCO3                CFT014
     I                                      106 140 WSRCO4                CFT014
     I                                      141 175 WSRCO5                CFT014
      *                                                                   CFT014
     ICSIDWS      DS                                                      CFT014
     I                                        1  12 W0112W                CFT014
     I                                        5   6 W0506W                CFT014
      *                                                                   CFT014
     IBTIDA8      DS                                                      CFT014
     I                                        1  12 W0112A                CFT014
     I                                        5   6 W0506A                CFT014
      *                                                                   CFT014
     ICSIDBB      DS                                                      CFT014
     I                                        1  12 W0112B                CFT014
     I                                        5   6 W0506B                CFT014
      *                                                                   S01435
     IINFT      E DSMEINFTPD                                              S01435
      *                                                                   S01435
      *  Define parameters to be passed for FT IMM update                 S01435
      *                                                                   S01435
     I*
     I*  DATA STRUCTURE FOR COMPILATION  - COPYRIGHT INSERTION
     ICPYR@#      DS
     I                                        1  80 CPY@
     I                                        1  20 CPY@##
     I*
     I** PROGRAM STATUS DATA STRUCTURE - RETREIVE USER ID
     I**
     IPSDS       SDS
     I                                        1  10 ##PGM                 S01435
     I***********                           244 246 WSID                  S01117
     I                                      244 253 WSID                  S01117
     I                                      254 263 USRID
      ************                                                        056031
      ************  Remove PRONO OLPOS and MEMOS processing               056031
      ************                                                        056031
     I************                                                        056031
     I****DATA*STRUCTURE FOR MEMOS RECORD                                 056031
     I************                                                        056031
     I*ZZ039*******DS                                                     056031
     I************                            1  150MMLDBL                056031
     I************                            1  150LDBLN                 056031
     I************                           16  300MMCLBL                056031
     I************                           16  300CLBLN                 056031
     I************                                                        056031
     I****DATA*STRUCTURE TO REDEFINE BALANCE ARRAY FROM PRONO             056031
     I************                                                        056031
     I*DSPNB*******DS                                                     056031
     I************                            1  40 PNB                   056031
     I************                        P   1  40 YPB                   056031
     I************                                                        056031
     I****DATA*STRUCTURE TO REDEFINE DATE ARRAY FROM PRONO                056031
     I************                                                        056031
     I*DSPND*******DS                                                     056031
     I************                            1  15 PND                   056031
     I************                        P   1  15 YPD                   056031
      *
      ****Data*structure*to*redefine*allowed*%*discrepancy*as*rate.*      S01194
     I************DS                                                      S01194
     I************                        P   1   32PRTDIS                S01194
     I************                        P   1   34RATDIS                S01194
      ************                                                        056031
      ************  Remove PRONO OLPOS and MEMOS processing               056031
      ************                                                        056031
     I************                                                        056031
     I****DATA*STRUCTURE TO REDEFINE DATE ARRAY FROM OLPOS                056031
     I************                                                        056031
     I*DSODT*******DS                                                     056031
     I************                            1  48 ODT                   056031
     I************                        P   1  48 YOD                   056031
     I************                                                        056031
     I****DATA*STRUCTURE TO REDEFINE INCOMING BALANCE ARRAY FROM OLPOS    056031
     I************                                                        056031
     I*DSOFI*******DS                                                     056031
     I************                            1 128 OFI                   056031
     I************                        P   1 128 YOI                   056031
     I************                                                        056031
     I****DATA*STRUCTURE TO REDEFINE OUTGOING BALANCE ARRAY FROM OLPOS    056031
     I************                                                        056031
     I*DSOFO*******DS                                                     056031
     I************                            1 128 OFO                   056031
     I************                        P   1 128 YOO                   056031
     I*
     I*     DATA AREA TO REDEFINE RETAIL NOSTRO FIELD
     I*
     IRTNO        DS
     I***********                             1   60CNUMN                              CGL029 CSD027
     I                                        1   6 CNUMN                                     CSD027
     I                                        7  160ACODNP                                    CGL029
     I                                       17  180ACSQNP                                    CGL029
     I                                       19  21 BRCANP                                    CGL029
     I                                        7   9 CCYN                                      CGL029
     I                                       10  190ACODN                                     CGL029
     I                                       20  210ACSQN                                     CGL029
     I                                       22  24 BRCAN                                     CGL029
     I                                        1  100ACNON
     I*
     I**********                              1   60CNUMN                                     CGL029
     I**********                              7   9 CCYN                                      CGL029
     I**********                             10  130ACODN                                     CGL029
     I**********                             14  150ACSQN                                     CGL029
     I**********                             16  18 BRCAN                              S01117 CGL029
     I**********                              7  100ACODNP                                    CGL029
     I**********                             11  120ACSQNP                                    CGL029
     I**********                             13  15 BRCANP                             S01117 CGL029
     I*
     I****DATA*STRUCTURE*TO*REDEFINE*HOLIDAY*ARRAY*FROM*TABLETJ***********S01195
     I*************                                                       S01195
     I*DSCCY*******DS                                                     S01195
     I*************                           1  75 HCCY                  S01195
     I*************                           1  75 ZACY                  S01195
     I*
     I**  DATA STRUCTURE FOR NEXT INCOMING PAYMENT REFERENCE NUMBER
     I*
     IDINPAY      DS                              4
     I                                        1   40DINSQ
     I*
     I**  DATA AREA LDA - USED IN THE EVENT OF DATABASE ERRORS
     I*
     IDLDA        DS                            256
     I***********                           134 138 DBFILE                S01194
     I***********                           139 167 DBKEY                 S01194
     I***********                           168 175 DBPGM                 S01194
     I***********                           176 177 DBASE                 S01194
     I                                      134 141 DBFILE                S01194
     I                                      142 170 DBKEY                 S01194
     I                                      171 180 DBPGM                 S01194
     I                                      181 1830DBASE                 S01194
     I*
     I**   DS FOR DBERR ON ACCNT
     I*
     I*ACKYDS*****DS                             15                       S01117
     I***ACKYDS*     DS                             18                                 S01117 CGL029
     IACKYDS      DS                             24                                           CGL029
     I**********                              1   60KACNUM                                    CSD027
     I                                        1   6 KACNUM                                    CSD027
     I                                        1   6 KACNMA                S01117
     I                                        7   9 KACCCY
     I                                       10  190KACCD                                     CGL029
     I                                       10  19 KACCDA                                    CGL029
     I                                       20  210KACSQ                                     CGL029
     I                                       20  21 KACSQA                                    CGL029
     I                                       22  24 KBRCA                                     CGL029
     I**********                             10  130KACCD                                     CGL029
     I**********                             10  13 KACCDA                             S01117 CGL029
     I**********                             14  150KACSQ                                     CGL029
     I**********                             14  15 KACSQA                             S01117 CGL029
     I**********                             16  18 KBRCA                              S01117 CGL029
     I*
     I**  DATA STRUCTURE TO PROVIDE TEXT ON COMIT ENTRY IN JOURNAL
     I*
     ICMTTXT      DS
     I                                        1   50TIMEX
     I                                        6   7 MDID
     I                                        8  15 PGMN
     I                                       16  18 WSIDX
     I                                       19  240TIME
     I                                       25  25 ACTCDX
     I                                       26  35 USRIDX
     I                                       51  52 STID
     I                                       53  53 SACTCD
     I                                       54  68 SPREF
     I                                       69  78 SSTTS
     I*************************************  79  97 SSWTN                 S01259
     I*************************************  99 133 SSND1                 S01259
     I************************************* 114 116 SSNBR                 S01117
     I************************************* 169 203 SSND2                 S01259
     I************************************* 239 273 SSND3                 S01259
     I************************************* 309 343 SSND4                 S01259
     I************************************* 379 393 SACB15                S01117
     I************************************* 379 390 SACBK                 S01259
     I************************************* 391 393 SACBB                 S01117
     I************************************* 426 435 SRCCO                 S01259
     I************************************* 436 449 SSMAM                 S01259
     I************************************* 450 452 SSMCY                 S01259
     I************************************* 453 458 SSLDT                 S01259
     I************************************* 459 472 SRATE                 S01259
     I************************************* 473 473 SOVRD                 S01259
     I************************************* 474 474 SADDC                 S01259
     I************************************* 475 488 SPYAM                 S01259
     I************************************* 489 491 SPCCY                 S01259
     I************************************* 492 497 SPVDT                 S01259
     I************************************* 498 499 SSWPC                 S01259
     I************************************* 500 514 SPREFP                S01259
     I************************************* 515 516 SPYTP                 S01259
     I************************************* 517 518 SPYST                 S01259
     I                                       79 106 SSWTN                 S01259
     I                                      108 142 SSND1                 S01259
     I                                      123 125 SSNBR                 S01259
     I                                      178 212 SSND2                 S01259
     I                                      248 282 SSND3                 S01259
     I                                      318 352 SSND4                 S01259
     I**********                            388 402 SACB15                             S01259 CGL029
     I**********                            388 399 SACBK                              S01259 CGL029
     I/COPY WNCPYSRC,FT0050I002
     I**********                            400 402 SACBB                              S01259 CGL029
     I**************************************435 444 SRCCO          S01259 CFT014
     I                                      435 444 FIL01                 CFT014
     I                                      445 458 SSMAM                 S01259
     I                                      459 461 SSMCY                 S01259
     I                                      462 467 SSLDT                 S01259
     I                                      468 481 SRATE                 S01259
     I                                      482 482 SOVRD                 S01259
     I                                      483 483 SADDC                 S01259
     I                                      484 497 SPYAM                 S01259
     I                                      498 500 SPCCY                 S01259
     I                                      501 506 SPVDT                 S01259
     I**************************************507 508 SSWPC           S01259S01117
     I**************************************509 523 SPREFP          S01259S01117
     I**************************************524 525 SPYTP           S01259S01117
     I**************************************526 527 SPYST           S01259S01117
     I                                      507 507 SSWPC                 S01117
     I                                      508 522 SPREFP                S01117
     I                                      523 524 SPYTP                 S01117
     I                                      525 526 SPYST                 S01117
     I                                      527 529 SNDCY                 CEU006
     I                                      530 543 SNDAM                 CEU006
     I                                      544 564 SACB15                                    CGL029
     I                                      544 561 SACBK                                     CGL029
     I                                      562 564 SACBB                                     CGL029
     I/COPY WNCPYSRC,FT0050I008
     I            DS
     I                                        1   6 SWDT
     I                                        1   2 SYY
     I                                        3   4 SMM
     I                                        5   6 SDD
     I************DS                                                      S01435
     I************                            1   3 CRLFC                 S01435
     I************                            1   1 BTA                   S01435
     I************                            2   2 BTB                   S01435
     I************                            3   3 CLN                   S01435
     I************                                                        S01435
     I************TO REDEFINE MDTA FROM INCOMING SWIFT                    S01435
     I************                                                        S01435
     I************DS                                                      S01435
     I************                            1 256 MDTA                  S01435
     I************                            1   3 ACK                   S01435
     I************                            4   4 IND                   S01435
     I************                           53  55 STYP1                 S01435
     I************                                                  E29837S01435
     I************TO REDEFINE FTPF FIELDS FROM INCOMING SWIFT       E29837S01435
     I************                                                  E29837S01435
     I************DS                                                E29837S01435
     I************                            1  10 FTPS            E29837S01435
     I************                            1   1 FTPF1           E29837S01435
     I************                            2   2 FTPF2           E29837S01435
     I************                            3   3 FTPF3           E29837S01435
     I************                            4   4 FTPF4           E29837S01435
     I************                            5   5 FTPF5           E29837S01435
     I************                            6   6 FTPF6           E29837S01435
     I************                            7   7 FTPF7           E29837S01435
     I************                            8   8 FTPF8           E29837S01435
     I************                            9   9 FTPF9           E29837S01435
     I************                           10  10 FTPF10          E29837S01435
     I************                                                        S01435
     I*****TO*REDEFINE SENDER CORRESRP. FROM INCOMING SWIFT MESSQGES      S01435
     I************                                                        S01435
     I************DS                                                      S01435
     I************                            1  12 SEND                  S01435
     I************                            1   8 SEDR1                 S01435
     I************                            9   9 SEDR2                 S01435
     I************                           10  12 SEDR3                 S01435
     I*
     I** DATA STRUCTURE TO CONCATANATE SCREEN BENEFICIARY CUSTOMER
     I*
     I            DS
     I                                        1   1 BCSL
     I                                        1  18 BPART                                     CGL029
     I**********                              1   60BCNUM                              CGL029 CSD027
     I                                        1   6 BCNUM                                     CSD027
     I                                        1   6 BCNUMA                                    CGL029
     I                                        7  160BACOD                                     CGL029
     I                                       17  180BACSQ                                     CGL029
     I                                       19  21 BBRCA                                     CGL029
     I**********                              1  12 BPART                                     CGL029
     I**********                              1   60BCNUM                                     CGL029
     I**********                              1   6 BCNUMA                                    CGL029
     I**********                              7  100BACOD                                     CGL029
     I**********                             11  120BACSQ                                     CGL029
     I**********                             13  15 BBRCA                              S01117 CGL029
     I                                        1  10 BSNAM
     I                                        1  35 SBNC1
     I                                       36  70 SBNC2
     I                                       71 105 SBNC3
     I                                      106 140 SBNC4
     I                                      141 175 SBNC5
     I*                                                                   E23285
     I                                        1 175 BCR0                  E23285
     I*                                                                   E23285
     I                                       19 175 BCR12                                     CGL029
     I                                       22 175 BCR15                                     CGL029
     I                                        7 175 BCR6
     I                                       11 175 BCR10
     I**********                             13 175 BCR12                                     CGL029
     I**********                             16 175 BCR15                              S01117 CGL029
     I/COPY WNCPYSRC,FT0050I007
     I*
     I*     DATA STRUCTURE REDEFINING ADDRESS  FIELDS
     I*
     I            DS
     I                                        1 175 ADDRSS
     I                                        1  35 ADCHK1
     I                                       36  70 ADCHK2
     I                                       71 105 ADCHK3
     I                                      106 140 ADCHK4
     I                                      141 175 ADCHK5
      *                                                                   056031
      *  Send message data structure                                      056031
      *                                                                   056031
     IDBDTA       DS                                                      056031
     I                                        1  10 @BPGM                 056031
     I                                       11  20 @BFILE                056031
     I                                       21  50 @BKEY                 056031
     I                                       51  550@BERNB                056031
     I                                       56 135 @BNARR                056031
     I                                      136 145 @BSTK                 056031
     I                                      146 175 @BPREF                056031
      *                                                                   056031
      *  Calling parameter data structure for AOSPOSU0                    056031
      *                                                                   056031
     IC#DTA       DS                            256                       056031
     I                                        1   1 C#ATYP                056031
     I**********                              2  19 C#ACCT                             056031 CGL029
     I                                        2  19 QQACCT                                    CGL029
     I**********                              2   70C#CNU1                             056031 CSD027
     I                                        2   7 C#CNU1                                    CSD027
     I                                        8  10 C#CCY1                056031
     I**********                             11  140C#ACO1                             056031 CGL029
     I                                       11  140QQACO1                                    CGL029
     I                                       15  160C#ACS1                056031
     I                                       17  19 C#BRC1                056031
     I                                        2   30C#NOSN                056031
     I                                        2   6 C#NOS                 056031
     I                                        2  110C#ACNO                056031
     I**********                              2   70C#CNUM                             056031 CSD027
     I                                        2   7 C#CNUM                                    CSD027
     I**********                              8  110C#ACOD                             056031 CGL029
     I                                        8  110QQACOD                                    CGL029
     I                                       12  130C#ACSQ                056031
     I                                       14  16 C#BRCA                056031
     I                                       24  24 C#IO                  056031
     I                                       25  27 C#CCY                 056031
     I                                       28  29 C#TRYP                056031
     I                                       30  59 C#NARR                056031
     I                                       60  670C#CHQN                056031
     I                                       68  82 C#PREF                056031
     I                                       83  88 C#TRN                 056031
     I                                    P  89  960C#AMT                 056031
     I                                       97  97 C#PRON                056031
     I                                       98  98 C#OLPS                056031
     I                                       99  99 C#MEMS                056031
     I                                      100 100 C#RSAC                056031
     I                                      101 102 C#MOD                 056031
     I                                      103 104 C#OLRC                056031
     I                                      105 105 C#FTOV                056031
     I                                    P 106 1080C#VDAT                056031
     I                                    P 109 1110C#PSTD                056031
     I                                      112 112 C#PSTO                056031
     I                                      113 113 C#RPST                068347
     I                                      114 1160C#RPNB                068347
     I                                      117 117 C#RTYP                068347
     I                                      121 1300C#ACO1                                    CGL029
     I                                      131 1400C#ACOD                                    CGL029
     I                                      141 160 C#OTR1                                    CAP204
     I                                      161 161 C#MTYP                                    CAP205
      *                                                                                       CLE134
      ** Exception Reference Id/Number                                                        CLE134
      *                                                                                       CLE134
     I                                      162 164 C#XRFI                                    CLE134
     I                                      165 1740C#XRFN                                    CLE134
      *                                                                                       CGL029
     I            DS                                                                          CGL029
     I                                        1  24 C#ACCT                                    CGL029
     I**********                              1   60W#CNU1                             CGL029 CSD027
     I                                        1   6 W#CNU1                                    CSD027
     I                                        7   9 W#CCY1                                    CGL029
     I                                       10  190W#ACO1                                    CGL029
     I                                       20  210W#ACS1                                    CGL029
     I                                       22  24 W#BRC1                                    CGL029
     I/COPY WNCPYSRC,FT0050I009
      *                                                                   056031
      *  Input parameters data structure from FT0005                      056031
      *                                                                   056031
     IC#CNTL      DS                            256                       056031
     I                                        1   1 C#PDTI                056031
     I                                        2   3 C#CCYI                056031
     I                                        4   4 C#GLUI                056031
     I                                        5   5 C#TPCI                056031
      *                                                                   056031
     I/COPY WNCPYSRC,FT0050I003
      /EJECT                                                              S01435
     IW8FT        DS                            128                       S01435
      *                                                                   S01435
      * Address data structure                                            S01435
      *                                                                   S01435
      * Currency                                                          S01435
     I                                        1   3 W8CCY                 S01435
      * Settlement Type                                                   S01435
     I                                        4   5 W8STMT                S01435
      * Mandatory Text - convert BIC identifiers                          S01435
     I                                        6   6 W8MTXT                S01435
      * Message Tag                                                       S01435
     I                                        7  11 W8MTAG                S01435
      * Construct of data in field                                        S01435
     I                                       12  12 W8TYPE                S01435
      * Number of Lines available                                         S01435
     I                                       13  140W8NLIN                S01435
      * Network and Message Type                                          S01435
     I                                       15  20 W8NWRK                S01435
     I                                       21  23 W8MTPY                S01435
      * Calling Program                                                   S01435
     I                                       24  33 W8CPGM                S01435
      * Action *PRINT/*ENQ/*MSG GEN                                       S01435
     I                                       34  41 W8ACT                 S01435
      * Critical reporting - Database error if 'Y'                        S01435
      * If no BIC directory and BIC entered no error                      S01435
     I                                       42  42 W8CRIT                S01435
      * Force Midas Address - where possible                              S01435
     I                                       43  43 W8MADD                S01435
      * If Retail get first address from account                          S01435
     I                                       44  44 W8RTAD                S01435
      * Alternative Address                                               S01435
     I                                       45  45 W8ALTN                S01435
      * Address type selected in W0MSG                                    S01435
     I                                       46  46 W8ADTP                S01435
      *                                                                   S01435
     I*
     IZMUSER      DS                             17                       S01117
     I*                                                                   S01117
     I*   USER / BRANCH DATA AREA                                         S01117
     I*                                                                   S01117
     I                                       11  13 DBRN                  S01117
     I                                       14  16 DPPT                  S01414
     I*                                                                   S01194
     I**    DATA STRUCTURES TO CHANGE FROM NUMERIC TO ALPHA               S01194
     I*                                                                   S01194
     I            DS                                                      S01194
     I**********                              1   60CNUM                               S01194 CSD027
     I                                        1   6 CNUM                                      CSD027
     I                                        1   6 CNUMA                 S01194
     I                                        7  160ACOD                                      CGL029
     I                                        7  16 ACODA                                     CGL029
     I                                       17  180ACSQ                                      CGL029
     I                                       17  18 ACSQA                                     CGL029
     I**********                              7  100ACOD                               S01194 CGL029
     I**********                              7  10 ACODA                              S01194 CGL029
     I**********                             11  120ACSQ                               S01194 CGL029
     I**********                             11  12 ACSQA                              S01194 CGL029
      *                                                                   S01435
     I            DS                                                      S01435
     I                                        1  24 SNDDS                                     CGL029
     I                                       25  48 RCCDS                                     CGL029
     I                                       49  72 BNCDS                                     CGL029
     I                                       73  96 ACBDS                                     CGL029
     I**********                              1  18 SNDDS                              S01435 CGL029
     I**********                             19  36 RCCDS                              S01435 CGL029
     I**********                             37  54 BNCDS                              S01435 CGL029
     I**********                             55  72 ACBDS                              S01435 CGL029
      *                                                                   CGL009
      ** Data Structure to format P53                                     CGL009
      *                                                                   CGL009
     I            DS                                                      CGL009
     I                                        1  35 W#P53                 CGL009
     I                                        1   1 W#P53A                CGL009
     I                                        2  35 W#P53B                CGL009
      *                                                                   CGL009
      ** Data Structure to format P59                                     CGL009
      *                                                                   CGL009
     I            DS                                                      CGL009
     I                                        1  35 W#P59                 CGL009
     I                                        1   1 W#P59A                CGL009
     I                                        2  35 W#P59B                CGL009
      *                                                                   CGL009
      ** Data Structure to format work variable of Beneficiary            CGL009
      *                                                                   CGL009
     I            DS                                                      CGL009
     I                                        1  35 W#BNC1                CGL009
     I                                        1   6 W#CUS1                CGL009
     I                                        7  16 W#ACD1                                    CGL029
     I                                       17  18 W#SQN1                                    CGL029
     I                                       19  21 W#BCH1                                    CGL029
     I**********                              7  10 W#ACD1                             CGL009 CGL029
     I**********                             11  12 W#SQN1                             CGL009 CGL029
     I**********                             13  15 W#BCH1                             CGL009 CGL029
      *                                                                   CGL009
      ** Data Structure for obtaining rate                                CGL009
      *                                                                   CGL009
     IR1          DS                                                      CGL009
     I                                        1  13 @R1                   CGL009
      *                                                                   CFT014
      *  Lines of first line of tag                                       CFT014
      *                                                                   CFT014
     ILFLTDS      DS                                                      CFT014
     I                                        1 295 LFLT                  CFT014
     I                                        1  24 BG1                   CFT014
     I                                       25  59 TV1                   CFT014
     I                                       60  83 BG2                   CFT014
     I                                       84 118 TV2                   CFT014
     I                                      119 142 BG3                   CFT014
     I                                      143 177 TV3                   CFT014
     I                                      178 201 BG4                   CFT014
     I                                      202 236 TV4                   CFT014
     I                                      237 260 BG5                   CFT014
     I                                      261 295 TV5                   CFT014
      *                                                                   CFT014
      * Sender's charges amounts                                          CFT014
     IDSSCHD      DS                                                      CFT014
     I                                        1  550CGA                   CFT014
     I                                        1  110MGSCH1                CFT014
     I                                       12  220MGSCH2                CFT014
     I                                       23  330MGSCH3                CFT014
     I                                       34  440MGSCH4                CFT014
     I                                       45  550MGSCH5                CFT014
      *                                                                   CFT014
      * Sender's charges currencies                                       CFT014
     IDSSCCD      DS                                                      CFT014
     I                                        1  15 CGC                   CFT014
     I                                        1   3 MGSCC1                CFT014
     I                                        4   6 MGSCC2                CFT014
     I                                        7   9 MGSCC3                CFT014
     I                                       10  12 MGSCC4                CFT014
     I                                       13  15 MGSCC5                CFT014
      *                                                                   S01435
     I***IMACNT*     DS                             18                                 S01435 CGL029
     IIMACNT      DS                             24                                           CGL029
      *  Define full account to be passed for FT IMM update               S01435
      *                                                                   S01435
     I**********                              1   60IMCNUM                             S01435 CSD027
     I                                        1   6 IMCNUM                                    CSD027
     I                                        7   9 IMCCY                 S01435
     I                                       10  190IMACOD                                    CGL029
     I                                       20  210IMACSQ                                    CGL029
     I                                       22  24 IMBRCA                                    CGL029
     I**********                             10  130IMACOD                             S01435 CGL029
     I**********                             14  150IMACSQ                             S01435 CGL029
     I**********                             16  18 IMBRCA                             S01435 CGL029
      *                                                                   S01435
     I/COPY MECPYSRC,SME1100P                                             S01435
      *                                                                   S01435
     IMSGREF      DS                                                      S01435
      *                                                                   S01435
      *  DS to split msg ref when FT0050 called from enquiry function     S01435
      *                                                                   S01435
     I                                        1   80REFMSG                S01435
     I                                        9  110REFPRT                S01435
     IDSMTR       DS                                                      S01494
      *                                                                   S01494
      *  Define fields for message transalation                           S01494
      *                                                                   S01494
     I                                        1 132 #MSDTA                S01494
     I                                       15  30 #MPREF                S01494
     I                                    P   1   20#MPART                S01494
     I                                      133 264 #MSTX1                S01494
     I#MSTX2      DS                                                      S01494
     I                                        1 256 #MSTXA                S01494
     I                                      257 512 #MSTXB                S01494
     I*                                                                   S01499
     IVATDS       DS                                                      S01499
     I** Calling parameter to AOVATR0                                     S01499
     I                                        1   3 I#BRCA                S01499
     I                                        4   9 I#CUST                S01499
     I                                    P  10  124O#VATR                S01499
     I*                                                                   S01506
     IW0DTA       DS                            256                       S01506
     I*                                                                   S01506
     I** Calling parameter data structure for FT0035                      S01506
     I*                                                                   S01506
     I                                        1   1 I#PT1                 S01506
     I                                        2  36 I#PTY1                S01506
     I                                       37  37 I#PT2                 S01506
     I                                       38  72 I#PTY2                S01506
     I                                       73  75 I#CCY                 S01506
     I                                       76  81 O#CUST                S01506
     IW3DATA      DS                             14                       CAC001
      * I : MAP Margin Info Processing                                    CAC001
     I                                    P   1   42W3FXMP                CAC001
     I                                        5   50W3FXMD                CAC001
     I                                        6   6 W3MBSI                CAC001
     I                                        7   7 W3MSIG                CAC001
     I                                    P   8  140W3MAMT                CAC001
     I*                                                                   S01508
     I*******W7DATA      DS                            310                S01508CEU006
     I/COPY WNCPYSRC,FT0050I004
     IW7DATA      DS                            321                       CEU006
     I/COPY WNCPYSRC,FT0050I005
     I*                                                                   S01508
     I* Payment type and subtype                                          S01508
     I*                                                                   S01508
     I                                        1   2 W7PYTP                S01508
     I                                        3   4 W7PYST                S01508
     I*                                                                   S01508
     I* Input currency and charge currency                                S01508
     I                                        5   7 W7ICCY                S01508
     I                                        8  10 W7CCCY                S01508
     I*                                                                   S01508
     I* Settlement method                                                 S01508
     I                                       11  12 W7STMT                S01508
     I*                                                                   S01508
     I* Defaults required                                                 S01508
     I                                       13  13 W7DFRQ                S01508
     I*                                                                   S01508
     I* Charges branch                                                    S01508
     I                                       14  16 W7BRCA                S01508
     I*                                                                   S01508
     I* Charge currency amount                                            S01508
     I                                       17  290W7CAMT                S01508
     I*                                                                   S01508
     I* Transfer Commission type                                          S01508
     I                                       30  30 W7TRCT                S01508
     I*                                                                   S01508
     I* SWIFT priority code                                               S01508
     I                                       31  31 W7SWPC                S01508
     I*                                                                   S01508
     I* Transfer Commission amount                                        S01508
     I                                       32  420W7TRCD                S01508
     I                                       43  530W7TRCH                S01508
     I*                                                                   S01508
     I* Telex charge                                                      S01508
     I                                       54  640W7TXCD                S01508
     I                                       65  750W7TXCH                S01508
     I*                                                                   S01508
     I* Cheque Charge                                                     S01508
     I                                       76  860W7CQCD                S01508
     I                                       87  970W7CQCH                S01508
     I*                                                                   S01508
     I* Costs Abroad                                                      S01508
     I                                       98 1080W7CSTD                S01508
     I                                      109 1190W7CSTA                S01508
     I*                                                                   S01508
     I* SWIFT Priority Charge                                             S01508
     I                                      120 1300W7SPCD                S01508
     I                                      131 1410W7SPCH                S01508
     I*                                                                   S01508
     I* Miscellaneous charge                                              S01508
     I                                      142 1520W7MSCD                S01508
     I                                      153 1630W7MSCH                S01508
     I*                                                                   S01508
     I* Advice Charge                                                     S01508
     I                                      164 1740W7ADCD                S01508
     I                                      175 1850W7ADCH                S01508
     I*                                                                   S01508
     I* Telephone Charge                                                  S01508
     I                                      186 1960W7TLCD                S01508
     I                                      197 2070W7TLCH                S01508
     I*                                                                   S01508
     I* Collection Charge                                                 S01508
     I                                      208 2180W7COLD                S01508
     I                                      219 2290W7COLL                S01508
     I*                                                                   S01508
     I* Payment amount currency                                           S01508
     I                                      230 232 W7PCCY                S01508
     I*                                                                   S01508
     I** Other currency                                                   S01508
     I                                      233 235 W7OCCY                S01508
     I*                                                                   S01508
     I** FX/Change commission (input ccy)                                 S01508
     I                                      236 2460W7CHCD                S01508
     I*                                                                   S01508
     I** FX/Change commission (charge ccy)                                S01508
     I                                      247 2570W7CHCM                S01508
     I*                                                                   S01508
     I** Our deductions (input ccy)                                       S01508
     I                                      258 2680W7DEDD                S01508
     I*                                                                   S01508
     I** Our deductions (charge ccy)                                      S01508
     I                                      269 2790W7DEDS                S01508
     I*                                                                   S01508
     I** Correspondent charge (input ccy)                                 S01508
     I                                      280 2900W7COCD                S01508
     I*                                                                   S01508
     I** Correspondent charge (charge ccy)                                S01508
     I                                      291 3010W7COCH                S01508
     I*                                                                   S01508
     I** Default type (HDR or DET or " ")                                 S01508
     I                                      302 304 W7DFTT                S01508
     I*                                                                   S01508
     I** Customer to be debited the charge                                S01508
     I                                      305 310 W7CUST                S01508
     I** Settle Date                                                      CEU006
     I                                      311 315 W7SLDT                CEU006
     I** Pay Date                                                         CEU006
     I                                      316 320 W7PVDT                CEU006
     I** Add/Deduct Charges                                               CEU006
     I                                      321 321 W7ADDC                CEU006
     I/COPY WNCPYSRC,FT0050I006
      *                                                                   S01435
     I*                                                                   S01194
     I**DATA STRUCTURES USED BY ACCESS PROGRAMS                           S01194
     I*                                                                   S01194
     IDSFDY     E DSDSFDY                                                 S01194
     IDSSDY     E DSDSSDY                                                 S01194
     I*                                                                   S01194
     ISCSARD    E DSSCSARDPD                                              S01494
     ISDBANK    E DSSDBANKPD                                              S01194
     ISDFONT    E DSSDFONTPD                                              CGL009
     ISDMMOD    E DSSDMMODPD                                              S01194
     ISDGELR    E DSSDGELRPD                                              S01194
     ISDFTFR    E DSSDFTFRPD                                              S01194
     I                                       44  484RATDIS                S01194
     ISDRETL    E DSSDRETLPD                                              S01194
     I              QQACCD                          QQACC1                                    CGL029
     ISDCURR    E DSSDCURRPD                                              S01194
     ISDCUST    E DSSDCUSTPD                                              S01194
     ISDNOST    E DSSDNOSTPD                                              S01194
     I              QQACCD                          QQACC2                                    CGL029
     I*   FOR HOLIDAY PROCESSING                                          S01195
     I                                       29  31 NOSLOC                S01195
     ISDBRCH    E DSSDBRCHPD                                              S01194
     I              QQDFAC                          QQDFA1                                    CGL029
     ISDDLST    E DSSDDLSTPD                                              S01194
     ISDBOOK    E DSSDBOOKPD                                              S01414
     ISDPRFC    E DSSDPRFCPD                                              S01414
     ISDCNST    E DSSDCNSTPD                                              068230
     IMEBICD    E DSMEBICDPD                                              068230
     ISDTRAD    E DSSDTRADPD                                              CFT007
     I              QQACCD                          QQACC3                                    CGL029
     ISDLOCN    E DSSDLOCNPD                                              CFT014
     ISDCTRY    E DSSDCTRYPD                                              CFT014
      *                                                                   CGL009
     IACCINF    E DSACCNTAB                                               CGL009
     I              RECI                            IFRECI                CGL009
     I              CNUM                            IFCNUM                CGL009
     I              CCY                             IFCCY                 CGL009
     I              ACOD                            IFACOD                CGL009
     I              ACSQ                            IFACSQ                CGL009
     I              ZZ006                           IFZZ06                CGL009
     I              BRCA                            IFBRCA                CGL009
     I              ATYP                            IFATYP                CGL009
     I              STYP                            IFSTYP                CGL009
     I              MFFQ                            IFMFFQ                CGL009
     I              ACST                            IFACST                CGL009
     I              DACO                            IFDACO                CGL009
     I              DACC                            IFDACC                CGL009
     I              ANAM                            IFANAM                CGL009
     I              LDBL                            IFLDBL                CGL009
     I              CLBL                            IFCLBL                CGL009
     I              STFQ                            IFSTFQ                CGL009
     I              STDY                            IFSTDY                CGL009
     I              LSTD                            IFLSTD                CGL009
     I              NSTD                            IFNSTD                CGL009
     I              LSTP                            IFLSTP                CGL009
     I              CFSB                            IFCFSB                CGL009
     I              LMVD                            IFLMVD                CGL009
     I              EPLB                            IFEPLB                CGL009
     I              EPCB                            IFEPCB                CGL009
     I              YTDB                            IFYTDB                CGL009
     I              GLBT                            IFGLBT                CGL009
     I              ADREF1                          IFARF1                CGL009
     I              PRFC                            IFPRFC                CGL009
     I              ZZ004                           IFZZ04                CGL009
     I              ORED                            IFORED                CGL009
     I              DLIM                            IFDLIM                CGL009
     I              LRCR                            IFLRCR                CGL009
     I              RTCB                            IFRTCB                CGL009
     I              RTLB                            IFRTLB                CGL009
     I              DITM                            IFDITM                CGL009
     I              CITM                            IFCITM                CGL009
     I              ADREF2                          IFREF2                CGL009
     I              ZZ002                           IFZZ02                CGL009
     I              CDIR                            IFCDIR                CGL009
     I              CCIR                            IFCCIR                CGL009
     I              ACNO                            IFACNO                CGL009
     I              RETB                            IFRETB                CGL009
     I              ODSC                            IFODSC                CGL009
     I              ODLN                            IFODLN                CGL009
     I              ODED                            IFODED                CGL009
     I              DIOD                            IFDIOD                CGL009
     I              FACT                            IFFACT                CGL009
     I              FCNO                            IFFCNO                CGL009
     I              EFAC                            IFEFAC                CGL009
     I              HELD                            IFHELD                CGL009
     I              MINB                            IFMINB                CGL009
     I              LACD                            IFLACD                CGL009
     I              LISP                            IFLISP                CGL009
     I              RRNM                            IFRRNM                CGL009
     I              DRIB                            IFDRIB                CGL009
     I              DRIS                            IFDRIS                CGL009
     I              DRCD                            IFDRCD                CGL009
     I              DRIC                            IFDRIC                CGL009
     I              DRIF                            IFDRIF                CGL009
     I              DRDY                            IFDRDY                CGL009
     I              NDID                            IFNDID                CGL009
     I              LDID                            IFLDID                CGL009
     I              LDIA                            IFLDIA                CGL009
     I              SDAP                            IFSDAP                CGL009
     I              LPAR                            IFLPAR                CGL009
     I              DIIE                            IFDIIE                CGL009
     I              DAIC                            IFDAIC                CGL009
     I              MADI                            IFMADI                CGL009
     I              GADI                            IFGADI                CGL009
     I              DDIS                            IFDDIS                CGL009
     I              DDIA                            IFDDIA                CGL009
     I              OLDR                            IFOLDR                CGL009
     I              OLDB                            IFOLDB                CGL009
     I              OLDS                            IFOLDS                CGL009
     I              CRIB                            IFCRIB                CGL009
     I              CRIS                            IFCRIS                CGL009
     I              CRCD                            IFCRCD                CGL009
     I              CRIC                            IFCRIC                CGL009
     I              CRIF                            IFCRIF                CGL009
     I              CRDY                            IFCRDY                CGL009
     I              NCID                            IFNCID                CGL009
     I              LCID                            IFLCID                CGL009
     I              LCIA                            IFLCIA                CGL009
     I              SCAP                            IFSCAP                CGL009
     I              LPAP                            IFLPAP                CGL009
     I              CIIE                            IFCIIE                CGL009
     I              CAIC                            IFCAIC                CGL009
     I              MACI                            IFMACI                CGL009
     I              GACI                            IFGACI                CGL009
     I              CDIS                            IFCDIS                CGL009
     I              DCIA                            IFDCIA                CGL009
     I              OLCR                            IFOLCR                CGL009
     I              OLCB                            IFOLCB                CGL009
     I              OLCS                            IFOLCS                CGL009
     I              LCD                             IFLCD                 CGL009
     I              CHTP                            IFCHTP                CGL009
     I              TNLU                            IFTNLU                CGL009
     I              BRTCA                           IFBRTA                CGL009
     I              NACSG                           IFNACG                CGL009
     I              R4ACNT                          IFR4AC                CGL009
     I              ENOC                            IFENOC                CGL009
     I              EPNO                            IFEPNO                CGL009
     I              ECFB                            IFECFB                CGL009
     I              LTAB                            IFLTAB                CGL009
     I              LTAC                            IFLTAC                CGL009
     I              LTAS                            IFLTAS                CGL009
     I              HCFB                            IFHCFB                CGL009
     I              PTFR                            IFPTFR                CGL009
     I              HLEX                            IFHLEX                CGL009
     I              A5TIAC                          IFA5TA                CGL009
     I              A5TIAN                          IFA5TN                CGL009
     I              A5TIAS                          IFA5TS                CGL009
     I              EUSB                            IFEUSB                CGL009
     I              IBAN                            IFIBAN                CFT004
     I              IBSEQN                          IFIBSQ                CFT004
     I              FRNT                            IFFRNA                CAP035
     I              AFRT                            IFAFRT                CAP035
     I              REPA                            IFREPA                CAP035
     I              REPI                            IFREPI                CPB001
     I              FCCU                            IFFCCU                                    CLE025
     I              COLF                            IFCOLF                                    CLE025
     I              BCOA                            IFBCOA                                    CLE025
     I              COLA                            IFCOLA                                    CLE025
     I              PFCU                            IFPFCU                                    CLE025
     I              PFTP                            IFPFTP                                    CLE025
     I              PFSQ                            IFPFSQ                                    CLE025
     I              A5ACKY                          IFACKY                                    CTI004
     I              A5INTL                          IFINTL                                    CTI004
     I              A5TIAB                          IFTIAB                                    CTI004
     I              AUTH                            IFAUTH                                    CDL038
     I              K24C                            IFK24C                                    CER047
     I              ACEFDT                          IFEFDT                                    CRE075
     IP@ACCN    E DSACCNTAB                                               CFT004
     I              RECI                            IBRECI                CFT014
     I              CNUM                            IBCNUM                CFT004
     I              BRCA                            IBBRCA                CFT004
     I              ACOD                            IBACOD                CFT004
     I              ACSQ                            IBACSQ                CFT004
     I              PRFC                            IBPRFC                CFT014
     I              LCD                             IBLCD                 CFT004
     I              CHTP                            IBCHTP                CFT014
     I              FRNT                            IBFRNT                CFT014
     I              AFRT                            IBAFRT                CFT014
     I              REPA                            IBREPA                CFT014
     I              REPI                            IBREPI                CFT014
     I              TMST                            IBTMST                                    CPK014
     I              ACODQQ                          QQACO2                                    CGL029
     I              LTACQQ                          QQLTA1                                    CGL029
     I              A5ACKY                          IBACKY                                    CTI004
     I              A5INTL                          IBINTL                                    CTI004
     I              A5TIAB                          IBTIAB                                    CTI004
     I              AUTH                            IBAUTH                                    CSD027
     I              DCSP                            IDCSP                                     CLE134
     I              DCSG                            IDCSG                                     CLE134
     I              DRMT                            IDRMT                                     CLE134
     I              DRFD                            IDRFD                                     CLE134
     I              CCSP                            ICCSP                                     CLE134
     I              CCSG                            ICCSG                                     CLE134
     I              CRMT                            ICRMT                                     CLE134
     I              CRFD                            ICRFD                                     CLE134
     I*
     I* FIELDS NEEDED IN SETTING DEFAULT PAY VALUE DATE                   S01195
     IPYFLDS      DS                                                      S01195
     I                                        1   6 CNUMPY                S01195
     I                                        7   9 CCYPY                 S01195
     I                                       10  19 ACODPY                                    CGL029
     I                                       20  21 ACSQPY                                    CGL029
     I                                       22  24 BRCAPY                                    CGL029
     I**********                             10  12 ACODPY                             S01195 CGL029
     I**********                             13  15 ACSQPY                             S01195 CGL029
     I**********                             16  18 BRCAPY                             S01195 CGL029
      *                                                                   CRT002
      *                                                                   CGL009
      ** Data Structure to hold G/L account number                        CGL009
      *                                                                   CGL009
     IDSGLDG      DS                                                      CGL009
     I                                        1   6 WGLCST                CGL009
     I                                        7   9 WGLCCY                CGL009
     I                                       10  19 WGLACD                                    CGL029
     I                                       20  21 WGLSQN                                    CGL029
     I                                       22  24 WGLBCH                                    CGL029
     I**********                             10  13 WGLACD                             CGL009 CGL029
     I**********                             14  15 WGLSQN                             CGL009 CGL029
     I**********                             16  18 WGLBCH                             CGL009 CGL029
      *                                                                   130869
     I***CSHDTA*     DS                            512                                 CRT002 CGL029
     ICSHDTA      DS                            522                                           CGL029
      **  Define CASH data area                                           CRT002
      *                                                                   CRT002
     I**********                             21  240DACACD                             CRT002 CGL029
     I                                      513 5220DACACD                                    CGL029
      *                                                                   CRT002
     ISWDT2       DS                              6                       CRT002
      **  Data structure for date change                                  CRT002
      *                                                                   CRT002
     I                                        1   2 DDS                   CRT002
     I                                        3   4 MM                    CRT002
     I                                        5   6 YY                    CRT002
     I            DS                                                      179732
     I**********                              1   60BENRET                             179732 CSD027
     I                                        1   6 BENRET                                    CSD027
     I                                        1   6 RETNXX                179732
     I            DS                                                      179732
     I**********                              1   60AWBNUM                             179732 CSD027
     I                                        1   6 AWBNUM                                    CSD027
     I                                        1   6 AWBCHR                179732
     I/COPY WNCPYSRC,FT0050I001
     I*
     I/COPY ZSRSRC,ZHOLI                                                  S01195
     E/COPY FTCPYSRC,SFTVALCS                                             068230
     I*
     ISPARE       DS                            256                       CAC001
      * Define the data structure to pass data to WN0010 and return pgm   CAC001
      *                                                                   CAC001
     I                                        1   1 WWACTN                CAC001
     I                                    P   2   88WWRATE                CAC001
     I                                        9   9 WWPSIN                CAC001
     I                                       10  12 WWPCCY                CAC001
     I                                       13  15 WWSMCY                CAC001
     I                                    P  16  220WWPYAM                CAC001
     I                                    P  23  290WWSMAM                CAC001
     I                                       30  300WWMDIN                CAC001
     I                                    P  31  342WWFXMP                CAC001
     I                                       35  350WWFXMD                CAC001
     I                                       36  36 WWMBSI                CAC001
     I                                       37  37 WWMSIG                CAC001
     I                                    P  38  440WWMAMT                CAC001
     I                                       45  45 WWFRCI                CAC001
      /COPY FTCPYSRC,FT0010I001                                           CEU006
      **  Data Structure for input/output parameters                      CEU006
     I/COPY QWINDSRC,FT0050DTA                                            S01241
      *                                                                   CFT007
     IINFDS#    E DSY2I#DSP                                               CFT007
      * Display file information data structure                           CFT007
      *                                                                   CFT007
     I@OADD       DS                            175                       CFT007
      * Output Data Structure for reformatted address                     CFT007
     I                                        1  35 OADD1                 CFT007
     I                                       36  70 OADD2                 CFT007
     I                                       71 105 OADD3                 CFT007
     I                                      106 140 OADD4                 CFT007
     I                                      141 175 OADD5                 CFT007
      *                                                                   CFT009
      *  Transaction details file parameter for FT000980                  CFT009
      *                                                                   CFT009
     ITRNDET      DS                           3000                       CFT009
      *                                                                   CFT009
      *  Transaction details extension file parameter for FT000980        CFT009
      *                                                                   CFT009
     ITRNEXT      DS                           3000                       CFT009
      *                                                                   CFT009
      *  Incoming Payments Details data structure                         CFT009
      *                                                                   CFT009
     IINPYDS    E DSINPAYDD                                               CFT009
     I              LCD                             I2LCD                 CFT009
     I              TRCM                            INTRCM                CFT009
     I              TRCMD                           ITRCMD                CFT009
     I              TXCH                            INTXCH                CFT009
     I              TXCHD                           ITXCHD                CFT009
     I              CQCH                            INCQCH                CFT009
     I              CQCHD                           ICQCHD                CFT009
     I              ADCH                            INADCH                CFT009
     I              ADCHD                           IADCHD                CFT009
     I              TLCH                            INTLCH                CFT009
     I              TLCHD                           ITLCHD                CFT009
     I              MSCH                            INMSCH                CFT009
     I              MSCHD                           IMSCHD                CFT009
     I              INCHCM                          IPCHCM                CFT009
     I              INVATT                          IPVATT                CFT009
     I              INVAT1                          IPVAT1                CFT009
     I              INVAT2                          IPVAT2                CFT009
     I              INVAT3                          IPVAT3                CFT009
     I              INVAT4                          IPVAT4                CFT009
     I              INVAT5                          IPVAT5                CFT009
     I              INVAT6                          IPVAT6                CFT009
     I              INVAT7                          IPVAT7                CFT009
     I              INVATR                          IPVATR                CFT009
     I              DUMA1                           IDUMA1                CFT009
     I              DUMA2                           IDUMA2                CFT009
     I              DUMA3                           IDUMA3                CFT009
     I              DUMA4                           IDUMA4                CFT009
     I              DUMA5                           IDUMA5                CFT009
     I              DUMA6                           IDUMA6                CFT009
     I              INDUM7                          IPDUM7                CFT009
     I              INDUM8                          IPDUM8                CFT009
     I              CDRO                            INCDRO                CFT009
     I              TMST                            XXTMST                                    CPK014
      *                                                                   CFT009
      *  Incoming Payments Details Extension data structure               CFT009
      *                                                                   CFT009
     IINPXDS    E DSINPAYXPD                                              CFT009
     I              INPDOF                          IPPDOF                CFT009
     I              TLCODE                          ITLCOD                CFT009
     I              CHCHCD                          ICHCHC                CFT009
     I              ADCHCD                          IADCHC                CFT009
     I              TLCHCD                          ITLCHC                CFT009
     I              MISCH                           IMISCH                CFT009
     I              MSCH1                           IMSCH1                CFT009
     I              MSCH2                           IMSCH2                CFT009
     I              MSCH3                           IMSCH3                CFT009
     I              MSCH4                           IMSCH4                CFT009
     I              MSCH5                           IMSCH5                CFT009
     I              TFCCCO                          ITFCCC                CFT009
     I              FXCHEC                          IFXCHE                CFT009
     I              VTMIC1                          IVTMI1                CFT009
     I              VTMIC2                          IVTMI2                CFT009
     I              VTMIC3                          IVTMI3                CFT009
     I              VTMIC4                          IVTMI4                CFT009
     I              VTMIC5                          IVTMI5                CFT009
     I              CMSC01                          IMSC01                CFT009
     I              CMSC02                          IMSC02                CFT009
     I              CMSC03                          IMSC03                CFT009
     I              CMSC04                          IMSC04                CFT009
     I              CMSC05                          IMSC05                CFT009
     I              MSC01                           ILMSC1                CFT009
     I              MSC02                           ILMSC2                CFT009
     I              MSC03                           ILMSC3                CFT009
     I              MSC04                           ILMSC4                CFT009
     I              MSC05                           ILMSC5                CFT009
     I              DATNOE                          IDATNO                CFT009
     I              DATNAH                          IDATNA                CFT009
     I              CUNFLG                          ICUNFL                CFT009
     I              INCHRT                          IPCHRT                CFT009
     I              INCHGC                          IPCHGC                CFT009
     I              INTRIT                          IPTRIT                CFT009
     I              INTRIB                          IPTRIB                CFT009
     I              INTMST                          YYTMST                                    CPK014
      *                                                                   CFT014
     I              '0123456789.'         C         @CHK                  CFT014
     I              '123456789'           C         @NUL                  CFT014
      *                                                                   CFT002
      ** DS for message data for overdraft limit check                                        CRE008
      *                                                                                       CRE008
     IWOLTXT      DS                                                                          CRE008
     I**********                              1  22 WMDTA1                             CRE008 CGL029
     I**********                              1  33 WMDTA2                             CRE008 CGL029
     I                                        1  28 WMDTA1                                    CGL029
     I                                        1  39 WMDTA2                                    CGL029
     I                                        1   3 WBRCDE                                    CRE008
     I                                        4   4 WDASH1                                    CRE008
     I                                        5  10 WCUSTN                                    CRE008
     I                                       11  11 WDASH2                                    CRE008
     I                                       12  14 WCURR                                     CRE008
     I                                       15  15 WDASH3                                    CRE008
     I**********                             16  19 WACOD                              CRE008 CGL029
     I**********                             20  20 WDASH4                             CRE008 CGL029
     I**********                             21  22 WACSQ                              CRE008 CGL029
     I**********                             23  23 WSLSH                              CRE008 CGL029
     I**********                             24  33 WRETN                              CRE008 CGL029
     I                                       16  25 WACOD                                     CGL029
     I                                       26  26 WDASH4                                    CGL029
     I                                       27  28 WACSQ                                     CGL029
     I                                       29  29 WSLSH                                     CGL029
     I                                       20  39 WRETN                                     CGL029
      *                                                                                       CRE008
      **                                                                                      CSC022
     ISCCMT       DS                            256                                           CSC022
     I                                        1   30WCMTNO                                    CSC022
     I                                        4 103 WCJOBS                                    CSC022
      ** Commitment Control dataarea                                                          CSC022
      **                                                                                      CSC022
     I/EJECT
     C                     MOVEACPY@      BIS@   80
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0050CCPG                                           S01408
     C*                                                                   S01408
     C*****************************************************************
     C*                 AA-MAINLINE-PROCESSING                        *
     C*                                                               *
     C*  FUNCTION : TO CONTROL THE PROCESSING WITHIN THE PROGRAM.     *
     C*             IT CALLS A SUBROUTINE TO PERFORM INITIAL          *
     C*             PROCESSING & THEN CALLS A SUBROUTINE TO PROCESS   *
     C*             INPUT TO THE SCREEN UNTIL THE USER ABORTS THE     *
     C*             PROGRAM. FINALLY IT TIDIES UP AT END OF PROGRAM.  *
     C*                                                               *
     C*  CALLS :    CAINIT                                            *
     C*             CCPROC                                            *
     C*                                                               *
     C*  CALLED BY: NONE                                              *
     C*                                                               *
     C*****************************************************************
     C*
     C           *LIKE     DEFN DBFILE    WDBFIL
     C           *LIKE     DEFN DBKEY     WDBKEY
     C           *LIKE     DEFN DBASE     WDBASE
     C           *LIKE     DEFN BCNUMA    CUST                            179732
     C*
     C** PERFORM INITIAL PROCESSING
     C*
     C                     EXSR CAINIT
     C*
     C/COPY WNCPYSRC,FT0050C149
     C** PROCESS INPUT FROM SCREEN UNTIL USER ENDS PROGRAM BY PRESSING
     C** F1
      ** Or Function 3 returned from FTC0055.
      ** Or COMMAND 7 PRESSED                                             E29970
     C*
     C           *INKC     DOUEQ'1'
     C           *IN07     OREQ '1'                                       E29970
     C           PCMD      OREQ '1'
     C           @PREF     ORNE *BLANK
     C           *IN75     ANDEQ'0'
     C           *IN16     ANDEQ'0'                                       S01194
     C           PCMD      ANDNE'2'
     C/COPY WNCPYSRC,FT0050C089
     C                     EXSR CCPROC
     C                     END
     C/COPY WNCPYSRC,FT0050C150
     C*
     C**PERFORM*MANUAL*CLOSE*OF*MSIME*FILE*                               S01259
     C**PERFORM*MANUAL*CLOSE*OF*MSMSI2L9*FILE*                      S01259S01435
     C*
     C*********************CLOSEMSIME                                     S01259
     C***********          CLOSEMSMSI2L9                            S01259S01435
     C*
     C** SETON LAST RECORD INDICATOR & END PROGRAM
     C*
     C                     SETON                     LR
     C/COPY WNCPYSRC,FT0050C114
      * SETUP RETURN CODE
     C                     MOVE ' '       @RETC
     C           *INKC     IFEQ '1'
     C           PCMD      OREQ '1'
     C                     MOVE '1'       @RETC
     C                     END
     C           *INKL     IFEQ '1'
     C           PCMD      OREQ '5'
     C                     MOVE '5'       @RETC
     C                     END
     C** IF COMMAND 7                                                     E29970
     C           *IN07     IFEQ '1'                                       E29970
     C                     MOVE '7'       @RETC                           E29970
     C                     END                                            E29970
     C/COPY WNCPYSRC,FT0050C164
     C*
     C*          *****     ***
     C           AAEND     TAG
     C*          *****     ***
     C*
     C** END OF MAIN LINE PROCESSING
     C*
     C/EJECT
     C           CAINIT    BEGSR
     C*          ******    *****
     C*
     C*****************************************************************
     C*                 CA-INITIAL-PROCESSING                         *
     C*                                                               *
     C*  FUNCTION : TO PERFORM INITIAL PROCESSING.                    *
     C*                                                               *
     C*  CALLS :****UATBCN*********************************************   S01194
     C*             UEABRT                                            *
     C**************ZSYSTM*********************************************   S01194
     C*                                                               *
     C*  CALLED BY: AA-MAIN                                           *
     C*                                                               *
     C*****************************************************************
      *                                                                   056031
      *  Set up subroutine stack name                                     056031
      *                                                                   056031
     C                     ADD  1         O                               056031
     C                     MOVEL'CAINIT'  @STK,O                          056031
      *                                                                   056031
     C*                                                                   S01194
     C** ACCESS SDMMODPD TO OBTAIN MULTIBRANCH INDICATOR                  S01194
     C*                                                                   S01194
     C                     CALL 'AOMMODR0'                                S01194
     C                     PARM '*DBERR ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDMMOD    PARM SDMMOD    DSFDY                           S01194
     C*                                                                   S01117
     C** SET ON *IN10 IF MULTI-BRANCHED                                   S01117
     C*                                                                   S01117
     C           BGMBIN    COMP 'Y'                      10               S01117
     C*
     C***CALL*ZSYSTM*TO*ACCESS*I.C.D.R.*1*ON*TABLE*FILE*******            S01194
     C***********                                                         S01194
     C***********          EXSR ZSYSTM                                    S01194
     C***********                                                         S01194
     C***CHECK*IF*DATABASE*ERROR*OCCURRED*******                          S01194
     C***********                                                         S01194
     C************IN99     IFEQ '1'                                       S01194
     C***********          MOVEL'TABFP'   WDBFIL                          S01194
     C***********          MOVELZTABKY    WDBKEY                          S01194
     C***********          MOVEL'01'      WDBASE                          S01194
     C***********          EXSR UEABRT                     *ABORT PGM*    S01194
     C***********          END                                            S01194
      ***********                                                         S01194
      *****read*ICR*2**********                                           S01194
     C***********          MOVEL'01      'ZTABKY 12                       S01194
     C***********          MOVE '  11'    ZTABKY                          S01194
     C***********ZTABKY    CHAINTABTB11F             99    ON NOT THERE   S01194
     C**N99******RECI      COMP 'D'                  9999  ON, IS DELETED S01194
     C************IN99     IFEQ '1'                                       S01194
     C***********          MOVEL'TABFP'   WDBFIL                          S01194
     C***********          MOVELZTABKY    WDBKEY                          S01194
     C***********          MOVEL'49'      WDBASE                          S01194
     C***********          EXSR UEABRT                     *ABORT PGM*    S01194
     C***********          END                                            S01194
      *
     C** EXTRACT BANK DETAILS                                             S01194
     C*                                                                   S01194
     C                     CALL 'AOBANKR0'                                S01194
     C                     PARM '*DBERR ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
     C*                                                                   S01194
     C** SETUP RUNDATE                                                    S01194
     C*                                                                   S01194
     C                     MOVELBJCYCD    BCCY    3                       CFT009
     C                     MOVE BJMRDT    SRUNA                           S01194
     C                     MOVE BJDFIN    WUDFF   1                       CRT002
     C*                                                                   S01194
     C** CHECK DATE FORMAT                                                S01194
     C*                                                                   S01194
     C           BJDFIN    COMP 'M'                      98               S01194
      *                                                                   S01194
     C                     CALL 'AOFTFRR0'                                S01194
     C                     PARM '*DBERR ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDFTFR    PARM SDFTFR    DSFDY                           S01194
     C*                                                                   S01194
     C** EXTRACT GENERAL LEDGER DETAILS                                   S01194
     C*                                                                   S01194
     C**********           CALL 'AOGELRR0'                                             S01194 CGL029
     C                     CALL 'AOGELRR1'                                                    CGL029
     C                     PARM '*DBERR ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C********** SDGELR    PARM SDGELR    DSFDY                                        S01194 CGL029
     C           SDGELR    PARM SDGELR    DSSDY                                               CGL029
      *                                                                   S01414
      * If return code is not blank - process for a database error        S01414
      *                                                                   S01414
     C           @RTCD     IFNE *BLANKS                                   S01414
     C                     MOVEL'SDGELRPD'WDBFIL           *************  S01414
     C                     Z-ADD63        WDBASE           * DBERR 63  *  S01414
     C                     MOVEL@OPTN     WDBKEY           *************  S01414
     C                     EXSR UEABRT                                    S01414
     C                     END                                            S01414
      *                                                                   S01194
     C** SET ON *IN11 IF MULTI-BRANCHED & ORIG. BRANCH USED               S01117
     C*                                                                   S01117
     C           BKOBRU    COMP 'Y'                      11               S01117
     C*                                                                   S01117
     C***********1         CHAINPYCHGDD              99    Get defaults.  S01117
     C************IN99     IFEQ '1'                                       S01117
     C***********          MOVEL'PYCHG'   WDBFIL                          S01117
     C***********          MOVEL'1'       WDBKEY                          S01117
     C***********          MOVEL'50'      WDBASE                          S01117
     C***********          EXSR UEABRT                     *ABORT PGM*    S01117
     C***********          END                                            S01117
     C***********          CLOSEPYCHGDD                                   S01117
     C***********                                                         S01117
     C**ZEROISE*DFLT*CHEQUE*CHARGE*SO*IT*DOES*NOT*WRITE*TO*FILE*****      S01117
     C***********                                                         S01117
     C***********          Z-ADD0         CQCH                            S01117
     C***********                                                         S01117
      ***********                                                         S01117
      ***Convert*rate*%*discrepancy*to*higher*&*lower*rate*margins.*****  S01117
     C***********1         ADD  RATDIS    UPMARG  74                      S01117
     C***********1         SUB  RATDIS    LWMARG  74                      S01117
     C*
     C** CHECK IF RETAIL MODULE IS PRESENT & OPEN APPROPRIATE OPTIONAL
     C** FILES IF IT IS
     C*
     C***********          TESTB'2'       MODI1          89               S01194
     C***********BGRTBN    COMP 'Y'                                 S01194E23411
     C           BGRTBN    IFEQ 'Y'                                       E23411
     C           BGIOAC    OREQ 'Y'                                       E23411
     C                     MOVE '1'       *IN89                           E23411
     C                     MOVE '1'       *IN32                           056031
     C                     END                                            E23411
     C*
      ************                                                        056031
      ************  Remove PRONO OLPOS and MEMOS processing               056031
      ************                                                        056031
     C************IN89     IFEQ '1'                                       056031
     C************         OPEN MEMOS                  89    -FAILS       056031
     C************IN89     IFEQ '1'                                       056031
     C************         MOVEL'MEMOS'   WDBFIL                          056031
     C************         MOVEL'OPEN'    WA11   11                       056031
     C************         MOVE 'FAILED'  WA11                            056031
     C************         MOVELWA11      WDBKEY                          056031
     C************         MOVEL'02'      WDBASE                          056031
     C************         EXSR UEABRT                                    056031
     C************         END                                            056031
     C************         SETON                     32       -OPEN OK    056031
     C************         END                                            056031
     C************                                                        056031
     C***CHECK*IF*DEALING MODULE IS PRESENT & OPEN APPROPRIATE OPTIONAL   056031
     C***FILES*IF*IT IS                                                   056031
     C************                                                        056031
     C***********          TESTB'1'       MODI1          89               S01194
     C           BGDLFX    COMP 'Y'                      89               S01194
     C   89      BGDLMM    COMP 'Y'                      89               S01194
     C*
     C           *IN89     IFEQ '1'
     C                     MOVEL'1'       *IN30                           056031
     C                     MOVEL'1'       *IN31                           056031
     C                     END                                            056031
     C***********          OPEN OLPOS                  89    -FAILS       056031
     C************IN89     IFEQ '1'                                       056031
     C***********          MOVEL'OLPOS'   WDBFIL                          056031
     C***********          MOVEL'OPEN'    WA11   11                       056031
     C***********          MOVE 'FAILED'  WA11                            056031
     C***********          MOVELWA11      WDBKEY                          056031
     C***********          MOVEL'03'      WDBASE                          056031
     C***********          EXSR UEABRT                                    056031
     C***********          END                                            056031
     C***********          SETON                     31       -OPEN OK    056031
     C***********                                                         056031
     C***********          OPEN PRONO                  89    -FAILS       056031
     C************IN89     IFEQ '1'                                       056031
     C***********          MOVEL'PRONO'   WDBFIL                          056031
     C***********          MOVEL'OPEN'    WA11   11                       056031
     C***********          MOVE 'FAILED'  WA11                            056031
     C***********          MOVELWA11      WDBKEY                          056031
     C***********          MOVEL'04'      WDBASE                          056031
     C***********          EXSR UEABRT                                    056031
     C***********          END                                            056031
     C***********          SETON                     30       -OPEN OK    056031
     C***********                                                         056031
     C***********          END                                            056031
     C***********                                                         S01194
     C***CALL*UATBCN*TO*ACCESS*I.C.D.R.*2*ON*TABLE*FILE******             S01194
     C***********                                                         S01194
     C***********          MOVEL*BLANKS   ZTABKY                          S01194
     C***********          MOVEL'01'      ZTABKY                          S01194
     C***********          MOVE '11'      ZTABKY                          S01194
     C***********          EXSR UATBCN                                    S01194
     C***********                                                         S01194
     C***CHECK*IF*DATABASE*ERROR*OCCURRED                                 S01194
     C***********                                                         S01194
     C************IN89     IFEQ '1'                                       S01194
     C***********          MOVEL'TABFP'   WDBFIL                          S01194
     C***********          MOVELZTABKY    WDBKEY                          S01194
     C***********          MOVEL'05'      WDBASE                          S01194
     C***********          EXSR UEABRT                     *ABORT PGM*    S01194
     C***********          END                                            S01194
     C*
     C** STORE BASE CURRENCY
     C*
     C***********          MOVELBCCY      SVBCCY  3                       S01194
     C                     MOVELBJCYCD    SVBCCY  3                       S01194
     C**READ*TABLE*FILE*FOR*BASE*CURRENCY                                 S01194
     C***********          MOVE *BLANK    ZTABKY                          S01194
     C***********          MOVEL'20'      ZTABKY                          S01194
     C***********          MOVELBCCY      SCCY    4                       S01194
     C***********          MOVE '1'       SCCY                            S01194
     C***********          MOVE SCCY      ZTABKY                          S01194
     C***********          EXSR UATBCN                                    S01194
     C***********                                                         S01194
     C***CHECK*IF*DATABASE*ERROR*OCCURRED********                         S01194
     C***********                                                         S01194
     C************IN89     IFEQ '1'                                       S01194
     C***********          MOVEL'TABFP'   WDBFIL                          S01194
     C***********          MOVELZTABKY    WDBKEY                          S01194
     C***********          MOVEL'51'      WDBASE                          S01194
     C***********          EXSR UEABRT                     *ABORT PGM*    S01194
     C***********          END                                            S01194
     C*                                                                   S01194
     C** CALL ACCESS PROGRAM FOR BASE CURRENCY                            S01194
     C*                                                                   S01194
     C                     CALL 'AOCURRR0'                                S01194
     C                     PARM '*DBERR ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM BJCYCD    @CCY    3                       S01194
     C           SDCURR    PARM SDCURR    DSSDY                           S01194
     C                     EXSR MVCURR                                    S01194
     C*                                                                   S01194
     C* STORE BASE CURRENCY DECIMAL PLACES
     C***********          Z-ADDCDP       BCDP    10                      S01194
     C                     Z-ADDA6NBDP    BCDP    10                      S01194
     C*
     C**   SETUP THE BACKVALUE LIMIT DATE
     C*
     C***********RUND      SUB  BVLP      BVLD    50                      S01194
     C           BJRDNB    SUB  BJBVPD    BVLD    50                      S01194
     C*
     C***CALL*UATBCN*TO*ACCESS*I.C.D.R.*3*ON*TABLE*FILE                   S01194
     C***********                                                         S01194
     C***********          MOVEL*BLANKS   ZTABKY                          S01194
     C***********          MOVEL'01'      ZTABKY                          S01194
     C***********          MOVE '20'      ZTABKY                          S01194
     C***********          EXSR UATBCN                                    S01194
     C***********                                                         S01194
     C***CHECK*IF*DATABASE*ERROR*OCCURRED                                 S01194
     C***********                                                         S01194
     C************IN89     IFEQ '1'                                       S01194
     C***********          MOVEL'TABFP'   WDBFIL                          S01194
     C***********          MOVELZTABKY    WDBKEY                          S01194
     C***********          MOVEL'06'      WDBASE                          S01194
     C***********          EXSR UEABRT                     *ABORT PGM*    S01194
     C***********          END                                            S01194
     C*                                                                   S01194
     C           BGRTBN    IFEQ 'Y'                                       084499
     C                     CALL 'AORETLR0'                                S01194
     C                     PARM '*DBERR ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDRETL    PARM SDRETL    DSFDY                           S01194
     C                     END                                            084499
     C*
     C** DETERMINE IF RETAIL ACCOUNT NUMBERS ARE USED
     C*
     C***********RACN      IFEQ 'Y'                                       S01194
     C           BMRANR    IFEQ 'Y'                                       S01194
     C                     SETON                     33
     C                     END
     C***********                                                         S01435
     C**SETUP*FIELD FOR 'CRLF:' FOR CHECKING IN SCAN                      S01435
     C***********          BITOF'01236'   BTA                             S01435
     C***********          BITON'457'     BTA                             S01435
     C***********          BITOF'01346'   BTB                             S01435
     C***********          BITON'257'     BTB                             S01435
     C***********          MOVE ':'       CLN                             S01435
     C***********          MOVELCRLFC     CRLF    1                       S01435
     C**SETUP*FIELD FOR 'CRLF-AUT' FOR CHECKING IN SCAN                   S01435
     C***********          MOVELCRLFC     CRLFA   6                       S01435
     C***********          MOVE '-AUT'    CRLFA                           S01435
      *                                                             S01241S01194
      **SEE*IF*WINDOW*REQUIRED                                      S01241S01194
      ***********                                                   S01241S01194
     C***********1         SETLLSDMMODPD                            S01241S01194
     C***********          READ SDMMODPD               8989         S01241S01194
     C************IN89     IFEQ '1'                                 S01241S01194
     C***********          MOVEL'SDMMOD'  WDBFIL                    S01241S01194
     C***********          MOVEL'FRT'     WDBKEY           *********S01241S01194
     C***********          MOVEL'99'      WDBASE           ** DBASE S01241S01194
     C***********          EXSR UEABRT                     *********S01241S01194
     C***********          END                                      S01241S01194
     C*                                                                   S01494
     C** Access SAR details file to determine if S01494 is switched ON    S01494
     C*                                                                   S01494
     C                     MOVE *BLANK    S01494  1                       S01494
     C                     CALL 'AOSARDR0'                                S01494
     C                     PARM *BLANKS   @RTRN   7                       S01494
     C                     PARM '*VERIFY' @OPTN   7                       S01494
     C                     PARM 'S01494'  @SARD   6                       S01494
     C           SCSARD    PARM SCSARD    DSFDY                           S01494
     C*                                                                   S01494
     C** If core feature is switched ON, set a variable field to          S01494
     C** condition the rest of the processing                             S01494
     C*                                                                   S01494
     C           @RTRN     IFEQ *BLANKS                                   S01494
     C                     MOVE 'Y'       S01494                          S01494
     C                     ELSE                                           S01494
     C*                                                                   S01494
     C** else, database error (return code other than *NRF)               S01494
     C*                                                                   S01494
     C           @RTRN     IFNE '*NRF   '                                 S01494
     C                     MOVEL'SCSARDPD'W0FILE           ************   S01494
     C                     MOVEL'*VERIFY' W0KEY            * DBERR 01 *   S01494
     C                     Z-ADD1         W0ERNB           ************   S01494
     C                     EXSR SRERR                      *ABORT PGM*    S01494
     C                     END                                            S01494
     C                     END                                            S01494
     C*                                                                   S01499
     C** Access SAR details file to determine if S01499 is switched ON    S01499
     C*                                                                   S01499
     C                     MOVE *BLANKS   S01499  1                       S01499
     C                     CALL 'AOSARDR0'                                S01499
     C                     PARM *BLANKS   @RTRN   7                       S01499
     C                     PARM '*VERIFY' @OPTN   7                       S01499
     C                     PARM 'S01499'  @SARD   6                       S01499
     C           SCSARD    PARM SCSARD    DSFDY                           S01499
     C*                                                                   S01499
     C** If core feature is switched ON, set a variable field to          S01499
     C** condition the rest of the processing                             S01499
     C*                                                                   S01499
     C           @RTRN     IFEQ *BLANKS                                   S01499
     C                     MOVE 'Y'       S01499                          S01499
     C                     ELSE                                           S01499
     C*                                                                   S01499
     C** else, database error (return code other than *NRF)               S01499
     C*                                                                   S01499
     C           @RTRN     IFNE '*NRF   '                                 S01499
     C                     MOVEL'SCSARDPD'W0FILE           ************   S01499
     C                     MOVEL'*VERIFY' W0KEY            * DBERR 02 *   S01499
     C                     Z-ADD2         W0ERNB           ************   S01499
     C                     EXSR SRERR                      *ABORT PGM*    S01499
     C                     END                                            S01499
     C                     END                                            S01499
      *                                                                   CFT009
      ** Access SAR details file to determine if CFT010 is switched ON.   CFT009
      *                                                                   CFT009
     C                     CALL 'AOSARDR0'                                CFT009
     C                     PARM *BLANKS   @RTRN                           CFT009
     C                     PARM '*VERIFY' @OPTN                           CFT009
     C                     PARM 'CFT010'  @SARD                           CFT009
     C           SCSARD    PARM SCSARD    DSFDY                           CFT009
      *                                                                   CFT009
     C           @RTRN     IFEQ *BLANKS                                   CFT009
     C                     MOVE 'Y'       CFT010  1                       CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
      *                                                                   CFT009
     C           @RTRN     IFNE '*NRF   '                                 CFT009
     C                     Z-ADD010       W0ERNB                          CFT009
     C                     MOVEL'CFT010'  W0KEY                           CFT009
     C                     MOVEL'SCSARDPD'W0FILE                          CFT009
     C                     EXSR SRERR                                     CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       CFT010                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
     C*                                                                   S01499
     C** If V.A.T. is active, access file for V.A.T rate                  S01499
     C*                                                                   S01499
     C           S01499    IFEQ 'Y'                                       S01499
     C           CFT010    OREQ 'Y'                                       CFT009
     C*                                                                   S01499
     C                     CALL 'AOVATR0'              9090               S01499
     C                     PARM '*MSG   ' P@RTCD  7        B:Return code  S01499
     C                     PARM '*FIRST ' P@OPTN  7        I:Option       S01499
     C                     PARM           VATDS                           S01499
     C*                                                                   S01499
     C** If return with an error (LR seton in called program) then        S01499
     C** process for database error.                                      S01499
     C*                                                                   S01499
     C           *IN90     IFEQ '1'                                       S01499
     C           P@RTCD    OREQ '*ERROR*'                                 S01499
     C                     MOVEL'ABSFI101'W0FILE           ************   S01499
     C                     MOVEL'*FIRST ' W0KEY            * DBERR 05 *   S01499
     C                     Z-ADD5         W0ERNB           ************   S01499
     C                     EXSR SRERR                      *ABORT PGM*    S01499
     C                     ELSE                                           S01499
     C                     Z-ADDO#VATR    WVATR   54                      S01499
     C                     END                                            S01499
     C                     END                                            S01499
     C*                                                                   S01506
     C** Access SAR details file to determine if S01506 is switched ON    S01506
     C*                                                                   S01506
     C                     MOVE *BLANK    S01506  1                       S01506
     C                     CALL 'AOSARDR0'                                S01506
     C                     PARM *BLANKS   @RTRN   7                       S01506
     C                     PARM '*VERIFY' @OPTN   7                       S01506
     C                     PARM 'S01506'  @SARD   6                       S01506
     C           SCSARD    PARM SCSARD    DSFDY                           S01506
     C*                                                                   S01506
     C** If core feature is switched ON, set a variable field to          S01506
     C** condition the rest of the processing                             S01506
     C*                                                                   S01506
     C           @RTRN     IFEQ *BLANKS                                   S01506
     C                     MOVE 'Y'       S01506                          S01506
     C                     ELSE                                           S01506
     C*                                                                   S01506
     C** else, database error (return code other than *NRF)               S01506
     C*                                                                   S01506
     C           @RTRN     IFNE '*NRF   '                                 S01506
     C                     MOVEL'SCSARDPD'W0FILE           ************   S01506
     C                     MOVEL'*VERIFY' W0KEY            * DBERR 03 *   S01506
     C                     Z-ADD3         W0ERNB           ************   S01506
     C                     EXSR SRERR                      *ABORT PGM*    S01506
     C                     END                                            S01506
     C                     END                                            S01506
     C*                                                                   S01508
     C** Access SAR details file to determine if S01508 is switched ON    S01508
     C*                                                                   S01508
     C                     MOVE *BLANKS   S01508  1                       S01508
     C                     CALL 'AOSARDR0'                                S01508
     C                     PARM *BLANKS   @RTRN   7                       S01508
     C                     PARM '*VERIFY' @OPTN   7                       S01508
     C                     PARM 'S01508'  @SARD   6                       S01508
     C           SCSARD    PARM SCSARD    DSFDY                           S01508
     C*                                                                   S01508
     C** If core feature is switched ON, set a variable field to          S01508
     C** condition the rest of the processing                             S01508
     C*                                                                   S01508
     C           @RTRN     IFEQ *BLANKS                                   S01508
     C                     MOVE 'Y'       S01508                          S01508
     C                     ELSE                                           S01508
     C*                                                                   S01508
     C** else, database error (return code other than *NRF)               S01508
     C*                                                                   S01508
     C           @RTRN     IFNE '*NRF   '                                 S01508
     C                     MOVEL'SCSARDPD'W0FILE           ************   S01508
     C                     MOVEL'*VERIFY' W0KEY            * DBERR 04 *   S01508
     C                     Z-ADD4         W0ERNB           ************   S01508
     C                     EXSR SRERR                      *ABORT PGM*    S01508
     C                     END                                            S01508
     C                     END                                            S01508
     C** Access SAR details file to determine if CEU006 is switched ON    CEU006
     C*                                                                   CEU006
     C                     MOVE *BLANK    CEU006  1                       CEU006
     C                     CALL 'AOSARDR0'                                CEU006
     C                     PARM *BLANKS   @RTRN   7                       CEU006
     C                     PARM '*VERIFY' @OPTN   7                       CEU006
     C                     PARM 'CEU006'  @SARD   6                       CEU006
     C           SCSARD    PARM SCSARD    DSFDY                           CEU006
     C*                                                                   CEU006
     C** If core feature is switched ON, set a variable field to          CEU006
     C** condition the rest of the processing                             CEU006
     C*                                                                   CEU006
     C           @RTRN     IFEQ *BLANKS                                   CEU006
     C                     MOVE 'Y'       CEU006                          CEU006
     C                     ELSE                                           CEU006
     C*                                                                   CEU006
     C** else, database error (return code other than *NRF)               CEU006
     C*                                                                   CEU006
     C           @RTRN     IFNE '*NRF   '                                 CEU006
     C                     MOVEL'SCSARDPD'W0FILE           ************   CEU006
     C                     MOVEL'*VERIFY' W0KEY            * DBERR 07 *   CEU006
     C                     Z-ADD7         W0ERNB           ************   CEU006
     C                     EXSR SRERR                      *ABORT PGM*    CEU006
     C                     ELSE                                           CEU006
     C                     MOVE 'N'       CEU006                          CEU006
     C                     ENDIF                                          CEU006
     C                     ENDIF                                          CEU006
     C*                                                                   CEU006
     C** If switchable feature CEU006 is not installed move on            CEU006
     C** indicators to non-display Delivery currency and amount fields    CEU006
     C*                                                                   CEU006
     C           CEU006    IFEQ 'N'                                       CEU006
     C                     MOVE *ON       *IN15                           CEU006
     C                     ENDIF                                          CEU006
     C*                                                                   CEU006
     C/COPY WNCPYSRC,FT0050C043
      *                                                                   CGL007
      ** Access SAR details to determine if CGL007 is installed           CGL007
      *                                                                   CGL007
     C                     CALL 'AOSARDR0'                                CGL007
     C                     PARM *BLANKS   PRTCD   7                       CGL007
     C                     PARM '*VERIFY' POPTN   7                       CGL007
     C                     PARM 'CGL007'  PSARD   6                       CGL007
     C           SCSARD    PARM SCSARD    DSFDY                           CGL007
      *                                                                   CGL007
     C           PRTCD     IFEQ *BLANKS                                   CGL007
     C                     MOVE 'Y'       CGL007  1                       CGL007
     C                     MOVE *BLANKS   GL0090  1                       CGL007
      *                                                                   CGL007
      ** If program is called by GL0090, @RETC contains 'Z'               CGL007
      *                                                                   CGL007
     C           @RETC     IFEQ 'Z'                                       CGL007
     C                     MOVE 'Y'       GL0090                          CGL007
     C                     MOVE *BLANK    @RETC                           CGL007
     C                     ENDIF                                          CGL007
     C                     ELSE                                           CGL007
     C           PRTCD     IFNE '*NRF   '                                 CGL007
     C                     MOVEL'SCSARDPD'W0FILE           ************   CGL007
     C                     MOVEL'*VERIFY' W0KEY            * DBERR 06 *   CGL007
     C                     Z-ADD6         W0ERNB           ************   CGL007
     C                     EXSR SRERR                                     CGL007
     C                     ELSE                                           CGL007
     C                     MOVE 'N'       CGL007                          CGL007
     C                     ENDIF                                          CGL007
     C                     ENDIF                                          CGL007
     C** Access SAR details file to determine if CGL009 is switched ON    175479
     C*                                                                   175479
     C                     MOVE *BLANK    CGL009  1                       175479
     C                     CALL 'AOSARDR0'                                175479
     C                     PARM *BLANKS   @RTRN   7                       175479
     C                     PARM '*VERIFY' @OPTN   7                       175479
     C                     PARM 'CGL009'  @SARD   6                       175479
     C           SCSARD    PARM SCSARD    DSFDY                           175479
     C*                                                                   175479
     C** If core feature is switched ON, set a variable field to          175479
     C** condition the rest of the processing                             175479
     C*                                                                   175479
     C           @RTRN     IFEQ *BLANKS                                   175479
     C                     MOVE 'Y'       CGL009                          175479
     C** Show FONTIS: deal reference field                                175479
     C                     SETON                     64                   175479
     C                     ELSE                                           175479
     C*                                                                   175479
     C** else, database error (return code other than *NRF)               175479
     C*                                                                   175479
     C           @RTRN     IFNE '*NRF   '                                 175479
     C                     MOVEL'SCSARDPD'W0FILE           ************   175479
     C                     MOVEL'*VERIFY' W0KEY            * DBERR 70 *   175479
     C                     Z-ADD70        W0ERNB           ************   175479
     C                     EXSR SRERR                      *ABORT PGM*    175479
     C                     ELSE                                           175479
     C                     MOVE 'N'       CGL009                          175479
     C** Hide FONTIS: deal reference field                                175479
     C                     SETOF                     64                   175479
     C                     ENDIF                                          175479
     C                     ENDIF                                          175479
      * ENTRY PARAMS
     C           *ENTRY    PLIST
     C           SACTCD    PARM           @SORT   1
     C           SPREF     PARM           @PREF  15
     C                     PARM           @RETC   1
     C                     PARM           WLINK   1
     C/COPY WNCPYSRC,FT0050C001
     C*                                                                   096486
     C**  If program is called by GL4442, then initialise fields.         096486
     C*                                                                   096486
     C                     MOVE *BLANK    @GL442  1                       096486
     C           @RETC     IFEQ 'G'                                       096486
     C                     MOVE 'Y'       @GL442                          096486
     C                     MOVE *BLANK    @RETC                           096486
     C                     END                                            096486
     C*
     C**PERFORM*MANUAL*OPEN*OF*MSIME*                                     S01259
     C**PERFORM*MANUAL*OPEN*OF*MSMSI2L9*                            S01259S01435
     C*
     C*********************OPEN MSIME                                     S01259
     C**********           OPEN MSMSI2L9                            S01259S01435
      *                                                                   056031
      * Access FT Control data                                            056031
      *                                                                   056031
     C                     CALL 'FT0005'               9090               056031
     C           R#RTN     PARM *BLANKS   O#RTN   7                       056031
     C           C#CNTL    PARM           O#DTA 256                       056031
      *                                                                   056031
     C           *IN90     IFEQ '1'                                       056031
     C           R#RTN     ORNE *BLANKS                                   056031
     C                     MOVEL'*CALL   'W0FILE                          056031
     C                     MOVEL'FT0005'  W0KEY                           056031
     C                     Z-ADD1         W0ERNB                          056031
     C                     MOVELERR@,1    W0NARR                          056031
     C                     EXSR SRERR                                     056031
     C                     END                                            056031
      *                                                                   056031
      * Set up FT override for General Ledger Balances                    056031
      *                                                                   056031
     C           C#GLUI    IFEQ 'I'                                       056031
     C                     MOVEL'Y'       ##FTOV  1                       056031
     C                     ELSE                                           056031
     C                     MOVEL*BLANKS   ##FTOV                          056031
     C                     END                                            056031
     C*                                                                   S01494
     C** Retrieve message id FTM2510 from GBFTUSRMSG                      S01494
     C*                                                                   S01494
     C                     CALL 'MEC1150'              9090               S01494
     C                     PARM 'FTM2510' #MSGID                          S01494
     C                     PARM 'FTUSRMSG'#MSGF                           S01494
     C                     PARM           #MSDTA                          S01494
     C                     PARM *BLANKS   #MSTX1                          S01494
     C                     PARM *BLANKS   #MSTX2                          S01494
      *                                                                   S01494
     C                     MOVEL#MSTX1    WM2510 28                       S01494
     C*                                                                   S01494
     C** Retrieve message id FTM2519 from GBFTUSRMSG                      S01494
     C*                                                                   S01494
     C                     CALL 'MEC1150'              9090               S01494
     C                     PARM 'FTM2519' #MSGID                          S01494
     C                     PARM 'FTUSRMSG'#MSGF                           S01494
     C                     PARM           #MSDTA                          S01494
     C                     PARM *BLANKS   #MSTX1                          S01494
     C                     PARM *BLANKS   #MSTX2                          S01494
      *                                                                   S01494
     C                     MOVEL#MSTX1    WM2519 28                       S01494
     C*                                                                   S01494
     C** Retrieve message id FTM2538 from GBFTUSRMSG                      S01494
     C*                                                                   S01494
     C                     CALL 'MEC1150'              9090               S01494
     C                     PARM 'FTM2538' #MSGID                          S01494
     C                     PARM 'FTUSRMSG'#MSGF                           S01494
     C                     PARM           #MSDTA                          S01494
     C                     PARM *BLANKS   #MSTX1                          S01494
     C                     PARM *BLANKS   #MSTX2                          S01494
     C*                                                                   S01494
     C                     MOVEL#MSTX1    WKEY1  78                       S01494
     C*                                                                   S01494
     C** Retrieve message id FTM2539 from GBFTUSRMSG                      S01494
     C*                                                                   S01494
     C                     CALL 'MEC1150'              9090               S01494
     C                     PARM 'FTM2539' #MSGID                          S01494
     C                     PARM 'FTUSRMSG'#MSGF                           S01494
     C                     PARM           #MSDTA                          S01494
     C                     PARM *BLANKS   #MSTX1                          S01494
     C                     PARM *BLANKS   #MSTX2                          S01494
     C*                                                                   S01494
     C                     MOVEL#MSTX1    WKEY2  78                       S01494
     C/COPY WNCPYSRC,FT0050C084
     C*                                                                   S01494
     C** Retrieve message id FTM2540 from GBFTUSRMSG                      S01494
     C*                                                                   S01494
     C                     CALL 'MEC1150'              9090               S01494
     C                     PARM 'FTM2540' #MSGID                          S01494
     C                     PARM 'FTUSRMSG'#MSGF                           S01494
     C                     PARM           #MSDTA                          S01494
     C                     PARM *BLANKS   #MSTX1                          S01494
     C                     PARM *BLANKS   #MSTX2                          S01494
     C*                                                                   S01494
     C                     MOVEL#MSTX1    WKEY3  78                       S01494
     C*                                                                   S01494
     C** Retrieve message id FTM2541 from GBFTUSRMSG                      S01494
     C*                                                                   S01494
     C                     CALL 'MEC1150'              9090               S01494
     C                     PARM 'FTM2541' #MSGID                          S01494
     C                     PARM 'FTUSRMSG'#MSGF                           S01494
     C                     PARM           #MSDTA                          S01494
     C                     PARM *BLANKS   #MSTX1                          S01494
     C                     PARM *BLANKS   #MSTX2                          S01494
     C*                                                                   S01494
     C                     MOVEL#MSTX1    WKEY4  78                       S01494
     C*                                                                   S01494
     C** Retrieve message id FTM2542 from GBFTUSRMSG                      S01494
     C*                                                                   S01494
     C                     CALL 'MEC1150'              9090               S01494
     C                     PARM 'FTM2542' #MSGID                          S01494
     C                     PARM 'FTUSRMSG'#MSGF                           S01494
     C                     PARM           #MSDTA                          S01494
     C                     PARM *BLANKS   #MSTX1                          S01494
     C                     PARM *BLANKS   #MSTX2                          S01494
     C*                                                                   S01494
     C                     MOVEL#MSTX1    WKEY5  78                       S01494
     C/COPY WNCPYSRC,FT0050C085
      *                                                                   S01435
     C** Retrieve message id FTM2623 from GBFTUSRMSG                      CFT007
     C*                                                                   CFT007
     C                     CALL 'MEC1150'              9090               CFT007
     C                     PARM 'FTM2623' #MSGID                          CFT007
     C                     PARM 'FTUSRMSG'#MSGF                           CFT007
     C                     PARM           #MSDTA                          CFT007
     C                     PARM *BLANKS   #MSTX1                          CFT007
     C                     PARM *BLANKS   #MSTX2                          CFT007
     C*                                                                   CFT007
     C                     MOVEL#MSTX1    WKEY6  78                       CFT007
      *                                                                   CFT007
     C** Retrieve message id FTM2624 from GBFTUSRMSG                      CFT007
     C*                                                                   CFT007
     C                     CALL 'MEC1150'              9090               CFT007
     C                     PARM 'FTM2624' #MSGID                          CFT007
     C                     PARM 'FTUSRMSG'#MSGF                           CFT007
     C                     PARM           #MSDTA                          CFT007
     C                     PARM *BLANKS   #MSTX1                          CFT007
     C                     PARM *BLANKS   #MSTX2                          CFT007
     C*                                                                   CFT007
     C                     MOVEL#MSTX1    WKEY7  78                       CFT007
      *                                                                   CFT007
      * Clear message subfile                                             S01435
      *                                                                   S01435
     C                     CALL 'Y2CLMSC'                                 S01435
     C                     PARM ##PGM     FTPGMQ 10                       S01435
     C                     PARM '*SAME'   FTPGRL  5                       S01435
      *                                                                   S01435
      * Reset message sent flag                                           S01435
      *                                                                   S01435
     C                     MOVEL'N'       FTMSGS  1                       S01435
     C/COPY WNCPYSRC,FT0050C071
      *                                                                   CRT002
      **  Get CASH information.                                           CRT002
      *                                                                   CRT002
     C           *NAMVAR   DEFN CASH      CSHDTA                          CRT002
     C                     IN   CSHDTA                                    CRT002
      *                                                                   S01435
      *  /Copy point for Initialisation                                   S01435
      *                                                                   S01435
     C/COPY WNCPYSRC,FT0050INIT                                           S01435
      *                                                                   CFT002
      *  Access SAR details file to see if CFT002 is installed.           CFT002
      *                                                                   CFT002
     C                     CALL 'AOSARDR0'                                CFT002
     C                     PARM *BLANKS   P@RTCD  7                       CFT002
     C                     PARM '*VERIFY' P@OPTN  7                       CFT002
     C                     PARM 'CFT002'  @SARD   6                       CFT002
     C           SCSARD    PARM *BLANKS   DSFDY                           CFT002
      *                                                                   CFT002
      *  Allow decode processing                                          CFT002
      *                                                                   CFT002
     C           P@RTCD    IFEQ *BLANKS                                   CFT002
     C                     MOVEL'CFT002'  CFT002  6                       CFT002
     C                     END                                            CFT002
      *                                                                   CFT003
      *  Access SAR details file to see if CFT003 is installed.           CFT003
      *                                                                   CFT003
     C                     CALL 'AOSARDR0'                                CFT003
     C                     PARM *BLANKS   P@RTCD  7                       CFT003
     C                     PARM '*VERIFY' P@OPTN  7                       CFT003
     C                     PARM 'CFT003'  @SARD   6                       CFT003
     C           SCSARD    PARM *BLANKS   DSFDY                           CFT003
      *                                                                   CFT003
      *  Allow Batch Authorisation processing                             CFT003
      *                                                                   CFT003
     C           P@RTCD    IFEQ *BLANKS                                   CFT003
     C           CFT003    ANDEQ*BLANKS                                   CFT003
     C                     MOVEL'CFT003'  CFT003  6                       CFT003
     C                     OPEN INPAYXL0                                  CFT003
     C                     END                                            CFT003
      *                                                                   CFT004
      ** Access SAR details file to see if CFT004 is installed.           CFT004
      *                                                                   CFT004
     C                     CALL 'AOSARDR0'                                CFT004
     C                     PARM *BLANKS   P@RTCD  7                       CFT004
     C                     PARM '*VERIFY' P@OPTN  7                       CFT004
     C                     PARM 'CFT004'  @SARD   6                       CFT004
     C           SCSARD    PARM *BLANKS   DSFDY                           CFT004
      *                                                                   CFT004
      ** Allow IBAN processing                                            CFT004
      *                                                                   CFT004
     C           P@RTCD    IFEQ *BLANKS                                   CFT004
     C                     MOVEL'Y'       CFT004  1                       CFT004
     C                     END                                            CFT004
      *                                                                   CFT007
      *  Access SAR details file to see if CFT007 is installed.           CFT007
      *                                                                   CFT007
     C                     CALL 'AOSARDR0'                                CFT007
     C                     PARM *BLANKS   P@RTCD  7                       CFT007
     C                     PARM '*VERIFY' P@OPTN  7                       CFT007
     C                     PARM 'CFT007'  @SARD   6                       CFT007
     C           SCSARD    PARM *BLANKS   DSFDY                           CFT007
      *                                                                   CFT007
      *  Allow BIC Database Plus Integration                              CFT007
      *                                                                   CFT007
     C           P@RTCD    IFEQ *BLANKS                                   CFT007
     C                     MOVEL'CFT007'  CFT007  6                       CFT007
     C                     MOVE *ON       *IN85                           CFT007
     C                     ENDIF                                          CFT007
      *                                                                                       CFT050
      ** Access SAR file to determine if CFT050 (SWIFTRef Directories                         CFT050
      ** upload) is installed.                                                                CFT050
      *                                                                                       CFT050
     C                     CALL 'AOSARDR0'                                                    CFT050
     C                     PARM *BLANKS   PRTCD                                               CFT050
     C                     PARM '*VERIFY' POPTN                                               CFT050
     C                     PARM 'CFT050'  PSARD                                               CFT050
      *                                                                                       CFT050
      ** CFT007 process will take place when CFT050 is switched on                            CFT050
      *                                                                                       CFT050
     C           PRTCD     IFEQ *BLANKS                                                       CFT050
     C                     MOVEL'CFT007'  CFT007                                              CFT050
     C                     MOVE *ON       *IN85                                               CFT050
     C                     ENDIF                                                              CFT050
      *                                                                   CFT012
      ** Access SAR details file to see if CFT012 is installed.           CFT012
      *                                                                   CFT012
     C                     CALL 'AOSARDR0'                                CFT012
     C                     PARM *BLANKS   P@RTCD  7                       CFT012
     C                     PARM '*VERIFY' P@OPTN  7                       CFT012
     C                     PARM 'CFT012'  @SARD   6                       CFT012
     C           SCSARD    PARM *BLANKS   DSFDY                           CFT012
      *                                                                   CFT012
      ** Allow X currency processing                                      CFT012
      *                                                                   CFT012
     C           P@RTCD    IFEQ *BLANKS                                   CFT012
     C                     MOVEL'Y'       CFT012  1                       CFT012
     C                     ELSE                                           CFT012
     C                     MOVEL'N'       CFT012  1                       CFT012
     C                     END                                            CFT012
      *                                                                   CFT007
      * Read SDTRADPD for US dollar currency code                         CFT007
      *                                                                   CFT007
     C                     CALL 'AOTRADR0'                                CFT007
     C                     PARM *BLANKS   RTCD    7                       CFT007
     C                     PARM '*FIRST'  @OPTN                           CFT007
     C           SDTRAD    PARM SDTRAD    DSFDY                           CFT007
      *                                                                   CFT007
      *                                                                   CFT009
      ** Access SAR details file to determine if CFT009 is switched ON.   CFT009
      *                                                                   CFT009
     C                     CALL 'AOSARDR0'                                CFT009
     C                     PARM *BLANKS   @RTRN                           CFT009
     C                     PARM '*VERIFY' @OPTN                           CFT009
     C                     PARM 'CFT009'  @SARD                           CFT009
     C           SCSARD    PARM SCSARD    DSFDY                           CFT009
      *                                                                   CFT009
     C           @RTRN     IFEQ *BLANKS                                   CFT009
     C                     MOVE 'Y'       CFT009  1                       CFT009
     C                     MOVE *ON       *IN39                           CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
      *                                                                   CFT009
     C           @RTRN     IFNE '*NRF   '                                 CFT009
     C                     Z-ADD009       W0ERNB                          CFT009
     C                     MOVEL'CFT009'  W0KEY                           CFT009
     C                     MOVEL'SCSARDPD'W0FILE                          CFT009
     C                     EXSR SRERR                                     CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       CFT009                          CFT009
     C                     MOVE *OFF      *IN39                           CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      ** Access SAR details file to determine if CFT014 is switched ON.   CFT014
      *                                                                   CFT014
     C                     MOVE *BLANK    CFT014  1                       CFT014
     C                     CALL 'AOSARDR0'                                CFT014
     C                     PARM *BLANKS   @RTRN                           CFT014
     C                     PARM '*VERIFY' @OPTN                           CFT014
     C                     PARM 'CFT014'  @SARD                           CFT014
     C           SCSARD    PARM SCSARD    DSFDY                           CFT014
      *                                                                   CFT014
     C           @RTRN     IFEQ *BLANKS                                   CFT014
     C                     MOVE 'Y'       CFT014                          CFT014
     C                     MOVE *ON       *IN77                           CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
     C           @RTRN     IFNE '*NRF   '                                 CFT014
     C                     Z-ADD008       W0ERNB                          CFT014
     C                     MOVEL'CFT014'  W0KEY                           CFT014
     C                     MOVEL'SCSARDPD'W0FILE                          CFT014
     C                     EXSR SRERR                                     CFT014
     C                     ELSE                                           CFT014
     C                     MOVE 'N'       CFT014                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
     C           CFT009    OREQ 'Y'                                       CFT009
      *                                                                   CFT014
      ** If switchable feature CFT014 is installed and CFT003 is not      CFT014
      ** installed, open INPAYXL0.                                        CFT014
      *                                                                   CFT014
     C***********CFT003    IFEQ 'N'                                CFT014 186787
     C           CFT003    IFNE 'CFT003'                                  186787
     C                     OPEN INPAYXL0                                  CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     OPEN INPAYXL2                                  CFT014
     C                     OPEN MEISOCL1                                  CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   056031
     C                     MOVE 'N'       CRE008  1                                           CRE008
     C                     CALL 'AOSARDR0'                                                    CRE008
     C                     PARM *BLANKS   @RTRN                                               CRE008
     C                     PARM '*VERIFY '@OPTN                                               CRE008
     C                     PARM 'CRE008'  @SARD                                               CRE008
     C           SCSARD    PARM SCSARD    DSFDY                                               CRE008
      *                                                                                       CRE008
     C           @RTRN     IFNE *BLANKS                                                       CRE008
     C           @RTRN     ANDNE'*NRF   '                                                     CRE008
     C                     Z-ADD010       W0ERNB                                              CRE008
     C                     MOVEL'CRE008'  W0KEY                                               CRE008
     C                     MOVEL'SCSARDPD'W0FILE                                              CRE008
     C                     EXSR SRERR                                                         CRE008
     C                     ENDIF                                                              CRE008
      *                                                                                       CRE008
     C           @RTRN     IFEQ *BLANKS                                                       CRE008
     C                     MOVE 'Y'       CRE008                                              CRE008
     C                     ENDIF                                                              CRE008
      *                                                                                       CAP205
      ** Determine if SAR CAP205 is installed                                                 CAP205
      *                                                                                       CAP205
     C                     MOVE 'N'       CAP205  1                                           CAP205
     C                     CALL 'AOSARDR0'                                                    CAP205
     C                     PARM *BLANKS   @RTRN                                               CAP205
     C                     PARM '*VERIFY '@OPTN                                               CAP205
     C                     PARM 'CAP205'  @SARD                                               CAP205
     C           SCSARD    PARM SCSARD    DSFDY                                               CAP205
      *                                                                                       CAP205
     C           @RTRN     IFNE *BLANKS                                                       CAP205
     C           @RTRN     ANDNE'*NRF   '                                                     CAP205
     C                     Z-ADD090       W0ERNB                                              CAP205
     C                     MOVEL'CAP205'  W0KEY                                               CAP205
     C                     MOVEL'SCSARDPD'W0FILE                                              CAP205
     C                     EXSR SRERR                                                         CAP205
     C                     ENDIF                                                              CAP205
      *                                                                                       CAP205
     C           @RTRN     IFEQ *BLANKS                                                       CAP205
     C                     MOVE 'Y'       CAP205                                              CAP205
     C                     ENDIF                                                              CAP205
      *                                                                                       CRE008
      **                                                                                      CSC022
      ** Initialize CSC022 and Skip Commit/Rollback flags                                     CSC022
      **                                                                                      CSC022
     C                     MOVE 'N'       CSC022  1                                           CSC022
     C                     MOVE 'N'       WCRSKP  1                                           CSC022
      **                                                                                      CSC022
      ** Access SAR details file to determine if CSC022 switchable feature                    CSC022
      ** is switched on                                                                       CSC022
      **                                                                                      CSC022
     C                     CALL 'AOSARDR0'                                                    CSC022
     C                     PARM *BLANKS   @RTRN                                               CSC022
     C                     PARM '*VERIFY '@OPTN                                               CSC022
     C                     PARM 'CSC022'  @SARD                                               CSC022
     C           SCSARD    PARM SCSARD    DSFDY                                               CSC022
      **                                                                                      CSC022
     C           @RTRN     IFEQ *BLANKS                                                       CSC022
     C                     MOVE 'Y'       CSC022                                              CSC022
      **                                                                                      CSC022
      ** Get Jobs currently running i batch mode using SCCMRJOB dataarea                      CSC022
      **                                                                                      CSC022
     C           *NAMVAR   DEFN SCCMTJOB  SCCMT                                               CSC022
     C                     IN   SCCMT                                                         CSC022
      **                                                                                      CSC022
     C           WCMTNO    IFGT 0                                                             CSC022
      ** Move committed jobs to arrary for checking                                           CSC022
     C                     MOVEAWCJOBS    WCMT                                                CSC022
      ** Verify if job running exists in array                                                CSC022
     C           WSID      LOKUPWCMT                     50                                   CSC022
     C           *IN50     IFEQ *ON                                                           CSC022
     C                     MOVE 'Y'       WCRSKP                                              CSC022
     C                     ENDIF                                                              CSC022
     C                     ENDIF                                                              CSC022
      **                                                                                      CSC022
     C                     ELSE                                                               CSC022
      ** Execute *PSSR if CSC022 is not found or Database error                               CSC022
     C           @RTRN     IFNE '*NRF'                                                        CSC022
     C                     MOVEL'CSC022'  W0KEY                                               CSC022
     C                     MOVEL'SCSARDPD'W0FILE                                              CSC022
     C                     Z-ADD013       W0ERNB                                              CSC022
     C                     EXSR SRERR                                                         CSC022
     C                     ENDIF                                                              CSC022
      **                                                                                      CSC022
     C                     ENDIF                                                              CSC022
      **                                                                                      CSC022
      *  Unwind subroutine stack name                                     056031
      *                                                                   056031
     C           CAEND     TAG                                            056031
     C                     MOVEA*BLANKS   @STK,O                          056031
     C                     SUB  1         O       50                      056031
      *                                                                   056031
     C*
     C*          *****     *****
     C***********CAEND*****ENDSR                                          056031
     C                     ENDSR                                          056031
     C*          *****     *****
     C/EJECT
     C           CCPROC    BEGSR
     C*          ******    *****
     C*
     C*****************************************************************
     C*                 CC-DETAIL-PROCESSING                          *
     C*                                                               *
     C*  FUNCTION : TO PERFORM PROCESSING OF THE INITIAL SCREEN &     *
     C*             WHERE APPROPRIATE TO CONTROL PROCESSING OF THE    *
     C*             DETAIL SCREEN. FINALLY TO CONTROL THE UPDATE OF   *
     C*             THE FILES AS NECCESSARY.                          *
     C*                                                               *
     C*  CALLS :    EAINPT                                            *
     C*             ECINST                                            *
     C*             EEAMND                                            *
     C*             EGDELT                                            *
     C*             EISWFT                                            *
     C**************UATBCN**********************                      *   S01194
     C*             UCINCN                                            *
     C*             UGTIME                                            *
     C*             UIFRMT                                            *
     C*             ZDATE2                                            *
     C*             FLDQ1                                             *   S01194
     C*                                                               *
     C*  CALLED BY: AAMAIN                                            *
     C*                                                               *
     C*****************************************************************
      *                                                                   056031
      *  Set up subroutine stack name                                     056031
      *                                                                   056031
     C                     ADD  1         O                               056031
     C                     MOVEL'CCPROC'  @STK,O                          056031
     C/COPY WNCPYSRC,FT0050C087
     C*
     C** EXECUTE INITIAL SCREEN
     C*
     C                     MOVEAERCD,1    SERCD1             -ERR MSGS
      ***********                                                   S01428S01435
     C***********SERCD1    IFEQ *BLANKS                             S01428S01435
     C***********EI        ANDGT0                                   S01428S01435
     C***********          MOVELEMSG,EI   SERCD1                    S01428S01435
     C***********          END                                      S01428S01435
     C***********          Z-ADD0         EI                        S01428S01435
     C*
     C                     EXSR UGTIME                       -GET TIME
     C*
     C                     SETON                     7173
     C                     SETOF                     7274
     C                     SETOF                     66                   S01414
     C*
     C                     MOVEL'SF'      STID
     C*
      *
      ** If bypass initial screen (from FTC0055 -only do once).
     C                     MOVE '0'       *IN04                           CFT009
     C           PCMD      IFEQ '2'
     C                     MOVE *BLANK    PCMD
     C                     SETON                     09                   S01117
     C                     ELSE
     C                     SETOF                     09                   S01117
      *
      * IF PROGRAM CALLED BYPASS INITIAL SCREEN
      *
     C           @PREF     IFEQ *BLANK
     C           *IN75     OREQ '1'
     C           *IN16     OREQ '1'                                       S01194
     C/COPY WNCPYSRC,FT0050C151
      *                                                                   042167
      * Call CL program to deallocate dataarea                            042167
      *                                                                   042167
     C                     EXSR DALLOC                                    042167
      *                                                                   S01428
      * Also, only display the initial screen if there are no more        S01428
      * selected electronic (SWIFT) messages that require processing.     S01428
      *                                                                   S01428
      * (If a '?' was placed in the swift reference, the user may have    S01428
      *  selected multltiple electronic messages. These are processed     S01428
      *  consecutively, with the selected message's details being         S01428
      *  displayed on the payment details screen - thus bypassing the     S01428
      *  need to display the initial screen.)                             S01428
      *                                                                   S01428
     C           @EMSG     IFNE 'Y'                                       S01428
     C           *IN75     OREQ '1'                        Error          S01428
      *                                                                   S01428
      *                                                                   042167
      * Display message subfile                                           S01435
      *                                                                   S01435
     C                     MOVEL'1'       *IN27                           S01435
     C/COPY WNCPYSRC,FT0050C152
     C                     WRITE#MSGCTL                                   S01435
     C/COPY WNCPYSRC,FT0050C153
      *                                                                   S01435
      * IF ERROR CODES ARRAY IS NOT BLANK, SET ON *IN76 TO DISPLAY        079909
     C           I         IFGT *ZERO                                     079909
     C                     SETON                     76                   079909
     C                     ELSE                                           079909
     C                     SETOF                     76                   079909
     C                     END                                            079909
      *                                                                   079909
     C*                                                                   S01494
     C** Display the available function keys                              S01494
     C*                                                                   S01494
     C/COPY WNCPYSRC,FT0050C046
     C                     MOVELWKEY1     SFKEY                           S01494
     C/COPY WNCPYSRC,FT0050C090
     C                     WRITEFT0050F1
     C*
     C**         *IN70     DOUEQ'0'                                       S01199
     C                     READ FT0050F1                 99
     C/COPY WNCPYSRC,FT0050C091
      *                                                                   S01435
      * Clear message subfile                                             S01435
      *                                                                   S01435
     C                     CALL 'Y2CLMSC'                                 S01435
     C                     PARM ##PGM     FTPGMQ 10                       S01435
     C                     PARM '*SAME'   FTPGRL  5                       S01435
     C/COPY WNCPYSRC,FT0050C154
      *                                                                   S01435
      * Reset message sent flag                                           S01435
      *                                                                   S01435
     C                     MOVEL'N'       FTMSGS  1                       S01435
     C                     MOVEL*BLANKS   FTNOUP                          S01435
      *                                                                   CFT009
      * Reset F12 pressed on insert mode flag                             CFT009
      * Reset FT000980 has been called flag                               CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   F12     1                       CFT009
     C                     MOVE *BLANKS   EXECDF  1                       CFT009
      *                                                                   CAC001
      ** Initialise first pass indicator to 'Y'                           CAC001
      *                                                                   CAC001
     C           *IN71     IFEQ '1'                                       CAC001
     C                     MOVEL'Y'       FIRST   1                       CAC001
     C                     Z-ADD*ZERO     W3FXMP                          CAC001
     C                     Z-ADD*ZERO     W3FXMD                          CAC001
     C                     MOVEL*BLANKS   W3MBSI                          CAC001
     C                     MOVEL*BLANKS   W3MSIG                          CAC001
     C                     Z-ADD*ZERO     W3MAMT                          CAC001
     C                     ENDIF                                          CAC001
      *                                                                   S01435
      ***********                                                   S01414S01435
     C***********          SETON                     66             S01414S01435
     C*
     C** CHECK IF HELP KEY WAS PRESSED & CALL HELP PROGRAM IF IT WAS
     C*
     C**         *IN70     IFEQ '1'                                       S01199
     C**                   MOVEAERCD      HERCD 160                       S01199
     C**                   MOVEL'FT0000'  HBPGM   8                       S01199
     C**                   CALL 'MHELP'                                   S01199
     C**                   PARM           HBPGM                           S01199
     C**                   PARM           HERCD                           S01199
     C**                   END                                            S01199
     C**                   END                                            S01199
      *                                                                   S01428
     C                     ELSE                                           S01428
     C                     MOVE '0'       *INKL                           S01428
     C                     END                                            S01428
     C*                                                                   S01428
     C                     END
     C*
     C* SETOF FLAG FOR PREVIOUS ENTRY BEING SUCCESSFUL INSERT
     C*
     C                     SETOF                     63
     C*
     C** CHECK IF FUNCTION KEY 3 WAS PRESSED
     C*
     C           *INKC     IFEQ '1'
     C                     GOTO CCEND
     C                     END
      *                                                                   S01428
      *  If Electronic Messages Processing is active determine if there   S01428
      *  are more to display.                                             S01428
      *                                                                   S01428
      *  If there are more to process the EMSG flag is set to 'Y'         S01428
      *  and the swift reference is placed in the input field - normal    S01428
      *  processing can continue.                                         S01428
      *                                                                   S01428
      *  If there are no more messages to process the electronic msg      S01428
      *  flag will be returned set to 'N'. Processing similar to Cmd 12   S01428
      *  is followed i.e. the initial screen will be displayed.           S01428
      *                                                                   S01428
     C           @EMSG     IFNE ' '                                       S01428
     C           *IN75     ANDEQ'0'                        No             S01428
     C                     EXSR MSGNXT                                    S01428
     C                     END                                            S01428
     C*
     C** CHECK IF FUNCTION KEY 12 WAS PRESSED
     C*
      *  OR if there are no more electronic messages to be processed      S01428
      *     as a result of checking within MSGNXT                         S01428
      *                                                                   S01428
      *  Display cleared initial screen.                                  S01428
      *                                                                   S01428
     C           *INKL     IFEQ '1'
     C           @EMSG     OREQ 'N'                                       S01428
     C                     Z-ADD0         I                               103715
     C  NKL                MOVEL' '       @EMSG                           S01428
     C                     EXSR MSGEND                                    S01428
      *                                                                   S01428
     C                     SETOF                     404142
     C                     SETOF                     76                   103715
     C                     SETOF                     75
     C                     SETOF                     12                   S01117
     C                     MOVEL*BLANKS   ERCD
     C                     MOVEL*BLANKS   SACTCD
     C                     MOVEL*BLANKS   SPREF
     C                     MOVEL*BLANKS   SSWTN
     C                     MOVEL*BLANKS   SBRCA                           S01117
     C                     Z-ADD0         SSEQNO
     C                     GOTO CCEND
     C                     END
     C                     END
     C*                                                                   S01194
     C**   RESOLVE ?'S FOR SBRCA BEFORE VALIDATION -                      S01194
     C*                                                                   S01194
     C                     EXSR FLDQ1                                     S01194
     C*
     C*                 *******************************
     C*
     C** VALIDATE INPUT FROM SCREEN
      **        or References returned from FTC0055.
     C*
     C                     MOVEL*BLANKS   ERCD
     C*                    MOVEA'0000'    *IN,10
     C                     MOVEA'000'     *IN,12                          S01117
     C                     MOVE '0'       *IN25                           074813
     C                     MOVE '00'      *IN,28                          CEU006
     C                     MOVEA'00000000'*IN,40
     C                     MOVEA'00000000'*IN,48
     C                     MOVEA'0000'    *IN,56
     C                     MOVE '0'       *IN70                           S01414
     C                     MOVE '0'       *IN79                           S01414
      *                                                                   CFT014
     C                     MOVE '0'       *IN67                           CFT014
     C                     MOVE '0'       *IN83                           CFT014
     C                     MOVE '0'       *IN86                           CFT014
     C*
     C                     SETOF                     7576
     C                     MOVE *OFF      *IN24                           CFT009
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0050CCP5                                           S01408
     C*                                                                   S01408
     C*
     C                     Z-ADD*ZERO     I       30
     C                     Z-ADD*ZERO     WARN    30                      CFT009
     C*
     C** ACTION CODE MUST BE ENTERED
     C*
     C           SACTCD    IFEQ *BLANKS
     C                     ADD  1         I
     C*********************MOVE '083'     ERCD,I                          S01117
     C                     MOVE '002'     ERCD,I                          S01117
     C                     SETON                     40
     C                     END
     C*
     C** ACTION CODE MUST BE 'I','A','D' OR 'E' IF ENTERED
     C*
     C           SACTCD    IFNE 'I'
     C           SACTCD    ANDNE'A'
     C           SACTCD    ANDNE'D'
     C           SACTCD    ANDNE'E'
     C           SACTCD    ANDNE*BLANKS
     C                     ADD  1         I
     C*********************MOVE '084'     ERCD,I                          S01117
     C                     MOVE '003'     ERCD,I                          S01117
     C                     SETON                     40
     C                     END
     C/COPY WNCPYSRC,FT0050C191
      *                                                                   S01435
      * If action code 'I' and FT0050 called from enquiry function then   S01435
      * blank out SPREF and move message ref. to DS PHEAD                 S01435
      *                                                                   S01435
     C           SACTCD    IFEQ 'I'                                       S01435
     C           @PREF     ANDNE*BLANKS                                   S01435
     C                     MOVEL*BLANKS   SPREF                           S01435
     C                     MOVEL@PREF     MSGREF                          S01435
     C                     Z-ADDREFMSG    PHMSGR                          S01435
     C                     Z-ADDREFPRT    PHPART                          S01435
     C                     MOVEL*BLANKS   PHMIR                           S01435
     C                     MOVEL*BLANKS   PHMOR                           S01435
     C                     END                                            S01435
     C*
     C** IF ACTION CODE IS 'I',PAYMENT REFERENCE MUST BE BLANK
     C*
     C           SACTCD    IFEQ 'I'
     C           SPREF     ANDNE*BLANKS
     C                     ADD  1         I
     C*********************MOVE '085'     ERCD,I                          S01117
     C                     MOVE '004'     ERCD,I                          S01117
     C                     SETON                     41
     C                     END
     C*
     C** IF ACTION CODE NOT I AND MB AND BRANCH ENTERED AND NOT           S01117
     C** CMD12 FROM FTC0055 THEN ERROR.                                   S01117
     C*                                                                   S01117
     C           SACTCD    IFNE 'I'                                       S01117
     C           *IN10     ANDEQ'1'                                       S01117
     C           *IN09     ANDNE'1'                                       S01117
     C           @PREF     ANDEQ*BLANKS                                   S01117
     C           SBRCA     ANDNE*BLANKS                                   S01117
     C                     ADD  1         I                               S01117
     C                     MOVE '009'     ERCD,I                          S01117
     C                     SETON                     12                   S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C** SKIP NEXT FEW LINES OF PROCESSING IF ACTION CODE IS NOT 'A',
     C** 'D' OR 'E'
     C*
     C           SACTCD    IFNE 'A'
     C           SACTCD    ANDNE'D'
     C           SACTCD    ANDNE'E'
     C*********************GOTO CC100                                     S01117
     C*********************END                                            S01117
     C                     ELSE                                           S01117
     C*
     C** ACTION CODE 'A','D' OR 'E' - PAYMENT REFERENCE IS MANDATORY
     C*
     C           SPREF     IFEQ *BLANKS
     C                     ADD  1         I
     C*********************MOVE '086'     ERCD,I                          S01117
     C                     MOVE '005'     ERCD,I                          S01117
     C                     SETON                     41
     C                     END
     C*
     C** ACCESS INCOMING PAYMENTS FILE IF PAYMENT REFERENCE ENTERED
     C*
     C           *IN41     IFNE '1'
     C                     EXSR UCINCN
     C                     END
     C*
     C** RECORD MUST EXIST & FOR AMENDMENT & DELETION MODES MUST
     C** BE LIVE AND NOT FULLY AUTHORISED
     C*
     C           *IN41     IFNE '1'
     C           *IN88     IFEQ '1'
     C                     ADD  1         I
     C*********************MOVE '087'     ERCD,I                          S01117
     C                     MOVE '006'     ERCD,I                          S01117
     C                     SETON                     41
     C/COPY WNCPYSRC,FT0050C155
     C           @GL442    IFEQ 'Y'                                       096486
     C                     MOVE 'E'       @RETC                           096486
     C                     MOVE '1'       *INLR                           096486
     C                     RETRN                                          096486
     C                     END                                            096486
     C/COPY WNCPYSRC,FT0050C060
     C           CGL007    IFEQ 'Y'                                       CGL007
     C           GL0090    ANDEQ'Y'                                       CGL007
     C                     MOVE 'E'       @RETC                           CGL007
     C                     MOVE *ON       *INLR                           CGL007
     C                     RETRN                                          CGL007
     C                     END                                            CGL007
     C                     ELSE
     C/COPY WNCPYSRC,FT0050C033
     C                     EXCPTEXINPY                     -RELEASE REC
     C/COPY WNCPYSRC,FT0050C034
     C*
     C           SACTCD    IFEQ 'A'
     C           SACTCD    OREQ 'D'
     C*
     C           RECI      IFNE 'D'
     C           AUIN      OREQ 'Y'
     C                     ADD  1         I
     C*********************MOVE '088'     ERCD,I                          S01117
     C                     MOVE '007'     ERCD,I                          S01117
     C                     SETON                     41
     C/COPY WNCPYSRC,FT0050C156
     C                     END
     C*
     C                     END
     C*
     C                     END
     C*
     C                     END
      *                                                                   CFT014
      ** Retrieve Incoming Payments Details Extension record.             CFT014
      *                                                                   CFT014
     C           *IN41     IFEQ *OFF                                      CFT014
     C           CFT014    ANDEQ'Y'                                       CFT014
     C           *IN41     OREQ *OFF                                      CFT009
     C           CFT009    ANDEQ'Y'                                       CFT009
      *                                                                   CFT014
     C           SPREF     CHAININPAYXL2             88                   CFT014
      *                                                                   CFT014
      ** Issue DB error if no record found on file.                       CFT014
      *                                                                   CFT014
     C           *IN88     IFEQ *ON                                       CFT014
     C                     Z-ADD015       W0ERNB                          CFT014
     C                     MOVELSPREF     W0KEY                           CFT014
     C                     MOVEL'INPAYXL2'W0FILE                          CFT014
     C                     EXSR SRERR                                     CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
      ** Issue DB error if no live record found for Amend and Delete.     CFT014
      *                                                                   CFT014
     C           SACTCD    IFEQ 'A'                                       CFT014
     C           INRECI    ANDNE'D'                                       CFT014
     C           SACTCD    OREQ 'D'                                       CFT014
     C           INRECI    ANDNE'D'                                       CFT014
     C                     Z-ADD016       W0ERNB                          CFT014
     C                     MOVELSPREF     W0KEY                           CFT014
     C                     MOVEL'INPAYXL2'W0FILE                          CFT014
     C                     EXSR SRERR                                     CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
     C/COPY WNCPYSRC,FT0050C147
     C*
     C** IF ACTION CODE IS 'A' OR 'D' STORE THE LAST DATE & TIME OF
     C** ALTERATION
     C*
     C           SACTCD    IFEQ 'A'
     C           SACTCD    OREQ 'D'
     C           *IN41     ANDNE'1'
     C                     Z-ADDINLCD     SVLCD   50
     C                     Z-ADDLCHT      SVLCHT  60
     C                     END
     C*
     C** SAVE RECORD ID FOR FUTURE USE
     C*
     C                     MOVELRECI      SVRECI  1
     C*
     C                     END                                            S01117
      *                                                                   042167
      * Call CL program to check for other users only if                  042167
      * - action 'A' or 'D' (not 'I' as ref. then is still blank)         042167
      * - AND if program is not called from an enquiry function (as       042167
      *   allocation processing would already have been done)             042167
      *                                                                   042167
     C                     MOVE *BLANKS   @RTCDE  7                       042167
     C                     MOVE 'FT'      @MODLE  2                       042167
     C                     MOVE SPREF     @TREF  15                       042167
     C                     MOVE *BLANKS   @RTINF 80                       042167
      *                                                                   042167
     C           SACTCD    IFEQ 'A'                                       042167
     C           @PREF     ANDEQ*BLANK                                    042167
      *                                                                   042167
     C           SACTCD    OREQ 'D'                                       042167
     C           @PREF     ANDEQ*BLANK                                    042167
     C                     CALL 'AOC8000'                                 042167
     C                     PARM           @RTCDE                          042167
     C                     PARM           @MODLE                          042167
     C                     PARM           @TREF                           042167
     C                     PARM           @RTINF                          042167
     C                     END                                            042167
      *                                                                   042167
      *  If 'IN USE' then redisplay subfile with error message            042167
      *  for record lock                                                  042167
      *                                                                   042167
     C           @RTCDE    IFEQ '*IN USE'                                 042167
     C                     MOVE '1'       *IN41                           042167
     C                     ADD  1         I                               042167
     C                     MOVEL' 600'    ERCD,I                          042167
     C                     END                                            042167
     C*                                                                   042167
     C** IF NO ERRORS SO FAR                                              S01117
     C*                                                                   042167
     C           I         IFEQ *ZERO                                     S01117
     C           *IN75     ANDEQ'0'                                       079909
      *                                                                   S01414
     C           *NAMVAR   DEFN           ZMUSER                          S01414
     C                     IN   ZMUSER                                    S01414
     C/COPY WNCPYSRC,FT0050C016
     C*                                                                   S01117
     C* IF NON-MULTIBRANCHING, CHECK USER HAS AUTHORITY TO ACTION CODE    S01117
     C*                                                                   S01117
     C           *IN10     IFEQ '0'                                       S01117
     C           @GL442    ANDNE'Y'                                       096486
     C                     CALL 'ZVACTU'                                  S01117
     C                     PARM SACTCD    ZACTN   1                       S01117
     C                     PARM           ERR     10                      S01117
     C*                                                                   S01117
     C* IF USER DOES NOT HAVE AUTHORITY, SET ERROR CODE                   S01117
     C*                                                                   S01117
     C           ERR       IFEQ 1                                         S01117
     C                     ADD  1         I                               S01117
     C                     MOVE '302'     ERCD,I                          S01117
     C                     SETON                     40                   S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C* OTHERWISE, IN MULTIBRANCHING ENVIRONMENT,                         S01117
     C* IF BOOKING BRANCH BLANK, USE DEFAULT BRANCH ON DATA AREA ZMUSER   S01117
     C*                                                                   S01117
     C                     ELSE                                           S01117
     C           SBRCA     IFEQ *BLANKS                                   S01117
     C           SACTCD    ANDEQ'I'                                       S01117
      *                                                                   S01414
      * Move the access of ZMUSER out of multibranching condition.        S01414
      *                                                                   S01414
     C************NAMVAR   DEFN           ZMUSER                    S01117S01414
     C************         IN   ZMUSER                              S01117S01414
     C                     MOVE DBRN      SBRCA                           S01117
     C/COPY WNCPYSRC,FT0050C025
     C                     END                                            S01117
     C*                                                                   S01117
     C**IF NOT INSERT SET SCREEN FIELD TO FILE VALUE                      S01117
     C*                                                                   S01117
     C           SACTCD    IFNE 'I'                                       S01117
     C                     MOVE BRCA      SBRCA                           S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C* CHECK BOOKING BRANCH VALID BY CALLING 'AOBRCHR0'                  S01117
     C*                                                                   S01117
     C                     Z-ADD0         ERR                             096486
     C*                                                                   096486
     C**********           CALL 'AOBRCHR0'                                             S01117 CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM *BLANKS   @RTCD                           S01117
     C                     PARM '*VERIFY' @OPTN                           S01117
     C                     PARM SBRCA     @BRCD                           S01117
     C********** SDBRCH    PARM SDBRCH    DSFDY                                        S01117 CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C*                                                                   S01117
     C           @RTCD     IFNE *BLANKS                                   S01117
     C                     ADD  1         I                               S01117
     C                     MOVE '008'     ERCD,I                          S01117
     C                     SETON                     12                   S01117
     C                     ELSE                                           S01117
     C*                                                                   096486
     C**  If FT0050 is called from GL4442, bypass validation.             096486
     C*                                                                   096486
     C           @GL442    IFNE 'Y'                                       096486
     C/COPY WNCPYSRC,FT0050C157
     C*                                                                   S01117
     C* CHECK USER IS AUTHORISED TO PERFORM ACTION CODE ON BOOKING BRANCH S01117
     C*                                                                   S01117
     C                     CALL 'ZVACTBU'                                 S01117
     C                     PARM SACTCD    ZACTN   1                       S01117
     C                     PARM SBRCA     ZBR     3                       S01117
     C                     PARM           ERR     10                      S01117
     C/COPY WNCPYSRC,FT0050C158
     C*                                                                   096486
     C                     ENDIF                                          096486
     C*                                                                   S01117
     C** USER NOT AUTHORISED TO ANY ACTION CODES FOR THIS ITEM AND BRANCH S01117
     C*                                                                   S01117
     C           ERR       IFEQ 1                                         S01117
     C                     ADD  1         I                               S01117
     C                     MOVE '303'     ERCD,I                          S01117
     C                     SETON                     4012                 S01117
     C                     ELSE                                           S01117
     C*                                                                   S01117
     C** USER NOT AUTHORISED TO ACTION CODE FOR THIS PARTICULAR ITEM      S01117
     C** AND BRANCH                                                       S01117
     C*                                                                   S01117
     C           ERR       IFEQ 2                                         S01117
     C                     ADD  1         I                               S01117
     C                     MOVE '304'     ERCD,I                          S01117
     C                     SETON                     4012                 S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     END                                            S01117
      *                                                                   S01428
      * If action code is 'I', a Swift reference has been entered and     S01428
      * no errors so far, check that the user is also authorised to       S01428
      * action code 'X'.                                                  S01428
      *                                                                   S01428
      * This additional check allows the restriction that only            S01428
      * nominated branches may process electronic messages i.e. only      S01428
      * those branches authorised to action code 'X'.                     S01428
      *                                                                   S01428
     C           SACTCD    IFEQ 'I'                                       S01428
     C           SSWTN     ANDNE*BLANKS                                   S01428
     C           *IN40     ANDEQ'0'                                       S01428
      *                                                                   S01428
     C                     CALL 'ZVACTBU'                                 S01428
     C                     PARM 'X'       ZACTN   1                       S01428
     C                     PARM SBRCA     ZBR     3                       S01428
     C                     PARM           ERR     10                      S01428
      *                                                                   S01428
      * User not authorised to action code for this branch                S01428
      *                                                                   S01428
     C           ERR       IFEQ 2                                         S01428
     C                     ADD  1         I                               S01428
     C                     MOVE '307'     ERCD,I                          S01428
     C                     SETON                     4012                 S01428
     C                     END                                            S01428
     C*                                                                   S01428
     C                     END                                            S01428
     C*                                                                   S01117
     C* END @RTCD IFNE *BLANKS                                            S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C** CHECK AUTHORITY TO ORIGINATING BRANCH IF NOT INSERT+REQUIRED     S01117
     C*                                                                   S01117
     C           SACTCD    IFNE 'I'                                       S01117
     C           BKOBUV    ANDEQ'Y'                                       S01117
     C                     CALL 'ZVOBU'                                   S01117
     C                     PARM ORBR      ZOBRX   3                       S01117
     C                     PARM           ERR     10                      S01117
     C*                                                                   S01117
     C** USER IS NOT AUTHORISED TO ANY ORIGINATING BRANCHES               S01117
     C*                                                                   S01117
     C           ERR       IFEQ 1                                         S01117
     C                     ADD  1         I                               S01117
     C                     MOVE '305'     ERCD,I                          S01117
     C                     SETON                     40                   S01117
     C                     ELSE                                           S01117
     C*                                                                   S01117
     C** USER IS NOT AUTHORISED TO THIS PARTICULAR ORIGINATING BRANCH     S01117
     C*                                                                   S01117
     C           ERR       IFEQ 2                                         S01117
     C                     ADD  1         I                               S01117
     C                     MOVE '306'     ERCD,I                          S01117
     C                     SETON                     4041                 S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C** IF ORIG BRANCH AUTH IN ERROR AND BOOKING NOT CLEAR SBRCA         S01117
     C** TO STOP IRRELEVANT DISPLAY ON FIRST SCREEN                       S01117
     C**                                                                  S01117
     C           ERR       IFNE *ZERO                                     S01117
     C           *IN12     ANDEQ'0'                                       S01117
     C                     MOVE *BLANKS   SBRCA                           S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C* END IF MULTIBRANCHING ENVIRONMENT                                 S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C****************************                                        S01117
     C***********CC100*****TAG****                                        S01117
     C****************************                                        S01117
      *                                                                   S01414
      *  Determine attributes for the Profit Centre field                 S01414
      *                                                                   S01414
     C                     EXSR SRPRFA                                    S01414
     C*
     C** BLANK OUT ALL DETAIL SCREEN INPUT FIELDS IF ACTION CODE 'I'
     C*
     C           SACTCD    IFEQ 'I'
     C                     MOVEL*BLANKS   SORBR                           S01117
     C                     MOVEL*BLANKS   SSTTS
     C                     MOVEL*BLANKS   SPYTP
     C                     MOVEL*BLANKS   SPYST
     C                     MOVEL*BLANKS   SSND1
     C                     MOVEL*BLANKS   SSND2
     C                     MOVEL*BLANKS   SSND3
     C                     MOVEL*BLANKS   SSND4
     C                     MOVEL*BLANKS   SBNC1
     C/COPY WNCPYSRC,FT0050C024
     C                     MOVEL*BLANKS   SBNC2
     C                     MOVEL*BLANKS   SBNC3
     C                     MOVEL*BLANKS   SBNC4
     C                     MOVEL*BLANKS   SBNC5
     C                     MOVEL*BLANKS   SACBK
     C                     MOVEL*BLANKS   SACBB                           S01117
     C***********          MOVEL*BLANKS   SRCCO                           CFT014
     C                     MOVEL*BLANKS   SRCO1                           CFT014
     C                     MOVEL*BLANKS   SRCO2                           CFT014
     C                     MOVEL*BLANKS   SRCO3                           CFT014
     C                     MOVEL*BLANKS   SRCO4                           CFT014
     C                     MOVEL*BLANKS   SRCO5                           CFT014
     C                     MOVEL*BLANKS   STRIB                           CFT014
     C                     MOVEL*BLANKS   SOEXR                           CFT014
     C                     MOVEL*BLANKS   SBOKC                           S01414
     C                     MOVEL*BLANKS   SPRFC                           S01414
     C                     MOVEL*BLANKS   SNDAM                           CEU006
     C                     MOVEL*BLANKS   SNDCY                           CEU006
     C                     MOVEL*BLANKS   SSMAM
     C                     MOVEL*BLANKS   SSMCY
     C                     MOVEL*BLANKS   SSLDT
     C                     MOVEL*BLANKS   SRATE
     C                     MOVEL*BLANKS   SOVRD
     C                     MOVEL*BLANKS   SADDC
     C                     MOVEL*BLANKS   SPYAM
     C                     MOVEL*BLANKS   SPCCY
     C                     MOVEL*BLANKS   SPYDT
     C                     MOVEL*BLANKS   SSWPC
     C                     MOVEL*BLANKS   SFDLR                           175479
     C*                                                                   E32531
     C***********          MOVE *BLANK    FTPF                      E32531S01435
     C***********          MOVE *BLANK    FTPS                      E29837S01435
     C*
     C*  SET UP DEFAULT FOR SWIFT PRIORITY CODE IF INSERT
     C*
     C*********************MOVE '02'      S#WPC   2                       S01117
     C                     MOVE 'N'       S#WPC   1                       S01117
     C*
     C* Clear Swift Receivers Corrrespondant/Account With Bank fields     055293
     C* e.t.c that are used only if the Incoming Payment is generated     055293
     C* using a Swift Transaction                                         055293
     C*                                                                   055293
     C                     MOVEL*BLANKS   INRCRT                          055293
     C                     MOVEL*BLANKS   INRCO1                          055293
     C                     MOVEL*BLANKS   INRCO2                          055293
     C                     MOVEL*BLANKS   INRCO3                          055293
     C                     MOVEL*BLANKS   INRCO4                          055293
     C                     MOVEL*BLANKS   INRCO5                          055293
     C                     MOVEL*BLANKS   INACBT                          055293
     C                     MOVEL*BLANKS   INACB1                          055293
     C                     MOVEL*BLANKS   INACB2                          055293
     C                     MOVEL*BLANKS   INACB3                          055293
     C                     MOVEL*BLANKS   INACB4                          055293
     C                     MOVEL*BLANKS   INACB5                          055293
     C                     MOVEL*BLANKS   INTRNO                          055293
     C                     MOVEL*BLANKS   INMTPY                          055293
     C                     MOVEL*BLANKS   INLVL1                          055293
     C                     MOVEL*BLANKS   INLVL2                          055293
     C                     Z-ADD*ZERO     INMSGR                          S01435
     C                     Z-ADD*ZERO     INKPRT                          S01435
      *                                                                   CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
     C                     MOVEL*BLANKS   INTRN                           CFT014
     C                     MOVEL*BLANKS   INTRI1                          CFT014
     C                     MOVEL*BLANKS   INTRI2                          CFT014
     C                     MOVEL*BLANKS   INTRI3                          CFT014
     C                     MOVEL*BLANKS   INTRI4                          CFT014
     C                     MOVEL*BLANKS   INTRI5                          CFT014
     C                     MOVEL*BLANKS   INRCCN                          CFT014
     C                     MOVEL*BLANKS   INRCUS                          CFT014
     C                     Z-ADD*ZEROS    INRCNW                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT009
      ** FX spread set                                                    CFT009
      *                                                                   CFT009
     C           CFT009    IFEQ 'Y'                                       CFT009
     C                     MOVEL*BLANKS   SPDSET                          CFT009
      ** ... and date offset code                                         CFT009
     C                     MOVEL*BLANKS   SOFCD                           CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT014
     C/COPY WNCPYSRC,FT0050C004
      *                                                                   CAC001
      **  Initialise Margin Information fields upon insert                CAC001
      *                                                                   CAC001
     C                     Z-ADD*ZERO     FXMP                            CAC001
     C                     Z-ADD*ZERO     FXMD                            CAC001
     C                     MOVEL*BLANKS   MBSI                            CAC001
     C                     MOVEL*BLANKS   MSIG                            CAC001
     C                     Z-ADD*ZERO     MAMT                            CAC001
     C*
     C/COPY WNCPYSRC,FT0050C109
     C                     END
     C*
     C** VALIDATE SWIFT TRN; ONLY ALLOWED IN INSERTION MODE
     C*
     C           SSWTN     IFNE *BLANKS                    B001
     C           SACTCD    IFNE 'I'                        B002
     C                     ADD  1         I
     C*********************MOVE '089'     ERCD,I                          S01117
     C                     MOVE '011'     ERCD,I                          S01117
     C                     SETON                     42
     C                     ELSE                            X002
      *
      ** SWIFT sequence number should not be > 10.
     C           SSEQNO    IFGT 10
     C                     ADD  1         I
     C*********************MOVE '387'     ERCD,I                          S01117
     C                     MOVE '015'     ERCD,I                          S01117
     C                     SETON                       59
     C                     END
      *
      ** If no errors, validate/select SWIFT reference no.                S01428
      *                                                                   S01428
     C           I         IFEQ 0                                         S01428
     C           *IN75     ANDEQ'0'                                       079909
     C                     EXSR EISWFT
     C                     END                                            S01428
      *                                                                   S01428
     C                     END
      *
     C                     ELSE
      *                                                                   S01435
      * If action code 'I' and FT0050 called from enquiry function, and   S01435
      * no errors, set up the detail screen fields from swift message     S01435
      *                                                                   S01435
     C           SACTCD    IFEQ 'I'                                       S01435
     C           @PREF     ANDNE*BLANKS                                   S01435
     C           I         IFEQ 0                                         S01435
     C           *IN75     ANDEQ'0'                                       079909
     C                     EXSR EISWFT                                    S01435
     C                     END                                            S01435
      *                                                                   S01435
     C                     ELSE                                           S01435
      *
      ** If no SWIFT reference then should be no sequence number.
     C           SSEQNO    IFNE 0
     C                     ADD  1         I
     C*********************MOVE '386'     ERCD,I                          S01117
     C                     MOVE '014'     ERCD,I                          S01117
     C                     SETON                       5942Highlight both
      **                                                   ref and seq.
     C                     END
      *                                                                   S01435
     C                     END                                            S01435
      *
     C                     END                             E001
     C*
     C** CHECK IF ANY ERRORS WERE DETECTED
     C*
     C           FTNOUP    IFNE *BLANKS                                   S01435
     C                     GOTO CCEND                                     S01435
     C                     END                                            S01435
      *                                                                   S01435
     C           I         IFGT *ZERO
     C           *IN75     OREQ '1'                                       S01428
     C                     SETON                       75
     C                     GOTO CCEND
     C                     END
     C*
     C** CHECK IF ? ENTERED IN ANY SD FIELD                               S01194
     C*                                                                   S01194
     C           *IN16     IFEQ '1'                                       S01194
     C                     GOTO CCEND                                     S01194
     C                     END                                            S01194
     C*
     C** SKIP NEXT FEW LINES OF PROCESSING IF ACTION CODE IS 'I'
     C           SACTCD    IFEQ 'I'                        B001
     C                     GOTO CC200
     C                     END                             E001
     C** FORMAT ALL DETAIL SCREEN FIELDS FROM INCOMING PAYMENTS RECORD
     C** (AMENDMENT/DELETION/ENQUIRY MODES)
     C*
     C***ACCESS*SETTLE*CCY*RECORD*ON*TABLE*FILE                           S01194
     C***********                                                         S01194
     C***********          MOVEL*BLANKS   ZTABKY                          S01194
     C***********          MOVEL'20'      ZTABKY                          S01194
     C***********          MOVELSMCY      WA4     4                       S01194
     C***********          MOVE '1'       WA4                             S01194
     C***********          MOVE WA4       ZTABKY                          S01194
     C***********          EXSR UATBCN                                    S01194
     C***********                                                         S01194
     C************IN89     IFEQ '1'                         -CHECK FOR    S01194
     C***********          MOVEL'TABFP'   WDBFIL             DBERR.       S01194
     C***********          MOVELZTABKY    WDBKEY                          S01194
     C***********          MOVEL'07'      WDBASE                          S01194
     C***********          EXSR UEABRT                                    S01194
     C***********          END                                            S01194
     C*                                                                   S01194
     C** USE ACCESS PROGRAM TO FIND SETTLE CCY                            S01194
     C*                                                                   S01194
     C                     CALL 'AOCURRR0'                                S01194
     C                     PARM '*DBERR ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM SMCY      @CCY    3                       S01194
     C           SDCURR    PARM SDCURR    DSSDY                           S01194
     C                     EXSR MVCURR                                    S01194
     C*
     C** FORMAT SETTLE AMOUNT
     C*
     C                     MOVEL*BLANKS   WFDIN  15
     C                     MOVE SMAM      WFDIN
     C***********13        SUB  CDP       WDIG    20                      S01194
     C***********          Z-ADDCDP       WDEC    10                      S01194
     C           13        SUB  A6NBDP    WDIG    20                      S01194
     C                     Z-ADDA6NBDP    WDEC    10                      S01194
     C/COPY WNCPYSRC,FT0050C035
     C                     Z-ADDI         SAVI    20                      133420
     C                     EXSR UIFRMT
     C                     Z-ADDSAVI      I                               133420
     C                     MOVE WFDOUT    SSMAM
     C*
     C** FORMAT RATE
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE RATE      WFDIN
     C                     Z-ADD5         WDIG
     C                     Z-ADD8         WDEC
     C                     Z-ADDI         SAVI                            133420
     C                     EXSR UIFRMT
     C                     Z-ADDSAVI      I                               133420
     C                     MOVE WFDOUT    SRATE
     C                     MOVE SRATE     RATEO  14
     C*
     C** ACCESS PAY CCY RECORD ON TABLE FILE
     C** (UNLESS SAME AS SETTLE CCY ACCESSED PREVIOUSLY)
     C*
     C           PCCY      IFNE SMCY
     C                     CALL 'AOCURRR0'                                S01194
     C                     PARM '*DBERR ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM PCCY      @CCY    3                       S01194
     C           SDCURR    PARM SDCURR    DSSDY                           S01194
     C                     EXSR MVCURR                                    S01194
     C*                                                                   S01194
     C***********          MOVEL*BLANKS   ZTABKY                          S01194
     C***********          MOVEL'20'      ZTABKY                          S01194
     C***********          MOVELPCCY      WA4                             S01194
     C***********          MOVE '1'       WA4                             S01194
     C***********          MOVE WA4       ZTABKY                          S01194
     C***********          EXSR UATBCN                                    S01194
     C***********                                                         S01194
     C************IN89     IFEQ '1'                         -CHECK FOR    S01194
     C***********          MOVEL'TABFP'   WDBFIL             DBERR.       S01194
     C***********          MOVELZTABKY    WDBKEY                          S01194
     C***********          MOVEL'08'      WDBASE                          S01194
     C***********          EXSR UEABRT                                    S01194
     C***********          END                                            S01194
     C*
     C                     END
     C*
     C** FORMAT PAY AMOUNT
     C*
     C                     MOVEL*BLANKS   WFDIN  15
     C                     MOVE PYAM      WFDIN
     C***********13        SUB  CDP       WDIG    20                      S01194
     C***********          Z-ADDCDP       WDEC    10                      S01194
     C           13        SUB  A6NBDP    WDIG    20                      S01194
     C                     Z-ADDA6NBDP    WDEC    10                      S01194
     C                     Z-ADDI         SAVI    20                      133420
     C                     EXSR UIFRMT
     C                     Z-ADDSAVI      I                               133420
     C                     MOVE WFDOUT    SPYAM
     C/COPY WNCPYSRC,FT0050C036
     C*                                                                   CEU006
     C** ACCESS NOTIFIED DELIVERY CURRENCY ON TABLE FILE                  CEU006
     C*                                                                   CEU006
     C                     MOVE *BLANKS   SNDAM                           149316
     C           CEU006    IFEQ 'Y'                                       145900
     C           CFT014    OREQ 'Y'                                       CFT014
     C           NDCY      IFNE *BLANKS                                   CEU006
     C                     CALL 'AOCURRR0'                                CEU006
     C                     PARM '*DBERR ' @RTCD   7                       CEU006
     C                     PARM '*KEY   ' @OPTN   7                       CEU006
     C                     PARM NDCY      @CCY    3                       CEU006
     C           SDCURR    PARM SDCURR    DSSDY                           CEU006
     C                     EXSR MVCURR                                    CEU006
     C*                                                                   CEU006
     C** NOTIFIED DELIVERY AMOUNT                                         CEU006
     C*                                                                   CEU006
     C                     MOVEL*BLANKS   WFDIN  15                       CEU006
     C                     MOVE NDAM      WFDIN                           CEU006
     C           13        SUB  A6NBDP    WDIG    20                      CEU006
     C                     Z-ADDA6NBDP    WDEC    10                      CEU006
     C                     EXSR UIFRMT                                    CEU006
     C                     MOVE WFDOUT    SNDAM                           CEU006
     C                     ENDIF                                          CEU006
     C                     ENDIF                                          145900
     C*                                                                   CEU006
      ** If switchable feature CFT014 is on, format Original              CFT014
      ** Exchange Rate.                                                   CFT014
      *                                                                   CFT014
     C                     MOVE *BLANKS   SOEXR                           CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
     C           INOEXR    ANDNE*ZERO                                     CFT014
     C                     MOVEL*BLANKS   WFDIN                           CFT014
     C                     MOVE INOEXR    WFDIN                           CFT014
     C                     Z-ADD5         WDIG                            CFT014
     C                     Z-ADD8         WDEC                            CFT014
     C                     Z-ADDI         SAVI                            CFT014
     C                     EXSR UIFRMT                                    CFT014
     C                     MOVE WFDOUT    SOEXR                           CFT014
     C                     Z-ADDSAVI      I                               CFT014
     C                     ENDIF                                          CFT014
     C*
     C** FORMAT SETTLE VALUE DATE
     C*
     C                     Z-ADDSLDT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVELZDATE     SSLDT
     C*
     C** FORMAT PAY VALUE DATE
     C*
     C                     Z-ADDPVDT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVELZDATE     SPYDT
     C*
     C** SETUP STATUS FIELD
     C*
     C                     MOVEL*BLANKS   SSTTS
     C*
     C           SVRECI    IFEQ 'M'
     C                     MOVEL'MATURED' SSTTS
     C                     ELSE
     C           SVRECI    IFEQ 'C'
     C                     MOVEL'DELETED' SSTTS
     C                     ELSE
     C           AUIN      IFEQ 'Y'
     C                     MOVEL'AUTHORIS'SSTTS
     C                     MOVE 'ED'      SSTTS
     C                     END
     C                     END
     C                     END
      *                                                                   CFT014
      ** If switchable feature CFT014 is on, format Third                 CFT014
      ** Reimbursement Institution.                                       CFT014
      *                                                                   CFT014
     C                     MOVE *BLANKS   STRIB                           CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
     C                     MOVELINTRIB    W34RMB                          CFT014
      *                                                                   CFT014
      ** If single-branching and Third Reimbursement Type is "G"          CFT014
      ** (GL a/c no.), move blanks to where Branch would be.              CFT014
      *                                                                   CFT014
     C           *IN10     IFEQ *OFF                                      CFT014
     C           INTRIT    ANDEQ'G'                                       CFT014
     C                     MOVE *BLANKS   W1618T                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     MOVELW34RMB    STRIB                           CFT014
     C                     ENDIF                                          CFT014
     C*
     C** SETUP RECEIVER'S CORRESPONDENT DEPENDING ON TYPE OF ENTRY
     C*
     C***********          MOVEL*BLANKS   SRCCO                           CFT014
     C*
     C***********RCRT      IFEQ 'R'                         -RETAIL A/C   CFT014
     C***********          MOVELRCCO      SRCCO                           CFT014
     C***********          ELSE                                           CFT014
     C***********RCRT      IFEQ 'N'                         -NOSTRO       CFT014
     C***********          MOVELRCCO      WA2                             CFT014
     C***********          MOVELWA2       SRCCO                           CFT014
     C***********          END                                            CFT014
     C***********          END                                            CFT014
      *                                                                   CFT014
     C                     MOVELINRCO1    SRCO1                           CFT014
      *                                                                   CFT014
      ** If single-branching and Receiver's Correspondent type is "G"     CFT014
      ** (GL a/c no.), move blanks to where Branch would be.              CFT014
      *                                                                   CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
     C           *IN10     ANDEQ*OFF                                      CFT014
     C           INRCRT    ANDEQ'G'                                       CFT014
     C                     MOVE *BLANKS   WCHR20 20                       CFT014
     C                     MOVE WCHR20    SRCO1                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     MOVELINRCO2    SRCO2                           CFT014
     C                     MOVELINRCO3    SRCO3                           CFT014
     C                     MOVELINRCO4    SRCO4                           CFT014
     C                     MOVELINRCO5    SRCO5                           CFT014
     C*
     C** SETUP ACCOUNT WITH BANK DEPENDING ON TYPE OF ENTRY
     C*
     C                     MOVEL*BLANKS   SACBK
     C                     MOVEL*BLANKS   SACBB                           S01117
     C*
     C** ONLY SET A/C WITH BANK BRANCH IF MULTI-BRANCHED & PARTIAL A/C    S01117
     C           ACBT      IFEQ 'P'                        -PARTIAL A/C
     C                     MOVELACBK      SACBK
     C   10                MOVELACBB      SACBB                           S01117
     C                     ELSE
     C           ACBT      IFEQ 'R'                        -RETAIL A/C
     C                     MOVELACBK      WA10
     C                     MOVELWA10      SACBK
     C                     ELSE
     C           ACBT      IFEQ 'N'                        -NOSTRO
     C                     MOVELACBK      WA2
     C                     MOVELWA2       SACBK
     C                     END
     C                     END
     C                     END
     C/COPY WNCPYSRC,FT0050C077
     C*
     C** SETUP OTHER SCREEN FIELDS
     C*
     C                     MOVE ORBR      SORBR                           S01117
     C                     MOVELPYTP      SPYTP
     C                     MOVELPYST      SPYST
     C                     MOVELSND1      SSND1
     C*                                                                   S01117
     C** IF SINGLE BRANCHED AND SENDER TYPE IS G (FULL A/C ID)            S01117
     C**  MOVE BLANKS TO WHERE BRANCH CODE WOULD BE (POSITIONS 16-18)     S01117
     C*                                                                   S01117
     C           *IN10     IFEQ '0'                                       S01117
     C           SNTP      ANDEQ'G'                                       S01117
     C                     MOVE *BLANKS   SSNBR                           S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     MOVELSND2      SSND2
     C                     MOVELSND3      SSND3
     C                     MOVELSND4      SSND4
     C                     MOVELBNC1      SBNC1
     C/COPY WNCPYSRC,FT0050C017
     C*                                                                   S01117
     C** IF SINGLE BRANCHED AND BENE CUST TYPE IS P (PARTIAL A/C ID)      S01117
     C**  MOVE BLANKS TO WHERE BRANCH CODE WOULD BE (POSITIONS 13-15)     S01117
     C*                                                                   S01117
     C           *IN10     IFEQ '0'                                       S01117
     C           BNCT      ANDEQ'P'                                       S01117
     C                     MOVE *BLANKS   BBRCA                           S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     MOVELBNC2      SBNC2
     C                     MOVELBNC3      SBNC3
     C                     MOVELBNC4      SBNC4
     C                     MOVELBNC5      SBNC5
      *                                                                   S01435
      *  If enquiry then format for screen                                S01435
      *                                                                   S01435
     C           SACTCD    IFEQ 'E'                                       S01435
      *                                                                   S01435
      *  Set up general parameters                                        S01435
      *                                                                   S01435
     C                     CLEARW8FT                                      S01435
     C                     MOVEL*BLANKS   W8STMT                          S01435
     C                     MOVELSMCY      W8CCY                           S01435
     C                     MOVEL##PGM     W8CPGM                          S01435
     C                     MOVEL'*SCR  '  W8ACT                           S01435
     C                     Z-ADD4         W8NLIN                          S01435
      *                                                                   S01435
      *  Set up parameters                                                S01435
      *                                                                   S01435
     C                     MOVELSNTP      W8TYPE                          S01435
     C                     MOVEL*BLANKS   W8LINS                          S01435
     C                     MOVEL*BLANKS   ADDRSS                          S01435
     C                     MOVELSND1      ADCHK1                          S01435
     C                     MOVELSND2      ADCHK2                          S01435
     C                     MOVELSND3      ADCHK3                          S01435
     C                     MOVELSND4      ADCHK4                          S01435
     C                     MOVELADDRSS    W8LINS                          S01435
      *                                                                   S01435
      * Call expansion program                                            S01435
      *                                                                   S01435
     C                     CALL 'FT0315'               8989               S01435
     C                     PARM           W8RTN   7                       S01435
     C                     PARM           W8FT                            S01435
     C                     PARM           W8LINS256                       S01435
     C                     PARM           W8RPT 256                       S01435
     C                     PARM           W8MSG 256                       S01435
     C                     PARM           W8SCR 256                       S01435
      *                                                                   S01435
      ** Check if database error occurred                                 S01435
      *                                                                   S01435
     C           *IN89     IFEQ '1'                                       S01435
     C           W8RTN     ORNE *BLANKS                                   S01435
     C                     MOVEL'FT0315'  WDBFIL                          S01435
     C                     MOVEL'*CALL'   WDBKEY                          S01435
     C                     MOVEL'52'      WDBASE                          S01435
     C                     EXSR UEABRT                     *ABORT PGM*    S01435
     C                     END                                            S01435
      *                                                                   S01435
     C           35        SUBSTW8SCR:1   SSND1                           S01435
     C           35        SUBSTW8SCR:36  SSND2                           S01435
     C           35        SUBSTW8SCR:71  SSND3                           S01435
     C           35        SUBSTW8SCR:106 SSND4                           S01435
     C/COPY WNCPYSRC,FT0050C192
      *                                                                   CFT014
      ** Set up general parameters for call to FT0315.                    CFT014
      *                                                                   CFT014
     C                     CLEARW8FT                                      CFT014
     C                     MOVEL*BLANKS   W8STMT                          CFT014
     C                     MOVELSMCY      W8CCY                           CFT014
     C                     MOVEL##PGM     W8CPGM                          CFT014
     C                     MOVEL'*SCR    'W8ACT                           CFT014
     C                     Z-ADD5         W8NLIN                          CFT014
      *                                                                   CFT014
      ** Set up other parameters.                                         CFT014
      *                                                                   CFT014
     C                     MOVELINRCRT    W8TYPE                          CFT014
     C                     MOVEL*BLANKS   W8LINS                          CFT014
     C                     MOVEL*BLANKS   ADDRSS                          CFT014
     C                     MOVELINRCO1    ADCHK1                          CFT014
     C                     MOVELINRCO2    ADCHK2                          CFT014
     C                     MOVELINRCO3    ADCHK3                          CFT014
     C                     MOVELINRCO4    ADCHK4                          CFT014
     C                     MOVELINRCO5    ADCHK5                          CFT014
     C                     MOVELADDRSS    W8LINS                          CFT014
      *                                                                   CFT014
      ** Call expansion program.                                          CFT014
      *                                                                   CFT014
     C                     CALL 'FT0315'               8989               CFT014
     C                     PARM           W8RTN                           CFT014
     C                     PARM           W8FT                            CFT014
     C                     PARM           W8LINS                          CFT014
     C                     PARM           W8RPT                           CFT014
     C                     PARM           W8MSG                           CFT014
     C                     PARM           W8SCR                           CFT014
      *                                                                   CFT014
      ** Check if database error occurred.                                CFT014
      *                                                                   CFT014
     C           *IN89     IFEQ *ON                                       CFT014
     C           W8RTN     ORNE *BLANKS                                   CFT014
     C                     MOVEL'FT0315'  WDBFIL                          CFT014
     C                     MOVEL'*CALL'   WDBKEY                          CFT014
     C                     MOVEL'17'      WDBASE                          CFT014
     C                     EXSR UEABRT                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           35        SUBSTW8SCR:1   SRCO1                           CFT014
     C           35        SUBSTW8SCR:36  SRCO2                           CFT014
     C           35        SUBSTW8SCR:71  SRCO3                           CFT014
     C           35        SUBSTW8SCR:106 SRCO4                           CFT014
     C           35        SUBSTW8SCR:141 SRCO5                           CFT014
      *                                                                   S01435
      *  Set up general parameters                                        S01435
      *                                                                   S01435
     C                     CLEARW8FT                                      S01435
     C                     MOVEL*BLANKS   W8STMT                          S01435
     C                     MOVELPCCY      W8CCY                           S01435
     C                     MOVEL##PGM     W8CPGM                          S01435
     C                     MOVEL'*SCR  '  W8ACT                           S01435
     C                     Z-ADD5         W8NLIN                          S01435
      *                                                                   S01435
      *  Set up parameters                                                S01435
      *                                                                   S01435
     C                     MOVELBNCT      W8TYPE                          S01435
     C                     MOVEL*BLANKS   W8LINS                          S01435
     C                     MOVEL*BLANKS   ADDRSS                          S01435
     C                     MOVELBNC1      ADCHK1                          S01435
     C/COPY WNCPYSRC,FT0050C018
     C                     MOVELBNC2      ADCHK2                          S01435
     C                     MOVELBNC3      ADCHK3                          S01435
     C                     MOVELBNC4      ADCHK4                          S01435
     C                     MOVELBNC5      ADCHK5                          S01435
     C                     MOVELADDRSS    W8LINS                          S01435
      *                                                                   S01435
      * Call expansion program                                            S01435
      *                                                                   S01435
     C                     CALL 'FT0315'               8989               S01435
     C                     PARM           W8RTN   7                       S01435
     C                     PARM           W8FT                            S01435
     C                     PARM           W8LINS256                       S01435
     C                     PARM           W8RPT 256                       S01435
     C                     PARM           W8MSG 256                       S01435
     C                     PARM           W8SCR 256                       S01435
      *                                                                   S01435
      ** Check if database error occurred                                 S01435
      *                                                                   S01435
     C           *IN89     IFEQ '1'                                       S01435
     C           W8RTN     ORNE *BLANKS                                   S01435
     C                     MOVEL'FT0315'  WDBFIL                          S01435
     C                     MOVEL'*CALL'   WDBKEY                          S01435
     C                     MOVEL'53'      WDBASE                          S01435
     C                     EXSR UEABRT                     *ABORT PGM*    S01435
     C                     END                                            S01435
      *                                                                   S01435
     C           35        SUBSTW8SCR:1   SBNC1                           S01435
     C           35        SUBSTW8SCR:36  SBNC2                           S01435
     C           35        SUBSTW8SCR:71  SBNC3                           S01435
     C           35        SUBSTW8SCR:106 SBNC4                           S01435
     C           35        SUBSTW8SCR:141 SBNC5                           S01435
     C                     END                                            S01435
     C/COPY WNCPYSRC,FT0050C192
     C                     MOVELBOKC      SBOKC                           S01414
     C                     MOVELPRFC      SPRFC                           S01414
     C                     MOVELSMCY      SSMCY
     C                     MOVELSMCY      OSMCY   3
     C                     MOVELOVRD      SOVRD
     C                     MOVELADDC      SADDC
     C                     MOVELADDC      FADDC   1                       CFT009
     C                     MOVELPCCY      SPCCY
     C                     MOVELPCCY      OPCCY   3
     C                     MOVELNDCY      SNDCY                           CEU006
     C                     MOVELFDLR      SFDLR                           175479
     C                     MOVELNDCY      ONDCY   3                       CEU006
     C/COPY WNCPYSRC,FT0050C005
     C*********************MOVELSWPC      SSWPC                           S01117
     C           SWPC      IFEQ 1                                         S01117
     C                     MOVE 'U'       SSWPC                           S01117
     C                     ELSE                                           S01117
     C           SWPC      IFEQ 2                                         S01117
     C                     MOVE 'N'       SSWPC                           S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C*********************MOVELSRNM      SSWTN                           S01259
     C                     MOVELMIR       SSWTN                           S01259
     C                     MOVELISEQ      SSEQNO                          E29837
      *                                                                   CFT009
      ** FX spread set                                                    CFT009
      *                                                                   CFT009
     C           CFT009    IFEQ 'Y'                                       CFT009
     C                     MOVELFXSPSC    SPDSET                          CFT009
      ** ... and date offset code                                         CFT009
     C                     MOVELINPDOF    SOFCD                           CFT009
     C                     ENDIF                                          CFT009
     C*
     C** SAVE ORIGINAL SETTLE AMOUNT, PAY AMOUNT & RATE
     C*
     C                     Z-ADDSMAM      SVSMAM
     C                     Z-ADDPYAM      SVPYAM
     C                     Z-ADDNDAM      SVNDAM                          CEU006
     C                     Z-ADDRATE      SVRATE 138
     C*
     C*          *****     ***
     C           CC200     TAG
     C*          *****     ***
      *                                                                   CAC001
      ** Set up Margin Information fields to be passed as parameters      CAC001
      ** on first pass                                                    CAC001
      *                                                                   CAC001
     C           FIRST     IFEQ 'Y'                                       CAC001
     C                     Z-ADDFXMP      W3FXMP                          CAC001
     C                     Z-ADDFXMD      W3FXMD                          CAC001
     C                     MOVELMBSI      W3MBSI                          CAC001
     C                     MOVELMSIG      W3MSIG                          CAC001
     C                     Z-ADDMAMT      W3MAMT                          CAC001
     C                     MOVEL'N'       FIRST                           CAC001
     C                     ENDIF                                          CAC001
     C*
     C** SETUP SCREEN ID. & SETOF PROTECTION INDICATOR FOR INSERT,
     C** AMEND MODES
     C*
     C           SACTCD    IFEQ 'I'
     C                     MOVEL'SI'      STID
     C                     SETOF                     73
     C                     ELSE
     C           SACTCD    IFEQ 'A'
     C                     MOVEL'SA'      STID
     C                     SETOF                     73
     C                     ELSE
     C           SACTCD    IFEQ 'D'
     C                     MOVEL'SD'      STID
     C                     SETON                     74
     C                     ELSE
     C                     MOVEL'SE'      STID
     C                     END
     C                     END
     C                     END
     C*
     C** PROCESS DETAIL SCREEN UNTIL FUNCTION KEYS 3,10 OR 12  PRESSED
     C** OR ALL INPUT FIELDS ARE VALID
     C** OR COMMAND 7 PRESSED FOR NEXT PAYMENT IN SUBFILE CALL            E29970
     C*
     C                     SETOF                     20
      *                                                                   S01435
      * Initialise no update indicator, re-display, warning array         S01435
      * and warning message sent                                          S01435
      *                                                                   S01435
     C                     MOVEL*BLANKS   FTNOUP                          S01435
     C                     MOVEL*BLANKS   FTRSND                          S01435
     C                     MOVEL*BLANKS   FTWARN  1                       S01435
     C                     MOVEL*BLANKS   WRN@                            S01435
      *                                                                   CFT014
      ** Initialise warning fields to blanks.                             CFT014
      *                                                                   CFT014
     C                     MOVEL*BLANKS   WRCO1  35                       CFT014
     C                     MOVEL*BLANKS   WRCO2  35                       CFT014
     C                     MOVEL*BLANKS   WRCO3  35                       CFT014
     C                     MOVEL*BLANKS   WRCO4  35                       CFT014
     C                     MOVEL*BLANKS   WRCO5  35                       CFT014
     C                     MOVEL*BLANKS   WTRIB  34                       CFT014
     C                     MOVEL*BLANKS   WWNDAM 14                       CFT014
      *                                                                   CFT014
     C/COPY WNCPYSRC,FT0050C088
     C*
     C           *INKC     DOUEQ'1'
     C           *IN07     OREQ '1'                                       E29970
     C           *INKJ     OREQ '1'
     C           *INKL     OREQ '1'
     C           *IN20     OREQ '1'
     C           *IN16     ANDEQ'0'                                       S01194
     C           FTNOUP    ANDEQ*BLANKS                                   S01435
     C           *IN06     ANDEQ'0'                                       074812
     C                     EXSR EAINPT
     C                     END
     C*
     C** CHECK IF FUNCTION KEY 3 WAS PRESSED TO DETAIL SCREEN
     C*
     C           *INKC     IFEQ '1'
     C                     GOTO CCEND
     C                     END
     C** CHECK IF FUNCTION KEY 7 WAS PRESSED IN DETAIL SCREEN             E29970
     C*                                                                   E29970
     C           *IN07     IFEQ '1'                                       E29970
     C                     GOTO CCEND                                     E29970
     C                     END                                            E29970
     C*
     C** CHECK IF FUNCTION KEY 12 WAS PRESSED TO DETAIL SCREEN
     C*
     C           *INKL     IFEQ '1'
     C                     SETOF                     75
     C                     MOVEL*BLANKS   ERCD
     C                     MOVEL*BLANKS   SACTCD
     C                     MOVEL*BLANKS   SPREF
     C                     MOVEL*BLANKS   SSWTN
     C                     MOVEL*BLANKS   SBRCA                           S01117
     C                     Z-ADD0         SSEQNO
     C/COPY WNCPYSRC,FT0050C027
      *                                                                   S01428
      *  F12 must cancel any reserved messages for the current job.       S01428
      * There may be several if the '?' facility was used or only one     S01428
      * if the swift reference was keyed on the initial screen.           S01428
      *                                                                   S01428
     C                     EXSR MSGEND                                    S01428
      *                                                                   S01428
     C                     GOTO CCEND
     C                     END
     C*
     C** GET TIME FOR UPDATE STAMP
     C*
     C                     EXSR UGTIME
      *                                                                   056031
      *  Clear stored values                                              056031
      *                                                                   056031
     C                     EXSR SRCLR                                     056031
      *                                                                   056031
     C*
     C***IF*ACTION*CODE*IS*'I'AND*SWIFT*MESSAGE,FLAG*MSIME*RECORD*        S01259
     C*********************                                               S01259
     C***********SACTCD****IFEQ 'I'                        B001           S01259
     C***********SSWTN*****ANDNE*BLANKS                                   S01259
     C*********************MOVE SSWTN     SRNM                            S01259
     C***********SRNM******SETLLMSIME                                     S01259
     C*********************SETOF                     77                   S01259
     C***********READ1*****TAG                                            S01259
     C*********************READ MSIME                    77               S01259
     C************IN77*****IFEQ '0'                        B002           S01259
     C***********SRNM******ANDEQSSWTN                                     S01259
     C***********STYPE*****ANDEQ'100'                                     S01259
     C***********ACK*******IFEQ 'ACK'                      B003           S01259
     C***********ACK*******OREQ 'NAK'                                     S01259
     C*********************GOTO READ1                                     S01259
     C*********************END                             E003           S01259
     C*********************END                             E002           S01259
     C*********************END                             E001           S01259
     C*                                                                   S01408
     C** Core hook for externalisation.                                   S01408
     C/COPY WNCPYSRC,FT0050CL1W                                           S01408
     C*
     C** IF ACTION CODE IS 'I',PERFORM INSERTION PROCESSING
     C*
     C           SACTCD    IFEQ 'I'
     C                     EXSR ECINST
     C                     END
     C*
     C** IF ACTION CODE IS 'A',PERFORM AMENDMENT PROCESSING
     C*
     C           SACTCD    IFEQ 'A'
     C                     EXSR EEAMND
     C                     END
     C/COPY WNCPYSRC,FT0050C072
     C*
     C** IF ACTION CODE IS 'D' ,PERFORM DELETION PROCESSING
     C*
     C           SACTCD    IFEQ 'D'
     C/COPY WNCPYSRC,FT0050C051
     C                     EXSR EGDELT
     C                     END
     C*                                                                   S01408
     C** Core hook for externalisation.                                   S01408
     C*****/COPY WNCPYSRC,FT0050CL1W                                      S01408
     C/COPY WNCPYSRC,FT0050C044
     C*
     C** IGNORE REST OF PROCESSING IF IN ENQUIRY MODE OR A VALIDATION
     C** ERROR OCCURRED OR F10 NOT PRESSED IN DELETION MODE
     C*
     C           SACTCD    IFEQ 'E'
     C                     GOTO CCNXT
     C                     END
     C*
     C           *IN20     IFNE '1'
     C                     GOTO CCEND
     C                     END
     C*
     C** COMMIT CHANGES TO FILES
     C*
     C                     MOVELTIME      TIMEX
     C                     MOVEL'FT'      MDID
     C                     MOVEL'FT0050'  PGMN
     C                     MOVELWSID      WSIDX
     C                     MOVELSACTCD    ACTCDX
     C                     MOVELUSRID     USRIDX
      *
      **                                                                                      CSC022
      ** Execute commit if SAR CSC022 is not enrolled or                                      CSC022
      **   job is not currently running in batch mode                                         CSC022
      **                                                                                      CSC022
     C           CSC022    IFEQ 'N'                                                           CSC022
     C           CSC022    OREQ 'Y'                                                           CSC022
     C           WCRSKP    ANDEQ'N'                                                           CSC022
     C           CMTTXT    COMIT
     C                     ENDIF                                                              CSC022
      *                                                                   S01435
      * Clear message subfile                                             S01435
      *                                                                   S01435
     C/COPY WNCPYSRC,FT0050C159
     C                     CALL 'Y2CLMSC'                                 S01435
     C                     PARM ##PGM     FTPGMQ 10                       S01435
     C                     PARM '*SAME'   FTPGRL  5                       S01435
     C/COPY WNCPYSRC,FT0050C160
      *                                                                   S01435
      * Reset message sent flag                                           S01435
      *                                                                   S01435
     C                     MOVEL'N'       FTMSGS  1                       S01435
     C                     MOVEL*BLANKS   FTWARN                          S01435
      *                                                                   S01435
      *                                                                   056031
      *  Clear stored values                                              056031
      *                                                                   056031
     C                     EXSR SRCLR                                     056031
      *                                                                   056031
      *
      ** Set up for next screen.
      *
     C           CCNXT     TAG
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0050CCP1                                           S01408
     C*                                                                   S01408
      *
      ** If program linked with FT0055 & not Deleting.
      *
     C***********FTLJ      IFEQ 'Y'                                       S01194
     C           BTLVJN    IFEQ 'Y'                                       S01194
     C           SACTCD    ANDNE'D'
     C           WLINK     OREQ 'Y'
     C           SACTCD    ANDNE'D'                                       S01435
     C*                                                                   096486
     C**  Set action code to 'G' to tell in FT0345 that the enquiry is    096486
     C**  triggered from Account  Movements menu option (GL4442).         096486
     C*                                                                   096486
     C           @GL442    IFEQ 'Y'                                       096486
     C                     MOVE 'G'       SACTCD                          096486
     C                     ENDIF                                          096486
      *
      ** set up parameters for FT0055 replacing initial screen...
      *
     C           SACTCD    IFEQ 'I'
     C                     MOVELPREF      SPREF
     C                     END
     C/COPY WNCPYSRC,FT0050C136
     C           SACTCD    IFEQ 'A'                                       CFT009
     C           SACTCD    OREQ 'I'                                       CFT009
     C                     MOVE 'Y'       FLAG12                          CFT009
     C                     ENDIF                                          CFT009
      *
     C***********SACTCD    IFEQ 'A'                                       S01435
     C***********ORC1      ANDEQ*BLANKS                                   S01435
     C***********          MOVE 'I'       SACTCD                          S01435
     C***********          END                                            S01435
      *
      ** RESET ACTION TO 'I' IF NO LEVEL 2 DETAILS HAVE BEEN ENTERED
      *
     C           SACTCD    IFEQ 'A'
     C***********ORC1      ANDEQ*BLANKS                                   S01435
     C           INLVL2    ANDNE'Y'                                       S01435
     C                     MOVE 'I'       SACTCD
     C                     END
      *
     C*********************CLOSEMSIME                                     S01259
     C***********          CLOSEMSMSI2L9                            S01259S01435
      *
      *                                                                   S01435
      *  Replace call to FTC0055 to new FT controlling Component          S01435
      *                                                                   S01435
     C************         CALL 'FTC0055'                                 S01435
     C************         PARM           SACTCD                          S01435
     C************         PARM           SPREF                           S01435
      ************                                                        S01435
      ***...*and*receive back from FT0055 the last function key.          S01435
      ************                                                        S01435
     C************         PARM           PCMD    1        Function       S01435
     C************         PARM           WLINK   1                       S01435
     C/COPY WNCPYSRC,FT0050C054
      *                                                                   E21452
     C*********************OPEN MSIME                               E21452S01259
     C***********          OPEN MSMSI2L9                            S01259S01435
      *                                                                   S01435
     C                     MOVELWLINK     WLINK   1                       S01435
     C                     MOVEL*BLANKS   W3FTCT                          S01435
     C           @PREF     IFNE *BLANKS                                   S01435
     C           @GL442    ANDEQ' '                                       096486
     C                     MOVEL'Y'       W3FTCT                          S01435
     C                     END                                            S01435
      *                                                                   S01435
     C/COPY WNCPYSRC,FT0050C110
     C                     CALL 'FTC0310'                                 S01435
     C                     PARM *BLANKS   W3RTN   7                       S01435
     C                     PARM 'FT0355'  W3PGM  10                       S01435
     C***********          PARM SACTCD    W3ACTC  1                S01435 096486
     C           SACTCD    PARM SACTCD    W3ACTC  1                       096486
     C                     PARM SPREF     W3PREF 15                       S01435
     C                     PARM           W3FTCT 64                       S01435
     C                     PARM           W3DATA                          CAC001
     C                     PARM           FLAG12  1                       CFT009
     C/COPY WNCPYSRC,FT0050C062
      *                                                                   S01435
      *  Set PCMD depending on W3RTN                                      S01435
      *                                                                   S01435
     C                     SELEC                                          S01435
     C           W3RTN     WHEQ 'Y2U9999'                                 S01435
     C                     MOVEL'1'       PCMD    1                       S01435
     C           W3RTN     WHEQ 'USR0790'                                 S01435
     C                     MOVEL'2'       PCMD                            S01435
     C           W3RTN     WHEQ 'FTM2005'                                 S01435
     C                     MOVEL'1'       *IN07                           S01435
     C                     MOVEL'7'       PCMD                            S01435
     C                     OTHER                                          S01435
     C                     MOVEL*BLANKS   PCMD                            S01435
     C                     ENDSL                                          S01435
     C/COPY WNCPYSRC,FT0050C063
      *
     C           PCMD      IFEQ '2'
     C           SACTCD    ANDEQ'I'
     C                     MOVE 'A'       SACTCD
     C                     MOVE 'Y'       F12                             CFT009
     C                     END
      *
     C                     END
     C/COPY WNCPYSRC,FT0050C055
      *
      ** If no function key (from FT0055) or not linked...
      *
     C           PCMD      IFEQ *BLANK
     C           PCMD      OREQ '5'
     C***********FTLJ      ORNE 'Y'                                       S01194
     C           BTLVJN    ORNE 'Y'                                       S01194
     C           WLINK     ANDNE'Y'
     C*
     C** BLANK OTHER FIELDS ON INITIAL SCREEN
     C*
     C                     MOVEL*BLANKS   SACTCD
     C                     MOVEL*BLANKS   SSEQNO
     C                     MOVEL*BLANKS   SPREF
     C                     MOVEL*BLANKS   SBRCA                           S01117
     C                     END
     C/COPY WNCPYSRC,FT0050C056
      *
     C                     MOVEL*BLANKS   SSWTN
     C                     Z-ADD0         SSEQNO
      *                                                                   056031
      *  Unwind subroutine stack name                                     056031
      *                                                                   056031
     C           CCEND     TAG                                            056031
     C/COPY WNCPYSRC,FT0050C037
     C                     MOVEA*BLANKS   @STK,O                          056031
     C                     SUB  1         O       50                      056031
     C*
     C*          *****     *****
     C***********CCEND*****ENDSR                                          056031
     C                     ENDSR                                          056031
     C*          *****     *****
     C/EJECT
      *****************************************************************   S01414
      *                                                               *   S01414
      *  SRPRFA   : Determine if Profit Centres are Used              *   S01414
      *                                                               *   S01414
      *  CALLED BY: CCPROC                                            *   S01414
      *                                                               *   S01414
      *  CALLS    : *NONE                                             *   S01414
      *                                                               *   S01414
      *****************************************************************   S01414
     CSR         SRPRFA    BEGSR                                          S01414
      *                                                                   S01414
      *  Check if Profit Centres are used and set screen attributes       S01414
      *                                                                   S01414
     C           BKPRCU    IFEQ 'Y'                                       S01414
      *                                                                   S01414
      *  If Profit Centres are used determine if field is amendable.      S01414
      *                                                                   S01414
      *  If Insert it is always amendable. If Amend it is only            S01414
      *  amendable if the Profit Centres Amendable flag is set to 'Y'.    S01414
      *  If Enquire or Delete it is not amendable.                        S01414
      *                                                                   S01414
     C           SACTCD    IFEQ 'I'                                       S01414
     C           SACTCD    OREQ 'A'                                       S01414
     C           BKPRCA    ANDEQ'Y'                                       S01414
     C                     MOVEA'010'     *IN,68           Amendable      S01414
     C                     ELSE                                           S01414
     C                     MOVEA'000'     *IN,68           Protect        S01414
     C                     END                                            S01414
      *                                                                   S01414
      *  If Profit Centres NOT Used - non display field                   S01414
      *                                                                   S01414
     C                     ELSE                                           S01414
     C                     MOVEA'100'     *IN,68           Non-display    S01414
     C                     END                                            S01414
      *                                                                   S01414
     CSR                   ENDSR                                          S01414
      *                    *****                                          S01414
      *                                                                   S01414
     C/EJECT                                                              S01414
     C           EAINPT    BEGSR
     C*          ******    *****
     C*
     C*****************************************************************
     C*                 EA-INPUT-PROCESSING                           *
     C*                                                               *
     C*  FUNCTION : TO PERFORM PROCESSING OF THE DETAIL SCREEN &      *
     C*             TO CONTROIL PROCESSING OF A SUBROUTINE TO         *
     C*             VALIDATE ALL THE INPUT FIELDS.                    *
     C*                                                               *
     C*  CALLS :    GAVALD                                            *
     C*             UGTIME                                            *
     C*                                                               *
     C*  CALLED BY: CCPROC                                            *
     C*                                                               *
     C*****************************************************************
     C*
     C** EXECUTE DETAIL SCREEN
     C*
     C/COPY WNCPYSRC,FT0050C038
     C                     MOVEAERCD,1    SERCD1             -ERR MSGS
     C                     MOVEAERCD,20   SERCD2
     C*
     C                     EXSR UGTIME                       -GET TIME
     C**                                                                  E29970
     C** IF CALLED FROM SUBFILE PROGRAM ENABLE F7 FOR NEXT PAYMENT        E29970
     C           @PREF     IFNE *BLANKS                                   E29970
     C           @GL442    ANDNE'Y'                                       096486
     C                     SETON                     19                   E29970
     C/COPY WNCPYSRC,FT0050C061
     C           CGL007    IFEQ 'Y'                                       CGL007
     C           GL0090    ANDEQ'Y'                                       CGL007
     C                     MOVE *OFF      *IN19                           CGL007
     C                     END                                            CGL007
     C                     END                                            E29970
     C*
     C                     SETOF                     71
     C                     SETON                     72
     C***********          SETOF                     66             S01414S01435
      *                                                                   S01435
      * If action code 'I' and FT0050 called from enquiry function        S01435
      * (@PREF filled with message ref.), than allow validation of        S01435
      * Booking Branch on detail screen.                                  S01435
      *                                                                   S01435
     C           SACTCD    IFEQ 'I'                                       S01435
     C           @PREF     ANDNE*BLANKS                                   S01435
     C                     SETON                     66                   S01435
     C                     END                                            S01435
     C*
     C** FOR INSERTED RECORDS:-
     C** INSERT DEFAULT VALUES (PAYMENT TYPE, SWIFT PRIORITY CODE,
     C** SETTLE VALUE DATE & ADD/DEDUCT CHARGES INDICATOR)
     C*
     C           SACTCD    IFEQ 'I'
     C                     MOVE 'IN'      SPYTP
     C/COPY WNCPYSRC,FT0050C032
     C           SSWPC     IFEQ *BLANKS
     C                     MOVE S#WPC     SSWPC
     C                     END
     C***********          Z-ADDRUND      ZDAYNO                          S01194
     C           SSLDT     IFEQ *BLANKS                                   E29837
     C           CFT009    ANDEQ'N'                                       CFT009
     C                     Z-ADDBJRDNB    ZDAYNO                          S01194
     C                     EXSR ZDATE2
     C                     MOVELZDATE     SSLDT
     C                     END                                            E29837
     C/COPY WNCPYSRC,FT0050C064
     C           SADDC     IFEQ *BLANKS                          S01178
     C***********INDDFT    IFEQ 'OUR'                               034119S01435
     C           DTCH      IFEQ 'OUR'                                     S01435
     C                     MOVE 'A'       SADDC                           034119
     C                     ELSE                                           034119
     C                     MOVE 'D'       SADDC
     C                     END                                            034119
     C                     END                                   S01178
     C/COPY WNCPYSRC,FT0050C065
     C                     END
      *                                                                   S01435
      * Display message subfile                                           S01435
      *                                                                   S01435
     C                     MOVEL'1'       *IN27                           S01435
     C/COPY WNCPYSRC,FT0050C161
     C                     WRITE#MSGCTL                                   S01435
     C/COPY WNCPYSRC,FT0050C162
      *                                                                   S01435
     C* IF ERROR CODES ARRAY IS NOT BLANK, SET ON *IN76 TO DISPLAY        079909
     C           I         IFGT *ZERO                                     079909
     C                     SETON                     76                   079909
     C                     ELSE                                           079909
     C                     SETOF                     76                   079909
     C                     END                                            079909
      *                                                                   079909
     C*                                                                   S01494
     C** Display the function keys available                              S01494
     C*                                                                   S01494
     C                     SELEC                                          S01494
     C*                                                                   S01494
     C           *IN74     WHEQ '1'                                       S01494
     C                     MOVELWKEY2     SFKEY                           S01494
     C*                                                                   S01494
     C           *IN19     WHEQ '1'                                       S01494
     C           *IN71     ANDEQ'0'                                       S01494
     C           *IN73     IFEQ '0'                                       S01494
     C           CFT007    IFEQ 'CFT007'                                  CFT007
     C                     MOVELWKEY6     SFKEY                           CFT007
     C                     ELSE                                           CFT007
     C                     MOVELWKEY3     SFKEY                           S01494
     C                     ENDIF                                          CFT007
     C                     ELSE                                           S01494
     C                     MOVELWKEY5     SFKEY                           S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C           *IN19     WHEQ '0'                                       CFT007
     C           *IN71     ANDEQ'0'                                       CFT007
     C           *IN73     ANDEQ'0'                                       CFT007
     C           CFT007    ANDEQ'CFT007'                                  CFT007
     C                     MOVELWKEY7     SFKEY                           CFT007
     C*                                                                   CFT007
     C           *IN19     WHEQ '0'                                       S01494
     C           *IN71     ANDEQ'0'                                       S01494
     C           *IN73     ANDEQ'1'                                       S01494
     C                     MOVELWKEY4     SFKEY                           S01494
     C                     ENDSL                                          S01494
     C*                                                                   S01494
     C/COPY WNCPYSRC,FT0050C002
     C                     WRITEFT0050F1
     C/COPY WNCPYSRC,FT0050C206
     C*
     C**         *IN70     DOUEQ'0'                                       S01199
     C                     READ FT0050F1                 99
      *                                                                   S01435
      * Clear message subfile                                             S01435
      *                                                                   S01435
     C                     CALL 'Y2CLMSC'                                 S01435
     C                     PARM ##PGM     FTPGMQ 10                       S01435
     C                     PARM '*SAME'   FTPGRL  5                       S01435
     C/COPY WNCPYSRC,FT0050C163
      *                                                                   S01435
      * Reset message sent flag                                           S01435
      *                                                                   S01435
     C                     MOVEL'N'       FTMSGS  1                       S01435
     C                     MOVEL*BLANKS   FTWARN                          S01435
     C                     MOVEL*BLANKS   FTNOUP                          S01435
     C                     Z-ADD*ZEROS    WARN                            CFT009
      *                                                                   CFT009
      ***********                                                   S01414S01435
     C***********          SETON                     66             S01414S01435
     C*
     C** CHECK IF HELP KEY WAS PRESSED & CALL HELP PROGRAM IF IT WAS
     C**         *IN70     IFEQ '1'                                       S01199
     C**                   MOVEAERCD      HERCD 160                       S01199
     C**                   MOVEL'FT0000'  HBPGM   8                       S01199
     C**                   CALL 'MHELP'                                   S01199
     C**                   PARM           HBPGM                           S01199
     C**                   PARM           HERCD                           S01199
     C**                   END                                            S01199
     C**                   END                                            S01199
     C*                                                                   S01494
     C** Check if F21 is pressed while in the enquiry mode                S01494
     C*                                                                   S01494
     C************IN06     DOWEQ'1'                                S01494 074812
     C************INKC     ANDEQ'0'                                S01494 074812
     C/COPY WNCPYSRC,FT0050C086
     C           *IN06     IFEQ '1'                                       074812
     C                     EXSR #LADDI                                    S01494
     C                     END                                            S01494
     C*
     C** CHECK IF FUNCTION KEYS 3 OR 12 HAVE BEEN PRESSED
     C*
     C           *INKC     IFEQ '1'
     C           *INKL     OREQ '1'
     C                     Z-ADD0         I                               103715
     C                     GOTO EAEND
     C                     END
     C/COPY WNCPYSRC,FT0050C026
      *                                                                   CFT007
      * If F4 or F16 is pressed                                           CFT007
      *                                                                   CFT007
     C           *IN08     IFEQ *ON                                       CFT007
     C           *IN13     OREQ *ON                                       CFT007
      *                                                                   CFT007
      * Redisplay screen after BIC processing                             CFT007
      *                                                                   CFT007
     C                     MOVE 'Y'       FTNOUP                          CFT007
      *                                                                   CFT007
      * Determine whether cursor is on an allowed field                   CFT007
      *                                                                   CFT007
     C                     Z-ADD@#RWCL    WKSCPS  50                      CFT007
      *                                                                   CFT007
      * Note: If these screen fields move then these values will          CFT007
      *       need changing.                                              CFT007
      *                                                                   CFT007
      *       The value is cursor row number * 256 + column number        CFT007
      *                                                                   CFT007
      *                                                                   CFT007
      * Sender line 1                                                     CFT007
      *                                                                   CFT007
     C                     MOVE *OFF      LINE1S  1                       CFT007
     C***********WKSCPS    IFGE 2050                               CFT007 CFT014
     C***********WKSCPS    ANDLE2084                               CFT007 CFT014
     C           WKSCPS    IFGE 1801                                      CFT014
     C           WKSCPS    ANDLE1835                                      CFT014
     C                     MOVE *ON       LINE1S                          CFT007
     C                     ENDIF                                          CFT007
      *                                                                   CFT007
      * Sender line 2                                                     CFT007
      *                                                                   CFT007
     C                     MOVE *OFF      LINE2S  1                       CFT007
     C***********WKSCPS    IFGE 2093                               CFT007 CFT014
     C***********WKSCPS    ANDLE2127                               CFT007 CFT014
     C           WKSCPS    IFGE 1837                                      CFT014
     C           WKSCPS    ANDLE1871                                      CFT014
     C                     MOVE *ON       LINE2S                          CFT007
     C                     ENDIF                                          CFT007
      * Beneficiary line 1                                                CFT007
      *                                                                   CFT007
     C                     MOVE *OFF      LINE1B  1                       CFT007
     C           WKSCPS    IFGE 3373                                      CFT007
     C           WKSCPS    ANDLE3407                                      CFT007
     C                     MOVE *ON       LINE1B                          CFT007
     C                     ENDIF                                          CFT007
      *                                                                   CFT007
      * Beneficiary line 2                                                CFT007
      *                                                                   CFT007
     C                     MOVE *OFF      LINE2B  1                       CFT007
     C***********WKSCPS    IFGE 3586                               CFT007 CFT014
     C***********WKSCPS    ANDLE3620                               CFT007 CFT014
     C           WKSCPS    IFGE 3593                                      CFT014
     C           WKSCPS    ANDLE3627                                      CFT014
     C                     MOVE *ON       LINE2B                          CFT007
     C                     ENDIF                                          CFT007
      *                                                                   CFT014
      ** Receiver's Correspondent Line 1                                  CFT014
      *                                                                   CFT014
     C                     MOVE *OFF      LINE1R  1                       CFT014
     C           WKSCPS    IFGE 2349                                      CFT014
     C           WKSCPS    ANDLE2383                                      CFT014
     C           CFT014    ANDEQ'Y'                                       CFT014
     C                     MOVE *ON       LINE1R                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Receiver's Correspondent Line 2                                  CFT014
      *                                                                   CFT014
     C                     MOVE *OFF      LINE2R  1                       CFT014
     C           WKSCPS    IFGE 2569                                      CFT014
     C           WKSCPS    ANDLE2603                                      CFT014
     C           CFT014    ANDEQ'Y'                                       CFT014
     C                     MOVE *ON       LINE2R                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT007
      * If cursor is not on an allowed field, error                       CFT007
      *                                                                   CFT007
     C           LINE1S    IFNE *ON                                       CFT007
     C           LINE2S    ANDNE*ON                                       CFT007
     C           LINE1B    ANDNE*ON                                       CFT007
     C           LINE2B    ANDNE*ON                                       CFT007
     C           LINE1R    ANDNE*ON                                       CFT014
     C           LINE2R    ANDNE*ON                                       CFT014
      *                                                                   CFT007
      * Error message:                                                    CFT007
     C                     MOVEL'FTM2625' FTMSID                          CFT007
     C                     EXSR FTSNMS                                    CFT007
      *                                                                   CFT007
     C                     ELSE                                           CFT007
      *                                                                   CFT007
      * In-line prompt mode, capture search criteria from screen field    CFT007
      *                                                                   CFT007
     C           *IN08     IFEQ *ON                        111            CFT007
     C                     MOVE 'P'       @IMODE                          CFT007
      *                                                                   CFT007
     C           LINE1S    IFEQ *ON                                       CFT007
     C                     MOVE SSND1     @ICRIT                          CFT007
     C                     ENDIF                                          CFT007
      *                                                                   CFT007
     C           LINE2S    IFEQ *ON                                       CFT007
     C                     MOVE SSND2     @ICRIT                          CFT007
     C                     ENDIF                                          CFT007
      *                                                                   CFT007
     C           LINE1B    IFEQ *ON                                       CFT007
     C                     MOVE SBNC1     @ICRIT                          CFT007
     C                     ENDIF                                          CFT007
      *                                                                   CFT007
     C           LINE2B    IFEQ *ON                                       CFT007
     C                     MOVE SBNC2     @ICRIT                          CFT007
     C                     ENDIF                                          CFT007
      *                                                                   CFT014
     C           LINE1R    IFEQ *ON                                       CFT014
     C                     MOVE SRCO1     @ICRIT                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           LINE2R    IFEQ *ON                                       CFT014
     C                     MOVE SRCO2     @ICRIT                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT007
     C                     ENDIF                                          CFT007
      *                                                                   CFT007
      * In-line search mode, capture search criteria from screen field    CFT007
      *                                                                   CFT007
     C           *IN13     IFEQ *ON                                       CFT007
     C                     MOVE 'F'       @IMODE                          CFT007
      *                                                                   CFT007
     C           LINE1S    IFEQ *ON                                       CFT007
     C                     MOVE SSND1     @ICRIT                          CFT007
     C                     ENDIF                                          CFT007
      *                                                                   CFT007
     C           LINE2S    IFEQ *ON                                       CFT007
     C                     MOVE SSND2     @ICRIT                          CFT007
     C                     ENDIF                                          CFT007
      *                                                                   CFT007
     C           LINE1B    IFEQ *ON                                       CFT007
     C                     MOVE SBNC1     @ICRIT                          CFT007
     C                     ENDIF                                          CFT007
      *                                                                   CFT007
     C           LINE2B    IFEQ *ON                                       CFT007
     C                     MOVE SBNC2     @ICRIT                          CFT007
     C                     ENDIF                                          CFT007
      *                                                                   CFT014
     C           LINE1R    IFEQ *ON                                       CFT014
     C                     MOVE SRCO1     @ICRIT                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           LINE2R    IFEQ *ON                                       CFT014
     C                     MOVE SRCO2     @ICRIT                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT007
     C                     ENDIF                                          CFT007
      *                                                                   CFT007
      * Call BIC Plus enquiry program                                     CFT007
      *                                                                   CFT007
     C                     CALL 'FT0900'                                  CFT007
     C                     PARM           @IMODE  1                       CFT007
     C                     PARM           @ICRIT 35                       CFT007
     C                     PARM *BLANKS   @OADD 175                       CFT007
     C                     PARM *BLANKS   @OCHIP 10                       CFT007
     C                     PARM *BLANKS   @OUTCD  2                       CFT007
     C                     PARM *BLANKS   @RTCD   7                       CFT007
     C                     MOVEL*BLANKS   @ICRIT                          CFT007
      *                                                                   CFT007
      *  F3 pressed - exit program                                        CFT007
      *                                                                   CFT007
     C           @RTCD     IFEQ 'F3'                                      CFT007
     C                     MOVEL'Y'       FTNOUP                          CFT007
     C                     MOVE *ON       *INKC                           CFT007
     C                     END                                            CFT007
      *                                                                   CFT007
     C           @RTCD     IFEQ *BLANKS                                   CFT007
      *                                                                   CFT007
      * If a CHIPS code exists and relevant currency is USD, replace      CFT007
      * clearing code with CHIPS code                                     CFT007
      *                                                                   CFT007
     C           @OCHIP    IFNE *BLANKS                                   CFT007
     C           @OUTCD    ANDNE'AC'                                      CFT007
      *                                                                   CFT007
     C           SSMCY     IFEQ BLUSCY                                    CFT007
     C           LINE1S    ANDEQ*ON                                       CFT007
     C           SSMCY     OREQ BLUSCY                                    CFT014
     C           LINE1R    ANDEQ*ON                                       CFT014
     C           SPCCY     OREQ BLUSCY                                    CFT007
     C           LINE1B    ANDEQ*ON                                       CFT007
      *                                                                   CFT007
      * If clearing code is not present, move details down to             CFT007
      * create space for CHIPS code                                       CFT007
      *                                                                   CFT007
     C           @OUTCD    IFNE 'BC'                                      CFT007
     C           @OUTCD    ANDNE'DC'                                      CFT007
     C                     MOVE @OADD     WKADD1210                       CFT007
     C                     MOVELWKADD1    @OADD                           CFT007
     C                     ENDIF                                          CFT007
      *                                                                   CFT007
     C                     MOVEL*BLANKS   WKCOCH 14                       CFT007
     C                     MOVEL*BLANKS   OADD1                           CFT007
     C                     MOVEL'//CH'    WKCOCH                          CFT007
     C                     MOVE @OCHIP    WKCOCH                          CFT007
     C                     MOVELWKCOCH    OADD1                           CFT007
     C                     ENDIF                                          CFT007
      *                                                                   CFT007
     C                     ENDIF                                          CFT007
      *                                                                   CFT007
      * If command key pressed on 2nd line, remove clearing               CFT007
      * code from details                                                 CFT007
      *                                                                   CFT007
     C           LINE2S    IFEQ *ON                                       CFT007
     C           @OUTCD    ANDEQ'BC'                                      CFT007
     C           LINE2S    OREQ *ON                                       CFT007
     C           @OUTCD    ANDEQ'DC'                                      CFT007
     C           LINE2R    OREQ *ON                                       CFT014
     C           @OUTCD    ANDEQ'BC'                                      CFT014
     C           LINE2R    OREQ *ON                                       CFT014
     C           @OUTCD    ANDEQ'DC'                                      CFT014
     C           LINE2B    OREQ *ON                                       CFT007
     C           @OUTCD    ANDEQ'BC'                                      CFT007
     C           LINE2B    OREQ *ON                                       CFT007
     C           @OUTCD    ANDEQ'DC'                                      CFT007
     C           @OUTCD    OREQ 'AC'                                      CFT007
     C                     MOVE @OADD     WKADD2140                       CFT007
     C                     MOVE *BLANKS   @OADD                           CFT007
     C                     MOVELWKADD2    @OADD                           CFT007
     C                     ENDIF                                          CFT007
      *                                                                   CFT007
      * Move details to screen                                            CFT007
      *                                                                   CFT007
     C           LINE1S    IFEQ *ON                                       CFT007
     C                     MOVELOADD1     SSND1                           CFT007
     C                     MOVELOADD2     SSND2                           CFT007
     C                     MOVELOADD3     SSND3                           CFT007
     C                     MOVELOADD4     SSND4                           CFT007
     C                     ENDIF                                          CFT007
      *                                                                   CFT014
     C           LINE1R    IFEQ *ON                                       CFT014
     C                     MOVELOADD1     SRCO1                           CFT014
     C                     MOVELOADD2     SRCO2                           CFT014
     C                     MOVELOADD3     SRCO3                           CFT014
     C                     MOVELOADD4     SRCO4                           CFT014
     C                     MOVELOADD5     SRCO5                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT007
     C           LINE1B    IFEQ *ON                                       CFT007
     C                     MOVELOADD1     SBNC1                           CFT007
     C                     MOVELOADD2     SBNC2                           CFT007
     C                     MOVELOADD3     SBNC3                           CFT007
     C                     MOVELOADD4     SBNC4                           CFT007
     C                     MOVELOADD5     SBNC5                           CFT007
     C                     ENDIF                                          CFT007
      *                                                                   CFT007
     C           LINE2S    IFEQ *ON                                       CFT007
     C                     MOVELOADD1     SSND2                           CFT007
     C                     MOVELOADD2     SSND3                           CFT007
     C                     MOVELOADD3     SSND4                           CFT007
     C                     ENDIF                                          CFT007
      *                                                                   CFT007
     C           LINE2R    IFEQ *ON                                       CFT014
     C                     MOVELOADD1     SRCO2                           CFT014
     C                     MOVELOADD2     SRCO3                           CFT014
     C                     MOVELOADD3     SRCO4                           CFT014
     C                     MOVELOADD4     SRCO5                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           LINE2B    IFEQ *ON                                       CFT007
     C                     MOVELOADD1     SBNC2                           CFT007
     C                     MOVELOADD2     SBNC3                           CFT007
     C                     MOVELOADD3     SBNC4                           CFT007
     C                     MOVELOADD4     SBNC5                           CFT007
     C                     ENDIF                                          CFT007
      *                                                                   CFT007
     C                     ENDIF                                          CFT007
      *                                                                   CFT007
     C                     ENDIF                                          CFT007
      *                                                                   CFT007
     C                     ENDIF                                          CFT007
      *                                                                   CFT007
      *                                                                   CFT007
     C*                                                                   S01194
     C**   RESOLVE ?'S BEFORE VALIDATION -                                S01194
     C*                                                                   S01194
     C                     EXSR FLDQ2                                     S01194
     C/COPY WNCPYSRC,FT0050C137
     C*
     C** SETON INDICATOR 20 IF IN DELETION MODE & F10 PRESSED.
     C** SKIP FURTHER PROCESSING IF IN DELETION MODE
     C*
     C           SACTCD    IFEQ 'D'
     C           *INKJ     IFEQ '1'
     C/COPY WNCPYSRC,FT0050C165
     C                     SETON                       20
     C/COPY WNCPYSRC,FT0050C052
     C                     END
     C                     GOTO EAEND
     C                     END
     C*
     C** CALL SUBROUTINE TO VALIDATE INPUT (NOT ENQUIRY MODE)
     C*
     C           SACTCD    IFNE 'E'
     C                     EXSR GAVALD
      *                                                                   CFT014
      ** Save values of Receiver's Correspondents.                        CFT014
      *                                                                   CFT014
     C                     MOVELSRCO1     WRCO1                           CFT014
     C                     MOVELSRCO2     WRCO2                           CFT014
     C                     MOVELSRCO3     WRCO3                           CFT014
     C                     MOVELSRCO4     WRCO4                           CFT014
     C                     MOVELSRCO5     WRCO5                           CFT014
      *                                                                   CFT014
      ** Save value of Third Reimbursement Institution.                   CFT014
      *                                                                   CFT014
     C                     MOVELSTRIB     WTRIB                           CFT014
      *                                                                   CFT014
      ** Save value of Instructed Amount.                                 CFT014
      *                                                                   CFT014
     C                     MOVELSNDAM     WWNDAM                          CFT014
      *                                                                   CFT014
     C/COPY WNCPYSRC,FT0050C039
     C* CHECK IF WARNING ERROR                                            E32543
     C           *IN23     IFEQ '1'                                       E32543
     C           WARN      ANDNE0                                         CFT009
     C* IF ENTER PRESSED AND FIELDS UNCHANGED ASSUME ACCEPTANCE           E32543
     C           *IN22     IFEQ '1'                                       E32543
     C                     MOVE *OFF      *IN22                           CFT009
     C           *IN51     IFEQ '1'
     C           SSLDT     ANDEQSLDTO                                     E32543
     C/COPY WNCPYSRC,FT0050C198
     C                     SETOF                     51                   E32543
     C/COPY WNCPYSRC,FT0050C200
     C                     SUB  1         I                               E32543
     C                     END                                            E32543
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0050CCP4                                           S01408
     C*                                                                   S01408
     C           *IN57     IFEQ '1'
     C           SPYDT     ANDEQPVDTO                                     E32543
     C/COPY WNCPYSRC,FT0050C199
     C                     SETOF                     57                   E32543
     C/COPY WNCPYSRC,FT0050C201
     C                     SUB  1         I                               E32543
     C                     END                                            E32543
     C*                                                                   CFT009
     C           *IN24     IFEQ *ON                                       CFT009
     C           SPDSET    ANDEQSPDSTO                                    CFT009
     C                     MOVE *OFF      *IN24                           CFT009
     C                     SUB  1         I                               CFT009
     C                     ENDIF                                          CFT009
     C*                                                                   CFT009
     C           *IN04     IFEQ *ON                                       CFT009
     C           SOFCD     ANDEQSOFCDO                                    CFT009
     C                     MOVE *OFF      *IN04                           CFT009
     C                     SUB  1         I                               CFT009
     C                     ENDIF                                          CFT009
     C*                                                                   CFT009
     C           *IN52     IFEQ *ON                                       CFT009
     C           SRATE     ANDEQSRATEO                                    CFT009
     C                     MOVE *OFF      *IN52                           CFT009
     C                     SUB  1         I                               CFT009
     C                     ENDIF                                          CFT009
      *                                                                                       CRE008
     C           *LIKE     DEFN SSND1     PSSND1                                              CRE008
     C           *LIKE     DEFN WSMAM     PWSMAM                                              CRE008
     C           *IN45     IFEQ '1'                                                           CRE008
     C           *IN49     ANDEQ'1'                                                           CRE008
     C           SSND1     ANDEQPSSND1                                                        CRE008
     C           WSMAM     ANDEQPWSMAM                                                        CRE008
     C                     SUB  1         I                                                   CRE008
     C                     MOVE '0'       *IN45                                               CRE008
     C                     MOVE '0'       *IN49                                               CRE008
     C                     ENDIF                                                              CRE008
      *                                                                                       CRE008
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0050CCP6                                           S01408
     C*                                                                   S01408
     C           SSLDT     IFEQ SLDTO                                     E32543
     C           SPYDT     ANDEQPVDTO                                     E32543
     C           SPDSET    ANDEQSPDSTO                                    CFT009
     C           SRATE     ANDEQSRATEO                                    CFT009
     C           SOFCD     ANDEQDFTPDO                                    CFT009
     C           SSND1     ANDEQPSSND1                                                        CRE008
     C           WSMAM     ANDEQPWSMAM                                                        CRE008
     C                     SETOF                     2223                 E32543
     C/COPY WNCPYSRC,FT0050C202
     C                     ELSE                                           E32543
     C                     MOVE SSLDT     SLDTO                           E32543
     C                     MOVE SPYDT     PVDTO                           E32543
     C                     MOVE SPDSET    SPDSTO                          CFT009
     C                     MOVE SOFCD     SOFCDO                          CFT009
     C                     MOVE SRATE     SRATEO                          CFT009
     C                     MOVE SSND1     PSSND1                                              CRE008
     C                     MOVE WSMAM     PWSMAM                                              CRE008
     C                     END                                            E32543
     C* ASSUME FIRST DISPLAY OF WARNING ERROR                             E32543
     C                     ELSE                                           E32543
     C                     SETON                     22                   E32543
     C                     MOVE SSLDT     SLDTO   6                       E32543
     C                     MOVE SPYDT     PVDTO   6                       E32543
     C                     MOVE SPDSET    SPDSTO  5                       CFT009
     C                     MOVE SOFCD     SOFCDO  5                       CFT009
     C                     MOVE SRATE     SRATEO 14                       CFT009
     C                     MOVE SSND1     PSSND1                                              CRE008
     C                     MOVE WSMAM     PWSMAM                                              CRE008
     C                     END                                            E32543
     C                     END                                            E32543
     C                     END
     C           I         IFEQ 0                                         E32543
     C                     MOVEA*BLANK    ERCD                            E32543
     C************         SETOF                     75             E32543079909
     C                     SETOF                     75                   133420
     C                     SETOF                     76                   079909
     C                     END                                            E32543
     C*
     C** CHECK FOR ERROR
     C*
     C           *IN75     IFEQ '0'
     C           *IN84     ANDEQ'0'                                       133420
     C                     SETON                       20
     C                     END
      *                                                                   S01435
      *  If warning sent with no errors allow update                      S01435
      *                                                                   S01435
     C           *IN75     IFEQ '0'                                       S01435
     C           FTWARN    IFEQ 'Y'                                       S01435
     C           FTRSND    ANDEQ*BLANKS                                   S01435
     C           FTNOUP    ANDEQ*BLANKS                                   S01435
     C                     MOVEL'Y'       FTRSND                          S01435
     C                     MOVEL'Y'       FTNOUP  1                       S01435
     C                     END                                            S01435
     C                     ELSE                                           S01435
     C                     MOVEL*BLANKS   FTRSND  1                       S01435
     C                     END                                            S01435
      *                                                                   CAC001
      **  If Analytical Accounting is installed, in amend mode,           CAC001
      **  ENTER was pressed, FQRY not used, no errors, update is          CAC001
      **  allowed, either currencies, rate or amounts were changed,       CAC001
      **  and there is a margin info, call window program                 CAC001
      *                                                                   CAC001
     C           BGWDPR    IFEQ 'Y'                                       CAC001
     C           BGN0ST    ANDEQ'Y'                                       CAC001
     C           SACTCD    ANDEQ'A'                                       CAC001
     C           *IN16     ANDEQ'0'                                       CAC001
     C           *IN75     ANDEQ'0'                                       CAC001
     C           FTNOUP    ANDEQ*BLANKS                                   CAC001
      *                                                                   CAC001
     C           SSMCY     IFNE OSMCY                                     CAC001
     C           SNDCY     ORNE ONDCY                                     CEU006
     C           SPCCY     ORNE OPCCY                                     CAC001
     C           SVSMAM    ORNE WSMAM                                     CAC001
     C           SVNDAM    ORNE WNDAM                                     CEU006
     C           SVPYAM    ORNE WPYAM                                     CAC001
     C           SVRATE    ORNE WRATE                                     CAC001
      *                                                                   CAC001
      ** If margin information details exist, set up call to window       CAC001
      *                                                                   CAC001
     C           W3MBSI    IFNE *BLANKS                                   CAC001
     C           W3MSIG    ORNE *BLANKS                                   CAC001
      *                                                                   CAC001
     C                     MOVE 'KT'      KEY                             CAC001
     C                     MOVE SACTCD    ACTN                            CAC001
     C                     MOVE SACTCD    WWACTN                          CAC001
     C                     Z-ADDWRATE     WWRATE                          CAC001
     C                     MOVE 'S'       WWPSIN                          CAC001
     C                     MOVE SPCCY     WWPCCY                          CAC001
     C                     MOVE SSMCY     WWSMCY                          CAC001
     C                     Z-ADDWPYAM     WWPYAM                          CAC001
     C                     Z-ADDWSMAM     WWSMAM                          CAC001
     C                     Z-ADDWMDIN     WWMDIN                          CAC001
     C                     Z-ADDW3FXMP    WWFXMP                          CAC001
     C                     Z-ADDW3FXMD    WWFXMD                          CAC001
     C                     MOVE W3MBSI    WWMBSI                          CAC001
     C                     MOVE W3MSIG    WWMSIG                          CAC001
     C                     Z-ADDW3MAMT    WWMAMT                          CAC001
     C                     MOVE 'Y'       WWFRCI                          CAC001
      *                                                                   CAC001
      ** If record id is not 'D', change value of action parameter        CAC001
      ** sent as 'E' as no changes are allowed for matured/authorised     CAC001
      ** deals for amend mode                                             CAC001
      *                                                                   CAC001
     C           SACTCD    IFEQ 'A'                                       CAC001
     C           RECI      ANDNE'D'                                       CAC001
     C                     MOVE 'E'       ACTN                            CAC001
     C                     ENDIF                                          CAC001
      *                                                                   CAC001
      **  Call window manager WN0010                                      CAC001
      *                                                                   CAC001
     C                     CALL 'WN0010'                                  CAC001
     C                     PARM 'FT0050'  #PGM   10                       CAC001
     C                     PARM           KEY     2                       CAC001
     C                     PARM           ACTN    1                       CAC001
     C                     PARM           DATA                            CAC001
     C                     PARM *BLANK    #RTRN   7                       CAC001
     C                     PARM           SPARE 256                       CAC001
      *                                                                   CAC001
      **  Check  return code. Return code is *User QUIT requested         CAC001
      *                                                                   CAC001
     C           #RTRN     IFEQ 'Y2U9999'                                 CAC001
     C                     MOVE '1'       *INKC                           CAC001
     C                     MOVE 'Y'       FTNOUP                          CAC001
     C                     ENDIF                                          CAC001
      *                                                                   CAC001
     C           #RTRN     IFNE *BLANK                                    CAC001
     C                     CALL 'SNDERMSG'                                CAC001
     C                     PARM 'FT0050'  ZAPGM  10        Program queue  CAC001
     C                     PARM           ZAPGRL  5        Rel queue      CAC001
     C                     PARM #RTRN     ZAMSID  7        Msg Id.        CAC001
     C                     PARM 'WNMSGF'  ZAMSGF 10        Msg file.      CAC001
     C                     PARM           ZAMSDA132        Message data.  CAC001
     C                     PARM           ZAMSTP  7        Message type.  CAC001
      *                                                                   CAC001
      **  Clear all fields                                                CAC001
      *                                                                   CAC001
     C                     MOVEL*BLANK    ZAPGM            Program queue  CAC001
     C                     MOVEL*BLANK    ZAPGRL           Rel queue      CAC001
     C                     MOVEL*BLANK    ZAMSID           Message Id.    CAC001
     C                     MOVEL*BLANK    ZAMSGF           Message file.  CAC001
     C                     MOVEL*BLANK    ZAMSDA           Message data.  CAC001
     C                     MOVEL*BLANK    ZAMSTP           Message type.  CAC001
     C                     MOVE 'Y'       FTNOUP                          CAC001
      *                                                                   CAC001
      **  If ENTER pressed from window, update margin info work fields    CAC001
      *                                                                   CAC001
     C                     ELSE                                           CAC001
     C                     Z-ADDWWFXMP    W3FXMP                          CAC001
     C                     Z-ADDWWFXMD    W3FXMD                          CAC001
     C                     MOVELWWMBSI    W3MBSI                          CAC001
     C                     MOVELWWMSIG    W3MSIG                          CAC001
     C                     Z-ADDWWMAMT    W3MAMT                          CAC001
     C                     MOVEL*BLANKS   FTNOUP                          CAC001
     C                     ENDIF                                          CAC001
     C                     ENDIF                                          CAC001
     C                     ENDIF                                          CAC001
     C                     ENDIF                                          CAC001
      *                                                                   S01435
     C/COPY WNCPYSRC,FT0050C028
     C*
     C*          *****     *****
     C           EAEND     ENDSR
     C*          *****     *****
     C/EJECT
     C           ECINST    BEGSR
     C*          ******    *****
     C*
     C*****************************************************************
     C*                 EC-INSERT-PROCESSING                          *
     C*                                                               *
     C*  FUNCTION : TO PERFORM PROCESSING REQUIRED TO UPDATE FILES    *
     C*             ETC. WHEN DETAILS OF INCOMING PAYMENTS ARE        *
     C*             INSERTED.                                         *
     C*                                                               *
     C*  CALLS :    GCINPY                                            *
     C*             GEINTR                                            *
     C*             GGDLUP                                            *
     C*             GIRTUP                                            *
     C**************UATBCN************************                    *   S01194
     C*             UEABRT                                            *
     C*                                                               *
     C*  CALLED BY: CCPROC                                            *
     C*                                                               *
     C*****************************************************************
      *                                                                   056031
      *  Set up subroutine stack name                                     056031
      *                                                                   056031
     C                     ADD  1         O                               056031
     C                     MOVEL'ECINST'  @STK,O                          056031
     C*
     C** UPDATE INCOMING PAYMENTS DATA AREA
     C*
     C/COPY WNCPYSRC,FT0050C047
     C           *NAMVAR   DEFN INPAYDA   DINPAY
     C           *LOCK     IN   DINPAY
     C/COPY WNCPYSRC,FT0050C148
     C                     Z-ADDDINSQ     WINSQ   40
     C                     ADD  1         DINSQ
     C                     OUT  DINPAY
     C/COPY WNCPYSRC,FT0050C048
     C*
     C** SETUP FIELDS FOR INCOMING PAYMENTS RECORD
     C*
     C                     EXSR GCINPY
     C*
     C** SET UP VALUE OF INPUT USER FOR LATER AUTHORISATION CHECK
     C*
     C                     MOVE USRID     INUSR1 10
     C                     Z-ADD0         DUMA1                           E37529
     C                     Z-ADD0         DUMA2                           E37529
     C                     Z-ADD0         DUMA3                           E37529
     C                     Z-ADD0         DUMA4                           E37529
     C                     Z-ADD0         DUMA5                           E37529
     C                     Z-ADD0         DUMA6                           E37529
     C*                                                                   S01494
     C           S01494    IFEQ 'Y'                                       S01494
     C                     Z-ADD0         INDUM7                          S01494
     C                     END                                            S01494
     C           S01499    IFEQ 'Y'                                       S01499
     C                     Z-ADD0         INDUM8                          S01499
     C                     END                                            S01499
     C*                                                                   S01408
      *                                                                   CFT009
      ** Default VAT flags, total VAT, VAT rate, file DAF format for      CFT009
      ** charges, entry charges                                           CFT009
      *                                                                   CFT009
     C           CFT009    IFEQ 'Y'                                       CFT009
     C                     EXSR CHGVAT                                    CFT009
     C                     ENDIF                                          CFT009
     C** Core hook for externalisation.                                   S01408
     C/COPY WNCPYSRC,FT0050CCBU                                           S01408
     C*
     C** WRITE INCOMING PAYMENTS RECORD
     C*
      *                                                                   S01435
      *  /COPY for additional processing before writing INPAYDD           S01435
      *                                                                   S01435
     C/COPY WNCPYSRC,FT0050INST                                           S01435
      *                                                                   CFT003
      *  If Batch Authorsation update/add record                          CFT003
      *                                                                   CFT003
     C           CFT003    IFEQ 'CFT003'                                  CFT003
     C           CFT014    OREQ 'Y'                                       CFT014
     C           CFT009    OREQ 'Y'                                       CFT009
     C*                                                                   CFT003
     C** Update extension record to include the Auto-generated            CFT003
     C** indicator                                                        CFT003
     C*                                                                   CFT003
     C           PREF      CHAININPAYXL0             90                   CFT003
     C/COPY WNCPYSRC,FT0050C193
     C*                                                                   CFT003
     C* If no existing extension record, insert new one                   CFT003
     C*                                                                   CFT003
     C           *IN90     IFEQ '1'                                       CFT003
     C                     MOVEL'D'       INRECI                          CFT003
     C                     MOVELPREF      INPREF                          CFT003
     C                     MOVEL'N'       INAUTO                          CFT003
      *                                                                   CFT009
      ** FX Spread set                                                    CFT009
      *                                                                   CFT009
     C           CFT009    IFEQ 'Y'                                       CFT009
     C                     EXSR MOVCHG                                    CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
      *                                                                   CFT014
      ** Initialise Level 2 fields.                                       CFT014
      *                                                                   CFT014
     C                     MOVEL*BLANKS   INBOCD                          CFT014
     C                     MOVEL*BLANKS   INTTCD                          CFT014
     C                     MOVEL*BLANKS   INICD1                          CFT014
     C                     MOVEL*BLANKS   INICD2                          CFT014
     C                     MOVEL*BLANKS   INICD3                          CFT014
     C                     MOVEL*BLANKS   INICD4                          CFT014
     C                     MOVEL*BLANKS   INICD5                          CFT014
     C                     MOVEL*BLANKS   INRRP1                          CFT014
     C                     MOVEL*BLANKS   INRRP2                          CFT014
     C                     MOVEL*BLANKS   INRRP3                          CFT014
     C                     MOVEL*BLANKS   INSCY1                          CFT014
     C                     MOVEL*BLANKS   INSCY2                          CFT014
     C                     MOVEL*BLANKS   INSCY3                          CFT014
     C                     MOVEL*BLANKS   INSCY4                          CFT014
     C                     MOVEL*BLANKS   INSCY5                          CFT014
     C                     Z-ADD*ZERO     INSCH1                          CFT014
     C                     Z-ADD*ZERO     INSCH2                          CFT014
     C                     Z-ADD*ZERO     INSCH3                          CFT014
     C                     Z-ADD*ZERO     INSCH4                          CFT014
     C                     Z-ADD*ZERO     INSCH5                          CFT014
     C                     Z-ADD*ZERO     INRCRM                          CFT014
     C                     MOVEASTAMP,1   INTMST                                              CPK014
      *                                                                   CFT014
      ** Fill Level 2 fields.                                             CFT014
      *                                                                   CFT014
     C                     EXSR FLHIZO                                    CFT014
      *  If any of the fields have been changed during display,           CFT014
      *  use these.                                                       CFT014
     C                     MOVELWTRIT     INTRIT                          CFT014
      *                                                                   CFT014
     C                     MOVELSTRIB     W34RMB                          CFT014
     C           *IN10     IFEQ *OFF                                      CFT014
     C           WTRIT     ANDEQ'G'                                       CFT014
     C                     MOVE BJSBRC    W1618T                          CFT014
     C                     ENDIF                                          CFT014
     C                     MOVELW34RMB    INTRIB                          CFT014
      *                                                                   CFT014
     C                     Z-ADDWOEXR     INOEXR                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
     C*                                                                   CFT003
     C***********          WRITEINPAYXDF                           CFT003 CFT014
     C                     WRITEINPAYXDF               90                 CFT014
      *                                                                   CFT014
     C           *IN90     IFEQ *ON                                       CFT014
     C                     Z-ADD025       W0ERNB                          CFT014
     C                     MOVELPREF      W0KEY                           CFT014
     C                     MOVEL'INPAYXL0'W0FILE                          CFT014
     C                     EXSR SRERR                                     CFT014
     C                     ENDIF                                          CFT014
     C*                                                                   CFT003
     C* If existing extension record, update                              CFT003
     C*                                                                   CFT003
     C                     ELSE                                           CFT003
     C/COPY WNCPYSRC,FT0050C194
      *                                                                   CFT014
      ** Issue DB error if CFT014 is installed and record                 CFT014
      ** already exists.                                                  CFT014
      *                                                                   CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
     C           CFT009    OREQ 'Y'                                       CFT009
     C                     Z-ADD018       W0ERNB                          CFT014
     C                     MOVELPREF      W0KEY                           CFT014
     C                     MOVEL'INPAYXL0'W0FILE                          CFT014
     C                     EXSR SRERR                                     CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
     C*                                                                   CFT003
     C                     MOVEL'N'       INAUTO                          CFT003
     C                     UPDATINPAYXDF                                  CFT003
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
     C*                                                                   CFT003
     C                     ENDIF                                          CFT003
      *                                                                   CFT003
     C                     ENDIF                                          CFT003
      *                                                                   S01435
     C                     MOVEASTAMP,1   INTMST           Default Timestamp                  CPK015
     C                     WRITEINPAYDDF               89
     C/COPY WNCPYSRC,FT0050C073
     C*
     C** CHECK FOR ERROR ON WRITE
     C*
     C           *IN89     IFEQ '1'                        B001
     C                     SETOF                     2072
     C                     SETON                     717578
     C*********************MOVE '068'     ERCD,1                          S01117
     C                     MOVE '001'     ERCD,1                          S01117
     C                     MOVEL*BLANKS   SACTCD
     C                     MOVEL*BLANKS   SPREF
     C                     MOVEL*BLANKS   SSWTN
     C                     MOVEL*BLANKS   SBRCA                           S01117
     C                     Z-ADD0         SSEQNO
     C                     GOTO ECEND
     C                     ELSE                            X001
     C                     SETON                     63
     C                     END                             E001
      *                                                                   042167
      * Call CL program to allocate this reference to a dataarea          042167
      *                                                                   042167
     C                     MOVE *BLANKS   @RTCDE                          042167
     C                     MOVE 'FT'      @MODLE                          042167
     C                     MOVE PREF      @TREF                           042167
     C                     MOVE *BLANKS   @RTINF                          042167
     C                     CALL 'AOC8000'                                 042167
     C                     PARM           @RTCDE                          042167
     C                     PARM           @MODLE                          042167
     C                     PARM           @TREF                           042167
     C                     PARM           @RTINF                          042167
      *                                                                   056031
      *  Process shadow post                                              056031
      *                                                                   056031
     C                     Z-ADDSMAM      ##SMAM                          056031
     C                     Z-ADDPYAM      ##PYAM                          056031
     C                     EXSR SRADD                                     056031
      *                                                                   CFT009
      *  Add shadow postings of charges if CFT009 active                  CFT009
     C           CFT009    IFEQ 'Y'                                       CFT009
     C                     EXSR CHGPST                                    CFT009
     C           ##CHGS    IFNE 0                                         CFT009
     C                     EXSR SRSCHG                                    CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   056031
      *  Update database with changes                                     056031
      *                                                                   056031
     C                     EXSR SRUPD                                     056031
      *
      ** Set previous pay ref of insert for Initial screen.
      *
     C                     MOVELPREF      SPREFP
      *                                                                   S01435
     C           INMSGR    IFNE 0                                         S01435
      *                                                                   S01435
      * The electronic message must be removed from the outstanding       S01435
      * reserved messages file                                            S01435
      *                                                                   S01435
     C                     EXSR MSGDEL                                    S01435
      *                                                                   S01435
      * Update Incoming Message FT Transaction Status File record         S01435
      *                                                                   S01435
     C                     MOVEL'MIN0030' W0FLAG  7                       S01435
     C                     MOVEL'MIN0027' W0LMSG  7                       S01435
      *                                                                   S01435
     C                     EXSR SRINFT                                    S01435
      *                                                                   S01435
     C                     END                                            S01435
      *
     C*
     C** UPDATE INCOMING PAYMENTS TRAILER WITH PAYMENT AMOUNT
     C*
     C                     MOVE SMAM      ZZAMT
     C                     EXSR GEINTR
      ***********                                                         056031
      ***********   Remove PRONO OLPOS and MEMOS processing               056031
      ***********                                                         056031
     C***********                                                         056031
     C***UPDATE*APPROPRIATE FILES IF RETAIL MODULE PRESENT                056031
     C***********                                                         056031
     C************IN32     IFEQ '1'                                       056031
     C***********          MOVELSNTP      WSNTP                           056031
     C***********          MOVELSND1      WSND1                           056031
     C***********          MOVELRCRT      WRCRT                           056031
     C***********          MOVELRCCO      WRCCO                           056031
     C***********          MOVELACBT      WACBT                           056031
     C***********          MOVELACBK      WACBK                           056031
     C***********          MOVELACBB      WACBB                     S01117056031
     C***********          MOVELBNCT      WBNCT   1                       056031
     C***********          MOVELBNC1      WBNC1  35                       056031
     C***********          Z-ADDSMAM      WSMAM                           056031
     C***********          MOVELSMCY      WSMCY                           056031
     C***********          Z-ADDPYAM      WPYAM                           056031
     C***********          MOVELPCCY      WPCCY                           056031
     C***********          Z-ADDSLDT      WSLDT                           056031
     C***********          Z-ADDPVDT      WPYDT                           056031
     C***********          EXSR GIRTUP                                    056031
     C***********          END                                            056031
     C***********                                                         056031
     C***UPDATE*APPROPRIATE FILES IF DEALING MODULE PRESENT               056031
     C***********                                                         056031
     C************IN30     IFEQ '1'                                       056031
     C************IN31     ANDEQ'1'                                       056031
     C***********          MOVELSNTP      WSNTP   1                       056031
     C***********          MOVELSND1      WSND1  35                       056031
     C***********          MOVELRCRT      WRCRT   1                       056031
     C***********          MOVELRCCO      WRCCO  10                       056031
     C***********          MOVELACBT      WACBT   1                       056031
     C***********          MOVELACBK      WACBK  12                       056031
     C***********          MOVELACBB      WACBB   3                 S01117056031
     C***********          Z-ADDSMAM      WSMAM  130                      056031
     C***********          MOVELSMCY      WSMCY   3                       056031
     C***********          Z-ADDPYAM      WPYAM  130                      056031
     C***********          MOVELPCCY      WPCCY   3                       056031
     C***********          Z-ADDSLDT      WSLDT   50                      056031
     C***********          Z-ADDPVDT      WPYDT   50                      056031
     C***********          MOVELRCCO      WRCNOS  2                       056031
     C***********          MOVELSND1      WSNOS   5                       056031
     C***********          MOVELACBK      WACNOS  2                       056031
     C***********          MOVELBNCT      WBNCT   1                       056031
     C***********          MOVELBNC1      WBNC1  35                       056031
     C***********          EXSR GGDLUP                                    056031
     C***********          END                                            056031
     C*
     C*****Update*MSIME*with*MSPF*=*'Y',*if*no*errors*from*EISWFT*        E20864
     C***                                                                 E20864
     C*****Update*MSIME*with*FTPF*=*'Y',*if*no*errors*from*EISWFT*  E20864S01259
     C***                                                                 S01259
     C*****Update*MSMSI2L9*with*FTPF*=*'Y',*if*no*errors*from*SW*   S01259S01435
     C***********                                                         S01435
     C***********SSWTN     IFNE *BLANKS                     SWIFT I/P     S01435
     C***********                                                         S01435
     C***********SSWTN*****CHAINMSIME                8888   READ SWIFT    S01259
     C*********************                                               S01259
     C************IN88*****IFEQ '1'                         ----------    S01259
     C*********************MOVEL'MSIMSPF' WDBFIL            -DATABASE-    S01259
     C*********************MOVELSRNM      WDBKEY            --ERROR---    S01259
     C*********************MOVEL'52'      WDBASE            ----------    S01259
     C*********************EXSR UEABRT                                    S01259
     C*********************ELSE                             CHAIN OK      S01259
     C*********************                                               S01259
     C***********SRNM******IFEQ SSWTN                        DO LOOP      S01259
     C************IN88*****ORNE '0'                                       S01259
     C*********************MOVE 'Y'       MSPF                      E20864S01259
     C*********************MOVE 'Y'       FTPF                      E20864S01259
     C*********************UPDATMSIMSPFF               88                 S01259
     C************IN88*****IFEQ '1'                         ----------    S01259
     C*********************MOVEL'MSIME'   WDBFIL            -DATABASE-    S01259
     C*********************MOVELSRNM      WDBKEY            --ERROR---    S01259
     C*********************MOVEL'52'      WDBASE            ----------    S01259
     C*********************END                                            S01259
     C*********************                                               S01259
     C*********************END                               END DO LOOP  S01259
     C*********************                                               S01259
     C*********************END                               CHAIN        S01259
      ***********                                                         S01435
     C***********                                                         S01435
     C***********SSWTN     CHAINMSMSI2L9             8888   READ SWIFT1259S01435
     C***********                                                   S01259S01435
     C************IN88     IFEQ '1'                         ----------1259S01435
     C***********          MOVEL'MSMSI2L9'WDBFIL            -DATABASE-1259S01435
     C***********          MOVELMIR       WDBKEY            --ERROR---1259S01435
     C***********          MOVEL'52'      WDBASE            ----------1259S01435
     C***********          EXSR UEABRT                              S01259S01435
     C***********          ELSE                             CHAIN OKS01259S01435
     C***********                                                   S01259S01435
     C***********MIR       IFEQ SSWTN                               S01259S01435
     C************IN88     ORNE '0'                                 S01259S01435
     C***********                                                   E29837S01435
     C***********SSEQNO    IFEQ 0                                   E29837S01435
     C***********          MOVE 'Y'       FTPF                      E29837S01435
     C***********          ELSE                                     E29837S01435
     C***********          Z-ADDSSEQNO    B       20                E29837S01435
     C***********          MOVE 'Y'       FTPS,B                    E29837S01435
     C***********          END                                      E29837S01435
     C***********                                                   S01259S01435
     C***********          UPDATMSMSI2D0               88           S01259S01435
     C***********                                                   S01259S01435
     C************IN88     IFEQ '1'                         ----------1259S01435
     C***********          MOVEL'MSMSI2L9'WDBFIL            -DATABASE-1259S01435
     C***********          MOVELMIR       WDBKEY            --ERROR---1259S01435
     C***********          MOVEL'52'      WDBASE            ----------1259S01435
     C***********          END                                      S01259S01435
      ***********                                                   S01428S01435
      ***After*a*successful update, the electronic message must be  S01428S01435
      ***removed*from the outstanding reserved messages file        S01428S01435
      ***********                                                   S01428S01435
     C***********          EXSR MSGDEL                              S01428S01435
     C***********                                                   S01259S01435
     C***********          END                               END DO LOOP59S01435
     C***********                                                   S01259S01435
     C***********          END                               CHAIN  S01259S01435
     C***********                                                   S01259S01435
     C***********          END                               END SWIFT    S01435
      *                                                                   056031
      *  Unwind subroutine stack name                                     056031
      *                                                                   056031
     C           ECEND     TAG                                            056031
     C                     MOVEA*BLANKS   @STK,O                          056031
     C                     SUB  1         O       50                      056031
     C*
     C*          *****     *****
     C***********ECEND*****ENDSR                                          056031
     C                     ENDSR                                          056031
     C*          *****     *****
     C/EJECT
     C           EEAMND    BEGSR
     C*          ******    *****
     C*
     C*****************************************************************
     C*                 EE-AMEND-PROCESSING                           *
     C*                                                               *
     C*  FUNCTION : TO PERFORM PROCESSING REQUIRED TO UPDATE FILES    *
     C*             WHEN DETAILS OF INCOMING PAYMENTS ARE AMENDED.    *
     C*                                                               *
     C*  CALLS :    GCINPY                                            *
     C*             GEINTR                                            *
     C*             GGDLUP                                            *
     C*             GIRTUP                                            *
     C*             UCINCN                                            *
     C*             UEABRT                                            *
     C*                                                               *
     C*  CALLED BY: CCPROC                                            *
     C*                                                               *
     C*****************************************************************
      *                                                                   056031
      *  Set up subroutine stack name                                     056031
      *                                                                   056031
     C                     ADD  1         O                               056031
     C                     MOVEL'EEAMND'  @STK,O                          056031
     C*
     C** ACCESS INCOMING PAYMENTS RECORD
     C*
     C                     EXSR UCINCN
     C*
     C** CHECK IF DATABASE ERROR OCCURRED
     C*
     C           *IN88     IFEQ '1'
     C                     MOVEL'INPAY'   WDBFIL
     C                     MOVELSPREF     WDBKEY
     C                     MOVEL'09'      WDBASE
     C                     EXSR UEABRT                     *ABORT PGM*
     C                     END
     C*
     C** CHECK IF DATE OR TIME STAMP IS DIFFERENT TO THAT SAVED
     C** (I.E. HAS RECORD BEEN UPDATED BY ANOTHER WORKSTATION)
     C*
     C           INLCD     IFNE SVLCD
     C           LCHT      ORNE SVLCHT
     C                     SETOF                     2072
     C                     SETON                     717578
     C*********************MOVE '068'     ERCD,1                          S01117
     C                     MOVE '001'     ERCD,1                          S01117
     C                     MOVEL*BLANKS   SACTCD
     C                     MOVEL*BLANKS   SPREF
     C                     MOVEL*BLANKS   SSWTN
     C                     MOVEL*BLANKS   SBRCA                           S01117
     C                     Z-ADD0         SSEQNO
     C                     EXCPTEXINPY
     C                     GOTO EEEND                      **RLS REC**
     C                     END
      *                                                                   CFT014
      ** Read extension details of Incoming Payment.                      CFT014
      *                                                                   CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
     C           CFT009    OREQ 'Y'                                       CFT009
      *                                                                   CFT014
     C           PREF      CHAININPAYXL0             90                   CFT014
      *                                                                   CFT014
      ** DB error if no live record exists.                               CFT014
      *                                                                   CFT014
     C           *IN90     IFEQ '1'                                       CFT014
     C           *IN90     OREQ '0'                                       CFT014
     C           INRECI    ANDNE'D'                                       CFT014
     C                     Z-ADD019       W0ERNB                          CFT014
     C                     MOVELPREF      W0KEY                           CFT014
     C                     MOVEL'INPAYXL0'W0FILE                          CFT014
     C                     EXSR SRERR                                     CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C**********           MOVE *BLANKS   WIBTR  18                                    CFT014 CGL029
     C**********           MOVE *BLANKS   WIBRC  18                                    CFT014 CGL029
     C                     MOVE *BLANKS   WIBTR  24                                           CGL029
     C                     MOVE *BLANKS   WIBRC  24                                           CGL029
     C*                                                                   S01508
     C** If S01508 is installed, check if debit customer has changed      S01508
     C/COPY WNCPYSRC,FT0050C166
     C*                                                                   S01508
     C           S01508    IFEQ 'Y'                                       S01508
     C                     MOVE *BLANKS   WDCUS1                          S01508
     C                     MOVE *BLANKS   WDCUS2                          S01508
     C                     MOVE *BLANK    WRDFTC                          S01508
      *                                                                   CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
     C           CFT004    ANDEQ'Y'                                       CFT014
      *                                                                   CFT014
      ** Determine corresponding Midas account of IBAN account            CFT014
      ** for Third Reimbursement Institution.                             CFT014
      *                                                                   CFT014
     C           INTRIT    IFEQ 'I'                                       CFT014
     C                     MOVELINTRIB    P@IBAN                          CFT014
     C                     MOVE *BLANKS   DSSDY                           CFT014
     C                     CALL 'AOIBANR4'                                CFT014
     C                     PARM *BLANKS   @RTCD                           CFT014
     C                     PARM '*KEY   ' @OPTN                           CFT014
     C                     PARM           P@IBAN                          CFT014
     C           P@ACCN    PARM           DSSDY                           CFT014
      *                                                                   CFT014
     C           @RTCD     IFNE *BLANKS                                   CFT014
     C                     Z-ADD021       W0ERNB                          CFT014
     C                     MOVELP@IBAN    W0KEY                           CFT014
     C                     MOVEL'ACCNTL6' W0FILE                          CFT014
     C                     EXSR SRERR                                     CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C**********           Z-ADDIBCNUM    IMCNUM                                       CFT014 CSD027
     C                     MOVE IBCNUM    IMCNUM                                              CSD027
     C                     MOVE CCY       IMCCY                           CFT014
     C                     Z-ADDIBACOD    IMACOD                          CFT014
     C                     Z-ADDIBACSQ    IMACSQ                          CFT014
     C                     MOVE IBBRCA    IMBRCA                          CFT014
     C                     MOVELIMACNT    WIBTR                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Determine corresponding Midas account of IBAN account            CFT014
      ** for Receiver's Correspondent.                                    CFT014
      *                                                                   CFT014
     C           INRCRT    IFEQ 'I'                                       CFT014
     C           34        SUBSTINRCO1:2  P@IBAN                          CFT014
     C                     MOVE *BLANKS   DSSDY                           CFT014
     C                     CALL 'AOIBANR4'                                CFT014
     C                     PARM *BLANKS   @RTCD                           CFT014
     C                     PARM '*KEY   ' @OPTN                           CFT014
     C                     PARM           P@IBAN                          CFT014
     C           P@ACCN    PARM           DSSDY                           CFT014
      *                                                                   CFT014
     C           @RTCD     IFNE *BLANKS                                   CFT014
     C                     Z-ADD022       W0ERNB                          CFT014
     C                     MOVELP@IBAN    W0KEY                           CFT014
     C                     MOVEL'ACCNTL6' W0FILE                          CFT014
     C                     EXSR SRERR                                     CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C**********           Z-ADDIBCNUM    IMCNUM                                       CFT014 CSD027
     C                     MOVE IBCNUM    IMCNUM                                              CSD027
     C                     MOVE CCY       IMCCY                           CFT014
     C                     Z-ADDIBACOD    IMACOD                          CFT014
     C                     Z-ADDIBACSQ    IMACSQ                          CFT014
     C                     MOVE IBBRCA    IMBRCA                          CFT014
     C                     MOVELIMACNT    WIBRC                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
     C*                                                                   S01508
     C** Determine the original debit customer by calling FT0035          S01508
     C** ...if S01506 is intalled, use ordering customer details          S01508
     C** ... if add/deduct is 'A', use ordering customer and bank         S01508
     C** ... if add/deduct is 'D', use destination and sender's corres.   S01508
     C*                                                                   S01508
     C                     CLEARW0DTA                                     S01508
     C                     SELEC                                          S01508
     C*                                                                   S01506
     C           S01506    WHEQ 'Y'                                       S01506
     C                     MOVELBNCT      I#PT1                           S01506
     C                     MOVELBNC1      I#PTY1                          S01506
     C/COPY WNCPYSRC,FT0050C019
     C                     MOVELPCCY      I#CCY                           S01506
     C*                                                                   S01506
     C           ADDC      WHEQ 'A'                                       S01508
      *                                                                   CFT014
     C           INTRIT    IFEQ *BLANK                                    CFT014
     C           CFT014    ORNE 'Y'                                       CFT014
     C                     MOVELSNTP      I#PT1                           S01508
     C                     MOVELSND1      I#PTY1                          S01508
     C                     MOVELSMCY      I#CCY                           S01508
     C***********RCCO      IFNE *ZEROS                             S01508 CFT014
     C/COPY WNCPYSRC,FT0050C129
     C***********          MOVELRCRT      I#PT2                    S01508 CFT014
     C***********          MOVELRCCO      I#PTY2                   S01508 CFT014
     C           WIBRC     IFNE *BLANKS                                   CFT014
     C                     MOVEL'G'       I#PT2                           CFT014
     C                     MOVELWIBRC     I#PTY2                          CFT014
     C                     ELSE                                           CFT014
     C                     MOVELINRCRT    I#PT2                           CFT014
     C                     MOVELINRCO1    I#PTY2                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
     C           WIBRC     IFNE *BLANKS                                   CFT014
     C                     MOVEL'G'       I#PT1                           CFT014
     C                     MOVELWIBRC     I#PTY1                          CFT014
     C                     ELSE                                           CFT014
     C                     MOVELINRCRT    I#PT1                           CFT014
     C                     MOVELINRCO1    I#PTY1                          CFT014
     C                     ENDIF                                          CFT014
     C                     MOVELSMCY      I#CCY                           CFT014
     C           WIBTR     IFNE *BLANKS                                   CFT014
     C                     MOVEL'G'       I#PT2                           CFT014
     C                     MOVELWIBTR     I#PTY2                          CFT014
     C                     ELSE                                           CFT014
     C                     MOVELINTRIT    I#PT2                           CFT014
     C                     MOVELINTRIB    I#PTY2                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C/COPY WNCPYSRC,FT0050C130
     C                     END                                            S01508
     C/COPY WNCPYSRC,FT0050C138
     C*                                                                   S01508
     C           ADDC      WHEQ 'D'                                       S01508
     C                     MOVELBNCT      I#PT1                           S01508
     C                     MOVELBNC1      I#PTY1                          S01508
     C/COPY WNCPYSRC,FT0050C020
     C                     MOVELPCCY      I#CCY                           S01508
     C           ACBB      IFNE *ZEROS                                    S01508
     C**********           MOVE *BLANKS   WORBKC 15                                    S01508 CGL029
     C                     MOVE *BLANKS   WORBKC 21                                           CGL029
     C           ACBK      CAT  ACBB      WORBKC                          S01508
     C                     MOVELACBT      I#PT2                           S01508
     C                     MOVELWORBKC    I#PTY2                          S01508
     C                     END                                            S01508
     C                     ENDSL                                          S01508
     C*                                                                   S01506
     C                     CALL 'FT0035'               9090               S01506
     C                     PARM *BLANKS   @RTRN                           S01506
     C                     PARM           W0DTA                           S01506
     C                     PARM           W0MSG 256                       S01506
     C           *IN90     IFEQ '1'                                       S01506
     C           @RTRN     ORNE *BLANKS                                   S01506
     C                     MOVEL'FT0035  'W0FILE           ************   S01506
     C                     MOVEL'*CALL   'W0KEY            * DBERR 33 *   S01506
     C                     Z-ADD33        W0ERNB           ************   S01506
     C                     EXSR SRERR                                     S01506
     C                     ELSE                                           S01506
     C                     MOVELO#CUST    WDCUS1  6                       S01506
     C                     END                                            S01506
     C*                                                                   S01508
     C** Determine the new debit customer by calling FT0035               S01508
     C** ... if S01506 is intalled, use ordering customer details         S01508
     C** ... if add/deduct is 'A', use ordering customer and bank         S01508
     C** ... if add/deduct is 'D', use destination and sender's corres.   S01508
     C*                                                                   S01508
     C                     CLEARW0DTA                                     S01508
     C                     SELEC                                          S01508
     C*                                                                   S01506
     C           S01506    WHEQ 'Y'                                       S01506
     C                     MOVELWBNCT     I#PT1                           S01506
     C           *IN10     IFEQ '0'                                       S01506
     C           WBNCT     ANDEQ'P'                                       S01506
     C                     MOVE BJSBRC    BBRCA                           S01506
     C                     END                                            S01506
     C                     MOVELSBNC1     I#PTY1                          S01506
     C                     MOVELSPCCY     I#CCY                           S01506
     C*                                                                   S01508
     C           SADDC     WHEQ 'A'                                       S01508
      *                                                                   CFT014
     C           WTRIT     IFEQ *BLANKS                                   CFT014
     C           CFT014    OREQ 'N'                                       CFT014
      *                                                                   CFT014
     C                     MOVELWSNTP     I#PT1                           S01508
     C           *IN10     IFEQ '0'                                       S01508
     C           WSNTP     ANDEQ'G'                                       S01508
     C                     MOVE BJSBRC    SSNBR                           S01508
     C                     END                                            S01508
     C           *IN38     IFEQ '1'                                       S01508
     C                     MOVE WCNUM     I#PTY1                          S01508
     C                     ELSE                                           S01508
     C                     MOVELSSND1     I#PTY1                          S01508
     C                     END                                            S01508
     C                     MOVELSSMCY     I#CCY                           S01508
     C                     MOVELWRCRT     I#PT2                           S01508
     C           WRCRT     IFEQ 'C'                                       CFT014
     C           WCNUM2    ANDNE*BLANKS                                   CFT014
     C                     MOVE WCNUM2    I#PTY2                          CFT014
     C                     ELSE                                           CFT014
     C***********          MOVELSRCCO     I#PTY2                   S01508 CFT014
     C           WRCRT     IFEQ 'I'                                       CFT014
     C           WRCRT     OREQ 'G'                                       CFT014
     C                     MOVEL'G'       I#PT2                           CFT014
     C                     MOVELRCCDS     I#PTY2                          CFT014
     C                     ELSE                                           CFT014
     C                     MOVELSRCO1     I#PTY2                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
     C                     MOVELWRCRT     I#PT1                           CFT014
     C           WRCRT     IFEQ 'C'                                       CFT014
     C           WCNUM2    ANDNE*BLANKS                                   CFT014
     C                     MOVE WCNUM2    I#PTY1                          CFT014
     C                     ELSE                                           CFT014
     C           WRCRT     IFEQ 'I'                                       CFT014
     C           WRCRT     OREQ 'G'                                       CFT014
     C                     MOVEL'G'       I#PT1                           CFT014
     C                     MOVELRCCDS     I#PTY1                          CFT014
     C                     ELSE                                           CFT014
     C                     MOVELSRCO1     I#PTY1                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
     C                     MOVELSSMCY     I#CCY                           CFT014
      *                                                                   CFT014
     C                     MOVELWTRIT     I#PT2                           CFT014
     C           WTRIT     IFEQ 'I'                                       CFT014
     C                     MOVEL'G'       I#PT2                           CFT014
     C                     MOVELWTRIDS    I#PTY2                          CFT014
     C                     ELSE                                           CFT014
     C                     MOVELSTRIB     W34RMB                          CFT014
     C           *IN10     IFEQ *OFF                                      CFT014
     C           WTRIT     ANDEQ'G'                                       CFT014
     C                     MOVE BJSBRC    W1618T                          CFT014
     C                     ENDIF                                          CFT014
     C                     MOVELW34RMB    I#PTY2                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
     C/COPY WNCPYSRC,FT0050C131
     C*                                                                   S01508
     C           SADDC     WHEQ 'D'                                       S01508
     C                     MOVELWBNCT     I#PT1                           S01508
     C           *IN10     IFEQ '0'                                       S01508
     C           WBNCT     ANDEQ'P'                                       S01508
     C                     MOVE BJSBRC    BBRCA                           S01508
     C                     END                                            S01508
     C                     MOVELSBNC1     I#PTY1                          S01508
     C                     MOVELSPCCY     I#CCY                           S01508
     C                     MOVE *BLANKS   WORBKC                          S01508
     C           SACBK     CAT  SACBB     WORBKC                          S01508
     C                     MOVELWACBT     I#PT2                           S01508
     C                     MOVELWORBKC    I#PTY2                          S01508
     C                     ENDSL                                          S01508
     C*                                                                   S01506
     C                     CALL 'FT0035'               9090               S01506
     C                     PARM *BLANKS   @RTRN                           S01506
     C                     PARM           W0DTA                           S01506
     C                     PARM           W0MSG 256                       S01506
     C           *IN90     IFEQ '1'                                       S01506
     C           @RTRN     ORNE *BLANKS                                   S01506
     C                     MOVEL'FT0035  'W0FILE           ************   S01506
     C                     MOVEL'*CALL   'W0KEY            * DBERR 34 *   S01506
     C                     Z-ADD34        W0ERNB           ************   S01506
     C                     EXSR SRERR                                     S01506
     C                     ELSE                                           S01506
     C                     MOVELO#CUST    WDCUS2  6                       S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C** Check if a recalculation is supposed to take place               S01506
     C*                                                                   S01506
     C           S01506    IFEQ 'Y'                                       S01506
     C           WDCUS1    IFNE WDCUS2                                    S01506
     C           SSMCY     ORNE SMCY                                      S01506
     C           SMAM      ORNE WSMAM                                     095075
     C           RATE      ORNE WRATE                                     124674
     C                     MOVE 'Y'       WRDFTC  1                       S01506
     C                     END                                            S01506
     C                     ELSE                                           S01508
     C           WDCUS1    IFNE WDCUS2                                    S01508
     C           SPYTP     ORNE PYTP                                      S01508
     C           SPYST     ORNE PYST                                      S01508
     C           SMAM      ORNE WSMAM                                     095075
     C           RATE      ORNE WRATE                                     124674
     C                     MOVE 'Y'       WRDFTC  1                       S01508
     C                     END                                            S01508
     C                     END                                            S01506
     C*                                                                   S01506
     C                     END                                            S01506
     C/COPY WNCPYSRC,FT0050C167
      *                                                                   056031
      *  Process shadow post (reverse out original entries)               056031
      *                                                                   056031
     C                     MOVEL*BLANKS   ##ACHG                          068320
      *                                                                   068320
     C           INLVL1    IFEQ 'Y'                                       S01435
     C                     Z-SUBSMAM      ##SMAM                          056031
     C                     Z-SUBPYAM      ##PYAM                          056031
     C                     EXSR SRADD                                     056031
      *                                                                   068320
      **If*charges*to*be*recalulated*then*reverse*them*out******** 068320 183200
      *                                                                   068320
      ** Do reversal of shadow posting for Charges always.  Anyway,       183200
      ** shadow postings for this maintenance that cancel out each        183200
      ** other will just be reversed out in AOSPOSU0 and will not         183200
      ** be posted anymore to the same account.                           183200
      *                                                                   183200
     C***********CDRO      IFEQ 0                                  068320 183200
     C***********SADDC     IFNE ADDC                               068320 183200
     C***********SMCY      ANDNEPCCY                               068320 183200
     C***********SADDC     ORNE ADDC                               068320 183200
     C***********SSMCY     ANDNESPCCY                              068320 183200
     C***********SPCCY     ORNE PCCY                               068320 183200
     C***********SADDC     ANDEQ'D'                                068320 183200
     C***********SSMCY     ORNE SMCY                               068320 183200
     C***********SADDC     ANDEQ'A'                                068320 183200
     C                     MOVEL'Y'       ##ACHG  1                       068320
      *                                                                   068320
      * Calculate charge amount (always debit)                            068320
      *                                                                   068320
     C           TXCH      ADD  CQCH      ##CHGS                          068320
     C/COPY WNCPYSRC,FT0050C177
     C                     ADD  ADCH      ##CHGS                          068320
     C/COPY WNCPYSRC,FT0050C178
     C                     ADD  TLCH      ##CHGS                          068320
     C                     ADD  MSCH      ##CHGS                          068320
     C                     ADD  TRCM      ##CHGS                          068320
     C*                                                                   S01494
     C           S01494    IFEQ 'Y'                                       S01494
     C                     ADD  INCHCM    ##CHGS                          S01494
     C                     END                                            S01494
     C           S01499    IFEQ 'Y'                                       S01499
     C           CFT010    OREQ 'Y'                                       CFT009
     C                     ADD  INVATT    ##CHGS                          S01499
     C                     END                                            S01499
      *
     C           CFT009    IFEQ 'Y'                                       CFT009
     C                     ADD  MSC01     ##CHGS                          CFT009
     C                     ADD  MSC02     ##CHGS                          CFT009
     C                     ADD  MSC03     ##CHGS                          CFT009
     C                     ADD  MSC04     ##CHGS                          CFT009
     C                     ADD  MSC05     ##CHGS                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      *                                                                   068320
     C           ##CHGS    IFNE 0                                         068320
     C                     Z-SUB##CHGS    ##CHGS                          068320
     C                     EXSR SRSCHG                                    068320
     C                     END                                            068320
      *                                                                   183200
     C***********          END                                     068320 183200
     C***********          END                                     068320 183200
      *                                                                   068320
     C                     END                                            S01435
      *                                                                   056031
     C*
     C** SAVE ORIGINAL FIELDS FOR DEALING/RETAIL MODULES FILE UPDATES
     C*
     C                     MOVELSNTP      SVSNTP  1
     C                     MOVELSND1      SVSND1 35
     C                     MOVELRCRT      SVRCRT  1
     C                     MOVELRCCO      SVRCCO 10
     C                     MOVELACBT      SVACBT  1
     C**********           MOVELACBK      SVACBK 12                                           CGL029
     C                     MOVELACBK      SVACBK 18                                           CGL029
     C                     MOVELACBB      SVACBB  3                       S01117
     C                     MOVELBNCT      SVBNCT  1
     C                     MOVELBNC1      SVBNC1 35
     C/COPY WNCPYSRC,FT0050C021
     C                     Z-ADDSMAM      SVSMAM 130
     C                     MOVELSMCY      SVSMCY  3
     C                     Z-ADDPYAM      SVPYAM 130
     C                     MOVELPCCY      SVPCCY  3
     C                     Z-ADDNDAM      SVNDAM 130                      CEU006
     C                     MOVELNDCY      SVNDCY  3                       CEU006
     C                     Z-ADDSLDT      SVSLDT  50
     C                     Z-ADDPVDT      SVPYDT  50
     C*
     C** SETUP FIELDS FOR INCOMING PAYMENTS RECORD
     C*
     C                     EXSR GCINPY
     C*
     C** SET UP VALUE OF INPUT USER FOR LATER AUTHORISATION CHECK
     C*
     C                     MOVE USRID     INUSR1 10
     C*
     C** UPDATE INCOMING PAYMENTS RECORD
     C*
      *                          INPYDS                                   S01435
      *  /COPY for additional processing before updating INPAYDD          S01435
      *                                                                   S01435
     C/COPY WNCPYSRC,FT0050AMND                                           S01435
      *                                                                   CFT003
      *  If Batch Authorsation update/add record                          CFT003
      *                                                                   CFT003
     C           CFT003    IFEQ 'CFT003'                                  CFT003
     C           CFT014    ANDNE'Y'                                       CFT014
     C           CFT009    ANDNE'Y'                                       CFT009
      *                                                                   CFT003
      ** Update extension record to include the Auto-generated            CFT003
      ** indicator                                                        CFT003
      *                                                                   CFT003
     C           PREF      CHAININPAYXL0             90                   CFT003
      *                                                                   CFT003
      * If no existing extension record, insert new one                   CFT003
      *                                                                   CFT003
     C           *IN90     IFEQ '1'                                       CFT003
     C                     MOVELPREF      INPREF                          CFT003
     C                     MOVEL'N'       INAUTO                          CFT003
      *                                                                   CFT003
     C                     MOVEASTAMP,1   INTMST                                              CPK015
     C                     WRITEINPAYXDF                                  CFT003
      *                                                                   CFT003
      * If existing extension record, update                              CFT003
      *                                                                   CFT003
     C                     ELSE                                           CFT003
      *                                                                   CFT003
     C                     MOVEL'N'       INAUTO                          CFT003
     C                     UPDATINPAYXDF                                  CFT003
      *                                                                   CFT003
     C                     ENDIF                                          CFT003
      *                                                                   CFT003
     C                     ENDIF                                          CFT003
      *                                                                   CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
     C           CFT009    OREQ 'Y'                                       CFT009
      *                                                                   CFT014
     C                     MOVEL'N'       INAUTO                          CFT014
      *                                                                   CFT009
      ** FX Spread set                                                    CFT009
      *                                                                   CFT009
     C           CFT009    IFEQ 'Y'                                       CFT009
      *                                                                   CFT009
      * Amend                                                             CFT009
     C           F12       IFEQ *BLANKS                                   CFT009
      *                                                                   CFT009
      * Save redefaulted charges                                          CFT009
     C           KFCHG     IFEQ 'Y'                                       CFT009
     C                     EXSR CHGVAT                                    CFT009
     C                     EXSR MOVCHG                                    CFT009
     C                     ELSE                                           CFT009
     C                     MOVELSPDSET    FXSPSC                          CFT009
     C                     MOVELSOFCD     INPDOF                          CFT009
      *                                                                   CFT009
      ** If add/deduct indicator is amended, levied charge currency and   CFT009
      ** corresponding charge amount must be adjusted accordingly         CFT009
      *                                                                   CFT009
     C           FADDC     IFNE SADDC                                     CFT009
     C                     EXSR READJ                                     CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
      * Insert                                                            CFT009
     C                     EXSR CHGVAT                                    CFT009
     C                     EXSR MOVCHG                                    CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT014
     C                     MOVELWTRIT     INTRIT                          CFT014
      *                                                                   CFT014
     C                     MOVELSTRIB     W34RMB                          CFT014
     C           *IN10     IFEQ *OFF                                      CFT014
     C           WTRIT     ANDEQ'G'                                       CFT014
     C                     MOVE BJSBRC    W1618T                          CFT014
     C                     ENDIF                                          CFT014
     C                     MOVELW34RMB    INTRIB                          CFT014
      *                                                                   CFT014
     C                     Z-ADDWOEXR     INOEXR                          CFT014
     C                     ENDIF                                          CFT009
      *                                                                   CFT014
     C                     UPDATINPAYXDF               90                 CFT014
      *                                                                   CFT014
     C           *IN90     IFEQ *ON                                       CFT014
     C                     Z-ADD026       W0ERNB                          CFT014
     C                     MOVELPREF      W0KEY                           CFT014
     C                     MOVEL'INPAYXL0'W0FILE                          CFT014
     C                     EXSR SRERR                                     CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   S01435
     C                     UPDATINPAYDDF               89
     C*
     C** CHECK IF DATABASE ERROR OCCURRED
     C*
     C           *IN89     IFEQ '1'
     C                     MOVEL'INPAY'   WDBFIL
     C                     MOVELSPREF     WDBKEY
     C                     MOVEL'10'      WDBASE
     C                     EXSR UEABRT                     *ABORT PGM*
     C                     END
      *                                                                   056031
      *  Process shadow post                                              056031
      *                                                                   056031
     C                     Z-ADDSMAM      ##SMAM                          056031
     C                     Z-ADDPYAM      ##PYAM                          056031
     C                     EXSR SRADD                                     056031
      *                                                                   068320
      * If charges to be recalulated then add them in                     068320
      *                                                                   068320
     C           ##ACHG    IFEQ 'Y'                                       068320
      *                                                                   068320
      * Calculate charge amount (always debit)                            068320
      *                                                                   068320
     C           TXCH      ADD  CQCH      ##CHGS                          068320
     C/COPY WNCPYSRC,FT0050C179
     C                     ADD  ADCH      ##CHGS                          068320
     C/COPY WNCPYSRC,FT0050C180
     C                     ADD  TLCH      ##CHGS                          068320
     C                     ADD  MSCH      ##CHGS                          068320
     C                     ADD  TRCM      ##CHGS                          068320
     C*                                                                   S01494
     C           S01494    IFEQ 'Y'                                       S01494
     C                     ADD  INCHCM    ##CHGS                          S01494
     C                     END                                            S01494
     C           S01499    IFEQ 'Y'                                       S01499
     C           CFT010    OREQ 'Y'                                       CFT009
     C                     ADD  INVATT    ##CHGS                          S01499
     C                     END                                            S01499
      *                                                                   CFT009
     C           CFT009    IFEQ 'Y'                                       CFT009
     C                     ADD  MSC01     ##CHGS                          CFT009
     C                     ADD  MSC02     ##CHGS                          CFT009
     C                     ADD  MSC03     ##CHGS                          CFT009
     C                     ADD  MSC04     ##CHGS                          CFT009
     C                     ADD  MSC05     ##CHGS                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   068320
     C           ##CHGS    IFNE 0                                         068320
     C                     EXSR SRSCHG                                    068320
     C                     END                                            068320
     C                     END                                            068320
      *                                                                   068320
      *                                                                   056031
      *  Update database with changes                                     056031
      *                                                                   056031
     C                     EXSR SRUPD                                     056031
      *                                                                   056031
      *                                                                   S01435
      * Update Incoming Message FT Transaction Status File record         S01435
      *                                                                   S01435
     C           INMSGR    IFNE 0                                         S01435
      *                                                                   S01435
     C                     MOVEL'MIN0030' W0FLAG                          S01435
     C                     MOVEL'MIN0028' W0LMSG                          S01435
     C                     MOVEL*BLANKS   PNWRK                           S01435
      *                                                                   S01435
     C                     EXSR SRINFT                                    S01435
      *                                                                   S01435
     C                     END                                            S01435
     C*
     C** UPDATE INCOMING PAYMENTS TRAILER WITH NEW PAYMENT AMOUNT
     C** MINUS ORIGINAL PAYMENT AMOUNT
     C*
     C           SMAM      SUB  SVSMAM    WN13   130
     C                     MOVE WN13      ZZAMT
     C                     EXSR GEINTR
      ***********                                                         056031
      ***********   Remove PRONO OLPOS and MEMOS                          056031
      ***********                                                         056031
     C***********                                                         056031
     C***UPDATE*APPROPRIATE FILES IF RETAIL MODULE PRESENT :              056031
     C***FIRST*WITH REVERSE OF ORIGINAL AMOUNTS & THEN WITH NEW           056031
     C***AMOUNTS*                                                         056031
     C***********                                                         056031
     C************IN32     IFEQ '1'                                       056031
     C***********          MOVELSVSNTP    WSNTP            -ORIGINAL      056031
     C***********          MOVELSVSND1    WSND1             VALUES.       056031
     C***********          MOVELSVRCRT    WRCRT                           056031
     C***********          MOVELSVRCCO    WRCCO                           056031
     C***********          MOVELSVACBT    WACBT                           056031
     C***********          MOVELSVACBK    WACBK                           056031
     C***********          MOVELSVACBB    WACBB                     S01117056031
     C***********          MOVELSVBNCT    WBNCT                           056031
     C***********          MOVELSVBNC1    WBNC1                           056031
     C***********          Z-SUBSVSMAM    WSMAM                           056031
     C***********          MOVELSVSMCY    WSMCY                           056031
     C***********          Z-SUBSVPYAM    WPYAM                           056031
     C***********          MOVELSVPCCY    WPCCY                           056031
     C***********          Z-ADDSVSLDT    WSLDT                           056031
     C***********          Z-ADDSVPYDT    WPYDT                           056031
     C***********          EXSR GIRTUP                                    056031
     C***********                                                         056031
     C***********          MOVELSNTP      WSNTP            -NEW VALUES.   056031
     C***********          MOVELSND1      WSND1                           056031
     C***********          MOVELRCRT      WRCRT                           056031
     C***********          MOVELRCCO      WRCCO                           056031
     C***********          MOVELACBT      WACBT                           056031
     C***********          MOVELACBK      WACBK                           056031
     C***********          MOVELACBB      WACBB                     S01117056031
     C***********          MOVELBNCT      WBNCT                           056031
     C***********          MOVELBNC1      WBNC1                           056031
     C***********          Z-ADDSMAM      WSMAM                           056031
     C***********          MOVELSMCY      WSMCY                           056031
     C***********          Z-ADDPYAM      WPYAM                           056031
     C***********          MOVELPCCY      WPCCY                           056031
     C***********          Z-ADDSLDT      WSLDT                           056031
     C***********          Z-ADDPVDT      WPYDT                           056031
     C***********          EXSR GIRTUP                                    056031
     C***********          END                                            056031
     C***********                                                         056031
     C***UPDATE*APPROPRIATE FILES IF DEALING MODULE PRESENT :             056031
     C***FIRST*WITH REVERSE OF ORIGINAL AMOUNTS & THEN WITH NEW           056031
     C***AMOUNTS*                                                         056031
     C***********                                                         056031
     C************IN30     IFEQ '1'                                       056031
     C************IN31     ANDEQ'1'                                       056031
     C***********          MOVELSVSNTP    WSNTP            -ORIGINAL      056031
     C***********          MOVELSVSND1    WSND1             VALUES.       056031
     C***********          MOVELSVRCRT    WRCRT                           056031
     C***********          MOVELSVRCCO    WRCCO                           056031
     C***********          MOVELSVACBT    WACBT                           056031
     C***********          MOVELSVACBK    WACBK                           056031
     C***********          MOVELSVACBB    WACBB                     S01117056031
     C***********          Z-SUBSVSMAM    WSMAM                           056031
     C***********          MOVELSVSMCY    WSMCY                           056031
     C***********          Z-SUBSVPYAM    WPYAM                           056031
     C***********          MOVELSVPCCY    WPCCY                           056031
     C***********          Z-ADDSVSLDT    WSLDT                           056031
     C***********          Z-ADDSVPYDT    WPYDT                           056031
     C***********          MOVELSVRCCO    WRCNOS                          056031
     C***********          MOVELSVSND1    WSNOS                           056031
     C***********          MOVELSVACBK    WACNOS                          056031
     C***********          MOVELSVBNCT    WBNCT                           056031
     C***********          MOVELSVBNC1    WBNC1                           056031
     C***********          EXSR GGDLUP                                    056031
     C***********                                                         056031
     C***********          MOVELSNTP      WSNTP            -NEW VALUES.   056031
     C***********          MOVELSND1      WSND1                           056031
     C***********          MOVELRCRT      WRCRT                           056031
     C***********          MOVELRCCO      WRCCO                           056031
     C***********          MOVELACBT      WACBT                           056031
     C***********          MOVELACBK      WACBK                           056031
     C***********          MOVELACBB      WACBB                     S01117056031
     C***********          Z-ADDSMAM      WSMAM                           056031
     C***********          MOVELSMCY      WSMCY                           056031
     C***********          Z-ADDPYAM      WPYAM                           056031
     C***********          MOVELPCCY      WPCCY                           056031
     C***********          Z-ADDSLDT      WSLDT                           056031
     C***********          Z-ADDPVDT      WPYDT                           056031
     C***********          MOVELRCCO      WRCNOS                          056031
     C***********          MOVELSND1      WSNOS                           056031
     C***********          MOVELACBK      WACNOS                          056031
     C***********          MOVELBNCT      WBNCT                           056031
     C***********          MOVELBNC1      WBNC1                           056031
     C***********          EXSR GGDLUP                                    056031
     C***********          END                                            056031
      *                                                                   056031
      *  Unwind subroutine stack name                                     056031
      *                                                                   056031
     C           EEEND     TAG                                            056031
     C                     MOVEA*BLANKS   @STK,O                          056031
     C                     SUB  1         O       50                      056031
     C*
     C*          *****     *****
     C***********EEEND*****ENDSR                                          056031
     C                     ENDSR                                          056031
     C*          *****     *****
     C/EJECT
     C           EGDELT    BEGSR
     C*          ******    *****
     C*
     C*****************************************************************
     C*                 EG-DELETE-PROCESSING                          *
     C*                                                               *
     C*  FUNCTION : TO PERFORM PROCESSING REQUIRED TO UPDATE FILES    *
     C*             WHEN DETAILS OF INCOMING PAYMENTS ARE DELETED.    *
     C*                                                               *
     C*  CALLS :    GCSTUP                                            *
     C*             GGDLUP                                            *
     C*             GIRTUP                                            *
     C*             UCINCN                                            *
     C*             UEABRT                                            *
     C*                                                               *
     C*  CALLED BY: CCPROC                                            *
     C*                                                               *
     C*****************************************************************
      *                                                                   056031
      *  Set up subroutine stack name                                     056031
      *                                                                   056031
     C                     ADD  1         O                               056031
     C                     MOVEL'EGDELT'  @STK,O                          056031
     C*
     C** ACCESS INCOMING PAYMENTS RECORD
     C*
     C                     EXSR UCINCN
     C*
     C** CHECK IF DATABASE ERROR OCCURRED
     C*
     C           *IN88     IFEQ '1'
     C                     MOVEL'INPAY'   WDBFIL
     C                     MOVELSPREF     WDBKEY
     C                     MOVEL'11'      WDBASE
     C                     EXSR UEABRT                     *ABORT PGM*
     C                     END
     C*
     C** CHECK IF DATE OR TIME STAMP IS DIFFERENT TO THAT SAVED
     C** (I.E. HAS RECORD BEEN UPDATED BY ANOTHER WORKSTATION)
     C*
     C           INLCD     IFNE SVLCD
     C           LCHT      ORNE SVLCHT
     C                     SETOF                     2072
     C                     SETON                     717578
     C*********************MOVE '068'     ERCD,1                          S01117
     C                     MOVE '001'     ERCD,1                          S01117
     C                     MOVEL*BLANKS   SACTCD
     C                     MOVEL*BLANKS   SPREF
     C                     MOVEL*BLANKS   SSWTN
     C                     MOVEL*BLANKS   SBRCA                           S01117
     C                     Z-ADD0         SSEQNO
     C                     EXCPTEXINPY
     C                     GOTO EGEND                      **RLS REC**
     C                     END
      *                                                                   CFT014
      ** Read extension details of Incoming Payment.                      CFT014
      *                                                                   CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
     C           CFT009    OREQ 'Y'                                       CFT009
      *                                                                   CFT014
     C           PREF      CHAININPAYXL0             90                   CFT014
      *                                                                   CFT014
      ** DB error if no live record exists.                               CFT014
      *                                                                   CFT014
     C           *IN90     IFEQ '1'                                       CFT014
     C           *IN90     OREQ '0'                                       CFT014
     C           INRECI    ANDNE'D'                                       CFT014
     C                     Z-ADD024       W0ERNB                          CFT014
     C                     MOVELPREF      W0KEY                           CFT014
     C                     MOVEL'INPAYXL0'W0FILE                          CFT014
     C                     EXSR SRERR                                     CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   056031
      *  Process shadow post (reverse out original entries)               056031
      *                                                                   056031
     C           INLVL1    IFEQ 'Y'                                       S01435
     C                     Z-SUBSMAM      ##SMAM                          056031
     C                     Z-SUBPYAM      ##PYAM                          056031
     C                     EXSR SRADD                                     056031
      *                                                                   068320
      * If charges then reverse them out                                  068320
      *                                                                   068320
      *                                                                   068320
      * Calculate charge amount (always debit)                            068320
      *                                                                   068320
     C           TXCH      ADD  CQCH      ##CHGS                          068320
     C/COPY WNCPYSRC,FT0050C181
     C                     ADD  ADCH      ##CHGS                          068320
     C/COPY WNCPYSRC,FT0050C182
     C                     ADD  TLCH      ##CHGS                          068320
     C                     ADD  MSCH      ##CHGS                          068320
     C                     ADD  TRCM      ##CHGS                          068320
     C           CFT009    IFEQ 'Y'                                       CFT009
     C                     ADD  MSC01     ##CHGS                          CFT009
     C                     ADD  MSC02     ##CHGS                          CFT009
     C                     ADD  MSC03     ##CHGS                          CFT009
     C                     ADD  MSC04     ##CHGS                          CFT009
     C                     ADD  MSC05     ##CHGS                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      *                                                                   068320
     C           ##CHGS    IFNE 0                                         068320
     C                     Z-SUB##CHGS    ##CHGS                          068320
     C                     EXSR SRSCHG                                    068320
     C                     END                                            068320
      *                                                                   068320
     C                     END                                            S01435
      *                                                                   056031
     C*
     C** SETUP FIELDS FOR INCOMING PAYMENTS RECORD
     C*
     C                     MOVEL'C'       RECI
     C**********           Z-ADDRUND      INLCD                           S01194
     C                     Z-ADDBJRDNB    INLCD                           S01194
     C                     Z-ADDTIME      LCHT
     C                     MOVEL'D'       CHTP
     C*                                                                   S01241
     C* IF DELETE, CALL WINDOW PROGRAM TO DELETE ASSOCIATED RECORD        S01241
     C*                                                                   S01241
     C********** BGL5ST    IFEQ 'Y'                                 S01241S01251
     C           BGWDPR    IFEQ 'Y'                                       S01251
     C*                                                                   S01241
      *    /copy to move data into the data structure fields passed       S01241
      *     as a parameter to the window controller                       S01241
      *                                                                   S01241
      /COPY WNCPYSRC,FT0050MOV1                                           S01241
     C/COPY WNCPYSRC,FT0050C113
      *                                                                   S01241
     C                     MOVEL'D'       #ACTN   1                       S01241
     C                     MOVE *BLANKS   RTNCDE  7                       S01241
     C                     MOVE *BLANKS   ##CMD   2                       S01241
     C                     MOVEL'FT0050'  ##PGM  10                       S01241
     C                     CALL 'WN0010'                                  S01241
     C                     PARM           ##PGM                           S01241
     C                     PARM           ##CMD                           S01241
     C                     PARM           #ACTN                           S01241
     C                     PARM           DATA                            S01241
     C**********           PARM           RTNCDE                    S01241S01252
     C                     PARM *BLANKS   RTNCDE                          S01252
     C                     PARM           SPARE 256                       S01252
     C*                                                                   051173
     C           RTNCDE    IFNE *BLANKS                                   051173
     C                     EXCPTEXINPY                                    051173
     C           CFT014    IFEQ 'Y'                                       CFT014
     C                     EXCPTEXIPEX                                    CFT014
     C                     ENDIF                                          CFT014
     C                     GOTO EGEND                      **RLS REC**    051173
     C/COPY WNCPYSRC,FT0050C003
     C                     END                                            051173
     C*                                                                   051173
     C                     END                                            S01241
     C*
     C** UPDATE INCOMING PAYMENTS RECORD
     C*
      *                                                                   S01435
      *  /COPY for additional processing before updating INPAYDD          S01435
      *                                                                   S01435
     C/COPY WNCPYSRC,FT0050DELT                                           S01435
      *                                                                   S01435
      ** Flag extension details of Incoming Payment as deleted.           CFT014
      *                                                                   CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
     C           CFT009    OREQ 'Y'                                       CFT009
      *                                                                   CFT014
     C                     MOVE 'C'       INRECI                          CFT014
      *                                                                   CFT014
     C                     UPDATINPAYXDF               90                 CFT014
      *                                                                   CFT014
     C           *IN90     IFEQ *ON                                       CFT014
     C                     Z-ADD027       W0ERNB                          CFT014
     C                     MOVELPREF      W0KEY                           CFT014
     C                     MOVEL'INPAYXL0'W0FILE                          CFT014
     C                     EXSR SRERR                                     CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     UPDATINPAYDDF               89
     C*
     C** CHECK IF DATABASE ERROR OCCURRED
     C*
     C           *IN89     IFEQ '1'
     C                     MOVEL'INPAY'   WDBFIL
     C                     MOVELSPREF     WDBKEY
     C                     MOVEL'12'      WDBASE
     C                     EXSR UEABRT                     *ABORT PGM*
     C                     END
      *                                                                   056031
      *  Update database with changes                                     056031
      *                                                                   056031
     C                     EXSR SRUPD                                     056031
      *                                                                   S01435
      * Update Incoming Message FT Transaction Status File record         S01435
      *                                                                   S01435
     C           INMSGR    IFNE 0                                         S01435
      *                                                                   S01435
     C                     MOVEL'MIN0031' W0FLAG                          S01435
     C                     MOVEL'MIN0029' W0LMSG                          S01435
     C                     MOVEL*BLANKS   PNWRK                           S01435
      *                                                                   S01435
     C                     EXSR SRINFT                                    S01435
      *                                                                   S01435
     C                     END                                            S01435
      *                                                                   056031
      ***********                                                         056031
      ***********   Remove PRONO OLPOS and MEMOS                          056031
      ***********                                                         056031
     C***********                                                         056031
     C***UPDATE*APPROPRIATE FILES IF RETAIL MODULE PRESENT                056031
     C***(WITH*REVERSE OF ORIGINAL AMOUNTS)                               056031
     C***********                                                         056031
     C************IN32     IFEQ '1'                                       056031
     C***********          MOVELSNTP      WSNTP                           056031
     C***********          MOVELSND1      WSND1                           056031
     C***********          MOVELRCRT      WRCRT                           056031
     C***********          MOVELRCCO      WRCCO                           056031
     C***********          MOVELACBT      WACBT                           056031
     C***********          MOVELACBK      WACBK                           056031
     C***********          MOVELACBB      WACBB                     S01117056031
     C***********          MOVELBNCT      WBNCT                           056031
     C***********          MOVELBNC1      WBNC1                           056031
     C***********          Z-SUBSMAM      WSMAM                           056031
     C***********          MOVELSMCY      WSMCY                           056031
     C***********          Z-SUBPYAM      WPYAM                           056031
     C***********          MOVELPCCY      WPCCY                           056031
     C***********          Z-ADDSLDT      WSLDT                           056031
     C***********          Z-ADDPVDT      WPYDT                           056031
     C***********          EXSR GIRTUP                                    056031
     C***********          END                                            056031
     C***********                                                         056031
     C***UPDATE*APPROPRIATE FILES IF DEALING MODULE PRESENT               056031
     C***(WITH*REVERSE OF ORIGINAL AMOUNTS)                               056031
     C***********                                                         056031
     C************IN30     IFEQ '1'                                       056031
     C************IN31     ANDEQ'1'                                       056031
     C***********          MOVELSNTP      WSNTP                           056031
     C***********          MOVELSND1      WSND1                           056031
     C***********          MOVELRCRT      WRCRT                           056031
     C***********          MOVELRCCO      WRCCO                           056031
     C***********          MOVELACBT      WACBT                           056031
     C***********          MOVELACBK      WACBK                           056031
     C***********          MOVELACBB      WACBB                     S01117056031
     C***********          Z-SUBSMAM      WSMAM                           056031
     C***********          MOVELSMCY      WSMCY                           056031
     C***********          Z-SUBPYAM      WPYAM                           056031
     C***********          MOVELPCCY      WPCCY                           056031
     C***********          Z-ADDSLDT      WSLDT                           056031
     C***********          Z-ADDPVDT      WPYDT                           056031
     C***********          MOVELRCCO      WRCNOS                          056031
     C***********          MOVELSND1      WSNOS                           056031
     C***********          MOVELACBK      WACNOS                          056031
     C***********          MOVELBNCT      WBNCT                           056031
     C***********          MOVELBNC1      WBNC1                           056031
     C***********          EXSR GGDLUP                                    056031
     C***********          END                                            056031
      *                                                                   056031
      *  Unwind subroutine stack name                                     056031
      *                                                                   056031
     C           EGEND     TAG                                            056031
     C                     MOVEA*BLANKS   @STK,O                          056031
     C                     SUB  1         O       50                      056031
     C*
     C*          *****     *****
     C***********EGEND*****ENDSR                                          056031
     C                     ENDSR                                          056031
     C*          *****     *****
     C/EJECT                                                              S01435
      *****************************************************************   S01435
      *                                                               *   S01435
      *  FTSNMS   : Send message to program's message queue           *   S01435
      *                                                               *   S01435
      *  CALLED BY: UPDATE                                            *   S01435
      *                                                               *   S01435
      *  CALLS    : *NONE                                             *   S01435
      *                                                               *   S01435
      *****************************************************************   S01435
     CSR         FTSNMS    BEGSR                                          S01435
      *                                                                   S01435
      * If no program send to FT0050                                      S01435
      *                                                                   S01435
     C           FTPGMQ    IFEQ *BLANK                                    S01435
     C                     MOVEL##PGM     FTPGMQ                          S01435
     C                     END                                            S01435
      *                                                                   S01435
      * If FTPGRL is blank set *SAME                                      S01435
      *                                                                   S01435
     C           FTPGRL    IFEQ *BLANK                                    S01435
     C                     MOVEL'*SAME'   FTPGRL                          S01435
     C                     END                                            S01435
      *                                                                   S01435
      * If no message file specified, use default                         S01435
      *                                                                   S01435
     C           FTMSGF    IFEQ *BLANK                                    S01435
     C                     MOVEL'FTUSRMSG'FTMSGF                          S01435
     C                     END                                            S01435
      *                                                                   S01435
     C                     CALL 'AOCREPT'                                 S01435
     C                     PARM           FTMSID  7                       S01435
     C                     PARM           FTMSGF 10                       S01435
     C                     PARM           FTMSFL 10                       S01435
     C                     PARM           FTMSDT256                       S01435
     C                     PARM           FTPGRL  5                       S01435
     C                     PARM           FTPGMQ 10                       S01435
     C                     PARM           FTMSGQ 10                       S01435
     C                     PARM           FTMSGT  7                       S01435
      *                                                                   S01435
     C                     MOVEL'Y'       FTMSGS  1                       S01435
      *                                                                   S01435
      * Clear all fields for default mechanism next time                  S01435
      *                                                                   S01435
     C                     MOVEL*BLANK    FTMSID                          S01435
     C                     MOVEL*BLANK    FTMSGF                          S01435
     C                     MOVEL*BLANK    FTMSFL                          S01435
     C                     MOVEL*BLANK    FTMSDT                          S01435
     C                     MOVEL*BLANK    FTPGRL                          S01435
     C                     MOVEL*BLANK    FTPGMQ                          S01435
     C                     MOVEL*BLANK    FTMSGQ                          S01435
     C                     MOVEL*BLANK    FTMSGT                          S01435
      *================================================================   S01435
     CSR         FTEXIT    ENDSR                                          S01435
     C/EJECT
      *****************************************************************   S01494
      *                                                               *   S01494
      *  #LADDI   : Access additional information for the transaction *   S01494
      *                                                               *   S01494
      *  CALLED BY: CCPROC                                            *   S01494
      *                                                               *   S01494
      *  CALLS    : *NONE                                             *   S01494
      *                                                               *   S01494
      *****************************************************************   S01494
     C/EJECT                                                              S01494
     C           #LADDI    BEGSR                                          S01494
     C*          ******    *****                                          S01494
     C*                                                                   S01494
     C** Initialise screen fields                                         S01494
     C*                                                                   S01494
     C                     MOVE *BLANKS   SUSRP1                          S01494
     C                     MOVE *BLANKS   SUSER1                          S01494
     C                     MOVE *BLANKS   SUSRP2                          S01494
     C                     MOVE *BLANKS   SUSER2                          S01494
     C                     MOVE *BLANKS   SAUP1                           S01494
     C                     MOVE *BLANKS   SAUT1                           S01494
     C                     MOVE *BLANKS   SAUP2                           S01494
     C                     MOVE *BLANKS   SAUT2                           S01494
     C                     MOVE *BLANKS   SNMIR                           S01494
     C                     MOVE *BLANKS   SNMOR                           S01494
     C*                                                                   S01494
     C** Retrieve the user profile names of the input users 1 & 2 and     S01494
     C** authorising users 1 & 2 from MUSERDD                             S01494
     C*                                                                   S01494
     C                     MOVELINUSR1    SUSRP1                          S01494
     C           INUSR1    IFNE *BLANKS                                   S01494
     C           INUSR1    CHAINMUSER                82                   S01494
     C           *IN82     IFEQ '1'                                       S01494
     C           *IN82     OREQ '0'                                       074810
     C           RECI      ANDNE'D'                                       074810
     C                     MOVELWM2510    SUSER1                          S01494
     C                     ELSE                                           S01494
     C                     MOVELUSER1     SUSER1                          S01494
     C                     END                                            S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C                     MOVELINUSR2    SUSRP2                          S01494
     C           INUSR2    IFNE *BLANKS                                   S01494
     C           INUSR2    CHAINMUSER                82                   S01494
     C           *IN82     IFEQ '1'                                       S01494
     C           *IN82     OREQ '0'                                       074810
     C           RECI      ANDNE'D'                                       074810
     C                     MOVELWM2510    SUSER2                          S01494
     C                     ELSE                                           S01494
     C                     MOVELUSER1     SUSER2                          S01494
     C                     END                                            S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C                     MOVELAUP1      SAUP1                           S01494
     C           AUP1      IFNE *BLANKS                                   S01494
     C           AUP1      CHAINMUSER                82                   S01494
     C           *IN82     IFEQ '1'                                       S01494
     C           *IN82     OREQ '0'                                       074810
     C           RECI      ANDNE'D'                                       074810
     C                     MOVELWM2510    SAUT1                           S01494
     C                     ELSE                                           S01494
     C                     MOVELUSER1     SAUT1                           S01494
     C                     END                                            S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C                     MOVELAUP2      SAUP2                           S01494
     C           AUP2      IFNE *BLANKS                                   S01494
     C           AUP2      CHAINMUSER                82                   S01494
     C           *IN82     IFEQ '1'                                       S01494
     C           *IN82     OREQ '0'                                       074810
     C           RECI      ANDNE'D'                                       074810
     C                     MOVELWM2510    SAUT2                           S01494
     C                     ELSE                                           S01494
     C                     MOVELUSER1     SAUT2                           S01494
     C                     END                                            S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C** Retrieve MIR and MOR of the transaction from MEINCRPD            S01494
     C*                                                                   S01494
     C           INMSGR    IFNE *ZEROS                                    S01494
     C           INMSGR    CHAINMEINCRL1             82                   S01494
     C           *IN82     IFEQ '1'                                       S01494
     C                     MOVELWM2519    SNMIR                           S01494
     C                     MOVELWM2519    SNMOR                           S01494
     C                     ELSE                                           S01494
     C                     MOVELCRMIR     SNMIR                           S01494
     C                     MOVELCRMOR     SNMOR                           S01494
     C                     END                                            S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C/COPY WNCPYSRC,FT0050C126
     C                     EXFMTFT0050F2                                  S01494
     C*                                                                   S01494
     C************INKC     IFEQ '0'                                S01494 074812
     C           *INKL     IFEQ '1'                                       074812
     C                     MOVE '0'       *INKL                           S01494
     C***********          WRITE#MSGCTL                            S01494 074812
     C***********          EXFMTFT0050F1                           S01494 074812
     C                     END                                            S01494
     C*                                                                   S01494
     C                     ENDSR                                          S01494
     C*                                                                   S01494
     C           EISWFT    BEGSR
     C*          ******    *****
     C*
     C*****************************************************************
     C*                 EI-SWIFT-TRN-PROCESSING                       *
     C*                                                               *
     C*  FUNCTION : TO ACCESS THE SWIFT MESSAGE RELATING TO THE SWIFT *
     C*             TRN ENTERED & TO SET UP THE DETAIL SCREEN FIELDS  *
     C*             FROM THIS MESSAGE.                                *
     C*                                                               *
     C*  CALLS :    SEARCH                                            *
     C*                                                               *
     C*  CALLED BY: CCPROC                                            *
     C*                                                               *
     C*****************************************************************
      *                                                                   S01428
      * Bypass if FT0050 called from enquiry function                     S01435
      *                                                                   S01435
     C           @PREF     IFEQ *BLANKS                                   S01435
      *                                                                   S01435
      * If Electronic Message Processing is not active then               S01428
      * determine if a '?' or a swift reference has been entered.         S01428
      *                                                                   S01428
     C           @EMSG     IFEQ ' '                                       S01428
     C***********          EXSR MSGKEY                              S01428S01435
     C                     EXSR SRMKEY                                    S01435
      *                                                                   S01428
      * If a '?' was entered and an electronic message was selected       S01428
      * or a valid swift reference was entered then continue with the     S01428
      * validation of the swift reference.                                S01428
      *                                                                   S01428
      * BUT, if a message was not selected or the entered swift           S01428
      * reference is not available for use then IN75 is on - bypass       S01428
      * swift reference validation and re-display the initial screen.     S01428
      *                                                                   S01428
      * If the keyed swift reference was not found or invalid then the    S01428
      * condition will be picked up in the validation section of this     S01428
      * sub-routine. At this stage *IN75 will be '0'.                     S01428
      *                                                                   S01428
     C           *IN75     IFEQ '1'                                       S01428
     C           FTNOUP    ORNE *BLANKS                                   S01435
     C                     GOTO EIEND                                     S01428
     C                     END                                            S01428
      *                                                                   S01428
     C                     END                                            S01428
      *                                                                   S01435
     C                     END                                            S01435
     C*
     C**CLEAR*ARRAY*USED*FOR*SWIFT*MESSAGES*THEN*LOAD*FROM*MSIME*         S01259
     C**CLEAR*ARRAY USED FOR SWIFT MESSAGES THEN LOAD FROM MSMSI2L9 S01259S01435
     C***********                                                   S01259S01435
     C***********          MOVE *BLANK    SDT                             S01435
      ***********                                                         S01435
     C***********SSWTN*****CHAINMSIME                77                   S01259
      **SAVE*MESSAGE*TYPE*FROM FIRST RECORD OF MESSAGE                    S01259
     C*********************MOVE STYP1     STYPE   3                       S01259
      ***********                                                   S01259S01435
     C***********SSWTN     CHAINMSMSI2L9             77             S01259S01435
      ***********                                                   S01259S01435
     C***********ACNK      IFNE *BLANKS                    B001     S01259S01435
     C***********          SETON                     77             S01259S01435
     C***********          END                             E001     S01259S01435
      ***********                                                   S01259S01435
      **SAVE*MESSAGE TYPE FROM FIRST RECORD OF MESSAGE              S01259S01435
      ***********                                                   S01259S01435
     C***********          MOVE MTPY      STYPE   3                 S01259S01435
      ***********                                                   055293S01435
      **Store*in*INPAY file fields message type and transaction no. 055293S01435
      ***********                                                   055293S01435
     C***********          MOVE MTPY      INMTPY                    055293S01435
     C***********          MOVE TRNO      INTRNO                    055293S01435
     C***********                                                         S01435
     C**IF*NO*RECORD FOUND ERROR                                          S01435
     C***********                                                         S01435
     C************IN77     IFEQ '1'                        B001           S01435
      ***********                                                         S01435
      ****If*sequence number not entered Type must be 202 or 100.         S01435
      ***********                                                         S01435
     C***********SSEQNO    OREQ 0                                         S01435
     C***********STYPE     ANDNE'100'                                     S01435
     C***********STYPE     ANDNE'202'                                     S01435
      ***********                                                         S01435
      ****If*sequence number entered Type must be 203                     S01435
      ***********                                                         S01435
     C***********SSEQNO    ORGT 0                                         S01435
     C***********STYPE     ANDNE'203'                                     S01435
      ***********                                                         S01435
     C***********          SETON                     42                   S01435
     C***********          ADD  1         I                               S01435
      ***********                                                         S01435
      ***Set*appropriate error code.                                      S01435
      ***********                                                         S01435
     C************IN77     IFEQ '1'                                       S01435
     C*********************MOVE ' 332'    ERCD,I                          S01117
     C***********          MOVE ' 012'    ERCD,I                    S01117S01435
     C***********          ELSE                                           S01435
      ***********                                                         S01435
     C***********SSEQNO    IFEQ 0                                         S01435
     C*********************MOVE ' 333'    ERCD,I                          S01117
     C***********          MOVE ' 013'    ERCD,I                    S01117S01435
     C***********          ELSE                                           S01435
     C*********************MOVE ' 388'    ERCD,I                          S01117
     C***********          MOVE ' 016'    ERCD,I                    S01117S01435
     C***********          SETON                       59  Highlight both S01435
      ***********                                          ref and seq.   S01435
     C***********          END                                            S01435
      ***********                                                         S01435
     C***********          END                                            S01435
      ***********                                                         S01435
     C***********          GOTO EIEND                                     S01435
     C***********          END                             E001           S01435
      ***********                                                         S01435
     C***********          MOVE SSEQNO    B                               S01435
      ***********                                                         S01435
     C************IN77     IFEQ '0'                        B001           S01435
     C***********MSPF******ANDEQ'Y'                                 E20864E29837
     C***********                                                   E29837S01435
     C***********FTPF      IFEQ 'Y'                        B002     E29837S01435
     C***********B         ORNE 0                                   E29837S01435
     C***********FTPS,B    ANDEQ'Y'                                 E29837S01435
     C***********          SETON                     42                   S01435
     C***********          ADD  1         I                               S01435
     C*********************MOVE ' 402'    ERCD,I                          S01117
     C***********          MOVE ' 079'    ERCD,I                    S01117S01435
     C***********          GOTO EIEND                                     S01435
     C***********          END                             E002     E29837S01435
     C***********                                                   E29837S01435
     C***********          END                             E001           S01435
      *                                                                   S01435
      * Bypass if FT0050 called from enquiry function                     S01435
      *                                                                   S01435
     C           @PREF     IFEQ *BLANKS                                   S01435
      *                                                                   S01428
      *  If the swift reference is valid then reserve it on file. A       S01428
      *  reserved message may not be selected by any other work           S01428
      *  station.                                                         S01428
      *                                                                   S01428
      *  N.B. If*Electronic Message Processing is active then a           S01428
      *       reservation does not need to be made as it was done         S01428
      *       when the message was initially selected.                    S01428
      *                                                                   S01428
     C           @EMSG     IFEQ ' '                                       S01428
     C                     EXSR MSGRSV                                    S01428
      *                                                                   S01428
      *  If the swift reference is already allocated to another job       S01428
      *  then re-display initial screen.                                  S01428
      *                                                                   S01428
     C           *IN75     IFEQ '1'                                       S01428
     C           FTNOUP    ORNE *BLANKS                                   S01435
     C                     GOTO EIEND                                     S01428
     C                     END                                            S01428
      *                                                                   S01428
     C                     END                                            S01428
      *                                                                   S01435
     C                     END                                            S01435
      * Receiver's charges currency number of decimal positions           CFT014
     C           *LIKE     DEFN WCYNDP    RCNBDP                          CFT014
      * Transaction amt currency number of decimal positions              CFT014
     C           *LIKE     DEFN WCYNDP    TRNBDP                          CFT014
      *                                                                   S01435
      * Call ME1100 to translate the data of the messages for FT fields   S01435
      *                                                                   S01435
     C                     CALL 'ME1100'               8080               S01435
     C                     PARM '*TRANS  '#ACT    8        Action         S01435
     C                     PARM           PHEAD            General DetailsS01435
     C                     PARM *BLANKS   PDATA            Message DetailsS01435
     C                     PARM *BLANKS   PDAT2            MsgDetlExt'n                       CSW209
     C                     PARM *BLANKS   RTN     7        Return Code    S01435
     C/COPY WNCPYSRC,FT0050C127
      *                                                                   S01435
      *  If call to program resulted in an error then end program.        S01435
      *                                                                   S01435
     C           RTN       IFEQ '*ERROR*'                                 S01435
     C           *IN80     OREQ '1'                                       S01435
     C                     Z-ADD60        W0ERNB           ************   S01435
     C                     MOVEL'*CALL   'W0FILE           *DB ERR 60 *   S01435
     C                     MOVEL*BLANKS   W0KEY            ************   S01435
     C                     MOVEL'ME1100'  W0KEY                           S01435
     C                     MOVELERR@,1    W0NARR                          S01435
     C                     EXSR SRERR                                     S01435
     C                     END                                            S01435
      *                                                                   S01435
      * Set up the detail screen fields from the message.                 S01435
      *                                                                   S01435
      * Sender                                                            S01435
     C                     MOVELPSNDR     SSND1                           S01435
      *                                                                   S01435
     C           PSN       IFNE *BLANKS                                   S01435
     C                     MOVELPSN       DSTRAN                          S01435
     C           PSNDR     IFEQ 'CASHIER'                                 140655
     C                     MOVELPSNAR,1   TMLIN2                          CRT002
     C                     END                                            140655
     C                     MOVELTMLIN1    SSND1                           S01435
     C                     MOVELTMLIN2    SSND2                           S01435
     C                     MOVELTMLIN3    SSND3                           S01435
     C                     MOVELTMLIN4    SSND4                           S01435
     C                     END                                            S01435
     C/COPY WNCPYSRC,FT0050C040
      *                                                                   S01435
      * Message type                                                      S01435
      *                                                                   S01435
     C                     MOVE PMTPY     INMTPY                          S01435
      *                                                                   S01435
      * Msg Unique Reference                                              S01435
     C                     Z-ADDPHMSGR    INMSGR                          S01435
      *                                                                   S01435
      * Swift Reference                                                   S01435
     C                     MOVELPHMIR     SSWTN                           S01435
      *                                                                   S01435
      * Part Number                                                       S01435
     C                     Z-ADDPHPART    SSEQNO                          S01435
     C                     Z-ADDPHPART    INKPRT                          S01435
      *                                                                   S01435
      * Swift Priority Code                                               S01435
     C                     MOVE PMPRY     SSWPC                           S01435
      *                                                                   S01435
      * Branch Code                                                       S01435
     C           PBRCA     IFNE *BLANKS                                   S01435
     C                     MOVELPBRCA     SBRCA                           S01435
     C                     END                                            S01435
      *                                                                   S01435
      * Transaction Reference no.                                         S01435
      *                                                                   S01435
     C           P20       IFNE *BLANKS                                   S01435
     C                     MOVELP20       DSTRAN                          S01435
     C                     MOVELTTREF     INTRNO                          S01435
     C                     ELSE                                           S01435
     C                     MOVEL*BLANKS   INTRNO                          S01435
     C                     END                                            S01435
      *                                                                   S01435
      * Related Reference                                                 S01435
      *                                                                   S01435
     C           P21       IFNE *BLANKS                                   S01435
     C                     MOVELP21       DSTRAN                          S01435
     C                     MOVELTTREF     RLPR                            S01435
     C                     ELSE                                           S01435
     C                     MOVEL*BLANKS   RLPR                            S01435
     C                     END                                            S01435
      *                                                                   CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
      *                                                                   CFT014
      ** Sender's Charge field                                            CFT014
     C           P71FX     IFNE *BLANKS                                   CFT014
     C                     MOVEL*BLANK    DSTRAN                          CFT014
     C                     MOVELP71FX     DSTRAN                          CFT014
     C                     Z-ADD1         L       20                      CFT014
     C                     MOVELTMLIN1    TV1                             CFT014
     C                     MOVELTMLIN2    TV2                             CFT014
     C                     MOVELTMLIN3    TV3                             CFT014
     C                     MOVELTMLIN4    TV4                             CFT014
     C                     MOVELTMLIN5    TV5                             CFT014
     C           L         DOWLE5                                         CFT014
     C           LFLT,L    ANDNE*BLANK                                    CFT014
     C                     MOVEL*BLANK    DSTRAN                          CFT014
     C                     MOVELLFLT,L    DSTRAN                          CFT014
     C                     EXSR RTPCA                                     CFT014
      *                                                                   CFT014
     C                     MOVELWCACY     WCYCCY                          CFT014
     C                     MOVEL'N'       WCYDMP                          CFT014
     C                     EXSR SRCCYD                                    CFT014
      *                                                                   CFT014
     C           WCYRTN    IFEQ *BLANK                                    CFT014
     C                     MOVE WCAAM     ZFIELD                          CFT014
     C           13        SUB  WCYNDP    ZADIG                           CFT014
     C                     Z-ADDWCYNDP    ZADEC                           CFT014
     C                     EXSR ZALIGN                                    CFT014
     C                     MOVE ZFIELD    CGA,L                           CFT014
     C                     MOVELWCACY     CGC,L                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ADD  1         L                               CFT014
     C                     ENDDO                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Receiver's Charge field                                          CFT014
     C           P71G      IFNE *BLANKS                                   CFT014
     C                     MOVEL*BLANK    DSTRAN                          CFT014
     C                     MOVEL'N'       MGRCUS                          CFT014
     C                     MOVELP71G      DSTRAN                          CFT014
     C                     EXSR RTPCA                                     CFT014
     C           *LIKE     DEFN WCACY     WRCHCY                          CFT014
     C           *LIKE     DEFN WCAAM     WRCHAM                          CFT014
      ** Memorize receiver's charges currency / amount                    CFT014
      ** to pass as input parameter to S/R OV32AM                         CFT014
     C                     MOVELWCACY     WRCHCY                          CFT014
     C                     MOVELWCAAM     WRCHAM                          CFT014
     C                     MOVELWCACY     WCYCCY                          CFT014
     C                     MOVEL'N'       WCYDMP                          CFT014
     C                     EXSR SRCCYD                                    CFT014
      *                                                                   CFT014
     C           WCYRTN    IFEQ *BLANK                                    CFT014
     C                     MOVE WCAAM     ZFIELD                          CFT014
     C           13        SUB  WCYNDP    ZADIG                           CFT014
     C                     Z-ADDWCYNDP    ZADEC                           CFT014
     C                     EXSR ZALIGN                                    CFT014
     C                     MOVE ZFIELD    MGRCNW                          CFT014
     C                     MOVELWCACY     MGRCCN                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   S01435
      * Value Date/Ccy/Amount                                             S01435
      *                                                                   S01435
     C           PDCA      IFNE *BLANKS                                   S01435
     C                     MOVELPDCA      DSTRAN                          S01435
      *                                                                   S01435
      * MMDDYY format display                                             S01435
      *                                                                   S01435
     C           *IN98     IFEQ '1'                                       S01435
     C                     MOVELTVVDAT    SWDT                            S01435
     C                     MOVE SDD       DD      20                      S01435
     C                     MOVE SYY       SDD                             S01435
     C                     MOVE SMM       SYY                             S01435
     C                     MOVE DD        SMM                             S01435
     C                     MOVE SWDT      SSLDT                           S01435
     C                     ELSE                                           S01435
      *                                                                   S01435
      * DDMMYY format display                                             S01435
      *                                                                   S01435
     C                     MOVELTVVDAT    SWDT                            S01435
     C                     MOVE SDD       DD                              S01435
     C                     MOVE SYY       SDD                             S01435
     C                     MOVE DD        SYY                             S01435
     C                     MOVE SWDT      SSLDT                           S01435
     C                     END                                            S01435
      *                                                                   S01435
      * Currency                                                          S01435
      *                                                                   S01435
     C                     MOVELTVCCY     SSMCY                           S01435
      *                                                                   CGL009
     C           PNWRK     IFNE 'FONTIS'                                  CGL009
      * Amount                                                            S01435
      *                                                                   S01435
      * Format amount field (change ',' decimal point to '.').            S01435
      *                                                                   S01435
     C                     MOVEATVAMT     YA1                             S01435
     C                     Z-ADD1         C       30                      S01435
      *                                                                   S01435
     C           C         DOUGT15                                        S01435
      *                                                                   S01435
     C           YA1,C     IFEQ ','                                       S01435
     C                     MOVE '.'       YA1,C                           S01435
     C                     Z-ADD16        C                               S01435
     C                     ELSE                                           S01435
     C                     ADD  1         C                               S01435
     C                     END                                            S01435
      *                                                                   S01435
     C                     END                                            S01435
      *                                                                   S01435
     C                     MOVEAYA1       AMT    15                       S01435
     C           CFT014    IFEQ 'Y'                                       CFT014
     C           P71G      ANDNE*BLANK                                    CFT014
      ** Need to overwrite transaction amount to allow for the            CFT014
      ** receiver's charges                                               CFT014
     C                     MOVELSWDT      ZDATE                           CFT014
     C                     EXSR ZDATE1                                    CFT014
     C                     Z-ADDZDAYNO    WOVVLD                          CFT014
     C                     MOVELSSMCY     WOVICY                          CFT014
     C                     MOVELAMT       WOVIAM                          CFT014
     C                     MOVELWRCHCY    WOVRCY                          CFT014
     C                     MOVELWRCHAM    WOVRAM                          CFT014
     C                     MOVEL'*SUB'    WOVOPR                          CFT014
     C                     EXSR OV32AM                                    CFT014
     C                     MOVELWOVAMT    SSMAM                           CFT014
     C                     ELSE                                           CFT014
     C                     MOVELAMT       SSMAM                           S01435
     C                     ENDIF                                          CFT014
      *                                                                   CGL009
     C                     ENDIF                                          CGL009
      *                                                                   S01435
     C                     END                                            S01435
      *                                                                   S01435
     C/COPY WNCPYSRC,FT0050C108
      * Ordering Customer                                                 S01435
      *                                                                   S01435
     C           P50       IFNE *BLANKS                                   S01435
     C                     MOVELP50       DSTRAN                          S01435
     C                     MOVELTMLIN1    ORC1                            S01435
     C                     MOVELTMLIN2    ORC2                            S01435
     C                     MOVELTMLIN3    ORC3                            S01435
     C                     MOVELTMLIN4    ORC4                            S01435
     C                     MOVELTMLIN5    ORC5                                                CFT032
     C                     ELSE                                           S01435
     C                     MOVEL*BLANKS   ORCT                            S01435
     C                     MOVEL*BLANKS   ORC1                            S01435
     C                     MOVEL*BLANKS   ORC2                            S01435
     C                     MOVEL*BLANKS   ORC3                            S01435
     C                     MOVEL*BLANKS   ORC4                            S01435
     C                     MOVEL*BLANKS   ORC5                                                CFT032
     C                     END                                            S01435
      *                                                                   S01435
      * Ordering Institution                                              S01435
      *                                                                   S01435
     C           P52       IFNE *BLANKS                                   S01435
     C                     MOVELP52       DSTRAN                          S01435
     C                     MOVELTMLIN1    ORB1                            S01435
     C                     MOVELTMLIN2    ORB2                            S01435
     C                     MOVELTMLIN3    ORB3                            S01435
     C                     MOVELTMLIN4    ORB4                            S01435
     C                     MOVELTMLIN5    ORB5                            S01435
     C                     ELSE                                           S01435
     C                     MOVEL*BLANKS   ORBT                            S01435
     C                     MOVEL*BLANKS   ORB1                            S01435
     C                     MOVEL*BLANKS   ORB2                            S01435
     C                     MOVEL*BLANKS   ORB3                            S01435
     C                     MOVEL*BLANKS   ORB4                            S01435
     C                     MOVEL*BLANKS   ORB5                            S01435
     C                     END                                            S01435
      *                                                                   S01435
      * Senders Correspondent                                             S01435
      *                                                                   S01435
     C           P53       IFNE *BLANKS                                   S01435
     C                     MOVELP53       DSTRAN                          S01435
     C                     MOVELTMLIN1    SNC1                            S01435
     C                     MOVELTMLIN2    SNC2                            S01435
     C                     MOVELTMLIN3    SNC3                            S01435
     C                     MOVELTMLIN4    SNC4                            S01435
     C                     MOVELTMLIN5    SNC5                            S01435
     C                     ELSE                                           S01435
     C                     MOVEL*BLANKS   SNCT                            S01435
     C                     MOVEL*BLANKS   SNC1                            S01435
     C                     MOVEL*BLANKS   SNC2                            S01435
     C                     MOVEL*BLANKS   SNC3                            S01435
     C                     MOVEL*BLANKS   SNC4                            S01435
     C                     MOVEL*BLANKS   SNC5                            S01435
     C                     END                                            S01435
      *                                                                   S01435
      * Receivers Correspondent                                           S01435
      *                                                                   S01435
     C           P54       IFNE *BLANKS                                   S01435
     C                     MOVELP54       DSTRAN                          S01435
     C***********          MOVELTMLIN1    SRCCO                    S01435 CFT014
     C                     MOVELTMLIN     SRCCO                           CFT014
     C                     MOVELTMLIN1    INRCO1                          S01435
     C                     MOVELTMLIN2    INRCO2                          S01435
     C                     MOVELTMLIN3    INRCO3                          S01435
     C                     MOVELTMLIN4    INRCO4                          S01435
     C                     MOVELTMLIN5    INRCO5                          S01435
      *                                                                   S01435
      * If network is swift, find field type                              S01435
      * otherwise default it to 'U'.                                      S01435
      *                                                                   S01435
     C           PNWRK     IFEQ 'SWIFT '                                  S01435
      *                                                                   S01435
      * Set up field type, if A->S, B->T, D->U                            S01435
      *                                                                   S01435
     C           1         SUBSTTRTAG:4   #WK1    1                       S01435
     C           #WK1      IFEQ 'A'                                       S01435
     C                     MOVEL'S'       INRCRT                          S01435
     C                     ELSE                                           S01435
      *                                                                   S01435
     C           #WK1      IFEQ 'B'                                       S01435
     C                     MOVEL'T'       INRCRT                          S01435
     C                     ELSE                                           S01435
     C                     MOVEL'U'       INRCRT                          S01435
     C                     END                                            S01435
     C                     END                                            S01435
      *                                                                   S01435
     C                     ELSE                                           S01435
      *                                                                   S01435
      * network is not swift                                              S01435
     C                     MOVEL'U'       INRCRT                          S01435
     C                     END                                            S01435
      *                                                                   S01435
     C                     ELSE                                           S01435
     C                     MOVEL*BLANKS   INRCRT                          S01435
     C                     MOVEL*BLANKS   INRCO1                          S01435
     C                     MOVEL*BLANKS   INRCO2                          S01435
     C                     MOVEL*BLANKS   INRCO3                          S01435
     C                     MOVEL*BLANKS   INRCO4                          S01435
     C                     MOVEL*BLANKS   INRCO5                          S01435
     C                     END                                            S01435
      *                                                                   S01435
      * Intermediary                                                      S01435
      *                                                                   S01435
     C           P56       IFNE *BLANKS                                   S01435
     C                     MOVELP56       DSTRAN                          S01435
     C                     MOVELTMLIN1    INB1                            S01435
     C                     MOVELTMLIN2    INB2                            S01435
     C                     MOVELTMLIN3    INB3                            S01435
     C                     MOVELTMLIN4    INB4                            S01435
     C                     MOVELTMLIN5    INB5                            S01435
     C                     ELSE                                           S01435
     C                     MOVEL*BLANKS   INBT                            S01435
     C                     MOVEL*BLANKS   INB1                            S01435
     C                     MOVEL*BLANKS   INB2                            S01435
     C                     MOVEL*BLANKS   INB3                            S01435
     C                     MOVEL*BLANKS   INB4                            S01435
     C                     MOVEL*BLANKS   INB5                            S01435
     C                     END                                            S01435
      *                                                                   S01435
      * Account with Institution                                          S01435
      *                                                                   S01435
     C           P57       IFNE *BLANKS                                   S01435
     C                     MOVELP57       DSTRAN                          S01435
     C                     MOVELTMLIN1    SACBK                           S01435
     C                     MOVELTMLIN1    INACB1                          S01435
     C                     MOVELTMLIN2    INACB2                          S01435
     C                     MOVELTMLIN3    INACB3                          S01435
     C                     MOVELTMLIN4    INACB4                          S01435
     C                     MOVELTMLIN5    INACB5                          S01435
      *                                                                   S01435
      * If network is swift, find field type                              S01435
      * otherwise default it to 'U'.                                      S01435
      *                                                                   S01435
     C           PNWRK     IFEQ 'SWIFT '                                  S01435
      *                                                                   S01435
      * Set up field type, if A->S, B->T, D->U                            S01435
      *                                                                   S01435
     C           1         SUBSTTRTAG:4   #WK1                            S01435
     C           #WK1      IFEQ 'A'                                       S01435
     C                     MOVEL'S'       INACBT                          S01435
     C                     ELSE                                           S01435
      *                                                                   S01435
     C           #WK1      IFEQ 'B'                                       S01435
     C                     MOVEL'T'       INACBT                          S01435
     C                     ELSE                                           S01435
     C                     MOVEL'U'       INACBT                          S01435
     C                     END                                            S01435
     C                     END                                            S01435
      *                                                                   S01435
     C                     ELSE                                           S01435
      *                                                                   S01435
      * network is not swift                                              S01435
     C                     MOVEL'U'       INACBT                          S01435
     C                     END                                            S01435
      *                                                                   S01435
     C                     ELSE                                           S01435
     C                     MOVEL*BLANKS   INACBT                          S01435
     C                     MOVEL*BLANKS   INACB1                          S01435
     C                     MOVEL*BLANKS   INACB2                          S01435
     C                     MOVEL*BLANKS   INACB3                          S01435
     C                     MOVEL*BLANKS   INACB4                          S01435
     C                     MOVEL*BLANKS   INACB5                          S01435
     C                     END                                            S01435
      *                                                                   S01435
      * Beneficiary Institution/ Beneficiary Customer                     S01435
      *                                                                   S01435
     C           P58       IFNE *BLANKS                                   S01435
     C                     MOVELP58       DSTRAN                          S01435
     C                     MOVELTMLIN1    SBNC1                           S01435
     C                     MOVELTMLIN2    SBNC2                           S01435
     C                     MOVELTMLIN3    SBNC3                           S01435
     C                     MOVELTMLIN4    SBNC4                           S01435
     C                     MOVELTMLIN5    SBNC5                           S01435
     C                     END                                            S01435
      *                                                                   S01435
     C           P59       IFNE *BLANKS                                   S01435
     C                     MOVELP59       DSTRAN                          S01435
     C                     MOVELTMLIN1    SBNC1                           S01435
     C                     MOVELTMLIN2    SBNC2                           S01435
     C                     MOVELTMLIN3    SBNC3                           S01435
     C                     MOVELTMLIN4    SBNC4                           S01435
     C                     MOVELTMLIN5    SBNC5                           S01435
     C                     END                                            S01435
      *                                                                   S01435
      * Details of Payment                                                S01435
      *                                                                   S01435
     C           P70       IFNE *BLANKS                                   S01435
     C                     MOVELP70       DSTRAN                          S01435
     C                     MOVELTMLIN1    DTP1                            S01435
     C                     MOVELTMLIN2    DTP2                            S01435
     C                     MOVELTMLIN3    DTP3                            S01435
     C                     MOVELTMLIN4    DTP4                            S01435
     C                     ELSE                                           S01435
     C                     MOVEL*BLANKS   DTP1                            S01435
     C                     MOVEL*BLANKS   DTP2                            S01435
     C                     MOVEL*BLANKS   DTP3                            S01435
     C                     MOVEL*BLANKS   DTP4                            S01435
     C                     END                                            S01435
      *                                                                   S01435
      * Details of Charges                                                S01435
      *                                                                   S01435
     C           P71       IFNE *BLANKS                                   S01435
     C                     MOVELP71       DSTRAN                          S01435
     C                     MOVELTTREF     DTCH                            S01435
     C           CFT014    IFEQ 'Y'                                       CFT014
     C           TTREF     IFEQ 'OUR'                                     CFT014
     C                     MOVEL'A'       SADDC                           CFT014
     C                     ELSE                                           CFT014
     C                     MOVEL'D'       SADDC                           CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
     C                     ELSE                                           S01435
     C                     MOVEL*BLANKS   DTCH                            S01435
     C                     END                                            S01435
      *                                                                   S01435
      * Bank to Bank Information                                          S01435
      *                                                                   S01435
      ** Access Settle currency details from SDCURRPD                     CEU006
      *                                                                   CEU006
     C                     CALL 'AOCURRR0'                                CEU006
      *                                                                   CEU006
      ** Call to AOCURRPD altered to remove possiblity of database        CEU006
      ** if mapped currency is not a Midas currency.                      CEU006
      *                                                                   CEU006
     C***********          PARM '*DBERR ' @RTCD   7                 CEU006150204
     C                     PARM '       ' @RTCD   7                       150204
     C                     PARM '*KEY   ' @OPTN   7                       CEU006
     C                     PARM SSMCY     @CCY    3                       CEU006
     C           SDCURR    PARM SDCURR    DSSDY                           CEU006
      *                                                                   CEU006
     C           P72       IFNE *BLANKS                                   S01435
     C                     MOVELP72       DSTRAN                          S01435
     C                     MOVELTMLIN1    BBI1                            S01435
     C                     MOVELTMLIN2    BBI2                            S01435
     C                     MOVELTMLIN3    BBI3                            S01435
     C                     MOVELTMLIN4    BBI4                            S01435
     C                     MOVELTMLIN5    BBI5                            S01435
     C                     MOVELTMLIN6    BBI6                            S01435
      **  For MT103 FT field Notified Ccy/Amount is renamed as            CFT014
      **  Instructed Ccy/Amount.                                          CFT014
      **  The validation of this field will be changed                    CFT014
      **  accordingly.                                                    CFT014
     C           P33B      IFEQ *BLANK                                    CFT014
     C*                                                                   CEU006
     C           '/OCMT/'  SCAN P72       OCMT    30                      CEU006
     C*                                                                   CEU006
     C           OCMT      IFNE 0                                         CEU006
     C*                                                                   CEU006
     C*********************EXSR FOCMT                               CEU006140623
     C                     MOVEL'/OCMT/'  WCW                             CGL009
     C                     MOVELP72       WCWLIN                          CGL009
     C                     EXSR FOCMT2                                    140623
     C                     MOVELWCWCY     SNDCY                           CGL009
     C                     MOVELWCWAM     SNDAM                           CGL009
     C*                                                                   CEU006
     C                     ELSE                                           CEU006
     C*                                                                   CEU006
     C***********A6INCY****IFEQ 'Y'                                 CEU006CFT003
     C*********************MOVE SSMCY     SNDCY                     CEU006CFT003
     C*********************MOVE SSMAM     SNDAM                     CEU006CFT003
     C*********************ELSE                                     CEU006CFT003
     C                     MOVE *BLANKS   SNDCY                           CEU006
     C                     MOVE *BLANKS   SNDAM                           CEU006
     C*********************ENDIF                                    CEU006CFT003
     C*                                                                   CEU006
     C                     ENDIF                                          CEU006
     C*                                                                   CFT014
     C                     ENDIF                                          CFT014
     C*                                                                   CEU006
     C                     ELSE                                           S01435
     C*                                                                   CEU006
     C***********A6INCY****IFEQ 'Y'                                 CEU006CFT003
     C*********************MOVE SSMCY     SNDCY                     CEU006CFT003
     C*********************MOVE SSMAM     SNDAM                     CEU006CFT003
     C*********************ELSE                                     CEU006CFT003
     C                     MOVE *BLANKS   SNDCY                           CEU006
     C                     MOVE *BLANKS   SNDAM                           CEU006
     C*********************ENDIF                                    CEU006CFT003
     C*                                                                   CEU006
     C                     MOVEL*BLANKS   BBI1                            S01435
     C                     MOVEL*BLANKS   BBI2                            S01435
     C                     MOVEL*BLANKS   BBI3                            S01435
     C                     MOVEL*BLANKS   BBI4                            S01435
     C                     MOVEL*BLANKS   BBI5                            S01435
     C                     MOVEL*BLANKS   BBI6                            S01435
     C                     END                                            S01435
      *                                                                   S01435
      * Set other fields to blanks or zero.                               S01435
      *                                                                   S01435
     C                     MOVEL*BLANK    OPIN                            S01435
     C/COPY WNCPYSRC,FT0050C092
     C                     Z-ADD*ZERO     DNBC                            S01435
     C/COPY WNCPYSRC,FT0050C093
     C                     MOVEL*BLANKS   TRCT                            S01435
     C                     Z-ADD*ZERO     TRCM                            S01435
     C                     Z-ADD*ZERO     TRCMD                           S01435
     C                     Z-ADD*ZERO     TXCH                            S01435
     C                     Z-ADD*ZERO     TXCHD                           S01435
     C                     Z-ADD*ZERO     CQCHD                           S01435
     C/COPY WNCPYSRC,FT0050C183
     C                     Z-ADD*ZERO     ADCH                            S01435
     C                     Z-ADD*ZERO     ADCHD                           S01435
     C/COPY WNCPYSRC,FT0050C184
     C                     Z-ADD*ZERO     TLCH                            S01435
     C                     Z-ADD*ZERO     TLCHD                           S01435
     C                     Z-ADD*ZERO     MSCH                            S01435
     C                     Z-ADD*ZERO     MSCHD                           S01435
     C                     MOVEL*BLANKS   CDRT                            S01435
     C************         Z-ADD*ZERO     CDRO                            S01435              CSD027
     C                     MOVE *BLANKS   CDRO                                                CSD027
     C                     MOVEL*BLANKS   AUP1                            S01435
     C                     MOVEL*BLANKS   AUP2                            S01435
     C                     MOVEL*BLANKS   AUIN                            S01435
     C                     MOVEL*BLANKS   SACG                            S01435
     C                     MOVEL*BLANKS   PACG                            S01435
     C                     MOVEL*BLANKS   SMSG                            S01435
     C                     MOVEL*BLANKS   PMSG                            S01435
     C                     MOVEL*BLANKS   IACG                            S01435
     C                     MOVEL*BLANKS   ADIN                            S01435
     C           S01499    IFEQ 'Y'                                       S01494
     C                     Z-ADD0         INCHCM                          S01494
     C                     END                                            S01494
     C           S01499    IFEQ 'Y'                                       S01499
     C           CFT009    ANDNE'Y'                                       CFT009
     C                     Z-ADD0         INVATT                          S01499
     C                     Z-ADD0         INVATR                          S01499
     C                     MOVE 'Y'       INVAT1                          S01499
     C                     MOVE 'Y'       INVAT2                          S01499
     C                     MOVE 'Y'       INVAT3                          S01499
     C                     MOVE 'Y'       INVAT4                          S01499
     C                     MOVE 'Y'       INVAT5                          S01499
     C                     MOVE 'Y'       INVAT6                          S01499
     C                     MOVE 'Y'       INVAT7                          S01499
     C                     END
      *                                                                   CRT002
      **  Additional Mapping for CASHIER.                                 CRT002
      *                                                                   CRT002
      **  Draft Currency, Draft Amount.                                   CRT002
      *                                                                   CRT002
     C           SDCA      IFNE *BLANKS                                   CRT002
     C                     Z-ADD0         TVVDAT                          CRT002
     C                     MOVELSDCA      DSTRAN                          CRT002
      *                                                                   CRT002
     C           TVVDAT    IFNE 0                                         CRT002
      *                                                                   CRT002
      **  MMDDYY format display.                                          CRT002
      *                                                                   CRT002
     C           WUDFF     IFEQ 'M'                                       CRT002
     C                     MOVELTVVDAT    SWDT1   6                       CRT002
     C           2         SUBSTSWDT1:5   MM                              CRT002
     C           2         SUBSTSWDT1:3   DDS                             CRT002
     C           2         SUBSTSWDT1:1   YY                              CRT002
     C                     MOVELSWDT2     SPYDT                           CRT002
     C                     ELSE                                           CRT002
      *                                                                   CRT002
      **  DDMMYY format display.                                          CRT002
      *                                                                   CRT002
     C                     MOVELTVVDAT    SWDT1   6                       CRT002
     C           2         SUBSTSWDT1:5   DDS                             CRT002
     C           2         SUBSTSWDT1:3   MM                              CRT002
     C           2         SUBSTSWDT1:1   YY                              CRT002
     C                     MOVELSWDT2     SPYDT                           CRT002
     C                     END                                            CRT002
     C                     END                                            CRT002
      *                                                                   CRT002
      **  Currency.                                                       CRT002
      *                                                                   CRT002
     C                     MOVELTVCCY     SPCCY                           CRT002
      *                                                                   CRT002
      **  Format amount field (change ',' decimal point to '.').          CRT002
      *                                                                   CRT002
     C                     MOVEA*BLANKS   YA1                             CRT002
     C                     MOVEATVAMT     YA1                             CRT002
     C                     Z-ADD1         C       30                      CRT002
      *                                                                   CRT002
     C           C         DOUGT15                                        CRT002
     C           YA1,C     IFEQ ','                                       CRT002
     C                     MOVE '.'       YA1,C                           CRT002
     C                     Z-ADD16        C                               CRT002
     C                     ELSE                                           CRT002
     C                     ADD  1         C                               CRT002
     C                     END                                            CRT002
     C                     END                                            CRT002
      *                                                                   CRT002
     C                     MOVEAYA1       AMT    15                       CRT002
     C                     MOVELAMT       SPYAM                           CRT002
     C                     END                                            CRT002
      *                                                                   CRT002
      **  Funding Currency, Funding Amount.                               CRT002
      *                                                                   CRT002
     C           PDC2      IFNE *BLANKS                                   CRT002
     C                     Z-ADD0         TVVDAT                          CRT002
     C                     MOVELPDC2      DSTRAN                          CRT002
      *                                                                   CRT002
     C           TVVDAT    IFNE 0                                         CRT002
      *                                                                   CRT002
      **  MMDDYY format display.                                          CRT002
      *                                                                   CRT002
     C           WUDFF     IFEQ 'M'                                       CRT002
     C                     MOVELTVVDAT    SWDT1   6                       CRT002
     C           2         SUBSTSWDT1:5   MM                              CRT002
     C           2         SUBSTSWDT1:3   DDS                             CRT002
     C           2         SUBSTSWDT1:1   YY                              CRT002
     C                     MOVELSWDT2     SSLDT                           CRT002
     C                     ELSE                                           CRT002
      *                                                                   CRT002
      **  DDMMYY format display.                                          CRT002
      *                                                                   CRT002
     C                     MOVELTVVDAT    SWDT1   6                       CRT002
     C           2         SUBSTSWDT1:5   DDS                             CRT002
     C           2         SUBSTSWDT1:3   MM                              CRT002
     C           2         SUBSTSWDT1:1   YY                              CRT002
     C                     MOVELSWDT2     SSLDT                           CRT002
     C                     END                                            CRT002
     C                     END                                            CRT002
      *                                                                   CRT002
      **  Currency.                                                       CRT002
      *                                                                   CRT002
     C                     MOVELTVCCY     SSMCY                           CRT002
      *                                                                   CRT002
      **  Format amount field (change ',' decimal point to '.').          CRT002
      *                                                                   CRT002
     C                     MOVEA*BLANKS   YA1                             CRT002
     C                     MOVEATVAMT     YA1                             CRT002
     C                     Z-ADD1         C       30                      CRT002
      *                                                                   CRT002
     C           C         DOUGT15                                        CRT002
     C           YA1,C     IFEQ ','                                       CRT002
     C                     MOVE '.'       YA1,C                           CRT002
     C                     Z-ADD16        C                               CRT002
     C                     ELSE                                           CRT002
     C                     ADD  1         C                               CRT002
     C                     END                                            CRT002
     C                     END                                            CRT002
      *                                                                   CRT002
     C                     MOVEAYA1       AMT    15                       CRT002
     C                     MOVELAMT       SSMAM                           CRT002
     C                     END                                            CRT002
      *                                                                   CRT002
      **  Rate.                                                           CRT002
      *                                                                   CRT002
     C           SPYAM     IFNE *BLANKS                                   CRT002
     C           SSMAM     ANDNE*BLANKS                                   CRT002
      *                                                                   CRT002
      **  Get the numeric value of SPYAM.                                 CRT002
      *                                                                   CRT002
     C                     CALL 'AOCURRR0'                                CRT002
     C                     PARM *BLANKS   @RTCD   7                       CRT002
     C                     PARM '*KEY   ' @OPTN   7                       CRT002
     C                     PARM SPCCY     @CURR   3                       CRT002
     C           SDCURR    PARM SDCURR    DSSDY                           CRT002
      *                                                                   CRT002
     C           @RTCD     IFNE *BLANKS                                   CRT002
     C                     MOVEL'AOCURRR0'WDBFIL                          CRT002
     C                     MOVEL'*CALL'   WDBKEY                          CRT002
     C                     Z-ADD36        WDBASE                          CRT002
     C                     EXSR UEABRT                                    CRT002
     C                     END                                            CRT002
     C                     Z-ADDA6NBDP    WPCYD   10                      CRT002
      *                                                                   CRT002
      **  Align amount.                                                   CRT002
      *                                                                   CRT002
     C                     Z-ADDWPCYD     ZADEC                           CRT002
     C           11        SUB  WPCYD     ZADIG                           CRT002
     C                     MOVEL*BLANK    ZFIELD                          CRT002
     C                     MOVE SPYAM     ZFIELD                          CRT002
     C                     EXSR ZALIGN                                    CRT002
     C                     MOVE ZFIELD    W1PYA  110                      CRT002
      *                                                                   CRT002
      **  Get the numeric value of SSMAM.                                 CRT002
      *                                                                   CRT002
     C                     CALL 'AOCURRR0'                                CRT002
     C                     PARM *BLANKS   @RTCD   7                       CRT002
     C                     PARM '*KEY   ' @OPTN   7                       CRT002
     C                     PARM SSMCY     @CURR   3                       CRT002
     C           SDCURR    PARM SDCURR    DSSDY                           CRT002
      *                                                                   CRT002
     C           @RTCD     IFNE *BLANKS                                   CRT002
     C                     MOVEL'AOCURRR0'WDBFIL                          CRT002
     C                     MOVEL'*CALL'   WDBKEY                          CRT002
     C                     Z-ADD37        WDBASE                          CRT002
     C                     EXSR UEABRT                                    CRT002
     C                     END                                            CRT002
     C                     Z-ADDA6NBDP    WSMCY   10                      CRT002
      *                                                                   CRT002
      **  Align amount.                                                   CRT002
      *                                                                   CRT002
     C                     Z-ADDWSMCY     ZADEC                           CRT002
     C           11        SUB  WSMCY     ZADIG                           CRT002
     C                     MOVEL*BLANK    ZFIELD                          CRT002
     C                     MOVE SSMAM     ZFIELD                          CRT002
     C                     EXSR ZALIGN                                    CRT002
     C                     MOVE ZFIELD    W1SMA  110                      CRT002
      *                                                                   CRT002
     C           W1PYA     IFNE 0                                         CRT002
     C           W1SMA     ANDNE0                                         CRT002
      *                                                                   CRT002
      **  Calculate the rate by dividing the larger amt by the smaller amtCRT002
      *                                                                   CRT002
     C           W1PYA     IFGE W1SMA                                     CRT002
     C           W1PYA     DIV  W1SMA     W1RTE  117                      CRT002
     C                     MOVE *BLANKS   SSMAM                           CRT002
     C                     END                                            CRT002
     C           W1SMA     IFGT W1PYA                                     CRT002
     C           W1PYA     DIV  W1SMA     W1RTE                           CRT002
     C                     MOVE *BLANKS   SPYAM                           CRT002
     C                     END                                            CRT002
      *                                                                   CRT002
      **  Format rate field.                                              CRT002
      *                                                                   CRT002
     C                     MOVE W1RTE     ZFIELD                          CRT002
     C                     Z-ADD7         ZADEC                           CRT002
     C                     EXSR ZEDIT                                     CRT002
     C                     MOVE ZFIELD    SRATE                           CRT002
     C                     END                                            CRT002
      *                                                                   CRT002
     C                     END                                            CRT002
      *                                                                   CRT002
     C           PNWRK     IFEQ 'CASHV8'                                  CRT002
      *                                                                   CRT002
      **  Receiver Correspondent and Ordering Bank.                       CRT002
      *                                                                   CRT002
     C           P54       IFNE *BLANKS                                   CRT002
     C                     MOVELP54       DSTRAN                          CRT002
     C                     MOVEL*BLANKS   SRCCO                           CRT002
     C                     MOVELTMLIN     SRCCO                           CRT002
     C                     MOVEL*BLANKS   ORB1                            CRT002
     C                     MOVELTMLIN     ORB1                            CRT002
      *                                                                   CRT002
     C                     ELSE                                           CRT002
      *                                                                   CRT002
      **  Use the default account code from CASH dataarea and build the   CRT002
      **  account number.                                                 CRT002
      *                                                                   CRT002
      **  Get branch internal customer.                                   CRT002
      *                                                                   CRT002
     C**********           CALL 'AOBRCHR0'                                             CRT002 CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM *BLANKS   @RTCD                           CRT002
     C                     PARM '*KEY   ' @OPTN                           CRT002
     C                     PARM SBRCA     #BRCA   3                       CRT002
     C********** SDBRCH    PARM SDBRCH    DSFDY                                        CRT002 CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
      *                                                                   CRT002
      **  If record not found.                                            CRT002
      *                                                                   CRT002
     C           @RTCD     IFNE *BLANK                                    CRT002
     C                     MOVEL'AOBRCHR0'WDBFIL                          CRT002
     C                     MOVEL'*CALL'   WDBKEY                          CRT002
     C                     Z-ADD38        WDBASE                          CRT002
     C                     EXSR SRERR                                     CRT002
     C                     END                                            CRT002
      *                                                                   CRT002
      **  Retrieve retail account number.                                 CRT002
      *                                                                   CRT002
     C                     MOVE A8BICN    KACNUM                          CRT002
     C                     MOVELSSMCY     KACCCY                          CRT002
     C                     MOVE DACACD    KACCD                           CRT002
     C                     Z-ADD1         KACSQ                           CRT002
     C                     MOVELSBRCA     KBRCA                           CRT002
      *                                                                   CRT002
     C           KACKEY    CHAINACCNT                90                   CRT002
     C           *IN90     IFEQ '0'                                                           189639
     C           RECI      ANDEQ'D'                                                           189639
     C**********           Z-ADDRETNUM    CNUM                                         189639 CSD027
     C                     MOVE RETNUM    CNUM                                                CSD027
     C                     ENDIF                                                              189639
      *                                                                   CRT002
      **  If record not found.                                            CRT002
      *                                                                   CRT002
     C           *IN90     IFEQ '1'                                       CRT002
     C                     MOVEL'ACCNT'   WDBFIL                          CRT002
     C                     MOVELACKYDS    WDBKEY                          CRT002
     C                     Z-ADD39        WDBASE                          CRT002
     C                     EXSR SRERR                                     CRT002
     C                     END                                            CRT002
      *                                                                   CRT002
      **  Move retail account number to receiver's correspondent.         CRT002
      *                                                                   CRT002
     C                     MOVEL*BLANKS   SRCCO                           CRT002
     C                     MOVE ACNO      SRCCO                           CRT002
      *                                                                   CRT002
     C                     END                                            CRT002
      *                                                                   CRT002
      **  Account with Institution.                                       CRT002
      *                                                                   CRT002
     C           P57       IFNE *BLANKS                                   CRT002
     C                     MOVELP57       DSTRAN                          CRT002
     C                     MOVEL*BLANKS   WREAC  10                       CRT002
     C                     MOVELTMLIN     WREAC                           CRT002
     C                     MOVEL*BLANKS   SACBK                           CRT002
     C                     MOVELWREAC     SACBK                           CRT002
     C                     END                                            CRT002
      *                                                                   CRT002
     C                     MOVEL'N'       OPIN                            CRT002
      *                                                                   CRT002
     C                     END                                            CRT002
      *                                                                   CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
      *                                                                   CFT014
      ** 3rd Reimbursment Institution                                     CFT014
     C           P55       IFNE *BLANKS                                   CFT014
     C                     MOVELP55       DSTRAN                          CFT014
      ** Map 1st line of SWIFT values into screen field                   CFT014
     C                     MOVELTMLIN1    STRIB                           CFT014
      ** Put Original SWIFT values into Network fields                    CFT014
     C                     MOVELTMLIN1    MGTRI1                          CFT014
     C                     MOVELTMLIN2    MGTRI2                          CFT014
     C                     MOVELTMLIN3    MGTRI3                          CFT014
     C                     MOVELTMLIN4    MGTRI4                          CFT014
     C                     MOVELTMLIN5    MGTRI5                          CFT014
      *                                                                   CFT014
     C           CFT004    IFEQ 'Y'                                       CFT014
      ** Check whether the field carry an IBAN                            CFT014
      ** If it is the case, move the IBAN into the 'screen' field         CFT014
      ** which will be validated afterwards                               CFT014
      *                                                                   CFT014
      ** We do this kind of checking here (instead of within the          CFT014
      ** validation) because S1TRIB is 34 char longs and INTRI1           CFT014
      ** is 35 long ('/' + 34 char); we don't want a valid Iban           CFT014
      ** to be truncated.                                                 CFT014
     C                     MOVEL*BLANK    P@IBAN                          CFT014
     C                     MOVELMGTRI1    W#P55   1                       CFT014
     C           W#P55     IFEQ '/'                                       CFT014
     C           34        SUBSTMGTRI1:2  P@IBAN                          CFT014
     C                     ELSE                                           CFT014
     C                     MOVELMGTRI1    P@IBAN                          CFT014
     C                     ENDIF                                          CFT014
     C* Check that it is a valid IBAN                                     CFT014
     C                     MOVE *BLANKS   DSSDY                           CFT014
     C                     CALL 'AOIBANR2'                                CFT014
     C                     PARM           @RTCD                           CFT014
     C                     PARM           P@IBAN                          CFT014
     C           P@ACCN    PARM           DSSDY                           CFT014
      *                                                                   CFT014
      * Network information is mapped onto the 'screen' field             CFT014
     C           @RTCD     IFEQ *BLANKS                                   CFT014
     C                     MOVEL*BLANK    STRIB                           CFT014
      ** '/' has been removed                                             CFT014
     C                     MOVELP@IBAN    STRIB                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Bank Operation Code                                              CFT014
     C           P23B      IFNE *BLANKS                                   CFT014
     C                     MOVEL*BLANK    DSTRAN                          CFT014
     C                     MOVELP23B      DSTRAN                          CFT014
     C                     MOVELTTREF     MGBOCD                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Instruction Code                                                 CFT014
     C           P23E      IFNE *BLANKS                                   CFT014
     C                     MOVEL*BLANK    DSTRAN                          CFT014
     C                     MOVELP23E      DSTRAN                          CFT014
     C                     MOVELTMLIN1    MGICD1                          CFT014
     C                     MOVELTMLIN2    MGICD2                          CFT014
     C                     MOVELTMLIN3    MGICD3                          CFT014
     C                     MOVELTMLIN4    MGICD4                          CFT014
     C                     MOVELTMLIN5    MGICD5                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Transaction Code                                                 CFT014
     C           P26T      IFNE *BLANKS                                   CFT014
     C                     MOVEL*BLANK    DSTRAN                          CFT014
     C                     MOVELP26T      DSTRAN                          CFT014
     C                     MOVELTTREF     MGTTCD                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Instructed Currency/Amount                                       CFT014
     C           P33B      IFNE *BLANKS                                   CFT014
     C                     MOVEL*BLANK    DSTRAN                          CFT014
     C                     MOVELP33B      DSTRAN                          CFT014
     C                     EXSR RTPCA                                     CFT014
     C                     MOVELWCACY     SNDCY                           CFT014
     C                     MOVELWCAAM     SNDAM                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Original Rate Currency/Amount                                    CFT014
     C           P36       IFNE *BLANKS                                   CFT014
     C                     MOVEL*BLANK    DSTRAN                          CFT014
     C                     MOVELP36       DSTRAN                          CFT014
     C                     EXSR RT36                                      CFT014
     C                     MOVELW36RT     SOEXR                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Regulatory Reporting                                             CFT014
     C           P77B      IFNE *BLANKS                                   CFT014
     C                     MOVEL*BLANK    DSTRAN                          CFT014
     C                     MOVELP77B      DSTRAN                          CFT014
     C                     MOVELTMLIN1    MGRRP1                          CFT014
     C                     MOVELTMLIN2    MGRRP2                          CFT014
     C                     MOVELTMLIN3    MGRRP3                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   S01435
      * /Copy for analysis/decoding process                               S01435
      *                                                                   S01435
     C/COPY WNCPYSRC,FT0050CDC1                                           S01408
      *                                                                   181723
     C           CFT002    IFEQ 'CFT002'                                  181723
      *                                                                   CFT002
      ***Default*in*BOOK*CODE******                                CFT002 181723
     C*********************MOVE 'FT'      BOKC                     CFT002 181723
     C*********************MOVE 'FT'      SBOKC                    CFT002 181723
      *  Default in PAY CURRENCY                                          CFT002
     C           CFT012    IFEQ 'N'                                       CFT012
     C                     MOVE SSMCY     PCCY                            CFT002
     C                     MOVE SSMCY     SPCCY                           CFT002
     C                     MOVE SSMCY     OPCCY                           CFT002
     C                     ELSE                                           CFT012
     C                     MOVE *BLANK    PCCY                            CFT012
     C                     MOVE *BLANK    SPCCY                           CFT012
     C                     MOVE *BLANK    OPCCY                           CFT012
     C                     ENDIF                                          CFT012
      *                                                                   181723
     C                     ENDIF                                          181723
      *                                                                   CGL009
      ** Set up fields for Incoming Fontis Messages                       CGL009
      *                                                                   CGL009
     C           PNWRK     IFEQ 'FONTIS'                                  CGL009
     C                     EXSR SRFONT                                    CGL009
     C                     ENDIF                                          CGL009
      *                                                                   CFT002
      * Decode data if feature installed                                  CFT002
      *                                                                   CFT002
     C           CFT002    IFEQ 'CFT002'                                  CFT002
      *                                                                   CFT002
      * Call ME1580 to translate the data of the messages for FT fields   CFT002
      *                                                                   CFT002
     C                     CALL 'ME1580'               8080               CFT002
     C                     PARM '*TRANS  '#ACT    8        Action         CFT002
     C                     PARM           PHEAD            General DatailsCFT002
     C                     PARM           PDATA            Message DatailsCFT002
     C                     PARM           PDAT2            MsgDetlExt'n                       CSW209
     C/COPY WNCPYSRC,FT0050C128
     C                     PARM *BLANKS   RTN     7        Return Code    CFT002
     C/COPY WNCPYSRC,FT0050C176
      *                                                                   CFT002
      *  If call to program resulted in an error then end program.        CFT002
     C           RTN       IFEQ '*ERROR*'                                 CFT002
     C                     MOVEL'*CALL   'W0FILE                          CFT002
     C                     MOVEL*BLANKS   W0KEY                           CFT002
     C                     MOVEL'ME1580'  W0KEY                           CFT002
     C                     Z-ADD61        W0ERNB                          CFT002
     C                     MOVELERR@,1    W0NARR                          CFT002
     C                     EXSR SRERR                                     CFT002
     C                     END                                            CFT002
     C/COPY WNCPYSRC,FT0050C132
      *                                                                   CFT002
      *  If Clearing then copy else map like FT0060                       CFT002
      *                                                                   CFT002
     C                     EXSR SRIMSG                                    CFT002
      *                                                                   CFT002
     C                     END                                            CFT002
      *                                                                   CFT012
      * Default payment currency for other network than FONTIS            CFT012
      * (provided payment currency is still blank)                        CFT012
     C           CFT012    IFEQ 'Y'                                       CFT012
     C           PNWRK     IFNE 'FONTIS'                                  CFT012
     C           SPCCY     IFEQ *BLANK                                    CFT012
     C                     EXSR SRDPCY                                    CFT012
     C                     ENDIF                                          CFT012
     C                     ENDIF                                          CFT012
     C                     ENDIF                                          CFT012
      ***********                                                         S01435
      ***********                                                         S01435
      ***If*no*sequence number entered process first set else..           S01435
      ***process*the n"th set of message records                          S01435
      *****...where n=the sequence number entered .                       S01435
      ***********     (Up to 10 records in a set and up to 10 sets).      S01435
      ***The*first record in a set is identified by presence of           S01435
      ********string ':20:' near(?|) start.                               S01435
      ***********                                                         S01435
      ***Initialize 'no of "start records" found' & no of records         S01435
      ********from required set read .                                    S01435
      ***********                                                         S01435
     C***********          Z-ADD0         XFOUND  30                      S01435
     C                     Z-ADD0         S       30
     C***********          Z-ADD0         BPOS    30                E29837S01435
     C***********          Z-ADD0         EPOS    30                E29837S01435
     C***********          Z-ADD0         SCOUNT  40                E29837S01435
     C***********          Z-ADD0         LENG    40                E29837S01435
     C***********          Z-ADD1         POS     30                E29837S01435
     C***********          MOVEA*BLANK    SD                        E29837S01435
     C***********          MOVEAMDTA      SD,4                      E29837S01435
     C***********          SETOF                     81             E29837S01435
      ***********                                                         S01435
     C************IN77     DOWEQ'0'                                       S01435
     C***********S         ANDLT10                                        S01435
     C***********SSEQNO    ANDGEXFOUND                                    S01435
      ***********                                                         S01435
      ***(If*no*seq. no. entered SSEQNO,XFOUND will both be 0 throughout) S01435
      ***********                                                         S01435
      ***If*sequence number entered scan for ':20:' start identity.       S01435
      ***********                                                         S01435
     C***********SSEQNO    IFGT 0                                         S01435
     C************IN81     DOWNE'1'                                 E29837S01435
     C***********          CALL 'QCLSCAN'                                 S01435
     C*********************PARM           MDTA                            E29837
     C*********************PARM 256       SLEN                            E29837
     C*********************PARM 1         SPOS                            E29837
     C***********          PARM           SD                        E29837S01435
     C***********          PARM 259       SLEN                      E29837S01435
     C***********          PARM POS       SPOS                      E29837S01435
     C***********          PARM ':20:'    PATT                            S01435
     C***********          PARM 4         PLEN                            S01435
     C***********          PARM           TRNS                            S01435
     C***********          PARM '1'       TRIM                            S01435
     C***********          PARM ' '       WILD                            S01435
     C***********          PARM           R                               S01435
      ***********                                                         S01435
      ***Update*number of 'start sequence records' found.                 S01435
      ***********                                                         S01435
     C***********R         IFGT 0                                         S01435
     C***********          ADD  1         XFOUND                          S01435
      ***********                                                         S01435
     C***********XFOUND    IFEQ SSEQNO                              E29837S01435
     C***********SCOUNT    ADD  R         BPOS                      E29837S01435
     C***********          SUB  3         BPOS                      E29837S01435
     C***********          END                                      E29837S01435
      ***********                                                   E29837S01435
     C***********STYPE     IFEQ '203'                               E29837S01435
      ***********                                                   E29837S01435
     C***********XFOUND    IFGT SSEQNO                              E29837S01435
     C***********EPOS      ANDEQ0                                   E29837S01435
     C***********SCOUNT    ADD  R         EPOS                      E29837S01435
     C***********          SUB  3         EPOS                      E29837S01435
     C***********                                                   E29837S01435
     C**SET*LENGTH FOR SCAN BASED ON START AND END POSITION OF MESSAGE9837S01435
     C***********                                                   E29837S01435
     C***********EPOS      SUB  BPOS      LENG                      E29837S01435
     C***********                                                   E29837S01435
     C***********          ELSE                                     E29837S01435
     C***********768       SUB  BPOS      LENG                      E29837S01435
     C***********          END                                      E29837S01435
     C***********                                                   E29837S01435
     C***********          END                                      E29837S01435
     C***********                                                   E29837S01435
     C***********R         ADD  4         POS                       E29837S01435
     C***********          Z-ADD0         R                         E29837S01435
     C***********          ELSE                                     E29837S01435
     C***********          SETON                     81             E29837S01435
     C***********          END                                            S01435
     C***********                                                   E29837S01435
     C***********          END                                      E29837S01435
     C***********                                                         S01435
     C***********          END                                            S01435
      ***********                                                         S01435
      ***If*required set found load array for future processing           S01435
      ***(If*no*sequence number entered both values will be 0 throughout  S01435
      ***********              as desired.)                               S01435
      ***********                                                         S01435
     C***********SSEQNO****IFEQ XFOUND                                    E29837
     C***********SSEQNO    IFLE XFOUND                              E29837S01435
     C***********                                                   E29837S01435
     C***********S         OREQ 0                                   E29837S01435
     C***********                                                   E29837S01435
     C***********SSEQNO    IFLT XFOUND                              E29837S01435
     C***********          SETON                     77             E29837S01435
     C***********          END                                      E29837S01435
     C***********                                                   E29837S01435
     C***********ACK       IFNE 'ACK'                      B002           S01435
     C***********ACK       ANDNE'NAK'                                     S01435
     C***********          ADD  1         S                               S01435
     C***********          MOVE MDTA      SDT,S                           S01435
     C***********          ADD  256       SCOUNT                    E29837S01435
     C***********          END                             E002           S01435
      ***********                                                         S01435
     C***********          END                                            S01435
      ***********                                                         S01435
      ***Continue reading unless Limit of 10 records loaded or            S01435
      ***the*required set has been passed .                               S01435
      ***********                                                         S01435
     C***********S         IFLE 10                                        S01435
     C************IN77     ANDNE'1'                                 E29837S01435
     C***********SSEQNO****ANDGEXFOUND                                    E29837
     C***********          MOVEASD,257    WRK3    3                       S01435
      ***********                                                         S01435
     C***********SSWTN*****READEMSIME                    77               S01259
     C***********SSWTN     READEMSMSI2L9                 77         S01259S01435
     C***********          Z-ADD1         POS                       E29837S01435
     C***********          Z-ADD0         R                         E29837S01435
     C***********          MOVEAWRK3      SD,1                      E29837S01435
     C***********          MOVEAMDTA      SD,4                      E29837S01435
     C***********          SETOF                     81             E29837S01435
     C***********          END                                            S01435
      ***********                                                         S01435
     C***********          END                             E001           S01435
      ***********                                                         S01435
      ***If*sequence number entered check that records were found .       S01435
      ***********                                                         S01435
     C***********SSEQNO    IFGT 0                                         S01435
     C***********S*********ANDEQ0                                         E29837
     C***********XFOUND    ANDLTSSEQNO                              E29837S01435
     C***********          SETON                     4259  Highlight both S01435
      ***********                                          ref and seq.   S01435
     C***********          ADD  1         I                               S01435
     C*********************MOVE ' 389'    ERCD,I                          S01117
     C***********          MOVE ' 017'    ERCD,I                    S01117S01435
     C***********          GOTO EIEND                                     S01435
     C***********          END                                            S01435
      ***********                                                         S01435
      ***********                                                         S01435
     C***********          MOVE *BLANK    ARA                             S01435
     C***********          MOVEASDT,1     ARA,1                           S01435
     C**SENDERS*CORRESPONDENT*FROM*34*                                    S01259
     C*********************MOVEAARA,34    SEND   12        E058           S01259
     C*********************MOVE *BLANK    SEDR11 11                       S01259
     C*********************MOVELSEDR1     SEDR11                          S01259
     C***********SEDR3*****IFNE 'XXX'                      B001           S01259
     C*********************MOVE SEDR3     SEDR11                          S01259
     C*********************END                             E001           S01259
     C*********************MOVELSEDR11    SSND1                           S01259
      ***********                                                   S01259S01435
      **SENDERS*ADDRESS FROM POSN.47 - ALWAYS 12 LONG IN SWIFT II   S01259S01435
      ***********                                                   S01259S01435
     C***********          MOVEAARA,47    SEND   12                 S01259S01435
     C***********          MOVELSEND      SSND1                     S01259S01435
      ***********                                                   S01259S01435
     C**SWIFT*PRIORITY*CODE*POSITIONS*57*AND*58*                          S01259
     C*********************MOVEAARA,57    SSWPC                           S01259
      ***********                                                   S01259S01435
      **SWIFT*PRIORITY FROM INCOMING MESSAGES FILE                  S01259S01435
      ***********                                                   S01259S01435
     C***********MPRY******IFEQ 'U'                        B001     S01259S01117
     C*********************MOVE '01'      SSWPC                     S01259S01117
     C*********************ELSE                            X001     S01259S01117
     C*********************MOVE '02'      SSWPC                     S01259S01117
     C*********************END                             E001     S01259S01117
     C***********                                                   S01117S01435
     C***********          MOVE MPRY      SSWPC                     S01117S01435
     C***********          Z-ADD1         S                               S01435
     C***********                                                         S01435
     C**VALUE*DATE FOR 203 TYPE                                           S01435
     C**SEARCH*FOR 32 TAG                                                 S01435
     C***********                                                         S01435
     C***********STYPE     IFNE '203'                      B001     E29837S01435
     C***********          MOVE ':32A:'   PATT    5                       S01435
     C***********          Z-ADD5         PLEN    30                      S01435
     C***********          MOVE ' '       WILD    1                       S01435
     C***********          MOVE 768       SLEN    30                E29837S01435
     C***********          MOVE 1         SPOS    30                E29837S01435
     C***********                                                         S01435
     C***********R         DOUNE0                          B002           S01435
     C***********S         OREQ 8                                         S01435
     C***********          EXSR SEARCH                                    S01435
     C***********          END                             E002           S01435
     C**IF*FOUND*                                                         S01435
     C***********R         IFNE 0                          B002           S01435
     C**AFTER*5*PAY DATE                                                  S01435
     C***********                                                         S01435
     C***********          ADD  5         R       30                      S01435
     C***********                                                         S01435
     C**MMDDYY*FORMAT DISPLAY                                             S01435
     C***********                                                         S01435
     C************IN98     IFEQ '1'                        B003           S01435
     C***********          MOVEAARA,R     SWDT                            S01435
     C***********          MOVE SDD       DD      20                      S01435
     C***********          MOVE SYY       SDD                             S01435
     C***********          MOVE SMM       SYY                             S01435
     C***********          MOVE DD        SMM                             S01435
     C***********          MOVE SWDT      SSLDT                           S01435
     C***********          ELSE                            X003           S01435
     C***********                                                         S01435
     C**DDMMYY*FORMAT DISPLAY                                             S01435
     C***********                                                         S01435
     C***********          MOVEAARA,R     SWDT                            S01435
     C***********          MOVE SDD       DD                              S01435
     C***********          MOVE SYY       SDD                             S01435
     C***********          MOVE DD        SYY                             S01435
     C***********          MOVE SWDT      SSLDT                           S01435
     C***********          END                             E003           S01435
     C***********                                                         S01435
     C**AFTER*6*PAY CURRENCY                                              S01435
     C***********                                                         S01435
     C***********          ADD  6         R                               S01435
     C***********          MOVEAARA,R     SSMCY                           S01435
     C***********                                                         S01435
     C**AFTER*3*PAY AMOUNT (AS IS 15 LONG IGNORE 1ST CHARACTER)           S01435
     C***********                                                         S01435
     C***********          ADD  3         R                               S01435
     C***********          MOVEA*BLANK    YA1                             S01435
     C***********          Z-ADD1         M       30                      S01435
     C***********          MOVEAARA,R     FLD                             S01435
     C***********CRLF      LOKUPFLD,M                    64               S01435
     C***********                                                         S01435
     C***64******          DO                              B003           S01435
     C***********          MOVEA*BLANK    FLD,M                           S01435
     C***********          MOVEAFLD       YA1                             S01435
     C***********          END                             E003           S01435
     C***********                                                         S01435
     C***********          Z-ADD1         C       30                      S01435
     C***********                                                         S01435
     C**CHANGE*,*DECIMAL POINT TO .                                       S01435
     C***********                                                         S01435
     C***********C         DOUGT15                         B003           S01435
     C***********                                                         S01435
     C***********YA1,C     IFEQ ','                        B004           S01435
     C***********          MOVE '.'       YA1,C                           S01435
     C***********          Z-ADD16        C                               S01435
     C***********          ELSE                            X004           S01435
     C***********          ADD  1         C                               S01435
     C***********          END                             E004           S01435
     C***********                                                         S01435
     C***********          END                             E003           S01435
     C***********                                                         S01435
     C***********          MOVEAYA1       AMT    15                       S01435
     C***********          MOVELAMT       SSMAM                           S01435
     C***********          END                             E002           S01435
     C***********                                                         S01435
     C***********          ELSE                            X001     E29837S01435
     C***********                                                   E29837S01435
     C**IF*203,*SEARCH FOR 32B FIELD                                E29837S01435
     C***********                                                   E29837S01435
     C***********          MOVE ':32B:'   PATT                      E29837S01435
     C***********          Z-ADD5         PLEN                      E29837S01435
     C***********          MOVE ' '       WILD                      E29837S01435
     C***********          MOVE LENG      SLEN                      E29837S01435
     C***********          MOVE BPOS      SPOS                      E29837S01435
     C***********                                                   E29837S01435
     C***********R         DOUNE0                          B002     E29837S01435
     C***********S         OREQ 8                                   E29837S01435
     C***********          EXSR SEARCH                              E29837S01435
     C***********          END                             E002     E29837S01435
     C**IF*FOUND*                                                   E29837S01435
     C***********R         IFNE 0                          B002     E29837S01435
     C***********                                                   E29837S01435
     C**AFTER*5*SETTLE CURRENCY                                     E29837S01435
     C***********                                                   E29837S01435
     C***********          ADD  5         R                         E29837S01435
     C***********          MOVEAARA,R     SSMCY                     E29837S01435
     C***********                                                   E29837S01435
     C**AFTER*3*SETTLE AMOUNT (AS IS 15 LONG IGNORE 1ST CHARACTER)  E29837S01435
     C***********                                                   E29837S01435
     C***********          ADD  3         R                         E29837S01435
     C***********          MOVEA*BLANK    YA1                       E29837S01435
     C***********          Z-ADD1         M       30                E29837S01435
     C***********          MOVEAARA,R     FLD                       E29837S01435
     C***********CRLF      LOKUPFLD,M                    64         E29837S01435
     C***********                                                   E29837S01435
     C***64******          DO                              B003     E29837S01435
     C***********          MOVEA*BLANK    FLD,M                     E29837S01435
     C***********          MOVEAFLD       YA1                       E29837S01435
     C***********          END                             E003     E29837S01435
     C***********                                                   E29837S01435
     C***********          Z-ADD1         C       30                E29837S01435
     C***********                                                   E29837S01435
     C**CHANGE*,*DECIMAL POINT TO .                                 E29837S01435
     C***********                                                   E29837S01435
     C***********C         DOUGT15                         B003     E29837S01435
     C***********                                                   E29837S01435
     C***********YA1,C     IFEQ ','                        B004     E29837S01435
     C***********          MOVE '.'       YA1,C                     E29837S01435
     C***********          Z-ADD16        C                         E29837S01435
     C***********          ELSE                            X004     E29837S01435
     C***********          ADD  1         C                         E29837S01435
     C***********          END                             E004     E29837S01435
     C***********                                                   E29837S01435
     C***********          END                             E003     E29837S01435
     C***********                                                   E29837S01435
     C***********          MOVEAYA1       AMT    15                 E29837S01435
     C***********          MOVELAMT       SSMAM                     E29837S01435
     C***********          END                             E002     E29837S01435
     C***********                                                         S01435
     C**DATE*FORMATTING FOR 203 TYPE MESSAGE                              S01435
     C***********                                                         S01435
     C***********          MOVE *BLANK    PATT                      E29837S01435
     C***********          MOVEL':30:'    PATT                            S01435
     C***********          Z-ADD1         S                         E29837S01435
     C***********          Z-ADD4         PLEN                            S01435
     C***********          MOVE ' '       WILD                            S01435
     C***********          MOVE 768       SLEN                      E29837S01435
     C***********          MOVE 1         SPOS                      E29837S01435
     C***********                                                   E29837S01435
     C***********R         DOUNE0                          B002     E29837S01435
     C***********S         OREQ 8                                   E29837S01435
     C***********          EXSR SEARCH                              E29837S01435
     C***********          END                             E002     E29837S01435
     C**IF*FOUND*                                                   E29837S01435
     C***********R         IFNE 0                          B002     E29837S01435
     C***********                                                   E29837S01435
     C**AFTER*4*SETTLE DATE                                         E29837S01435
     C***********                                                   E29837S01435
     C***********          ADD  4         R                         E29837S01435
     C************IN98     IFEQ '1'                        B003     E29837S01435
     C***********                                                   E29837S01435
     C**MMDDYY*FORMAT DISPLAY                                       E29837S01435
     C***********                                                   E29837S01435
     C***********          MOVEAARA,R     SWDT                      E29837S01435
     C***********          MOVE SDD       DD                        E29837S01435
     C***********          MOVE SYY       SDD                       E29837S01435
     C***********          MOVE SMM       SYY                       E29837S01435
     C***********          MOVE DD        SMM                       E29837S01435
     C***********          MOVE SWDT      SSLDT                     E29837S01435
     C***********          ELSE                            X003     E29837S01435
     C***********                                                   E29837S01435
     C**DDMMYY*FORMAT DISPLAY                                       E29837S01435
     C***********                                                   E29837S01435
     C***********          MOVEAARA,R     SWDT                      E29837S01435
     C***********          MOVE SDD       DD                        E29837S01435
     C***********          MOVE SYY       SDD                       E29837S01435
     C***********          MOVE DD        SYY                       E29837S01435
     C***********          MOVE SWDT      SSLDT                     E29837S01435
     C***********          END                             E003     E29837S01435
     C***********                                                   E29837S01435
     C***********          END                             E002     E29837S01435
     C***********                                                   E29837S01435
     C***********          END                             E001     E29837S01435
     C***********                                                   E29837S01435
     C**SEARCH*FOR 54 TAG                                                 S01435
     C***********                                                         S01435
     C***********          Z-ADD1         S                               S01435
     C***********          MOVE ':54*:'   PATT                            S01435
     C***********          Z-ADD5         PLEN                            S01435
     C***********          MOVE '*'       WILD                            S01435
     C***********          MOVE 768       SLEN                      E29837S01435
     C***********          MOVE 1         SPOS                      E29837S01435
     C***********                                                         S01435
     C***********R         DOUNE0                          B001           S01435
     C***********S         OREQ 8                                         S01435
     C***********          EXSR SEARCH                                    S01435
     C***********          END                             E001           S01435
     C**IF*FOUND*                                                         S01435
     C**increment R by 3 to access the type of data stored in the field293S01435
     C**instead*of going straight to the actual data ie where R is 5055293S01435
     C***********R         IFNE 0                          B001           S01435
     C*********************ADD  5         R                               055293
     C***********          ADD  3         R                         055293S01435
      ***********                                                   055293S01435
      **Set*up*field type, if A->S, B->T or D->U.                   055293S01435
      ***********                                                   055293S01435
     C***********ARA,R     IFEQ 'A'                                 055293S01435
     C***********          MOVEL'S'       INRCRT                    055293S01435
     C***********          ELSE                                     055293S01435
      ***********                                                   055293S01435
     C***********ARA,R     IFEQ 'B'                                 055293S01435
     C***********          MOVEL'T'       INRCRT                    055293S01435
     C***********          ELSE                                     055293S01435
     C***********          MOVEL'U'       INRCRT                    055293S01435
     C***********          END                                      055293S01435
      ***********                                                   055293S01435
     C***********          END                                      055293S01435
     C***********                                                         S01435
     C**AFTER*TAG RECEIVERS CORRESPONDENT                                 S01435
     C***********                                                   055293S01435
     C**Increment R by 2 to access the type of data stored in the field293S01435
     C***********                                                   055293S01435
     C***********          ADD  2         R                         055293S01435
     C***********                                                   055293S01435
     C***********          MOVE *BLANK    SRCCO                           S01435
     C***********          MOVEAARA,R     FLD                             S01435
     C***********          Z-ADD1         M                               S01435
     C***********CRLF      LOKUPFLD,M                    64               S01435
     C***********                                                         S01435
     C***64******          DO                              B002           S01435
     C***********          MOVEA*BLANK    FLD,M                           S01435
     C***********          MOVEAFLD       SRCCO                           S01435
      ***********                                                   055293S01435
      **Fill*Receivers Correspondant line 1                         055293S01435
      ***********                                                   055293S01435
     C***********          MOVELSRCCO     INRCO1                    055293S01435
     C***********          END                             E002           S01435
      ***********                                                   055293S01435
      **Move*Receivers Correspondent address details to file        055293S01435
      ***********                                                   055293S01435
     C***********          ADD  M         R                         055293S01435
     C***********          SUB  1         R                         055293S01435
     C***********          MOVEAARA,R     CHK     3                 055293S01435
      ***********                                                   055293S01435
      **Check*for Carriage return line feed S.W.I.F.T. start tag    055293S01435
      ***********                                                   055293S01435
     C***********CHK       IFNE CRLFC                      Line 2   055293S01435
     C***********          ADD  2         R                         055293S01435
     C***********          MOVEAARA,R     FLD                       055293S01435
     C***********          Z-ADD1         M                         055293S01435
      ***********                                                   055293S01435
      **Fill*Receivers Correspondant line 2                         055293S01435
      ***********                                                   055293S01435
     C***********CRLF      LOKUPFLD,M                    64         055293S01435
     C************IN64     IFEQ '1'                                 055293S01435
     C***********          MOVEA*BLANK    FLD,M                     055293S01435
     C***********          MOVEAFLD       INRCO2                    055293S01435
     C***********          END                                      055293S01435
      ***********                                                   055293S01435
     C***********          ADD  M         R                         055293S01435
     C***********          SUB  1         R                         055293S01435
     C***********          MOVEAARA,R     CHK     3                 055293S01435
      ***********                                                   055293S01435
      **Check*for Carriage return line feed S.W.I.F.T. start tag    055293S01435
      ***********                                                   055293S01435
     C***********CHK       IFNE CRLFC                      Line 3   055293S01435
     C***********          ADD  2         R                         055293S01435
     C***********          MOVEAARA,R     FLD                       055293S01435
     C***********          Z-ADD1         M                         055293S01435
      ***********                                                   055293S01435
      **Fill*Receivers Correspondant line 3                         055293S01435
      ***********                                                   055293S01435
     C***********CRLF      LOKUPFLD,M                    64         055293S01435
     C************IN64     IFEQ '1'                                 055293S01435
     C***********          MOVEA*BLANK    FLD,M                     055293S01435
     C***********          MOVEAFLD       INRCO3                    055293S01435
     C***********          END                                      055293S01435
      ***********                                                   055293S01435
     C***********          ADD  M         R                         055293S01435
     C***********          SUB  1         R                         055293S01435
     C***********          MOVEAARA,R     CHK     3                 055293S01435
      ***********                                                   055293S01435
      **Check*for Carriage return line feed S.W.I.F.T. start tag    055293S01435
      ***********                                                   055293S01435
     C***********CHK       IFNE CRLFC                      Line 4   055293S01435
     C***********          ADD  2         R                         055293S01435
     C***********          MOVEAARA,R     FLD                       055293S01435
     C***********          Z-ADD1         M                         055293S01435
      ***********                                                   055293S01435
      **Fill*Receivers Correspondant line 4                         055293S01435
      ***********                                                   055293S01435
     C***********CRLF      LOKUPFLD,M                    64         055293S01435
     C************IN64     IFEQ '1'                                 055293S01435
     C***********          MOVEA*BLANK    FLD,M                     055293S01435
     C***********          MOVEAFLD       INRCO4                    055293S01435
     C***********          END                                      055293S01435
      ***********                                                   055293S01435
     C***********          ADD  M         R                         055293S01435
     C***********          SUB  1         R                         055293S01435
     C***********          MOVEAARA,R     CHK     3                 055293S01435
      ***********                                                   055293S01435
      **Check*for Carriage return line feed S.W.I.F.T. start tag    055293S01435
      ***********                                                   055293S01435
     C***********CHK       IFNE CRLFC                      Line 5   055293S01435
     C***********          ADD  2         R                         055293S01435
     C***********          MOVEAARA,R     FLD                       055293S01435
     C***********          Z-ADD1         M                         055293S01435
      ***********                                                   055293S01435
      **Fill*Receivers Correspondant line 5                         055293S01435
      ***********                                                   055293S01435
     C***********CRLF      LOKUPFLD,M                    64         055293S01435
      ***********                                                   055293S01435
     C************IN64     IFEQ '1'                                 055293S01435
     C***********          MOVEA*BLANK    FLD,M                     055293S01435
     C***********          MOVEAFLD       INRCO5                    055293S01435
     C***********          END                                      055293S01435
      ***********                                                   055293S01435
     C***********          END                             Line 5   055293S01435
      ***********                                                   055293S01435
     C***********          END                             Line 4   055293S01435
      ***********                                                   055293S01435
     C***********          END                             Line 3   055293S01435
      ***********                                                   055293S01435
     C***********          END                             Line 2   055293S01435
      ***********                                                   055293S01435
     C***********                                                         S01435
     C***********          END                             E001           S01435
     C***********                                                         S01435
     C**SERCH*FOR 57 TAG                                                  S01435
     C***********                                                         S01435
     C***********          Z-ADD1         S                         E29837S01435
     C***********                                                   E29837S01435
     C***********STYPE     IFNE '203'                               E29837S01435
     C***********          Z-ADD768       SLEN                      E29837S01435
     C***********          Z-ADD1         SPOS                      E29837S01435
     C***********          ELSE                                     E29837S01435
     C***********          Z-ADDBPOS      SPOS                      E29837S01435
     C***********          Z-ADDLENG      SLEN                      E29837S01435
     C***********          END                                      E29837S01435
     C***********                                                   E29837S01435
     C***********          MOVE ':57*:'   PATT                            S01435
     C***********          Z-ADD5         PLEN                            S01435
     C***********                                                         S01435
     C***********R         DOUNE0                          B001           S01435
     C***********S         OREQ 8                                         S01435
     C***********          EXSR SEARCH                                    S01435
     C***********          END                             E001           S01435
      ***********                                                   055293S01435
      **Initialise Account with Institution fields                  055293S01435
      ***********                                                   055293S01435
     C***********          MOVEL*BLANKS   INACBT                    055293S01435
     C***********          MOVEL*BLANKS   INACB1                    055293S01435
     C***********          MOVEL*BLANKS   INACB2                    055293S01435
     C***********          MOVEL*BLANKS   INACB3                    055293S01435
     C***********          MOVEL*BLANKS   INACB4                    055293S01435
     C***********          MOVEL*BLANKS   INACB5                    055293S01435
     C***********                                                         S01435
     C***********R         IFNE 0                          B001           S01435
     C***********          ADD  3         R                               S01435
      ***********                                                   055293S01435
      **Set*up*field type, if A->S, B->T or D->V.                   055293S01435
      ***********                                                   055293S01435
     C***********ARA,R     IFEQ 'A'                                 055293S01435
     C***********          MOVEL'S'       INACBT                    055293S01435
     C***********          ELSE                                     055293S01435
      ***********                                                   055293S01435
     C***********ARA,R     IFEQ 'B'                                 055293S01435
     C***********          MOVEL'T'       INACBT                    055293S01435
     C***********          ELSE                                     055293S01435
     C***********          MOVEL'U'       INACBT                    055293S01435
     C***********          END                                      055293S01435
      ***********                                                   055293S01435
     C***********          END                                      055293S01435
      ***********                                                   055293S01435
     C**IF*TAG*TYPE A AFTER TAG ACCOUNT WITH BANK 11 CHARACTERS LONG      S01435
     C***********                                                         S01435
     C***********ARA,R     IFEQ 'A'                        B002           S01435
     C***********          ADD  2         R                               S01435
     C***********          MOVE *BLANK    AC11   11                       S01435
     C***********          MOVEAARA,R     FLD                             S01435
     C***********          Z-ADD1         M                               S01435
     C***********CRLF      LOKUPFLD,M                    64               S01435
     C***********                                                         S01435
     C***64******          DO                              B003           S01435
     C***********          MOVEA*BLANK    FLD,M                           S01435
     C***********          MOVEAFLD       AC11                            S01435
     C***********          END                             E003           S01435
     C***********                                                         S01435
     C***********          MOVELAC11      SACBK                           S01435
     C***********          ELSE                            X002           S01435
     C***********                                                         S01435
     C*IF*TAG*TYPE NOT A AFTER TAG ACCOUNT WITH BANK 12 CHARACTERS LONG   S01435
     C***********                                                         S01435
     C***********          ADD  2         R                               S01435
     C***********          MOVE *BLANK    AC12   12                       S01435
     C***********          MOVEAARA,R     FLD                             S01435
     C***********          Z-ADD1         M                               S01435
     C***********CRLF      LOKUPFLD,M                    64               S01435
     C***********                                                         S01435
     C***64******          DO                              B003           S01435
     C***********          MOVEA*BLANK    FLD,M                           S01435
     C***********          MOVEAFLD       AC12                            S01435
     C***********          END                             E003           S01435
     C***********                                                         S01435
     C***********          MOVE AC12      SACBK                           S01435
     C***********          END                             E002           S01435
      ***********                                                   055293S01435
      **Before*extracting information for screen, extract Account   055293S01435
      **With*Bank address fields.                                   055293S01435
      ***********                                                   055293S01435
     C***********          MOVEAARA,R     FLD                       055293S01435
     C***********          Z-ADD1         M                         055293S01435
      ***********                                                   055293S01435
      **Fill*Account with Institution line 1                        055293S01435
      ***********                                                   055293S01435
     C***********CRLF      LOKUPFLD,M                    64         055293S01435
     C************IN64     IFEQ '1'                                 055293S01435
     C***********          MOVEA*BLANK    FLD,M                     055293S01435
     C***********          MOVEAFLD       INACB1                    055293S01435
     C***********          END                                      055293S01435
      ***********                                                   055293S01435
     C***********          ADD  M         R                         055293S01435
     C***********          SUB  1         R                         055293S01435
     C***********          MOVEAARA,R     CHK     3                 055293S01435
      ***********                                                   055293S01435
      **Check*for Carriage return line feed S.W.I.F.T. start tag    055293S01435
      ***********                                                   055293S01435
     C***********CHK       IFNE CRLFC                      Line 2   055293S01435
     C***********          ADD  2         R                         055293S01435
     C***********          MOVEAARA,R     FLD                       055293S01435
     C***********          Z-ADD1         M                         055293S01435
      ***********                                                   055293S01435
      **Fill*Account with Institution line 2                        055293S01435
      ***********                                                   055293S01435
     C***********CRLF      LOKUPFLD,M                    64         055293S01435
     C************IN64     IFEQ '1'                                 055293S01435
     C***********          MOVEA*BLANK    FLD,M                     055293S01435
     C***********          MOVEAFLD       INACB2                    055293S01435
     C***********          END                                      055293S01435
      ***********                                                   055293S01435
     C***********          ADD  M         R                         055293S01435
     C***********          SUB  1         R                         055293S01435
     C***********          MOVEAARA,R     CHK     3                 055293S01435
      ***********                                                   055293S01435
      **Check*for Carriage return line feed S.W.I.F.T. start tag    055293S01435
      ***********                                                   055293S01435
     C***********CHK       IFNE CRLFC                      Line 3   055293S01435
     C***********          ADD  2         R                         055293S01435
     C***********          MOVEAARA,R     FLD                       055293S01435
     C***********          Z-ADD1         M                         055293S01435
      ***********                                                   055293S01435
      **Fill*Account with Institution line 3                        055293S01435
      ***********                                                   055293S01435
     C***********CRLF      LOKUPFLD,M                    64         055293S01435
     C************IN64     IFEQ '1'                                 055293S01435
     C***********          MOVEA*BLANK    FLD,M                     055293S01435
     C***********          MOVEAFLD       INACB3                    055293S01435
     C***********          END                                      055293S01435
      ***********                                                   055293S01435
     C***********          ADD  M         R                         055293S01435
     C***********          SUB  1         R                         055293S01435
     C***********          MOVEAARA,R     CHK     3                 055293S01435
      ***********                                                   055293S01435
      **Check*for Carriage return line feed S.W.I.F.T. start tag    055293S01435
      ***********                                                   055293S01435
     C***********CHK       IFNE CRLFC                      Line 4   055293S01435
     C***********          ADD  2         R                         055293S01435
     C***********          MOVEAARA,R     FLD                       055293S01435
     C***********          Z-ADD1         M                         055293S01435
      ***********                                                   055293S01435
      **Fill*Account with Institution line 4                        055293S01435
      ***********                                                   055293S01435
     C***********CRLF      LOKUPFLD,M                    64         055293S01435
     C************IN64     IFEQ '1'                                 055293S01435
     C***********          MOVEA*BLANK    FLD,M                     055293S01435
     C***********          MOVEAFLD       INACB4                    055293S01435
     C***********          END                                      055293S01435
      ***********                                                   055293S01435
     C***********          ADD  M         R                         055293S01435
     C***********          SUB  1         R                         055293S01435
     C***********          MOVEAARA,R     CHK     3                 055293S01435
      ***********                                                   055293S01435
      **Check*for Carriage return line feed S.W.I.F.T. start tag    055293S01435
      ***********                                                   055293S01435
     C***********CHK       IFNE CRLFC                      Line 5   055293S01435
     C***********          ADD  2         R                         055293S01435
     C***********          MOVEAARA,R     FLD                       055293S01435
     C***********          Z-ADD1         M                         055293S01435
      ***********                                                   055293S01435
      **Fill*Account with Institution line 5                        055293S01435
      ***********                                                   055293S01435
     C***********CRLF      LOKUPFLD,M                    64         055293S01435
      ***********                                                   055293S01435
     C************IN64     IFEQ '1'                                 055293S01435
     C***********          MOVEA*BLANK    FLD,M                     055293S01435
     C***********          MOVEAFLD       INACB5                    055293S01435
     C***********          END                                      055293S01435
      ***********                                                   055293S01435
     C***********          END                             Line 5   055293S01435
      ***********                                                   055293S01435
     C***********          END                             Line 4   055293S01435
      ***********                                                   055293S01435
     C***********          END                             Line 3   055293S01435
      ***********                                                   055293S01435
     C***********          END                             Line 2   055293S01435
      ***********                                                   055293S01435
     C***********          END                             E001           S01435
     C***********                                                         S01435
     C**SEARCH*FOR TAG 59                                                 S01435
     C***********                                                         S01435
     C***********          Z-ADD1         S                               S01435
     C***********          MOVE *BLANK    PATT                      E29837S01435
     C***********                                                         S01435
     C**FOR*202'S LOOK FOR 58                                             S01435
     C***********                                                         S01435
     C***********STYPE     IFEQ '100'                      B001           S01435
     C***********          MOVEL':59:'    PATT                            S01435
     C***********          MOVE ' '       WILD                      E29837S01435
     C***********          Z-ADD4         PLEN                      E29837S01435
     C***********          Z-ADD1         SPOS                      E29837S01435
     C***********          Z-ADD768       SLEN                      E29837S01435
     C***********          ELSE                            X001           S01435
     C*********************MOVEL':58:'    PATT                            E29837
     C***********          MOVEL':58*:'   PATT                      E29837S01435
     C***********          MOVE '*'       WILD                      E29837S01435
     C***********          Z-ADD5         PLEN                      E29837S01435
     C***********                                                   E29837S01435
     C***********STYPE     IFEQ '203'                      B002     E29837S01435
     C***********          Z-ADDBPOS      SPOS                      E29837S01435
     C***********          Z-ADDLENG      SLEN                      E29837S01435
     C***********          ELSE                            X002     E29837S01435
     C***********          Z-ADD1         SPOS                      E29837S01435
     C***********          Z-ADD768       SLEN                      E29837S01435
     C***********          END                             E002     E29837S01435
     C***********                                                   E29837S01435
     C***********          END                             E001           S01435
     C***********                                                   E29837S01435
     C*********************Z-ADD4         PLEN                            E29837
     C*********************MOVE ' '       WILD                            E29837
     C***********                                                         S01435
     C***********R         DOUNE0                          B001           S01435
     C***********S         OREQ 8                                         S01435
     C***********          EXSR SEARCH                                    S01435
     C***********          END                             E001           S01435
     C**IF*FOUND*                                                         S01435
     C***********R         IFNE 0                          B001           S01435
     C***********                                                         S01435
     C***********STYPE     IFEQ '100'                               E29837S01435
     C***********          ADD  4         R                               S01435
     C***********          ELSE                                     E29837S01435
     C***********          ADD  5         R                         E29837S01435
     C***********          END                                      E29837S01435
     C***********                                                         S01435
     C**AFTER*TAG BENEFICIARY BANK                                        S01435
     C***********                                                         S01435
     C***********          MOVE *BLANK    SBNC1                           S01435
     C***********          MOVEAARA,R     FLD                             S01435
     C***********          Z-ADD1         M                               S01435
     C***********CRLF      LOKUPFLD,M                    64               S01435
     C***********                                                         S01435
     C***64******          DO                              B002           S01435
     C***********          MOVEA*BLANK    FLD,M                           S01435
     C***********          MOVEAFLD       SBNC1                           S01435
     C***********          END                             E002           S01435
     C***********                                                         S01435
     C***********          ADD  M         R                               S01435
     C***********          SUB  1         R                               S01435
     C***********          MOVEAARA,R     CHK     3                       S01435
     C***********          MOVEAARA,R     CHKA    6                 E29837S01435
     C***********                                                         S01435
     C**IF*AFTER*LINE NEXT NOT CR/LF: THEN IS NEXT LINE OF ADDRESS        S01435
     C***********                                                         S01435
     C***********CHK       IFNE CRLFC                      B002           S01435
     C***********CHK*******ANDNECRLFA                                     S01435
     C***********CHKA      ANDNECRLFA                                     S01435
     C***********          ADD  2         R                               S01435
     C***********          MOVE *BLANK    SBNC2                           S01435
     C***********          MOVEAARA,R     FLD                             S01435
     C***********          Z-ADD1         M                               S01435
     C***********CRLF      LOKUPFLD,M                    64               S01435
     C***********                                                         S01435
     C***64******          DO                              B003           S01435
     C***********          MOVEA*BLANK    FLD,M                           S01435
     C***********          MOVEAFLD       SBNC2                           S01435
     C***********          END                             E003           S01435
     C***********                                                         S01435
     C***********          ADD  M         R                               S01435
     C***********          SUB  1         R                               S01435
     C***********          MOVEAARA,R     CHK                             S01435
     C***********          MOVEAARA,R     CHKA    6                 E29837S01435
     C***********                                                         S01435
     C**IF*AFTER*LINE NEXT NOT CR/LF: THEN IS NEXT LINE OF ADDRESS        S01435
     C***********                                                         S01435
     C***********CHK       IFNE CRLFC                      B003           S01435
     C***********CHK*******ANDNECRLFA                                     S01435
     C***********CHKA      ANDNECRLFA                                     S01435
     C***********          ADD  2         R                               S01435
     C***********          MOVE *BLANK    SBNC3                           S01435
     C***********          MOVEAARA,R     FLD                             S01435
     C***********          Z-ADD1         M                               S01435
     C***********CRLF      LOKUPFLD,M                    64               S01435
     C***********                                                         S01435
     C***64******          DO                              B004           S01435
     C***********          MOVEA*BLANK    FLD,M                           S01435
     C***********          MOVEAFLD       SBNC3                           S01435
     C***********          END                             E004           S01435
     C***********                                                         S01435
     C***********          ADD  M         R                               S01435
     C***********          SUB  1         R                               S01435
     C***********          MOVEAARA,R     CHK                             S01435
     C***********          MOVEAARA,R     CHKA    6                 E29837S01435
     C***********                                                         S01435
     C**IF*AFTER*LINE NEXT NOT CR/LF: THEN IS NEXT LINE OF ADDRESS        S01435
     C***********                                                         S01435
     C***********CHK       IFNE CRLFC                      B004           S01435
     C***********CHK*******ANDNECRLFA                                     S01435
     C***********CHKA      ANDNECRLFA                                     S01435
     C***********          ADD  2         R                               S01435
     C***********          MOVE *BLANK    SBNC4                           S01435
     C***********          MOVEAARA,R     FLD                             S01435
     C***********          Z-ADD1         M                               S01435
     C***********CRLF      LOKUPFLD,M                    64               S01435
     C***********                                                         S01435
     C***64******          DO                              B005           S01435
     C***********          MOVEA*BLANK    FLD,M                           S01435
     C***********          MOVEAFLD       SBNC4                           S01435
     C***********          END                             E005           S01435
     C***********                                                         S01435
     C***********          ADD  M         R                               S01435
     C***********          SUB  1         R                               S01435
     C***********          MOVEAARA,R     CHK                             S01435
     C***********          MOVEAARA,R     CHKA    6                 E29837S01435
     C***********                                                         S01435
     C**IF*AFTER*LINE NEXT NOT CR/LF: THEN IS NEXT LINE OF ADDRESS        S01435
     C***********                                                         S01435
     C***********CHK       IFNE CRLFC                      B005           S01435
     C***********CHK*******ANDNECRLFA                                     S01435
     C***********CHKA      ANDNECRLFA                                     S01435
     C***********          ADD  2         R                               S01435
     C***********          MOVE *BLANK    SBNC5                           S01435
     C***********          MOVEAARA,R     FLD                             S01435
     C***********          Z-ADD1         M                               S01435
     C***********CRLF      LOKUPFLD,M                    64               S01435
     C***********                                                         S01435
     C***64******          DO                              B006           S01435
     C***********          MOVEA*BLANK    FLD,M                           S01435
     C***********          MOVEAFLD       SBNC5                           S01435
     C***********          END                             E006           S01435
     C***********                                                         S01435
     C***********          END                             E005           S01435
     C***********                                                         S01435
     C***********          END                             E004           S01435
     C***********                                                         S01435
     C***********          END                             E003           S01435
     C***********                                                         S01435
     C***********          END                             E002           S01435
     C***********                                                         S01435
     C***********          END                             E001           S01435
     C***********                                                         S01435
     C**SEARCH*FOR 71A TAG                                          034119S01435
     C***********                                                   034119S01435
     C***********          Z-ADD1         S                         034119S01435
     C***********          MOVE ':71A:'   PATT                      034119S01435
     C***********          Z-ADD5         PLEN                      034119S01435
     C***********          MOVE ' '       WILD                      034119S01435
     C***********          MOVE 768       SLEN                      034119S01435
     C***********          MOVE 1         SPOS                      034119S01435
     C***********                                                   034119S01435
     C***********R         DOUNE0                          B001     034119S01435
     C***********S         OREQ 8                                   034119S01435
     C***********          EXSR SEARCH                              034119S01435
     C***********          END                             E001     034119S01435
     C**IF*FOUND*                                                   034119S01435
     C***********R         IFNE 0                          B001     034119S01435
     C***********          ADD  5         R                         034119S01435
     C***********                                                   034119S01435
     C**AFTER*TAG RECEIVERS CORRESPONDENT                           034119S01435
     C***********                                                   034119S01435
     C***********          MOVEAARA,R     INDDFT  3                 034119S01435
     C***********          END                             E001     034119S01435
     C*
     C*          *****     *****
     C           EIEND     ENDSR
     C*          *****     *****
     C/COPY WNCPYSRC,FT0050C053
     C/EJECT
     C           GAVALD    BEGSR
     C*          ******    *****
     C*
     C*****************************************************************
     C*                 GA-VALIDATE-DETAIL-INPUT                      *
     C*                                                               *
     C*  FUNCTION : TO PERFORM VALIDATION OF ALL DETAIL FIELDS        *
     C*             ENTERED,SETON APPROPRIATE INDICATORS AND SETUP    *
     C*             THE ARRAY OF APPROPRIATE ERROR CODES FOR DISPLAY. *
     C*                                                               *
     C*  CALLS :    IAVLRT                                            *
     C**************UATBCN*********************************************   S01194
     C*             UEABRT                                            *
     C**************UKCLCN*********************************************   S01194
     C*             UMAACN                                            *
     C*             UOACCN                                            *
     C**************UQSNCN*********************************************   S01194
     C*             ZALIGN                                            *
     C*             ZDATE1                                            *
     C**************ZDATE3*********************************************   S01195
     C*             ZFWDT                                             *   S01195
     C*             FLDQ2                                             *   S01194
     C*             SRRCCS                                            *   CFT014
     C*             SRTRIB                                            *   CFT014
     C*             SRIDFT                                            *   CFT014
     C*             SROEXR                                            *   CFT014
     C*                                                               *
     C*  CALLED BY: EAINPT                                            *
     C*                                                               *
     C*****************************************************************
     C/COPY WNCPYSRC,FT0050C195
     C*
     C** CLEAR ERROR INDICATORS & ERROR CODES ARRAY
     C*
     C                     MOVEL*BLANKS   ERCD
     C*
     C* SETOF SENDER +BENEF ERROR INDICATORS (FIELDS 2 - 4)
     C                     MOVEA'00'      *IN,24
     C                     MOVEA'000'     *IN,12                          S01117
     C*********************MOVEA'00'      *IN,16                   BDBG20 S01117
     C*
     C                     MOVEA'00'      *IN,28                          CEU006
     C                     MOVEA'00000'   *IN,34
     C                     MOVEA'00000000'*IN,40
     C                     MOVEA'00000000'*IN,48
     C                     MOVEA'0000'    *IN,56
     C                     MOVEA'000'     *IN,60
     C                     MOVE '0'       *IN70                           S01414
     C                     MOVE '0'       *IN79                           S01414
     C*
     C                     SETOF                     757620
     C                     MOVE *OFF      *IN24                           CFT009
     C*
     C                     Z-ADD*ZERO     I
      *
     C                     MOVE '0'       *IN67                           CFT014
     C                     MOVE '0'       *IN83                           CFT014
     C                     MOVE '0'       *IN86                           CFT014
     C*                                                                   S01408
     C** Core hook for externalisation.                                   S01408
     C/COPY WNCPYSRC,FT0050CVSF                                           S01408
      *                                                                   S01435
      * Validate Booking Branch if                                        S01435
      * Multibranching environment, action code I and FT0050 called       S01435
      * from swift enquiry function.                                      S01435
      *                                                                   S01435
     C           *IN10     IFEQ '1'                                       S01435
     C           *IN66     ANDEQ'1'                                       S01435
     C                     EXSR SRBRCA                                    S01435
     C                     END                                            S01435
     C*                                                                   S01408
     C** Core hook for externalisation.                                   S01408
     C/COPY WNCPYSRC,FT0050CVSF                                           S01408
     C*                                                                   S01117
     C*********************************                                   S01117
     C** VALIDATE ORIGINATING BRANCH **                                   S01117
     C*********************************                                   S01117
     C*                                                                   S01117
     C** IF MULTIBRANCHING ENVIRONMENT AND ORIGINATING BRANCH USED        S01117
     C** VALIDATE ORIGINATING BRANCH                                      S01117
     C*                                                                   S01117
     C           *IN11     IFEQ '1'                                       S01117
     C           *IN10     ANDEQ'1'                                       S01117
     C*                                                                   S01117
     C** IF NO ENTRY MADE TO ORIGINATING BRANCH THEN USE BOOKING BRANCH   S01117
     C*                                                                   S01117
     C           SORBR     IFEQ *BLANKS                                   S01117
     C                     MOVE SBRCA     SORBR                           S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C** CHECK ORIGINATING BRANCH VALID BY CALLING 'AOBRCHR0'             S01117
     C*                                                                   S01117
     C**********           CALL 'AOBRCHR0'                                             S01117 CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM *BLANKS   @RTCD                           S01117
     C                     PARM '*VERIFY' @OPTN                           S01117
     C                     PARM SORBR     @BRCD                           S01117
     C********** SDBRCH    PARM SDBRCH    DSFDY                                        S01117 CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C*                                                                   S01117
     C           @RTCD     IFNE *BLANKS                                   S01117
     C                     ADD  1         I                               S01117
     C                     MOVE '010'     ERCD,I                          S01117
     C                     SETON                     14                   S01117
     C                     ELSE                                           S01117
     C*                                                                   S01117
     C** IF ORIGINATING BRANCH USER VALIDATION REQUIRED                   S01117
     C** CHECK USER HAS AUTHORITY TO ORIGINATING BRANCH                   S01117
     C*                                                                   S01117
     C           BKOBUV    IFEQ 'Y'                                       S01117
     C                     CALL 'ZVOBU'                                   S01117
     C                     PARM SORBR     ZOBRX   3                       S01117
     C                     PARM           ERR     10                      S01117
     C*                                                                   S01117
     C** USER IS NOT AUTHORISED TO ANY ORIGINATING BRANCHES               S01117
     C*                                                                   S01117
     C           ERR       IFEQ 1                                         S01117
     C                     ADD  1         I                               S01117
     C                     MOVE '305'     ERCD,I                          S01117
     C                     SETON                     14                   S01117
     C                     ELSE                                           S01117
     C*                                                                   S01117
     C** USER IS NOT AUTHORISED TO THIS PARTICULAR ORIGINATING BRANCH     S01117
     C*                                                                   S01117
     C           ERR       IFEQ 2                                         S01117
     C                     ADD  1         I                               S01117
     C                     MOVE '306'     ERCD,I                          S01117
     C                     SETON                     14                   S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C* END, BROBUV IFEQ 'Y'                                              S01117
     C                     END                                            S01117
     C* END, @RTCD IFNE *BLANKS                                           S01117
     C                     END                                            S01117
     C* END, *IN11 IFEQ '1'                                               S01117
     C                     END                                            S01117
     C*
     C******************************
     C** VALIDATE PAYMENT SUBTYPE **
     C******************************
     C** FIELD MUST BE ENTERED & MUST EXIST ON TABLE FILE
     C*
     C           @DTSTK    KLIST                                          093958
     C                     KFLD           SPYTP                           093958
     C                     KFLD           SPYST                           093958
     C*                                                                   093958
     C           SPYST     IFEQ *BLANKS
     C                     ADD  1         I
     C*********************MOVE '091'     ERCD,I                          S01117
     C                     MOVE '018'     ERCD,I                          S01117
     C                     SETON                     44
     C                     ELSE
     C***********          MOVEL*BLANKS   ZTABKY                          S01194
     C***********          MOVEL'42'      ZTABKY                          S01194
     C***********          MOVE SPYST     ZTABKY                          S01194
     C***********          EXSR UATBCN                                    S01194
     C*                                                                   S01194
     C                     CALL 'AODLSTR0'                                S01194
     C                     PARM *BLANKS   @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM SPYST     @DSTC   2                       S01194
     C           SDDLST    PARM SDDLST    DSFDY                           S01194
     C*                                                                   S01194
     C           @RTCD     COMP *BLANK               4444                 093958
     C*                                                                   093958
     C** Check in Deal type/Sub type file if combination exists           093958
     C*                                                                   093958
     C           *IN44     IFEQ '0'                                       093958
     C           @DTSTK    CHAINFDDTSTL1             44                   093958
     C           *IN44     IFEQ '0'                                       093958
     C           RCID11    ANDEQ'*'                                       093958
     C                     SETON                     44                   093958
     C                     END                                            093958
     C                     END                                            093958
     C*                                                                   093958
     C************IN89     IFEQ '1'                         -REC NOT      S01194
     C***********@RTCD     IFNE *BLANK                              S01194093958
     C           *IN44     IFEQ '1'                                       093895
     C                     ADD  1         I                  FOUND.
     C*********************MOVE '092'     ERCD,I                          S01117
     C                     MOVE '019'     ERCD,I                          S01117
     C*********************SETON                     44                   093958
     C                     END
     C                     END
     C/COPY WNCPYSRC,FT0050C066
     C*
     C***************************
     C** VALIDATE SETTLE CURRENCY **
     C***************************
     C** FIELD MUST BE ENTERED & MUST EXIST ON CURRENCY TABLE
     C*
     C           SSMCY     IFEQ *BLANKS
     C                     ADD  1         I
     C*********************MOVE '093'     ERCD,I                          S01117
     C                     MOVE '066'     ERCD,I                          S01117
     C                     SETON                     50
     C                     ELSE
     C***********          MOVEL*BLANKS   ZTABKY                          S01194
     C***********          MOVEL'20'      ZTABKY                          S01194
     C***********          MOVELSSMCY     WA4                             S01194
     C***********          MOVE '1'       WA4                             S01194
     C***********          MOVE WA4       ZTABKY                          S01194
     C***********          EXSR UATBCN                                    S01194
     C*                                                                   S01194
     C                     CALL 'AOCURRR0'                                S01194
     C                     PARM *BLANKS   @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM SSMCY     @CCY    3                       S01194
     C           SDCURR    PARM SDCURR    DSSDY                           S01194
     C*                                                                   S01194
     C           @RTCD     CASEQ*BLANKS   MVCURR     8989                 S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C           *IN89     IFEQ '1'                         -REC NOT
     C                     ADD  1         I                  FOUND.
     C*********************MOVE '094'     ERCD,I                          S01117
     C                     MOVE '067'     ERCD,I                          S01117
     C                     SETON                     50
     C                     ELSE
     C***********          Z-ADDCDP       SVSCDP  10                      S01194
     C***********          Z-ADDSPOT      SVSSPT 138                      S01194
     C                     MOVE A6INCY    W1INCY  1                       CEU006
     C                     MOVE A6EUER    W1EUER 138                      CEU006
     C                     MOVE A6TPSD    W1TPSD  50                      CEU006
     C                     MOVE A6TPED    W1TPED  50                      CEU006
     C                     Z-ADDA6NBDP    SVSCDP  10                      S01194
     C                     Z-ADDA6SPRT    SVSSPT 138                      S01194
     C                     Z-ADDMDIN      SVSMDN  10
     C***********          MOVE '4'       ZTABKY                          S01194
     C**READ*TABTG40******************                                    S01194
     C***********          EXSR UATBCN                                    S01194
     C/COPY WNCPYSRC,FT0050C006
     C* CHANGE SPOT RATE BY BUY SPREAD
     C***********BSSG      IFEQ '+'                        B003           S01194
     C***********SPOT      ADD  BSPR      SBRAT  138                      S01194
     C           A6BYSS    IFEQ '+'                        B003           S01194
     C           A6SPRT    ADD  A6BYSR    SBRAT  138                      S01194
     C                     ELSE                            X003
     C***********SPOT      SUB  BSPR      SBRAT                           S01194
     C           A6SPRT    SUB  A6BYSR    SBRAT                           S01194
     C                     END                             E003
     C* SAVE SPOT + SPREAD RATE FOR USE IN FT0055
     C***********SSMCY     IFEQ BCCY                                      S01194
     C           SSMCY     IFEQ BJCYCD                                    S01194
     C                     Z-ADD1         SRTE
     C                     ELSE
     C                     Z-ADDSBRAT     SRTE
     C                     END
     C* CHANGE SPOT RATE BY SELL SPREAD
     C***********SSSG      IFEQ '+'                        B003           S01194
     C***********SPOT      ADD  SSPR      SSRAT  138                      S01194
     C           A6SLSS    IFEQ '+'                        B003           S01194
     C           A6SPRT    ADD  A6SLSR    SSRAT  138                      S01194
     C                     ELSE                            X003
     C***********SPOT      SUB  SSPR      SSRAT                           S01194
     C           A6SPRT    SUB  A6SLSR    SSRAT                           S01194
     C                     END                             E003
     C/COPY WNCPYSRC,FT0050C139
     C                     END
     C                     END
     C/COPY WNCPYSRC,FT0050C007
     C*
     C*******************************
     C** VALIDATE PAY CURRENCY **
     C*******************************
     C** IF ENTERED,IT MUST EXIST ON CURRENCY TABLE
     C*
     C           SPCCY     IFNE *BLANKS
     C***********          MOVEL*BLANKS   ZTABKY                          S01194
     C***********          MOVEL'20'      ZTABKY                          S01194
     C***********          MOVELSPCCY     WA4                             S01194
     C***********          MOVE '1'       WA4                             S01194
     C***********          MOVE WA4       ZTABKY                          S01194
     C***********          EXSR UATBCN                                    S01194
     C*                                                                   S01194
     C                     CALL 'AOCURRR0'                                S01194
     C                     PARM *BLANKS   @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM SPCCY     @CCY    3                       S01194
     C           SDCURR    PARM SDCURR    DSSDY                           S01194
     C*                                                                   S01194
     C           @RTCD     CASEQ*BLANK    MVCURR     8989                 S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C           *IN89     IFEQ '1'                         -REC NOT
     C                     ADD  1         I                  FOUND.
     C*********************MOVE '095'     ERCD,I                          S01117
     C                     MOVE '073'     ERCD,I                          S01117
     C                     SETON                     56
     C                     ELSE
     C                     MOVE A6INCY    W2INCY  1                       CEU006
     C                     MOVE A6EUER    W2EUER 138                      CEU006
     C                     MOVE A6TPSD    W2TPSD  50                      CEU006
     C                     MOVE A6TPED    W2TPED  50                      CEU006
     C                     MOVELSPCCY     WPCCY   3          REC CCY,
     C***********          Z-ADDCDP       SVPCDP  10        -SAVE CDP,    S01194
     C***********          Z-ADDSPOT      SVPSPT 138         SPOT RATE,   S01194
     C                     Z-ADDA6NBDP    SVPCDP  10                      S01194
     C                     Z-ADDA6SPRT    SVPSPT 138                      S01194
     C                     Z-ADDMDIN      SVPMDN  10         M/D IND.
     C***********          MOVE '4'       ZTABKY                          S01194
     C**READ*TABTG40******************                                    S01194
     C***********          EXSR UATBCN                                    S01194
     C/COPY WNCPYSRC,FT0050C008
     C* CHANGE SPOT RATE BY BUY SPREAD
     C***********BSSG      IFEQ '+'                        B003           S01194
     C***********SPOT      ADD  BSPR      PBRAT  138                      S01194
     C           A6BYSS    IFEQ '+'                        B003           S01194
     C           A6SPRT    ADD  A6BYSR    PBRAT  138                      S01194
     C                     ELSE                            X003
     C***********SPOT      SUB  BSPR      PBRAT                           S01194
     C           A6SPRT    SUB  A6BYSR    PBRAT                           S01194
     C                     END                             E003
     C* CHANGE SPOT RATE BY SELL SPREAD
     C***********SSSG      IFEQ '+'                        B003           S01194
     C***********SPOT      ADD  SSPR      PSRAT  138                      S01194
     C           A6SLSS    IFEQ '+'                        B003           S01194
     C           A6SPRT    ADD  A6SLSR    PSRAT  138                      S01194
     C                     ELSE                            X003
     C***********SPOT      SUB  SSPR      PSRAT                           S01194
     C           A6SPRT    SUB  A6SLSR    PSRAT                           S01194
     C                     END                             E003
     C* SAVE SPOT + SPREAD RATE FOR USE IN FT0055
     C***********SPCCY     IFEQ BCCY                                      S01194
     C           SPCCY     IFEQ BJCYCD                                    S01194
     C                     Z-ADD1         PRTE
     C                     ELSE
     C                     Z-ADDPSRAT     PRTE
     C                     END                             E003
     C                     END
     C                     END
     C/COPY WNCPYSRC,FT0050C009
     C*
     C** IF PAY CURRENCY NOT ENTERED & VALID PAY CURRENCY ENTERED,
     C** SET PAY CCY & NO. OF DECIMAL PLACES EQUAL TO PAY VALUES
     C** (ALSO SPOT RATE & MULT/DIV INDICATOR)
     C*
     C           SPCCY     IFEQ *BLANKS
     C           *IN50     ANDNE'1'
     C                     MOVELSSMCY     WPCCY
      *                                                                   E32532
      *  E32532 Tries later to access table file with blank currency      E32532
      *                                                                   E32532
     C                     MOVELSSMCY     SPCCY                           E32532
     C                     Z-ADDSVSCDP    SVPCDP
     C                     Z-ADDSVSSPT    SVPSPT
     C                     Z-ADDSVSMDN    SVPMDN
     C                     Z-ADDSRTE      PRTE
     C                     END
     C*                                                                   CEU006
     C/COPY WNCPYSRC,FT0050C067
     C**************************************                              CEU006
     C** VALIDATE NOTIFIED DELIVERY CURRENCY                              CEU006
     C**************************************                              CEU006
     C** VALIDATE IF SWITCHABLE FEATURE CEU006 IS INSTALLED               CEU006
      ** and if switchable feature CFT014 is not installed.               CFT014
     C*                                                                   CEU006
     C           CEU006    IFEQ 'Y'                                       CEU006
     C           CFT014    ANDEQ'N'                                       CFT014
     C*                                                                   CEU006
     C           SNDCY     IFNE *BLANKS                                   CEU006
      *                                                                   CEU006
     C           W1INCY    IFNE 'Y'                                       CEU006
     C           SSMCY     ANDNEBKEURO                                    CEU006
     C***********          MOVEL'FTM2585' FTMSID                   CEU006 CFT014
     C                     MOVEL'FTM3150' FTMSID                          CFT014
     C                     MOVEL'FTUSRMSG'FTMSGF                          CEU006
     C                     ADD  1         I                               CEU006
     C                     EXSR FTSNMS                                    CEU006
     C                     MOVE *ON       *IN28                           CEU006
     C                     ENDIF                                          CEU006
     C*                                                                   CEU006
     C                     CALL 'AOCURRR0'                                CEU006
     C                     PARM *BLANKS   @RTCD   7                       CEU006
     C                     PARM '*KEY   ' @OPTN   7                       CEU006
     C                     PARM SNDCY     @CCY    3                       CEU006
     C           SDCURR    PARM SDCURR    DSSDY                           CEU006
      *                                                                   CEU006
     C           @RTCD     IFEQ *BLANK                                    CEU006
      *                                                                   CEU006
     C           A6INCY    IFNE 'Y'                                       CEU006
     C           A6CYCD    ANDNEBKEURO                                    CEU006
     C***********          MOVEL'FTM2556' FTMSID                   CEU006 CFT014
     C                     MOVEL'FTM3151' FTMSID                          CFT014
     C                     MOVEL'FTUSRMSG'FTMSGF                          CEU006
     C                     ADD  1         I                               CEU006
     C                     EXSR FTSNMS                                    CEU006
     C                     MOVE *ON       *IN28                           CEU006
     C                     ENDIF                                          CEU006
      *                                                                   CEU006
     C           SSMCY     IFEQ BKEURO                                    CEU006
     C           A6INCY    ANDNE'Y'                                       CEU006
     C***********          MOVEL'FTM2557' FTMSID                   CEU006 CFT014
     C                     MOVEL'FTM3152' FTMSID                          CFT014
     C                     MOVEL'FTUSRMSG'FTMSGF                          CEU006
     C                     ADD  1         I                               CEU006
     C                     EXSR FTSNMS                                    CEU006
     C                     MOVE *ON       *IN28                           CEU006
      *                                                                   CEU006
     C                     ELSE                                           CEU006
      *                                                                   CEU006
     C           W1INCY    IFEQ 'Y'                                       CEU006
     C           SNDCY     ANDNEBKEURO                                    CEU006
     C***********          MOVEL'FTM2558' FTMSID                   CEU006 CFT014
     C                     MOVEL'FTM3153' FTMSID                          CFT014
     C                     MOVEL'FTUSRMSG'FTMSGF                          CEU006
     C                     ADD  1         I                               CEU006
     C                     EXSR FTSNMS                                    CEU006
     C                     MOVE *ON       *IN28                           CEU006
     C                     ELSE                                           CEU006
      *                                                                   CEU006
     C                     MOVE A6INCY    W3INCY  1                       CEU006
     C                     MOVE A6EUER    W3EUER 138                      CEU006
     C                     MOVE A6TPSD    W3TPSD  50                      CEU006
     C                     MOVE A6TPED    W3TPED  50                      CEU006
     C                     Z-ADDA6NBDP    W3NBDP  10                      CEU006
     C                     Z-ADDA6SPRT    W3SPRT 138                      CEU006
     C                     Z-ADDMDIN      W3MDIN  10                      CEU006
     C                     ENDIF                                          CEU006
     C*                                                                   CEU006
     C                     ENDIF                                          CEU006
     C*                                                                   CEU006
     C                     ELSE                                           CEU006
     C***********          MOVEL'FTM2555' FTMSID                   CEU006 CFT014
     C                     MOVEL'FTM3154' FTMSID                          CFT014
     C                     MOVEL'FTUSRMSG'FTMSGF                          CEU006
     C                     ADD  1         I                               CEU006
     C                     EXSR FTSNMS                                    CEU006
     C                     MOVE *ON       *IN28                           CEU006
     C*                                                                   CEU006
     C                     ENDIF                                          CEU006
     C*                                                                   CEU006
     C                     ENDIF                                          CEU006
     C*                                                                   CEU006
     C                     ENDIF                                          CEU006
      *                                                                   CFT014
      ** Validate Instructed Currency if switchable feature               CFT014
      ** CFT014 is installed.                                             CFT014
      *                                                                   CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
      *                                                                   CFT014
     C           SNDCY     IFNE *BLANKS                                   CFT014
      *                                                                   CFT014
     C                     CALL 'AOCURRR0'                                CFT014
     C                     PARM *BLANKS   @RTCD                           CFT014
     C                     PARM '*KEY   ' @OPTN                           CFT014
     C                     PARM SNDCY     @CCY                            CFT014
     C           SDCURR    PARM SDCURR    DSSDY                           CFT014
      *                                                                   CFT014
     C           @RTCD     IFNE *BLANKS                                   CFT014
     C                     MOVEL'FTM3154' FTMSID                          CFT014
     C                     MOVEL'FTUSRMSG'FTMSGF                          CFT014
     C                     MOVEL'Y'       FTNOUP                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     MOVE '1'       *IN28                           CFT014
     C                     ELSE                                           CFT014
     C                     EXSR MVCURR                                    CFT014
     C                     MOVE A6INCY    W3INCY                          CFT014
     C                     MOVE A6EUER    W3EUER                          CFT014
     C                     MOVE A6TPSD    W3TPSD                          CFT014
     C                     MOVE A6TPED    W3TPED                          CFT014
     C                     Z-ADDA6NBDP    W3NBDP                          CFT014
     C                     Z-ADDA6SPRT    W3SPRT                          CFT014
     C                     Z-ADDMDIN      W3MDIN                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C/COPY WNCPYSRC,FT0050C083
     C*                                                                   CEU006
     C****************************
     C** VALIDATE OVERRIDE FLAG **
     C****************************
     C** IF ENTERED,FIELD MUST BE EQUAL TO 'Y' OR 'N'
     C*
     C           SOVRD     IFNE *BLANKS
     C           SOVRD     ANDNE'Y'
     C           SOVRD     ANDNE'N'
     C/COPY WNCPYSRC,FT0050C070
     C                     ADD  1         I
     C*********************MOVE '096'     ERCD,I                          S01117
     C                     MOVE '070'     ERCD,I                          S01117
     C                     SETON                     53
     C                     END
     C/COPY WNCPYSRC,FT0050C105
     C*
     C** FIELD CANNOT BE 'Y' IF NO RATE IS ENTERED
     C*
     C           SOVRD     IFEQ 'Y'
     C           SRATE     ANDEQ*BLANK
     C                     ADD  1         I
     C*********************MOVE '097'     ERCD,I                          S01117
     C                     MOVE '071'     ERCD,I                          S01117
     C                     SETON                     53
     C                     END
     C*
     C*********************
     C** VALIDATE SENDER **
     C*********************
     C*
     C                     MOVEL*BLANKS   WERCD   4
     C                     MOVEL*BLANKS   WACCCY  3
     C***********          MOVEL*BLANKS   WSNTP                           056031
     C                     MOVEL*BLANKS   WSNTP   1                       056031
     C                     MOVEL*BLANK    ACST1   1                       047179
     C                     MOVEL*BLANKS   WSCSID 12                       CFT014
     C                     MOVEL*BLANKS   WSCNUM  6                       CFT014
     C                     MOVEL*BLANKS   WSCOLC  2                       CFT014
     C*
     C** SOME ENTRY MUST BE MADE TO ONE OF THE SENDER FIELDS
     C*
     C           SSND1     IFEQ *BLANKS
     C           SSND2     ANDEQ*BLANKS
     C           SSND3     ANDEQ*BLANKS
     C           SSND4     ANDEQ*BLANKS
     C                     ADD  1         I
     C*********************MOVE '103'     ERCD,I                          S01117
     C                     MOVE '025'     ERCD,I                          S01117
     C                     SETON                     45
     C                     GOTO GA200
     C                     END
     C*                                                                   S01194
     C** CHECK THAT FIRST FIELD OF SENDER DOES NOT CONTAIN '?'            S01194
     C*                                                                   S01194
     C                     MOVE '0'       *IN18                           S01194
     C                     MOVEA*BLANKS   QUERY                           S01194
     C                     MOVEASSND1     QUERY                           S01194
     C           '?'       LOKUPQUERY                    18               S01194
     C*                                                                   S01194
     C           *IN18     IFEQ '1'                                       S01194
     C                     ADD  1         I                               S01194
     C                     MOVE '036'     ERCD,I                          S01194
     C                     SETON                     45                   S01194
     C                     GOTO GA200                                     S01194
     C                     END                                            S01194
     C/COPY WNCPYSRC,FT0050C078
     C*
     C** ANY ENTRY TO SENDER FIELDS 2,3 OR 4 IMPLIES THAT THE WHOLE
     C***IS*AN*ADDRESS,WHICH*IS*AUTOMATICALLY*VALID.***************
     C** IS AN ADDRESS,WHICH NEEDS ADDITIONAL VALIDATION.
     C** ALSO CHECK WHETHER MORE THAN FIFTEEN CHARACTERS HAVE BEEN
     C**                         (OR EIGHTEEN IF MULTIBRANCH)             S01117
     C** ENTERED IN LINE ONE
     C*
     C***********          MOVE SSND1     WA20   20                       S01117
     C  N10                MOVE SSND1     WA20   20                       S01117
     C   10                MOVE SSND1     WA17   17                       S01117
     C           WA20      IFNE *BLANKS
     C           *IN10     ANDEQ'0'                                       S01117
     C           WA17      ORNE *BLANKS                                   S01117
     C           *IN10     ANDEQ'1'                                       S01117
     C           SSND2     ORNE *BLANKS
     C           SSND3     ORNE *BLANKS
     C           SSND4     ORNE *BLANKS
     C                     MOVEL'A'       WSNTP
     C*
     C                     SETOF                     919293
     C                     SETOF                     9424
     C*
     C                     MOVE *BLANKS   ADDRSS
     C*
     C                     MOVELSSND1     ADCHK1
     C                     MOVELSSND2     ADCHK2
     C                     MOVELSSND3     ADCHK3
     C                     MOVELSSND4     ADCHK4
     C                     MOVE *BLANKS   ADCHK5
     C*
     C                     EXSR ADCHK
     C*
     C** DEPENDING ON THE INDICATORS, HIGHLIGHT THE FIELD IN ERROR
     C** ERROR AND PRODUCE THE ERROR MESSAGE
     C*
     C           *IN92     IFEQ '1'
     C                     SETON                     452475
     C                     ADD  1         I
     C*********************MOVE '484'     ERCD,I                          S01117
     C                     MOVE '030'     ERCD,I                          S01117
     C                     END
     C*
     C           *IN93     IFEQ '1'
     C                     SETON                     452475
     C                     END
     C*
     C                     GOTO GA200
     C                     END
      *                                                                   068230
      * Check for SWIFT Address                                           068230
      *                                                                   068230
     C                     MOVELSSND1     ADCHK1                          068230
     C                     MOVELSSND2     ADCHK2                          068230
     C                     MOVELSSND3     ADCHK3                          068230
     C                     MOVELSSND4     ADCHK4                          068230
     C           140       SUBSTADDRSS:1  ##140 140                       068230
     C           129       SUBSTADDRSS:12 ##129 129                       068230
     C           11        SUBSTADDRSS:1  ##011  11                       068230
     C                     MOVEA*IN,31    ##002   2                       068230
      *                                                                   068230
     C           ##140     IFNE *BLANKS                                   068230
     C           ##129     ANDEQ*BLANKS                                   068230
      *                                                                   068230
      * Call SWIFT subroutine to check address                            068230
      *                                                                   068230
     C                     MOVEL*BLANKS   CLSWTK                          068230
     C                     MOVEL##011     CLSWTK                          068230
      *                                                                   068230
     C                     Z-ADDO         Q                               068230
     C                     EXSR SWIFT                                     068230
      *                                                                   068230
      *  No SWIFT address record but format is valid                      068230
      *                                                                   068230
     C           ##CSID    IFEQ 'Y'                                       068230
      *                                                                   068230
     C           ##CSID    IFEQ 'Y'                                       068230
     C           *IN31     ANDEQ'1'                                       068230
      *                                                                   068230
     C           *IN32     OREQ '1'                                       068230
     C           *IN31     ANDEQ'0'                                       068230
     C                     MOVEL'FTM2356' FTMSID                          068230
     C                     MOVEL'FTUSRMSG'FTMSGF                          068230
     C                     MOVEL'Y'       FTNOUP                          068230
     C                     EXSR FTSNMS                                    068230
     C                     SETON                     45                   068230
     C                     ELSE                                           068230
      *                                                                   068230
     C                     MOVEA##002     *IN,31                          068230
     C                     MOVEL'S'       WSNTP                           068230
     C                     MOVEL##011     WSCSID                          CFT014
     C                     GOTO GA200                                     068230
     C                     END                                            068230
      *                                                                   068230
     C                     END                                            068230
      *                                                                   068230
     C                     MOVEA##002     *IN,31                          068230
     C                     END                                            068230
     C*
     C***********          MOVELSSND1     WA15   15                       S01117
     C**N10*****           MOVELSSND1     WA15   15                                    S01117 CGL029
     C***10*****           MOVELSSND1     WA18   18                                    S01117 CGL029
     C  N10                MOVELSSND1     WA15   21                                           CGL029
     C   10                MOVELSSND1     WA18   24                                           CGL029
     C*
     C*
     C** ALSO THERE MUST BE NO EMBEDDED SPACES IN POSITIONS 11 TO 15
     C**                     OR FOR MULTIBRANCHED POSITIONS 11 TO 18      S01117
     C** CHARACTERS
     C*
     C***********          MOVEAWA15      YA3,1                           S01117
     C  N10                MOVEAWA15      YA3,1                           S01117
     C   10                MOVEAWA18      YA3,1                           S01117
     C*
     C                     SETOF                     8889
     C                     Z-ADD11        I1
     C  N10                Z-ADD15        J1      30                      S01117
     C   10                Z-ADD18        J1                              S01117
     C*
     C           *IN89     DOUEQ'1'
     C***********I1        ORGT 15                                        S01117
     C           I1        ORGT J1                                        S01117
     C           YA3,I1    IFEQ *BLANKS
     C                     SETON                     88
     C                     ELSE
     C           *IN88     IFEQ '1'
     C                     SETON                     89
     C                     END
     C                     END
     C                     ADD  1         I1
     C                     END
     C*
     C           *IN89     IFEQ '1'
     C                     ADD  1         I
     C*********************MOVE '102'     ERCD,I                          S01117
     C                     MOVE '024'     ERCD,I                          S01117
     C                     SETON                     45
     C                     GOTO GA200
     C                     END
     C*
     C** IF THERE ARE ANY EMBEDDED SPACES IN POSITIONS 1 TO 10,IT CAN
     C** ONLY BE A SHORT-NAME & SHOULD BE VALIDATED AS SUCH
     C** BUT IS INVALID IF ENTRY IS > 10 CHARACTERS                       S01117
     C*
     C                     SETOF                     8889
     C                     Z-ADD1         I1
     C*
     C           *IN89     DOUEQ'1'
     C           I1        ORGT 10
     C           YA3,I1    IFEQ *BLANKS
     C                     SETON                     88
     C                     ELSE
     C           *IN88     IFEQ '1'
     C                     SETON                     89
     C                     END
     C                     END
     C                     ADD  1         I1
     C                     END
     C*
     C           *IN89     IFEQ '1'
     C           YA3,11    IFNE *BLANK                                    S01117
     C                     ADD  1         I                               S01117
     C                     MOVE '024'     ERCD,I                          S01117
     C                     SETON                     45                   S01117
     C                     GOTO GA200                                     S01117
     C                     ELSE                                           S01117
     C                     GOTO GA100
     C                     END                                            S01117
     C                     END
     C*
     C** IF LESS THAN 5 CHARACTERS WERE ENTERED,SKIP THE NEXT FEW LINES
     C** & PROCEED TO VALIDATE ENTRY AS IF IT WERE A SHORT NAME
     C*
     C           YA3,5     CABEQ*BLANK    GA100
     C*
     C** CHECK IF EXACTLY 5 CHARACTERS WERE ENTERED;IF SO VALIDATE IT
     C** AS BEING A NOSTRO - MUST BE ON TABLE FILE
     C*
     C           YA3,6     IFEQ *BLANKS
     C***********          MOVEL*BLANKS   ZTABKY                          S01194
     C***********          MOVEL'70'      ZTABKY                          S01194
     C***********          MOVEAYA3,1     WA5     5                       S01194
     C***********          MOVE WA5       ZTABKY                          S01194
     C***********          EXSR UATBCN                                    S01194
     C*                                                                   S01194
     C                     MOVEAYA3,1     WA3     3                       S01194
     C                     MOVEAYA3,4     WA2     2                       S01194
     C                     CALL 'AONOSTR0'                                S01194
     C                     PARM *BLANKS   @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM *BLANKS   @CUST   6                       S01194
     C                     PARM WA3       @CYCD   3                       S01194
     C**********           PARM *BLANKS   @ACCN   4                                    S01194 CGL029
     C                     PARM *BLANKS   @ACCN  10                                           CGL029
     C                     PARM *BLANKS   @ACSN   2                       S01194
     C                     PARM WA2       @NONB   2                       S01194
     C                     PARM *BLANKS   @BRCD   3                       S01194
     C                     PARM *BLANKS   @CSSN  10                       S01194
     C                     PARM *BLANKS   @PNOI   1                       S01194
     C           SDNOST    PARM SDNOST    DSFDY                           S01194
     C*                                                                   S01194
     C           @RTCD     CASEQ*BLANK    MVNOS1     8989                 S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C           *IN89     IFEQ '1'                         -FAILED,
     C                     SETON                     45      BUT MAY
     C*********************MOVE '098'     WERCD              BE A VALID   S01117
     C                     MOVE '020'     WERCD              BE A VALID   S01117
     C                     GOTO GA100                        SHORT NAME
     C                     ELSE
     C                     MOVEAYA3,1     WACCCY            -VALID
     C                     SETON                     34      NOSTRO.
     C                     MOVEL'F'       WSNTP
     C**
     C*    STORE FIELDS FOR KEY TO ACCNT
     C**
     C**********           Z-ADDCNUM      CNUMSV  60                                          CSD027
     C                     MOVE CNUM      CNUMSV  6                                           CSD027
     C                     MOVELSSND1     CCYSV   3
     C**********           Z-ADDACOD      ACODSV  40                                          CGL029
     C                     Z-ADDACOD      ACODSV 100                                          CGL029
     C                     Z-ADDACSQ      ACSQSV  20
     C                     MOVE BRCA      BRCASV  3                       S01117
     C*
     C                     GOTO GA200
     C                     END
     C                     END
     C*
     C** CHECK IF EXACTLY 6 CHARACTERS WERE ENTERED & THEN IF THESE
     C** WERE NUMERIC; IF SO
     C** VALIDATE IT AS BEING A LIVE CUSTOMER - MUST BE ON CLINT FILE;
     C** OTHERWISE SKIP TO CODE TO VALIDATE IT AS BEING A SHORT NAME
     C*
     C           YA3,7     IFEQ *BLANKS
     C                     MOVEAYA3,1     WA6     6
     C***********          MOVE WA6       WN6     60                                          CSD027
     C                     MOVE WA6       WN6     6                                           CSD027
     C                     MOVE WN6       WA6A    6
     C***********WA6       IFNE WA6A                        -ALPHA                            CSD027
     C***********          GOTO GA100                                                         CSD027
     C***********          ELSE                                                               CSD027
     C***********          MOVE WN6       KCLNUM                          S01194
     C***********          MOVEL'A'       KCLRCT                          S01194
     C***********          EXSR UKCLCN                                    S01194
     C*                                                                   S01194
     C                     CALL 'AOCUSTR0'                                S01194
     C                     PARM *BLANKS   @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM WA6A      @KEY1  10                       S01194
     C                     PARM *BLANK    @KYST   7                       S01194
     C           SDCUST    PARM SDCUST    DSSDY                           S01194
     C*                                                                   S01194
     C           @RTCD     CASEQ*BLANK    MVCUST     8989                 S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C           *IN89     IFEQ '1'                         -FAILED
     C           @KYST     ORNE '*CNUM  '                  -FAILED        S01194
     C                     SETON                     45      BUT MAY BE
     C*********************MOVE '099'     WERCD              A VALID      S01117
     C                     MOVE '021'     WERCD              A VALID      S01117
     C                     GOTO GA100                        SHORT NAME
     C                     ELSE
     C                     MOVEL'C'       WSNTP
     C                     MOVELBBCSID    WSCSID                          CFT014
     C                     MOVELBBCOLC    WSCOLC                          CFT014
     C                     SETON                     35     -VALID LIVE
     C                     GOTO GA200                        CUSTOMER.
     C                     END
     C*************        END                                                                CSD027
     C                     END
     C*
     C** IF LESS THAN 10 CHARACTERS WERE ENTERED,SKIP THE NEXT FEW
     C** LINES & PROCEED TO VALIDATE ENTRY AS IF IT WERE A SHORT NAME
     C*
     C           YA3,10    CABEQ*BLANK    GA100
     C*
     C** IF RETAIL MODULE IS PRESENT & RETAIL A/C NOS. ARE USED:
     C** CHECK IF EXACTLY 10 CHARACTERS WERE ENTERED & THEN IF THESE
     C** WERE NUMERIC; IF SO VALIDATE IT AS
     C** BEING A LIVE RETAIL ACCOUNT - MUST BE ON ACNUMA FILE;
     C** OTHERWISE SKIP TO CODE TO VALIDATE IT AS BEING A SHORT NAME
     C*
     C           *IN32     IFEQ '1'
     C*
     C           YA3,11    IFEQ *BLANKS
     C                     MOVEAYA3,1     WA10   10
     C                     MOVE WA10      WN10   100
     C                     MOVE WN10      WA10A  10
     C           WA10      IFNE WA10A                        -ALPHA
     C                     GOTO GA100
     C                     ELSE
     C                     MOVE WN10      ACNO
     C                     EXSR UMAACN
     C           *IN89     IFEQ '1'                         -FAILED
     C                     SETON                     45      BUT MAY BE
     C*********************MOVE '100'     WERCD              A VALID      S01117
     C                     MOVE '022'     WERCD              A VALID      S01117
     C                     GOTO GA100                        SHORT NAME
     C                     ELSE
     C*
     C** IF RETAIL ACCOUNTS NOT ALLOWED, DISPLAY ERROR MESSAGE
     C*
     C***********RACN      IFNE 'Y'                                       S01194
     C           BMRANR    IFNE 'Y'                                       S01194
     C                     ADD  1         I
     C*********************MOVE '414'     ERCD,I                          S01117
     C                     MOVE '029'     ERCD,I                          S01117
     C                     SETON                     45
     C                     GOTO GA200                        RETAIL A/C
     C                     ELSE
     C*
     C                     MOVELCCY       WACCCY
     C                     MOVEL'R'       WSNTP
     C                     SETON                     36     -VALID LIVE
     C                     GOTO GA200                        RETAIL A/C
     C                     END
     C                     END
     C                     END
     C                     END
     C*
     C                     END
     C*
     C** IF EXACTLY 10 CHARACTERS WERE ENTERED,SKIP TO CODE TO
     C** VALIDATE THE FIELD AS A SHORT NAME
     C*
     C           YA3,11    CABEQ*BLANKS   GA100
     C*
     C** IF LESS THAN 15 CHARACTERS WERE ENTERED,THE FIELD IS INVALID
     C** OR LESS THAN 18 IF MULTI-BRANCH                                  S01117
     C*
     C           YA3,15    IFEQ *BLANKS
     C           *IN10     ANDEQ'0'                                       S01117
     C           YA3,18    OREQ *BLANKS                                   S01117
     C           *IN10     ANDEQ'1'                                       S01117
     C                     ADD  1         I
     C*********************MOVE '102'     ERCD,I                          S01117
     C                     MOVE '024'     ERCD,I                          S01117
     C                     SETON                     45
     C                     GOTO GA200
     C                     END
     C*
     C** EXACTLY 18 CHARACTERS ENTERED FOR MULTI-BRANCH ELSE              S01117
     C** EXACTLY 15 CHARACTERS ENTERED;THEY MUST BE IN THE FORMAT
     C** 999999XXX999999
     C*
     C                     MOVEAYA3,1     WA6
     C                     MOVE WA6       WN6
     C                     MOVE WN6       WA6A
     C********** WA6A      IFNE WA6                         -INVALID                          CSD027
     C**********           ADD  1         I                  FORMAT.                          CSD027
     C*********************MOVE '102'     ERCD,I                          S01117
     C**********           MOVE '024'     ERCD,I                          S01117              CSD027
     C**********           SETON                     45                                       CSD027
     C**********           GOTO GA200                                                         CSD027
     C**********           END                                                                CSD027
     C*
     C**********           MOVEAYA3,10    WA6                                                 CGL029
     C**********           MOVE WA6       WN6                                                 CGL029
     C**********           MOVE WN6       WA6A                                                CGL029
     C********** WA6A      IFNE WA6                         -INVALID                          CGL029
     C**********           ADD  1         I                  FORMAT.                          CGL029
     C*********************MOVE '102'     ERCD,I                          S01117
     C                     MOVEAYA3,10    WWA10  10                                           CGL029
     C                     MOVE WWA10     WN10   100                                          CGL029
     C                     MOVE WN10      WWA10A 10                                           CGL029
     C           WWA10A    IFNE WWA10                                                         CGL029
     C                     ADD  1         I                                                   CGL029
     C                     MOVE '024'     ERCD,I                          S01117
     C                     SETON                     45
     C                     GOTO GA200
     C                     END
     C*
     C** VALIDATE THE FIELD AS BEING A LIVE FULL ACCOUNT - IT MUST BE
     C** ON ACCNT FILE
     C*
     C                     MOVEAYA3,1     WA6
     C***********          MOVEAYA3,10    WA4                             056031
     C**********           MOVEAYA3,10    WA4     4                                    056031 CGL029
     C**********           MOVEAYA3,14    WA2                                                 CGL029
     C                     MOVEAYA3,10    WWA10                                               CGL029
     C                     MOVEAYA3,20    WA2                                                 CGL029
     C                     MOVE WA6       KACNUM
     C                     MOVEAYA3,7     KACCCY
     C**********           MOVE WA4       KACCD                                               CGL029
     C                     MOVE WWA10     KACCD                                               CGL029
     C                     MOVE WA2       KACSQ
     C  N10                MOVE BJSBRC    KBRCA                           S01117
     C***10*****           MOVEAYA3,16    KBRCA                                        S01117 CGL029
     C   10                MOVEAYA3,22    KBRCA                                               CGL029
     C                     EXSR UOACCN
     C           *IN89     IFEQ '1'                         -FAILED
     C                     SETON                     45
     C                     ADD  1         I
     C*********************MOVE '101'     ERCD,I                          S01117
     C                     MOVE '023'     ERCD,I                          S01117
     C                     GOTO GA200
     C                     ELSE
     C                     MOVELCCY       WACCCY
     C                     MOVEL'G'       WSNTP
     C                     SETON                     37     -VALID LIVE
     C                     GOTO GA200                        FULL A/C.
     C                     END
     C*
     C*          *****     ***
     C           GA100     TAG
     C*          *****     ***
     C** VALIDATE ENTRY AS BEING A VALID SHORT NAME - CHAIN TO SNAME.
     C** IF IT FAILS & AN ERROR CODE HAS ALREADY BEEN ASSIGNED TO THIS
     C** FIELD,USE THAT CODE;OTHERWISE SETON INDICATOR TO ASSIGN ERROR
     C** CODE 102 LATER ON
     C*
     C***********          MOVELSSND1     CSNM                            S01194
     C***********          EXSR UQSNCN                                    S01194
     C*                                                                   S01194
     C                     CALL 'AOCUSTR0'                                S01194
     C                     PARM *BLANKS   @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM SSND1     @KEY1  10                       S01194
     C                     PARM *BLANKS   @KYST   7                       S01194
     C           SDCUST    PARM SDCUST    DSSDY                           S01194
     C*                                                                   S01194
     C           @RTCD     CASEQ*BLANK    MVCUST     8989                 S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C           *IN89     IFEQ '1'                          -FAILS.
     C           @KYST     ORNE '*CSHT'                                   S01194
     C           WERCD     IFNE *BLANKS
     C                     ADD  1         I
     C                     MOVE WERCD     ERCD,I
     C                     MOVEL*BLANKS   WERCD
     C                     SETON                     45
     C                     ELSE
     C                     SETON                     4561
     C                     END
     C                     ELSE                             -VALID
     C                     SETON                     38      SHORT NAME
     C                     MOVEL'C'       WSNTP
     C                     MOVE BBCSID    WSCSID                          CFT014
     C                     MOVE BBCOLC    WSCOLC                          CFT014
     C**********           Z-ADDCNUM      WCNUM   60                                          CSD027
     C                     MOVE CNUM      WCNUM   6                                           CSD027
     C                     END
     C*
     C*          *****     ***
     C           GA200     TAG
     C*          *****     ***
     C*
     C*  IF A VALID ACCOUNT HAS BEEN ENTERED STORE THE ACCOUNT TYPE AND
     C*     THE DATE THE ACCOUNT WAS OPENED
     C*
     C           *IN45     IFEQ '0'
     C           WSNTP     IFEQ 'F'
     C           WSNTP     OREQ 'R'
     C           WSNTP     OREQ 'G'
     C*
     C*  FOR A NOSTRO FIRST ACCESS THE ACCNT RECORD
     C*
     C           WSNTP     IFEQ 'F'
     C                     EXSR ACCCHN
     C                     END
     C*
     C                     MOVE ATYP      ATYP1   1
     C                     MOVE ACST      ACST1                           047179
     C                     Z-ADDDACO      DACO1   50
     C*
      * Store full account details for FT Transaction Status File         S01435
      * record update.                                                    S01435
     C**********           Z-ADDCNUM      IMCNUM                                       S01435 CSD027
     C                     MOVE CNUM      IMCNUM                                              CSD027
     C                     MOVE CCY       IMCCY                           S01435
     C                     Z-ADDACOD      IMACOD                          S01435
     C                     Z-ADDACSQ      IMACSQ                          S01435
     C                     MOVE BRCA      IMBRCA                          S01435
     C                     MOVELIMACNT    SNDDS                           S01435
     C                     MOVE CNUM      WSCNUM                          CFT014
      *                                                                   179420
     C                     TESTB'2'       RETB           08               179420
     C           *IN08     IFEQ '1'                                       179420
      *                                                                   179420
      ** Error: Debits are blocked against this account.                  179420
      *                                                                   179420
     C                     MOVE '1'       *IN45                           179420
     C                     MOVE '1'       *IN16                           179420
     C                     MOVEL'Y'       FTNOUP                          179420
     C                     MOVEL'FTM0014' FTMSID                          179420
     C                     EXSR FTSNMS                                    179420
     C                     ENDIF                                          179420
      *                                                                   S01435
     C/COPY WNCPYSRC,FT0050C012
     C                     END
     C                     END
      *                                                                                       CRE008
      ** Move key fields to variable if CRE008 is installed.                                  CRE008
      *                                                                                       CRE008
     C           CRE008    IFEQ 'Y'                                                           CRE008
     C           *IN45     ANDEQ'0'                                                           CRE008
     C                     MOVE BRCA      PIBRCH  3                                           CRE008
     C**********           Z-ADDCNUM      PICUST  60                                   CRE008 CSD027
     C                     MOVE CNUM      PICUST  6                                           CSD027
     C                     MOVE CCY       PICURR  3                                           CRE008
     C**********           Z-ADDACOD      PIACOD  40                                   CRE008 CGL029
     C                     Z-ADDACOD      PIACOD 100                                          CGL029
     C                     Z-ADDACSQ      PIACSQ  20                                          CRE008
     C                     ENDIF                                                              CRE008
      *                                                                                       CRE008
     C/COPY WNCPYSRC,FT0050C068
     C*
     C***************************************
     C** VALIDATE RECEIVER'S CORRESPONDENT **
     C***************************************
     C*
     C                     MOVEL*BLANKS   WERCD                           CFT014
     C                     MOVEL*BLANKS   WMSID   7                       CFT014
     C                     MOVEL*BLANKS   WWMSID  7                       CFT014
     C                     MOVEL*BLANKS   WEIBAN  1                       CFT014
     C                     MOVEL*BLANKS   WRCCCY  3                       CFT014
     C                     MOVEL*BLANKS   WCNUM2  6                       CFT014
     C***********          MOVEL*BLANKS   WRCRT                           056031
     C                     MOVEL*BLANKS   WRCRT   1                       056031
     C                     MOVE *BLANK    ACST2   1                       047179
      *                                                                   CFT014
     C                     MOVE SRCO1     WSRCO1                          CFT014
     C                     MOVE SRCO2     WSRCO2                          CFT014
     C                     MOVE SRCO3     WSRCO3                          CFT014
     C                     MOVE SRCO4     WSRCO4                          CFT014
     C                     MOVE SRCO5     WSRCO5                          CFT014
     C*
     C** CHECK THAT SRCCO  FIELD DOES NOT CONTAIN '?' - ERROR IF IT DOES  S01194
     C*                                                                   S01194
     C                     SETOF                     18                   S01194
     C                     MOVEA*BLANKS   QUERY                           S01194
     C***********          MOVEASRCCO     QUERY                    S01194 CFT014
     C                     MOVEASRCO1     QUERY                           CFT014
     C           '?'       LOKUPQUERY                    18               S01194
     C*                                                                   S01194
     C           *IN18     IFEQ '1'                                       S01194
     C                     ADD  1         I                               S01194
     C                     MOVE '044'     ERCD,I                          S01194
     C                     SETON                     48                   S01194
     C                     GOTO GA300                                     S01194
     C                     END                                            S01194
     C*
     C** FIELD MUST BE ENTERED IF A VALID SENDER WAS & THE SENDER WAS
     C** NOT A NOSTRO,FULL ACCOUNT OR RETAIL ACCOUNT
     C*
     C           *IN45     IFNE '1'
     C           *IN34     ANDNE'1'
     C           *IN36     ANDNE'1'
     C           *IN37     ANDNE'1'
     C***********SRCCO     ANDEQ*BLANKS                                   CFT014
     C           SRCO1     ANDEQ*BLANKS                                   CFT014
     C           SRCO2     ANDEQ*BLANKS                                   CFT014
     C           SRCO3     ANDEQ*BLANKS                                   CFT014
     C           SRCO4     ANDEQ*BLANKS                                   CFT014
     C           SRCO5     ANDEQ*BLANKS                                   CFT014
     C/COPY WNCPYSRC,FT0050C140
     C                     ADD  1         I
     C*********************MOVE '104'     ERCD,I                          S01117
     C                     MOVE '037'     ERCD,I                          S01117
     C                     SETON                     48
     C                     GOTO GA300
     C                     END
     C*
     C** IF SENDER IS A NOSTRO,FULL ACCOUNT OR RETAIL ACCOUNT &
     C** RECEIVER'S CORRESPONDENT IS NOT ENTERED,THE ACCOUNT MUST BE
     C** IN PAY CURRENCY
     C*
     C***********SRCCO     IFEQ *BLANKS                                   CFT014
     C           SRCO1     IFEQ *BLANKS                                   CFT014
     C           SRCO2     ANDEQ*BLANKS                                   CFT014
     C           SRCO3     ANDEQ*BLANKS                                   CFT014
     C           SRCO4     ANDEQ*BLANKS                                   CFT014
     C           SRCO5     ANDEQ*BLANKS                                   CFT014
     C           *IN34     IFEQ '1'
     C           *IN36     OREQ '1'
     C           *IN37     OREQ '1'
     C           WACCCY    IFNE SSMCY
     C                     ADD  1         I
     C*********************MOVE '105'     ERCD,I                          S01117
     C                     MOVE '026'     ERCD,I                          S01117
     C                     SETON                     48
     C                     GOTO GA300
     C                     END
     C                     END
     C                     END
     C*
     C** APART FROM ABOVE CASES,FIELD MAY BE BLANK
     C*
     C***********SRCCO     CABEQ*BLANKS   GA300                           CFT014
     C           SRCO1     IFEQ *BLANKS                                   CFT014
     C           SRCO2     ANDEQ*BLANKS                                   CFT014
     C           SRCO3     ANDEQ*BLANKS                                   CFT014
     C           SRCO4     ANDEQ*BLANKS                                   CFT014
     C           SRCO5     ANDEQ*BLANKS                                   CFT014
     C                     GOTO GA300                                     CFT014
     C/COPY WNCPYSRC,FT0050C141
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** If switchable feature CFT014 is off, Receiver's Correspondent    CFT014
      ** should not be more than 10 characters long.                      CFT014
      *                                                                   CFT014
     C           CFT014    IFEQ 'N'                                       CFT014
      *                                                                   CFT014
     C           W11175    IFNE *BLANKS                                   CFT014
     C                     ADD  1         I                               CFT014
     C                     MOVE '040'     ERCD,I                          CFT014
     C                     SETON                     4867                 CFT014
     C                     GOTO GA300                                     CFT014
     C                     ENDIF                                          CFT014
     C*
     C** THERE MUST BE NO EMBEDDED SPACES IN THE FIELD
     C*
     C                     MOVEL*BLANKS   YA3
     C***********          MOVEASRCCO     YA3,1                           CFT014
     C                     MOVEASRCO1     YA3,1                           CFT014
     C*
     C                     SETOF                     8889
     C                     Z-ADD1         I1
     C*
     C           *IN89     DOUEQ'1'
     C           I1        ORGT 10
     C           YA3,I1    IFEQ *BLANKS
     C                     SETON                     88
     C                     ELSE
     C           *IN88     IFEQ '1'
     C                     SETON                     89
     C                     END
     C                     END
     C                     ADD  1         I1
     C                     END
     C*
     C           *IN89     IFEQ '1'
     C                     ADD  1         I
     C*********************MOVE '108'     ERCD,I                          S01117
     C                     MOVE '040'     ERCD,I                          S01117
     C                     SETON                     48
     C                     GOTO GA300
     C                     END
     C*
     C** CHECK IF LESS THAN 2 CHARACTERS WERE ENTERED - INVALID
     C*
     C           YA3,2     IFEQ *BLANKS
     C                     ADD  1         I
     C*********************MOVE '108'     ERCD,I                          S01117
     C                     MOVE '040'     ERCD,I                          S01117
     C                     SETON                     48
     C                     GOTO GA300
     C                     END
     C*
     C** CHECK IF EXACTLY 2 CHARACTERS WERE ENTERED;IF SO CHECK THAT
     C** THEY ARE NUMERIC & IF THEY ARE AND THE SETTLE CCY ENTERED WAS
     C** VALID,VALIDATE THIS FIELD AS BEING A NOSTRO - MUST BE ON
     C** TABLE FILE
     C*
     C           YA3,3     IFEQ *BLANKS
     C                     MOVEAYA3,1     WA2     2
     C                     MOVE WA2       WN2     20
     C                     MOVE WN2       WA2A    2
     C           WA2A      IFNE WA2                        -ALPHA
     C                     ADD  1         I
     C*********************MOVE '108'     ERCD,I                          S01117
     C                     MOVE '040'     ERCD,I                          S01117
     C                     SETON                     48
     C                     GOTO GA300
     C                     ELSE
     C           *IN50     IFNE '1'
     C***********          MOVEL*BLANKS   ZTABKY                          S01194
     C***********          MOVEL'70'      ZTABKY                          S01194
     C***********          MOVELSSMCY     WA5                             S01194
     C***********          MOVE WN2       WA5                             S01194
     C***********          MOVE WA5       ZTABKY                          S01194
     C***********          EXSR UATBCN                                    S01194
     C*                                                                   S01194
     C                     CALL 'AONOSTR0'                                S01194
     C                     PARM *BLANKS   @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM *BLANKS   @CUST   6                       S01194
     C                     PARM SSMCY     @CYCD   3                       S01194
     C**********           PARM *BLANKS   @ACCN   4                                    S01194 CGL029
     C                     PARM *BLANKS   @ACCN                                               CGL029
     C                     PARM *BLANKS   @ACSN   2                       S01194
     C                     PARM WA2A      @NONB   2                       S01194
     C                     PARM *BLANKS   @BRCD   3                       S01194
     C                     PARM *BLANKS   @CSSN  10                       S01194
     C                     PARM *BLANKS   @PNOI   1                       S01194
     C           SDNOST    PARM SDNOST    DSFDY                           S01194
     C*                                                                   S01194
     C           @RTCD     CASEQ*BLANK    MVNOS1     8989                 S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C           *IN89     IFEQ '1'                         -FAILED.
     C                     ADD  1         I
     C*********************MOVE '106'     ERCD,I                          S01117
     C                     MOVE '038'     ERCD,I                          S01117
     C                     SETON                     48
     C                     GOTO GA300
     C                     ELSE
     C                     MOVEL'N'       WRCRT
     C**
     C*    STORE FIELDS FOR KEY TO ACCNT
     C**
     C**********           Z-ADDCNUM      CNUMSV  60                                          CSD027
     C                     MOVE CNUM      CNUMSV  6                                           CSD027
     C                     MOVELSSMCY     CCYSV   3
     C**********           Z-ADDACOD      ACODSV  40                                          CGL029
     C                     Z-ADDACOD      ACODSV                                              CGL029
     C                     Z-ADDACSQ      ACSQSV  20
     C                     MOVE BRCA      BRCASV  3                       S01117
     C*
     C                     GOTO GA300                       -VALID.
     C                     END
     C                     END
     C                     END
     C                     END
     C*
     C** IF RETAIL MODULE IS PRESENT & RETAIL A/C NOS. ARE USED:
     C** CHECK IF EXACTLY 10 CHARACTERS WERE ENTERED & THEN IF THESE
     C** WERE NUMERIC; IF SO VALIDATE IT AS
     C** BEING A LIVE RETAIL ACCOUNT - MUST BE ON ACNUMA FILE;
     C** ALSO A/C MUST BE IN SETTLE CCY (IF THIS WAS VALID) - IF NOT IN
     C***SETTLE*CCY,*SETON*INDICATOR*TO*ASSIGN*ERROR*CODE*112*LATER*ON.*  S01117
     C** SETTLE CCY, SETON INDICATOR TO ASSIGN ERROR CODE 041 LATER ON.   S01117
     C*
     C           *IN32     IFEQ '1'
     C*
     C           YA3,10    IFNE *BLANKS
     C                     MOVEAYA3,1     WA10
     C                     MOVE WA10      WN10
     C                     MOVE WN10      WA10A
     C           WA10      IFNE WA10A                        -ALPHA
     C                     ADD  1         I
     C*********************MOVE '108'     ERCD,I                          S01117
     C                     MOVE '040'     ERCD,I                          S01117
     C                     SETON                     48
     C                     GOTO GA300
     C                     ELSE                              -NUMERIC
     C                     MOVE WN10      ACNO
     C                     EXSR UMAACN
     C           *IN89     IFEQ '1'
     C                     ADD  1         I
     C*********************MOVE '107'     ERCD,I                          S01117
     C                     MOVE '039'     ERCD,I                          S01117
     C                     SETON                     48
     C                     GOTO GA300
     C                     ELSE
     C*
     C** IF RETAIL ACCOUNTS NOT ALLOWED, DISPLAY ERROR MESSAGE
     C*
     C***********RACN      IFNE 'Y'                                       S01194
     C           BMRANR    IFNE 'Y'                                       S01194
     C                     ADD  1         I
     C*********************MOVE '414'     ERCD,I                          S01117
     C                     MOVE '029'     ERCD,I                          S01117
     C                     SETON                     48
     C                     GOTO GA300
     C                     ELSE
     C*
     C           *IN50     IFNE '1'
     C           CCY       ANDNESSMCY
     C                     SETON                     4860
     C                     GOTO GA300
     C                     ELSE                            -VALID
     C                     MOVEL'R'       WRCRT             RETAIL A/C
     C                     GOTO GA300
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C*
     C                     END
     C*
     C** FIELD HAS BETWEEN 3 & 9 DIGITS.THIS IS INVALID
     C*
     C                     ADD  1         I
     C*********************MOVE '108'     ERCD,I                          S01117
     C                     MOVE '040'     ERCD,I                          S01117
     C                     SETON                     48
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Additional validation for Receiver's Correspondent               CFT014
      ** if switchable feature CFT014 is on.                              CFT014
      *                                                                   CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
      *                                                                   CFT014
      ** If switchable feature CFT004 is on, validate entry               CFT014
      ** as an IBAN.                                                      CFT014
      *                                                                   CFT014
     C           CFT004    IFEQ 'Y'                                       CFT014
      *                                                                   CFT014
     C           W01C      IFEQ '/'                                       CFT014
     C           34        SUBSTSRCO1:2   PIBAN                           CFT014
     C                     ELSE                                           CFT014
     C                     MOVELSRCO1     PIBAN                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     CALL 'AOIBANR3'                                CFT014
     C                     PARM           @RTCD                           CFT014
     C                     PARM           PIBAN                           CFT014
     C                     PARM           POWITH                          CFT014
     C           P@IBAN    PARM           PONOBL                          CFT014
      *                                                                   CFT014
     C           @RTCD     IFEQ *BLANKS                                   CFT014
      *                                                                   CFT014
     C           1         SUBSTP@IBAN:1  WTRD1   1                       CFT014
     C           1         SUBSTP@IBAN:2  WTRD2   1                       CFT014
     C           1         SUBSTP@IBAN:3  WTRD3   1                       CFT014
     C           1         SUBSTP@IBAN:4  WTRD4   1                       CFT014
     C           WTRD1     LOKUPALPH                     88               CFT014
     C   88      WTRD2     LOKUPALPH                     88               CFT014
     C   88      WTRD3     LOKUPNUMC                     88               CFT014
     C   88      WTRD4     LOKUPNUMC                     88               CFT014
      *                                                                   CFT014
      ** Entry is in valid IBAN format.                                   CFT014
      *                                                                   CFT014
     C           *IN88     IFEQ *ON                                       CFT014
     C                     MOVE *BLANKS   DSSDY                           CFT014
     C                     CALL 'AOIBANR2'                                CFT014
     C                     PARM           @RTCD                           CFT014
     C                     PARM           P@IBAN                          CFT014
     C           P@ACCN    PARM           DSSDY                           CFT014
      *                                                                   CFT014
      ** IBAN entry is an invalid ISO country code.                       CFT014
      *                                                                   CFT014
     C           @RTCD     IFEQ '      1'                                 CFT014
     C                     MOVEL'FTM3107' WMSID                           CFT014
     C                     MOVEL'FTM3108' WWMSID                          CFT014
     C                     MOVEL'Y'       WEIBAN                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Invalid BBAN length on country file for IBAN entry.              CFT014
      *                                                                   CFT014
     C           @RTCD     IFEQ '      2'                                 CFT014
     C                     MOVEL'FTM3109' WMSID                           CFT014
     C                     MOVEL'FTM3110' WWMSID                          CFT014
     C                     MOVEL'Y'       WEIBAN                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** IBAN entry contains invalid characters.                          CFT014
      *                                                                   CFT014
     C           @RTCD     IFEQ '      3'                                 CFT014
     C                     MOVEL'FTM3111' WMSID                           CFT014
     C                     MOVEL'FTM3112' WWMSID                          CFT014
     C                     MOVEL'Y'       WEIBAN                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** IBAN length of BBAN  is incorrect.                               CFT014
      *                                                                   CFT014
     C           @RTCD     IFEQ '      4'                                 CFT014
     C                     MOVEL'FTM3113' WMSID                           CFT014
     C                     MOVEL'FTM3114' WWMSID                          CFT014
     C                     MOVEL'Y'       WEIBAN                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Check Digits are incorrect for IBAN entry.                       CFT014
      *                                                                   CFT014
     C           @RTCD     IFEQ '      5'                                 CFT014
     C                     MOVEL'FTM3115' WMSID                           CFT014
     C                     MOVEL'FTM3116' WWMSID                          CFT014
     C                     MOVEL'Y'       WEIBAN                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** IBAN account does not exist on the system.                       CFT014
      *                                                                   CFT014
     C           @RTCD     IFEQ '      6'                                 CFT014
     C                     MOVEL'A'       WRCRT                           CFT014
     C                     GOTO GA300                                     CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** IBAN is valid.                                                   CFT014
      *                                                                   CFT014
     C           @RTCD     IFEQ *BLANKS                                   CFT014
     C           '/'       CAT  P@IBAN    SRCO1                           CFT014
     C**********           Z-ADDIBCNUM    CNUM                                         CFT014 CSD027
     C                     MOVE IBCNUM    CNUM                                                CSD027
     C                     Z-ADDIBACOD    ACOD                            CFT014
     C                     Z-ADDIBACSQ    ACSQ                            CFT014
     C                     MOVE IBBRCA    BRCA                            CFT014
     C                     MOVE CCY       WRCCCY                          CFT014
     C                     MOVE 'I'       WRCRT                           CFT014
     C                     GOTO GA300                                     CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** If entry for Receiver's Correspondent is more than               CFT014
      ** 18 (multibranch) or more than 15 (single-branch) characters,     CFT014
      ** validate entry as an address.                                    CFT014
      *                                                                   CFT014
     C           W19175    IFNE *BLANKS                                   CFT014
     C           BGMBIN    ANDEQ'Y'                                       CFT014
     C           W16175    ORNE *BLANKS                                   CFT014
     C           BGMBIN    ANDNE'Y'                                       CFT014
      *                                                                   CFT014
     C           WEIBAN    IFEQ 'Y'                                       CFT014
      *                                                                   CFT014
     C           SRCO1     IFNE WRCO1                                     CFT014
     C           SRCO2     ORNE WRCO2                                     CFT014
     C           SRCO3     ORNE WRCO3                                     CFT014
     C           SRCO4     ORNE WRCO4                                     CFT014
     C           SRCO5     ORNE WRCO5                                     CFT014
     C                     MOVELWWMSID    FTMSID                          CFT014
     C                     MOVEL'FTUSRMSG'FTMSGF                          CFT014
     C                     MOVEL'Y'       FTNOUP                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     SETON                     4867                 CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     SETOF                     919293               CFT014
     C                     SETOF                     94                   CFT014
     C                     MOVE *BLANKS   ADDRSS                          CFT014
     C                     MOVELSRCO1     ADCHK1                          CFT014
     C                     MOVELSRCO2     ADCHK2                          CFT014
     C                     MOVELSRCO3     ADCHK3                          CFT014
     C                     MOVELSRCO4     ADCHK4                          CFT014
     C                     MOVELSRCO5     ADCHK5                          CFT014
     C                     EXSR ADCHK                                     CFT014
      *                                                                   CFT014
      ** There should be no blank lines in between entries.               CFT014
      *                                                                   CFT014
     C           *IN92     IFEQ *ON                                       CFT014
     C                     MOVEL'FTM3117' FTMSID                          CFT014
     C                     MOVEL'FTUSRMSG'FTMSGF                          CFT014
     C                     MOVEL'Y'       FTNOUP                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     SETON                     4867                 CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           *IN93     IFEQ *ON                                       CFT014
     C                     SETON                     4867                 CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** If Receiver's Correspondent is still valid up to this            CFT014
      ** point, validate further.                                         CFT014
      *                                                                   CFT014
     C           *IN48     IFEQ *OFF                                      CFT014
      *                                                                   CFT014
      ** Check if first character of the first line is '/'.               CFT014
      *                                                                   CFT014
     C           SRCO1     IFNE *BLANKS                                   CFT014
     C           SRCO2     ANDNE*BLANKS                                   CFT014
     C           SRCO3     ANDNE*BLANKS                                   CFT014
     C           SRCO4     ANDNE*BLANKS                                   CFT014
     C           SRCO5     ANDNE*BLANKS                                   CFT014
      *                                                                   CFT014
     C           W01C      IFNE '/'                                       CFT014
     C                     MOVEL'FTM3118' FTMSID                          CFT014
     C                     MOVEL'FTUSRMSG'FTMSGF                          CFT014
     C                     MOVEL'Y'       FTNOUP                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     SETON                     4867                 CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           *IN48     IFEQ *OFF                                      CFT014
     C                     MOVE 'A'       WRCRT                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     GOTO GA300                                     CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Validate entry as GL account.                                    CFT014
      *                                                                   CFT014
     C           W1218     IFNE *BLANK                                    CFT014
     C           BGMBIN    ANDEQ'Y'                                       CFT014
     C           W1215     ORNE *BLANK                                    CFT014
     C           BGMBIN    ANDNE'Y'                                       CFT014
      *                                                                   CFT014
     C           6         SUBSTWSRCO1:1  WCHR06  6                       CFT014
      *                                                                   CFT014
     C                     TESTN          WCHR06     88                   CFT014
      *                                                                   CFT014
     C           *IN88     IFEQ *OFF                                      CFT014
     C                     MOVEL'FTM3144' FTMSID                          CFT014
     C                     MOVEL'FTUSRMSG'FTMSGF                          CFT014
     C                     MOVEL'Y'       FTNOUP                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     SETON                     48                   CFT014
     C                     GOTO GA300                                     CFT014
     C                     ELSE                                           CFT014
     C                     MOVE WCHR06    KACNUM                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           3         SUBSTWSRCO1:7  KACCCY                          CFT014
      *                                                                   CFT014
     C********** 6         SUBSTWSRCO1:10 WCHR06                                       CFT014 CGL029
      *                                                                   CFT014
     C**********           TESTN          WCHR06     88                                CFT014 CGL029
     C           12        SUBSTWSRCO1:10 WCHR12 12                                           CGL029
     C                     TESTN          WCHR12     88                                       CGL029
      *                                                                   CFT014
     C           *IN88     IFEQ *OFF                                      CFT014
     C                     MOVEL'FTM3144' FTMSID                          CFT014
     C                     MOVEL'FTUSRMSG'FTMSGF                          CFT014
     C                     MOVEL'Y'       FTNOUP                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     SETON                     48                   CFT014
     C                     GOTO GA300                                     CFT014
     C                     ELSE                                           CFT014
     C********** 4         SUBSTWSRCO1:10 WCHR04  4                                    CFT014 CGL029
     C**********           MOVE WCHR04    KACCD                                        CFT014 CGL029
     C********** 2         SUBSTWSRCO1:14 WCHR02  2                                    CFT014 CGL029
     C**********           MOVE WCHR02    KACSQ                                        CFT014 CGL029
     C           10        SUBSTWSRCO1:10 WCHR10 10                                           CGL029
     C                     MOVE WCHR10    KACCD                                               CGL029
     C           2         SUBSTWSRCO1:20 WCHR02  2                                           CGL029
     C                     MOVE WCHR02    KACSQ                                               CGL029
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           BGMBIN    IFEQ 'Y'                                       CFT014
     C********** 3         SUBSTWSRCO1:16 KBRCA                                        CFT014 CGL029
     C           3         SUBSTWSRCO1:22 KBRCA                                               CGL029
     C                     ELSE                                           CFT014
     C                     MOVE BJSBRC    KBRCA                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     EXSR UOACCN                                    CFT014
      *                                                                   CFT014
      ** Error if no existing live account.                               CFT014
      *                                                                   CFT014
     C           *IN89     IFEQ *ON                                       CFT014
     C                     MOVEL'FTM3145' FTMSID                          CFT014
     C                     MOVEL'FTUSRMSG'FTMSGF                          CFT014
     C                     MOVEL'Y'       FTNOUP                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     SETON                     48                   CFT014
     C                     ELSE                                           CFT014
     C                     MOVE 'G'       WRCRT                           CFT014
     C           3         SUBSTWSRCO1:7  WRCCCY                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     GOTO GA300                                     CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Validate entry as SWIFT Id.                                      CFT014
      *                                                                   CFT014
     C                     MOVEA*IN,31    WIN312  2                       CFT014
      *                                                                   CFT014
     C           11        SUBSTW175RC:1  WALL11 11                       CFT014
      *                                                                   CFT014
     C                     MOVEL*BLANKS   CLSWTK                          CFT014
     C                     MOVELWALL11    CLSWTK                          CFT014
     C                     Z-ADDO         Q                               CFT014
     C                     EXSR SWIFT                                     CFT014
      *                                                                   CFT014
     C           ##CSID    IFEQ 'Y'                                       CFT014
     C           *IN31     IFEQ *ON                                       CFT014
     C           *IN32     OREQ *ON                                       CFT014
     C                     MOVEL'FTM3119' WMSID                           CFT014
     C                     ELSE                                           CFT014
     C                     MOVE 'S'       WRCRT                           CFT014
     C                     MOVEAWIN312    *IN,31                          CFT014
     C                     GOTO GA300                                     CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     MOVEAWIN312    *IN,31                          CFT014
      *                                                                   CFT014
      ** If position 11 of the Receiver's Correspondent entry             CFT014
      ** is non-blank, entry is an invalid customer shortname.            CFT014
      *                                                                   CFT014
     C           W11C      IFNE *BLANK                                    CFT014
     C                     MOVEL'FTM3120' FTMSID                          CFT014
     C                     MOVEL'FTUSRMSG'FTMSGF                          CFT014
     C                     MOVEL'Y'       FTNOUP                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     SETON                     48                   CFT014
     C                     GOTO GA300                                     CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Check for embedded spaces in positions 1-10 of the entry.        CFT014
      *                                                                   CFT014
     C                     MOVEL*BLANKS   YA3                             CFT014
     C                     MOVEASRCO1     YA3,1                           CFT014
      *                                                                   CFT014
     C                     SETOF                     8889                 CFT014
     C                     Z-ADD1         I1                              CFT014
      *                                                                   CFT014
     C           *IN89     DOUEQ'1'                                       CFT014
     C           I1        ORGT 10                                        CFT014
     C           YA3,I1    IFEQ *BLANKS                                   CFT014
     C                     SETON                     88                   CFT014
     C                     ELSE                                           CFT014
     C           *IN88     IFEQ *ON                                       CFT014
     C                     SETON                     89                   CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
     C                     ADD  1         I1                              CFT014
     C                     ENDDO                                          CFT014
      *                                                                   CFT014
      ** Validate entry as customer shortname if there are embedded       CFT014
      ** spaces.                                                          CFT014
      *                                                                   CFT014
     C           *IN89     IFEQ *ON                                       CFT014
     C                     EXSR SRRCCS                                    CFT014
     C                     GOTO GA300                                     CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** If Retail module is present and position 10 of the               CFT014
      ** entry is non-blank, validate entry as a Retail a/c no.           CFT014
      *                                                                   CFT014
     C           *IN32     IFEQ *ON                                       CFT014
     C           W10C      ANDNE*BLANK                                    CFT014
      *                                                                   CFT014
     C                     MOVE *BLANKS   W10RC  10                       CFT014
     C                     MOVELSRCO1     W10RC                           CFT014
     C                     TESTN          W10RC      88                   CFT014
      *                                                                   CFT014
     C           *IN88     IFEQ *ON                                       CFT014
     C                     MOVE W10RC     W10N   100                      CFT014
     C                     MOVELW10N      ACNO                            CFT014
     C                     EXSR UMAACN                                    CFT014
      *                                                                   CFT014
     C           *IN89     IFEQ *ON                                       CFT014
     C                     MOVE '039'     WERCD                           CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
      ** Error if Retail a/c no. is not supported by the system.          CFT014
      *                                                                   CFT014
     C           BMRANR    IFNE 'Y'                                       CFT014
     C                     ADD  1         I                               CFT014
     C                     MOVE '029'     ERCD,I                          CFT014
     C                     SETON                     48                   CFT014
     C                     GOTO GA300                                     CFT014
     C                     ELSE                                           CFT014
     C                     MOVELCCY       WRCCCY                          CFT014
     C                     MOVE 'R'       WRCRT                           CFT014
     C                     GOTO GA300                                     CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** If positions 7-10 of the entry are blanks and position 6         CFT014
      ** is non-blank, validate entry as a customer number.               CFT014
      *                                                                   CFT014
     C           W0710C    IFEQ *BLANKS                                   CFT014
     C           W06C      ANDNE*BLANKS                                   CFT014
      *                                                                   CFT014
     C                     MOVE *BLANKS   W06RC   6                       CFT014
     C                     MOVELSRCO1     W06RC                           CFT014
     C                     TESTN          W06RC      88                   CFT014
      *                                                                   CFT014
      ** If entry is numeric, access AOCUSTR0 to check if record          CFT014
      ** exists in Customers file.                                        CFT014
      *                                                                   CFT014
     C           *IN88     IFEQ *ON                                       CFT014
     C                     MOVELW06RC     @KEY1                           CFT014
     C                     CALL 'AOCUSTR0'                                CFT014
     C                     PARM *BLANKS   @RTCD                           CFT014
     C                     PARM '*KEY   ' @OPTN                           CFT014
     C                     PARM           @KEY1                           CFT014
     C                     PARM *BLANK    @KYST                           CFT014
     C           SDCUST    PARM SDCUST    DSSDY                           CFT014
      *                                                                   CFT014
     C           @RTCD     IFNE *BLANKS                                   CFT014
     C           @KYST     ORNE '*CNUM'                                   CFT014
     C                     MOVE 'FTM3121' WMSID                           CFT014
     C                     ELSE                                           CFT014
     C                     MOVE 'C'       WRCRT                           CFT014
     C                     GOTO GA300                                     CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** If positions 6-10 are blanks and position 5 is non-blank         CFT014
      ** OR positions 3-10 are blanks and position 2 is non-blank,        CFT014
      ** validate entry as a nostro.                                      CFT014
      *                                                                   CFT014
     C           W0610C    IFEQ *BLANKS                                   CFT014
     C           W05C      ANDNE*BLANK                                    CFT014
     C           W0310C    OREQ *BLANKS                                   CFT014
     C           W02C      ANDNE*BLANK                                    CFT014
      *                                                                   CFT014
     C                     MOVE *BLANKS   WSETT   1                       CFT014
      *                                                                   CFT014
      ** Position 3-5 are blanks, use entry for positions 1-2 as          CFT014
      ** nostro code.                                                     CFT014
      *                                                                   CFT014
     C                     MOVELW0310C    W3TO5   3                       CFT014
      *                                                                   CFT014
     C           W3TO5     IFEQ *BLANKS                                   CFT014
     C                     MOVELSRCO1     WNCD    2                       CFT014
      *                                                                   CFT014
      ** If Settlement Currency is valid, move its value to WRCCY         CFT014
      ** else, use entry for positions 1-3.                               CFT014
      *                                                                   CFT014
     C           *IN50     IFEQ *OFF                                      CFT014
     C                     MOVELSSMCY     WRCCY   3                       CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     MOVE 'Y'       WSETT                           CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
     C                     MOVE W3TO5     WNCD                            CFT014
     C                     MOVELSRCO1     WRCCY                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     TESTN          WNCD       88                   CFT014
      *                                                                   CFT014
     C           *IN88     IFEQ *ON                                       CFT014
      *                                                                   CFT014
     C           WRCCY     IFNE *BLANKS                                   CFT014
     C                     CALL 'AONOSTR0'                                CFT014
     C                     PARM *BLANKS   @RTCD                           CFT014
     C                     PARM '*KEY   ' @OPTN                           CFT014
     C                     PARM *BLANKS   @CUST                           CFT014
     C                     PARM WRCCY     @CYCD                           CFT014
     C                     PARM *BLANKS   @ACCN                           CFT014
     C                     PARM *BLANKS   @ACSN                           CFT014
     C                     PARM WNCD      @NONB                           CFT014
     C                     PARM *BLANKS   @BRCD                           CFT014
     C                     PARM *BLANKS   @CSSN                           CFT014
     C                     PARM *BLANKS   @PNOI                           CFT014
     C           SDNOST    PARM SDNOST    DSFDY                           CFT014
      *                                                                   CFT014
     C           @RTCD     IFNE *BLANKS                                   CFT014
      *                                                                   CFT014
     C           WSETT     IFEQ 'Y'                                       CFT014
     C                     MOVE '038'     WERCD                           CFT014
     C                     ELSE                                           CFT014
     C                     MOVE 'FTM3122' WMSID                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
     C                     EXSR MVNOS1                                    CFT014
      *                                                                   CFT014
     C           WSETT     IFEQ 'Y'                                       CFT014
     C                     MOVELSSMCY     W5NOST  5                       CFT014
     C                     MOVE WNCD      W5NOST                          CFT014
     C                     MOVEL*BLANKS   SRCO1                           CFT014
     C                     MOVELW5NOST    SRCO1                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C**********           Z-ADDCNUM      CNUMSV                                       CFT014 CSD027
     C                     MOVE CNUM      CNUMSV                                              CSD027
     C                     MOVELSRCO1     CCYSV                           CFT014
     C                     Z-ADDACOD      ACODSV                          CFT014
     C                     Z-ADDACSQ      ACSQSV                          CFT014
     C                     MOVE BRCA      BRCASV                          CFT014
     C                     MOVE WRCCY     WRCCCY                          CFT014
     C                     MOVE 'F'       WRCRT                           CFT014
     C                     GOTO GA300                                     CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
     C                     GOTO GA300                                     CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Validate entry as a customer shortname.                          CFT014
      *                                                                   CFT014
     C                     EXSR SRRCCS                                    CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
     C*
     C*          *****     ***
     C           GA300     TAG
     C*          *****     ***
     C*
     C*  IF A VALID ACCOUNT HAS BEEN ENTERED STORE THE ACCOUNT TYPE AND
     C*     THE DATE THE ACCOUNT WAS OPENED
     C*
     C           *IN48     IFEQ '0'
     C           WRCRT     IFEQ 'N'
     C           WRCRT     OREQ 'R'
     C           WRCRT     OREQ 'F'                                       CFT014
     C           WRCRT     OREQ 'I'                                       CFT014
     C           WRCRT     OREQ 'G'                                       CFT014
     C*
     C*  FOR A NOSTRO FIRST ACCESS THE ACCNT RECORD
     C*
     C           WRCRT     IFEQ 'N'
     C           WRCRT     OREQ 'F'                                       CFT014
     C                     EXSR ACCCHN
     C                     END
     C*
     C                     MOVE ATYP      ATYP2   1
     C                     MOVE ACST      ACST2                           047179
     C                     Z-ADDDACO      DACO2   50
     C*
      * Store full account details for FT Transaction Status File         S01435
      * record update.                                                    S01435
     C**********           Z-ADDCNUM      IMCNUM                                       S01435 CSD027
     C                     MOVE CNUM      IMCNUM                                              CSD027
     C                     MOVE CCY       IMCCY                           S01435
     C                     Z-ADDACOD      IMACOD                          S01435
     C                     Z-ADDACSQ      IMACSQ                          S01435
     C                     MOVE BRCA      IMBRCA                          S01435
     C                     MOVELIMACNT    RCCDS                           S01435
      *                                                                   S01435
     C                     TESTB'2'       RETB           08               179420
     C           *IN08     IFEQ '1'                                       179420
      *                                                                   179420
      ** Error: Debits are blocked against this account.                  179420
      *                                                                   179420
     C                     MOVE '1'       *IN48                           179420
     C                     MOVE '1'       *IN16                           179420
     C                     MOVEL'Y'       FTNOUP                          179420
     C                     MOVEL'FTM0014' FTMSID                          179420
     C                     EXSR FTSNMS                                    179420
     C                     ENDIF                                          179420
      *                                                                   179420
     C/COPY WNCPYSRC,FT0050C013
     C                     END
     C                     END
      *                                                                   CFT014
      ** Validate Third Reimbursement Institution if switchable           CFT014
      ** feature CFT014 is installed.                                     CFT014
      *                                                                   CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
      *                                                                   CFT014
     C                     EXSR SRTRIB                                    CFT014
      *                                                                   CFT014
     C           *IN83     IFEQ *OFF                                      CFT014
      *                                                                   CFT014
     C           WTRIT     IFEQ 'I'                                       CFT014
     C           WTRIT     OREQ 'F'                                       CFT014
     C           WTRIT     OREQ 'R'                                       CFT014
     C           WTRIT     OREQ 'G'                                       CFT014
      *                                                                   CFT014
     C           *IN50     IFEQ *OFF                                      CFT014
     C           WTRCCY    ANDNESSMCY                                     CFT014
     C                     MOVEL'FTM3146' FTMSID                          CFT014
     C                     MOVEL'FTUSRMSG'FTMSGF                          CFT014
     C                     MOVEL'Y'       FTNOUP                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     SETON                     83                   CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
      ** For Nostro, first access the ACCNT record.                       CFT014
      *                                                                   CFT014
     C           WTRIT     IFEQ 'F'                                       CFT014
     C                     EXSR ACCCHN                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     MOVE ATYP      WATYP5                          CFT014
     C                     MOVE ACST      WACST5                          CFT014
     C                     Z-ADDDACO      WDACO5                          CFT014
      *                                                                   CFT014
      ** Store full account details for FT Transaction Status File        CFT014
      ** record update.                                                   CFT014
      *                                                                   CFT014
     C**********           Z-ADDCNUM      IMCNUM                                       CFT014 CSD027
     C                     MOVE CNUM      IMCNUM                                              CSD027
     C                     MOVE CCY       IMCCY                           CFT014
     C                     Z-ADDACOD      IMACOD                          CFT014
     C                     Z-ADDACSQ      IMACSQ                          CFT014
     C                     MOVE BRCA      IMBRCA                          CFT014
     C                     MOVELIMACNT    WTRIDS                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
     C*
     C*
     C***********************************
     C** VALIDATE BENEFICIARY CUSTOMER **
     C***********************************
     C/COPY WNCPYSRC,FT0050C079
     C*
     C***********          MOVEL*BLANKS   WBNCT                           056031
     C                     MOVEL*BLANKS   WBNCT   1                       056031
     C                     MOVE *BLANK    ACST3   1                       047179
     C/COPY WNCPYSRC,FT0050C097
     C*
     C** CHECK THAT SBNC1  FIELD DOES NOT CONTAIN '?' - ERROR IF IT DOES  S01194
     C*                                                                   S01194
     C                     SETOF                     18                   S01194
     C**********           MOVE *ZEROS    BENRET                                       179732 CSD027
     C                     MOVE *BLANKS   BENRET                                              CSD027
     C                     MOVEA*BLANKS   QUERY                           S01194
     C                     MOVEASBNC1     QUERY                           S01194
     C           '?'       LOKUPQUERY                    18               S01194
     C*                                                                   S01194
     C           *IN18     IFEQ '1'                                       S01194
     C                     ADD  1         I                               S01194
     C                     MOVE '062'     ERCD,I                          S01194
     C                     SETON                     46                   S01194
     C                     GOTO GA500                                     S01194
     C                     END                                            S01194
     C/COPY WNCPYSRC,FT0050C080
     C*
     C**IF*ONLY*SIX*CHARACTERS*ENTERED*SEE*IF*CLIENT*NUMBER*              E21888
     C***********BCR6      IFEQ *BLANK                     B001           E21888
     C**CHECK*FOR*NUMERIC*                                                E21888
     C*********************MOVELBCNUM     NUML    70                      E21888
     C*********************MOVELNUML      NUMA    6                       E21888
     C***********BCNUMA****IFEQ NUMA                       B002           E21888
     C**CHAIN*TO*CLINT********************                                E21888
     C*********************Z-ADDBCNUM     KCLNUM                          E21888
     C*********************MOVE 'A'       KCLRCT                          E21888
     C***********KCLKEY****CHAINCLINTCBF             89                   E21888
     C**N89******RECI******COMP 'D'                  8989                 E21888
     C************IN89*****IFEQ '1'                        B003           E21888
     C*********************ADD  1         I                               E21888
     C*********************MOVE ' 394'    ERCD,I                          E21888
     C*********************SETON                     46                   E21888
     C*********************ELSE                            X003           E21888
     C*********************MOVE 'C'       WBNCT   1                       E21888
     C*********************END                             E003           E21888
     C*********************GOTO GA500                                     E21888
     C*********************END                             E002           E21888
     C*********************END                             E001           E21888
     C* IF ONLY SIX CHARACTERS ENTERED SEE IF CLIENT NUMBER               E36197
     C           BCR6      IFEQ *BLANK                     B001           E36197
     C* CHECK FOR NUMERIC                                                 E36197
     C**********           MOVELBCNUM     NUML    70                                   E36197 CSD027
     C**********           MOVELNUML      NUMA    6                                    E36197 CSD027
     C                     MOVELBCNUM     NUMA    6                                           CSD027
     C           BCNUMA    IFEQ NUMA                       B002           E36197
     C*                                                                   E36197
     C                     CALL 'AOCUSTR0'                                E36197
     C                     PARM *BLANKS   @RTCD   7                       E36197
     C                     PARM '*KEY   ' @OPTN   7                       E36197
     C                     PARM NUMA      @KEY1  10                       E36197
     C                     PARM *BLANKS   @KYST   7                       E36197
     C           SDCUST    PARM SDCUST    DSSDY                           E36197
     C/COPY WNCPYSRC,FT0050C098
     C*                                                                   E36197
     C           @RTCD     CASEQ*BLANK    MVCUST     8989                 E36197
     C                     END                                            E36197
     C*                                                                   E36197
     C           *IN89     IFEQ '1'                        B003           E36197
     C           @KYST     ORNE '*CNUM'                                   E36197
     C                     ADD  1         I                               E36197
     C                     MOVE ' 059'    ERCD,I                          E36197
     C                     SETON                     46                   E36197
     C                     ELSE                            X003           E36197
     C                     MOVE 'C'       WBNCT   1                       E36197
     C                     END                             E003           E36197
     C                     GOTO GA500                                     E36197
     C                     END                             E002           E36197
     C                     END                             E001           E36197
     C*                                                                   E23285
     C***CHECK FOR BLANK BENEFICIARY                                      E23285
     C*                                                                   E23285
     C           BCR0      IFEQ *BLANK                                    E23285
     C                     SETON                     46                   E23285
     C                     ADD  1         I                               E23285
     C*********************MOVEA' 115'    ERCD,I                    E23285S01117
     C                     MOVEA' 054'    ERCD,I                          S01117
     C                     GOTO GA500                                     E23285
     C                     END                                            E23285
     C*
     C* IF ONLY TEN CHARACTERS ENTERED, CHECK FOR RETAIL ACCOUNT NO.
     C* OR CUSTOMER SHORTNAME
     C           BCR10     IFEQ *BLANK                     B001
     C                     MOVELBSNAM     RETL   110
     C                     MOVELRETL      RETA   10
     C           BSNAM     IFEQ RETA                       B002
     C                     MOVE BSNAM     ACNO
     C           ACNO      CHAINACNUMABF             89
     C  N89      RECI      COMP 'D'                  8989
     C* Store Retail Number for Later Use                                 179732
     C           *IN89     IFEQ '0'                                       179732
     C                     MOVE RETNUM    BENRET                          179732
     C**********           Z-ADDRETNUM    CNUM                                         189639 CSD027
     C                     MOVE RETNUM    CNUM                                                CSD027
     C                     ELSE                                           179732
     C**********           MOVE *ZEROS    BENRET                                       179732 CSD027
     C                     MOVE *BLANKS   BENRET                                              CSD027
     C                     ENDIF                                          179732
     C           *IN89     IFEQ '1'                        B003
     C                     SETON                     46
     C                     ADD  1         I
     C*********************MOVEA' 116'    ERCD,I                          S01117
     C                     MOVEA' 055'    ERCD,I                          S01117
     C                     ELSE
     C/COPY WNCPYSRC,FT0050C099
     C*
     C** IF RETAIL ACCOUNTS NOT ALLOWED, DISPLAY ERROR MESSAGE
     C*
     C***********RACN      IFNE 'Y'                                       S01194
     C           BMRANR    IFNE 'Y'                                       S01194
     C                     ADD  1         I
     C*********************MOVE '414'     ERCD,I                          S01117
     C                     MOVE '029'     ERCD,I                          S01117
     C                     SETON                     46
     C                     ELSE
     C*
     C**N87******CCY*******IFNE WPCCY                      B004           034175
     C           CCY       IFNE WPCCY                      B005           034175
     C                     SETON                     46
     C                     ADD  1         I
     C*********************MOVEA' 117'    ERCD,I                          S01117
     C                     MOVEA' 056'    ERCD,I                          S01117
     C                     ELSE                            X004
     C                     MOVE 'R'       WBNCT
     C                     END                             E004
     C                     END                             E003
     C                     END                             E003
     C                     GOTO GA500
     C                     ELSE                            X002
     C                     MOVE BSNAM     CSNM
     C***********CSNM      CHAINSNAMECBF             89                   S01194
     C**N89******RECI      COMP 'D'                  8989                 S01194
     C*                                                                   S01194
     C                     CALL 'AOCUSTR0'                                S01194
     C                     PARM *BLANKS   @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM CSNM      @KEY1  10                       S01194
     C                     PARM *BLANKS   @KYST   7                       S01194
     C           SDCUST    PARM SDCUST    DSSDY                           S01194
     C/COPY WNCPYSRC,FT0050C100
     C*                                                                   S01194
     C**N89****************DO                              B003           S01194
     C           @RTCD     IFEQ *BLANK                                    S01194
     C           @KYST     ANDEQ'*CSHT'                                   S01194
     C                     EXSR MVCUST                                    S01194
     C                     MOVE *BLANK    SBNC1
     C                     MOVELCNUM      SBNC1
     C                     MOVE 'C'       WBNCT
     C                     GOTO GA500
     C                     END                             E003
     C                     END                             E002
     C                     END                             E001
     C* IF ONLY TWELVE CHARACTERS ENTERED SWIFT ADDRESS
     C** SINGLE BRANCH - PARTIAL A/C IS 12 LONG                           S01117
     C** MULTI  BRANCH - PARTIAL A/C IS 15 LONG                           S01117
     C           BCR12     IFEQ *BLANK                     B001
     C           *IN10     ANDEQ'0'                                       S01117
     C           BCR15     OREQ *BLANK                                    S01117
     C           *IN10     ANDEQ'1'                                       S01117
     C**********           MOVELBPART     PARTA  130                                          CGL029
     C**********           MOVELPARTA     PARTN  12                                           CGL029
     C                     MOVELBPART     PARTA  190                                          CGL029
     C                     MOVELPARTA     PARTN  18                                           CGL029
     C           BPART     IFEQ PARTN                      B002
     C**********           Z-ADDBCNUM     KACNUM                                              CSD027
     C                     MOVE BCNUM     KACNUM                                              CSD027
     C                     MOVE WPCCY     KACCCY
     C                     Z-ADDBACOD     KACCD
     C                     Z-ADDBACSQ     KACSQ
     C  N10                MOVE BJSBRC    KBRCA                           S01117
     C   10                MOVE BBRCA     KBRCA                           S01117
     C           KACKEY    CHAINACCNT                89
     C  N89      RECI      COMP 'D'                  8989
     C           *IN89     IFEQ '0'                                                           189639
     C**********           Z-ADDRETNUM    CNUM                                         189639 CSD027
     C                     MOVE RETNUM    CNUM                                                CSD027
     C                     ENDIF                                                              189639
     C           *IN89     IFEQ '1'                        B003
     C                     ADD  1         I
     C*********************MOVE ' 119'    ERCD,I                          S01117
     C                     MOVE ' 057'    ERCD,I                          S01117
     C                     SETON                     46
     C                     ELSE                            X002
     C/COPY WNCPYSRC,FT0050C101
     C                     MOVE 'P'       WBNCT
     C                     END                             E003
     C                     GOTO GA500
     C                     ELSE                            X002
     C                     MOVE *BLANKS   SW
     C                     MOVEASBNC1     SW
      *                                                                   068230
      * Call SWIFT subroutine to check address                            068230
      *                                                                   068230
     C**********           MOVEL*BLANKS   CLSWTK 12                                    068230 CGL029
     C                     MOVEL*BLANKS   CLSWTK 18                                           CGL029
     C                     MOVELSBNC1     CLSWTK                          068230
      *                                                                   068230
     C                     Z-ADDO         Q                               068230
     C                     EXSR SWIFT
      *                                                                   068230
      *  No SWIFT address record but format is valid                      068230
      *                                                                   068230
     C           ##CSID    IFEQ 'Y'                                       068230
      *                                                                   068230
     C           ##CSID    IFEQ 'Y'                                       068230
     C           *IN31     ANDEQ'1'                                       068230
      *                                                                   068230
     C           *IN32     OREQ '1'                                       068230
     C           *IN31     ANDEQ'0'                                       068230
     C************IN89     IFEQ '0'                        B002           068230
     C***********BBRCA     ORNE *BLANKS                             S01117068230
     C                     ADD  1         I
     C*********************MOVE ' 395'    ERCD,I                          S01117
     C                     MOVE ' 059'    ERCD,I                          S01117
     C                     SETON                     46
     C                     ELSE                            X002
     C                     MOVE 'S'       WBNCT
     C                     END                             E002
     C                     MOVEA##002     *IN,31                          068230
     C                     GOTO GA500
     C                     END                             E001
      *                                                                   068230
     C                     MOVEA##002     *IN,31                          068230
     C                     END                                            068230
     C                     END                             E001
      *                                                                   068230
      * Check for / and second line is SWIFT                              068230
      *                                                                   068230
     C           140       SUBSTBCR0:36   ##140 140                       068230
     C           129       SUBSTBCR0:47   ##129 129                       068230
     C           11        SUBSTBCR0:36   ##011  11                       068230
      *                                                                   068230
     C           BCSL      IFEQ '/'                                       068230
     C           ##140     ANDNE*BLANKS                                   068230
     C           ##129     ANDEQ*BLANKS                                   068230
      *                                                                   068230
      * Call SWIFT subroutine to check address                            068230
      *                                                                   068230
     C**********           MOVEL*BLANKS   CLSWTK 12                                    068230 CGL029
     C                     MOVEL*BLANKS   CLSWTK                                              CGL029
     C                     MOVEL##011     CLSWTK                          068230
      *                                                                   068230
     C                     Z-ADDO         Q                               068230
     C                     EXSR SWIFT                                     068230
      *                                                                   068230
      *  No SWIFT address record but format is valid                      068230
      *                                                                   068230
     C           ##CSID    IFEQ 'Y'                                       068230
      *                                                                   068230
     C           ##CSID    IFEQ 'Y'                                       068230
     C           *IN31     ANDEQ'1'                                       068230
      *                                                                   068230
     C           *IN32     OREQ '1'                                       068230
     C           *IN31     ANDEQ'0'                                       068230
     C                     ADD  1         I                               068230
     C                     MOVE ' 059'    ERCD,I                          068230
     C                     SETON                     46                   068230
     C                     ELSE                                           068230
     C                     MOVE 'S'       WBNCT                           068230
     C                     MOVEA##002     *IN,31                          068230
     C                     GOTO GA500                                     068230
     C                     END                                            068230
      *                                                                   068230
     C                     END                                            068230
      *                                                                   068230
     C                     MOVEA##002     *IN,31                          068230
     C                     END                                            068230
     C*                                                                   CFT004
     C** IBAN                                                             CFT004
     C** If beneficiary start with '/aann' or 'aann'                      CFT004
     C** validate as an IBAN (INTERNATIONAL BANK ACCOUNT NUMBER)          CFT004
     C** having first formatted field removing blanks and IBAN prefix     CFT004
     C*                                                                   CFT004
     C           CFT004    IFEQ 'Y'                                       CFT004
     C*                                                                   CFT004
     C           BCSL      IFEQ '/'                                       CFT004
     C           34        SUBSTSBNC1:2   PIBAN                           CFT004
     C                     ELSE                                           CFT004
     C                     MOVELSBNC1     PIBAN                           CFT004
     C                     ENDIF                                          CFT004
     C*                                                                   CFT004
     C                     CALL 'AOIBANR3'                                CFT004
     C                     PARM           @RTCD                           CFT004
     C                     PARM           PIBAN  47                       CFT004
     C                     PARM           POWITH 47                       CFT004
     C           P@IBAN    PARM           PONOBL 34                       CFT004
     C*                                                                   CFT004
     C           1         SUBSTP@IBAN:1  BCTY1   1                       CFT004
     C           1         SUBSTP@IBAN:2  BCTY2   1                       CFT004
     C           1         SUBSTP@IBAN:3  BDGT1   1                       CFT004
     C           1         SUBSTP@IBAN:4  BDGT2   1                       CFT004
     C           BCTY1     LOKUPALPH                     94               CFT004
     C   94      BCTY2     LOKUPALPH                     94               CFT004
     C   94      BDGT1     LOKUPNUMC                     94               CFT004
     C   94      BDGT2     LOKUPNUMC                     94               CFT004
     C*                                                                   CFT004
     C* Check that it is a valid IBAN                                     CFT004
     C           *IN94     IFEQ *ON                                       CFT004
     C                     MOVE *BLANKS   DSSDY                           CFT004
     C                     CALL 'AOIBANR2'                                CFT004
     C                     PARM           @RTCD                           CFT004
     C                     PARM           P@IBAN 34                       CFT004
     C           P@ACCN    PARM           DSSDY                           CFT004
      *                                                                   CFT004
      * Invalid Country                                                   CFT004
     C           @RTCD     IFEQ '      1'                                 CFT004
     C                     ADD  1         I                               CFT004
     C                     MOVE '201'     ERCD,I                          CFT004
     C                     MOVE '1'       *IN46                           CFT004
     C                     GOTO GA500                                     CFT004
     C                     ENDIF                                          CFT004
      * Invalid BBAN length on country file                               CFT004
     C           @RTCD     IFEQ '      2'                                 CFT004
     C                     ADD  1         I                               CFT004
     C                     MOVE '202'     ERCD,I                          CFT004
     C                     MOVE '1'       *IN46            Pos. Cursor    CFT004
     C                     GOTO GA500                                     CFT004
     C                     ENDIF                                          CFT004
      * IBAN contains Invalid Characters                                  CFT004
     C           @RTCD     IFEQ '      3'                                 CFT004
     C                     ADD  1         I                               CFT004
     C                     MOVE '203'     ERCD,I                          CFT004
     C                     MOVE '1'       *IN46            Pos. Cursor    CFT004
     C                     GOTO GA500                                     CFT004
     C                     ENDIF                                          CFT004
      * IBAN length of BBAN is incorrect                                  CFT004
     C           @RTCD     IFEQ '      4'                                 CFT004
     C                     ADD  1         I                               CFT004
     C                     MOVE '204'     ERCD,I                          CFT004
     C                     MOVE '1'       *IN46            Pos. Cursor    CFT004
     C                     GOTO GA500                                     CFT004
     C                     ENDIF                                          CFT004
      * Checks Digits are not corrects                                    CFT004
     C           @RTCD     IFEQ '      5'                                 CFT004
     C                     ADD  1         I                               CFT004
     C                     MOVE '205'     ERCD,I                          CFT004
     C                     MOVE '1'       *IN46            Pos. Cursor    CFT004
     C                     GOTO GA500                                     CFT004
     C                     ENDIF                                          CFT004
      * Valid IBAN but not on the system, Process as Customer name and    CFT004
      * Address field                                                     CFT004
     C           @RTCD     IFEQ '      6'                                 CFT004
     C                     MOVE 'A'       WBNCT                           CFT004
     C                     GOTO GA500                                     CFT004
     C                     ENDIF                                          CFT004
      *                                                                   CFT004
      * Check if Account Currency matchs with the pay currency            CFT004
     C           @RTCD     IFEQ *BLANKS                                   CFT004
     C           CCY       IFEQ SPCCY                                     CFT004
     C           '/'       CAT  P@IBAN    SBNC1                           CFT004
     C**********           Z-ADDIBCNUM    CNUM                                         CFT004 CSD027
     C                     MOVE IBCNUM    CNUM                                                CSD027
     C                     Z-ADDIBACOD    ACOD                            CFT004
     C                     Z-ADDIBACSQ    ACSQ                            CFT004
     C                     Z-ADDIBLCD     LCD                             CFT004
     C                     MOVE IBBRCA    BRCA                            CFT004
     C                     MOVE 'I'       WBNCT                           CFT004
     C                     GOTO GA500                                     CFT004
     C                     ELSE                                           CFT004
     C                     MOVE '1'       *IN46            Pos. Cursor    CFT004
     C                     ADD  1         I                               CFT004
     C                     MOVE '200'     ERCD,I                          CFT004
     C                     GOTO GA500                                     CFT004
     C                     ENDIF                                          CFT004
     C                     ENDIF                                          CFT004
     C                     ENDIF                                          CFT004
      *                                                                   CFT004
     C                     ENDIF                            E001          CFT004
      *                                                                   CFT004
     C*
     C* IF MORE THAN ONE FIELD IS ENTERED, VALIDATE AS AN ADDRESS
     C* ALSO CHECK FIRST LINE FOR MORE THAN TWELVE CHARACTERS
     C*
     C                     MOVE SBNC1     WA23   23
     C           WA23      IFNE *BLANKS
     C*
     C           SBNC1     ORNE *BLANK
     C           SBNC2     ANDNE*BLANK
     C*
     C           SBNC1     ORNE *BLANK
     C           SBNC3     ANDNE*BLANK
     C*
     C           SBNC1     ORNE *BLANK
     C           SBNC4     ANDNE*BLANK
     C*
     C           SBNC1     ORNE *BLANK
     C           SBNC5     ANDNE*BLANK
     C*
     C           SBNC2     ORNE *BLANK
     C           SBNC3     ANDNE*BLANK
     C*
     C           SBNC2     ORNE *BLANK
     C           SBNC4     ANDNE*BLANK
     C*
     C           SBNC2     ORNE *BLANK
     C           SBNC5     ANDNE*BLANK
     C*
     C           SBNC3     ORNE *BLANK
     C           SBNC4     ANDNE*BLANK
     C*
     C           SBNC3     ORNE *BLANK
     C           SBNC5     ANDNE*BLANK
     C*
     C           SBNC4     ORNE *BLANK
     C           SBNC5     ANDNE*BLANK
     C*
     C                     SETOF                     919293
     C                     SETOF                     9425
     C*
     C                     MOVE *BLANKS   ADDRSS
     C*
     C                     MOVELSBNC1     ADCHK1
     C                     MOVELSBNC2     ADCHK2
     C                     MOVELSBNC3     ADCHK3
     C                     MOVELSBNC4     ADCHK4
     C                     MOVELSBNC5     ADCHK5
     C*
     C                     MOVE 'A'       WBNCT
     C/COPY WNCPYSRC,FT0050C168
     C*
     C                     EXSR ADCHK
     C/COPY WNCPYSRC,FT0050C169
     C*
     C** DEPENDING ON THE INDICATORS, HIGHLIGHT THE FIELD IN ERROR
     C** ERROR AND PRODUCE THE ERROR MESSAGE
     C           *IN92     IFEQ '1'
     C                     SETON                     462575
     C                     ADD  1         I
     C*********************MOVE '474'     ERCD,I                          S01117
     C                     MOVE '061'     ERCD,I                          S01117
     C                     END
     C*
     C           *IN93     IFEQ '1'
     C                     SETON                     462575
     C                     END
     C*
     C                     ELSE                                           E37171
     C                     SETON                     462575               E37171
     C                     ADD  1         I                               E37171
     C                     MOVE '061'     ERCD,I                          E37171
     C*                                                                   E37171
     C                     END
     C**     I.E. BEGINS WITH '/'
     C*
     C*
     C           SBNC5     IFNE *BLANKS                    B001
     C           BCSL      ANDNE'/'
     C           S         ADD  1         I
     C*********************MOVE '115'     ERCD,I                          S01117
     C                     MOVE '054'     ERCD,I                          S01117
     C                     SETON                     46
     C                     END                             E001
     C*
     C  N46                MOVE 'A'       WBNCT
     C*
     C*          *****     ***
     C           GA500     TAG
     C*          *****     ***
     C*
     C*  IF A VALID ACCOUNT HAS BEEN ENTERED STORE THE ACCOUNT TYPE AND
     C*     THE DATE THE ACCOUNT WAS OPENED
     C*
     C                     MOVEL*BLANKS   PYFLDS                          S01195
     C           *IN46     IFEQ '0'
     C           WBNCT     IFEQ 'R'
     C           WBNCT     OREQ 'P'
     C           CFT004    OREQ 'Y'                                       CFT004
     C           WBNCT     ANDEQ'I'                                       CFT004
     C*
     C                     MOVE ATYP      ATYP3   1
     C                     MOVE ACST      ACST3                           047179
     C                     Z-ADDDACO      DACO3   50
     C*
      * Store full account details for FT Transaction Status File         S01435
      * record update.                                                    S01435
     C**********           Z-ADDCNUM      IMCNUM                                       S01435 CSD027
     C                     MOVE CNUM      IMCNUM                                              CSD027
     C                     MOVE CCY       IMCCY                           S01435
     C                     Z-ADDACOD      IMACOD                          S01435
     C                     Z-ADDACSQ      IMACSQ                          S01435
     C                     MOVE BRCA      IMBRCA                          S01435
     C                     MOVELIMACNT    BNCDS                           S01435
      *                                                                   S01435
     C** ALSO SAVE FIELDS NEEDED TO SET DEFAULT PAY VALUE DATE            S01195
     C                     MOVELCNUM      CNUMPY                          S01195
     C                     MOVELCCY       CCYPY                           S01195
     C                     MOVELACOD      ACODPY                          S01195
     C                     MOVELACSQ      ACSQPY                          S01195
     C                     MOVELBRCA      BRCAPY                          S01195
     C*                                                                   S01195
     C                     TESTB'3'       RETB           08               179420
     C           *IN08     IFEQ '1'                        B002           179420
      *                                                                   179420
      ** Error: Credits are blocked against this account.                 179420
      *                                                                   179420
     C                     MOVE '1'       *IN46                           179420
     C                     MOVE '1'       *IN16                           179420
     C                     MOVEL'Y'       FTNOUP                          179420
     C                     MOVEL'FTM0019' FTMSID                          179420
     C                     EXSR FTSNMS                                    179420
     C                     ENDIF                                          179420
      *                                                                   179420
     C/COPY WNCPYSRC,FT0050C014
     C                     END
     C                     END
     C/COPY WNCPYSRC,FT0050C107
     C*
     C*
     C**********************************
     C** VALIDATE A/C WITH BANK FIELD **
     C**********************************
     C*
     C***********          MOVEL*BLANKS   WACBT                           056031
     C                     MOVEL*BLANKS   WACBT   1                       056031
     C                     MOVE *BLANK    ACST4   1                       047179
     C/COPY WNCPYSRC,FT0050C102
     C*
     C** CHECK THAT SACBK  FIELD DOES NOT CONTAIN '?' - ERROR IF IT DOES  S01194
     C*                                                                   S01194
     C                     SETOF                     18                   S01194
     C                     MOVEA*BLANKS   QUERY                           S01194
     C                     MOVEASACB15    QUERY                           S01194
     C           '?'       LOKUPQUERY                    18               S01194
     C*                                                                   S01194
     C           *IN18     IFEQ '1'                                       S01194
     C                     ADD  1         I                               S01194
     C                     MOVE '053'     ERCD,I                          S01194
     C                     SETON                     47                   S01194
     C                     GOTO GA400                                     S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C***FIELD*IS*MANDATORY*IF*BENEFICIARY*IS*A*NAME*AND*ADDRESS          E22881
     C*****OTHERWISE*IT*IS*OPTIONAL*****************************          E22881
     C*
     C** FIELD IS MANDATORY IF BENEFICIARY IS A NAME AND ADDRESS          E22881
     C** CUSTOMER NUMBER, SHORTNAME OR SWIFT ADDRESS OTHERWISE            E22881
     C** IT IS OPTIONAL                                                   E22881
     C***********SACBK     IFEQ *BLANKS                                   S01117
     C           SACB15    IFEQ *BLANKS                                   S01117
     C           WBNCT     IFEQ 'A'
     C           WBNCT     OREQ 'C'                                       E22881
     C           WBNCT     OREQ 'S'                                       E22881
     C                     SETON                     47
     C                     ADD  1         I
     C*********************MOVE '337'     ERCD,I                          S01117
     C                     MOVE '050'     ERCD,I                          S01117
     C                     END
     C                     GOTO GA400
     C                     END
     C*
     C** THERE MUST BE NO EMBEDDED SPACES IN THE FIELD
     C*
     C                     MOVEL*BLANKS   YA3
     C***********          MOVEASACBK     YA3,1                           S01117
     C                     MOVEASACB15    YA3,1                           S01117
     C*
     C                     SETOF                     8889
     C                     Z-ADD1         I1
     C*
     C           *IN89     DOUEQ'1'
     C***********I1        ORGT 12                                        S01117
     C           I1        ORGT 15                                        S01117
     C           YA3,I1    IFEQ *BLANKS
     C                     SETON                     88
     C                     ELSE
     C           *IN88     IFEQ '1'
     C                     SETON                     89
     C                     END
     C                     END
     C                     ADD  1         I1
     C                     END
     C*
     C           *IN89     IFEQ '1'
     C           *IN60     IFEQ '1'                        -ASSIGN
     C                     ADD  1         I                 ERROR CODE
     C*********************MOVE '112'     ERCD,I            112 IF        S01117
     C                     MOVE '041'     ERCD,I                          S01117
     C                     SETOF                     60     OUTSTANDING
     C                     END
     C                     ADD  1         I
     C*********************MOVE '114'     ERCD,I                          S01117
     C                     MOVE '049'     ERCD,I                          S01117
     C                     SETON                     47
     C                     GOTO GA400
     C                     END
     C*
     C** DETERMINE IF THE PAY CURRENCY ENTERED WAS VALID.
     C** (IF NO PAY CURRENCY ENTERED,THIS DEPENDS ON VALIDITY OF
     C**  SETTLE CURRENCY ENTERED). INDICATOR 87 ON IF INVALID.
     C*
     C                     SETOF                     87
     C*
     C           SPCCY     IFNE *BLANKS
     C           *IN56     IFEQ '1'                           -INVALID
     C                     SETON                     87        SET CCY.
     C                     END
     C                     ELSE
     C           *IN50     IFEQ '1'                           -INVALID
     C                     SETON                     87        PAY CCY.
     C                     END
     C                     END
     C*
     C** CHECK IF LESS THAN 2 CHARACTERS WERE ENTERED - INVALID
     C*
     C           YA3,2     IFEQ *BLANKS
     C           *IN60     IFEQ '1'                        -ASSIGN
     C                     ADD  1         I                 ERROR CODE
     C*********************MOVE '112'     ERCD,I            112 IF        S01117
     C                     MOVE '041'     ERCD,I                          S01117
     C                     SETOF                     60     OUTSTANDING
     C                     END
     C                     ADD  1         I
     C*********************MOVE '114'     ERCD,I                          S01117
     C                     MOVE '049'     ERCD,I                          S01117
     C                     SETON                     47
     C                     GOTO GA400
     C                     END
     C*
     C** CHECK IF EXACTLY 2 CHARACTERS WERE ENTERED;IF SO CHECK THAT
     C** THEY ARE NUMERIC & IF THEY ARE AND THE PAY CCY ENTERED WAS
     C** VALID,VALIDATE THIS FIELD AS BEING A NOSTRO - MUST BE ON
     C** TABLE FILE
     C*
     C           YA3,3     IFEQ *BLANKS
     C                     MOVEAYA3,1     WA2     2
     C                     MOVE WA2       WN2     20
     C                     MOVE WN2       WA2A    2
     C           WA2A      IFNE WA2                        -ALPHA
     C           *IN60     IFEQ '1'                        -ASSIGN
     C                     ADD  1         I                 ERROR CODE
     C*********************MOVE '112'     ERCD,I            112 IF        S01117
     C                     MOVE '041'     ERCD,I                          S01117
     C                     SETOF                     60     OUTSTANDING
     C                     END
     C                     ADD  1         I
     C*********************MOVE '114'     ERCD,I                          S01117
     C                     MOVE '049'     ERCD,I                          S01117
     C                     SETON                     47
     C                     GOTO GA400
     C                     ELSE
     C           *IN87     IFNE '1'
     C***********          MOVEL*BLANKS   ZTABKY                          S01194
     C***********          MOVEL'70'      ZTABKY                          S01194
     C***********          MOVELWPCCY     WA5                             S01194
     C***********          MOVE WN2       WA5                             S01194
     C***********          MOVE WA5       ZTABKY                          S01194
     C***********          EXSR UATBCN                                    S01194
     C*                                                                   S01194
     C                     CALL 'AONOSTR0'                                S01194
     C                     PARM *BLANKS   @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM *BLANKS   @CUST   6                       S01194
     C                     PARM WPCCY     @CYCD   3                       S01194
     C**********           PARM *BLANKS   @ACCN   4                                    S01194 CGL029
     C                     PARM *BLANKS   @ACCN                                               CGL029
     C                     PARM *BLANKS   @ACSN   2                       S01194
     C                     PARM WA2A      @NONB   2                       S01194
     C                     PARM *BLANKS   @BRCD   3                       S01194
     C                     PARM *BLANKS   @CSSN  10                       S01194
     C                     PARM *BLANKS   @PNOI   1                       S01194
     C           SDNOST    PARM SDNOST    DSFDY                           S01194
     C*                                                                   S01194
     C           @RTCD     CASEQ*BLANK    MVNOS1     8989                 S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C           *IN89     IFEQ '1'                         -FAILED.
     C                     ADD  1         I
     C*********************MOVE '109'     ERCD,I                          S01117
     C                     MOVE '045'     ERCD,I                          S01117
     C                     SETON                     47
     C                     GOTO GA400
     C                     ELSE
     C                     MOVEL'N'       WACBT
     C**
     C*    STORE FIELDS FOR KEY TO ACCNT
     C**
     C**********           Z-ADDCNUM      CNUMSV  60                                          CSD027
     C                     MOVE CNUM      CNUMSV  6                                           CSD027
     C                     MOVELWPCCY     CCYSV   3
     C**********           Z-ADDACOD      ACODSV  40                                          CGL029
     C                     Z-ADDACOD      ACODSV                                              CGL029
     C                     Z-ADDACSQ      ACSQSV  20
     C                     MOVE BRCA      BRCASV  3                       S01117
     C/COPY WNCPYSRC,FT0050C197
     C*
     C                     GOTO GA400                       -VALID.
     C                     END
     C                     END
     C                     END
     C                     END
     C*
     C** CHECK IF LESS THAN 10 CHARACTERS WERE ENTERED - INVALID
     C*
     C           YA3,10    IFEQ *BLANKS
     C           *IN60     IFEQ '1'                        -ASSIGN
     C                     ADD  1         I                 ERROR CODE
     C*********************MOVE '112'     ERCD,I            112 IF        S01117
     C                     MOVE '041'     ERCD,I                          S01117
     C                     SETOF                     60     OUTSTANDING
     C                     END
     C                     ADD  1         I
     C*********************MOVE '114'     ERCD,I                          S01117
     C                     MOVE '049'     ERCD,I                          S01117
     C                     SETON                     47
     C                     GOTO GA400
     C                     END
     C*
     C** IF RETAIL MODULE IS PRESENT & RETAIL A/C NOS. ARE USED:
     C** CHECK IF EXACTLY 10 CHARACTERS WERE ENTERED & THEN IF THESE
     C** WERE NUMERIC; IF SO VALIDATE IT AS
     C** BEING A LIVE RETAIL ACCOUNT - MUST BE ON ACNUMA FILE;
     C** ALSO A/C MUST BE IN PAY CCY (IF THIS WAS VALID)
     C*
     C           *IN32     IFEQ '1'
     C*
     C           YA3,11    IFEQ *BLANKS
     C                     MOVEAYA3,1     WA10
     C                     MOVE WA10      WN10
     C                     MOVE WN10      WA10A
     C           WA10      IFNE WA10A                        -ALPHA
     C           *IN60     IFEQ '1'                        -ASSIGN
     C                     ADD  1         I                 ERROR CODE
     C*********************MOVE '112'     ERCD,I            112 IF        S01117
     C                     MOVE '041'     ERCD,I                          S01117
     C                     SETOF                     60     OUTSTANDING
     C                     END
     C                     ADD  1         I
     C*********************MOVE '114'     ERCD,I                          S01117
     C                     MOVE '049'     ERCD,I                          S01117
     C                     SETON                     47
     C                     GOTO GA400
     C                     ELSE                              -NUMERIC
     C                     MOVE WN10      ACNO
     C                     EXSR UMAACN
     C           *IN89     IFEQ '1'
     C                     ADD  1         I
     C*********************MOVE '110'     ERCD,I                          S01117
     C                     MOVE '046'     ERCD,I                          S01117
     C                     SETON                     47
     C                     GOTO GA400
     C                     ELSE
     C/COPY WNCPYSRC,FT0050C103
     C*
     C** IF RETAIL ACCOUNTS NOT ALLOWED, DISPLAY ERROR MESSAGE
     C*
     C***********RACN      IFNE 'Y'                                       S01194
     C           BMRANR    IFNE 'Y'                                       S01194
     C                     ADD  1         I
     C*********************MOVE '414'     ERCD,I                          S01117
     C                     MOVE '029'     ERCD,I                          S01117
     C                     SETON                     47
     C                     GOTO GA400
     C                     ELSE
     C*
     C           *IN87     IFNE '1'
     C           CCY       ANDNEWPCCY
     C           *IN60     IFEQ '1'                        -ASSIGN
     C                     ADD  1         I                 ERROR CODE
     C*********************MOVE '112'     ERCD,I            112 IF        S01117
     C                     MOVE '041'     ERCD,I                          S01117
     C                     SETOF                     60     OUTSTANDING
     C                     END
     C                     ADD  1         I
     C*********************MOVE '113'     ERCD,I                          S01117
     C                     MOVE '048'     ERCD,I                          S01117
     C                     SETON                     47
     C                     GOTO GA400
     C                     ELSE                            -VALID
     C                     MOVEL'R'       WACBT             RETAIL A/C
     C                     GOTO GA400
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C*
     C                     END
     C*
     C** CHECK IF LESS THAN 12 CHARACTERS WERE ENTERED - INVALID
     C**                    15 CHARACTERS IF MULTI-BRANCHED               S01117
     C*
     C           YA3,12    IFEQ *BLANKS
     C           *IN10     ANDEQ'0'                                       S01117
     C           YA3,15    OREQ *BLANKS                                   S01117
     C           *IN10     ANDEQ'1'                                       S01117
     C           *IN60     IFEQ '1'                        -ASSIGN
     C                     ADD  1         I                 ERROR CODE
     C*********************MOVE '112'     ERCD,I            112 IF        S01117
     C                     MOVE '041'     ERCD,I                          S01117
     C                     SETOF                     60     OUTSTANDING
     C                     END
     C                     ADD  1         I
     C*********************MOVE '114'     ERCD,I                          S01117
     C                     MOVE '049'     ERCD,I                          S01117
     C                     SETON                     47
     C                     GOTO GA400
     C                     END
     C*
     C** 12 CHARACTERS WERE ENTERED.CHECK IF THESE
     C** WERE NUMERIC; IF SO & THE PAY CCY ENTERED WAS VALID,
     C** VALIDATE THIS FIELD AS BEING A LIVE FULL ACCOUNT - MUST BE
     C** ON ACCNT FILE
     C*
     C**********           MOVEAYA3,1     WA12   12                                           CGL029
     C**********           MOVE WA12      WN12   120                                          CGL029
     C**********           MOVE WN12      WA12A  12                                           CGL029
     C********** WA12      IFNE WA12A                        -ALPHA                           CGL029
     C                     MOVEAYA3,1     WWA18  18                                           CGL029
     C                     MOVE WWA18     WN18   180                                          CGL029
     C                     MOVE WN18      WA18A  18                                           CGL029
     C           WWA18     IFNE WA18A                                                         CGL029
     C           *IN60     IFEQ '1'                        -ASSIGN
     C                     ADD  1         I                 ERROR CODE
     C*********************MOVE '112'     ERCD,I            112 IF        S01117
     C                     MOVE '041'     ERCD,I                          S01117
     C                     SETOF                     60     OUTSTANDING
     C                     END
     C                     ADD  1         I
     C*********************MOVE '114'     ERCD,I                          S01117
     C                     MOVE '049'     ERCD,I                          S01117
     C                     SETON                     47
     C                     GOTO GA400
     C                     ELSE                              -NUMERIC
     C           *IN87     IFNE '1'
     C                     MOVEAYA3,1     WA6
     C**********           MOVEAYA3,7     WA4                                                 CGL029
     C**********           MOVEAYA3,11    WA2                                                 CGL029
     C                     MOVEAYA3,7     WWA10                                               CGL029
     C                     MOVEAYA3,17    WA2                                                 CGL029
     C                     MOVE WA6       KACNUM
     C                     MOVELWPCCY     KACCCY
     C**********           MOVE WA4       KACCD                                               CGL029
     C                     MOVE WWA10     KACCD                                               CGL029
     C                     MOVE WA2       KACSQ
     C  N10                MOVE BJSBRC    KBRCA                           S01117
     C   10                MOVE SACBB     KBRCA                           S01117
     C                     EXSR UOACCN
     C           *IN89     IFEQ '1'
     C                     ADD  1         I
     C*********************MOVE '111'     ERCD,I                          S01117
     C                     MOVE '047'     ERCD,I                          S01117
     C                     SETON                     47
     C                     GOTO GA400
     C                     ELSE                            -VALID
     C/COPY WNCPYSRC,FT0050C104
     C                     MOVEL'P'       WACBT             PARTIAL A/C
     C                     END
     C                     END
     C                     END
     C*
     C*          *****     ***
     C           GA400     TAG
     C*          *****     ***
     C*
     C*  IF A VALID ACCOUNT HAS BEEN ENTERED STORE THE ACCOUNT TYPE AND
     C*     THE DATE THE ACCOUNT WAS OPENED
     C*
     C           *IN47     IFEQ '0'
     C           WACBT     IFEQ 'N'
     C           WACBT     OREQ 'R'
     C           WACBT     OREQ 'P'
     C*
     C*  FOR A NOSTRO FIRST ACCESS THE ACCNT RECORD
     C*
     C           WACBT     IFEQ 'N'
     C                     EXSR ACCCHN
     C                     END
     C*
     C                     MOVE ATYP      ATYP4   1
     C                     MOVE ACST      ACST4                           047179
     C                     Z-ADDDACO      DACO4   50
     C*
      * Store full account details for FT Transaction Status File         S01435
      * record update.                                                    S01435
     C**********           Z-ADDCNUM      IMCNUM                                       S01435 CSD027
     C                     MOVE CNUM      IMCNUM                                              CSD027
     C                     MOVE CCY       IMCCY                           S01435
     C                     Z-ADDACOD      IMACOD                          S01435
     C                     Z-ADDACSQ      IMACSQ                          S01435
     C                     MOVE BRCA      IMBRCA                          S01435
     C                     MOVELIMACNT    ACBDS                           S01435
      *                                                                   S01435
     C** ALSO SAVE FIELDS NEEDED TO SET DEFAULT PAY VALUE DATE            S01195
     C                     MOVELCNUM      CNUMPY                          S01195
     C                     MOVELCCY       CCYPY                           S01195
     C                     MOVELACOD      ACODPY                          S01195
     C                     MOVELACSQ      ACSQPY                          S01195
     C                     MOVELBRCA      BRCAPY                          S01195
     C*                                                                   S01195
     C                     TESTB'3'       RETB           08               179420
     C           *IN08     IFEQ '1'                        B002           179420
      *                                                                   179420
      ** Error: Credits are blocked against this account.                 179420
      *                                                                   179420
     C                     MOVE '1'       *IN47                           179420
     C                     MOVE '1'       *IN16                           179420
     C                     MOVEL'Y'       FTNOUP                          179420
     C                     MOVEL'FTM0019' FTMSID                          179420
     C                     EXSR FTSNMS                                    179420
     C                     ENDIF                           E002           179420
      *                                                                   179420
     C/COPY WNCPYSRC,FT0050C015
     C                     END
     C                     END
     C*
     C*
     C           *IN60     IFEQ '1'                        -ASSIGN
     C                     ADD  1         I                 ERROR CODE
     C*********************MOVE '112'     ERCD,I            112 IF        S01117
     C                     MOVE '041'     ERCD,I                          S01117
     C                     SETOF                     60     OUTSTANDING
     C                     END
     C/COPY WNCPYSRC,FT0050C081
     C*
     C****************************
     C** VALIDATE AMOUNT FIELDS **
     C****************************
     C** SETTLE AMOUNT FIELD MUST BE 13-LONG NUMERIC WITH NUMBER OF
     C** D.P.S. DEPENDENT ON THE PAY CURRENCY
     C*
     C***********          SETOF                     8788                 CEU006
     C                     SETOF                     878889               CEU006
     C*
     C                     Z-ADDSVSCDP    ZADEC
     C           13        SUB  SVSCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SSMAM     ZFIELD
     C/COPY WNCPYSRC,FT0050C116
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WSMAM  130
     C/COPY WNCPYSRC,FT0050C122
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     87
     C                     END
     C*
     C** PAY AMOUNT FIELD MUST BE 13-LONG NUMERIC WITH NUMBER OF D.P.S
     C** DEPENDENT ON THE PAY CURRENCY
     C*
     C                     Z-ADDSVPCDP    ZADEC
     C           13        SUB  SVPCDP    ZADIG
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE SPYAM     ZFIELD
     C/COPY WNCPYSRC,FT0050C117
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    WPYAM  130
     C/COPY WNCPYSRC,FT0050C123
     C*
     C           *IN99     IFEQ '1'                         -ERROR
     C                     SETON                     88
     C                     END
     C*
     C** NOTIFIED DELIVERY AMOUNT MUST BE 13-LONG NUMERIC WITH NUMBER     CEU006
     C** OF D.P.S DEPENDENT ON THE NOTIFIED DELIVERY CURRENCY             CEU006
     C*                                                                   CEU006
     C*                                                                   CFT003
     C           CEU006    IFEQ 'Y'                                       CFT003
     C           CFT014    OREQ 'Y'                                       CFT014
     C*                                                                   CFT003
     C           SNDAM     IFNE *BLANKS                     -ERROR        CEU006
     C           SNDCY     ANDEQ*BLANKS                     -ERROR        CEU006
     C                     ADD  1         I                               CEU006
     C***********          MOVEL'FTM2586' FTMSID                   CEU006 CFT014
     C                     MOVEL'FTM3155' FTMSID                          CFT014
     C                     MOVEL'FTUSRMSG'FTMSGF                          CEU006
     C                     EXSR FTSNMS                                    CEU006
     C                     MOVEA'11'      *IN,28                          CEU006
     C                     END                                            CEU006
     C*                                                                   CEU006
     C** NOTIFIED DELIVERY CURRENCY MUST BE 13-LONG NUMERIC WITH NO.      CEU006
     C** OF DECIMAL PLACED DEPENDENT ON PAY CURRENCY                      CEU006
     C*                                                                   CEU006
     C                     Z-ADDW3NBDP    ZADEC                           CEU006
     C           13        SUB  W3NBDP    ZADIG                           CEU006
     C                     MOVEL*BLANKS   ZFIELD                          CEU006
     C                     MOVE SNDAM     ZFIELD                          CEU006
     C/COPY WNCPYSRC,FT0050C118
     C                     EXSR ZALIGN                                    CEU006
     C                     MOVE ZFIELD    WNDAM  130                      CEU006
     C/COPY WNCPYSRC,FT0050C124
     C*                                                                   CEU006
     C           *IN99     IFEQ '1'                         -ERROR        CEU006
     C                     SETON                     89                   CEU006
     C                     ENDIF                                          CEU006
     C*                                                                   CFT003
     C                     ENDIF                                          CFT003
     C/COPY WNCPYSRC,FT0050C125
     C*
     C** CHECK IF RECIEVE AMOUNT IS IN WRONG FORMAT
     C*
     C           *IN87     IFEQ '1'
     C                     ADD  1         I
     C*********************MOVE '126'     ERCD,I                          S01117
     C                     MOVE '064'     ERCD,I                          S01117
     C                     SETON                     49
     C                     END
     C*
     C** CHECK IF NEITHER AMOUNT ENTERED - INVALID
     C*
     C           CEU006    IFNE 'Y'                                       CEU006
     C           CFT014    ANDNE'Y'                                       CFT014
      *                                                                   CEU006
     C           WSMAM     IFEQ *ZERO
     C           WPYAM     ANDEQ*ZERO
     C           *IN87     ANDNE'1'
     C           *IN88     ANDNE'1'
     C                     ADD  1         I
     C*********************MOVE '127'     ERCD,I                          S01117
     C                     MOVE '065'     ERCD,I                          S01117
     C                     SETON                     4955
     C                     END
      *                                                                   CEU006
     C                     ELSE                                           CEU006
      *                                                                   CEU006
     C           WSMAM     IFEQ *ZERO                                     CEU006
     C           WPYAM     ANDEQ*ZERO                                     CEU006
     C           WNDAM     ANDEQ*ZERO                                     CEU006
     C           *IN87     ANDNE'1'                                       CEU006
     C           *IN88     ANDNE'1'                                       CEU006
     C           *IN89     ANDNE'1'                                       CEU006
     C                     ADD  1         I                               CEU006
     C***********          MOVEL'FTM2583' FTMSID                   CEU006 CFT014
     C                     MOVEL'FTM3156' FTMSID                          CFT014
     C                     MOVEL'FTUSRMSG'FTMSGF                          CEU006
     C                     EXSR FTSNMS                                    CEU006
     C                     MOVE *ON       *IN29                           CEU006
     C                     MOVE *ON       *IN49                           CEU006
     C                     MOVE *ON       *IN55                           CEU006
     C                     ENDIF                                          CEU006
     C                     ENDIF                                          CEU006
     C*
     C** CHECK IF PAY AMOUNT IS IN WRONG FORMAT
     C*
     C           *IN88     IFEQ '1'
     C                     ADD  1         I
     C*********************MOVE '128'     ERCD,I                          S01117
     C                     MOVE '072'     ERCD,I                          S01117
     C                     SETON                     55
     C                     END
     C*                                                                   CEU006
     C** CHECK IF NOTIFIED DELIVERY AMOUNT IS IN WRONG FORMAT             CEU006
     C*                                                                   CEU006
     C           CEU006    IFEQ 'Y'                                       CFT003
     C           CFT014    OREQ 'Y'                                       CFT014
     C           *IN89     IFEQ '1'                                       CEU006
     C***********          MOVEL'FTM2559' FTMSID                   CEU006 CFT014
     C                     MOVEL'FTM3157' FTMSID                          CFT014
     C                     MOVEL'FTUSRMSG'FTMSGF                          CEU006
     C                     MOVEL'Y'       FTNOUP                          CEU006
     C                     EXSR FTSNMS                                    CEU006
     C                     MOVE *ON       *IN29                           CEU006
     C                     ENDIF                                          CEU006
     C                     ENDIF                                          CFT003
      *                                                                                       CRE008
      ** Move key fields to variable if CRE008 is installed.                                  CRE008
      *                                                                                       CRE008
     C           CRE008    IFEQ 'Y'                                                           CRE008
     C           *IN49     ANDEQ'0'                                                           CRE008
     C                     MOVE WSMAM     PSETAM 150                                          CRE008
     C                     ENDIF                                                              CRE008
     C*                                                                   CEU006
     C*                                                                   CEU006
     C*****************************                                       CEU006
     C** VALIDATE SETTLE VALUE DATE **                                    CEU006
     C*****************************                                       CEU006
     C/COPY WNCPYSRC,FT0050C058
     C**   IF DATE IS NOT ENTERED, SET TO SYSTEM DATE                     CEU006
     C**     OTHERWISE VALIDATE AS BEING A VALID DATE                     CEU006
     C*                                                                   CEU006
     C           SSLDT     IFEQ *BLANKS                                   CEU006
     C                     Z-ADDBJRDNB    WSLDT   50                      CEU006
      *                                                                   CEU006
      *Ensure that date is not before EMU transition start date if        CEU006
      *either Notified Delivery or settlement currency is Euro and        CEU006
      *the other is "In".                                                 CEU006
      *                                                                   CEU006
     C           CEU006    IFEQ 'Y'                                       CEU006
     C           W3INCY    IFEQ 'Y'                                       CEU006
     C           SSMCY     ANDEQBKEURO                                    CEU006
     C           W3TPSD    ANDGTWSLDT                                     CEU006
     C           W1INCY    OREQ 'Y'                                       CEU006
     C           SNDCY     ANDEQBKEURO                                    CEU006
     C           W1TPSD    ANDGTWSLDT                                     CEU006
     C                     MOVEL'FTM2560' FTMSID                          CEU006
     C                     MOVEL'FTUSRMSG'FTMSGF                          CEU006
     C                     MOVEL'Y'       FTNOUP                          CEU006
     C                     EXSR FTSNMS                                    CEU006
     C                     MOVE *ON       *IN51                           CEU006
     C                     ENDIF                                          CEU006
     C                     ENDIF                                          CEU006
      *                                                                   CEU006
     C                     ELSE                                           CEU006
     C* CHECK IF DATE IS NUMERIC                                          CEU006
     C                     MOVELSSLDT     DATEL   70                      CEU006
     C                     MOVELDATEL     DATES   6                       CEU006
     C           SSLDT     IFNE DATES                      B002           CEU006
     C                     SETON                     99                   CEU006
     C                     ELSE                            X002           CEU006
     C                     MOVE SSLDT     ZDATE                           CEU006
     C                     EXSR ZDATE1                                    CEU006
     C                     Z-ADDZDAYNO    WSLDT                           CEU006
      ** THE SETTLE DATE MUST NOT BE A HOLIDAY IN LOCAL CURRENCY          CEU006
      *                                                                   CEU006
     C                     MOVE BJLCCY    ZCCY                            CEU006
     C                     EXSR ZCHKH                                     CEU006
      *                                                                   CEU006
      ** if ZIND = 'H' then the date is a holiday                         CEU006
     C           ZIND      IFEQ 'H'                        B003           CEU006
     C           CEU006    IFNE 'Y'                                       CEU006
     C                     SETON                     235175               CEU006
     C                     ADD  1         I                               CEU006
     C                     MOVEA' W01'    ERCD,I                          CEU006
     C                     ADD  1         WARN                            CFT009
     C                     ELSE                                           CEU006
     C           *IN22     IFEQ *ON                                       CEU006
     C           SSLDT     ANDEQSLDTO                                     CEU006
     C                     ELSE                                           CEU006
     C                     SETON                     235175               CEU006
     C                     ADD  1         I                               CEU006
     C                     MOVEA' W01'    ERCD,I                          CEU006
     C                     ADD  1         WARN                            CFT009
     C                     ENDIF                                          CEU006
     C                     ENDIF                                          CEU006
     C                     END                             E003           CEU006
      *                                                                   CEU006
      *Ensure that date is not before EMU transition start date if        CEU006
      *either Notified Delivery or settlement currency is Euro and        CEU006
      *the other is "In".                                                 CEU006
      *                                                                   CEU006
     C           CEU006    IFEQ 'Y'                                       CEU006
     C           W3INCY    IFEQ 'Y'                                       CEU006
     C           SSMCY     ANDEQBKEURO                                    CEU006
     C           W3TPSD    ANDGTWSLDT                                     CEU006
     C           W1INCY    OREQ 'Y'                                       CEU006
     C           SNDCY     ANDEQBKEURO                                    CEU006
     C           W1TPSD    ANDGTWSLDT                                     CEU006
     C                     MOVEL'FTM2560' FTMSID                          CEU006
     C                     MOVEL'FTUSRMSG'FTMSGF                          CEU006
     C                     MOVEL'Y'       FTNOUP                          CEU006
     C                     EXSR FTSNMS                                    CEU006
     C                     MOVE *ON       *IN51                           CEU006
     C                     ENDIF                                          CEU006
     C                     ENDIF                                          CEU006
      *                                                                   CEU006
     C                     END                             E002           CEU006
     C           *IN99     IFEQ '1'                        -INVLD FMT     CEU006
     C                     ADD  1         I                               CEU006
     C                     MOVE '074'     ERCD,I                          CEU006
     C                     SETON                     51                   CEU006
     C                     ELSE                                           CEU006
     C                     END                                            CEU006
     C                     END                                            CEU006
      *                                                                   CEU006
     C/COPY WNCPYSRC,FT0050C059
      *                                                                   CEU006
      *  Check if settle date is in the future and if the account         CEU006
      *  is closing today (if settle value date is valid)                 CEU006
      *                                                                   CEU006
     C           *IN51     IFEQ '0'                                       CEU006
     C           *IN45     ANDEQ'0'                                       CEU006
     C           *IN48     ANDEQ'0'                                       CEU006
     C           *IN83     ANDEQ'0'                                       CFT014
     C           CFT009    ANDEQ'N'                                       CFT009
      *                                                                   CEU006
     C           WSLDT     IFGT BJRDNB                                    CEU006
     C           ACST1     ANDEQ'C'                                       CEU006
     C                     ADD  1         I                               CEU006
     C                     MOVE '601'     ERCD,I                          CEU006
     C                     MOVE '1'       *IN45                           CEU006
     C                     END                                            CEU006
      *                                                                   CEU006
     C           WSLDT     IFGT BJRDNB                                    CEU006
     C           ACST2     ANDEQ'C'                                       CEU006
     C                     ADD  1         I                               CEU006
     C                     MOVE '602'     ERCD,I                          CEU006
     C                     MOVE '1'       *IN48                           CEU006
     C                     END                                            CEU006
      *                                                                   CEU006
     C           WSLDT     IFGT BJRDNB                                    CFT014
     C           WACST5    ANDEQ'C'                                       CFT014
     C                     MOVEL'FTM3141' FTMSID                          CFT014
     C                     MOVEL'FTUSRMSG'FTMSGF                          CFT014
     C                     MOVEL'Y'       FTNOUP                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     SETON                     83                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     END                                            CEU006
     C*                                                                   CEU006
     C/COPY WNCPYSRC,FT0050CCP7                                           CEU006
     C*                                                                   CEU006
     C*                                                                   CEU006
     C**  IF SETTLE VALUE DATE, SENDER AND RECEIVER'S CORRESPONDENT ARE   CEU006
     C**    VALID SO FAR, FOR RETAIL ACCOUNTS ONLY CHECK THAT THE SETTLE  CEU006
     C**    VALUE DATE IS NOT BEFORE THE BACKVALUE LIMIT DATE NOR BEFORE  CEU006
     C**    THE DATE THE ACCOUNT WAS OPENED FOR THE ACCOUNT THAT MUST BE  CEU006
     C*     IN SETTLE CURRENCY.                                           CEU006
     C*                                                                   CEU006
     C           *IN51     IFEQ '0'                        B001           CEU006
     C           *IN45     ANDEQ'0'                                       CEU006
     C           *IN48     ANDEQ'0'                                       CEU006
     C           *IN83     ANDEQ'0'                                       CFT014
     C           CFT009    ANDEQ'N'                                       CFT009
     C*                                                                   CEU006
     C***********SRCCO     IFEQ *BLANKS                    B002    CEU006 CFT014
     C           WRCRT     IFEQ *BLANKS                                   CFT014
     C           WTRIT     ANDEQ*BLANKS                                   CFT014
     C* USE SENDER FIELDS                                                 CEU006
     C*                                                                   CEU006
     C           ATYP1     IFEQ 'R'                        B003           CEU006
     C*                                                                   CEU006
     C           WSLDT     IFLT BVLD                       B004           CEU006
     C                     ADD  1         I                               CEU006
     C                     MOVE '028'     ERCD,I                          CEU006
     C                     MOVE '1'       *IN45                           CEU006
     C                     ELSE                            X004           CEU006
     C           WSLDT     IFLT DACO1                      B005           CEU006
     C                     ADD  1         I                               CEU006
     C                     MOVE '027'     ERCD,I                          CEU006
     C                     MOVE '1'       *IN45                           CEU006
     C                     END                             E005           CEU006
     C                     END                             E004           CEU006
     C                     END                             E003           CEU006
     C*                                                                   CEU006
     C                     ELSE                            X002           CEU006
      *                                                                   CFT014
     C           WTRIT     IFEQ *BLANKS                                   CFT014
      *                                                                   CFT014
     C* USE RECEIVER'S CORRESPONDENT FIELDS                               CEU006
     C*                                                                   CEU006
     C           ATYP2     IFEQ 'R'                        B003           CEU006
     C*                                                                   CEU006
     C           WSLDT     IFLT BVLD                       B004           CEU006
     C                     ADD  1         I                               CEU006
     C                     MOVE '043'     ERCD,I                          CEU006
     C                     MOVE '1'       *IN48                           CEU006
     C                     ELSE                            X004           CEU006
     C           WSLDT     IFLT DACO2                      B005           CEU006
     C                     ADD  1         I                               CEU006
     C                     MOVE '042'     ERCD,I                          CEU006
     C                     MOVE '1'       *IN48                           CEU006
     C                     END                             E005           CEU006
     C                     END                             E004           CEU006
     C*                                                                   CEU006
     C                     END                             E003           CEU006
      *                                                                   CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
     C           WATYP5    IFEQ 'R'                                       CFT014
      *                                                                   CFT014
     C           WSLDT     IFLT BVLD                                      CFT014
     C                     MOVEL'FTM3142' FTMSID                          CFT014
     C                     MOVEL'FTUSRMSG'FTMSGF                          CFT014
     C                     MOVEL'Y'       FTNOUP                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     SETON                     83                   CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
     C           WSLDT     IFLT WDACO5                                    CFT014
     C                     MOVEL'FTM3143' FTMSID                          CFT014
     C                     MOVEL'FTUSRMSG'FTMSGF                          CFT014
     C                     MOVEL'Y'       FTNOUP                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     SETON                     83                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
     C*                                                                   CEU006
     C                     END                             E002           CEU006
     C                     END                             E001           CEU006
     C**                                                                  CEU006
     C*                                                                   CEU006
     C*********************************                                   CEU006
     C** VALIDATE PAY VALUE DATE **                                       CEU006
     C*********************************                                   CEU006
     C* IF DATE IS NOT ENTERED,SET TO RUN DATE + 1 WORKING DAY IN PAY   E CEU006
     C*  CURRENCY IF SETTLE  CURRENCY IS BASE CURRENCY AND TO RUN         CEU006
     C*  DATE +2 WORKING DAYS IN RECEIVE CURRENCY IF NOT ; OTHERWISE      CEU006
     C*  VALIDATE AS BEING A VALID DATE                                   CEU006
     C*                                                                   CEU006
      *                                                                   CEU006
      *  /COPY for additional pay value date processing                   CEU006
      *                                                                   CEU006
     C/COPY WNCPYSRC,FT0050PVDT                                           CEU006
      *                                                                   CEU006
     C           SPYDT     IFEQ *BLANKS                                   CEU006
     C*                                                                   CEU006
     C/COPY WNCPYSRC,FT0050CCP2                                           CEU006
     C*                                                                   CEU006
     C** CHECK A/C WITH BANK OR BENEFICIARY CUST BEING NOSTRO             CEU006
     C                     CALL 'AONOSTR0'                                CEU006
     C                     PARM *BLANKS   @RTCD   7                       CEU006
     C                     PARM '*KEY'    @OPTN   7                       CEU006
     C                     PARM CNUMPY    @CUST   6                       CEU006
     C                     PARM CCYPY     @CYCD   3                       CEU006
     C**********           PARM ACODPY    @ACCD   4                                    CEU006 CGL029
     C                     PARM ACODPY    @ACCD  10                                           CGL029
     C                     PARM ACSQPY    @ACSN   2                       CEU006
     C                     PARM *BLANKS   @NONB   2                       CEU006
     C                     PARM BRCAPY    @BRCD   3                       CEU006
     C                     PARM *BLANKS   @CSSN  10                       CEU006
     C                     PARM *BLANKS   @PNOI   1                       CEU006
     C           SDNOST    PARM SDNOST    DSFDY                           CEU006
     C           @RTCD     IFEQ *BLANKS                                   CEU006
     C                     MOVE CCYPY     ZCCY                            CEU006
     C                     MOVE NOSLOC    ZLOC                            CEU006
     C                     ELSE                                           CEU006
     C                     MOVE BJLCCY    ZCCY                            CEU006
     C                     MOVE BJSLCD    ZLOC                            CEU006
     C                     END                                            CEU006
     C*                                                                   CEU006
     C           ZCCY      IFEQ SVBCCY                     -BASE CCY      CEU006
     C                     Z-ADDBJRDNB    ZDAYNO                          CEU006
     C                     Z-ADD1         ZNRDYS                          CEU006
     C                     EXSR ZFWDT                                     CEU006
     C                     Z-ADDZDYNBR    WPYDT   50                      CEU006
     C                     ELSE                             -NOT BASE     CEU006
     C                     Z-ADDBJRDNB    ZDAYNO                          CEU006
     C                     Z-ADD2         ZNRDYS                          CEU006
     C                     EXSR ZFWDT                                     CEU006
     C                     Z-ADDZDYNBR    WPYDT   50                      CEU006
     C                     END                                            CEU006
     C*                                                                   CEU006
     C/COPY WNCPYSRC,FT0050CCP3                                           CEU006
     C*                                                                   CEU006
     C                     ELSE                                           CEU006
     C* CHECK IF DATE IS NUMERIC                                          CEU006
     C                     MOVELSPYDT     DATEL                           CEU006
     C                     MOVELDATEL     DATES                           CEU006
     C           SPYDT     IFNE DATES                      B002           CEU006
     C                     SETON                     99                   CEU006
     C                     ELSE                            X002           CEU006
     C                     MOVE SPYDT     ZDATE                           CEU006
     C                     EXSR ZDATE1                                    CEU006
     C                     Z-ADDZDAYNO    WPYDT                           CEU006
      ** THE PAY VALUE DATE MUST NOT BE A HOLIDAY IN LOCAL CURRENCY       CEU006
      *                                                                   CEU006
     C                     MOVE BJLCCY    ZCCY                            CEU006
     C                     EXSR ZCHKH                                     CEU006
      *                                                                   CEU006
      ** if ZIND = 'H' then the date is a holiday                         CEU006
     C           ZIND      IFEQ 'H'                        B003           CEU006
     C/COPY WNCPYSRC,FT0050C211
     C                     SETON                     235775               CEU006
     C                     ADD  1         I                               CEU006
     C                     MOVEA' W02'    ERCD,I                          CEU006
     C                     ADD  1         WARN                            CFT009
     C/COPY WNCPYSRC,FT0050C212
     C                     END                             E003           CEU006
      *                                                                   CEU006
     C                     END                              E002          CEU006
      *                                                                   CEU006
     C           *IN99     IFEQ '1'                        -INVLD FRMT    CEU006
     C                     ADD  1         I                               CEU006
     C                     MOVE '075'     ERCD,I                          CEU006
     C                     SETON                     57                   CEU006
     C                     ELSE                                           CEU006
     C                     END                                            CEU006
      *                                                                   CEU006
     C                     END                                            CEU006
      *                                                                   CEU006
      *  Check if Pay Value Date is in the future and if the              CEU006
      *  account is closing today (if pay date is valid)                  CEU006
      *                                                                   CEU006
     C           *IN57     IFEQ '0'                                       CEU006
     C           *IN46     ANDEQ'0'                                       CEU006
     C           *IN47     ANDEQ'0'                                       CEU006
     C           CFT009    ANDEQ'N'                                       CFT009
      *                                                                   CEU006
     C           WPYDT     IFGT BJRDNB                                    CEU006
     C           ACST3     ANDEQ'C'                                       CEU006
     C                     ADD  1         I                               CEU006
     C                     MOVE '604'     ERCD,I                          CEU006
     C                     MOVE '1'       *IN46                           CEU006
     C                     END                                            CEU006
      *                                                                   CEU006
     C           WPYDT     IFGT BJRDNB                                    CEU006
     C           ACST4     ANDEQ'C'                                       CEU006
     C                     ADD  1         I                               CEU006
     C                     MOVE '603'     ERCD,I                          CEU006
     C                     MOVE '1'       *IN47                           CEU006
     C                     END                                            CEU006
      *                                                                   CEU006
     C                     END                                            CEU006
     C*                                                                   CEU006
     C/COPY WNCPYSRC,FT0050CCP8                                           CEU006
     C*                                                                   CEU006
     C*                                                                   CEU006
     C**  IF PAY VALUE DATE, BENEFICIARY CUSTOMER AND ACCOUNT WITH        CEU006
     C**    BANK ARE VALID SO FAR, FOR RETAIL ACCOUNTS ONLY CHECK THAT    CEU006
     C**    THE PAY VALUE DATE IS NOT BEFORE THE BACKVALUE LIMIT          CEU006
     C**    DATE NOR BEFORE THE DATE THE ACCOUNT WAS OPENED FOR THE       CEU006
     C**    ACCOUNT THAT MUST BE IN PAY CURRENCY.                         CEU006
     C*                                                                   CEU006
     C           *IN57     IFEQ '0'                        B001           CEU006
     C           *IN46     ANDEQ'0'                                       CEU006
     C           *IN47     ANDEQ'0'                                       CEU006
     C           CFT009    ANDEQ'N'                                       CFT009
     C*                                                                   CEU006
     C           SACBK     IFEQ *BLANKS                    B002           CEU006
     C* USE BENEFICIARY CUSTOMER FIELDS                                   CEU006
     C*                                                                   CEU006
     C           ATYP3     IFEQ 'R'                        B003           CEU006
     C*                                                                   CEU006
     C           WPYDT     IFLT BVLD                       B004           CEU006
     C                     ADD  1         I                               CEU006
     C                     MOVE '060'     ERCD,I                          CEU006
     C                     MOVE '1'       *IN46                           CEU006
     C                     ELSE                            X004           CEU006
     C           WPYDT     IFLT DACO3                      B005           CEU006
     C                     ADD  1         I                               CEU006
     C                     MOVE '058'     ERCD,I                          CEU006
     C                     MOVE '1'       *IN46                           CEU006
     C                     END                             E005           CEU006
     C                     END                             E004           CEU006
     C                     END                             E003           CEU006
     C*                                                                   CEU006
     C                     ELSE                            X002           CEU006
     C* USE ACCOUNT WITH BANK FIELDS                                      CEU006
     C*                                                                   CEU006
     C           ATYP4     IFEQ 'R'                        B003           CEU006
     C*                                                                   CEU006
     C           WPYDT     IFLT BVLD                       B004           CEU006
     C                     ADD  1         I                               CEU006
     C                     MOVE '052'     ERCD,I                          CEU006
     C                     MOVE '1'       *IN47                           CEU006
     C                     ELSE                            X004           CEU006
     C           WPYDT     IFLT DACO4                      B005           CEU006
     C                     ADD  1         I                               CEU006
     C                     MOVE '051'     ERCD,I                          CEU006
     C                     MOVE '1'       *IN47                           CEU006
     C                     END                             E005           CEU006
     C                     END                             E004           CEU006
     C*                                                                   CEU006
     C                     END                             E003           CEU006
     C*                                                                   CEU006
     C                     END                             E002           CEU006
     C                     END                             E001           CEU006
     C*                                                                   CEU006
     C/COPY WNCPYSRC,FT0050C029                                           CEU006
     C*************************
     C** VALIDATE RATE FIELD **
     C*************************
     C*
     C* ONLY IF AMOUNTS AND CURRENCIES ARE OK
     C*   NEED PAYMENT CHARGES RECORD TO VALIDATE RATE                    S01117
     C*   AND CANNOT ACCESS THIS WITH INVALID ORIGINATING BRANCH          S01117
     C           *IN49     IFEQ '0'                        SET AMOUNT
     C           *IN50     ANDEQ'0'                        SET CCY
     C           *IN55     ANDEQ'0'                        PAY AMT
     C           *IN56     ANDEQ'0'                        PAY CCY
     C           *IN29     ANDEQ'0'                        ND  AMT        CEU006
     C           *IN28     ANDEQ'0'                        ND  CCY        CEU006
     C           *IN14     ANDEQ'0'                        ORIG BRANCH    S01117
     C                     EXSR PYCHRG                                    S01117
      *                                                                   CEU006
     C           CEU006    IFNE 'Y'                                       CEU006
     C           CFT014    ANDNE'Y'                                       CFT014
     C/COPY WNCPYSRC,FT0050C204
     C                     EXSR RATES
      *                                                                   CEU006
     C                     ELSE                                           CEU006
     C/COPY WNCPYSRC,FT0050C190
      *                                                                   CEU006
     C* Check that rate has been entered in a valid format before         CEU006
      * FT0010 is called.                                                 CEU006
     C           SRATE     IFEQ *BLANKS                                   CFT009
     C           SPDSET    ANDNE*BLANKS                                   CFT009
     C           WSMAM     IFEQ *ZEROS                                    CFT009
     C                     MOVEL'*CALCSET'RTN980                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVEL'*CALCPAY'RTN980                          CFT009
     C                     ENDIF                                          CFT009
     C                     EXSR SRSPST                                    CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     MOVE *BLANK    ZFIELD                          CEU006
     C                     MOVE SRATE     ZFIELD                          CEU006
     C**********           Z-ADD4         ZADIG                                      CEU006 AR895223
     C                     Z-ADD5         ZADIG                                             AR895223
     C                     Z-ADD8         ZADEC                           CEU006
     C                     EXSR ZALIGN                                    CEU006
      *                                                                   CEU006
     C           *IN99     IFEQ '1'                        B002           CEU006
     C                     SETON                     5289                 CEU006
     C                     ADD  1         I                               CEU006
     C                     MOVEA' 069'    ERCD,I                          CEU006
     C                     ELSE                                           CEU006
     C                     MOVE ZFIELD    WRATE  138                      CEU006
     C                     ENDIF                                          CEU006
      *                                                                   CEU006
     C                     ENDIF                                          CEU006
      *                                                                   CEU006
     C                     END
     C*
     C*
     C** CHECK IF BOTH AMOUNTS ENTERED - INVALID IF INSERT MODE BUT
     C** VALID OTHERWISE (AMEND MODE) IF NONE OF SETTLE AMOUNT,PAY
     C** AMOUNT & RATE HAVE BEEN ALTERED.
     C*
     C           CEU006    IFNE 'Y'                                       CEU006
     C           CFT014    ANDNE'Y'                                       CFT014
     C/COPY WNCPYSRC,FT0050C205
     C*                                                                   CEU006
     C           SSMAM     IFNE *BLANK
     C           SPYAM     ANDNE*BLANK
     C           SACTCD    IFEQ 'I'
     C           SVSMAM    ORNE WSMAM
     C           SVPYAM    ORNE WPYAM
     C           SVRATE    ORNE WRATE
     C                     ADD  1         I
     C*********************MOVE '125'     ERCD,I                          S01117
     C                     MOVE '063'     ERCD,I                          S01117
     C                     SETON                     4955
     C                     END
     C                     END
     C*                                                                   CEU006
     C                     ELSE                                           CEU006
     C*Check that all amounts, currencies and rates are in a valid        CEU006
     C*format                                                             CEU006
     C           *IN49     IFEQ '0'                        SET AMOUNT     CEU006
     C           *IN50     ANDEQ'0'                        SET CCY        CEU006
     C           *IN55     ANDEQ'0'                        PAY AMT        CEU006
     C           *IN56     ANDEQ'0'                        PAY CCY        CEU006
     C           *IN29     ANDEQ'0'                        ND  AMT        CEU006
     C           *IN28     ANDEQ'0'                        ND  CCY        CEU006
     C           *IN52     ANDEQ'0'                        RATE           CEU006
     C************IN51     ANDEQ'0'                        SET DAT CEU006 156473
     C************IN57     ANDEQ'0'                        PAY DAT CEU006 156473
      *                                                                   CFT014
     C                     MOVE *BLANKS   WFT10A  1                       CFT014
     C                     MOVE *BLANKS   WFT10B  1                       CFT014
      *                                                                   CFT014
     C           CFT014    IFEQ 'N'                                       CFT014
     C                     MOVE 'Y'       WFT10A                          CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
     C           WNDAM     IFEQ *ZERO                                     CFT014
      *                                                                   CFT014
     C           CEU006    IFEQ 'Y'                                       CFT014
     C           W1INCY    ANDEQ'Y'                                       CFT014
     C           SNDCY     ANDEQBKEURO                                    CFT014
     C           CEU006    OREQ 'Y'                                       CFT014
     C           W3INCY    ANDEQ'Y'                                       CFT014
     C           SSMCY     ANDEQBKEURO                                    CFT014
     C                     MOVE 'Y'       WFT10A                          CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
     C                     MOVE 'Y'       WFT10B                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
     C*                                                                   CEU006
     C**Set up parameters to call FT0010                                  CEU006
     C*                                                                   CEU006
     C***********          MOVE *BLANKS   P#0010                   CEU006 CFT014
     C                     CLEARP#0010                                    CFT014
      *                                                                   CFT014
     C           WFT10A    IFEQ 'Y'                                       CFT014
     C                     MOVE SNDCY     P#NDCY                          CEU006
     C                     Z-ADDWNDAM     P#NDAM                          CEU006
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     MOVE SSMCY     P#DBCY                          CEU006
     C                     Z-ADDWSMAM     P#DBAM                          CEU006
     C                     MOVE SPCCY     P#CRCY                          CEU006
     C                     Z-ADDWPYAM     P#CRAM                          CEU006
     C                     MOVE *BLANKS   P#PDCY                          CEU006
     C                     Z-ADD*ZEROS    P#PDAM                          CEU006
     C                     Z-ADDWSLDT     P#DBDT                          CEU006
     C                     Z-ADDWPYDT     P#CRDT                          CEU006
     C                     MOVE WRATE     P#RATE                          CEU006
     C                     MOVE SOVRD     P#OVRT                          CEU006
     C                     MOVE 'Y'       P#SDIN                          CEU006
     C                     MOVE BTPCRD    P#RTDS                          CEU006
     C                     MOVEL'FT0050'  P#PMSQ                          CEU006
     C                     MOVE *BLANKS   P#INDC                          CEU006
     C                     MOVE *BLANKS   P#RTCD                          CEU006
     C/COPY WNCPYSRC,FT0050C106
      *                                                                   CEU006
     C                     CALL 'FT0010'                                  CEU006
     C                     PARM           P#0010                          CEU006
      *Database error handling                                            CEU006
     C           P#RTCD    IFEQ '*ERROR*'                                 CEU006
     C                     MOVEL'FT0010  'W0FILE           ************   CEU006
     C                     MOVEL'*FIRST ' W0KEY            * DBERR 20 *   CEU006
     C                     Z-ADD20        W0ERNB           ************   CEU006
     C                     EXSR SRERR                      *ABORT PGM*    CEU006
     C*                                                                   CEU006
     C                     ELSE                                           CEU006
      *Check if validation error occurred. If not convert validated       CEU006
      *amounts to screen-ready format.                                    CEU006
     C           P#INDC    IFEQ '00000'                                   CEU006
      *                                                                   CFT009
      ** If settle amount is blank , move '*CALCSET' into return code,    CFT009
      ** otherwise move '*CALCPAY' into return code for call of           CFT009
      ** FT000980                                                         CFT009
      *                                                                   CFT009
     C           WSMAM     IFEQ *ZEROS                                    CFT009
     C                     MOVEL'*CALCSET'RTN980                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVEL'*CALCPAY'RTN980                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CEU006
     C***********SNDCY     IFNE *BLANKS                            CEU006 CFT014
     C           P#NDCY    IFNE *BLANKS                                   CFT014
     C                     MOVE P#NDAM    WNDAM                           CEU006
     C                     MOVE *BLANK    ZFIELD                          CEU006
     C                     MOVE P#NDAM    ZFIELD                          CEU006
     C                     Z-ADDW3NBDP    ZADEC                           CEU006
     C                     EXSR ZEDIT                                     CEU006
     C                     MOVE ZFIELD    SNDAM                           CEU006
     C                     ENDIF                                          CEU006
      *                                                                   CEU006
     C                     MOVE P#DBAM    WSMAM                           CEU006
     C                     MOVE *BLANK    ZFIELD                          CEU006
     C                     MOVE P#DBAM    ZFIELD                          CEU006
     C                     Z-ADDSVSCDP    ZADEC                           CEU006
     C                     EXSR ZEDIT                                     CEU006
     C                     MOVE ZFIELD    SSMAM                           CEU006
      *                                                                   CEU006
     C                     MOVE P#CRAM    WPYAM                           CEU006
     C                     MOVE *BLANK    ZFIELD                          CEU006
     C                     MOVE P#CRAM    ZFIELD                          CEU006
     C                     Z-ADDSVPCDP    ZADEC                           CEU006
     C                     EXSR ZEDIT                                     CEU006
     C                     MOVE ZFIELD    SPYAM                           CEU006
     C*                                                                   CEU006
     C                     MOVE P#RATE    WRATE                           CEU006
     C           CFT009    IFEQ 'N'                                       CFT009
     C                     MOVE *BLANK    ZFIELD                          CEU006
     C                     MOVE P#RATE    ZFIELD                          CEU006
     C                     Z-ADD8         ZADEC                           CEU006
     C                     EXSR ZEDIT                                     CEU006
     C                     MOVE ZFIELD    SRATE                           CEU006
      *                                                                   CEU006
     C                     Z-ADDP#DBDT    ZDAYNO                          CEU006
     C                     EXSR ZDATE2                                    CEU006
     C                     MOVE ZDATE     SSLDT                           CEU006
      *                                                                   CEU006
     C                     Z-ADDP#CRDT    ZDAYNO                          CEU006
     C                     EXSR ZDATE2                                    CEU006
     C                     MOVE ZDATE     SPYDT                           CEU006
     C                     ENDIF                                          CFT009
      *                                                                   CEU006
     C                     ELSE                                           CEU006
      *Set up amount and rates fields as error fields                     CEU006
     C                     MOVEAP#INDC    IND                             CEU006
     C                     MOVE IND,1     *IN29                           CEU006
     C                     MOVE IND,2     *IN49                           CEU006
     C                     MOVE IND,3     *IN55                           CEU006
     C                     MOVE IND,5     *IN52                           CEU006
     C           CFT009    IFEQ 'N'                                       CFT009
     C                     ADD  1         I                               CEU006
     C                     ELSE                                           CFT009
     C           IND,1     IFEQ '1'                                       CFT009
     C                     ADD  1         I                               CFT009
     C                     ENDIF                                          CFT009
     C           IND,2     IFEQ '1'                                       CFT009
     C                     ADD  1         I                               CFT009
     C                     ENDIF                                          CFT009
     C           IND,3     IFEQ '1'                                       CFT009
     C                     ADD  1         I                               CFT009
     C                     ENDIF                                          CFT009
     C           IND,5     IFEQ '1'                                       CFT009
     C                     ADD  1         I                               CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CEU006
     C                     ENDIF                                          CEU006
     C                     ENDIF                                          CEU006
      *                                                                   CEU006
     C           WFT10B    IFEQ 'Y'                                       CFT014
     C           *IN55     ANDEQ*OFF                                      CFT014
     C           SNDCY     ANDNE*BLANKS                                   CFT014
      *                                                                   CFT014
      ** Set up paramaters for call to FT0010.                            CFT014
      *                                                                   CFT014
     C                     CLEARP#0010                                    CFT014
     C                     MOVE *BLANKS   P#NDCY                          CFT014
     C                     Z-ADD*ZEROS    P#NDAM                          CFT014
     C                     MOVE SPCCY     P#DBCY                          CFT014
     C                     Z-ADDWPYAM     P#DBAM                          CFT014
     C                     MOVE SNDCY     P#CRCY                          CFT014
     C                     Z-ADDWNDAM     P#CRAM                          CFT014
     C                     MOVE *BLANKS   P#PDCY                          CFT014
     C                     Z-ADD*ZEROS    P#PDAM                          CFT014
     C                     Z-ADD*ZEROS    P#DBDT                          CFT014
     C                     Z-ADD*ZEROS    P#CRDT                          CFT014
     C                     Z-ADD*ZEROS    P#RATE                          CFT014
     C                     MOVE *BLANKS   P#OVRT                          CFT014
     C                     MOVE *BLANKS   P#SDIN                          CFT014
     C                     MOVE BTPCRD    P#RTDS                          CFT014
     C                     MOVEL'FT0050'  P#PMSQ                          CFT014
     C                     MOVE *BLANKS   P#INDC                          CFT014
     C                     MOVE *BLANKS   P#RTCD                          CFT014
      *                                                                   CFT014
     C                     CALL 'FT0010'                                  CFT014
     C                     PARM           P#0010                          CFT014
      *                                                                   CFT014
     C           P#RTCD    IFEQ '*ERROR*'                                 CFT014
     C                     Z-ADD028       W0ERNB                          CFT014
     C                     MOVEL'*CALL   'W0KEY                           CFT014
     C                     MOVEL'FT0010'  W0FILE                          CFT014
     C                     EXSR SRERR                                     CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           P#INDC    IFEQ '00000'                                   CFT014
     C                     MOVE P#CRAM    WNDAM                           CFT014
     C                     MOVE *BLANKS   ZFIELD                          CFT014
     C                     MOVE P#CRAM    ZFIELD                          CFT014
     C                     Z-ADDW3NBDP    ZADEC                           CFT014
     C                     EXSR ZEDIT                                     CFT014
     C                     MOVE ZFIELD    SNDAM                           CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
     C                     MOVEAP#INDC    IND                             CFT014
     C                     MOVE IND,2     *IN55                           CFT014
     C                     MOVE IND,3     *IN29                           CFT014
     C                     MOVE 'Y'       FTNOUP                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CEU006
     C                     ENDIF                                          CEU006
     C*                                                                   CEU006
      *                                                                   CFT014
      ** Perform additional defaulting process for Instructed             CFT014
      ** Currency/Amount if switchable feature CFT014 is installed.       CFT014
      *                                                                   CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
     C           *IN28     ANDEQ*OFF                                      CFT014
     C           SNDCY     ANDEQ*BLANKS                                   CFT014
     C           *IN29     ANDEQ*OFF                                      CFT014
     C           WNDAM     ANDEQ*ZERO                                     CFT014
     C           *IN45     ANDEQ*OFF                                      CFT014
     C           *IN12     ANDEQ*OFF                                      CFT014
     C           *IN50     ANDEQ*OFF                                      CFT014
     C           SSMCY     ANDNE*BLANKS                                   CFT014
     C           *IN49     ANDEQ*OFF                                      CFT014
     C           WSMAM     ANDNE*ZERO                                     CFT014
     C                     EXSR SRIDFT                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Display warning error if Level Joiner is off, action is          CFT014
      ** Amend, any of the Sender's Charges or Receiver's Charges         CFT014
      ** is not zero and Instructed amount is zero.                       CFT014
      *                                                                   CFT014
     C           SNDAM     IFNE WWNDAM                                    CFT014
     C           CFT014    ANDEQ'Y'                                       CFT014
      *                                                                   CFT014
     C           BTLVJN    IFNE 'Y'                                       CFT014
     C           SACTCD    ANDEQ'A'                                       CFT014
     C           *IN29     ANDEQ*OFF                                      CFT014
     C           WNDAM     ANDEQ*ZERO                                     CFT014
      *                                                                   CFT014
     C           INSCH1    IFNE *ZERO                                     CFT014
     C           INSCH2    ORNE *ZERO                                     CFT014
     C           INSCH3    ORNE *ZERO                                     CFT014
     C           INSCH4    ORNE *ZERO                                     CFT014
     C           INSCH5    ORNE *ZERO                                     CFT014
     C           INSCY1    ORNE *BLANKS                                   CFT014
     C           INSCY2    ORNE *BLANKS                                   CFT014
     C           INSCY3    ORNE *BLANKS                                   CFT014
     C           INSCY4    ORNE *BLANKS                                   CFT014
     C           INSCY5    ORNE *BLANKS                                   CFT014
     C           INRCRM    ORNE *ZERO                                     CFT014
     C                     MOVEL'FTM3160' FTMSID                          CFT014
     C                     MOVEL'FTUSRMSG'FTMSGF                          CFT014
     C                     MOVEL'Y'       FTNOUP                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     SETON                     29                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Validate Original Exchange Rate if switchable feature            CFT014
      ** CFT014 is installed.                                             CFT014
      *                                                                   CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
     C                     EXSR SROEXR                                    CFT014
     C                     ENDIF                                          CFT014
     C*
     C*****************************                                       CEU006
     C** VALIDATE SETTLE VALUE DATE **                                    CEU006
     C*****************************                                       CEU006
     C**   IF DATE IS NOT ENTERED, SET TO SYSTEM DATE                     CEU006
     C**     OTHERWISE VALIDATE AS BEING A VALID DATE                     CEU006
     C*                                                                   CEU006
     C********   SSLDT     IFEQ *BLANKS                                   CEU006
     C***********          Z-ADDRUND      WSLDT   50                S01194CEU006
     C***********          Z-ADDBJRDNB    WSLDT   50                S01194CEU006
      ***********                                                   E32543CEU006
     C***********          ELSE                                           CEU006
     C* CHECK IF DATE IS NUMERIC                                          CEU006
     C***********          MOVELSSLDT     DATEL   70                      CEU006
     C***********          MOVELDATEL     DATES   6                       CEU006
     C***********SSLDT     IFNE DATES                      B002           CEU006
     C***********          SETON                     99                   CEU006
     C***********          ELSE                            X002           CEU006
     C***********          MOVE SSLDT     ZDATE                           CEU006
     C***********          EXSR ZDATE1                                    CEU006
     C***********          Z-ADDZDAYNO    WSLDT                           CEU006
      ** THE SETTLE DATE MUST NOT BE A HOLIDAY IN LOCAL CURRENCY    E32543CEU006
      *                                                             E32543CEU006
     C***********          MOVE BJLCCY    ZCCY                      E32543CEU006
     C***********          EXSR ZCHKH                               E32543CEU006
      ***********                                                   E32543CEU006
      ** if ZIND = 'H' then the date is a holiday                   E32543CEU006
     C***********ZIND      IFEQ 'H'                        B003     E32543CEU006
     C***********          SETON                     235175         E32543CEU006
     C***********          ADD  1         I                         E32543CEU006
     C*********************MOVEA' W11'    ERCD,I                    CEU006E32543
     C***********          MOVEA' W01'    ERCD,I                    S01117CEU006
     C***********          END                             E003     E32543CEU006
      ***********                                                   E32543CEU006
     C***********          END                             E002           CEU006
     C************IN99     IFEQ '1'                        -INVLD FRMT    CEU006
     C***********          ADD  1         I                               CEU006
     C*********************MOVE '129'     ERCD,I                    S01117CEU006
     C***********          MOVE '074'     ERCD,I                    S01117CEU006
     C***********          SETON                     51                   CEU006
     C***********          ELSE                                           CEU006
     C***********          END                                            CEU006
     C***********          END                                            CEU006
      ***********                                                   047179CEU006
      ***Check if settle date is in the future and if the account   047179CEU006
      ***is closing today (if settle value date is valid)           047179CEU006
      ***********                                                   047179CEU006
     C************IN51     IFEQ '0'                                 047179CEU006
     C************IN45     ANDEQ'0'                                 047179CEU006
     C************IN48     ANDEQ'0'                                 047179CEU006
      ***********                                                   047179CEU006
     C***********WSLDT     IFGT BJRDNB                              047179CEU006
     C***********ACST1     ANDEQ'C'                                 047179CEU006
     C***********          ADD  1         I                         047179CEU006
     C***********          MOVE '601'     ERCD,I                    047179CEU006
     C***********          MOVE '1'       *IN45                     047179CEU006
     C***********          END                                      047179CEU006
      ***********                                                   047179CEU006
     C***********WSLDT     IFGT BJRDNB                              047179CEU006
     C***********ACST2     ANDEQ'C'                                 047179CEU006
     C***********          ADD  1         I                         047179CEU006
     C***********          MOVE '602'     ERCD,I                    047179CEU006
     C***********          MOVE '1'       *IN48                     047179CEU006
     C***********          END                                      047179CEU006
      ***********                                                   047179CEU006
     C***********          END                                      047179CEU006
     C***********                                                   S01408CEU006
     C***********/COPY WNCPYSRC,FT0050CCP7                          S01408CEU006
     C************                                                  S01408CEU006
     C************                                                        CEU006
     C**  IF SETTLE VALUE DATE, SENDER AND RECEIVER'S CORRESPONDENT ARE   CEU006
     C**    VALID SO FAR, FOR RETAIL ACCOUNTS ONLY CHECK THAT THE SETTLE  CEU006
     C**    VALUE DATE IS NOT BEFORE THE BACKVALUE LIMIT DATE NOR BEFORE  CEU006
     C**    THE DATE THE ACCOUNT WAS OPENED FOR THE ACCOUNT THAT MUST BE  CEU006
     C*     IN SETTLE CURRENCY.                                           CEU006
     C************                                                        CEU006
     C************IN51     IFEQ '0'                        B001           CEU006
     C************IN45     ANDEQ'0'                                       CEU006
     C************IN48     ANDEQ'0'                                       CEU006
     C***********                                                         CEU006
     C***********SRCCO     IFEQ *BLANKS                    B002           CEU006
     C* USE SENDER FIELDS                                                 CEU006
     C***********                                                         CEU006
     C***********ATYP1     IFEQ 'R'                        B003           CEU006
     C***********                                                         CEU006
     C***********WSLDT     IFLT BVLD                       B004           CEU006
     C***********          ADD  1         I                               CEU006
     C*********************MOVE '367'     ERCD,I                    S01117CEU006
     C***********          MOVE '028'     ERCD,I                    S01117CEU006
     C***********          MOVE '1'       *IN45                           CEU006
     C***********          ELSE                            X004           CEU006
     C***********WSLDT     IFLT DACO1                      B005           CEU006
     C***********          ADD  1         I                               CEU006
     C*********************MOVE '352'     ERCD,I                    S01117CEU006
     C***********          MOVE '027'     ERCD,I                    S01117CEU006
     C***********          MOVE '1'       *IN45                           CEU006
     C***********          END                             E005           CEU006
     C***********          END                             E004           CEU006
     C***********          END                             E003           CEU006
     C***********                                                         CEU006
     C***********          ELSE                            X002           CEU006
     C* USE RECEIVER'S CORRESPONDENT FIELDS                               CEU006
     C***********                                                         CEU006
     C***********ATYP2     IFEQ 'R'                        B003           CEU006
     C***********                                                         CEU006
     C***********WSLDT     IFLT BVLD                       B004           CEU006
     C***********          ADD  1         I                               CEU006
     C*********************MOVE '363'     ERCD,I                    S01117CEU006
     C***********          MOVE '043'     ERCD,I                    S01117CEU006
     C***********          MOVE '1'       *IN48                           CEU006
     C***********          ELSE                            X004           CEU006
     C***********WSLDT     IFLT DACO2                      B005           CEU006
     C***********          ADD  1         I                               CEU006
     C*********************MOVE '348'     ERCD,I                    S01117CEU006
     C***********          MOVE '042'     ERCD,I                    S01117CEU006
     C***********          MOVE '1'       *IN48                           CEU006
     C***********          END                             E005           CEU006
     C***********          END                             E004           CEU006
     C***********                                                         CEU006
     C***********          END                             E003           CEU006
     C***********                                                         CEU006
     C***********          END                             E002           CEU006
     C***********          END                             E001           CEU006
     C***********                                                         CEU006
     C***********                                                         CEU006
     C*********************************                                   CEU006
     C** VALIDATE PAY VALUE DATE **                                       CEU006
     C*********************************                                   CEU006
     C* IF DATE IS NOT ENTERED,SET TO RUN DATE + 1 WORKING DAY IN PAY   E CEU006
     C*  CURRENCY IF SETTLE  CURRENCY IS BASE CURRENCY AND TO RUN         CEU006
     C*  DATE +2 WORKING DAYS IN RECEIVE CURRENCY IF NOT ; OTHERWISE      CEU006
     C*  VALIDATE AS BEING A VALID DATE                                   CEU006
     C************                                                        CEU006
      ************                                                  S01435CEU006
      ************  /COPY for additional pay value date processing  S01435CEU006
      ************                                                  S01435CEU006
     C***********/COPY WNCPYSRC,FT0050PVDT                          S01435CEU006
      ***********                                                   S01435CEU006
     C***********SPYDT     IFEQ *BLANKS                                   CEU006
     C***********                                                   S01408CEU006
     C***********/COPY WNCPYSRC,FT0050CCP2                          S01408CEU006
     C************                                                  S01408CEU006
     C** CHECK A/C WITH BANK OR BENEFICIARY CUST BEING NOSTRO       S01195CEU006
     C***********          CALL 'AONOSTR0'                          S01195CEU006
     C***********          PARM *BLANKS   @RTCD   7                 S01195CEU006
     C***********          PARM '*KEY'    @OPTN   7                 S01195CEU006
     C***********          PARM CNUMPY    @CUST   6                 S01195CEU006
     C***********          PARM CCYPY     @CYCD   3                 S01195CEU006
     C***********          PARM ACODPY    @ACCD   4                 S01195CEU006
     C***********          PARM ACSQPY    @ACSN   2                 S01195CEU006
     C***********          PARM *BLANKS   @NONB   2                 S01195CEU006
     C***********          PARM BRCAPY    @BRCD   3                 S01195CEU006
     C***********          PARM *BLANKS   @CSSN  10                 S01195CEU006
     C***********          PARM *BLANKS   @PNOI   1                 S01195CEU006
     C***********SDNOST    PARM SDNOST    DSFDY                     S01195CEU006
     C***********@RTCD     IFEQ *BLANKS                             S01195CEU006
     C***********          MOVE CCYPY     ZCCY                      S01195CEU006
     C***********          MOVE NOSLOC    ZLOC                      S01195CEU006
     C***********          ELSE                                     S01195CEU006
     C***********          MOVE BJLCCY    ZCCY                      S01195CEU006
     C***********          MOVE BJSLCD    ZLOC                      S01195CEU006
     C***********          END                                      S01195CEU006
     C***********                                                   S01195CEU006
     C***********SSMCY     IFEQ SVBCCY                     -BASE CCYS01195CEU006
     C***********ZCCY      IFEQ SVBCCY                     -BASE CCYS01195CEU006
     C***********          Z-ADDRUND      ZDAYNO                    S01194CEU006
     C***********          Z-ADDBJRDNB    ZDAYNO                    S00194CEU006
     C***********          MOVELSSMCY     ZCCY                      S01195CEU006
     C***********          Z-ADD1         ZNRDYS                          CEU006
     C*********************EXSR ZDATE3                              S01195CEU006
     C***********          EXSR ZFWDT                               S01195CEU006
     C***********          Z-ADDZDYNBR    WPYDT   50                      CEU006
     C***********          ELSE                             -NOT BASE     CEU006
     C*********************Z-ADDRUND      ZDAYNO                    S01194CEU006
     C***********          Z-ADDBJRDNB    ZDAYNO                    S01194CEU006
     C*********************MOVELSSMCY     ZCCY                      S01195CEU006
     C***********          Z-ADD2         ZNRDYS                          CEU006
     C*********************EXSR ZDATE3                              S01195CEU006
     C***********          EXSR ZFWDT                               S01195CEU006
     C***********          Z-ADDZDYNBR    WPYDT   50                      CEU006
     C***********          END                                            CEU006
     C***********                                                   S01408CEU006
     C***********/COPY WNCPYSRC,FT0050CCP3                          S01408CEU006
     C***********                                                   S01408CEU006
     C***********          ELSE                                           CEU006
     C* CHECK IF DATE IS NUMERIC                                          CEU006
     C***********          MOVELSPYDT     DATEL                           CEU006
     C***********          MOVELDATEL     DATES                           CEU006
     C***********SPYDT     IFNE DATES                      B002           CEU006
     C***********          SETON                     99                   CEU006
     C***********          ELSE                            X002           CEU006
     C***********          MOVE SPYDT     ZDATE                           CEU006
     C***********          EXSR ZDATE1                                    CEU006
     C***********          Z-ADDZDAYNO    WPYDT                           CEU006
      ** THE PAY VALUE DATE MUST NOT BE A HOLIDAY IN LOCAL CURRENCY E32543CEU006
      ***********                                                   E32543CEU006
     C***********          MOVE BJLCCY    ZCCY                      E32543CEU006
     C***********          EXSR ZCHKH                               E32543CEU006
      ***********                                                   E32543CEU006
      ** if ZIND = 'H' then the date is a holiday                   E32543CEU006
     C***********ZIND      IFEQ 'H'                        B003     E32543CEU006
     C***********          SETON                     235775         E32543CEU006
     C***********          ADD  1         I                         E32543CEU006
     C*********************MOVEA' W10'    ERCD,I                    E32543CEU006
     C***********          MOVEA' W02'    ERCD,I                    S01117CEU006
     C***********          END                             E003     E32543CEU006
      ***********                                                   E32543CEU006
     C***********          END                              E002          CEU006
      ***********                                                         CEU006
     C************IN99     IFEQ '1'                        -INVLD FRMT    CEU006
     C***********          ADD  1         I                               CEU006
     C*********************MOVE '131'     ERCD,I                    S01117CEU006
     C***********          MOVE '075'     ERCD,I                    S01117CEU006
     C***********          SETON                     57                   CEU006
     C***********          ELSE                                           CEU006
     C***********          END                                            CEU006
      ***********                                                         CEU006
     C***********          END                                            CEU006
      ***********                                                   047179CEU006
      *  Check if Pay Value Date is in the future and if the        047179CEU006
      *  account is closing today (if pay date is valid)            047179CEU006
      *                                                             047179CEU006
     C************IN57     IFEQ '0'                                 047179CEU006
     C************IN46     ANDEQ'0'                                 047179CEU006
     C************IN47     ANDEQ'0'                                 047179CEU006
      *                                                             047179CEU006
     C***********WPYDT     IFGT BJRDNB                              047179CEU006
     C***********ACST3     ANDEQ'C'                                 047179CEU006
     C***********          ADD  1         I                         047179CEU006
     C***********          MOVE '604'     ERCD,I                    047179CEU006
     C***********          MOVE '1'       *IN46                     047179CEU006
     C***********          END                                      047179CEU006
      ***********                                                   047179CEU006
     C***********WPYDT     IFGT BJRDNB                              047179CEU006
     C***********ACST4     ANDEQ'C'                                 047179CEU006
     C***********          ADD  1         I                         047179CEU006
     C***********          MOVE '603'     ERCD,I                    047179CEU006
     C***********          MOVE '1'       *IN47                     047179CEU006
     C***********          END                                      047179CEU006
      ***********                                                   047179CEU006
     C***********          END                                      047179CEU006
     C***********                                                   S01408CEU006
     C***********/COPY WNCPYSRC,FT0050CCP8                          S01408CEU006
     C***********                                                   S01408CEU006
     C***********                                                         CEU006
     C**  IF PAY VALUE DATE, BENEFICIARY CUSTOMER AND ACCOUNT WITH        CEU006
     C**    BANK ARE VALID SO FAR, FOR RETAIL ACCOUNTS ONLY CHECK THAT    CEU006
     C**    THE PAY VALUE DATE IS NOT BEFORE THE BACKVALUE LIMIT          CEU006
     C**    DATE NOR BEFORE THE DATE THE ACCOUNT WAS OPENED FOR THE       CEU006
     C**    ACCOUNT THAT MUST BE IN PAY CURRENCY.                         CEU006
     C*                                                                   CEU006
     C************IN57     IFEQ '0'                        B001           CEU006
     C************IN46     ANDEQ'0'                                       CEU006
     C************IN47     ANDEQ'0'                                       CEU006
     C***********                                                         CEU006
     C***********SACBK     IFEQ *BLANKS                    B002           CEU006
     C* USE BENEFICIARY CUSTOMER FIELDS                                   CEU006
     C***********                                                         CEU006
     C***********ATYP3     IFEQ 'R'                        B003           CEU006
     C***********                                                         CEU006
     C***********WPYDT     IFLT BVLD                       B004           CEU006
     C***********          ADD  1         I                               CEU006
     C*********************MOVE '368'     ERCD,I                    S01117CEU006
     C***********          MOVE '060'     ERCD,I                    S01117CEU006
     C***********          MOVE '1'       *IN46                           CEU006
     C***********          ELSE                            X004           CEU006
     C***********WPYDT     IFLT DACO3                      B005           CEU006
     C***********          ADD  1         I                               CEU006
     C*********************MOVE '353'     ERCD,I                    S01117CEU006
     C***********          MOVE '058'     ERCD,I                    S01117CEU006
     C***********          MOVE '1'       *IN46                           CEU006
     C***********          END                             E005           CEU006
     C***********          END                             E004           CEU006
     C***********          END                             E003           CEU006
     C***********                                                         CEU006
     C***********          ELSE                            X002           CEU006
     C* USE ACCOUNT WITH BANK FIELDS                                      CEU006
     C***********                                                         CEU006
     C***********ATYP4     IFEQ 'R'                        B003           CEU006
     C***********                                                         CEU006
     C***********WPYDT     IFLT BVLD                       B004           CEU006
     C***********          ADD  1         I                               CEU006
     C*********************MOVE '364'     ERCD,I                    S01117CEU006
     C***********          MOVE '052'     ERCD,I                    S01117CEU006
     C***********          MOVE '1'       *IN47                           CEU006
     C***********          ELSE                            X004           CEU006
     C***********WPYDT     IFLT DACO4                      B005           CEU006
     C***********          ADD  1         I                               CEU006
     C*********************MOVE '349'     ERCD,I                    S01117CEU006
     C***********          MOVE '051'     ERCD,I                    S01117CEU006
     C***********          MOVE '1'       *IN47                           CEU006
     C***********          END                             E005           CEU006
     C***********          END                             E004           CEU006
     C***********                                                         CEU006
     C***********          END                             E003           CEU006
     C***********                                                         CEU006
     C***********          END                             E002           CEU006
     C***********          END                             E001           CEU006
     C***********                                                         CEU006
     C***********/COPY WNCPYSRC,FT0050C029                                CEU006
     C*******************************************
     C** VALIDATE ADD/DEDUCT CHARGES INDICATOR **
     C*******************************************
     C** IF ENTERED,IT MUST BE EITHER 'Y' OR 'N'
     C*
     C           SADDC     IFNE *BLANKS
     C           SADDC     ANDNE'A'
     C           SADDC     ANDNE'D'
     C                     ADD  1         I
     C*********************MOVE '133'     ERCD,I                          S01117
     C                     MOVE '076'     ERCD,I                          S01117
     C                     SETON                     54
     C                     END
     C/COPY WNCPYSRC,FT0050C069
     C*
     C**********************************
     C** VALIDATE SWIFT PRIORITY CODE **
     C**********************************
     C***IF*ENTERED,VALIDATE*AS*NUMERIC*USING*ZALIGN;*IF*VALID*I**MUST*   S01117
     C***HAVE*A*VALUE*OF*'1'*OR*'2'***************************
     C***HAVE*A*VALUE*OF*'1'*OR*'2'*OR*'11'*OR*'12'*                      S01117
     C*********************                                               S01117
     C***********SSWPC*****IFNE *BLANKS                                   S01117
     C*********************Z-ADD2         ZADIG                           S01117
     C*********************Z-ADD0         ZADEC                           S01117
     C*********************MOVEL*BLANKS   ZFIELD                          S01117
     C*********************MOVE SSWPC     ZFIELD                          S01117
     C*********************EXSR ZALIGN                                    S01117
     C*********************MOVE ZFIELD    WSWPC   20                      S01117
     C************IN99*****IFEQ '1'                         -ERROR        S01117
     C*********************ADD  1         I                               S01117
     C*********************MOVE '134'     ERCD,I                          S01117
     C*********************SETON                     58                   S01117
     C*********************ELSE                                           S01117
     C***********WSWPC*****IFNE 1                                         S01117
     C***********WSWPC*****ANDNE2                                         S01117
     C***********WSWPC*****ANDNE11                                        S01117
     C***********WSWPC*****ANDNE12                                        S01117
     C*********************ADD  1         I                               S01117
     C*********************MOVE '135'     ERCD,I                          S01117
     C*********************SETON                     58                   S01117
     C*********************END                                            S01117
     C*********************END                                            S01117
     C*********************END                                            S01117
     C*                                                                   S01117
     C** IF ENTERED MUST BE 'U' OR 'N'.                                   S01117
     C*                                                                   S01117
     C           SSWPC     IFNE *BLANKS                    B001           S01117
     C           SSWPC     IFNE 'U'                        B002           S01117
     C           SSWPC     ANDNE'N'                                       S01117
     C                     ADD  1         I                               S01117
     C                     MOVE '078'     ERCD,I                          S01117
     C                     SETON                     58                   S01117
     C                     END                             E002           S01117
     C                     END                             E001           S01117
      *                                                                   S01414
      *  Validate the Book Code.                                          S01414
      *                                                                   S01414
     C                     EXSR SRBOOK                     Book Code      S01414
      *                                                                   S01414
      *  Validate the Profit Centre if Used.                              S01414
      *                                                                   S01414
     C           BKPRCU    IFEQ 'Y'                                       S01414
     C                     EXSR SRPRFC                     Profit Centre  S01414
     C                     END                                            S01414
     C/COPY WNCPYSRC,FT0050C096
      *                                                                   CFT009
      ** Validate spread set and default charges                          CFT009
      *                                                                   CFT009
     C           CFT009    IFEQ 'Y'                                       CFT009
     C           I         IFEQ 0                                         CFT009
     C           I         OREQ WARN                                      CFT009
     C                     EXSR SRSPST                                    CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                                       CRE008
      ** Check overdraft limit if CRE008 is installed                                         CRE008
      *                                                                                       CRE008
     C           CRE008    IFEQ 'Y'                                                           CRE008
     C           *IN45     ANDEQ'0'                                                           CRE008
     C           *IN49     ANDEQ'0'                                                           CRE008
     C                     EXSR OVDRLT                                                        CRE008
     C                     ENDIF                                                              CRE008
      *                                                                                       CRE008
     C***********************
     C** END OF VALIDATION **
     C***********************
     C*
     C** ASSIGN ERROR CODES 102 & 174 IF OUTSTANDING **
     C*
     C           *IN61     IFEQ '1'
     C                     ADD  1         I
     C*********************MOVE '102'     ERCD,I                          S01117
     C                     MOVE '024'     ERCD,I                          S01117
     C                     END
     C*
     C************IN62*****IFEQ '1'                                       S01117
     C*********************ADD  1         I                               S01117
     C*********************MOVE '174'     ERCD,I                          S01117
     C*********************END                                            S01117
     C*
     C** Core hook for externalisation.                                   S01408
     C/COPY WNCPYSRC,FT0050CVSR                                           S01408
     C*
     C** CHECK IF ANY ERRORS HAVE BEEN FOUND
     C*
     C           I         IFGT *ZERO
     C           *IN75     ORNE '0'                                       079909
     C                     SETON                     75
     C/COPY WNCPYSRC,FT0050C196
     C***********I         IFGT 19                                        079909
     C***********          SETON                     76                   079909
     C***********          END                                            079909
     C                     ELSE
     C                     SETON                     20
     C                     END
     C*
     C*          *****     *****
     C           GAEND     ENDSR
     C*          *****     *****
     C/EJECT
     C           GCINPY    BEGSR
     C*          ******    *****
     C*
     C*****************************************************************
     C*                 GC-SETUP-INPAYDD-RECORD                       *
     C*                                                               *
     C*  FUNCTION : TO SETUP ALL THE FIELDS REQUIRED FOR OUTPUT TO    *
     C*             THE INCOMING PAYMENTS RECORD.                     *
     C*             (ACTION CODES INSERT & AMEND)                     *
     C*                                                               *
     C*  CALLS :    ICGNRT                                            *
     C*             IEGNAM                                            *
     C*             ZDATE2                                            *
     C*                                                               *
     C*  CALLED BY: ECINST                                            *
     C*             EEAMND                                            *
     C*                                                               *
     C*****************************************************************
     C*
     C** SAVE LAST UPDATE TYPE FROM INPAYDD RECORD
     C*
     C                     MOVELCHTP      SVCHTP  1
     C*
     C*
     C** SETUP RECORD IDENTIFIER
     C*
     C                     MOVE 'D'       RECI
     C*
     C** PAYMENT TYPE
     C*
     C                     MOVE SPYTP     PYTP
      *                                                                   S01435
      * Set level 1 Valid indicator.                                      S01435
      *                                                                   S01435
     C                     MOVE 'Y'       INLVL1                          S01435
     C*
     C** IF ACTION CODE IS 'I',GENERATE PAYMENT REFERENCE & ORIGINAL
     C** ENTRY DATES
     C/COPY WNCPYSRC,FT0050C074
     C*
     C           SACTCD    IFEQ 'I'
     C*                                                    -CONVERT
     C***********          Z-ADDRUND      ZDAYNO            RUN-DATE TO   S01194
     C                     Z-ADDBJRDNB    ZDAYNO            RUN-DATE TO   S01194
     C                     EXSR ZDATE2                      DDMMYY FRMT
     C*
     C***********          Z-ADDRUND      OEDT             -SETUP OED,    S01194
     C                     Z-ADDBJRDNB    OEDT             -SETUP OED,    S01194
     C                     Z-ADDZDATE     OEDTD1            DAF OED1,
     C                     MOVE ZDATE     WN2     20        & DAF OED2
     C           WN2       IFLT 72
     C                     Z-ADD20        OEDTD2
     C                     ELSE
     C                     Z-ADD19        OEDTD2
     C                     END
     C*
     C**********           MOVELZDATE     WA4              -CONVERT                           CGL029
     C                     MOVELZDATE     WA4     4                                           CGL029
     C  N98                MOVELWA4       WA2               RUN-DATE TO
     C  N98                MOVE WA4       WA2A              YYMMDD FRMT
     C  N98                MOVELWA2A      WA4
     C  N98                MOVE WA2       WA4
     C                     MOVE ZDATE     WA2
     C                     MOVELWA2       ZDATE
     C                     MOVE WA4       ZDATE
     C*                                                    -SETUP
     C                     Z-ADDZDATE     OEDTD3            DAF OED3.
     C*
     C                     MOVE ZDATE     WA6              -SETUP
     C/COPY WNCPYSRC,FTH00097
     C                     MOVE WINSQ     WA4               PAYMENT
     C/COPY WNCPYSRC,FTH00098
     C                     MOVE 'P'       YA3,1
     C                     MOVEAWA6       YA3,2             REFERENCE.
     C                     MOVEAWA4       YA3,8             REFERENCE.
     C                     MOVEAPYTP      YA3,12
     C                     MOVEA'00'      YA3,14
     C*******    1         DO   15        I                -REPLACE       103715
     C*******    YA3,I     IFEQ ' '                         ANY BLANKS    103715
     C*******              MOVEL'0'       YA3,I                           103715
     C           1         DO   15        IA      20       -REPLACE       103715
     C           YA3,IA    IFEQ ' '                         ANY BLANKS    103715
     C                     MOVEL'0'       YA3,IA                          103715
     C                     END
     C                     END
     C*
     C                     MOVEAYA3,1     PREF
     C*
     C                     END
     C/COPY WNCPYSRC,FT0050C075
     C*                                                                   S01117
     C** SETUP BOOKING BRANCH AND ORIGINATING BRANCH                      S01117
     C**  IF SINGLE BRANCHED,USE SINGLE BRANCH CODE FROM SDBANKPD         S01117
     C*                                                                   S01117
     C           *IN10     IFEQ '0'                                       S01117
     C                     MOVELBJSBRC    BRCA                            S01117
     C                     MOVELBJSBRC    ORBR                            S01117
     C                     ELSE                                           S01117
     C*                                                                   S01117
     C** IF ORIGINATING BRANCH NOT USED, ORBR DEFAULTS TO BRCA            S01117
     C           *IN11     IFEQ '0'                                       S01117
     C                     MOVELSBRCA     BRCA                            S01117
     C                     MOVELSBRCA     ORBR                            S01117
     C                     ELSE                                           S01117
     C                     MOVELSBRCA     BRCA                            S01117
     C                     MOVELSORBR     ORBR                            S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C*
     C** SETUP PAYMENT SUBTYPE
     C*
     C                     MOVELSPYST     PYST
     C*
     C** SETUP SENDER TYPE
     C*
     C                     MOVELWSNTP     SNTP
     C*
     C** IF SINGLE BRANCHED AND SENDER TYPE IS G (FULL A/C ID)            S01117
     C**  MOVE SINGLE BRANCH CODE INTO SENDER 1 FIELD POSITIONS 16-18     S01117
     C*                                                                   S01117
     C           *IN10     IFEQ '0'                                       S01117
     C           WSNTP     ANDEQ'G'                                       S01117
     C                     MOVE BJSBRC    SSNBR                           S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C** SETUP SENDER (SENDER 1 = CUSTOMER NUMBER,IF SHORTNAME ENTERED)
     C*
     C           *IN38     IFEQ '1'
     C                     MOVEL*BLANKS   SND1
     C                     MOVELWCNUM     SND1
     C                     ELSE
     C                     MOVELSSND1     SND1
     C                     END
     C*
     C                     MOVELSSND2     SND2
     C                     MOVELSSND3     SND3
     C                     MOVELSSND4     SND4
     C*
     C** SETUP RECEIVER'S CORRESPONDENT TYPE
     C*
     C***********          MOVELWRCRT     RCRT                            CFT014
     C                     MOVELWRCRT     INRCRT                          CFT014
     C*
     C** SETUP RECEIVER'S CORRESPONDENT
     C*
     C***********          MOVELSRCCO     RCCO                            CFT014
      *                                                                   CFT014
     C           WRCRT     IFEQ 'C'                                       CFT014
     C           WCNUM2    ANDNE*BLANKS                                   CFT014
     C                     MOVELWCNUM2    INRCO1                          CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
     C           WRCRT     IFEQ 'G'                                       CFT014
     C           CFT014    ANDEQ'Y'                                       CFT014
     C                     MOVE *BLANKS   SRCO1                           CFT014
     C                     MOVELRCCDS     SRCO1                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     MOVELSRCO1     INRCO1                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     MOVELSRCO2     INRCO2                          CFT014
     C                     MOVELSRCO3     INRCO3                          CFT014
     C                     MOVELSRCO4     INRCO4                          CFT014
     C                     MOVELSRCO5     INRCO5                          CFT014
     C*
     C** SETUP ACCOUNT WITH BANK TYPE
     C*
     C                     MOVELWACBT     ACBT
     C*
     C** SETUP ACCOUNT WITH BANK
     C*
     C                     MOVELSACBK     ACBK
     C                     MOVELSACBB     ACBB                            S01117
     C/COPY WNCPYSRC,FT0050C082
     C*                                                                   S01117
     C** IF SINGLE BRANCHED AND A/C WITH BK TYPE IS P (PARTIAL A/C ID)    S01117
     C**  MOVE SINGLE BRANCH CODE INTO A/C WITH BANK BRANCH               S01117
     C*                                                                   S01117
     C           WACBT     IFEQ 'P'                                       S01117
     C           *IN10     ANDEQ'0'                                       S01117
     C                     MOVELBJSBRC    ACBB                            S01117
     C                     END                                            S01117
     C*
     C** SETUP BENEFICIARY CUSTOMER TYPE
     C*
     C                     MOVELWBNCT     BNCT
     C*
     C** IF SINGLE BRANCHED AND BENE CUST TYPE IS P (PARTIAL A/C ID)      S01117
     C**  MOVE SINGLE BRANCH CODE INTO BENE CUST 1 POSITIONS 13-15        S01117
     C*                                                                   S01117
     C           *IN10     IFEQ '0'                                       S01117
     C           WBNCT     ANDEQ'P'                                       S01117
     C                     MOVE BJSBRC    BBRCA                           S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C** SETUP BENEFICIARY CUSTOMER
     C*
     C                     MOVELSBNC1     BNC1
     C                     MOVELSBNC2     BNC2
     C                     MOVELSBNC3     BNC3
     C                     MOVELSBNC4     BNC4
     C                     MOVELSBNC5     BNC5
      *                                                                   S01414
      * setup Book Code and Profit Centre                                 S01414
      *                                                                   S01414
     C                     MOVE SBOKC     BOKC                            S01414
     C                     MOVE SPRFC     PRFC                            S01414
     C*                                                                   175479
     C** SETUP FONTIS DEAL REFERENCE.                                     175479
     C*                                                                   175479
     C                     MOVELSFDLR     FDLR                            175479
     C*
     C** SETUP SETTLEMENT AMOUNT .
     C** IF NOT ENTERED IT WILL HAVE TO BE GENERATED FROM THE PAYMENT
     C** AMOUNT & THE RATE.
     C*
     C                     Z-ADDWSMAM     SMAM
     C*
     C** SETUP DAF SETTLE AMOUNT,DEPENDING ON NUMBER OF DECIMAL PLACES
     C** IN SETTLE CURRENCY
     C*
     C           SVSCDP    IFEQ *ZERO
     C                     Z-ADDSMAM      SMAMD
     C                     ELSE
     C           SVSCDP    IFEQ 1
     C           SMAM      DIV  10        SMAMD
     C                     ELSE
     C           SVSCDP    IFEQ 2
     C           SMAM      DIV  100       SMAMD
     C                     ELSE
     C           SMAM      DIV  1000      SMAMD     H
     C                     END
     C                     END
     C                     END
     C* CALCULATE BASE CURRENCY EQUIV
     C           SVSCDP    SUB  BCDP      N       10               AKEYXX
     C                     ADD  4         N
     C           SVSMDN    IFEQ 0                          B001    AKEYXX
     C           SVSSPT    MULT POWER,N   WK159     H              AKEYXX
     C           SMAM      DIV  WK159     SBCQ      H
     C                     ELSE                            X001
     C           SVSSPT    DIV  POWER,N   WK159  159H              AKEYXX
     C           SMAM      MULT WK159     SBCQ      H
     C                     END                             E001
     C*
     C* IF AMEND AND ADD/DEDUCT INDICATOR HAS CHANGED,THEN
     C* CONVERT CHARGE VALUES IF NEEDED(ONLY IF CDRO BLANK) AND PAY
     C* AND SETTLE CCY DIFFER.
     C*
     C           SACTCD    IFEQ 'A'
     C***********CDRO      ANDEQ0                                                             CSD027
     C           CDRO      ANDEQ*BLANKS                                                       CSD027
     C*
     C** IF PAY CCY BLANKED DURING AMEND MOVE IN SETTLE CCY.
     C*
     C           SPCCY     IFEQ *BLANKS                                   E23768
     C                     MOVELSSMCY     SPCCY                           E23768
     C                     END                                            E23768
     C*
     C           SADDC     IFNE ADDC
     C           SMCY      ANDNEPCCY
     C*
     C           SADDC     ORNE ADDC
     C           SSMCY     ANDNESPCCY
     C*
     C           SPCCY     ORNE PCCY
     C           SADDC     ANDEQ'D'
     C*
     C           SSMCY     ORNE SMCY
     C           SADDC     ANDEQ'A'
     C*                                                                   S01508
     C           WRDFTC    OREQ 'Y'                                       S01508
     C           SMAM      ORNE WSMAM                                     124674
     C           RATE      ORNE WRATE                                     124674
     C*
     C           CFT009    IFEQ 'N'                                       CFT009
     C                     EXSR CHARGE
     C                     ENDIF                                          CFT009
     C                     END
     C                     END
     C*
     C** SETUP SETTLE CURRENCY
     C*
     C                     MOVELSSMCY     SMCY
     C*
     C** SETUP RATE MULTIPLY/DIVIDE INDICATOR
     C*
     C                     Z-ADDWMDIN     MDIN
     C*
     C** SETUP RATE
     C*
     C                     Z-ADDWRATE     RATE
     C*
     C** SETUP DAF RATE
     C*
     C           MDIN      IFEQ 1
     C                     Z-ADDRATE      RATED
     C                     ELSE
     C           1         DIV  RATE      RATED     H
     C                     END
     C*
     C** SETUP OVERRIDE
     C*
     C           SOVRD     IFNE *BLANKS
     C                     MOVELSOVRD     OVRD
     C                     ELSE
     C                     MOVEL'N'       OVRD
     C                     END
     C*
     C** SETUP PAY AMOUNT .
     C** IF NOT ENTERED IT WILL HAVE TO BE GENERATED FROM THE SETTLE
     C** AMOUNT & THE RATE.
     C*
     C                     Z-ADDWPYAM     PYAM
     C*
     C** SETUP DAF PAY AMOUNT,DEPENDING ON NUMBER OF DECIMAL PLACES
     C** IN PAY CURRENCY
     C*
     C           SVPCDP    IFEQ *ZERO
     C                     Z-ADDPYAM      PYAMD
     C                     ELSE
     C           SVPCDP    IFEQ 1
     C           PYAM      DIV  10        PYAMD
     C                     ELSE
     C           SVPCDP    IFEQ 2
     C           PYAM      DIV  100       PYAMD
     C                     ELSE
     C           PYAM      DIV  1000      PYAMD     H
     C                     END
     C                     END
     C                     END
     C* CALCULATE BASE CURRENCY EQUIV
     C           SVPCDP    SUB  BCDP      N       10               AKEYXX
     C                     ADD  4         N
     C           SVPMDN    IFEQ 0                          B001    AKEYXX
     C           SVPSPT    MULT POWER,N   WK159     H              AKEYXX
     C           PYAM      DIV  WK159     PBCQ      H
     C                     ELSE                            X001
     C           SVPSPT    DIV  POWER,N   WK159  159H              AKEYXX
     C           PYAM      MULT WK159     PBCQ      H
     C                     END                             E001
     C*
     C* THIS IS TO MAKE BASE CURRENCY EQUIVS EQUAL
     C/COPY WNCPYSRC,FT0050C111
     C*
     C***********WPCCY     IFEQ BCCY                       B001           S01194
     C           WPCCY     IFEQ BJCYCD                     B001           S01194
     C                     Z-ADDPBCQ      SBCQ
     C                     ELSE                            X001
     C                     Z-ADDSBCQ      PBCQ
     C                     END                             E001
     C*
     C/COPY WNCPYSRC,FT0050C112
     C** SETUP PAY CURRENCY
     C*
     C                     MOVELWPCCY     PCCY
     C*
     C** SETUP SETTLE VALUE DATE
     C*
     C                     Z-ADDWSLDT     SLDT
     C*
     C** SETUP DAF SETTLE VALUE DATE 1
     C*
     C                     Z-ADDSLDT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZDATE     SLDTD1
     C*
     C** SETUP DAF SETTLE VALUE DATE 2
     C*
     C                     MOVE SLDTD1    WN2
     C           WN2       IFLT 72
     C                     Z-ADD20        SLDTD2
     C                     ELSE
     C                     Z-ADD19        SLDTD2
     C                     END
     C*
     C** SETUP DAF SETTLE VALUE DATE 3
     C*
     C                     MOVELSLDTD1    WA4
     C  N98                MOVELWA4       WA2
     C  N98                MOVE WA4       WA2A
     C  N98                MOVELWA2A      WA4
     C  N98                MOVE WA2       WA4
     C                     MOVE SLDTD1    WA2
     C                     MOVELWA2       SLDTD3
     C                     MOVE WA4       SLDTD3
     C*
     C** SETUP PAY VALUE DATE
     C*
     C                     Z-ADDWPYDT     PVDT
     C*
     C** SETUP DAF PAY VALUE DATE 1
     C*
     C                     Z-ADDPVDT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZDATE     PVDTD1
     C/COPY WNCPYSRC,FT0050C133
     C*
     C** SETUP DAF PAY VALUE DATE 2
     C*
     C                     MOVE PVDTD1    WN2
     C           WN2       IFLT 72
     C                     Z-ADD20        PVDTD2
     C                     ELSE
     C                     Z-ADD19        PVDTD2
     C                     END
     C*
     C** SETUP DAF PAY VALUE DATE 3
     C*
     C                     MOVELPVDTD1    WA4
     C  N98                MOVELWA4       WA2
     C  N98                MOVE WA4       WA2A
     C  N98                MOVELWA2A      WA4
     C  N98                MOVE WA2       WA4
/    C                     MOVE PVDTD1    WA2
     C                     MOVELWA2       PVDTD3
     C                     MOVE WA4       PVDTD3
     C*
     C** SETUP NOTIFIED DELIVERY CURRENCY                                 CEU006
     C*                                                                   CEU006
     C                     MOVELSNDCY     NDCY                            CEU006
     C** SETUP NOTIFIED DELIVERY AMOUNT                                   CEU006
     C** IF NOT ENTERED DEFAULT ENTRIES TO ZERO.                          CEU006
     C*                                                                   CEU006
     C           SNDAM     IFNE *BLANKS                                   CEU006
     C                     Z-ADDWNDAM     NDAM                            CEU006
     C                     ELSE                                           CEU006
     C                     MOVE *ZEROS    NDAM                            CEU006
     C                     ENDIF                                          CEU006
     C*
     C** SETUP ADD/DEDUCT CHARGES INDICATOR
     C*
     C           SADDC     IFNE *BLANKS
     C                     MOVELSADDC     ADDC
     C                     ELSE
     C                     MOVEL'D'       ADDC
     C                     END
     C*
     C** SETUP SWIFT PRIORITY CODE
     C*
     C           SSWPC     IFNE *BLANKS
     C*********************Z-ADDWSWPC     SWPC                            S01117
     C           SSWPC     IFEQ 'U'                        B001           S01117
     C                     Z-ADD1         SWPC                            S01117
     C                     ELSE                            X001           S01117
     C           SSWPC     IFEQ 'N'                        B002           S01117
     C                     Z-ADD2         SWPC                            S01117
     C                     END                             E002           S01117
     C                     END                             E001           S01117
     C                     ELSE
     C                     Z-ADD2         SWPC
     C                     END
     C*
     C** SETUP SWIFT REFERENCE NUMBER
     C*
     C*********************MOVE SSWTN     SRNM                            S01259
     C                     MOVE SSWTN     MIR                             S01259
     C*                                                                   E29837
     C** AND SWIFT SEQUENCE NUMBER                                        E29837
     C*                                                                   E29837
     C                     MOVE SSEQNO    ISEQ                            E29837
     C*                                                                   E29837
     C*
     C**   SET OTHER FIELDS (INCLUDING LEVEL TWO FIELDS) TO BLANKS OR
     C**      ZERO AS APPROPRIATE ON INSERT ONLY
     C*
     C           SACTCD    IFEQ 'I'
     C           SSWTN     ANDEQ*BLANKS                                   S01435
     C           PNWRK     IFNE 'FONTIS'                                  CGL009
     C                     MOVEL*BLANK    OPIN
     C                     MOVEL*BLANKS   RLPR
     C                     ENDIF                                          CGL009
     C                     MOVEL*BLANKS   ORBT
     C                     MOVEL*BLANKS   ORB1
     C                     MOVEL*BLANKS   ORB2
     C                     MOVEL*BLANKS   ORB3
     C                     MOVEL*BLANKS   ORB4
     C                     MOVEL*BLANKS   ORB5
     C                     MOVEL*BLANKS   SNCT
     C                     MOVEL*BLANKS   SNC1
     C                     MOVEL*BLANKS   SNC2
     C                     MOVEL*BLANKS   SNC3
     C                     MOVEL*BLANKS   SNC4
     C                     MOVEL*BLANKS   SNC5                            E16603
     C                     MOVEL*BLANKS   ORCT
     C           PNWRK     IFNE 'FONTIS'                                  CGL009
     C                     MOVEL*BLANKS   ORC1
     C                     MOVEL*BLANKS   ORC2
     C                     MOVEL*BLANKS   ORC3
     C                     MOVEL*BLANKS   ORC4
     C                     MOVEL*BLANKS   ORC5                                                CFT032
     C                     MOVEL*BLANKS   DTP1
     C                     MOVEL*BLANKS   DTP2
     C                     MOVEL*BLANKS   DTP3
     C                     MOVEL*BLANKS   DTP4
     C                     MOVEL*BLANKS   DTCH
     C                     MOVEL*BLANKS   BBI1
     C                     MOVEL*BLANKS   BBI2
     C                     MOVEL*BLANKS   BBI3
     C                     MOVEL*BLANKS   BBI4
     C                     MOVEL*BLANKS   BBI5
     C                     MOVEL*BLANKS   BBI6
     C                     ENDIF                                          CGL009
     C/COPY WNCPYSRC,FT0050C094
     C                     Z-ADD*ZERO     DNBC
     C/COPY WNCPYSRC,FT0050C095
     C                     MOVEL*BLANKS   INBT
     C                     MOVEL*BLANKS   INB1
     C                     MOVEL*BLANKS   INB2
     C                     MOVEL*BLANKS   INB3
     C                     MOVEL*BLANKS   INB4
     C                     MOVEL*BLANKS   INB5
     C                     MOVEL*BLANKS   TRCT
     C                     MOVEL*BLANKS   INVAT1                          S01499
     C                     MOVEL*BLANKS   INVAT2                          S01499
     C                     MOVEL*BLANKS   INVAT3                          S01499
     C                     MOVEL*BLANKS   INVAT4                          S01499
     C                     MOVEL*BLANKS   INVAT5                          S01499
     C                     MOVEL*BLANKS   INVAT6                          S01499
     C                     MOVEL*BLANKS   INVAT7                          S01499
     C                     Z-ADD*ZERO     TRCM
     C                     Z-ADD*ZERO     TRCMD
     C                     Z-ADD*ZERO     TXCH
     C                     Z-ADD*ZERO     TXCHD
     C                     Z-ADD*ZERO     CQCHD
     C/COPY WNCPYSRC,FT0050C185
     C                     Z-ADD*ZERO     ADCH
     C                     Z-ADD*ZERO     ADCHD
     C/COPY WNCPYSRC,FT0050C186
     C                     Z-ADD*ZERO     TLCH
     C                     Z-ADD*ZERO     TLCHD
     C                     Z-ADD*ZERO     MSCH
     C                     Z-ADD*ZERO     MSCHD
     C                     MOVEL*BLANKS   CDRT
     C***********          Z-ADD*ZERO     CDRO                                                CSD027
     C                     MOVE *BLANKS   CDRO                                                CSD027
     C***********          MOVEL*BLANKS   AUP1                            S01435
     C***********          MOVEL*BLANKS   AUP2                            S01435
     C                     MOVEL*BLANKS   AUIN
     C                     MOVEL*BLANKS   SACG
     C                     MOVEL*BLANKS   PACG
     C                     MOVEL*BLANKS   SMSG
     C                     MOVEL*BLANKS   PMSG
     C                     MOVEL*BLANKS   IACG
     C                     MOVEL*BLANKS   ADIN
     C*                                                                   S01494
     C           S01494    IFEQ 'Y'                                       S01494
     C                     Z-ADD0         INCHCM                          S01494
     C                     END                                            S01494
     C           S01499    IFEQ 'Y'                                       S01499
     C                     Z-ADD0         INVATT                          S01499
     C                     MOVE 'Y'       INVAT1                          S01499
     C                     MOVE 'Y'       INVAT2                          S01499
     C                     MOVE 'Y'       INVAT3                          S01499
     C                     MOVE 'Y'       INVAT4                          S01499
     C                     MOVE 'Y'       INVAT5                          S01499
     C                     MOVE 'Y'       INVAT6                          S01499
     C                     MOVE 'Y'       INVAT7                          S01499
     C                     END                                            S01499
      *                                                                   CFT009
      * If CFT009, reset VAT flags to blanks                              CFT009
     C           CFT009    IFEQ 'Y'                                       CFT009
     C                     MOVE *BLANK    INVAT1                          CFT009
     C                     MOVE *BLANK    INVAT2                          CFT009
     C                     MOVE *BLANK    INVAT3                          CFT009
     C                     MOVE *BLANK    INVAT4                          CFT009
     C                     MOVE *BLANK    INVAT5                          CFT009
     C                     MOVE *BLANK    INVAT6                          CFT009
     C                     MOVE *BLANK    INVAT7                          CFT009
     C                     MOVE *BLANK    IPVAT1                          CFT009
     C                     MOVE *BLANK    IPVAT2                          CFT009
     C                     MOVE *BLANK    IPVAT3                          CFT009
     C                     MOVE *BLANK    IPVAT4                          CFT009
     C                     MOVE *BLANK    IPVAT5                          CFT009
     C                     MOVE *BLANK    IPVAT6                          CFT009
     C                     MOVE *BLANK    IPVAT7                          CFT009
     C                     MOVE *BLANK    VTMIC1                          CFT009
     C                     MOVE *BLANK    VTMIC2                          CFT009
     C                     MOVE *BLANK    VTMIC3                          CFT009
     C                     MOVE *BLANK    VTMIC4                          CFT009
     C                     MOVE *BLANK    VTMIC5                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     END
      *                                                                   S01435
     C                     MOVEL*BLANKS   AUP1                            S01435
     C                     MOVEL*BLANKS   AUP2                            S01435
     C*                                                                   CAC001
     C** Setup Margin Information fields for update                       CAC001
     C*                                                                   CAC001
     C                     Z-ADDW3FXMP    FXMP                            CAC001
     C                     Z-ADDW3FXMD    FXMD                            CAC001
     C                     MOVELW3MBSI    MBSI                            CAC001
     C                     MOVELW3MSIG    MSIG                            CAC001
     C                     Z-ADDW3MAMT    MAMT                            CAC001
     C*
     C** IF ACTION CODE IS 'A' BUT RECORD WAS INSERTED TODAY,DO NOT
     C** CHANGE THE LAST CHANGE TYPE
     C*
     C           SACTCD    IFNE 'A'
     C           SVCHTP    ORNE 'I'
     C***********SVLCD     ORNE RUND                                      S01194
     C           SVLCD     ORNE BJRDNB                                    S01194
     C                     MOVELSACTCD    CHTP
     C                     ELSE
     C                     MOVELSVCHTP    CHTP
     C                     END
     C/COPY WNCPYSRC,FT0050C119
     C*
     C** SETUP DATE & TIME STAMP
     C*
     C***********          Z-ADDRUND      INLCD                           S01194
     C                     Z-ADDBJRDNB    INLCD                           S01194
     C                     Z-ADDTIME      LCHT
     C/COPY WNCPYSRC,FT0050C142
     C*
     C*          *****     *****
     C           GCEND     ENDSR
     C*          *****     *****
     C/EJECT
     C           GEINTR    BEGSR
     C*          ******    *****
     C*
     C*****************************************************************
     C*                 GE-UPDATE-INPAY-TRAILER-RECORD                *
     C*                                                               *
     C*  FUNCTION : TO UPDATE THE INCOMING PAYMENTS TRAILER RECORD    *
     C*             WITH PAYMENT AMOUNT FROM TRANSACTION ENTERED.     *
     C*                                                               *
     C*  CALLS :    UEABRT                                            *
     C*             GLZADD                                            *
     C*                                                               *
     C*  CALLED BY: ECINST                                            *
     C*             EEAMND                                            *
     C*             EGDELT                                            *
     C*                                                               *
     C*****************************************************************
     C*
     C** READ TRAILER RECORD
     C*
     C           1         CHAININPAYZZ              89
     C*
     C           *IN89     IFEQ '1'                         -CHECK FOR
     C                     MOVEL'INPAY'   WDBFIL             DATABASE
     C                     MOVEL'MISSING' WA15               ERROR.
     C                     MOVE 'TRAILER' WA15
     C                     MOVELWA15      WDBKEY
     C                     MOVEL'13'      WDBASE
     C                     EXSR UEABRT
     C                     END
     C*
     C** INCREMENT RECORD COUNT IF ACTION CODE IS 'I'
     C*
     C           SACTCD    IFEQ 'I'
     C                     ADD  1         NORE1
     C                     END
     C*
     C** INCREMENT HASH TOTALS OF PAYMENT AMOUNTS
     C*
     C                     Z-ADDHRWN      ZZTOTI
     C                     Z-ADDHRDC      ZZTOTD
     C                     EXSR GLZADD
     C                     Z-ADDZZTOTI    HRWN
     C                     Z-ADDZZTOTD    HRDC
     C*
     C** UPDATER TRAILER RECORD
     C*
     C                     UPDATINPAYZZF               89
     C*
     C           *IN89     IFEQ '1'
     C                     MOVEL'INPAY'   WDBFIL            -DATABASE
     C                     MOVEL'MISSING' WA15               ERROR.
     C                     MOVE 'TRAILER' WA15
     C                     MOVELWA15      WDBKEY
     C                     MOVEL'14'      WDBASE
     C                     EXSR UEABRT
     C                     END
     C*
     C*          *****     *****
     C           GEEND     ENDSR
     C*          *****     *****
     C/EJECT
      ***********                                                         056031
      ***********   Remove PRONO OLPOS and MEMOS processing               056031
      ***********                                                         056031
     C***********GGDLUP    BEGSR                                          056031
     C*****************    *****                                          056031
     C***********                                                         056031
     C*****************************************************************   056031
     C***********       GG-UPDATE-DEALING-MODULE-FILES                *   056031
     C***********                                                     *   056031
     C***FUNCTION : TO UPDATE THE FILES USED BY THE DEALING MODULE,   *   056031
     C***********   NAMELY PRONO,OLPOS.                               *   056031
     C***********                                                     *   056031
     C***CALLS*:*   UEABRT                                            *   056031
     C***********   USPRCN                                            *   056031
     C***********   UUOLCN                                            *   056031
     C***********   ADOTPY                                            *   056031
     C***********                                                     *   056031
     C***CALLED*BY: ECINST                                            *   056031
     C***********   EEAMND                                            *   056031
     C***********   EGDELT                                            *   056031
     C***********                                                     *   056031
     C*****************************************************************   056031
      ***********                                                         056031
      ***Check*whether outgoing payment to be generated by this payment   056031
      ****in*FT0060, so that shadow postings won't be duplicated          056031
      ***********                                                         056031
     C***********WACBT     IFNE *BLANK                                    056031
     C***********          EXSR ADOTPY                                    056031
     C***********          END                                            056031
     C***********                                                         056031
     C*******************                                                 056031
     C***OLPOS*UPDATES **                                                 056031
     C*******************                                                 056031
     C***********                                                         056031
     C***ACCESS*SETTLE CURRENCY RECORD NUMBER 1                           056031
     C***********                                                         056031
     C***********          MOVELSBRCA     KOBRCA                    S01117056031
     C***********          MOVELWSMCY     KOLCCY                          056031
     C***********          MOVE '01'      KOLRCN                          056031
     C***********          EXSR UUOLCN                                    056031
     C************IN89     IFEQ '1'                                       056031
     C***********          GOTO GG100                      -IGNORE.       056031
     C***********          END                                            056031
     C***********                                                         056031
     C***IGNORE*IF PAYMENT DATE IS LESS THAN FIRST DAY FOR CURRENCY       056031
     C***********                                                         056031
     C***********WSLDT     IFLT YOD,1                                     056031
     C***********          EXCPTEXOLPS                     -RLS REC.      056031
     C***********          GOTO GG100                                     056031
     C***********          END                                            056031
     C***********                                                         056031
     C***DETERMINE 1ST CCY DATE TO WHICH PAYMENT IS TO BE APPLIED         056031
     C***********                                                         056031
     C***********          SETOF                     8889                 056031
     C***********          Z-ADD1         I                               056031
     C***********                                                         056031
     C***********WSLDT     IFGT YOD,16                                    056031
     C***********          Z-ADD16        I                               056031
     C***********          ELSE                                           056031
     C***********WSLDT     LOKUPYOD,I                88  89               056031
     C***********                                                         056031
     C************IN88     IFEQ '1'                         -PAYMENT      056031
     C***********I         ANDGT1                            DATE FALLS   056031
     C***********          SUB  1         I                  BETWEEN 2    056031
     C***********          END                               NOSTRO DTS   056031
     C***********                                                         056031
     C***********          END                                            056031
     C***********                                                         056031
     C***ADD*PAYMENT AMOUNT TO RELEVANT INCOMING BALANCE                  056031
     C***********                                                         056031
     C***********          ADD  WSMAM     YOI,I                           056031
     C***********                                                         056031
     C***SETUP*TIME OF CHANGE                                             056031
     C***********                                                         056031
     C***********          MOVE TIME      TNLU                            056031
     C***********                                                         056031
     C***UPDATE*OLPOS RECORD                                              056031
     C***********                                                         056031
     C***********          UPDATOLPOSOAF               89                 056031
     C***********                                                         056031
     C************IN89     IFEQ '1'                                       056031
     C***********          MOVEL'OLPOS'   WDBFIL            -DATABASE     056031
     C*********************MOVELWSMCY     WA5                ERROR.       S01117
     C***********          MOVELWSMCY     WA5     5                 S01117056031
     C***********          MOVE '01'      WA5                             056031
     C***********          MOVELWA5       WDBKEY                          056031
     C***********          MOVEL'15'      WDBASE                          056031
     C***********          EXSR UEABRT                                    056031
     C***********          END                                            056031
     C***********                                                         056031
     C****************     ***                                            056031
     C***********GG100     TAG                                            056031
     C****************     ***                                            056031
     C***********                                                         056031
     C***ACCESS*PAY CURRENCY RECORD NUMBER 1                              056031
     C***********                                                         056031
     C************IN21     IFEQ '0'                                       056031
     C***********          MOVELSBRCA     KOBRCA                    S01117056031
     C***********          MOVELWPCCY     KOLCCY                          056031
     C***********          MOVE '01'      KOLRCN                          056031
     C***********          EXSR UUOLCN                                    056031
     C************IN89     IFEQ '1'                                       056031
     C***********          GOTO GG200                      -IGNORE.       056031
     C***********          END                                            056031
     C***********                                                         056031
     C***IGNORE*IF RECEIPT DATE IS LESS THAN FIRST DAY FOR CURRENCY       056031
     C***********                                                         056031
     C***********WPYDT     IFLT YOD,1                                     056031
     C***********          EXCPTEXOLPS                     -RLS REC.      056031
     C***********          GOTO GG200                                     056031
     C***********          END                                            056031
     C***********                                                         056031
     C***DETERMINE 1ST CCY DATE TO WHICH PAYMENT IS TO BE APPLIED         056031
     C***********                                                         056031
     C***********          SETOF                     8889                 056031
     C***********          Z-ADD1         I                               056031
     C***********                                                         056031
     C***********WPYDT     IFGT YOD,16                                    056031
     C***********          Z-ADD16        I                               056031
     C***********          ELSE                                           056031
     C***********WPYDT     LOKUPYOD,I                88  89               056031
     C***********                                                         056031
     C************IN88     IFEQ '1'                         -PAYMENT      056031
     C***********I         ANDGT1                            DATE FALLS   056031
     C***********          SUB  1         I                  BETWEEN 2    056031
     C***********          END                               NOSTRO DTS   056031
     C***********                                                         056031
     C***********          END                                            056031
     C***********                                                         056031
     C***ADD*RECEIPT AMOUNT TO RELEVANT OUTGOING BALANCE                  056031
     C***********                                                         056031
     C***********          ADD  WPYAM     YOO,I                           056031
     C***********                                                         056031
     C***SETUP*TIME OF CHANGE                                             056031
     C***********                                                         056031
     C***********          MOVE TIME      TNLU                            056031
     C***********                                                         056031
     C***UPDATE*OLPOS RECORD                                              056031
     C***********                                                         056031
     C***********          UPDATOLPOSOAF               89                 056031
     C***********                                                         056031
     C************IN89     IFEQ '1'                                       056031
     C***********          MOVEL'OLPOS'   WDBFIL            -DATABASE     056031
     C***********          MOVELWSMCY     WA5                ERROR.       056031
     C***********          MOVE '01'      WA5                             056031
     C***********          MOVELWA5       WDBKEY                          056031
     C***********          MOVEL'16'      WDBASE                          056031
     C***********          EXSR UEABRT                                    056031
     C***********          END                                            056031
     C***********          END                                            056031
     C***********                                                         056031
     C****************     ***                                            056031
     C***********GG200     TAG                                            056031
     C****************     ***                                            056031
     C*******************                                                 056031
     C***PRONO*UPDATES **                                                 056031
     C*******************                                                 056031
     C***********                                                         056031
     C**IF*RECEIVER'S CORRESPONDENT IS NOT TYPE 'N' CHECK FOR NOSTRO      056031
     C**ACCOUNT**                                                         056031
     C***********WRCRT     IFNE 'N'                                       056031
     C***********          MOVE WRCRT     NTYPE   1                       056031
     C***********          MOVELWRCCO     RTNO                            056031
     C***********          MOVE WSMCY     NCCY                            056031
     C***********          EXSR NOSTRO                                    056031
     C***********          MOVE CCY       KPRCCY                          056031
     C***********          MOVE NOSN      KPRNOS                          056031
     C***********          ELSE                                           056031
     C***********          SETON                     65                   056031
     C***ACCESS*APPROPRIATE PRONO RECORD                                  056031
     C***********                                                         056031
     C***********          MOVELWSMCY     KPRCCY                          056031
     C***********          MOVELWRCNOS    KPRNOS                          056031
     C***********          END                                            056031
     C**N65******          GOTO GG300                                     056031
     C***SAVE*NOSTRO NUMBER IN CASE UNALLOCATED NOTSRO 00 USED.     E32536056031
     C***********                                                   E32536056031
     C***********          Z-ADDKPRNOS    NOSOR   20                E32536056031
     C***********                                                   E32536056031
     C***********          EXSR USPRCN                                    056031
     C************IN89     IFEQ '1'                        -MISSING;      056031
     C***********          MOVEL'00'      KPRNOS            TRY DEFAULT   056031
     C***********          EXSR USPRCN                      NOSTRO.       056031
     C***********          MOVELWRCNOS    KPRNOS                    E22989056031
     C************IN89     IFEQ '1'                                       056031
     C***********          GOTO GG300                      -IGNORE.       056031
     C***********          END                                            056031
     C***********          END                                            056031
     C***********                                                         056031
     C***IGNORE*IF PAYMENT DATE IS GREATER THAN LAST DAY FOR NOSTRO       056031
     C***********                                                         056031
     C***********WSLDT     IFGT YPD,5                                     056031
     C***********          EXCPTEXPRNO                     -RLS REC.      056031
     C***********          GOTO GG300                                     056031
     C***********          END                                            056031
     C***********                                                         056031
     C***DETERMINE 1ST NOSTRO DATE TO WHICH PAYMENT IS TO BE APPLIED      056031
     C***********                                                         056031
     C***********          SETOF                     8889                 056031
     C***********          Z-ADD1         I                               056031
     C***********                                                         056031
     C***********WSLDT     LOKUPYPD,I                88  89               056031
     C***********                                                         056031
     C************IN88     IFEQ '1'                         -PAYMENT      056031
     C***********I         ANDGT1                            DATE FALLS   056031
     C***********          SUB  1         I                  BETWEEN 2    056031
     C***********          END                               NOSTRO DTS   056031
     C***********                                                         056031
     C***ADD*PAYMENT AMOUNT TO ALL RELEVANT BALANCES                      056031
     C***********                                                         056031
     C***********          Z-ADDYPB       YPO                             056031
     C***********I         DOUGT5                                         056031
     C***********          ADD  WSMAM     YPB,I                           056031
     C***********          ADD  1         I                               056031
     C***********          END                                            056031
     C***********                                                         056031
     C***SETUP*TIME OF CHANGE                                             056031
     C***********                                                         056031
     C***********          MOVE TIME      TNLU                            056031
     C***********                                                         056031
     C***UPDATE*PRONO RECORD                                              056031
     C***********                                                         056031
     C***********          UPDATPRONOPNF               89                 056031
     C***********                                                         056031
     C************IN89     IFEQ '1'                                       056031
     C***********          MOVEL'PRONO'   WDBFIL            -DATABASE     056031
     C***********          MOVELCCY       WA5                ERROR.       056031
     C***********          MOVE NOSN      WA5                             056031
     C***********          MOVELWA5       WDBKEY                          056031
     C***********          MOVEL'17'      WDBASE                          056031
     C***********          EXSR UEABRT                                    056031
     C***********          END                                            056031
     C***********                                                         056031
     C***********          Z-ADDWSLDT     VUDT                            056031
     C***********          Z-ADDWSMAM     MVAM                            056031
     C***********          SETON                     60                   056031
     C***********                                                   E32536056031
     C***REINSTATE ORIGINAL NOSTRO NUMBER IN CASE UNALLOCATED       E32536056031
     C***NOSTRO*NO 00 USED                                          E32536056031
     C***********                                                   E32536056031
     C***********          Z-ADDNOSOR     KPRNOS                    E32536056031
     C***********                                                   E32536056031
     C***********          EXSR AMOVTS                                    056031
     C***********                                                         056031
     C****************     ***                                            056031
     C***********GG300     TAG                                            056031
     C****************     ***                                            056031
     C***********                                                         056031
     C***IF*RECEIVER'S CORRESPONDENT IS NOT BLANK OR SENDER DOES NOT      056031
     C***CONTAIN*A NOSTRO,SKIP THE NEXT FEW LINES                         056031
     C***********                                                         056031
     C***********WRCRT     IFNE *BLANKS                                   056031
     C***********          GOTO GG400                                     056031
     C***********          END                                            056031
     C***********                                                         056031
     C***ACCESS*APPROPRIATE PRONO RECORD                                  056031
     C***********                                                         056031
     C***********WSNTP     IFNE 'F'                                       056031
     C***********          MOVE WSNTP     NTYPE   1                       056031
     C***********          MOVELWSND1     RTNO                            056031
     C***********          MOVE WSMCY     NCCY                            056031
     C***********          EXSR NOSTRO                                    056031
     C***********          MOVE CCY       KPRCCY                          056031
     C***********          MOVE NOSN      KPRNOS                          056031
     C***********          ELSE                                           056031
     C***********          SETON                     65                   056031
     C***********          MOVELWSNOS     KPRCCY                          056031
     C***********          MOVE WSNOS     KPRNOS                          056031
     C***********          END                                            056031
     C**N65******          GOTO GG400                                     056031
     C***SAVE*NOSTRO NUMBER IN CASE UNALLOCATED NOTSRO 00 USED.     E32536056031
     C***********                                                   E32536056031
     C***********          Z-ADDKPRNOS    NOSOR                     E32536056031
     C***********                                                   E32536056031
     C***********          EXSR USPRCN                                    056031
     C************IN89     IFEQ '1'                        -MISSING;      056031
     C***********          MOVEL'00'      KPRNOS            TRY DEFAULT   056031
     C***********          EXSR USPRCN                      NOSTRO.       056031
     C***********          MOVE WSNOS     KPRNOS                    E22989056031
     C************IN89     IFEQ '1'                                       056031
     C***********          GOTO GG400                      -IGNORE.       056031
     C***********          END                                            056031
     C***********          END                                            056031
     C***********                                                         056031
     C***IGNORE*IF PAYMENT DATE IS GREATER THAN LAST DAY FOR NOSTRO       056031
     C***********                                                         056031
     C***********WSLDT     IFGT YPD,5                                     056031
     C***********          EXCPTEXPRNO                     -RLS REC.      056031
     C***********          GOTO GG400                                     056031
     C***********          END                                            056031
     C***********                                                         056031
     C***DETERMINE 1ST NOSTRO DATE TO WHICH PAYMENT IS TO BE APPLIED      056031
     C***********                                                         056031
     C***********          SETOF                     8889                 056031
     C***********          Z-ADD1         I                               056031
     C***********                                                         056031
     C***********WSLDT     LOKUPYPD,I                88  89               056031
     C***********                                                         056031
     C************IN88     IFEQ '1'                         -PAYMENT      056031
     C***********I         ANDGT1                            DATE FALLS   056031
     C***********          SUB  1         I                  BETWEEN 2    056031
     C***********          END                               NOSTRO DTS   056031
     C***********                                                         056031
     C***ADD*PAYMENT AMOUNT TO ALL RELEVANT BALANCES                      056031
     C***********                                                         056031
     C***********          Z-ADDYPB       YPO                             056031
     C***********I         DOUGT5                                         056031
     C***********          ADD  WSMAM     YPB,I                           056031
     C***********          ADD  1         I                               056031
     C***********          END                                            056031
     C***********                                                         056031
     C***SETUP*TIME OF CHANGE                                             056031
     C***********                                                         056031
     C***********          MOVE TIME      TNLU                            056031
     C***********                                                         056031
     C***UPDATE*PRONO RECORD                                              056031
     C***********                                                         056031
     C***********          UPDATPRONOPNF               89                 056031
     C***********                                                         056031
     C************IN89     IFEQ '1'                                       056031
     C***********          MOVEL'PRONO'   WDBFIL            -DATABASE     056031
     C***********          MOVELCCY       WA5                ERROR.       056031
     C***********          MOVE NOSN      WA5                             056031
     C***********          MOVELWA5       WDBKEY                          056031
     C***********          MOVEL'18'      WDBASE                          056031
     C***********          EXSR UEABRT                                    056031
     C***********          END                                            056031
     C***********                                                         056031
     C***********          Z-ADDWSLDT     VUDT                            056031
     C***********          Z-ADDWSMAM     MVAM                            056031
     C***********          SETON                     60                   056031
     C***REINSTATE ORIGINAL NOSTRO NUMBER IN CASE UNALLOCATED       E32536056031
     C***NOSTRO*NO 00 USED                                          E32536056031
     C***********                                                   E32536056031
     C***********          Z-ADDNOSOR     KPRNOS                    E32536056031
     C***********                                                   E32536056031
     C***********          EXSR AMOVTS                                    056031
     C***********                                                         056031
     C****************     ***                                            056031
     C***********GG400     TAG                                            056031
     C****************     ***                                            056031
     C***********                                                         056031
     C***********                                                         056031
     C***ACCESS*APPROPRIATE PRONO RECORD                                  056031
     C***********                                                         056031
     C************IN21     IFEQ '0'                                       056031
     C***********WACBT     IFNE 'N'                                       056031
     C***********          MOVE WACBT     NTYPE   1                       056031
     C***********          MOVELWACBK     RTNO                            056031
     C***********          MOVE WPCCY     NCCY    3                       056031
     C***********          EXSR NOSTRO                                    056031
     C***********          MOVE CCY       KPRCCY                          056031
     C***********          MOVE NOSN      KPRNOS                          056031
     C***********          ELSE                                           056031
     C***********          SETON                     65                   056031
     C***********          MOVELWPCCY     KPRCCY                          056031
     C***********          MOVELWACNOS    KPRNOS                          056031
     C***********          END                                            056031
     C**N65******          GOTO GG500                                     056031
     C***SAVE*NOSTRO NUMBER IN CASE UNALLOCATED NOTSRO 00 USED.     E32536056031
     C***********                                                   E32536056031
     C***********          Z-ADDKPRNOS    NOSOR   20                E32536056031
     C***********                                                   E32536056031
     C***********          EXSR USPRCN                                    056031
     C************IN89     IFEQ '1'                        -MISSING;      056031
     C***********          MOVEL'00'      KPRNOS            TRY DEFAULT   056031
     C***********          EXSR USPRCN                      NOSTRO.       056031
     C***********          MOVELWACNOS    KPRNOS                    E22989056031
     C************IN89     IFEQ '1'                                       056031
     C***********          GOTO GG500                      -IGNORE.       056031
     C***********          END                                            056031
     C***********          END                                            056031
     C***********                                                         056031
     C***IGNORE*IF PAY DATE IS GREATER THAN LAST DAY FOR NOSTRO           056031
     C***********                                                         056031
     C***********WPYDT     IFGT YPD,5                                     056031
     C***********          EXCPTEXPRNO                     -RLS REC.      056031
     C***********          GOTO GG500                                     056031
     C***********          END                                            056031
     C***********                                                         056031
     C***DETERMINE 1ST NOSTRO DATE TO WHICH RECEIPT IS TO BE APPLIED      056031
     C***********                                                         056031
     C***********          SETOF                     8889                 056031
     C***********          Z-ADD1         I                               056031
     C***********                                                         056031
     C***********WPYDT     LOKUPYPD,I                88  89               056031
     C***********                                                         056031
     C************IN88     IFEQ '1'                         -PAYMENT      056031
     C***********I         ANDGT1                            DATE FALLS   056031
     C***********          SUB  1         I                  BETWEEN 2    056031
     C***********          END                               NOSTRO DTS   056031
     C***********                                                         056031
     C***ADD*RECEIPT AMOUNT TO ALL RELEVANT BALANCES                      056031
     C***********                                                         056031
     C***********          Z-ADDYPB       YPO                       S01117056031
     C***********I         DOUGT5                                         056031
     C***********          SUB  WPYAM     YPB,I                           056031
     C***********          ADD  1         I                               056031
     C***********          END                                            056031
     C***********                                                         056031
     C***SETUP*TIME OF CHANGE                                             056031
     C***********                                                         056031
     C***********          MOVE TIME      TNLU                            056031
     C***********                                                         056031
     C***UPDATE*PRONO RECORD                                              056031
     C***********                                                         056031
     C***********          UPDATPRONOPNF               89                 056031
     C***********                                                         056031
     C************IN89     IFEQ '1'                                       056031
     C***********          MOVEL'PRONO'   WDBFIL            -DATABASE     056031
     C***********          MOVELCCY       WA5                ERROR.       056031
     C***********          MOVE NOSN      WA5                             056031
     C***********          MOVELWA5       WDBKEY                          056031
     C***********          MOVEL'19'      WDBASE                          056031
     C***********          EXSR UEABRT                                    056031
     C***********          END                                            056031
     C***********                                                   S01117056031
     C***********          Z-ADDWPYDT     VUDT                      S01117056031
     C***********          Z-ADDWPYAM     MVAM                      S01117056031
     C***********          SETON                     60             S01117056031
     C***REINSTATE ORIGINAL NOSTRO NUMBER IN CASE UNALLOCATED       E32536056031
     C***NOSTRO*NO 00 USED                                          E32536056031
     C***********                                                   E32536056031
     C***********          Z-ADDNOSOR     KPRNOS                    E32536056031
     C***********                                                   E32536056031
     C***********          EXSR AMOVTS                              S01117056031
     C***********                                                   S01117056031
     C***********          END                                            056031
     C***********                                                         056031
     C****************     ***                                            056031
     C***********GG500     TAG                                            056031
     C****************     ***                                            056031
     C***********                                                         056031
     C***IF*BENEFICIARY DOES NOT CONTAIN A NOSTRO,SKIP THE NEXT           056031
     C***FEW*LINES                                                        056031
     C***********                                                         056031
     C***********                                                         056031
     C***ACCESS*APPROPRIATE PRONO RECORD                                  056031
     C***********                                                         056031
     C***********WACBT     IFNE *BLANK                                    056031
     C***********          GOTO GGEND                                     056031
     C***********          END                                            056031
     C***********          MOVE WBNCT     NTYPE   1                       056031
     C***********          MOVELWBNC1     RTNO                            056031
     C***********          MOVE WPCCY     NCCY    3                       056031
     C***********          EXSR NOSTRO                                    056031
     C***********          MOVE CCY       KPRCCY                          056031
     C***********          MOVE NOSN      KPRNOS                          056031
     C**N65******          GOTO GGEND                                     056031
     C***SAVE*NOSTRO NUMBER IN CASE UNALLOCATED NOTSRO 00 USED.     E32536056031
     C***********                                                   E32536056031
     C***********          Z-ADDKPRNOS    NOSOR                     E32536056031
     C***********                                                   E32536056031
     C***********          EXSR USPRCN                                    056031
     C************IN89     IFEQ '1'                        -MISSING;      056031
     C***********          MOVEL'00'      KPRNOS            TRY DEFAULT   056031
     C***********          EXSR USPRCN                      NOSTRO.       056031
     C***********          MOVE NOSN      KPRNOS                    E22989056031
     C************IN89     IFEQ '1'                                       056031
     C***********          GOTO GGEND                      -IGNORE.       056031
     C***********          END                                            056031
     C***********          END                                            056031
     C***********                                                         056031
     C***IGNORE*IF PAY DATE IS GREATER THAN LAST DAY FOR NOSTRO           056031
     C***********                                                         056031
     C***********WPYDT     IFGT YPD,5                                     056031
     C***********          EXCPTEXPRNO                     -RLS REC.      056031
     C***********          GOTO GGEND                                     056031
     C***********          END                                            056031
     C***********                                                         056031
     C***DETERMINE 1ST NOSTRO DATE TO WHICH RECEIPT IS TO BE APPLIED      056031
     C***********                                                         056031
     C***********          SETOF                     8889                 056031
     C***********          Z-ADD1         I                               056031
     C***********                                                         056031
     C***********WPYDT     LOKUPYPD,I                88  89               056031
     C***********                                                         056031
     C************IN88     IFEQ '1'                         -PAYMENT      056031
     C***********I         ANDGT1                            DATE FALLS   056031
     C***********          SUB  1         I                  BETWEEN 2    056031
     C***********          END                               NOSTRO DTS   056031
     C***********                                                         056031
     C***ADD*RECEIPT AMOUNT TO ALL RELEVANT BALANCES                      056031
     C***********                                                         056031
     C***********          Z-ADDYPB       YPO                             056031
     C***********I         DOUGT5                                         056031
     C***********          SUB  WPYAM     YPB,I                           056031
     C***********          ADD  1         I                               056031
     C***********          END                                            056031
     C***********                                                         056031
     C***SETUP*TIME OF CHANGE                                             056031
     C***********                                                         056031
     C***********          MOVE TIME      TNLU                            056031
     C***********                                                         056031
     C***UPDATE*PRONO RECORD                                              056031
     C***********                                                         056031
     C***********          UPDATPRONOPNF               89                 056031
     C***********                                                         056031
     C***********          Z-ADDWPYDT     VUDT                            056031
     C***********          Z-ADDWPYAM     MVAM                            056031
     C***********          SETON                     60                   056031
     C***REINSTATE ORIGINAL NOSTRO NUMBER IN CASE UNALLOCATED       E32536056031
     C***NOSTRO*NO 00 USED                                          E32536056031
     C***********                                                   E32536056031
     C***********          Z-ADDNOSOR     KPRNOS                    E32536056031
     C***********                                                   E32536056031
     C***********          EXSR AMOVTS                                    056031
     C***********                                                         056031
     C************IN89     IFEQ '1'                                       056031
     C***********          MOVEL'PRONO'   WDBFIL            -DATABASE     056031
     C***********          MOVELCCY       WA5                ERROR.       056031
     C***********          MOVE NOSN      WA5                             056031
     C***********          MOVELWA5       WDBKEY                          056031
     C***********          MOVEL'51'      WDBASE                          056031
     C***********          EXSR UEABRT                                    056031
     C***********          END                                            056031
     C***********                                                         056031
     C****************     *****                                          056031
     C***********GGEND     ENDSR                                          056031
     C****************     *****                                          056031
     C*/EJECT*****                                                        056031
     C***********GIRTUP    BEGSR                                          056031
     C*****************    *****                                          056031
     C***********                                                         056031
     C*****************************************************************   056031
     C***********       GI-UPDATE-RETAIL-MODULE-FILES                 *   056031
     C***********                                                     *   056031
     C***FUNCTION : TO UPDATE THE FILES USED BY THE RETAIL MODULE,    *   056031
     C***********   NAMELY MEMOS.                                     *   056031
     C***********                                                     *   056031
     C***CALLS*:****UATBCN************************                  S01194056031
     C***********   UEABRT                                            *   056031
     C***********   UMAACN                                            *   056031
     C***********   UOACCN                                            *   056031
     C***********   UWMMCN                                            *   056031
     C***********   ADOTPY                                            *   056031
     C***********                                                     *   056031
     C***CALLED*BY: ECINST                                            *   056031
     C***********   EEAMND                                            *   056031
     C***********   EGDELT                                            *   056031
     C***********                                                     *   056031
     C*****************************************************************   056031
      ***********                                                         056031
      ***Check*whether outgoing payment to be generated by this payment   056031
      ****in*FT0060, so that shadow postings won't be duplicated          056031
      ***********                                                         056031
     C***********WACBT     IFNE *BLANK                                    056031
     C***********          EXSR ADOTPY                                    056031
     C***********          END                                            056031
     C***********                                                         056031
     C***IF*RECEIVER'S CORRESPONDENT DOES NOT CONTAIN A NOSTRO,SKIP       056031
     C***THE*NEXT FEW LINES                                               056031
     C***********                                                         056031
     C***********WRCRT     CABNE'N'       GI100                           056031
     C***********                                                         056031
     C***ACCESS*NOSTRO RECORD FROM TABLE FILE                             056031
     C***********                                                         056031
     C***********          MOVEL*BLANKS   ZTABKY                          S01194
     C***********          MOVEL'70'      ZTABKY                          S01194
     C***********          MOVELWSMCY     WA5                             S01194
     C***********          MOVELWRCCO     WA2                             S01194
     C***********          MOVE WA2       WA5                             S01194
     C***********          MOVE WA5       ZTABKY                          S01194
     C***********          EXSR UATBCN                                    S01194
     C************IN89     IFEQ '1'                                       S01194
     C***********          MOVEL'TABFP'   WDBFIL            -DATABASE     S01194
     C***********          MOVELZTABKY    WDBKEY             ERROR.       S01194
     C***********          MOVEL'20'      WDBASE                          S01194
     C***********          EXSR UEABRT                                    S01194
     C***********          END                                            S01194
     C***********                                                   S01194056031
     C***********          CALL 'AONOSTR0'                          S01194056031
     C***********          PARM '*DBERR ' @RTCD   7                 S01194056031
     C***********          PARM '*KEY   ' @OPTN   7                 S01194056031
     C***********          PARM *BLANKS   @CUST   6                 S01194056031
     C***********          PARM WSMCY     @CYCD   3                 S01194056031
     C***********          PARM *BLANKS   @ACCN   4                 S01194056031
     C***********          PARM *BLANKS   @ACSN   2                 S01194056031
     C***********          PARM WRCCO     @NONB   2                 S01194056031
     C***********          PARM *BLANKS   @BRCD   3                 S01194056031
     C***********          PARM *BLANKS   @CSSN  10                 S01194056031
     C***********          PARM *BLANKS   @PNOI   1                 S01194056031
     C***********SDNOST    PARM SDNOST    DSFDY                     S01194056031
     C***********          EXSR MVNOS1                              S01194056031
     C***********                                                         056031
     C***ACCESS*ACCOUNT FILE FOR THIS NOSTRO                              056031
     C***********                                                         056031
     C***********          Z-ADDCNUM      KACNUM                          056031
     C***********          MOVELWSMCY     KACCCY                          056031
     C***********          Z-ADDACOD      KACCD                           056031
     C***********          Z-ADDACSQ      KACSQ                           056031
     C***********          MOVE BRCA      KBRCA                     S01117056031
     C***********          EXSR UOACCN                                    056031
     C************IN89     IFEQ '1'                                       056031
     C***********          MOVEL'ACCNT'   WDBFIL            -DATABASE     056031
     C***********          MOVE KACNUM    WA6                ERROR.       056031
     C***********          MOVE KACCD     WA4                             056031
     C***********          MOVE KACSQ     WA2                             056031
     C***********          MOVEAWA6       YA3,1                           056031
     C***********          MOVEAKACCCY    YA3,7                           056031
     C***********          MOVEAWA4       YA3,10                          056031
     C***********          MOVEAWA2       YA3,14                          056031
     C***********          MOVEAKBRCA     YA3,16                    S01117056031
     C***********          MOVEAYA3,1     WDBKEY                          056031
     C***********          MOVEL'21'      WDBASE                          056031
     C***********          EXSR UEABRT                                    056031
     C***********          END                                            056031
     C***********                                                         056031
     C***IGNORE*IF THE ACCOUNT TYPE IS NOT 'R'                            056031
     C***********                                                         056031
     C***********ATYP      CABNE'R'       GI100                           056031
     C***********                                                         056031
     C***ACCESS*MEMOS RECORD                                              056031
     C***********                                                         056031
     C***********          EXSR UWMMCN                                    056031
     C***********                                                         056031
     C************IN89     IFEQ '1'                                       056031
     C***********          MOVEL'MEMOS'   WDBFIL            -DATABASE     056031
     C***********          MOVELRRNM      WDBKEY             ERROR.       056031
     C***********          MOVEL'22'      WDBASE                          056031
     C***********          EXSR UEABRT                                    056031
     C***********          END                                            056031
     C***********                                                         056031
     C***UPDATE*BALANCES & TIME OF CHANGE                                 056031
     C***********                                                         056031
     C***********          MOVE MMLDBL    LDBLWK 150                      056031
     C***********          ADD  WSMAM     MMLDBL                          056031
     C***********                                                         056031
     C***********WSLDT     IFLT DNWD                                      S01194
     C***********WSLDT     IFLT BJDNWD                              S01194056031
     C***********          ADD  WSMAM     MMCLBL                          056031
     C***********          END                                            056031
     C***********                                                         056031
     C***UPDATE*MEMOS RECORD                                              056031
     C***********                                                         056031
     C***********          UPDATMEMOSMDF               89                 056031
     C***********                                                         056031
     C***IF*DEALING MOD. NOT PRESENT,UPDATE AME HERE                      056031
     C***********                                                         056031
     C************IN30     IFEQ '0'                                       056031
     C***********          MOVE NOSLOC    ZLOC                      S01195056031
     C***********          Z-ADDWSLDT     VUDT                            056031
     C***********          Z-ADDWSMAM     MVAM                            056031
     C***********          EXSR AMOVTS                                    056031
     C***********          END                                            056031
     C***********                                                         056031
     C************IN89     IFEQ '1'                                       056031
     C***********          MOVEL'MEMOS'   WDBFIL            -DATABASE     056031
     C***********          MOVELRRNM      WDBKEY             ERROR.       056031
     C***********          MOVEL'23'      WDBASE                          056031
     C***********          EXSR UEABRT                                    056031
     C***********          END                                            056031
     C***********                                                         056031
     C****************     ***                                            056031
     C***********GI100     TAG                                            056031
     C****************     ***                                            056031
     C***********                                                         056031
     C***IF*RECEIVER'S CORRESPONDENT DOES NOT CONTAIN A RETAIL ACCOUNT,   056031
     C***SKIP*THE NEXT FEW LINES                                          056031
     C***********                                                         056031
     C***********WRCRT     CABNE'R'       GI200                           056031
     C***********                                                         056031
     C***ACCESS*RETAIL ACCOUNTS FILE                                      056031
     C***********                                                         056031
     C***********          MOVELWRCCO     ACNO                            056031
     C***********          EXSR UMAACN                                    056031
     C************IN89     IFEQ '1'                                       056031
     C***********          MOVEL'ACNUMA'  WDBFIL            -DATABASE     056031
     C***********          MOVELACNO      WDBKEY             ERROR.       056031
     C***********          MOVEL'24'      WDBASE                          056031
     C***********          EXSR UEABRT                                    056031
     C***********          END                                            056031
     C***********                                                         056031
     C***ACCESS*MEMOS RECORD                                              056031
     C***********                                                         056031
     C***********          EXSR UWMMCN                                    056031
     C***********                                                         056031
     C************IN89     IFEQ '1'                                       056031
     C***********          MOVEL'MEMOS'   WDBFIL            -DATABASE     056031
     C***********          MOVELRRNM      WDBKEY             ERROR.       056031
     C***********          MOVEL'25'      WDBASE                          056031
     C***********          EXSR UEABRT                                    056031
     C***********          END                                            056031
     C***********                                                         056031
     C***UPDATE*BALANCES & TIME OF CHANGE                                 056031
     C***********                                                         056031
     C***********          MOVE MMLDBL    LDBLWK                          056031
     C***********          ADD  WSMAM     MMLDBL                          056031
     C***********                                                         056031
     C***********WSLDT     IFLT DNWD                                      S01194
     C***********WSLDT     IFLT BJDNWD                              S01194056031
     C***********          ADD  WSMAM     MMCLBL                          056031
     C***********          END                                            056031
     C***********                                                         056031
     C***UPDATE*MEMOS RECORD                                              056031
     C***********                                                         056031
     C***********          UPDATMEMOSMDF               89                 056031
     C***********                                                         056031
     C**WRITE*TO*ACCOUNT MOVEMENTS FILE,IF ACCOUNT IS NOT A NOSTRO        056031
     C**OR*ACCOUNT IS A NOSTRO AND ACCOUNT MOVEMENT WRITE IS NOT DONS01117056031
     C**IN*DEALING UPDATES (GGDLUP)                                 S01117056031
     C***********                                                         056031
     C***********          MOVE CNUM      KACNUM                          056031
     C***********          MOVE CCY       KACCCY                          056031
     C***********          MOVE ACOD      KACCD                           056031
     C***********          MOVE ACSQ      KACSQ                           056031
     C***********          MOVE BRCA      KBRCA                     S01117056031
     C***********KACKEY    CHAINFPRTNF               67                   S01194
     C**N67******RECI      COMP 'D'                  6767                 S01194
     C***********                                                   S01194056031
     C***********          CALL 'AONOSTR0'                          S01194056031
     C***********          PARM *BLANKS   @RTCD   7                 S01194056031
     C***********          PARM '*KEY   ' @OPTN   7                 S01194056031
     C***********          PARM KACNMA    @CUST   6                 S01194056031
     C***********          PARM KACCCY    @CYCD   3                 S01194056031
     C***********          PARM KACCDA    @ACCN   4                 S01194056031
     C***********          PARM KACSQA    @ACSN   2                 S01194056031
     C***********          PARM *BLANKS   @NONB   2                 S01194056031
     C***********          PARM KBRCA     @BRCD   3                 S01194056031
     C***********          PARM *BLANKS   @CSSN  10                 S01194056031
     C***********          PARM *BLANKS   @PNOI   1                 S01194056031
     C***********SDNOST    PARM SDNOST    DSFDY                     S01194056031
     C***********                                                   S01194056031
     C***********@RTCD     CASEQ*BLANK    MVNOS2     6767           S01194056031
     C***********          END                                      S01194056031
     C***********                                                   S01194056031
     C************IN67     IFEQ '1'                        B003           056031
     C************IN67     OREQ '0'                                 S01117056031
     C************IN30     ANDEQ'0'                                 S01117056031
     C***67******          MOVE BJSLCD    ZLOC                      S01195056031
     C**N67******          MOVE NOSLOC    ZLOC                      S01195056031
     C***********          Z-ADDWSLDT     VUDT                            056031
     C***********          Z-ADDWSMAM     MVAM                            056031
     C***********          EXSR AMOVTS                                    056031
     C***********          END                                            056031
     C***********                                                         056031
     C************IN89     IFEQ '1'                                       056031
     C***********          MOVEL'MEMOS'   WDBFIL            -DATABASE     056031
     C***********          MOVELRRNM      WDBKEY             ERROR.       056031
     C***********          MOVEL'26'      WDBASE                          056031
     C***********          EXSR UEABRT                                    056031
     C***********          END                                            056031
     C***********                                                         056031
     C****************     ***                                            056031
     C***********GI200     TAG                                            056031
     C****************     ***                                            056031
     C***********                                                         056031
     C***IF*RECEIVER'S CORRESPONDENT IS NOT BLANK OR SENDER DOES NOT      056031
     C***CONTAIN*A NOSTRO,SKIP THE NEXT FEW LINES                         056031
     C***********                                                         056031
     C***********WRCRT     IFNE *BLANKS                                   056031
     C***********WSNTP     ORNE 'F'                                       056031
     C***********          GOTO GI300                                     056031
     C***********          END                                            056031
     C***********                                                         056031
     C***ACCESS*NOSTRO*RECORD*FROM*TABLE*FILE********                     S01194
     C***********                                                         056031
     C***********          MOVEL*BLANKS   ZTABKY                          S01194
     C***********          MOVEL'70'      ZTABKY                          S01194
     C***********          MOVELWSND1     WA5                             056031
     C***********          MOVE WA5       ZTABKY                          S01194
     C***********          EXSR UATBCN                                    S01194
     C************IN89     IFEQ '1'                                       S01194
     C***********          MOVEL'TABFP'   WDBFIL            -DATABASE     S01194
     C***********          MOVELZTABKY    WDBKEY             ERROR.       S01194
     C***********          MOVEL'27'      WDBASE                          S01194
     C***********          EXSR UEABRT                                    S01194
     C***********          END                                            S01194
     C***********                                                   S01194056031
     C***********          MOVELWA5       WA3     3                 S01194056031
     C***********          MOVE WA5       WA2     2                 S01194056031
     C***********          CALL 'AONOSTR0'                          S01194056031
     C***********          PARM '*DBERR ' @RTCD   7                 S01194056031
     C***********          PARM '*KEY   ' @OPTN   7                 S01194056031
     C***********          PARM *BLANKS   @CUST   6                 S01194056031
     C***********          PARM WA3       @CYCD   3                 S01194056031
     C***********          PARM *BLANKS   @ACCN   4                 S01194056031
     C***********          PARM *BLANKS   @ACSN   2                 S01194056031
     C***********          PARM WA2       @NONB   2                 S01194056031
     C***********          PARM *BLANKS   @BRCD   3                 S01194056031
     C***********          PARM *BLANKS   @CSSN  10                 S01194056031
     C***********          PARM *BLANKS   @PNOI   1                 S01194056031
     C***********SDNOST    PARM SDNOST    DSFDY                     S01194056031
     C***********          EXSR MVNOS1                              S01194056031
     C***********                                                         056031
     C***ACCESS*ACCOUNT FILE FOR THIS NOSTRO                              056031
     C***********                                                         056031
     C***********          Z-ADDCNUM      KACNUM                          056031
     C***********          MOVELWSMCY     KACCCY                          056031
     C***********          Z-ADDACOD      KACCD                           056031
     C***********          Z-ADDACSQ      KACSQ                           056031
     C***********          MOVE BRCA      KBRCA                     S01117056031
     C***********          EXSR UOACCN                                    056031
     C************IN89     IFEQ '1'                                       056031
     C***********          MOVEL'ACCNT'   WDBFIL            -DATABASE     056031
     C***********          MOVE KACNUM    WA6                ERROR.       056031
     C***********          MOVE KACCD     WA4                             056031
     C***********          MOVE KACSQ     WA2                             056031
     C***********          MOVEAWA6       YA3,1                           056031
     C***********          MOVEAKACCCY    YA3,7                           056031
     C***********          MOVEAWA4       YA3,10                          056031
     C***********          MOVEAWA2       YA3,14                          056031
     C***********          MOVEAKBRCA     YA3,16                    S01117056031
     C***********          MOVEAYA3,1     WDBKEY                          056031
     C***********          MOVEL'28'      WDBASE                          056031
     C***********          EXSR UEABRT                                    056031
     C***********          END                                            056031
     C***********                                                         056031
     C***IGNORE*IF THE ACCOUNT TYPE IS NOT 'R'                            056031
     C***********                                                         056031
     C***********ATYP      CABNE'R'       GI300                           056031
     C***********                                                         056031
     C***ACCESS*MEMOS RECORD                                              056031
     C***********                                                         056031
     C***********          EXSR UWMMCN                                    056031
     C***********                                                         056031
     C************IN89     IFEQ '1'                                       056031
     C***********          MOVEL'MEMOS'   WDBFIL            -DATABASE     056031
     C***********          MOVELRRNM      WDBKEY             ERROR.       056031
     C***********          MOVEL'29'      WDBASE                          056031
     C***********          EXSR UEABRT                                    056031
     C***********          END                                            056031
     C***********                                                         056031
     C***UPDATE*BALANCES & TIME OF CHANGE                                 056031
     C***********                                                         056031
     C***********          MOVE MMLDBL    LDBLWK                          056031
     C***********          ADD  WSMAM     MMLDBL                          056031
     C***********                                                         056031
     C***********WSLDT     IFLT DNWD                                      S01194
     C***********WSLDT     IFLT BJDNWD                              S01194056031
     C***********          ADD  WSMAM     MMCLBL                          056031
     C***********          END                                            056031
     C***********                                                         056031
     C***UPDATE*MEMOS RECORD                                              056031
     C***********                                                         056031
     C***********          UPDATMEMOSMDF               89                 056031
     C***********                                                         056031
     C***IF*DEALING MOD. NOT PRESENT,UPDATE AME HERE                      056031
     C***********                                                         056031
     C************IN30     IFEQ '0'                                       056031
     C***********          MOVE NOSLOC    ZLOC                      S01195056031
     C***********          Z-ADDWSLDT     VUDT                            056031
     C***********          Z-ADDWSMAM     MVAM                            056031
     C***********          EXSR AMOVTS                                    056031
     C***********          END                                            056031
     C***********                                                         056031
     C************IN89     IFEQ '1'                                       056031
     C***********          MOVEL'MEMOS'   WDBFIL            -DATABASE     056031
     C***********          MOVELRRNM      WDBKEY             ERROR.       056031
     C***********          MOVEL'30'      WDBASE                          056031
     C***********          EXSR UEABRT                                    056031
     C***********          END                                            056031
     C***********                                                         056031
     C****************     ***                                            056031
     C***********GI300     TAG                                            056031
     C****************     ***                                            056031
     C***********                                                         056031
     C***IF*RECEIVER'S CORRESPONDENT IS NOT BLANK OR SENDER DOES NOT      056031
     C***CONTAIN*EITHER A RETAIL OR A FULL A/C,SKIP THE NEXT FEW LINES    056031
     C***********                                                         056031
     C***********WRCRT     CABNE*BLANKS   GI400                           056031
     C***********                                                         056031
     C***********WSNTP     IFNE 'R'                                       056031
     C***********WSNTP     ANDNE'G'                                       056031
     C***********          GOTO GI400                                     056031
     C***********          END                                            056031
     C***********                                                         056031
     C***ACCESS*RETAIL ACCOUNTS FILE OR ACCOUNTS FILE AS APPROPRIATE      056031
     C***********                                                         056031
     C***********WSNTP     IFEQ 'R'                         -RETAIL A/C   056031
     C***********          MOVELWSND1     ACNO                            056031
     C***********          EXSR UMAACN                                    056031
     C************IN89     IFEQ '1'                                       056031
     C***********          MOVEL'ACNUMA'  WDBFIL            -DATABASE     056031
     C***********          MOVELACNO      WDBKEY             ERROR.       056031
     C***********          MOVEL'31'      WDBASE                          056031
     C***********          EXSR UEABRT                                    056031
     C***********          END                                            056031
     C***********          ELSE                                           056031
     C***********          MOVEAWSND1     YA3,1             -FULL A/C     056031
     C***********          MOVEAYA3,1     WA6                             056031
     C***********          MOVEAYA3,10    WA4                             056031
     C***********          MOVEAYA3,14    WA2                             056031
     C***********          MOVE WA6       KACNUM                          056031
     C***********          MOVEAYA3,7     KACCCY                          056031
     C***********          MOVE WA4       KACCD                           056031
     C***********          MOVE WA2       KACSQ                           056031
     C***********          MOVEAYA3,16    KBRCA                     S01117056031
     C***********          EXSR UOACCN                                    056031
     C************IN89     IFEQ '1'                                       056031
     C***********          MOVEL'ACCNT'   WDBFIL            -DATABASE     056031
     C***********          MOVE KACNUM    WA6                ERROR.       056031
     C***********          MOVE KACCD     WA4                             056031
     C***********          MOVE KACSQ     WA2                             056031
     C***********          MOVEAWA6       YA3,1                           056031
     C***********          MOVEAKACCCY    YA3,7                           056031
     C***********          MOVEAWA4       YA3,10                          056031
     C***********          MOVEAWA2       YA3,14                          056031
     C***********          MOVEAKBRCA     YA3,16                    S01117056031
     C***********          MOVEAYA3,1     WDBKEY                          056031
     C***********          MOVEL'32'      WDBASE                          056031
     C***********          EXSR UEABRT                                    056031
     C***********          END                                            056031
     C***********          END                                            056031
     C***********                                                         056031
     C***IGNORE*IF THE ACCOUNT TYPE IS NOT 'R'                            056031
     C***********                                                         056031
     C***********ATYP      CABNE'R'       GI400                           056031
     C***********                                                         056031
     C***ACCESS*MEMOS RECORD                                              056031
     C***********                                                         056031
     C***********          EXSR UWMMCN                                    056031
     C***********                                                         056031
     C************IN89     IFEQ '1'                                       056031
     C***********          MOVEL'MEMOS'   WDBFIL            -DATABASE     056031
     C***********          MOVELRRNM      WDBKEY             ERROR.       056031
     C***********          MOVEL'33'      WDBASE                          056031
     C***********          EXSR UEABRT                                    056031
     C***********          END                                            056031
     C***********                                                         056031
     C***UPDATE*BALANCES & TIME OF CHANGE                                 056031
     C***********                                                         056031
     C***********          MOVE MMLDBL    LDBLWK                          056031
     C***********          ADD  WSMAM     MMLDBL                          056031
     C***********                                                         056031
     C***********WSLDT     IFLT DNWD                                      S01194
     C***********WSLDT     IFLT BJDNWD                              S01194056031
     C***********          ADD  WSMAM     MMCLBL                          056031
     C***********          END                                            056031
     C***********                                                         056031
     C***********                                                         056031
     C***UPDATE*MEMOS RECORD                                              056031
     C***********                                                         056031
     C***********          UPDATMEMOSMDF               89                 056031
     C***********                                                         056031
     C**WRITE*TO*ACCOUNT MOVEMENTS FILE,IF ACCOUNT IS NOT A NOSTRO        056031
     C**OR*IF*NOSTRO AND NOT DONE IN GGDLUP - DEALING UPDATES       S01195056031
     C***********                                                         056031
     C***********WSNTP     IFEQ 'R'                                       056031
     C***********          MOVE CNUM      KACNUM                          056031
     C***********          MOVE CCY       KACCCY                          056031
     C***********          MOVE ACOD      KACCD                           056031
     C***********          MOVE ACSQ      KACSQ                           056031
     C***********          MOVE BRCA      KBRCA                     S01117056031
     C***********          END                                            056031
     C***********KACKEY    CHAINFPRTNF               67                   S01194
     C**N67******RECI      COMP 'D'                  6767                 S01194
     C***********                                                   S01194056031
     C***********          CALL 'AONOSTR0'                          S01194056031
     C***********          PARM *BLANKS   @RTCD   7                 S01194056031
     C***********          PARM '*KEY   ' @OPTN   7                 S01194056031
     C***********          PARM KACNMA    @CUST   6                 S01194056031
     C***********          PARM KACCCY    @CYCD   3                 S01194056031
     C***********          PARM KACCDA    @ACCN   4                 S01194056031
     C***********          PARM KACSQA    @ACSN   2                 S01194056031
     C***********          PARM *BLANKS   @NONB   2                 S01194056031
     C***********          PARM KBRCA     @BRCD   3                 S01194056031
     C***********          PARM *BLANKS   @CSSN  10                 S01194056031
     C***********          PARM *BLANKS   @PNOI   1                 S01194056031
     C***********SDNOST    PARM SDNOST    DSFDY                     S01194056031
     C***********                                                   S01194056031
     C***********@RTCD     CASEQ*BLANK    MVNOS2     6767           S01194056031
     C***********          END                                      S01194056031
     C***********                                                   S01194056031
     C************IN67     IFEQ '1'                                       056031
     C************IN67     OREQ '0'                                 S01117056031
     C************IN30     ANDEQ'0'                                 S01117056031
     C***67******          MOVE BJSLCD    ZLOC                      S01195056031
     C**N67******          MOVE NOSLOC    ZLOC                      S01195056031
     C***********          Z-ADDWSLDT     VUDT                            056031
     C***********          Z-ADDWSMAM     MVAM                            056031
     C***********          EXSR AMOVTS                                    056031
     C***********          END                                            056031
     C***********                                                         056031
     C************IN89     IFEQ '1'                                       056031
     C***********          MOVEL'MEMOS'   WDBFIL            -DATABASE     056031
     C***********          MOVELRRNM      WDBKEY             ERROR.       056031
     C***********          MOVEL'34'      WDBASE                          056031
     C***********          EXSR UEABRT                                    056031
     C***********          END                                            056031
     C***********                                                         056031
     C****************     ***                                            056031
     C***********GI400     TAG                                            056031
     C****************     ***                                            056031
     C***********                                                         056031
     C***IF*ACCOUNT WITH BANK DOES NOT CONTAIN A NOSTRO,SKIP THE NEXT     056031
     C***FEW*LINES                                                        056031
     C***********                                                         056031
     C***********WACBT     CABNE'N'       GI500                           056031
     C***********                                                         056031
     C***ACCESS*NOSTRO RECORD FROM TABLE FILE                             056031
     C***********                                                         056031
     C************IN21     IFEQ '0'                                       056031
     C***********          MOVEL*BLANKS   ZTABKY                          S01194
     C***********          MOVEL'70'      ZTABKY                          S01194
     C***********          MOVELWPCCY     WA5                             S01194
     C***********          MOVELWACBK     WA2                             S01194
     C***********          MOVE WA2       WA5                             S01194
     C***********          MOVE WA5       ZTABKY                          S01194
     C***********          EXSR UATBCN                                    S01194
     C************IN89     IFEQ '1'                                       S01194
     C***********          MOVEL'TABFP'   WDBFIL            -DATABASE     S01194
     C***********          MOVELZTABKY    WDBKEY             ERROR.       S01194
     C***********          MOVEL'35'      WDBASE                          S01194
     C***********          EXSR UEABRT                                    S01194
     C***********          END                                            S01194
     C***********                                                   S01194056031
     C***********          CALL 'AONOSTR0'                          S01194056031
     C***********          PARM '*DBERR ' @RTCD   7                 S01194056031
     C***********          PARM '*KEY   ' @OPTN   7                 S01194056031
     C***********          PARM *BLANKS   @CUST   6                 S01194056031
     C***********          PARM WPCCY     @CYCD   3                 S01194056031
     C***********          PARM *BLANKS   @ACCN   4                 S01194056031
     C***********          PARM *BLANKS   @ACSN   2                 S01194056031
     C***********          PARM WACBK     @NONB   2                 S01194056031
     C***********          PARM *BLANKS   @BRCD   3                 S01194056031
     C***********          PARM *BLANKS   @CSSN  10                 S01194056031
     C***********          PARM *BLANKS   @PNOI   1                 S01194056031
     C***********SDNOST    PARM SDNOST    DSFDY                     S01194056031
     C***********          EXSR MVNOS1                              S01194056031
     C***********                                                   S01194056031
     C***ACCESS*ACCOUNT FILE FOR THIS NOSTRO                              056031
     C***********                                                         056031
     C***********          Z-ADDCNUM      KACNUM                          056031
     C***********          MOVELWPCCY     KACCCY                          056031
     C***********          Z-ADDACOD      KACCD                           056031
     C***********          Z-ADDACSQ      KACSQ                           056031
     C***********          MOVE BRCA      KBRCA                     S01117056031
     C***********          EXSR UOACCN                                    056031
     C************IN89     IFEQ '1'                                       056031
     C***********          MOVEL'ACCNT'   WDBFIL            -DATABASE     056031
     C***********          MOVE KACNUM    WA6                ERROR.       056031
     C***********          MOVE KACCD     WA4                             056031
     C***********          MOVE KACSQ     WA2                             056031
     C***********          MOVEAWA6       YA3,1                           056031
     C***********          MOVEAKACCCY    YA3,7                           056031
     C***********          MOVEAWA4       YA3,10                          056031
     C***********          MOVEAWA2       YA3,14                          056031
     C***********          MOVEAKBRCA     YA3,16                    S01117056031
     C***********          MOVEAYA3,1     WDBKEY                          056031
     C***********          MOVEL'36'      WDBASE                          056031
     C***********          EXSR UEABRT                                    056031
     C***********          END                                            056031
     C***********                                                         056031
     C***IGNORE*IF THE ACCOUNT TYPE IS NOT 'R'                            056031
     C***********                                                         056031
     C***********ATYP      CABNE'R'       GI500                           056031
     C***********                                                         056031
     C***ACCESS*MEMOS RECORD                                              056031
     C***********                                                         056031
     C***********          EXSR UWMMCN                                    056031
     C***********                                                         056031
     C************IN89     IFEQ '1'                                       056031
     C***********          MOVEL'MEMOS'   WDBFIL            -DATABASE     056031
     C***********          MOVELRRNM      WDBKEY             ERROR.       056031
     C***********          MOVEL'37'      WDBASE                          056031
     C***********          EXSR UEABRT                                    056031
     C***********          END                                            056031
     C***********                                                         056031
     C***UPDATE*BALANCES & TIME OF CHANGE                                 056031
     C***********                                                         056031
     C***********          SUB  WPYAM     MMLDBL                          056031
     C***********                                                         056031
     C***********WPYDT     IFLT DNWD                                      S01194
     C***********WPYDT     IFLT BJDNWD                              S01194056031
     C***********          SUB  WPYAM     MMCLBL                          056031
     C***********          END                                            056031
     C***********                                                         056031
     C***********                                                         056031
     C***UPDATE*MEMOS RECORD                                              056031
     C***********                                                         056031
     C***********          UPDATMEMOSMDF               89                 056031
     C***********                                                   E32878056031
     C**WRITE*TO*ACCOUNT MOVEMENTS FILE,IF ACCOUNT IS NOT A NOSTRO  E32878056031
     C**OR*ACCOUNT IS A NOSTRO AND ACCOUNT MOVEMENT WRITE IS NOT DONE32878056031
     C**IN*DEALING UPDATES (GGDLUP)                                 E32878056031
     C***********                                                   E32878056031
     C***********          MOVE CNUM      KACNUM                    E32878056031
     C***********          MOVE CCY       KACCCY                    E32878056031
     C***********          MOVE ACOD      KACCD                     E32878056031
     C***********          MOVE ACSQ      KACSQ                     E32878056031
     C***********          MOVE BRCA      KBRCA                     E32878056031
     C***********                                                   E32878056031
     C***********          CALL 'AONOSTR0'                          E32878056031
     C***********          PARM *BLANKS   @RTCD   7                 E32878056031
     C***********          PARM '*KEY   ' @OPTN   7                 E32878056031
     C***********          PARM KACNMA    @CUST   6                 E32878056031
     C***********          PARM KACCCY    @CYCD   3                 E32878056031
     C***********          PARM KACCDA    @ACCN   4                 E32878056031
     C***********          PARM KACSQA    @ACSN   2                 E32878056031
     C***********          PARM *BLANKS   @NONB   2                 E32878056031
     C***********          PARM KBRCA     @BRCD   3                 E32878056031
     C***********          PARM *BLANKS   @CSSN  10                 E32878056031
     C***********          PARM *BLANKS   @PNOI   1                 E32878056031
     C***********SDNOST    PARM SDNOST    DSFDY                     E32878056031
     C***********                                                   E32878056031
     C***********@RTCD     CASEQ*BLANK    MVNOS2     6767           E32878056031
     C***********          END                                      E32878056031
     C***********                                                   E32878056031
     C************IN67     IFEQ '1'                                 E32878056031
     C************IN67     OREQ '0'                                 E32878056031
     C************IN30     ANDEQ'0'                                 E32878056031
     C***67******          MOVE BJSLCD    ZLOC                      E32878056031
     C**N67******          MOVE NOSLOC    ZLOC                      E32878056031
     C***********          Z-ADDWPYDT     VUDT                      E32878056031
     C***********          Z-ADDWPYAM     MVAM                      E32878056031
     C***********          EXSR AMOVTS                              E32878056031
     C***********          END                                      E32878056031
     C***********                                                         056031
     C************IN89     IFEQ '1'                                       056031
     C***********          MOVEL'MEMOS'   WDBFIL            -DATABASE     056031
     C***********          MOVELRRNM      WDBKEY             ERROR.       056031
     C***********          MOVEL'38'      WDBASE                          056031
     C***********          EXSR UEABRT                                    056031
     C***********          END                                            056031
     C***********                                                   S01195056031
     C************IN30     IFEQ '0'                                 S01195056031
     C***********          MOVE NOSLOC    ZLOC                      S01195056031
     C***********          Z-ADDWSLDT     VUDT                      S01195056031
     C***********          Z-ADDWSMAM     MVAM                      S01195056031
     C***********          EXSR AMOVTS                              S01195056031
     C***********          END                                      S01195056031
     C***********          END                                            056031
     C***********                                                         056031
     C****************     ***                                            056031
     C***********GI500     TAG                                            056031
     C****************     ***                                            056031
     C***********                                                         056031
     C***IF*ACCOUNT WITH BANK DOES NOT CONTAIN EITHER A RETAIL OR A       056031
     C***PARTIAL*A/C,SKIP THE NEXT FEW LINES                              056031
     C***********                                                         056031
     C***********WACBT     IFNE 'R'                                       056031
     C***********WACBT     ANDNE'P'                                       056031
     C***********          GOTO GI600                                     056031
     C***********          END                                            056031
     C***********                                                         056031
     C***ACCESS*RETAIL ACCOUNTS FILE OR ACCOUNTS FILE AS APPROPRIATE      056031
     C***********                                                         056031
     C************IN21     IFEQ '0'                                       056031
     C***********WACBT     IFEQ 'R'                         -RETAIL A/C   056031
     C***********          MOVELWACBK     ACNO                            056031
     C***********          EXSR UMAACN                                    056031
     C************IN89     IFEQ '1'                                       056031
     C***********          MOVEL'ACNUMA'  WDBFIL            -DATABASE     056031
     C***********          MOVELACNO      WDBKEY             ERROR.       056031
     C***********          MOVEL'39'      WDBASE                          056031
     C***********          EXSR UEABRT                                    056031
     C***********          END                                            056031
     C***********          ELSE                                           056031
     C***********          MOVEAWACBK     YA3,1             -PARTIAL      056031
     C***********          MOVEAWACBB     YA3,16                    S01117056031
     C***********          MOVEAYA3,1     WA6                A/C.         056031
     C***********          MOVEAYA3,7     WA4                             056031
     C***********          MOVEAYA3,11    WA2                             056031
     C***********          MOVE WA6       KACNUM                          056031
     C***********          MOVELWPCCY     KACCCY                          056031
     C***********          MOVE WA4       KACCD                           056031
     C***********          MOVE WA2       KACSQ                           056031
     C***********          MOVEAYA3,16    KBRCA                     S01117056031
     C***********          EXSR UOACCN                                    056031
     C************IN89     IFEQ '1'                                       056031
     C***********          MOVEL'ACCNT'   WDBFIL            -DATABASE     056031
     C***********          MOVE KACNUM    WA6                ERROR.       056031
     C***********          MOVE KACCD     WA4                             056031
     C***********          MOVE KACSQ     WA2                             056031
     C***********          MOVEAWA6       YA3,1                           056031
     C***********          MOVEAKACCCY    YA3,7                           056031
     C***********          MOVEAWA4       YA3,10                          056031
     C***********          MOVEAWA2       YA3,14                          056031
     C***********          MOVEAKBRCA     YA3,16                    S01117056031
     C***********          MOVEAYA3,1     WDBKEY                          056031
     C***********          MOVEL'40'      WDBASE                          056031
     C***********          EXSR UEABRT                                    056031
     C***********          END                                            056031
     C***********          END                                            056031
     C***********                                                         056031
     C***IGNORE*IF THE ACCOUNT TYPE IS NOT 'R'                            056031
     C***********                                                         056031
     C***********ATYP      CABNE'R'       GI600                           056031
     C***********                                                   S01194056031
     C**ACCESS*NOSTRO DETAILS                                       S01194056031
     C***********                                                   S01194056031
     C***********          CALL 'AONOSTR0'                          S01194056031
     C***********          PARM *BLANKS   @RTCD   7                 S01194056031
     C***********          PARM '*KEY   ' @OPTN   7                 S01194056031
     C***********          PARM KACNMA    @CUST   6                 S01194056031
     C***********          PARM KACCCY    @CYCD   3                 S01194056031
     C***********          PARM KACCDA    @ACCN   4                 S01194056031
     C***********          PARM KACSQA    @ACSN   2                 S01194056031
     C***********          PARM *BLANKS   @NONB   2                 S01194056031
     C***********          PARM KBRCA     @BRCD   3                 S01194056031
     C***********          PARM *BLANKS   @CSSN  10                 S01194056031
     C***********          PARM *BLANKS   @PNOI   1                 S01194056031
     C***********SDNOST    PARM SDNOST    DSFDY                     S01194056031
     C***********                                                   S01194056031
     C***********@RTCD     CASEQ*BLANK    MVNOS2     6767           S01194056031
     C***********          END                                      S01194056031
     C***********                                                         056031
     C***ACCESS*MEMOS RECORD                                              056031
     C***********                                                         056031
     C***********          EXSR UWMMCN                                    056031
     C***********                                                         056031
     C************IN89     IFEQ '1'                                       056031
     C***********          MOVEL'MEMOS'   WDBFIL            -DATABASE     056031
     C***********          MOVELRRNM      WDBKEY             ERROR.       056031
     C***********          MOVEL'41'      WDBASE                          056031
     C***********          EXSR UEABRT                                    056031
     C***********          END                                            056031
     C***********                                                         056031
     C***UPDATE*BALANCES & TIME OF CHANGE                                 056031
     C***********                                                         056031
     C***********          SUB  WPYAM     MMLDBL                          056031
     C***********                                                         056031
     C***********WPYDT     IFLT DNWD                                      S01194
     C***********WPYDT     IFLT BJDNWD                              S01194056031
     C***********          SUB  WPYAM     MMCLBL                          056031
     C***********          END                                            056031
     C***********                                                         056031
     C***UPDATE*MEMOS RECORD                                              056031
     C***********                                                         056031
     C***********          UPDATMEMOSMDF               89                 056031
     C***********                                                   E32878056031
     C**WRITE*TO*ACCOUNT MOVEMENTS FILE,IF ACCOUNT IS NOT A NOSTRO  E32878056031
     C**OR*ACCOUNT IS A NOSTRO AND ACCOUNT MOVEMENT WRITE IS NOT DONE32878056031
     C**IN*DEALING UPDATES (GGDLUP)                                 E32878056031
     C***********                                                   E32878056031
     C***********          MOVE CNUM      KACNUM                    E32878056031
     C***********          MOVE CCY       KACCCY                    E32878056031
     C***********          MOVE ACOD      KACCD                     E32878056031
     C***********          MOVE ACSQ      KACSQ                     E32878056031
     C***********          MOVE BRCA      KBRCA                     E32878056031
     C***********                                                   E32878056031
     C***********          CALL 'AONOSTR0'                          E32878056031
     C***********          PARM *BLANKS   @RTCD   7                 E32878056031
     C***********          PARM '*KEY   ' @OPTN   7                 E32878056031
     C***********          PARM KACNMA    @CUST   6                 E32878056031
     C***********          PARM KACCCY    @CYCD   3                 E32878056031
     C***********          PARM KACCDA    @ACCN   4                 E32878056031
     C***********          PARM KACSQA    @ACSN   2                 E32878056031
     C***********          PARM *BLANKS   @NONB   2                 E32878056031
     C***********          PARM KBRCA     @BRCD   3                 E32878056031
     C***********          PARM *BLANKS   @CSSN  10                 E32878056031
     C***********          PARM *BLANKS   @PNOI   1                 E32878056031
     C***********SDNOST    PARM SDNOST    DSFDY                     E32878056031
     C***********                                                   E32878056031
     C***********@RTCD     CASEQ*BLANK    MVNOS2     6767           E32878056031
     C***********          END                                      E32878056031
     C***********                                                   E32878056031
     C************IN67     IFEQ '1'                                 E32878056031
     C************IN67     OREQ '0'                                 E32878056031
     C************IN30     ANDEQ'0'                                 E32878056031
     C***67******          MOVE BJSLCD    ZLOC                      E32878056031
     C**N67******          MOVE NOSLOC    ZLOC                      E32878056031
     C***********          Z-ADDWPYDT     VUDT                      E32878056031
     C***********          Z-ADDWPYAM     MVAM                      E32878056031
     C***********          EXSR AMOVTS                              E32878056031
     C***********          END                                      E32878056031
     C***********                                                         056031
     C************IN89     IFEQ '1'                                       056031
     C***********          MOVEL'MEMOS'   WDBFIL            -DATABASE     056031
     C***********          MOVELRRNM      WDBKEY             ERROR.       056031
     C***********          MOVEL'42'      WDBASE                          056031
     C***********          EXSR UEABRT                                    056031
     C***********          END                                            056031
     C***********                                                   S01195056031
     C************IN30     IFEQ '0'                                 S01195056031
     C***********          MOVE NOSLOC    ZLOC                      S01195056031
     C***********          Z-ADDWSLDT     VUDT                      S01195056031
     C***********          Z-ADDWSMAM     MVAM                      S01195056031
     C***********          EXSR AMOVTS                              S01195056031
     C***********          END                                      S01195056031
     C***********          END                                            056031
     C***********                                                         056031
     C****************     ***                                            056031
     C***********GI600     TAG                                            056031
     C****************     ***                                            056031
     C***********                                                         056031
     C***IF*ACCOUNT WITH BANK IS NOT BLANK OR BENEFICIARY CUSTOMER DOES   056031
     C***NOT*CONTAIN EITHER A RETAIL OR A PARTIAL ACCOUNT,SKIP THE NEXT   056031
     C***FEW*LINES.                                                       056031
     C***********                                                         056031
     C***********WACBT     CABNE*BLANKS   GIEND                           056031
     C***********                                                         056031
     C***********WBNCT     IFNE 'R'                                       056031
     C***********WBNCT     ANDNE'P'                                       056031
     C***********          GOTO GIEND                                     056031
     C***********          END                                            056031
     C***********                                                         056031
     C***ACCESS*RETAIL ACCOUNTS FILE OR ACCOUNTS FILE AS APPROPRIATE      056031
     C***********                                                         056031
     C***********WBNCT     IFEQ 'R'                         -RETAIL A/C   056031
     C***********          MOVELWBNC1     ACNO                            056031
     C***********          EXSR UMAACN                                    056031
     C************IN89     IFEQ '1'                                       056031
     C***********          MOVEL'ACNUMA'  WDBFIL            -DATABASE     056031
     C***********          MOVELACNO      WDBKEY             ERROR.       056031
     C***********          MOVEL'43'      WDBASE                          056031
     C***********          EXSR UEABRT                                    056031
     C***********          END                                            056031
     C***********          ELSE                                           056031
     C***********          MOVEAWBNC1     YA3,1             -PARTIAL      056031
     C***********          MOVEAYA3,1     WA6                A/C.         056031
     C***********          MOVEAYA3,7     WA4                             056031
     C***********          MOVEAYA3,11    WA2                             056031
     C***********          MOVE WA6       KACNUM                          056031
     C***********          MOVELWPCCY     KACCCY                          056031
     C***********          MOVE WA4       KACCD                           056031
     C***********          MOVE WA2       KACSQ                           056031
     C***********          MOVEAYA3,13    KBRCA                     S01117056031
     C***********          EXSR UOACCN                                    056031
     C************IN89     IFEQ '1'                                       056031
     C***********          MOVEL'ACCNT'   WDBFIL            -DATABASE     056031
     C***********          MOVE KACNUM    WA6                ERROR.       056031
     C***********          MOVE KACCD     WA4                             S01194
     C***********          MOVE KACCD     WA4     4                 S01194056031
     C***********          MOVE KACSQ     WA2                             056031
     C***********          MOVEAWA6       YA3,1                           056031
     C***********          MOVEAKACCCY    YA3,7                           056031
     C***********          MOVEAWA4       YA3,10                          056031
     C***********          MOVEAWA2       YA3,14                          056031
     C***********          MOVEAKBRCA     YA3,16                    S01117056031
     C***********          MOVEAYA3,1     WDBKEY                          056031
     C***********          MOVEL'44'      WDBASE                          056031
     C***********          EXSR UEABRT                                    056031
     C***********          END                                            056031
     C***********          END                                            056031
     C***********                                                         056031
     C***IGNORE*IF THE ACCOUNT TYPE IS NOT 'R'                            056031
     C***********                                                         056031
     C***********ATYP      CABNE'R'       GIEND                           056031
     C***********                                                         056031
     C***ACCESS*MEMOS RECORD                                              056031
     C***********                                                         056031
     C***********          EXSR UWMMCN                                    056031
     C***********                                                         056031
     C************IN89     IFEQ '1'                                       056031
     C***********          MOVEL'MEMOS'   WDBFIL            -DATABASE     056031
     C***********          MOVELRRNM      WDBKEY             ERROR.       056031
     C***********          MOVEL'45'      WDBASE                          056031
     C***********          EXSR UEABRT                                    056031
     C***********          END                                            056031
     C***********                                                         056031
     C***UPDATE*BALANCES & TIME OF CHANGE                                 056031
     C***********                                                         056031
     C***********          MOVE MMLDBL    LDBLWK                          056031
     C***********          SUB  WPYAM     MMLDBL                          056031
     C***********                                                         056031
     C***********WPYDT     IFLT DNWD                                      S01194
     C***********WPYDT     IFLT BJDNWD                              S01194056031
     C***********          SUB  WPYAM     MMCLBL                          056031
     C***********          END                                            056031
     C***********                                                         056031
     C***UPDATE*MEMOS RECORD                                              056031
     C***********                                                         056031
     C***********          UPDATMEMOSMDF               89                 056031
     C***********                                                         056031
     C**WRITE*TO*ACCOUNT MOVEMENTS FILE,IF ACCOUNT IS NOT A NOSTRO        056031
     C**OR*IF*NOSTRO AND NOT DONE IN GGDLUP - DEALING UPDATES       S01117056031
     C***********                                                         056031
     C***********WBNCT     IFEQ 'R'                                       056031
     C***********          MOVE CNUM      KACNUM                          056031
     C***********          MOVE CCY       KACCCY                          056031
     C***********          MOVE ACOD      KACCD                           056031
     C***********          MOVE ACSQ      KACSQ                           056031
     C***********          MOVE BRCA      KBRCA                     S01117056031
     C***********          END                                            056031
     C***********KACKEY    CHAINFPRTNF               67                   S01194
     C**N67******RECI      COMP 'D'                  6767                 S01194
     C***********                                                   S01194056031
     C***********          CALL 'AONOSTR0'                          S01194056031
     C***********          PARM *BLANKS   @RTCD   7                 S01194056031
     C***********          PARM '*KEY   ' @OPTN   7                 S01194056031
     C***********          PARM KACNMA    @CUST   6                 S01194056031
     C***********          PARM KACCCY    @CYCD   3                 S01194056031
     C***********          PARM KACCDA    @ACCN   4                 S01194056031
     C***********          PARM KACSQA    @ACSN   2                 S01194056031
     C***********          PARM *BLANKS   @NONB   2                 S01194056031
     C***********          PARM KBRCA     @BRCD   3                 S01194056031
     C***********          PARM *BLANKS   @CSSN  10                 S01194056031
     C***********          PARM *BLANKS   @PNOI   1                 S01194056031
     C***********SDNOST    PARM SDNOST    DSFDY                     S01194056031
     C***********                                                   S01194056031
     C***********@RTCD     CASEQ*BLANK    MVNOS2     6767           S01194056031
     C***********          END                                      S01194056031
     C***********                                                   S01194056031
     C************IN67     IFEQ '1'                                       056031
     C************IN67     OREQ '0'                                 S01117056031
     C************IN30     ANDEQ'0'                                 S01117056031
     C***67******          MOVE BJSLCD    ZLOC                      S01195056031
     C**N67******          MOVE NOSLOC    ZLOC                      S01195056031
     C***********          Z-ADDWPYDT     VUDT                            056031
     C***********          Z-ADDWPYAM     MVAM                            056031
     C***********          EXSR AMOVTS                                    056031
     C***********          END                                            056031
     C***********                                                         056031
     C************IN89     IFEQ '1'                                       056031
     C***********          MOVEL'MEMOS'   WDBFIL            -DATABASE     056031
     C***********          MOVELRRNM      WDBKEY             ERROR.       056031
     C***********          MOVEL'46'      WDBASE                          056031
     C***********          EXSR UEABRT                                    056031
     C***********          END                                            056031
     C***********                                                         056031
     C****************     *****                                          056031
     C***********GIEND     ENDSR                                          056031
     C*          *****     *****
     C************************************************************
     C/EJECT
     C*****************************************************************
     C*
     C*  ADCHK SUBROUTINE - TO VALIDATE ADDRESS FIELDS
     C*
     C*****************************************************************
     C*
     C           ADCHK     BEGSR
     C*
     C*
     C* THERE SHOULD BE NO EMBEDDED SPACES
     C*
     C           ADCHK1    IFEQ *BLANK                                    E37171
     C           ADCHK2    ANDNE*BLANK                                    E37171
     C*                                                                   E37171
     C           ADCHK1    OREQ *BLANK                                    E37171
     C           ADCHK3    ANDNE*BLANK                                    E37171
     C*                                                                   E37171
     C           ADCHK1    OREQ *BLANK                                    E37171
     C           ADCHK4    ANDNE*BLANK                                    E37171
     C*                                                                   E37171
     C           ADCHK1    OREQ *BLANK                                    E37171
     C           ADCHK5    ANDNE*BLANK                                    E37171
     C*                                                                   E37171
     C***********ADCHK2    IFEQ *BLANK                                    E37171
     C***********ADCHK3    ANDNE*BLANK                                    E37171
     C***********                                                         E37171
     C           ADCHK2    OREQ *BLANK                                    E37171
     C           ADCHK3    ANDNE*BLANK                                    E37171
     C*                                                                   E37171
     C           ADCHK2    OREQ *BLANK
     C           ADCHK4    ANDNE*BLANK
     C*
     C           ADCHK2    OREQ *BLANK
     C           ADCHK5    ANDNE*BLANK
     C*
     C           ADCHK3    OREQ *BLANK
     C           ADCHK4    ANDNE*BLANK
     C*
     C           ADCHK3    OREQ *BLANK
     C           ADCHK5    ANDNE*BLANK
     C*
     C           ADCHK4    OREQ *BLANK
     C           ADCHK5    ANDNE*BLANK
     C*
     C                     SETON                     92
     C*
     C                     END
     C*
     C** CHECK FOR NON-VALID SWIFT CHARACTERS
     C*
     C           ADCHK1    IFNE *BLANKS
     C                     MOVEA*BLANKS   #FLD
     C                     MOVE ADCHK1    #FLD
     C/COPY WNCPYSRC,FT0050C170
     C                     EXSR SWSET
     C/COPY WNCPYSRC,FT0050C171
     C           *IN94     IFEQ '0'
     C                     ADD  1         I
     C*********************MOVE '500'     ERCD,I                          S01117
     C                     MOVE '031'     ERCD,I                          S01117
     C                     SETON                     93
     C                     END
     C                     END
     C**
     C           ADCHK2    IFNE *BLANKS
     C                     MOVEA*BLANKS   #FLD
     C                     MOVE ADCHK2    #FLD
     C                     EXSR SWSET
     C           *IN94     IFEQ '0'
     C                     ADD  1         I
     C*********************MOVE '501'     ERCD,I                          S01117
     C                     MOVE '032'     ERCD,I                          S01117
     C                     SETON                     93
     C                     END
     C                     END
     C**
     C           ADCHK3    IFNE *BLANKS
     C                     MOVEA*BLANKS   #FLD
     C                     MOVE ADCHK3    #FLD
     C                     EXSR SWSET
     C           *IN94     IFEQ '0'
     C                     ADD  1         I
     C*********************MOVE '502'     ERCD,I                          S01117
     C                     MOVE '033'     ERCD,I                          S01117
     C                     SETON                     93
     C                     END
     C                     END
     C**
     C           ADCHK4    IFNE *BLANKS
     C                     MOVEA*BLANKS   #FLD
     C                     MOVE ADCHK4    #FLD
     C                     EXSR SWSET
     C           *IN94     IFEQ '0'
     C                     ADD  1         I
     C*********************MOVE '503'     ERCD,I                          S01117
     C                     MOVE '034'     ERCD,I                          S01117
     C                     SETON                     93
     C                     END
     C                     END
     C**
     C           ADCHK5    IFNE *BLANKS
     C                     MOVEA*BLANKS   #FLD
     C                     MOVE ADCHK5    #FLD
     C                     EXSR SWSET
     C           *IN94     IFEQ '0'
     C                     SETON                     93
     C                     ADD  1         I
     C*********************MOVE '504'     ERCD,I                          S01117
     C                     MOVE '035'     ERCD,I                          S01117
     C                     END
     C                     END
     C**
     C                     ENDSR
     C*                                                               *
     C*                                                               *
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C* SUBROUTINE SWSET CHECK FOR VALID SWIFT CHARACTER USED
     C*   IND '94' IS SET BY AN INVALID CHARACTER IN SWCH
     C*****************************************************************
     C*
     C           SWSET     BEGSR                           *** SWSET ****
     C*
     C***********          Z-ADD1         Q       20                      068230
     C                     Z-ADD1         Q       50                      068230
     C                     MOVE '1'       *IN94
     C*
     C                     MOVEA*BLANK    TST
     C*
     C           #FLD,1    IFNE *BLANK                     B002
     C                     MOVEA#FLD      TST
     C                     Z-ADD1         Q
     C/COPY WNCPYSRC,FT0050C172
     C*
     C           Q         DOWLE35                         B003
     C*
     C           TST,Q     IFNE ' '                        B004
     C/COPY WNCPYSRC,FT0050C174
     C           TST,Q     LOKUPSWCH                     94
     C/COPY WNCPYSRC,FT0050C175
     C*
     C           *IN94     IFEQ '0'                        B005
     C                     GOTO ENDLP
     C                     END                             E005
     C                     END                             E004
     C                     ADD  1         Q
     C                     END                             E003
     C/COPY WNCPYSRC,FT0050C173
     C                     END                             E002
     C           ENDLP     TAG
     C                     ENDSR
     C********************************************************************
     C/EJECT
      ***********                                                         056031
      ***********   Remove PRONO OLPOS and MEMOS processing               056031
      ***********                                                         056031
     C************************************************************        056031
     C**ACMVT*SUBROUTINE - TO WRITE TO ACCOUNT MOVEMENTS FILE             056031
     C************************************************************        056031
     C***********                                                         056031
     C***********AMOVTS    BEGSR                                          056031
     C***********                                                         056031
     C***IF*PRONO RECORD PROCESSED                                        056031
     C***********                                                         056031
     C************IN60     IFEQ '1'                        B001           056031
     C***********                                                         056031
     C***ACCESS*FULL A/C DETAILS                                          056031
     C***********                                                         056031
     C***********          MOVE *BLANK    ZTABKY                          S01194
     C***********          MOVEL'70'      ZTABKY                          S01194
     C***********          MOVELKPRCCY    NOSWRK  5                       S01194
     C***********          MOVE KPRNOS    NOSWRK                          S01194
     C***********          MOVE KPRNOS    KPRNSA  2                 S01194056031
     C***********          MOVE NOSWRK    ZTABKY                          S01194
     C***********ZTABKY    CHAINTABLETLF             79                   S01194
     C**N79******RECI      COMP 'D'                  7979                 S01194
     C***********                                                         S01194
     C************IN79     IFEQ '1'                                       S01194
     C***********          MOVEL'TABLETL' WDBFIL            -DATABASE     S01194
     C***********          MOVELZTABKY    WDBKEY             ERROR.       S01194
     C***********          MOVEL'49'      WDBASE                          S01194
     C***********          EXSR UEABRT                                    S01194
     C***********          END                                            S01194
     C***********                                                   S01194056031
     C***********          CALL 'AONOSTR0'                          S01194056031
     C***********          PARM '*DBERR ' @RTCD   7                 S01194056031
     C***********          PARM '*KEY   ' @OPTN   7                 S01194056031
     C***********          PARM *BLANKS   @CUST   6                 S01194056031
     C***********          PARM KPRCCY    @CYCD   3                 S01194056031
     C***********          PARM *BLANKS   @ACCN   4                 S01194056031
     C***********          PARM *BLANKS   @ACSN   2                 S01194056031
     C***********          PARM KPRNSA    @NONB   2                 S01194056031
     C***********          PARM *BLANKS   @BRCD   3                 S01194056031
     C***********          PARM *BLANKS   @CSSN  10                 S01194056031
     C***********          PARM *BLANKS   @PNOI   1                 S01194056031
     C***********SDNOST    PARM SDNOST    DSFDY                     S01194056031
     C***********          EXSR MVNOS1                              S01194056031
     C***********          MOVE NOSLOC    ZLOC                      S01195056031
     C***********                                                         056031
     C***********          XFOOTYPO       TOT1   150                      056031
     C***********          XFOOTYPB       TOT2   150                      056031
     C**IF*NOSTRO BALANCES INCREASED                                      056031
     C***********TOT1      IFLT TOT2                       B002           056031
     C***********          MOVE '0'       DORC                            056031
     C***********          ELSE                            X002           056031
     C**IF*NOSTRO BALANCES DECREASED                                      056031
     C***********TOT1      IFGT TOT2                       B003           056031
     C***********          MOVE '1'       DORC                            056031
     C***********          END                             E003           056031
     C***********          END                             E002           056031
     C***********                                                         056031
     C***IF*MEMO*RECORD PROCESSED                                         056031
     C***********                                                         056031
     C***********          ELSE                            X001           056031
     C**IF*LEDGER BALANCE INCREASED                                       056031
     C***********LDBLWK    IFLT MMLDBL                     B002           056031
     C***********          MOVE '0'       DORC                            056031
     C***********          ELSE                            X002           056031
     C**IF*LEDGER BALANCE DECREASED                                       056031
     C***********LDBLWK    IFGT MMLDBL                     B003           056031
     C***********          MOVE '1'       DORC                            056031
     C***********          END                             E003           056031
     C***********          END                             E002           056031
     C***********          END                             E001           056031
     C***********                                                         056031
     C***********          MOVE VUDT      F PYDT                          056031
     C***NEW*HOLIDAY PROCESSING                                     S01195056031
     C***********          MOVE CCY       ZCCY                      S01195056031
     C***********                                                   S01195056031
     C***********ZIND      DOUEQ'W'                                 S01195056031
     C***********          Z-ADDPTDT      ZDAYNO                    S01195056031
     C***********          EXSR ZCHKH                               S01195056031
     C***********ZIND      IFNE 'W'                                       S01195
     C***********          SUB  1         PTDT                            S01195
     C***********          END                                            S01195
     C***********          END                                            S01195
     C***********                                                         S01195
     C**SETUP*VALUE*DATE*OF*ENTRY*********                                S01195
     C************IN94     DOUNE'1'                        B001           S01195
     C***********          SETOF                       9394               S01195
     C***********          MOVEL'22    '  ZTABKY                          S01195
     C***********          MOVELPTDT      ZWRK6                           S01195
     C***********          MOVE 1         ZWRK6                           S01195
     C***********          MOVE ZWRK6     ZTABKY                          S01195
     C***********ZTABKY    CHAINTABLETJF             93                   S01195
     C**N93******RECI      COMP '*'                      93               S01195
     C************IN93     IFEQ '0'                        B002           S01195
     C***********          MOVEAHCCY      HCC                             S01195
     C***********CCY       LOKUPHCC,1                    94               S01195
     C************IN94     IFEQ '1'                        B003           S01195
     C***********          SUB  1         PTDT                            S01195
     C***********          END                             E003           S01195
     C***********          END                             E002           S01195
     C***********          END                             E001           S01195
     C***********                                                   S01195056031
     C***********          Z-ADDCNUM      CUSN                            056031
     C***********          MOVE CCY       CCYD                            056031
     C***********          Z-ADDACOD      ACDE                            056031
     C***********          Z-ADDACSQ      ASNC                            056031
     C***********          MOVE PYTP      TRYP                            056031
     C***********          MOVE PREF      TNMR                            056031
     C***********          MOVE PREF      FUND                      E32880056031
     C***********                                                         056031
     C**AS*DORC*CONTROLS DEBIT/CREDIT,ENTRY MUST ALWAYS BE                056031
     C**INHERENTLY POSITIVE                                               056031
     C***********                                                         056031
     C***********MVAM      IFLT *ZERO                                     056031
     C***********          Z-SUBMVAM      MVAM                            056031
     C***********          END                                            056031
     C**WRITE*DETAILS TO FILE                                             056031
     C***********          WRITERSACMTPO                                  056031
     C***********          SETOF                     609394               056031
     C***********                                                         056031
     C***********          ENDSR                                          056031
     C*
     C************************************************************
     C/EJECT
     C*****************************************************************
     C* ADOTPY SR.
     C* CHECK CUSTOMER MASTER FILE FOR BIT 3 SET ON FOR A/C WITH BANK
     C*
     C*  CALLS:      TBLKEY
     C*              ACNKEY
     C*              FLDKEY
     C*              UEABRT
     C*
     C*  CALLED BY:  GIRTUP
     C*              GGDLUP
     C*****************************************************************
     C           ADOTPY    BEGSR
      *                                                                   056031
      ** Set flag and exit if no A/c with Bank entered                    056031
      *                                                                   056031
     C                     MOVEL'N'       @OPIN                           056031
     C           ACBT      CABEQ' '       EXOTPY                          056031
      *
      ** Find customer no.
      *
     C***********WACBT     CASEQ'N'       TBLKEY                          056031
     C***********WACBT     CASEQ'R'       ACNKEY                          056031
     C***********WACBT     CASEQ'P'       FLDKEY                          056031
     C           ACBT      CASEQ'N'       TBLKEY                          056031
     C           ACBT      CASEQ'R'       ACNKEY                          056031
     C           ACBT      CASEQ'P'       FLDKEY                          056031
     C                     END
      *
     C***********          MOVEL'A'       RCDT                            S01194
     C***********CLKEY     KLIST                                          S01194
     C***********          KFLD           CNUM                            S01194
     C***********          KFLD           RCDT                            S01194
     C***********CNUM      CHAINCLINTCBF             80                   S01194
     C***80******          DO                              *********** ** S01194
     C***********          MOVEL'52'      WDBASE           *DB ERR 52*    S01194
     C***********          MOVE 'CLINT'   WDBFIL           ************   S01194
     C***********          MOVELCNUM      WDBKEY                          S01194
     C***********          EXSR UEABRT                                 ** S01194
     C***********          END                                            S01194
     C*                                                                   S01194
     C                     CALL 'AOCUSTR0'                                S01194
     C                     PARM '*DBERR ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM CNUMA     @KEY1  10                       S01194
     C                     PARM *BLANK    @KYST   7                       S01194
     C           SDCUST    PARM SDCUST    DSSDY                           S01194
     C                     EXSR MVCUST                                    S01194
      *
     C***********          TESTB'0'       CMIN           21 IS A BANK     S01194
     C           BBBNBI    COMP 'Y'                      21 IS A BANK     S01194
      ***********                                                   056031053418
      **If*not*a*bank *IN21 '0' then set @OPIN to N else Y          056031053418
      ***********                                                   056031053418
     C************IN21     IFEQ '0'                                 056031053418
     C***********          MOVEL'N'       @OPIN   1                 056031053418
     C***********          ELSE                                     056031053418
     C***********          MOVEL'Y'       @OPIN                     056031053418
     C***********          END                                      056031053418
     C**                                                                  053418
     C** If in insert mode, set @OPIN to 'N'                              053418
     C**                                                                  053418
     C           SACTCD    IFEQ 'I'                                       053418
     C                     MOVEL'N'       @OPIN                           053418
     C                     END                                            053418
     C**                                                                  053418
     C** If in amend or delete mode, set @OPIN to 'Y' if                  053418
     C** OPIN is 'Y' else set @OPIN to 'N'                                053418
     C**                                                                  053418
     C           SACTCD    IFEQ 'A'                                       053418
     C           SACTCD    OREQ 'D'                                       053418
     C           OPIN      IFEQ 'Y'                                       053418
     C                     MOVEL'Y'       @OPIN   1                       053418
     C                     ELSE                                           053418
     C                     MOVEL'N'       @OPIN                           053418
     C                     END                                            053418
     C                     END                                            053418
      *                                                                   056031
     C           EXOTPY    ENDSR                                          056031
     C***********          ENDSR                                          056031
     C****************************************************************
     C* END OF ADOTPY SR.
     C****************************************************************
     C*
     C/EJECT
     C*****************************************************************
     C* TBLKEY SR.
     C* OBTAIN CLIENT NUMBER FROM NOSTRO TABLE FILE
     C*
     C*  CALLS:      UEABRT
     C*  CALLED BY:  ADOTPY
     C*
     C*****************************************************************
     C*
     C           TBLKEY    BEGSR
     C***********          MOVELWACBK     WSKY1   2                       056031
     C                     MOVELACBK      WSKY1   2                       056031
     C                     CALL 'AONOSTR0'                                S01194
     C                     PARM '*DBERR ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM *BLANKS   @CUST   6                       S01194
     C***********          PARM WPCCY     @CYCD   3                 S01194056031
     C                     PARM PCCY      @CYCD   3                       056031
     C**********           PARM *BLANKS   @ACCN   4                                    S01194 CGL029
     C                     PARM *BLANKS   @ACCN                                               CGL029
     C                     PARM *BLANKS   @ACSN   2                       S01194
     C                     PARM WSKY1     @NONB   2                       S01194
     C                     PARM *BLANKS   @BRCD   3                       S01194
     C                     PARM *BLANKS   @CSSN  10                       S01194
     C                     PARM *BLANKS   @PNOI   1                       S01194
     C           SDNOST    PARM SDNOST    DSFDY                           S01194
     C                     EXSR MVNOS1                                    S01194
     C*                                                                   S01194
     C***********          MOVE WSKY1     WSKEY   5                       S01194
     C***********          MOVELWPCCY     WSKEY                           S01194
     C***********          MOVE *BLANKS   KEY                             S01194
     C***********          MOVEL'70'      KEY                             S01194
     C***********          MOVE WSKEY     KEY                             S01194
     C***********KEY       CHAINTABLETLF             80                   S01194
     C**N80******RECI      COMP 'D'                  8080                 S01194
     C***80******          DO                                             S01194
     C***********          MOVEL'53'      WDBASE           *DB ERR 53 *   S01194
     C***********          MOVE 'TABTL'   WDBFIL           ************   S01194
     C***********          MOVELKEY       WDBKEY                          S01194
     C***********          EXSR UEABRT                                 ** S01194
     C***********          END                                            S01194
     C                     ENDSR
     C/EJECT
     C*****************************************************************
     C* ACNKEY SR.
     C* OBTAIN CLIENT NUMBER FROM RETAIL ACCOUNT NO.
     C*
     C*  CALLS:      UEABRT
     C*  CALLED BY:  ADOTPY
     C*
     C*****************************************************************
     C*
     C****************************************************************
     C           ACNKEY    BEGSR
     C***********          MOVELWACBK     ACNO                            056031
     C                     MOVELACBK      ACNO                            056031
     C           ACNO      CHAINACNUMABF             80
     C  N80      RECI      COMP 'D'                  8080                 047179
     C           *IN80     IFEQ '0'                                                           189639
     C**********           Z-ADDRETNUM    CNUM                                         189639 CSD027
     C                     MOVE RETNUM    CNUM                                                CSD027
     C                     ENDIF                                                              189639
     C   80                DO
     C                     MOVEL'54'      WDBASE           *DB ERR 54 *
     C                     MOVE 'ACNUM'   WDBFIL           ************
     C                     MOVELACNO      WDBKEY
     C                     EXSR UEABRT                                 **
     C                     END
     C                     ENDSR
     C/EJECT
     C*****************************************************************
     C* FLDKEY SR.
     C* OBTAIN CLIENT NUMBER FROM PARTIAL ACCOUNT NO.
     C*
     C*  CALLS:      UEABRT
     C*  CALLED BY:  ADOTPY
     C*
     C*****************************************************************
     C*
     C           FLDKEY    BEGSR
     C***********          MOVELWACBK     CNUM                            056031
     C                     MOVELACBK      CNUM                            056031
     C                     ENDSR
     C***************************************************************
     C* END OF OBTAIN CLIENT NUMBER SUBROUTINE
     C***************************************************************
     C/EJECT
     C************************************************************
     C* RATES SR.
     C* VALIDAION OF RATE
     C* OPTIONAL DEFAULTS TO CROSS RATE
     C* IF REGULAR PAYMENT NOT PERMITTED
     C*
     C           RATES     BEGSR
     C*
     C* CHECK IF SETTLE OR PAY CCY AMENDED AND RATE NOT ALTERED.
     C*
     C           SACTCD    IFEQ 'A'
      *
     C           SSMCY     IFNE OSMCY
     C           SPCCY     ORNE OPCCY
      *
     C           SRATE     IFEQ RATEO
     C                     SETON                     5289
     C                     ADD  1         I
     C*********************MOVEA' 423'    ERCD,I                          S01117
     C                     MOVEA' 080'    ERCD,I                          S01117
     C                     END
      *
     C                     END
      *
     C                     END
     C*
     C/COPY WNCPYSRC,FT0050C010
     C                     EXSR RATDEF
     C/COPY WNCPYSRC,FT0050C011
      *
     C           SRATE     IFEQ *BLANK                     B001
     C                     Z-ADDDRATE     WRATE
     C                     Z-ADDDMDIN     WMDIN   10
     C                     ELSE                            X001
      *
     C* CHECK IF VALID NUMERIC
      *
     C                     MOVE *BLANK    ZFIELD
     C                     MOVE SRATE     ZFIELD
     C**********           Z-ADD4         ZADIG                                             AR895223
     C                     Z-ADD5         ZADIG                                             AR895223
     C                     Z-ADD8         ZADEC
     C                     EXSR ZALIGN
      *
     C           *IN99     IFEQ '1'                        B002
     C                     SETON                     5289
     C                     ADD  1         I
     C******************   MOVEA' 046'    ERCD,I                          E16366
     C*********************MOVEA' 120'    ERCD,I                    E16366S01117
     C                     MOVEA' 069'    ERCD,I                          S01117
     C                     ELSE                            X002
     C                     MOVE ZFIELD    WRATE  138
      *
     C***********DRATE     IFGT 1                          B003                               112287
     C***********WRATE     ANDGT1                                                             112287
     C***********DRATE     ORLE 1                                                             112287
     C***********WRATE     ANDLE1                                                             112287
     C                     Z-ADDDMDIN     WMDIN
     C***********          ELSE                            X003                               112287
     C***********1         SUB  DMDIN     WMDIN                                               112287
     C***********          END                             E003                               112287
      *
     C           SOVRD     IFNE 'Y'                        B003
     C           SSMCY     OREQ SPCCY                                     055201
     C           SOVRD     ANDEQ'Y'                                       055201
     C                     EXSR RATVAL
     C                     END                             E003
      *
     C                     END                             E002
      *
     C                     END                             E001
      *                                                                   CFT009
      ** If settle amount is blank , move '*CALCSET' into return code,    CFT009
      ** otherwise move '*CALCPAY' into return code for call of           CFT009
      ** FT000980                                                         CFT009
      *                                                                   CFT009
     C           WSMAM     IFEQ *ZEROS                                    CFT009
     C                     MOVEL'*CALCSET'RTN980                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVEL'*CALCPAY'RTN980                          CFT009
     C                     ENDIF                                          CFT009
      *
     C/COPY WNCPYSRC,FT0050C030
     C  N52                EXSR RATCAL
     C/COPY WNCPYSRC,FT0050C031
      *
     C                     ENDSR
     C************************************************************
     C* END OF RATE VALIDATION
     C************************************************************
     C/EJECT
     C************************************************************
     C* RATDEF SR.
     C* DEFAULT RATE CALCULATION
     C*
     C           RATDEF    BEGSR
     C*
     C* SETUP TO AND FROM RATES
     C*
     C           WSMAM     IFEQ 0                          B001
     C                     MOVE SSMCY     TCCY    3
     C                     MOVE WPCCY     FCCY    3
     C                     Z-ADDSBRAT     TSRAT  138
     C                     Z-ADDSVSMDN    TMDIN   10
     C                     Z-ADDSVSCDP    TCDP    10
     C                     Z-ADDSBRAT     TBRAT  138
     C                     Z-ADDPSRAT     FBRAT  138
     C                     Z-ADDSVPMDN    FMDIN   10
     C                     Z-ADDSVPCDP    FCDP    10
     C                     ELSE                            X001
     C                     MOVE SSMCY     FCCY
     C                     MOVE WPCCY     TCCY
     C                     Z-ADDSBRAT     FBRAT  138
     C                     Z-ADDSVSMDN    FMDIN
     C                     Z-ADDPSRAT     TBRAT  138
     C                     Z-ADDSVSCDP    FCDP
     C                     Z-ADDPSRAT     TSRAT  138
     C                     Z-ADDSVPMDN    TMDIN
     C                     Z-ADDSVPCDP    TCDP
     C                     END                             E001
     C*
     C* IF CURRENCIES EQUAL RATE IS 1.0
     C*
     C           FCCY      IFEQ TCCY                       B001
     C                     Z-ADD1         DRATE  138
     C                     Z-ADD0         DMDIN   10
     C*
     C                     ELSE                            X001
     C*
     C* IF FROM CURRENCY IS BASE RATE IS TO CURRENCY
     C*
     C           FCCY      IFEQ SVBCCY                     B002
     C                     Z-ADDTBRAT     DRATE
     C*********************Z-ADDTMDIN     DMDIN                           E21453
     C*                                                                   053348
     C           WPCCY     IFEQ TCCY                                      053348
     C           1         SUB  TMDIN     DMDIN                           E21453
     C                     ELSE                                           053348
     C                     Z-ADDTMDIN     DMDIN                           053348
     C                     END                                            053348
     C*                                                                   053348
     C                     ELSE                            X002
     C*
     C* IF TO CURRENCY IS BASE RATE IS FROM CURRENCY
     C*
     C           TCCY      IFEQ SVBCCY                     B003
     C                     Z-ADDFBRAT     DRATE
     C*                                                                   053348
     C           WPCCY     IFEQ TCCY                                      053348
     C                     Z-ADDFMDIN     DMDIN
     C                     ELSE                                           053348
     C           1         SUB  FMDIN     DMDIN                           E21453
     C                     END                                            053348
     C*                                                                   053348
     C                     ELSE                            X003
     C*
     C* IF NEITHER CURRENCY IS BASE
     C* IF BOTH DIVIDE CURRENCIES
     C*
     C           FMDIN     IFEQ 0                          B004
     C           TMDIN     IFEQ 0                          B005
     C*
     C* RATE IS TO SELL RATE DIVIDE BY FROM BUY RATE
     C*
     C           TSRAT     DIV  FBRAT     DRATE     H
     C                     Z-ADD1         DMDIN
     C*
     C           DRATE     IFLT 1                          B006
     C           FBRAT     DIV  TSRAT     DRATE     H
     C                     Z-ADD0         DMDIN
     C                     END                             E006
     C*
     C                     ELSE                            X005
     C           FBRAT     MULT TSRAT     DRATE     H
     C                     Z-ADD0         DMDIN
     C*
     C           DRATE     IFLT 1                          B006
     C           1         DIV  DRATE     DRATE     H
     C                     Z-ADD1         DMDIN
     C                     END                             E006
     C*
     C                     END                             E005
     C*
     C                     ELSE                            X004
     C*
     C           TMDIN     IFEQ 0                          B005
     C           TSRAT     MULT FBRAT     DRATE     H
     C                     Z-ADD1         DMDIN
     C*
     C           DRATE     IFLT 1                          B006
     C           1         DIV  DRATE     DRATE     H
     C                     Z-ADD0         DMDIN
     C                     END                             E006
     C*
     C                     ELSE                            X005
     C           FBRAT     DIV  TSRAT     DRATE     H
     C                     Z-ADD1         DMDIN
     C*
     C           DRATE     IFLT 1                          B006
     C           TSRAT     DIV  FBRAT     DRATE     H
     C                     Z-ADD0         DMDIN
     C                     END                             E006
     C*
     C                     END                             E005
     C                     END                             E004
     C*
     C           WSMAM     IFEQ 0                          B004
     C           1         SUB  DMDIN     DMDIN
     C                     END                             E004
     C*
     C                     END                             E003
     C                     END                             E002
     C                     END                             E001
     C*
     C                     ENDSR
     C************************************************************
     C* END DEFAULT RATE CALCULATION
     C************************************************************
     C/EJECT
     C************************************************************
     C* RATCAL SR.
     C* UNENTERED VALUE CALCULATION
     C*
     C           RATCAL    BEGSR
     C*
     C           WSMAM     IFEQ 0                          B001
     C           SVPCDP    SUB  SVSCDP    N       10
     C                     ADD  4         N
     C*
     C           WMDIN     IFEQ 1                          B002
     C***********WRATE     DIV  POWER,N   WK159  159H                     046270
     C***********WPYAM     MULT WK159     WSMAM     H                     046270
     C           WRATE     MULT POWER,N   WK159                           046270
     C           WPYAM     DIV  WK159     WSMAM     H                     046270
     C                     ELSE                            X002
     C***********WRATE     MULT POWER,N   WK159                           046270
     C***********WPYAM     DIV  WK159     WSMAM     H                     046270
     C           WRATE     DIV  POWER,N   WK159  159H                     046270
     C           WPYAM     MULT WK159     WSMAM     H                     046270
     C                     END                             E002
     C*
     C                     ELSE                            X001
     C           SVSCDP    SUB  SVPCDP    N       10
     C                     ADD  4         N
     C*
     C           WMDIN     IFEQ 1                          B002
     C           WRATE     DIV  POWER,N   WK159  159H
     C           WSMAM     MULT WK159     WPYAM     H
     C                     ELSE                            X002
     C           WRATE     MULT POWER,N   WK159
     C           WSMAM     DIV  WK159     WPYAM     H
     C                     END                             E002
     C*
     C                     END                             E001
     C*
     C                     ENDSR
     C************************************************************
     C* END UNENTERED VALUE CALCULATION
     C************************************************************
     C/EJECT
     C************************************************************
     C* RATVAL SR.
     C* VALIDATE RATE WHEN ENTERED
     C*
     C           RATVAL    BEGSR
     C*
     C           SSMCY     IFEQ WPCCY                      B001
     C*
     C           WRATE     IFNE 1                          B002
     C                     SETON                     5289
     C                     ADD  1         I
     C*********************MOVEA' 048'    ERCD,I                          S01117
     C                     MOVEA' 068'    ERCD,I                          S01117
     C                     END                             E002
     C*
     C                     ELSE                            X001
     C*          DRATE     MULT 0.9       DORATE 138H
     C*          DRATE     MULT 1.1       UPRATE 138H
      *
      ** Upper and lower limits are determined by % rate discrepancy
      **                                    from payment charges file.
     C           DRATE     MULT UPMARG    UPRATE 138H
     C           DRATE     MULT LWMARG    DORATE 138H
     C           WRATE     IFLT DORATE                     B002
     C           WRATE     ORGT UPRATE
      *
      ** Entered rate may be Settle ccy/Pay ccy or vice versa
      **     (whichever is nearer the default rate(DRATE) is assumed)
     C           1         DIV  DRATE     DRATE
     C           DRATE     MULT UPMARG    UPRATE 138H
     C           DRATE     MULT LWMARG    DORATE 138H
     C*          DRATE     MULT 0.9       DORATE 138H
     C*          DRATE     MULT 1.1       UPRATE 138H
     C           WRATE     IFLT DORATE                     B003
     C           WRATE     ORGT UPRATE
     C                     SETON                     5289
     C                     ADD  1         I
     C*********************MOVEA' 048'    ERCD,I                          S01117
     C                     MOVEA' 068'    ERCD,I                          S01117
     C                     ELSE                                           113477
     C           1         SUB  WMDIN     WMDIN                           113477
     C                     END                             E003
     C                     END                             E002
     C                     END                             E001
     C                     ENDSR
     C************************************************************
     C* END OF ENTERED RATE VALIDATION
     C************************************************************
     C/EJECT
      ***********                                                         056031
      ***********   Remove PRONO OLPOS and MEMOS processing               056031
      ***********                                                         056031
     C************************************************************        056031
     C**NOSTRO*SR.                                                        056031
     C**CHECKS*FOR ACCOUNT ENTRIES BEING NOSTROS                          056031
     C***********                                                         056031
     C***********NOSTRO    BEGSR                                          056031
     C***********                                                         056031
     C***********          SETOF                     65                   056031
     C**IF*TYPE*NOT R,P OR G IGNORE                                       056031
     C***********NTYPE     IFEQ 'R'                        B001           056031
     C***********NTYPE     OREQ 'P'                                       056031
     C***********NTYPE     OREQ 'G'                                       056031
     C**IF*RETAIL NUMBER READ ACNUMA TO GET ACCOUNT DETAILS               056031
     C***********NTYPE     IFEQ 'R'                        B002           056031
     C***********          Z-ADDACNON     ACNO                            056031
     C***********ACNO      CHAINACNUMA               89                   056031
     C**N89******RECI      COMP 'D'                  8989                 056031
     C***89******          DO                              B003           056031
     C***********          MOVEL'ACNUM'   WDBFIL             DATABASE     056031
     C***********          MOVELACNO      WDBKEY                          056031
     C***********          MOVEL'48'      WDBASE                          056031
     C***********          EXSR UEABRT                                    056031
     C***********          END                             E003           056031
     C***********          END                             E002           056031
     C**IF*PARTIAL ACCOUNT FORMAT ACCOUNT NUMBER                          056031
     C***********NTYPE     IFEQ 'P'                        B002           056031
     C***********          Z-ADDCNUMN     CNUM                            056031
     C***********          MOVE NCCY      CCY                             056031
     C***********          Z-ADDACODNP    ACOD                            056031
     C***********          Z-ADDACSQNP    ACSQ                            056031
     C***********          MOVE BRCANP    BRCA                      S01117056031
     C***********          END                             E002           056031
     C**IF*FULL*ACCOUNT FORMAT ACCOUNT NUMBER                             056031
     C***********NTYPE     IFEQ 'G'                        B002           056031
     C***********          Z-ADDCNUMN     CNUM                            056031
     C***********          MOVE CCYN      CCY                             056031
     C***********          Z-ADDACODN     ACOD                            056031
     C***********          Z-ADDACSQN     ACSQ                            056031
     C***********          MOVE BRCAN     BRCA                      S01117056031
     C***********          END                             E002           056031
     C**READ***TABLETL***SDNOSTPD*TO*SEE*IF*A*NOSTRO*******************   S01194
     C***********          Z-ADDCNUM      KACNUM                          056031
     C***********          MOVE CCY       KACCCY                          056031
     C***********          Z-ADDACOD      KACCD                           056031
     C***********          Z-ADDACSQ      KACSQ                           056031
     C***********          MOVE BRCA      KBRCA                     S01117056031
     C***********KACKEY    CHAINFPRTNF               88                   S01194
     C***********                                                   S01194056031
     C***********          CALL 'AONOSTR0'                          S01194056031
     C***********          PARM *BLANKS   @RTCD   7                 S01194056031
     C***********          PARM '*KEY   ' @OPTN   7                 S01194056031
     C***********          PARM KACNMA    @CUST   6                 S01194056031
     C***********          PARM KACCCY    @CYCD   3                 S01194056031
     C***********          PARM KACCDA    @ACCN   4                 S01194056031
     C***********          PARM KACSQA    @ACSN   2                 S01194056031
     C***********          PARM *BLANKS   @NONB   2                 S01194056031
     C***********          PARM KBRCA     @BRCD   3                 S01194056031
     C***********          PARM *BLANKS   @CSSN  10                 S01194056031
     C***********          PARM *BLANKS   @PNOI   1                 S01194056031
     C***********SDNOST    PARM SDNOST    DSFDY                     S01194056031
     C***********                                                   S01194056031
     C***********@RTCD     CASEQ*BLANK    MVNOS2     8888           S01194056031
     C***********          END                                      S01194056031
     C***********                                                   S01194056031
     C**N88******RECI      COMP 'D'                  8888                 056031
     C**N88******          SETON                     65                   056031
     C***********          END                             E001           056031
     C***********          ENDSR                                          056031
     C************************************************************
     C* END OF NOSTRO SUBROUTINE
     C************************************************************
     C/EJECT
     C***********UATBCN    BEGSR                                          S01194
     C*****************    *****                                          S01194
     C***********                                                         S01194
     C*****************************************************************   S01194
     C******************UA-CHAIN-TABLE-FILE****************************   S01194
     C***********                                                     *   S01194
     C***FUNCTION*:*TO*ATTEMPT*TO*ACCESS*A*REQUESTED*RECORD*FROM*THE***   S01194
     C**************TABLE FILE.                                       *   S01194
     C***********                                                     *   S01194
     C***CALL**:****NONE                                              *   S01194
     C***********                                                     *   S01194
     C***CALLED*BY:*CAINIT                                            *   S01194
     C***********   CCPROC                                            *   S01194
     C***********   GAVALD                                            *   S01194
     C***********   GIRTUP                                            *   S01194
     C***********   IAVLRT                                            *   S01194
     C***********   ICGNRT                                            *   S01194
     C***********                                                     *   S01194
     C*****************************************************************   S01194
     C***********                                                         S01194
     C***********ZTABKY    CHAINTABFP                89                   S01194
     C***********                                                         S01194
     C**N89******RECI      COMP 'D'                  8989                 S01194
     C***********                                                         S01194
     C****************     *****                                          S01194
     C***********UAEND     ENDSR                                          S01194
     C****************     *****                                          S01194
     C/EJECT
     C           UCINCN    BEGSR
     C*          ******    *****
     C*
     C*****************************************************************
     C*                 UC-CHAIN-PAYMENT-CHARGES-FILE                 *
     C*                                                               *
     C*  FUNCTION : TO ATTEMPT TO ACCESS THE RECORD FROM THE PAYMENT  *
     C*             CHARGES FILE.                                     *
     C*                                                               *
     C*  CALLS :    NONE                                              *
     C*                                                               *
     C*  CALLED BY: CCPROC                                            *
     C*             EEAMND                                            *
     C*             EGDELT                                            *
     C*                                                               *
     C*****************************************************************
     C*
     C                     SETOF                     88
     C*
     C           SPREF     CHAININPAY                89
     C/COPY WNCPYSRC,FT0050C041
     C*
     C** IF CHAIN FAILS,SETUP SEPERATE INDICATOR
     C*
     C   89                SETON                     88
     C*
     C  N89      RECI      COMP 'D'                  8989
     C*
     C*          *****     *****
     C           UCEND     ENDSR
     C*          *****     *****
     C/EJECT
     C           UEABRT    BEGSR
     C*          ******    *****
     C*
     C*****************************************************************
     C*                 UE-ABORT-PROGRAM                              *
     C*                                                               *
     C*  FUNCTION : TO ABORT THE PROGRAM IN THE EVENT OF A DATABASE   *
     C*             ERROR. ALSO TO SETUP THE RELEVANT FIELDS IN THE   *
     C*             DATA AREA LDA FOR THIS ERROR.                     *
     C*                                                               *
     C*  CALLS :    NONE                                              *
     C*                                                               *
     C*  CALLED BY: CAINIT                                            *
     C*             CCPROC                                            *
     C*             EEAMND                                            *
     C*             EGDELT                                            *
     C*             GEINTR                                            *
     C*             GGDLUP                                            *
     C*             GIRTUP                                            *
     C*             IAVLRT                                            *
     C*             ICGNRT                                            *
     C*             ACCCHN                                            *
     C*                                                               *
     C*****************************************************************
     C*
     C** UPDATE DATA AREA LDA
     C*
     C           *NAMVAR   DEFN LDA       DLDA
     C           *LOCK     IN   DLDA
     C                     MOVEL*BLANKS   DBPGM                           S01428
     C                     MOVEL'FT0050'  DBPGM
     C                     MOVELWDBFIL    DBFILE
     C                     MOVELWDBKEY    DBKEY
     C                     MOVELWDBASE    DBASE
     C                     OUT  DLDA
      *                                                                   042167
      *  Allocate dataarea to blanks                                      042167
      *                                                                   042167
     C                     EXSR DALLOC                                    042167
     C*
     C**MANUAL*CLOSE*OF*MSIME*FILE*                                       S01259
     C**MANUAL*CLOSE*OF*MSMSI2L9*FILE*                              S01259S01435
     C*
     C*********************CLOSEMSIME                                     S01259
     C***********          CLOSEMSMSI2L9                            S01259S01435
     C*
     C** SETON INDICATORS TO INDICATE DATABASE ERRORS
     C*
     C                     SETON                     U7U8LR
     C/COPY WNCPYSRC,FT0050C115
     C*
     C** PRODUCE PROGRAM DUMP
     C*
     C                     DUMP
     C*
     C** CLOSE OPTIONAL FILES AS APPROPRIATE
     C*
     C*
     C** END PROGRAM
     C*
     C                     RETRN
     C*
     C*          *****     *****
     C           UEEND     ENDSR
     C*          *****     *****
     C/EJECT
     C********************************************************************042167
     C* SUBROUTINE TO DEALLOCATE DATAAREA                                 042167
     C*                                                                   042167
     C           DALLOC    BEGSR                           *** DALLOC ****042167
      *                                                                   042167
      * Call CL program to de-allocate                                    042167
      *                                                                   042167
     C                     MOVE *BLANKS   @RTCDE                          042167
     C                     MOVE 'FT'      @MODLE                          042167
     C                     MOVE *BLANKS   @TREF                           042167
     C                     MOVE *BLANKS   @RTINF                          042167
     C                     CALL 'AOC8000'                                 042167
     C                     PARM           @RTCDE                          042167
     C                     PARM           @MODLE                          042167
     C                     PARM           @TREF                           042167
     C                     PARM           @RTINF                          042167
      *                                                                   042167
     C                     ENDSR                                          042167
      *                                                                   042167
     C*                                                                   042167
     C/EJECT
     C           UGTIME    BEGSR
     C*          ******    *****
     C*
     C*****************************************************************
     C*                 UG-GET-TIME                                   *
     C*                                                               *
     C*  FUNCTION : TO OBTAIN THE CURRENT SYSTEM TIME.                *
     C*                                                               *
     C*  CALLS :    NONE                                              *
     C*                                                               *
     C*  CALLED BY: CCPROC                                            *
     C*             EAINPT                                            *
     C*                                                               *
     C*****************************************************************
     C*
     C                     TIME           TIME
     C*
     C*          *****     *****
     C           UGEND     ENDSR
     C*          *****     *****
     C/EJECT
     C           UIFRMT    BEGSR
     C*          ******    *****
     C*
     C*****************************************************************
     C*             UI-FORMAT-FIELD-FOR-OUTPUT-TO-SCREEN              *
     C*                                                               *
     C*  FUNCTION : TO FORMAT A NUMERIC FIELD FROM THE PAYMENT        *
     C*             CHARGES FILE FOR OUTPUT TO THE DETAIL SCREEN.     *
     C*             IT REMOVES LEADING ZEROES & INSERTS A DECIMAL     *
     C*             POINT IN THE APPROPRIATE POSITION.                *
     C*                                                               *
     C*  CALLS :    NONE                                              *
     C*                                                               *
     C*  CALLED BY: CCPROC                                            *
     C*                                                               *
     C*****************************************************************
     C*
     C                     MOVEAWFDIN     YA1,1
     C*
     C** REPLACE LEADING ZEROES (IF LEFT OF DECIMAL POINT) WITH SPACES
     C*
     C                     SETOF                     89
     C*******    15        SUB  WDIG      I                 -START        103715
     C*******              SUB  WDEC      I                  POS.         103715
     C           15        SUB  WDIG      ID      20        -START        103715
     C                     SUB  WDEC      ID                 POS.         103715
     C*
     C           14        SUB  WDEC      I1      30
     C*
     C           *IN89     DOUEQ'1'
     C*******              ADD  1         I                               103715
     C*******    I         IFGT 15                          -CHECK FOR    103715
     C                     ADD  1         ID                              103715
     C           ID        IFGT 15                          -CHECK FOR    103715
     C                     SETON                     89      ARRAY END
     C                     ELSE
     C*******    YA1,I     IFNE '0'                         -CHECK FOR    103715
     C           YA1,ID    IFNE '0'                         -CHECK FOR    103715
     C                     SETON                     89      NON-ZERO
     C                     ELSE                              DIGIT.
     C*******    I         IFLE I1                                        103715
     C*******              MOVEL' '       YA1,I                           103715
     C           ID        IFLE I1                                        103715
     C                     MOVEL' '       YA1,ID                          103715
     C                     END
     C                     END
     C                     END
     C                     END
     C*
     C** MOVE TO OUTPUT ARRAY,INSERTING A DECIMAL POINT AS APPROPRIATE
     C** (UNLESS THE INPUT FIELD WAS ALL ZEROES)
     C*
     C*******    I         IFGT 15                                        103715
     C           ID        IFGT 15                                        103715
     C                     MOVEL*BLANKS   WFDOUT
     C                     GOTO UIEND
     C                     END
     C*
     C                     MOVEL*BLANKS   YA2
     C*
     C           WDEC      IFEQ *ZERO
     C                     MOVEAYA1,1     YA2,2
     C                     ELSE
     C                     MOVEAYA1,1     YA2,1
     C*******    16        SUB  WDEC      I                               103715
     C*******    I         ADD  1         I1                              103715
     C*******              MOVEL'.'       YA2,I                           103715
     C*******              MOVEAYA1,I     YA2,I1                          103715
     C           16        SUB  WDEC      ID                              103715
     C           ID        ADD  1         I1                              103715
     C                     MOVEL'.'       YA2,ID                          103715
     C                     MOVEAYA1,ID    YA2,I1                          103715
     C                     END
     C*
     C                     MOVEAYA2,1     WFDOUT 16
     C*
     C*          *****     *****
     C           UIEND     ENDSR
     C*          *****     *****
     C/EJECT
     C***********UKCLCN    BEGSR                                          S01194
     C*****************    *****                                          S01194
     C***********                                                         S01194
     C*****************************************************************   S01194
     C***********       UK-CHAIN-CLINT-FILE                           *   S01194
     C***********                                                     *   S01194
     C***FUNCTION*:*TO*ATTEMPT*TO*ACCESS*A*REQUESTED*RECORD*FROM*THE***   S01194
     C***********   CLINT FILE.                                       *   S01194
     C***********                                                     *   S01194
     C***CALLS*:****NONE                                              *   S01194
     C***********                                                     *   S01194
     C***CALLED*BY:*GAVALD                                            *   S01194
     C***********                                                     *   S01194
     C*****************************************************************   S01194
     C***********                                                         S01194
     C***********KCLKEY    KLIST                                          S01194
     C***********          KFLD           KCLNUM  60                      S01194
     C***********          KFLD           KCLRCT  1                       S01194
     C***********                                                         S01194
     C***********KCLKEY    CHAINCLINT                89                   S01194
     C***********                                                         S01194
     C**N89******RECI      COMP 'D'                  8989                 S01194
     C***********                                                         S01194
     C****************     *****                                          S01194
     C***********UKEND     ENDSR                                          S01194
     C****************     *****                                          S01194
     C/EJECT
     C           UMAACN    BEGSR
     C*          ******    *****
     C*
     C*****************************************************************
     C*                 UK-CHAIN-ACNUMA-FILE                          *
     C*                                                               *
     C*  FUNCTION : TO ATTEMPT TO ACCESS A REQUESTED RECORD FROM THE  *
     C*             ACNUMA FILE.                                      *
     C*                                                               *
     C*  CALLS :    NONE                                              *
     C*                                                               *
     C*  CALLED BY: GAVALD                                            *
     C*             GIRTUP                                            *
     C*                                                               *
     C*****************************************************************
     C*
     C           ACNO      CHAINACNUMA               89
     C*
     C  N89      RECI      COMP 'D'                  8989
     C           *IN89     IFEQ '0'                                                           189639
     C**********           Z-ADDRETNUM    CNUM                                         189639 CSD027
     C                     MOVE RETNUM    CNUM                                                CSD027
     C                     ENDIF                                                              189639
     C*
     C*          *****     *****
     C           UMEND     ENDSR
     C*          *****     *****
     C/EJECT
     C********************************************************************
     C*
     C*  SR ACCCHN TO ACCESS THE ACCNT RECORD FOR A NOSTRO
     C*
     C*  CALLS    : UOACCN
     C*  CALLED BY: GAVALD
     C*
     C           ACCCHN    BEGSR
     C*
     C**********           Z-ADDCNUMSV    KACNUM                                              CSD027
     C                     MOVE CNUMSV    KACNUM                                              CSD027
     C                     MOVE CCYSV     KACCCY
     C                     Z-ADDACODSV    KACCD
     C                     Z-ADDACSQSV    KACSQ
     C                     MOVE BRCASV    KBRCA                           S01117
     C                     EXSR UOACCN
     C*
     C           *IN89     IFEQ '1'
     C                     MOVE 'ACCNT'   WDBFIL           ***************
     C                     MOVEL'47'      WDBASE           * DB ERROR 47 *
     C                     MOVELACKYDS    WDBKEY           ***************
     C                     EXSR UEABRT
     C                     END
     C*
     C                     ENDSR
     C*
     C********************************************************************
     C/EJECT
     C*          ******    *****
     C           UOACCN    BEGSR
     C*          ******    *****
     C*
     C*****************************************************************
     C*                 UO-CHAIN-ACCNT-FILE                           *
     C*                                                               *
     C*  FUNCTION : TO ATTEMPT TO ACCESS A REQUESTED RECORD FROM THE  *
     C*             ACCNT FILE.                                       *
     C*                                                               *
     C*  CALLS :    NONE                                              *
     C*                                                               *
     C*  CALLED BY: GAVALD                                            *
     C*             GIRTUP                                            *
     C*                                                               *
     C*****************************************************************
     C*
     C           KACKEY    KLIST
     C**********           KFLD           KACNUM  60                                          CSD027
     C                     KFLD           KACNUM  6                                           CSD027
     C                     KFLD           KACCCY  3
     C**********           KFLD           KACCD   40                                          CGL029
     C                     KFLD           KACCD                                               CGL029
     C                     KFLD           KACSQ   20
     C                     KFLD           KBRCA   3                       S01117
     C*
     C           KACKEY    CHAINACCNT                89
     C*
     C  N89      RECI      COMP 'D'                  8989
     C           *IN89     IFEQ '0'                                                           189639
     C**********           Z-ADDRETNUM    CNUM                                         189639 CSD027
     C                     MOVE RETNUM    CNUM                                                CSD027
     C                     ENDIF                                                              189639
     C*
     C*          *****     *****
     C           UOEND     ENDSR
     C*          *****     *****
     C/EJECT
     C***********UQSNCN    BEGSR                                          S01194
     C*****************    *****                                          S01194
     C***********                                                         S01194
     C*****************************************************************   S01194
     C***********       UQ-CHAIN-SNAME-FILE                           *   S01194
     C***********                                                     *   S01194
     C***FUNCTION*:*TO*ATTEMPT*TO*ACCESS*A*REQUESTED*RECORD*FROM*THE***   S01194
     C***********   SNAME FILE.                                       *   S01194
     C***********                                                     *   S01194
     C***CALLS*:****NONE                                              *   S01194
     C***********                                                     *   S01194
     C***CALLED*BY:*GAVALD                                            *   S01194
     C***********                                                     *   S01194
     C*****************************************************************   S01194
     C***********                                                         S01194
     C***********CSNM      CHAINSNAME                89                   S01194
     C***********                                                         S01194
     C**N89******RECI      COMP 'D'                  8989                 S01194
     C***********                                                         S01194
     C****************     *****                                          S01194
     C***********UQEND     ENDSR                                          S01194
     C****************     *****                                          S01194
     C/EJECT
      ***********                                                         056031
      ***********   Remove PRONO OLPOS and MEMOS processing               056031
      ***********                                                         056031
     C***********USPRCN    BEGSR                                          056031
     C*****************    *****                                          056031
     C***********                                                         056031
     C*****************************************************************   056031
     C***********       US-CHAIN-PRONO-FILE                           *   056031
     C***********                                                     *   056031
     C***FUNCTION : TO ATTEMPT TO ACCESS A REQUESTED RECORD FROM THE  *   056031
     C***********   PRONO FILE.                                       *   056031
     C***********                                                     *   056031
     C***CALLS*:*   NONE                                              *   056031
     C***********                                                     *   056031
     C***CALLED*BY: GGDLUP                                            *   056031
     C***********                                                     *   056031
     C*****************************************************************   056031
     C***********                                                         056031
     C***********KPRKEY    KLIST                                          056031
     C***********          KFLD           KPRCCY  3                       056031
     C***********          KFLD           KPRNOS  20                      056031
     C***********                                                         056031
     C***********KPRKEY    CHAINPRONO                89                   056031
     C***********                                                         056031
     C**N89******RECI      COMP 'D'                  8989                 056031
     C***********                                                         056031
     C****************     *****                                          056031
     C***********USEND     ENDSR                                          056031
     C****************     *****                                          056031
     C*/EJECT*****                                                        056031
     C***********UUOLCN    BEGSR                                          056031
     C*****************    *****                                          056031
     C***********                                                         056031
     C*****************************************************************   056031
     C***********       UU-CHAIN-OLPOS-FILE                           *   056031
     C***********                                                     *   056031
     C***FUNCTION : TO ATTEMPT TO ACCESS A REQUESTED RECORD FROM THE  *   056031
     C***********   OLPOS FILE.                                       *   056031
     C***********                                                     *   056031
     C***CALLS*:*   NONE                                              *   056031
     C***********                                                     *   056031
     C***CALLED*BY: GGDLUP                                            *   056031
     C***********                                                     *   056031
     C*****************************************************************   056031
     C***********                                                         056031
     C***********KOLKEY    KLIST                                          056031
     C***********          KFLD           KOBRCA  3                 S01117056031
     C***********          KFLD           KOLCCY  3                       056031
     C***********          KFLD           KOLRCN  20                      056031
     C***********                                                         056031
     C***********KOLKEY    CHAINOLPOS                89                   056031
     C***********                                                         056031
     C**N89******RECI      COMP 'D'                  8989                 056031
     C***********                                                         056031
     C****************     *****                                          056031
     C***********UUEND     ENDSR                                          056031
     C****************     *****                                          056031
     C*/EJECT*****                                                        056031
     C***********UWMMCN    BEGSR                                          056031
     C*****************    *****                                          056031
     C***********                                                         056031
     C*****************************************************************   056031
     C***********       UW-CHAIN-MEMOS-FILE                           *   056031
     C***********                                                     *   056031
     C***FUNCTION : TO ATTEMPT TO ACCESS A REQUESTED RECORD FROM THE  *   056031
     C***********   MEMOS FILE.                                       *   056031
     C***********                                                     *   056031
     C***CALLS*:*   NONE                                              *   056031
     C***********                                                     *   056031
     C***CALLED*BY: GIRTUP                                            *   056031
     C***********                                                     *   056031
     C*****************************************************************   056031
     C***********                                                         056031
     C***********RRNM      CHAINMEMOS                89                   056031
     C***********                                                         056031
     C**N89******RECI      COMP 'D'                  8989                 056031
     C***********                                                         056031
     C****************     *****                                          056031
     C***********UWEND     ENDSR                                          056031
     C/EJECT
     C************************************************************
     C* CHARGE CONVERSION SUBROUTINE
     C************************************************************
     C*
     C           CHARGE    BEGSR
     C*                                                                   S01508
     C** If recalculation for extended payment is necessary, format       S01508
     C** the parameter for FT0320                                         S01508
     C*                                                                   S01508
     C           WRDFTC    IFEQ 'Y'                                       S01508
     C                     CLEARW7DATA                                    S01508
     C*                                                                   S01508
     C                     MOVELSPYTP     W7PYTP                          S01508
     C                     MOVELSPYST     W7PYST                          S01508
     C*                                                                   S01508
     C** Input currency and charge currency                               S01508
     C*                                                                   S01508
     C                     SELEC                                          S01508
     C           BTCHCY    WHEQ 'C'                                       S01508
     C           SADDC     IFEQ 'A'                                       S01508
     C                     MOVE SSMCY     W7ICCY                          S01508
     C                     ELSE                                           S01508
     C                     MOVE SPCCY     W7ICCY                          S01508
     C                     END                                            S01508
     C           BTCHCY    WHEQ 'L'                                       S01508
     C                     MOVE BJLCCY    W7ICCY                          S01508
     C                     OTHER                                          S01508
     C                     MOVE BJCYCD    W7ICCY                          S01508
     C                     ENDSL                                          S01508
     C*                                                                   S01508
     C           SADDC     IFEQ 'A'                                       S01508
     C                     MOVELSSMCY     W7CCCY                          S01508
     C                     ELSE                                           S01508
     C                     MOVELSPCCY     W7CCCY                          S01508
     C                     END                                            S01508
     C*                                                                   S01508
     C** Settlement method                                                S01508
     C*                                                                   S01508
     C                     MOVEL*BLANKS   W7STMT                          S01508
     C*                                                                   S01508
     C** Defaults required                                                S01508
     C*                                                                   S01508
     C                     MOVEL'Y'       W7DFRQ                          S01508
     C*                                                                   S01508
     C** Charges branch                                                   S01508
     C*                                                                   S01508
     C                     MOVELPYBR      W7BRCA                          S01508
     C*                                                                   S01508
     C** Charge currency amount                                           S01508
     C*                                                                   S01508
     C                     SELEC                                          S01508
     C*                                                                   S01508
     C           SADDC     WHEQ 'A'                                       S01508
     C                     Z-ADDSMAM      W7CAMT                          S01508
     C***13*****           Z-ADDWSMAM     W7CAMT                    095075100660
     C           SACTCD    IFEQ 'A'                                       100660
     C                     Z-ADDWSMAM     W7CAMT                          100660
     C                     ENDIF                                          100660
     C                     MOVELSSMCY     W7PCCY                          S01508
     C*                                                                   S01508
     C                     OTHER                                          S01508
     C                     Z-ADDPYAM      W7CAMT                          S01508
     C***13*****           Z-ADDWPYAM     W7CAMT                    095075100660
     C           SACTCD    IFEQ 'A'                                       100660
     C                     Z-ADDWPYAM     W7CAMT                          100660
     C                     ENDIF                                          100660
     C                     MOVELSPCCY     W7PCCY                          S01508
     C                     ENDSL                                          S01508
     C*                                                                   S01508
     C** Transfer Commission type                                         S01508
     C*                                                                   S01508
     C                     MOVELTRCT      W7TRCT                          S01508
     C*                                                                   S01508
     C** SWIFT priority code                                              S01508
     C*                                                                   S01508
     C           SWPC      IFEQ 1                                         S01508
     C                     MOVEL'U'       W7SWPC                          S01508
     C                     ELSE                                           S01508
     C                     MOVEL'N'       W7SWPC                          S01508
     C                     END                                            S01508
     C*                                                                   S01508
     C** Transfer Commission amount                                       S01508
     C*                                                                   S01508
     C                     Z-ADDDUMA1     W7TRCD                          S01508
     C                     Z-ADDTRCM      W7TRCH                          S01508
     C*                                                                   S01508
     C** Telex charge                                                     S01508
     C*                                                                   S01508
     C                     Z-ADDDUMA2     W7TXCD                          S01508
     C                     Z-ADDTXCH      W7TXCH                          S01508
     C*                                                                   S01508
     C** Cheque Charge                                                    S01508
     C*                                                                   S01508
     C                     Z-ADDDUMA3     W7CQCD                          S01508
     C                     Z-ADDCQCH      W7CQCH                          S01508
     C*                                                                   S01508
     C** Costs Abroad                                                     S01508
     C*                                                                   S01508
     C                     Z-ADD0         W7CSTD                          S01508
     C                     Z-ADD0         W7CSTA                          S01508
     C*                                                                   S01508
     C** SWIFT Priority Charge                                            S01508
     C*                                                                   S01508
     C                     Z-ADD0         W7SPCD                          S01508
     C                     Z-ADD0         W7SPCH                          S01508
     C*                                                                   S01508
     C** Miscellaneous charge                                             S01508
     C*                                                                   S01508
     C                     Z-ADDDUMA6     W7MSCD                          S01508
     C                     Z-ADDMSCH      W7MSCH                          S01508
     C*                                                                   S01494
     C** FX/Change Commission                                             S01494
     C*                                                                   S01494
     C           S01494    IFEQ 'Y'                                       S01494
     C                     Z-ADDINDUM7    W7CHCD                          S01494
     C                     Z-ADDINCHCM    W7CHCM                          S01494
     C                     END                                            S01494
     C*                                                                   S01508
     C** Advice Charge                                                    S01508
     C*                                                                   S01508
     C                     Z-ADDDUMA4     W7ADCD                          S01508
     C                     Z-ADDADCH      W7ADCH                          S01508
     C*                                                                   S01508
     C** Telephone Charge                                                 S01508
     C*                                                                   S01508
     C                     Z-ADDDUMA5     W7TLCD                          S01508
     C                     Z-ADDTLCH      W7TLCH                          S01508
     C*                                                                   S01508
     C** Collection Charge                                                S01508
     C*                                                                   S01508
     C                     Z-ADD0         W7COLD                          S01508
     C                     Z-ADD0         W7COLL                          S01508
     C*                                                                   S01508
     C                     MOVEL*BLANKS   W7ACT                           S01508
     C                     MOVEL'IN'      W7ACT                           S01508
     C*                                                                   S01508
     C**  Other currency                                                  S01508
     C*                                                                   S01508
     C           SADDC     IFEQ 'D'                                       S01508
     C                     MOVE SSMCY     W7OCCY                          S01508
     C                     ELSE                                           S01508
     C                     MOVE SPCCY     W7OCCY                          S01508
     C                     END                                            S01508
     C*                                                                   S01508
     C** Customer to be debited                                           S01508
     C*                                                                   S01508
     C                     MOVE WDCUS2    W7CUST                          S01508
     C/COPY WNCPYSRC,FT0050C076
     C*                                                                   S01508
     C** Call defaults program                                            S01508
     C*                                                                   S01508
     C                     CALL 'FT0320'               9090               S01508
     C                     PARM *BLANKS   W7RTN   7                       S01508
     C                     PARM           W7ACT   8                       S01508
     C                     PARM           W7DATA                          S01508
     C*                                                                   S01508
      ** Re-apply old charges if only settlement amount has changed       100660
     C           SPCCY     IFEQ PCCY                                      100660
     C           SSMCY     ANDEQSMCY                                      100660
     C           WRDFTC    ANDEQ'Y'                                       100660
     C           SACTCD    ANDEQ'A'                                       100660
     C                     Z-ADDDUMA2     W7TXCD                          100660
     C                     Z-ADDDUMA3     W7CQCD                          100660
     C                     Z-ADDDUMA4     W7ADCD                          100660
     C                     Z-ADDDUMA5     W7TLCD                          100660
     C                     Z-ADDDUMA6     W7MSCD                          100660
     C                     ENDIF                                          100660
      *                                                                   100660
     C           *IN90     IFEQ '1'                                       S01508
     C           W7RTN     ORNE *BLANKS                                   S01508
     C                     MOVEL'FT0320  'W0FILE           ***************S01508
     C                     MOVEL'*CALL   'W0KEY            * DB ERROR 23 *S01508
     C                     Z-ADD23        W0ERNB           ***************S01508
     C                     EXSR SRERR                                     S01508
     C                     END                                            S01508
     C*                                                                   S01508
     C** Transfer Commission amount                                       S01508
     C*                                                                   S01508
     C                     Z-ADDW7TRCD    DUMA1                           S01508
     C                     Z-ADDW7TRCH    TRCM                            S01508
     C*                                                                   S01508
     C** Telex charge                                                     S01508
     C*                                                                   S01508
     C                     Z-ADDW7TXCD    DUMA2                           S01508
     C                     Z-ADDW7TXCH    TXCH                            S01508
     C*                                                                   S01508
     C** Cheque Charge                                                    S01508
     C*                                                                   S01508
     C                     Z-ADDW7CQCD    DUMA3                           S01508
     C                     Z-ADDW7CQCH    CQCH                            S01508
     C*                                                                   S01508
     C** Advice charge                                                    S01508
     C*                                                                   S01508
     C/COPY WNCPYSRC,FT0050C187
     C                     Z-ADDW7ADCD    DUMA4                           S01508
     C                     Z-ADDW7ADCH    ADCH                            S01508
     C/COPY WNCPYSRC,FT0050C188
     C*                                                                   S01508
     C** Telephone Charge                                                 S01508
     C*                                                                   S01508
     C                     Z-ADDW7TLCD    DUMA5                           S01508
     C                     Z-ADDW7TLCH    TLCH                            S01508
     C*                                                                   S01508
     C** Miscellaneous charge                                             S01508
     C*                                                                   S01508
     C                     Z-ADDW7MSCD    DUMA6                           S01508
     C                     Z-ADDW7MSCH    MSCH                            S01508
     C*                                                                   S01494
     C** FX/Change Commission                                             S01494
     C*                                                                   S01494
     C           S01494    IFEQ 'Y'                                       S01494
     C                     Z-ADDW7CHCD    INDUM7                          S01494
     C                     Z-ADDW7CHCM    INCHCM                          S01494
     C                     END                                            S01494
     C*                                                                   S01508
     C                     END                                            S01508
     C*
     C* IF CHARGES TO THE DEBIT OF IS 0,USE PAY OR SETTLE
     C* BASED ON **FTCC** BTCHCY INDICATOR                                S01194
     C*
     C***********FTCC      IFEQ 'C'                        ** B001        S01194
     C           BTCHCY    IFEQ 'C'                        ** B001        S01194
     C*
     C           ADDC      IFEQ 'A'                        ** B002
     C                     MOVE SMCY      SCCCY   3
     C                     ELSE                            ** X002
     C                     MOVE PCCY      SCCCY
     C                     END                             ** E002
     C*
     C                     ELSE                            ** X001
     C*
     C***********FTCC      IFEQ 'L'                        ** B002        S01194
     C           BTCHCY    IFEQ 'L'                        ** B002        S01194
     C***********          MOVE LOCY      SCCCY                           S01194
     C                     MOVE BJLCCY    SCCCY                           S01194
     C                     ELSE                            ** X002
     C***********          MOVE BCCY      SCCCY                           S01194
     C                     MOVE BJCYCD    SCCCY                           S01194
     C                     END                             ** E002
     C*
     C                     END                             ** E001
     C*
     C* ONLY CONVERT IF ENTRY CHARGE CCY NOT BASE
     C*
     C***********SCCCY     IFNE BCCY                       ** B001        S01194
     C           SCCCY     IFNE BJCYCD                     ** B001        S01194
     C*
     C* ACCESS DETAILS OF FILE CHARGE CCY FOR CHARGE CALCULATIONS
     C*
     C                     CALL 'AOCURRR0'                                S01194
     C                     PARM '*DBERR ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM SCCCY     @CCY    3                       S01194
     C           SDCURR    PARM SDCURR    DSSDY                           S01194
     C                     EXSR MVCURR                                    S01194
     C*                                                                   S01194
     C***********          MOVEL'20      'TABKEY 12                       S01194
     C***********          MOVE '1'       WK4     4                       S01194
     C***********          MOVELSCCCY     WK4                             S01194
     C***********          MOVE WK4       TABKEY                          S01194
     C***********TABKEY    CHAINTABTG10F             80                   S01194
     C**N80******RECI      COMP 'D'                  8080                 S01194
     C************IN80     IFEQ '1'                        ** B002        S01194
     C***********          MOVE 'TABTG10' WDBFIL           ************   S01194
     C***********          MOVELTABKEY    WDBKEY           * DB ERROR 60  S01194
     C***********          MOVEL'60'      WDBASE           ************   S01194
     C***********          EXSR UEABRT                                 ** S01194
     C***********          END                             ** E002        S01194
     C* N IS DIFFERENCE BETWEEN DECIMALS FOR BASE AND DECIMALS FOR FILE
     C* CURRENCY - FOLLOWING CALCS FIND TRUE RATE(TSPOT)TO CONVERT FILE
     C* CURRENCY TO BASE
     C*
     C***********BCDP      SUB  CDP       N       10                      S01194
     C           BCDP      SUB  A6NBDP    N       10                      S01194
     C           MDIN      IFEQ 1                          ** B002
     C           N         IFGT 0                          ** B003
     C***********SPOT      MULT POWERS,N  TSPOT  159                      S01194
     C           A6SPRT    MULT POWERS,N  TSPOT  159                      S01194
     C                     ELSE                            ** X003
     C           N         IFLT 0                          ** B004
     C                     Z-SUBN         N
     C***********SPOT      DIV  POWERS,N  TSPOT                           S01194
     C           A6SPRT    DIV  POWERS,N  TSPOT                           S01194
     C                     ELSE                            ** X004
     C***********          Z-ADDSPOT      TSPOT                           S01194
     C                     Z-ADDA6SPRT    TSPOT                           S01194
     C                     END                             ** E004
     C                     END                             ** E003
     C                     END                             ** E002
     C           MDIN      IFEQ 0                          ** B002
     C           N         IFGT 0                          ** B003
     C***********SPOT      DIV  POWERS,N  TSPOT                           S01194
     C           A6SPRT    DIV  POWERS,N  TSPOT                           S01194
     C                     ELSE                            ** X003
     C           N         IFLT 0                          ** B004
     C                     Z-SUBN         N
     C***********SPOT      MULT POWERS,N  TSPOT                           S01194
     C           A6SPRT    MULT POWERS,N  TSPOT                           S01194
     C                     ELSE                            ** X004
     C***********          Z-ADDSPOT      TSPOT                           S01194
     C                     Z-ADDA6SPRT    TSPOT                           S01194
     C                     END                             ** E004
     C                     END                             ** E003
     C                     END                             ** E002
     C*
     C* NOW USE RATE TO CALCULATE VALUE FOR AMENDMENT IN BASE
     C*
     C           MDIN      IFEQ 1                          ** B002
     C* TRANSFER COMMISSION
     C           DUMA1     MULT TSPOT     TRCMB  110H       S01178
     C* TELEX CHARGE
     C           DUMA2     MULT TSPOT     TXCHB  110H
     C* CHEQUE CHARGE
     C           DUMA3     MULT TSPOT     CQCHB  110H
     C* ADVICE CHARGE
     C           DUMA4     MULT TSPOT     ADCHB  110H
     C* TELEPHONE CHARGE
     C           DUMA5     MULT TSPOT     TLCHB  110H
     C* MISCELLANEOUS CHARGE
     C           DUMA6     MULT TSPOT     MSCHB  110H
     C*                                                                   S01494
     C** FX/Change commission                                             S01494
     C*                                                                   S01494
     C           S01494    IFEQ 'Y'                                       S01494
     C           INDUM7    MULT TSPOT     CHCMB  110H                     S01494
     C                     END                                            S01494
     C                     END                             ** E002
     C*
     C           MDIN      IFEQ 0                          ** B002
     C* TRANSFER COMMISSION
     C           DUMA1     DIV  TSPOT     TRCMB     H
     C* TELEX CHARGE
     C           DUMA2     DIV  TSPOT     TXCHB     H
     C* CHEQUE CHARGE
     C           DUMA3     DIV  TSPOT     CQCHB     H
     C* ADVICE CHARGE
     C           DUMA4     DIV  TSPOT     ADCHB     H
     C* TELEPHONE CHARGE
     C           DUMA5     DIV  TSPOT     TLCHB     H
     C* MISCELLANEOUS CHARGE
     C           DUMA6     DIV  TSPOT     MSCHB     H
     C*                                                                   S01494
     C** FX/Change commission                                             S01494
     C*                                                                   S01494
     C           S01494    IFEQ 'Y'                                       S01494
     C           INDUM7    DIV  TSPOT     CHCMB     H                     S01494
     C                     END                                            S01494
     C                     END                             ** E002
     C*
     C                     ELSE                            ** X001
     C                     Z-ADDDUMA1     TRCMB
     C                     Z-ADDDUMA2     TXCHB
     C                     Z-ADDDUMA3     CQCHB
     C                     Z-ADDDUMA4     ADCHB
     C                     Z-ADDDUMA5     TLCHB
     C                     Z-ADDDUMA6     MSCHB
     C*                                                                   S01494
     C           S01494    IFEQ 'Y'                                       S01494
     C                     Z-ADDINDUM7    CHCMB                           S01494
     C                     END                                            S01494
     C                     END                             ** E001
     C*
     C           SADDC     IFEQ 'A'                        ** B001
     C                     MOVE SSMCY     SCCCY
     C                     ELSE                            ** X001
     C                     MOVE SPCCY     SCCCY
     C                     END                             ** E001
     C*
     C* ONLY CONVERT IF NEW CHARGE CCY NOT BASE
     C*
     C***********SCCCY     IFNE BCCY                       ** B001        S01194
     C           SCCCY     IFNE BJCYCD                     ** B001        S01194
     C*
     C***********          MOVEL'20      'TABKEY 12                       S01194
     C***********          MOVE '1'       WK4     4                       S01194
     C***********          MOVELSCCCY     WK4                             S01194
     C***********          MOVE WK4       TABKEY                          S01194
     C***********TABKEY    CHAINTABTG10F             80                   S01194
     C**N80******RECI      COMP 'D'                  8080                 S01194
     C************IN80     IFEQ '1'                        ** B002        S01194
     C***********          MOVE 'TABTG10' WDBFIL           ************   S01194
     C***********          MOVELTABKEY    WDBKEY           * DB ERROR 61  S01194
     C***********          MOVEL'61'      WDBASE           ************   S01194
     C***********          EXSR UEABRT                                 ** S01194
     C***********          END                             ** E002        S01194
     C*                                                                   S01194
     C                     CALL 'AOCURRR0'                                S01194
     C                     PARM '*DBERR ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM SCCCY     @CCY    3                       S01194
     C           SDCURR    PARM SDCURR    DSSDY                           S01194
     C                     EXSR MVCURR                                    S01194
     C*                                                                   S01194
     C* N IS DIFFERENCE BETWEEN DECIMALS FOR BASE AND DECIMALS FOR
     C* CHARGE CURRENCY - FOLLOWING CALCS FIND TRUE RATE(TSPOT)TO
     C* CONVERT BASE CURRENCY BACK TO NEW CHARGE CCY
     C*
     C***********CDP       SUB  BCDP      N       10                      S01194
     C           A6NBDP    SUB  BCDP      N       10                      S01194
     C           MDIN      IFEQ 1                          ** B002
     C           N         IFGT 0                          ** B003
     C***********SPOT      DIV  POWERS,N  TSPOT  159                      S01194
     C           A6SPRT    DIV  POWERS,N  TSPOT  159                      S01194
     C                     ELSE                            ** X003
     C           N         IFLT 0                          ** B004
     C                     Z-SUBN         N
     C***********SPOT      MULT POWERS,N  TSPOT                           S01194
     C           A6SPRT    MULT POWERS,N  TSPOT                           S01194
     C                     ELSE                            ** X004
     C***********          Z-ADDSPOT      TSPOT                           S01194
     C                     Z-ADDA6SPRT    TSPOT                           S01194
     C                     END                             ** E004
     C                     END                             ** E003
     C                     END                             ** E002
     C           MDIN      IFEQ 0                          ** B002
     C           N         IFGT 0                          ** B003
     C***********SPOT      MULT POWERS,N  TSPOT                           S01194
     C           A6SPRT    MULT POWERS,N  TSPOT                           S01194
     C                     ELSE                            ** X003
     C           N         IFLT 0                          ** B004
     C                     Z-SUBN         N
     C***********SPOT      DIV  POWERS,N  TSPOT                           S01194
     C           A6SPRT    DIV  POWERS,N  TSPOT                           S01194
     C                     ELSE                            ** X004
     C***********          Z-ADDSPOT      TSPOT                           S01194
     C                     Z-ADDA6SPRT    TSPOT                           S01194
     C                     END                             ** E004
     C                     END                             ** E003
     C                     END                             ** E002
     C*
     C* NOW USE RATE TO CALCULATE NEW CHARGE VALUES
     C*
     C           MDIN      IFEQ 1                          ** B002
     C* TRANSFER COMMISSION
     C           TRCMB     DIV  TSPOT     TRCM      H
     C* TELEX CHARGE
     C           TXCHB     DIV  TSPOT     TXCH      H
     C* CHEQUE CHARGE
     C           CQCHB     DIV  TSPOT     CQCH      H
     C* ADVICE CHARGE
     C           ADCHB     DIV  TSPOT     ADCH      H
     C* TELEPHONE CHARGE
     C           TLCHB     DIV  TSPOT     TLCH      H
     C* MISCELLANEOUS CHARGE
     C           MSCHB     DIV  TSPOT     MSCH      H
     C*                                                                   S01494
     C** FX/Change commission                                             S01494
     C*                                                                   S01494
     C           S01494    IFEQ 'Y'                                       S01494
     C           CHCMB     DIV  TSPOT     INCHCM    H                     S01494
     C                     END                                            S01494
     C                     END                             ** E002
     C*
     C           MDIN      IFEQ 0                          ** B002
     C* TRANSFER COMMISSION
     C           TRCMB     MULT TSPOT     TRCM      H
     C* TELEX CHARGE
     C           TXCHB     MULT TSPOT     TXCH      H
     C* CHEQUE CHARGE
     C           CQCHB     MULT TSPOT     CQCH      H
     C* ADVICE CHARGE
     C           ADCHB     MULT TSPOT     ADCH      H
     C* TELEPHONE CHARGE
     C           TLCHB     MULT TSPOT     TLCH      H
     C* MISCELLANEOUS CHARGE
     C           MSCHB     MULT TSPOT     MSCH      H
     C*                                                                   S01494
     C** FX/Change commission                                             S01494
     C*                                                                   S01494
     C           S01494    IFEQ 'Y'                                       S01494
     C           CHCMB     MULT TSPOT     INCHCM    H                     S01494
     C                     END                                            S01494
     C                     END                             ** E002
     C*
     C                     ELSE                            ** X001
     C                     Z-ADDTRCMB     TRCM
     C                     Z-ADDTXCHB     TXCH
     C                     Z-ADDCQCHB     CQCH
     C                     Z-ADDADCHB     ADCH
     C                     Z-ADDTLCHB     TLCH
     C                     Z-ADDMSCHB     MSCH
     C*                                                                   S01494
     C           S01494    IFEQ 'Y'                                       S01494
     C                     Z-ADDCHCMB     INCHCM                          S01494
     C                     END                                            S01494
     C                     END                             ** E001
     C*
     C* FILE DAF FORMAT(NOT LIKE REAL DAF)
     C*
     C***********SCCCY     IFNE BCCY                       ** B001        S01194
     C***********          Z-ADDCDP       FCDP                            S01194
     C           SCCCY     IFNE BJCYCD                     ** B001        S01194
     C                     Z-ADDA6NBDP    FCDP                            S01194
     C                     ELSE                            ** X001
     C                     Z-ADDBCDP      FCDP
     C                     END                             ** E001
     C*
     C* TRANSFER COMMISSION
     C           FCDP      ADD  1         W       10
     C           TRCM      DIV  FCTR,W    TRCMD
     C* TELEX CHARGE
     C           FCDP      ADD  1         W
     C           TXCH      DIV  FCTR,W    TXCHD
     C* CHEQUE CHARGE
     C           FCDP      ADD  1         W
     C           CQCH      DIV  FCTR,W    CQCHD
     C* ADVICE CHARGE
     C           FCDP      ADD  1         W
     C           ADCH      DIV  FCTR,W    ADCHD
     C* TELEPHONE CHARGE
     C           FCDP      ADD  1         W
     C           TLCH      DIV  FCTR,W    TLCHD
     C* MISCELLANEOUS CHARGE
     C           FCDP      ADD  1         W
     C           MSCH      DIV  FCTR,W    MSCHD
     C*
     C***********FTCC      IFEQ 'C'                        B001           S01194
     C           BTCHCY    IFEQ 'C'                        B001           S01194
     C*
     C* OR,IF **FTCC** BTCHCY IS SET TO 'B' FOR BASE CURRENCY,AND DEFAULT S01194
     C* CHARGE CCY IS BASE
     C*
     C***********FTCC      OREQ 'B'                                       S01194
     C***********SCCCY     ANDEQBCCY                                      S01194
     C           BTCHCY    OREQ 'B'                                       S01194
     C           SCCCY     ANDEQBJCYCD                                    S01194
     C*                                                                   S01194
     C* OR,IF **FTCC** BTCHCY IS SET TO 'L' FOR LOCAL CURRENCY,AND LOCAL  S01194
     C* IS THE SAME CCY AS BASE,AND DEFAULT CCY IS BASE                   S01194
     C*                                                                   S01194
     C***********FTCC      OREQ 'L'                                       S01194
     C***********BCCY      ANDEQLOCY                                      S01194
     C***********SCCCY     ANDEQBCCY                                      S01194
     C           BTCHCY    OREQ 'L'                                       S01194
     C           BJCYCD    ANDEQBJLCCY                                    S01194
     C           SCCCY     ANDEQBJCYCD                                    S01194
     C*                                                                   S01194
     C* OR,IF **FTCC** BTCHY IS SET TO 'L' FOR LOCAL CURRENCY,AND DEFAULT S01194
     C* CHARGE CURRENCY IS THE SAME AS LOCAL CCY                          S01194
     C*                                                                   S01194
     C***********FTCC      OREQ 'L'                                       S01194
     C***********SCCCY     ANDEQLOCY                                      S01194
     C           BTCHCY    OREQ 'L'                                       S01194
     C           SCCCY     ANDEQBJLCCY                                    S01194
     C*
     C                     Z-ADDTRCM      DUMA1
     C                     Z-ADDTXCH      DUMA2
     C                     Z-ADDCQCH      DUMA3
     C                     Z-ADDADCH      DUMA4
     C                     Z-ADDTLCH      DUMA5
     C                     Z-ADDMSCH      DUMA6
     C*                                                                   S01494
     C           S01494    IFEQ 'Y'                                       S01494
     C                     Z-ADDINCHCM    INDUM7                          S01494
     C                     END                                            S01494
     C*
     C                     ELSE                            X001
     C*
     C* INPUT CAPABLE CHARGE FIELD MAY BE BASE
     C* WITH RIGHT HAND SIDE NOT BASE - HERE USE BASE COMMISSION
     C* CHARGE ALREADY CALCULATED
     C*
     C***********FTCC      IFEQ 'B'                        B002           S01194
     C***********SCCCY     ANDNEBCCY                                      S01194
     C           BTCHCY    IFEQ 'B'                        B002           S01194
     C           SCCCY     ANDNEBJCYCD                                    S01194
     C*
     C***********FTCC      OREQ 'L'                                       S01194
     C***********LOCY      ANDEQBCCY                                      S01194
     C           BTCHCY    OREQ 'L'                                       S01194
     C           BJLCCY    ANDEQBJCYCD                                    S01194
     C*
     C                     Z-ADDTRCMB     DUMA1
     C                     Z-ADDTXCHB     DUMA2
     C                     Z-ADDCQCHB     DUMA3
     C                     Z-ADDADCHB     DUMA4
     C                     Z-ADDTLCHB     DUMA5
     C                     Z-ADDMSCHB     DUMA6
     C*                                                                   S01494
     C           S01494    IFEQ 'Y'                                       S01494
     C                     Z-ADDINCHCM    INDUM7                          S01494
     C                     END                                            S01494
     C*
     C                     ELSE                            X002
     C*
     C                     Z-ADDTRCMB     AMNTB  110
     C                     EXSR CHGLT
     C                     MOVE AMNTE     DUMA1
     C*
     C                     Z-ADDTXCHB     AMNTB
     C                     EXSR CHGLT
     C                     MOVE AMNTE     DUMA2
     C*
     C                     Z-ADDCQCHB     AMNTB
     C                     EXSR CHGLT
     C                     MOVE AMNTE     DUMA3
     C*
     C                     Z-ADDADCHB     AMNTB
     C                     EXSR CHGLT
     C                     MOVE AMNTE     DUMA4
     C*
     C                     Z-ADDTLCHB     AMNTB
     C                     EXSR CHGLT
     C                     MOVE AMNTE     DUMA5
     C*
     C                     Z-ADDMSCHB     AMNTB
     C                     EXSR CHGLT
     C                     MOVE AMNTE     DUMA6
     C*                                                                   S01494
     C           S01494    IFEQ 'Y'                                       S01494
     C                     Z-ADDCHCMB     AMNTB                           S01494
     C                     EXSR CHGLT                                     S01494
     C                     MOVE AMNTE     INDUM7                          S01494
     C                     END                                            S01494
     C*
     C                     END                             E002
     C*
     C                     END                             E001
     C*                                                                   S01499
     C** If S01499 is active, calculate V.A.T. charges                    S01499
     C*                                                                   S01499
     C           S01499    IFEQ 'Y'                                       S01499
     C                     Z-ADDWVATR     INVATR                          S01499
     C                     MOVE *ZEROS    INDUM8                          S01499
     C                     MOVE *ZEROS    INVATT                          S01499
     C*                                                                   S01499
     C** .... Transfer commission                                         S01499
     C*                                                                   S01499
     C           INVAT1    IFEQ 'Y'                                       S01499
     C           DUMA1     MULT WVATR     WVATE  130H                     S01499
     C           TRCM      MULT WVATR     WVATC  130H                     S01499
     C                     ADD  WVATE     INDUM8                          S01499
     C                     ADD  WVATC     INVATT                          S01499
     C                     END                                            S01499
     C*                                                                   S01499
     C** .... Telex                                                       S01499
     C*                                                                   S01499
     C           INVAT2    IFEQ 'Y'                                       S01499
     C           DUMA2     MULT WVATR     WVATE     H                     S01499
     C           TXCH      MULT WVATR     WVATC     H                     S01499
     C                     ADD  WVATE     INDUM8                          S01499
     C                     ADD  WVATC     INVATT                          S01499
     C                     END                                            S01499
     C*                                                                   S01499
     C** .... Cheque                                                      S01499
     C*                                                                   S01499
     C           INVAT3    IFEQ 'Y'                                       S01499
     C           DUMA3     MULT WVATR     WVATE     H                     S01499
     C           CQCH      MULT WVATR     WVATC     H                     S01499
     C                     ADD  WVATE     INDUM8                          S01499
     C                     ADD  WVATC     INVATT                          S01499
     C                     END                                            S01499
     C*                                                                   S01499
     C** .... Advice                                                      S01499
     C*                                                                   S01499
     C           INVAT4    IFEQ 'Y'                                       S01499
     C           DUMA4     MULT WVATR     WVATE     H                     S01499
     C           ADCH      MULT WVATR     WVATC     H                     S01499
     C                     ADD  WVATE     INDUM8                          S01499
     C                     ADD  WVATC     INVATT                          S01499
     C                     END                                            S01499
     C*                                                                   S01499
     C** .... Telephone                                                   S01499
     C*                                                                   S01499
     C           INVAT5    IFEQ 'Y'                                       S01499
     C           DUMA5     MULT WVATR     WVATE     H                     S01499
     C           TLCH      MULT WVATR     WVATC     H                     S01499
     C                     ADD  WVATE     INDUM8                          S01499
     C                     ADD  WVATC     INVATT                          S01499
     C                     END                                            S01499
     C*                                                                   S01499
     C** .... Miscellaneous                                               S01499
     C*                                                                   S01499
     C           INVAT6    IFEQ 'Y'                                       S01499
     C           DUMA6     MULT WVATR     WVATE     H                     S01499
     C           MSCH      MULT WVATR     WVATC     H                     S01499
     C                     ADD  WVATE     INDUM8                          S01499
     C                     ADD  WVATC     INVATT                          S01499
     C                     END                                            S01499
     C*                                                                   S01499
     C** .... FX/Change commission                                        S01499
     C*                                                                   S01499
     C           INVAT7    IFEQ 'Y'                                       S01499
     C           S01494    ANDEQ'Y'                                       S01499
     C           INDUM7    MULT WVATR     WVATE     H                     S01499
     C           INCHCM    MULT WVATR     WVATC     H                     S01499
     C                     ADD  WVATE     INDUM8                          S01499
     C                     ADD  WVATC     INVATT                          S01499
     C                     END                                            S01499
     C*                                                                   S01499
     C                     END                                            S01499
     C*
     C                     ENDSR
     C*
     C************************************************************
     C* END OF CHARGES SUBROUTINE
     C************************************************************
     C*/EJECT
     C************************************************************
     C*  CHGLT SUBROUTINE TO CONVERT FOR LOCY AMOUNTS
     C************************************************************
     C           CHGLT     BEGSR
     C*
     C***********          MOVEL'20      'TABKEY 12                       S01194
     C***********          MOVE '1'       WK4     4                       S01194
     C***********          MOVELLOCY      WK4                             S01194
     C***********          MOVE WK4       TABKEY                          S01194
     C***********TABKEY    CHAINTABTG10F             80                   S01194
     C**N80******RECI      COMP 'D'                  8080                 S01194
     C************IN80     IFEQ '1'                        ** B001        S01194
     C***********          MOVE 'TABTG10' WDBFIL           ************   S01194
     C***********          MOVELTABKEY    WDBKEY           * DBERR 23     S01194
     C***********          MOVEL'23'      WDBASE           ************   S01194
     C***********          EXSR UEABRT                                 ** S01194
     C***********          END                             ** E001        S01194
     C*                                                                   S01194
     C                     CALL 'AOCURRR0'                                S01194
     C                     PARM '*DBERR ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM BJLCCY    @CCY    3                       S01194
     C           SDCURR    PARM SDCURR    DSSDY                           S01194
     C                     EXSR MVCURR                                    S01194
     C*                                                                   S01194
     C***********          Z-ADDCDP       LCDP    10                      S01194
     C                     Z-ADDA6NBDP    LCDP    10                      S01194
     C                     Z-ADDMDIN      LMDIN   10
     C***********          Z-ADDSPOT      LSPOT  138                      S01194
     C                     Z-ADDA6SPRT    LSPOT  138                      S01194
     C*
     C* H IS DIFFERENCE BETWEEN DECIMALS FOR BASE AND DECIMALS FOR
     C* LOCAL CURRENCY - FOLLOWING CALCS FIND TRUE RATE(LSPOT)TO
     C* CONVERT BASE CURRENCY TO LOCAL
     C*
     C           LCDP      SUB  BCDP      H       10
     C           LMDIN     IFEQ 1                          ** B001
     C           H         IFGT 0                          ** B002
     C           LSPOT     DIV  POWERS,H  TSPOT  159
     C                     ELSE                            ** X002
     C           H         IFLT 0                          ** B003
     C                     Z-SUBH         H
     C           LSPOT     MULT POWERS,H  TSPOT
     C                     ELSE                            ** X003
     C                     Z-ADDLSPOT     TSPOT
     C                     END                             ** E003
     C                     END                             ** E002
     C                     END                             ** E001
     C           LMDIN     IFEQ 0                          ** B001
     C           H         IFGT 0                          ** B002
     C           LSPOT     MULT POWERS,H  TSPOT
     C                     ELSE                            ** X002
     C           H         IFLT 0                          ** B003
     C                     Z-SUBH         H
     C           LSPOT     DIV  POWERS,H  TSPOT
     C                     ELSE                            ** X003
     C                     Z-ADDLSPOT     TSPOT
     C                     END                             ** E003
     C                     END                             ** E002
     C                     END                             ** E001
     C*
     C* NOW USE RATE TO CALCULATE DEFAULT VALUE IN LOCAL CURRENCY
     C*
     C           LMDIN     IFEQ 1                          ** B001
     C* TRANSFER COMMISSION
     C           AMNTB     DIV  TSPOT     AMNTE  110H
     C                     END                             ** E001
     C*
     C           LMDIN     IFEQ 0                          ** B001
     C* TRANSFER COMMISSION
     C           AMNTB     MULT TSPOT     AMNTE  110H
     C                     END                             ** E001
      *
     C                     ENDSR
     C*          *****     *****
     C************************************************************
     C/EJECT
     C*****************************************************************   S01435
     C***********       SEARCH                                        *   S01435
     C***********                                                     *   S01435
     C***FUNCTION : TO CALL QCASCAN TO SEARCH SWIFT MESSAGES FOR THE  *   S01435
     C***********   DETAILS.                                          *   S01435
     C***********                                                     *   S01435
     C***CALLS*:*   NONE                                              *   S01435
     C***********                                                     *   S01435
     C***CALLED*BY: EISWFT                                            *   S01435
     C***********                                                     *   S01435
     C*****************************************************************   S01435
     C***********SEARCH    BEGSR                                          S01435
     C*****************    *****                                          S01435
     C***********                                                         S01435
     C***********                                                         S01435
     C**LOAD*STRING TO BE SEARCHED                                        S01435
     C***********          MOVE *BLANK    ARA                             S01435
     C***********SPOS      IFGT 1792                                E29837S01435
     C***********          SUB  1536      SPOS                      E29837S01435
     C***********          ADD  6         S                         E29837S01435
     C***********          ELSE                                     E29837S01435
     C***********SPOS      IFGT 1280                                E29837S01435
     C***********          SUB  1024      SPOS                      E29837S01435
     C***********          ADD  4         S                         E29837S01435
     C***********          ELSE                                     E29837S01435
     C***********SPOS      IFGT 768                                 E29837S01435
     C***********          SUB  512       SPOS                      E29837S01435
     C***********          ADD  2         S                         E29837S01435
     C***********          END                                      E29837S01435
     C***********          END                                      E29837S01435
     C***********          END                                      E29837S01435
     C***********          MOVEASDT,S     ARA,1                           S01435
     C***********          ADD  1         S                               S01435
     C**IF*MORE*DATA LOAD                                                 S01435
     C***********S         IFLE 10                         B001           S01435
     C***********SDT,S     ANDNE*BLANK                                    S01435
     C***********          Z-ADD257       L       30                      S01435
     C***********          MOVEASDT,S     ARA,L                           S01435
     C***********          ADD  1         S                               S01435
     C**IF*MORE*DATA LOAD                                                 S01435
     C***********S         IFLE 10                         B002           S01435
     C***********SDT,S     ANDNE*BLANK                                    S01435
     C***********          Z-ADD513       L       30                      S01435
     C***********          MOVEASDT,S     ARA,L                           S01435
     C***********          END                             E002           S01435
     C***********          SUB  1         S                               S01435
     C***********          END                             E001           S01435
     C*********************Z-ADD768       SLEN    30                      E29837
     C*********************Z-ADD1         SPOS    30                      E29837
     C***********          MOVE ' '       TRNS    1                       S01435
     C***********          MOVE ' '       TRIM    1                       S01435
     C***********          MOVEA*BLANK    AR                        E29837S01435
     C***********SPOS      IFNE 1                                   E29837S01435
     C***********          Z-ADDSPOS      L                         E29837S01435
     C***********          MOVEAARA,L     AR,1                      E29837S01435
     C***********          MOVEA*BLANK    ARA                       E29837S01435
     C***********          MOVEAAR,1      ARA,1                     E29837S01435
     C***********          Z-ADD1         SPOS                      E29837S01435
     C***********          END                                      E29837S01435
     C**CALL*IBM*SUPPLIED SEARCH PROGRAM                                  S01435
     C***********          CALL 'QCLSCAN'                                 S01435
     C***********          PARM           ARA                             S01435
     C***********          PARM           SLEN                            S01435
     C***********          PARM           SPOS                            S01435
     C***********          PARM           PATT                            S01435
     C***********          PARM           PLEN                            S01435
     C***********          PARM           TRNS                            S01435
     C***********          PARM           TRIM                            S01435
     C***********          PARM           WILD                            S01435
     C***********          PARM           R                               S01435
     C**IF*NO*MORE DATA SET SUBSCRIPT TO EXIT SUBROUTINE                  S01435
     C***********SDT,S     IFEQ *BLANK                     B001           S01435
     C***********          Z-ADD8         S                               S01435
     C***********          END                             E001           S01435
     C**IF*FOUND*IN LAST THIRD REORGANISE AS MAY NOT HAVE WHOLE DATA      S01435
     C***********R         IFGT 512                        B001           S01435
     C***********          SUB  512       R                               S01435
     C***********          ADD  1         S                               S01435
     C***********          MOVEASDT,S     ARA,1                           S01435
     C***********          ADD  1         S                               S01435
     C***********S         IFLE 10                         B002           S01435
     C***********SDT,S     ANDNE*BLANK                                    S01435
     C***********          Z-ADD257       L       30                      S01435
     C***********          MOVEASDT,S     ARA,L                           S01435
     C***********          ADD  1         S                               S01435
     C***********S         IFLE 10                         B003           S01435
     C***********SDT,S     ANDNE*BLANK                                    S01435
     C***********          Z-ADD513       L                               S01435
     C***********          MOVEASDT,S     ARA,L                           S01435
     C***********          END                             E003           S01435
     C***********          SUB  1         S                               S01435
     C***********          END                             E002           S01435
     C***********          END                             E001           S01435
     C***********                                                         S01435
     C****************     *****                                          S01435
     C***********          ENDSR                                          S01435
     C****************     *****                                          S01435
     C***********                                                         S01435
     C/EJECT
     C/COPY FTCPYSRC,SFTSWFTC                                             068230
      **************                                                      068230
      ************** Use FT standard processing                           068230
      **************                                                      068230
      **************                                                      068230
     C*****************************************************************   068230
     C**************                                                      068230
     C****FUNCTION:* TO VALIDATE SWIFT ADDRESS ALLOWABLE CHARACTERS       068230
     C************** ARE A-Z, 0-9                                         068230
     C**************                                                      068230
     C****CALLS:**** NONE                                                 068230
     C**************                                                      068230
     C**************                                                      068230
     C***********SWIFT     BEGSR                                          068230
     C***********-----                                                    068230
     C**************       SETOF                     89                   068230
     C**************       Z-ADD1         Z       20                      068230
     C**************                                                      068230
     C***********TEST POSITIONS 1-8                                       068230
     C**************                                                      068230
     C***********Z**       DOUEQ9                                         068230
     C************IN89     ORNE '1'                                       068230
     C***********SW,Z      LOKUPSWCH                     89               068230
     C**N89*********       GOTO EXITSW                                    068230
     C**************       ADD  1         Z                               068230
     C**************       END                                            068230
     C**************                                                      068230
     C***********TEST POSITIONS 10-12                                     068230
     C**************                                                      068230
     C************IN89     IFEQ '1'                                       068230
     C**************       Z-ADD10        Z                               068230
     C***********Z**       DOUEQ13                                        068230
     C************IN89     ORNE '1'                                       068230
     C***********SW,Z      LOKUPSWCH                     89               068230
     C**N89*********       GOTO EXITSW                                    068230
     C**************       ADD  1         Z                               068230
     C**************       END                                            068230
     C**************       END                                            068230
     C**************                                                      068230
     C**************                                                      068230
     C***First*12*characters should be key for CLSWT.                     068230
     C**************       MOVELSBNC1     CSID                            068230
     C***********CSID      SETLLCLSWT                    89               S01194
     C***********CSID      SETLLSDCUSTL7                 89         S01194068230
     C***89******CSID      COMP *BLANK               8989           S01194068230
     C**************                                                      068230
     C***********EXITSW    ENDSR                                          068230
     C*
     C/EJECT                                                              S01117
     C*****************************************************************   S01117
     C**                                                                  S01117
     C**  FUNCTION:  TO ACCESS PYCHGDB FILE                               S01117
     C**                                                                  S01117
     C**  CALLS:     NONE                                                 S01117
     C**                                                                  S01117
     C**                                                                  S01117
     C           PYCHRG    BEGSR                                          S01117
     C*          -----                                                    S01117
     C*                                                                   S01117
     C** IF SINGLE BRANCH MODE, USE SINGLE BRANCH CODE FROM SDBANKPD      S01117
     C*                                                                   S01117
     C           *IN10     IFNE '1'                                       S01117
     C                     MOVE BJSBRC    PYBR    3                       S01117
     C                     ELSE                                           S01117
     C*                                                                   S01117
     C** ELSE MULTIBRANCHING -                                            S01117
     C** TAKE ORIGINATING BRANCH IF USED, OTHERWISE TAKE BOOKING BRANCH   S01117
     C*                                                                   S01117
     C           *IN11     IFEQ '1'                                       S01117
     C                     MOVE SORBR     PYBR                            S01117
     C                     ELSE                                           S01117
     C                     MOVE SBRCA     PYBR                            S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C                     SETOF                     84                   133420
     C*                                                                   S01117
     C           PYBR      CHAINPYCHGDB              99    Get defaults.  S01117
     C*                                                                   079909
     C** Error if payment/charges record not found for branch             079909
     C           *IN99     IFEQ '1'                                       S01117
     C           CFT009    ANDEQ'N'                                       CFT009
     C*                                                                   S01117
     C** NO RECORD FOUND                                                  S01117
     C*                                                                   S01117
     C**  Set on general error indicator                                  079909
     C                     SETON                     75                   079909
     C                     SETON                     84                   133420
     C*                                                                   079909
     C** If multi branch, highlight originating branch or booking branch  079909
     C           BGMBIN    IFEQ 'Y'                                       079909
     C           BKOBRU    ANDEQ'Y'                                       079909
     C                     SETON                     14                   079909
     C                     ELSE                                           079909
     C                     SETON                     12                   079909
     C                     END                                            079909
     C*                                                                   079909
     C** Send error message to screen                                     079909
     C                     MOVELPYBR      FTMSDT                          079909
     C                     MOVEL'FTM2001' FTMSID                          079909
     C                     EXSR FTSNMS                                    079909
     C************         MOVEL'PYCHG'   WDBFIL                    S01117079909
     C************         MOVEL'1'       WDBKEY                    S01117079909
     C************         MOVEL'50'      WDBASE                    S01117079909
     C************         EXSR UEABRT                  *ABORT PGM* S01117079909
     C*                                                                   S01117
     C************         ELSE                            Else*IN99S01117079909
     C                     ELSE                                           094824
     C*                                                                   S01117
     C* ZEROISE DFLT CHEQUE CHARGE SO IT DOES NOT WRITE TO FILE           S01117
     C*                                                                   S01117
     C           CFT009    IFEQ 'N'                                       CFT009
     C                     Z-ADD0         CQCH                            S01117
     C                     ENDIF                                          CFT009
     C*                                                                   S01117
     C** Convert rate % discrepancy to higher & lower rate margins.       S01117
     C           1         ADD  RATDIS    UPMARG  74                      S01117
     C           1         SUB  RATDIS    LWMARG  74                      S01117
     C*                                                                   S01117
     C** End *IN99 ifeq '1'                                               S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     ENDSR                                          S01117
     C*                                                                   S01194
     C*****************************************************************   S01194
     C**                                                                  S01194
     C**  FUNCTION:  TO MOVE NEW SYNON FIELD NAMES IN SDCURRPD            S01194
     C**             BACK INTO OLD FIELDS                                 S01194
     C**                                                                  S01194
     C**  CALLS:     NONE                                                 S01194
     C**                                                                  S01194
     C**                                                                  S01194
     C           MVCURR    BEGSR                                          S01194
     C*          -----                                                    S01194
     C           A6MDIN    IFEQ 'M'                                       S01194
     C                     Z-ADD1         MDIN                            S01194
     C                     ELSE                                           S01194
     C                     Z-ADD0         MDIN                            S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C                     ENDSR                                          S01194
     C*                                                                   S01194
     C*****************************************************************   S01194
     C**                                                                  S01194
     C**  FUNCTION:  TO MOVE NEW SYNON FIELD NAMES IN SDNOSTPD            S01194
     C**             BACK INTO OLD FIELDS WHEN CHAIN TO                   S01194
     C**             TABLETL OCCURS                                       S01194
     C**                                                                  S01194
     C**  CALLS:     NONE                                                 S01194
     C**                                                                  S01194
     C**                                                                  S01194
     C           MVNOS1    BEGSR                                          S01194
     C*          -----                                                    S01194
     C                     MOVE A7ACCD    ACOD                            S01194
     C                     MOVE A7ACSN    ACSQ                            S01194
     C                     MOVE A7CUST    CNUM                            S01194
     C                     MOVE A7BRCD    BRCA                            S01194
     C*                                                                   S01194
     C                     ENDSR                                          S01194
     C*                                                                   S01194
     C*****************************************************************   S01194
      ***********                                                         056031
     C***********                                                   S01194056031
     C****FUNCTION:  TO MOVE NEW SYNON FIELD NAMES IN SDNOSTPD      S01194056031
     C***********    BACK INTO OLD FIELDS WHENEVER CALL TO          S01194056031
     C***********    FPRTN OCCURS                                   S01194056031
     C***********                                                   S01194056031
     C****CALLS:*    NONE                                           S01194056031
     C***********                                                   S01194056031
     C***********                                                   S01194056031
     C***********MVNOS2    BEGSR                                    S01194056031
     C***********-----                                              S01194056031
     C***********          MOVE A7ACCD    ACOD                      S01194056031
     C***********          MOVE A7ACSN    ACSQ                      S01194056031
     C***********          MOVE A7CYCD    CCY                       S01194056031
     C***********          MOVE A7CUST    CNUM                      S01194056031
     C***********          MOVE A7NOSN    CSNM                      S01194056031
     C***********          MOVE A7NONB    NOSN                      S01194056031
     C***********          MOVE A7BRCD    BRCA                      S01194056031
     C***********                                                   S01194056031
     C***********          ENDSR                                    S01194056031
     C*                                                                   S01194
     C*****************************************************************   S01194
     C**                                                                  S01194
     C**  FUNCTION:  TO MOVE NEW SYNON FIELD NAMES IN SDCUSTPD            S01194
     C**             BACK INTO OLD FIELDS                                 S01194
     C**                                                                  S01194
     C**  CALLS:     NONE                                                 S01194
     C**                                                                  S01194
     C**                                                                  S01194
     C           MVCUST    BEGSR                                          S01194
     C*          -----                                                    S01194
     C                     MOVE BBCUST    CNUM                            S01194
     C                     MOVE BBCSID    CSID   12                       S01194
     C***********          MOVE BBCSSN    CSNM                      S01194056031
     C                     MOVE BBCSSN    CSNM   10                       S01194
     C                     MOVE BBBRCD    BRCA                            S01194
     C*                                                                   S01194
     C                     ENDSR                                          S01194
     C*                                                                   S01194
     C*****************************************************************   S01194
     C**                                                                  S01194
     C**  FUNCTION:  TO CHECK FOR '?' IN SBRCA FIELD                      S01194
     C**                                                                  S01194
     C**  CALLS:     NONE                                                 S01194
     C**                                                                  S01194
     C**  CALLED BY: CCPROC                                               S01194
     C**                                                                  S01194
     C**                                                                  S01194
     C           FLDQ1     BEGSR                                          S01194
     C*          -----                                                    S01194
     C                     SETOF                     16                   S01194
     C*                                                                   S01194
     C* CHECK SBRCA FOR ENTRY OF ?                                        S01194
     C*                                                                   S01194
     C                     MOVEA*BLANKS   FLDQ                            S01194
     C                     MOVEASBRCA     FLDQ                            S01194
     C                     SETOF                     17                   S01194
     C           '?'       LOKUPFLDQ                     17               S01194
     C*                                                                   S01194
     C* IF ? FOUND SETON REDISPLAY INDICATOR AND CALL ACCESS PROGRAM      S01194
     C*                                                                   S01194
     C           *IN17     IFEQ '1'                                       S01194
     C                     SETON                     16                   S01194
     C**********           CALL 'AOBRCHR0'                                             S01194 CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM *BLANKS   @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM '?'       @BRCD   3                       S01194
     C********** SDBRCH    PARM SDBRCH    DSFDY                                        S01194 CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C*                                                                   S01194
     C* IF SELECTION MADE MOVE VALUE TO SBRCA FLD                         S01194
     C*                                                                   S01194
     C           @RTCD     IFEQ *BLANKS                                   S01194
     C                     MOVELA8BRCD    SBRCA                           S01194
     C                     ELSE                                           S01194
     C                     MOVEL*BLANKS   SBRCA                           S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C                     ENDSR                                          S01194
     C*                                                                   S01194
     C*****************************************************************   S01194
     C**                                                                  S01194
     C**  FUNCTION:  TO CHECK FOR '?' IN DETAIL SCREEN FIELDS             S01194
     C**                                                                  S01194
     C**  CALLS:     NONE                                                 S01194
     C**                                                                  S01194
     C**  CALLED BY: GAVALD                                               S01194
     C**                                                                  S01194
     C**                                                                  S01194
     C           FLDQ2     BEGSR                                          S01194
     C*          -----                                                    S01194
     C                     SETOF                     16                   S01194
     C*                                                                   S01435
     C** check SBRCA for entry of ?                                       S01435
     C*  --------------------------                                       S01435
     C                     MOVEA*BLANKS   FLDQ                            S01435
     C                     MOVEASBRCA     FLDQ                            S01435
     C                     SETOF                     17                   S01435
     C           '?'       LOKUPFLDQ                     17               S01435
     C*                                                                   S01435
     C* if ? found in SBRCA and call access program                       S01435
     C*                                                                   S01435
     C           *IN17     IFEQ '1'                                       S01435
     C                     SETON                     16                   S01435
     C**********           CALL 'AOBRCHR0'                                             S01435 CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM *BLANKS   @RTCD   7                       S01435
     C                     PARM '*KEY   ' @OPTN   7                       S01435
     C                     PARM '?'       @BRCD   3                       S01435
     C********** SDBRCH    PARM SDBRCH    DSFDY                                        S01435 CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C*                                                                   S01435
     C* if selection made move value to SBRCA fld                         S01435
     C*                                                                   S01435
     C           @RTCD     IFEQ *BLANKS                                   S01435
     C                     MOVELA8BRCD    SBRCA                           S01435
     C                     ELSE                                           S01435
     C                     MOVE *BLANKS   SBRCA                           S01435
     C                     END                                            S01435
     C*                                                                   S01435
     C                     END                                            S01435
     C*                                                                   S01194
     C** CHECK SORBR FOR ENTRY OF ?                                       S01194
     C*  --------------------------                                       S01194
     C                     MOVEA*BLANKS   FLDQ                            S01194
     C                     MOVEASORBR     FLDQ                            S01194
     C                     SETOF                     17                   S01194
     C           '?'       LOKUPFLDQ                     17               S01194
     C*                                                                   S01194
     C* IF ? FOUND IN SORBR AND CALL ACCESS PROGRAM                       S01194
     C*                                                                   S01194
     C           *IN17     IFEQ '1'                                       S01194
     C                     SETON                     16                   S01194
     C**********           CALL 'AOBRCHR0'                                             S01194 CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM *BLANKS   @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM '?'       @BRCD   3                       S01194
     C********** SDBRCH    PARM SDBRCH    DSFDY                                        S01194 CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C*                                                                   S01194
     C* IF SELECTION MADE MOVE VALUE TO SORBR FLD                         S01194
     C*                                                                   S01194
     C           @RTCD     IFEQ *BLANKS                                   S01194
     C                     MOVELA8BRCD    SORBR                           S01194
     C                     ELSE                                           S01194
     C                     MOVE *BLANKS   SORBR                           S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C** CHECK SPYST FOR ENTRY OF '?'                                     S01194
     C*  ----------------------------                                     S01194
     C                     MOVEA*BLANKS   FLDQ                            S01194
     C                     MOVEASPYST     FLDQ                            S01194
     C                     SETOF                     17                   S01194
     C           '?'       LOKUPFLDQ                     17               S01194
     C*                                                                   S01194
     C* IF ? FOUND IN SPYST AND CALL ACCESS PROGRAM                       S01194
     C*                                                                   S01194
     C           *IN17     IFEQ '1'                                       S01194
     C                     SETON                     16                   S01194
     C                     CALL 'AODLSTR0'                                S01194
     C                     PARM *BLANKS   @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM '?'       @DSTC   2                       S01194
     C           SDDLST    PARM SDDLST    DSFDY                           S01194
     C*                                                                   S01194
     C* IF SELECTION MADE MOVE VALUE TO SPYST FLD                         S01194
     C*                                                                   S01194
     C           @RTCD     IFEQ *BLANKS                                   S01194
     C                     MOVELASDSTC    SPYST                           S01194
     C                     ELSE                                           S01194
     C                     MOVE *BLANKS   SPYST                           S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C** CHECK SACBB FOR ENTRY OF ?                                       S01194
     C*  --------------------------                                       S01194
     C                     MOVEA*BLANKS   FLDQ                            S01194
     C                     MOVEASACBB     FLDQ                            S01194
     C                     SETOF                     17                   S01194
     C           '?'       LOKUPFLDQ                     17               S01194
     C*                                                                   S01194
     C* IF ? FOUND IN SACBB AND CALL ACCESS PROGRAM                       S01194
     C*                                                                   S01194
     C           *IN17     IFEQ '1'                                       S01194
     C                     SETON                     16                   S01194
     C**********           CALL 'AOBRCHR0'                                             S01194 CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM *BLANKS   @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM '?'       @BRCD   3                       S01194
     C********** SDBRCH    PARM SDBRCH    DSFDY                                        S01194 CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C*                                                                   S01194
     C* IF SELECTION MADE MOVE VALUE TO SACBB FLD                         S01194
     C*                                                                   S01194
     C           @RTCD     IFEQ *BLANKS                                   S01194
     C                     MOVELA8BRCD    SACBB                           S01194
     C                     ELSE                                           S01194
     C                     MOVE *BLANKS   SACBB                           S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C** CHECK SSMCY FOR ENTRY OF ?                                       S01194
     C*  --------------------------                                       S01194
     C                     MOVEA*BLANKS   FLDQ                            S01194
     C                     MOVEASSMCY     FLDQ                            S01194
     C                     SETOF                     17                   S01194
     C           '?'       LOKUPFLDQ                     17               S01194
     C*                                                                   S01194
     C* IF ? FOUND IN SSMCY AND CALL ACCESS PROGRAM                       S01194
     C*                                                                   S01194
     C           *IN17     IFEQ '1'                                       S01194
     C                     SETON                     16                   S01194
     C                     CALL 'AOCURRR0'                                S01194
     C                     PARM *BLANKS   @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM '?'       @CYCD   3                       S01194
     C           SDCURR    PARM SDCURR    DSSDY                           S01194
     C*                                                                   S01194
     C* IF SELECTION MADE MOVE VALUE TO SSMCY FLD                         S01194
     C*                                                                   S01194
     C           @RTCD     IFEQ *BLANKS                                   S01194
     C                     MOVELA6CYCD    SSMCY                           S01194
     C                     ELSE                                           S01194
     C                     MOVE *BLANKS   SSMCY                           S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C                     END                                            S01194
     C*                                                                   CEU006
     C** CHECK SNDCY FOR ENTRY OF ?                                       CEU006
     C*  --------------------------                                       CEU006
     C                     MOVEA*BLANKS   FLDQ                            CEU006
     C                     MOVEASNDCY     FLDQ                            CEU006
     C                     SETOF                     17                   CEU006
     C           '?'       LOKUPFLDQ                     17               CEU006
     C*                                                                   CEU006
     C* IF ? FOUND IN SNDCY AND CALL ACCESS PROGRAM                       CEU006
     C*                                                                   CEU006
     C           *IN17     IFEQ '1'                                       CEU006
     C                     SETON                     16                   CEU006
     C                     CALL 'AOCURRR0'                                CEU006
     C                     PARM *BLANKS   @RTCD   7                       CEU006
     C                     PARM '*KEY   ' @OPTN   7                       CEU006
     C                     PARM '?'       @CYCD   3                       CEU006
     C           SDCURR    PARM SDCURR    DSSDY                           CEU006
     C*                                                                   CEU006
     C* IF SELECTION MADE MOVE VALUE TO SNDCY FLD                         CEU006
     C*                                                                   CEU006
     C           @RTCD     IFEQ *BLANKS                                   CEU006
     C                     MOVELA6CYCD    SNDCY                           CEU006
     C                     ELSE                                           CEU006
     C                     MOVE *BLANKS   SNDCY                           CEU006
     C                     END                                            CEU006
     C*                                                                   CEU006
     C                     END                                            CEU006
     C*                                                                   S01194
     C** CHECK SPCCY FOR ENTRY OF ?                                       S01194
     C*  --------------------------                                       S01194
     C                     MOVEA*BLANKS   FLDQ                            S01194
     C                     MOVEASPCCY     FLDQ                            S01194
     C                     SETOF                     17                   S01194
     C           '?'       LOKUPFLDQ                     17               S01194
     C*                                                                   S01194
     C* IF ? FOUND IN SPCCY AND CALL ACCESS PROGRAM                       S01194
     C*                                                                   S01194
     C           *IN17     IFEQ '1'                                       S01194
     C                     SETON                     16                   S01194
     C                     CALL 'AOCURRR0'                                S01194
     C                     PARM *BLANKS   @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM '?'       @CYCD   3                       S01194
     C           SDCURR    PARM SDCURR    DSSDY                           S01194
     C*                                                                   S01194
     C* IF SELECTION MADE MOVE VALUE TO SPCCY FLD                         S01194
     C*                                                                   S01194
     C           @RTCD     IFEQ *BLANKS                                   S01194
     C                     MOVELA6CYCD    SPCCY                           S01194
     C                     ELSE                                           S01194
     C                     MOVE *BLANKS   SPCCY                           S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C                     END                                            S01194
      *                                                                   S01414
      *  check SBOKC for entry of ?                                       S01414
      *  --------------------------                                       S01414
     C                     MOVEA*BLANKS   FLDQ                            S01414
     C                     MOVEASBOKC     FLDQ                            S01414
     C                     SETOF                     17                   S01414
     C           '?'       LOKUPFLDQ                     17               S01414
     C*                                                                   S01414
     C* if ? found in SBOKC and call access program                       S01414
     C*                                                                   S01414
     C           *IN17     IFEQ '1'                                       S01414
     C                     SETON                     16                   S01414
     C                     CALL 'AOBOOKR0'                                S01414
     C                     PARM *BLANKS   U#RTCD  7                       S01414
     C                     PARM '*KEY   ' U#OPTN  7                       S01414
     C                     PARM '?'       U#BOKC  2                       S01414
     C           SDBOOK    PARM SDBOOK    DSFDY                           S01414
     C*                                                                   S01414
     C* if selection made move value to SBOKC fld                         S01414
     C*                                                                   S01414
     C           U#RTCD    IFEQ *BLANKS                                   S01414
     C                     MOVELSDBOOK    SBOKC                           S01414
     C                     ELSE                                           S01414
     C                     MOVE *BLANKS   SBOKC                           S01414
     C                     END                                            S01414
     C*                                                                   S01414
     C                     END                                            S01414
      *                                                                   S01414
      *  check SPRFC for entry of ?                                       S01414
      *  --------------------------                                       S01414
     C                     MOVEA*BLANKS   FLDQ                            S01414
     C                     MOVEASPRFC     FLDQ                            S01414
     C                     SETOF                     17                   S01414
     C           '?'       LOKUPFLDQ                     17               S01414
     C*                                                                   S01414
     C* if ? found in SPRFC and call access program                       S01414
     C*                                                                   S01414
     C           *IN17     IFEQ '1'                                       S01414
     C                     SETON                     16                   S01414
     C                     CALL 'AOPRFCR0'                                S01414
     C                     PARM *BLANKS   U#RTCD  7                       S01414
     C                     PARM '*KEY   ' U#OPTN  7                       S01414
     C                     PARM '?'       U#PRFC  4                       S01414
     C           SDPRFC    PARM SDPRFC    DSFDY                           S01414
     C*                                                                   S01414
     C* if selection made move value to SPRFC fld                         S01414
     C*                                                                   S01414
     C           U#RTCD    IFEQ *BLANKS                                   S01414
     C                     MOVELSDPRFC    SPRFC                           S01414
     C                     ELSE                                           S01414
     C                     MOVE *BLANKS   SPRFC                           S01414
     C                     END                                            S01414
     C*                                                                   S01414
     C                     END                                            S01414
     C/COPY WNCPYSRC,FT0050C143
     C*                                                                   S01194
     C                     ENDSR                                          S01194
     C/EJECT                                                              S01435
      *****************************************************************   S01435
      *                                                               *   S01435
      *  SRBRCA   : Validate Booking Branch                           *   S01435
      *                                                               *   S01435
      *  CALLED BY: GAVALD                                            *   S01435
      *                                                               *   S01435
      *  CALLS    : AOBRCHR0                                          *   S01435
      *             ZVACTBU                                           *   S01435
      *                                                               *   S01435
      *****************************************************************   S01435
     CSR         SRBRCA    BEGSR                                          S01435
      *                                                                   S01435
      *  Set up subroutine stack name                                     S01435
      *                                                                   S01435
     C                     ADD  1         O                               S01435
     C                     MOVEL'SRBRCA'  @STK,O                          S01435
      *                                                                   S01435
      * If Booking Branch blank, use default branch on data area ZMUSER   S01435
      *                                                                   S01435
     C           SBRCA     IFEQ *BLANKS                                   S01435
     C                     MOVE DBRN      SBRCA                           S01435
     C                     END                                            S01435
      *                                                                   S01435
      * Check Booking Branch valid by calling 'AOBRCHR0'                  S01435
      *                                                                   S01435
     C**********           CALL 'AOBRCHR0'                                             S01435 CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM *BLANKS   @RTCD                           S01435
     C                     PARM '*VERIFY' @OPTN                           S01435
     C                     PARM SBRCA     @BRCD                           S01435
     C********** SDBRCH    PARM SDBRCH    DSFDY                                        S01435 CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
      *                                                                   S01435
     C           @RTCD     IFNE *BLANKS                                   S01435
     C                     ADD  1         I                               S01435
     C                     MOVE '008'     ERCD,I                          S01435
     C                     SETON                     12                   S01435
     C                     ELSE                                           S01435
      *                                                                   S01435
      * Check user is authorised to perform action code on Booking branch S01435
      *                                                                   S01435
     C                     CALL 'ZVACTBU'                                 S01435
     C                     PARM SACTCD    ZACTN   1                       S01435
     C                     PARM SBRCA     ZBR     3                       S01435
     C                     PARM           ERR     10                      S01435
      *                                                                   S01435
      * User not authorised to any action codes for this item and branch  S01435
      *                                                                   S01435
     C           ERR       IFEQ 1                                         S01435
     C                     ADD  1         I                               S01435
     C                     MOVE '303'     ERCD,I                          S01435
     C                     SETON                     4012                 S01435
     C                     ELSE                                           S01435
      *                                                                   S01435
      * User not authorised to action code for this particular item       S01435
      * and branch                                                        S01435
      *                                                                   S01435
     C           ERR       IFEQ 2                                         S01435
     C                     ADD  1         I                               S01435
     C                     MOVE '304'     ERCD,I                          S01435
     C                     SETON                     4012                 S01435
     C                     END                                            S01435
      *                                                                   S01435
     C                     END                                            S01435
      *                                                                   S01435
      *                                                                   S01435
      * end @RTCD ifne *blanks                                            S01435
     C                     END                                            S01435
      *                                                                   S01435
      *  Unwind subroutine stack name                                     S01435
      *                                                                   S01435
     C           EXBRCA    TAG                                            S01435
     C                     MOVEA*BLANKS   @STK,O                          S01435
     C                     SUB  1         O       50                      S01435
      *                                                                   S01435
     CSR                   ENDSR                                          S01435
      *                                                                   S01435
     C/EJECT
      *****************************************************************   S01414
      *                                                               *   S01414
      *  SRBOOK   : Validate Book Code                                *   S01414
      *                                                               *   S01414
      *  CALLED BY: GAVALD                                            *   S01414
      *                                                               *   S01414
      *  CALLS    : AOBOOKR0                                          *   S01414
      *             FTSNMS                                            *   S01414
      *                                                               *   S01414
      *****************************************************************   S01414
     CSR         SRBOOK    BEGSR                                          S01414
      *                                                                   S01414
      *  Set up subroutine stack name                                     S01414
      *                                                                   S01414
     C                     ADD  1         O                               S01414
     C                     MOVEL'SRBOOK'  @STK,O                          S01414
      *                                                                   S01414
      *  Book Code must be entered                                        S01414
      *                                                                   S01414
     C           SBOKC     IFEQ *BLANKS                                   S01414
     C                     ADD  1         I                               S01414
     C                     MOVE '400'     ERCD,I                          S01414
     C                     MOVE '1'       *IN79                           S01414
     C                     END                                            S01414
      *                                                                   S01414
      *  Access the Book Code file for validation if an Insert OR         S01414
      *  if an Amend and the Book Code has been changed                   S01414
      *                                                                   S01414
     C           SBOKC     IFNE *BLANKS                                   S01414
     C           SBOKC     ANDNEBOKC                                      S01414
      *                                                                   S01414
     C                     CALL 'AOBOOKR0'             90                 S01414
     C                     PARM *BLANKS   U#RTCD  7                       S01414
     C                     PARM '*KEY   ' U#OPTN  7                       S01414
     C                     PARM SBOKC     U#BOKC  2                       S01414
     C           SDBOOK    PARM SDBOOK    DSFDY                           S01414
      *                                                                   S01414
      *  If error on CALL - process as database error                     S01414
      *                                                                   S01414
     C           *IN90     IFEQ '1'                                       S01414
     C                     MOVEL'*CALL  ' W0FILE           ************   S01414
     C                     MOVEL'AOBOOKR' W0KEY            * DBERR 64 *   S01414
     C                     Z-ADD64        W0ERNB           ************   S01414
     C                     EXSR SRERR                                     S01414
     C                     END                                            S01414
      *                                                                   S01414
      * If return code is not blank - process for an error                S01414
      * else map the book code from the data structure to screen field    S01414
      *                                                                   S01414
     C           U#RTCD    IFNE *BLANKS                                   S01414
     C                     ADD  1         I                               S01414
     C                     MOVE '400'     ERCD,I                          S01414
     C                     MOVE '1'       *IN79                           S01414
      *                                                                   S01414
     C                     ELSE                                           S01414
     C                     MOVELBDBKCD    SBOKC                           S01414
     C                     END                                            S01414
      *                                                                   S01414
     C                     END                                            S01414
      *                                                                   S01414
      *  Unwind subroutine stack name                                     S01414
      *                                                                   S01414
     C           EXBOOK    TAG                                            S01414
     C                     MOVEA*BLANKS   @STK,O                          S01414
     C                     SUB  1         O       50                      S01414
      *                                                                   S01414
     CSR                   ENDSR                                          S01414
      *                                                                   S01414
     C/EJECT                                                              S01414
      *****************************************************************   S01414
      *                                                               *   S01414
      *  SRPRFC   : Validation Of Profit Centre                       *   S01414
      *                                                               *   S01414
      *  CALLED BY: GAVALD                                            *   S01414
      *                                                               *   S01414
      *  CALLS    : FTSNMS                                            *   S01414
      *             AOPRFMR0                                          *   S01414
      *             AOPRFCR0                                          *   S01414
      *                                                               *   S01414
      *****************************************************************   S01414
     CSR         SRPRFC    BEGSR                                          S01414
      *                                                                   S01414
      *  Set up subroutine stack name                                     S01414
      *                                                                   S01414
     C                     ADD  1         O                               S01414
     C                     MOVEL'SRPRFC'  @STK,O                          S01414
      *                                                                   S01414
      *  Profit Centre is Optional input.                                 S01414
      *                                                                   S01414
      *  If the profit centre field is blank set to a default only if     S01414
      *  the Profit Centre Defaults Used flag is set to 'Y'.              S01414
      *  This could only happen on an Insert.                             S01414
      *  Do not default if error in Beneficiary, Account with Bank        179732
      *  or book code                                                     179732
      *                                                                   S01414
     C           SACTCD    IFEQ 'I'                                       S01414
     C           SPRFC     ANDEQ*BLANKS                                   S01414
     C           BKPCDU    ANDEQ'Y'                                       S01414
     C           *IN46     ANDNE'1'                                       179732
     C           *IN47     ANDNE'1'                                       179732
     C           *IN79     ANDNE'1'                                       179732
      **                                                                  179732
      * Retrieve the Beneficiary details.                                 179732
     C           *LIKE     DEFN BBACOC    BBACOZ                          179732
     C                     MOVEL*BLANKS   BBACOZ                          179732
     C                     MOVEL*BLANKS   @KEY1                           179732
     C                     MOVEL*BLANKS   CUST                            179732
      * If Retail account, then use retail customer no.                   179732
     C********** BENRET    IFNE 0                                                      179732 CSD027
     C           BENRET    IFNE *BLANKS                                                       CSD027
     C                     MOVELRETNXX    @KEY1                           179732
     C                     MOVELRETNXX    CUST                            179732
     C                     ELSE                                           179732
     C                     MOVELBCNUMA    @KEY1                           179732
     C                     MOVELBCNUMA    CUST                            179732
     C                     END                                            179732
     C*                                                                   179732
     C                     CALL 'AOCUSTR0'                                179732
     C                     PARM *BLANKS   @RTCD                           179732
     C                     PARM '*KEY   ' @OPTN                           179732
     C                     PARM           @KEY1                           179732
     C                     PARM *BLANKS   @KYST                           179732
     C           SDCUST    PARM *BLANKS   DSSDY                           179732
      *                                                                   179732
     C           @RTCD     IFEQ *BLANKS                                   179732
     C                     MOVE BBACOC    BBACOZ                          179732
     C                     ENDIF                                          179732
      **                                                                  179732
     C*If Beneficiary has not been set up with a default                  179732
     C*profit centre, determine the default from the 'A/c with            179732
     C*Bank' entry.                                                       179732
     C           BBACOZ    IFEQ *BLANKS                                   179732
     C*                                                                   179732
     C           AWBCHR    IFNE *BLANKS                                   179732
     C                     MOVELAWBCHR    @KEY1                           179732
     C*                                                                   179732
     C                     CALL 'AOCUSTR0'                                179732
     C                     PARM *BLANKS   @RTCD                           179732
     C                     PARM '*KEY   ' @OPTN                           179732
     C                     PARM           @KEY1                           179732
     C                     PARM *BLANKS   @KYST                           179732
     C           SDCUST    PARM *BLANKS   DSSDY                           179732
     C*                                                                   179732
     C           @RTCD     IFEQ *BLANKS                                   179732
     C                     MOVE BBACOC    BBACOZ                          179732
     C                     END                                            179732
     C*                                                                   179732
     C                     ENDIF                                          179732
     C                     ENDIF                                          179732
      **                                                                  179732
      *                                                                   S01414
      *  Determine parameters to be passed                                S01414
      *                                                                   S01414
      ***For*Outgoing*Payments*the*Customer*and*Account*Officer*willS01414179732
      ***be*blank.************************************************* S01414179732
      *                                                                   S01414
      *                                                                   S01414
     C******************** MOVEL*BLANKS   CUST    6        Customer S01414179732
     C******************** MOVEL*BLANKS   ACOF    2        Account OS01414179732
     C                     MOVELBBACOZ    ACOF    2        A/c officS01414179732
     C                     MOVELSPYTP     TRTP    5        Transaction TypS01414
      *                                                                   S01414
      *  Get default profit centre                                        S01414
      *                                                                   S01414
     C                     CALL 'AOPRFMR0'             90                 S01414
     C                     PARM *BLANKS   U#RTCD  7        Return Code    S01414
     C                     PARM SBOKC     U#BOKC  2        Book Code      S01414
     C                     PARM TRTP      U#TRTP  5        Transaction TypS01414
     C                     PARM SPYST     U#SUTP  2        Sub Type       S01414
     C                     PARM SBRCA     U#BRAN  3        Branch Code    S01414
     C                     PARM DPPT      U#DEPT  3        Department CodeS01414
     C                     PARM USRID     U#USER 10        User           S01414
     C                     PARM ACOF      U#ACOF  2        Account OfficerS01414
     C                     PARM CUST      U#CUST  6        Customer NumberS01414
     C           SPRFC     PARM *BLANKS   U#PRFC  4        Profit Centre  S01414
      *                                                                   S01414
      *  If error on CALL - process as database error                     S01414
      *                                                                   S01414
     C           *IN90     IFEQ '1'                                       S01414
     C                     MOVEL'*CALL  ' W0FILE           ************   S01414
     C                     MOVEL'AOPRFMR' W0KEY            * DBERR 65 *   S01414
     C                     Z-ADD65        W0ERNB           ************   S01414
     C                     EXSR SRERR                                     S01414
     C                     END                                            S01414
      *                                                                   S01414
      * If return code is not blank - process for an error                S01414
      * If no error then the screen field is filled by passed parameter   S01414
      *                                                                   S01414
     C           U#RTCD    IFEQ '2'                                       S01414
     C                     ADD  1         I                               S01414
     C                     MOVE '410'     ERCD,I                          S01414
     C                     MOVE '1'       *IN70                           S01414
     C                     GOTO EXPRFC                                    S01414
     C                     END                                            S01414
      *                                                                   S01414
     C                     END                                            S01414
      *                                                                   S01414
      *                                                                   S01414
      *  Validate Profit Centre                                           S01414
      *                                                                   S01414
     C           SACTCD    IFEQ 'I'                                       S01414
     C           SPRFC     ANDNE*BLANKS                                   S01414
     C           SACTCD    OREQ 'A'                                       S01414
     C           SPRFC     ANDNE*BLANKS                                   S01414
     C           SACTCD    OREQ 'I'                                       120827
     C           BGN0ST    ANDEQ'Y'                                       120827
     C           SACTCD    OREQ 'A'                                       120827
     C           BGN0ST    ANDEQ'Y'                                       120827
      *                                                                   S01414
     C                     CALL 'AOPRFCR0'             90                 S01414
     C                     PARM *BLANKS   U#RTCD  7                       S01414
     C                     PARM '*KEY'    U#OPTN  7                       S01414
     C                     PARM SPRFC     U#PRFC  4                       S01414
     C           SDPRFC    PARM SDPRFC    DSFDY                           S01414
      *                                                                   S01414
      *  If error on CALL - process as database error                     S01414
      *                                                                   S01414
     C           *IN90     IFEQ '1'                                       S01414
     C                     MOVEL'*CALL  ' W0FILE           ************   S01414
     C                     MOVEL'AOPRFCR' W0KEY            * DBERR 66 *   S01414
     C                     Z-ADD66        W0ERNB           ************   S01414
     C                     EXSR SRERR                                     S01414
     C                     END                                            S01414
      *                                                                   S01414
      * If return code is not blank - process for an error                S01414
      *                                                                   S01414
     C           U#RTCD    IFNE *BLANKS                                   S01414
     C                     ADD  1         I                               S01414
     C                     MOVEA' 410'    ERCD,I                          S01414
     C                     MOVE '1'       *IN70                           S01414
      *                                                                   S01414
     C                     ELSE                                           S01414
     C                     MOVELDSPCCD    SPRFC                           S01414
     C                     END                                            S01414
      *                                                                   S01414
     C                     END                                            S01414
      *                                                                   S01414
      *  Unwind subroutine stack name                                     S01414
      *                                                                   S01414
     C           EXPRFC    TAG                                            S01414
     C                     MOVEA*BLANKS   @STK,O                          S01414
     C                     SUB  1         O       50                      S01414
      *                                                                   S01414
     CSR                   ENDSR                                          S01414
     C/EJECT                                                              CFT009
      *****************************************************************   CFT009
      *                                                               *   CFT009
      *  SRSPST   : Validate spread set and default charges           *   CFT009
      *                                                               *   CFT009
      *  CALLED BY: GAVALD                                            *   CFT009
      *                                                               *   CFT009
      *  CALLS    : *NONE                                             *   CFT009
      *                                                               *   CFT009
      *****************************************************************   CFT009
     CSR         SRSPST    BEGSR                                          CFT009
      *                                                                   CFT009
      *  Set up subroutine stack name                                     CFT009
      *                                                                   CFT009
     C                     ADD  1         O                               CFT009
     C                     MOVEL'SRSPST'  @STK,O                          CFT009
      *                                                                   CFT009
      ** Spread set must be blank, if settle currency = pay currency      CFT009
      *                                                                   CFT009
     C           SSMCY     IFEQ SPCCY                                     CFT009
     C           SSMCY     ANDNE*BLANKS                                   CFT009
     C           SPCCY     ANDNE*BLANKS                                   CFT009
      *                                                                   CFT009
     C           SPDSET    IFNE *BLANKS                                   CFT009
     C                     MOVE *ON       *IN24                           CFT009
     C                     MOVEL'FTF3157' FTMSID                          CFT009
     C                     MOVEL'FTUSRMSG'FTMSGF                          CFT009
     C                     ADD  1         I                               CFT009
     C                     EXSR FTSNMS                                    CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
      *                                                                   CFT009
      ** Must be a valid spread set if not blank                          CFT009
      *                                                                   CFT009
     C           SPDSET    IFNE *BLANKS                                   CFT009
     C           SPDSET    SETLLFTXTRHL0                 90               CFT009
      *                                                                   CFT009
     C           *IN90     IFEQ *OFF                                      CFT009
     C                     MOVE *ON       *IN24                           CFT009
     C                     MOVEL'FTF3152' FTMSID                          CFT009
     C                     MOVEL'FTUSRMSG'FTMSGF                          CFT009
     C                     ADD  1         I                               CFT009
     C                     EXSR FTSNMS                                    CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Must be a valid date offset code, if not blank                   CFT009
      *                                                                   CFT009
     C           SOFCD     IFNE *BLANKS                                   CFT009
     C           SOFCD     SETLLFTPDOCL0                 90               CFT009
      *                                                                   CFT009
     C           *IN90     IFEQ *OFF                                      CFT009
     C                     MOVE *ON       *IN04                           CFT009
     C                     MOVE *ON       *IN75                           CFT009
     C                     MOVEL'FTF3223' FTMSID                          CFT009
     C                     Z-ADD1         I                               CFT009
     C                     EXSR FTSNMS                                    CFT009
     C                     ELSE                                           CFT009
     C                     MOVE *OFF      *IN04                           CFT009
     C                     ENDIF                                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVE *OFF      *IN04                           CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Default charges                                                  CFT009
      *                                                                   CFT009
     C           *IN24     IFEQ *OFF                                      CFT009
     C           *IN04     ANDEQ*OFF                                      CFT009
     C                     CLEARINPYDS                                    CFT009
     C                     CLEARINPXDS                                    CFT009
     C                     CLEARTRNDET                                    CFT009
     C                     CLEARTRNEXT                                    CFT009
     C                     MOVE *BLANKS   KFCHG   1                       CFT009
     C                     MOVE 'N'       FLAG12                          CFT009
      *                                                                   CFT009
      * Move details into incoming payment details DS                     CFT009
      *                                                                   CFT009
     C                     EXSR GCINPY                                    CFT009
     C                     EXSR MOVIDS                                    CFT009
      *                                                                   CFT009
     C                     MOVELINPYDS    TRNDET                          CFT009
     C                     MOVELINPXDS    TRNEXT                          CFT009
      *                                                                   CFT009
     C                     CALL 'FT000980'                                CFT009
     C                     PARM           RTN980 10                       CFT009
     C                     PARM           TRNDET                          CFT009
     C                     PARM           TRNEXT                          CFT009
     C                     PARM 'IN'      TRNTYP  2                       CFT009
     C                     PARM 'M'       PRCMTD  1                       CFT009
     C                     PARM *BLANKS   MESTYP  3                       CFT009
     C                     PARM *BLANKS   SETNUM  3                       CFT009
      *                                                                   CFT009
     C                     MOVELTRNDET    INPYDS                          CFT009
     C                     MOVELTRNEXT    INPXDS                          CFT009
      *                                                                   CFT009
      * Save default payment date offset code                             CFT009
     C           *LIKE     DEFN IPPDOF    DFTPDO                          CFT009
     C                     MOVELIPPDOF    DFTPDO                          CFT009
      *                                                                   CFT009
      ** Amend mode                                                       CFT009
      *                                                                   CFT009
     C           SACTCD    IFNE 'I'                                       CFT009
     C           F12       ANDNE'Y'                                       CFT009
     C           SACTCD    OREQ 'I'                                       CFT009
     C           EXECDF    ANDEQ'Y'                                       CFT009
     C           F12       OREQ 'Y'                                       CFT009
     C           EXECDF    ANDEQ'Y'                                       CFT009
      *                                                                   CFT009
      ** If date offset code is not blank but both payment dates are      CFT009
      ** blanked out, redefault them                                      CFT009
      *                                                                   CFT009
     C           SOFCD     IFNE *BLANKS                                   CFT009
      *                                                                   CFT009
     C           SSLDT     IFEQ *BLANKS                                   CFT009
     C                     MOVE SLDTD1    SSLDT                           CFT009
      *                                                                   CFT009
      ** Convert settle date into various formats                         CFT009
      *                                                                   CFT009
     C                     MOVE SLDTD1    ZDATE                           CFT009
     C                     EXSR ZDATE1                                    CFT009
     C                     Z-ADDZDAYNO    WSLDT                           CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C           SPYDT     IFEQ *BLANKS                                   CFT009
     C                     MOVE PVDTD1    SPYDT                           CFT009
      *                                                                   CFT009
      ** Convert pay date into various formats                            CFT009
      *                                                                   CFT009
     C                     MOVE PVDTD1    ZDATE                           CFT009
     C                     EXSR ZDATE1                                    CFT009
     C                     Z-ADDZDAYNO    WPYDT                           CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** If add/deduct indicator is amended and spread set is blanked     CFT009
      ** out, redefault the spread set                                    CFT009
      *                                                                   CFT009
     C           FADDC     IFNE SADDC                                     CFT009
     C           SPDSET    ANDEQ*BLANKS                                   CFT009
      *                                                                   CFT009
     C           SSMCY     IFNE SPCCY                                     CFT009
     C                     MOVE FXSPSC    SPDSET                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** If spread set code is not blank but rate is blanked out,         CFT009
      ** redefault the rate                                               CFT009
      *                                                                   CFT009
     C           SPDSET    IFNE *BLANKS                                   CFT009
     C           SRATE     ANDEQ*BLANKS                                   CFT009
      *                                                                   CFT009
     C                     MOVEL*BLANK    ZFIELD                          CFT009
     C                     MOVE RATE      ZFIELD                          CFT009
     C                     Z-ADD8         ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    SRATE                           CFT009
      *                                                                   CFT009
     C           RATE      IFNE 0                                         CFT009
     C                     Z-ADDRATE      WRATE                           CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Set on redefault charges flag, if rate has been amended          CFT009
      *                                                                   CFT009
     C           RATE      IFNE SVRATE                                    CFT009
     C                     MOVE 'Y'       KFCHG                           CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Pay amount                                                       CFT009
      *                                                                   CFT009
     C                     CALL 'AOCURRR0'                                CFT009
     C                     PARM *BLANKS   @RTCD   7                       CFT009
     C                     PARM '*KEY   ' @OPTN   7                       CFT009
     C                     PARM SPCCY     @CURR   3                       CFT009
     C           SDCURR    PARM SDCURR    DSSDY                           CFT009
      *                                                                   CFT009
     C           @RTCD     IFNE *BLANKS                                   CFT009
     C                     MOVEL'AOCURRR0'WDBFIL                          CFT009
     C                     MOVEL'*CALL'   WDBKEY                          CFT009
     C                     Z-ADD36        WDBASE                          CFT009
     C                     EXSR UEABRT                                    CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     MOVEL*BLANK    ZFIELD                          CFT009
     C                     MOVE PYAM      ZFIELD                          CFT009
     C                     Z-ADDA6NBDP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    SPYAM                           CFT009
      *                                                                   CFT009
     C                     Z-ADDPYAM      WPYAM                           CFT009
      *                                                                   CFT009
      ** Settle amount                                                    CFT009
      *                                                                   CFT009
     C                     CALL 'AOCURRR0'                                CFT009
     C                     PARM *BLANKS   @RTCD   7                       CFT009
     C                     PARM '*KEY   ' @OPTN   7                       CFT009
     C                     PARM SSMCY     @CURR   3                       CFT009
     C           SDCURR    PARM SDCURR    DSSDY                           CFT009
      *                                                                   CFT009
     C           @RTCD     IFNE *BLANKS                                   CFT009
     C                     MOVEL'AOCURRR0'WDBFIL                          CFT009
     C                     MOVEL'*CALL'   WDBKEY                          CFT009
     C                     Z-ADD37        WDBASE                          CFT009
     C                     EXSR UEABRT                                    CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     MOVEL*BLANK    ZFIELD                          CFT009
     C                     MOVE SMAM      ZFIELD                          CFT009
     C                     Z-ADDA6NBDP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    SSMAM                           CFT009
      *                                                                   CFT009
     C                     Z-ADDSMAM      WSMAM                           CFT009
      *                                                                   CFT009
      ** Set on redefault charges flag, if settle amt has been amended    CFT009
      *                                                                   CFT009
     C           SMAM      IFNE SVSMAM                                    CFT009
     C                     MOVE 'Y'       KFCHG                           CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Check if any of key fields have been amended, if so redefault    CFT009
      ** charges                                                          CFT009
      *                                                                   CFT009
     C           KFCHG     IFEQ *BLANKS                                   CFT009
     C***********CDRO      IFEQ 0                                         CFT009              CSD027
     C           CDRO      IFEQ *BLANKS                                                       CSD027
      *                                                                   CFT009
     C           SADDC     IFNE FADDC                                     CFT009
     C           OSMCY     ANDNEOPCCY                                     CFT009
      *                                                                   CFT009
     C           SADDC     ORNE FADDC                                     CFT009
     C           SSMCY     ANDNESPCCY                                     CFT009
      *                                                                   CFT009
     C           SPCCY     ORNE OPCCY                                     CFT009
     C           SADDC     ANDEQ'D'                                       CFT009
      *                                                                   CFT009
     C           SSMCY     ORNE OSMCY                                     CFT009
     C           SADDC     ANDEQ'A'                                       CFT009
      *                                                                   CFT009
     C           WSMAM     ORNE SVSMAM                                    CFT009
     C           WRATE     ORNE SVRATE                                    CFT009
     C                     MOVE 'Y'       KFCHG                           CFT009
     C                     MOVE 'Y'       FLAG12                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Insert mode                                                      CFT009
      *                                                                   CFT009
     C           SACTCD    IFEQ 'I'                                       CFT009
     C           EXECDF    ANDEQ*BLANKS                                   CFT009
     C           F12       OREQ 'Y'                                       CFT009
     C           EXECDF    ANDEQ*BLANKS                                   CFT009
     C           KFCHG     OREQ 'Y'                                       CFT009
      *                                                                   CFT009
      ** Set on FT000980 has been called flag                             CFT009
      *                                                                   CFT009
     C                     MOVE 'Y'       EXECDF                          CFT009
      *                                                                   CFT009
      ** If screen spread set <> defaulted spread set, issue warning      CFT009
      ** message else if screen spread set is blank and pay ccy <>        CFT009
      ** settle ccy, move it into screen field                            CFT009
      *                                                                   CFT009
     C           SPDSET    IFNE *BLANKS                                   CFT009
      *                                                                   CFT009
     C           SPDSET    IFNE FXSPSC                                    CFT009
      *                                                                   CFT009
     C                     MOVE *ON       *IN24                           CFT009
     C                     MOVE *ON       *IN75                           CFT009
     C                     MOVE *ON       *IN23                           CFT009
     C                     MOVEL'FTF3154' FTMSID                          CFT009
     C                     MOVEL'FTUSRMSG'FTMSGF                          CFT009
     C                     ADD  1         I                               CFT009
     C                     ADD  1         WARN                            CFT009
     C                     EXSR FTSNMS                                    CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
      *                                                                   CFT009
     C           SSMCY     IFNE SPCCY                                     CFT009
     C                     MOVE FXSPSC    SPDSET                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** If screen rate <> calculated rate, issue warning message         CFT009
      ** else if screen rate is blank, move calculated rate in and        CFT009
      ** calculated pay amount                                            CFT009
      *                                                                   CFT009
     C           SRATE     IFNE *BLANKS                                   CFT009
     C                     MOVEL*BLANK    ZFIELD                          CFT009
     C                     MOVE RATE      ZFIELD                          CFT009
     C                     Z-ADD8         ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    C#RATE 14                       CFT009
      *                                                                   CFT009
     C           C#RATE    IFNE SRATE                                     CFT009
     C                     MOVE *ON       *IN52                           CFT009
     C                     MOVE *ON       *IN75                           CFT009
     C                     MOVE *ON       *IN23                           CFT009
     C                     MOVEL'FTF0012' FTMSID                          CFT009
     C                     MOVEL'FTUSRMSG'FTMSGF                          CFT009
     C                     ADD  1         I                               CFT009
     C                     ADD  1         WARN                            CFT009
     C                     EXSR FTSNMS                                    CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Rate                                                             CFT009
     C                     ELSE                                           CFT009
     C                     MOVEL*BLANK    ZFIELD                          CFT009
     C                     MOVE RATE      ZFIELD                          CFT009
     C                     Z-ADD8         ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    SRATE                           CFT009
      *                                                                   CFT009
     C           RATE      IFNE 0                                         CFT009
     C                     Z-ADDRATE      WRATE                           CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Pay amount                                                       CFT009
      *                                                                   CFT009
     C                     CALL 'AOCURRR0'                                CFT009
     C                     PARM *BLANKS   @RTCD   7                       CFT009
     C                     PARM '*KEY   ' @OPTN   7                       CFT009
     C                     PARM SPCCY     @CURR   3                       CFT009
     C           SDCURR    PARM SDCURR    DSSDY                           CFT009
      *                                                                   CFT009
     C           @RTCD     IFNE *BLANKS                                   CFT009
     C                     MOVEL'AOCURRR0'WDBFIL                          CFT009
     C                     MOVEL'*CALL'   WDBKEY                          CFT009
     C                     Z-ADD36        WDBASE                          CFT009
     C                     EXSR UEABRT                                    CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     MOVEL*BLANK    ZFIELD                          CFT009
     C                     MOVE PYAM      ZFIELD                          CFT009
     C                     Z-ADDA6NBDP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    SPYAM                           CFT009
      *                                                                   CFT009
     C                     Z-ADDPYAM      WPYAM                           CFT009
      *                                                                   CFT009
      ** Settle amount                                                    CFT009
      *                                                                   CFT009
     C                     CALL 'AOCURRR0'                                CFT009
     C                     PARM *BLANKS   @RTCD   7                       CFT009
     C                     PARM '*KEY   ' @OPTN   7                       CFT009
     C                     PARM SSMCY     @CURR   3                       CFT009
     C           SDCURR    PARM SDCURR    DSSDY                           CFT009
      *                                                                   CFT009
     C           @RTCD     IFNE *BLANKS                                   CFT009
     C                     MOVEL'AOCURRR0'WDBFIL                          CFT009
     C                     MOVEL'*CALL'   WDBKEY                          CFT009
     C                     Z-ADD37        WDBASE                          CFT009
     C                     EXSR UEABRT                                    CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     MOVEL*BLANK    ZFIELD                          CFT009
     C                     MOVE SMAM      ZFIELD                          CFT009
     C                     Z-ADDA6NBDP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    SSMAM                           CFT009
      *                                                                   CFT009
     C                     Z-ADDSMAM      WSMAM                           CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** If screen settle date <> defaulted date, issue warning           CFT009
      ** message else if screen settle date is blank, move defaulted      CFT009
      ** date into screen field                                           CFT009
      *                                                                   CFT009
     C           SSLDT     IFNE *BLANKS                                   CFT009
      *                                                                   CFT009
     C                     MOVE SSLDT     ZDATE                           CFT009
     C                     EXSR ZDATE1                                    CFT009
     C                     Z-ADDZDAYNO    WSLDT                           CFT009
      *                                                                   CFT009
     C                     MOVE SLDTD1    C#DATS  6                       CFT009
      *                                                                   CFT009
     C           C#DATS    IFNE SSLDT                                     CFT009
      *                                                                   CFT009
     C           *IN75     IFEQ *OFF                                      CFT009
     C           *IN51     OREQ *OFF                                      CFT009
     C                     ADD  1         I                               CFT009
     C                     ADD  1         WARN                            CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     MOVE *ON       *IN75                           CFT009
     C                     MOVE *ON       *IN51                           CFT009
     C                     MOVE *ON       *IN23                           CFT009
     C                     MOVEL'FTF3156' FTMSID                          CFT009
     C                     MOVEL'FTUSRMSG'FTMSGF                          CFT009
     C                     EXSR FTSNMS                                    CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
     C                     MOVE SLDTD1    SSLDT                           CFT009
      *                                                                   CFT009
      ** Convert settle date into various formats                         CFT009
      *                                                                   CFT009
     C                     MOVE SLDTD1    ZDATE                           CFT009
     C                     EXSR ZDATE1                                    CFT009
     C                     Z-ADDZDAYNO    WSLDT                           CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** If screen pay date <> defaulted date, issue warning              CFT009
      ** message else if screen pay date is blank, move defaulted         CFT009
      ** date into screen field                                           CFT009
      *                                                                   CFT009
     C           SPYDT     IFNE *BLANKS                                   CFT009
      *                                                                   CFT009
     C                     MOVE SPYDT     ZDATE                           CFT009
     C                     EXSR ZDATE1                                    CFT009
     C                     Z-ADDZDAYNO    WPYDT                           CFT009
      *                                                                   CFT009
     C                     MOVE PVDTD1    C#DATS  6                       CFT009
     C           C#DATS    IFNE SPYDT                                     CFT009
      *                                                                   CFT009
     C           *IN75     IFEQ *OFF                                      CFT009
     C           *IN57     OREQ *OFF                                      CFT009
     C                     ADD  1         I                               CFT009
     C                     ADD  1         WARN                            CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     MOVE *ON       *IN75                           CFT009
     C                     MOVE *ON       *IN57                           CFT009
     C                     MOVE *ON       *IN23                           CFT009
     C                     MOVEL'FTF3155' FTMSID                          CFT009
     C                     MOVEL'FTUSRMSG'FTMSGF                          CFT009
     C                     EXSR FTSNMS                                    CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
     C                     MOVE PVDTD1    SPYDT                           CFT009
      *                                                                   CFT009
      ** Convert pay date into various formats                            CFT009
      *                                                                   CFT009
     C                     MOVE PVDTD1    ZDATE                           CFT009
     C                     EXSR ZDATE1                                    CFT009
     C                     Z-ADDZDAYNO    WPYDT                           CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** If screen date offset code is a valid one, check to see if       CFT009
      ** it is the same as the defaulted offset code. If not, issue a     CFT009
      ** warning message else, if screen offset code is blank move        CFT009
      ** the default code into screen field.                              CFT009
      *                                                                   CFT009
     C           *IN04     IFEQ *OFF                                      CFT009
      *                                                                   CFT009
     C           SOFCD     IFNE *BLANKS                                   CFT009
      *                                                                   CFT009
     C           SOFCD     IFNE DFTPDO                                    CFT009
      *                                                                   CFT009
     C                     MOVE *ON       *IN04                           CFT009
     C                     MOVE *ON       *IN23                           CFT009
     C                     MOVE *ON       *IN75                           CFT009
     C                     MOVEL'FTF3222' FTMSID                          CFT009
     C                     MOVEL'FTUSRMSG'FTMSGF                          CFT009
     C                     ADD  1         I                               CFT009
     C                     ADD  1         WARN                            CFT009
     C                     EXSR FTSNMS                                    CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
     C                     MOVE IPPDOF    SOFCD                           CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Check if rate from FT000980 is in tolerence range                CFT009
      *                                                                   CFT009
     C           SOVRD     IFNE 'Y'                                       CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   WFT10A  1                       CFT009
     C                     MOVE *BLANKS   WFT10B  1                       CFT009
      *                                                                   CFT009
     C           CFT014    IFEQ 'N'                                       CFT009
     C                     MOVE 'Y'       WFT10A                          CFT009
     C                     ELSE                                           CFT009
      *                                                                   CFT009
     C           WNDAM     IFEQ *ZERO                                     CFT009
      *                                                                   CFT009
     C           CEU006    IFEQ 'Y'                                       CFT009
     C           W1INCY    ANDEQ'Y'                                       CFT009
     C           SNDCY     ANDEQBKEURO                                    CFT009
     C           CEU006    OREQ 'Y'                                       CFT009
     C           W3INCY    ANDEQ'Y'                                       CFT009
     C           SSMCY     ANDEQBKEURO                                    CFT009
     C                     MOVE 'Y'       WFT10A                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'Y'       WFT10B                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
     C*                                                                   CFT009
     C**Set up parameters to call FT0010                                  CFT009
     C*                                                                   CFT009
     C                     CLEARP#0010                                    CFT009
      *                                                                   CFT009
     C           WFT10A    IFEQ 'Y'                                       CFT009
     C                     MOVE SNDCY     P#NDCY                          CFT009
     C                     Z-ADDWNDAM     P#NDAM                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     MOVE SSMCY     P#DBCY                          CFT009
     C                     Z-ADDWSMAM     P#DBAM                          CFT009
     C                     MOVE SPCCY     P#CRCY                          CFT009
     C                     Z-ADDWPYAM     P#CRAM                          CFT009
     C                     MOVE *BLANKS   P#PDCY                          CFT009
     C                     Z-ADD*ZEROS    P#PDAM                          CFT009
     C                     Z-ADDWSLDT     P#DBDT                          CFT009
     C                     Z-ADDWPYDT     P#CRDT                          CFT009
     C                     MOVE WRATE     P#RATE                          CFT009
     C                     MOVE SOVRD     P#OVRT                          CFT009
     C                     MOVE 'Y'       P#SDIN                          CFT009
     C                     MOVE BTPCRD    P#RTDS                          CFT009
     C                     MOVEL'FT0050'  P#PMSQ                          CFT009
     C                     MOVE *BLANKS   P#INDC                          CFT009
     C                     MOVE *BLANKS   P#RTCD                          CFT009
      *                                                                   CFT009
     C                     CALL 'FT0010'                                  CFT009
     C                     PARM           P#0010                          CFT009
      *Database error handling                                            CFT009
     C           P#RTCD    IFEQ '*ERROR*'                                 CFT009
     C                     MOVEL'FT0010  'W0FILE           ************   CFT009
     C                     MOVEL'*FIRST ' W0KEY            * DBERR 120*   CFT009
     C                     Z-ADD120       W0ERNB           ************   CFT009
     C                     EXSR SRERR                      *ABORT PGM*    CFT009
     C                     ELSE                                           CFT009
      *Set up fields as error fields                                      CFT009
     C                     MOVEAP#INDC    IND                             CFT009
     C*                                                                   CFT009
     C           IND,5     IFEQ '1'                                       CFT009
     C                     MOVE IND,5     *IN52                           CFT009
     C                     ADD  1         I                               CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
     C*                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      *  Check if settle date is in the future and if the account         CFT009
      *  is closing today (if settle value date is valid)                 CFT009
      *                                                                   CFT009
     C           WSLDT     IFGT BJRDNB                                    CFT009
     C           ACST1     ANDEQ'C'                                       CFT009
     C                     ADD  1         I                               CFT009
     C                     MOVE '601'     ERCD,I                          CFT009
     C                     MOVE *ON       *IN45                           CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C           WSLDT     IFGT BJRDNB                                    CFT009
     C           ACST2     ANDEQ'C'                                       CFT009
     C                     ADD  1         I                               CFT009
     C                     MOVE '602'     ERCD,I                          CFT009
     C                     MOVE *ON       *IN48                           CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C           WSLDT     IFGT BJRDNB                                    CFT009
     C           WACST5    ANDEQ'C'                                       CFT009
     C                     MOVEL'FTM3141' FTMSID                          CFT009
     C                     MOVEL'FTUSRMSG'FTMSGF                          CFT009
     C                     MOVEL'Y'       FTNOUP                          CFT009
     C                     EXSR FTSNMS                                    CFT009
     C                     MOVE *ON       *IN83                           CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** For retail accounts only check that the settle value date is     CFT009
      ** not before the backvalue limit date nor before the date the      CFT009
      ** account was opened for the account that must be in settle ccy    CFT009
      *                                                                   CFT009
     C           WRCRT     IFEQ *BLANKS                                   CFT009
     C           WTRIT     ANDEQ*BLANKS                                   CFT009
      *                                                                   CFT009
      * Use sender fields                                                 CFT009
      *                                                                   CFT009
     C           ATYP1     IFEQ 'R'                                       CFT009
      *                                                                   CFT009
     C           WSLDT     IFLT BVLD                                      CFT009
     C                     ADD  1         I                               CFT009
     C                     MOVE '028'     ERCD,I                          CFT009
     C                     MOVE *ON       *IN45                           CFT009
     C                     ELSE                                           CFT009
     C           WSLDT     IFLT DACO1                                     CFT009
     C                     ADD  1         I                               CFT009
     C                     MOVE '027'     ERCD,I                          CFT009
     C                     MOVE *ON       *IN45                           CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
      *                                                                   CFT009
     C           WTRIT     IFEQ *BLANKS                                   CFT009
      *                                                                   CFT009
      * Use receiver's correspondent fields                               CFT009
      *                                                                   CFT009
     C           ATYP2     IFEQ 'R'                                       CFT009
      *                                                                   CFT009
     C           WSLDT     IFLT BVLD                                      CFT009
     C                     ADD  1         I                               CFT009
     C                     MOVE '043'     ERCD,I                          CFT009
     C                     MOVE *ON       *IN48                           CFT009
     C                     ELSE                                           CFT009
     C           WSLDT     IFLT DACO2                                     CFT009
     C                     ADD  1         I                               CFT009
     C                     MOVE '042'     ERCD,I                          CFT009
     C                     MOVE *ON       *IN48                           CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
      *                                                                   CFT009
     C           WATYP5    IFEQ 'R'                                       CFT009
      *                                                                   CFT009
     C           WSLDT     IFLT BVLD                                      CFT009
     C                     MOVEL'FTM3142' FTMSID                          CFT009
     C                     MOVEL'FTUSRMSG'FTMSGF                          CFT009
     C                     MOVEL'Y'       FTNOUP                          CFT009
     C                     EXSR FTSNMS                                    CFT009
     C                     MOVE *ON       *IN83                           CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
      *                                                                   CFT009
     C           WSLDT     IFLT WDACO5                                    CFT009
     C                     MOVEL'FTM3143' FTMSID                          CFT009
     C                     MOVEL'FTUSRMSG'FTMSGF                          CFT009
     C                     MOVEL'Y'       FTNOUP                          CFT009
     C                     EXSR FTSNMS                                    CFT009
     C                     MOVE *ON       *IN83                           CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      *  Check if Pay Value Date is in the future and if the              CFT009
      *  account is closing today (if pay date is valid)                  CFT009
      *                                                                   CFT009
     C           WPYDT     IFGT BJRDNB                                    CFT009
     C           ACST3     ANDEQ'C'                                       CFT009
     C                     ADD  1         I                               CFT009
     C                     MOVE '604'     ERCD,I                          CFT009
     C                     MOVE *ON       *IN46                           CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C           WPYDT     IFGT BJRDNB                                    CFT009
     C           ACST4     ANDEQ'C'                                       CFT009
     C                     ADD  1         I                               CFT009
     C                     MOVE '603'     ERCD,I                          CFT009
     C                     MOVE *ON       *IN47                           CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** For retail accounts only check that the pay value date is not    CFT009
      ** before the backvalue limit date nor before the date the          CFT009
      ** account was opened for the account that must be in pay ccy       CFT009
      *                                                                   CFT009
     C           SACBK     IFEQ *BLANKS                                   CFT009
      *                                                                   CFT009
      * Use beneficiary customer fields                                   CFT009
      *                                                                   CFT009
     C           ATYP3     IFEQ 'R'                                       CFT009
      *                                                                   CFT009
     C           WPYDT     IFLT BVLD                                      CFT009
     C                     ADD  1         I                               CFT009
     C                     MOVE '060'     ERCD,I                          CFT009
     C                     MOVE *ON       *IN46                           CFT009
     C                     ELSE                                           CFT009
     C           WPYDT     IFLT DACO3                                     CFT009
     C                     ADD  1         I                               CFT009
     C                     MOVE '058'     ERCD,I                          CFT009
     C                     MOVE *ON       *IN46                           CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
      *                                                                   CFT009
      * Use account with bank fields                                      CFT009
      *                                                                   CFT009
     C           ATYP4     IFEQ 'R'                                       CFT009
      *                                                                   CFT009
     C           WPYDT     IFLT BVLD                                      CFT009
     C                     ADD  1         I                               CFT009
     C                     MOVE '052'     ERCD,I                          CFT009
     C                     MOVE *ON       *IN47                           CFT009
     C                     ELSE                                           CFT009
     C           WPYDT     IFLT DACO4                                     CFT009
     C                     ADD  1         I                               CFT009
     C                     MOVE '051'     ERCD,I                          CFT009
     C                     MOVE *ON       *IN47                           CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      *  Unwind subroutine stack name                                     CFT009
      *                                                                   CFT009
     C                     MOVEA*BLANKS   @STK,O                          CFT009
     C                     SUB  1         O       50                      CFT009
      *                                                                   CFT009
     CSR                   ENDSR                                          CFT009
     C/EJECT                                                              CFT009
      *****************************************************************   CFT009
      *                                                               *   CFT009
      *  MOVIDS   : Move fields into incoming DS                      *   CFT009
      *                                                               *   CFT009
      *  CALLED BY: SRSPST                                            *   CFT009
      *                                                               *   CFT009
      *  CALLS    : *NONE                                             *   CFT009
      *                                                               *   CFT009
      *****************************************************************   CFT009
     CSR         MOVIDS    BEGSR                                          CFT009
      *                                                                   CFT009
      *  Set up subroutine stack name                                     CFT009
      *                                                                   CFT009
     C                     ADD  1         O                               CFT009
     C                     MOVEL'MOVIDS'  @STK,O                          CFT009
      *                                                                   CFT009
     C                     MOVELSPDSET    FXSPSC                          CFT009
     C                     MOVE SOFCD     IPPDOF                          CFT009
     C***********          Z-ADDCDRO      INCDRO                          CFT009              CSD027
     C                     MOVELCDRO      INCDRO                                              CSD027
     C*                                                                   CFT009
     C** Input currency and charge currency                               CFT009
     C*                                                                   CFT009
     C                     SELEC                                          CFT009
     C***********CDRO      WHNE *ZEROS                                    CFT009              CSD027
     C           CDRO      WHNE *BLANKS                                                       CSD027
     C                     MOVE BJCYCD    W7ICCY                          CFT009
     C           BTCHCY    WHEQ 'C'                                       CFT009
     C           SADDC     IFEQ 'A'                                       CFT009
     C                     MOVE SSMCY     W7ICCY                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVE SPCCY     W7ICCY                          CFT009
     C                     END                                            CFT009
     C           BTCHCY    WHEQ 'L'                                       CFT009
     C                     MOVE BJLCCY    W7ICCY                          CFT009
     C           BTCHCY    WHEQ 'F'                                       CFT009
     C                     MOVE FCHCCY    W7ICCY                          CFT009
     C           BTCHCY    WHEQ 'B'                                       CFT009
     C                     MOVE BJCYCD    W7ICCY                          CFT009
     C                     OTHER                                          CFT009
     C                     Z-ADD70        DBASE                           CFT009
     C                     MOVELW7ICCY    DBKEY                           CFT009
     C                     EXSR SRERR                                     CFT009
     C                     ENDSL                                          CFT009
      *                                                                   CFT009
      * Move charges currency to INPAYXPD                                 CFT009
      *                                                                   CFT009
     C                     MOVELW7ICCY    IPCHGC                          CFT009
      *                                                                   CFT009
     C                     MOVEL*BLANKS   IPVAT1                          CFT009
     C                     MOVEL*BLANKS   IPVAT2                          CFT009
     C                     MOVEL*BLANKS   IPVAT3                          CFT009
     C                     MOVEL*BLANKS   IPVAT4                          CFT009
     C                     MOVEL*BLANKS   IPVAT5                          CFT009
     C                     MOVEL*BLANKS   IPVAT6                          CFT009
     C                     MOVEL*BLANKS   IPVAT7                          CFT009
     C                     MOVEL*BLANKS   IVTMI1                          CFT009
     C                     MOVEL*BLANKS   IVTMI2                          CFT009
     C                     MOVEL*BLANKS   IVTMI3                          CFT009
     C                     MOVEL*BLANKS   IVTMI4                          CFT009
     C                     MOVEL*BLANKS   IVTMI5                          CFT009
      *                                                                   CFT009
     C                     MOVELINVATR    IPVATR                          CFT009
     C                     MOVELINVATT    IPVATT                          CFT009
     C                     Z-ADDINDUM8    IPDUM8                          CFT009
     C                     MOVEL*BLANKS   ITLCOD                          CFT009
     C                     MOVEL*BLANKS   ICHCHC                          CFT009
     C                     MOVEL*BLANKS   IADCHC                          CFT009
     C                     MOVEL*BLANKS   ITLCHC                          CFT009
     C                     MOVEL*BLANKS   IMISCH                          CFT009
     C                     MOVEL*BLANKS   IMSCH1                          CFT009
     C                     MOVEL*BLANKS   IMSCH2                          CFT009
     C                     MOVEL*BLANKS   IMSCH3                          CFT009
     C                     MOVEL*BLANKS   IMSCH4                          CFT009
     C                     MOVEL*BLANKS   IMSCH5                          CFT009
     C                     MOVEL*BLANKS   ITFCCC                          CFT009
     C                     MOVEL*BLANKS   IFXCHE                          CFT009
     C                     Z-ADD0         INTRCM                          CFT009
     C                     Z-ADD0         ITRCMD                          CFT009
     C                     Z-ADD0         INTXCH                          CFT009
     C                     Z-ADD0         ITXCHD                          CFT009
     C                     Z-ADD0         INCQCH                          CFT009
     C                     Z-ADD0         ICQCHD                          CFT009
     C                     Z-ADD0         INADCH                          CFT009
     C                     Z-ADD0         IADCHD                          CFT009
     C                     Z-ADD0         INTLCH                          CFT009
     C                     Z-ADD0         ITLCHD                          CFT009
     C                     Z-ADD0         INMSCH                          CFT009
     C                     Z-ADD0         IMSCHD                          CFT009
     C                     Z-ADD0         IPCHCM                          CFT009
     C                     Z-ADD0         IDUMA1                          CFT009
     C                     Z-ADD0         IDUMA2                          CFT009
     C                     Z-ADD0         IDUMA3                          CFT009
     C                     Z-ADD0         IDUMA4                          CFT009
     C                     Z-ADD0         IDUMA5                          CFT009
     C                     Z-ADD0         IDUMA6                          CFT009
     C                     Z-ADD0         IPDUM7                          CFT009
     C                     Z-ADD0         IMSC01                          CFT009
     C                     Z-ADD0         IMSC02                          CFT009
     C                     Z-ADD0         IMSC03                          CFT009
     C                     Z-ADD0         IMSC04                          CFT009
     C                     Z-ADD0         IMSC05                          CFT009
     C                     Z-ADDDATNOE    IDATNO                          CFT009
     C                     Z-ADDDATNAH    IDATNA                          CFT009
     C                     MOVELCUNFLG    ICUNFL                          CFT009
     C                     Z-ADDINCHRT    IPCHRT                          CFT009
     C                     Z-ADDP#MDIN    MDIN                            CFT009
      *                                                                   CFT009
      ** Levied charge currency                                           CFT009
      *                                                                   CFT009
     C                     SELEC                                          CFT009
     C***********CDRO      WHNE *ZEROS                                    CFT009              CSD027
     C           CDRO      WHNE *BLANKS                                                       CSD027
     C                     MOVELBCCY      WCCY    3                       CFT009
     C           SADDC     WHEQ 'A'                                       CFT009
     C                     MOVELSSMCY     WCCY                            CFT009
     C           SSND1     IFEQ 'CASHIER'                                 CFT009
     C           SPCCY     ANDEQBCCY                                      CFT009
     C                     MOVELSPCCY     WCCY                            CFT009
     C                     ENDIF                                          CFT009
     C                     OTHER                                          CFT009
     C                     MOVELSPCCY     WCCY                            CFT009
     C                     ENDSL                                          CFT009
      *                                                                   CFT009
      * Save LEVIED currency                                              CFT009
     C                     MOVELWCCY      LEVIED  3                       CFT009
      *                                                                   CFT009
      * If use transaction exchange rate, move to charges X-Rate          CFT009
      *                                                                   CFT009
     C           CHTRCY    IFEQ 'Y'                                       CFT009
     C                     Z-ADDRATE      IPCHRT                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      * Default settle date                                               CFT009
      *                                                                   CFT009
     C                     Z-ADDBJRDNB    SLDT                            CFT009
      *                                                                   CFT009
      ** Setup DAF settle value date 1                                    CFT009
      *                                                                   CFT009
     C                     Z-ADDSLDT      ZDAYNO                          CFT009
     C                     EXSR ZDATE2                                    CFT009
     C                     MOVE ZDATE     SLDTD1                          CFT009
      *                                                                   CFT009
      * Default pay date                                                  CFT009
      *                                                                   CFT009
     C                     CALL 'AONOSTR0'                                CFT009
     C                     PARM *BLANKS   @RTCD   7                       CFT009
     C                     PARM '*KEY'    @OPTN   7                       CFT009
     C                     PARM CNUMPY    @CUST   6                       CFT009
     C                     PARM CCYPY     @CYCD   3                       CFT009
     C**********           PARM ACODPY    @ACCD   4                                    CFT009 CGL029
     C                     PARM ACODPY    @ACCD                                               CGL029
     C                     PARM ACSQPY    @ACSN   2                       CFT009
     C                     PARM *BLANKS   @NONB   2                       CFT009
     C                     PARM BRCAPY    @BRCD   3                       CFT009
     C                     PARM *BLANKS   @CSSN  10                       CFT009
     C                     PARM *BLANKS   @PNOI   1                       CFT009
     C           SDNOST    PARM SDNOST    DSFDY                           CFT009
      *                                                                   CFT009
     C           @RTCD     IFEQ *BLANKS                                   CFT009
     C                     MOVE CCYPY     ZCCY                            CFT009
     C                     MOVE NOSLOC    ZLOC                            CFT009
     C                     ELSE                                           CFT009
     C                     MOVE BJLCCY    ZCCY                            CFT009
     C                     MOVE BJSLCD    ZLOC                            CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C           ZCCY      IFEQ SVBCCY                                    CFT009
     C                     Z-ADDBJRDNB    ZDAYNO                          CFT009
     C                     Z-ADD1         ZNRDYS                          CFT009
     C                     EXSR ZFWDT                                     CFT009
     C                     Z-ADDZDYNBR    PVDT                            CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADDBJRDNB    ZDAYNO                          CFT009
     C                     Z-ADD2         ZNRDYS                          CFT009
     C                     EXSR ZFWDT                                     CFT009
     C                     Z-ADDZDYNBR    PVDT                            CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Setup DAF pay value date 1                                       CFT009
      *                                                                   CFT009
     C                     Z-ADDPVDT      ZDAYNO                          CFT009
     C                     EXSR ZDATE2                                    CFT009
     C                     MOVE ZDATE     PVDTD1                          CFT009
      *                                                                   CFT009
      *                                                                   CFT009
     C           *IN10     IFEQ *OFF                                      CFT009
     C           WTRIT     ANDEQ'G'                                       CFT009
     C                     MOVE BJSBRC    W1618T                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     MOVELW34RMB    IPTRIB                          CFT009
     C                     MOVELW34RMB    INTRIB                          CFT009
     C                     MOVE WTRIT     IPTRIT                          CFT009
     C                     MOVE WTRIT     INTRIT                          CFT009
      *                                                                   CFT009
      *  Unwind subroutine stack name                                     CFT009
      *                                                                   CFT009
     C                     MOVEA*BLANKS   @STK,O                          CFT009
     C                     SUB  1         O       50                      CFT009
      *                                                                   CFT009
     CSR                   ENDSR                                          CFT009
     C/EJECT                                                              CFT009
      *****************************************************************   CFT009
      *                                                               *   CFT009
      *  CHGVAT   : Default VAT flags, total VAT, VAT rate, file DAF  *   CFT009
      *             format for charges, entry charges                 *   CFT009
      *                                                               *   CFT009
      *  CALLED BY: ECINST                                            *   CFT009
      *                                                               *   CFT009
      *  CALLS    : *NONE                                             *   CFT009
      *                                                               *   CFT009
      *****************************************************************   CFT009
     CSR         CHGVAT    BEGSR                                          CFT009
      *                                                                   CFT009
      *  Set up subroutine stack name                                     CFT009
      *                                                                   CFT009
     C                     ADD  1         O                               CFT009
     C                     MOVEL'CHGVAT'  @STK,O                          CFT009
      *                                                                   CFT009
      * SET DEFAULT FLAGS TO N                                            CFT009
     C                     MOVE 'N'       IPVAT2                          CFT009
     C                     MOVE 'N'       IPVAT3                          CFT009
     C                     MOVE 'N'       IPVAT4                          CFT009
     C                     MOVE 'N'       IPVAT5                          CFT009
     C                     MOVE 'N'       IPVAT6                          CFT009
     C                     MOVE 'N'       IVTMI1                          CFT009
     C                     MOVE 'N'       IVTMI2                          CFT009
     C                     MOVE 'N'       IVTMI3                          CFT009
     C                     MOVE 'N'       IVTMI4                          CFT009
     C                     MOVE 'N'       IVTMI5                          CFT009
     C                     MOVE 'N'       IPVAT1                          CFT009
     C                     MOVE 'N'       IPVAT7                          CFT009
      *                                                                   CFT009
      *  Entry charges (saved in charges currency)                        CFT009
      *                                                                   CFT009
     C                     Z-ADDINTRCM    IDUMA1                          CFT009
     C                     Z-ADDINTXCH    IDUMA2                          CFT009
     C                     Z-ADDINCQCH    IDUMA3                          CFT009
     C                     Z-ADDINADCH    IDUMA4                          CFT009
     C                     Z-ADDINTLCH    IDUMA5                          CFT009
     C                     Z-ADDINMSCH    IDUMA6                          CFT009
     C                     Z-ADDIPCHCM    IPDUM7                          CFT009
      *                                                                   CFT009
      *  Existing charges are saved in levied currency, need to convert   CFT009
      *  as they are currently in charges currency from FT000980          CFT009
      *                                                                   CFT009
     C                     SELEC                                          CFT009
     C***********CDRO      WHNE *ZEROS                                    CFT009              CSD027
     C           CDRO      WHNE *BLANKS                                                       CSD027
     C                     MOVELBCCY      SAVCCY  3                       CFT009
     C           SADDC     WHEQ 'A'                                       CFT009
     C                     MOVELSSMCY     SAVCCY                          CFT009
     C           SSND1     IFEQ 'CASHIER'                                 CFT009
     C           SPCCY     ANDEQBCCY                                      CFT009
     C                     MOVELSPCCY     SAVCCY                          CFT009
     C                     ENDIF                                          CFT009
     C                     OTHER                                          CFT009
     C                     MOVELSPCCY     SAVCCY                          CFT009
     C                     ENDSL                                          CFT009
      *                                                                   CFT009
      * Transfer Commission                                               CFT009
     C                     CLEARP#0010                                    CFT009
     C                     MOVE IPCHGC    P#FRCY                          CFT009
     C                     Z-ADDINTRCM    P#FRAM                          CFT009
     C                     MOVE SAVCCY    P#TOCY                          CFT009
      *                                                                   CFT009
      ** Calculate Instructed amount via FT0010                           CFT009
      *                                                                   CFT009
     C                     CALL 'FT0010'                                  CFT009
     C                     PARM           P#0010                          CFT009
      *                                                                   CFT009
      ** Error calling FT0010                                             CFT009
      *                                                                   CFT009
     C           P#RTCD    IFEQ '*ERROR*'                                 CFT009
     C                     MOVEL'FT0010  'W0FILE                          CFT009
     C                     Z-ADD2         W0ERNB                          CFT009
     C                     MOVEL'*CALL '  W0KEY                           CFT009
     C                     EXSR SRERR                                     CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     MOVE P#TOAM    INTRCM                          CFT009
      *                                                                   CFT009
      * Telex Charge                                                      CFT009
     C                     CLEARP#0010                                    CFT009
     C                     MOVE IPCHGC    P#FRCY                          CFT009
     C                     Z-ADDINTXCH    P#FRAM                          CFT009
     C                     MOVE SAVCCY    P#TOCY                          CFT009
      *                                                                   CFT009
      ** Calculate Instructed amount via FT0010                           CFT009
      *                                                                   CFT009
     C                     CALL 'FT0010'                                  CFT009
     C                     PARM           P#0010                          CFT009
      *                                                                   CFT009
      ** Error calling FT0010                                             CFT009
      *                                                                   CFT009
     C           P#RTCD    IFEQ '*ERROR*'                                 CFT009
     C                     MOVEL'FT0010  'W0FILE                          CFT009
     C                     Z-ADD3         W0ERNB                          CFT009
     C                     MOVEL'*CALL '  W0KEY                           CFT009
     C                     EXSR SRERR                                     CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     MOVE P#TOAM    INTXCH                          CFT009
      *                                                                   CFT009
      * Cheque Charge                                                     CFT009
     C                     CLEARP#0010                                    CFT009
     C                     MOVE IPCHGC    P#FRCY                          CFT009
     C                     Z-ADDINCQCH    P#FRAM                          CFT009
     C                     MOVE SAVCCY    P#TOCY                          CFT009
      *                                                                   CFT009
      ** Calculate Instructed amount via FT0010                           CFT009
      *                                                                   CFT009
     C                     CALL 'FT0010'                                  CFT009
     C                     PARM           P#0010                          CFT009
      *                                                                   CFT009
      ** Error calling FT0010                                             CFT009
      *                                                                   CFT009
     C           P#RTCD    IFEQ '*ERROR*'                                 CFT009
     C                     MOVEL'FT0010  'W0FILE                          CFT009
     C                     Z-ADD4         W0ERNB                          CFT009
     C                     MOVEL'*CALL '  W0KEY                           CFT009
     C                     EXSR SRERR                                     CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     MOVE P#TOAM    INCQCH                          CFT009
      *                                                                   CFT009
      * Advice Charge                                                     CFT009
     C                     CLEARP#0010                                    CFT009
     C                     MOVE IPCHGC    P#FRCY                          CFT009
     C                     Z-ADDINADCH    P#FRAM                          CFT009
     C                     MOVE SAVCCY    P#TOCY                          CFT009
      *                                                                   CFT009
      ** Calculate Instructed amount via FT0010                           CFT009
      *                                                                   CFT009
     C                     CALL 'FT0010'                                  CFT009
     C                     PARM           P#0010                          CFT009
      *                                                                   CFT009
      ** Error calling FT0010                                             CFT009
      *                                                                   CFT009
     C           P#RTCD    IFEQ '*ERROR*'                                 CFT009
     C                     MOVEL'FT0010  'W0FILE                          CFT009
     C                     Z-ADD5         W0ERNB                          CFT009
     C                     MOVEL'*CALL '  W0KEY                           CFT009
     C                     EXSR SRERR                                     CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     MOVE P#TOAM    INADCH                          CFT009
      *                                                                   CFT009
      * Telephone charge                                                  CFT009
     C                     CLEARP#0010                                    CFT009
     C                     MOVE IPCHGC    P#FRCY                          CFT009
     C                     Z-ADDINTLCH    P#FRAM                          CFT009
     C                     MOVE SAVCCY    P#TOCY                          CFT009
      *                                                                   CFT009
      ** Calculate Instructed amount via FT0010                           CFT009
      *                                                                   CFT009
     C                     CALL 'FT0010'                                  CFT009
     C                     PARM           P#0010                          CFT009
      *                                                                   CFT009
      ** Error calling FT0010                                             CFT009
      *                                                                   CFT009
     C           P#RTCD    IFEQ '*ERROR*'                                 CFT009
     C                     MOVEL'FT0010  'W0FILE                          CFT009
     C                     Z-ADD6         W0ERNB                          CFT009
     C                     MOVEL'*CALL '  W0KEY                           CFT009
     C                     EXSR SRERR                                     CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     MOVE P#TOAM    INTLCH                          CFT009
      *                                                                   CFT009
      * Miscellaneous Charge                                              CFT009
     C                     CLEARP#0010                                    CFT009
     C                     MOVE IPCHGC    P#FRCY                          CFT009
     C                     Z-ADDINMSCH    P#FRAM                          CFT009
     C                     MOVE SAVCCY    P#TOCY                          CFT009
      *                                                                   CFT009
      ** Calculate Instructed amount via FT0010                           CFT009
      *                                                                   CFT009
     C                     CALL 'FT0010'                                  CFT009
     C                     PARM           P#0010                          CFT009
      *                                                                   CFT009
      ** Error calling FT0010                                             CFT009
      *                                                                   CFT009
     C           P#RTCD    IFEQ '*ERROR*'                                 CFT009
     C                     MOVEL'FT0010  'W0FILE                          CFT009
     C                     Z-ADD7         W0ERNB                          CFT009
     C                     MOVEL'*CALL '  W0KEY                           CFT009
     C                     EXSR SRERR                                     CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     MOVE P#TOAM    INMSCH                          CFT009
      *                                                                   CFT009
      ** FX/Change                                                        CFT009
     C                     CLEARP#0010                                    CFT009
     C                     MOVE IPCHGC    P#FRCY                          CFT009
     C                     Z-ADDIPCHCM    P#FRAM                          CFT009
     C                     MOVE SAVCCY    P#TOCY                          CFT009
      *                                                                   CFT009
      ** Calculate Instructed amount via FT0010                           CFT009
      *                                                                   CFT009
     C                     CALL 'FT0010'                                  CFT009
     C                     PARM           P#0010                          CFT009
      *                                                                   CFT009
      ** Error calling FT0010                                             CFT009
      *                                                                   CFT009
     C           P#RTCD    IFEQ '*ERROR*'                                 CFT009
     C                     MOVEL'FT0010  'W0FILE                          CFT009
     C                     Z-ADD11        W0ERNB                          CFT009
     C                     MOVEL'*CALL '  W0KEY                           CFT009
     C                     EXSR SRERR                                     CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     MOVE P#TOAM    IPCHCM                          CFT009
      *                                                                   CFT009
      ** Convert new charges (miscellaneous charges 1-5) into levied      CFT009
      ** charge currency                                                  CFT009
      *                                                                   CFT009
     C                     CLEARP#0010                                    CFT009
     C                     MOVE IPCHGC    P#FRCY                          CFT009
     C                     Z-ADDIMSC01    P#FRAM                          CFT009
     C                     MOVE SAVCCY    P#TOCY                          CFT009
      *                                                                   CFT009
      ** Calculate Instructed amount via FT0010                           CFT009
      *                                                                   CFT009
     C                     CALL 'FT0010'                                  CFT009
     C                     PARM           P#0010                          CFT009
      *                                                                   CFT009
      ** Error calling FT0010                                             CFT009
      *                                                                   CFT009
     C           P#RTCD    IFEQ '*ERROR*'                                 CFT009
     C                     MOVEL'FT0010  'W0FILE                          CFT009
     C                     Z-ADD80        W0ERNB                          CFT009
     C                     MOVEL'*CALL '  W0KEY                           CFT009
     C                     EXSR SRERR                                     CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     MOVE P#TOAM    ILMSC1                          CFT009
      *                                                                   CFT009
     C                     CLEARP#0010                                    CFT009
     C                     MOVE IPCHGC    P#FRCY                          CFT009
     C                     Z-ADDIMSC02    P#FRAM                          CFT009
     C                     MOVE SAVCCY    P#TOCY                          CFT009
      *                                                                   CFT009
      ** Calculate Instructed amount via FT0010                           CFT009
      *                                                                   CFT009
     C                     CALL 'FT0010'                                  CFT009
     C                     PARM           P#0010                          CFT009
      *                                                                   CFT009
      ** Error calling FT0010                                             CFT009
      *                                                                   CFT009
     C           P#RTCD    IFEQ '*ERROR*'                                 CFT009
     C                     MOVEL'FT0010  'W0FILE                          CFT009
     C                     Z-ADD81        W0ERNB                          CFT009
     C                     MOVEL'*CALL '  W0KEY                           CFT009
     C                     EXSR SRERR                                     CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     MOVE P#TOAM    ILMSC2                          CFT009
      *                                                                   CFT009
     C                     CLEARP#0010                                    CFT009
     C                     MOVE IPCHGC    P#FRCY                          CFT009
     C                     Z-ADDIMSC03    P#FRAM                          CFT009
     C                     MOVE SAVCCY    P#TOCY                          CFT009
      *                                                                   CFT009
      ** Calculate Instructed amount via FT0010                           CFT009
      *                                                                   CFT009
     C                     CALL 'FT0010'                                  CFT009
     C                     PARM           P#0010                          CFT009
      *                                                                   CFT009
      ** Error calling FT0010                                             CFT009
      *                                                                   CFT009
     C           P#RTCD    IFEQ '*ERROR*'                                 CFT009
     C                     MOVEL'FT0010  'W0FILE                          CFT009
     C                     Z-ADD82        W0ERNB                          CFT009
     C                     MOVEL'*CALL '  W0KEY                           CFT009
     C                     EXSR SRERR                                     CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     MOVE P#TOAM    ILMSC3                          CFT009
      *                                                                   CFT009
     C                     CLEARP#0010                                    CFT009
     C                     MOVE IPCHGC    P#FRCY                          CFT009
     C                     Z-ADDIMSC04    P#FRAM                          CFT009
     C                     MOVE SAVCCY    P#TOCY                          CFT009
      *                                                                   CFT009
      ** Calculate Instructed amount via FT0010                           CFT009
      *                                                                   CFT009
     C                     CALL 'FT0010'                                  CFT009
     C                     PARM           P#0010                          CFT009
      *                                                                   CFT009
      ** Error calling FT0010                                             CFT009
      *                                                                   CFT009
     C           P#RTCD    IFEQ '*ERROR*'                                 CFT009
     C                     MOVEL'FT0010  'W0FILE                          CFT009
     C                     Z-ADD83        W0ERNB                          CFT009
     C                     MOVEL'*CALL '  W0KEY                           CFT009
     C                     EXSR SRERR                                     CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     MOVE P#TOAM    ILMSC4                          CFT009
      *                                                                   CFT009
     C                     CLEARP#0010                                    CFT009
     C                     MOVE IPCHGC    P#FRCY                          CFT009
     C                     Z-ADDIMSC05    P#FRAM                          CFT009
     C                     MOVE SAVCCY    P#TOCY                          CFT009
      *                                                                   CFT009
      ** Calculate Instructed amount via FT0010                           CFT009
      *                                                                   CFT009
     C                     CALL 'FT0010'                                  CFT009
     C                     PARM           P#0010                          CFT009
      *                                                                   CFT009
      ** Error calling FT0010                                             CFT009
      *                                                                   CFT009
     C           P#RTCD    IFEQ '*ERROR*'                                 CFT009
     C                     MOVEL'FT0010  'W0FILE                          CFT009
     C                     Z-ADD84        W0ERNB                          CFT009
     C                     MOVEL'*CALL '  W0KEY                           CFT009
     C                     EXSR SRERR                                     CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     MOVE P#TOAM    ILMSC5                          CFT009
      *                                                                   CFT009
      ** Default VAT flags                                                CFT009
      *                                                                   CFT009
     C           CFT010    IFEQ 'Y'                                       CFT009
      *                                                                   CFT009
      ** VAT rate                                                         CFT009
      *                                                                   CFT009
     C                     Z-ADDWVATR     IPVATR                          CFT009
      *                                                                   CFT009
      ** Telex VAT flag                                                   CFT009
      *                                                                   CFT009
     C                     MOVE *BLANK    VATLIN                          CFT009
     C           ITLCOD    IFNE *BLANKS                                   CFT009
     C           ITLCOD    CHAINFTPCHGL0             90                   CFT009
      *                                                                   CFT009
     C           VATLIN    IFEQ 'Y'                                       CFT009
     C                     MOVE 'Y'       IPVAT2                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       IPVAT2                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
     C                     MOVE *BLANK    IPVAT2                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Cheque VAT flag                                                  CFT009
      *                                                                   CFT009
     C                     MOVE *BLANK    VATLIN                          CFT009
     C           ICHCHC    IFNE *BLANKS                                   CFT009
     C           ICHCHC    CHAINFTPCHGL0             90                   CFT009
      *                                                                   CFT009
     C           VATLIN    IFEQ 'Y'                                       CFT009
     C                     MOVE 'Y'       IPVAT3                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       IPVAT3                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
     C                     MOVE *BLANK    IPVAT3                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Advice VAT flag                                                  CFT009
      *                                                                   CFT009
     C                     MOVE *BLANK    VATLIN                          CFT009
     C           IADCHC    IFNE *BLANKS                                   CFT009
     C           IADCHC    CHAINFTPCHGL0             90                   CFT009
      *                                                                   CFT009
     C           VATLIN    IFEQ 'Y'                                       CFT009
     C                     MOVE 'Y'       IPVAT4                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       IPVAT4                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
     C                     MOVE *BLANK    IPVAT4                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Telephone VAT flag                                               CFT009
      *                                                                   CFT009
     C                     MOVE *BLANK    VATLIN                          CFT009
     C           ITLCHC    IFNE *BLANKS                                   CFT009
     C           ITLCHC    CHAINFTPCHGL0             90                   CFT009
      *                                                                   CFT009
     C           VATLIN    IFEQ 'Y'                                       CFT009
     C                     MOVE 'Y'       IPVAT5                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       IPVAT5                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
     C                     MOVE *BLANK    IPVAT5                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Miscellaneous VAT flag                                           CFT009
      *                                                                   CFT009
     C                     MOVE *BLANK    VATLIN                          CFT009
     C           IMISCH    IFNE *BLANKS                                   CFT009
     C           IMISCH    CHAINFTPCHGL0             90                   CFT009
      *                                                                   CFT009
     C           VATLIN    IFEQ 'Y'                                       CFT009
     C                     MOVE 'Y'       IPVAT6                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       IPVAT6                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
     C                     MOVE *BLANK    IPVAT6                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Miscellaneous 1 VAT flag                                         CFT009
      *                                                                   CFT009
     C                     MOVE *BLANK    VATLIN                          CFT009
     C           IMSCH1    IFNE *BLANKS                                   CFT009
     C           IMSCH1    CHAINFTPCHGL0             90                   CFT009
      *                                                                   CFT009
     C           VATLIN    IFEQ 'Y'                                       CFT009
     C                     MOVE 'Y'       IVTMI1                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       IVTMI1                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
     C                     MOVE *BLANK    IVTMI1                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Miscellaneous 2 VAT flag                                         CFT009
      *                                                                   CFT009
     C                     MOVE *BLANK    VATLIN                          CFT009
     C           IMSCH2    IFNE *BLANKS                                   CFT009
     C           IMSCH2    CHAINFTPCHGL0             90                   CFT009
      *                                                                   CFT009
     C           VATLIN    IFEQ 'Y'                                       CFT009
     C                     MOVE 'Y'       IVTMI2                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       IVTMI2                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
     C                     MOVE *BLANK    IVTMI2                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Miscellaneous 3 VAT flag                                         CFT009
      *                                                                   CFT009
     C                     MOVE *BLANK    VATLIN                          CFT009
     C           IMSCH3    IFNE *BLANKS                                   CFT009
     C           IMSCH3    CHAINFTPCHGL0             90                   CFT009
      *                                                                   CFT009
     C           VATLIN    IFEQ 'Y'                                       CFT009
     C                     MOVE 'Y'       IVTMI3                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       IVTMI3                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
     C                     MOVE *BLANK    IVTMI3                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Miscellaneous 4 VAT flag                                         CFT009
      *                                                                   CFT009
     C                     MOVE *BLANK    VATLIN                          CFT009
     C           IMSCH4    IFNE *BLANKS                                   CFT009
     C           IMSCH4    CHAINFTPCHGL0             90                   CFT009
      *                                                                   CFT009
     C           VATLIN    IFEQ 'Y'                                       CFT009
     C                     MOVE 'Y'       IVTMI4                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       IVTMI4                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
     C                     MOVE *BLANK    IVTMI4                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Miscellaneous 5 VAT flag                                         CFT009
      *                                                                   CFT009
     C                     MOVE *BLANK    VATLIN                          CFT009
     C           IMSCH5    IFNE *BLANKS                                   CFT009
     C           IMSCH5    CHAINFTPCHGL0             90                   CFT009
      *                                                                   CFT009
     C           VATLIN    IFEQ 'Y'                                       CFT009
     C                     MOVE 'Y'       IVTMI5                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       IVTMI5                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
     C                     MOVE *BLANK    IVTMI5                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Transfer Commission VAT flag                                     CFT009
      *                                                                   CFT009
     C                     MOVE *BLANK    VATLIN                          CFT009
     C           ITFCCC    IFNE *BLANKS                                   CFT009
     C           ITFCCC    CHAINFTPCHGL0             90                   CFT009
      *                                                                   CFT009
     C           VATLIN    IFEQ 'Y'                                       CFT009
     C                     MOVE 'Y'       IPVAT1                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       IPVAT1                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
     C                     MOVE *BLANK    IPVAT1                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** FX/change VAT flag                                               CFT009
      *                                                                   CFT009
     C                     MOVE *BLANK    VATLIN                          CFT009
     C           IFXCHE    IFNE *BLANKS                                   CFT009
     C           IFXCHE    CHAINFTPCHGL0             90                   CFT009
      *                                                                   CFT009
     C           VATLIN    IFEQ 'Y'                                       CFT009
     C                     MOVE 'Y'       IPVAT7                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       IPVAT7                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
     C                     MOVE *BLANK    IPVAT7                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
      *                                                                   CFT009
      ** Set all VAT flags to BLANKS                                      CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   IPVAT2                          CFT009
     C                     MOVE *BLANKS   IPVAT3                          CFT009
     C                     MOVE *BLANKS   IPVAT4                          CFT009
     C                     MOVE *BLANKS   IPVAT5                          CFT009
     C                     MOVE *BLANKS   IPVAT6                          CFT009
     C                     MOVE *BLANKS   IVTMI1                          CFT009
     C                     MOVE *BLANKS   IVTMI2                          CFT009
     C                     MOVE *BLANKS   IVTMI3                          CFT009
     C                     MOVE *BLANKS   IVTMI4                          CFT009
     C                     MOVE *BLANKS   IVTMI5                          CFT009
     C                     MOVE *BLANKS   IPVAT1                          CFT009
     C                     MOVE *BLANKS   IPVAT7                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** VAT totals                                                       CFT009
      *                                                                   CFT009
     C           IPVAT2    IFEQ 'Y'                                       CFT009
     C                     Z-ADDINTXCH    SUMVAT 150                      CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT    150                      CFT009
     C                     Z-ADD0         SUMVAT                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C           IPVAT3    IFEQ 'Y'                                       CFT009
     C                     Z-ADDINCQCH    VAT                             CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
      *                                                                   CFT009
     C           IPVAT4    IFEQ 'Y'                                       CFT009
     C                     Z-ADDINADCH    VAT                             CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
      *                                                                   CFT009
     C           IPVAT5    IFEQ 'Y'                                       CFT009
     C                     Z-ADDINTLCH    VAT                             CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
      *                                                                   CFT009
     C           IPVAT6    IFEQ 'Y'                                       CFT009
     C                     Z-ADDINMSCH    VAT                             CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
      *                                                                   CFT009
     C           IVTMI1    IFEQ 'Y'                                       CFT009
     C                     Z-ADDILMSC1    VAT                             CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
      *                                                                   CFT009
     C           IVTMI2    IFEQ 'Y'                                       CFT009
     C                     Z-ADDILMSC2    VAT                             CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
      *                                                                   CFT009
     C           IVTMI3    IFEQ 'Y'                                       CFT009
     C                     Z-ADDILMSC3    VAT                             CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
      *                                                                   CFT009
     C           IVTMI4    IFEQ 'Y'                                       CFT009
     C                     Z-ADDILMSC4    VAT                             CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
      *                                                                   CFT009
     C           IVTMI5    IFEQ 'Y'                                       CFT009
     C                     Z-ADDILMSC5    VAT                             CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
      *                                                                   CFT009
     C           IPVAT1    IFEQ 'Y'                                       CFT009
     C                     Z-ADDINTRCM    VAT                             CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
      *                                                                   CFT009
     C           IPVAT7    IFEQ 'Y'                                       CFT009
     C                     Z-ADDIPCHCM    VAT                             CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
      *                                                                   CFT009
      ** Calculate total VAT at end to avoid rounding errors.             CFT009
      *                                                                   CFT009
     C           IPVATR    MULT SUMVAT    VAT       H                     CFT009
     C                     Z-ADDVAT       SUMVAT                          CFT009
      *                                                                   CFT009
     C                     Z-ADDSUMVAT    IPVATT                          CFT009
      *                                                                   CFT009
      ** File DAF Format                                                  CFT009
      *                                                                   CFT009
     C           SADDC     IFEQ 'A'                                       CFT009
     C                     MOVE SSMCY     SCCCY                           CFT009
     C                     ELSE                                           CFT009
     C                     MOVE SPCCY     SCCCY                           CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C           SCCCY     IFNE BJCYCD                                    CFT009
     C                     CALL 'AOCURRR0'                                CFT009
     C                     PARM '*DBERR ' RTCD                            CFT009
     C                     PARM '*KEY   ' @OPTN                           CFT009
     C                     PARM SCCCY     @CCY                            CFT009
     C           SDCURR    PARM SDCURR    DSSDY                           CFT009
      *                                                                   CFT009
     C                     Z-ADDA6NBDP    FCDP                            CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADDBCDP      FCDP                            CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C           FCDP      ADD  1         W       10                      CFT009
      *                                                                   CFT009
      * Transfer Commission                                               CFT009
     C           INTRCM    DIV  FCTR,W    ITRCMD                          CFT009
      * Telex Charge                                                      CFT009
     C           INTXCH    DIV  FCTR,W    ITXCHD                          CFT009
      * Cheque Charge                                                     CFT009
     C           INCQCH    DIV  FCTR,W    ICQCHD                          CFT009
      * Advice charge                                                     CFT009
     C           INADCH    DIV  FCTR,W    IADCHD                          CFT009
      * Telephone charge                                                  CFT009
     C           INTLCH    DIV  FCTR,W    ITLCHD                          CFT009
      * Miscellaneous Charge                                              CFT009
     C           INMSCH    DIV  FCTR,W    IMSCHD                          CFT009
      *                                                                   CFT009
      ** VAT (charge currency)                                            CFT009
     C                     CLEARP#0010                                    CFT009
     C                     MOVE SAVCCY    P#FRCY                          CFT009
     C                     Z-ADDIPVATT    P#FRAM                          CFT009
     C                     MOVE IPCHGC    P#TOCY                          CFT009
      *                                                                   CFT009
      ** Calculate Instructed amount via FT0010                           CFT009
      *                                                                   CFT009
     C                     CALL 'FT0010'                                  CFT009
     C                     PARM           P#0010                          CFT009
      *                                                                   CFT009
      ** Error calling FT0010                                             CFT009
      *                                                                   CFT009
     C           P#RTCD    IFEQ '*ERROR*'                                 CFT009
     C                     MOVEL'FT0010  'W0FILE                          CFT009
     C                     Z-ADD12        W0ERNB                          CFT009
     C                     MOVEL'*CALL '  W0KEY                           CFT009
     C                     EXSR SRERR                                     CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     MOVE P#TOAM    IPDUM8                          CFT009
      *                                                                   CFT009
      *  Unwind subroutine stack name                                     CFT009
      *                                                                   CFT009
     C                     MOVEA*BLANKS   @STK,O                          CFT009
     C                     SUB  1         O       50                      CFT009
      *                                                                   CFT009
     CSR                   ENDSR                                          CFT009
     C/EJECT                                                              CFT009
      *****************************************************************   CFT009
      *                                                               *   CFT009
      *  MOVCHG   : Move new charges before writing                   *   CFT009
      *                                                               *   CFT009
      *  CALLED BY: ECINST                                            *   CFT009
      *                                                               *   CFT009
      *  CALLS    : *NONE                                             *   CFT009
      *                                                               *   CFT009
      *****************************************************************   CFT009
     CSR         MOVCHG    BEGSR                                          CFT009
      *                                                                   CFT009
      *  Set up subroutine stack name                                     CFT009
      *                                                                   CFT009
     C                     ADD  1         O                               CFT009
     C                     MOVEL'MOVCHG'  @STK,O                          CFT009
      *                                                                   CFT009
     C                     MOVELSPDSET    FXSPSC                          CFT009
     C                     MOVELSOFCD     INPDOF                          CFT009
     C                     MOVELIPVAT1    INVAT1                          CFT009
     C                     MOVELIPVAT2    INVAT2                          CFT009
     C                     MOVELIPVAT3    INVAT3                          CFT009
     C                     MOVELIPVAT4    INVAT4                          CFT009
     C                     MOVELIPVAT5    INVAT5                          CFT009
     C                     MOVELIPVAT6    INVAT6                          CFT009
     C                     MOVELIPVAT7    INVAT7                          CFT009
     C                     MOVELIPVATR    INVATR                          CFT009
     C                     MOVELIPVATT    INVATT                          CFT009
     C                     Z-ADDINTRCM    TRCM                            CFT009
     C                     Z-ADDITRCMD    TRCMD                           CFT009
     C                     Z-ADDINTXCH    TXCH                            CFT009
     C                     Z-ADDITXCHD    TXCHD                           CFT009
     C                     Z-ADDINCQCH    CQCH                            CFT009
     C                     Z-ADDICQCHD    CQCHD                           CFT009
     C                     Z-ADDINADCH    ADCH                            CFT009
     C                     Z-ADDIADCHD    ADCHD                           CFT009
     C                     Z-ADDINTLCH    TLCH                            CFT009
     C                     Z-ADDITLCHD    TLCHD                           CFT009
     C                     Z-ADDINMSCH    MSCH                            CFT009
     C                     Z-ADDIMSCHD    MSCHD                           CFT009
     C                     Z-ADDIPCHCM    INCHCM                          CFT009
     C                     Z-ADDIDUMA1    DUMA1                           CFT009
     C                     Z-ADDIDUMA2    DUMA2                           CFT009
     C                     Z-ADDIDUMA3    DUMA3                           CFT009
     C                     Z-ADDIDUMA4    DUMA4                           CFT009
     C                     Z-ADDIDUMA5    DUMA5                           CFT009
     C                     Z-ADDIDUMA6    DUMA6                           CFT009
     C                     Z-ADDIPDUM7    INDUM7                          CFT009
     C                     Z-ADDIPDUM8    INDUM8                          CFT009
     C                     MOVELITLCOD    TLCODE                          CFT009
     C                     MOVELICHCHC    CHCHCD                          CFT009
     C                     MOVELIADCHC    ADCHCD                          CFT009
     C                     MOVELITLCHC    TLCHCD                          CFT009
     C                     MOVELIMISCH    MISCH                           CFT009
     C                     MOVELIMSCH1    MSCH1                           CFT009
     C                     MOVELIMSCH2    MSCH2                           CFT009
     C                     MOVELIMSCH3    MSCH3                           CFT009
     C                     MOVELIMSCH4    MSCH4                           CFT009
     C                     MOVELIMSCH5    MSCH5                           CFT009
     C                     MOVELITFCCC    TFCCCO                          CFT009
     C                     MOVELIFXCHE    FXCHEC                          CFT009
     C                     MOVELIVTMI1    VTMIC1                          CFT009
     C                     MOVELIVTMI2    VTMIC2                          CFT009
     C                     MOVELIVTMI3    VTMIC3                          CFT009
     C                     MOVELIVTMI4    VTMIC4                          CFT009
     C                     MOVELIVTMI5    VTMIC5                          CFT009
     C                     Z-ADDIMSC01    CMSC01                          CFT009
     C                     Z-ADDIMSC02    CMSC02                          CFT009
     C                     Z-ADDIMSC03    CMSC03                          CFT009
     C                     Z-ADDIMSC04    CMSC04                          CFT009
     C                     Z-ADDIMSC05    CMSC05                          CFT009
     C                     Z-ADDILMSC1    MSC01                           CFT009
     C                     Z-ADDILMSC2    MSC02                           CFT009
     C                     Z-ADDILMSC3    MSC03                           CFT009
     C                     Z-ADDILMSC4    MSC04                           CFT009
     C                     Z-ADDILMSC5    MSC05                           CFT009
     C                     Z-ADDIDATNO    DATNOE                          CFT009
     C                     Z-ADDIDATNA    DATNAH                          CFT009
     C                     MOVELICUNFL    CUNFLG                          CFT009
     C                     Z-ADDIPCHRT    INCHRT                          CFT009
     C                     MOVELIPCHGC    INCHGC                          CFT009
      *                                                                   CFT009
      * If use transaction exchange rate, move to charges X-Rate          CFT009
      *                                                                   CFT009
     C           CHTRCY    IFEQ 'Y'                                       CFT009
     C                     Z-ADDRATE      INCHRT                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      *  Unwind subroutine stack name                                     CFT009
      *                                                                   CFT009
     C                     MOVEA*BLANKS   @STK,O                          CFT009
     C                     SUB  1         O       50                      CFT009
      *                                                                   CFT009
     CSR                   ENDSR                                          CFT009
      *                                                                   S01414
     C/EJECT                                                              CFT009
      *****************************************************************   CFT009
      *                                                               *   CFT009
      *  READJ    : Readjust levied charge currency and corresponding *   CFT009
      *             charge amounts                                    *   CFT009
      *                                                               *   CFT009
      *  CALLED BY: EEAMND                                            *   CFT009
      *                                                               *   CFT009
      *  CALLS    : *NONE                                             *   CFT009
      *                                                               *   CFT009
      *****************************************************************   CFT009
     CSR         READJ     BEGSR                                          CFT009
      *                                                                   CFT009
      *  Set up subroutine stack name                                     CFT009
      *                                                                   CFT009
     C                     ADD  1         O                               CFT009
     C                     MOVEL'READJ'   @STK,O                          CFT009
      *                                                                   CFT009
      ** Levied charge currency                                           CFT009
      *                                                                   CFT009
     C                     SELEC                                          CFT009
     C***********CDRO      WHNE *ZEROS                                    CFT009              CSD027
     C           CDRO      WHNE *BLANKS                                                       CSD027
     C                     MOVELBCCY      SAVCCY  3                       CFT009
     C           SADDC     WHEQ 'A'                                       CFT009
     C                     MOVELSSMCY     SAVCCY                          CFT009
     C           SSND1     IFEQ 'CASHIER'                                 CFT009
     C           SPCCY     ANDEQBCCY                                      CFT009
     C                     MOVELSPCCY     SAVCCY                          CFT009
     C                     ENDIF                                          CFT009
     C                     OTHER                                          CFT009
     C                     MOVELSPCCY     SAVCCY                          CFT009
     C                     ENDSL                                          CFT009
      *                                                                   CFT009
      * Transfer Commission                                               CFT009
     C                     CLEARP#0010                                    CFT009
     C                     MOVE INCHGC    P#FRCY                          CFT009
     C                     Z-ADDDUMA1     P#FRAM                          CFT009
     C                     MOVE SAVCCY    P#TOCY                          CFT009
      *                                                                   CFT009
      ** Calculate Instructed amount via FT0010                           CFT009
      *                                                                   CFT009
     C                     CALL 'FT0010'                                  CFT009
     C                     PARM           P#0010                          CFT009
      *                                                                   CFT009
      ** Error calling FT0010                                             CFT009
      *                                                                   CFT009
     C           P#RTCD    IFEQ '*ERROR*'                                 CFT009
     C                     MOVEL'FT0010  'W0FILE                          CFT009
     C                     Z-ADD2         W0ERNB                          CFT009
     C                     MOVEL'*CALL '  W0KEY                           CFT009
     C                     EXSR SRERR                                     CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     MOVE P#TOAM    TRCM                            CFT009
      *                                                                   CFT009
      * Telex Charge                                                      CFT009
     C                     CLEARP#0010                                    CFT009
     C                     MOVE INCHGC    P#FRCY                          CFT009
     C                     Z-ADDDUMA2     P#FRAM                          CFT009
     C                     MOVE SAVCCY    P#TOCY                          CFT009
      *                                                                   CFT009
      ** Calculate Instructed amount via FT0010                           CFT009
      *                                                                   CFT009
     C                     CALL 'FT0010'                                  CFT009
     C                     PARM           P#0010                          CFT009
      *                                                                   CFT009
      ** Error calling FT0010                                             CFT009
      *                                                                   CFT009
     C           P#RTCD    IFEQ '*ERROR*'                                 CFT009
     C                     MOVEL'FT0010  'W0FILE                          CFT009
     C                     Z-ADD3         W0ERNB                          CFT009
     C                     MOVEL'*CALL '  W0KEY                           CFT009
     C                     EXSR SRERR                                     CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     MOVE P#TOAM    TXCH                            CFT009
      *                                                                   CFT009
      * Cheque Charge                                                     CFT009
     C                     CLEARP#0010                                    CFT009
     C                     MOVE INCHGC    P#FRCY                          CFT009
     C                     Z-ADDDUMA3     P#FRAM                          CFT009
     C                     MOVE SAVCCY    P#TOCY                          CFT009
      *                                                                   CFT009
      ** Calculate Instructed amount via FT0010                           CFT009
      *                                                                   CFT009
     C                     CALL 'FT0010'                                  CFT009
     C                     PARM           P#0010                          CFT009
      *                                                                   CFT009
      ** Error calling FT0010                                             CFT009
      *                                                                   CFT009
     C           P#RTCD    IFEQ '*ERROR*'                                 CFT009
     C                     MOVEL'FT0010  'W0FILE                          CFT009
     C                     Z-ADD4         W0ERNB                          CFT009
     C                     MOVEL'*CALL '  W0KEY                           CFT009
     C                     EXSR SRERR                                     CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     MOVE P#TOAM    CQCH                            CFT009
      *                                                                   CFT009
      * Advice Charge                                                     CFT009
     C                     CLEARP#0010                                    CFT009
     C                     MOVE INCHGC    P#FRCY                          CFT009
     C                     Z-ADDDUMA4     P#FRAM                          CFT009
     C                     MOVE SAVCCY    P#TOCY                          CFT009
      *                                                                   CFT009
      ** Calculate Instructed amount via FT0010                           CFT009
      *                                                                   CFT009
     C                     CALL 'FT0010'                                  CFT009
     C                     PARM           P#0010                          CFT009
      *                                                                   CFT009
      ** Error calling FT0010                                             CFT009
      *                                                                   CFT009
     C           P#RTCD    IFEQ '*ERROR*'                                 CFT009
     C                     MOVEL'FT0010  'W0FILE                          CFT009
     C                     Z-ADD5         W0ERNB                          CFT009
     C                     MOVEL'*CALL '  W0KEY                           CFT009
     C                     EXSR SRERR                                     CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     MOVE P#TOAM    ADCH                            CFT009
      *                                                                   CFT009
      * Telephone charge                                                  CFT009
     C                     CLEARP#0010                                    CFT009
     C                     MOVE INCHGC    P#FRCY                          CFT009
     C                     Z-ADDDUMA5     P#FRAM                          CFT009
     C                     MOVE SAVCCY    P#TOCY                          CFT009
      *                                                                   CFT009
      ** Calculate Instructed amount via FT0010                           CFT009
      *                                                                   CFT009
     C                     CALL 'FT0010'                                  CFT009
     C                     PARM           P#0010                          CFT009
      *                                                                   CFT009
      ** Error calling FT0010                                             CFT009
      *                                                                   CFT009
     C           P#RTCD    IFEQ '*ERROR*'                                 CFT009
     C                     MOVEL'FT0010  'W0FILE                          CFT009
     C                     Z-ADD6         W0ERNB                          CFT009
     C                     MOVEL'*CALL '  W0KEY                           CFT009
     C                     EXSR SRERR                                     CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     MOVE P#TOAM    TLCH                            CFT009
      *                                                                   CFT009
      * Miscellaneous Charge                                              CFT009
     C                     CLEARP#0010                                    CFT009
     C                     MOVE INCHGC    P#FRCY                          CFT009
     C                     Z-ADDDUMA6     P#FRAM                          CFT009
     C                     MOVE SAVCCY    P#TOCY                          CFT009
      *                                                                   CFT009
      ** Calculate Instructed amount via FT0010                           CFT009
      *                                                                   CFT009
     C                     CALL 'FT0010'                                  CFT009
     C                     PARM           P#0010                          CFT009
      *                                                                   CFT009
      ** Error calling FT0010                                             CFT009
      *                                                                   CFT009
     C           P#RTCD    IFEQ '*ERROR*'                                 CFT009
     C                     MOVEL'FT0010  'W0FILE                          CFT009
     C                     Z-ADD7         W0ERNB                          CFT009
     C                     MOVEL'*CALL '  W0KEY                           CFT009
     C                     EXSR SRERR                                     CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     MOVE P#TOAM    MSCH                            CFT009
      *                                                                   CFT009
      ** FX/Change                                                        CFT009
     C                     CLEARP#0010                                    CFT009
     C                     MOVE INCHGC    P#FRCY                          CFT009
     C                     Z-ADDINDUM7    P#FRAM                          CFT009
     C                     MOVE SAVCCY    P#TOCY                          CFT009
      *                                                                   CFT009
      ** Calculate Instructed amount via FT0010                           CFT009
      *                                                                   CFT009
     C                     CALL 'FT0010'                                  CFT009
     C                     PARM           P#0010                          CFT009
      *                                                                   CFT009
      ** Error calling FT0010                                             CFT009
      *                                                                   CFT009
     C           P#RTCD    IFEQ '*ERROR*'                                 CFT009
     C                     MOVEL'FT0010  'W0FILE                          CFT009
     C                     Z-ADD11        W0ERNB                          CFT009
     C                     MOVEL'*CALL '  W0KEY                           CFT009
     C                     EXSR SRERR                                     CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     MOVE P#TOAM    INCHCM                          CFT009
      *                                                                   CFT009
      ** File DAF Format                                                  CFT009
      *                                                                   CFT009
     C           SADDC     IFEQ 'A'                                       CFT009
     C                     MOVE SSMCY     SCCCY                           CFT009
     C                     ELSE                                           CFT009
     C                     MOVE SPCCY     SCCCY                           CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C           SCCCY     IFNE BJCYCD                                    CFT009
     C                     CALL 'AOCURRR0'                                CFT009
     C                     PARM '*DBERR ' RTCD                            CFT009
     C                     PARM '*KEY   ' @OPTN                           CFT009
     C                     PARM SCCCY     @CCY                            CFT009
     C           SDCURR    PARM SDCURR    DSSDY                           CFT009
      *                                                                   CFT009
     C                     Z-ADDA6NBDP    FCDP                            CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADDBCDP      FCDP                            CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C           FCDP      ADD  1         W       10                      CFT009
      *                                                                   CFT009
      * Transfer Commission                                               CFT009
     C           TRCM      DIV  FCTR,W    TRCMD                           CFT009
      * Telex Charge                                                      CFT009
     C           TXCH      DIV  FCTR,W    TXCHD                           CFT009
      * Cheque Charge                                                     CFT009
     C           CQCH      DIV  FCTR,W    CQCHD                           CFT009
      * Advice charge                                                     CFT009
     C           ADCH      DIV  FCTR,W    ADCHD                           CFT009
      * Telephone charge                                                  CFT009
     C           TLCH      DIV  FCTR,W    TLCHD                           CFT009
      * Miscellaneous Charge                                              CFT009
     C           MSCH      DIV  FCTR,W    MSCHD                           CFT009
      *                                                                   CFT009
      ** VAT (levied charge currency)                                     CFT009
     C                     CLEARP#0010                                    CFT009
     C                     MOVE INCHGC    P#FRCY                          CFT009
     C                     Z-ADDINDUM8    P#FRAM                          CFT009
     C                     MOVE SAVCCY    P#TOCY                          CFT009
      *                                                                   CFT009
      ** Calculate Instructed amount via FT0010                           CFT009
      *                                                                   CFT009
     C                     CALL 'FT0010'                                  CFT009
     C                     PARM           P#0010                          CFT009
      *                                                                   CFT009
      ** Error calling FT0010                                             CFT009
      *                                                                   CFT009
     C           P#RTCD    IFEQ '*ERROR*'                                 CFT009
     C                     MOVEL'FT0010  'W0FILE                          CFT009
     C                     Z-ADD12        W0ERNB                          CFT009
     C                     MOVEL'*CALL '  W0KEY                           CFT009
     C                     EXSR SRERR                                     CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     MOVE P#TOAM    INVATT                          CFT009
      *                                                                   CFT009
      *  Unwind subroutine stack name                                     CFT009
      *                                                                   CFT009
     C                     MOVEA*BLANKS   @STK,O                          CFT009
     C                     SUB  1         O       50                      CFT009
      *                                                                   CFT009
     CSR                   ENDSR                                          CFT009
     C/EJECT                                                              S01414
      *****************************************************************   CEU006
      *                                                               *   CEU006
      *  FOCMT    : Extraction of field 72 from swift message         *   CEU006
      *                                                               *   CEU006
      *  CALLED BY: EISWFT                                            *   CEU006
      *                                                               *   CEU006
      *  CALLS    : NONE                                              *   CEU006
      *                                                               *   CEU006
      *****************************************************************   CEU006
     C           FOCMT     BEGSR                                          CEU006
      *                                                                   CEU006
      * Notified Delivery currency/amount                                 CEU006
      *                                                                   CEU006
     C                     MOVELP72       DSTRAN                          CEU006
      *                                                                   CEU006
      * Currency                                                          CEU006
      *                                                                   CEU006
     C                     MOVELTVCCY     SNDCY                           CEU006
      * Amount                                                            CEU006
      *                                                                   CEU006
      * Format amount field (change ',' decimal point to '.').            CEU006
      *                                                                   CEU006
     C                     MOVEATVAMT     YA1                             CEU006
     C                     Z-ADD1         C       30                      CEU006
      *                                                                   CEU006
     C           C         DOUGT15                                        CEU006
      *                                                                   CEU006
     C           YA1,C     IFEQ ','                                       CEU006
     C                     MOVE '.'       YA1,C                           CEU006
     C                     Z-ADD16        C                               CEU006
     C                     ELSE                                           CEU006
     C                     ADD  1         C                               CEU006
     C                     ENDIF                                          CEU006
      *                                                                   CEU006
     C                     ENDDO                                          CEU006
      *                                                                   CEU006
     C                     MOVEAYA1       AMT                             CEU006
      *                                                                   CEU006
     C                     MOVELAMT       SNDAM                           CEU006
      *                                                                   CEU006
     C                     ENDSR                                          CEU006
     C/EJECT                                                              140623
      *****************************************************************   140623
      *                                                               *   140623
      *  FOCMT2   : Extraction of field 72 from swift message         *   140623
      *             Replaces FOCMT see GEMS 140623                    *   140623
      *  CALLED BY: EISWFT                                            *   140623
      *                                                               *   140623
      *  CALLS    : NONE                                              *   140623
      *                                                               *   140623
      *****************************************************************   140623
     C           FOCMT2    BEGSR                                          140623
      *                                                                   CGL009
      ** Initialise working fields for Fontis                             CGL009
      *                                                                   CGL009
     C                     MOVE *BLANKS   WCWCY   3                       CGL009
     C                     MOVE *BLANKS   WCWAM  14                       CGL009
      *                                                                   140623
      **  Retrieve notified delivery currency and amount                  140623
      *                                                                   140623
     C***********          MOVEL'012345'  @CHK   11                140623 CFT014
     C***********          MOVE '6789.'   @CHK                     140623 CFT014
      *                                                                   140623
     C***********'/OCMT/'  SCAN P72:1     @F      30     81        140623 CGL009
     C           WCW       SCAN WCWLIN:1  @F      30     81               CGL009
      *                                                                   140623
     C           *IN81     IFEQ *ON                                       140623
      *                                                                   140623
      * Map currency code -> SNDCY                                        140623
     C                     ADD  6         @F                              140623
     C***********3         SUBSTP72:@F    SNDCY                    140623 CGL009
     C           3         SUBSTWCWLIN:@F WCWCY                           CGL009
      * Map amount -> SNDAM                                               140623
      * Move possible 15 chars to work array and work string              140623
     C                     ADD  3         @F                              140623
     C***********15        SUBSTP72:@F    @S     15                140623 CGL009
     C           15        SUBSTWCWLIN:@F @S     15                       CGL009
     C                     MOVEA@S        @A                              140623
     C                     CLEAR@S                                        140623
      *                                                                   140623
      * If ',' in amount string @S change to '.'                          140623
      * Only need to check valid chars till one ',' found                 140623
     C                     Z-ADD1         @C      30                      140623
     C                     MOVE *BLANKS   @T      1                       140623
      *                                                                   140623
     C           1         DO   15        @C                              140623
     C                     MOVE @A,@C     @T                              140623
     C           @T        IFEQ ','                                       140623
     C                     MOVE '.'       @A,@C                           140623
     C                     LEAVE                                          140623
     C                     ENDIF                                          140623
     C                     ENDDO                                          140623
      *                                                                   140623
     C                     Z-ADD1         @C                              140623
     C                     MOVE *BLANKS   @T      1                       140623
     C                     MOVEA@A        @S                              140623
      * Get amount - upto 15 chars possible                               140623
     C           @C        DOUGT15                                        140623
     C                     MOVE @A,@C     @T                              140623
     C           @CHK      CHECK@T        @F             82               140623
      *                                                                   140623
      * Char not valid must be end of amount                              140623
     C           *IN82     IFEQ *ON                                       140623
     C           @C        IFNE 1                                         140623
     C           @C        SUB  1         @F                              140623
     C***********@F        SUBST@S:1      SNDAM                    140623 CGL009
     C           @F        SUBST@S:1      WCWAM                           CGL009
     C                     ENDIF                                          140623
     C                     LEAVE                                          140623
     C                     ENDIF                                          140623
      * All chars in string ok                                            140623
     C           @C        IFEQ 15                                        140623
     C*********************MOVEL@S        SNDAM                    140623 CGL009
     C                     MOVEL@S        WCWAM                           140623
     C                     ENDIF                                          140623
      *                                                                   140623
     C                     ADD  1         @C                              140623
      *                                                                   140623
     C                     ENDDO                                          140623
      *                                                                   140623
     C                     ENDIF                                          140623
      *                                                                   CGL009
      ** Reset input variables                                            CGL009
      *                                                                   CGL009
     C                     MOVEL*BLANKS   WCWLIN256                       CGL009
     C                     MOVEL*BLANKS   WCW     6                       CGL009
      *                                                                   140623
     C                     ENDSR                                          140623
      *                                                                   140623
      *****************************************************************   056031
      *                                                               *   056031
      *  SRCLR    : Clear all positions in store                      *   056031
      *                                                               *   056031
      *  CALLED BY: CCPROC - Process detail                           *   056031
      *                                                               *   056031
      *  CALLS    : SRERR - Report errors                             *   056031
      *                                                               *   056031
      *****************************************************************   056031
     CSR         SRCLR     BEGSR                                          056031
      *                                                                   056031
      *  Set up subroutine stack name                                     056031
      *                                                                   056031
     C                     ADD  1         O                               056031
     C                     MOVEL'SRCLR'   @STK,O                          056031
      *                                                                   056031
      *  Clear arrays in AOSPOSU0                                         056031
      *                                                                   056031
     C                     CLEARC#DTA                                     056031
     C                     CALL 'AOSPOSU0'             9090               056031
     C           R#RTN     PARM *BLANKS   O#RTN   7                       056031
     C                     PARM '*CLEAR  'W0ACT   8                       056031
     C                     PARM C#DTA     O#DTA 256                       056031
      *                                                                   056031
     C           *IN90     IFEQ '1'                                       056031
     C           R#RTN     ORNE *BLANKS                                   056031
     C                     MOVEL'*CALL   'W0FILE                          056031
     C                     MOVEL'AOSPOSU0'W0KEY                           056031
     C                     Z-ADD901       W0ERNB                          056031
     C                     MOVELERR@,1    W0NARR                          056031
     C                     EXSR SRERR                                     056031
     C                     END                                            056031
     C/COPY WNCPYSRC,FT0050C207
      *                                                                   056031
      *  Unwind subroutine stack name                                     056031
      *                                                                   056031
     C           EXCLR     TAG                                            056031
     C                     MOVEA*BLANKS   @STK,O                          056031
     C                     SUB  1         O       50                      056031
      *                                                                   056031
     CSR                   ENDSR                                          056031
     C/EJECT                                                              056031
      *****************************************************************   056031
      *                                                               *   056031
      *  SRADD    : Add shadow positions to store                     *   056031
      *                                                               *   056031
      *  CALLED BY: ECINST - Insert a record                          *   056031
      *             EEAMND - Amend a record                           *   056031
      *             EGDELT - Delete a record                          *   056031
      *                                                               *   056031
      *  CALLS    : SRERR - Report errors                             *   056031
      *                                                               *   056031
      *****************************************************************   056031
     CSR         SRADD     BEGSR                                          056031
      *                                                                   056031
      *  Set up subroutine stack name                                     056031
      *                                                                   056031
     C                     ADD  1         O                               056031
     C                     MOVEL'SRADD'   @STK,O                          056031
      *                                                                   056031
      *  Define settle and pay amounts                                    056031
      *                                                                   056031
     C           *LIKE     DEFN SMAM      ##SMAM                          056031
     C           *LIKE     DEFN PYAM      ##PYAM                          056031
      *                                                                   056031
      *  Move fields to C#DTA structure and call AOSPOSU0                 056031
      *                                                                   056031
      *         S E T T L E    I N S T R U C T I O N S                    056031
      *                                                                   056031
     C                     CLEARC#DTA                                     056031
      *                                                                   CFT014
     C           INTRIT    IFNE *BLANKS                                   CFT014
     C           CFT014    ANDEQ'Y'                                       CFT014
     C                     MOVELINTRIT    C#ATYP                          CFT014
      *                                                                   CFT014
      ** Determine corresponding Midas account of IBAN account            CFT014
      ** for Third Reimbursement Institution.                             CFT014
      *                                                                   CFT014
     C           INTRIT    IFEQ 'I'                                       CFT014
     C           CFT004    ANDEQ'Y'                                       CFT014
     C                     MOVELINTRIB    P@IBAN                          CFT014
     C                     MOVE *BLANKS   DSSDY                           CFT014
     C                     CALL 'AOIBANR4'                                CFT014
     C                     PARM *BLANKS   @RTCD                           CFT014
     C                     PARM '*KEY   ' @OPTN                           CFT014
     C                     PARM           P@IBAN                          CFT014
     C           P@ACCN    PARM           DSSDY                           CFT014
      *                                                                   CFT014
     C           @RTCD     IFNE *BLANKS                                   CFT014
     C                     Z-ADD043       W0ERNB                          CFT014
     C                     MOVELP@IBAN    W0KEY                           CFT014
     C                     MOVEL'ACCNTL6' W0FILE                          CFT014
     C                     EXSR SRERR                                     CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C**********           Z-ADDIBCNUM    IMCNUM                                       CFT014 CSD027
     C                     MOVE IBCNUM    IMCNUM                                              CSD027
     C                     MOVE CCY       IMCCY                           CFT014
     C                     Z-ADDIBACOD    IMACOD                          CFT014
     C                     Z-ADDIBACSQ    IMACSQ                          CFT014
     C                     MOVE IBBRCA    IMBRCA                          CFT014
     C                     MOVELIMACNT    C#ACCT                          CFT014
     C                     EXSR SRACCT                                                        CGL029
      *                                                                   CFT014
     C                     ELSE                                           CFT014
     C                     MOVELINTRIB    C#ACCT                          CFT014
     C                     EXSR SRACCT                                                        CGL029
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
     C***********RCRT      IFNE *BLANKS                            056031 CFT014
     C           INRCRT    IFNE *BLANKS                                   CFT014
     C***********          MOVELRCRT      C#ATYP                   056031 CFT014
     C***********          MOVELRCCO      C#ACCT                   056031 CFT014
     C                     MOVELINRCRT    C#ATYP                          CFT014
      *                                                                   CFT014
      ** Determine corresponding Midas account of IBAN account            CFT014
      ** for Receiver's Correspondent.                                    CFT014
      *                                                                   CFT014
     C           INRCRT    IFEQ 'I'                                       CFT014
     C           CFT004    ANDEQ'Y'                                       CFT014
     C           34        SUBSTINRCO1:2  P@IBAN                          CFT014
     C                     MOVE *BLANKS   DSSDY                           CFT014
     C                     CALL 'AOIBANR4'                                CFT014
     C                     PARM *BLANKS   @RTCD                           CFT014
     C                     PARM '*KEY   ' @OPTN                           CFT014
     C                     PARM           P@IBAN                          CFT014
     C           P@ACCN    PARM           DSSDY                           CFT014
      *                                                                   CFT014
     C           @RTCD     IFNE *BLANKS                                   CFT014
     C                     Z-ADD044       W0ERNB                          CFT014
     C                     MOVELP@IBAN    W0KEY                           CFT014
     C                     MOVEL'ACCNTL6' W0FILE                          CFT014
     C                     EXSR SRERR                                     CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C**********           Z-ADDIBCNUM    IMCNUM                                       CFT014 CSD027
     C                     MOVE IBCNUM    IMCNUM                                              CSD027
     C                     MOVE CCY       IMCCY                           CFT014
     C                     Z-ADDIBACOD    IMACOD                          CFT014
     C                     Z-ADDIBACSQ    IMACSQ                          CFT014
     C                     MOVE IBBRCA    IMBRCA                          CFT014
     C                     MOVELIMACNT    C#ACCT                          CFT014
     C                     EXSR SRACCT                                                        CGL029
      *                                                                   CFT014
     C                     ELSE                                           CFT014
     C                     MOVELINRCO1    C#ACCT                          CFT014
     C                     EXSR SRACCT                                                        CGL029
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ELSE                                           056031
     C                     MOVELSNTP      C#ATYP                          056031
     C                     MOVELSND1      C#ACCT                          056031
     C                     EXSR SRACCT                                                        CGL029
     C                     END                                            056031
     C/COPY WNCPYSRC,FT0050C144
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     Z-ADDSLDT      C#VDAT                          056031
      *                                                                   056031
      * Set posting date according to FT Control Data                     056031
      *                                                                   056031
     C           C#PDTI    IFEQ 'I'                                       056031
     C                     Z-ADDBJRDNB    C#PSTD                          056031
     C                     ELSE                                           056031
     C           C#PDTI    IFEQ 'E'                                       056031
     C                     Z-ADDSLDT      C#PSTD                          056031
     C                     ELSE                                           056031
     C           SLDT      IFLT PVDT                                      056031
     C                     Z-ADDSLDT      C#PSTD                          056031
     C                     ELSE                                           056031
     C                     Z-ADDPVDT      C#PSTD                          056031
     C                     END                                            056031
     C                     END                                            056031
     C                     END                                            056031
      *                                                                   056031
     C                     MOVEL'I'       C#IO                            056031
     C                     MOVELSMCY      C#CCY                           056031
     C                     MOVELPYTP      C#TRYP                          056031
     C                     MOVELPREF      C#PREF                          056031
     C                     Z-ADD##SMAM    C#AMT                           056031
     C                     MOVEL'FT'      C#MOD                           056031
     C                     MOVEL'01'      C#OLRC                          056031
     C                     MOVEL##FTOV    C#FTOV                          056031
     C                     MOVEL'Y'       C#RPST                          068347
     C                     Z-ADD10        C#RPNB                          068347
     C                     MOVEL'D'       C#RTYP                          068347
     C           CAP205    IFEQ 'Y'                                                           CAP205
     C                     MOVEL'F'       C#MTYP                                              CAP205
     C                     ENDIF                                                              CAP205
      *                                                                   056031
      *  Call AOSPOSU0                                                    056031
      *                                                                   056031
     C/COPY WNCPYSRC,FT0050C049
     C                     CALL 'AOSPOSU0'             9090               056031
     C           R#RTN     PARM *BLANKS   O#RTN   7                       056031
     C                     PARM '*ADD    'W0ACT   8                       056031
     C                     PARM C#DTA     O#DTA 256                       056031
      *                                                                   056031
     C           *IN90     IFEQ '1'                                       056031
     C           R#RTN     ORNE *BLANKS                                   056031
     C                     MOVEL'*CALL   'W0FILE                          056031
     C                     MOVEL'AOSPOSU0'W0KEY                           056031
     C                     Z-ADD902       W0ERNB                          056031
     C                     MOVELERR@,1    W0NARR                          056031
     C                     EXSR SRERR                                     056031
     C                     END                                            056031
     C/COPY WNCPYSRC,FT0050C208
      *                                                                   056031
      *         P A Y          I N S T R U C T I O N S                    056031
      *                                                                   056031
      *  Only execute if Outgoing Payment not to be generated             056031
      *  - determine this by checking A/c with Bank is not a bank         056031
      *                                                                   056031
     C                     EXSR ADOTPY                                    056031
     C           @OPIN     IFNE 'Y'                                       056031
     C                     CLEARC#DTA                                     056031
     C           ACBT      IFNE *BLANKS                                   056031
     C                     MOVELACBT      C#ATYP                          056031
     C                     MOVELACBK      C#ACCT                          056031
     C                     EXSR SRACCT                                                        CGL029
     C                     MOVELACBB      C#BRCA                          056031
     C                     ELSE                                           056031
     C                     MOVELBNCT      C#ATYP                          056031
      * If not IBAN                                                       CFT004
     C           BNCT      IFNE 'I'                                       CFT004
     C           CFT004    ANDEQ'Y'                                       CFT004
     C           CFT004    ORNE 'Y'                                       CFT004
     C                     MOVELBNC1      C#ACCT                          056031
     C                     EXSR SRACCT                                                        CGL029
     C/COPY WNCPYSRC,FT0050C022
     C                     ELSE                                           CFT004
      *                                                                   CFT014
     C           34        SUBSTBNC1:2    P@IBAN                          CFT014
     C                     MOVE *BLANKS   DSSDY                           CFT014
     C                     CALL 'AOIBANR4'                                CFT014
     C                     PARM *BLANKS   @RTCD                           CFT014
     C                     PARM '*KEY   ' @OPTN                           CFT014
     C                     PARM           P@IBAN                          CFT014
     C           P@ACCN    PARM           DSSDY                           CFT014
      *                                                                   CFT014
     C           @RTCD     IFNE *BLANKS                                   CFT014
     C                     Z-ADD045       W0ERNB                          CFT014
     C                     MOVELP@IBAN    W0KEY                           CFT014
     C                     MOVEL'ACCNTL6' W0FILE                          CFT014
     C                     EXSR SRERR                                     CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C**********           Z-ADDIBCNUM    C#CNU1                                       CFT004 CSD027
     C                     MOVE IBCNUM    C#CNU1                                              CSD027
     C                     MOVE CCY       C#CCY1                          CFT004
     C                     Z-ADDIBACOD    C#ACO1                          CFT004
     C                     Z-ADDIBACSQ    C#ACS1                          CFT004
     C                     MOVE IBBRCA    C#BRC1                          CFT004
     C                     ENDIF                                          CFT004
     C                     END                                            056031
     C                     Z-ADDPVDT      C#VDAT                          056031
      *                                                                   056031
      * Set posting date according to FT Control Data                     056031
      *                                                                   056031
     C           C#PDTI    IFEQ 'I'                                       056031
     C                     Z-ADDBJRDNB    C#PSTD                          056031
     C                     ELSE                                           056031
     C           C#PDTI    IFEQ 'E'                                       056031
     C                     Z-ADDPVDT      C#PSTD                          056031
     C                     ELSE                                           056031
     C           SLDT      IFLT PVDT                                      056031
     C                     Z-ADDSLDT      C#PSTD                          056031
     C                     ELSE                                           056031
     C                     Z-ADDPVDT      C#PSTD                          056031
     C                     END                                            056031
     C                     END                                            056031
     C                     END                                            056031
      *                                                                   056031
     C                     MOVEL'O'       C#IO                            056031
     C                     MOVELPCCY      C#CCY                           056031
     C                     MOVELPYTP      C#TRYP                          056031
     C                     MOVELPREF      C#PREF                          056031
     C                     Z-SUB##PYAM    C#AMT                           056031
     C                     MOVEL'FT'      C#MOD                           056031
     C                     MOVEL'01'      C#OLRC                          056031
     C                     MOVEL##FTOV    C#FTOV                          056031
     C                     MOVEL'Y'       C#RPST                          068347
     C                     Z-ADD20        C#RPNB                          068347
     C                     MOVEL'C'       C#RTYP                          068347
     C           CAP205    IFEQ 'Y'                                                           CAP205
     C                     MOVEL'F'       C#MTYP                                              CAP205
     C                     ENDIF                                                              CAP205
     C/COPY WNCPYSRC,FT0050C057
      *                                                                   056031
      *  Call AOSPOSU0                                                    056031
      *                                                                   056031
     C                     CALL 'AOSPOSU0'             9090               056031
     C           R#RTN     PARM *BLANKS   O#RTN   7                       056031
     C                     PARM '*ADD    'W0ACT   8                       056031
     C                     PARM C#DTA     O#DTA 256                       056031
      *                                                                   056031
     C           *IN90     IFEQ '1'                                       056031
     C           R#RTN     ORNE *BLANKS                                   056031
     C                     MOVEL'*CALL   'W0FILE                          056031
     C                     MOVEL'AOSPOSU0'W0KEY                           056031
     C                     Z-ADD903       W0ERNB                          056031
     C                     MOVELERR@,1    W0NARR                          056031
     C                     EXSR SRERR                                     056031
     C                     END                                            056031
     C                     END                                            056031
     C/COPY WNCPYSRC,FT0050C209
      *                                                                   056031
      *  Unwind subroutine stack name                                     056031
      *                                                                   056031
     C           EXADD     TAG                                            056031
     C                     MOVEA*BLANKS   @STK,O                          056031
     C                     SUB  1         O       50                      056031
      *                                                                   056031
     CSR                   ENDSR                                          056031
     C/EJECT                                                              068320
      *****************************************************************   068320
      *                                                               *   068320
      *  SRSCHG   : Reverse charges from database                     *   068320
      *                                                               *   068320
      *  CALLED BY: EEAMND - Amendtaarecordd                          *   068320
      *             EGDELT - Delete a record                          *   068320
      *                                                               *   068320
      *  CALLS    : SRERR - Report errors                             *   068320
      *                                                               *   068320
      *****************************************************************   068320
     CSR         SRSCHG    BEGSR                                          068320
      *                                                                   068320
      *  Set up subroutine stack name                                     068320
      *                                                                   068320
     C                     ADD  1         O                               068320
     C                     MOVEL'SRSCHG'  @STK,O                          068320
      *                                                                   068320
      *  Move fields to C#DTA structure and call AOSPOSU0                 068320
      *                                                                   068320
     C                     CLEARC#DTA                                     068320
      *                                                                   068320
      *  If add use Receiver's Correspondent and Sender                   068320
      *                                                                   068320
     C                     SELEC                                          068320
     C           CDRT      WHNE *BLANKS                                   068320
     C                     MOVELCDRT      C#ATYP                          068320
     C                     MOVELCDRO      C#ACCT                          068320
     C                     EXSR SRACCT                                                        CGL029
     C                     MOVELCDBR      C#BRCA                          068320
     C                     MOVELBJCYCD    C#CCY                           068320
     C/COPY WNCPYSRC,FT0050C042
     C           ADDC      IFEQ 'A'                                       068320
     C                     Z-ADDSLDT      C#VDAT                          068320
     C                     ELSE                                           068320
     C                     Z-ADDPVDT      C#VDAT                          068320
     C                     END                                            068320
     C           ADDC      WHEQ 'A'                                       068320
     C                     MOVELSMCY      C#CCY                           068320
      *                                                                   CFT014
     C           INTRIT    IFNE *BLANKS                                   CFT014
     C           CFT014    ANDEQ'Y'                                       CFT014
     C                     MOVELINTRIT    C#ATYP                          CFT014
      *                                                                   CFT014
      ** Determine corresponding Midas account of IBAN account            CFT014
      ** for Third Reimbursement Institution.                             CFT014
      *                                                                   CFT014
     C           INTRIT    IFEQ 'I'                                       CFT014
     C           CFT004    ANDEQ'Y'                                       CFT014
     C                     MOVELINTRIB    P@IBAN                          CFT014
     C                     MOVE *BLANKS   DSSDY                           CFT014
     C                     CALL 'AOIBANR4'                                CFT014
     C                     PARM *BLANKS   @RTCD                           CFT014
     C                     PARM '*KEY   ' @OPTN                           CFT014
     C                     PARM           P@IBAN                          CFT014
     C           P@ACCN    PARM           DSSDY                           CFT014
      *                                                                   CFT014
     C           @RTCD     IFNE *BLANKS                                   CFT014
     C                     Z-ADD046       W0ERNB                          CFT014
     C                     MOVELP@IBAN    W0KEY                           CFT014
     C                     MOVEL'ACCNTL6' W0FILE                          CFT014
     C                     EXSR SRERR                                     CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C**********           Z-ADDIBCNUM    IMCNUM                                       CFT014 CSD027
     C                     MOVE IBCNUM    IMCNUM                                              CSD027
     C                     MOVE CCY       IMCCY                           CFT014
     C                     Z-ADDIBACOD    IMACOD                          CFT014
     C                     Z-ADDIBACSQ    IMACSQ                          CFT014
     C                     MOVE IBBRCA    IMBRCA                          CFT014
     C                     MOVELIMACNT    C#ACCT                          CFT014
     C                     EXSR SRACCT                                                        CGL029
      *                                                                   CFT014
     C                     ELSE                                           CFT014
     C                     MOVELINTRIB    C#ACCT                          CFT014
     C                     EXSR SRACCT                                                        CGL029
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
     C***********RCRT      IFNE *BLANKS                            068320 CFT014
     C           INRCRT    IFNE *BLANKS                                   CFT014
     C***********          MOVELRCRT      C#ATYP                   068320 CFT014
     C***********          MOVELRCCO      C#ACCT                   068320 CFT014
     C                     MOVELINRCRT    C#ATYP                          CFT014
      *                                                                   CFT014
      ** Determine corresponding Midas account of IBAN account            CFT014
      ** for Receiver's Correspondent.                                    CFT014
      *                                                                   CFT014
     C           INRCRT    IFEQ 'I'                                       CFT014
     C           CFT004    ANDEQ'Y'                                       CFT014
     C           34        SUBSTINRCO1:2  P@IBAN                          CFT014
     C                     MOVE *BLANKS   DSSDY                           CFT014
     C                     CALL 'AOIBANR4'                                CFT014
     C                     PARM *BLANKS   @RTCD                           CFT014
     C                     PARM '*KEY   ' @OPTN                           CFT014
     C                     PARM           P@IBAN                          CFT014
     C           P@ACCN    PARM           DSSDY                           CFT014
      *                                                                   CFT014
     C           @RTCD     IFNE *BLANKS                                   CFT014
     C                     Z-ADD047       W0ERNB                          CFT014
     C                     MOVELP@IBAN    W0KEY                           CFT014
     C                     MOVEL'ACCNTL6' W0FILE                          CFT014
     C                     EXSR SRERR                                     CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C**********           Z-ADDIBCNUM    IMCNUM                                       CFT014 CSD027
     C                     MOVE IBCNUM    IMCNUM                                              CSD027
     C                     MOVE CCY       IMCCY                           CFT014
     C                     Z-ADDIBACOD    IMACOD                          CFT014
     C                     Z-ADDIBACSQ    IMACSQ                          CFT014
     C                     MOVE IBBRCA    IMBRCA                          CFT014
     C                     MOVELIMACNT    C#ACCT                          CFT014
     C                     EXSR SRACCT                                                        CGL029
      *                                                                   CFT014
     C                     ELSE                                           CFT014
     C                     MOVELINRCO1    C#ACCT                          CFT014
     C                     EXSR SRACCT                                                        CGL029
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ELSE                                           068320
     C                     MOVELSNTP      C#ATYP                          068320
     C                     MOVELSND1      C#ACCT                          068320
     C                     EXSR SRACCT                                                        CGL029
     C                     END                                            068320
     C/COPY WNCPYSRC,FT0050C145
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     Z-ADDSLDT      C#VDAT                          068320
     C                     OTHER                                          068320
      *                                                                   068320
      *  If deduct use Account with Bank and Beneficiary                  068320
      *                                                                   068320
     C                     MOVELPCCY      C#CCY                           068320
     C           ACBT      IFNE *BLANKS                                   068320
     C                     MOVELACBT      C#ATYP                          068320
     C                     MOVELACBK      C#ACCT                          068320
     C                     EXSR SRACCT                                                        CGL029
     C                     MOVELACBB      C#BRCA                          068320
     C                     ELSE                                           068320
     C                     MOVELBNCT      C#ATYP                          068320
     C                     MOVELBNC1      C#ACCT                          068320
     C                     EXSR SRACCT                                                        CGL029
     C/COPY WNCPYSRC,FT0050C023
     C                     END                                            068320
     C                     Z-ADDPVDT      C#VDAT                          068320
     C                     END                                            068320
      *                                                                   068320
      * Set posting date according to FT Control Data                     068320
      *                                                                   068320
     C           C#PDTI    IFEQ 'I'                                       068320
     C                     Z-ADDBJRDNB    C#PSTD                          068320
     C                     ELSE                                           068320
     C           C#PDTI    IFEQ 'E'                                       068320
     C           ADDC      IFEQ 'A'                                       068320
     C                     Z-ADDSLDT      C#PSTD                          068320
     C                     ELSE                                           068320
     C                     Z-ADDPVDT      C#PSTD                          068320
     C                     END                                            068320
     C                     ELSE                                           068320
     C           SLDT      IFLT PVDT                                      068320
     C                     Z-ADDSLDT      C#PSTD                          068320
     C                     ELSE                                           068320
     C                     Z-ADDPVDT      C#PSTD                          068320
     C                     END                                            068320
     C                     END                                            068320
     C                     END                                            068320
      *                                                                   068320
     C                     MOVEL'I'       C#IO                            068320
     C                     MOVELPYTP      C#TRYP                          068320
     C                     MOVELPREF      C#PREF                          068320
     C                     MOVEL'FT'      C#MOD                           068320
     C                     MOVEL'01'      C#OLRC                          068320
     C                     MOVEL##FTOV    C#FTOV                          068320
     C           *LIKE     DEFN C#AMT     ##CHGS                          068320
     C                     Z-ADD##CHGS    C#AMT                           068320
     C                     MOVEL'Y'       C#RPST                          068347
     C                     Z-ADD30        C#RPNB                          068347
     C                     MOVEL'D'       C#RTYP                          068347
     C           CAP205    IFEQ 'Y'                                                           CAP205
     C                     MOVEL'F'       C#MTYP                                              CAP205
     C                     ENDIF                                                              CAP205
      *                                                                   068320
      *  Call AOSPOSU0                                                    068320
      *                                                                   068320
     C/COPY WNCPYSRC,FT0050C050
     C                     CALL 'AOSPOSU0'             9090               068320
     C           R#RTN     PARM *BLANKS   O#RTN   7                       068320
     C                     PARM '*ADD    'W0ACT   8                       068320
     C                     PARM C#DTA     O#DTA 256                       068320
      *                                                                   068320
     C           *IN90     IFEQ '1'                                       068320
     C           R#RTN     ORNE *BLANKS                                   068320
     C                     MOVEL'*CALL   'W0FILE                          068320
     C                     MOVEL'AOSPOSU0'W0KEY                           068320
     C                     Z-ADD942       W0ERNB                          068320
     C                     MOVELERR@,1    W0NARR                          068320
     C                     EXSR SRERR                                     068320
     C                     END                                            068320
      *                                                                   068320
     C/COPY WNCPYSRC,FT0050C189
      *  Unwind subroutine stack name                                     068320
      *                                                                   068320
     C           EXSCHG    TAG                                            068320
     C                     MOVEA*BLANKS   @STK,O                          068320
     C                     SUB  1         O       50                      068320
      *                                                                   068320
     CSR                   ENDSR                                          068320
     C/EJECT                                                              056031
      *****************************************************************   056031
      *                                                               *   056031
      *  SRUPD    : Update database with shadow positions             *   056031
      *                                                               *   056031
      *  CALLED BY: ECINST - Insert a record                          *   056031
      *             EEAMND - Amend a record                           *   056031
      *             EGDELT - Delete a record                          *   056031
      *                                                               *   056031
      *  CALLS    : SRERR - Report errors                             *   056031
      *                                                               *   056031
      *****************************************************************   056031
     CSR         SRUPD     BEGSR                                          056031
      *                                                                   056031
      *  Set up subroutine stack name                                     056031
      *                                                                   056031
     C                     ADD  1         O                               056031
     C                     MOVEL'SRUPD'   @STK,O                          056031
      *                                                                   056031
      *  Call AOSPOSU0 to update database                                 056031
      *                                                                   056031
     C                     CALL 'AOSPOSU0'             9090               056031
     C           R#RTN     PARM *BLANKS   O#RTN   7                       056031
     C                     PARM '*UPDATE 'W0ACT   8                       056031
     C                     PARM C#DTA     O#DTA 256                       056031
      *                                                                   056031
     C           *IN90     IFEQ '1'                                       056031
     C           R#RTN     ORNE *BLANKS                                   056031
     C                     MOVEL'*CALL   'W0FILE                          056031
     C                     MOVEL'AOSPOSU0'W0KEY                           056031
     C                     Z-ADD904       W0ERNB                          056031
     C                     MOVELERR@,1    W0NARR                          056031
     C                     EXSR SRERR                                     056031
     C                     END                                            056031
     C/COPY WNCPYSRC,FT0050C210
      *                                                                   056031
      *  Unwind subroutine stack name                                     056031
      *                                                                   056031
     C           EXUPD     TAG                                            056031
     C                     MOVEA*BLANKS   @STK,O                          056031
     C                     SUB  1         O                               056031
      *                                                                   056031
     CSR                   ENDSR                                          056031
     C/COPY WNCPYSRC,FT0050C045
     C/EJECT                                                              056031
      *****************************************************************   056031
      *                                                               *   056031
      *  SRERR    : Report error and close down program               *   056031
      *                                                               *   056031
      *  CALLED BY: SRCLR - Clear arrays                              *   056031
      *             SRUPD - Update Database with shadow positions     *   056031
      *             SRADD - Add shadow positions to store             *   056031
      *             CAINT - Initation subroutine                      *   056031
      *             SRBOOK- Validate Book code field                  *   056031
      *             SRPRFC- Validate Profit Centre field              *   056031
      *                                                               *   056031
      *  CALLS    : *NONE                                             *   056031
      *                                                               *   056031
      *****************************************************************   056031
     CSR         SRERR     BEGSR                                          056031
      *                                                                   056031
      *  Define work variables                                            056031
      *                                                                   056031
     C           *LIKE     DEFN @BKEY     W0KEY                           056031
     C           *LIKE     DEFN @BERNB    W0ERNB                          056031
     C           *LIKE     DEFN @BFILE    W0FILE                          056031
     C           *LIKE     DEFN @BNARR    W0NARR                          056031
      *                                                                   056031
      *  Dump program                                                     056031
      *                                                                   056031
     C                     DUMP                                           056031
      **                                                                                      CSC022
      ** Execute rollback if SAR CSC022 is not enrolled or                                    CSC022
      **   job is not currently running in batch mode                                         CSC022
      **                                                                                      CSC022
     C           CSC022    IFEQ 'N'                                                           CSC022
     C           CSC022    OREQ 'Y'                                                           CSC022
     C           WCRSKP    ANDEQ'N'                                                           CSC022
     C                     ROLBK                                          056031
     C                     ENDIF                                                              CSC022
      *                                                                   056031
      *  Send message to MOPERQ                                           056031
      *                                                                   056031
     C                     MOVEL*BLANKS   DBDTA                           056031
     C                     MOVEL'FT0050  '@BPGM                           056031
     C           O         IFGT 1                                         056031
     C           O         ANDLT21                                        056031
     C                     MOVEL@STK,O    @BSTK                           056031
     C                     ELSE                                           056031
     C                     MOVEL'*Nostkin'@BSTK                           056031
     C                     END                                            056031
     C                     MOVELW0KEY     @BKEY                           056031
     C                     Z-ADDW0ERNB    @BERNB                          056031
     C                     MOVELW0FILE    @BFILE                          056031
     C                     MOVELPREF      @BPREF                          056031
     C           W0NARR    IFEQ *BLANKS                                   056031
     C                     MOVELERR@,1    @BNARR                          056031
     C                     ELSE                                           056031
     C                     MOVELW0NARR    @BNARR                          056031
     C                     END                                            056031
      *                                                                   056031
     C                     CALL 'AOCREPT'              9090               056031
     C                     PARM 'MEM5000' #MSGID  7                       056031
     C                     PARM 'MIDAS  ' #MSGF  10                       056031
     C                     PARM *BLANKS   #MSGFL 10                       056031
     C                     PARM DBDTA     #MSGDT256                       056031
     C                     PARM '*PRV'    #MSGR   5                       056031
     C                     PARM '*'       #PRGM  10                       056031
     C                     PARM 'MOPERQ ' #MSGQ  10                       056031
     C                     PARM '*INFO  ' #MSGT   7                       056031
      *                                                                   056031
      *  Close down program                                               056031
      *                                                                   056031
     C           *LOCK     IN   DLDA                                      056031
     C                     MOVE 'FT0050  'DBPGM                           056031
     C                     MOVELW0FILE    DBFILE                          056031
     C                     Z-ADDW0ERNB    DBASE                           056031
     C                     MOVELW0KEY     DBKEY                           056031
     C                     OUT  DLDA                                      056031
     C                     SETON                     U7U8LR               056031
     C/COPY WNCPYSRC,FT0050C120
      *                                                                   042167
     C/COPY WNCPYSRC,FT0050C121
      *  Allocate dataarea to blanks                                      042167
      *                                                                   042167
     C                     EXSR DALLOC                                    042167
      *                                                                   042167
     C                     RETRN                                          056031
     C                     MOVEL*BLANKS   R#RTN   7                       056031
      *                                                                   056031
     CSR         EXERR     ENDSR                                          056031
     C/EJECT                                                              056031
     C*                                                                   S01428
     C*****************************************************************   S01428
     C**                                                                  S01428
     C**  FUNCTION:  To determine if the swift reference holds a '?'      S01428
     C**             or a valid swift reference.                          S01428
     C**                                                                  S01428
     C**  CALLS:     NONE                                                 S01428
     C**                                                                  S01428
     C**  CALLED BY: EISWFT                                               S01428
     C**                                                                  S01428
     C*****************************************************************   S01428
     C**                                                                  S01428
     C***********MSGKEY    BEGSR                                    S01428S01435
     C           SRMKEY    BEGSR                                          S01435
      *                                                                   S01428
      *  Set up subroutine stack name                                     S01428
      *                                                                   S01428
     C                     ADD  1         O                               S01428
     C***********          MOVEL'MSGKEY'  @STK,O                    S01428S01435
     C                     MOVEL'SRMKEY'  @STK,O                          S01435
      *                                                                   S01435
      * Set up part number parameter                                      S01435
      *                                                                   S01435
     C           SSEQNO    IFEQ 0                                         S01435
     C                     Z-ADD1         @KPRT                           S01435
     C                     ELSE                                           S01435
     C                     Z-ADDSSEQNO    @KPRT                           S01435
     C                     END                                            S01435
      *                                                                   S01428
      *  The swift reference may hold either a '?' or an actual swift     S01428
      *  reference. The called program will determine which.              S01428
      *                                                                   S01428
     C***********          CALL 'FTEMSGV0'             8080         S01428S01435
     C                     CALL 'ME1080'               8080               S01435
     C                     PARM '*KEY   ' @ACT    7                       S01428
     C           PHMSGR    PARM *ZEROS    @MSGR   80                      S01435
     C           PHPART    PARM           @KPRT   30                      S01435
     C***********          PARM *BLANKS   @MOR   28                 S01428S01435
     C***********          PARM SSWTN     @MIR   28                 S01428S01435
     C           PHMOR     PARM SSWTN     @MOR   28                       S01435
     C           PHMIR     PARM SSWTN     @MIR   28                       S01435
     C                     PARM *BLANKS   @RTN    7                       S01428
      *                                                                   S01428
      *  If call to program resulted in an error then end program.        S01428
      *                                                                   S01428
     C           @RTN      IFEQ '*ERROR*'                                 S01428
     C           *IN80     OREQ '1'                                       S01428
     C                     Z-ADD55        W0ERNB           ************   S01428
     C                     MOVEL'*CALL   'W0FILE           *DB ERR 55 *   S01428
     C                     MOVEL*BLANKS   W0KEY            ************   S01428
     C***********          MOVEL'FTEMSGV0'W0KEY                     S01428S01435
     C                     MOVEL'ME1080'  W0KEY                           S01435
     C                     MOVELERR@,1    W0NARR                          S01428
     C                     EXSR SRERR                                     S01428
     C                     END                                            S01428
      *                                                                   S01435
      *  F3 pressed - exit program                                        S01435
      *                                                                   S01435
     C           @RTN      IFEQ 'Y2U9999'                                 S01435
     C                     MOVEL'Y'       FTNOUP                          S01435
     C                     MOVEL'1'       PCMD                            S01435
     C                     GOTO EXKEY                                     S01435
     C                     END                                            S01435
      *                                                                   S01435
      *  F12 pressed - redisplay screen                                   S01435
      *                                                                   S01435
     C           @RTN      IFEQ 'USR0790'                                 S01435
     C                     MOVEL'Y'       FTNOUP                          S01435
      *                                                                   S01435
      * Send message 'F12 taken from selection screen'                    S01435
      *                                                                   S01435
     C                     MOVEL'MIN0001' FTMSID                          S01435
     C                     MOVEL'MEMSG'   FTMSGF                          S01435
     C                     EXSR FTSNMS                                    S01435
     C                     GOTO EXKEY                                     S01435
     C                     END                                            S01435
      *                                                                   S01428
      * If '?' was entered                                                S01428
      * ------------------                                                S01428
      *                                                                   S01428
      **If*FTM1505*-*Reserved*message*found*                        S01428S01435
      * If MIN0105 - Reserved message found                               S01435
      *                                                                   S01428
      * If there is an electronic message for the current job then        S01428
      * prepare input fields for processing                               S01428
      *                                                                   S01428
      * Messages that are selected using the '?' facility are reserved    S01428
      * at time of selection.                                             S01428
      *                                                                   S01428
     C***********@RTN      IFEQ 'FTM1505'                           S01428S01435
     C           @RTN      IFEQ 'MIN0105'                                 S01435
     C                     MOVEL'Y'       @EMSG   1                       S01428
     C                     MOVEL@MIR      SSWTN                           S01428
     C                     END                                            S01428
      *                                                                   S01428
      **If*FTM1506*-*No*reserved*messages*to*process*               S01428S01435
      * If MIN0106 - No reserved messages to process                      S01435
      *                                                                   S01428
      * If there is NOT an electronic message for the current job then    S01428
      * clear the swift reference field and seton error indicator. On     S01428
      * return to EISWFT control will return immediately to CCPROC and    S01428
      * a blank initial screen will be displayed.                         S01428
      *                                                                   S01428
     C***********@RTN      IFEQ 'FTM1506'                           S01428S01435
     C***********          MOVEL'1'       *IN75                     S01428S01435
     C***********          Z-ADD6         EI      20                S01428S01435
     C           @RTN      IFEQ 'MIN0106'                                 S01435
     C                     MOVEL'MIN0106' FTMSID                          S01435
     C                     MOVEL'MEMSG'   FTMSGF                          S01435
     C                     MOVEL'Y'       FTNOUP                          S01435
     C                     EXSR FTSNMS                                    S01435
     C                     MOVEL*BLANKS   SSWTN                           S01428
     C                     END                                            S01428
      *                                                                   S01435
      * Message may not be processed by FT                                S01435
      *                                                                   S01435
     C           @RTN      IFEQ 'MIN0197'                                 S01435
     C                     MOVEL'MIN0197' FTMSID                          S01435
     C                     MOVEL'MEMSG'   FTMSGF                          S01435
     C                     MOVEL'Y'       FTNOUP                          S01435
     C                     EXSR FTSNMS                                    S01435
     C                     MOVEL*BLANKS   SSWTN                           S01435
     C                     END                                            S01435
      *                                                                   S01428
      * If a Swift Reference was entered                                  S01428
      * --------------------------------                                  S01428
      *                                                                   S01428
      * If any errors are detected an error indicator is set on,          S01428
      * control returns to EISWFT and from there returns immediately to   S01428
      * CCPROC and the initial screen will be displayed.                  S01428
      *                                                                   S01428
      **If*FTM1501*-*swift*reference*not*found*or*invalid*          S01428S01435
      * If MIN0101 - swift reference not found or invalid                 S01435
      *                                                                   S01428
      **Error*indicator*not*set*here*because*the*condition*will*occur*1428S01435
      **again*on*the*return*to*EISWFT*and*it*will*be*handled*there.*S01428S01435
      *                                                                   S01428
     C***********@RTN      IFEQ 'FTM1501'                           S01428S01435
     C           @RTN      IFEQ 'MIN0101'                                 S01435
     C                     MOVEL'MIN0101' FTMSID                          S01435
     C                     MOVEL'MEMSG'   FTMSGF                          S01435
     C                     MOVEL'Y'       FTNOUP                          S01435
     C                     EXSR FTSNMS                                    S01435
     C                     END                                            S01428
      *                                                                   S01428
      * If MIN0100 - message part does not exist or has already been      S01435
      *              processed by Funds Transfer                          S01435
      *                                                                   S01435
     C           @RTN      IFEQ 'MIN0100'                                 S01435
     C                     MOVEL'MIN0100' FTMSID                          S01435
     C                     MOVEL'MEMSG'   FTMSGF                          S01435
     C                     MOVEL'Y'       FTNOUP                          S01435
     C                     EXSR FTSNMS                                    S01435
     C                     END                                            S01428
      *                                                                   S01435
      **If*FTM1503*-*Swift*reference*already*reserved*for*this*job* S01428S01435
      * If MIN0103 - Swift reference already reserved for this job        S01435
      *                                                                   S01428
     C***********@RTN      IFEQ 'FTM1503'                           S01428S01435
     C***********          MOVEL'1'       *IN75                     S01428S01435
     C***********          Z-ADD3         EI                        S01428S01435
     C           @RTN      IFEQ 'MIN0103'                                 S01435
     C                     MOVEL'MIN0103' FTMSID                          S01435
     C                     MOVEL'MEMSG'   FTMSGF                          S01435
     C                     MOVEL'Y'       FTNOUP                          S01435
     C                     EXSR FTSNMS                                    S01435
     C                     END                                            S01428
      *                                                                   S01428
      **If*FTM1504*-*Swift*reference*reserved*for*another*job*      S01428S01435
      * If MIN0104 - Swift reference reserved for another job             S01435
      *                                                                   S01428
     C***********@RTN      IFEQ 'FTM1504'                           S01428S01435
     C***********          MOVEL'1'       *IN75                     S01428S01435
     C***********          Z-ADD4         EI                        S01428S01435
     C           @RTN      IFEQ 'MIN0104'                                 S01435
     C                     MOVEL'MIN0104' FTMSID                          S01435
     C                     MOVEL'MEMSG'   FTMSGF                          S01435
     C                     MOVEL'Y'       FTNOUP                          S01435
     C                     EXSR FTSNMS                                    S01435
     C                     END                                            S01428
      *                                                                   S01428
      **If*FTM1502*-*valid*swift*reference*found*-*not*yet*reserved*S01428S01435
      * If MIN0112 - valid swift reference found - not yet reserved       S01435
      *                                                                   S01428
      * If the swift reference is valid and available for use then        S01428
      * a reservation on the Reserved Messages file will be made after    S01428
      * further validation in EISWFT.                                     S01428
      *                                                                   S01428
      * Messages that are selected using the '?' facility are reserved    S01428
      * at time of selection.                                             S01428
      *                                                                   S01428
     C***********@RTN      IFEQ 'FTM1502'                           S01428S01435
     C***********          Z-ADD2         EI                        S01428S01435
     C           @RTN      IFEQ 'MIN0112'                                 S01435
     C                     MOVEL'MIN0112' FTMSID                          S01435
     C                     MOVEL'MEMSG'   FTMSGF                          S01435
     C                     EXSR FTSNMS                                    S01435
     C                     END                                            S01428
      *                                                                   S01428
      *  Unwind subroutine stack name                                     S01428
      *                                                                   S01428
     C           EXKEY     TAG                                            S01428
     C                     MOVEA*BLANKS   @STK,O                          S01428
     C                     SUB  1         O                               S01428
      *                                                                   S01428
     C                     ENDSR                                          S01428
     C/EJECT                                                              S01428
     C*****************************************************************   S01428
     C**                                                                  S01428
     C**  FUNCTION:  To reserve a selected/entered electronic message     S01428
     C**             for use by the current job only.                     S01428
     C**                                                                  S01428
     C**  CALLS:     NONE                                                 S01428
     C**                                                                  S01428
     C**  CALLED BY: EISWFT                                               S01428
     C**                                                                  S01428
     C*****************************************************************   S01428
     C**                                                                  S01428
     C           MSGRSV    BEGSR                                          S01428
      *                                                                   S01428
      *  Set up subroutine stack name                                     S01428
      *                                                                   S01428
     C                     ADD  1         O                               S01428
     C                     MOVEL'MSGRSV'  @STK,O                          S01428
      *                                                                   S01428
      *  The swift reference must be written to the reserved messages     S01428
      *  file to prevent other workstations accessing it for update       S01428
      *                                                                   S01428
     C***********          CALL 'FTEMSGU0'             8080         S01428S01435
     C                     CALL 'ME1070'               8080               S01435
     C                     PARM '*RESERV' @ACT    7                       S01428
     C                     PARM           @MSGR                           S01435
     C                     PARM           @KPRT                           S01435
     C                     PARM           @MOR   28                       S01428
     C                     PARM           @MIR   28                       S01428
     C                     PARM *BLANKS   @RTN    7                       S01428
      *                                                                   S01428
      *  If call to program resulted in an error then end program.        S01428
      *                                                                   S01428
     C           @RTN      IFEQ '*ERROR*'                                 S01428
     C           *IN80     OREQ '1'                                       S01428
     C                     Z-ADD56        W0ERNB           ************   S01428
     C                     MOVEL'*CALL   'W0FILE           *DB ERR 56 *   S01428
     C                     MOVEL*BLANKS   W0KEY            ************   S01428
     C***********          MOVEL'FTEMSGU0'W0KEY                     S01428S01435
     C                     MOVEL'ME1070'  W0KEY                           S01435
     C                     MOVELERR@,1    W0NARR                          S01428
     C                     EXSR SRERR                                     S01428
     C                     END                                            S01428
      *                                                                   S01428
      * If any errors are detected an error indicator is set on,          S01428
      * control returns to EISWFT and from there returns immediately to   S01428
      * CCPROC and the initial screen will be displayed.                  S01428
      *                                                                   S01428
      **If*FTM1507*-*Message*previously*reserved*for*this*job*      S01428S01435
      * If MIN0107 - Message previously reserved for this job             S01435
      *                                                                   S01428
     C***********@RTN      IFEQ 'FTM1507'                           S01428S01435
     C***********          MOVEL'1'       *IN75                     S01428S01435
     C***********          Z-ADD7         EI                        S01428S01435
     C           @RTN      IFEQ 'MIN0107'                                 S01435
     C                     MOVEL'MIN0107' FTMSID                          S01435
     C                     MOVEL'MEMSG'   FTMSGF                          S01435
     C                     MOVEL'Y'       FTNOUP                          S01435
     C                     EXSR FTSNMS                                    S01435
     C                     END                                            S01428
      *                                                                   S01428
      **If*FTM1508*-*Message*Already*reserved*for*another*job*      S01428S01435
      * If MIN0108 - Message Already reserved for another job             S01435
      *                                                                   S01428
     C***********@RTN      IFEQ 'FTM1508'                           S01428S01435
     C***********          MOVEL'1'       *IN75                     S01428S01435
     C***********          Z-ADD8         EI                        S01428S01435
     C           @RTN      IFEQ 'MIN0108'                                 S01435
     C                     MOVEL'MIN0108' FTMSID                          S01435
     C                     MOVEL'MEMSG'   FTMSGF                          S01435
     C                     MOVEL'Y'       FTNOUP                          S01435
     C                     EXSR FTSNMS                                    S01435
     C                     END                                            S01428
      *                                                                   S01428
      * If the swift reference is valid and available for use then        S01428
      * a reservation on the Reserved Messages file was made.             S01428
      *                                                                   S01428
      **If*FTM1509*-*Message*is*now*reserved*for*this*job*          S01428S01435
      * If MIN0109 - Message is now reserved for this job                 S01435
      *                                                                   S01428
     C***********@RTN      IFEQ 'FTM1509'                           S01428S01435
     C***********          Z-ADD9         EI                        S01428S01435
     C           @RTN      IFEQ 'MIN0109'                                 S01435
     C                     MOVEL'MIN0109' FTMSID                          S01435
     C                     MOVEL'MEMSG'   FTMSGF                          S01435
     C                     EXSR FTSNMS                                    S01435
      *                                                                   S01428
     C                     MOVELTIME      TIMEX                           S01428
     C                     MOVEL'FT'      MDID                            S01428
     C                     MOVEL'FT0050'  PGMN                            S01428
     C                     MOVELWSID      WSIDX                           S01428
     C                     MOVELSACTCD    ACTCDX                          S01428
     C                     MOVELUSRID     USRIDX                          S01428
      **                                                                                      CSC022
      ** Execute commit if SAR CSC022 is not enrolled or                                      CSC022
      **   job is not currently running in batch mode                                         CSC022
      **                                                                                      CSC022
     C           CSC022    IFEQ 'N'                                                           CSC022
     C           CSC022    OREQ 'Y'                                                           CSC022
     C           WCRSKP    ANDEQ'N'                                                           CSC022
     C           CMTTXT    COMIT                                          S01428
     C                     ENDIF                                                              CSC022
     C                     END                                            S01428
      *                                                                   S01428
      *  Unwind subroutine stack name                                     S01428
      *                                                                   S01428
     C           EXRSV     TAG                                            S01428
     C                     MOVEA*BLANKS   @STK,O                          S01428
     C                     SUB  1         O                               S01428
      *                                                                   S01428
     C                     ENDSR                                          S01428
     C/EJECT                                                              S01428
     C*****************************************************************   S01428
     C**                                                                  S01428
     C**  FUNCTION:  To check if there are more selected Electronic       S01428
     C**             Messages to be processed.                            S01428
     C**                                                                  S01428
     C**  CALLS:     NONE                                                 S01428
     C**                                                                  S01428
     C**  CALLED BY: CCPROC                                               S01428
     C**                                                                  S01428
     C*****************************************************************   S01428
     C**                                                                  S01428
     C           MSGNXT    BEGSR                                          S01428
      *                                                                   S01428
      *  Set up subroutine stack name                                     S01428
      *                                                                   S01428
     C                     ADD  1         O                               S01428
     C                     MOVEL'MSGNXT'  @STK,O                          S01428
      *                                                                   S01428
      *  All electronic messages selected are held on the file FTINMGPD   S01428
      *  for reservation purposes. This file must be checked to see if    S01428
      *  there are any more outstanding for the current job.              S01428
      *                                                                   S01428
     C***********          CALL 'FTEMSGV0'             8080         S01428S01435
     C                     CALL 'ME1080'               8080               S01435
     C                     PARM '*NEXT  ' @ACT    7                       S01428
     C***********          PARM *ZEROS    @MSGR                    S01435 097263
     C***********          PARM *ZEROS    @KPRT                    S01435 097263
     C***********          PARM *BLANKS   @MOR   28                S01428 097263
     C***********          PARM *BLANKS   @MIR   28                S01428 097263
     C           PHMSGR    PARM *ZEROS    @MSGR                           097263
     C           PHPART    PARM *ZEROS    @KPRT                           097263
     C           PHMOR     PARM *BLANKS   @MOR                            097263
     C           PHMIR     PARM *BLANKS   @MIR                            097263
     C                     PARM *BLANKS   @RTN    7                       S01428
      *                                                                   S01428
      *  If call to program resulted in an error then end program.        S01428
      *                                                                   S01428
     C           @RTN      IFEQ '*ERROR*'                                 S01428
     C           *IN80     OREQ '1'                                       S01428
     C                     Z-ADD57        W0ERNB           ************   S01428
     C                     MOVEL'*CALL   'W0FILE           *DB ERR 57 *   S01428
     C                     MOVEL*BLANKS   W0KEY            ************   S01428
     C***********          MOVEL'FTEMSGV0'W0KEY                     S01428S01435
     C                     MOVEL'ME1080'  W0KEY                           S01435
     C                     MOVELERR@,1    W0NARR                          S01428
     C                     EXSR SRERR                                     S01428
     C                     END                                            S01428
      *                                                                   S01428
      **If*FTM1505*-*Reserved*message*found*                        S01428S01435
      * If MIN0105 - Reserved message found                               S01435
      *                                                                   S01428
      * If there is an electronic message for the current job then        S01428
      * prepare input fields for processing                               S01428
      *                                                                   S01428
     C***********@RTN      IFEQ 'FTM1505'                           S01428S01435
     C           @RTN      IFEQ 'MIN0105'                                 S01435
     C                     MOVEL'Y'       @EMSG   1                       S01428
     C                     MOVEL'I'       SACTCD                          S01428
     C                     MOVEL*BLANKS   SPREF                           S01428
     C                     MOVEL@MIR      SSWTN                           S01428
     C                     Z-ADD0         SSEQNO                          S01428
     C                     END                                            S01428
      *                                                                   S01428
      **If*FTM1506*-*No*reserved*messages*to*process*               S01428S01435
      * If MIN0106 - No reserved messages to process                      S01435
      *                                                                   S01428
      * If there is NOT an electronic message for the current job then    S01428
      * on return to CCPROC, control will return to the mainline and a    S01428
      * blank initial screen will be displayed.                           S01428
      *                                                                   S01428
     C***********@RTN      IFEQ 'FTM1506'                           S01428S01435
     C           @RTN      IFEQ 'MIN0106'                                 S01435
     C                     MOVEL'N'       @EMSG   1                       S01428
     C                     MOVEL*BLANKS   SACTCD                          S01428
     C                     MOVEL*BLANKS   SPREF                           S01428
     C                     MOVEL*BLANKS   SSWTN                           S01428
     C                     MOVEL*BLANKS   SBRCA                           S01428
     C                     Z-ADD0         SSEQNO                          S01428
     C***********          Z-ADD6         EI                        S01428S01435
     C                     MOVEL'MIN0106' FTMSID                          S01435
     C                     MOVEL'MEMSG'   FTMSGF                          S01435
     C                     EXSR FTSNMS                                    S01435
     C                     END                                            S01428
      *                                                                   S01428
      *  Unwind subroutine stack name                                     S01428
      *                                                                   S01428
     C                     MOVEA*BLANKS   @STK,O                          S01428
     C                     SUB  1         O                               S01428
      *                                                                   S01428
     C                     ENDSR                                          S01428
     C/EJECT                                                              S01428
     C*****************************************************************   S01428
     C**                                                                  S01428
     C**  FUNCTION:  To remove ALL electronic messages that are           S01428
     C**             reserved for the current job.                        S01428
     C**                                                                  S01428
     C**  CALLS:     NONE                                                 S01428
     C**                                                                  S01428
     C**  CALLED BY: CCPROC                                               S01428
     C**                                                                  S01428
     C*****************************************************************   S01428
     C**                                                                  S01428
     C           MSGEND    BEGSR                                          S01428
      *                                                                   S01428
      *  Set up subroutine stack name                                     S01428
      *                                                                   S01428
     C                     ADD  1         O                               S01428
     C                     MOVEL'MSGEND'  @STK,O                          S01428
      *                                                                   S01428
      *  All electronic messages selected are held on the file FTINMGPD   S01428
      *  for reservation purposes. This file must be cleared of all       S01428
      *  electronic messages that were selected for the current job.      S01428
      *                                                                   S01428
     C***********          CALL 'FTEMSGU0'             8080         S01428S01435
     C                     CALL 'ME1070'               8080               S01435
     C                     PARM '*END   ' @ACT    7                       S01428
     C                     PARM *ZEROS    @MSGR                           S01435
     C                     PARM *ZEROS    @KPRT                           S01435
     C                     PARM *BLANKS   @MOR   28                       S01428
     C                     PARM *BLANKS   @MIR   28                       S01428
     C                     PARM *BLANKS   @RTN    7                       S01428
      *                                                                   S01428
      *  If call to program resulted in an error then end program.        S01428
      *                                                                   S01428
     C           @RTN      IFEQ '*ERROR*'                                 S01428
     C           *IN80     OREQ '1'                                       S01428
     C                     Z-ADD58        W0ERNB           ************   S01428
     C                     MOVEL'*CALL   'W0FILE           *DB ERR 58 *   S01428
     C                     MOVEL*BLANKS   W0KEY            ************   S01428
     C***********          MOVEL'FTEMSGU0'W0KEY                     S01428S01435
     C                     MOVEL'ME1070'  W0KEY                           S01435
     C                     MOVELERR@,1    W0NARR                          S01428
     C                     EXSR SRERR                                     S01428
     C                     END                                            S01428
      *                                                                   S01428
      * If all reserved records were successfully cleared then set the    S01428
      * Electronic Message Processing flag and commit the file update.    S01428
      *                                                                   S01428
      **If*FTM1511*-*Reservation*Processing*Cancelled*For*Job*      S01428S01435
      * If MIN0111 - Reservation Processing Cancelled For Job             S01435
      *                                                                   S01428
     C***********@RTN      IFEQ 'FTM1511'                           S01428S01435
     C           @RTN      IFEQ 'MIN0111'                                 S01435
     C                     MOVEL' '       @EMSG                           S01428
      *                                                                   S01428
     C                     MOVELTIME      TIMEX                           S01428
     C                     MOVEL'FT'      MDID                            S01428
     C                     MOVEL'FT0050'  PGMN                            S01428
     C                     MOVELWSID      WSIDX                           S01428
     C                     MOVELSACTCD    ACTCDX                          S01428
     C                     MOVELUSRID     USRIDX                          S01428
      **                                                                                      CSC022
      ** Execute commit if SAR CSC022 is not enrolled or                                      CSC022
      **   job is not currently running in batch mode                                         CSC022
      **                                                                                      CSC022
     C           CSC022    IFEQ 'N'                                                           CSC022
     C           CSC022    OREQ 'Y'                                                           CSC022
     C           WCRSKP    ANDEQ'N'                                                           CSC022
     C           CMTTXT    COMIT                                          S01428
     C                     ENDIF                                                              CSC022
     C                     END                                            S01428
      *                                                                   S01428
      *  Unwind subroutine stack name                                     S01428
      *                                                                   S01428
     C                     MOVEA*BLANKS   @STK,O                          S01428
     C                     SUB  1         O                               S01428
      *                                                                   S01428
     C                     ENDSR                                          S01428
     C/EJECT                                                              S01428
     C*****************************************************************   S01428
     C**                                                                  S01428
     C**  FUNCTION:  To remove the reserved electronic message that has   S01428
     C**             just been inserted and updated.                      S01428
     C**                                                                  S01428
     C**  CALLS:     NONE                                                 S01428
     C**                                                                  S01428
     C**  CALLED BY: ECINST                                               S01428
     C**                                                                  S01428
     C*****************************************************************   S01428
     C**                                                                  S01428
     C           MSGDEL    BEGSR                                          S01428
      *                                                                   S01428
      *  Set up subroutine stack name                                     S01428
      *                                                                   S01428
     C                     ADD  1         O                               S01428
     C                     MOVEL'MSGDEL'  @STK,O                          S01428
      *                                                                   S01428
      *  All electronic messages selected are held on the file FTINMGPD   S01428
      *  for reservation purposes.                                        S01428
      *                                                                   S01428
      *  The electronic message that was just inserted must be removed    S01428
      *  from the file.                                                   S01428
      *                                                                   S01428
      *  The COMIT is done on the succesful completion of Insert          S01428
      *  processing.                                                      S01428
      *                                                                   S01428
      *                                                                   S01435
      * Set up message ref. and part nbr. if FT0050 is called from        S01435
      * enquiry function.                                                 S01435
      *                                                                   S01435
     C           *IN66     IFEQ '1'                                       S01435
     C                     Z-ADDPHMSGR    @MSGR                           S01435
     C                     Z-ADDPHPART    @KPRT                           S01435
     C                     END                                            S01435
      *                                                                   S01435
     C***********          CALL 'FTEMSGU0'             8080         S01428S01435
     C                     CALL 'ME1070'               8080               S01435
     C                     PARM '*DEL   ' @ACT    7                       S01428
     C                     PARM           @MSGR                           S01435
     C                     PARM           @KPRT                           S01435
     C                     PARM           @MOR   28                       S01428
     C                     PARM           @MIR   28                       S01428
     C                     PARM *BLANKS   @RTN    7                       S01428
      *                                                                   S01428
      *  If call to program resulted in an error then end program.        S01428
      *                                                                   S01428
     C           @RTN      IFEQ '*ERROR*'                                 S01428
     C           *IN80     OREQ '1'                                       S01428
     C                     Z-ADD59        W0ERNB           ************   S01428
     C                     MOVEL'*CALL   'W0FILE           *DB ERR 59 *   S01428
     C                     MOVEL*BLANKS   W0KEY            ************   S01428
     C***********          MOVEL'FTEMSGU0'W0KEY                     S01428S01435
     C                     MOVEL'ME1070'  W0KEY                           S01435
     C                     MOVELERR@,1    W0NARR                          S01428
     C                     EXSR SRERR                                     S01428
     C                     END                                            S01428
      *                                                                   S01428
      **If*FTM1510*-*Reservation*For*Message*Removed*               S01428S01435
      * If MIN0110 - Reservation For Message Removed                      S01435
      *                                                                   S01428
     C***********@RTN      IFEQ 'FTM1510'                           S01428S01435
     C           @RTN      IFEQ 'MIN0110'                                 S01435
     C                     END                                            S01428
      *                                                                   S01428
      *  Unwind subroutine stack name                                     S01428
      *                                                                   S01428
     C                     MOVEA*BLANKS   @STK,O                          S01428
     C                     SUB  1         O                               S01428
      *                                                                   S01428
     C                     ENDSR                                          S01428
     C/EJECT                                                              S01428
      *****************************************************************   S01435
      *                                                               *   S01435
      *  SRINFT   : Update Incoming Message FT Transaction Status     *   S01435
      *             File record                                       *   S01435
      *  CALLS    : SRERR   - report error and close down program     *   S01435
      *                                                               *   S01435
      *                                                               *   S01435
      *  CALLED BY: ECINST                                            *   S01435
      *             EEAMND                                            *   S01435
      *             EGDELT                                            *   S01435
      *                                                               *   S01435
      *****************************************************************   S01435
     CSR         SRINFT    BEGSR                                          S01435
      *                                                                   S01435
      *  Set up subroutine stack name                                     S01435
      *                                                                   S01435
     C                     ADD  1         O                               S01435
     C                     MOVEL'SRINFT'  @STK,O                          S01435
      *                                                                   S01435
      *  Fill record format data structure with available data            S01435
      *                                                                   S01435
     C                     CLEARINFT                                      S01435
      *                                                                   S01435
     C           INTRIT    IFNE *BLANKS                                   CFT014
     C           CFT014    ANDEQ'Y'                                       CFT014
     C                     MOVELWTRIDS    FTFRWR                          CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
     C***********RCRT      IFNE *BLANKS                            S01435 CFT014
     C           INRCRT    IFNE *BLANKS                                   CFT014
     C**********           MOVELRCCDS     FTFRWR 18                                    S01435 CGL029
     C                     MOVELRCCDS     FTFRWR 24                                           CGL029
     C                     ELSE                                           S01435
     C                     MOVELSNDDS     FTFRWR                          S01435
     C                     END                                            S01435
     C/COPY WNCPYSRC,FT0050C146
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           ACBT      IFNE *BLANKS                                   S01435
     C**********           MOVELACBDS     FTTOWR 18                                    S01435 CGL029
     C                     MOVELACBDS     FTTOWR 24                                           CGL029
     C                     ELSE                                           S01435
     C                     MOVELBNCDS     FTTOWR                          S01435
     C                     END                                            S01435
      *                                                                   S01435
     C                     Z-ADDINMSGR    FTMSGR           Unique Ref.    S01435
     C                     Z-ADDINKPRT    FTKPRT           Part No.       S01435
     C                     MOVELBRCA      FTBRCA           Branch Code    S01435
     C                     MOVELW0FLAG    FTINFG           Incoming Flag  S01435
     C                     MOVELPREF      FTIPRF           Incom. Pay. RefS01435
     C                     MOVELFTFRWR    FTFRGL           Funds From     S01435
     C                     MOVELFTTOWR    FTTOGL           Funds To       S01435
      *                                                                   S01435
     C                     MOVELW0LMSG    W2LMSG           Log file Msg IDS01435
     C                     MOVELPNWRK     W2NWRK           Network        S01435
      *                                                                   S01435
      *  N.B. Audit Stamp details are determined in called program        S01435
      *                                                                   S01435
      *                                                                   S01435
      *  Set up data to be passed using the rcd format data structure     S01435
      *                                                                   S01435
     C                     CALL 'ME1050'               90                 S01435
     C                     PARM '*FT INC 'W2ACT   8                       S01435
     C                     PARM ##PGM     W2CPGM 10                       S01435
     C                     PARM           W2NWRK  6                       S01435
     C                     PARM           W2LMSG  7                       S01435
     C                     PARM           INFT                            S01435
     C                     PARM *BLANKS   W2RTN   7                       S01435
      *                                                                   S01435
      *  If return with an error (LR seton in called program) then        S01435
      *  process for database error.                                      S01435
      *                                                                   S01435
     C           *IN90     IFEQ '1'                                       S01435
     C           W2RTN     OREQ '*ERROR*'                                 S01435
     C                     MOVEL'ME1050  'W0FILE           ***************S01435
     C                     MOVEL'*CALL'   W0KEY            * DB ERROR 61 *S01435
     C                     Z-ADD61        W0ERNB           ***************S01435
     C                     EXSR SRERR                                     S01435
     C                     END                                            S01435
      *                                                                   S01435
      *  Unwind subroutine stack name                                     S01435
      *                                                                   S01435
     C           EXLOG     TAG                                            S01435
     C                     MOVEA*BLANKS   @STK,O                          S01435
     C                     SUB  1         O                               S01435
      *                                                                   S01435
     CSR                   ENDSR                                          S01435
     C/EJECT                                                              S01435
     C**
     C**
     C********************************************************************
     C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
     C*   IND '99' IS SET BY AN OVERFLOW ERROR
     C*
     C           GLZADD    BEGSR                           *** GLZADD ****
     C*
     C                     Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT
     C   91                GOTO ZZAEND                     AMT = 0.BYPASS
     C*
     C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
     C                     Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
     C                     MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD
     C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
     C*
     C                     EXSR GLZSUM
     C           ZZAEND    ENDSR                           ** ZZAEND TAG *
     C/EJECT
     C*
     C********************************************************************
     C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
     C*                        GLZADD, GLZSUB, GLZCMP.
     C*          PARAMETERS PASSED -
     C*                     I/P ZZAMTI ZZAMTD
     C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
     C*
     C           GLZSUM    BEGSR                           *** GLZSUM ****
     C*
     C                     Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
     C                     Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
     C                     SETOF                     919293
     C                     SETOF                     949599
     C*
     C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
     C           ZZAMTI    COMP 0                      9293
     C   93      ZZAMTD    COMP 0                      9293
     C   93                GOTO ZZSEND                     ZERO BYPASS
     C*
     C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
     C           ZZTOTI    COMP 0                      9193
     C   93      ZZTOTD    COMP 0                      9193
     C*
     C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
     C   93                Z-ADDZZAMTI    ZZTOTI
     C   93                Z-ADDZZAMTD    ZZTOTD
     C   93                GOTO ZZSEND                     ZERO BYPASS
     C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
     C   91N92
     CORN91 92             GOTO ZZOFPS
     C*
     C           ZZAMTD    ADD  ZZTOTD    ZZWK2   40
     C           ZZWK2     COMP 999                  93    '93' = CARRY
     C  N93      ZZWK2     COMP -999                   93    INTO INTEGER.
     C*
     C   93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
     C      93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
     C   93      ZZTOTI    ADD  ZZWK3     ZZWK3
     C  N93      ZZTOTI    ADD  ZZAMTI    ZZWK3
     C*
     C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
     C  N92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
     C   92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
     C  N99                Z-ADDZZWK2     ZZTOTD
     C  N99                Z-ADDZZWK3     ZZTOTI
     C*
     C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
     C   99                Z-ADD0         ZZAMT  153
     C                     GOTO ZZSEND
     C*
     C* THE 'SIGNS' ARE DIFFERENT
     C           ZZOFPS    TAG                             ** ZZOFPS TAG**
     C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
     C*
     C   92                Z-SUBZZAMTI    ZZAMTI 150
     C   92                Z-SUBZZAMTD    ZZAMTD  30
     C*
     C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
     C*
     C   91                Z-SUBZZTOTI    ZZTOTI
     C   91                Z-SUBZZTOTD    ZZTOTD
     C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
     C*
     C           ZZTOTI    COMP ZZAMTI               93  95
     C   95      ZZTOTD    COMP ZZAMTD               93  95
     C*
     C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
     C   95                Z-ADD0         ZZTOTI
     C   95                Z-ADD0         ZZTOTD
     C   95                GOTO ZZSEND
     C*
     C* IF ZZTOT GT. ZZAMT.
     C   93      ZZAMTD    COMP ZZTOTD               94
     C   93 94   ZZTOTI    SUB  1         ZZTOTI
     C   93 94   ZZTOTD    ADD  1000      ZZWK2
     C   93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
     C   93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
     C   93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
     C*
     C*
     C* IF ZZAMT GT. ZZTOT.
     C  N93      ZZTOTD    COMP ZZAMTD               94
     C  N93 94   ZZAMTI    SUB  1         ZZWK3  150
     C  N93 94   ZZAMTD    ADD  1000      ZZWK2
     C  N93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
     C  N93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
     C  N93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
     C  N93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
     C*
     C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
     C                     SETOF                     94
     C   93 91
     CORN93 92             SETON                     94
     C   94                Z-SUBZZTOTI    ZZTOTI
     C   94                Z-SUBZZTOTD    ZZTOTD
     C**
     C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
     C   92                Z-SUBZZAMTI    ZZAMTI
     C   92                Z-SUBZZAMTD    ZZAMTD
     C           ZZSEND    TAG                             ** ZZSEND TAG *
     C**
     C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
     C                     SETOF                     96
     C           ZZTOTD    COMP 0                        91
     C   91      ZZTOTI    COMP 0                      96
     C   96                MOVE '.000-'   ZZNEGD  5
     C                     ENDSR                             ** ENDSR **
     C/EJECT
     C**
     C********************************************************************
     C**
     C**   ZALIGN SR. TO VALIDATE AND RIGHT-ALIGN NUMERIC FIELDS.
     C**
     C           ZALIGN    BEGSR                           *** ZALIGN ***
     C**
     C                     SETOF                     929399
     C**
     C**   SAVE INPUT FIELD IN ARRAY, ZA1.
     C                     MOVEAZFIELD    ZA1
     C**
     C**   CALCULATION TO DEFINE NUMBER STRUCTURE CONTROL FIELDS.
     C                     Z-ADDZADIG     ZADIG   20
     C                     Z-ADDZADEC     ZADEC   10
     C**
     C**   CALCULATIONS TO DEFINE/CLEAR FIELDS.
     C                     MOVE ' '       ZA2
     C                     MOVEAZA2       ZFIELD 16
     C                     Z-ADD0         ZX      20
     C                     Z-ADD0         ZY      20
     C**
     C**   ENSURE REQUIRED STRUCTURE OF FIELD IS VALID.
     C           ZADIG     ADD  ZADEC     ZZ      20
     C           ZZ        COMP 15                   99
     C   99                GOTO ZAEND
     C**
     C**   LOOP TO FIND DECIMAL POINT, BLANKS AND CHARACTERS.
     C           ZATAG1    TAG                             ** ZATAG1 TAG *
     C           ZX        ADD  1         ZX
     C**
     C**   CHECK FOR DECIMAL POINT. ERROR IF SECOND DECIMAL POINT.
     C           ZA1,ZX    COMP '.'                      90
     C   90 93             SETON                     99
     C   99                GOTO ZAEND
     C**
     C**
     C**   CHECK FOR 'M' CONSTANT. ERROR IF NOT LAST CHARACTER ENTERED
     C           ZA1,ZX    COMP 'M'                      96
     C   96                DO
     C           ZX        COMP 15                   99  99
     C   99                GOTO ZAEND
     C           ZX        ADD  1         ZX
     C           ZA1,ZX    COMP ' '                  9999
     C   99                GOTO ZAEND
     C           ZX        SUB  1         ZX
     C           ZX        COMP 9                    99
     C   99                GOTO ZAEND
     C                     END
     C**
     C**   CHECK FOR 'T' CONSTANT. ERROR IF NOT LAST CHARACTER ENTERED
     C           ZA1,ZX    COMP 'T'                      97
     C   97                DO
     C           ZX        COMP 15                   99  99
     C   99                GOTO ZAEND
     C           ZX        ADD  1         ZX
     C           ZA1,ZX    COMP ' '                  9999
     C   99                GOTO ZAEND
     C           ZX        SUB  1         ZX
     C           ZX        COMP 12                   99
     C   99                GOTO ZAEND
     C                     END
     C**
     C**   CLEAR ALPHAMERIC CONSTANT FROM ZA1
     C   96
     COR 97                MOVE ' '       ZA1,ZX
     C**
     C**   CHECK FOR BLANKS. BYPASS FOR FIRST BLANK AFTER A DIGIT.
     C           ZA1,ZX    COMP ' '                      91
     C   91 92             GOTO ZATAG2
     C**
     C**   CHECK FOR NUMERIC, IF NOT '.' OR ' '.
     C  N90N91   ZA1,ZX    COMP '0'                    99
     C  N90N91N99ZA1,ZX    COMP '9'                  99
     C   99                GOTO ZAEND                      NOT NUMERIC
     C**
     C**   STORE DIGITS IN ARRAY AND HOW MANY.
     C**   ZY, TOTAL OF DIGITS IN THE INPUT FIELD.
     C**   ZZ, TOTAL OF DIGITS TO THE LEFT OF DECIMAL POINT.
     C  N90N91   ZY        ADD  1         ZY         92
     C  N90N91             MOVE ZA1,ZX    ZA2,ZY
     C   90                Z-ADDZY        ZZ         93  93
     C**
     C           ZX        COMP 16                     94  CHECK IF ALL
     C   94                GOTO ZATAG1
     C**
     C           ZATAG2    TAG                             ** ZATAG2 TAG *
     C**
     C**   IF 'M' SPECIFIED, MULTIPLY ZA1 BY 1 MILLION
     C   96      ZZ        ADD  6         ZZ
     C**
     C**   IF 'T' SPECIFIED, MULTIPLY ZA1 BY 1 THOUSAND
     C   97      ZZ        ADD  3         ZZ
     C**
     C**   FILL IN ZEROS IN ANY BLANKS LEFT OF DECIMAL POINT
     C   96 93
     COR 97 93   ZZ        DOWGTZY
     C           ZY        ADD  1         ZY
     C                     MOVE '0'       ZA2,ZY
     C                     END
     C**
     C**   IF CONSTANT SPECIFIED WITH NO DECIMAL POINT ZEROISE BLANKS
     C   96N93             DO   6
     C           ZY        ADD  1         ZY
     C                     MOVE '0'       ZA2,ZY
     C                     END
     C**
     C   97N93             DO   3
     C           ZY        ADD  1         ZY
     C                     MOVE '0'       ZA2,ZY
     C                     END
     C**
     C**   IF NO DECIMAL POINT FOUND, SET TOTAL FIELD ZZ.
     C  N93                Z-ADDZY        ZZ
     C**
     C**   CHECK FOR EMBEDDED BLANKS.
     C   91 92             MOVEAZA1,ZX    ZFIELD
     C   91 92   ZFIELD    COMP ' '                  9999
     C   99                GOTO ZAEND                      EMBEDDED BLANK
     C**
     C**   ENSURE THAT NUMBER OF DIGITS ENTERED EITHER SIDE
     C**   OF DECIMAL POINT ARE NOT MORE THAN ALLOWED.
     C           ZZ        COMP ZADIG                99
     C           ZY        SUB  ZZ        ZX
     C  N99      ZADEC     SUB  ZX        ZX           9995
     C   99                GOTO ZAEND
     C   95                GOTO ZATAG4                     NO TRAILING
     C**                                                   BLANKS.
     C**   FILL THE TRAILING BLANKS WITH ZEROS.
     C           ZY        ADD  ZX        ZZ
     C           ZATAG3    TAG                             ** ZATAG3 TAG *
     C           ZY        ADD  1         ZY
     C                     MOVE '0'       ZA2,ZY
     C           ZY        COMP ZZ                     94
     C   94                GOTO ZATAG3
     C**
     C**   RIGHT-ALIGN THE VALUE BY MOVING BACK TO ARRAY, ZA1.
     C           ZATAG4    TAG                             ** ZATAG4 TAG *
     C                     MOVE '0'       ZA1
     C                     Z-ADD16        ZX
     C           ZATAG5    TAG                             ** ZATAG5 TAG *
     C           ZY        COMP 0                        94
     C   94                GOTO ZATAG6
     C                     MOVE ZA2,ZY    ZA1,ZX
     C           ZY        SUB  1         ZY
     C           ZX        SUB  1         ZX
     C                     GOTO ZATAG5
     C           ZATAG6    TAG                             ** ZATAG6 TAG *
     C**
     C**   MOVE VALIDATED AND RIGHT-ALIGNED NUMBER BACK INTO ZFIELD.
     C                     MOVEAZA1       ZFIELD
     C**
     C                     SETOF                     9697
     C**
     C           ZAEND     ENDSR                           * ZAEND ENDSR *
     C**
     C/EJECT
     C********************************************************************
     C**
     C**   ZDATE1 SR. TO VALIDATE DATES SUBMITTED AND
     C**              CONVERT TO A NUMBER OF DAYS.
     C**
     C**   THE YEAR 2000, BEING DIVISIBLE BY 400, IS A LEAP YEAR.
     C**
     C           ZDATE1    BEGSR                           *** ZDATE1 ***
     C**
     C**   CLEAR DAY NUMBER.
     C                     Z-ADD0         ZDAYNO  50
     C**
     C**   CALCULATION TO DEFINE INPUT DATE FIELD.
     C                     Z-ADDZDATE     ZDATE   60
     C**
     C**   GET INDIVIDUAL DAY, MONTH AND YEAR FIELDS.
     C                     MOVE ZDATE     ZYEAR   20
     C  N98                MOVELZDATE     ZDAY    20
     C   98                MOVELZDATE     ZMTH    20
     C                     MOVE ZDATE     ZWRK4   40
     C  N98                MOVELZWRK4     ZMTH
     C   98                MOVELZWRK4     ZDAY
     C**
     C**   ENSURE MONTH IS VALID.
     C           ZMTH      COMP 0                      9999
     C  N99      ZMTH      COMP 12                   99
     C   99                GOTO ZDEND1                     BYPASS IF ERROR
     C**
     C**   CHECK FOR 30 DAY MONTHS.
     C           ZMTH      COMP 4                        90IF 90 ON, 30
     C  N90      ZMTH      COMP 6                        90DAY MONTH.
     C  N90      ZMTH      COMP 9                        90
     C  N90      ZMTH      COMP 11                       90
     C**
     C**   ENSURE DAY IS VALID.
     C           ZDAY      COMP 0                      9999
     C   90N99   ZDAY      COMP 30                   99
     C  N90N99   ZDAY      COMP 31                   99
     C   99                GOTO ZDEND1                     BYPASS IF ERROR
     C**
     C**   CHECK FOR LEAP YEAR AND FEBRUARY.
     C           ZYEAR     ADD  28        ZYEAR
     C           ZYEAR     DIV  4         ZLYR    20
     C                     MVR            ZLY     10     91LEAP YR, 91 ON
     C           ZMTH      COMP 2                    93  92FEB., 92 ON
     C**                                                   PAST FEB, 93 ON
     C**   IF FEBUARY FURTHER VALIDATE DAY.
     C  N91 92   ZDAY      COMP 28                   99
     C   91 92   ZDAY      COMP 29                   99
     C   99                GOTO ZDEND1                     BYPASS IF ERROR
     C**
     C**   DETERMINE NUMBER OF DAYS FROM 31/12/1971.     NO.OF 4 YR. SPANS
     C           ZLYR      MULT 1461      ZDAYNO           X DAYS IN SPAN.
     C  N91      ZDAYNO    ADD  ZYDY,ZLY  ZDAYNO           SINCE LAST L.YR
     C   91 93   ZDAYNO    ADD  1         ZDAYNO           L.YR.,PAST FEB.
     C           ZDAYNO    ADD  ZMDY,ZMTH ZDAYNO           DAYS THIS YEAR
     C           ZDAYNO    ADD  ZDAY      ZDAYNO           DAYS THIS MONTH
     C**
     C           ZDEND1    ENDSR                           * ZDEND1 ENDSR*
     C**
     C**
     C********************************************************************
     C/EJECT
     C**
     C********************************************************************
     C**
     C**   ZDATE2 SR. TO CONVERT A DAY NUMBER TO DATE FORMATS.
     C**
     C**   THE YEAR 2000, BEING DIVISIBLE BY 400, IS A LEAP YEAR.
     C**
     C           ZDATE2    BEGSR                           *** ZDATE2 ***
     C**
     C**   CLEAR DATE FIELDS.
     C                     Z-ADD0         ZDATE   60
     C                     MOVEL'       ' ZADATE  7
     C**
     C**   CALCULATION TO DEFINE INPUT DAY NUMBER.
     C                     Z-ADDZDAYNO    ZDAYNO  50
     C**
     C**   DETERMINE YEAR NUMBER.
     C**
     C**   ADJUST DAY NUMBER IN CASE LAST DAY OF YEAR.
     C           ZDAYNO    SUB  1         ZDAYN1  50   99
     C   99                GOTO ZDEND2
     C**
     C**   CALCULATE NUMBER OF 4 YEAR SPANS SINCE 31/12/1971.
     C           ZDAYN1    DIV  1461      ZLYR    20
     C                     MVR            ZDAYN1           SAVE REMAINING
     C**                                                   DAYS
     C**   CALCULATE NUMBER OF REMAINING YEARS.
     C                     Z-ADD1         ZWRK2   20
     C           ZDTAG1    TAG                             ** ZDTAG1 TAG *
     C           ZDAYN1    COMP ZYDY,ZWRK2             90
     C  N90      ZWRK2     ADD  1         ZWRK2
     C  N90                GOTO ZDTAG1
     C           ZWRK2     SUB  1         ZWRK2          91LEAP YR, 91 ON
     C**
     C**   DECREMENT DAY NO. BY DAYS IN REMAINING YEARS.
     C  N91      ZDAYN1    SUB  ZYDY,ZWRK2ZDAYN1
     C**
     C**   CALCULATE ACTUAL YEAR NUMBER.
     C           ZLYR      MULT 4         ZWRK3   30
     C           ZWRK3     ADD  72        ZWRK3            BASE IS 1972
     C                     Z-ADDZWRK3     ZYEAR   20
     C           ZYEAR     ADD  ZWRK2     ZYEAR            YEAR
     C**
     C**   DETERMINE MONTH NUMBER.
     C**
     C**   ADJUST DAY NO. IN CASE LAST DAY OF LEAP YEAR FEBRUARY.
     C                     SETOF                     9293
     C   91      ZDAYN1    COMP 59                     9293
     C   91N92   ZDAYN1    SUB  1         ZDAYN1
     C**
     C**   CALCULATE MONTH NUMBER.
     C                     Z-ADD2         ZWRK2
     C           ZDTAG2    TAG                             ** ZDTAG2 TAG *
     C           ZDAYN1    COMP ZMDY,ZWRK2             94
     C  N94      ZWRK2     ADD  1         ZWRK2
     C  N94                GOTO ZDTAG2
     C           ZWRK2     SUB  1         ZWRK2
     C**
     C                     Z-ADDZWRK2     ZMTH    20       MONTH
     C**
     C**   DETERMINE DAY OF MONTH.
     C**
     C**   ADD BACK LAST DAY OF YEAR ADJUSTMENT.
     C           ZDAYN1    ADD  1         ZDAYN1
     C**
     C**   CALCULATE DAY OF MONTH.
     C           ZDAYN1    SUB  ZMDY,ZWRK2ZDAY    20       DAY
     C**
     C**   ADD BACK LEAP YEAR 29TH FEBUARY ADJUSTMENT, IF REQUIRED.
     C   93      ZDAY      ADD  1         ZDAY
     C**
     C**   FORMAT DATE, DDMMYY OR MMDDYY.
     C  N98                MOVELZDAY      ZWRK4   40
     C   98                MOVE ZDAY      ZWRK4
     C  N98                MOVE ZMTH      ZWRK4
     C   98                MOVELZMTH      ZWRK4
     C                     MOVELZWRK4     ZDATE
     C                     MOVE ZYEAR     ZDATE
     C**
     C**   FORMAT ALPHA DATE, DDMMMYY.
     C           ZDAY      COMP 10                     95
     C                     MOVELZDAY      ZWRK5   5
     C   95                MOVEL' '       ZWRK5
     C                     MOVE ZMNM,ZMTH ZWRK5
     C                     MOVELZWRK5     ZADATE
     C                     MOVE ZYEAR     ZADATE
     C**
     C           ZDEND2    ENDSR                           * ZDEND2 ENDSR*
     C/EJECT
     C**
     C********************************************************************
     C********************************************************************S01195
     C*****ZDATE3*SR.*TO*CALCULATE*ANY*NUMBER*OF*WORKING******************S01195
     C****************DAYS*FORWARD*IN*ANY*CURRENCY.***********************S01195
     C********************************************************************S01195
     C*********THIS*SR.*CAN*BE*USED*WHEN*THE*INPUT*CYCLE*IS*RUNNING*AS****S01195
     C*********HOLIDAY*RECORDS*ARE*ACCESSED*BY*CHAIN.*THEREFORE*NEWLY*****S01195
     C*********ADDED*RECORDS*IN*THE*OVERFLOW*AREA*CAN*ALSO*BE*ACCESSED.***S01195
     C********************************************************************S01195
     C*********************                                               S01195
     C***********ZDATE3****BEGSR                                          S01195
     C*****CALCULATIONS*TO*DEFINE INPUT FIELDS.                           S01195
     C*********************Z-ADDZDAYNO    ZDAYNO  50       STARTING DATE  S01195
     C*********************MOVE ZCCY      ZCCY    3        DATE CURRENCY  S01195
     C*********************Z-ADDZNRDYS    ZNRDYS  20       NBR OF WORKING S01195
     C*********************                                DAYS FORWARD   S01195
     C*****CLEAR*COUNT*OF*NBR*OF*DAYS*ADDED,*&*DEFINE*ZDYNBR.**********   S01195
     C*********************Z-ADD0         ZDCNT   20                      S01195
     C*********************Z-ADDZDAYNO    ZDYNBR  50                      S01195
     C*********************                                               S01195
     C*****LOOP*TO*INCREMENT*DAY*NUMBER*AND*CHECK*FOR*HOLIDAY.*********   S01195
     C***********ZDLOP1****TAG                             ** ZDLOP1 TAG *S01195
     C*********************SETOF                     9596                 S01195
     C***********ZDYNBR****ADD  1         ZDYNBR                          S01195
     C*****SET*KEY*FOR*FIRST*HOLIDAY*RECORD.***************************   S01195
     C*********************MOVEL'22    '  ZDHKEY 12                       S01195
     C*********************MOVELZDYNBR    ZWRK6   6                       S01195
     C*********************MOVE '1'       ZWRK6                           S01195
     C*********************MOVE ZWRK6     ZDHKEY                          S01195
     C*********************                                               S01195
     C*****CHAIN*FOR*HOLIDAY*RECORD,*RECORD*1*OR*2*********************   S01195
     C***********ZDHCHN****TAG                             ** ZDHCHN TAG *S01195
     C*********************                                               S01195
     C***********ZDHKEY****CHAINTABFP                90    ON NOT THERE   S01195
     C**N90******RECI******COMP 'D'                  9090  DELETED        S01195
     C*********************                                               S01195
     C*****NO*RECORD*1*FOUND,*IS*NOT*A*HOLIDAY*************************   S01195
     C***90N95*************GOTO ZDOAGN                                    S01195
     C*********************                                               S01195
     C*****NO*RECORD*2*FOUND*******************************************   S01195
     C***90*95*96**********GOTO ZDLOP1                     EXC. NOT FOUND S01195
     C***90*95N96**********GOTO ZDOAGN                     INC. NOT FOUND S01195
     C*********************                                               S01195
     C*****DETERMINE*TYPE*FOUND,*INCLUDE*OR*EXCLUDE********************   S01195
     C***********INEX******COMP 'E'                  92  91               S01195
     C*********************                                               S01195
     C*****CHECK*IF*DAY*IS*HOLIDAY*FOR*CURRENCY.***********************   S01195
     C***********ZCCY******LOKUPZACY                     93               S01195
     C***91*93*************GOTO ZDOAGN                     EXCLUDE FOUND  S01195
     C***92*93*************GOTO ZDLOP1                     INCLUDE FOUND  S01195
     C*********************                                               S01195
     C*****IF*EXCLUDE*OR*INCLUDE*NOT*FOUND*CHECK***********************   S01195
     C*****FOR*SECOND*HOLIDAY*RECORD,*IF*REQUIRED.*********************   S01195
     C***********'   '*****LOKUPZACY                     94ON IF NO RCD.2 S01195
     C*********************MOVE ZDHKEY    ZWRK1H  1                       S01195
     C***********ZWRK1H****COMP '1'                      95               S01195
     C***91*95*************SETON                     96                   S01195
     C***95N94*************MOVE '2'       ZDHKEY                          S01195
     C***95N94*************GOTO ZDHCHN                     GET SECOND REC S01195
     C*********************                                               S01195
     C***91****************GOTO ZDLOP1                     EXC. NOT FOUND S01195
     C***92****************GOTO ZDOAGN                     INC. NOT FOUND S01195
     C*********************                                               S01195
     C*****INCREMENT*COUNT*AND*CHECK*IF*REQUIRED*NUMBER*OF*DAYS********** S01195
     C*****HAVE*BEEN*ADDED.*IF*NOT,*GO*THROUGH*LOOP1*AGAIN.************** S01195
     C***********ZDOAGN****TAG                             ** ZDOAGN TAG *S01195
     C*********************                                               S01195
     C***********ZDCNT*****ADD  1         ZDCNT                           S01195
     C***********ZDCNT*****COMP ZNRDYS                 97                 S01195
     C***97****************GOTO ZDLOP1                                    S01195
     C*********************                                               S01195
     C*********************ENDSR                                          S01195
     C/EJECT
     C**
     C********************************************************************
     C**
     C**
     C*****ZSYSTM*SR.*TO*CHAIN*TO*THE*INSTALLATION*CONTROL*DATA*RECORD.   S01194
     C***********                                                         S01194
     C***********ZSYSTM    BEGSR                           *** ZSYSTEM ***S01194
     C***********                                                         S01194
     C*****SET*UP*KEY*FOR*INSTALLATION*CONTROL*RECORD.                    S01194
     C***********          MOVEL'01      'ZTABKY 12                       S01194
     C***********          MOVE '  10'    ZTABKY                          S01194
     C***********                                                         S01194
     C***********ZTABKY    CHAINTABFP                99    ON NOT THERE   S01194
     C**N99******RECI      COMP 'D'                  9999  ON, IS DELETED S01194
     C***********                                                         S01194
     C*****CHECK*SYSTEM*DATE*FORMAT,*DDMMYY*OR*MMDDYY.                    S01194
     C***********DATF      COMP 'M'                      98MMDDYY, 98 ON  S01194
     C***********                                                         S01194
     C***********          ENDSR                                          S01194
     C**
     C/COPY ZSRSRC,ZACCH                                                  S01195
     C/COPY ZSRSRC,ZCHKH                                                  S01195
     C/COPY ZSRSRC,ZFWDT                                                  S01195
     C/EJECT
     C/COPY WNCPYSRC,FT0050DCPG                                           S01435
      *                                                                   S01435
      *  /Copy point for Calculations                                     S01435
      *                                                                   S01435
      *================================================================   CFT002
      *  Map Translated data for Incoming messages                        CFT002
      *================================================================   CFT002
      *                                                                   CFT002
     C           SRIMSG    BEGSR                                          CFT002
      *                                                                   CFT002
      *  Set up the detail screen fields from the message.                CFT002
      *                                                                   CFT002
      *  Sender                                                           CFT002
      *  In FONTIS this field can be translated only by                   CGL009
      *  the sender correspondant (P53)                                   CGL009
     C           PNWRK     IFNE 'FONTIS'                                  CGL009
      *                                                                   CFT002
     C           PSN       IFNE *BLANKS                                   CFT002
     C                     MOVELPSN       DSTRAN                          CFT002
     C           TRCODE    IFNE *BLANKS                                   CFT002
      *                                                                   CFT002
      * Translate to nostro and retail account numbers                    CFT002
      *                                                                   CFT002
     C                     EXSR SRTRAN                                    CFT002
     C                     SELEC                                          CFT002
      *                                                                   CFT002
      * If local and account currency local then use retail number        CFT002
      *                                                                   CFT002
     C           BJLCCY    WHEQ SSMCY                                     CFT002
     C           TRCYCD    ANDEQSSMCY                                     CFT002
     C           ##ACNO    ANDNE0                                         CFT002
     C                     MOVE *BLANKS   SSND1                           CFT002
     C                     MOVE *BLANKS   SSND2                           CFT002
     C                     MOVE *BLANKS   SSND3                           CFT002
     C                     MOVE *BLANKS   SSND4                           CFT002
     C                     MOVEL##ACNO    SSND1                           CFT002
      *                                                                   CFT002
      * If currency the same as settle and nostro, use nostro             CFT002
      *                                                                   CFT002
     C           ##NCCY    WHEQ SSMCY                                     CFT002
     C           ##NONB    ANDNE*BLANKS                                   CFT002
     C                     MOVE *BLANKS   SSND1                           CFT002
     C                     MOVE *BLANKS   SSND2                           CFT002
     C                     MOVE *BLANKS   SSND3                           CFT002
     C                     MOVE *BLANKS   SSND4                           CFT002
     C           ##NCCY    CAT  ##NONB    SSND1     P                     CFT002
      *                                                                   CFT002
      * If currency the same use GL Account                               CFT002
      *                                                                   CFT002
     C           TRCYCD    WHEQ SSMCY                                     CFT002
     C                     MOVE *BLANKS   SSND1                           CFT002
     C                     MOVE *BLANKS   SSND2                           CFT002
     C                     MOVE *BLANKS   SSND3                           CFT002
     C                     MOVE *BLANKS   SSND4                           CFT002
     C           BGMBIN    IFNE 'Y'                                       CFT002
     C                     MOVE '   '     TRCODE                          CFT002
     C                     END                                            CFT002
     C                     MOVELTRCODE    SSND1                           CFT002
      *                                                                   CFT002
      * Use customer number                                               CFT002
      *                                                                   CFT002
     C                     OTHER                                          CFT002
     C                     MOVE *BLANKS   SSND1                           CFT002
     C                     MOVE *BLANKS   SSND2                           CFT002
     C                     MOVE *BLANKS   SSND3                           CFT002
     C                     MOVE *BLANKS   SSND4                           CFT002
     C                     MOVELTRCNUM    SSND1                           CFT002
     C                     ENDSL                                          CFT002
     C                     ELSE                                           CFT002
     C                     MOVELTMLIN2    SSND2                           CFT002
     C                     END                                            CFT002
     C                     END                                            CFT002
      *                                                                   CFT002
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
      *  Senders Correspondent                                            CFT002
      *  By default will translate the sender field in FONTIS             CGL009
      *                                                                   CFT002
     C                     MOVELP54       DSTRAN                          CFT002
     C                     MOVELTRCODE    TRCDE2                          CFT002
     C           P54       IFEQ *BLANKS                                   CFT002
     C           P55       ANDEQ*BLANKS                                   CFT014
     C           P53       ANDNE*BLANKS                                   CFT002
     C***********P54       ORNE *BLANKS                            CFT002 CFT014
     C***********TRCNUM    ANDEQ'501116'                           CFT002 CFT014
     C***********P53       ANDNE*BLANKS                            CFT002 CFT014
     C                     MOVELP53       DSTRAN                          CFT002
     C                     MOVELTRCODE    TRCDE2                          CFT002
     C           TRCODE    IFNE *BLANKS                                   CFT002
     C***********TRCNUM    ANDNE'501116'                           CFT002 CFT014
      *                                                                   CFT002
      * Translate to nostro and retail account numbers                    CFT002
      *                                                                   CFT002
     C                     EXSR SRTRAN                                    CFT002
     C                     SELEC                                          CFT002
      *                                                                   CFT002
      * If local and account currency local then use retail number        CFT002
      *                                                                   CFT002
     C           BJLCCY    WHEQ SSMCY                                     CFT002
     C           TRCYCD    ANDEQSSMCY                                     CFT002
     C           ##ACNO    ANDNE0                                         CFT002
     C                     MOVE *BLANKS   SSND1                           CFT002
     C                     MOVE *BLANKS   SSND2                           CFT002
     C                     MOVE *BLANKS   SSND3                           CFT002
     C                     MOVE *BLANKS   SSND4                           CFT002
     C                     MOVEL##ACNO    SSND1                           CFT002
      *                                                                   CFT002
      * If currency the same as settle and nostro, use nostro             CFT002
      *                                                                   CFT002
     C           ##NCCY    WHEQ SSMCY                                     CFT002
     C           ##NONB    ANDNE*BLANKS                                   CFT002
     C                     MOVE *BLANKS   SSND1                           CFT002
     C                     MOVE *BLANKS   SSND2                           CFT002
     C                     MOVE *BLANKS   SSND3                           CFT002
     C                     MOVE *BLANKS   SSND4                           CFT002
     C           ##NCCY    CAT  ##NONB    SSND1     P                     CFT002
      *                                                                   CFT002
      * If currency the same use GL Account                               CFT002
      *                                                                   CFT002
     C           TRCYCD    WHEQ SSMCY                                     CFT002
     C                     MOVE *BLANKS   SSND1                           CFT002
     C                     MOVE *BLANKS   SSND2                           CFT002
     C                     MOVE *BLANKS   SSND3                           CFT002
     C                     MOVE *BLANKS   SSND4                           CFT002
     C           BGMBIN    IFNE 'Y'                                       CFT002
     C                     MOVE '   '     TRCODE                          CFT002
     C                     END                                            CFT002
     C                     MOVELTRCODE    SSND1                           CFT002
      *                                                                   CFT002
      * Use customer number                                               CFT002
      *                                                                   CFT002
     C                     OTHER                                          CFT002
     C                     MOVE *BLANKS   SSND1                           CFT002
     C                     MOVE *BLANKS   SSND2                           CFT002
     C                     MOVE *BLANKS   SSND3                           CFT002
     C                     MOVE *BLANKS   SSND4                           CFT002
     C                     MOVELTRCNUM    SSND1                           CFT002
     C                     ENDSL                                          CFT002
     C                     END                                            CFT002
     C                     END                                            CFT002
      *                                                                   CFT002
      *  Receivers Correspondent                                          CFT002
      *                                                                   CFT002
     C                     SELEC                                          CFT002
     C           PNWRK     WHEQ 'YENKSI'                                  CFT002
     C/COPY WNCPYSRC,FT0050C135
      *                                                                   CFT002
     C           P54       WHNE *BLANKS                                   CFT002
     C                     MOVELP54       DSTRAN                          CFT002
     C                     MOVELTRCODE    TRCDE2                          CFT002
     C           TRCODE    IFNE *BLANKS                                   CFT002
     C           TRCNUM    ANDEQ'501116'                                  CFT002
     C                     MOVE *BLANKS   SRCCO                           CFT002
     C                     ENDIF                                          CFT002
     C           TRCODE    IFNE *BLANKS                                   CFT002
     C           TRCNUM    ANDNE'501116'                                  CFT002
      *                                                                   CFT002
      * Translate to nostro and retail account numbers                    CFT002
      *                                                                   CFT002
     C                     EXSR SRTRAN                                    CFT002
     C                     SELEC                                          CFT002
      *                                                                   CFT002
      * If local and account currency local then use retail number        CFT002
      *                                                                   CFT002
     C           BJLCCY    WHEQ SSMCY                                     CFT002
     C           TRCYCD    ANDEQSSMCY                                     CFT002
     C           ##ACNO    ANDNE0                                         CFT002
     C                     MOVE *BLANKS   SRCCO                           CFT002
     C                     MOVEL##ACNO    SRCCO                           CFT002
      *                                                                   CFT002
      * If currency the same as settle and nostro, use nostro             CFT002
      *                                                                   CFT002
     C           ##NCCY    WHEQ SSMCY                                     CFT002
     C           ##NONB    ANDNE*BLANKS                                   CFT002
     C                     MOVE *BLANKS   SRCCO                           CFT002
     C                     MOVEL##NONB    SRCCO                           CFT002
      *                                                                   CFT002
      * Use customer number                                               CFT002
      *                                                                   CFT002
     C                     OTHER                                          CFT002
     C                     MOVE *BLANKS   SRCCO                           CFT002
     C                     MOVELTRCNUM    SRCCO                           CFT002
     C                     ENDSL                                          CFT002
     C                     END                                            CFT002
     C                     ENDSL                                          CFT002
      *                                                                   CFT014
      *  Third Reimbursement Institution                                  CFT014
      *                                                                   CFT014
     C           P55       IFNE *BLANKS                                   CFT014
     C                     MOVELP55       DSTRAN                          CFT014
     C           TRCODE    IFNE *BLANKS                                   CFT014
     C                     MOVEL*BLANKS   STRIB                           CFT014
     C                     ENDIF                                          CFT014
     C           TRCODE    IFNE *BLANKS                                   CFT014
      *                                                                   CFT014
      * Translate to nostro and retail account numbers                    CFT014
      *                                                                   CFT014
     C                     EXSR SRTRAN                                    CFT014
     C                     SELEC                                          CFT014
      *                                                                   CFT014
      * If local and account currency local then use retail number        CFT014
      *                                                                   CFT014
     C           BJLCCY    WHEQ SSMCY                                     CFT014
     C           TRCYCD    ANDEQSSMCY                                     CFT014
     C           ##ACNO    ANDNE0                                         CFT014
     C                     MOVEL*BLANKS   STRIB                           CFT014
     C                     MOVEL##ACNO    STRIB                           CFT014
      *                                                                   CFT014
      * If currency the same as settle and nostro, use nostro             CFT014
      *                                                                   CFT014
     C           ##NCCY    WHEQ SSMCY                                     CFT014
     C           ##NONB    ANDNE*BLANKS                                   CFT014
     C                     MOVEL*BLANKS   STRIB                           CFT014
     C                     MOVEL##NONB    STRIB                           CFT014
      *                                                                   CFT014
      * If currency the same use GL Account                               CFT014
     C           TRCYCD    WHEQ SSMCY                                     CFT014
     C                     MOVEL*BLANKS   STRIB                           CFT014
     C           BGMBIN    IFNE 'Y'                                       CFT014
     C                     MOVE '   '     TRCODE                          CFT014
     C                     ENDIF                                          CFT014
     C                     MOVELTRCODE    STRIB                           CFT014
      *                                                                   CFT014
      * Use customer number                                               CFT014
      *                                                                   CFT014
     C                     OTHER                                          CFT014
     C                     MOVEL*BLANKS   STRIB                           CFT014
     C                     MOVELTRCNUM    STRIB                           CFT014
     C                     ENDSL                                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
     C/COPY WNCPYSRC,FT0050C134
      *                                                                   CFT002
      *  Account with Institution                                         CFT002
      *  Can't be translated if FONTIS message                            CGL009
     C           PNWRK     IFNE 'FONTIS'                                  CGL009
     C           P57       IFNE *BLANKS                                   CFT002
     C                     MOVELP57       DSTRAN                          CFT002
     C           TRCODE    IFNE *BLANKS                                   CFT002
      *                                                                   CFT002
      * Translate to nostro and retail account numbers                    CFT002
      *                                                                   CFT002
     C                     EXSR SRTRAN                                    CFT002
     C                     SELEC                                          CFT002
      *                                                                   CFT002
      * If local and account currency local then use retail number        CFT002
      * Save if CFT012 is on                                              CFT012
      *                                                                   CFT002
     C           BJLCCY    WHEQ SSMCY                                     CFT002
     C           TRCYCD    ANDEQSSMCY                                     CFT002
     C           ##ACNO    ANDNE0                                         CFT002
     C           CFT012    ANDEQ'N'                                       CFT012
     C                     MOVE *BLANKS   SACBK                           CFT002
     C                     MOVEL##ACNO    SACBK                           CFT002
      *                                                                   CFT012
     C           ##ACNO    WHNE 0                                         CFT012
     C           CFT012    ANDEQ'Y'                                       CFT012
     C                     MOVEL*BLANKS   SACBK                           CFT012
     C                     MOVEL##ACNO    SACBK                           CFT012
     C                     MOVELTRCYCD    SPCCY                           CFT012
      *                                                                   CFT002
      * If currency the same as settle and nostro, use nostro             CFT002
      * Save if CFT012 is on                                              CFT012
      *                                                                   CFT002
     C           ##NCCY    WHEQ SSMCY                                     CFT002
     C           ##NONB    ANDNE*BLANKS                                   CFT002
     C           CFT012    ANDEQ'N'                                       CFT012
     C                     MOVE *BLANKS   SACBK                           CFT002
     C                     MOVEL##NONB    SACBK                           CFT002
      *                                                                   CFT012
     C           ##NONB    WHNE *BLANKS                                   CFT012
     C           CFT012    ANDEQ'Y'                                       CFT012
     C                     MOVEL*BLANKS   SACBK                           CFT012
     C                     MOVEL##NONB    SACBK                           CFT012
     C                     MOVEL##NCCY    SPCCY                           CFT012
      *                                                                   CFT002
      * If currency the same use GL Account                               CFT002
      * Save if CFT012 is on                                              CFT012
      *                                                                   CFT002
     C           TRCYCD    WHEQ SSMCY                                     CFT002
     C           CFT012    ANDEQ'N'                                       CFT012
     C                     MOVE *BLANKS   SACBK                           CFT002
     C           TRCNUM    CAT  TRCDSQ    SACBK                           CFT002
     C           BGMBIN    IFEQ 'Y'                                       CFT002
     C                     MOVE TRBRCD    SACBB                           CFT002
     C                     END                                            CFT002
      *                                                                   CFT012
     C           CFT012    WHEQ 'Y'                                       CFT012
     C           TRCYCD    ANDNE*BLANK                                    CFT012
     C           TRCDSQ    ANDNE*BLANK                                    CFT012
     C                     MOVEL*BLANKS   SACBK                           CFT012
     C           TRCNUM    CAT  TRCDSQ    SACBK                           CFT012
     C           BGMBIN    IFEQ 'Y'                                       CFT012
     C                     MOVE TRBRCD    SACBB                           CFT012
     C                     END                                            CFT012
     C                     MOVELTRCYCD    SPCCY                           CFT012
      *                                                                   CFT002
      * Use customer number                                               CFT002
      *                                                                   CFT002
     C                     OTHER                                          CFT002
     C                     MOVE *BLANKS   SACBK                           CFT002
     C                     MOVELTRCNUM    SACBK                           CFT002
     C                     ENDSL                                          CFT002
     C                     END                                            CFT002
     C                     END                                            CFT002
     C                     ENDIF                                          CGL009
      *                                                                   CFT002
      *  Beneficiary Institution/ Beneficiary Customer                    CFT002
      *                                                                   CFT002
     C           P58       IFNE *BLANKS                                   CFT002
     C                     MOVELP58       DSTRAN                          CFT002
     C           TRCODE    IFNE *BLANKS                                   CFT002
      *                                                                   CFT002
      * Translate to nostro and retail account numbers                    CFT002
      *                                                                   CFT002
     C                     EXSR SRTRAN                                    CFT002
     C                     SELEC                                          CFT002
      *                                                                   CFT002
      * If local and account currency local then use retail number        CFT002
      * Save if CFT012 is on                                              CFT012
      *                                                                   CFT002
     C           BJLCCY    WHEQ SSMCY                                     CFT002
     C           TRCYCD    ANDEQSSMCY                                     CFT002
     C           ##ACNO    ANDNE0                                         CFT002
     C           CFT012    ANDEQ'N'                                       CFT012
     C                     MOVE *BLANKS   SBNC1                           CFT002
     C                     MOVEL##ACNO    SBNC1                           CFT002
     C                     MOVEL*BLANKS   SBNC2                           CFT002
     C                     MOVEL*BLANKS   SBNC3                           CFT002
     C                     MOVEL*BLANKS   SBNC4                           CFT002
     C                     MOVEL*BLANKS   SBNC5                           CFT002
      *                                                                   CFT012
     C           ##ACNO    WHNE 0                                         CFT012
     C           CFT012    ANDEQ'Y'                                       CFT012
     C                     MOVEL*BLANKS   SBNC1                           CFT012
     C                     MOVEL##ACNO    SBNC1                           CFT002
     C                     MOVEL*BLANKS   SBNC2                           CFT012
     C                     MOVEL*BLANKS   SBNC3                           CFT012
     C                     MOVEL*BLANKS   SBNC4                           CFT012
     C                     MOVEL*BLANKS   SBNC5                           CFT012
     C                     MOVELTRCYCD    SPCCY                           CFT012
      *                                                                   CFT002
      * If currency the same use GL Account                               CFT002
      * Save if CFT012 is on                                              CFT012
      *                                                                   CFT002
     C           TRCYCD    WHEQ SSMCY                                     CFT002
     C           CFT012    ANDEQ'N'                                       CFT012
     C                     MOVE *BLANKS   SBNC1                           CFT002
     C           BGMBIN    IFNE 'Y'                                       CFT002
     C                     MOVEL*BLANKS   TRBRCD                          CFT002
     C                     END                                            CFT002
     C           TRCNUM    CAT  TRCSB     SBNC1                           CFT002
     C                     MOVEL*BLANKS   SBNC2                           CFT002
     C                     MOVEL*BLANKS   SBNC3                           CFT002
     C                     MOVEL*BLANKS   SBNC4                           CFT002
     C                     MOVEL*BLANKS   SBNC5                           CFT002
      *                                                                   CFT012
     C           CFT012    WHEQ 'Y'                                       CFT012
     C           TRCYCD    ANDNE*BLANK                                    CFT012
     C           TRCSB     ANDNE*BLANK                                    CFT012
     C                     MOVEL*BLANKS   SBNC1                           CFT012
     C           BGMBIN    IFNE 'Y'                                       CFT012
     C                     MOVEL*BLANKS   TRBRCD                          CFT012
     C                     END                                            CFT012
     C           TRCNUM    CAT  TRCSB     SBNC1                           CFT012
     C                     MOVEL*BLANKS   SBNC2                           CFT012
     C                     MOVEL*BLANKS   SBNC3                           CFT012
     C                     MOVEL*BLANKS   SBNC4                           CFT012
     C                     MOVEL*BLANKS   SBNC5                           CFT012
     C                     MOVELTRCYCD    SPCCY                           CFT012
      *                                                                   CFT002
      * Use customer number                                               CFT002
      *                                                                   CFT002
     C                     OTHER                                          CFT002
     C                     MOVE *BLANKS   SBNC1                           CFT002
     C                     MOVELTRCNUM    SBNC1                           CFT002
     C                     MOVEL*BLANKS   SBNC2                           CFT002
     C                     MOVEL*BLANKS   SBNC3                           CFT002
     C                     MOVEL*BLANKS   SBNC4                           CFT002
     C                     MOVEL*BLANKS   SBNC5                           CFT002
     C                     ENDSL                                          CFT002
     C                     END                                            CFT002
     C                     END                                            CFT002
      *                                                                   CFT002
     C           P59       IFNE *BLANKS                                   CFT002
     C                     MOVELP59       DSTRAN                          CFT002
     C           TRCODE    IFNE *BLANKS                                   CFT002
      *                                                                   CFT002
      * Translate to nostro and retail account numbers                    CFT002
      *                                                                   CFT002
     C                     EXSR SRTRAN                                    CFT002
     C                     SELEC                                          CFT002
      *                                                                   CFT002
      * If local and account currency local then use retail number        CFT002
      * Save if CFT012 is on                                              CFT012
      *                                                                   CFT002
     C           BJLCCY    WHEQ SSMCY                                     CFT002
     C           TRCYCD    ANDEQSSMCY                                     CFT002
     C           ##ACNO    ANDNE0                                         CFT002
     C           CFT012    ANDEQ'N'                                       CFT012
     C                     MOVE *BLANKS   SBNC1                           CFT002
     C                     MOVEL##ACNO    SBNC1                           CFT002
     C                     MOVEL*BLANKS   SBNC2                           CFT002
     C                     MOVEL*BLANKS   SBNC3                           CFT002
     C                     MOVEL*BLANKS   SBNC4                           CFT002
     C                     MOVEL*BLANKS   SBNC5                           CFT002
      *                                                                   CFT012
     C           ##ACNO    WHNE 0                                         CFT012
     C           CFT012    ANDEQ'Y'                                       CFT012
     C                     MOVEL*BLANKS   SBNC1                           CFT012
     C                     MOVEL##ACNO    SBNC1                           CFT012
     C                     MOVEL*BLANKS   SBNC2                           CFT012
     C                     MOVEL*BLANKS   SBNC3                           CFT012
     C                     MOVEL*BLANKS   SBNC4                           CFT012
     C                     MOVEL*BLANKS   SBNC5                           CFT012
     C                     MOVELTRCYCD    SPCCY                           CFT012
      *                                                                   CFT002
      * If currency the same use GL Account                               CFT002
      * Save if CFT012 is on                                              CFT012
      *                                                                   CFT002
     C           TRCYCD    WHEQ SSMCY                                     CFT002
     C           CFT012    ANDEQ'N'                                       CFT012
     C                     MOVE *BLANKS   SBNC1                           CFT002
     C           BGMBIN    IFNE 'Y'                                       CFT002
     C                     MOVEL*BLANKS   TRBRCD                          CFT002
     C                     END                                            CFT002
     C           TRCNUM    CAT  TRCSB     SBNC1                           CFT002
     C                     MOVEL*BLANKS   SBNC2                           CFT002
     C                     MOVEL*BLANKS   SBNC3                           CFT002
     C                     MOVEL*BLANKS   SBNC4                           CFT002
     C                     MOVEL*BLANKS   SBNC5                           CFT002
      *                                                                   CFT012
     C           CFT012    WHEQ 'Y'                                       CFT012
     C           TRCYCD    ANDNE*BLANK                                    CFT012
     C           TRCSB     ANDNE*BLANK                                    CFT012
     C                     MOVEL*BLANKS   SBNC1                           CFT012
     C           BGMBIN    IFNE 'Y'                                       CFT012
     C                     MOVEL*BLANKS   TRBRCD                          CFT012
     C                     ENDIF                                          CFT012
     C           TRCNUM    CAT  TRCSB     SBNC1                           CFT012
     C                     MOVEL*BLANKS   SBNC2                           CFT012
     C                     MOVEL*BLANKS   SBNC3                           CFT012
     C                     MOVEL*BLANKS   SBNC4                           CFT012
     C                     MOVEL*BLANKS   SBNC5                           CFT012
     C                     MOVELTRCYCD    SPCCY                           CFT012
      *                                                                   CFT002
      * Use customer number                                               CFT002
      *                                                                   CFT002
     C                     OTHER                                          CFT002
     C                     MOVE *BLANKS   SBNC1                           CFT002
     C                     MOVELTRCNUM    SBNC1                           CFT002
     C                     MOVEL*BLANKS   SBNC2                           CFT002
     C                     MOVEL*BLANKS   SBNC3                           CFT002
     C                     MOVEL*BLANKS   SBNC4                           CFT002
     C                     MOVEL*BLANKS   SBNC5                           CFT002
     C                     ENDSL                                          CFT002
     C                     END                                            CFT002
     C                     END                                            CFT002
      *                                                                   CFT002
     C                     ENDSR                                          CFT002
      *                                                                   CFT002
      *================================================================   CFT002
      /EJECT                                                              CFT002
      *================================================================   CFT002
      *  Translate to retail and nostro code                              CFT002
      *================================================================   CFT002
      *                                                                   CFT002
     C           SRTRAN    BEGSR                                          CFT002
      *                                                                   CFT002
      * Clear Retail number and nostro code                               CFT002
      *                                                                   CFT002
     C           *LIKE     DEFN ACNO      ##ACNO                          CFT002
     C                     Z-ADD0         ##ACNO                          CFT002
     C           *LIKE     DEFN A7CYCD    ##NCCY                          CFT002
     C                     MOVEL*BLANKS   ##NCCY                          CFT002
     C           *LIKE     DEFN A7NONB    ##NONB                          CFT002
     C                     MOVEL*BLANKS   ##NONB                          CFT002
      *                                                                   CFT002
      * If TRCODE has no currency exit                                    CFT002
      *                                                                   CFT002
     C                     MOVE TRCODE    TRCDE2                          CFT002
     C           TRCYCD    CABEQ*BLANKS   EXTRAN                          CFT002
      *                                                                   CFT002
      * Find Account details                                              CFT002
      *                                                                   CFT002
     C                     MOVELTRCODE    ACKYDS                          CFT002
     C           KACKEY    CHAINACCNTABF             89                   CFT002
     C           *IN89     IFEQ '0'                                       CFT002
     C           RECI      ANDEQ'D'                                       CFT002
     C**********           Z-ADDRETNUM    CNUM                                         189639 CSD027
     C                     MOVE RETNUM    CNUM                                                CSD027
     C********** ATYP      ANDEQ'R'                                                    CFT002 189639
     C           ATYP      IFEQ 'R'                                                           189639
     C                     Z-ADDACNO      ##ACNO                          CFT002
     C                     ENDIF                                                              189639
     C                     END                                            CFT002
      *                                                                   CFT002
      * Find Nostro details                                               CFT002
      *                                                                   CFT002
     C                     CALL 'AONOSTR0'                                CFT002
     C                     PARM *BLANKS   @RTCD                           CFT002
     C                     PARM '*KEY   ' @OPTN                           CFT002
     C                     PARM CNUMA     @CUST                           CFT002
     C                     PARM CCY       @CYCD                           CFT002
     C                     PARM ACODA     @ACCD                           CFT002
     C                     PARM ACSQA     @ACSN                           CFT002
     C                     PARM *BLANKS   @NONB                           CFT002
     C                     PARM BRCA      @BRCD                           CFT002
     C                     PARM *BLANKS   @CSSN                           CFT002
     C                     PARM *BLANKS   @PNOI                           CFT002
     C           SDNOST    PARM *BLANKS   DSFDY                           CFT002
      *                                                                   CFT002
     C           @RTCD     IFEQ *BLANKS                                   CFT002
     C                     MOVELA7CYCD    ##NCCY                          CFT002
     C                     MOVELA7NONB    ##NONB                          CFT002
     C                     END                                            CFT002
      *                                                                   CFT002
     C           EXTRAN    ENDSR                                          CFT002
      *                                                                   CFT002
      *================================================================   CGL009
      *  Map Translated data for Incoming Fontis Messages                 CGL009
      *================================================================   CGL009
      *                                                                   CGL009
     C           SRFONT    BEGSR                                          CGL009
      *                                                                   CGL009
      ** Set up Defaults for Fontis                                       CGL009
      *                                                                   CGL009
     C                     MOVE 'N'       SSWPC                           CGL009
     C                     MOVE *BLANKS   SACBK                           CGL009
     C                     MOVE *BLANKS   SACBB                           CGL009
      *                                                                   CGL009
      ** Retrieve Electronic Banking ICD Details                          CGL009
      *                                                                   CGL009
     C                     CALL 'AOFONTR0'                                CGL009
     C                     PARM           @RTCD   7                       CGL009
     C                     PARM '*FIRST'  @OPTN   7                       CGL009
     C           SDFONT    PARM SDFONT    DSFDY                           CGL009
      *                                                                   CGL009
     C           @RTCD     IFNE *BLANKS                                   CGL009
     C                     MOVEL'AOFONTR0'WDBFIL                          CGL009
     C                     MOVEL'*CALL'   WDBKEY           ***************CGL009
     C                     Z-ADD67        WDBASE           * DB ERROR 67 *CGL009
     C                     EXSR UEABRT                     ***************CGL009
     C                     ELSE                                           CGL009
     C                     MOVE F8IPST    SPYST                           CGL009
     C                     MOVE F8TBKC    SBOKC                           CGL009
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
      * Related Reference                                                 CGL009
      *                                                                   CGL009
     C           P20       IFNE *BLANKS                                   CGL009
     C                     MOVELP20       DSTRAN                          CGL009
     C                     MOVELTTREF     RLPR                            CGL009
     C                     ELSE                                           CGL009
     C                     MOVEL*BLANKS   RLPR                            CGL009
     C                     END                                            CGL009
      *                                                                   CGL009
      ** Currency Code, Payment Amount, and Payment Date                  CGL009
      *                                                                   CGL009
     C           PDCA      IFNE *BLANKS                                   CGL009
     C                     MOVELPDCA      DSTRAN                          CGL009
     C                     MOVELTVCCY     SPCCY                           CGL009
      *                                                                   CGL009
     C                     MOVEATVAMT     YA1                             CGL009
     C                     Z-ADD1         C       30                      CGL009
      *                                                                   CGL009
     C           C         DOUGT15                                        CGL009
      *                                                                   CGL009
     C           YA1,C     IFEQ ','                                       CGL009
     C                     MOVE '.'       YA1,C                           CGL009
     C                     Z-ADD16        C                               CGL009
     C                     ELSE                                           CGL009
     C                     ADD  1         C                               CGL009
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
     C                     ENDDO                                          CGL009
      *                                                                   CGL009
     C                     MOVEAYA1       WNLAM                           CGL009
     C                     MOVEAYA1       W#PYAM 14                       CGL009
     C                     EXSR SRNULL                                    CGL009
      *                                                                   CGL009
     C           WNLNUL    IFEQ 'N'                                       CGL009
     C                     MOVELW#PYAM    SPYAM                           CGL009
     C                     ELSE                                           CGL009
     C                     MOVEL*BLANKS   SPYAM                           CGL009
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
      ** MMDDYY format display                                            CGL009
      *                                                                   CGL009
     C           WUDFF     IFEQ 'M'                                       CGL009
     C                     MOVELTVVDAT    SWDT1   6                       CGL009
     C           2         SUBSTSWDT1:5   MM                              CGL009
     C           2         SUBSTSWDT1:3   DDS                             CGL009
     C           2         SUBSTSWDT1:1   YY                              CGL009
     C                     MOVELSWDT2     SPYDT                           CGL009
     C                     ELSE                                           CGL009
      *                                                                   CGL009
      ** DDMMYY format display                                            CGL009
      *                                                                   CGL009
     C                     MOVELTVVDAT    SWDT1   6                       CGL009
     C           2         SUBSTSWDT1:5   DDS                             CGL009
     C           2         SUBSTSWDT1:3   MM                              CGL009
     C           2         SUBSTSWDT1:1   YY                              CGL009
     C                     MOVELSWDT2     SPYDT                           CGL009
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
     C                     Z-ADDBJRDNB    WVLDT   50                      CGL009
     C                     MOVELSPYDT     ZDATE                           CGL009
     C                     EXSR ZDATE1                                    CGL009
     C           *IN99     IFEQ '0'                                       CGL009
     C                     Z-ADDZDAYNO    WVLDT                           CGL009
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
      ** Debit Account                                                    CGL009
      *                                                                   CGL009
     C           P53       IFNE *BLANKS                                   CGL009
     C                     MOVE *BLANKS   W#P53P 35                       CGL009
     C                     MOVELP53       DSTRAN                          CGL009
     C                     MOVELTMLIN1    W#P53                           CGL009
      *                                                                   CGL009
     C           W#P53A    IFEQ '/'                                       CGL009
     C                     MOVELW#P53B    W#P53P                          CGL009
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
     C                     MOVEL*BLANKS   SSND2                           CGL009
     C                     MOVEL*BLANKS   SSND3                           CGL009
     C                     MOVEL*BLANKS   SSND4                           CGL009
      *                                                                   CGL009
     C           ' '       CHEKRW#P53P    W#LEN   20                      CGL009
      *                                                                   CGL009
      ** Check if it is a Retail Account                                  CGL009
      *                                                                   CGL009
     C           W#LEN     IFEQ 10                                        CGL009
     C                     MOVELW#P53P    P@RETL                          CGL009
     C                     MOVEL*BLANKS   P@CNUM                          CGL009
     C                     MOVEL*BLANKS   P@CUCD                          CGL009
     C                     MOVEL*BLANKS   P@ACCD                          CGL009
     C                     MOVEL*BLANKS   P@ACSQ                          CGL009
     C                     MOVEL*BLANKS   P@BRCA                          CGL009
     C                     ELSE                                           CGL009
      *                                                                   CGL009
      ** Account is not Retail but General Ledger                         CGL009
      *                                                                   CGL009
     C                     MOVEL*BLANKS   P@RETL                          CGL009
     C           3         SUBSTW#P53P:1  P@BRCA                          CGL009
     C           6         SUBSTW#P53P:4  P@CNUM                          CGL009
     C           3         SUBSTW#P53P:10 P@CUCD                          CGL009
     C********** 4         SUBSTW#P53P:13 P@ACCD                                       CGL009 CGL029
     C********** 2         SUBSTW#P53P:17 P@ACSQ                                       CGL009 CGL029
     C           10        SUBSTW#P53P:13 P@ACCD                                              CGL029
     C           2         SUBSTW#P53P:23 P@ACSQ                                              CGL029
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
      ** Access Account Details                                           CGL009
      *                                                                   CGL009
     C                     CALL 'AOACCTR0'             90                 CGL009
     C                     PARM           P@RTCD  7                       CGL009
     C                     PARM '*KEY   ' P@OPTN  7                       CGL009
     C                     PARM           P@RETL 10                       CGL009
     C                     PARM           P@CNUM  6                       CGL009
     C                     PARM           P@CUCD  3                       CGL009
     C**********           PARM           P@ACCD  4                                    CGL009 CGL029
     C                     PARM           P@ACCD 10                                           CGL029
     C                     PARM           P@ACSQ  2                       CGL009
     C                     PARM           P@BRCA  3                       CGL009
     C                     PARM           ACCINF                          CGL009
     C           P@RTCD    IFEQ *BLANK                                    175474
      *                                                                   CGL009
      ** If it is a G/L account we put the branch as the end              CGL009
      ** (BRCA/CUST/CCY/ACOD/SEQ) => (CUST/CCY/ACOD/SEQ/BRCA)             CGL009
      ** If it is a retail one, we don't format it                        CGL009
     C           W#LEN     IFEQ 10                                        CGL009
     C                     MOVELW#P53P    SSND1                           CGL009
     C                     ELSE                                           CGL009
     C           3         SUBSTW#P53P:1  WGLBCH                          CGL009
     C           3         SUBSTW#P53P:10 WGLCCY                          CGL009
     C           6         SUBSTW#P53P:4  WGLCST                          CGL009
     C********** 4         SUBSTW#P53P:13 WGLACD                                       CGL009 CGL029
     C********** 2         SUBSTW#P53P:17 WGLSQN                                       CGL009 CGL029
     C           10        SUBSTW#P53P:13 WGLACD                                              CGL029
     C           2         SUBSTW#P53P:23 WGLSQN                                              CGL029
     C                     MOVELDSGLDG    SSND1                           CGL009
     C                     ENDIF                                          CGL009
     C************LIKE     DEFN SSMCY     W53CCY                    CGL009175475
     C*********************MOVELIFCCY     W53CCY                    CGL009175475
     C                     MOVELIFBRCA    SBRCA                           CGL009
     C                     MOVELIFBRCA    SORBR                           CGL009
     C                     ELSE                                           175474
      ** If no valid account in tag 53 we concatenate line of             175474
      ** 53 (A/C debited)  + first lines of 50 (Ord Cust)                 175474
     C                     MOVELW#P53P    SSND1                           175474
     C                     MOVELP50       DSTRAN                          175474
     C                     MOVELTMLIN1    SSND2                           175474
     C                     MOVELTMLIN2    SSND3                           175474
     C                     MOVELTMLIN3    SSND4                           175474
     C*********************MOVEL*BLANK    W53CCY                    175474175475
      *                                                                   175474
     C                     ENDIF                                          175474
      *                                                                   CGL009
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
      ** Retrieve Default Profit Centre                                   CGL009
      *                                                                   CGL009
     C                     MOVELSPYTP     TRTP                            CGL009
     C                     MOVEL*BLANKS   DPPT                            CGL009
     C                     MOVEL*BLANKS   USRID                           CGL009
     C                     EXSR SRPRFC                                    CGL009
     C           SPRFC     IFEQ *BLANKS                                   CGL009
     C                     MOVELF8TPFC    SPRFC                           CGL009
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
      ** Beneficiary Customer                                             CGL009
      *                                                                   CGL009
     C           P59       IFNE *BLANKS                                   CGL009
     C                     MOVE *BLANKS   W#P59P 35                       CGL009
     C                     MOVELP59       DSTRAN                          CGL009
     C                     MOVELTMLIN1    W#P59                           CGL009
      *                                                                   CGL009
     C           W#P59A    IFEQ '/'                                       CGL009
     C                     MOVELW#P59B    W#P59P                          CGL009
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
     C           ' '       CHEKRW#P59P    W#LEN                           CGL009
      *                                                                   CGL009
      ** Check if it is a Retail Account                                  CGL009
      *                                                                   CGL009
     C           W#LEN     IFEQ 10                                        CGL009
     C                     MOVELW#P59P    P@RETL                          CGL009
     C                     MOVEL*BLANKS   P@CNUM                          CGL009
     C                     MOVEL*BLANKS   P@CUCD                          CGL009
     C                     MOVEL*BLANKS   P@ACCD                          CGL009
     C                     MOVEL*BLANKS   P@ACSQ                          CGL009
     C                     MOVEL*BLANKS   P@BRCA                          CGL009
     C                     ELSE                                           CGL009
      *                                                                   CGL009
      ** Account is not Retail but General Ledger                         CGL009
      *                                                                   CGL009
     C                     MOVEL*BLANKS   P@RETL                          CGL009
     C           3         SUBSTW#P59P:1  P@BRCA                          CGL009
     C           6         SUBSTW#P59P:4  P@CNUM                          CGL009
     C           3         SUBSTW#P59P:10 P@CUCD                          CGL009
     C********** 4         SUBSTW#P59P:13 P@ACCD                                       CGL009 CGL029
     C********** 2         SUBSTW#P59P:17 P@ACSQ                                       CGL009 CGL029
     C           10        SUBSTW#P59P:13 P@ACCD                                              CGL029
     C           2         SUBSTW#P59P:23 P@ACSQ                                              CGL029
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
      ** Access Account Details                                           CGL009
      *                                                                   CGL009
     C                     CALL 'AOACCTR0'             90                 CGL009
     C                     PARM           P@RTCD  7                       CGL009
     C                     PARM '*KEY   ' P@OPTN  7                       CGL009
     C                     PARM           P@RETL 10                       CGL009
     C                     PARM           P@CNUM  6                       CGL009
     C                     PARM           P@CUCD  3                       CGL009
     C**********           PARM           P@ACCD  4                                    CGL009 CGL029
     C                     PARM           P@ACCD                                              CGL029
     C                     PARM           P@ACSQ  2                       CGL009
     C                     PARM           P@BRCA  3                       CGL009
     C                     PARM           ACCINF                          CGL009
      *                                                                   CGL009
     C           P@RTCD    IFEQ *BLANKS                                   CGL009
      *                                                                   CGL009
     C           W#LEN     IFEQ 10                                        CGL009
     C                     MOVELW#P59P    SBNC1                           CGL009
     C                     ELSE                                           CGL009
     C           3         SUBSTW#P59P:1  W#BCH1                          CGL009
     C           6         SUBSTW#P59P:4  W#CUS1                          CGL009
     C********** 4         SUBSTW#P59P:13 W#ACD1                                       CGL009 CGL029
     C********** 2         SUBSTW#P59P:17 W#SQN1                                       CGL009 CGL029
     C           10        SUBSTW#P59P:13 W#ACD1                                              CGL029
     C           2         SUBSTW#P59P:23 W#SQN1                                              CGL029
     C                     MOVELW#BNC1    SBNC1                           CGL009
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
     C                     MOVEL*BLANKS   SBNC2                           CGL009
     C                     MOVEL*BLANKS   SBNC3                           CGL009
     C                     MOVEL*BLANKS   SBNC4                           CGL009
     C                     MOVEL*BLANKS   SBNC5                           CGL009
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
      ** Details of Charges                                               CGL009
      *                                                                   CGL009
     C           P71       IFNE *BLANKS                                   CGL009
     C                     MOVELP71       DSTRAN                          CGL009
      *                                                                   CGL009
     C           TTREF     IFEQ 'OUR'                                     CGL009
     C                     MOVEL'A'       SADDC                           CGL009
     C                     ELSE                                           CGL009
     C                     MOVEL'D'       SADDC                           CGL009
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
     C                     ELSE                                           CGL009
      *                                                                   CGL009
     C                     MOVEL'D'       SADDC                           CGL009
      *                                                                   CGL009
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
      ** Sender to Receiver Information                                   CGL009
      *                                                                   CGL009
     C           P72       IFEQ *BLANKS                                   CGL009
      ***Settlement*CCY*will*be*the*same*as*the*account*to*be*debitedGL009175475
     C*********************MOVELW53CCY    SSMCY                     CGL009175475
      ** Should never happen because FONTIS is supposed to send the       175475
      ** settlement currency via :72: /ORIG/                              175475
     C                     MOVEL*BLANK    SSMCY                           175475
      ** Funds tranferts fields have been cleared in EISWFT               CGL009
     C                     ELSE                                           CGL009
     C                     EXSR ICCHK                                     CGL009
     C                     MOVELP72       DSFONT                          CGL009
     C           FOUND     IFEQ 'Y'                                       CGL009
     C                     MOVEL*BLANKS   BBI6                            CGL009
     C                     MOVELFN72L2    BBI1                            CGL009
     C                     MOVELFN72L3    BBI2                            CGL009
     C                     MOVELFN72L4    BBI3                            CGL009
     C                     MOVELFN72L5    BBI4                            CGL009
     C                     MOVELFN72L6    BBI5                            CGL009
     C                     ELSE                                           CGL009
     C                     MOVELFN72L1    BBI1                            CGL009
     C                     MOVELFN72L2    BBI2                            CGL009
     C                     MOVELFN72L3    BBI3                            CGL009
     C                     MOVELFN72L4    BBI4                            CGL009
     C                     MOVELFN72L5    BBI5                            CGL009
     C                     MOVELFN72L6    BBI6                            CGL009
     C                     ENDIF                                          CGL009
     C                     MOVEL'/REF/'   WCW                             175479
     C                     MOVELFONT72    WCWLIN                          175479
     C                     Z-ADD30        WCWLEN                          175479
     C                     EXSR CWVAL                                     175479
     C           WCWVAL    IFNE *BLANK                                    175479
     C                     MOVELWCWVAL    SFDLR                           175479
     C                     ENDIF                                          175479
      *                                                                   175479
     C                     MOVEL'/ORIG/'  WCW                             CGL009
     C                     MOVELFONT72    WCWLIN                          CGL009
     C                     EXSR FOCMT2                                    CGL009
     C           WCWCY     IFNE *BLANK                                    CGL009
     C                     MOVELWCWCY     SSMCY                           CGL009
     C                     ELSE                                           CGL009
      ** Should never happen because FONTIS is supposed to send the       175475
      ** settlement currency via :72: /ORIG/                              175475
     C*********************MOVELW53CCY    SSMCY                     CGL009175475
     C                     MOVEL*BLANK    SSMCY                           175475
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
     C                     MOVELWCWAM     WNLAM                           CGL009
     C                     EXSR SRNULL                                    CGL009
      *                                                                   CGL009
     C           WNLNUL    IFEQ 'N'                                       CGL009
     C                     MOVELWCWAM     SSMAM                           CGL009
     C                     ELSE                                           CGL009
     C                     MOVEL*BLANKS   SSMAM                           CGL009
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
     C                     MOVEL'/RATE/'  WCW                             CGL009
     C                     MOVELFONT72    WCWLIN                          CGL009
     C                     EXSR SRRATE                                    CGL009
     C                     MOVELWCWRT     WNLAM                           CGL009
     C                     EXSR SRNULL                                    CGL009
     C           WNLNUL    IFEQ 'Y'                                       CGL009
     C                     MOVEL*BLANKS   WCWRT                           CGL009
     C                     ELSE                                           CGL009
      *                                                                   CGL009
      ** Decimal places in FT are stored on 8 digits                      CGL009
      ** => truncated if greater                                          CGL009
      *                                                                   CGL009
     C           WCWDPT    IFGT 8                                         CGL009
     C           '.'       SCAN WCWRT     IN      20                      CGL009
      *                                                                   CGL009
      ** Extract Digits + comma                                           CGL009
      *                                                                   CGL009
     C           IN        SUBSTWCWRT:1   #014A  14 P                     CGL009
     C                     ADD  1         IN                              CGL009
      *                                                                   CGL009
      ** Extract Decimals after comma                                     CGL009
      *                                                                   CGL009
     C           8         SUBSTWCWRT:IN  #008A   8 P                     CGL009
     C           #014A     CAT  #008A:0   WCWRT     P                     CGL009
     C                     ENDIF                                          CGL009
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
     C           WCWRT     IFNE *BLANKS                                   CGL009
      *                                                                   CGL009
     C                     MOVE WCWRT     SRATE                           CGL009
      *                                                                   CGL009
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
     C                     MOVEL'N'       OPIN                            CGL009
     C                     MOVEL*BLANKS   SNDAM                           CGL009
     C           SSMCY     IFEQ SNDCY                                     CGL009
     C                     MOVEL*BLANK    SNDCY                           CGL009
     C                     ENDIF                                          CGL009
     C                     MOVEL*BLANKS   SNC1                            CGL009
     C                     MOVEL*BLANKS   SNC2                            CGL009
     C                     MOVEL*BLANKS   SNC3                            CGL009
     C                     MOVEL*BLANKS   SNC4                            CGL009
     C                     MOVEL*BLANKS   SNC5                            CGL009
     C                     MOVEL*BLANKS   INB1                            CGL009
     C                     MOVEL*BLANKS   INB2                            CGL009
     C                     MOVEL*BLANKS   INB3                            CGL009
     C                     MOVEL*BLANKS   INB4                            CGL009
     C                     MOVEL*BLANKS   INB5                            CGL009
      *                                                                   CGL009
     C                     ENDSR                                          CGL009
      *                                                                   CGL009
      *================================================================   CGL009
      *  Test if an amount is null                                        CGL009
      *================================================================   CGL009
      *                                                                   CGL009
     C           SRNULL    BEGSR                                          CGL009
      *                                                                   CGL009
      ** Initialise working fields                                        CGL009
      *                                                                   CGL009
     C                     MOVEL'Y'       WNLNUL  1                       CGL009
     C***********          MOVEL'123456'  @NUL    9                CGL009 CFT014
     C***********          MOVE '789'     @NUL                     CGL009 CFT014
      *                                                                   CGL009
     C           WNLAM     IFNE *BLANK                                    CGL009
     C                     MOVEL*BLANKS   YA1                             CGL009
     C                     MOVEAWNLAM     YA1                             CGL009
      *                                                                   CGL009
     C                     DO   15        IN                              CGL009
     C           @NUL      CHECKYA1,IN                   82               CGL009
      *                                                                   CGL009
     C           *IN82     IFEQ '0'                                       CGL009
     C                     MOVEL'N'       WNLNUL                          CGL009
     C                     LEAVE                                          CGL009
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
     C                     ENDDO                                          CGL009
      *                                                                   CGL009
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
      ** Initialise working fields                                        CGL009
      *                                                                   CGL009
     C                     MOVEL*BLANKS   WNLAM  15                       CGL009
     C                     MOVEL*BLANKS   YA1     1                       CGL009
      *                                                                   CGL009
     C                     ENDSR                                          CGL009
      *                                                                   CGL009
      *================================================================   CGL009
      *  Retrieve currency details                                        CGL009
      *================================================================   CGL009
      *                                                                   CGL009
     C           SRCCYD    BEGSR                                          CGL009
      *                                                                   CGL009
      ** Initialise Work Fields                                           CGL009
      *                                                                   CGL009
     C                     Z-ADD0         WCYNDP  10                      CGL009
     C                     MOVEL*BLANK    WCYRTN  7                       CGL009
      *                                                                   CGL009
     C                     CALL 'AOCURRR0'             9090               CGL009
     C                     PARM *BLANKS   @RTCD                           CGL009
     C                     PARM '*KEY   ' @OPTN                           CGL009
     C                     PARM WCYCCY    @CCY                            CGL009
     C           SDCURR    PARM *BLANKS   DSSDY                           CGL009
      *                                                                   CGL009
      ** If error on call                                                 CGL009
      *                                                                   CGL009
     C           *IN90     IFEQ '1'                                       CGL009
     C           @RTCD     ORNE *BLANKS                                   CGL009
     C                     MOVEL'*ERROR'  WCYRTN                          CGL009
      *                                                                   CGL009
     C           WCYDMP    IFNE 'Y'                                       CGL009
     C                     GOTO EXRCYD                                    CGL009
     C                     ELSE                                           CGL009
      *                                                                   CGL009
     C           *IN90     IFEQ '1'                                       CGL009
     C                     MOVEL'AOCURRR0'WDBFIL           ***************CGL009
     C                     MOVEL'*CALL'   WDBKEY           * DB ERROR 69 *CGL009
     C                     Z-ADD69        WDBASE           ***************CGL009
     C                     EXSR UEABRT                                    CGL009
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
     C           @RTCD     IFNE *BLANKS                                   CGL009
     C                     MOVEL'AOCURRR0'WDBFIL           ***************CGL009
     C                     MOVELWCYCCY    WDBKEY           * DB ERROR 70 *CGL009
     C                     Z-ADD70        WDBASE           ***************CGL009
     C                     EXSR UEABRT                                    CGL009
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
     C                     END                                            CGL009
      *                                                                   CGL009
     C                     END                                            CGL009
      *                                                                   CGL009
      ** Store Decimal Places Spot Rate Multiply/Divide Ind.              CGL009
      *                                                                   CGL009
     C                     Z-ADDA6NBDP    WCYNDP                          CGL009
      *                                                                   CGL009
     C           EXRCYD    TAG                                            CGL009
      *                                                                   CGL009
      ** Reset input variables                                            CGL009
     C                     MOVEL*BLANK    WCYCCY  3                       CGL009
     C                     MOVEL*BLANK    WCYDMP  1                       CGL009
      *                                                                   CGL009
     C                     ENDSR                                          CGL009
      *                                                                   CGL009
      *================================================================   175479
      *  Retrieve FONTIS alphanumeric field identified by presence        175479
      *  of codework /XXXX/                                               175479
      *================================================================   175479
     C           CWVAL     BEGSR                                          175479
      *                                                                   175479
      *  Set up subroutine stack name                                     175479
      *                                                                   175479
     C                     ADD  1         O                               175479
     C                     MOVEL'CWVAL'   @STK,O                          175479
      ** Inputs                                                           175479
      ** ------                                                           175479
      ** Code work lines                                                  175479
      **                                  WCWLIN                          175479
      ** Code work                                                        175479
      **                                  WCW                             175479
      ** Code work length                                                 175479
      **                                  WCWLEN                          175479
      ** Outputs                                                          175479
      ** -------                                                          175479
      ** An alphanumeric field of max 256 length                          175479
     C           *LIKE     DEFN WCWLIN    WCWVAL                          175479
      *                                                                   175479
      ** Reset temporary variables                                        175479
     C                     MOVEL*BLANK    @CW                             175479
     C                     MOVEL*BLANK    @VL                             175479
     C                     MOVEL*BLANK    WCWVAL                          175479
     C                     Z-ADD0         LN      20                      175479
     C                     Z-ADD0         VL      30                      175479
     C           *LIKE     DEFN VL        LNCW                            175479
     C           *LIKE     DEFN VL        WT                              175479
     C                     Z-ADD0         WT                              175479
     C                     Z-ADD0         LNCW                            175479
      *                                                                   175479
      ** Length of tag containing the code works                          175479
     C           ' '       CHEKRWCWLIN    LNCW                            175479
      *                                                                   175479
      ** Length of search argument                                        175479
     C           ' '       CHEKRWCW       LN                              175479
      *                                                                   175479
     C           WCW:LN    SCAN WCWLIN:1  VL             81               175479
     C           *IN81     IFEQ *ON                                       175479
     C                     MOVEAWCWLIN    @CW                             175479
     C           VL        ADD  LN        VL                              175479
      *                                                                   175479
      ** We start to extract the value right after the code work          175479
      ** (so we need to know the length of the code work)                 175479
      ** We stop extracting when                                          175479
      ** - another / (and therefore another code work) has been found     175479
      ** - we reached the length to extract                               175479
      ** - we reached the length of the tag                               175479
     C           WT        DOWLTWCWLEN                                    175479
     C           VL        ANDLELNCW                                      175479
     C           @CW,VL    ANDNE'/'                                       175479
     C                     ADD  1         WT                              175479
     C                     MOVEL@CW,VL    @VL,WT                          175479
     C                     ADD  1         VL                              175479
     C                     ENDDO                                          175479
     C                     MOVEA@VL       WCWVAL                          175479
     C                     ENDIF                                          175479
      *                                                                   175479
      ** Reset input variables                                            175479
     C                     MOVEL*BLANKS   WCWLIN256                       175479
     C                     MOVEL*BLANKS   WCW     6                       175479
     C                     Z-ADD0         WCWLEN  30                      175479
      *                                                                   175479
      *  Unwind subroutine stack name                                     175479
      *                                                                   175479
     C           EXCWVL    TAG                                            175479
     C                     MOVEA*BLANKS   @STK,O                          175479
     C                     SUB  1         O       50                      175479
      *                                                                   175479
     C                     ENDSR                                          175479
      *                                                                   175479
      *================================================================   CGL009
      *  Retrieve the rate and the multiply/divide indicator              CGL009
      *================================================================   CGL009
      *                                                                   CGL009
     C           SRRATE    BEGSR                                          CGL009
      *                                                                   CGL009
      ** Reset Work Variables                                             CGL009
      *                                                                   CGL009
     C                     MOVEL*BLANK    WCWRT  14                       CGL009
     C                     Z-ADD0         WCWDPT  10                      CGL009
     C                     Z-ADD0         WCWDP   20                      CGL009
      *                                                                   CGL009
     C           WCW       SCAN WCWLIN:1  @F      30     81               CGL009
     C           *IN81     IFEQ '1'                                       CGL009
     C                     ADD  6         @F                              CGL009
      *                                                                   CGL009
      ** Move possible 13 chars to work array and work string             CGL009
      *                                                                   CGL009
     C           13        SUBSTWCWLIN:@F @R     13                       CGL009
     C                     MOVEA@R        @R1                             CGL009
     C                     CLEAR@R                                        CGL009
      *                                                                   CGL009
      ** If ',' in rate string @R change to '.'                           CGL009
      ** Only need to check valid chars till one ',' found                CGL009
      *                                                                   CGL009
     C                     Z-ADD1         @C      30                      CGL009
     C                     MOVE *BLANKS   @T      1                       CGL009
      *                                                                   CGL009
     C           1         DO   13        @C                              CGL009
     C           @R1,@C    IFEQ ','                                       CGL009
     C                     MOVE '.'       @R1,@C                          CGL009
      *                                                                   CGL009
      ** Retrieve the number of decimal position                          CGL009
      *                                                                   CGL009
     C           @CHK      CHECKR1        @F      30                      CGL009
     C           @F        IFNE 0                                         CGL009
     C           @F        SUB  1         @F                              CGL009
     C           @F        SUB  @C        WCWDP                           CGL009
     C                     ELSE                                           CGL009
     C           13        SUB  @C        WCWDP                           CGL009
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
      ** Decimal position can be handled only on one 1 digit              CGL009
      ** => range 0-9  (otherwise truncated to 9)                         CGL009
      *                                                                   CGL009
     C           WCWDP     IFGT 9                                         CGL009
     C                     Z-ADD9         WCWDPT                          CGL009
     C                     ELSE                                           CGL009
     C                     Z-ADDWCWDP     WCWDPT                          CGL009
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
     C                     LEAVE                                          CGL009
     C                     ENDIF                                          CGL009
     C                     ENDDO                                          CGL009
      *                                                                   CGL009
     C                     Z-ADD1         @C                              CGL009
     C                     MOVE *BLANKS   @T      1                       CGL009
     C                     MOVEA@R1       @R                              CGL009
      *                                                                   CGL009
      ** Get amount - upto 13 chars possible                              CGL009
      *                                                                   CGL009
     C           @C        DOUGT13                                        CGL009
     C                     MOVE @R1,@C    @T                              CGL009
     C           @CHK      CHECK@T        @F             82               CGL009
      *                                                                   CGL009
      ** Char not valid must be end of rate                               CGL009
      *                                                                   CGL009
     C           *IN82     IFEQ *ON                                       CGL009
     C           @C        IFNE 1                                         CGL009
     C           @C        SUB  1         @F                              CGL009
     C           @F        SUBST@R:1      WCWRT                           CGL009
     C                     ENDIF                                          CGL009
     C                     LEAVE                                          CGL009
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
      ** All chars in string ok                                           CGL009
      *                                                                   CGL009
     C           @C        IFEQ 13                                        CGL009
     C                     MOVEL@R        WCWRT                           CGL009
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
     C                     ADD  1         @C                              CGL009
      *                                                                   CGL009
     C                     ENDDO                                          CGL009
      *                                                                   CGL009
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
      ** Reset input variables                                            CGL009
      *                                                                   CGL009
     C                     MOVEL*BLANKS   WCWLIN                          CGL009
     C                     MOVEL*BLANKS   WCW                             CGL009
      *                                                                   CGL009
     C                     ENDSR                                          CGL009
      *================================================================   CGL009
      *  Scan for /OCMT/, /ORIG/, /RATE/                                  CGL009
      *================================================================   CGL009
     C           ICCHK     BEGSR                                          CGL009
     C*                                                                   CGL009
     C                     MOVEL*BLANKS   FOUND   1                       CGL009
     C*                                                                   CGL009
     C           '/RATE/'  SCAN P72:1     @X      30     81               CGL009
     C           *IN81     IFEQ *OFF                                      CGL009
     C           '/ORIG/'  SCAN P72:1     @X             81               CGL009
     C           *IN81     IFEQ *OFF                                      CGL009
     C           '/OCMT/'  SCAN P72:1     @X             81               CGL009
     C                     ENDIF                                          CGL009
     C                     ENDIF                                          CGL009
     C*                                                                   CGL009
     C           *IN81     IFEQ *ON                                       CGL009
     C                     MOVE 'Y'       FOUND                           CGL009
     C                     ENDIF                                          CGL009
     C*                                                                   CGL009
     C                     ENDSR                                          CGL009
      *================================================================   CFT014
      /EJECT                                                              CFT014
      *****************************************************************   CFT014
      *                                                               *   CFT014
      *  SRRCCS - Validate Receiver's Correspondent as a              *   CFT014
      *           Customer Shortname                                  *   CFT014
      *                                                               *   CFT014
      *****************************************************************   CFT014
      *                                                                   CFT014
     C           SRRCCS    BEGSR                                          CFT014
      *                                                                   CFT014
      ** Set up subroutine stack name.                                    CFT014
      *                                                                   CFT014
     C                     ADD  1         O                               CFT014
     C                     MOVEL'SRRCCS'  @STK,O                          CFT014
      *                                                                   CFT014
      ** Access AOCUSTR0 using SRCO1.                                     CFT014
      *                                                                   CFT014
     C                     CALL 'AOCUSTR0'                                CFT014
     C                     PARM *BLANKS   @RTCD                           CFT014
     C                     PARM '*KEY   ' @OPTN                           CFT014
     C                     PARM SRCO1     @KEY1                           CFT014
     C                     PARM *BLANKS   @KYST                           CFT014
     C           SDCUST    PARM SDCUST    DSSDY                           CFT014
      *                                                                   CFT014
     C           @RTCD     IFEQ *BLANKS                                   CFT014
     C           @KYST     ANDEQ'*CSHT'                                   CFT014
     C                     EXSR MVCUST                                    CFT014
     C                     MOVE 'C'       WRCRT                           CFT014
     C                     MOVE CNUM      WCNUM2                          CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
     C           WERCD     IFNE *BLANKS                                   CFT014
     C                     ADD  1         I                               CFT014
     C                     MOVE WERCD     ERCD,I                          CFT014
     C                     MOVEL*BLANKS   WERCD                           CFT014
     C                     ELSE                                           CFT014
     C           WMSID     IFNE *BLANKS                                   CFT014
     C                     MOVELWMSID     FTMSID                          CFT014
     C                     MOVEL'FTUSRMSG'FTMSGF                          CFT014
     C                     MOVEL'Y'       FTNOUP                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     ELSE                                           CFT014
     C                     MOVEL'FTM3104' FTMSID                          CFT014
     C                     MOVEL'FTUSRMSG'FTMSGF                          CFT014
     C                     MOVEL'Y'       FTNOUP                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
     C                     SETON                     48                   CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           EXRCCS    TAG                                            CFT014
     C                     MOVEA*BLANKS   @STK,O                          CFT014
     C                     SUB  1         O                               CFT014
      *                                                                   CFT014
     C                     ENDSR                                          CFT014
      *                                                                   CFT014
      *****************************************************************   CFT014
      /EJECT                                                              CFT014
      *****************************************************************   CFT014
      *                                                               *   CFT014
      *  SRTRIB - Validate Third Reimbursement Institution            *   CFT014
      *                                                               *   CFT014
      *****************************************************************   CFT014
      *                                                                   CFT014
     C           SRTRIB    BEGSR                                          CFT014
     C/COPY WNCPYSRC,FT0050C213
      *                                                                   CFT014
      ** Set up subroutine stack name.                                    CFT014
      *                                                                   CFT014
     C                     ADD  1         O                               CFT014
     C                     MOVEL'SRTRIB'  @STK,O                          CFT014
      *                                                                   CFT014
     C                     MOVE *BLANKS   WTRIT   1                       CFT014
     C                     MOVE *BLANKS   WTRCCY  3                       CFT014
     C                     MOVE *BLANKS   WATYP5  1                       CFT014
     C                     MOVE *BLANKS   WACST5  1                       CFT014
     C**********           MOVE *BLANKS   WTRIDS 18                                    CFT014 CGL029
     C                     MOVE *BLANKS   WTRIDS 24                                           CGL029
     C                     Z-ADD0         WDACO5  50                      CFT014
     C                     MOVE *BLANKS   WMSID                           CFT014
     C                     MOVE STRIB     W34RMB                          CFT014
      *                                                                   CFT014
      ** Display warning error if Level Joiner is off, action is          CFT014
      ** Amend, Sender Correspondent is blank and Third                   CFT014
      ** Reimbursement has been entered.                                  CFT014
      *                                                                   CFT014
     C           STRIB     IFNE WTRIB                                     CFT014
      *                                                                   CFT014
     C           BTLVJN    IFNE 'Y'                                       CFT014
     C           SACTCD    ANDEQ'A'                                       CFT014
     C           SNCT      ANDEQ*BLANK                                    CFT014
     C           STRIB     ANDNE*BLANKS                                   CFT014
     C                     MOVEL'FTM3159' FTMSID                          CFT014
     C                     MOVEL'FTUSRMSG'FTMSGF                          CFT014
     C                     MOVEL'Y'       FTNOUP                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     SETON                     83                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Check Third Reimbursement Institution for entry of '?'.          CFT014
      *                                                                   CFT014
     C                     MOVE '0'       *IN18                           CFT014
     C                     MOVEA*BLANKS   QUERY                           CFT014
     C                     MOVEASTRIB     QUERY                           CFT014
     C           '?'       LOKUPQUERY                    18               CFT014
      *                                                                   CFT014
     C           *IN18     IFEQ *ON                                       CFT014
     C                     MOVEL'FTM3105' FTMSID                          CFT014
     C                     MOVEL'FTUSRMSG'FTMSGF                          CFT014
     C                     MOVEL'Y'       FTNOUP                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     SETON                     83                   CFT014
     C                     GOTO EXTRIB                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Third Reimbursement Institution is blank.                        CFT014
      *                                                                   CFT014
     C           STRIB     IFEQ *BLANKS                                   CFT014
      *                                                                   CFT014
      ** Bypass validation if Receiver's Correspondent is blank.          CFT014
      *                                                                   CFT014
     C           WRCRT     IFEQ *BLANK                                    CFT014
     C                     GOTO EXTRIB                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Error if Receiver's Correspondent is valid but is                CFT014
      ** not a Nostro and not a Retail a/c and not an IBAN a/c and not    CFT014
      ** a GL a/c.                                                        CFT014
      *                                                                   CFT014
     C           *IN48     IFEQ *OFF                                      CFT014
     C           WRCRT     ANDNE'N'                                       CFT014
     C           WRCRT     ANDNE'F'                                       CFT014
     C           WRCRT     ANDNE'R'                                       CFT014
     C           WRCRT     ANDNE'I'                                       CFT014
     C           WRCRT     ANDNE'G'                                       CFT014
      *                                                                   CFT014
     C           CFT004    IFEQ 'Y'                                       CFT014
     C                     MOVEL'FTM3106' FTMSID                          CFT014
     C                     MOVEL'FTUSRMSG'FTMSGF                          CFT014
     C                     MOVEL'Y'       FTNOUP                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     ELSE                                           CFT014
     C                     MOVEL'FTM3124' FTMSID                          CFT014
     C                     MOVEL'FTUSRMSG'FTMSGF                          CFT014
     C                     MOVEL'Y'       FTNOUP                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     SETON                     83                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Error if Receiver's Correspondent is a Nostro or a               CFT014
      ** Retail a/c or an IBAN a/c or a GL a/c but a/c currency is not    CFT014
      ** equal to settle currency.                                        CFT014
      *                                                                   CFT014
     C           WRCRT     IFEQ 'N'                                       CFT014
     C           WRCRT     OREQ 'F'                                       CFT014
     C           WRCRT     OREQ 'R'                                       CFT014
     C           WRCRT     OREQ 'I'                                       CFT014
     C           WRCRT     OREQ 'G'                                       CFT014
      *                                                                   CFT014
     C           WRCCCY    IFNE SSMCY                                     CFT014
     C                     MOVEL'FTM3158' FTMSID                          CFT014
     C                     MOVEL'FTUSRMSG'FTMSGF                          CFT014
     C                     MOVEL'Y'       FTNOUP                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     SETON                     83                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     GOTO EXTRIB                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** If Receiver's Correspondent has not been entered,                CFT014
      ** Third Reimbursement Institution must be blank.                   CFT014
      *                                                                   CFT014
     C           SRCO1     IFEQ *BLANKS                                   CFT014
     C           SRCO2     ANDEQ*BLANKS                                   CFT014
     C           SRCO3     ANDEQ*BLANKS                                   CFT014
     C           SRCO4     ANDEQ*BLANKS                                   CFT014
     C           SRCO5     ANDEQ*BLANKS                                   CFT014
     C                     MOVEL'FTM3147' FTMSID                          CFT014
     C                     MOVEL'FTUSRMSG'FTMSGF                          CFT014
     C                     MOVEL'Y'       FTNOUP                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     SETON                     83                   CFT014
     C                     GOTO EXTRIB                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** If switchable feature CFT004 is installed, validate entry        CFT014
      ** as an IBAN.                                                      CFT014
      *                                                                   CFT014
     C           CFT004    IFEQ 'Y'                                       CFT014
      *                                                                   CFT014
     C                     MOVELSTRIB     PIBAN                           CFT014
      *                                                                   CFT014
     C                     CALL 'AOIBANR3'                                CFT014
     C                     PARM           @RTCD                           CFT014
     C                     PARM           PIBAN                           CFT014
     C                     PARM           POWITH                          CFT014
     C           P@IBAN    PARM           PONOBL                          CFT014
      *                                                                   CFT014
     C           @RTCD     IFEQ *BLANKS                                   CFT014
      *                                                                   CFT014
     C           1         SUBSTP@IBAN:1  WTRD1                           CFT014
     C           1         SUBSTP@IBAN:2  WTRD2                           CFT014
     C           1         SUBSTP@IBAN:3  WTRD3                           CFT014
     C           1         SUBSTP@IBAN:4  WTRD4                           CFT014
     C           WTRD1     LOKUPALPH                     88               CFT014
     C   88      WTRD2     LOKUPALPH                     88               CFT014
     C   88      WTRD3     LOKUPNUMC                     88               CFT014
     C   88      WTRD4     LOKUPNUMC                     88               CFT014
      *                                                                   CFT014
      ** Entry is in valid IBAN format.                                   CFT014
      *                                                                   CFT014
     C           *IN88     IFEQ *ON                                       CFT014
     C                     MOVE *BLANKS   DSSDY                           CFT014
     C                     CALL 'AOIBANR2'                                CFT014
     C                     PARM           @RTCD                           CFT014
     C                     PARM           P@IBAN                          CFT014
     C           P@ACCN    PARM           DSSDY                           CFT014
      *                                                                   CFT014
      ** IBAN entry is an invalid ISO country code.                       CFT014
      *                                                                   CFT014
     C           @RTCD     IFEQ '      1'                                 CFT014
     C                     MOVEL'FTM3125' WMSID                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Invalid BBAN length on country file for IBAN entry.              CFT014
      *                                                                   CFT014
     C           @RTCD     IFEQ '      2'                                 CFT014
     C                     MOVEL'FTM3126' WMSID                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** IBAN entry contains invalid characters.                          CFT014
      *                                                                   CFT014
     C           @RTCD     IFEQ '      3'                                 CFT014
     C                     MOVEL'FTM3127' WMSID                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** IBAN length of BBAN  is incorrect.                               CFT014
      *                                                                   CFT014
     C           @RTCD     IFEQ '      4'                                 CFT014
     C                     MOVEL'FTM3128' WMSID                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Check Digits are incorrect for IBAN entry.                       CFT014
      *                                                                   CFT014
     C           @RTCD     IFEQ '      5'                                 CFT014
     C                     MOVEL'FTM3129' WMSID                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** IBAN account does not exist on the system.                       CFT014
      *                                                                   CFT014
     C           @RTCD     IFEQ '      6'                                 CFT014
     C                     MOVEL'FTM3130' WMSID                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** IBAN is valid.                                                   CFT014
      *                                                                   CFT014
     C           @RTCD     IFEQ *BLANKS                                   CFT014
     C                     MOVEL*BLANKS   STRIB                           CFT014
     C                     MOVELP@IBAN    STRIB                           CFT014
     C**********           Z-ADDIBCNUM    CNUM                                         CFT014 CSD027
     C                     MOVE IBCNUM    CNUM                                                CSD027
     C                     Z-ADDIBACOD    ACOD                            CFT014
     C                     Z-ADDIBACSQ    ACSQ                            CFT014
     C                     MOVE IBBRCA    BRCA                            CFT014
     C                     MOVE CCY       WTRCCY                          CFT014
     C                     MOVE 'I'       WTRIT                           CFT014
     C                     GOTO EXTRIB                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** If multi-branching and entry is more than 18 characters          CFT014
      ** OR if single-branching and entry is more than 15                 CFT014
      ** characters, display error message and bypass validation.         CFT014
      *                                                                   CFT014
     C           *IN10     IFEQ *ON                                       CFT014
     C           W1934T    ANDNE*BLANKS                                   CFT014
     C           *IN10     OREQ *OFF                                      CFT014
     C           W1634T    ANDNE*BLANKS                                   CFT014
      *                                                                   CFT014
     C           WMSID     IFNE *BLANKS                                   CFT014
     C                     MOVE WMSID     FTMSID                          CFT014
     C                     ELSE                                           CFT014
     C           CFT004    IFEQ 'Y'                                       CFT014
     C                     MOVEL'FTM3131' FTMSID                          CFT014
     C                     ELSE                                           CFT014
     C                     MOVEL'FTM3148' FTMSID                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     MOVEL'FTUSRMSG'FTMSGF                          CFT014
     C                     MOVEL'Y'       FTNOUP                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     SETON                     83                   CFT014
     C                     GOTO EXTRIB                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     MOVE *BLANKS   WA15                            CFT014
     C                     MOVE *BLANKS   WA18                            CFT014
     C                     MOVEL*BLANKS   YA3                             CFT014
      *                                                                   CFT014
      ** Check for embedded blanks in positions 1-18 (for                 CFT014
      ** multi-branching) and in positions 1-15 (for single-              CFT014
      ** branching).                                                      CFT014
      *                                                                   CFT014
     C           *IN10     IFEQ *ON                                       CFT014
     C                     MOVELSTRIB     WA18                            CFT014
     C                     MOVEAWA18      YA3,1                           CFT014
     C                     Z-ADD18        WNUM    30                      CFT014
     C                     ELSE                                           CFT014
     C                     MOVELSTRIB     WA15                            CFT014
     C                     MOVEAWA15      YA3,1                           CFT014
     C                     Z-ADD15        WNUM                            CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     SETOF                     8889                 CFT014
     C                     Z-ADD1         I1                              CFT014
     C           *IN89     DOUEQ'1'                                       CFT014
     C           I1        ORGT WNUM                                      CFT014
     C           YA3,I1    IFEQ *BLANKS                                   CFT014
     C                     SETON                     88                   CFT014
     C                     ELSE                                           CFT014
     C           *IN88     IFEQ *ON                                       CFT014
     C                     SETON                     89                   CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
     C                     ADD  1         I1                              CFT014
     C                     ENDDO                                          CFT014
      *                                                                   CFT014
      ** Error if there are embedded spaces.                              CFT014
      *                                                                   CFT014
     C           *IN89     IFEQ *ON                                       CFT014
     C           CFT004    IFEQ 'Y'                                       CFT014
     C                     MOVEL'FTM3132' FTMSID                          CFT014
     C                     ELSE                                           CFT014
     C                     MOVEL'FTM3148' FTMSID                          CFT014
     C                     ENDIF                                          CFT014
     C                     MOVEL'FTUSRMSG'FTMSGF                          CFT014
     C                     MOVEL'Y'       FTNOUP                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     SETON                     83                   CFT014
     C                     GOTO EXTRIB                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Check positions 6-34 of Third Reimbursement are blanks           CFT014
      ** If position 5 is blank, display error message and bypass         CFT014
      ** remaining validation.                                            CFT014
      *                                                                   CFT014
     C           W0634T    IFEQ *BLANKS                                   CFT014
      *                                                                   CFT014
     C           W05T      IFEQ *BLANKS                                   CFT014
     C                     MOVEL'FTM3123' FTMSID                          CFT014
     C                     MOVEL'FTUSRMSG'FTMSGF                          CFT014
     C                     MOVEL'Y'       FTNOUP                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     SETON                     83                   CFT014
     C                     GOTO EXTRIB                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** If positions 4-5 is not numeric, display error message           CFT014
      ** and bypass remaining validation.                                 CFT014
      *                                                                   CFT014
     C                     TESTN          W0405T     88                   CFT014
      *                                                                   CFT014
     C           *IN88     IFEQ *OFF                                      CFT014
     C                     MOVEL'FTM3123' FTMSID                          CFT014
     C                     MOVEL'FTUSRMSG'FTMSGF                          CFT014
     C                     MOVEL'Y'       FTNOUP                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     SETON                     83                   CFT014
     C                     GOTO EXTRIB                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Check if entry is an existing full Nostro identifier.            CFT014
      *                                                                   CFT014
     C                     CALL 'AONOSTR0'                                CFT014
     C                     PARM *BLANKS   @RTCD                           CFT014
     C                     PARM '*KEY   ' @OPTN                           CFT014
     C                     PARM *BLANKS   @CUST                           CFT014
     C                     PARM W0103T    @CYCD                           CFT014
     C                     PARM *BLANKS   @ACCN                           CFT014
     C                     PARM *BLANKS   @ACSN                           CFT014
     C                     PARM W0405T    @NONB                           CFT014
     C                     PARM *BLANKS   @BRCD                           CFT014
     C                     PARM *BLANKS   @CSSN                           CFT014
     C                     PARM *BLANKS   @PNOI                           CFT014
     C           SDNOST    PARM SDNOST    DSFDY                           CFT014
      *                                                                   CFT014
     C           @RTCD     IFNE *BLANKS                                   CFT014
     C                     MOVEL'FTM3133' FTMSID                          CFT014
     C                     MOVEL'FTUSRMSG'FTMSGF                          CFT014
     C                     MOVEL'Y'       FTNOUP                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     SETON                     83                   CFT014
     C                     GOTO EXTRIB                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     EXSR MVNOS1                                    CFT014
      *                                                                   CFT014
     C**********           Z-ADDCNUM      CNUMSV                                       CFT014 CSD027
     C                     MOVE CNUM      CNUMSV                                              CSD027
     C                     MOVELSTRIB     CCYSV                           CFT014
     C                     Z-ADDACOD      ACODSV                          CFT014
     C                     Z-ADDACSQ      ACSQSV                          CFT014
     C                     MOVE BRCA      BRCASV                          CFT014
      *                                                                   CFT014
     C                     MOVE W0103T    WTRCCY                          CFT014
     C                     MOVE 'F'       WTRIT                           CFT014
      *                                                                   CFT014
     C                     GOTO EXTRIB                                    CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Validate entry as Retail a/c number if positions 11 to 34        CFT014
      ** are blanks and Retail module (*IN32) is ON.                      CFT014
      *                                                                   CFT014
     C           W1134T    IFEQ *BLANKS                                   CFT014
     C           *IN32     ANDEQ*ON                                       CFT014
      *                                                                   CFT014
      ** Error if position 10 is blank.                                   CFT014
      *                                                                   CFT014
     C           W10T      IFEQ *BLANKS                                   CFT014
     C                     MOVEL'FTM3134' FTMSID                          CFT014
     C                     MOVEL'FTUSRMSG'FTMSGF                          CFT014
     C                     MOVEL'Y'       FTNOUP                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     SETON                     83                   CFT014
     C                     GOTO EXTRIB                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Error if entry is not numeric.                                   CFT014
      *                                                                   CFT014
     C                     TESTN          W0110T     88                   CFT014
      *                                                                   CFT014
     C           *IN88     IFEQ *OFF                                      CFT014
     C                     MOVEL'FTM3134' FTMSID                          CFT014
     C                     MOVEL'FTUSRMSG'FTMSGF                          CFT014
     C                     MOVEL'Y'       FTNOUP                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     SETON                     83                   CFT014
     C                     GOTO EXTRIB                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** If entry is numeric, save value to ACNO and execute UMAACN       CFT014
      ** to check if live record exists on file.                          CFT014
      *                                                                   CFT014
     C                     MOVE *BLANKS   W10N                            CFT014
     C                     MOVELSTRIB     W10N                            CFT014
     C                     MOVELW10N      ACNO                            CFT014
     C                     EXSR UMAACN                                    CFT014
      *                                                                   CFT014
      ** If no live record found, display error message and bypass        CFT014
      ** remaining validation.                                            CFT014
      *                                                                   CFT014
     C           *IN89     IFEQ *ON                                       CFT014
     C                     MOVEL'FTM3135' FTMSID                          CFT014
     C                     MOVEL'FTUSRMSG'FTMSGF                          CFT014
     C                     MOVEL'Y'       FTNOUP                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     SETON                     83                   CFT014
     C                     GOTO EXTRIB                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** If Retail a/c no. is not supported by the system,                CFT014
      ** display error message and bypass remaining validation.           CFT014
      *                                                                   CFT014
     C           BMRANR    IFNE 'Y'                                       CFT014
     C                     MOVEL'FTM3136' FTMSID                          CFT014
     C                     MOVEL'FTUSRMSG'FTMSGF                          CFT014
     C                     MOVEL'Y'       FTNOUP                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     SETON                     83                   CFT014
     C                     GOTO EXTRIB                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     MOVE CCY       WTRCCY                          CFT014
     C                     MOVE 'R'       WTRIT                           CFT014
     C                     GOTO EXTRIB                                    CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** If entry for positions 1-6 is not numeric, display               CFT014
      ** error message and bypass remaining validation.                   CFT014
      *                                                                   CFT014
     C                     MOVELSTRIB     W6N     6                       CFT014
     C                     TESTN          W6N        88                   CFT014
      *                                                                   CFT014
     C           *IN88     IFEQ *OFF                                      CFT014
     C                     MOVEL'FTM3137' FTMSID                          CFT014
     C                     MOVEL'FTUSRMSG'FTMSGF                          CFT014
     C                     MOVEL'Y'       FTNOUP                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     SETON                     83                   CFT014
     C                     GOTO EXTRIB                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** If entry for positions 10-15 is not numeric, display             CFT014
      ** error message and bypass remaining validation.                   CFT014
      *                                                                   CFT014
     C                     TESTN          W1015T     88                   CFT014
      *                                                                   CFT014
     C           *IN88     IFEQ *OFF                                      CFT014
     C                     MOVEL'FTM3137' FTMSID                          CFT014
     C                     MOVEL'FTUSRMSG'FTMSGF                          CFT014
     C                     MOVEL'Y'       FTNOUP                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     SETON                     83                   CFT014
     C                     GOTO EXTRIB                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     MOVE W0106T    KACNUM                          CFT014
     C                     MOVE W0709T    KACCCY                          CFT014
     C                     MOVE W1013T    KACCD                           CFT014
     C                     MOVE W1415T    KACSQ                           CFT014
      *                                                                   CFT014
      ** If multi-branching, move values of positions 16-18               CFT014
      ** to KBRCA.  Otherwise, move values of BJSBRC if                   CFT014
      ** single -branching.                                               CFT014
      *                                                                   CFT014
     C           *IN10     IFEQ *ON                                       CFT014
     C                     MOVE W1618T    KBRCA                           CFT014
     C                     ELSE                                           CFT014
     C                     MOVE BJSBRC    KBRCA                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     EXSR UOACCN                                    CFT014
      *                                                                   CFT014
      ** Error if no existing live account.                               CFT014
      *                                                                   CFT014
     C           *IN89     IFEQ *ON                                       CFT014
     C                     MOVEL'FTM3138' FTMSID                          CFT014
     C                     MOVEL'FTUSRMSG'FTMSGF                          CFT014
     C                     MOVEL'Y'       FTNOUP                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     SETON                     83                   CFT014
     C                     GOTO EXTRIB                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     MOVE CCY       WTRCCY                          CFT014
     C                     MOVE 'G'       WTRIT                           CFT014
      *                                                                   CFT014
     C           EXTRIB    TAG                                            CFT014
     C                     MOVEA*BLANKS   @STK,O                          CFT014
     C                     SUB  1         O                               CFT014
      *                                                                   CFT014
     C                     ENDSR                                          CFT014
      *                                                                   CFT014
      *****************************************************************   CFT014
      /EJECT                                                              CFT014
      *****************************************************************   CFT014
      *                                                               *   CFT014
      *  SRIDFT - Additional Defaulting Process for                   *   CFT014
      *           Instructed Currency / Amount                        *   CFT014
      *                                                               *   CFT014
      *****************************************************************   CFT014
      *                                                                   CFT014
     C           SRIDFT    BEGSR                                          CFT014
      *                                                                   CFT014
      ** Set up subroutine stack name.                                    CFT014
      *                                                                   CFT014
     C                     ADD  1         O                               CFT014
     C                     MOVEL'SRIDFT'  @STK,O                          CFT014
      *                                                                   CFT014
     C           WSNTP     IFNE 'F'                                       CFT014
     C           WSNTP     ANDNE'R'                                       CFT014
     C           WSNTP     ANDNE'G'                                       CFT014
     C           WSNTP     ANDNE'C'                                       CFT014
     C           WSNTP     ANDNE'S'                                       CFT014
     C                     GOTO EXIDFT                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Check for Support Charge Transparency flag for                   CFT014
      ** Sender Country Code.                                             CFT014
      *                                                                   CFT014
     C           WSNTP     IFEQ 'F'                                       CFT014
     C           WSNTP     OREQ 'R'                                       CFT014
     C           WSNTP     OREQ 'G'                                       CFT014
      *                                                                   CFT014
      ** Retrieve Customer details of Sender.                             CFT014
      *                                                                   CFT014
     C                     CALL 'AOCUSTR0'                                CFT014
     C                     PARM *BLANKS   @RTCD                           CFT014
     C                     PARM '*KEY   ' @OPTN                           CFT014
     C                     PARM WSCNUM    @KEY1                           CFT014
     C                     PARM *BLANK    @KYST                           CFT014
     C           SDCUST    PARM SDCUST    DSSDY                           CFT014
      *                                                                   CFT014
     C           @RTCD     IFNE *BLANKS                                   CFT014
     C           @KYST     ORNE '*CNUM'                                   CFT014
     C                     Z-ADD029       W0ERNB                          CFT014
     C                     MOVELWSCNUM    W0KEY                           CFT014
     C                     MOVEL'SDCUSTPD'W0FILE                          CFT014
     C                     EXSR SRERR                                     CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     MOVE BBCSID    WSCSID                          CFT014
     C                     MOVE BBCOLC    WSCOLC                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** If WSCSID field is not blank, use the 5-6 positions              CFT014
      ** of the field to chain to MEISOCL1.                               CFT014
      *                                                                   CFT014
     C           WSCSID    IFNE *BLANKS                                   CFT014
     C                     MOVE WSCSID    W0112W                          CFT014
     C           W0506W    CHAINMEISOCL1             88                   CFT014
      *                                                                   CFT014
     C           *IN88     IFEQ *ON                                       CFT014
     C           M3SCHT    ORNE 'Y'                                       CFT014
     C                     GOTO EXIDFT                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
     C           WSCOLC    IFNE *BLANKS                                   CFT014
      *                                                                   CFT014
      ** Retrieve Country Code details of Sender.                         CFT014
      *                                                                   CFT014
     C                     CALL 'AOCTRYR0'                                CFT014
     C                     PARM *BLANKS   @RTCD                           CFT014
     C                     PARM '*KEY   ' @OPTN                           CFT014
     C                     PARM WSCOLC    @CNCD   2                       CFT014
     C           SDCTRY    PARM SDCTRY    DSSDY                           CFT014
      *                                                                   CFT014
     C           @RTCD     IFNE *BLANKS                                   CFT014
     C                     Z-ADD030       W0ERNB                          CFT014
     C                     MOVELWSCOLC    W0KEY                           CFT014
     C                     MOVEL'SDCTRYPD'W0FILE                          CFT014
     C                     EXSR SRERR                                     CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Use A4ISOC from Country Code details to chain                    CFT014
      ** to MEISOCL1.                                                     CFT014
      *                                                                   CFT014
     C           A4ISOC    CHAINMEISOCL1             88                   CFT014
      *                                                                   CFT014
     C           *IN88     IFEQ *ON                                       CFT014
     C           M3SCHT    ORNE 'Y'                                       CFT014
     C                     GOTO EXIDFT                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
     C                     GOTO EXIDFT                                    CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Check for Support Charge Transparency flag for                   CFT014
      ** Receiver Country Code.                                           CFT014
      *                                                                   CFT014
     C           *IN10     IFEQ *ON                                       CFT014
     C                     MOVE SBRCA     WRBRCH  3                       CFT014
     C                     ELSE                                           CFT014
     C                     MOVE BJSBRC    WRBRCH                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Retrieve Branch details of Booking Branch or                     CFT014
      ** Single-Branch code.                                              CFT014
      *                                                                   CFT014
     C**********           CALL 'AOBRCHR0'                                             CFT014 CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM *BLANKS   @RTCD                           CFT014
     C                     PARM '*KEY   ' @OPTN                           CFT014
     C                     PARM WRBRCH    @BRCD                           CFT014
     C********** SDBRCH    PARM SDBRCH    DSFDY                                        CFT014 CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
      *                                                                   CFT014
     C           @RTCD     IFNE *BLANKS                                   CFT014
     C                     Z-ADD031       W0ERNB                          CFT014
     C                     MOVELWRBRCH    W0KEY                           CFT014
     C                     MOVEL'SDBRCHPD'W0FILE                          CFT014
     C                     EXSR SRERR                                     CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** If A8BTID field is not blank, use the 5-6 positions              CFT014
      ** of the field from Branch details to chain to MEISOCL1.           CFT014
      *                                                                   CFT014
     C           A8BTID    IFNE *BLANKS                                   CFT014
     C                     MOVE A8BTID    W0112A                          CFT014
     C           W0506A    CHAINMEISOCL1             88                   CFT014
      *                                                                   CFT014
     C           *IN88     IFEQ *ON                                       CFT014
     C           M3SCHT    ORNE 'Y'                                       CFT014
     C                     GOTO EXIDFT                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
     C           A8LCCD    IFNE *BLANKS                                   CFT014
      *                                                                   CFT014
      ** Retrieve Location Code details of Branch.                        CFT014
      *                                                                   CFT014
     C                     CALL 'AOLOCNR0'                                CFT014
     C                     PARM *BLANKS   @RTCD                           CFT014
     C                     PARM '*KEY   ' @OPTN                           CFT014
     C                     PARM A8LCCD    @LCCD   3                       CFT014
     C           SDLOCN    PARM SDLOCN    DSSDY                           CFT014
      *                                                                   CFT014
     C           @RTCD     IFNE *BLANKS                                   CFT014
     C                     Z-ADD032       W0ERNB                          CFT014
     C                     MOVELA8LCCD    W0KEY                           CFT014
     C                     MOVEL'SDLOCNPD'W0FILE                          CFT014
     C                     EXSR SRERR                                     CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Retrieve Country Code details.                                   CFT014
      *                                                                   CFT014
     C                     CALL 'AOCTRYR0'                                CFT014
     C                     PARM *BLANKS   @RTCD                           CFT014
     C                     PARM '*KEY   ' @OPTN                           CFT014
     C                     PARM DVCNCD    @CNCD                           CFT014
     C           SDCTRY    PARM SDCTRY    DSSDY                           CFT014
      *                                                                   CFT014
     C           @RTCD     IFNE *BLANKS                                   CFT014
     C                     Z-ADD035       W0ERNB                          CFT014
     C                     MOVELDVCNCD    W0KEY                           CFT014
     C                     MOVEL'SDCTRYPD'W0FILE                          CFT014
     C                     EXSR SRERR                                     CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Use A4ISOC from Country Code details to chain                    CFT014
      ** to MEISOCL1.                                                     CFT014
      *                                                                   CFT014
     C           A4ISOC    CHAINMEISOCL1             88                   CFT014
      *                                                                   CFT014
     C           *IN88     IFEQ *ON                                       CFT014
     C           M3SCHT    ORNE 'Y'                                       CFT014
     C                     GOTO EXIDFT                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
      ** Retrieve Customer details of Branch Internal Customer.           CFT014
      *                                                                   CFT014
     C                     CALL 'AOCUSTR0'                                CFT014
     C                     PARM *BLANKS   @RTCD                           CFT014
     C                     PARM '*KEY   ' @OPTN                           CFT014
     C                     PARM A8BICN    @KEY1                           CFT014
     C                     PARM *BLANK    @KYST                           CFT014
     C           SDCUST    PARM SDCUST    DSSDY                           CFT014
      *                                                                   CFT014
     C           @RTCD     IFNE *BLANKS                                   CFT014
     C           @KYST     ORNE '*CNUM'                                   CFT014
     C                     Z-ADD040       W0ERNB                          CFT014
     C                     MOVELA8BICN    W0KEY                           CFT014
     C                     MOVEL'SDCUSTPD'W0FILE                          CFT014
     C                     EXSR SRERR                                     CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** If SWIFT Id is not blank, chain to MEISOCL1 using                CFT014
      ** positions 5 to 6 of the field.                                   CFT014
      *                                                                   CFT014
     C           BBCSID    IFNE *BLANKS                                   CFT014
     C                     MOVE BBCSID    W0112B                          CFT014
     C           W0506B    CHAINMEISOCL1             88                   CFT014
      *                                                                   CFT014
     C           *IN88     IFEQ *ON                                       CFT014
     C           M3SCHT    ORNE 'Y'                                       CFT014
     C                     GOTO EXIDFT                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
      ** Retrieve Country Code details of Branch Internal                 CFT014
      ** Customer.                                                        CFT014
      *                                                                   CFT014
     C                     CALL 'AOCTRYR0'                                CFT014
     C                     PARM *BLANKS   @RTCD                           CFT014
     C                     PARM '*KEY   ' @OPTN                           CFT014
     C                     PARM BBCOLC    @CNCD                           CFT014
     C           SDCTRY    PARM SDCTRY    DSSDY                           CFT014
      *                                                                   CFT014
     C           @RTCD     IFNE *BLANKS                                   CFT014
     C                     Z-ADD041       W0ERNB                          CFT014
     C                     MOVELBBCOLC    W0KEY                           CFT014
     C                     MOVEL'SDCTRYPD'W0FILE                          CFT014
     C                     EXSR SRERR                                     CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Use A4ISOC from Country Code details to chain                    CFT014
      ** to MEISOCL1.                                                     CFT014
      *                                                                   CFT014
     C           A4ISOC    CHAINMEISOCL1             88                   CFT014
      *                                                                   CFT014
     C           *IN88     IFEQ *ON                                       CFT014
     C           M3SCHT    ORNE 'Y'                                       CFT014
     C                     GOTO EXIDFT                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** At this point, Support Charge Transparency flag is 'Y'           CFT014
      ** for both Sender and Receiver.  Default Instructed Currency       CFT014
      ** and Amount to Settlement Currency and Amount.                    CFT014
      *                                                                   CFT014
     C                     MOVE SSMCY     SNDCY                           CFT014
      *                                                                   CFT014
      ** Save Settle Currency details to Instructed Currency              CFT014
      ** details.                                                         CFT014
      *                                                                   CFT014
     C                     MOVE W1INCY    W3INCY                          CFT014
     C                     MOVE W1EUER    W3EUER                          CFT014
     C                     MOVE W1TPSD    W3TPSD                          CFT014
     C                     MOVE W1TPED    W3TPED                          CFT014
     C                     Z-ADDSVSCDP    W3NBDP                          CFT014
     C                     Z-ADDSVSSPT    W3SPRT                          CFT014
     C                     Z-ADDSVSMDN    W3MDIN                          CFT014
      *                                                                   CFT014
     C                     Z-ADDWSMAM     WNDAM                           CFT014
      *                                                                   CFT014
      ** Format Instructed Amount for display.                            CFT014
      *                                                                   CFT014
     C                     MOVE *BLANK    ZFIELD                          CFT014
     C                     MOVE WNDAM     ZFIELD                          CFT014
     C                     Z-ADDW3NBDP    ZADEC                           CFT014
     C                     EXSR ZEDIT                                     CFT014
     C                     MOVE ZFIELD    SNDAM                           CFT014
     C/COPY WNCPYSRC,FT0050C214
      *                                                                   CFT014
     C           EXIDFT    TAG                                            CFT014
     C                     MOVEA*BLANKS   @STK,O                          CFT014
     C                     SUB  1         O                               CFT014
      *                                                                   CFT014
     C                     ENDSR                                          CFT014
      *                                                                   CFT014
      *****************************************************************   CFT014
      /EJECT                                                              CFT014
      *****************************************************************   CFT014
      *                                                               *   CFT014
      *  SROEXR - Validate Original Exchange Rate                     *   CFT014
      *                                                               *   CFT014
      *****************************************************************   CFT014
      *                                                                   CFT014
     C           SROEXR    BEGSR                                          CFT014
      *                                                                   CFT014
      ** Set up subroutine stack name.                                    CFT014
      *                                                                   CFT014
     C                     ADD  1         O                               CFT014
     C                     MOVEL'SROEXR'  @STK,O                          CFT014
     C/COPY WNCPYSRC,FT0050C215
      *                                                                   CFT014
     C                     Z-ADD0         WOEXR  138                      CFT014
      *                                                                   CFT014
      ** Validate non-blank Original Exchange Rate.                       CFT014
      *                                                                   CFT014
     C           SOEXR     IFNE *BLANKS                                   CFT014
      *                                                                   CFT014
      ** Error if Instructed Amount is zero.                              CFT014
      *                                                                   CFT014
     C           WNDAM     IFEQ *ZERO                                     CFT014
     C                     MOVEL'FTM3139' FTMSID                          CFT014
     C                     MOVEL'FTUSRMSG'FTMSGF                          CFT014
     C                     MOVEL'Y'       FTNOUP                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     SETON                     86                   CFT014
     C                     GOTO EXOEXR                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Check if Original Exchange Rate is in valid format.              CFT014
      *                                                                   CFT014
     C                     MOVE *BLANKS   ZFIELD                          CFT014
     C                     MOVE SOEXR     ZFIELD                          CFT014
     C                     Z-ADD5         ZADIG                           CFT014
     C                     Z-ADD8         ZADEC                           CFT014
     C                     EXSR ZALIGN                                    CFT014
      *                                                                   CFT014
      ** If Original Exchange Rate is not in valid format,                CFT014
      ** display error message and bypass remaining validation.           CFT014
      *                                                                   CFT014
     C           *IN99     IFEQ *ON                                       CFT014
     C                     MOVEL'FTM3140' FTMSID                          CFT014
     C                     MOVEL'FTUSRMSG'FTMSGF                          CFT014
     C                     MOVEL'Y'       FTNOUP                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     SETON                     86                   CFT014
     C                     GOTO EXOEXR                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     MOVE ZFIELD    WOEXR                           CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** If Original Exchange Rate is blank or zero, get the default      CFT014
      ** Original Exchange Rate only if Pay Amount, Pay Currency,         CFT014
      ** Instructed Amount and Instructed Currency are valid.             CFT014
      *                                                                   CFT014
     C           SOEXR     IFEQ *BLANKS                                   CFT014
     C           WOEXR     OREQ *ZERO                                     CFT014
      *                                                                   CFT014
     C           *IN55     IFEQ *OFF                                      CFT014
     C           WPYAM     ANDNE*ZERO                                     CFT014
     C           *IN56     ANDEQ*OFF                                      CFT014
     C           SPCCY     ANDNE*BLANKS                                   CFT014
     C           *IN29     ANDEQ*OFF                                      CFT014
     C           WNDAM     ANDNE*ZERO                                     CFT014
     C           *IN28     ANDEQ*OFF                                      CFT014
     C           SNDCY     ANDNE*BLANKS                                   CFT014
      *                                                                   CFT014
      ** Set up paramaters for call to FT0010.                            CFT014
      *                                                                   CFT014
     C                     CLEARP#0010                                    CFT014
     C                     MOVE *BLANKS   P#NDCY                          CFT014
     C                     Z-ADD*ZEROS    P#NDAM                          CFT014
     C                     MOVE SPCCY     P#DBCY                          CFT014
     C                     Z-ADDWPYAM     P#DBAM                          CFT014
     C                     MOVE SNDCY     P#CRCY                          CFT014
     C                     Z-ADDWNDAM     P#CRAM                          CFT014
     C                     MOVE *BLANKS   P#PDCY                          CFT014
     C                     Z-ADD*ZEROS    P#PDAM                          CFT014
     C                     Z-ADD*ZEROS    P#DBDT                          CFT014
     C                     Z-ADD*ZEROS    P#CRDT                          CFT014
     C                     Z-ADD*ZEROS    P#RATE                          CFT014
     C                     MOVE *BLANKS   P#OVRT                          CFT014
     C                     MOVE *BLANKS   P#SDIN                          CFT014
     C                     MOVE BTPCRD    P#RTDS                          CFT014
     C                     MOVEL*BLANKS   P#PMSQ                          CFT014
     C                     MOVE *BLANKS   P#INDC                          CFT014
     C                     MOVE *BLANKS   P#RTCD                          CFT014
      *                                                                   CFT014
     C                     CALL 'FT0010'                                  CFT014
     C                     PARM           P#0010                          CFT014
      *                                                                   CFT014
     C           P#RTCD    IFEQ '*ERROR*'                                 CFT014
     C                     Z-ADD042       W0ERNB                          CFT014
     C                     MOVEL'*CALL   'W0KEY                           CFT014
     C                     MOVEL'FT0010'  W0FILE                          CFT014
     C                     EXSR SRERR                                     CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Get difference in no. of decimal places.                         CFT014
      *                                                                   CFT014
     C           W3NBDP    SUB  SVPCDP    N1      30                      CFT014
      *                                                                   CFT014
     C                     SELEC                                          CFT014
      *                                                                   CFT014
      ** Same number of decimal places, set workfields equal to           CFT014
      ** amounts.                                                         CFT014
      *                                                                   CFT014
     C           N1        WHEQ 0                                         CFT014
     C                     Z-ADDWNDAM     WNDAMT 130                      CFT014
     C                     Z-ADDWPYAM     WPYAMT 130                      CFT014
      *                                                                   CFT014
      ** Instructed amount dec. greater than the Payment amount dec.,     CFT014
      ** align Payment amount to Instructed amount.                       CFT014
      *                                                                   CFT014
     C           N1        WHGT 0                                         CFT014
     C           WPYAM     DIV  POWER,N1  WPYAMT                          CFT014
     C                     Z-ADDWNDAM     WNDAMT                          CFT014
      *                                                                   CFT014
      ** Instructed amount dec. less  than the Payment amount dec.,       CFT014
      ** align Instructed amount to Payment amount.                       CFT014
      *                                                                   CFT014
     C           N1        WHLT 0                                         CFT014
     C                     Z-SUBN1        N1                              CFT014
     C           WNDAM     DIV  POWER,N1  WNDAMT                          CFT014
     C                     Z-ADDWPYAM     WPYAMT                          CFT014
      *                                                                   CFT014
     C                     ENDSL                                          CFT014
      *                                                                   CFT014
      ** Calculate Original Exchange Rate.                                CFT014
      *                                                                   CFT014
     C           P#MDIN    IFEQ 1                                         CFT014
     C           WNDAMT    DIV  WPYAMT    WOEXR                           CFT014
     C                     ELSE                                           CFT014
     C           WPYAMT    DIV  WNDAMT    WOEXR                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Format Original Exchange Rate for display.                       CFT014
      *                                                                   CFT014
     C                     MOVE *BLANKS   ZFIELD                          CFT014
     C                     MOVE WOEXR     ZFIELD                          CFT014
     C                     Z-ADD8         ZADEC                           CFT014
     C                     EXSR ZEDIT                                     CFT014
     C                     MOVE ZFIELD    SOEXR                           CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           EXOEXR    TAG                                            CFT014
     C                     MOVEA*BLANKS   @STK,O                          CFT014
     C                     SUB  1         O                               CFT014
      *                                                                   CFT014
     C                     ENDSR                                          CFT014
      *                                                                   CFT014
      *================================================================   CFT012
      *  Default the Payment Currency                                     CFT012
      *================================================================   CFT012
      *                                                                   CFT012
     C           SRDPCY    BEGSR                                          CFT012
      *                                                                   CFT012
     C           SPCCY     IFEQ *BLANK                                    CFT012
     C           CFT004    IFEQ 'Y'                                       CFT012
     C                     MOVEL*BLANKS   P@IBAN                          CFT012
     C                     ENDIF                                          CFT012
     C                     MOVELSBNC1     WIB1    1                       CFT012
     C           WIB1      IFEQ '/'                                       CFT012
     C                     MOVELSBNC2     WAC                             CFT012
     C           CFT004    IFEQ 'Y'                                       CFT012
     C           34        SUBSTSBNC1:2   P@IBAN                          CFT012
     C                     ENDIF                                          CFT012
     C                     ELSE                                           CFT012
     C                     MOVELSBNC1     WAC                             CFT012
     C                     ENDIF                                          CFT012
     C                     MOVEL'N'       WACDMP                          CFT012
     C                     EXSR RTACNT                                    CFT012
     C           WACRTN    IFEQ *BLANK                                    CFT012
     C                     MOVELIFCCY     SPCCY                           CFT012
     C                     ENDIF                                          CFT012
     C                     ENDIF                                          CFT012
      *                                                                   CFT012
     C           SPCCY     IFEQ *BLANK                                    CFT012
     C           CFT004    IFEQ 'Y'                                       CFT012
     C           P@IBAN    IFNE *BLANK                                    CFT012
     C                     CALL 'AOIBANR2'                                CFT012
     C                     PARM           @RTCD                           CFT012
     C                     PARM           P@IBAN                          CFT012
     C           ACCINF    PARM           DSSDY                           CFT012
      *                                                                   CFT012
     C           @RTCD     IFEQ *BLANK                                    CFT012
     C                     MOVELIFCCY     SPCCY                           CFT012
     C                     ENDIF                                          CFT012
     C                     ENDIF                                          CFT012
     C                     ENDIF                                          CFT012
     C                     ENDIF                                          CFT012
      *                                                                   CFT012
     C           SPCCY     IFEQ *BLANK                                    CFT012
     C                     MOVELINACB1    WAC                             CFT012
     C                     MOVEL'N'       WACDMP                          CFT012
     C                     EXSR RTACNT                                    CFT012
     C           WACRTN    IFEQ *BLANK                                    CFT012
     C                     MOVELIFCCY     SPCCY                           CFT012
     C                     ENDIF                                          CFT012
     C                     ENDIF                                          CFT012
      *                                                                   CFT012
     C           SPCCY     IFEQ *BLANK                                    CFT012
     C                     MOVELSSMCY     SPCCY                           CFT012
     C                     ENDIF                                          CFT012
      *                                                                   CFT012
     C                     ENDSR                                          CFT012
      *================================================================   CFT012
      *  Retrieve the data of an account                                  CFT012
      *================================================================   CFT012
     C           RTACNT    BEGSR                                          CFT012
      *                                                                   CFT012
      *  Set up subroutine stack name                                     CFT012
      *                                                                   CFT012
     C                     ADD  1         O                               CFT012
     C                     MOVEL'RTCYAC'  @STK,O                          CFT012
      *                                                                   CFT012
      ** Inputs                                                           CFT012
      ** ------                                                           CFT012
     C********** *LIKE     DEFN TRCODE    WAC                                          CFT012 CGL029
     C                     MOVE *BLANKS   WAC    24                                           CGL029
      ****                                WACDMP                          CFT012
      ** Outputs                                                          CFT012
      ** -------                                                          CFT012
     C           *LIKE     DEFN IFCCY     WACCY                           CFT012
     C           *LIKE     DEFN IFBRCA    WACBCH                          CFT012
      **                                  WACLN                           CFT012
     C           *LIKE     DEFN P@RTCD    WACRTN                          CFT012
      *                                                                   CFT012
     C                     MOVEL*BLANK    WACCY                           CFT012
     C                     MOVEL*BLANK    WACBCH                          CFT012
     C                     Z-ADD0         WACLN   20                      CFT012
     C                     MOVEL*BLANK    WACRTN                          CFT012
      ** Compute length                                                   CFT012
     C           ' '       CHEKRWAC       WACLN                           CFT012
      ** It is a retail number                                            CFT012
     C           WACLN     IFEQ 10                                        CFT012
     C                     MOVELWAC       P@RETL                          CFT012
     C                     MOVEL*BLANK    P@CNUM                          CFT012
     C                     MOVEL*BLANK    P@CUCD                          CFT012
     C                     MOVEL*BLANK    P@ACCD                          CFT012
     C                     MOVEL*BLANK    P@ACSQ                          CFT012
     C                     MOVEL*BLANK    P@BRCA                          CFT012
     C                     ELSE                                           CFT012
      ** It is a G/L account number                                       CFT012
     C                     MOVEL*BLANK    P@RETL                          CFT012
     C           3         SUBSTWAC:1     P@BRCA                          CFT012
     C           6         SUBSTWAC:4     P@CNUM                          CFT012
     C           3         SUBSTWAC:10    P@CUCD                          CFT012
     C********** 4         SUBSTWAC:13    P@ACCD                                       CFT012 CGL029
     C********** 2         SUBSTWAC:17    P@ACSQ                                       CFT012 CGL029
     C           10        SUBSTWAC:13    P@ACCD                                              CGL029
     C           2         SUBSTWAC:23    P@ACSQ                                              CGL029
     C                     ENDIF                                          CFT012
     C                     CALL 'AOACCTR0'             90                 CFT012
     C                     PARM           P@RTCD  7                       CFT012
     C                     PARM '*KEY   ' P@OPTN  7                       CFT012
     C                     PARM           P@RETL 10                       CFT012
     C                     PARM           P@CNUM  6                       CFT012
     C                     PARM           P@CUCD  3                       CFT012
     C**********           PARM           P@ACCD  4                                    CFT012 CGL029
     C                     PARM           P@ACCD                                              CGL029
     C                     PARM           P@ACSQ  2                       CFT012
     C                     PARM           P@BRCA  3                       CFT012
     C                     PARM           ACCINF                          CFT012
      *                                                                   CFT012
     C           P@RTCD    IFNE *BLANK                                    CFT012
     C           *IN90     OREQ '1'                                       CFT012
     C                     MOVEL'*ERROR'  WACRTN                          CFT012
     C           WACDMP    IFEQ 'Y'                                       CFT012
     C                     MOVEL'AOACCTR0'W0FILE                          CFT012
      ** It is a retail number                             ***************CFT012
     C           WACLN     IFEQ 10                         * DB ERROR 67 *CFT012
     C                     MOVELP@RETL    W0KEY     P      ***************CFT012
      ** It is a G/L account number                                       CFT012
     C                     ELSE                                           CFT012
     C                     MOVEL*BLANK    W0KEY                           CFT012
     C           W0KEY     CAT  P@BRCA:0  W0KEY                           CFT012
     C           W0KEY     CAT  P@CNUM:0  W0KEY                           CFT012
     C           W0KEY     CAT  P@CUCD:0  W0KEY                           CFT012
     C           W0KEY     CAT  P@ACCD:0  W0KEY                           CFT012
     C           W0KEY     CAT  P@ACSQ:0  W0KEY                           CFT012
     C                     ENDIF                                          CFT012
     C                     Z-ADD67        W0ERNB                          CFT012
     C                     EXSR SRERR                                     CFT012
     C                     ENDIF                                          CFT012
     C                     ELSE                                           CFT012
     C                     MOVELIFCCY     WACCY                           CFT012
     C                     MOVELIFBRCA    WACBCH                          CFT012
     C                     ENDIF                                          CFT012
      *                                                                   CFT012
      ** Reset input variables                                            CFT012
     C                     MOVEL*BLANK    WAC                             CFT012
     C                     MOVEL*BLANK    WACDMP  1                       CFT012
      *                                                                   CFT012
      *  Unwind subroutine stack name                                     CFT012
      *                                                                   CFT012
     C           EXRTAC    TAG                                            CFT012
     C                     MOVEA*BLANKS   @STK,O                          CFT012
     C                     SUB  1         O       50                      CFT012
      *                                                                   CFT012
     C                     ENDSR                                          CFT012
      *================================================================   CFT014
      *  Overwrite transaction amount                                     CFT014
      *================================================================   CFT014
      *                                                                   CFT014
     C           OV32AM    BEGSR                                          CFT014
      *                                                                   CFT014
      *  Set up subroutine stack name                                     CFT014
      *                                                                   CFT014
     C                     ADD  1         O                               CFT014
     C                     MOVEL'OV32AM'  @STK,O                          CFT014
      *                                                                   CFT014
      ** Inputs                                                           CFT014
      ** ------                                                           CFT014
      ** Input amount                                                     CFT014
     C           *LIKE     DEFN SSMAM     WOVIAM                          CFT014
      ** Input currency                                                   CFT014
     C           *LIKE     DEFN SSMCY     WOVICY                          CFT014
      ** Receiver's Charges amount                                        CFT014
     C           *LIKE     DEFN SSMAM     WOVRAM                          CFT014
      ** Receiver's Charges currency                                      CFT014
     C           *LIKE     DEFN SSMCY     WOVRCY                          CFT014
      ** Operation                                                        CFT014
     ***                                  WOVOPR                          CFT014
      ** Value date                                                       CFT014
     C           *LIKE     DEFN ZDAYNO    WOVVLD                          CFT014
      ** Outputs                                                          CFT014
      ** -------                                                          CFT014
      ** Amount overwritten                                               CFT014
     C           *LIKE     DEFN SSMAM     WOVAMT                          CFT014
      ** Temporary variables                                              CFT014
      ** -------------------                                              CFT014
      ** Transaction amount numeric format                                CFT014
     C           *LIKE     DEFN P#TOAM    WOVTAN                          CFT014
      ** Receiver's charges amount numeric format                         CFT014
     C           *LIKE     DEFN P#TOAM    WOVRCN                          CFT014
      *                                                                   CFT014
      ** Reset output parameters and temporary variables                  CFT014
     C                     MOVEL*BLANK    WOVAMT                          CFT014
     C                     Z-ADD0         WOVTAN                          CFT014
     C                     Z-ADD0         WOVRCN                          CFT014
      *                                                                   CFT014
      ** If both currencies are the same, we don't need to perform        CFT014
      ** currency conversion before doing operation on the amounts        CFT014
     C           WOVICY    IFEQ WOVRCY                                    CFT014
      ** Retrieve details of transaction currency                         CFT014
     C                     MOVELWOVICY    WCYCCY                          CFT014
     C                     MOVEL'N'       WCYDMP                          CFT014
     C                     EXSR SRCCYD                                    CFT014
     C           WCYRTN    IFEQ *BLANK                                    CFT014
     C                     Z-ADDWCYNDP    TRNBDP                          CFT014
     C                     Z-ADDWCYNDP    RCNBDP                          CFT014
     C                     ENDIF                                          CFT014
      ** Format charges amount                                            CFT014
     C                     MOVEL*BLANK    ZFIELD                          CFT014
     C                     MOVELWOVRAM    ZFIELD                          CFT014
     C           13        SUB  RCNBDP    ZADIG                           CFT014
     C                     Z-ADDRCNBDP    ZADEC                           CFT014
     C                     EXSR ZALIGN                                    CFT014
     C                     MOVE ZFIELD    WOVRCN                          CFT014
      ** Format input amount                                              CFT014
     C                     MOVEL*BLANK    ZFIELD                          CFT014
     C                     MOVELWOVIAM    ZFIELD                          CFT014
     C           13        SUB  TRNBDP    ZADIG                           CFT014
     C                     Z-ADDTRNBDP    ZADEC                           CFT014
     C                     EXSR ZALIGN                                    CFT014
     C                     MOVE ZFIELD    WOVTAN                          CFT014
      *                                                                   CFT014
     C                     SELEC                                          CFT014
     C           WOVOPR    WHEQ '*SUB'                                    CFT014
      ** Final amount = Input amount - Charges amount                     CFT014
     C           WOVTAN    SUB  WOVRCN    WOVTAN                          CFT014
     C           WOVOPR    WHEQ '*ADD'                                    CFT014
      ** Final amount = Input amount + Charges amount                     CFT014
     C           WOVTAN    ADD  WOVRCN    WOVTAN                          CFT014
     C                     ENDSL                                          CFT014
      *                                                                   CFT014
      ** Format Final amount                                              CFT014
     C                     MOVEL*BLANK    ZFIELD                          CFT014
     C                     MOVE WOVTAN    ZFIELD                          CFT014
     C                     Z-ADDTRNBDP    ZADEC                           CFT014
     C                     EXSR ZEDIT                                     CFT014
     C                     MOVE ZFIELD    WOVAMT                          CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
      ** Currencies are different                                         CFT014
      *                                                                   CFT014
      ** Begin to fill parameters for FT0010 (currency conversion)        CFT014
     C                     CLEARP#0010                                    CFT014
     C                     MOVELWOVRCY    P#FRCY                          CFT014
      ** Retrieve details of transaction currency                         CFT014
     C                     MOVELWOVICY    P#TOCY                          CFT014
     C                     MOVELWOVICY    WCYCCY                          CFT014
     C                     MOVEL'N'       WCYDMP                          CFT014
     C                     EXSR SRCCYD                                    CFT014
     C           WCYRTN    IFEQ *BLANK                                    CFT014
     C                     Z-ADDWCYNDP    TRNBDP                          CFT014
     C                     ENDIF                                          CFT014
     C                     Z-ADDWOVVLD    P#FRDT                          CFT014
     C                     Z-ADDWOVVLD    P#TODT                          CFT014
      ** Retrieve details of currency of Receiver's Charges               CFT014
     C                     MOVELWOVRCY    WCYCCY                          CFT014
     C                     MOVEL'N'       WCYDMP                          CFT014
     C                     EXSR SRCCYD                                    CFT014
     C           WCYRTN    IFEQ *BLANK                                    CFT014
     C                     Z-ADDWCYNDP    RCNBDP                          CFT014
      *                                                                   CFT014
      ** Format charges amount                                            CFT014
     C                     MOVEL*BLANK    ZFIELD                          CFT014
     C                     MOVELWOVRAM    ZFIELD                          CFT014
     C           13        SUB  RCNBDP    ZADIG                           CFT014
     C                     Z-ADDRCNBDP    ZADEC                           CFT014
     C                     EXSR ZALIGN                                    CFT014
     C                     MOVE ZFIELD    P#FRAM                          CFT014
      *                                                                   CFT014
      ** Convert the :71G: amount into the :32A: currency                 CFT014
     C                     CALL 'FT0010'                                  CFT014
     C                     PARM           P#0010                          CFT014
      *                                                                   CFT014
     C           P#RTCD    IFNE *BLANK                                    CFT014
     C                     MOVEL'FT0010  'W0FILE           ***************CFT014
     C                     MOVEL'*CALL  ' W0KEY            * DB ERROR 79 *CFT014
     C                     Z-ADD79        W0ERNB           ***************CFT014
     C                     EXSR SRERR                                     CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
     C                     Z-ADDP#TOAM    WOVRCN                          CFT014
      ** Format input amount                                              CFT014
     C                     MOVEL*BLANK    ZFIELD                          CFT014
     C                     MOVELWOVIAM    ZFIELD                          CFT014
     C           13        SUB  TRNBDP    ZADIG                           CFT014
     C                     Z-ADDTRNBDP    ZADEC                           CFT014
     C                     EXSR ZALIGN                                    CFT014
     C                     MOVE ZFIELD    WOVTAN                          CFT014
      *                                                                   CFT014
     C                     SELEC                                          CFT014
     C           WOVOPR    WHEQ '*SUB'                                    CFT014
      ** Final amount = Input amount - Charges amount                     CFT014
     C           WOVTAN    SUB  WOVRCN    WOVTAN                          CFT014
     C           WOVOPR    WHEQ '*ADD'                                    CFT014
      ** Final amount = Input amount + Charges amount                     CFT014
     C           WOVTAN    ADD  WOVRCN    WOVTAN                          CFT014
     C                     ENDSL                                          CFT014
      *                                                                   CFT014
      ** Format Final amount                                              CFT014
     C                     MOVEL*BLANK    ZFIELD                          CFT014
     C                     MOVE WOVTAN    ZFIELD                          CFT014
     C                     Z-ADDTRNBDP    ZADEC                           CFT014
     C                     EXSR ZEDIT                                     CFT014
     C                     MOVE ZFIELD    WOVAMT                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Reset input parameters                                           CFT014
     C                     MOVEL*BLANK    WOVIAM                          CFT014
     C                     MOVEL*BLANK    WOVICY                          CFT014
     C                     MOVEL*BLANK    WOVRAM                          CFT014
     C                     MOVEL*BLANK    WOVRCY                          CFT014
     C                     MOVEL*BLANK    WOVOPR  4                       CFT014
     C                     Z-ADD0         WOVVLD                          CFT014
      *                                                                   CFT014
      *  Unwind subroutine stack name                                     CFT014
      *                                                                   CFT014
     C           EXOV32    TAG                                            CFT014
     C                     MOVEA*BLANKS   @STK,O                          CFT014
     C                     SUB  1         O                               CFT014
      *                                                                   CFT014
     C                     ENDSR                                          CFT014
      *================================================================   CFT014
      *  Retrieve the amount , currency in P33B (tag :33B:)               CFT014
      *================================================================   CFT014
     C           RTPCA     BEGSR                                          CFT014
      *                                                                   CFT014
      *  Set up subroutine stack name                                     CFT014
      *                                                                   CFT014
     C                     ADD  1         O                               CFT014
     C                     MOVEL'RTPCA'   @STK,O                          CFT014
      *                                                                   CFT014
      ** Inputs                                                           CFT014
      ** ------                                                           CFT014
      ** DS for tags  (will NOT be blanked at the end of the S/R)         CFT014
      **                                  DSTRAN                          CFT014
      ** Outputs                                                          CFT014
      ** -------                                                          CFT014
      ** Currency                                                         CFT014
     C           *LIKE     DEFN TVCCY     WCACY                           CFT014
      ** Amount                                                           CFT014
     C           *LIKE     DEFN SSMAM     WCAAM                           CFT014
      *                                                                   CFT014
     C                     MOVEL*BLANK    WCACY                           CFT014
     C                     MOVEL*BLANK    WCAAM                           CFT014
      *                                                                   CFT014
      * Currency                                                          CFT014
      *                                                                   CFT014
     C                     MOVELTTCCY     WCACY                           CFT014
      * Amount                                                            CFT014
      *                                                                   CFT014
      * Format amount field (change ',' decimal point to '.').            CFT014
      *                                                                   CFT014
     C                     MOVEATTAMT     YA1                             CFT014
     C                     Z-ADD1         C       30                      CFT014
      *                                                                   CFT014
     C           C         DOUGT15                                        CFT014
      *                                                                   CFT014
     C           YA1,C     IFEQ ','                                       CFT014
     C                     MOVE '.'       YA1,C                           CFT014
     C                     Z-ADD16        C                               CFT014
     C                     ELSE                                           CFT014
     C                     ADD  1         C                               CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDDO                                          CFT014
      *                                                                   CFT014
     C                     MOVEAYA1       AMT    15                       CFT014
     C                     MOVELAMT       WCAAM                           CFT014
      *                                                                   CFT014
      *  Unwind subroutine stack name                                     CFT014
      *                                                                   CFT014
     C           EX33B     TAG                                            CFT014
     C                     MOVEA*BLANKS   @STK,O                          CFT014
     C                     SUB  1         O       50                      CFT014
      *                                                                   CFT014
     C                     ENDSR                                          CFT014
      *================================================================   CFT014
      *  Retrieve the rate of tag :36:                                    CFT014
      *================================================================   CFT014
     C           RT36      BEGSR                                          CFT014
      *                                                                   CFT014
      *  Set up subroutine stack name                                     CFT014
      *                                                                   CFT014
     C                     ADD  1         O                               CFT014
     C                     MOVEL'RT36'    @STK,O                          CFT014
      *                                                                   CFT014
      ** Inputs                                                           CFT014
      ** ------                                                           CFT014
      ** Code work lines                                                  CFT014
      **                                  DSTRAN                          CFT014
      ** Outputs                                                          CFT014
      ** -------                                                          CFT014
      ** Rate                                                             CFT014
     C           *LIKE     DEFN SOEXR     W36RT                           CFT014
      ** Decimal Position Truncated                                       CFT014
     C           *LIKE     DEFN A6NBDP    W36DPT                          CFT014
      ** Decimal Position                                                 CFT014
     C           *LIKE     DEFN A6NBDP    W36DP + 1                       CFT014
      *                                                                   CFT014
     C                     MOVEL*BLANK    W36RT                           CFT014
     C                     Z-ADD0         W36DPT                          CFT014
     C                     Z-ADD0         W36DP                           CFT014
      *                                                                   CFT014
      * Map Rate                                                          CFT014
      * Move possible 12 chars to work array and work string              CFT014
     C           12        SUBSTTMLIN1:1  @R     13                       CFT014
     C                     MOVEA@R        @R1                             CFT014
     C                     CLEAR@R                                        CFT014
      *                                                                   CFT014
      * If ',' in rate string @R change to '.'                            CFT014
      * Only need to check valid chars till one ',' found                 CFT014
     C                     Z-ADD1         @C      30                      CFT014
     C                     MOVE *BLANKS   @T      1                       CFT014
      *                                                                   CFT014
     C           1         DO   12        @C                              CFT014
     C           @R1,@C    IFEQ ','                                       CFT014
     C                     MOVE '.'       @R1,@C                          CFT014
      * Retrieve the number of decimal position                           CFT014
     C           @CHK      CHECKR1        @F      30                      CFT014
     C           @F        IFNE 0                                         CFT014
     C           @F        SUB  1         @F                              CFT014
     C           @F        SUB  @C        W36DP                           CFT014
     C                     ELSE                                           CFT014
     C           12        SUB  @C        W36DP                           CFT014
     C                     ENDIF                                          CFT014
      ** Decimal position can be handled only on one 1 digit              CFT014
      ** => range 0-9  (otherwise truncated to 9)                         CFT014
     C           W36DP     IFGT 9                                         CFT014
     C                     Z-ADD9         W36DPT                          CFT014
     C                     ELSE                                           CFT014
     C                     Z-ADDW36DP     W36DPT                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     LEAVE                                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDDO                                          CFT014
      *                                                                   CFT014
     C                     Z-ADD1         @C                              CFT014
     C                     MOVE *BLANKS   @T      1                       CFT014
     C                     MOVEA@R1       @R                              CFT014
      * Get amount - upto 12 chars possible                               CFT014
     C           @C        DOUGT12                                        CFT014
     C                     MOVE @R1,@C    @T                              CFT014
     C           @CHK      CHECK@T        @F             82               CFT014
      *                                                                   CFT014
      * Char not valid must be end of rate                                CFT014
     C           *IN82     IFEQ *ON                                       CFT014
     C           @C        IFNE 1                                         CFT014
     C           @C        SUB  1         @F                              CFT014
     C           @F        SUBST@R:1      W36RT                           CFT014
     C                     ENDIF                                          CFT014
     C                     LEAVE                                          CFT014
     C                     ENDIF                                          CFT014
      * All chars in string ok                                            CFT014
     C           @C        IFEQ 12                                        CFT014
     C                     MOVEL@R        W36RT                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ADD  1         @C                              CFT014
      *                                                                   CFT014
     C                     ENDDO                                          CFT014
      *                                                                   CFT014
      *  Unwind subroutine stack name                                     CFT014
      *                                                                   CFT014
     C           EXRT36    TAG                                            CFT014
     C                     MOVEA*BLANKS   @STK,O                          CFT014
     C                     SUB  1         O       50                      CFT014
      *                                                                   CFT014
     C                     ENDSR                                          CFT014
      *================================================================   CFT014
      *  FLHIZO - Fill  MT103 additional new fields coming from           CFT014
      *  routed message                                                   CFT014
      *================================================================   CFT014
      *                                                                   CFT014
     C           FLHIZO    BEGSR                                          CFT014
      *                                                                   CFT014
      *  Set up subroutine stack name                                     CFT014
      *                                                                   CFT014
     C                     ADD  1         O                               CFT014
     C                     MOVEL'FLHIZO'  @STK,O                          CFT014
      *                                                                   CFT014
      ** Hidden zones are supposed to be filled only in EISWFT            CFT014
     C           INMSGR    IFEQ 0                                         CFT014
     C                     GOTO EXFHZO                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Hidden zones filled by routing an incoming MT103 message         CFT014
      ** These zones belong to other parts of the transaction             CFT014
      ** They will be validated by the screen they belong to              CFT014
     C           *LIKE     DEFN INBOCD    MGBOCD                          CFT014
     C           *LIKE     DEFN INICD1    MGICD1                          CFT014
     C           *LIKE     DEFN INICD2    MGICD2                          CFT014
     C           *LIKE     DEFN INICD3    MGICD3                          CFT014
     C           *LIKE     DEFN INICD4    MGICD4                          CFT014
     C           *LIKE     DEFN INICD5    MGICD5                          CFT014
     C           *LIKE     DEFN INTTCD    MGTTCD                          CFT014
     C           *LIKE     DEFN INTRIT    MGTRIT                          CFT014
     C           *LIKE     DEFN INTRI1    MGTRI1                          CFT014
     C           *LIKE     DEFN INTRI2    MGTRI2                          CFT014
     C           *LIKE     DEFN INTRI3    MGTRI3                          CFT014
     C           *LIKE     DEFN INTRI4    MGTRI4                          CFT014
     C           *LIKE     DEFN INTRI5    MGTRI5                          CFT014
     C           *LIKE     DEFN INRRP1    MGRRP1                          CFT014
     C           *LIKE     DEFN INRRP2    MGRRP2                          CFT014
     C           *LIKE     DEFN INRRP3    MGRRP3                          CFT014
     C           *LIKE     DEFN INRCCN    MGRCCN                          CFT014
     C           *LIKE     DEFN INRCNW    MGRCNW                          CFT014
     C           *LIKE     DEFN INRCUS    MGRCUS                          CFT014
      *                                                                   CFT014
     C                     MOVELMGBOCD    INBOCD                          CFT014
     C                     MOVELMGICD1    INICD1                          CFT014
     C                     MOVELMGICD2    INICD2                          CFT014
     C                     MOVELMGICD3    INICD3                          CFT014
     C                     MOVELMGICD4    INICD4                          CFT014
     C                     MOVELMGICD5    INICD5                          CFT014
     C                     MOVELMGTTCD    INTTCD                          CFT014
     C                     MOVELMGTRIT    INTRIT                          CFT014
     C                     MOVELMGTRI1    INTRI1                          CFT014
     C                     MOVELMGTRI2    INTRI2                          CFT014
     C                     MOVELMGTRI3    INTRI3                          CFT014
     C                     MOVELMGTRI4    INTRI4                          CFT014
     C                     MOVELMGTRI5    INTRI5                          CFT014
     C                     MOVELMGRRP1    INRRP1                          CFT014
     C                     MOVELMGRRP2    INRRP2                          CFT014
     C                     MOVELMGRRP3    INRRP3                          CFT014
     C                     MOVELMGSCC1    INSCY1                          CFT014
     C                     MOVELMGSCC2    INSCY2                          CFT014
     C                     MOVELMGSCC3    INSCY3                          CFT014
     C                     MOVELMGSCC4    INSCY4                          CFT014
     C                     MOVELMGSCC5    INSCY5                          CFT014
     C                     MOVELMGRCCN    INRCCN                          CFT014
     C                     Z-ADDMGSCH1    INSCH1                          CFT014
     C                     Z-ADDMGSCH2    INSCH2                          CFT014
     C                     Z-ADDMGSCH3    INSCH3                          CFT014
     C                     Z-ADDMGSCH4    INSCH4                          CFT014
     C                     Z-ADDMGSCH5    INSCH5                          CFT014
     C                     Z-ADDMGRCNW    INRCNW                          CFT014
     C                     MOVELMGRCUS    INRCUS                          CFT014
      *                                                                   CFT014
     C                     MOVEL*BLANK    MGBOCD                          CFT014
     C                     MOVEL*BLANK    MGICD1                          CFT014
     C                     MOVEL*BLANK    MGICD2                          CFT014
     C                     MOVEL*BLANK    MGICD3                          CFT014
     C                     MOVEL*BLANK    MGICD4                          CFT014
     C                     MOVEL*BLANK    MGICD5                          CFT014
     C                     MOVEL*BLANK    MGTTCD                          CFT014
     C                     MOVEL*BLANK    MGTRIT                          CFT014
     C                     MOVEL*BLANK    MGTRI1                          CFT014
     C                     MOVEL*BLANK    MGTRI2                          CFT014
     C                     MOVEL*BLANK    MGTRI3                          CFT014
     C                     MOVEL*BLANK    MGTRI4                          CFT014
     C                     MOVEL*BLANK    MGTRI5                          CFT014
     C                     MOVEL*BLANK    MGRRP1                          CFT014
     C                     MOVEL*BLANK    MGRRP2                          CFT014
     C                     MOVEL*BLANK    MGRRP3                          CFT014
     C                     MOVEL*BLANK    MGSCC1                          CFT014
     C                     MOVEL*BLANK    MGSCC2                          CFT014
     C                     MOVEL*BLANK    MGSCC3                          CFT014
     C                     MOVEL*BLANK    MGSCC4                          CFT014
     C                     MOVEL*BLANK    MGSCC5                          CFT014
     C                     MOVEL*BLANK    MGRCCN                          CFT014
     C                     Z-ADD0         MGSCH1                          CFT014
     C                     Z-ADD0         MGSCH2                          CFT014
     C                     Z-ADD0         MGSCH3                          CFT014
     C                     Z-ADD0         MGSCH4                          CFT014
     C                     Z-ADD0         MGSCH5                          CFT014
     C                     Z-ADD0         MGRCNW                          CFT014
     C                     MOVEL*BLANK    MGRCUS                          CFT014
      *                                                                   CFT014
      *  Unwind subroutine stack name                                     CFT014
      *                                                                   CFT014
     C           EXFHZO    TAG                                            CFT014
     C                     MOVEA*BLANKS   @STK,O                          CFT014
     C                     SUB  1         O       50                      CFT014
      *                                                                   CFT014
     C                     ENDSR                                          CFT014
      *================================================================   CFT009
      *  CHGPST - Post charge amounts if defaulted via fees and           CFT009
      *  charges.                                                         CFT009
      *================================================================   CFT009
     C           CHGPST    BEGSR                                          CFT009
      *                                                                   CFT009
     C           TXCH      ADD  CQCH      ##CHGS                          CFT009
     C                     ADD  ADCH      ##CHGS                          CFT009
     C                     ADD  TLCH      ##CHGS                          CFT009
     C                     ADD  MSCH      ##CHGS                          CFT009
     C                     ADD  TRCM      ##CHGS                          CFT009
      *                                                                   CFT009
     C           S01494    IFEQ 'Y'                                       CFT009
     C                     ADD  INCHCM    ##CHGS                          CFT009
     C                     END                                            CFT009
      *                                                                   CFT009
     C           S01499    IFEQ 'Y'                                       CFT009
     C           CFT010    OREQ 'Y'                                       CFT009
     C                     ADD  INVATT    ##CHGS                          CFT009
     C                     END                                            CFT009
      *                                                                   CFT009
     C                     ADD  MSC01     ##CHGS                          CFT009
     C                     ADD  MSC02     ##CHGS                          CFT009
     C                     ADD  MSC03     ##CHGS                          CFT009
     C                     ADD  MSC04     ##CHGS                          CFT009
     C                     ADD  MSC05     ##CHGS                          CFT009
      *                                                                   CFT009
     C                     ENDSR                                          CFT009
      *****************************************************************                       CGL029
      /EJECT                                                                                  CGL029
      *****************************************************************                       CGL029
      *                                                               *                       CGL029
      *  SRACCT - Moves relevant account data.                        *                       CGL029
      *                                                               *                       CGL029
      *****************************************************************                       CGL029
     C           SRACCT    BEGSR                                                              CGL029
      *                                                                                       CGL029
     C                     MOVE W#CNU1    C#CNU1                                              CGL029
     C                     MOVE W#CCY1    C#CCY1                                              CGL029
     C                     MOVE W#ACO1    C#ACO1                                              CGL029
     C                     MOVE W#ACS1    C#ACS1                                              CGL029
     C                     MOVE W#BRC1    C#BRC1                                              CGL029
      *                                                                                       CGL029
     C                     ENDSR                                                              CGL029
      *================================================================   CGL009
     C/EJECT                                                                                  CRE008
      *****************************************************************                       CRE008
      *                                                               *                       CRE008
      *  OVDRLT - Check group account overdraft limit                 *                       CRE008
      *                                                               *                       CRE008
      *****************************************************************                       CRE008
      *                                                                                       CRE008
     C           OVDRLT    BEGSR                                                              CRE008
      *                                                                                       CRE008
     C                     MOVEL'RE10'    WPGM    8                                           CRE008
     C                     MOVE '1901'    WPGM                                                CRE008
     C                     CALL WPGM                                                          CRE008
      ** Input parameters                                                                     CRE008
     C                     PARM *BLANKS   PRCODE  7                                           CRE008
     C                     PARM           PIBRCH                                              CRE008
     C                     PARM           PICUST                                              CRE008
     C                     PARM           PICURR                                              CRE008
     C                     PARM           PIACOD                                              CRE008
     C                     PARM           PIACSQ                                              CRE008
     C                     PARM           PSETAM                                              CRE008
      ** Output parameters                                                                    CRE008
     C                     PARM           POBRCH  3                                           CRE008
     C**********           PARM           POCUST  60                                   CRE008 CSD027
     C                     PARM           POCUST  6                                           CSD027
     C                     PARM           POCURR  3                                           CRE008
     C**********           PARM           POACOD  40                                   CRE008 CGL029
     C                     PARM           POACOD 100                                          CGL029
     C                     PARM           POACSQ  20                                          CRE008
     C                     PARM           PORETN 100                                          CRE008
      *                                                                                       CRE008
     C           PRCODE    IFEQ '*ODLMTX'                                                     CRE008
     C                     MOVE *ON       *IN23                                               CRE008
     C                     MOVE *ON       *IN45                                               CRE008
     C                     MOVE *ON       *IN49                                               CRE008
     C                     ADD  1         WARN                                                CRE008
     C                     ADD  1         I                                                   CRE008
     C                     MOVE POBRCH    WBRCDE                                              CRE008
     C                     MOVE '-'       WDASH1                                              CRE008
     C                     MOVE POCUST    WCUSTN                                              CRE008
     C                     MOVE '-'       WDASH2                                              CRE008
     C                     MOVE POCURR    WCURR                                               CRE008
     C                     MOVE '-'       WDASH3                                              CRE008
     C                     MOVE POACOD    WACOD                                               CRE008
     C                     MOVE '-'       WDASH4                                              CRE008
     C                     MOVE POACSQ    WACSQ                                               CRE008
     C                     MOVE '/'       WSLSH                                               CRE008
     C                     MOVE PORETN    WRETN                                               CRE008
      *                                                                                       CRE008
     C           PORETN    IFEQ *ZERO                                                         CRE008
     C                     MOVELWMDTA1    PMSGDT                                              CRE008
     C                     ELSE                                                               CRE008
     C                     MOVELWMDTA2    PMSGDT                                              CRE008
     C                     ENDIF                                                              CRE008
      *                                                                                       CRE008
     C                     CALL 'ZA0350'                                                      CRE008
     C                     PARM 'FTUSRMSG'PMSGFL 10                                           CRE008
     C                     PARM 'FTA0131' PMSGID 10                                           CRE008
     C                     PARM           PMSGDT 45                                           CRE008
     C                     ENDIF                                                              CRE008
      *                                                                                       CRE008
     C                     ENDSR                                                              CRE008
      *****************************************************************                       CRE008
      *                                                                   CRT002
     C/COPY ZSRSRC,ZEDITZ2                                                CRT002
      **  SR.ZEDIT subroutine                                             CRT002
      *                                                                   CRT002
     C/EJECT                                                              CRT002
     C/COPY WNCPYSRC,FT0050C203
     C/EJECT
     O*
     O** RELEASE INCOMING PAYMENTS RECORD
     O*
     OINPAYDDFE                EXINPY
      *                                                                   CFT014
      ** Release extension record of Incoming Payment.                    CFT014
      *                                                                   CFT014
     OINPAYXDFE                EXIPEX                                     CFT014
      *                                                                   CFT014
      ***********                                                         056031
      ***********   Remove PRONO OLPOS and MEMOS processing               056031
      ***********                                                         056031
     O***********                                                         056031
     O***RELEASE*PRONO RECORD                                             056031
     O***********                                                         056031
     O*PRONOPNFE**              EXPRNO                                    056031
     O***********                                                         056031
     O***RELEASE*OLPOS RECORD                                             056031
     O***********                                                         056031
     O*OLPOSOAFE**              EXOLPS                                    056031
     O/COPY WNCPYSRC,FT0050DOPG                                           S01435
      *                                                                   S01435
      *  /Copy point for Outputs                                          S01435
      *                                                                   S01435
     O/EJECT
     O*****EMSG*-*ARRAY*OF*ERROR*MESSAGES*                          S01428S01435
     O*Swift*Reference*not*found*or*invalid*                              S01435
     O*Valid*Swift*Reference*found*-*not*yet*reserved*                    S01435
     O*Swift*Reference*already*reserved*for*this*job*                     S01435
     O*Swift*reference*reserved*for*another*job*                          S01435
     O*Reserved*message*found*                                            S01435
     O*No*reserved*messages*to*process*                                   S01435
     O*Message*previously*reserved*for*this*job*                          S01435
     O*Message*already*reserved*for*another*job*                          S01435
     O*Message*is*now*reserved*for*this*job*                              S01435
     O*Reservation*for*message*removed*                                   S01435
     O*Reservation*processing*cancelled*for*job*                          S01435
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
**   POWER - ARRAY OF POWERS OF 10 FOR CURRENCY CONVERSIONS
0000001
0000010
0000100
0001000
0010000
0100000
1000000
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
**   SWCH  - ARRAY OF VALID SWIFT CHARACTER
ABCDEFGHIJKLMNOPQRSTUVWXYZ 1234567890/-?:().,'+
**   POWERS(FOR CHARGES CONVERSION ROUTINES)
0000010
0000100
0001000
0010000
0100000
1000000
**   FCTR - ARRAY OF POWERS OF 10 FOR DAF CONVERSIONS
0001
0010
0100
1000
**  Error text                                                            056031
Error occurred on call to program - see dumps for further details
**  PSNAR table                                                           CRT002
Payment Advice From Cashier System                                        CRT002
**   ALPH  - Array of alphabetic                                          CFT004
ABCDEFGHIJKLMNOPQRSTUVWXYZ
**   NUMC  - Array of numeric                                             CFT004
1234567890
** STAMP - Dummy timestamp                                                                    CPK014
0001-01-01-00.00.00.000000                                                                    CPK014
