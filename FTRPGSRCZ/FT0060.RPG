     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas FT Payment authorisation')                       *
      *****************************************************************
      *                                                               *
      *  Midas - Funds Transfer Module                                *
      *                                                               *
      *  FT0060 - Payment Authorisation                               *
      *                                                               *
      *  (c) Finastra International Limited 2001                      *
      *                                                               *
      *  Last Amend No. HUT101             Date 27Mar20               *
      *  Prev Amend No. MD054059           Date 28Nov19               *
      *                 MD046248           Date 27Oct17               *
      *                 MD043792           Date 07Feb17               *
      *                 CFT049             Date 20Feb15               *
      *                 MD032021           Date 23Jan15               *
      *                 CFT158             Date 10Nov14               *
      *                 CFT151             Date 20Mar14               *
      *                 AR1056423          Date 06Jun13               *
      *                 AR974383           Date 14Feb13               *
      *                 260694             Date 28Sep12               *
      *                 CFT120             Date 28Sep12               *
      *                 CFT145             Date 28Sep12               *
      *                 CFT123             Date 28Sep12               *
      *                 CER049             Date 06Dec10               *
      *                 AR787620           Date 10Jun11               *
      *                 AR694651           Date 11Jan11               *
      *                 CER059             Date 19Jul10               *
      *                 BUG23832           Date 19May09               *
      *                 BUG23535           Date 23Mar09               *
      *                 BUG23383           Date 13Mar09               *
      *                 BUG23380           Date 13Mar09               *
      *                 BUG22904           Date 16Feb09               *
      *                 BUG22826           Date 10Feb09               *
      *                 CER030             Date 09Jul08               *
      *                 CSD083             Date 27May10               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      *                 BUG26108           Date 22Sep09               *
      *                 BUG25971           Date 10Sep09               *
      *                 CSW209             Date 01Apr09               *
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 BUG21265           Date 02Oct08               *
      *                 BUG21206           Date 25Sep08               *
      *                 257603             Date 12Nov08               *
      *                 256821             Date 13Oct08               *
      *                 256589             Date 18Sep08               *
      *                 BUG18708           Date 15May08               *
      *                 BUG17709           Date 06May08               *
      *                 BUG16175           Date 06Mar08               *
      *                 BUG16160           Date 26Feb08               *
      *                 BUG15903           Date 08Feb08               *
      *                 251933             Date 11Dec07               *
      *                 BUG15225           Date 02Nov07               *
      *                 BUG15201           Date 30Oct07               *
      *                 BUG15042A          Date 23Oct07               *
      *                 BUG15042           Date 17Oct07               *
      *                 249567             Date 06Aug07               *
      *                 247142A            Date 13Jul07               *
      *                 247142             Date 01Jun07               *
      *                 245881             Date 17Apr07               *
      *                 245478             Date 06Feb07               *
      *                 250350             Date 24Sep07               *
      *                 243989             Date 21Sep07               *
      *                 242863             Date 21Sep07               *
      *                 207477             Date 16Aug07               *
      *                 BUG12704           Date 16Nov06               *
      *                 BUG12713           Date 17Nov06               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CRE026             Date 24May06               *
      *                 BUG12944A          Date 20Dec06               *
      *                 BUG12865           Date 12Dec06               *
      *                 241810             Date 04Sep06               *
      *                 BUG12713           Date 17Nov06               *
      *                 BUG12704           Date 16Nov06               *
      *                 CFT032             Date 11Sep06               *
      *                 CSD031             Date 10Apr06               *
      *                 BUG433             Date 05Dec05               *
      *                 CDL049             Date 06Jul06               *
      *                 237593             Date 11Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CER001             Date 25Apr05               *
      *                 CSW037A            Date 02May05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 BUG4152            Date 03Sep04               *
      *                 BUG3727            Date 20Jul04               *
      *                 CLE025             Date 20Oct03               *
      *                 TDA035             Date 02Apr04               *
      *                 CRE020             Date 20Jan04               *
      *                 CSC022             Date 24Feb04               *
      *                 CGL029             Date 01Sep03               *
      *                 CSW203             Date 26May03               *
      *                 CRE008             Date 19Feb02               *
      *                 CSD015             Date 14Oct02               *
      *                 207525             Date 14Feb03               *
      * Midas Release 4.01.03 ----------------------------------------*
      * Midas Release 4.01.02 ----------------------------------------*
      *                 205523             Date 07May02               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.05 -----------------------------------------------*
      *                 CSD006             Date 11Oct00               *
      *                 CFT009             Date 01JUN00               *
      * Midas DBA 3.04 -----------------------------------------------*
      *                 CFT014             Date 25May00               *
      * Midas DBA 3.03 -----------------------------------------------*
      *                 177672             DATE 13Jun00               *
      * Midas DBA 3.02 -----------------------------------------------*
      *                 166281             DATE 24Aug99               *
      *                 CFT004             DATE 27Jul99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 CFT003       DATE  25Nov98                    *
      *                 CEU006       DATE  28APR97                    *
      *                 106483       DATE  22MAY97                    *
      *                 122060       Date   5Nov97                    *
      *                 106410       DATE  13MAY97                    *
      *                 093130       DATE  26JUL96                    *
      *                 CAC001       DATE  01FEB96                    *
      *                 S01408       DATE  10JUL96                    *
      *                 S01408       DATE  10JUN96                    *
      *                 S01408       DATE  22FEB96                    *
      *                 S01408       DATE  18JAN96                    *
      *                 078509       DATE  03APR95                    *
      *                 S01408       DATE  10MAR95                    *
      *                 S01499       DATE  06JUN94                    *
      *                 S01494       DATE  25MAY94                    *
      *                 S01435       DATE  14NOV93                    *
      *                 061236       DATE  28SEP93                    *
      *                 059192       DATE  06AUG93                    *
      *                 058679       DATE  26JUL93                    *
      *                 S01435       DATE  22JUL93                    *
      *                 S01408       DATE  16JUN93                    *
      *                 055293       DATE  14MAY93                    *
      *                 040903       DATE  27APR93                    *
      *                 042167       DATE  15APR93                    *
      *                 S01414       DATE  29MAR93                    *
      *                 004120       DATE  11SEP91                    *
      *                 E32472       DATE  26NOV91                    *
      *                 E29970       DATE  20JUN91                    *
      *                 033601       DATE  13NOV90                    *
      *                 E32481       DATE  17JUN91                    *
      *                 E32885       DATE  03JUN91                    *
      *                 E25232       DATE  31MAY91                    *
      *                 E32886       DATE  30MAY91                    *
      *                 E32870       DATE  10MAY91                    *
      *                 E29867       DATE  04JAN91                    *
      *                 E29862       DATE  04JAN91                    *
      *                 E29860       DATE  02JAN91                    *
      *                 E23761       DATE  21SEP90                    *
      *                 S01194       DATE  07SEP90                    *
      *                 S01117       DATE  07SEP90                    *
      *                 E23343       DATE  15AUG90                    *
      *                 E23191       DATE  15AUG90                    *
      *                 E21468       DATE  24APR90                    *
      *                 S01252       DATE  03FEB90                    *
      *                 S01251       DATE  03FEB90                    *
      *                 S01241       DATE  08JAN90                    *
      *                 S01199       DATE  17/08/89                   *
      *                                                               *
      *---------------------------------------------------------------*
      *                                                               *
      *  HUT101 - Upgrade CFT129 to FBM 2.1 SP22                      *
      *           Payment Authorisation for Funds Transfer            *
      *           Used hooks: FT0060C001, FT0060C099                  *
      *           Added hooks: HUT101_001, HUT101_102, HUT101_103,    *
      *           HUT101_104, HUT101_005, HUT101_006, HUT101_007      *
      *    261163 - Amend program to not check for authorisation limit*
      *             when IPAY is N in T_ALSYSPD                       *
      *  MD054059 - Missing outgoing payment reference in the         *
      *             extension files                                   *
      *  MD046248 - Finastra Rebranding                               *
      *  MD043792 - Payment was authorised even if user has no        *
      *             permission to authorise.                          *
      *  CFT049 - Account with Bank validation if EU/EEA Payment      *
      *  MD032021 - Missing Front Office ID after authorisation.      *
      *             Rename FRNT from ACNUMA.                          *
      *  CFT158 - Return Status of Interfaced FT Payments.            *
      *  CFT151 - FT IN/OP Alphanumeric sequence                      *
      *  AR1056423 - In the Payment Authorisation screen, DBASE error *
      *              occurs when displaying the OPAY details prior to *
      *              authorisation. In SR/CVRTOP, temporarily set PCCY*
      *              to SMCY before SR/TBLKEY is processed.           *
      *              (Child: AR1056424)                               *
      *  AR974383 - Redefine F7 (Child: AR974386) (Recompile)         *
      *  260694 - FT authorisation error if '/' in Ordering Customer  *
      *  CFT120 - FT IN/OP - Charges to DR of Account Currency        *
      *  CFT145 - FT IN/OP - Charges to the Debit of Account          *
      *           Validation                                          *
      *  CFT123 - FT OPAY Authorization - Display BIC Details         *
      *  CER049 - Stamp Tax                                           *
      *  AR787620 - Hooks Incorporation                               *
      *             WNCPYSRC,FTH00071                                 *
      *             WNCPYSRC,FTH00110                                 *
      *             WNCPYSRC,FTH00072                                 *
      *             WNCPYSRC,FTH00073                                 *
      *             WNCPYSRC,FTH00074                                 *
      *             WNCPYSRC,FTH00075                                 *
      *             WNCPYSRC,FTH00076                                 *
      *  AR694651 - Cover details not displayed on Payment Authori-   *
      *             sation (Child: AR694652)                          *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  BUG23832 - Transaction Type code not reflected in PAUT       *
      *  BUG23535 - OPAY generated from Regular Payment cannot be     *
      *             authorized in PAUT                                *
      *  BUG23383 - Looping screens C and screen D                    *
      *  BUG23380 - Do not show other set of extended narrative if    *
      *             transaction is incoming payment                   *
      *  BUG22904 - OPAY generated from IPAY does not update Related  *
      *             Pay Ref                                           *
      *  BUG22826 - OPAY generated from IPAY defaults the extended    *
      *             narratives to blank                               *
      *  CER030 - Multicash German Feature                            *
      *  CSD083 - Watch List Compliance Upgrade                       *
      *  BUG26108 - Invalid generation of payment during STP process  *
      *             and authorisation problem                         *
      *  BUG25971 - CFT004 is deactivated when CFT009/CFT010 is not   *
      *             activated                                         *
      *  CSW209 - SWIFT 2009 Changes                                  *
      *  BUG21265 - Debits are blocked error if '/' + Retail Account  *
      *  BUG21206 - Debits are blocked against this account           *
      *  257603 - Defect with F12 and Enter buttons                   *
      *  256821 - FT - absence of field "Booking branch" on           *
      *           authorisation screen                                *
      *  256589 - FT - Incoming Payment Authorization failed.         *
      *  BUG18708 - Processed payment authorization on IPAY still     *
      *             outstanding in WIP.                               *
      *  BUG17709 - Recompiled over changes in FT0060DF               *
      *  BUG16175 - Vague error message on authorized IPAY.           *
      *  BUG16160 - Applied fix BUG15517                              *
      *  BUG15517 - MT103 Field becomes blank at payment authorization*
      *  BUG15903 - Applied fix 249567                                *
      *  249567 - Redefine F9 (Recompile)                            *
      *  251933 - Database error in calling FT0805 for Partial account*
      *  BUG15225 - Database error encountered when calling FT0805    *
      *             for partial account with '/' prefix.              *
      *  BUG15201 - Encounter Database Errors (Recompile)             *
      *  BUG15042A - Codes are partially incorrect.                   *
      *  BUG15042 - Ensure Ordering Customer IBAN entry is formatted  *
      *             as Midas account before passing to FT0805.        *
      *           - Also added DBASE error handling to ensure program *
      *             terminates abnormally if error in FT0805.         *
      *  249567 - Recompile.                                          *
      *  247142A - Check accounts even if CFT003 is off.              *
      *  247142 - Apply fix 216511.                                   *
      *  216511 - Check block accounts.                               *
      *  245881 - Apply fix BUG12865 and BUG12944A. Fixes are already *
      *           incorporated.                                       *
      *  245478 - DOUBLE USE OF *IN50 => DB ERROR IN FT0805 BECAUSE   *
      *           BRANCH CODE NOT FILLED                              *
      *  250350 - Recompile due to changes in FT0060DF.               *
      *  243989 - File OTPAYXL0 record 13 already locked to this job. *
      *           Fix is not to CHAIN lock the record because 242863  *
      *           changed the F-specs from I to U. This worked on 1st *
      *           screen but another record locking on press of F9.   *
      *           Fix now is to make OTPAYXL2 as input file only.     *
      *  242863 - Timestamp field is overridden with incorrect value  *
      *           from ACCNTAB when IP/OP deal is authorised.         *
      *           Rename TMST field from ACNUMA/ACCNTAB.  Also update *
      *           the TMST field with the current value.              *
      *           Applied fix 238060.                                 *
      *           Also included timestamp in checking if record has   *
      *           been updated by another user.                       *
      *  207477 - Error message 'Customer Accounts has insufficient   *
      *           funds for payment' displayed even if the account    *
      *           does have sufficient funds. Changed condition used  *
      *           in determining whether this message should be       *
      *           displayed. Applied part of fix 184298.              *
      *  BUG12704 - Applied partially as CFT032.                      *
      *  BUG12713 - Missing 5th line detail in the Ordering customer  *
      *             (Outgoing Payment)                                *
      *  CRE026   - Consumer Banking (Recompile)                      *
      *  BUG12865 - Fix invalid data error when writing to OTPAYXPD.  *
      *  BUG12944A - FTC0510 00001 Failed                             *
      *  241810 - Authorisation on the webfaced screen will not be    *
      *           allowed if record still exists on WIP.              *
      *  BUG12713 - Missing 5th line detail in the Ordering customer  *
      *             (Outgoing Payment)                                *
      *  BUG12704 - Missing 5th line detail in the Ordering customer  *
      *  CFT032 - Account line in field 50k in MT103                  *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  BUG433 - Recompiled due to change in FTPCHGPD                *
      *  CDL049 - Addition of a Reference Rate field                  *
      *  237593 - Recompiled due to change in display file FT0060DF   *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CER001 - LUX Upgrade to MidasPlus                            *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  BUG4152 - AOCUSTR0 parameter mismatch                        *
      *  BUG3727- Dataarea SCCMT is not setup if CFT003 is off        *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  TDA035 - RTS Signon changes for MidasPlus. (Recompile)       *
      *  CRE020 - Midas Plus Online Printing of Advices (GE7)         *
      *  CSC022 - Commitment Control Changes for MidasPlus            *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  CSW203 - SWIFT 2003 Standards Update                         *
      *  CRE008 - Cash Management                                     *
      *  CSD015 - Midas Compliance Watch - Watch List Checking        *
      *  207525 - Initialised screen fields for Notified Delivery     *
      *           Amount and Instructed Amount.                       *
      *  205523 - 'insufficient funds' warning message being displayed*
      *           incorrectly.                                        *
      *  CSD006 - Use long DS with SDCURRPD.                          *
      *  CFT009 - FT Fees and Charge Development                      *
      *  CFT014 - Straight-through Processing Phase 2 MT103           *
      *           Messages Generation for FT.                         *
      *  177672 - Expand audit threshold field                        *
      *  166281 - Wrong account checked during authorisation process  *
      *  CFT004 - International Bank Account Number                   *
      *           Allow Non-Valid IBAN                                *
      *  CFT003 - FT Batch Authorisation                              *
      *  CEU006 - EMU Funds Transfer Enhancements                     *
      *  106483 - The user could not enquire on payments if           *
      *           he/she was not authorised to action code 'X'.       *
      *  122060 - Drafts Issuance.                                    *
      *           customer, ensure field ORCT being updated when      *
      *           'MT202' defaulted to ORC1, else FT0035 has          *
      *           database error                                      *
      *  106410 - If producing outgoing message, & no ordering        *
      *  093130 - Show Ordering bank "OP" if MT202 Keyword entered    *
      *  CAC001 - Profit Centre Accounting Development:               *
      *           Allow F19 for Margin Information if Analytical      *
      *           Accounting is installed.                            *
      *  S01408 - Core hook FT0060CCP5 added                          *
      *  S01408 - Core hook FT0060CCP4 added                          *
      *           Core hook FT0060CCP3 added                          *
      *  S01408 - Core hook FT0060CCP1 added                          *
      *           Core hook FT0060CCP2 added                          *
      *  S01408 - Addition of core hook   FT0060CADV                  *
      *  078509 - Authorisation doesn't work (part of S01494 wrongly  *
      *           placed : PAUT overwritten)                          *
      *  S01408 - Addition of core hooks  FT0060CCPG                  *
      *                                   FT0060CADU                  *
      *  S01499 - BLI V.A.T. Processing                               *
      *  S01494 - BLI Funds Transfer Enhancements                     *
      *         - If user not found, display message "User not        *
      *           found" and stop authorisation (TEMP03 FIX)          *
      *  S01435 - Standardise output                                  *
      *  061236 - Missing functionality re: Generation of MT202.      *
      *  059192 - Add message subfile processing                      *
      *           Correct window processing                           *
      *           Send warning message if two authorisations needed   *
      *  058679 - Database error in file SDNOSTPD, key US, in, at 013.*
      *  S01435 - Incoming Message Management.                        *
      *  S01408 - Core hook FT0060CL1W added                          *
      *           Core hook FT0060CL1E added                          *
      *  055293 - Resolve mapping problems for Outgoing Payments that *
      *           are generated from an Incoming Payment.             *
      *           Map originating bank to new fields on OTPAY and set *
      *           originating bank (now funds from) to the FT Suspense*
      *           account.                                            *
      *  040903 - When generating an outgoing payment from an incoming*
      *           change the set up of Ordering Bank. Validate that   *
      *           if it is originating from the Sender that the       *
      *           currency is the same as the pay currency of the     *
      *           incoming payment. If not then suppress the          *
      *           filling of ORBT and ORBK.                           *
      *                                                               *
      *           Also do not use the ordering bank information       *
      *           if it is not an account.                            *
      *                                                               *
      *           Also clear account with bank field if this is       *
      *           used for the outgoing destination. This completes   *
      *           fix 033996/E32886 which relates to A/c With Bank    *
      *           and not ordering bank.                              *
      *                                                               *
      *           This fix removed lines of code relating to E29862   *
      *           as it affected the same area of code and E29862 was *
      *           not 100% accurate.                                  *
      *  042167 - Include CL program to check for record locking      *
      *  S01414 - Book Code and Profit Centre Incorporation.          *
      *  004120 - IF BENEFICIARY IS ENTERED AS A CUST.NO, PGM LOSES   *
      *           LAST CHANGE TYPE DURING VALIDATION AND AUDIT REPORTS*
      *           WILL SHOW INVALID INFORMATION.                      *
      *  E32472 - E23191 DOES NOT CONVERT A/C WITH BANK TO A SWIFT ID *
      *           OR FULL NAME AND ADDRESS WHEN RETAIL OR PARTIAL     *
      *           ACCOUNTS ENTERED ON INPAYDD                         *
      *  E29970 - ENABLE CMD7 WHEN CALLED FROM ENQUIRY SUBFILE        *
      *           TO ALLOW PROGRESSION TO NEXT PAYMENT                *
      *  033601 - ENSURE LAST CHANGE DATE UPDATED CORRECTLY.          *
      *  E32481  -  REMOVAL OF REDUNDANT FLAGS                        *
      *  E32885  -  Sadly, payments can be authorised whether or not  *
      *             they have any valid details from level 1 or 2     *
      *             input, since ' ' is used for VALID and never      *
      *             entered (default value).  Change to positive val. *
      *  E25232  -  Place the incoming payment ref onto OTPAYDD for   *
      *             audit purposes.                                   *
      *  E32886  -  Ordering bank type is not set to blank on         *
      *             OTPAYDD which gives rise to a myriad of database  *
      *             errors                                            *
      *  E32870  -  Map SWIFT priority code, do not default to 2      *
      *  E29867 - BLANK OUT ACCOUNT WITH BANK TYPE, TO AVOID          *
      *           CORRUPTION OF OTPAYDD WHEN ACBK MAPPED TO DESTIN    *
      *  E29862 - ALLOW FORMATTING OF ORDERING BANK FROM              *
      *           SENDER= FULL,RETAIL,NOSTRO ACCOUNTS                 *
      *           ELSE BLANK FIELD OUT ON MAPPING                     *
      *  E29860 - ALLOW AUTHORISATION OF INCOMING PAYMNT              *
      *           WHEN SETTLE AMOUNT > AUDIT THRESHOLD                *
      *           (THIS AMENDS INCORRECT FIX E23761 BELOW)            *
      ***E23761*-*ALLOWS AUTHORISATION WITH                           *
      ************TWO AUTH PERSONNEL.                                 *
      *  S01194 - NEW STANDING DATA                                   *
      *  S01117 - MULTIBRANCHING                                      *
      *  E23343 - IF SETTLE TYPE IS 08 AND PAY REF. ENDS 00, THEN     *
      *           WRONG SETTLE TYPE IS OUTPUT TO SCREEN.              *
      *  E23191 - IF OUTGOING PAYMENT TO BE GENERATED, AND INTERMEDIARY
      *           IS NOT BLANK, THEN A/C WITH BANK IS OUTPUT TO OTPAYDD
      *           THIS CAN BE A NOSTRO CODE ON INPAYDD, BUT NOT ON    *
      *           OTPAYDD, THEREFORE CONVERT TO A SWIFT ID OR FULL    *
      *           NAME AND ADDRESS.                                   *
      *  E21468 - CHAPS CODE NOW APPEARS ON OUTGOING PAYMENTS         *
      *           AUTHORIZATION SCREEN.                               *
      *  S01252 - ADDITIONAL SPARE WINDOW MANAGER PARAMETER.          *
      *           BLANK RETURN CODE.                                  *
      *  S01251 - SYNON FIELD/PROGRAM NAME CHANGES.                   *
      *  S01241 - WINDOW INCORPORATION                                *
      *  S01199 -  HELP SYSTEM.                                       *
      *                                                               *
      *****************************************************************
      *                                                               *
      *  FUNCTION OF INDICATORS                                       *
      *                                                               *
      *  01  F3 - exit program                                        *
      *            - go back to authorisation screen                  *
      *  02  F12 - go back one screen                                 *
      *  03  F12 has been pressed to go back from screen 3            *
      *  05  F5 - return to initial screen                            *
      *  07  F7 - Enables user to skip this payment and process       *
      *              next requested payment                           *
      *  08  F9 - authorise payment                                   *
      ***11  HELP                                                     *   S01199
      *  12  Values subroutine has been run                           *
      *  13  Core feature S01494 installed                            *   S01494
      *  15  Core feature S01499 installed                            *   S01499
      *  16  Analytical Accounting is installed                       *   CAC001
      *  19  Used in conditioning output for CDL049                   *   CDL049
      *  20  invalid payment reference                                *
      *  21  invalid pay amount                                       *
      *  22  invalid pay currency                                     *
      *  23  invalid receive amount                                   *
      *  24  invalid receive currency                                 *
      *  25  invalid first authorising user                           *
      *  26  invalid second authorising user                          *
      *  30-33  number of decimal places pay currency                 *
      *  35-38  number of decimal places base currency                *
      *  40     If SET ON process Initial Screen                      *
      *               OFF Bypass  Initial Screen                      *
      *  42  Payment reference no blank, i.e. called from FT0110.     *
      *      Enables F7                                               *
      *  45  When ON, the user is not allowed to Authorise payments.  *   106483
      *  49  is a nostro                                              *
      ***50  BGMBIN = Y , Multibranching indicator                    *   S01117              245478
      *  50  BGMBIN = Y , Multibranching indicator                    *                       256821
      *  51  BKOBRU = Y , Originating Branch used indicator           *   S01117
      *  52  On then redisplay screen      }ON FLDQRY                 *   S01194
      *  53  Used in LOKUP, on if ? found  }ON FLDQRY                 *   S01194
      *  55  Used by message subfile                                  *   059192
      *  56  Putovr and Overlay on message subfile                    *   059192
      *  57  Chain indicator for SDCWHTL1                             *                       CSD015
      *  58  Chain indicator for GPFTWIPL                             *                       241810
      *  60  if on outgoing payment else incoming payment             *
      *  69  not found on lokup                                       *
      *  70  all details have been displayed for this payment         *
      ***71**found*on*lokup*                                          *   S01414
      *  71  Profit Centres In Use Flag                               *   S01414
      *  72  Display Notified/Pay Ccy fields for EMU                  *   CEU006
      *  73  FEATURE CFT009 ACTIVE                                    *   CFT009
      *  74  FEATURE CFT010 ACTIVE                                    *   CFT009
      *  75  Feature CSW209 Active                                    *                       CSW209
      *  80  error flag                                               *
      *  86  not live record on CLSWT                                 *
      *  87  not live record                                          *
      *  88  payment not on file                                      *
      *  89  general invalid field flag                               *
      *  90-99  standard subroutine indicators                        *
      *                                                               *
      *****************************************************************
      *
     F/COPY WNCPYSRC,FT0060F002
     FFT0060DFCF  E                    WORKSTN
     F/COPY WNCPYSRC,FT0060F003
     FINPAY   UF  E           K        DISK
     F                                              KCOMIT
     FOTPAY   UF  E           K        DISK                      A
     F                                              KCOMIT
     FINPAYXL0IF  E           K        DISK                               CFT009
     FOTPAYZZ UF  E                    DISK
     F                                              KCOMIT
     FMUSER   IF  E           K        DISK
     F*PYCHGDD*IF**E                    DISK                              S01117
     F*CLINT**IF**E           K        DISK                               S01194
     F************CLINTCAF                          KIGNORE               S01194
     F************CLINTCCF                          KIGNORE               E23191
     F************CLINTC1F                          KIGNORE               S01194
     FACNUMA  IF  E           K        DISK
     F            ACCNTABF                          KRENAMEACNUMAF
     F*TABFP***IF**E           K        DISK                              S01194
     F************TABTB20F                          KIGNORE               S01194
     F************TABTG20F                          KIGNORE               S01194
     F************TABLETJF                          KIGNORE               S01194
     F************TABLETPF                          KIGNORE               S01194
     F*SDMMODPD*IF*E                   DISK                         S01241S01194
     FPYCHGDB IF  E           K        DISK                               S01194
      ** Payment Charge defintion file                                    CFT009
     FFTPCHGL0IF  E           K        DISK                               CFT009
      *                                                                   CFT014
      ** Incoming Payments Details Extension retrieval index              CFT014
      *                                                                   CFT014
     F*INPAYXL2IF**E           K        DISK                           UC              CFT014 242863
     FINPAYXL2UF  E           K        DISK                           UC                      242863
     F                                              KCOMIT                                    242863
      *                                                                   CFT014
      ** Outgoing Payments Details Extension retrieval index              CFT014
      *                                                                   CFT014
     FOTPAYXL2IF  E           K        DISK                           UC  CFT014
      *                                                                   CFT014
      ** Outgoing Payments Details Extension update index                 CFT014
      *                                                                   CFT014
     FOTPAYXL0UF  E           K        DISK                      A    UC  CFT014
     F                                              KCOMIT                CFT014
     F/COPY WNCPYSRC,HUT101_001                                                               HUT101
     F*                                                                   S01241
     F* /COPY used to define extension file that will be updated          S01241
     F*       after authorisation of the payment                          S01241
     F*                                                                   S01241
     F/COPY WNCPYSRC,FT0060FIL                                            S01241
     FSDCWHTL1IF  E           K        DISK                                                   CSD015
      ** Compliance Watch Hit List File                                                       CSD015
      *
      ** Retail Advice Index File                                                             CRE020
     FREADVCL1UF  E           K        DISK         KCOMIT       A    UC                      CRE020
      *                                                                                       CRE020
     F/COPY WNCPYSRC,FTH00218
     FGPFTWIPLIF  E           K        DISK                                                   241810
      ** WIP transaction file (selected on TO_APPROVE and TO_AUTHORISE only)                  241810
      *                                                                                       241810
     F/COPY WNCPYSRC,FT0060F001
     FOTPAYQL0UF  E           K        DISK                      A                          MD054059
     E                    CPY@    1   1 80
     E*
     E*   TABLES
     E*
     E                    ZA1        16  1               ZALIGN SR. ARRAY
     E                    ZA2        16  1               ZALIGN SR. ARRAY
     E                    DIG1       13  1               UNEDITED VALUE
     E                    DIG2       14  1               EDITED VALUE
     E                    ERCD       19  4               ERROR CODES
     E                    ZYDY    4   4  4 0             ZDATE1/2 SR.ARRAY
     E                    ZMDY   13  13  3 0             ZDATE1/2 SR.ARRAY
     E                    ZMNM   12  12  3               ZDATE2 SR. ARRAY
     E                    POWER   1   7  7 3             POWERS TABLE
     E                    @DFT    1   1 35               Default Text     055293
     E*                                                                   S01194
     E**FLDQ ARRAY FOR '?' HANDLING                                       S01194
     E                    FLDQ       10  1                                S01194
      *                                                                   059192
      *  Subroutine stack                                                 059192
      *                                                                   059192
     E                    @STK       20 10                                059192
      *                                                                   059192
      *  Warning check array                                              059192
      *                                                                   059192
     E                    WRN@       40  1                                059192
      *                                                                   S01435
      *  Error texts                                                      S01435
      *                                                                   S01435
     E                    ERR@    1   1 80                                S01435
     E                    DESC    1   5 30                                CFT009
     E                    STMP    1   5 30                                                    CER049
     E                    DCC     1   3  3                                                    CRE020
      **                                                                                      CSC022
      ** Array to hold commitment jobs name                                                   CSC022
      **                                                                                      CSC022
     E                    WCMT       10 10                                                    CSC022
      *                                                                                       CFT158
      ** OPAY subtypes to receive return status                                               CFT158
     E                    OPST       50  2                                                    CFT158
      ** IPAY subtypes to receive return status                                               CFT158
     E                    IPST       50  2                                                    CFT158
      *                                                                                       CFT158
     E/COPY WNCPYSRC,FT0060E001
      *                                                                   S01194
      /COPY WNCPYSRC,HUT101_002                                                               HUT101
      *                                                                                       CRE020
      ** Declare CRE020 System Value Constants                                                CRE020
      *                                                                                       CRE020
     I              'Out/RegularPayments' C         OTSVAL                                    CRE020
     I              'IncomingPayments'    C         INSVAL                                    CRE020
      *                                                                                       CFT158
      ** Declare CFT158 constants                                                             CFT158
     I              'FTRetStatusOP'       C         OPRETS                                    CFT158
     I              'FTRetStatusIP'       C         IPRETS                                    CFT158
     I              'PROCESSED'           C         WKPROC                                    CFT158
     I              'AOSVALR0'            C         PGMA                                      CFT158
      *                                                                                       CFT158
     I/COPY WNCPYSRC,FTH00425
      *                                                                                       CRE020
      *                                                                                       CFT120
      ** Rename Charges to the DR of currency for generic processing                          CFT120
      *                                                                                       CFT120
     IOTPAYDDF                                                                                CFT120
     I              OPCDRC                          CDRC                                      CFT120
      *                                                                                       CFT120
      ** Rename Charges to the DR of currency for generic processing                          CFT120
      *                                                                                       CFT120
     IINPAYDDF                                                                                CFT120
     I              INCDRC                          CDRC                                      CFT120
      *                                                                                       CFT120
     I              'GPACSBRCH'           C         GPBRCH                                  BUG18708
     I** RENAME PYCHGDB FIELDS CQCH,SPCH TO AVOID CORRUPTING STORED       S01117
     I** DATA FROM READ OF OTPAYDD                                        S01117
     IPYCHGDDF                                                            S01117
     I              CQCH                            STCQCH                S01117
     I              SPCH                            STSPCH                S01117
     I*                                                                   S01414
     I* Rename of ACNUMA Profit Centre to avoid overwriting               S01414
     I*                                                                   S01414
     IACNUMAF                                                             S01414
     I              PRFC                            ACPRFC                S01414
     I              TMST                            ACTMST                                  BUG12865
     I              FRNT                            ACFRNT                                  MD032021
      *                                                                                       241810
      ** Rename of GPFTWIPL fields                                                            241810
      *                                                                                       241810
     IT@MSWIP                                                                                 241810
     I              MSWTREF                         MSTREF                                    241810
     I              MSWZONE                         MSZONE                                    241810
      *                                                                                       241810
     I/COPY WNCPYSRC,FT0060I004
     I*                                                                   S01414
     IINFT      E DSMEINFTPD                                              S01435
      *                                                                   S01435
      *  Define parameters to be passed for FT IMM update                 S01435
      *                                                                   S01435
     I*                                                                   S01117
     I*  DATA STRUCTURE FOR COMPILATION  - COPYRIGHT INSERTION
     ICPYR@#      DS
     I                                        1  80 CPY@
     I                                        1  20 CPY@##
     I*
     I*     DATA AREA DATA STRUCTURE FOR HANDLING DB ERRORS
     I*
     IDLDA        DS                            256
     I************                          134 138 DBFILE                S01194
     I************                          139 167 DBKEY                 S01194
     I************                          168 175 DBPGM                 S01194
     I************                          176 1770DBASE                 S01194
     I************                          178 178 CMD                   S01194
     I                                      134 141 DBFILE                S01194
     I                                      142 170 DBKEY                 S01194
     I                                      171 180 DBPGM                 S01194
     I                                      181 1830DBASE                 S01194
     I                                      184 184 CMD                   S01194
      *                                                                   S01435
      *  Send message data structure                                      S01435
      *                                                                   S01435
     IDBDTA       DS                                                      S01435
     I                                        1  10 @BPGM                 S01435
     I                                       11  20 @BFILE                S01435
     I                                       21  50 @BKEY                 S01435
     I                                       51  550@BERNB                S01435
     I                                       56 135 @BNARR                S01435
     I                                      136 145 @BSTK                 S01435
     I                                      146 175 @BPREF                S01435
     I*
     I*     DATA AREA FOR ORDINARY PAYMENT REF NUMBERING
     I*
     I***OTPAYD    E DSOTPAYDA                                                                CFT151
     IOTPAYD      DS                                                                          CFT151
     I                                        1   40WOTSQ                                     CFT151
     I*
     I*
     I*     DATA AREA TO REDEFINE IPREF FOR INSERTS
     I*
     I            DS
     I                                        1  15 IPREF
     I                                        1   1 P
     I                                        2   70RUND3
     I                                        2   30YY
     I                                        4   50MM
     I                                        6   70DD
     I**********                              8  110PRNUM                                     CFT151
     I                                        8  11 PRNUM                                     CFT151
     I                                       12  13 PYTP
     I                                       14  150STTP
     I*     DATA AREA FOR REFORMATTING DATE TO YYMMDD
     I/COPY WNCPYSRC,FTH00071
     I*
     I*
     I*     DATA AREA FOR PROGRAM STATUS DISK AREA
     I*
     IPSDS       SDS
     I                                        1  10 ##PGM                 059192
     I                                      244 253 WID
     I                                      254 263 USRID
     I/COPY WNCPYSRC,FT0060I002
     I*
     I*
     I*
     I*     DATA AREA FOR RENAMING OF CURRENCIES FOR DISPLAY
     I*
     I            DS
     I                                        1   3 CCY1
     I                                        1   3 CCY2
     I                                        1   3 CCY3
     I                                        1   3 CCY4
     I                                        1   3 CCY5
     I                                        1   3 CCY6
     I                                        1   3 CCY7                  S01494
     I                                        1   3 CCY8                  S01499
     I            DS
     I                                        1   3 CCYA
     I                                        1   3 CCYB
     I                                        1   3 CCYC
     I                                        1   3 CCYD
     I                                        1   3 CCYE
     I                                        1   3 CCYF
     I                                        1   3 CCYG                  S01494
     I                                        1   3 CCYH                  S01499
     I*
     I*     DATA AREA TO REDEFINES FIELDS
     I*
     I            DS
     I                                        1  76 ERCD
     I                                        1  76 ERRS
     I                                       77  89 DIG1
     I                                       77  890DIG1N
     I                                       90 103 DIG2
     I                                       90 103 DIG2A
     I                                      104 108 CURR
     I                                      107 108 CURRN
     I*
     I*     DATA STRUCTURE FOR COMMITMENT BOUNDARY IDENTIFIERS
     I*
     I            DS
     I                                        1   50TRANS
     I                                        6   7 MODULE
     I                                        8  15 PROG
     I                                       16  18 WID1
     I                                       19  240TIM
     I                                       25  25 ACTION
     I                                       26  35 USRID1
     I                                       51  60 WID2
     I                                       61  75 PREF
     I                                       76  89 SVAL
     I                                       90  92 SYCY
     I                                       93 106 PVAL
     I                                      107 109 RCCY
     I                                      110 119 AUP1
     I                                      120 144 NAME
     I                                      145 154 AUP2
     I                                      155 179 NAME2
     I                                        1 179 COMBOU
     I*
     I* CONCATANATE BENEFICIARY CUSTOMER
     IBENCUS      DS
     I                                        1  35 BNC1
     I                                       36  70 BNC2
     I                                       71 105 BNC3
     I                                      106 140 BNC4
     I                                      141 175 BNC5
     I*
     I* CONCATANATE ORDERING CUSTOMER
     IORDCUS      DS
     I                                        1  35 ORC1
     I/COPY WNCPYSRC,FT0060I003
     I                                       36  70 ORC2
     I                                       71 105 ORC3
     I                                      106 140 ORC4
     I                                      141 175 ORC5                                      CFT032
     I*
     I*     DATA AREA TO REDEFINE RETAIL NOSTRO FIELD
     I*
     IRTNO        DS
     I**********                              1   60CNUMN                                     CSD027
     I                                        1   6 CNUMN                                     CSD027
     I                                        1  100ACNON
     I                                        7   9 CCYN
     I                                        7  160ACODNP                                    CGL029
     I                                       17  180ACSQNP                                    CGL029
     I                                       10  190ACODN                                     CGL029
     I                                       20  210ACSQN                                     CGL029
     I**********                              7  100ACODNP                                    CGL029
     I**********                             11  120ACSQNP                                    CGL029
     I**********                             10  130ACODN                                     CGL029
     I**********                             14  150ACSQN                                     CGL029
     I*
     I*     DATA STRUCTURE REDEFINING ACCNT KEY FIELDS
     I*
     I************DS                                                      040903
     IFGLNO       DS                                                      040903
     I**********                              1   60CNUM                                      CSD027
     I                                        1   6 CNUM                                      CSD027
     I                                        1   6 CNUMA                 S01194
     I                                        7   9 CCY
     I                                       10  190ACOD                                      CGL029
     I                                       20  210ACSQ                                      CGL029
     I                                       22  24 BRCAF                                     CGL029
     I                                        1  21 AKEYF                                     CGL029
     I**********                             10  130ACOD                                      CGL029
     I**********                             14  150ACSQ                                      CGL029
     I**********                             16  18 BRCAF                              040903 CGL029
     I**********                              1  15 AKEYF                                     CGL029
     I*
     I*     DATA STRUCTURE REDEFINING ORBK FOR KEYS
     I*
     I            DS
     I**********                              1   60ORNUM                                     CSD027
     I                                        1   6 ORNUM                                     CSD027
     I                                        7  160ORCOD                                     CGL029
     I                                       17  180ORSEQ                                     CGL029
     I                                        1  18 ORBKS                                     CGL029
     I**********                              7  100ORCOD                                     CGL029
     I**********                             11  120ORSEQ                                     CGL029
     I**********                              1  12 ORBKS                                     CGL029
     I*
     I*     DATA STRUCTURES FOR CONVERTING 'ACCOUNT WITH BANK' TO
     I*      FULL ACCOUNT IDENTIFIER IN DESTINATION
     I*
     I            DS
     I**********                              1  12 ACBK                                      CGL029
     I**********                              1   6 ACBK1                                     CGL029
     I**********                              7  10 ACBK3                                     CGL029
     I**********                             11  12 ACBK4                                     CGL029
     I                                        1  18 ACBK                                      CGL029
     I                                        1   6 ACBK1                                     CGL029
     I                                        7  16 ACBK3                                     CGL029
     I                                       17  18 ACBK4                                     CGL029
     I*
     IDST1        DS
     I**********                              1   60DEST1                                     CSD027
     I                                        1   6 DEST1                                     CSD027
     I                                        7   9 DEST2
     I                                       10  190DEST3                                     CGL029
     I                                       20  210DEST4                                     CGL029
     I                                       22  24 DEST5                                     CGL029
     I**********                             10  130DEST3                                     CGL029
     I**********                             14  150DEST4                                     CGL029
     I**********                             16  18 DEST5                              S01194 CGL029
     I/COPY WNCPYSRC,FT0060I005
     I*
     I*     DATA STRUCTURES FOR CONVERTING SENDER TO PARTIAL ACCOUNT
     I*      IDENTIFIER IN ORDERING BANK
     I*
     ISND1        DS
     I**********                              1   60SNP1                                      CSD027
     I                                        1   6 SNP1                                      CSD027
     I                                       10  190SNP2                                      CGL029
     I                                       20  210SNP3                                      CGL029
     I                                       22  24 SNP4                                      CGL029
     I                                       10  210SNPG                                      CGL029
     I**********                             10  130SNP2                                      CGL029
     I**********                             10  150SNPG                               E29862 CGL029
     I**********                             14  150SNP3                                      CGL029
     I**********                             16  18 SNP4                               S01194 CGL029
     I*
     I            DS
     I**********                              1  180ORBK                               CGL029 CSD027
     I**********                              1   60ORBP1                              CGL029 CSD027
     I                                        1  18 ORBK                                      CSD027
     I                                        1   6 ORBP1                                     CSD027
     I                                        7  160ORBP2                                     CGL029
     I                                       17  180ORBP3                                     CGL029
     I**********                              1  120ORBK                                      CGL029
     I**********                              1   60ORBP1                                     CGL029
     I**********                              7  100ORBP2                                     CGL029
     I**********                             11  120ORBP3                                     CGL029
      *                                                                   055293
      * Funds Transfer Default Account                                    055293
      *                                                                   055293
     I***FTDFAC*     DS                             12                                 055293 CGL029
     IFTDFAC      DS                             18                                           CGL029
     I**********                              1   60OBCNUM                             055293 CSD027
     I                                        1   6 OBCNUM                                    CSD027
     I                                        7  160OBACOD                                    CGL029
     I                                       17  180OBACSQ                                    CGL029
     I**********                              1  180OBFTAC                             CGL029 CSD027
     I                                        1  18 OBFTAC                                    CSD027
     I**********                              7  100OBACOD                             055293 CGL029
     I**********                             11  120OBACSQ                             055293 CGL029
     I**********                              1  120OBFTAC                             055293 CGL029
     IDSMTR       DS                                                      S01494
     I*                                                                   S01494
     I**  Define fields for message translation                           S01494
     I*                                                                   S01494
     I                                        1 132 #MSDTA                S01494
     I                                       15  30 #MPREF                S01494
     I                                    P   1   20#MPART                S01494
     I                                      133 264 #MSTX1                S01494
     I#MSTX2      DS                                                      S01494
     I                                        1 256 #MSTXA                S01494
     I                                      257 512 #MSTXB                S01494
      *                                                                                       242863
     IQUSEC       DS                                                                          242863
     I                                    B   1   40QUSBPR                                    242863
     I                                    B   5   80QUSBAV                                    242863
     I                                        9  15 QUSEI                                     242863
     I                                       16  16 QUSERE                                    242863
     I                                       17  32 QUSED0                                    242863
      *                                                                                       242863
     IOUTDAT      DS                                                                          242863
     I                                        1   4 APIYR                                     242863
     I                                        5   6 APIMH                                     242863
     I                                        7   8 APIDY                                     242863
     I                                        9  10 APIHR                                     242863
     I                                       11  12 APIMN                                     242863
     I                                       13  14 APISC                                     242863
     I                                       15  17 APIML                                     242863
     ISTAMP       DS                                                                          242863
     I                                        1   4 RETYR                                     242863
     I                                        5   5 TMST1                                     242863
     I                                        6   7 RETMH                                     242863
     I                                        8   8 TMST2                                     242863
     I                                        9  10 RETDY                                     242863
     I                                       11  11 TMST3                                     242863
     I                                       12  13 RETHR                                     242863
     I                                       14  14 TMST4                                     242863
     I                                       15  16 RETMN                                     242863
     I                                       17  17 TMST5                                     242863
     I                                       18  19 RETSC                                     242863
     I                                       20  20 TMST6                                     242863
     I                                       21  23 RETML                                     242863
     I                                       24  26 RETMC                                     242863
      *                                                                                       CRE008
      ** DS for message data for overdraft limit check                                        CRE008
      *                                                                                       CRE008
     IWOLTXT      DS                                                                          CRE008
     I**********                              1  18 WMDTA1                             CRE008 CGL029
     I**********                              1  33 WMDTA2                             CRE008 CGL029
     I                                        1  22 WMDTA1                                    CRE008
     I                                        1  39 WMDTA2                                    CRE008
     I                                        1   3 WBRCDE                                    CRE008
     I                                        4   4 WDASH1                                    CRE008
     I                                        5  10 WCUSTN                                    CRE008
     I                                       11  11 WDASH2                                    CRE008
     I                                       12  14 WCURR                                     CRE008
     I                                       15  15 WDASH3                                    CRE008
     I**********                             16  19 WACODE                             CRE008 CGL029
     I**********                             20  20 WDASH4                             CRE008 CGL029
     I**********                             21  22 WACSEQ                             CRE008 CGL029
     I**********                             23  23 WSLSH                              CRE008 CGL029
     I**********                             24  33 WRETN                              CRE008 CGL029
     I                                       16  25 WACODE                                    CGL029
     I                                       26  26 WDASH4                                    CGL029
     I                                       27  28 WACSEQ                                    CGL029
     I                                       29  29 WSLSH                                     CGL029
     I                                       30  39 WRETN                                     CGL029
      * Data structure for CSC011 front office ID ref ('MD'+PREF)                             CFT158
     I            DS                                                                          CFT158
     I                                        1  20 XFRNT                                     CFT158
     I                                        1   2 XPRFX                                     CFT158
     I                                        3  17 XTREF                                     CFT158
     I/COPY WNCPYSRC,FTH00426
     I*                                                                   S01194
     ISDMMOD    E DSSDMMODPD                                              S01194
     I*External data structure for Midas Modules Details                  S01194
     I*                                                                   S01194
     ISDGELR    E DSSDGELRPD                                              S01194
     I*External data structure for General Ledger Details                 S01194
     I*                                                                   S01194
     ISDBANK    E DSSDBANKPD                                              S01194
     I*External data structure for Bank Details                           S01194
     I*                                                                   S01194
     ISDNOST    E DSSDNOSTPD                                              S01194
     I*External data structure for Nostro Details                         S01194
     I              QQACCD                          QQACC1                                    CGL029
     I*                                                                   S01194
     ISDCUST    E DSSDCUSTPD                                              S01194
     I*External data structure for Client Details                         S01194
     I*                                                                   S01194
     ISDCURR    E DSSDCURRPD                                              S01194
     I*External data structure for Currency Details                       S01194
     I*                                                                   S01194
     ISDFTFR    E DSSDFTFRPD                                              S01194
     I*External data structure for Funds Transfer Details                 S01194
0393 I*                                                                   055293
0392 ISDBRCH    E DSSDBRCHPD                                              055293
0393 I* BRANCH DETAILS ACCESSED VIA ACCESS PROGRAM                        055293
     I              QQDFAC                          QQDFA1                                    CGL029
     I**                                                                  S01494
     ISCSARD    E DSSCSARDPD                                              S01494
     I* External data structure for SAR file details                      S01494
     I*                                                                   S01194
     I/COPY WNCPYSRC,FT0060I001
      /EJECT                                                              S01435
     C/COPY FTCPYSRC,SFTADDRI                                             S01435
      *                                                                   S01435
      * Address data structure                                            S01435
      *                                                                   S01435
     IW8FT        DS                            128                       S01435
      *                                                                   S01435
      * Address data structure                                            S01435
      *                                                                   S01435
      * Currency                                                          S01435
     I                                        1   3 W8CCY                 S01435
      * Settlement Type                                                   S01435
     I                                        4   5 W8STMT                S01435
      * Mandatory Text - convert BIC identifiers                          S01435
     I                                        6   6 W8MTXT                S01435
      * Message Tag                                                       S01435
     I                                        7  11 W8MTAG                S01435
      * Construct of data in field                                        S01435
     I                                       12  12 W8TYPE                S01435
      * Number of Lines available                                         S01435
     I                                       13  140W8NLIN                S01435
      * Network and Message Type                                          S01435
     I                                       15  20 W8NWRK                S01435
     I                                       21  23 W8MTPY                S01435
      * Calling Program                                                   S01435
     I                                       24  33 W8CPGM                S01435
      * Action *PRINT/*ENQ/*MSG GEN                                       S01435
     I                                       34  41 W8ACT                 S01435
      * Critical reporting - Database error if 'Y'                        S01435
      * If no BIC directory and BIC entered no error                      S01435
     I                                       42  42 W8CRIT                S01435
      * Force Midas Address - where possible                              S01435
     I                                       43  43 W8MADD                S01435
      * If Retail get first address from account                          S01435
     I                                       44  44 W8RTAD                S01435
      * Alternative Address                                               S01435
     I                                       45  45 W8ALTN                S01435
      * Address type selected in W0MSG                                    S01435
     I                                       46  46 W8ADTP                S01435
      *                                                                   CFT003
     IW0DATA      DS                            256                       CFT003
      *                                                                   CFT003
      *  Define data structure used to pass parameters                    CFT003
      *                                                                   CFT003
     I                                        1   3 B#BRCA                CFT003
     I                                        4   4 O#ACTD                CFT003
     I                                        5  14 O#CPGM                CFT003
      *                                                                   CFT003
      /EJECT                                                              S01435
     IDSFDY     E DSDSFDY                                                 S01194
     I*1st DS for access program , short data structure                   S01194
     I*                                                                   S01194
     IDSSDY     E DSDSSDY                                                 S01194
     I*2nd DS for access program , long data structure                    S01194
     I*                                                                   S01194
      *                                                                   CAC001
     ISPARE       DS                            256                       CAC001
      * Define the data structure to pass data to WN0010 and return pgm   CAC001
      *                                                                   CAC001
     I                                        1   1 WACTN                 CAC001
     I                                    P   2   88RATE                  CAC001
     I                                        9   9 WPSIN                 CAC001
     I                                       10  12 PCCY                  CAC001
     I                                       13  15 SMCY                  CAC001
     I                                    P  16  220PYAM                  CAC001
     I                                    P  23  290SMAM                  CAC001
     I                                       30  300MDIN                  CAC001
     I                                    P  31  342FXMP                  CAC001
     I                                       35  350FXMD                  CAC001
     I                                       36  36 MBSI                  CAC001
     I                                       37  37 MSIG                  CAC001
     I                                    P  38  440MAMT                  CAC001
     I                                       45  45 FRCI                  CAC001
      *                                                                   CFT014
     IWACCN     E DSACCNTAB                                               CFT014
     I              RECI                            WRECI                 CFT014
     I              CNUM                            WCNUM                 CFT014
     I              CCY                             WCCY                  CFT014
     I              ACOD                            WACOD                 CFT014
     I              ACSQ                            WACSQ                 CFT014
     I              BRCA                            WBRCA                 CFT014
     I              PRFC                            WPRFC                 CFT014
     I              LCD                             WLCD                  CFT014
     I              CHTP                            WCHTP                 CFT014
     I              FRNT                            WFRNT                 CFT014
     I              AFRT                            WAFRT                 CFT014
     I              REPA                            WREPA                 CFT014
     I              REPI                            WREPI                 CFT014
     I              TMST                            WTMST                                     242863
     I/COPY WNCPYSRC,FTH00491
      *                                                                   CFT014
     I            DS                                                      CFT014
     I**********                              1  15 WACNT                              CFT014 CGL029
     I                                        1  21 WACNT                                     CGL029
     I                                        1   6 FCNUM                 CFT014
     I                                        7   9 FCCY                  CFT014
     I**********                             10  13 FACOD                              CFT014 CGL029
     I**********                             14  15 FACSQ                              CFT014 CGL029
     I                                       10  19 FACOD                                     CGL029
     I                                       20  21 FACSQ                                     CGL029
      *                                                                   CFT014
     I            DS                                                      CFT014
     I                                        1  34 WINTRB                CFT014
     I                                        1  21 TPACNT                                    CGL029
     I                                       22  24 TPBRCA                                    CGL029
     I**********                              1  15 TPACNT                             CFT014 CGL029
     I**********                             16  18 TPBRCA                             CFT014 CGL029
      *                                                                   CFT014
     I/COPY FTCPYSRC,FT0010I001                                           CFT014
      *                                                                   CFT014
     I/COPY QWINDSRC,FT0060DTA                                            S01241
      *                                                                                       CSD015
     IPDATA       DS                           1024                                           CER001
      *                                                                                       CER001
     I                                        7  21 PREFX                                     CER001
      *                                                                                       CER001
     ISDWLCC    E DSSDWLCCPD                                                                  CSD015
      ** Midas Functions for Watch List Checking Details File                                 CSD015
      *                                                                                       CSD015
     ISC24X7    E DS                                                                          CSD015
      ** 24x7 Status Dataarea                                                                 CSD015
      *                                                                                       CSD015
     ISDSTAT    E DSSDSTAT                                                                    CSD015
      ** SD data area                                                                         CSD015
      *                                                                                       CSD015
      **                                                                                      CSC022
     ISCCMT       DS                            256                                           CSC022
     I                                        1   30WCMTNO                                    CSC022
     I                                        4 103 WCJOBS                                    CSC022
      ** Commitment Control dataarea                                                          CSC022
      **                                                                                      CSC022
     C                     MOVEACPY@      BIS@   80
     C/EJECT
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0060CCPG                                           S01408
     C*                                                                   S01408
     C********************************************************************
     C* MAIN SECTION
     C* DISPLAYS FIRST SCREEN UNTIL F3 IS PRESSED
     C********************************************************************
     C*
     C* PERFORM INTITIAL SUBROUTINE
     C           *ENTRY    PLIST
     C/COPY WNCPYSRC,FT0060C069
     C                     PARM           XPREF
     C                     PARM           @RETC   1
     C/COPY WNCPYSRC,FT0060C070
     C           *LIKE     DEFN PREF      XPREF
      *
     C                     Z-ADD0         ZRATE1 138                      CFT009
     C                     Z-ADD0         ZRATE2 138                      CFT009
     C                     MOVEL*BLANKS   ZMDI1   1                       CFT009
     C                     MOVEL*BLANKS   ZMDI2   1                       CFT009
      *
     C**DEFINE*KEY*LIST*                                            E23191S01194
     C***********CLKEY*****KLIST                                    E23191S01194
     C*********************KFLD           CNUM                      E23191S01194
     C*********************KFLD           RCDT                      E23191S01194
     C*********************                                         E23191S01194
     C*
     C           *LOCK     IN   DLDA
     C                     MOVE '0'       CMD
     C                     OUT  DLDA
     C*
     C           *BLANK    IFEQ XPREF                      SET BYPASS 1ST
     C                     SETON                     40
     C                     ELSE                            SCREEN INDICATE
     C                     MOVELXPREF     PREF
     C                     SETOF                     40
     C                     END
     C*
     C                     EXSR INITL
      *                                                                   059192
      * Initialise no update indicator, re-display, warning array         059192
      * and warning message sent                                          059192
      *                                                                   059192
     C                     MOVEL*BLANKS   FTNOUP  1                       059192
     C                     MOVEL*BLANKS   FTRSND  1                       059192
     C                     MOVEL*BLANKS   FTWARN                          059192
     C                     MOVEL*BLANKS   WRN@                            059192
      *                                                                   059192
     C*
     C* DO LOOP UNTIL F3 HAS BEEN PRESSED
     C*
     C           *IN01     DOUEQ'1'                        B001
     C*
     C* If NOT called from enquiry function or errors exist, display
     C* initial screen
     C*
     C   40
     COR 89                DO                              BYPASS LOOP
     C*
     C* IF NO ERRORS CLEAR FIELDS
     C*
     C  N89                DO                              B002
     C                     Z-ADD1         Z       30
     C                     MOVE *BLANK    ERCD
     C                     MOVEA'00000'   *IN,20
     C                     MOVE *BLANK    PREF             PAYMENT REF
     C                     MOVE *BLANK    SVAL             SETTLE AMOUNT
     C                     MOVE *BLANK    SYCY             SET CURRENCY
     C                     MOVE *BLANK    PVAL             PAY AMT
     C                     MOVE *BLANK    RCCY             PAY CCY
     C/COPY WNCPYSRC,FT0060C109
     C                     END                             E002
     C*                                                                   S01194
     C** Tag to redisplay 1st screen if field query is used               S01194
     C*                                                                   S01194
     C           FIRST     TAG                                            S01194
      *                                                                   059192
      * Initialise no update indicator to allow update                    059192
      *                                                                   059192
     C                     MOVEL*BLANKS   FTNOUP                          059192
      *                                                                   059192
      ** Initialise Notified Delivery and Instructed Amount fields                            207525
      *                                                                                       207525
     C                     MOVE *BLANKS   SPDAM                                               207525
     C                     MOVE *BLANKS   SNDAM                                               207525
      *                                                                   042167
      * Call CL program to de-allocate ONLY if not linked via an          042167
      * enquiry function.                                                 042167
      *                                                                   042167
     C           XPREF     IFEQ *BLANKS                                   042167
     C                     EXSR DALLOC                                    042167
     C                     END                                            042167
     C*                                                                   S01194
     C** To move the time to 'time' on display file                       S01194
     C*                                                                   S01194
     C                     TIME           TIME                            S01194
      *                                                                   059192
      * Display message subfile                                           059192
      *                                                                   059192
     C**********           MOVEL'1'       *IN56                                       059192 247142A
     C/COPY WNCPYSRC,FT0060C071
     C**********           WRITE#MSGCTL                                               059192 247142A
      *                                                                   059192
     C*
     C                     WRITEFT0060F1
     C                     MOVEL'1'       *IN56                                              247142A
     C                     WRITE#MSGCTL                                                      247142A
     C*
     C           MNRED     TAG                             ** TAG MNRED
     C                     READ FT0060F1                 80
     C           *IN05     IFEQ '1'                                                           257603
     C                     MOVE '0'       *IN05                                               257603
     C                     MOVE '1'       *IN01                                               257603
     C                     ENDIF                                                              257603
      *                                                                   059192
      * Clear message subfile                                             059192
      *                                                                   059192
     C                     CALL 'Y2CLMSC'                                 059192
     C                     PARM ##PGM     FTPGMQ                          059192
     C                     PARM '*SAME'   FTPGRL                          059192
     C/COPY WNCPYSRC,FT0060C072
      *                                                                   059192
      * Reset message sent flag                                           059192
      *                                                                   059192
     C                     MOVEL'N'       FTMSGS                          059192
     C                     MOVEL*BLANKS   FTWARN                          059192
      *                                                                   059192
     C*
     C   05                SETOF                     89
     C**                                                                  S01199
     C** 11                DO                              B002           S01199
     C**                   EXSR HELP                                      S01199
     C**                   GOTO MNRED                                     S01199
     C**                   END                             E002           S01199
     C*
     C                     END                             BYPASS LOOP
     C*
     C* IF NONE OF HELP, F3 OR F5 HAVE BEEN PRESSED
     C* VALIDATE AND GOT AUTHORISATION SCREEN IF NO ERRORS
     C*
     C  N01N05             DO                              B002
     C/COPY WNCPYSRC,FT0060C073
     C*                                                                   S01194
     C**  Resolve ?'s before validation                                   S01194
     C*                                                                   S01194
     C                     EXSR FLDQRY                                    S01194
     C*                                                                   S01194
     C**  Goto beginning if field in error or queried                     S01194
     C*                                                                   S01194
     C           *IN52     IFEQ '1'                                       S01194
     C                     GOTO FIRST                                     S01194
     C                     END                                            S01194
     C*
     C                     EXSR VALONE
     C/COPY WNCPYSRC,FT0060C007
     C           FTNOUP    IFEQ *BLANKS                                   059192
     C  N89                EXSR AUTHOR
     C/COPY WNCPYSRC,FT0060C074
     C   05 89             SETOF                     05
     C                     END                                            059192
     C                     END                             E002
     C*
     C  N89      XPREF     IFNE *BLANK
     C           FTNOUP    ANDEQ*BLANKS                                   059192
     C                     MOVE '1'       *IN01
     C                     END
     C*
     C                     END                             E001
     C*
     C* If F3 Exit and not F5
     C*
     C           *IN01     IFEQ '1'
     C           *IN05     ANDEQ'0'
     C           *LOCK     IN   DLDA
     C                     MOVE '3'       CMD
     C                     OUT  DLDA
     C                     END
     C*
     C/COPY WNCPYSRC,FT0060C036
     C                     SETON                     LR
     C********************************************************************
     C* END OF MAIN SECTION
     C********************************************************************
     C/EJECT
     C************************************************************
     C* KLISTS FOR ACCNT , OLPOS , PRONO
     C************************************************************
     C*
     C           AKEY      KLIST
     C                     KFLD           CNUM
     C                     KFLD           CCY
     C                     KFLD           ACOD
     C                     KFLD           ACSQ
     C*
     C************************************************************
     C* END OF KLISTS
     C************************************************************
     C/EJECT
     C********************************************************************
     C* INITL SR.
     C* READS TABLE FILE FOR BASE CURRENCY RUN DATE ETC
     C*
     C           INITL     BEGSR
     C* SETUP STANDARD FIELDS FOR ERRORS AND COMIT
     C           *NAMVAR   DEFN LDA       DLDA
     C           *NAMVAR   DEFN OTPAYDA   OTPAYD
     C                     MOVE 'FT'      MODULE
     C                     MOVE 'A'       ACTION
     C                     MOVELWID       WID1
     C                     MOVE WID       WID2
     C                     MOVE USRID     USRID1
     C                     MOVE 'FT0060'  PROG
     C*                    MOVE *BLANKS   BLNK35 35
      *                                                                   059192
      * Clear message subfile                                             059192
      *                                                                   059192
     C                     CALL 'Y2CLMSC'                                 059192
     C                     PARM ##PGM     FTPGMQ                          059192
     C                     PARM '*SAME'   FTPGRL                          059192
      *                                                                   059192
      * Reset message sent flag                                           059192
      *                                                                   059192
     C                     MOVEL'N'       FTMSGS                          059192
     C                     MOVEL*BLANKS   FTWARN                          059192
      *                                                                   059192
     C**READ*INSTALLATION*CONTROL RECORD 1                                S01194
     C*********************MOVE *BLANK    KEY                             S01194
     C*********************MOVEL'01'      KEY                             S01194
     C*********************MOVE '10'      KEY                             S01194
     C***********KEY*******CHAINTABTB10F             80                   S01194
     C**N80******RECI******COMP 'D'                  8080                 S01194
     C***80****************DO                              B001           S01194
     C************LOCK*****IN   DLDA                                      S01194
     C*********************MOVE 'FT0060'  DBPGM                           S01194
     C*********************MOVE 'TABLE'   DBFILE           ***************S01194
     C*********************Z-ADD1         DBASE            * DB ERROR 01 *S01194
     C*********************MOVELKEY       DBKEY            ***************S01194
     C*********************MOVE '*'       @RETC                           S01194
     C*********************OUT  DLDA                                      S01194
     C*********************SETON                     U7U8LR               S01194
     C*********************DUMP                                           S01194
     C*********************RETRN                                          S01194
     C*********************END                             E001           S01194
     C**READ*INSTALLATION*CONTROL RECORD TWO.                             S01194
     C*********************MOVE '11'      KEY                             S01194
     C***********KEY*******CHAINTABTB11F             80                   S01194
     C**N80****************                                               S01194
     C***80****************DO                              B001           S01194
     C************LOCK*****IN   DLDA                                      S01194
     C*********************MOVE 'FT0060'  DBPGM                           S01194
     C*********************MOVE 'TABLE'   DBFILE           ***************S01194
     C*********************Z-ADD2         DBASE            * DB ERROR 02 *S01194
     C*********************MOVELKEY       DBKEY            ***************S01194
     C*********************MOVE '*'       @RETC                           S01194
     C*********************OUT  DLDA                                      S01194
     C*********************SETON                     U7U8LR               S01194
     C*********************DUMP                                           S01194
     C*********************RETRN                                          S01194
     C*********************END                             E001           S01194
     C**READ*TABLE*FILE*FOR LOCAL CURRENCY                                S01194
     C*********************MOVE *BLANK    KEY                             S01194
     C*********************MOVEL'20'      KEY                             S01194
     C*********************MOVELLOCY      SCCY    4                       S01194
     C*********************MOVE '1'       SCCY                            S01194
     C*********************MOVE SCCY      KEY                             S01194
     C***********KEY*******CHAINTABTG10F             80                   S01194
     C**N80******RECI******COMP 'D'                  8080                 S01194
     C***80****************DO                              B001           S01194
     C************LOCK*****IN   DLDA                                      S01194
     C*********************MOVE 'FT0060'  DBPGM                           S01194
     C*********************MOVE 'TABLE'   DBFILE           ***************S01194
     C*********************Z-ADD19        DBASE            * DB ERROR 19 *S01194
     C*********************MOVELKEY       DBKEY            ***************S01194
     C*********************MOVE '*'       @RETC                           S01194
     C*********************OUT  DLDA                                      S01194
     C*********************SETON                     U7U8LR               S01194
     C*********************DUMP                                           S01194
     C*********************RETRN                                          S01194
     C*********************END                             E001           S01194
     C*                                                                   S01194
     C** Call to access pgm for bank details                              S01194
     C*                                                                   S01194
     C                     CALL 'AOBANKR0'                                S01194
     C                     PARM '*DBERR ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
     C*                                                                   S01194
     C** Execute Subroutine to move fields to old field names             S01194
     C*                                                                   S01194
     C                     EXSR AOBANK                                    S01194
     C*                                                                   S01194
     C*                                                                   S01194
     C** Call to access pgm for currency  details                         S01194
     C*                                                                   S01194
     C                     CALL 'AOCURRR0'                                S01194
     C                     PARM '*DBERR ' @RTCD                           S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM LOCY      @CCY    3                       S01194
     C           SDCURR    PARM SDCURR    DSSDY                           S01194
     C*                                                                   S01194
     C** Execute Subroutine to move fields to old field names             S01194
     C*                                                                   S01194
     C                     EXSR AOCURR                                    S01194
     C*                                                                   S01194
     C                     MOVE CDP       LCDP    10
     C*                                                                   S01194
     C**READ*TABLE*FILE*FORMBASE*CURRENCY KEY                             S01194
     C*********************MOVE *BLANK    KEY                             S01194
     C*********************MOVEL'20'      KEY                             S01194
     C*********************MOVELBCCY      SCCY    4                       S01194
     C*********************MOVE '1'       SCCY                            S01194
     C*********************MOVE SCCY      KEY                             S01194
     C***********KEY*******CHAINTABTG10F             80                   S01194
     C**N80******RECI******COMP 'D'                  8080                 S01194
     C***80****************DO   *BLANK                     B001           S01194
     C************LOCK*****IN   DLDA                                      S01194
     C*********************MOVE 'FT0060'  DBPGM                           S01194
     C*********************MOVE 'TABLE'   DBFILE           ***************S01194
     C*********************Z-ADD3         DBASE            * DB ERROR 03 *S01194
     C*********************MOVELKEY       DBKEY            ***************S01194
     C*********************MOVE '*'       @RETC                           S01194
     C*********************OUT  DLDA                                      S01194
     C*********************SETON                     U7U8LR               S01194
     C*********************DUMP                                           S01194
     C*********************RETRN          KEY                             S01194
     C*********************END            KEY              E001           S01194
     C*                                                                   S01194
     C** Call to access pgm for currency  details                         S01194
     C*                                                                   S01194
     C                     CALL 'AOCURRR0'                                S01194
     C                     PARM '*DBERR ' @RTCD                           S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM BCCY      @CCY    3                       S01194
     C           SDCURR    PARM SDCURR    DSSDY                           S01194
     C*                                                                   S01194
     C** Execute Subroutine to move fields to old field names             S01194
     C*                                                                   S01194
     C                     EXSR AOCURR                                    S01194
     C*                                                                   S01194
     C* STORE NUMBER OF DECIMAL PLACES AND SET 35,36,37 OR 38
     C*                                                                   S01194
     C                     MOVE CDP       BCDP    10
     C                     MOVEA'0000'    *IN,35
     C           35        ADD  CDP       Q       30
     C* READ PAYMENT CHARGES RECORD
     C                     MOVE '1'       *IN,Q
     C*                                                                   S01194
     C***********1*********CHAINPYCHGDD              80                   S01117
     C**N80******RECI******COMP 'D'                  8080                 S01117
     C***80****************DO                              B003           S01117
     C************LOCK*****IN   DLDA                                      S01117
     C*********************MOVE 'FT0060'  DBPGM                           S01117
     C*********************MOVE 'PYCHG'   DBFILE           ***************S01117
     C*********************Z-ADD4         DBASE            * DB ERROR 04 *S01117
     C*********************MOVEL'1'       DBKEY            ***************S01117
     C*********************MOVE '*'       @RETC                           S01117
     C*********************OUT  DLDA                                      S01117
     C*********************SETON                     U7U8LR               S01117
     C*********************DUMP                                           S01117
     C*********************RETRN                                          S01117
     C*********************END                             E003           S01117
      *                                                                   S01241
      * SEE IF WINDOW IS REQUIRED                                         S01241
      *                                                                   S01241
     C***********1*********SETLLSDMMODPD               8080         S01241S01194
     C*********************READ SDMMODPD               8080         S01241S01194
     C************IN80*****IFEQ '1'                                 S01241S01194
     C************LOCK*****IN   DLDA                                S01241S01194
     C*********************MOVE 'FT0060'  DBPGM                     S01241S01194
     C*********************MOVE 'SDMMOD'  DBFILE           *********S01241S01194
     C*********************Z-ADD99        DBASE            * DB ERROS01241S01194
     C*********************MOVEL'1'       DBKEY            *********S01241S01194
     C*********************MOVE '*'       @RETC                     S01241S01194
     C*********************OUT  DLDA                                S01241S01194
     C*********************SETON                     U7U8LR         S01241S01194
     C*********************DUMP                                     S01241S01194
     C*********************RETRN                                    S01241S01194
     C*********************END                                      S01241S01194
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0060CCP3                                           S01408
     C*                                                                   S01408
     C*                                                                   S01494
     C** Access SAR details file to determine if S01494 is switched ON    S01494
     C*                                                                   S01494
     C                     CALL 'AOSARDR0'                                S01494
     C                     PARM *BLANKS   @RTCD   7                       S01494
     C                     PARM '*VERIFY' @OPTN   7                       S01494
     C                     PARM 'S01494'  @SARD   6                       S01494
     C           SCSARD    PARM SCSARD    DSFDY                           S01494
     C                     MOVE 'N'       S01494  1                       S01494
     C                     MOVE '0'       *IN13                           S01494
     C*                                                                   S01494
     C** If core feature is switched ON, set a variable field to          S01494
     C** condition the rest of the processing                             S01494
     C*                                                                   S01494
     C           @RTCD     IFEQ *BLANKS                                   S01494
     C                     MOVE 'Y'       S01494                          S01494
     C                     MOVE '1'       *IN13                           S01494
     C                     ELSE                                           S01494
     C*                                                                   S01494
     C** else, database error (return code other than *NRF)               S01494
     C*                                                                   S01494
     C           @RTCD     IFNE '*NRF   '                                 S01494
     C                     MOVEL'FT0060 ' DBPGM                           S01494
     C                     MOVEL'SCSARDPD'DBFILE           ************   S01494
     C                     MOVEL'*VERIFY' DBKEY            * DBERR 09 *   S01494
     C                     Z-ADD09        DBASE            ************   S01494
     C                     OUT  DLDA                                      S01494
     C                     SETON                     U7U8LR               S01494
     C                     DUMP                                           S01494
     C*                                                                   S01494
     C** Allocate dataarea to blanks                                      S01494
     C*                                                                   S01494
     C                     EXSR DALLOC                                    S01494
     C                     RETRN                                          S01494
     C                     END                                            S01494
     C                     END                                            S01494
     C/COPY WNCPYSRC,FT0060C029
     C*                                                                   S01499
     C** Access SAR details file to determine if S01499 is switched ON    S01499
     C*                                                                   S01499
     C                     CALL 'AOSARDR0'                                S01499
     C                     PARM *BLANKS   @RTCD   7                       S01499
     C                     PARM '*VERIFY' @OPTN   7                       S01499
     C                     PARM 'S01499'  @SARD   6                       S01499
     C           SCSARD    PARM SCSARD    DSFDY                           S01499
     C                     MOVE 'N'       S01499  1                       S01499
     C                     MOVE '0'       *IN15                           S01499
     C*                                                                   S01499
     C** If core feature is switched ON, set a variable field to          S01499
     C** condition the rest of the processing                             S01499
     C*                                                                   S01499
     C           @RTCD     IFEQ *BLANKS                                   S01499
     C                     MOVE 'Y'       S01499                          S01499
     C                     MOVE '1'       *IN15                           S01499
     C                     ELSE                                           S01499
     C*                                                                   S01499
     C** else, database error (return code other than *NRF)               S01499
     C*                                                                   S01499
     C           @RTCD     IFNE '*NRF   '                                 S01499
     C                     MOVEL'FT0060 ' DBPGM                           S01499
     C                     MOVEL'SCSARDPD'DBFILE           ************   S01499
     C                     MOVEL'*VERIFY' DBKEY            * DBERR 10 *   S01499
     C                     Z-ADD10        DBASE            ************   S01499
     C                     OUT  DLDA                                      S01499
     C                     SETON                     U7U8LR               S01499
     C                     DUMP                                           S01499
     C*                                                                   S01499
     C** Allocate dataarea to blanks                                      S01499
     C*                                                                   S01499
     C/COPY WNCPYSRC,FT0060C028
     C                     EXSR DALLOC                                    S01499
     C                     RETRN                                          S01499
     C                     END                                            S01499
     C                     END                                            S01499
      /COPY WNCPYSRC,HUT101_003                                                               HUT101
      *                                                                   CEU006
      ** Access SAR details file to determine if CEU006 is switched ON    CEU006
      *                                                                   CEU006
     C                     CALL 'AOSARDR0'                                CEU006
     C                     PARM *BLANKS   @RTCD                           CEU006
     C                     PARM '*VERIFY' @OPTN                           CEU006
     C                     PARM 'CEU006'  @SARD                           CEU006
     C           SCSARD    PARM SCSARD    DSFDY                           CEU006
     C                     MOVE 'N'       CEU006  1                       CEU006
     C                     MOVE '0'       *IN72                           CEU006
      *                                                                   CEU006
      ** If core feature is switched ON, set a variable field to          CEU006
      ** condition the rest of the processing                             CEU006
      *                                                                   CEU006
     C           @RTCD     IFEQ *BLANKS                                   CEU006
     C                     MOVE 'Y'       CEU006                          CEU006
     C                     MOVE '1'       *IN72                           CEU006
     C                     ELSE                                           CEU006
     C*                                                                   CEU006
     C** else, database error (return code other than *NRF)               CEU006
     C*                                                                   CEU006
     C           @RTCD     IFNE '*NRF   '                                 CEU006
     C                     MOVEL'FT0060 ' DBPGM                           CEU006
     C                     MOVEL'SCSARDPD'DBFILE           ************   CEU006
     C                     MOVEL'*VERIFY' DBKEY            * DBERR 21 *   CEU006
     C                     Z-ADD21        DBASE            ************   CEU006
     C                     OUT  DLDA                                      CEU006
     C                     SETON                     U7U8LR               CEU006
     C                     DUMP                                           CEU006
     C*                                                                   CEU006
     C** Allocate dataarea to blanks                                      CEU006
     C*                                                                   CEU006
     C                     EXSR DALLOC                                    CEU006
     C                     RETRN                                          CEU006
     C                     ENDIF                                          CEU006
     C                     ENDIF                                          CEU006
     C/COPY WNCPYSRC,FT0060C035
      *                                                                                       CFT049
      *** Check if CFT049 is switched on                                                      CFT049
      *                                                                                       CFT049
     C                     MOVE 'N'       CFT049  1                                           CFT049
     C                     CALL 'AOSARDR0'                                                    CFT049
     C                     PARM '       ' @RTCD                                               CFT049
     C                     PARM '*VERIFY' @OPTN                                               CFT049
     C                     PARM 'CFT049'  @SARD                                               CFT049
      *                                                                                       CFT049
     C           @RTCD     IFEQ *BLANK                                                        CFT049
     C                     MOVE 'Y'       CFT049                                              CFT049
     C                     ENDIF                                                              CFT049
      *                                                                   CDL049
     C                     MOVE 'N'       CDL049  1                       CDL049
     C                     MOVE 0         *IN19                           CDL049
      *                                                                   CDL049
      ** Access SAR details file to determine if CDL049 is switched ON    CDL049
      *                                                                   CDL049
     C                     CALL 'AOSARDR0'                                CDL049
     C                     PARM *BLANKS   @RTCD                           CDL049
     C                     PARM '*VERIFY' @OPTN                           CDL049
     C                     PARM 'CDL049'  @SARD                           CDL049
     C           SCSARD    PARM SCSARD    DSFDY                           CDL049
      *                                                                   CDL049
      ** If feature is switched ON, set a variable field to               CDL049
      ** condition the rest of the processing                             CDL049
      *                                                                   CDL049
     C           @RTCD     IFEQ *BLANKS                                   CDL049
     C                     MOVE 'Y'       CDL049                          CDL049
     C                     MOVE 1         *IN19                           CDL049
     C                     ENDIF                                          CDL049
      *                                                                   CDL049
      *                                                                   CFT004
      *** Check if CFT004 is switched on                                  CFT004
      *                                                                   CFT004
     C                     CALL 'AOSARDR0'                                CFT004
     C                     PARM '       ' @RTCD   7                       CFT004
     C                     PARM '*VERIFY' @OPTN                           CFT004
     C                     PARM 'CFT004'  @SARD   6                       CFT004
      *                                                                   CFT004
     C           @RTCD     IFEQ *BLANK                                    CFT004
     C                     MOVE 'Y'       CFT004  1                       CFT004
     C                     ELSE                                           CFT004
     C** else, database error (return code other than *NRF)               CFT004
     C*                                                                   CFT004
     C           @RTCD     IFNE '*NRF   '                                 CFT004
     C                     MOVEL'FT0060 ' DBPGM                           CFT004
     C                     MOVEL'SCSARDPD'DBFILE           ************   CFT004
     C                     MOVEL'*VERIFY' DBKEY            * DBERR 22 *   CFT004
     C                     Z-ADD22        DBASE            ************   CFT004
     C                     OUT  DLDA                                      CFT004
     C                     SETON                     U7U8LR               CFT004
     C                     DUMP                                           CFT004
     C*                                                                   CFT004
     C** Allocate dataarea to blanks                                      CFT004
     C*                                                                   CFT004
     C                     EXSR DALLOC                                    CFT004
     C                     RETRN                                          CFT004
     C                     ELSE                                           CFT004
     C                     MOVE 'N'       CFT004                          CFT004
     C                     ENDIF                                          CFT004
     C                     ENDIF                                          CFT004
      *                                                                   CFT004
      *                                                                   CFT009
      *** Check if CFT009 is switched on                                  CFT009
      *                                                                   CFT009
     C                     CALL 'AOSARDR0'                                CFT009
     C                     PARM '       ' @RTCD   7                       CFT009
     C                     PARM '*VERIFY' @OPTN                           CFT009
     C                     PARM 'CFT009'  @SARD   6                       CFT009
      *                                                                   CFT009
     C           @RTCD     IFEQ *BLANK                                    CFT009
     C                     MOVE 'Y'       CFT009  1                       CFT009
     C                     SETON                         73               CFT009
     C                     ELSE                                           CFT009
     C** else, database error (return code other than *NRF)               CFT009
     C*                                                                   CFT009
     C           @RTCD     IFNE '*NRF   '                                 CFT009
     C                     MOVEL'FT0060 ' DBPGM                           CFT009
     C                     MOVEL'SCSARDPD'DBFILE           ************   CFT009
     C                     MOVEL'*VERIFY' DBKEY            * DBERR 23 *   CFT009
     C                     Z-ADD23        DBASE            ************   CFT009
     C                     OUT  DLDA                                      CFT009
     C                     SETON                     U7U8LR               CFT009
     C                     DUMP                                           CFT009
     C*                                                                   CFT009
     C** Allocate dataarea to blanks                                      CFT009
     C*                                                                   CFT009
     C                     EXSR DALLOC                                    CFT009
     C                     RETRN                                          CFT009
     C                     ELSE                                           CFT009
     C**********           MOVE 'N'       CFT004                                     CFT009 BUG25971
     C                     MOVE 'N'       CFT009                                            BUG25971
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      *** Check if CFT010 is switched on                                  CFT009
      *                                                                   CFT009
     C                     CALL 'AOSARDR0'                                CFT009
     C                     PARM '       ' @RTCD   7                       CFT009
     C                     PARM '*VERIFY' @OPTN                           CFT009
     C                     PARM 'CFT010'  @SARD   6                       CFT009
      *                                                                   CFT009
     C           @RTCD     IFEQ *BLANK                                    CFT009
     C                     MOVE 'Y'       CFT010  1                       CFT009
     C                     SETON                         74               CFT009
     C                     ELSE                                           CFT009
     C** else, database error (return code other than *NRF)               CFT009
     C*                                                                   CFT009
     C           @RTCD     IFNE '*NRF   '                                 CFT009
     C                     MOVEL'FT0060 ' DBPGM                           CFT009
     C                     MOVEL'SCSARDPD'DBFILE           ************   CFT009
     C                     MOVEL'*VERIFY' DBKEY            * DBERR 24 *   CFT009
     C                     Z-ADD24        DBASE            ************   CFT009
     C                     OUT  DLDA                                      CFT009
     C                     SETON                     U7U8LR               CFT009
     C                     DUMP                                           CFT009
     C*                                                                   CFT009
     C** Allocate dataarea to blanks                                      CFT009
     C*                                                                   CFT009
     C                     EXSR DALLOC                                    CFT009
     C                     RETRN                                          CFT009
     C                     ELSE                                           CFT009
     C**********           MOVE 'N'       CFT004                                     CFT009 BUG25971
     C                     MOVE 'N'       CFT010                                            BUG25971
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
     C*                                                                   CFT009
     C* VAT Flags                                                         CFT009
     C           CFT009    IFEQ 'Y'                                       CFT009
     C           CFT010    IFEQ 'Y'                                       CFT009
     C                     SETON                         15               CFT009
     C                     ELSE                                           CFT009
     C                     SETOF                         15               CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
     C*                                                                   CFT009
      ** Access SAR file to determine if CFT014 is switched ON.           CFT014
      *                                                                   CFT014
     C                     CALL 'AOSARDR0'                                CFT014
     C                     PARM *BLANKS   @RTCD                           CFT014
     C                     PARM '*VERIFY' @OPTN                           CFT014
     C                     PARM 'CFT014'  @SARD                           CFT014
     C           SCSARD    PARM SCSARD    DSFDY                           CFT014
     C                     MOVE 'N'       CFT014  1                       CFT014
      *                                                                   CFT014
      ** If core feature is switched ON, set a variable field to          CFT014
      ** condition the rest of the processing.                            CFT014
      *                                                                   CFT014
     C           @RTCD     IFEQ *BLANKS                                   CFT014
     C                     MOVE 'Y'       CFT014                          CFT014
     C                     MOVE *ON       *IN83                           CFT014
     C*********************OPEN INPAYXL2                            CFT014CFT009
     C*********************OPEN OTPAYXL2                            CFT014CFT009
     C*********************OPEN OTPAYXL0                            CFT014CFT009
     C                     ELSE                                           CFT014
      *                                                                   CFT014
      ** Else, database error if return code is other than *NRF.          CFT014
      *                                                                   CFT014
     C           @RTCD     IFNE '*NRF   '                                 CFT014
     C                     Z-ADD060       W0ERNB                          CFT014
     C                     MOVEL'CFT014'  W0KEY                           CFT014
     C                     MOVEL'SCSARDPD'W0FILE                          CFT014
     C                     EXSR SRERR                                     CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
     C/COPY WNCPYSRC,FTH00219
      *                                                                                       CFT120
      ** Access SAR details file to determine if CFT120 is switched ON                        CFT120
      *                                                                                       CFT120
     C                     CALL 'AOSARDR0'                                                    CFT120
     C                     PARM *BLANKS   @RTCD                                               CFT120
     C                     PARM '*VERIFY' @OPTN                                               CFT120
     C                     PARM 'CFT120'  @SARD                                               CFT120
     C           SCSARD    PARM SCSARD    DSFDY                                               CFT120
     C                     MOVE 'N'       CFT120  1                                           CFT120
     C                     MOVE '0'       *IN59                                               CFT120
      *                                                                                       CFT120
      ** If core feature is switched ON, set a variable field to                              CFT120
      ** condition the rest of the processing                                                 CFT120
      *                                                                                       CFT120
     C           @RTCD     IFEQ *BLANKS                                                       CFT120
     C                     MOVE 'Y'       CFT120                                              CFT120
     C                     MOVE '1'       *IN59                                               CFT120
     C                     ELSE                                                               CFT120
      *                                                                                       CFT120
      ** else, database error (return code other than *NRF)                                   CFT120
      *                                                                                       CFT120
     C           @RTCD     IFNE '*NRF   '                                                     CFT120
     C                     MOVEL'FT0060 ' DBPGM                                               CFT120
     C                     MOVEL'SCSARDPD'DBFILE           ************                       CFT120
     C                     MOVEL'*VERIFY' DBKEY            * DBERR 25 *                       CFT120
     C                     Z-ADD25        DBASE            ************                       CFT120
     C                     OUT  DLDA                                                          CFT120
     C                     SETON                     U7U8LR                                   CFT120
     C                     DUMP                                                               CFT120
      *                                                                                       CFT120
      ** Allocate dataarea to blanks                                                          CFT120
      *                                                                                       CFT120
     C                     EXSR DALLOC                                                        CFT120
     C                     RETRN                                                              CFT120
     C                     END                                                                CFT120
     C                     END                                                                CFT120
     C/COPY WNCPYSRC,FT0060C029                                                               CFT120
      *                                                                                       CSW203
      ** Check if SWIFT Changes 2003 (CSW203) is installed                                    CSW203
      *                                                                                       CSW203
     C                     CALL 'SWIF2003'                                                    CSW203
     C                     PARM *BLANKS   PRTCD                                               CSW203
      *                                                                                       CSW203
     C           PRTCD     IFEQ 'CSW2003'                                                     CSW203
     C                     MOVE 'Y'       CSW203  1                                           CSW203
     C                     MOVE *ON       *IN85                                               CSW203
     C                     ELSE                                                               CSW203
     C                     MOVE 'N'       CSW203                                              CSW203
     C                     MOVE *OFF      *IN85                                               CSW203
     C                     ENDIF                                                              CSW203
      *                                                                   CFT009
     C           CFT014    IFEQ 'Y'                                       CFT009
     C           CFT009    OREQ 'Y'                                       CFT009
     C                     OPEN INPAYXL2                                  CFT009
     C                     OPEN OTPAYXL2                                  CFT009
     C                     OPEN OTPAYXL0                                  CFT009
     C                     ENDIF                                          CFT009
      *                                                                                       CRE008
      ** Check if Cash Mangament is installed                                                 CRE008
      *                                                                                       CRE008
     C                     MOVE 'N'       CRE008  1                                           CRE008
     C                     CALL 'AOSARDR0'                                                    CRE008
     C                     PARM *BLANKS   @RTCD                                               CRE008
     C                     PARM '*VERIFY' @OPTN                                               CRE008
     C                     PARM 'CRE008'  @SARD                                               CRE008
     C           SCSARD    PARM SCSARD    DSFDY                                               CRE008
      *                                                                                       CRE008
     C           @RTCD     IFEQ *BLANKS                                                       CRE008
     C                     MOVE 'Y'       CRE008                                              CRE008
     C                     ELSE                                                               CRE008
     C           @RTCD     IFNE '*NRF   '                                                     CRE008
     C                     Z-ADD103       W0ERNB                                              CRE008
     C                     MOVEL'CRE008'  W0KEY                                               CRE008
     C                     MOVEL'SCSARDPD'W0FILE                                              CRE008
     C                     EXSR SRERR                                                         CRE008
     C                     ENDIF                                                              CRE008
     C                     ENDIF                                                              CRE008
      *                                                                                       CFT151
      ** Check if CFT151 is ON                                                                CFT151
      *                                                                                       CFT151
     C                     MOVE 'N'       CFT151  1                                           CFT151
     C                     CALL 'AOSARDR0'                                                    CFT151
     C                     PARM *BLANKS   @RTCD                                               CFT151
     C                     PARM '*VERIFY' @OPTN                                               CFT151
     C                     PARM 'CFT151'  @SARD                                               CFT151
     C           SCSARD    PARM SCSARD    DSFDY                                               CFT151
      *                                                                                       CFT151
     C           @RTCD     IFEQ *BLANKS                                                       CFT151
     C                     MOVE 'Y'       CFT151                                              CFT151
     C                     ELSE                                                               CFT151
     C           @RTCD     IFNE '*NRF   '                                                     CFT151
     C                     Z-ADD103       W0ERNB                                              CFT151
     C                     MOVEL'CFT151'  W0KEY                                               CFT151
     C                     MOVEL'SCSARDPD'W0FILE                                              CFT151
     C                     EXSR SRERR                                                         CFT151
     C                     ENDIF                                                              CFT151
     C                     ENDIF                                                              CFT151
     C/COPY WNCPYSRC,FTH00110
     C*                                                                   S01494
     C** Retrieve the text "User not found" using MEC1150                 S01494
     C*                                                                   S01494
     C                     CALL 'MEC1150'              9090               S01494
     C                     PARM 'FTM2510' #MSGID  7                       S01494
     C                     PARM 'FTUSRMSG'#MSGF  10                       S01494
     C                     PARM           #MSDTA                          S01494
     C                     PARM *BLANKS   #MSTX1                          S01494
     C                     PARM *BLANKS   #MSTX2                          S01494
     C*                                                                   S01494
     C                     MOVEL#MSTX1    WM2510 28                       S01494
     C*                                                                   S01194
     C** Call to Midas Modules access pgm for MBIN                        S01194
     C*                                                                   S01194
     C                     CALL 'AOMMODR0'                                S01194
     C                     PARM '*DBERR ' @RTCD                           S01194
     C                     PARM '*FIRST ' @OPTN                           S01194
     C           SDMMOD    PARM SDMMOD    DSFDY                           S01194
     C*                                                                   S01194
     C***        BGMBIN    IFEQ 'Y'                                S01117 245478
     C***                  MOVE '1'       *IN50                    S01117 245478
     C***                  END                                     S01117 245478
     C           BGMBIN    IFEQ 'Y'                                                           256821
     C                     MOVE '1'       *IN50                                               256821
     C                     ENDIF                                                              256821
      *                                                                   CAC001
      **  If Analytical Accounting is installed, enable F19 for           CAC001
      **  Margin Information.                                             CAC001
      *                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C                     MOVE '1'       *IN16                           CAC001
     C                     ELSE                                           CAC001
     C                     MOVE '0'       *IN16                           CAC001
     C                     END                                            CAC001
     C*                                                                   S01194
     C** Call to General Ledger access pgm                                S01194
     C*                                                                   S01194
     C**********           CALL 'AOGELRR0'                                             S01194 CGL029
     C                     CALL 'AOGELRR1'                                                    CGL029
     C                     PARM '*DBERR ' @RTCD                           S01194
     C                     PARM '*FIRST ' @OPTN                           S01194
     C********** SDGELR    PARM SDGELR    DSFDY                                        S01194 CGL029
     C           SDGELR    PARM SDGELR    DSSDY                                               CGL029
     C*                                                                   S01194
     C           BKOBRU    IFEQ 'Y'                                       S01117
     C                     MOVE '1'       *IN51                           S01117
     C                     END                                            S01117
      *                                                                   S01414
      *  Check if Profit Centres are used and set screen attributes       S01414
      *                                                                   S01414
     C           BKPRCU    IFEQ 'Y'                                       S01414
     C                     MOVE '1'       *IN71                           S01414
     C                     END                                            S01414
     C*                                                                   S01194
     C** Call to Funds Transfer access pgm                                S01194
     C** Read FT ICD file                                                 S01194
     C*                                                                   S01194
     C                     CALL 'AOFTFRR0'                                S01194
     C                     PARM '*DBERR ' @RTCD                           S01194
     C                     PARM '*FIRST ' @OPTN                           S01194
     C           SDFTFR    PARM SDFTFR    DSFDY                           S01194
     C*                                                                   S01194
     C                     MOVE BTCHCY    FTCC    1                       S01194
      *                                                                                       CSW209
      ** Access Switchable Features file for CSW209                                           CSW209
      *                                                                                       CSW209
     C                     MOVE 'N'       CSW209  1                                           CSW209
     C                     CALL 'SWIF2009'                                                    CSW209
     C                     PARM *BLANKS   @RTCD                                               CSW209
      *                                                                                       CSW209
     C           @RTCD     IFEQ 'CSW2009'                                                     CSW209
     C                     MOVE 'Y'       CSW209                                              CSW209
     C                     SETON                     75                                       CSW209
     C                     ELSE                                                               CSW209
     C                     SETOF                     75                                       CSW209
     C                     ENDIF                                                              CSW209
      *
      ** Seton 42 (enable F7) if called from FT0110, i.e. payment
      ** reference not blank
      *
     C           XPREF     COMP *BLANK               4242
      *                                                                   106483
     C                     MOVE '0'       *IN45                           106483
      *                                                                                       CSD015
      ** Determine if CSC011 enhancement is installed                                         CSD015
      *                                                                                       CSD015
     C                     MOVE 'N'       CSC011  1                                           CSD015
      *                                                                                       CSD015
     C                     CALL 'AOSARDR0'                                                    CSD015
     C                     PARM *BLANKS   PRTCD                                               CSD015
     C                     PARM '*VERIFY' POPTN                                               CSD015
     C                     PARM 'CSC011'  PSARD                                               CSD015
     C           SCSARD    PARM SCSARD    DSFDY                                               CSD015
      *                                                                                       CSD015
      ** Database Error (return code other than *NRF)                                         CSD015
      *                                                                                       CSD015
     C           PRTCD     IFNE *BLANKS                                                       CSD015
     C           PRTCD     ANDNE'*NRF   '                                                     CSD015
     C                     MOVEL'SCSARDPD'W0FILE                                              CSD015
     C                     MOVEL'CSC011'  W0KEY                                               CSD015
     C                     Z-ADD30        W0ERNB                                              CSD015
     C                     EXSR SRERR                                                         CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PRTCD     IFEQ *BLANKS                                                       CSD015
     C                     MOVE 'Y'       CSC011                                              CSD015
      *                                                                                       CSD015
     C           *NAMVAR   DEFN           SC24X7                                              CSD015
     C                     IN   SC24X7                                                        CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           *NAMVAR   DEFN           SDSTAT                                              CSD015
     C                     IN   SDSTAT                                                        CSD015
      *                                                                                       CSD015
      ** Determine if CSD015 enhancement is installed                                         CSD015
      *                                                                                       CSD015
     C                     MOVE 'N'       CSD015  1                                           CSD015
      *                                                                                       CSD015
     C                     CALL 'AOSARDR0'                                                    CSD015
     C                     PARM *BLANKS   PRTCD   7                                           CSD015
     C                     PARM '*VERIFY' POPTN   7                                           CSD015
     C                     PARM 'CSD015'  PSARD   6                                           CSD015
     C           SCSARD    PARM SCSARD    DSFDY                                               CSD015
      *                                                                                       CSD015
      ** Database Error (return code other than *NRF)                                         CSD015
      *                                                                                       CSD015
     C           PRTCD     IFNE *BLANKS                                                       CSD015
     C           PRTCD     ANDNE'*NRF   '                                                     CSD015
     C                     MOVEL'SCSARDPD'W0FILE                                              CSD015
     C                     MOVEL'CSD015'  W0KEY                                               CSD015
     C                     Z-ADD31        W0ERNB                                              CSD015
     C                     EXSR SRERR                                                         CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PRTCD     IFEQ *BLANKS                                                       CSD015
     C                     MOVE 'Y'       CSD015                                              CSD015
      *                                                                                       CSD015
      ** Access AOWLCCR0 to check if function code 'FTIPAY' is available                      CSD015
      *                                                                                       CSD015
     C                     CALL 'AOWLCCR0'                                                    CSD015
     C                     PARM *BLANKS   PRTCD                                               CSD015
     C                     PARM '*KEY'    POPTN                                               CSD015
     C                     PARM 'FTIPAY'  PFUNC   8                                           CSD015
     C           SDWLCC    PARM SDWLCC    DSFDY                                               CSD015
      *                                                                                       CSD015
     C           PRTCD     IFNE *BLANKS                                                       CSD015
     C           PRTCD     ANDNE'*NRF'                                                        CSD015
     C                     MOVEL'SDWLCCPD'W0FILE                                              CSD015
     C                     MOVELPFUNC     W0KEY                                               CSD015
     C                     Z-ADD32        W0ERNB                                              CSD015
     C                     EXSR SRERR                                                         CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      ** If return code is equal to blank, set WELCI to 'Y'                                   CSD015
      *                                                                                       CSD015
     C                     MOVE *BLANK    WELCI   1                                           CSD015
     C           PRTCD     IFEQ *BLANKS                                                       CSD015
     C           W1EWLC    ANDEQ'Y'                                                           CSD015
     C                     MOVE 'Y'       WELCI                                               CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      ** Access AOWLCCR0 to check if function code 'FTOPAY' is available                      CSD015
      *                                                                                       CSD015
     C                     CALL 'AOWLCCR0'                                                    CSD015
     C                     PARM *BLANKS   PRTCD                                               CSD015
     C                     PARM '*KEY'    POPTN                                               CSD015
     C                     PARM 'FTOPAY'  PFUNC                                               CSD015
     C           SDWLCC    PARM SDWLCC    DSFDY                                               CSD015
      *                                                                                       CSD015
     C           PRTCD     IFNE *BLANKS                                                       CSD015
     C           PRTCD     ANDNE'*NRF'                                                        CSD015
     C           *LOCK     IN   DLDA                                                          CSD015
     C                     MOVEL'SDWLCCPD'W0FILE                                              CSD015
     C                     MOVELPFUNC     W0KEY                                               CSD015
     C                     Z-ADD33        W0ERNB                                              CSD015
     C                     EXSR SRERR                                                         CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      ** If return code is equal to blank, set WELCO to 'Y'                                   CSD015
      *                                                                                       CSD015
     C                     MOVE *BLANK    WELCO   1                                           CSD015
     C           PRTCD     IFEQ *BLANKS                                                       CSD015
     C           W1EWLC    ANDEQ'Y'                                                           CSD015
     C                     MOVE 'Y'       WELCO                                               CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD083
      ** Determine if CSD083 enhancement is installed. If it is then switch off               CSD083
      ** CSD015                                                                               CSD083
      *                                                                                       CSD083
     C                     CALL 'AOSARDR0'                                                    CSD083
     C                     PARM *BLANKS   PRTCD                                               CSD083
     C                     PARM '*VERIFY' POPTN                                               CSD083
     C                     PARM 'CSD083'  PSARD                                               CSD083
     C           SCSARD    PARM SCSARD    DSFDY                                               CSD083
      *                                                                                       CSD083
      ** Database Error (return code other than *NRF)                                         CSD083
      *                                                                                       CSD083
     C           PRTCD     IFNE *BLANKS                                                       CSD083
     C           PRTCD     ANDNE'*NRF   '                                                     CSD083
     C                     MOVEL'SCSARDPD'W0FILE                                              CSD083
     C                     MOVEL'CSD083'  W0KEY                                               CSD083
     C                     Z-ADD106       W0ERNB                                              CSD083
     C                     EXSR SRERR                                                         CSD083
     C                     ENDIF                                                              CSD083
      *                                                                                       CSD083
     C           PRTCD     IFEQ *BLANKS                                                       CSD083
     C                     MOVE 'N'       CSD015                                              CSD083
     C                     ENDIF                                                              CSD083
      *                                                                                       CRE020
      ** Check if Online Printing of Advices (GE7) is on                                      CRE020
      *                                                                                       CRE020
     C                     MOVE 'N'       CRE020  1                                           CRE020
     C                     CALL 'AOSARDR0'                                                    CRE020
     C                     PARM *BLANKS   @RTCD                                               CRE020
     C                     PARM '*VERIFY' @OPTN                                               CRE020
     C                     PARM 'CRE020'  @SARD                                               CRE020
     C           SCSARD    PARM SCSARD    DSFDY                                               CRE020
      *                                                                                       CRE020
     C           @RTCD     IFEQ *BLANKS                                                       CRE020
     C                     MOVE 'Y'       CRE020                                              CRE020
     C                     MOVEL'FT0060'  RPRGMN                                              CRE020
     C                     ELSE                                                               CRE020
     C           @RTCD     IFNE '*NRF   '                                                     CRE020
     C                     Z-ADD104       W0ERNB                                              CRE020
     C                     MOVEL'CRE020'  W0KEY                                               CRE020
     C                     MOVEL'SCSARDPD'W0FILE                                              CRE020
     C                     EXSR SRERR                                                         CRE020
     C                     ENDIF                                                              CRE020
     C                     ENDIF                                                              CRE020
      *                                                                                       CRE020
      ** Call AOSVALR0 to check system values                                                 CRE020
      *                                                                                       CRE020
     C           CRE020    IFEQ 'Y'                                                           CRE020
     C                     MOVELINSVAL    PSVOP1 20                                           CRE020
     C                     MOVELOTSVAL    PSVOP2 20                                           CRE020
     C                     MOVE *BLANKS   PBLNK1 20                                           CRE020
     C                     MOVE *BLANKS   PBLNK2200                                           CRE020
      *                                                                                       CRE020
     C                     CALL 'AOSVALR0'                                                    CRE020
     C                     PARM *BLANKS   @RTCD                                               CRE020
     C                     PARM           PSVOP1                                              CRE020
     C                     PARM           PSVAL1200                                           CRE020
     C                     PARM           PSVOP2                                              CRE020
     C                     PARM           PSVAL2200                                           CRE020
     C                     PARM           PBLNK1                                              CRE020
     C                     PARM           PBLNK2                                              CRE020
     C                     PARM           PBLNK1                                              CRE020
     C                     PARM           PBLNK2                                              CRE020
     C                     PARM           PBLNK1                                              CRE020
     C                     PARM           PBLNK2                                              CRE020
     C                     PARM           PBLNK1                                              CRE020
     C                     PARM           PBLNK2                                              CRE020
     C                     PARM           PBLNK1                                              CRE020
     C                     PARM           PBLNK2                                              CRE020
     C                     PARM           PBLNK1                                              CRE020
     C                     PARM           PBLNK2                                              CRE020
     C                     PARM           PBLNK1                                              CRE020
     C                     PARM           PBLNK2                                              CRE020
     C                     PARM           PBLNK1                                              CRE020
     C                     PARM           PBLNK2                                              CRE020
      *                                                                                       CRE020
     C           @RTCD     IFNE *BLANKS                                                       CRE020
     C                     Z-ADD105       W0ERNB                                              CRE020
     C                     MOVEL'CRE020'  W0KEY                                               CRE020
     C                     MOVEL'SDSVALPD'W0FILE                                              CRE020
     C                     EXSR SRERR                                                         CRE020
     C                     ENDIF                                                              CRE020
     C                     ENDIF                                                              CRE020
     C/COPY WNCPYSRC,FTH00427
      *                                                                                       CSD015
      ** Compliance Watch Hit List Key List                                                   CSD015
      *                                                                                       CSD015
     C           KCWHT     KLIST                                                              CSD015
     C                     KFLD           KFUNT   8                                           CSD015
     C                     KFLD           KIDEN  40                                           CSD015
     C                     KFLD           KBRCH   3                                           CSD015
      *                                                                                       241810
      ** WIP file key                                                                         241810
      *                                                                                       241810
     C           KWIP      KLIST                                                              241810
     C                     KFLD           WIPREF 15                                           241810
     C                     KFLD           WIPZON 10                                           241810
      *
     C/COPY WNCPYSRC,FT0060C001
      ** Access SAR Details to determine if ULX043 is switched ON                             CER001
     C                     MOVEL'N'       ULX043  1                                           CER001
     C                     CALL 'AOSARDR0'                                                    CER001
     C                     PARM '       ' @RTCD                                               CER001
     C                     PARM '*VERIFY' @OPTN                                               CER001
     C                     PARM 'ULX043'  @SARD   6                                           CER001
     C           SCSARD    PARM SCSARD    DSFDY                                               CER001
      *                                                                                       CER001
     C           @RTCD     IFEQ *BLANK                                                        CER001
     C                     MOVE 'Y'       ULX043                                              CER001
     C                     ELSE                                                               CER001
      *                                                                                       CER001
      ** else, database error (return code other than *NRF)                                   CER001
      *                                                                                       CER001
     C           @RTCD     IFNE '*NRF   '                                                     CER001
     C                     MOVEL'FT0060 ' DBPGM                                               CER001
     C                     MOVEL'SCSARDPD'DBFILE                                              CER001
     C                     MOVEL'*VERIFY' DBKEY                                               CER001
     C                     Z-ADD09        DBASE                                               CER001
     C                     OUT  DLDA                                                          CER001
     C                     SETON                     U7U8LR                                   CER001
     C                     DUMP                                                               CER001
      *                                                                                       CER001
      ** Allocate dataarea to blanks                                                          CER001
      *                                                                                       CER001
     C                     EXSR DALLOC                                                        CER001
     C                     RETRN                                                              CER001
     C                     ENDIF                                                              CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER030
      ** Check if CER030 is switched 'ON'                                                     CER030
      *                                                                                       CER030
     C                     MOVE 'N'       CER030  1                                           CER030
     C                     MOVE *OFF      *IN47                                               CER030
      *                                                                                       CER030
     C                     CALL 'AOSARDR0'                                                    CER030
     C                     PARM *BLANKS   PRTCD                                               CER030
     C                     PARM '*VERIFY' POPTN                                               CER030
     C                     PARM 'CER030'  PSARD                                               CER030
     C           SCSARD    PARM SCSARD    DSFDY                                               CER030
      *                                                                                       CER030
     C           PRTCD     IFEQ *BLANKS                                                       CER030
     C                     MOVE 'Y'       CER030                                              CER030
     C                     ELSE                                                               CER030
      *                                                                                       CER030
      ** else, database error (return code other than *NRF)                                   CER030
      *                                                                                       CER030
     C           PRTCD     IFNE '*NRF   '                                                     CER030
     C                     MOVEL'FT0060 ' DBPGM                                               CER030
     C                     MOVEL'SCSARDPD'DBFILE                                              CER030
     C                     MOVELPSARD     DBKEY                                               CER030
     C                     Z-ADD106       DBASE                                               CER030
     C                     OUT  DLDA                                                          CER030
     C                     SETON                     U7U8LR                                   CER030
     C                     DUMP                                                               CER030
      *                                                                                       CER030
      ** Allocate dataarea to blanks                                                          CER030
      *                                                                                       CER030
     C                     EXSR DALLOC                                                        CER030
     C                     RETRN                                                              CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     MOVE 'N'       CGL013  1                                           CER030
      *                                                                                       CER030
     C                     CALL 'AOSARDR0'                                                    CER030
     C                     PARM *BLANKS   PRTCD                                               CER030
     C                     PARM '*VERIFY' POPTN                                               CER030
     C                     PARM 'CGL013'  PSARD                                               CER030
     C           SCSARD    PARM SCSARD    DSFDY                                               CER030
      *                                                                                       CER030
     C           PRTCD     IFEQ *BLANKS                                                       CER030
     C                     MOVE 'Y'       CGL013                                              CER030
     C                     ELSE                                                               CER030
      *                                                                                       CER030
      ** else, database error (return code other than *NRF)                                   CER030
      *                                                                                       CER030
     C           PRTCD     IFNE '*NRF   '                                                     CER030
     C                     MOVEL'FT0060 ' DBPGM                                               CER030
     C                     MOVEL'SCSARDPD'DBFILE                                              CER030
     C                     MOVELPSARD     DBKEY                                               CER030
     C                     Z-ADD108       DBASE                                               CER030
     C                     OUT  DLDA                                                          CER030
     C                     SETON                     U7U8LR                                   CER030
     C                     DUMP                                                               CER030
      *                                                                                       CER030
      ** Allocate dataarea to blanks                                                          CER030
      *                                                                                       CER030
     C                     EXSR DALLOC                                                        CER030
     C                     RETRN                                                              CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
      ** Check if CER031 is switched 'ON'                                                     CER030
      *                                                                                       CER030
     C                     MOVE 'N'       CER031  1                                           CER030
     C                     MOVE *OFF      *IN44                                               CER030
      *                                                                                       CER030
     C                     CALL 'AOSARDR0'                                                    CER030
     C                     PARM *BLANKS   PRTCD                                               CER030
     C                     PARM '*VERIFY' POPTN                                               CER030
     C                     PARM 'CER031'  PSARD                                               CER030
     C           SCSARD    PARM SCSARD    DSFDY                                               CER030
      *                                                                                       CER030
     C           PRTCD     IFEQ *BLANKS                                                       CER030
     C                     MOVE 'Y'       CER031                                              CER030
     C                     MOVE *ON       *IN44                                               CER030
     C                     ELSE                                                               CER030
      *                                                                                       CER030
      ** else, database error (return code other than *NRF)                                   CER030
      *                                                                                       CER030
     C           PRTCD     IFNE '*NRF   '                                                     CER030
     C                     MOVEL'FT0060 ' DBPGM                                               CER030
     C                     MOVEL'SCSARDPD'DBFILE                                              CER030
     C                     MOVELPSARD     DBKEY                                               CER030
     C                     Z-ADD107       DBASE                                               CER030
     C                     OUT  DLDA                                                          CER030
     C                     SETON                     U7U8LR                                   CER030
     C                     DUMP                                                               CER030
      *                                                                                       CER030
      ** Allocate dataarea to blanks                                                          CER030
      *                                                                                       CER030
     C                     EXSR DALLOC                                                        CER030
     C                     RETRN                                                              CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C           CGL013    IFEQ 'Y'                                                           CER030
     C           CER030    OREQ 'Y'                                                           CER030
     C           CER031    OREQ 'Y'                                                           CER030
     C                     MOVE *ON       *IN47                                               CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
      ** Check if CFT003 is switched 'ON'                                                     CER030
      *                                                                                       CER030
     C                     MOVE '      '  CFT003                                              CER030
      *                                                                                       CER030
     C                     CALL 'AOSARDR0'                                                    CER030
     C                     PARM *BLANKS   PRTCD                                               CER030
     C                     PARM '*VERIFY' POPTN                                               CER030
     C                     PARM 'CFT003'  PSARD                                               CER030
     C           SCSARD    PARM SCSARD    DSFDY                                               CER030
      *                                                                                       CER030
     C           PRTCD     IFEQ *BLANKS                                                       CER030
     C                     MOVE 'CFT003'  CFT003                                              CER030
     C                     ELSE                                                               CER030
      *                                                                                       CER030
      ** else, database error (return code other than *NRF)                                   CER030
      *                                                                                       CER030
     C           PRTCD     IFNE '*NRF   '                                                     CER030
     C                     MOVEL'FT0060 ' DBPGM                                               CER030
     C                     MOVEL'SCSARDPD'DBFILE                                              CER030
     C                     MOVELPSARD     DBKEY                                               CER030
     C                     Z-ADD107       DBASE                                               CER030
     C                     OUT  DLDA                                                          CER030
     C                     SETON                     U7U8LR                                   CER030
     C                     DUMP                                                               CER030
      *                                                                                       CER030
      ** Allocate dataarea to blanks                                                          CER030
      *                                                                                       CER030
     C                     EXSR DALLOC                                                        CER030
     C                     RETRN                                                              CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     ENDIF                                                              CER030
     C/COPY WNCPYSRC,FTH00267
      *                                                                                       CER049
      ** Access SAR file to determine if CER049                                               CER049
      ** (Stamp Tax) is installed.                                                            CER049
      *                                                                                       CER049
     C                     MOVE '0'       *IN54                                               CER049
     C                     MOVE 'N'       CER049  1                                           CER049
     C                     CALL 'AOSARDR0'                                                    CER049
     C                     PARM *BLANKS   @RTCD                                               CER049
     C                     PARM '*VERIFY' @OPTN                                               CER049
     C                     PARM 'CER049'  @SARD                                               CER049
     C           SCSARD    PARM SCSARD    DSFDY                                               CER049
      *                                                                                       CER049
     C           @RTCD     IFEQ *BLANKS                                                       CER049
     C                     MOVE '1'       *IN54                                               CER049
     C                     MOVE 'Y'       CER049                                              CER049
     C                     ELSE                                                               CER049
     C           @RTCD     IFNE '*NRF   '                                                     CER049
     C                     Z-ADD106       W0ERNB                                              CER049
     C                     MOVEL'CER049'  W0KEY                                               CER049
     C                     MOVEL'SCSARDPD'W0FILE                                              CER049
     C                     EXSR SRERR                                                         CER049
     C                     ENDIF                                                              CER049
     C                     ENDIF                                                              CER049
      *                                                                                       CER049
      ** Check if feature CFT158 is ON                                                        CFT158
     C                     MOVE 'N'       CFT158  1                                           CFT158
     C                     CALL 'AOSARDR0'                                                    CFT158
     C                     PARM *BLANKS   @RTCD                                               CFT158
     C                     PARM '*VERIFY' @OPTN                                               CFT158
     C                     PARM 'CFT158'  @SARD                                               CFT158
     C           SCSARD    PARM SCSARD    DSFDY                                               CFT158
      *                                                                                       CFT158
     C           @RTCD     IFEQ *BLANKS                                                       CFT158
     C                     MOVE 'Y'       CFT158                                              CFT158
      *                                                                                       CFT158
      ** Feature CFT158 is on, retrieve system values.                                        CFT158
      **                                                                                      CFT158
      ** --> Retrieve 'FTRetStatusOP'                                                         CFT158
     C                     MOVELOPRETS    WSVOP1 20                                           CFT158
      ** --> Retrieve 'FTRetStatusIP'                                                         CFT158
     C                     MOVELIPRETS    WSVOP2 20                                           CFT158
      ** --> Pass blanks to unused parameters.                                                CFT158
     C                     MOVE *BLANKS   WBLNK1 20                                           CFT158
     C                     MOVE *BLANKS   WBLNK2200                                           CFT158
      ** --> Initialise output                                                                CFT158
     C                     MOVE *BLANKS   WSVAL1200                                           CFT158
     C                     MOVE *BLANKS   WSVAL2200                                           CFT158
      *                                                                                       CFT158
     C                     CALL PGMA                                                          CFT158
     C                     PARM *BLANKS   @RTCD                                               CFT158
     C                     PARM           WSVOP1                                              CFT158
     C                     PARM           WSVAL1                                              CFT158
     C                     PARM           WSVOP2                                              CFT158
     C                     PARM           WSVAL2                                              CFT158
     C                     PARM           WBLNK1                                              CFT158
     C                     PARM           WBLNK2                                              CFT158
     C                     PARM           WBLNK1                                              CFT158
     C                     PARM           WBLNK2                                              CFT158
     C                     PARM           WBLNK1                                              CFT158
     C                     PARM           WBLNK2                                              CFT158
     C                     PARM           WBLNK1                                              CFT158
     C                     PARM           WBLNK2                                              CFT158
     C                     PARM           WBLNK1                                              CFT158
     C                     PARM           WBLNK2                                              CFT158
     C                     PARM           WBLNK1                                              CFT158
     C                     PARM           WBLNK2                                              CFT158
     C                     PARM           WBLNK1                                              CFT158
     C                     PARM           WBLNK2                                              CFT158
     C                     PARM           WBLNK1                                              CFT158
     C                     PARM           WBLNK2                                              CFT158
      *                                                                                       CFT158
      ** Load system value 'FTRetStatusOP' into OPAY subtype work array                       CFT158
     C           WSVAL1    IFNE *BLANKS                                                       CFT158
     C                     MOVEAWSVAL1    OPST                                                CFT158
     C                     ENDIF                                                              CFT158
      *                                                                                       CFT158
      ** Load system value 'FTRetStatusIP' into IPAY subtype work array                       CFT158
     C           WSVAL2    IFNE *BLANKS                                                       CFT158
     C                     MOVEAWSVAL2    IPST                                                CFT158
     C                     ENDIF                                                              CFT158
      *                                                                                       CFT158
     C                     ENDIF                                                              CFT158
      *                                                                                       CFT158
     C                     ENDSR
     C********************************************************************
     C* END OF INITIAL SUBROUTINE
     C********************************************************************
     C/EJECT
     C********************************************************************
     C* VALONE SR.
     C* TO VALIDATE ENTRIES FOR SCREEN ONE
     C*
     C           VALONE    BEGSR
     C*
     C* CLEAR ERROR CODES AND SET OFF INDICATORS
     C*
     C                     SETOF                     89
     C                     Z-ADD1         Z       30
     C                     MOVE *BLANK    ERCD
     C                     MOVEA'00000'   *IN,20
     C*
     C**   VALIDATE PAYMENT REFERENCE
     C**   CANNOT BE - BLANK
     C**             - NOT ON FILE
     C**             - ENTERED ON DIFFERENT DAY
     C**             - ALREADY FULLY AUTHORISE
     C**             - REGULAR PAYMENT
     C**             - 'LEVEL 2' INPUT HAS NOT BEEN DONE
     C**             - HAVE AN RECORD EXISTING ON WIP                                         241810
     C*
     C           PREF      IFEQ *BLANK                     B001
     C                     SETON                     2089
     C*********************MOVE ' 069'    ERCD,Z           MANDATORY      S01117
     C                     MOVE ' 003'    ERCD,Z           MANDATORY      S01117
     C                     ADD  1         Z
     C                     GOTO VLPVAL
     C                     END                             E001
     C*
     C                     SETOF                     8887
     C           PREF      CHAININPAYDDF             88
     C  N88                MOVE CHTP      IPCHTP  1                       004120
     C  N88      RECI      COMP 'D'                  8787
     C  N87                SETOF                     60    RECORD FOUND
     C/COPY WNCPYSRC,FT0060C032
     C*
     C   88
     COR 87                DO                              B001
     C                     SETOF                     88
     C           PREF      CHAINOTPAYDDF             88
     C  N88      RECI      COMP 'D'                  8787
     C  N87                SETON                     60    RECORD FOUND
     C                     MOVELODMT      SODMT                                             BUG15517
     C/COPY WNCPYSRC,FT0060C033
     C                     END                             E001
     C*
     C   88N87             DO                              B001
     C                     SETON                     2089
     C*********************MOVE ' 070'    ERCD,Z           MUST EXIST     S01117
     C                     MOVE ' 004'    ERCD,Z           MUST EXIST     S01117
     C                     ADD  1         Z
     C/COPY WNCPYSRC,FT0060C075
     C                     GOTO VLPVAL
     C                     END                             E001
     C*
     C   87                DO                              B001
     C                     SETON                     2089
     C*********************MOVE ' 071'    ERCD,Z           MUST BE LIVE   S01117
     C                     MOVE ' 005'    ERCD,Z           MUST BE LIVE   S01117
     C                     ADD  1         Z
     C                     GOTO VLPVAL
     C                     END                             E001
     C/COPY WNCPYSRC,FT0060C008
     C*
     C* STORE LAST CHANGE DATE TIME THEN RELEASE RECORDS
     C*
     C                     Z-ADDLCD       SCD     50
     C                     Z-ADDLCHT      SCT     60
     C                     MOVELTMST      STMST  26                                           242863
     C   60                EXCPTROTPAY
     C  N60                EXCPTRINPAY
      *                                                                   CFT014
      ** Access extension record of payment.                              CFT014
      *                                                                   CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
     C********** CFT009    ANDEQ'Y'                                                BUG23535 BUG23832
     C           CFT009    OREQ 'Y'                                                         BUG23832
      *                                                                   CFT014
     C           *IN60     IFEQ *ON                                       CFT014
      *                                                                   CFT014
     C           PREF      CHAINOTPAYXL2             80                   CFT014
      *                                                                   CFT014
     C           *IN80     IFEQ '1'                                       CFT014
     C           *IN80     OREQ '0'                                       CFT014
     C           OPRECI    ANDNE'D'                                       CFT014
     C                     Z-ADD061       W0ERNB                          CFT014
     C                     MOVELPREF      W0KEY                           CFT014
     C                     MOVEL'OTPAYXL2'W0FILE                          CFT014
     C                     EXSR SRERR                                     CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
      *                                                                   256589
     C                     MOVE *BLANKS   @RTCDE  7                       256589
     C                     MOVE 'FT'      @MODLE  2                       256589
     C                     MOVE PREF      @TREF  15                       256589
     C                     MOVE *BLANKS   @RTINF 80                       256589
     C                     CALL 'AOC8000'                                 256589
     C                     PARM           @RTCDE                          256589
     C                     PARM           @MODLE                          256589
     C                     PARM           @TREF                           256589
     C                     PARM           @RTINF                          256589
      *                                                                   256589
      *  If 'IN USE' then redisplay subfile with error message            256589
      *  for record lock                                                  256589
      *                                                                   256589
     C           @RTCDE    IFEQ '*IN USE'                                 256589
     C                     MOVE '600'     ERCD,Z                          256589
     C                     ADD  1         Z                               256589
     C                     SETON                     2089                 256589
     C                     GOTO VLPVAL                                    256589
     C                     END                                            256589
      *                                                                   CFT014
     C           PREF      CHAININPAYXL2             80                   CFT014
      *                                                                   CFT014
     C           *IN80     IFEQ '1'                                       CFT014
     C           *IN80     OREQ '0'                                       CFT014
     C           INRECI    ANDNE'D'                                       CFT014
     C                     Z-ADD062       W0ERNB                          CFT014
     C                     MOVELPREF      W0KEY                           CFT014
     C                     MOVEL'INPAYXL2'W0FILE                          CFT014
     C                     EXSR SRERR                                     CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   042167
      * If not linked via an enquiry function,                            042167
      * then CALL CL pgm to check if other users are accessing the same   042167
      * transaction reference.                                            042167
      *                                                                   042167
     C           XPREF     IFEQ *BLANKS                                   042167
      *                                                                   042167
     C                     MOVE *BLANKS   @RTCDE  7                       042167
     C                     MOVE 'FT'      @MODLE  2                       042167
     C                     MOVE PREF      @TREF  15                       042167
     C                     MOVE *BLANKS   @RTINF 80                       042167
     C                     CALL 'AOC8000'                                 042167
     C                     PARM           @RTCDE                          042167
     C                     PARM           @MODLE                          042167
     C                     PARM           @TREF                           042167
     C                     PARM           @RTINF                          042167
      *                                                                   042167
      *  If 'IN USE' then redisplay subfile with error message            042167
      *  for record lock                                                  042167
      *                                                                   042167
     C           @RTCDE    IFEQ '*IN USE'                                 042167
     C                     MOVE '600'     ERCD,Z                          042167
     C                     ADD  1         Z                               042167
     C                     SETON                     2089                 042167
     C                     GOTO VLPVAL                                    042167
     C                     END                                            042167
      *                                                                   042167
     C                     END                                            042167
     C*                                                                   S01117
     C           ORBR      CHAINPYCHGDB              80                   S01117
     C  N80      RECI      COMP 'D'                  8080                 S01117
     C*                                                                   S01117
     C   80                DO                              B001           S01117
     C           *LOCK     IN   DLDA                                      S01117
     C                     MOVE 'FT0060'  DBPGM                           S01117
     C                     MOVE 'PYCHGDB' DBFILE           ***************S01117
     C                     Z-ADD4         DBASE            * DB ERROR 04 *S01117
     C                     MOVEL'1'       DBKEY            ***************S01117
     C                     MOVE '*'       @RETC                           S01117
     C                     OUT  DLDA                                      S01117
     C                     SETON                     U7U8LR               S01117
     C                     DUMP                                           S01117
      *                                                                   042167
      *  Allocate dataarea to blanks                                      042167
      *                                                                   042167
     C                     EXSR DALLOC                                    042167
      *                                                                   042167
     C                     RETRN                                          S01117
     C                     END                             E001           S01117
     C*                                                                   S01117
     C* NOTE: TEST IF BYPASS (40 IS OFF) AND IF SO
     C*       BYPASS VALIDATION CHECKS
     C*
     C   40      AUIN      IFEQ 'Y'                        B001
     C/COPY WNCPYSRC,FT0060C076
     C********** AUP2      IFEQ *BLANKS                    B002                             BUG16175
     C**********           SETON                     2089                                   BUG16175
     C*********************MOVE ' 073'    ERCD,Z           ALREADY        S01117
     C**********           MOVE ' 006'    ERCD,Z           ALREADY        S01117            BUG16175
     C**********           ADD  1         Z                AUTHORISED                       BUG16175
     C**********           GOTO VLPVAL                                                      BUG16175
     C**********           ELSE                            X002                             BUG16175
     C                     SETON                     2089
     C*********************MOVE ' 400'    ERCD,Z           ALREADY        S01117
     C                     MOVE ' 007'    ERCD,Z           ALREADY        S01117
     C                     ADD  1         Z                AUTHORISED
     C                     GOTO VLPVAL
     C**********           END                             E002                             BUG16175
      *
     C                     END                             E001
      *                                                                   E32885
      ** Check that LEVEL1 & LEVEL2 input has been completed for          E32885
      ** Outgoing Payments.                                               E32885
      *                                                                   E32885
     C           *IN60     IFEQ '1'                                       E32885
      *                                                                   E32885
     C           LVL2      IFNE 'Y'                                       E32885
     C           LVL1      ORNE 'Y'                                       E32885
     C                     SETON                     2089                 E32885
     C*********************MOVE ' 067'    ERCD,Z                    E32885S01117
     C                     MOVE ' 002'    ERCD,Z                          S01117
     C                     ADD  1         Z                               E32885
     C                     END                                            E32885
      *                                                                   S01435
      ** When CSD015 enhancement is installed  and WELCO is equal to 'Y'                      CSD015
      *                                                                                       CSD015
     C           CSD015    IFEQ 'Y'                                                           CSD015
      *                                                                                       CSD015
     C           CSC011    IFEQ 'N'                                                           CSD015
     C           CSC011    OREQ 'Y'                                                           CSD015
     C           LIBR      ANDEQS1MAIN                                                        CSD015
      *                                                                                       CSD015
     C           WELCO     IFEQ 'Y'                                                           CSD015
     C                     MOVEL'OTPAYDD' KFUNT                                               CSD015
     C                     MOVELPREF      KIDEN                                               CSD015
     C                     MOVELBRCA      KBRCH                                               CSD015
      *                                                                                       CSD015
     C           KCWHT     CHAINSDCWHTL1             57                                       CSD015
      *                                                                                       CSD015
      ** If record found and under investigation, activate *IN46 to display on                CSD015
      ** the report, 'Item under review by Compliance Officer'                                CSD015
      *                                                                                       CSD015
     C           *IN57     IFEQ *OFF                                                          CSD015
     C           W3TREL    ANDNE'Y'                                                           CSD015
      *                                                                                       CSD015
      ** Display error code 500: Item under review by Compliance Officer                      CSD015
      *                                                                                       CSD015
     C                     MOVE *ON       *IN20                                               CSD015
     C                     MOVE *ON       *IN89                                               CSD015
     C                     MOVE ' 500'    ERCD,Z                                              CSD015
     C                     ADD  1         Z                                                   CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C                     ELSE                                           S01435
      *                                                                   S01435
      * Check that LEVEL1 & LEVEL2 input has been completed for           S01435
      * Incoming Payments.                                                S01435
      *                                                                   S01435
     C           INLVL1    IFNE 'Y'                                       S01435
     C           INLVL2    ORNE 'Y'                                       S01435
     C                     SETON                     2089                 S01435
     C                     MOVE ' 002'    ERCD,Z                          S01435
     C                     ADD  1         Z                               S01435
     C                     END                                            S01435
      *                                                                   E32885
      ** When CSD015 enhancement is installed  and WELCI is equal to 'Y'                      CSD015
      *                                                                                       CSD015
     C           CSD015    IFEQ 'Y'                                                           CSD015
      *                                                                                       CSD015
     C           CSC011    IFEQ 'N'                                                           CSD015
     C           CSC011    OREQ 'Y'                                                           CSD015
     C           LIBR      ANDEQS1MAIN                                                        CSD015
      *                                                                                       CSD015
     C           WELCI     IFEQ 'Y'                                                           CSD015
     C                     MOVEL'INPAYDD' KFUNT                                               CSD015
     C                     MOVELPREF      KIDEN                                               CSD015
     C                     MOVELBRCA      KBRCH                                               CSD015
      *                                                                                       CSD015
     C           KCWHT     CHAINSDCWHTL1             57                                       CSD015
      *                                                                                       CSD015
      ** If record found and under investigation, activate *IN46 to display on                CSD015
      ** the report, 'Item under review by Compliance Officer'                                CSD015
      *                                                                                       CSD015
     C           *IN57     IFEQ *OFF                                                          CSD015
     C           W3TREL    ANDNE'Y'                                                           CSD015
      *                                                                                       CSD015
      ** Display error code 500: Item under review by Compliance Officer                      CSD015
      *                                                                                       CSD015
     C                     MOVE *ON       *IN20                                               CSD015
     C                     MOVE *ON       *IN89                                               CSD015
     C                     MOVE ' 500'    ERCD,Z                                              CSD015
     C                     ADD  1         Z                                                   CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C                     END                                            E32885
     C*                                                                   S01117
     C** Validation of user for action codes,branches,and menu items.     S01117
     C** If multibranching is used.                                       S01117
     C*                                                                   S01117
     C           BGMBIN    IFEQ 'Y'                                       S01117
     C                     EXSR BBAUTH                                    S01117
     C*                                                                   S01117
     C** If originating branch validation is required.                    S01117
     C*                                                                   S01117
     C           BKOBUV    IFEQ 'Y'                                       S01117
     C                     EXSR OBAUTH                                    S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     END                                            S01117
     C*                                                                   S01117
      ** Check whether or not payment has a outstanding record on WIP                         241810
      *                                                                                       241810
     C                     EXSR CHKWIP                                                        241810
      *                                                                                       241810
     C**
     C** 40      PYTP      IFEQ 'RP'                       B001
     C**                   SETON                     2089
     C**                   MOVE ' 278'    ERCD,Z           REGULAR
     C**                   ADD  1         Z                PAYMENT
     C**                   END                             E001
     C*
     C**   VALIDATE SETTLE VALUE & SETTLE CURRENCY
     C*
     C           VLPVAL    TAG
     C   40      SYCY      IFEQ '   '                      B001
     C                     SETON                     2289
     C*********************MOVE ' 093'    ERCD,Z           NO SET CCY     S01117
     C                     MOVE ' 011'    ERCD,Z           NO SET CCY     S01117
     C                     ADD  1         Z
     C                     GOTO VLRVAL
     C                     END                             E001
     C*
     C**READ*TABLE*FILE*FOR SETTLE CURRENCY                               S01194
     C*********************MOVE *BLANK    KEY                             S01194
     C*********************MOVEL'20'      KEY                             S01194
     C***40****************MOVELSYCY      SCCY    4                       S01194
     C**N40****************MOVELSMCY      SCCY    4                       S01194
     C*********************MOVE '1'       SCCY                            S01194
     C*********************MOVE SCCY      KEY                             S01194
     C***********KEY*******CHAINTABTG10F             22                   S01194
     C**N22******RECI******COMP 'D'                  2222                 S01194
     C***22****************DO                              B001           S01194
     C*                                                                   S01194
     C** Call to access pgm for currency  details                         S01194
     C*                                                                   S01194
     C           *IN40     IFEQ '1'                                       S01194
     C                     MOVE SYCY      @CCY                            S01194
     C                     ELSE                                           S01194
     C                     MOVE SMCY      @CCY                            S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C                     CALL 'AOCURRR0'                                S01194
     C                     PARM *BLANKS   @RTCD                           S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM @CCY      @CCY                            S01194
     C           SDCURR    PARM SDCURR    DSSDY                           S01194
     C*                                                                   S01194
     C           @RTCD     COMP *BLANKS              2222                 S01194
     C           *IN22     IFEQ '1'                                       S01194
     C                     SETON                     89                   S01194
     C*********************MOVE ' 076'    ERCD,Z           CURRENCY NOT   S01117
     C                     MOVE ' 010'    ERCD,Z           CURRENCY NOT   S01117
     C                     ADD  1         Z                ON FILE
     C                     GOTO VLRVAL
     C                     END                             E001
     C*                                                                   S01194
     C** Execute Subroutine to move fields to old field names             S01194
     C*                                                                   S01194
     C                     EXSR AOCURR                                    S01194
     C*
     C/COPY WNCPYSRC,FT0060C077
     C   40      SVAL      IFNE *BLANKS                    B001
     C                     Z-ADDCDP       ZADEC
     C           13        SUB  CDP       ZADIG
     C                     MOVE *BLANK    ZFIELD
     C                     MOVE SVAL      ZFIELD           VALIDATE
     C                     EXSR ZALIGN                     SETTLE AMOUNT
     C*
     C   99                DO                              B002
     C                     SETON                     2189
     C*********************MOVE ' 074'    ERCD,Z           NOT NUMERIC    S01117
     C                     MOVE ' 008'    ERCD,Z           NOT NUMERIC    S01117
     C                     ADD  1         Z
     C                     END                             E002
     C*
     C                     MOVE ZFIELD    AMOUNT 130
     C*
     C  N99      AMOUNT    IFNE SMAM                       B002
     C                     SETON                     2189  ENTERED
     C*********************MOVE ' 075'    ERCD,Z           AMOUNT NOT =   S01117
     C                     MOVE ' 009'    ERCD,Z           AMOUNT NOT =   S01117
     C                     ADD  1         Z                SET AMOUNT
     C                     END                             E002
     C*
     C                     END                             E001
     C/COPY WNCPYSRC,FT0060C078
     C*
     C   40      SYCY      IFNE SMCY                       B001
     C                     SETON                     2289  ENTERED
     C*********************MOVE ' 076'    ERCD,Z           CURRENCY NOT   S01117
     C                     MOVE ' 010'    ERCD,Z           CURRENCY NOT   S01117
     C                     ADD  1         Z                = SET CCY
     C                     END                             E001
     C/COPY WNCPYSRC,HUT101_004                                                               HUT101
     C*
     C* CONVERT THRESHOLD TO SAME NUMBER OF DECIMAL PLACES AS CCY
     C* SET *IN30-33 DEPENDING ON PAY NUMBER OF DECIMAL PLACES
     C*
     C                     MOVEA'0000'    *IN,30
     C           30        ADD  CDP       Q
     C                     MOVE '1'       *IN,Q
     C*********************Z-ADDTHRH      BTHRH  140                      S01194
     C***********          Z-ADDBTAUDT    BTHRH  140                S01194177672
     C                     Z-ADDBTAUDT    BTHRH  160                      177672
     C*
     C           MDIN      IFEQ 0                          B001
     C                     MULT SPOT      BTHRH     H
     C                     ELSE                            X001
     C                     DIV  SPOT      BTHRH     H
     C                     END                             E001
     C*
     C   35                MULT 1000      BTHRH
     C   36                MULT 100       BTHRH
     C   37                MULT 10        BTHRH
     C   30                DIV  1000      BTHRH     H
     C   31                DIV  100       BTHRH     H
     C   32                DIV  10        BTHRH     H
     C/COPY WNCPYSRC,HUT101_005                                                               HUT101
     C           *LIKE     DEFN AUP1      U#AUP1                          059192
     C                     MOVELAUP1      U#AUP1                          059192
     C/COPY WNCPYSRC,FTH00220
     C**   VALIDATE PAYMENT VALUE & PAYMENT CURRENCY
     C*
     C           VLRVAL    TAG
     C  N40                GOTO VLEND
     C*
     C/COPY WNCPYSRC,FT0060C079
     C           SVAL      IFEQ *BLANK                     B001
     C           PVAL      ANDEQ*BLANK
     C                     SETON                     2389
     C*********************MOVE ' 077'    ERCD,Z           MANDATORY      S01117
     C                     MOVE ' 012'    ERCD,Z           MANDATORY      S01117
     C                     ADD  1         Z
     C                     END                             E001
     C/COPY WNCPYSRC,FT0060C080
     C*
     C           RCCY      IFEQ *BLANK                     B001
     C                     SETON                     2489
     C*********************MOVE ' 081'    ERCD,Z           MANDATORY      S01117
     C                     MOVE ' 016'    ERCD,Z           MANDATORY      S01117
     C                     ADD  1         Z
     C                     END                             E001
     C   23
     COR 24                GOTO VLEND
     C*
     C           SVAL      IFNE *BLANK                     B001
     C           PVAL      ANDNE*BLANK
     C                     SETON                     2389
     C*********************MOVE ' 078'    ERCD,Z           PROHIBITED     S01117
     C                     MOVE ' 013'    ERCD,Z           PROHIBITED     S01117
     C                     ADD  1         Z
     C                     GOTO VLEND
     C                     END                             E001
     C*
     C**READ*TABLE*FILE*FOR PAYMENT CURRENCY                              S01194
     C*********************MOVE *BLANK    KEY                             S01194
     C*********************MOVEL'20'      KEY                             S01194
     C*********************MOVELRCCY      SCCY    4                       S01194
     C*********************MOVE '1'       SCCY                            S01194
     C*********************MOVE SCCY      KEY                             S01194
     C***********KEY*******CHAINTABTG10F             24                   S01194
     C**N24******RECI******COMP 'D'                  2424                 S01194
     C***24****************DO                              B001           S01194
     C*                                                                   S01194
     C** Call to access pgm for currency  details                         S01194
     C*                                                                   S01194
     C                     CALL 'AOCURRR0'                                S01194
     C                     PARM *BLANKS   @RTCD                           S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM RCCY      @CCY    3                       S01194
     C           SDCURR    PARM SDCURR    DSSDY                           S01194
     C*                                                                   S01194
     C           @RTCD     COMP *BLANKS              2424                 S01194
     C           *IN24     IFEQ '1'
     C                     SETON                     89                   S01194
     C*********************MOVE ' 082'    ERCD,Z           CCY NOT ON     S01117
     C                     MOVE ' 017'    ERCD,Z           CCY NOT ON     S01117
     C                     ADD  1         Z                FILE
     C                     GOTO VLEND
     C                     END                                            S01194
     C*********************END                             E001           S01194
     C*                                                                   S01194
     C** Execute Subroutine to move fields to old field names             S01194
     C*                                                                   S01194
     C                     EXSR AOCURR                                    S01194
     C*
     C           PVAL      IFNE *BLANKS                    B001
     C                     Z-ADDCDP       ZADEC
     C           13        SUB  CDP       ZADIG
     C                     MOVE *BLANK    ZFIELD
     C                     MOVE PVAL      ZFIELD           VALIDATE
     C                     EXSR ZALIGN                     PAY AMOUNT
     C   99                DO                              B002
     C                     SETON                     2389
     C*********************MOVE ' 079'    ERCD,Z           NOT NUMERIC    S01117
     C                     MOVE ' 014'    ERCD,Z           NOT NUMERIC    S01117
     C                     ADD  1         Z
     C                     END                             E001
     C                     MOVE ZFIELD    AMOUNT 130
     C  N99      AMOUNT    IFNE PYAM                       B001
     C                     SETON                     2389  ENTERED
     C*********************MOVE ' 080'    ERCD,Z           NOT = PAY      S01117
     C                     MOVE ' 015'    ERCD,Z           NOT = PAY      S01117
     C                     ADD  1         Z                AMOUNT
     C                     END                             E002
     C                     END                             E001
     C*
     C           RCCY      IFNE PCCY                       B001
     C                     SETON                     2489  CURRENCY NOT
     C*********************MOVE ' 082'    ERCD,Z           = FILE         S01117
     C                     MOVE ' 017'    ERCD,Z           = FILE         S01117
     C                     ADD  1         Z                CURRENCY
     C                     END                             E001
     C           VLEND     TAG
     C                     SETOF                     12    VALUES DONE
     C                     SETON                     40
     C                     ENDSR
     C********************************************************************
     C* END OF VALIDATION SUBROUTINE
     C********************************************************************
     C/EJECT
     C********************************************************************
     C* AUTHOR SR.
     C* DISPLAY THE AUTHORISE SCREEN
     C* ALLOW ENTRY OF F3 TO GO BACK TO INITIAL SCREEN
     C* F9 TO AUTHORISE OR ENTER TO DISPLAY DETAILS
     C*
     C           AUTHOR    BEGSR
     C* LINE TO DEFINE F9
     C   08N08             SETON                     08
     C*                                                                   078509
     C/COPY WNCPYSRC,FTH00221
     C** Format Input User 1                                              078509
     C*                                                                   078509
     C                     MOVE INUSR1    IUSR1                           078509
     C*                                                                   078509
     C** Get name of Input User 1 from MUSER                              078509
     C*                                                                   078509
     C           IUSR1     CHAINMUSER                80                   078509
     C  N80      RECI      COMP 'D'                  8080                 078509
     C*                                                                   078509
     C**  If error occurred, display text "User not found" and            078509
     C**  stop authorisation                                              078509
     C*                                                                   078509
     C           *IN80     IFEQ '1'                                       078509
     C                     MOVELWM2510    USNM1                           078509
     C                     MOVE 'Y'       USERR                           078509
     C                     ELSE                                           078509
     C                     MOVE USER1     USNM1                           078509
     C                     END                                            078509
     C*                                                                   078509
     C           INUSR2    IFEQ *BLANKS                                   078509
     C                     MOVE *BLANKS   IUSR2                           078509
     C                     MOVE *BLANKS   USNM2                           078509
     C                     ELSE                                           078509
     C                     MOVE INUSR2    IUSR2                           078509
     C*                                                                   078509
     C** Check if Input User 1 and Input User 2 are the same              078509
     C*                                                                   078509
     C           INUSR1    IFEQ INUSR2                                    078509
     C                     MOVE USNM1     USNM2                           078509
     C                     ELSE                                           078509
     C*                                                                   078509
     C** Get name of Input User 2 from MUSER                              078509
     C*                                                                   078509
     C           IUSR2     CHAINMUSER                80                   078509
     C  N80      RECI      COMP 'D'                  8080                 078509
     C*                                                                   078509
     C**  If error occurred, display text "User not found" and            078509
     C**  stop authorisation                                              078509
     C*                                                                   078509
     C           *IN80     IFEQ '1'                                       078509
     C                     MOVELWM2510    USNM2                           078509
     C                     MOVE 'Y'       USERR                           078509
     C                     ELSE                                           078509
     C                     MOVE USER1     USNM2                           078509
     C                     END                                            078509
     C*                                                                   078509
     C                     END                                            078509
     C                     END                                            078509
     C* READ MUSER FOR NAMES IF NOT BLANK
     C           AUP1      IFEQ *BLANK                     B001
     C                     MOVE USRID     AUP1             1ST AUTHOR
     C                     ELSE                            X001
     C                     MOVE USRID     AUP2             2ND AUTHOR
     C                     END                             E001
     C* READ MUSER FOR NAME
     C                     MOVE AUP1      USRP
     C           USRP      CHAINMUSER                80
     C  N80      RECI      COMP 'D'                  8080
     C   80                DO                              B001
     C           *LOCK     IN   DLDA
     C                     MOVE 'FT0060'  DBPGM
     C                     MOVE 'MUSER'   DBFILE           ***************
     C                     Z-ADD5         DBASE            * DB ERROR 05 *
     C                     MOVELUSRP      DBKEY            ***************
     C                     MOVE '*'       @RETC
     C                     OUT  DLDA
     C                     SETON                     U7U8LR
     C                     DUMP
      *                                                                   042167
      *  Allocate dataarea to blanks                                      042167
      *                                                                   042167
     C                     EXSR DALLOC                                    042167
      *                                                                   042167
     C                     RETRN
     C                     END                             E001
     C* READ MUSER FOR SECOND NAME
     C                     MOVE USER1     NAME
     C           AUP2      IFNE *BLANK                     B001
     C                     MOVE AUP2      USRP
     C           USRP      CHAINMUSER                80
     C  N80      RECI      COMP 'D'                  8080
     C   80                DO                              B002
     C           *LOCK     IN   DLDA
     C                     MOVE 'FT0060'  DBPGM
     C                     MOVE 'MUSER'   DBFILE           ***************
     C                     Z-ADD6         DBASE            * DB ERROR 06 *
     C                     MOVELUSRP      DBKEY            ***************
     C                     MOVE '*'       @RETC
     C                     OUT  DLDA
     C                     SETON                     U7U8LR
     C                     DUMP
      *                                                                   042167
      *  Allocate dataarea to blanks                                      042167
      *                                                                   042167
     C                     EXSR DALLOC                                    042167
      *                                                                   042167
     C                     RETRN
     C                     END                             E002
     C                     MOVE USER1     NAME2
     C/COPY WNCPYSRC,FTH00222
     C                     ELSE                            X001
     C                     MOVE *BLANK    NAME2            NO 2ND USER
     C                     END                             E001
     C***********                                                  S01494 078509
     C***Format*Input*User*1***************************************S01494 078509
     C***********                                                  S01494 078509
     C***********          MOVE INUSR1    IUSR1                    S01494 078509
     C***********                                                  S01494 078509
     C***Get*name*of*Input*User*1*from*MUSER***********************S01494 078509
     C***********                                                  S01494 078509
     C***********IUSR1     CHAINMUSER                80            S01494 078509
     C**N80******RECI      COMP 'D'                  8080          S01494 078509
     C***80******          DO                                      S01494 S01494
     C************LOCK     IN   DLDA                               S01494 S01494
     C***********          MOVE 'FT0060'  DBPGM                    S01494 S01494
     C***********          MOVE 'MUSER'   DBFILE           ********S01494 S01494
     C***********          Z-ADD20        DBASE            * DBERR S01494 S01494
     C***********          MOVELIUSR1     DBKEY            ********S01494 S01494
     C***********          MOVE '*'       @RETC                    S01494 S01494
     C***********          OUT  DLDA                               S01494 S01494
     C***********          SETON                     U7U8LR        S01494 S01494
     C***********          DUMP                                    S01494 S01494
     C***********                                                  S01494 S01494
     C***Allocate*dataarea*to*blanks*******************************S01494 S01494
     C***********          EXSR DALLOC                             S01494 S01494
     C***********          RETRN                                   S01494 S01494
     C***********          END                                     S01494 S01494
     C***********                                                  S01494 078509
     C****If*error*occurred,*display*text*"User*not*found"*and*****S01494 078509
     C****stop*authorisation***************************************S01494 078509
     C***********                                                  S01494 078509
     C************IN80     IFEQ '1'                                S01494 078509
     C***********          MOVELWM2510    USNM1                    S01494 078509
     C***********          MOVE 'Y'       USERR                    S01494 078509
     C***********          ELSE                                    S01494 078509
     C***********          MOVE USER1     USNM1                    S01494 078509
     C***********          END                                     S01494 078509
     C***********                                                  S01494 078509
     C***********INUSR2    IFEQ *BLANKS                            S01494 078509
     C***********          MOVE *BLANKS   IUSR2                    S01494 078509
     C***********          MOVE *BLANKS   USNM2                    S01494 078509
     C***********          ELSE                                    S01494 078509
     C***********          MOVE INUSR2    IUSR2                    S01494 078509
     C***********                                                  S01494 078509
     C***Check*if*Input*User*1*and*Input*User*2*are*the*same*******S01494 078509
     C***********                                                  S01494 078509
     C***********INUSR1    IFEQ INUSR2                             S01494 078509
     C***********          MOVE USNM1     USNM2                    S01494 078509
     C***********          ELSE                                    S01494 078509
     C***********                                                  S01494 078509
     C***Get*name*of*Input*User*2*from*MUSER***********************S01494 078509
     C***********                                                  S01494 078509
     C***********IUSR2     CHAINMUSER                80            S01494 078509
     C**N80******RECI      COMP 'D'                  8080          S01494 078509
     C***80******          DO                                      S01494 S01494
     C************LOCK     IN   DLDA                               S01494 S01494
     C***********          MOVE 'FT0060'  DBPGM                    S01494 S01494
     C***********          MOVE 'MUSER'   DBFILE           ********S01494 S01494
     C***********          Z-ADD21        DBASE            * DBERR S01494 S01494
     C***********          MOVELIUSR2     DBKEY            ********S01494 S01494
     C***********          MOVE '*'       @RETC                    S01494 S01494
     C***********          OUT  DLDA                               S01494 S01494
     C***********          SETON                     U7U8LR        S01494 S01494
     C***********          DUMP                                    S01494 S01494
     C***********                                                  S01494 S01494
     C***Allocate*dataarea*to*blanks*******************************S01494 S01494
     C***********          EXSR DALLOC                             S01494 S01494
     C***********          RETRN                                   S01494 S01494
     C***********          END                                     S01494 S01494
     C***********                                                  S01494 078509
     C****If*error*occurred,*display*text*"User*not*found"*and*****S01494 078509
     C****stop*authorisation***************************************S01494 078509
     C***********                                                  S01494 078509
     C************IN80     IFEQ '1'                                S01494 078509
     C***********          MOVELWM2510    USNM2                    S01494 078509
     C***********          MOVE 'Y'       USERR                    S01494 078509
     C***********          ELSE                                    S01494 078509
     C***********          MOVE USER1     USNM2                    S01494 078509
     C***********          END                                     S01494 078509
     C***********                                                  S01494 078509
     C***********          END                                     S01494 078509
     C***********          END                                     S01494 078509
     C*
     C** SETOF INDICATOR TO SHOW IF ALL SET DETAILS HAVE BEEN DISPLAYED
     C*
     C                     SETOF                     70
     C/COPY WNCPYSRC,FT0060C034
     C*
     C* DO LOOP UNTIL F3 OR F5 OR F7 IF VALID
     C           *IN01     DOUEQ'1'                        B001
     C           *IN05     OREQ '1'
     C           *IN07     OREQ '1'
      *                                                                   059192
      * If user is blank then check to see if two authorisations          059192
      * are needed, if so send message.                                   059192
      *                                                                   059192
      * Check threshold to be less than or equal to Settle amount         059192
     C/COPY WNCPYSRC,HUT101_006                                                               HUT101
      *                                                                   059192
     C           U#AUP1    IFEQ *BLANK                     B002           059192
      *                                                                   059192
     C           SMAM      ANDGEBTHRH                      B003           059192
     C                     MOVEL'FTW0003' FTMSID                          059192
     C                     MOVEL'FTUSRMSG'FTMSGF                          059192
     C                     EXSR FTSNMS                                    059192
     C/COPY WNCPYSRC,FTH00223
     C                     END                             E003           059192
      *                                                                   059192
     C/COPY WNCPYSRC,FT0060C099
     C** To move the time to 'time' on display file                       S01194
     C                     TIME           TIME                            S01194
      *                                                                   059192
      * Initialise no update indicator to allow update                    059192
      *                                                                   059192
     C                     MOVEL*BLANKS   FTNOUP                          059192
     C/COPY WNCPYSRC,FT0060C022
      *                                                                   059192
      * Display message subfile                                           059192
      *                                                                   059192
     C**********           MOVEL'1'       *IN56                                       059192 247142A
     C/COPY WNCPYSRC,FT0060C081
     C**********           WRITE#MSGCTL                                               059192 247142A
      *                                                                   059192
     C/COPY WNCPYSRC,FT0060C108
     C                     WRITEFT0060F2
     C                     MOVEL'1'       *IN56                                              247142A
     C                     WRITE#MSGCTL                                                      247142A
     C           AURED     TAG                             ** TAG AURED
     C                     READ FT0060F2                 80
     C           *IN05     IFEQ '1'                                                           257603
     C           *IN70     ANDEQ'1'                                                           257603
     C                     GOTO AURED                                                         257603
     C                     ENDIF                                                              257603
      *                                                                   059192
      * Clear message subfile                                             059192
      *                                                                   059192
     C                     CALL 'Y2CLMSC'                                 059192
     C                     PARM ##PGM     FTPGMQ                          059192
     C                     PARM '*SAME'   FTPGRL                          059192
     C/COPY WNCPYSRC,FT0060C082
      *                                                                   059192
      * Reset message sent flag                                           059192
      *                                                                   059192
     C                     MOVEL'N'       FTMSGS                          059192
     C                     MOVEL*BLANKS   FTWARN                          059192
      *                                                                   059192
     C                     SETOF                     252689
     C**                                                                  S01199
     C** 11                DO                              B002           S01199
     C**                   EXSR HELP                                      S01199
     C**                   GOTO AURED                                     S01199
     C**                   END                             E002           S01199
      *                                                                   CAC001
      **  If F19 is pressed and Analytical Accounting is installed,       CAC001
      **  setup data to be passed to window manager WN0010                CAC001
      *                                                                   CAC001
     C           BGWDPR    IFEQ 'Y'                        B002           CAC001
      *                                                                   CAC001
     C           *INKT     IFEQ *ON                        B003           CAC001
     C           BGN0ST    ANDEQ'Y'                                       CAC001
     C                     MOVE 'KT'      KEY                             CAC001
     C                     MOVE 'E'       ACTN                            CAC001
     C                     MOVE 'E'       WACTN                           CAC001
      *                                                                   CAC001
     C                     SELEC                           B004           CAC001
      *                                                                   CAC001
      **  Incoming Payments                                               CAC001
      *                                                                   CAC001
     C           *IN60     WHEQ '0'                                       CAC001
     C                     MOVE 'P'       WPSIN                           CAC001
      *                                                                   CAC001
      **  Outgoing Payments                                               CAC001
      *                                                                   CAC001
     C           *IN60     WHEQ '1'                                       CAC001
     C                     MOVE 'S'       WPSIN                           CAC001
      *                                                                   CAC001
     C                     ENDSL                           E004           CAC001
      *                                                                   CAC001
      **  Call window manager WN0010                                      CAC001
      *                                                                   CAC001
     C           ULX043    IFEQ 'Y'                                                           CER001
     C                     MOVE PREF      PREFX                                               CER001
     C                     CALL 'FT0060A'                                                     CER001
     C                     PARM           ACTION  1                                           CER001
     C                     PARM           PDATA                                               CER001
     C                     PARM           #RTRN   7                                           CER001
     C                     PARM           SPARE 256                                           CER001
      *                                                                                       CER001
      ** F3 has been pressed                                                                  CER001
      *                                                                                       CER001
     C           #RTRN     IFEQ 'Y2U9999'                                                     CER001
     C                     MOVE *ON       *INLR                                               CER001
     C                     MOVE '1'       @RETC                                               CER001
      *                                                                                       CER001
      ** Allocate data area to blanks                                                         CER001
      *                                                                                       CER001
     C                     EXSR DALLOC                                                        CER001
     C                     RETRN                                                              CER001
     C                     ELSE                                                               CER001
      *                                                                                       CER001
      ** F12 has been pressed                                                                 CER001
      *                                                                                       CER001
     C           #RTRN     IFEQ 'USR0790'                                                     CER001
     C                     MOVE '1'       *IN02                                               CER001
     C                     MOVEL'Y'       FTNOUP                                              CER001
     C                     ENDIF                                                              CER001
     C                     ENDIF                                                              CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
     C                     CALL 'WN0010'                                  CAC001
     C                     PARM           ##PGM  10                       CAC001
     C                     PARM           KEY     2                       CAC001
     C                     PARM           ACTN    1                       CAC001
     C                     PARM           DATA                            CAC001
     C                     PARM *BLANK    #RTRN   7                       CAC001
     C                     PARM           SPARE 256                       CAC001
      *                                                                   CAC001
      **  Check return code                                               CAC001
      *                                                                   CAC001
     C           #RTRN     IFEQ 'Y2U9999'                  B004           CAC001
     C                     MOVE *ON       *IN01            F3 Requested   CAC001
     C                     ELSE                                           CAC001
     C           #RTRN     IFNE *BLANK                     B005           CAC001
     C                     CALL 'SNDERMSG'                                CAC001
     C                     PARM 'FT0060'  ZAPGM  10        Program queue  CAC001
     C                     PARM           ZAPGRL  5        Rel queue      CAC001
     C                     PARM #RTRN     ZAMSID  7        Msg Id.        CAC001
     C                     PARM 'WNMSGF'  ZAMSGF 10        Msg file.      CAC001
     C                     PARM           ZAMSDA132        Message data.  CAC001
     C                     PARM           ZAMSTP  7        Message type.  CAC001
      *                                                                   CAC001
      **  Clear all fields                                                CAC001
      *                                                                   CAC001
     C                     MOVEL*BLANK    ZAPGM            Program queue  CAC001
     C                     MOVEL*BLANK    ZAPGRL           Rel queue      CAC001
     C                     MOVEL*BLANK    ZAMSID           Message Id.    CAC001
     C                     MOVEL*BLANK    ZAMSGF           Message file.  CAC001
     C                     MOVEL*BLANK    ZAMSDA           Message data.  CAC001
     C                     MOVEL*BLANK    ZAMSTP           Message type.  CAC001
     C                     ENDIF                           E005           CAC001
     C                     ENDIF                           E004           CAC001
     C*                                                                   CAC001
     C                     ENDIF                           E003           CAC001
     C/COPY WNCPYSRC,FT0060C043
     C                     ENDIF                           E002           CAC001
     C*                                                                   CAC001
     C/COPY WNCPYSRC,FT0060C005
     C         08          DO                              B002
     C/COPY WNCPYSRC,FT0060C006
     C**   VALIDATE IF ALLOWED TO AUTHORISE  - F9 -
     C**   LAST USER RECORD READ IS RELEVENT
     C                     Z-ADD1         Z
     C                     MOVEA*BLANK    ERCD
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0060CCP4                                           S01408
     C*                                                                   S01408
     C*
     C* 'BNC1' + 'ORC1' ARE BOTH MANDATORY ENTRIES ON LEVEL 2 INPUT
     C*  OF OTPAY AND INPAY RESPECTIVELY. IF THEY ARE BLANK THEN
     C*  THERE HAS BEEN NO LEVEL 2 INPUT.
     C*
     C           *IN60     IFEQ '1'                        OTPAY REC
     C           BENCUS    IFEQ *BLANKS
     C                     SETON                     2089
     C*********************MOVE ' 340'    ERCD,Z                          S01117
     C                     MOVE ' 022'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     END
     C/COPY WNCPYSRC,FT0060C068
      *
      **  Check that system-generated payments have had details
      **   completed - i.e. a credit party must have been entered, as
      **   well as the payment subtype and settlement type.
      *
     C           DSTT      IFNE 'F'
     C           DSTT      ANDNE'R'
     C           DSTT      ANDNE'G'
     C***********SNCO      ANDEQ0                                                             CSD027
     C           SNCO      ANDEQ*BLANKS                                                       CSD027
     C/COPY WNCPYSRC,FT0060C060
     C           PYST      OREQ *BLANKS
     C           STMT      OREQ 0
     C                     SETON                     2089
     C*********************MOVE ' 415'    ERCD,Z                          S01117
     C                     MOVE ' 023'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     END
     C/COPY WNCPYSRC,FT0060C009
      *
     C                     ELSE                            INPAY REC
      *                                                                   S01435
      * Allow blanks in Ordering Customer fields if Incoming Payment      S01435
      * record has been created from incoming swift message:              S01435
      * MT200, MT201, MT202, MT203 or MT205.                              S01435
      *                                                                   S01435
     C           INMTPY    IFNE '200'                                     S01435
     C           INMTPY    ANDNE'201'                                     S01435
     C           INMTPY    ANDNE'202'                                     S01435
     C           INMTPY    ANDNE'203'                                     S01435
     C           INMTPY    ANDNE'205'                                     S01435
     C           INMTPY    ANDNE'B22'                                     S01435
      *                                                                   S01435
     C           ORDCUS    IFEQ *BLANKS
     C                     SETON                     2089
     C*********************MOVE ' 340'    ERCD,Z                          S01117
     C                     MOVE ' 022'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     END
      *                                                                   S01435
     C                     END                                            S01435
     C                     END
     C           PAUT      IFNE 'Y'                        B003
     C*********************MOVE ' 143'    ERCD,Z           NOT ALLOWED    S01117
     C                     MOVE ' 018'    ERCD,Z           NOT ALLOWED    S01117
     C                     ADD  1         Z
     C           AUP2      IFEQ *BLANK                     B004
     C                     SETON                     2589
     C                     ELSE                            X004
     C                     SETON                     2689
     C                     END                             E004
     C                     END                             E003
     C* CHECK IF 1ST USER NOT EQUAL 2ND USER
     C           AUP1      IFEQ AUP2                       B003
     C                     SETON                     2689
     C*********************MOVE ' 162'    ERCD,Z           1ST = 2ND      S01117
     C                     MOVE ' 019'    ERCD,Z           1ST = 2ND      S01117
     C                     ADD  1         Z
     C                     END                             E003
     C* CHECK IF 1ST USER NOT EQUAL TO INPUT USER
     C           AUP1      IFEQ INUSR1                     B003
     C           AUP1      OREQ INUSR2
     C                     SETON                     2589
     C*********************MOVE ' 409'    ERCD,Z                          S01117
     C                     MOVE ' 021'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     END                             E003
     C*
     C* CHECK IF 2ND USER NOT EQUAL TO INPUT USER
     C           AUP2      IFNE *BLANKS                    B003
     C           AUP2      IFEQ INUSR1                     B004
     C           AUP2      OREQ INUSR2
     C                     SETON                     2689
     C*********************MOVE ' 409'    ERCD,Z                          S01117
     C                     MOVE ' 021'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C/COPY WNCPYSRC,FTH00224
     C                     END                             E004
     C                     END                             E003
     C*
     C** CHECK IF ALL DETAILS HAVE BEEN DISPLAYED FOR THIS PAYMENT
     C*
     C  N70                DO                              B003
     C                     SETON                     89
     C*********************MOVE ' 279'    ERCD,Z                          S01117
     C                     MOVE ' 020'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     END                             E003
     C/COPY WNCPYSRC,FT0060C027
     C*
     C* IF NOT ERRORS UPDATE FILE
     C*                                                                   S01494
     C** If user not found, stop authorisation and go to initial screen   S01494
     C*                                                                   S01494
     C           USERR     IFNE 'Y'                                       S01494
     C*                                                                   S01494
     C           FTNOUP    IFEQ *BLANKS                                   059192
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0060CCP5                                           S01408
     C*                                                                   S01408
     C**********  N89                EXSR FILEUP                                            MD043792
     C  N89N45             EXSR FILEUP                                                      MD043792
      *                                                                                       207525
      ** Initialise Notified Delivery and Instructed Amount fields                            207525
      *                                                                                       207525
     C**********           MOVE *BLANKS   SPDAM                                      207525 MD043792
     C**********           MOVE *BLANKS   SNDAM                                      207525 MD043792
     C  N45                MOVE *BLANKS   SPDAM                                             MD043792
     C  N45                MOVE *BLANKS   SNDAM                                             MD043792
     C/COPY WNCPYSRC,FT0060C010
     C                     END                                            059192
     C*                                                                   S01494
     C                     ELSE                                           S01494
     C/COPY WNCPYSRC,FT0060C083
     C                     MOVE '1'       *IN05                           S01494
     C                     MOVE ' '       USERR   1                       S01494
     C/COPY WNCPYSRC,FT0060C084
     C                     END                                            S01494
     C                     END                             E002
     C**N01N05N08                                                         CAC001
     C***ANN07             DO                              B002           CAC001
     C           *IN01     IFEQ '0'                        B002           CAC001
     C           *IN05     ANDEQ'0'                                       CAC001
     C           *IN08     ANDEQ'0'                                       CAC001
     C           *IN07     ANDEQ'0'                                       CAC001
     C           *INKT     ANDEQ'0'                                       CAC001
     C* IF ENTER HAS BEEN PRESSED DISPLAY DETAILS
     C                     EXSR DSPONE
     C/COPY WNCPYSRC,FT0060C023
     C                     SETOF                     01
     C/COPY WNCPYSRC,FT0060C058
     C                     END                             E002
     C                     END                             E001
     C* SETUP RETURN CODE
     C   01                MOVE '1'       @RETC
     C   05N08             MOVE '5'       @RETC
     C           *IN08     IFNE '1'                                       E29970
     C           *IN07     ANDEQ'1'                                       E29970
     C                     MOVE '7'       @RETC                           E29970
     C                     END                                            E29970
     C                     ENDSR
     C********************************************************************
     C* END OF AUTHORISATION SUBROUTINE
     C********************************************************************
     C/EJECT
     C********************************************************************
     C* DSPONE SR.
     C* DISPLAYS SCREEN 1 OF ENQUIRY THEN PERFORMS DSPTWO
     C*
     C           DSPONE    BEGSR
     C* DO LOOP UNTIL F3 PRESSED
     C           *IN01     DOUEQ'1'                        B001
     C           *IN02     OREQ '1'                                                           257603
     C  N12                EXSR VALUES
     C/COPY WNCPYSRC,FTH00072
     C                     MOVE PREF      IPREF
     C/COPY WNCPYSRC,FT0060C002
     C                     Z-ADDSTMT      STMTF3  20                      E23343
     C/COPY WNCPYSRC,FT0060C003
      *                                                                                       CFT123
      ** If Outgoing Payment being processed                                                  CFT123
      *                                                                                       CFT123
     C           *IN60     IFEQ '1'                                                           CFT123
      *                                                                                       CFT123
      ** Call FT0061 to check if BIC Code entered and to format fields                        CFT123
      ** Destination                                                                          CFT123
      *                                                                                       CFT123
     C           DST1      IFNE *BLANKS                                                       CFT123
     C           DST3      ANDEQ*BLANKS                                                       CFT123
      *                                                                                       CFT123
     C                     CALL 'FT0061'                                                      CFT123
     C                     PARM DST1      UMINP1                                              CFT123
     C                     PARM DST2      UMINP2                                              CFT123
     C           SDST1     PARM SDST1     UMDSP1                                              CFT123
     C           SDST2     PARM SDST2     UMDSP2                                              CFT123
     C           SDST3     PARM SDST3     UMDSP3                                              CFT123
     C           SDST4     PARM SDST4     UMDSP4                                              CFT123
     C                     PARM *BLANKS   UMDSP5                                              CFT123
     C                     PARM 3         UMFLDN                                              CFT123
      *                                                                                       CFT123
     C                     ENDIF                                                              CFT123
      *                                                                                       CFT123
      ** Ordering Customer                                                                    CFT123
      *                                                                                       CFT123
     C           ORC1      IFNE *BLANKS                                                       CFT123
     C           ORC3      ANDEQ*BLANKS                                                       CFT123
      *                                                                                       CFT123
     C                     CALL 'FT0061'                                                      CFT123
     C                     PARM ORC1      UMINP1                                              CFT123
     C                     PARM ORC2      UMINP2                                              CFT123
     C           SORC1     PARM SORC1     UMDSP1                                              CFT123
     C           SORC2     PARM SORC2     UMDSP2                                              CFT123
     C           SORC3     PARM SORC3     UMDSP3                                              CFT123
     C           SORC4     PARM SORC4     UMDSP4                                              CFT123
     C                     PARM *BLANKS   UMDSP5                                              CFT123
     C                     PARM 3         UMFLDN                                              CFT123
      *                                                                                       CFT123
     C                     ENDIF                                                              CFT123
      *                                                                                       CFT123
     C                     ENDIF                                                              CFT123
      *                                                                                       CFT123
     C** To move the time to 'time' on display file                       S01117
     C                     TIME           TIME                            S01117
     C*                                                                   S01117
     C/COPY WNCPYSRC,FT0060C020
      *                                                                   059192
      * Initialise no update indicator to allow update                    059192
      *                                                                   059192
     C                     MOVEL*BLANKS   FTNOUP                          059192
      *                                                                   CFT003
     C/COPY WNCPYSRC,FT0060C054
     C********** CFT003    IFEQ *BLANKS                                               CFT003 247142A
     C********** CFT003    OREQ 'CFT003'                                              CFT003 247142A
     C                     EXSR SRBAUT                                    CFT003
     C**********           ENDIF                                                      CFT003 247142A
      *                                                                   CFT003
     C           CRE008    IFEQ 'Y'                                                           CRE008
     C                     EXSR SRODLC                                                        CRE008
     C                     ENDIF                                                              CRE008
      *                                                                                       CRE008
     C/COPY WNCPYSRC,FT0060C021
      *                                                                   059192
      * Display message subfile                                           059192
      *                                                                   059192
     C**********           MOVEL'1'       *IN56                                       059192 247142A
     C/COPY WNCPYSRC,FT0060C085
     C**********           WRITE#MSGCTL                                               059192 247142A
      *                                                                   059192
     C/COPY WNCPYSRC,FT0060C107
     C***60*****           EXFMTFT0060F3                                                     247142A
     C**N60*****           EXFMTFT0060F6                                                     247142A
     C           *IN60     IFEQ '1'                                                          247142A
     C                     WRITEFT0060F3                                                     247142A
     C                     ELSE                                                              247142A
     C                     WRITEFT0060F6                                                     247142A
     C                     ENDIF                                                             247142A
     C                     MOVEL'1'       *IN56                                              247142A
     C                     WRITE#MSGCTL                                                      247142A
     C           *IN60     IFEQ '1'                                                          247142A
     C                     READ FT0060F3                 80                                  247142A
     C                     ELSE                                                              247142A
     C                     READ FT0060F6                 80                                  247142A
     C                     ENDIF                                                             247142A
     C           *IN05     IFEQ '1'                                                           257603
     C                     MOVE '0'       *IN05                                               257603
     C                     MOVE '1'       *IN02                                               257603
     C                     ENDIF                                                              257603
     C*                                                                   S01408
     C** Core hook for externalisation.                                   S01408
     C/COPY WNCPYSRC,FT0060CL1W                                           S01408
     C*                                                                   S01408
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0060CADU                                           S01408
      *                                                                                       CFT123
      ** If Outgoing Payment being processed                                                  CFT123
      *                                                                                       CFT123
     C           *IN60     IFEQ '1'                                                           CFT123
      *                                                                                       CFT123
      ** Call FT0061 to check if BIC Code entered and to format fields                        CFT123
      ** Receiver's Correspondent                                                             CFT123
      *                                                                                       CFT123
     C           RCO1      IFNE *BLANKS                                                       CFT123
     C           RCO3      ANDEQ*BLANKS                                                       CFT123
      *                                                                                       CFT123
     C                     CALL 'FT0061'                                                      CFT123
     C                     PARM RCO1      UMINP1 35                                           CFT123
     C                     PARM RCO2      UMINP2 35                                           CFT123
     C           SRCO1     PARM SRCO1     UMDSP1 35                                           CFT123
     C           SRCO2     PARM SRCO2     UMDSP2 35                                           CFT123
     C           SRCO3     PARM SRCO3     UMDSP3 35                                           CFT123
     C           SRCO4     PARM SRCO4     UMDSP4 35                                           CFT123
     C           SRCO5     PARM SRCO5     UMDSP5 35                                           CFT123
     C                     PARM 4         UMFLDN  10                                          CFT123
      *                                                                                       CFT123
     C                     ENDIF                                                              CFT123
      *                                                                                       CFT123
      ** Account with Bank                                                                    CFT123
      *                                                                                       CFT123
     C           ACB1      IFNE *BLANKS                                                       CFT123
     C           ACB3      ANDEQ*BLANKS                                                       CFT123
      *                                                                                       CFT123
     C                     CALL 'FT0061'                                                      CFT123
     C                     PARM ACB1      UMINP1                                              CFT123
     C                     PARM ACB2      UMINP2                                              CFT123
     C           SACB1     PARM SACB1     UMDSP1                                              CFT123
     C           SACB2     PARM SACB2     UMDSP2                                              CFT123
     C           SACB3     PARM SACB3     UMDSP3                                              CFT123
     C           SACB4     PARM SACB4     UMDSP4                                              CFT123
     C           SACB5     PARM SACB5     UMDSP5                                              CFT123
     C                     PARM 4         UMFLDN                                              CFT123
      *                                                                                       CFT123
     C                     ENDIF                                                              CFT123
      *                                                                                       CFT123
      ** Beneficiary                                                                          CFT123
      *                                                                                       CFT123
     C           BNC1      IFNE *BLANKS                                                       CFT123
     C           BNC3      ANDEQ*BLANKS                                                       CFT123
      *                                                                                       CFT123
     C                     CALL 'FT0061'                                                      CFT123
     C                     PARM BNC1      UMINP1                                              CFT123
     C                     PARM BNC2      UMINP2                                              CFT123
     C           SBNC1     PARM SBNC1     UMDSP1 35                                           CFT123
     C           SBNC2     PARM SBNC2     UMDSP2 35                                           CFT123
     C           SBNC3     PARM SBNC3     UMDSP3 35                                           CFT123
     C           SBNC4     PARM SBNC4     UMDSP4 35                                           CFT123
     C           SBNC5     PARM SBNC5     UMDSP5 35                                           CFT123
     C                     PARM 4         UMFLDN  10                                          CFT123
      *                                                                                       CFT123
     C                     ENDIF                                                              CFT123
      *                                                                                       CFT123
      ** Intermediary Bank                                                                    CFT123
      *                                                                                       CFT123
     C           INB1      IFNE *BLANKS                                                       CFT123
     C           INB3      ANDEQ*BLANKS                                                       CFT123
      *                                                                                       CFT123
     C                     CALL 'FT0061'                                                      CFT123
     C                     PARM INB1      UMINP1                                              CFT123
     C                     PARM INB2      UMINP2                                              CFT123
     C           SINB1     PARM SINB1     UMDSP1                                              CFT123
     C           SINB2     PARM SINB2     UMDSP2                                              CFT123
     C           SINB3     PARM SINB3     UMDSP3                                              CFT123
     C           SINB4     PARM SINB4     UMDSP4                                              CFT123
     C           SINB5     PARM SINB5     UMDSP5                                              CFT123
     C                     PARM 4         UMFLDN                                              CFT123
      *                                                                                       CFT123
     C                     ENDIF                                                              CFT123
      *                                                                                       CFT123
     C                     ENDIF                                                              CFT123
     C*                                                                   S01408
      *                                                                   059192
      * Clear message subfile                                             059192
      *                                                                   059192
     C                     CALL 'Y2CLMSC'                                 059192
     C                     PARM ##PGM     FTPGMQ                          059192
     C                     PARM '*SAME'   FTPGRL                          059192
     C/COPY WNCPYSRC,FT0060C044
      *                                                                   059192
      * Reset message sent flag                                           059192
      *                                                                   059192
     C                     MOVEL'N'       FTMSGS                          059192
     C                     MOVEL*BLANKS   FTWARN                          059192
     C/COPY WNCPYSRC,FT0060C037
      *                                                                   059192
     C* IF ENTER PRESSED DISPLAY SCREEN TWO
     C           OERROR    IFNE 'Y'                                                           216511
     C**N01*****           EXSR DSPTWO                                                        257603
     C  N01N02             EXSR DSPTWO                                                        257603
     C                     ENDIF                                                              216511
     C*                                                                   S01408
     C** Core hook for externalisation.                                   S01408
     C/COPY WNCPYSRC,FT0060CL1E                                           S01408
     C*                                                                   S01408
     C                     END                             E001
     C   02                SETOF                     02                                       257603
     C                     ENDSR
     C********************************************************************
     C* END OF DISPLAY SCREEN ONE SUBROUTINE
     C********************************************************************
     C/EJECT
     C********************************************************************
     C* VALUES SR.
     C* SETUP DISPLAY FIELDS
     C*
     C           VALUES    BEGSR
     C                     SETON                     12
     C* MOVE EDITED DATES TO UNEDITED FIELDS
     C                     Z-ADDSLDTD1    SDAT    60
     C                     Z-ADDPVDTD1    PYDT    60
     C*********************MOVE *BLANK    KEY                             S01194
     C*********************MOVEL'20'      KEY                             S01194
     C*********************MOVELSMCY      SCCY    4                       S01194
     C*********************MOVE '1'       SCCY                            S01194
     C*********************MOVE SCCY      KEY                             S01194
     C***********KEY*******CHAINTABTG10F             80                   S01194
     C**N80******RECI******COMP 'D'                  8080                 S01194
     C***80****************DO                              B001           S01194
     C************LOCK*****IN   DLDA                                      S01194
     C*********************MOVE 'FT0060'  DBPGM                           S01194
     C*********************MOVE 'TABLE'   DBFILE           ***************S01194
     C*********************Z-ADD7         DBASE            * DB ERROR 07 *S01194
     C*********************MOVELKEY       DBKEY            ***************S01194
     C*********************MOVE '*'       @RETC                           S01194
     C*********************OUT  DLDA                                      S01194
     C*********************SETON                     U7U8LR               S01194
     C*********************DUMP                                           S01194
     C*********************RETRN                                          S01194
     C*********************END                             E001           S01194
     C*                                                                   S01194
     C** Call to currency codes access program                            S01194
     C*                                                                   S01194
     C                     CALL 'AOCURRR0'                                S01194
     C                     PARM '*DBERR ' @RTCD                           S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM SMCY      @CCY                            S01194
     C           SDCURR    PARM SDCURR    DSSDY                           S01194
     C*                                                                   S01194
     C** Execute Subroutine to move fields to old field names             S01194
     C*                                                                   S01194
     C                     EXSR AOCURR                                    S01194
     C*                                                                   S01194
     C                     MOVE CDP       PCDP    10
     C                     MOVE *BLANK    DIG1
     C                     Z-ADDSMAM      DIG1N
     C                     EXSR EDIT
     C                     MOVEADIG2      SMAMA
     C*********************MOVE *BLANK    KEY                             S01194
     C*********************MOVEL'20'      KEY                             S01194
     C*********************MOVELPCCY      SCCY    4                       S01194
     C*********************MOVE '1'       SCCY                            S01194
     C*********************MOVE SCCY      KEY                             S01194
     C***********KEY*******CHAINTABTG10F             80                   S01194
     C**N80******RECI******COMP 'D'                  8080                 S01194
     C***80****************DO                              B001           S01194
     C************LOCK*****IN   DLDA                                      S01194
     C*********************MOVE 'FT0060'  DBPGM                           S01194
     C*********************MOVE 'TABLE'   DBFILE           ***************S01194
     C*********************Z-ADD8         DBASE            * DB ERROR 08 *S01194
     C*********************MOVELKEY       DBKEY            ***************S01194
     C*********************MOVE '*'       @RETC                           S01194
     C*********************OUT  DLDA                                      S01194
     C*********************SETON                     U7U8LR               S01194
     C*********************DUMP                                           S01194
     C*********************RETRN                                          S01194
     C*********************END                             E001           S01194
     C*                                                                   S01194
     C** Call to currency codes access program                            S01194
     C*                                                                   S01194
     C                     CALL 'AOCURRR0'                                S01194
     C                     PARM '*DBERR ' @RTCD                           S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM PCCY      @CCY                            S01194
     C           SDCURR    PARM SDCURR    DSSDY                           S01194
     C*                                                                   S01194
     C** Execute Subroutine to move fields to old field names             S01194
     C*                                                                   S01194
     C                     EXSR AOCURR                                    S01194
     C*                                                                   S01194
     C                     Z-ADDSPOT      RSPOT  138
     C                     Z-ADDMDIN      RMDIN   10
     C                     MOVE CDP       RCDP    10
     C                     MOVE *BLANK    DIG1
     C                     Z-ADDPYAM      DIG1N
     C                     EXSR EDIT
     C                     MOVEADIG2      PYAMA
     C           CFT120    IFEQ 'Y'                                                           CFT120
      *                                                                                       CFT120
      ** Call to currency codes access program                                                CFT120
      *                                                                                       CFT120
     C                     Z-ADD0         CCDP    10                                          CFT120
     C           CDRC      IFNE *BLANKS                                                       CFT120
     C                     CALL 'AOCURRR0'                                                    CFT120
     C                     PARM '*DBERR ' @RTCD                                               CFT120
     C                     PARM '*KEY   ' @OPTN                                               CFT120
     C                     PARM CDRC      @CCY                                                CFT120
     C           SDCURR    PARM SDCURR    DSSDY                                               CFT120
      *                                                                                       CFT120
      ** Execute Subroutine to move fields to old field names                                 CFT120
      *                                                                                       CFT120
     C                     EXSR AOCURR                                                        CFT120
      *                                                                                       CFT120
     C                     MOVE CDP       CCDP                                                CFT120
     C                     ENDIF                                                              CFT120
      *                                                                                       CFT120
      ** Call to currency codes access program for Fixed Currency (ICD)                       CFT120
      *                                                                                       CFT120
     C                     Z-ADD0         FCDP    10                                          CFT120
     C           FCHCCY    IFNE *BLANKS                                                       CFT120
     C                     CALL 'AOCURRR0'                                                    CFT120
     C                     PARM '*DBERR ' @RTCD                                               CFT120
     C                     PARM '*KEY   ' @OPTN                                               CFT120
     C                     PARM FCHCCY    @CCY                                                CFT120
     C           SDCURR    PARM SDCURR    DSSDY                                               CFT120
      *                                                                                       CFT120
      ** Execute Subroutine to move fields to old field names                                 CFT120
      *                                                                                       CFT120
     C                     EXSR AOCURR                                                        CFT120
      *                                                                                       CFT120
     C                     MOVE CDP       FCDP                                                CFT120
     C                     ENDIF                                                              CFT120
     C                     ENDIF                                                              CFT120
      *                                                                                       CFT120
     C***********CDRO      IFNE 0                          B001                               CSD027
     C           CDRO      IFNE *BLANKS                    B001                               CSD027
      *                                                                                       CFT120
     C                     MOVE BCDP      CDP
     C                     MOVE BCCY      CCYA
     C           CDRC      IFNE *BLANKS                                                       CFT120
     C           CFT120    ANDEQ'Y'                                                           CFT120
     C                     MOVE CCDP      CDP                                                 CFT120
     C                     MOVE CDRC      CCYA                                                CFT120
     C                     ENDIF                                                              CFT120
      *                                                                                       CFT120
     C                     ELSE                            X001
     C           ADDC      IFEQ 'A'                        B002
     C                     MOVE PCDP      CDP
     C                     MOVE SMCY      CCYA
     C           SND1      IFEQ 'CASHIER'                                 122060
     C           PCCY      ANDEQBCCY                                      122060
     C                     MOVELPCCY      CCYA                            122060
     C                     ENDIF                                          122060
      *                                                                   122060
     C                     ELSE                            X002
     C                     MOVE RCDP      CDP
     C                     MOVE PCCY      CCYA
     C                     END                             E002
     C                     END                             E001
     C/COPY WNCPYSRC,FT0060C011
     C                     MOVE *BLANK    DIG1
     C                     Z-ADDTRCM      DIG1N
     C                     EXSR EDIT
     C                     MOVE DIG2A     TRCMA
     C*                                                                   S01494
     C** If S01494 is installed, display FX/change commission             S01494
     C*                                                                   S01494
     C           S01494    IFEQ 'Y'                                       S01494
     C*                                                                   S01494
     C** Outgoing                                                         S01494
     C*                                                                   S01494
     C           *IN60     IFEQ '1'                                       S01494
     C                     MOVE *BLANKS   DIG1                            S01494
     C                     Z-ADDOPCHCM    DIG1N                           S01494
     C                     EXSR EDIT                                      S01494
     C                     MOVE DIG2A     CHCMA                           S01494
     C*                                                                   S01494
     C** Incoming                                                         S01494
     C*                                                                   S01494
     C                     ELSE                                           S01494
     C                     MOVE *BLANKS   DIG1                            S01494
     C                     Z-ADDINCHCM    DIG1N                           S01494
     C                     EXSR EDIT                                      S01494
     C                     MOVE DIG2A     CHCMA                           S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C                     END                                            S01494
     C*                                                                   S01499
     C** If S01499 is installed, display V.A.T. details                   S01499
     C*                                                                   S01499
     C           S01499    IFEQ 'Y'                                       S01499
     C*                                                                   S01499
     C** Outgoing                                                         S01499
     C*                                                                   S01499
     C           *IN60     IFEQ '1'                                       S01499
     C                     MOVE *BLANKS   DIG1                            S01499
     C                     Z-ADDOPVATT    DIG1N                           S01499
     C                     EXSR EDIT                                      S01499
     C                     MOVE DIG2A     VATTA                           S01499
     C*                                                                   S01499
     C** Incoming                                                         S01499
     C*                                                                   S01499
     C                     ELSE                                           S01499
     C                     MOVE *BLANKS   DIG1                            S01499
     C                     Z-ADDINVATT    DIG1N                           S01499
     C                     EXSR EDIT                                      S01499
     C                     MOVE DIG2A     VATTA                           S01499
     C                     END                                            S01499
     C*                                                                   S01499
     C                     END                                            S01499
     C*                                                                   S01499
     C                     Z-ADDTXCH      DIG1N
     C                     EXSR EDIT
     C                     MOVE DIG2A     TXCHA
     C                     Z-ADDCQCH      DIG1N
     C                     EXSR EDIT
     C                     MOVE DIG2A     CQCHA
     C  N60                Z-ADDADCH      DIG1N
     C  N60                EXSR EDIT
     C  N60                MOVE DIG2A     ADCHA
     C  N60                Z-ADDTLCH      DIG1N
     C  N60                EXSR EDIT
     C  N60                MOVE DIG2A     TLCHA
     C                     Z-ADDMSCH      DIG1N
     C                     EXSR EDIT
     C                     MOVE DIG2A     MSCHA
     C   60                Z-ADDCSTA      DIG1N
     C   60                EXSR EDIT
     C   60                MOVE DIG2A     CSTAA
     C   60                Z-ADDSPCH      DIG1N
     C   60                EXSR EDIT
     C   60                MOVE DIG2A     SPCHA
     C*
      *                                                                                       CFT120
      ** If Charges to the DR of is used, charges are in Charges                              CFT120
      ** DR Currency or Base                                                                  CFT120
      *                                                                                       CFT120
     C           CDRO      IFNE *BLANKS                                                       CFT120
      *                                                                                       CFT120
     C           CFT120    IFEQ 'Y'                                                           CFT120
     C           CDRC      IFEQ *BLANKS                                                       CFT120
     C                     MOVE BCDP      CDP                                                 CFT120
     C                     MOVE BCCY      CCY1                                                CFT120
     C                     ELSE                                                               CFT120
     C                     MOVE CCDP      CDP                                                 CFT120
     C                     MOVE CDRC      CCY1                                                CFT120
     C                     ENDIF                                                              CFT120
     C                     ENDIF                                                              CFT120
      *                                                                                       CFT120
     C                     ELSE                                                               CFT120
      *                                                                                       CFT120
     C           FTCC      IFEQ 'F'                                                           CFT120
     C           CFT120    ANDEQ'Y'                                                           CFT120
     C                     MOVE FCDP      CDP                                                 CFT120
     C                     MOVE BTCHCY    CCY1                                                CFT120
     C                     ELSE                                                               CFT120
     C           FTCC      IFEQ 'B'                        B001
     C                     MOVE BCDP      CDP
     C                     MOVE BCCY      CCY1
     C                     ELSE                            X001
     C           FTCC      IFEQ 'L'                        B002
     C                     MOVE LCDP      CDP
     C                     MOVE LOCY      CCY1
     C                     ELSE                            X002
     C                     MOVE CCYA      CCY1
     C                     END                             E002
     C                     END                             E001
      *                                                                                       CFT120
     C                     ENDIF                                                              CFT120
     C                     ENDIF                                                              CFT120
      *                                                                                       CFT120
     C                     MOVE *BLANK    DIG1
     C                     Z-ADDDUMA1     DIG1N
     C                     EXSR EDIT
     C                     MOVE DIG2A     TRCML
     C*                                                                   S01494
     C** If S01494 is installed, display FX/change commission             S01494
     C*                                                                   S01494
     C           S01494    IFEQ 'Y'                                       S01494
     C*                                                                   S01494
     C** Outgoing                                                         S01494
     C*                                                                   S01494
     C           *IN60     IFEQ '1'                                       S01494
     C                     MOVE *BLANKS   DIG1                            S01494
     C                     Z-ADDOPDUM7    DIG1N                           S01494
     C                     EXSR EDIT                                      S01494
     C                     MOVE DIG2A     CHCML                           S01494
     C*                                                                   S01494
     C** Incoming                                                         S01494
     C*                                                                   S01494
     C                     ELSE                                           S01494
     C                     MOVE *BLANKS   DIG1                            S01494
     C                     Z-ADDINDUM7    DIG1N                           S01494
     C                     EXSR EDIT                                      S01494
     C                     MOVE DIG2A     CHCML                           S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C                     END                                            S01494
     C*                                                                   S01499
     C** If S01499 is installed, display V.A.T. details                   S01499
     C*                                                                   S01499
     C           S01499    IFEQ 'Y'                                       S01499
     C*                                                                   S01499
     C** Outgoing                                                         S01499
     C*                                                                   S01499
     C           *IN60     IFEQ '1'                                       S01499
     C                     MOVE *BLANKS   DIG1                            S01499
     C                     Z-ADDOPDUM8    DIG1N                           S01499
     C                     EXSR EDIT                                      S01499
     C                     MOVE DIG2A     VATTL                           S01499
     C*                                                                   S01499
     C** Incoming                                                         S01499
     C*                                                                   S01499
     C                     ELSE                                           S01499
     C                     MOVE *BLANKS   DIG1                            S01499
     C                     Z-ADDINDUM8    DIG1N                           S01499
     C                     EXSR EDIT                                      S01499
     C                     MOVE DIG2A     VATTL                           S01499
     C                     END                                            S01499
     C*                                                                   S01499
     C                     END                                            S01499
     C*                                                                   S01499
     C                     Z-ADDDUMA2     DIG1N
     C                     EXSR EDIT
     C                     MOVE DIG2A     TXCHL
     C                     Z-ADDDUMA3     DIG1N
     C                     EXSR EDIT
     C                     MOVE DIG2A     CQCHL
     C  N60                Z-ADDDUMA4     DIG1N
     C  N60                EXSR EDIT
     C  N60                MOVE DIG2A     ADCHL
     C  N60                Z-ADDDUMA5     DIG1N
     C  N60                EXSR EDIT
     C  N60                MOVE DIG2A     TLCHL
     C   60                Z-ADDDUMA4     DIG1N
     C   60                EXSR EDIT
     C   60                MOVE DIG2A     CSTAL
     C   60                Z-ADDDUMA5     DIG1N
     C   60                EXSR EDIT
     C   60                MOVE DIG2A     SPCHL
     C                     Z-ADDDUMA6     DIG1N
     C                     EXSR EDIT
     C                     MOVE DIG2A     MSCHL
      *                                                                   CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
      *                                                                   CFT014
      ** Outgoing Payment                                                 CFT014
      *                                                                   CFT014
     C           *IN60     IFEQ *ON                                       CFT014
      *                                                                   CFT014
     C           OPOEXR    IFNE 0                                         CFT014
     C                     MOVE *ON       *IN84                           CFT014
     C                     MOVE OPOEXR    SOEXR                           CFT014
     C                     ELSE                                           CFT014
     C                     MOVE *OFF      *IN84                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     MOVELOPBOCD    SBOCD                           CFT014
     C                     MOVELOPTTCD    STTCD                           CFT014
     C                     MOVELOPICD1    SICD1                           CFT014
     C                     MOVELOPICD2    SICD2                           CFT014
     C                     MOVELOPICD3    SICD3                           CFT014
     C                     MOVELOPICD4    SICD4                           CFT014
     C                     MOVELOPICD5    SICD5                           CFT014
     C                     MOVELOPRRP1    SRRP1                           CFT014
     C                     MOVELOPRRP2    SRRP2                           CFT014
     C                     MOVELOPRRP3    SRRP3                           CFT014
      *                                                                   CFT014
     C                     MOVE PCCY      SRCCYO                          CFT014
     C                     MOVE *BLANKS   SRCRM                           CFT014
     C           OPRCRM    IFNE 0                                         CFT014
      *                                                                   CFT014
     C                     CALL 'AOCURRR0'                                CFT014
     C                     PARM *BLANKS   @RTCD                           CFT014
     C                     PARM '*KEY   ' @OPTN                           CFT014
     C                     PARM PCCY      @CCY                            CFT014
     C           SDCURR    PARM SDCURR    DSSDY                           CFT014
      *                                                                   CFT014
     C           @RTCD     IFNE *BLANKS                                   CFT014
     C                     Z-ADD063       W0ERNB                          CFT014
     C                     MOVELPCCY      W0KEY                           CFT014
     C                     MOVEL'SDCURRPD'W0FILE                          CFT014
     C                     EXSR SRERR                                     CFT014
     C                     ELSE                                           CFT014
     C                     EXSR AOCURR                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     MOVE *BLANKS   DIG1                            CFT014
     C                     Z-ADDOPRCRM    DIG1N                           CFT014
     C                     EXSR EDIT                                      CFT014
     C                     MOVE DIG2A     SRCRM                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     MOVE *BLANKS   SSCH1                           CFT014
     C                     MOVE *BLANKS   SCCYO1                          CFT014
     C           OPSCC1    IFNE *BLANKS                                   CFT014
      *                                                                   CFT014
     C                     CALL 'AOCURRR0'                                CFT014
     C                     PARM *BLANKS   @RTCD                           CFT014
     C                     PARM '*KEY   ' @OPTN                           CFT014
     C                     PARM OPSCC1    @CCY                            CFT014
     C           SDCURR    PARM SDCURR    DSSDY                           CFT014
      *                                                                   CFT014
     C           @RTCD     IFNE *BLANKS                                   CFT014
     C                     Z-ADD064       W0ERNB                          CFT014
     C                     MOVELOPSCC1    W0KEY                           CFT014
     C                     MOVEL'SDCURRPD'W0FILE                          CFT014
     C                     EXSR SRERR                                     CFT014
     C                     ELSE                                           CFT014
     C                     EXSR AOCURR                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     MOVE OPSCC1    SCCYO1                          CFT014
     C                     MOVE *BLANKS   DIG1                            CFT014
     C                     Z-ADDOPSCH1    DIG1N                           CFT014
     C                     EXSR EDIT                                      CFT014
     C                     MOVE DIG2A     SSCH1                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     MOVE *BLANKS   SSCH2                           CFT014
     C                     MOVE *BLANKS   SCCYO2                          CFT014
     C           OPSCC2    IFNE *BLANKS                                   CFT014
      *                                                                   CFT014
     C                     CALL 'AOCURRR0'                                CFT014
     C                     PARM *BLANKS   @RTCD                           CFT014
     C                     PARM '*KEY   ' @OPTN                           CFT014
     C                     PARM OPSCC2    @CCY                            CFT014
     C           SDCURR    PARM SDCURR    DSSDY                           CFT014
      *                                                                   CFT014
     C           @RTCD     IFNE *BLANKS                                   CFT014
     C                     Z-ADD065       W0ERNB                          CFT014
     C                     MOVELOPSCC2    W0KEY                           CFT014
     C                     MOVEL'SDCURRPD'W0FILE                          CFT014
     C                     EXSR SRERR                                     CFT014
     C                     ELSE                                           CFT014
     C                     EXSR AOCURR                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     MOVE OPSCC2    SCCYO2                          CFT014
     C                     MOVE *BLANKS   DIG1                            CFT014
     C                     Z-ADDOPSCH2    DIG1N                           CFT014
     C                     EXSR EDIT                                      CFT014
     C                     MOVE DIG2A     SSCH2                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     MOVE *BLANKS   SSCH3                           CFT014
     C                     MOVE *BLANKS   SCCYO3                          CFT014
     C           OPSCC3    IFNE *BLANKS                                   CFT014
      *                                                                   CFT014
     C                     CALL 'AOCURRR0'                                CFT014
     C                     PARM *BLANKS   @RTCD                           CFT014
     C                     PARM '*KEY   ' @OPTN                           CFT014
     C                     PARM OPSCC3    @CCY                            CFT014
     C           SDCURR    PARM SDCURR    DSSDY                           CFT014
      *                                                                   CFT014
     C           @RTCD     IFNE *BLANKS                                   CFT014
     C                     Z-ADD066       W0ERNB                          CFT014
     C                     MOVELOPSCC3    W0KEY                           CFT014
     C                     MOVEL'SDCURRPD'W0FILE                          CFT014
     C                     EXSR SRERR                                     CFT014
     C                     ELSE                                           CFT014
     C                     EXSR AOCURR                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     MOVE OPSCC3    SCCYO3                          CFT014
     C                     MOVE *BLANKS   DIG1                            CFT014
     C                     Z-ADDOPSCH3    DIG1N                           CFT014
     C                     EXSR EDIT                                      CFT014
     C                     MOVE DIG2A     SSCH3                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     MOVE *BLANKS   SSCH4                           CFT014
     C                     MOVE *BLANKS   SCCYO4                          CFT014
     C           OPSCC4    IFNE *BLANKS                                   CFT014
      *                                                                   CFT014
     C                     CALL 'AOCURRR0'                                CFT014
     C                     PARM *BLANKS   @RTCD                           CFT014
     C                     PARM '*KEY   ' @OPTN                           CFT014
     C                     PARM OPSCC4    @CCY                            CFT014
     C           SDCURR    PARM SDCURR    DSSDY                           CFT014
      *                                                                   CFT014
     C           @RTCD     IFNE *BLANKS                                   CFT014
     C                     Z-ADD067       W0ERNB                          CFT014
     C                     MOVELOPSCC4    W0KEY                           CFT014
     C                     MOVEL'SDCURRPD'W0FILE                          CFT014
     C                     EXSR SRERR                                     CFT014
     C                     ELSE                                           CFT014
     C                     EXSR AOCURR                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     MOVE OPSCC4    SCCYO4                          CFT014
     C                     MOVE *BLANKS   DIG1                            CFT014
     C                     Z-ADDOPSCH4    DIG1N                           CFT014
     C                     EXSR EDIT                                      CFT014
     C                     MOVE DIG2A     SSCH4                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     MOVE *BLANKS   SSCH5                           CFT014
     C                     MOVE *BLANKS   SCCYO5                          CFT014
     C           OPSCC5    IFNE *BLANKS                                   CFT014
      *                                                                   CFT014
     C                     CALL 'AOCURRR0'                                CFT014
     C                     PARM *BLANKS   @RTCD                           CFT014
     C                     PARM '*KEY   ' @OPTN                           CFT014
     C                     PARM OPSCC5    @CCY                            CFT014
     C           SDCURR    PARM SDCURR    DSSDY                           CFT014
      *                                                                   CFT014
     C           @RTCD     IFNE *BLANKS                                   CFT014
     C                     Z-ADD068       W0ERNB                          CFT014
     C                     MOVELOPSCC5    W0KEY                           CFT014
     C                     MOVEL'SDCURRPD'W0FILE                          CFT014
     C                     EXSR SRERR                                     CFT014
     C                     ELSE                                           CFT014
     C                     EXSR AOCURR                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     MOVE OPSCC5    SCCYO5                          CFT014
     C                     MOVE *BLANKS   DIG1                            CFT014
     C                     Z-ADDOPSCH5    DIG1N                           CFT014
     C                     EXSR EDIT                                      CFT014
     C                     MOVE DIG2A     SSCH5                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Incoming Payment                                                 CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
     C           INOEXR    IFNE 0                                         CFT014
     C                     MOVE *ON       *IN84                           CFT014
     C                     MOVE INOEXR    SOEXR                           CFT014
     C                     ELSE                                           CFT014
     C                     MOVE *OFF      *IN84                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     MOVELINTRIB    STRIB                           CFT014
     C                     MOVELINBOCD    SBOCD                           CFT014
     C                     MOVELINTTCD    STTCD                           CFT014
     C                     MOVELINICD1    SICD1                           CFT014
     C                     MOVELINICD2    SICD2                           CFT014
     C                     MOVELINICD3    SICD3                           CFT014
     C                     MOVELINICD4    SICD4                           CFT014
     C                     MOVELINICD5    SICD5                           CFT014
     C                     MOVELINRRP1    SRRP1                           CFT014
     C                     MOVELINRRP2    SRRP2                           CFT014
     C                     MOVELINRRP3    SRRP3                           CFT014
      *                                                                   CFT014
     C                     MOVE SMCY      SRCCYI                          CFT014
     C                     MOVE *BLANK    SRCRM                           CFT014
     C           INRCRM    IFNE 0                                         CFT014
      *                                                                   CFT014
     C                     CALL 'AOCURRR0'                                CFT014
     C                     PARM *BLANKS   @RTCD                           CFT014
     C                     PARM '*KEY   ' @OPTN                           CFT014
     C                     PARM SMCY      @CCY                            CFT014
     C           SDCURR    PARM SDCURR    DSSDY                           CFT014
      *                                                                   CFT014
     C           @RTCD     IFNE *BLANKS                                   CFT014
     C                     Z-ADD069       W0ERNB                          CFT014
     C                     MOVELSMCY      W0KEY                           CFT014
     C                     MOVEL'SDCURRPD'W0FILE                          CFT014
     C                     EXSR SRERR                                     CFT014
     C                     ELSE                                           CFT014
     C                     EXSR AOCURR                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     MOVE *BLANK    DIG1                            CFT014
     C                     Z-ADDINRCRM    DIG1N                           CFT014
     C                     EXSR EDIT                                      CFT014
     C                     MOVE DIG2A     SRCRM                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     MOVE *BLANKS   SSCH1                           CFT014
     C                     MOVE *BLANKS   SCCYI1                          CFT014
     C           INSCY1    IFNE *BLANKS                                   CFT014
      *                                                                   CFT014
     C                     CALL 'AOCURRR0'                                CFT014
     C                     PARM *BLANKS   @RTCD                           CFT014
     C                     PARM '*KEY   ' @OPTN                           CFT014
     C                     PARM INSCY1    @CCY                            CFT014
     C           SDCURR    PARM SDCURR    DSSDY                           CFT014
      *                                                                   CFT014
     C           @RTCD     IFNE *BLANKS                                   CFT014
     C                     Z-ADD070       W0ERNB                          CFT014
     C                     MOVELINSCY1    W0KEY                           CFT014
     C                     MOVEL'SDCURRPD'W0FILE                          CFT014
     C                     EXSR SRERR                                     CFT014
     C                     ELSE                                           CFT014
     C                     EXSR AOCURR                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     MOVE INSCY1    SCCYI1                          CFT014
     C                     MOVE *BLANKS   DIG1                            CFT014
     C                     Z-ADDINSCH1    DIG1N                           CFT014
     C                     EXSR EDIT                                      CFT014
     C                     MOVE DIG2A     SSCH1                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     MOVE *BLANKS   SSCH2                           CFT014
     C                     MOVE *BLANKS   SCCYI2                          CFT014
     C           INSCY2    IFNE *BLANKS                                   CFT014
      *                                                                   CFT014
     C                     CALL 'AOCURRR0'                                CFT014
     C                     PARM *BLANKS   @RTCD                           CFT014
     C                     PARM '*KEY   ' @OPTN                           CFT014
     C                     PARM INSCY2    @CCY                            CFT014
     C           SDCURR    PARM SDCURR    DSSDY                           CFT014
      *                                                                   CFT014
     C           @RTCD     IFNE *BLANKS                                   CFT014
     C                     Z-ADD071       W0ERNB                          CFT014
     C                     MOVELINSCY2    W0KEY                           CFT014
     C                     MOVEL'SDCURRPD'W0FILE                          CFT014
     C                     EXSR SRERR                                     CFT014
     C                     ELSE                                           CFT014
     C                     EXSR AOCURR                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     MOVE INSCY2    SCCYI2                          CFT014
     C                     MOVE *BLANKS   DIG1                            CFT014
     C                     Z-ADDINSCH2    DIG1N                           CFT014
     C                     EXSR EDIT                                      CFT014
     C                     MOVE DIG2A     SSCH2                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     MOVE *BLANKS   SSCH3                           CFT014
     C                     MOVE *BLANKS   SCCYI3                          CFT014
     C           INSCY3    IFNE *BLANKS                                   CFT014
      *                                                                   CFT014
     C                     CALL 'AOCURRR0'                                CFT014
     C                     PARM *BLANKS   @RTCD                           CFT014
     C                     PARM '*KEY   ' @OPTN                           CFT014
     C                     PARM INSCY3    @CCY                            CFT014
     C           SDCURR    PARM SDCURR    DSSDY                           CFT014
      *                                                                   CFT014
     C           @RTCD     IFNE *BLANKS                                   CFT014
     C                     Z-ADD072       W0ERNB                          CFT014
     C                     MOVELINSCY3    W0KEY                           CFT014
     C                     MOVEL'SDCURRPD'W0FILE                          CFT014
     C                     EXSR SRERR                                     CFT014
     C                     ELSE                                           CFT014
     C                     EXSR AOCURR                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     MOVE INSCY3    SCCYI3                          CFT014
     C                     MOVE *BLANKS   DIG1                            CFT014
     C                     Z-ADDINSCH3    DIG1N                           CFT014
     C                     EXSR EDIT                                      CFT014
     C                     MOVE DIG2A     SSCH3                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     MOVE *BLANKS   SSCH4                           CFT014
     C                     MOVE *BLANKS   SCCYI4                          CFT014
     C           INSCY4    IFNE *BLANKS                                   CFT014
      *                                                                   CFT014
     C                     CALL 'AOCURRR0'                                CFT014
     C                     PARM *BLANKS   @RTCD                           CFT014
     C                     PARM '*KEY   ' @OPTN                           CFT014
     C                     PARM INSCY4    @CCY                            CFT014
     C           SDCURR    PARM SDCURR    DSSDY                           CFT014
      *                                                                   CFT014
     C           @RTCD     IFNE *BLANKS                                   CFT014
     C                     Z-ADD073       W0ERNB                          CFT014
     C                     MOVELINSCY4    W0KEY                           CFT014
     C                     MOVEL'SDCURRPD'W0FILE                          CFT014
     C                     EXSR SRERR                                     CFT014
     C                     ELSE                                           CFT014
     C                     EXSR AOCURR                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     MOVE INSCY4    SCCYI4                          CFT014
     C                     MOVE *BLANKS   DIG1                            CFT014
     C                     Z-ADDINSCH4    DIG1N                           CFT014
     C                     EXSR EDIT                                      CFT014
     C                     MOVE DIG2A     SSCH4                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     MOVE *BLANKS   SSCH5                           CFT014
     C                     MOVE *BLANKS   SCCYI5                          CFT014
     C           INSCY5    IFNE *BLANKS                                   CFT014
      *                                                                   CFT014
     C                     CALL 'AOCURRR0'                                CFT014
     C                     PARM *BLANKS   @RTCD                           CFT014
     C                     PARM '*KEY   ' @OPTN                           CFT014
     C                     PARM INSCY5    @CCY                            CFT014
     C           SDCURR    PARM SDCURR    DSSDY                           CFT014
      *                                                                   CFT014
     C           @RTCD     IFNE *BLANKS                                   CFT014
     C                     Z-ADD074       W0ERNB                          CFT014
     C                     MOVELINSCY5    W0KEY                           CFT014
     C                     MOVEL'SDCURRPD'W0FILE                          CFT014
     C                     EXSR SRERR                                     CFT014
     C                     ELSE                                           CFT014
     C                     EXSR AOCURR                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     MOVE INSCY5    SCCYI5                          CFT014
     C                     MOVE *BLANKS   DIG1                            CFT014
     C                     Z-ADDINSCH5    DIG1N                           CFT014
     C                     EXSR EDIT                                      CFT014
     C                     MOVE DIG2A     SSCH5                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CEU006
      * Set up Notified and Pay delivery currency fields for incoming     CEU006
      * and outgoing payment screens.                                     CEU006
      *                                                                   CEU006
      *                                                                   CEU006
     C           CEU006    IFEQ 'Y'                                       CEU006
     C           CFT014    OREQ 'Y'                                       CFT014
     C           *IN60     ANDEQ*OFF                                      CFT014
      *                                                                   CEU006
     C           NDCY      IFNE *BLANKS                                   CEU006
      *                                                                   CEU006
      ** Call to currency codes access program                            CEU006
      *                                                                   CEU006
     C                     CALL 'AOCURRR0'                                CEU006
     C                     PARM '*DBERR ' @RTCD                           CEU006
     C                     PARM '*KEY   ' @OPTN                           CEU006
     C                     PARM NDCY      @CCY                            CEU006
     C           SDCURR    PARM SDCURR    DSSDY                           CEU006
      *                                                                   CEU006
      ** Execute Subroutine to move fields to old field names             CEU006
      *                                                                   CEU006
     C                     EXSR AOCURR                                    CEU006
      *                                                                   CEU006
     C                     MOVE *BLANK    DIG1                            CEU006
     C                     Z-ADDNDAM      DIG1N                           CEU006
     C                     EXSR EDIT                                      CEU006
     C                     MOVEADIG2      SNDAM                           CEU006
      *                                                                   CEU006
     C                     ENDIF                                          CEU006
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CEU006
     C           CEU006    IFEQ 'Y'                                       CFT014
     C           CFT014    OREQ 'Y'                                       CFT014
     C           *IN60     ANDEQ*ON                                       CFT014
      *                                                                   CFT014
     C           PDCY      IFNE *BLANKS                                   CEU006
      *                                                                   CEU006
      ** Call to currency codes access program                            CEU006
      *                                                                   CEU006
     C                     CALL 'AOCURRR0'                                CEU006
     C                     PARM '*DBERR ' @RTCD                           CEU006
     C                     PARM '*KEY   ' @OPTN                           CEU006
     C                     PARM PDCY      @CCY                            CEU006
     C           SDCURR    PARM SDCURR    DSSDY                           CEU006
      *                                                                   CEU006
      ** Execute Subroutine to move fields to old field names             CEU006
      *                                                                   CEU006
     C                     EXSR AOCURR                                    CEU006
      *                                                                   CEU006
     C                     MOVE *BLANK    DIG1                            CEU006
     C                     Z-ADDPDAM      DIG1N                           CEU006
     C                     EXSR EDIT                                      CEU006
     C                     MOVEADIG2      SPDAM                           CEU006
      *                                                                   CEU006
     C                     ENDIF                                          CEU006
      *                                                                   CEU006
     C                     ENDIF                                          CEU006
     C*                                                                   E21468
     C           CHAP      IFEQ 0                          B001           E21468
     C                     MOVE *BLANK    SCHAP                           E21468
     C                     ELSE                            X001           E21468
     C                     MOVE CHAP      SCHAP                           E21468
     C                     END                             E001           E21468
     C**
     C*  CONVERT OPTIONAL FIELDS WHICH MAY BE IN DIFFERENT FORMATS
     C**
     C           *IN60     IFEQ '1'
     C                     EXSR CVRTOP
     C                     ELSE
     C                     EXSR CVRTIN
     C                     END
     C*
     C** Move file update fields to screen output fields                  S01117
     C** If non-multibranching call subroutine FORMAT                     S01117
     C*                                                                   S01117
      *                                                                   S01435
      *  Now formatted by FT0315                                          S01435
      *                                                                   S01435
     C**********           MOVE DST1      SDST1                     S01117S01435
     C**********           MOVE ORC1      SORC1                     S01117S01435
     C**********           MOVE SND1      SSND1                     S01117S01435
     C**********           MOVE BNC1      SBNC1                     S01117S01435
     C**********                                                    S01117S01435
     C********** *IN50     IFEQ '0'                                 S01117S01435
     C**********           EXSR FORMAT                              S01117S01435
     C**********           END                                      S01117S01435
     C**********                                                    S01117S01435
      ** If CDL049 is installed, format Reference Rate                    CDL049
      *                                                                   CDL049
     C           CDL049    IFEQ 'Y'                                       CDL049
      *                                                                   CDL049
      ** Outgoing                                                         CDL049
      *                                                                   CDL049
     C           *IN60     IFEQ '1'                                       CDL049
     C                     MOVE OPRRAT    ZFIELD                          CDL049
     C                     Z-ADD8         ZADEC                           CDL049
     C                     EXSR ZEDIT                                     CDL049
     C                     MOVE ZFIELD    S#REFR                          CDL049
      ** Incoming                                                         CDL049
     C                     ELSE                                           CDL049
     C                     MOVE INRRAT    ZFIELD                          CDL049
     C                     Z-ADD8         ZADEC                           CDL049
     C                     EXSR ZEDIT                                     CDL049
     C                     MOVE ZFIELD    S#REFR                          CDL049
     C                     END                                            CDL049
      *                                                                   CDL049
     C                     END                                            CDL049
      *                                                                   CDL049
     C/COPY WNCPYSRC,FT0060C012
      *                                                                                       CER030
     C           CGL013    IFEQ 'Y'                                                           CER030
     C           CER030    OREQ 'Y'                                                           CER030
     C           CER031    OREQ 'Y'                                                           CER030
      *                                                                                       CER030
      ** Outgoing Payment                                                                     CER030
      *                                                                                       CER030
     C                     MOVE *OFF      *IN48                                               CER030
     C                     MOVE *OFF      *IN49                                             BUG23380
      *                                                                                       CER030
     C           *IN60     IFEQ *ON                                                           CER030
      *                                                                                       CER030
     C           CER030    IFEQ 'Y'                                                           CER030
     C           CGL013    OREQ 'Y'                                                           CER030
     C                     MOVE *ON       *IN48                                               CER030
     C                     MOVELOPRTTY    D1RTTY                                              CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C           CER031    IFEQ 'Y'                                                           CER030
      *                                                                                       CER030
     C                     MOVEL'(Debit):'D1TYPE                                              CER030
     C                     MOVELOPEXT1    D1NAR1                                              CER030
     C                     MOVELOPEXT2    D1NAR2                                              CER030
     C                     MOVELOPEXT3    D1NAR3                                              CER030
     C                     MOVELOPEXT4    D1NAR4                                              CER030
     C                     MOVELOPEXT5    D1NAR5                                              CER030
     C                     MOVELOPEXT6    D1NAR6                                              CER030
      *                                                                                       CER030
     C**********           MOVE *OFF      *IN49                                      CER030 BUG23380
      *                                                                                       CER030
     C           CFT003    IFEQ 'CFT003'                                                      CER030
     C                     MOVE *ON       *IN49                                               CER030
     C                     MOVELOPEXC1    D1NAR7                                              CER030
     C                     MOVELOPEXC2    D1NAR8                                              CER030
     C                     MOVELOPEXC3    D1NAR9                                              CER030
     C                     MOVELOPEXC4    D1NR10                                              CER030
     C                     MOVELOPEXC5    D1NR11                                              CER030
     C                     MOVELOPEXC6    D1NR12                                              CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     ELSE                                                               CER030
      *                                                                                       CER030
      ** Incoming Payment                                                                     CER030
      *                                                                                       CER030
     C           CER030    IFEQ 'Y'                                                           CER030
     C           CGL013    OREQ 'Y'                                                           CER030
     C                     MOVE *ON       *IN48                                               CER030
     C                     MOVELIRTTY     D1RTTY                                              CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C           CER031    IFEQ 'Y'                                                           CER030
      *                                                                                       CER030
     C                     MOVEL'(Credit)'D1TYPE                                              CER030
     C                     MOVELIEXT1     D1NAR1                                              CER030
     C                     MOVELIEXT2     D1NAR2                                              CER030
     C                     MOVELIEXT3     D1NAR3                                              CER030
     C                     MOVELIEXT4     D1NAR4                                              CER030
     C                     MOVELIEXT5     D1NAR5                                              CER030
     C                     MOVELIEXT6     D1NAR6                                              CER030
      *                                                                                       CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     ENDSR
     C********************************************************************
     C* END OF VALUES SUBROUTINE
     C********************************************************************
     C/COPY WNCPYSRC,FT0060C013
     C/EJECT
     C********************************************************************
     C*
     C*    CVRTOP SR.  TO REFORMAT FIELDS FOR OUTGOING PAYMENTS
     C*
     C           CVRTOP    BEGSR
     C**
     C*   SENDER'S CORRESPONDENT CAN BE A NOSTRO NUMBER OR A RETAIL NUMBER
     C**
     C                     MOVE *BLANKS   SSNCO
     C*
     C           SNCT      IFEQ 'N'
     C                     MOVELSNCO      WORK02  2
     C                     MOVELWORK02    SSNCO
     C                     END
     C*
     C           SNCT      IFEQ 'R'
     C                     MOVELSNCO      SSNCO
     C                     END
     C**
     C*   ORDERING BANK CAN BE A NOSTRO NUMBER A RETAIL NUMBER OR
     C*     A PARTIAL ACCOUNT IDENTIFIER
     C**
     C                     MOVE *BLANKS   SORBK
     C*
     C           ORBT      IFEQ 'N'
     C                     MOVELORBK      WORK02  2
     C                     MOVELWORK02    SORBK
     C                     END
     C*
     C           ORBT      IFEQ 'R'
     C                     MOVELORBK      WORK10 10
     C                     MOVELWORK10    SORBK
     C                     END
     C*
     C           ORBT      IFEQ 'P'
     C                     MOVELORBK      SORBK
     C           BGMBIN    IFEQ 'Y'                                       S01117
     C                     MOVELORBB      SORBB   3                       S01117
     C                     ELSE                                           S01117
     C                     MOVE BJSBRC    ORBB                            S01117
     C                     MOVE *BLANKS   SORBB                           S01117
     C                     END                                            S01117
     C                     END
      *                                                                                       CFT145
     C                     MOVE *BLANKS   SVACBK 18                                           CFT145
     C                     SELEC                                                              CFT145
     C           ORBT      WHEQ 'N'                                                           CFT145
     C                     MOVELACBK      SVACBK 18                                           CFT145
     C                     MOVELORBK      ACBK                                                CFT145
      *                                                                                    AR1056423
     C                     MOVELPCCY      WPCCY   3                                        AR1056423
     C                     MOVELSMCY      PCCY                                             AR1056423
     C                     EXSR TBLKEY                                                        CFT145
     C                     MOVELWPCCY     PCCY                                             AR1056423
     C                     MOVEL*BLANKS   WPCCY                                            AR1056423
      *                                                                                    AR1056423
     C                     MOVELA7CUST    WWODCN  6                                           CFT145
     C                     MOVELSVACBK    ACBK                                                CFT145
     C           ORBT      WHEQ 'R'                                                           CFT145
      *                                                                                       CFT145
      ** Save Booking Branch from OTPAY to stop overwriting if ACNUMA accessed                CFT145
      *                                                                                       CFT145
     C                     MOVE BRCA      OPBRC   3                                           CFT145
     C                     MOVELACBK      SVACBK 18                                           CFT145
     C                     MOVELORBK      ACBK                                                CFT145
     C                     EXSR ACNKEY                                                        CFT145
     C                     MOVELCNUM      WWODCN  6                                           CFT145
     C                     MOVELSVACBK    ACBK                                                CFT145
      *                                                                                       CFT145
      ** Restore branch value                                                                 CFT145
      *                                                                                       CFT145
     C                     MOVE OPBRC     BRCA                                                CFT145
     C           ORBT      WHEQ 'P'                                                           CFT145
     C                     MOVELORBK      WWODCN  6                                           CFT145
     C                     ENDSL                                                              CFT145
      *                                                                                       CFT145
     C**
     C*   CHARGES TO THE DEBIT OF ACCOUNT CAN BE A NOSTRO NUMBER
     C*     A RETAIL NUMBER  OR A PARTIAL ACCOUNT IDENTIFIER
     C**
     C                     MOVE *BLANKS   SCDRO
     C*
     C           CDRT      IFEQ 'N'
     C                     MOVELCDRO      WORK02  2
     C                     MOVELWORK02    SCDRO
     C                     END
     C*
     C           CDRT      IFEQ 'R'
     C                     MOVELCDRO      WORK10 10
     C                     MOVELWORK10    SCDRO
     C                     END
     C*
     C           CDRT      IFEQ 'P'
     C                     MOVELCDBR      SCDBR                           S01117
     C                     MOVELCDRO      SCDRO
     C/COPY WNCPYSRC,FT0060C014
     C                     END
     C/COPY WNCPYSRC,FT0060C030
      *                                                                                       CFT145
     C                     MOVE *BLANKS   SVACBK 18                                           CFT145
     C                     SELEC                                                              CFT145
     C           CDRT      WHEQ 'N'                                                           CFT145
     C                     MOVELCDRO      WSKY1   2                                           CFT145
     C           CDRC      IFEQ *BLANKS                                                       CFT145
     C                     MOVE BJCYCD    @CCY                                                CFT145
     C                     ELSE                                                               CFT145
     C                     MOVE CDRC      @CCY                                                CFT145
     C                     ENDIF                                                              CFT145
      *                                                                                       CFT145
      ** Call to access pgm for nostro details                                                CFT145
      *                                                                                       CFT145
     C                     CALL 'AONOSTR0'                                                    CFT145
     C                     PARM '*DBERR ' @RTCD                                               CFT145
     C                     PARM '*KEY   ' @OPTN                                               CFT145
     C                     PARM *BLANKS   @CUST   6                                           CFT145
     C                     PARM           @CCY    3                                           CFT145
     C                     PARM *BLANKS   @ACCD  10                                           CFT145
     C                     PARM *BLANKS   @ACSN   2                                           CFT145
     C                     PARM WSKY1     @NONB   2                                           CFT145
     C                     PARM *BLANKS   @BRCD   3                                           CFT145
     C                     PARM *BLANKS   @CSSN  10                                           CFT145
     C                     PARM *BLANKS   @PNOI   1                                           CFT145
     C           SDNOST    PARM SDNOST    DSFDY                                               CFT145
     C                     MOVELA7CUST    WWCDCN  6                                           CFT145
     C           CDRT      WHEQ 'R'                                                           CFT145
      *                                                                                       CFT145
      ** Save Booking Branch from to stop overwriting if ACNUMA accessed                      CFT145
      *                                                                                       CFT145
     C                     MOVE BRCA      SVBRC   3                                           CFT145
     C                     MOVELACBK      SVACBK 18                                           CFT145
     C                     MOVELCDRO      ACBK                                                CFT145
     C                     EXSR ACNKEY                                                        CFT145
     C                     MOVELCNUM      WWCDCN  6                                           CFT145
     C                     MOVELSVACBK    ACBK                                                CFT145
      *                                                                                       CFT145
      ** Restore branch value                                                                 CFT145
      *                                                                                       CFT145
     C                     MOVE SVBRC     BRCA                                                CFT145
     C           CDRT      WHEQ 'P'                                                           CFT145
     C                     MOVELCDRO      WWCDCN  6                                           CFT145
     C                     ENDSL                                                              CFT145
     C*
     C* DISPLAY SWIFT PRIORITY CODE AS : 'U' - URGENT OR 'N' - NORMAL.    S01117
     C*                                                                   S01117
     C           SWPC      IFEQ 1                                         S01117
     C                     MOVE 'U'       SSWPC                           S01117
     C                     ELSE                                           S01117
     C           SWPC      IFEQ 2                                         S01117
     C                     MOVE 'N'       SSWPC                           S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C*                                                                   S01117
      *                                                                   S01435
      * Expand data where possible                                        S01435
      *                                                                   S01435
      *                                                                   S01435
      *  Set up general parameters                                        S01435
      *                                                                   S01435
     C                     CLEARW8FT                                      S01435
     C                     MOVELSTMT      W8STMT                          S01435
     C                     MOVEL##PGM     W8CPGM                          S01435
     C                     MOVEL'*ENQ'    W8ACT                           S01435
     C                     MOVEL'Y'       W8CRIT                          S01435
     C                     Z-ADD4         W8NLIN                          S01435
      *                                                                   S01435
      *  Destination                                                      S01435
      *                                                                   S01435
     C                     MOVELDSTT      W8TYPE                          S01435
     C                     MOVELPCCY      W8CCY                           S01435
     C                     MOVEL*BLANKS   ADDRSS                          S01435
     C                     MOVELDST1      ADCHK1                          S01435
     C                     MOVELDST2      ADCHK2                          S01435
     C                     MOVELDST3      ADCHK3                          S01435
     C                     MOVELDST4      ADCHK4                          S01435
     C**********           MOVELSORC5     ADCHK5                                     CFT032 BUG12713
     C                     MOVELORC5      ADCHK5                                            BUG12713
     C                     MOVELADDRSS    W8LINS                          S01435
     C/COPY WNCPYSRC,FT0060C102
      *                                                                   S01435
      * Call expansion program                                            S01435
      *                                                                   S01435
     C                     CALL 'FT0315'               9090               S01435
     C                     PARM           W8RTN   7                       S01435
     C                     PARM           W8FT                            S01435
     C                     PARM           W8LINS256                       S01435
     C                     PARM           W8RPT 256                       S01435
     C                     PARM           W8MSG 256                       S01435
     C                     PARM           W8SCR 256                       S01435
      *                                                                   S01435
     C                     MOVELW8SCR     ADDRSS                          S01435
     C                     MOVELADCHK1    SDST1                           S01435
     C                     MOVELADCHK2    SDST2                           S01435
     C                     MOVELADCHK3    SDST3                           S01435
     C                     MOVELADCHK4    SDST4                           S01435
     C                     MOVELADCHK5    SORC5                                               CFT032
     C/COPY WNCPYSRC,FT0060C103
     C           SORC1     IFEQ 'MT202'                                   093130
     C           SORC2     ANDEQ*BLANKS                                   093130
     C           SORC3     ANDEQ*BLANKS                                   093130
     C           SORC4     ANDEQ*BLANKS                                   093130
     C           SORC5     ANDNE*BLANKS                                                       CFT032
     C                     MOVELOPORB1    SORC2                           093130
     C                     MOVELOPORB2    SORC3                           093130
     C                     MOVELOPORB3    SORC4                           093130
     C                     MOVELOPORB4    SORC5                                               CFT032
     C                     END                                            093130
      *                                                                   S01435
      * Database error if data not correct                                S01435
      *                                                                   S01435
     C           *IN90     IFEQ '1'                                       S01435
     C           W8RTN     ORNE *BLANKS                                   S01435
     C           *LOCK     IN   DLDA                                      S01435
     C                     MOVEL'FT0060'  DBPGM                           S01435
     C                     MOVEL'FT0315'  DBFILE           ***************S01435
     C                     Z-ADD91        DBASE            * DB ERROR 91 *S01435
     C                     MOVEL'*CALL'   DBKEY            ***************S01435
     C                     MOVE '*'       @RETC                           S01435
     C                     OUT  DLDA                                      S01435
     C                     SETON                     U7U8LR               S01435
     C                     DUMP                                           S01435
     C                     RETRN                                          S01435
     C                     END                                            S01435
      *                                                                   S01435
      *  Ordering Customer                                                S01435
      *                                                                   S01435
     C                     MOVELORCT      W8TYPE                          S01435
     C                     MOVELSMCY      W8CCY                           S01435
     C                     MOVEL*BLANKS   ADDRSS                          S01435
     C                     MOVELORC1      ADCHK1                          S01435
     C                     MOVELORC2      ADCHK2                          S01435
     C                     MOVELORC3      ADCHK3                          S01435
     C                     MOVELORC4      ADCHK4                          S01435
     C**********           MOVELSORC5     ADCHK5                                     CFT032 BUG12713
     C                     MOVELORC5      ADCHK5                                            BUG12713
     C                     MOVELADDRSS    W8LINS                          S01435
      *                                                                   S01435
      * Call expansion program                                            S01435
      *                                                                   S01435
     C                     CALL 'FT0315'               9090               S01435
     C                     PARM           W8RTN   7                       S01435
     C                     PARM           W8FT                            S01435
     C                     PARM           W8LINS256                       S01435
     C                     PARM           W8RPT 256                       S01435
     C                     PARM           W8MSG 256                       S01435
     C                     PARM           W8SCR 256                       S01435
      *                                                                   S01435
      * Database error if data not correct                                S01435
      *                                                                   S01435
     C           *IN90     IFEQ '1'                                       S01435
     C           W8RTN     ORNE *BLANKS                                   S01435
     C           *LOCK     IN   DLDA                                      S01435
     C                     MOVEL'FT0060'  DBPGM                           S01435
     C                     MOVEL'FT0315'  DBFILE           ***************S01435
     C                     Z-ADD92        DBASE            * DB ERROR 92 *S01435
     C                     MOVEL'*CALL'   DBKEY            ***************S01435
     C                     MOVE '*'       @RETC                           S01435
     C                     OUT  DLDA                                      S01435
     C                     SETON                     U7U8LR               S01435
     C                     DUMP                                           S01435
     C                     RETRN                                          S01435
     C                     END                                            S01435
      *                                                                   S01435
     C                     MOVELW8SCR     ADDRSS                          S01435
     C                     MOVELADCHK1    SORC1                           S01435
     C                     MOVELADCHK2    SORC2                           S01435
     C                     MOVELADCHK3    SORC3                           S01435
     C                     MOVELADCHK4    SORC4                           S01435
     C                     MOVELADCHK5    SORC5                                               CFT032
      *                                                                                       CFT145
     C                     MOVE *BLANKS   SVACBK 18                                           CFT145
     C                     SELEC                                                              CFT145
     C           ORCT      WHEQ 'N'                                                           CFT145
     C                     MOVELACBK      SVACBK 18                                           CFT145
     C                     MOVELORC1      ACBK                                                CFT145
      *                                                                                    AR1056423
     C                     MOVELPCCY      WPCCY   3                                        AR1056423
     C                     MOVELSMCY      PCCY                                             AR1056423
     C                     EXSR TBLKEY                                                        CFT145
     C                     MOVELWPCCY     PCCY                                             AR1056423
     C                     MOVEL*BLANKS   WPCCY                                            AR1056423
      *                                                                                    AR1056423
     C                     MOVELA7CUST    WWODCN  6                                           CFT145
     C                     MOVELSVACBK    ACBK                                                CFT145
     C           ORCT      WHEQ 'R'                                                           CFT145
      *                                                                                       CFT145
      ** Save Booking Branch to stop overwriting if ACNUMA accessed                           CFT145
      *                                                                                       CFT145
     C                     MOVE BRCA      SVBRC   3                                           CFT145
     C                     MOVELACBK      SVACBK 18                                           CFT145
     C           1         SUBSTORC1:1    SLSH    1                                           260694
     C           SLSH      IFNE '/'                                                           260694
     C                     MOVELORC1      ACBK                                                CFT145
     C                     ELSE                                                               260694
     C           10        SUBSTORC1:2    ACBK                                                260694
     C                     ENDIF                                                              260694
     C                     EXSR ACNKEY                                                        CFT145
     C                     MOVELCNUM      WWODCN  6                                           CFT145
     C                     MOVELSVACBK    ACBK                                                CFT145
      *                                                                                       CFT145
      ** Restore branch value                                                                 CFT145
      *                                                                                       CFT145
     C                     MOVE SVBRC     BRCA                                                CFT145
     C           ORCT      WHEQ 'P'                                                           CFT145
     C           1         SUBSTORC1:1    SLSH                                                260694
     C           SLSH      IFNE '/'                                                           260694
     C                     MOVELORC1      WWODCN  6                                           CFT145
     C                     ELSE                                                               260694
     C           6         SUBSTORC1:2    WWODCN                                              260694
     C                     ENDIF                                                              260694
     C                     ENDSL                                                              CFT145
      *                                                                   S01435
      *  Receivers Correspondent                                          S01435
      *                                                                   S01435
     C           CFT004    IFEQ 'Y'                                       CFT004
     C           RCRT      ANDEQ'I'                                       CFT004
     C                     MOVE *BLANK    W8CRIT                          CFT004
     C                     ELSE                                           CFT004
     C                     MOVEL'Y'       W8CRIT                          CFT004
     C                     ENDIF                                          CFT004
     C                     MOVELRCRT      W8TYPE                          S01435
     C                     MOVEL*BLANKS   ADDRSS                          S01435
     C                     MOVELRCO1      ADCHK1                          S01435
     C                     MOVELRCO2      ADCHK2                          S01435
     C                     MOVELRCO3      ADCHK3                          S01435
     C                     MOVELRCO4      ADCHK4                          S01435
     C                     MOVELRCO5      ADCHK5                          S01435
     C                     MOVELSORC5     ADCHK5                                            BUG15042
     C                     MOVELADDRSS    W8LINS                          S01435
     C                     Z-ADD5         W8NLIN                          S01435
      *                                                                   S01435
      * Call expansion program                                            S01435
      *                                                                   S01435
     C                     CALL 'FT0315'               9090               S01435
     C                     PARM           W8RTN   7                       S01435
     C                     PARM           W8FT                            S01435
     C                     PARM           W8LINS256                       S01435
     C                     PARM           W8RPT 256                       S01435
     C                     PARM           W8MSG 256                       S01435
     C                     PARM           W8SCR 256                       S01435
      *                                                                   S01435
      * Database error if data not correct                                S01435
      *                                                                   S01435
     C           *IN90     IFEQ '1'                                       S01435
     C           W8RTN     ORNE *BLANKS                                   S01435
     C           *LOCK     IN   DLDA                                      S01435
     C                     MOVEL'FT0060'  DBPGM                           S01435
     C                     MOVEL'FT0315'  DBFILE           ***************S01435
     C                     Z-ADD93        DBASE            * DB ERROR 93 *S01435
     C                     MOVEL'*CALL'   DBKEY            ***************S01435
     C                     MOVE '*'       @RETC                           S01435
     C                     OUT  DLDA                                      S01435
     C                     SETON                     U7U8LR               S01435
     C                     DUMP                                           S01435
     C                     RETRN                                          S01435
     C                     END                                            S01435
      *                                                                   S01435
     C                     MOVELW8SCR     ADDRSS                          S01435
     C                     MOVELADCHK1    SRCO1                           S01435
     C                     MOVELADCHK2    SRCO2                           S01435
     C                     MOVELADCHK3    SRCO3                           S01435
     C                     MOVELADCHK4    SRCO4                           S01435
     C                     MOVELADCHK5    SRCO5                           S01435
      *                                                                   CFT014
      ** Format Third Reimbursement Institution.                          CFT014
      *                                                                   CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
      *                                                                   CFT014
     C           CFT004    IFEQ 'Y'                                       CFT014
     C           OPTRIT    ANDEQ'I'                                       CFT014
     C                     MOVE *BLANK    W8CRIT                          CFT014
     C                     ELSE                                           CFT014
     C                     MOVEL'Y'       W8CRIT                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     MOVELOPTRIT    W8TYPE                          CFT014
     C                     MOVEL*BLANKS   W8LINS                          CFT014
     C                     MOVEL*BLANKS   ADDRSS                          CFT014
     C                     MOVELOPTRI1    ADCHK1                          CFT014
     C                     MOVELOPTRI2    ADCHK2                          CFT014
     C                     MOVELOPTRI3    ADCHK3                          CFT014
     C                     MOVELOPTRI4    ADCHK4                          CFT014
     C                     MOVELOPTRI5    ADCHK5                          CFT014
     C                     MOVELADDRSS    W8LINS                          CFT014
      *                                                                   CFT014
      ** Call expansion program.                                          CFT014
      *                                                                   CFT014
     C                     CALL 'FT0315'               9090               CFT014
     C                     PARM           W8RTN                           CFT014
     C                     PARM           W8FT                            CFT014
     C                     PARM           W8LINS                          CFT014
     C                     PARM           W8RPT                           CFT014
     C                     PARM           W8MSG                           CFT014
     C                     PARM           W8SCR                           CFT014
      *                                                                   CFT014
      ** Database error if data not correct.                              CFT014
      *                                                                   CFT014
     C           *IN90     IFEQ '1'                                       CFT014
     C           W8RTN     ORNE *BLANKS                                   CFT014
     C           *LOCK     IN   DLDA                                      CFT014
     C                     Z-ADD075       DBASE                           CFT014
     C                     MOVEL'*CALL'   DBKEY                           CFT014
     C                     MOVEL'FT0315'  DBFILE                          CFT014
     C                     MOVEL'FT0060'  DBPGM                           CFT014
     C                     MOVE '*'       @RETC                           CFT014
     C                     OUT  DLDA                                      CFT014
     C                     SETON                     U7U8LR               CFT014
     C                     DUMP                                           CFT014
     C                     RETRN                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     MOVELW8SCR     ADDRSS                          CFT014
     C                     MOVELADCHK1    STRI1                           CFT014
     C                     MOVELADCHK2    STRI2                           CFT014
     C                     MOVELADCHK3    STRI3                           CFT014
     C                     MOVELADCHK4    STRI4                           CFT014
     C                     MOVELADCHK5    STRI5                           CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   S01435
      *  Account with Institution                                         S01435
      *                                                                   S01435
     C           CFT004    IFEQ 'Y'                                       CFT004
     C           ACBT      ANDEQ'I'                                       CFT004
     C                     MOVE *BLANK    W8CRIT                          CFT004
     C                     ELSE                                           CFT004
     C                     MOVEL'Y'       W8CRIT                          CFT004
     C                     ENDIF                                          CFT004
     C                     MOVELACBT      W8TYPE                          S01435
     C                     MOVEL*BLANKS   ADDRSS                          S01435
     C                     MOVELACB1      ADCHK1                          S01435
     C                     MOVELACB2      ADCHK2                          S01435
     C                     MOVELACB3      ADCHK3                          S01435
     C                     MOVELACB4      ADCHK4                          S01435
     C                     MOVELACB5      ADCHK5                          S01435
     C                     MOVELADDRSS    W8LINS                          S01435
      *                                                                   S01435
      * Call expansion program                                            S01435
      *                                                                   S01435
     C                     CALL 'FT0315'               9090               S01435
     C                     PARM           W8RTN   7                       S01435
     C                     PARM           W8FT                            S01435
     C                     PARM           W8LINS256                       S01435
     C                     PARM           W8RPT 256                       S01435
     C                     PARM           W8MSG 256                       S01435
     C                     PARM           W8SCR 256                       S01435
      *                                                                   S01435
      * Database error if data not correct                                S01435
      *                                                                   S01435
     C           *IN90     IFEQ '1'                                       S01435
     C           W8RTN     ORNE *BLANKS                                   S01435
     C           *LOCK     IN   DLDA                                      S01435
     C                     MOVEL'FT0060'  DBPGM                           S01435
     C                     MOVEL'FT0315'  DBFILE           ***************S01435
     C                     Z-ADD94        DBASE            * DB ERROR 94 *S01435
     C                     MOVEL'*CALL'   DBKEY            ***************S01435
     C                     MOVE '*'       @RETC                           S01435
     C                     OUT  DLDA                                      S01435
     C                     SETON                     U7U8LR               S01435
     C                     DUMP                                           S01435
     C                     RETRN                                          S01435
     C                     END                                            S01435
      *                                                                   S01435
     C                     MOVELW8SCR     ADDRSS                          S01435
     C                     MOVELADCHK1    SACB1                           S01435
     C                     MOVELADCHK2    SACB2                           S01435
     C                     MOVELADCHK3    SACB3                           S01435
     C                     MOVELADCHK4    SACB4                           S01435
     C                     MOVELADCHK5    SACB5                           S01435
      *                                                                   S01435
      *  Beneficiary                                                      S01435
     C/COPY WNCPYSRC,FT0060C104
      *                                                                   S01435
     C           CFT004    IFEQ 'Y'                                       CFT004
     C           BNCT      ANDEQ'I'                                       CFT004
     C                     MOVE *BLANK    W8CRIT                          CFT004
     C                     ELSE                                           CFT004
     C                     MOVEL'Y'       W8CRIT                          CFT004
     C                     ENDIF                                          CFT004
     C                     MOVELBNCT      W8TYPE                          S01435
     C                     MOVEL*BLANKS   ADDRSS                          S01435
     C                     MOVELBNC1      ADCHK1                          S01435
     C                     MOVELBNC2      ADCHK2                          S01435
     C                     MOVELBNC3      ADCHK3                          S01435
     C                     MOVELBNC4      ADCHK4                          S01435
     C                     MOVELBNC5      ADCHK5                          S01435
     C                     MOVELADDRSS    W8LINS                          S01435
      *                                                                   S01435
      * Call expansion program                                            S01435
      *                                                                   S01435
     C                     CALL 'FT0315'               9090               S01435
     C                     PARM           W8RTN   7                       S01435
     C                     PARM           W8FT                            S01435
     C                     PARM           W8LINS256                       S01435
     C                     PARM           W8RPT 256                       S01435
     C                     PARM           W8MSG 256                       S01435
     C                     PARM           W8SCR 256                       S01435
      *                                                                   S01435
      * Database error if data not correct                                S01435
      *                                                                   S01435
     C           *IN90     IFEQ '1'                                       S01435
     C           W8RTN     ORNE *BLANKS                                   S01435
     C           *LOCK     IN   DLDA                                      S01435
     C                     MOVEL'FT0060'  DBPGM                           S01435
     C                     MOVEL'FT0315'  DBFILE           ***************S01435
     C                     Z-ADD95        DBASE            * DB ERROR 95 *S01435
     C                     MOVEL'*CALL'   DBKEY            ***************S01435
     C                     MOVE '*'       @RETC                           S01435
     C                     OUT  DLDA                                      S01435
     C                     SETON                     U7U8LR               S01435
     C                     DUMP                                           S01435
     C                     RETRN                                          S01435
     C                     END                                            S01435
      *                                                                   S01435
     C                     MOVELW8SCR     ADDRSS                          S01435
     C                     MOVELADCHK1    SBNC1                           S01435
     C                     MOVELADCHK2    SBNC2                           S01435
     C                     MOVELADCHK3    SBNC3                           S01435
     C                     MOVELADCHK4    SBNC4                           S01435
     C                     MOVELADCHK5    SBNC5                           S01435
     C/COPY WNCPYSRC,FT0060C105
      *                                                                   S01435
      *  Intermediary Bank                                                S01435
      *                                                                   S01435
     C           CFT004    IFEQ 'Y'                                       CFT004
     C           INBT      ANDEQ'I'                                       CFT004
     C                     MOVE *BLANK    W8CRIT                          CFT004
     C                     ELSE                                           CFT004
     C                     MOVEL'Y'       W8CRIT                          CFT004
     C                     ENDIF                                          CFT004
     C                     MOVELINBT      W8TYPE                          S01435
     C                     MOVEL*BLANKS   ADDRSS                          S01435
     C                     MOVELINB1      ADCHK1                          S01435
     C                     MOVELINB2      ADCHK2                          S01435
     C                     MOVELINB3      ADCHK3                          S01435
     C                     MOVELINB4      ADCHK4                          S01435
     C                     MOVELINB5      ADCHK5                          S01435
     C                     MOVELADDRSS    W8LINS                          S01435
      *                                                                   S01435
      * Call expansion program                                            S01435
      *                                                                   S01435
     C                     CALL 'FT0315'               9090               S01435
     C                     PARM           W8RTN   7                       S01435
     C                     PARM           W8FT                            S01435
     C                     PARM           W8LINS256                       S01435
     C                     PARM           W8RPT 256                       S01435
     C                     PARM           W8MSG 256                       S01435
     C                     PARM           W8SCR 256                       S01435
      *                                                                   S01435
      * Database error if data not correct                                S01435
      *                                                                   S01435
     C           *IN90     IFEQ '1'                                       S01435
     C           W8RTN     ORNE *BLANKS                                   S01435
     C           *LOCK     IN   DLDA                                      S01435
     C                     MOVEL'FT0060'  DBPGM                           S01435
     C                     MOVEL'FT0315'  DBFILE           ***************S01435
     C                     Z-ADD96        DBASE            * DB ERROR 96 *S01435
     C                     MOVEL'*CALL'   DBKEY            ***************S01435
     C                     MOVE '*'       @RETC                           S01435
     C                     OUT  DLDA                                      S01435
     C                     SETON                     U7U8LR               S01435
     C                     DUMP                                           S01435
     C                     RETRN                                          S01435
     C                     END                                            S01435
      *                                                                   S01435
     C                     MOVELW8SCR     ADDRSS                          S01435
     C                     MOVELADCHK1    SINB1                           S01435
     C                     MOVELADCHK2    SINB2                           S01435
     C                     MOVELADCHK3    SINB3                           S01435
     C                     MOVELADCHK4    SINB4                           S01435
     C                     MOVELADCHK5    SINB5                           S01435
      *                                                                   S01435
      * =*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*  CFT009
     C           CFT009    IFEQ 'Y'                                       CFT009
      *                                                                   CFT009
      *                                                                   CFT009
     C                     MOVELPREF      PREF                            CFT009
      *                                                                   CFT009
      * GET EXTENSION FILE RECORD                                         CFT009
     C           PREF      CHAINOTPAYXL0             97                   CFT009
     C           *IN97     IFEQ *ON                                       CFT009
     C           *LOCK     IN   DLDA                                      CFT009
     C                     MOVE 'FT0060'  DBPGM                           CFT009
     C                     MOVE 'OTPAYXPD'DBFILE           ***************CFT009
     C                     Z-ADD1         DBASE            * DB ERROR 01 *CFT009
     C                     MOVELPREF      DBKEY            ***************CFT009
     C                     MOVE '*'       @RETC                           CFT009
     C                     OUT  DLDA                                      CFT009
     C                     SETON                     U7U8LR               CFT009
     C                     DUMP                                           CFT009
      *                                                                   CFT009
      *  Allocate dataarea to blanks                                      CFT009
      *                                                                   CFT009
     C                     EXSR DALLOC                                    CFT009
      *                                                                   CFT009
     C                     RETRN                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      * BASE DATA                                                         CFT009
     C                     MOVELCDRO      SCDRO                           CFT009
     C                     MOVELCDBR      SCDBR                           CFT009
     C           CFT120    IFEQ 'Y'                                                           CFT120
     C                     MOVELCDRC      SCDRC                                               CFT120
     C                     ENDIF                                                              CFT120
     C                     MOVELDTCH      DTCH                            CFT009
     C                     MOVELFXSRSC    SSSRCD                          CFT009
     C                     MOVELOTPDOF    SSPDOF                          CFT009
      *                                                                   CFT009
      * CODES                                                             CFT009
     C                     MOVELTFCCCD    TRCDE                           CFT009
     C                     MOVELTLXCDE    TXCDE                           CFT009
     C                     MOVELCHQCHC    CQCDE                           CFT009
     C                     MOVELCACHCD    CACDE                           CFT009
     C                     MOVELSSTCCD    STCDE                           CFT009
     C                     MOVELSPRCCD    SPCDE                           CFT009
     C                     MOVELMSCHC     MSCDE                           CFT009
     C                     MOVELMSCHC1    M1CDE                           CFT009
     C                     MOVELMSCHC2    M2CDE                           CFT009
     C                     MOVELMSCHC3    M3CDE                           CFT009
     C                     MOVELMSCHC4    M4CDE                           CFT009
     C                     MOVELMSCHC5    M5CDE                           CFT009
     C                     MOVELFXCACC    FXCDE                           CFT009
      *                                                                   CFT009
      * PAY / SETTLE CCY                                                  CFT009
     C                     SELEC                                          CFT009
     C***********CDRO      WHNE 0                                         CFT009              CSD027
     C           CDRO      WHNE *BLANKS                                                       CSD027
      *                                                                                       CFT120
      **  If Charges to the DR of Currency, use instead of Base                               CFT120
      *                                                                                       CFT120
     C                     MOVELBCCY      WTRNCY  3                       CFT009
     C           CDRC      IFNE *BLANKS                                                       CFT120
     C           CFT120    ANDEQ'Y'                                                           CFT120
     C                     MOVELCDRC      WTRNCY                                              CFT120
     C                     ENDIF                                                              CFT120
      *                                                                   CFT009
     C           BTCHCY    WHEQ 'L'                                       CFT009
     C                     MOVELLOCY      WTRNCY                          CFT009
      *                                                                   CFT009
     C           ADDC      WHEQ 'A'                                       CFT009
     C                     MOVELSMCY      WTRNCY                          CFT009
      *                                                                   CFT009
     C                     OTHER                                          CFT009
      *                                                                   CFT009
     C                     MOVELPCCY      WTRNCY                          CFT009
      *                                                                   CFT009
     C                     ENDSL                                          CFT009
      *                                                                   CFT009
     C                     MOVELWTRNCY    CCYA                            CFT009
     C                     MOVELWTRNCY    CCYB                            CFT009
     C                     MOVELWTRNCY    CCYC                            CFT009
     C                     MOVELWTRNCY    CCYD                            CFT009
     C                     MOVELWTRNCY    CCYE                            CFT009
     C                     MOVELWTRNCY    CCYF                            CFT009
     C                     MOVELWTRNCY    CCYG                            CFT009
     C                     MOVELWTRNCY    RCY9                            CFT009
     C                     MOVELWTRNCY    RCY10                           CFT009
     C                     MOVELWTRNCY    RCY11                           CFT009
     C                     MOVELWTRNCY    RCY12                           CFT009
     C                     MOVELWTRNCY    RCY13                           CFT009
     C                     MOVELWTRNCY    RCY14                           CFT009
      *                                                                   CFT009
      * CHARGE CURRENCY                                                   CFT009
      *                                                                   CFT009
     C                     MOVE OPCHGC    CCY1                            CFT009
     C                     MOVE OPCHGC    CCY2                            CFT009
     C                     MOVE OPCHGC    CCY3                            CFT009
     C                     MOVE OPCHGC    CCY4                            CFT009
     C                     MOVE OPCHGC    CCY5                            CFT009
     C                     MOVE OPCHGC    CCY6                            CFT009
     C                     MOVE OPCHGC    CCY7                            CFT009
     C                     MOVE OPCHGC    CCY8                            CFT009
     C                     MOVE OPCHGC    CCY9                            CFT009
     C                     MOVE OPCHGC    CCY10                           CFT009
     C                     MOVE OPCHGC    CCY11                           CFT009
     C                     MOVE OPCHGC    CCY12                           CFT009
     C                     MOVE OPCHGC    CCY13                           CFT009
     C                     MOVE OPCHGC    CCY14                           CFT009
      *                                                                   CFT009
      * FORMAT AMOUNTS                                                    CFT009
      * CHARGE AMOUNTS                                                    CFT009
     C*                                                                   CFT009
     C** Call to access pgm for currency  details LEVIED CCY              CFT009
     C*                                                                   CFT009
     C                     CALL 'AOCURRR0'                                CFT009
     C                     PARM '*DBERR ' @RTCD                           CFT009
     C                     PARM '*KEY   ' @OPTN                           CFT009
     C                     PARM WTRNCY    @CCY    3                       CFT009
     C           SDCURR    PARM SDCURR    DSSDY                           CFT009
      *                                                                   CFT009
      * Save decimal places                                               CFT009
     C           *LIKE     DEFN A6NBDP    TRNDCP                          CFT009
     C                     Z-ADDA6NBDP    TRNDCP                          CFT009
      *                                                                   CFT009
      * Transfer Commission                                               CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE TRCM      ZFIELD                          CFT009
     C                     Z-ADDTRNDCP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    TRCMA                           CFT009
      *                                                                   CFT009
      * FX/CHANGE COMMISSION                                              CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE OPCHCM    ZFIELD                          CFT009
     C                     Z-ADDTRNDCP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    CHCMA                           CFT009
      *                                                                   CFT009
      * TELEX CHARGE                                                      CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE TXCH      ZFIELD                          CFT009
     C                     Z-ADDTRNDCP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    TXCHA                           CFT009
      * CHEQUE CHARGE                                                     CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE CQCH      ZFIELD                          CFT009
     C                     Z-ADDTRNDCP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    CQCHA                           CFT009
      *                                                                   CFT009
      * COSTS ABROAD                                                      CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE CSTA      ZFIELD                          CFT009
     C                     Z-ADDTRNDCP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    CSTAA                           CFT009
      *                                                                   CFT009
      * SWIFT STANDARD CHARGE                                             CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE SWSCHG    ZFIELD                          CFT009
     C                     Z-ADDTRNDCP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    STCH                            CFT009
      *                                                                   CFT009
      * SWIFT PRIORITY CHARGE                                             CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE SPCH      ZFIELD                          CFT009
     C                     Z-ADDTRNDCP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    SPCHA                           CFT009
      *                                                                   CFT009
      * MISCELLANEOUS CHARGE                                              CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE MSCH      ZFIELD                          CFT009
     C                     Z-ADDTRNDCP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    MSCHA                           CFT009
      *                                                                   CFT009
      * MISCELLANEOUS CHARGE 1                                            CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE MISC01    ZFIELD                          CFT009
     C                     Z-ADDTRNDCP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    M1CH                            CFT009
      *                                                                   CFT009
      * MISCELLANEOUS CHARGE 2                                            CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE MISC02    ZFIELD                          CFT009
     C                     Z-ADDTRNDCP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    M2CH                            CFT009
      *                                                                   CFT009
      * MISCELLANEOUS CHARGE 3                                            CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE MISC03    ZFIELD                          CFT009
     C                     Z-ADDTRNDCP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    M3CH                            CFT009
      *                                                                   CFT009
      * MISCELLANEOUS CHARGE 4                                            CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE MISC04    ZFIELD                          CFT009
     C                     Z-ADDTRNDCP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    M4CH                            CFT009
      *                                                                   CFT009
      * MISCELLANEOUS CHARGE 5                                            CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE MISC05    ZFIELD                          CFT009
     C                     Z-ADDTRNDCP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    M5CH                            CFT009
      *                                                                   CFT009
      * VAT                                                               CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE OPVATT    ZFIELD                          CFT009
     C                     Z-ADDTRNDCP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    VATTA                           CFT009
      *                                                                   CFT009
      * SETTLE / PAY AMOUNTS                                              CFT009
     C           *LIKE     DEFN A6NBDP    CHGDCP                          CFT009
      *                                                                   CFT009
      * Convert between settlement currency and changes currency.         CFT009
      * Calculate exchange rate.  Then convert.                           CFT009
      *                                                                   CFT009
     C                     CALL 'AOCURRR0'                                CFT009
     C                     PARM '*DBERR ' @RTCD                           CFT009
     C                     PARM '*KEY   ' @OPTN                           CFT009
     C                     PARM OPCHGC    @CCY    3                       CFT009
     C           SDCURR    PARM SDCURR    DSSDY                           CFT009
     C                     Z-ADDA6NBDP    CHGDCP                          CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE DUMA1     ZFIELD                          CFT009
     C                     Z-ADDCHGDCP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    TRCML                           CFT009
      *                                                                   CFT009
      * Convert FX / Change Commission                                    CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE OPDUM7    ZFIELD                          CFT009
     C                     Z-ADDCHGDCP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    CHCML                           CFT009
      *                                                                   CFT009
      * Convert Telex Charge                                              CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE DUMA2     ZFIELD                          CFT009
     C                     Z-ADDCHGDCP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    TXCHL                           CFT009
      *                                                                   CFT009
      * Convert Cheque Charge                                             CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE DUMA3     ZFIELD                          CFT009
     C                     Z-ADDCHGDCP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    CQCHL                           CFT009
      *                                                                   CFT009
      * Convert Costs Abroad                                              CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE DUMA4     ZFIELD                          CFT009
     C                     Z-ADDCHGDCP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    CSTAL                           CFT009
      * Convert Swift Standard Charge                                     CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE SWSCCC    ZFIELD                          CFT009
     C                     Z-ADDCHGDCP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    STCD                            CFT009
      *                                                                   CFT009
      * Convert Swift Priority Charge                                     CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE DUMA5     ZFIELD                          CFT009
     C                     Z-ADDCHGDCP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    SPCHL                           CFT009
      *                                                                   CFT009
      * Convert Miscellaneous Charge                                      CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE DUMA6     ZFIELD                          CFT009
     C                     Z-ADDCHGDCP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    MSCHL                           CFT009
      * Convert Miscellaneous Charge 1                                    CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE MISCC1    ZFIELD                          CFT009
     C                     Z-ADDCHGDCP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    M1CD                            CFT009
      *                                                                   CFT009
      * Convert Miscellaneous Charge 2                                    CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE MISCC2    ZFIELD                          CFT009
     C                     Z-ADDCHGDCP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    M2CD                            CFT009
      * Convert Miscellaneous Charge 3                                    CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE MISCC3    ZFIELD                          CFT009
     C                     Z-ADDCHGDCP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    M3CD                            CFT009
      * Convert Miscellaneous Charge 4                                    CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE MISCC4    ZFIELD                          CFT009
     C                     Z-ADDCHGDCP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    M4CD                            CFT009
      *                                                                   CFT009
      * Convert Miscellaneous Charge 5                                    CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE MISCC5    ZFIELD                          CFT009
     C                     Z-ADDCHGDCP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    M5CD                            CFT009
      *                                                                   CFT009
      * Convert V.A.T. amount                                             CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE OPDUM8    ZFIELD                          CFT009
     C                     Z-ADDCHGDCP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    VATTL                           CFT009
      *                                                                   CFT009
      *                                                                   CFT009
      * VAT FLAG INDICATORS                                               CFT009
     C           CFT010    IFEQ 'Y'                                       CFT009
     C                     MOVE VMIC1     VAT9                            CFT009
     C                     MOVE VMIC2     VAT10                           CFT009
     C                     MOVE VMIC3     VAT11                           CFT009
     C                     MOVE VMIC4     VAT12                           CFT009
     C                     MOVE VMIC5     VAT13                           CFT009
     C                     MOVE VTSWSC    VAT14                           CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      * MISCELLANEOUS CHARGE DESCRIPTIONS                                 CFT009
      *                                                                   CFT009
     C           M1CDE     IFNE *BLANKS                                   CFT009
     C           M1CDE     CHAINFTPCHGL0             90                   CFT009
     C           *IN90     IFEQ '0'                                       CFT009
     C                     MOVELCHDESC    M1DESC                          CFT009
     C                     ENDIF                                          CFT009
     C                     ELSE                                           CFT009
     C           CER049    IFEQ 'Y'                                                           CER049
     C                     MOVELSTMP,1    M1DESC                                              CER049
     C                     ELSE                                                               CER049
     C                     MOVELDESC,1    M1DESC                          CFT009
     C                     ENDIF                                                              CER049
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C           M2CDE     IFNE *BLANKS                                   CFT009
     C           M2CDE     CHAINFTPCHGL0             90                   CFT009
     C           *IN90     IFEQ '0'                                       CFT009
     C                     MOVELCHDESC    M2DESC                          CFT009
     C                     ENDIF                                          CFT009
     C                     ELSE                                           CFT009
     C           CER049    IFEQ 'Y'                                                           CER049
     C                     MOVELSTMP,2    M2DESC                                              CER049
     C                     ELSE                                                               CER049
     C                     MOVELDESC,2    M2DESC                          CFT009
     C                     ENDIF                                                              CER049
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C           M3CDE     IFNE *BLANKS                                   CFT009
     C           M3CDE     CHAINFTPCHGL0             90                   CFT009
     C           *IN90     IFEQ '0'                                       CFT009
     C                     MOVELCHDESC    M3DESC                          CFT009
     C                     ENDIF                                          CFT009
     C                     ELSE                                           CFT009
     C           CER049    IFEQ 'Y'                                                           CER049
     C                     MOVELSTMP,3    M3DESC                                              CER049
     C                     ELSE                                                               CER049
     C                     MOVELDESC,3    M3DESC                          CFT009
     C                     ENDIF                                                              CER049
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C           M4CDE     IFNE *BLANKS                                   CFT009
     C           M4CDE     CHAINFTPCHGL0             90                   CFT009
     C           *IN90     IFEQ '0'                                       CFT009
     C                     MOVELCHDESC    M4DESC                          CFT009
     C                     ENDIF                                          CFT009
     C                     ELSE                                           CFT009
     C           CER049    IFEQ 'Y'                                                           CER049
     C                     MOVELSTMP,4    M4DESC                                              CER049
     C                     ELSE                                                               CER049
     C                     MOVELDESC,4    M4DESC                          CFT009
     C                     ENDIF                                                              CER049
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C           M5CDE     IFNE *BLANKS                                   CFT009
     C           M5CDE     CHAINFTPCHGL0             90                   CFT009
     C           *IN90     IFEQ '0'                                       CFT009
     C                     MOVELCHDESC    M5DESC                          CFT009
     C                     ENDIF                                          CFT009
     C                     ELSE                                           CFT009
     C           CER049    IFEQ 'Y'                                                           CER049
     C                     MOVELSTMP,5    M5DESC                                              CER049
     C                     ELSE                                                               CER049
     C                     MOVELDESC,5    M5DESC                          CFT009
     C                     ENDIF                                                              CER049
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
     C/COPY WNCPYSRC,FT0060C106
      *                                                                   CFT009
     C                     ENDSR
     C********************************************************************
     C* END OF REFORMAT FOR OUTGOING PAYMENTS SUBROUTINE
     C********************************************************************
     C/COPY WNCPYSRC,FT0060C041
     C/EJECT
     C********************************************************************
     C*
     C*    CVRTIN SR.  TO REFORMAT FIELDS FOR INCOMING PAYMENTS
     C*
     C           CVRTIN    BEGSR
     C**
     C*   ACCOUNT WITH BANK CAN BE A NOSTRO NUMBER A RETAIL NUMBER OR
     C*     A PARTIAL ACCOUNT IDENTIFIER
     C**
     C                     MOVE *BLANKS   SACBK
     C*
     C           ACBT      IFEQ 'N'
     C                     MOVELACBK      WORK02  2
     C                     MOVELWORK02    SACBK
     C                     END
     C*
     C           ACBT      IFEQ 'R'
     C                     MOVELACBK      WORK10 10
     C                     MOVELWORK10    SACBK
     C                     END
     C*
     C           ACBT      IFEQ 'P'
     C           ACBT      OREQ 'S'
     C                     MOVELACBK      SACBK
     C                     END
     C                     SELEC                                                              CFT145
     C           ACBT      WHEQ 'N'                                                           CFT145
     C                     EXSR TBLKEY                                                        CFT145
     C                     MOVELA7CUST    WWODCN  6                                           CFT145
     C           ACBT      WHEQ 'R'                                                           CFT145
      *                                                                                       CFT145
      ** Save Booking Branch to stop overwriting if ACNUMA accessed                           CFT145
      *                                                                                       CFT145
     C                     MOVE BRCA      SVBRC   3                                           CFT145
     C                     EXSR ACNKEY                                                        CFT145
     C                     MOVELCNUM      WWODCN  6                                           CFT145
      *                                                                                       CFT145
      ** Restore branch value                                                                 CFT145
      *                                                                                       CFT145
     C                     MOVE SVBRC     BRCA                                                CFT145
     C           ACBT      WHEQ 'P'                                                           CFT145
     C                     MOVELACBK      WWODCN  6                                           CFT145
     C                     ENDSL                                                              CFT145
     C*                                                                   S01117
     C** Set up screen field -- A/C with bank branch                      S01117
     C           ACBT      IFEQ 'P'                                       S01117
     C                     MOVELACBB      SACBB                           S01117
     C                     END                                            S01117
     C*
     C           ACBT      IFEQ 'C'
     C                     MOVELACBK      WORK06  6
     C                     MOVELWORK06    SACBK
     C                     END
     C***********                                                         CFT014
     C****RECEIVER'S*CORRESPONDENT*CAN*BE*A*NOSTRO*NUMBER*OR*A*RETAIL*NUM CFT014
     C***********                                                         CFT014
     C***********          MOVE *BLANKS   SRCCO                           CFT014
     C***********                                                         CFT014
     C***********RCRT      IFEQ 'N'                                       CFT014
     C***********          MOVELRCCO      WORK02  2                       CFT014
     C***********          MOVELWORK02    SRCCO                           CFT014
     C***********          END                                            CFT014
     C***********                                                         CFT014
     C***********RCRT      IFEQ 'R'                                       CFT014
     C***********          MOVELRCCO      SRCCO                           CFT014
     C***********          END                                            CFT014
     C**
     C*   CHARGES TO THE DEBIT OF ACCOUNT CAN BE A NOSTRO NUMBER
     C*     A RETAIL NUMBER  OR A PARTIAL ACCOUNT IDENTIFIER
     C**
     C                     MOVE *BLANKS   SCDRO
     C*
     C           CDRT      IFEQ 'N'
     C                     MOVELCDRO      WORK02  2
     C                     MOVELWORK02    SCDRO
     C                     END
     C*
     C           CDRT      IFEQ 'R'
     C                     MOVELCDRO      WORK10 10
     C                     MOVELWORK10    SCDRO
     C                     END
     C*
     C           CDRT      IFEQ 'P'
     C                     MOVELCDRO      SCDRO
     C/COPY WNCPYSRC,FT0060C015
     C** Set up screen field -- Charges to the debit of branch            S01117
     C                     MOVELCDBR      SCDBR                           S01117
     C                     END
      *                                                                                       CFT145
     C                     MOVE *BLANKS   SVACBK 18                                           CFT145
     C                     SELEC                                                              CFT145
     C           CDRT      WHEQ 'N'                                                           CFT145
     C                     MOVELCDRO      WSKY1   2                                           CFT145
     C           CDRC      IFEQ *BLANKS                                                       CFT145
     C                     MOVE BJCYCD    @CCY                                                CFT145
     C                     ELSE                                                               CFT145
     C                     MOVE CDRC      @CCY                                                CFT145
     C                     ENDIF                                                              CFT145
      *                                                                                       CFT145
      ** Call to access pgm for nostro details                                                CFT145
      *                                                                                       CFT145
     C                     CALL 'AONOSTR0'                                                    CFT145
     C                     PARM '*DBERR ' @RTCD                                               CFT145
     C                     PARM '*KEY   ' @OPTN                                               CFT145
     C                     PARM *BLANKS   @CUST   6                                           CFT145
     C                     PARM           @CCY    3                                           CFT145
     C                     PARM *BLANKS   @ACCD  10                                           CFT145
     C                     PARM *BLANKS   @ACSN   2                                           CFT145
     C                     PARM WSKY1     @NONB   2                                           CFT145
     C                     PARM *BLANKS   @BRCD   3                                           CFT145
     C                     PARM *BLANKS   @CSSN  10                                           CFT145
     C                     PARM *BLANKS   @PNOI   1                                           CFT145
     C           SDNOST    PARM SDNOST    DSFDY                                               CFT145
     C                     MOVELA7CUST    WWCDCN  6                                           CFT145
     C           CDRT      WHEQ 'R'                                                           CFT145
      *                                                                                       CFT145
      ** Save Booking Branch from to stop overwriting if ACNUMA accessed                      CFT145
      *                                                                                       CFT145
     C                     MOVE BRCA      SVBRC   3                                           CFT145
     C                     MOVELACBK      SVACBK 18                                           CFT145
     C                     MOVELCDRO      ACBK                                                CFT145
     C                     EXSR ACNKEY                                                        CFT145
     C                     MOVELCNUM      WWCDCN  6                                           CFT145
     C                     MOVELSVACBK    ACBK                                                CFT145
      *                                                                                       CFT145
      ** Restore branch value                                                                 CFT145
      *                                                                                       CFT145
     C                     MOVE SVBRC     BRCA                                                CFT145
     C           CDRT      WHEQ 'P'                                                           CFT145
     C                     MOVELCDRO      WWCDCN  6                                           CFT145
     C                     ENDSL                                                              CFT145
     C/COPY WNCPYSRC,FT0060C031
     C*
     C* DISPLAY SWIFT PRIORITY CODE AS : 'U' - URGENT OR 'N' - NORMAL.    S01117
     C*                                                                   S01117
     C           SWPC      IFEQ 1                                         S01117
     C                     MOVE 'U'       SSWPC                           S01117
     C                     ELSE                                           S01117
     C           SWPC      IFEQ 2                                         S01117
     C                     MOVE 'N'       SSWPC                           S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C*                                                                   S01117
      *                                                                   S01435
      *  Set up general parameters                                        S01435
      *                                                                   S01435
     C                     CLEARW8FT                                      S01435
     C                     MOVEL*BLANKS   W8STMT                          S01435
     C                     MOVEL##PGM     W8CPGM                          S01435
     C                     MOVEL'*ENQ'    W8ACT                           S01435
     C                     MOVELSMCY      W8CCY                           S01435
     C                     MOVEL'Y'       W8CRIT                          S01435
     C                     Z-ADD4         W8NLIN                          S01435
      *                                                                   S01435
      *  Sender                                                           S01435
      *                                                                   S01435
     C                     MOVELSNTP      W8TYPE                          S01435
     C                     MOVEL*BLANKS   ADDRSS                          S01435
     C                     MOVELSND1      ADCHK1                          S01435
     C                     MOVELSND2      ADCHK2                          S01435
     C                     MOVELSND3      ADCHK3                          S01435
     C                     MOVELSND4      ADCHK4                          S01435
     C                     MOVELSORC5     ADCHK5                                              CFT032
     C                     MOVELADDRSS    W8LINS                          S01435
      *                                                                   S01435
      * Call expansion program                                            S01435
      *                                                                   S01435
     C                     CALL 'FT0315'               9090               S01435
     C                     PARM           W8RTN   7                       S01435
     C                     PARM           W8FT                            S01435
     C                     PARM           W8LINS256                       S01435
     C                     PARM           W8RPT 256                       S01435
     C                     PARM           W8MSG 256                       S01435
     C                     PARM           W8SCR 256                       S01435
      *                                                                   S01435
      * Database error if data not correct                                S01435
      *                                                                   S01435
     C           *IN90     IFEQ '1'                                       S01435
     C           W8RTN     ORNE *BLANKS                                   S01435
     C           *LOCK     IN   DLDA                                      S01435
     C                     MOVEL'FT0060'  DBPGM                           S01435
     C                     MOVEL'FT0315'  DBFILE           ***************S01435
     C                     Z-ADD97        DBASE            * DB ERROR 97 *S01435
     C                     MOVEL'*CALL'   DBKEY            ***************S01435
     C                     MOVE '*'       @RETC                           S01435
     C                     OUT  DLDA                                      S01435
     C                     SETON                     U7U8LR               S01435
     C                     DUMP                                           S01435
     C                     RETRN                                          S01435
     C                     END                                            S01435
      *                                                                   S01435
     C                     MOVELW8SCR     ADDRSS                          S01435
     C                     MOVELADCHK1    SSND1                           S01435
     C                     MOVELADCHK2    SSND2                           S01435
     C                     MOVELADCHK3    SSND3                           S01435
     C                     MOVELADCHK4    SSND4                           S01435
     C                     MOVELADCHK5    SORC5                                               CFT032
     C                     Z-ADD5         W8NLIN                          S01435
      *                                                                   CFT014
      ** Receiver's Correspondent                                         CFT014
      *                                                                   CFT014
     C                     MOVELINRCRT    W8TYPE                          CFT014
     C                     MOVEL*BLANKS   W8LINS                          CFT014
     C                     MOVEL*BLANKS   ADDRSS                          CFT014
     C                     MOVELINRCO1    ADCHK1                          CFT014
     C                     MOVELINRCO2    ADCHK2                          CFT014
     C                     MOVELINRCO3    ADCHK3                          CFT014
     C                     MOVELINRCO4    ADCHK4                          CFT014
     C                     MOVELINRCO5    ADCHK5                          CFT014
     C                     MOVELADDRSS    W8LINS                          CFT014
      *                                                                   CFT014
      ** Call expansion program.                                          CFT014
      *                                                                   CFT014
     C                     CALL 'FT0315'               9090               CFT014
     C                     PARM           W8RTN                           CFT014
     C                     PARM           W8FT                            CFT014
     C                     PARM           W8LINS                          CFT014
     C                     PARM           W8RPT                           CFT014
     C                     PARM           W8MSG                           CFT014
     C                     PARM           W8SCR                           CFT014
      *                                                                   CFT014
      ** Database error if data not correct.                              CFT014
      *                                                                   CFT014
     C           *IN90     IFEQ '1'                                       CFT014
     C           W8RTN     ORNE *BLANKS                                   CFT014
     C           *LOCK     IN   DLDA                                      CFT014
     C                     Z-ADD076       DBASE                           CFT014
     C                     MOVEL'*CALL'   DBKEY                           CFT014
     C                     MOVEL'FT0315'  DBFILE                          CFT014
     C                     MOVEL'FT0060'  DBPGM                           CFT014
     C                     MOVE '*'       @RETC                           CFT014
     C                     OUT  DLDA                                      CFT014
     C                     SETON                     U7U8LR               CFT014
     C                     DUMP                                           CFT014
     C                     RETRN                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     MOVELW8SCR     ADDRSS                          CFT014
     C                     MOVELADCHK1    SRCO1                           CFT014
     C                     MOVELADCHK2    SRCO2                           CFT014
     C                     MOVELADCHK3    SRCO3                           CFT014
     C                     MOVELADCHK4    SRCO4                           CFT014
     C                     MOVELADCHK5    SRCO5                           CFT014
      *                                                                   S01435
      *  Beneficiary                                                      S01435
      *                                                                   S01435
     C                     MOVELBNCT      W8TYPE                          S01435
     C                     MOVELPCCY      W8CCY                           S01435
     C                     MOVEL*BLANKS   ADDRSS                          S01435
     C                     MOVELBNC1      ADCHK1                          S01435
     C                     MOVELBNC2      ADCHK2                          S01435
     C                     MOVELBNC3      ADCHK3                          S01435
     C                     MOVELBNC4      ADCHK4                          S01435
     C                     MOVELBNC5      ADCHK5                          S01435
     C                     MOVELADDRSS    W8LINS                          S01435
      *                                                                   S01435
      * Call expansion program                                            S01435
      *                                                                   S01435
     C                     CALL 'FT0315'               9090               S01435
     C                     PARM           W8RTN   7                       S01435
     C                     PARM           W8FT                            S01435
     C                     PARM           W8LINS256                       S01435
     C                     PARM           W8RPT 256                       S01435
     C                     PARM           W8MSG 256                       S01435
     C                     PARM           W8SCR 256                       S01435
      *                                                                   S01435
      * Database error if data not correct                                S01435
      *                                                                   S01435
     C           *IN90     IFEQ '1'                                       S01435
     C           W8RTN     ORNE *BLANKS                                   S01435
     C           *LOCK     IN   DLDA                                      S01435
     C                     MOVEL'FT0060'  DBPGM                           S01435
     C                     MOVEL'FT0315'  DBFILE           ***************S01435
     C                     Z-ADD102       DBASE            * DB ERROR 102*S01435
     C                     MOVEL'*CALL'   DBKEY            ***************S01435
     C                     MOVE '*'       @RETC                           S01435
     C                     OUT  DLDA                                      S01435
     C                     SETON                     U7U8LR               S01435
     C                     DUMP                                           S01435
     C                     RETRN                                          S01435
     C                     END                                            S01435
      *                                                                                       CFT145
     C                     MOVE *BLANKS   SVACBK 18                                           CFT145
     C                     SELEC                                                              CFT145
     C           BNCT      WHEQ 'N'                                                           CFT145
     C                     MOVELACBK      SVACBK 18                                           CFT145
     C                     MOVELBNC1      ACBK                                                CFT145
     C                     EXSR TBLKEY                                                        CFT145
     C                     MOVELA7CUST    WWODCN  6                                           CFT145
     C                     MOVELSVACBK    ACBK                                                CFT145
     C           BNCT      WHEQ 'R'                                                           CFT145
      *                                                                                       CFT145
      ** Save Booking Branch to stop overwriting if ACNUMA accessed                           CFT145
      *                                                                                       CFT145
     C                     MOVE BRCA      SVBRC   3                                           CFT145
     C                     MOVELACBK      SVACBK 18                                           CFT145
     C           1         SUBSTBNC1:1    SLSH                                                260694
     C           SLSH      IFNE '/'                                                           260694
     C                     MOVELBNC1      ACBK                                                CFT145
     C                     ELSE                                                               260694
     C           10        SUBSTBNC1:2    ACBK                                                260694
     C                     ENDIF                                                              260694
     C                     EXSR ACNKEY                                                        CFT145
     C                     MOVELCNUM      WWODCN  6                                           CFT145
     C                     MOVELSVACBK    ACBK                                                CFT145
      *                                                                                       CFT145
      ** Restore branch value                                                                 CFT145
      *                                                                                       CFT145
     C                     MOVE SVBRC     BRCA                                                CFT145
     C           BNCT      WHEQ 'P'                                                           CFT145
     C           1         SUBSTBNC1:1    SLSH                                                260694
     C           SLSH      IFNE '/'                                                           260694
     C                     MOVELBNC1      WWODCN  6                                           CFT145
     C                     ELSE                                                               260694
     C           6         SUBSTBNC1:2    WWODCN                                              260694
     C                     ENDIF                                                              260694
     C                     ENDSL                                                              CFT145
      *                                                                   S01435
     C                     MOVELW8SCR     ADDRSS                          S01435
     C                     MOVELADCHK1    SBNC1                           S01435
     C                     MOVELADCHK2    SBNC2                           S01435
     C                     MOVELADCHK3    SBNC3                           S01435
     C                     MOVELADCHK4    SBNC4                           S01435
     C                     MOVELADCHK5    SBNC5                           S01435
     C/COPY WNCPYSRC,FT0060C046
      *                                                                   S01435
      *  Ordering Bank                                                    S01435
      *                                                                   S01435
     C                     MOVELORBT      W8TYPE                          S01435
     C                     MOVEL*BLANKS   ADDRSS                          S01435
     C                     MOVELORB1      ADCHK1                          S01435
     C                     MOVELORB2      ADCHK2                          S01435
     C                     MOVELORB3      ADCHK3                          S01435
     C                     MOVELORB4      ADCHK4                          S01435
     C                     MOVELORB5      ADCHK5                          S01435
     C                     MOVELADDRSS    W8LINS                          S01435
      *                                                                   S01435
      * Call expansion program                                            S01435
      *                                                                   S01435
     C                     CALL 'FT0315'               9090               S01435
     C                     PARM           W8RTN   7                       S01435
     C                     PARM           W8FT                            S01435
     C                     PARM           W8LINS256                       S01435
     C                     PARM           W8RPT 256                       S01435
     C                     PARM           W8MSG 256                       S01435
     C                     PARM           W8SCR 256                       S01435
      *                                                                   S01435
      * Database error if data not correct                                S01435
      *                                                                   S01435
     C           *IN90     IFEQ '1'                                       S01435
     C           W8RTN     ORNE *BLANKS                                   S01435
     C           *LOCK     IN   DLDA                                      S01435
     C                     MOVEL'FT0060'  DBPGM                           S01435
     C                     MOVEL'FT0315'  DBFILE           ***************S01435
     C                     Z-ADD98        DBASE            * DB ERROR 98 *S01435
     C                     MOVEL'*CALL'   DBKEY            ***************S01435
     C                     MOVE '*'       @RETC                           S01435
     C                     OUT  DLDA                                      S01435
     C                     SETON                     U7U8LR               S01435
     C                     DUMP                                           S01435
     C                     RETRN                                          S01435
     C                     END                                            S01435
      *                                                                   S01435
     C                     MOVELW8SCR     ADDRSS                          S01435
     C                     MOVELADCHK1    SORB1                           S01435
     C                     MOVELADCHK2    SORB2                           S01435
     C                     MOVELADCHK3    SORB3                           S01435
     C                     MOVELADCHK4    SORB4                           S01435
     C                     MOVELADCHK5    SORB5                           S01435
      *                                                                   S01435
      *  Sender's Correspondent                                           S01435
      *                                                                   S01435
     C                     MOVELSNCT      W8TYPE                          S01435
     C                     MOVEL*BLANKS   ADDRSS                          S01435
     C                     MOVELSNC1      ADCHK1                          S01435
     C                     MOVELSNC2      ADCHK2                          S01435
     C                     MOVELSNC3      ADCHK3                          S01435
     C                     MOVELSNC4      ADCHK4                          S01435
     C                     MOVELSNC5      ADCHK5                          S01435
     C                     MOVELADDRSS    W8LINS                          S01435
      *                                                                   S01435
      * Call expansion program                                            S01435
      *                                                                   S01435
     C                     CALL 'FT0315'               9090               S01435
     C                     PARM           W8RTN   7                       S01435
     C                     PARM           W8FT                            S01435
     C                     PARM           W8LINS256                       S01435
     C                     PARM           W8RPT 256                       S01435
     C                     PARM           W8MSG 256                       S01435
     C                     PARM           W8SCR 256                       S01435
      *                                                                   S01435
      * Database error if data not correct                                S01435
      *                                                                   S01435
     C           *IN90     IFEQ '1'                                       S01435
     C           W8RTN     ORNE *BLANKS                                   S01435
     C           *LOCK     IN   DLDA                                      S01435
     C                     MOVEL'FT0060'  DBPGM                           S01435
     C                     MOVEL'FT0315'  DBFILE           ***************S01435
     C                     Z-ADD99        DBASE            * DB ERROR 99 *S01435
     C                     MOVEL'*CALL'   DBKEY            ***************S01435
     C                     MOVE '*'       @RETC                           S01435
     C                     OUT  DLDA                                      S01435
     C                     SETON                     U7U8LR               S01435
     C                     DUMP                                           S01435
     C                     RETRN                                          S01435
     C                     END                                            S01435
      *                                                                   S01435
     C                     MOVELW8SCR     ADDRSS                          S01435
     C                     MOVELADCHK1    SSNC1                           S01435
     C                     MOVELADCHK2    SSNC2                           S01435
     C                     MOVELADCHK3    SSNC3                           S01435
     C                     MOVELADCHK4    SSNC4                           S01435
     C                     MOVELADCHK5    SSNC5                           S01435
      *                                                                   S01435
      *  Ordering Customer                                                S01435
      *                                                                   S01435
     C                     MOVELORCT      W8TYPE                          S01435
     C                     MOVEL*BLANKS   ADDRSS                          S01435
     C                     MOVELORC1      ADCHK1                          S01435
     C                     MOVELORC2      ADCHK2                          S01435
     C                     MOVELORC3      ADCHK3                          S01435
     C                     MOVELORC4      ADCHK4                          S01435
     C**********           MOVEL*BLANKS   ADCHK5                                     S01435 BUG12704
     C                     MOVELORC5      ADCHK5                                            BUG12704
     C                     MOVELADDRSS    W8LINS                          S01435
      *                                                                   S01435
      * Call expansion program                                            S01435
      *                                                                   S01435
     C                     CALL 'FT0315'               9090               S01435
     C                     PARM           W8RTN   7                       S01435
     C                     PARM           W8FT                            S01435
     C                     PARM           W8LINS256                       S01435
     C                     PARM           W8RPT 256                       S01435
     C                     PARM           W8MSG 256                       S01435
     C                     PARM           W8SCR 256                       S01435
      *                                                                   S01435
     C                     MOVELW8SCR     ADDRSS                          S01435
     C                     MOVELADCHK1    SORC1                           S01435
     C                     MOVELADCHK2    SORC2                           S01435
     C                     MOVELADCHK3    SORC3                           S01435
     C                     MOVELADCHK4    SORC4                           S01435
     C                     MOVELADCHK5    SORC5                                             BUG12704
      *                                                                   S01435
      * Database error if data not correct                                S01435
      *                                                                   S01435
     C           *IN90     IFEQ '1'                                       S01435
     C           W8RTN     ORNE *BLANKS                                   S01435
     C           *LOCK     IN   DLDA                                      S01435
     C                     MOVEL'FT0060'  DBPGM                           S01435
     C                     MOVEL'FT0315'  DBFILE           ***************S01435
     C                     Z-ADD100       DBASE            * DB ERROR 100*S01435
     C                     MOVEL'*CALL'   DBKEY            ***************S01435
     C                     MOVE '*'       @RETC                           S01435
     C                     OUT  DLDA                                      S01435
     C                     SETON                     U7U8LR               S01435
     C                     DUMP                                           S01435
     C                     RETRN                                          S01435
     C                     END                                            S01435
      *                                                                   S01435
      *  Intermediary Bank                                                S01435
      *                                                                   S01435
     C                     MOVELINBT      W8TYPE                          S01435
     C                     MOVEL*BLANKS   ADDRSS                          S01435
     C                     MOVELINB1      ADCHK1                          S01435
     C                     MOVELINB2      ADCHK2                          S01435
     C                     MOVELINB3      ADCHK3                          S01435
     C                     MOVELINB4      ADCHK4                          S01435
     C                     MOVELINB5      ADCHK5                          S01435
     C                     MOVELADDRSS    W8LINS                          S01435
      *                                                                   S01435
      * Call expansion program                                            S01435
      *                                                                   S01435
     C                     CALL 'FT0315'               9090               S01435
     C                     PARM           W8RTN   7                       S01435
     C                     PARM           W8FT                            S01435
     C                     PARM           W8LINS256                       S01435
     C                     PARM           W8RPT 256                       S01435
     C                     PARM           W8MSG 256                       S01435
     C                     PARM           W8SCR 256                       S01435
      *                                                                   S01435
      * Database error if data not correct                                S01435
      *                                                                   S01435
     C           *IN90     IFEQ '1'                                       S01435
     C           W8RTN     ORNE *BLANKS                                   S01435
     C           *LOCK     IN   DLDA                                      S01435
     C                     MOVEL'FT0060'  DBPGM                           S01435
     C                     MOVEL'FT0315'  DBFILE           ***************S01435
     C                     Z-ADD101       DBASE            * DB ERROR 101*S01435
     C                     MOVEL'*CALL'   DBKEY            ***************S01435
     C                     MOVE '*'       @RETC                           S01435
     C                     OUT  DLDA                                      S01435
     C                     SETON                     U7U8LR               S01435
     C                     DUMP                                           S01435
     C                     RETRN                                          S01435
     C                     END                                            S01435
      *                                                                   S01435
     C                     MOVELW8SCR     ADDRSS                          S01435
     C                     MOVELADCHK1    SINB1                           S01435
     C                     MOVELADCHK2    SINB2                           S01435
     C                     MOVELADCHK3    SINB3                           S01435
     C                     MOVELADCHK4    SINB4                           S01435
     C                     MOVELADCHK5    SINB5                           S01435
      *                                                                   S01435
     C           CFT009    IFEQ 'Y'                                       CFT009
      *                                                                   CFT009
     C                     MOVELPREF      PREF                            CFT009
      *                                                                   CFT009
      * GET EXTENSION FILE RECORD                                         CFT009
     C           PREF      CHAININPAYXL0             97                   CFT009
     C           *IN97     IFEQ *ON                                       CFT009
     C           *LOCK     IN   DLDA                                      CFT009
     C                     MOVE 'FT0060'  DBPGM                           CFT009
     C                     MOVE 'INPAYXPD'DBFILE           ***************CFT009
     C                     Z-ADD2         DBASE            * DB ERROR 02 *CFT009
     C                     MOVELPREF      DBKEY            ***************CFT009
     C                     MOVE '*'       @RETC                           CFT009
     C                     OUT  DLDA                                      CFT009
     C                     SETON                     U7U8LR               CFT009
     C                     DUMP                                           CFT009
      *                                                                   CFT009
      *  Allocate dataarea to blanks                                      CFT009
      *                                                                   CFT009
     C                     EXSR DALLOC                                    CFT009
      *                                                                   CFT009
     C                     RETRN                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                                       CSW209
     C                     MOVELINMTPY    INMTPE  3                                           CSW209
      *                                                                   CFT009
      * BASE DATA                                                         CFT009
     C                     MOVELCDRO      SCDRO                           CFT009
     C                     MOVELCDBR      SCDBR                           CFT009
     C           CFT120    IFEQ 'Y'                                                           CFT120
     C                     MOVELCDRC      SCDRC                                               CFT120
     C                     ENDIF                                                              CFT120
     C                     MOVELDTCH      DTCH                            CFT009
     C                     MOVELFXSPSC    SSSRCD                          CFT009
     C                     MOVELINPDOF    SSPDOF                          CFT009
      *                                                                   CFT009
      * CODES                                                             CFT009
     C                     MOVELTFCCCO    TRCDE                           CFT009
     C                     MOVELFXCHEC    FXCDE                           CFT009
     C                     MOVELTLCODE    TXCDE                           CFT009
     C                     MOVELCHCHCD    CQCDE                           CFT009
     C                     MOVELADCHCD    ADCDE                           CFT009
     C                     MOVELTLCHCD    TPCDE                           CFT009
     C                     MOVELMISCH     MSCDE                           CFT009
     C                     MOVELMSCH1     M1CDE                           CFT009
     C                     MOVELMSCH2     M2CDE                           CFT009
     C                     MOVELMSCH3     M3CDE                           CFT009
     C                     MOVELMSCH4     M4CDE                           CFT009
     C                     MOVELMSCH5     M5CDE                           CFT009
      *                                                                   CFT009
      * PAY / SETTLE CCY                                                  CFT009
     C                     SELEC                                          CFT009
     C***********CDRO      WHNE 0                                         CFT009              CSD027
     C           CDRO      WHNE *BLANKS                                                       CSD027
      *                                                                                       CFT120
      **  If Charges to the DR of Currency, use instead of Base                               CFT120
      *                                                                                       CFT120
     C                     MOVELBCCY      WTRNCY  3                       CFT009
     C           CDRC      IFNE *BLANKS                                                       CFT120
     C           CFT120    ANDEQ'Y'                                                           CFT120
     C                     MOVELCDRC      WTRNCY                                              CFT120
     C                     ENDIF                                                              CFT120
      *                                                                   CFT009
     C           BTCHCY    WHEQ 'L'                                       CFT009
     C                     MOVELLOCY      WTRNCY                          CFT009
      *                                                                   CFT009
     C           ADDC      WHEQ 'A'                                       CFT009
     C                     MOVELSMCY      WTRNCY                          CFT009
      *                                                                   CFT009
     C                     OTHER                                          CFT009
      *                                                                   CFT009
     C                     MOVELPCCY      WTRNCY                          CFT009
      *                                                                   CFT009
     C                     ENDSL                                          CFT009
      *                                                                   CFT009
     C                     MOVELWTRNCY    CCYA                            CFT009
     C                     MOVELWTRNCY    CCYB                            CFT009
     C                     MOVELWTRNCY    CCYC                            CFT009
     C                     MOVELWTRNCY    CCYD                            CFT009
     C                     MOVELWTRNCY    CCYE                            CFT009
     C                     MOVELWTRNCY    CCYF                            CFT009
     C                     MOVELWTRNCY    CCYG                            CFT009
     C                     MOVELWTRNCY    RCY9                            CFT009
     C                     MOVELWTRNCY    RCY10                           CFT009
     C                     MOVELWTRNCY    RCY11                           CFT009
     C                     MOVELWTRNCY    RCY12                           CFT009
     C                     MOVELWTRNCY    RCY13                           CFT009
      *                                                                   CFT009
      * CHARGE CURRENCY                                                   CFT009
      *                                                                   CFT009
     C                     MOVE INCHGC    CCY1                            CFT009
     C                     MOVE INCHGC    CCY2                            CFT009
     C                     MOVE INCHGC    CCY3                            CFT009
     C                     MOVE INCHGC    CCY4                            CFT009
     C                     MOVE INCHGC    CCY5                            CFT009
     C                     MOVE INCHGC    CCY6                            CFT009
     C                     MOVE INCHGC    CCY7                            CFT009
     C                     MOVE INCHGC    CCY9                            CFT009
     C                     MOVE INCHGC    CCY10                           CFT009
     C                     MOVE INCHGC    CCY11                           CFT009
     C                     MOVE INCHGC    CCY12                           CFT009
     C                     MOVE INCHGC    CCY13                           CFT009
      *                                                                   CFT009
      * FORMAT AMOUNTS                                                    CFT009
      * CHARGE AMOUNTS                                                    CFT009
     C*                                                                   CFT009
     C** Call to access pgm for currency  details LEVIED CCY              CFT009
     C*                                                                   CFT009
     C                     CALL 'AOCURRR0'                                CFT009
     C                     PARM '*DBERR ' @RTCD                           CFT009
     C                     PARM '*KEY   ' @OPTN                           CFT009
     C                     PARM WTRNCY    @CCY    3                       CFT009
     C           SDCURR    PARM SDCURR    DSSDY                           CFT009
      *                                                                   CFT009
      * Save decimal places                                               CFT009
     C                     Z-ADDA6NBDP    TRNDCP                          CFT009
      *                                                                   CFT009
      * Transfer Commission                                               CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE TRCM      ZFIELD                          CFT009
     C                     Z-ADDTRNDCP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    TRCMA                           CFT009
      *                                                                   CFT009
      * FX/CHANGE COMMISSION                                              CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE INCHCM    ZFIELD                          CFT009
     C                     Z-ADDTRNDCP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    CHCMA                           CFT009
      *                                                                   CFT009
      * TELEX CHARGE                                                      CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE TXCH      ZFIELD                          CFT009
     C                     Z-ADDTRNDCP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    TXCHA                           CFT009
      * CHEQUE CHARGE                                                     CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE CQCH      ZFIELD                          CFT009
     C                     Z-ADDTRNDCP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    CQCHA                           CFT009
      * ADVICE CHARGE                                                     CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE ADCH      ZFIELD                          CFT009
     C                     Z-ADDTRNDCP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    ADCHA                           CFT009
      * TELEPHONE CHARGE                                                  CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE TLCH      ZFIELD                          CFT009
     C                     Z-ADDTRNDCP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    TLCHA                           CFT009
      *                                                                   CFT009
      * MISCELLANEOUS CHARGE                                              CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE MSCH      ZFIELD                          CFT009
     C                     Z-ADDTRNDCP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    MSCHA                           CFT009
      *                                                                   CFT009
      * MISCELLANEOUS CHARGE 1                                            CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE MSC01     ZFIELD                          CFT009
     C                     Z-ADDTRNDCP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    M1CH                            CFT009
      *                                                                   CFT009
      * MISCELLANEOUS CHARGE 2                                            CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE MSC02     ZFIELD                          CFT009
     C                     Z-ADDTRNDCP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    M2CH                            CFT009
      *                                                                   CFT009
      * MISCELLANEOUS CHARGE 3                                            CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE MSC03     ZFIELD                          CFT009
     C                     Z-ADDTRNDCP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    M3CH                            CFT009
      *                                                                   CFT009
      * MISCELLANEOUS CHARGE 4                                            CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE MSC04     ZFIELD                          CFT009
     C                     Z-ADDTRNDCP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    M4CH                            CFT009
      *                                                                   CFT009
      * MISCELLANEOUS CHARGE 5                                            CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE MSC05     ZFIELD                          CFT009
     C                     Z-ADDTRNDCP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    M5CH                            CFT009
      *                                                                   CFT009
      * VAT                                                               CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE INVATT    ZFIELD                          CFT009
     C                     Z-ADDTRNDCP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    VATTA                           CFT009
      *                                                                   CFT009
      * SETTLE / PAY AMOUNTS                                              CFT009
     C*                                                                   CFT009
     C                     CALL 'AOCURRR0'                                CFT009
     C                     PARM '*DBERR ' @RTCD                           CFT009
     C                     PARM '*KEY   ' @OPTN                           CFT009
     C                     PARM INCHGC    @CCY    3                       CFT009
     C           SDCURR    PARM SDCURR    DSSDY                           CFT009
      *                                                                   CFT009
      * Save decimal places                                               CFT009
     C                     Z-ADDA6NBDP    CHGDCP                          CFT009
      *                                                                   CFT009
      *                                                                   CFT009
      * Convert Transfer Commission                                       CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE DUMA1     ZFIELD                          CFT009
     C                     Z-ADDCHGDCP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    TRCML                           CFT009
      *                                                                   CFT009
      * Convert FX / Change Commission                                    CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE INDUM7    ZFIELD                          CFT009
     C                     Z-ADDCHGDCP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    CHCML                           CFT009
      *                                                                   CFT009
      * Convert Telex Charge                                              CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE DUMA2     ZFIELD                          CFT009
     C                     Z-ADDCHGDCP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    TXCHL                           CFT009
      *                                                                   CFT009
      * Convert Cheque Charge                                             CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE DUMA3     ZFIELD                          CFT009
     C                     Z-ADDCHGDCP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    CQCHL                           CFT009
      *                                                                   CFT009
      * Convert Advice Charge                                             CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE DUMA4     ZFIELD                          CFT009
     C                     Z-ADDCHGDCP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    ADCHL                           CFT009
      * Convert Telephone Charge                                          CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE DUMA5     ZFIELD                          CFT009
     C                     Z-ADDCHGDCP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    TLCHL                           CFT009
      *                                                                   CFT009
      * Convert Miscellaneous Charge                                      CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE DUMA6     ZFIELD                          CFT009
     C                     Z-ADDCHGDCP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    MSCHL                           CFT009
      * Convert Miscellaneous Charge 1                                    CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE CMSC01    ZFIELD                          CFT009
     C                     Z-ADDCHGDCP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    M1CD                            CFT009
      *                                                                   CFT009
      * Convert Miscellaneous Charge 2                                    CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE CMSC02    ZFIELD                          CFT009
     C                     Z-ADDCHGDCP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    M2CD                            CFT009
      * Convert Miscellaneous Charge 3                                    CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE CMSC03    ZFIELD                          CFT009
     C                     Z-ADDCHGDCP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    M3CD                            CFT009
      * Convert Miscellaneous Charge 4                                    CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE CMSC04    ZFIELD                          CFT009
     C                     Z-ADDCHGDCP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    M4CD                            CFT009
      *                                                                   CFT009
      * Convert Miscellaneous Charge 5                                    CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE CMSC05    ZFIELD                          CFT009
     C                     Z-ADDCHGDCP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    M5CD                            CFT009
      *                                                                   CFT009
      * VAT                                                               CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE INDUM8    ZFIELD                          CFT009
     C                     Z-ADDCHGDCP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    VATTL                           CFT009
      *                                                                   CFT009
      *                                                                   CFT009
      * VAT FLAG INDICATORS                                               CFT009
     C           CFT010    IFEQ 'Y'                                       CFT009
     C                     MOVE INVAT1    INVAT1                          CFT009
     C                     MOVE INVAT2    INVAT2                          CFT009
     C                     MOVE INVAT3    INVAT3                          CFT009
     C                     MOVE INVAT4    INVAT4                          CFT009
     C                     MOVE INVAT5    INVAT5                          CFT009
     C                     MOVE INVAT6    INVAT6                          CFT009
     C                     MOVE INVAT7    INVAT7                          CFT009
     C                     MOVE VTMIC1    VAT9                            CFT009
     C                     MOVE VTMIC2    VAT10                           CFT009
     C                     MOVE VTMIC3    VAT11                           CFT009
     C                     MOVE VTMIC4    VAT12                           CFT009
     C                     MOVE VTMIC5    VAT13                           CFT009
     C                     MOVE VTSWSC    VAT14                           CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      * MISCELLANEOUS CHARGE DESCRIPTIONS                                 CFT009
      *                                                                   CFT009
     C           MSCH1     IFNE *BLANKS                                   CFT009
     C           MSCH1     CHAINFTPCHGL0             90                   CFT009
     C           *IN90     IFEQ '0'                                       CFT009
     C                     MOVELCHDESC    M1DESC                          CFT009
     C                     ELSE                                           CFT009
     C           CER049    IFEQ 'Y'                                                           CER049
     C                     MOVELSTMP,1    M1DESC                                              CER049
     C                     ELSE                                                               CER049
     C                     MOVELDESC,1    M1DESC                          CFT009
     C                     ENDIF                                                              CER049
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C           MSCH2     IFNE *BLANKS                                   CFT009
     C           MSCH2     CHAINFTPCHGL0             90                   CFT009
     C           *IN90     IFEQ '0'                                       CFT009
     C                     MOVELCHDESC    M2DESC                          CFT009
     C                     ELSE                                           CFT009
     C           CER049    IFEQ 'Y'                                                           CER049
     C                     MOVELSTMP,2    M2DESC                                              CER049
     C                     ELSE                                                               CER049
     C                     MOVELDESC,2    M2DESC                          CFT009
     C                     ENDIF                                                              CER049
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C           MSCH3     IFNE *BLANKS                                   CFT009
     C           MSCH3     CHAINFTPCHGL0             90                   CFT009
     C           *IN90     IFEQ '0'                                       CFT009
     C                     MOVELCHDESC    M3DESC                          CFT009
     C                     ELSE                                           CFT009
     C           CER049    IFEQ 'Y'                                                           CER049
     C                     MOVELSTMP,3    M3DESC                                              CER049
     C                     ELSE                                                               CER049
     C                     MOVELDESC,3    M3DESC                          CFT009
     C                     ENDIF                                                              CER049
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C           MSCH4     IFNE *BLANKS                                   CFT009
     C           MSCH4     CHAINFTPCHGL0             90                   CFT009
     C           *IN90     IFEQ '0'                                       CFT009
     C                     MOVELCHDESC    M4DESC                          CFT009
     C                     ELSE                                           CFT009
     C           CER049    IFEQ 'Y'                                                           CER049
     C                     MOVELSTMP,4    M4DESC                                              CER049
     C                     ELSE                                                               CER049
     C                     MOVELDESC,4    M4DESC                          CFT009
     C                     ENDIF                                                              CER049
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C           MSCH5     IFNE *BLANKS                                   CFT009
     C           MSCH5     CHAINFTPCHGL0             90                   CFT009
     C           *IN90     IFEQ '0'                                       CFT009
     C                     MOVELCHDESC    M5DESC                          CFT009
     C                     ELSE                                           CFT009
     C           CER049    IFEQ 'Y'                                                           CER049
     C                     MOVELSTMP,5    M5DESC                                              CER049
     C                     ELSE                                                               CER049
     C                     MOVELDESC,5    M5DESC                          CFT009
     C                     ENDIF                                                              CER049
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDSR
     C********************************************************************
     C* END OF REFORMAT FOR OUTGOING PAYMENTS SUBROUTINE
     C********************************************************************
     C/EJECT                                                              S01117
      **********                                                          S01435
      ********** Subroutine now replaced by FT0315                        S01435
      **********                                                          S01435
     C**************************************************************S01117S01435
     C**FORMAT*SR.                                                  S01117S01435
     C***To*remove display of branch from screen fld for nonmultibraS01117S01435
     C***Only*called for NON-multibranching  (*in50=0)              S01117S01435
     C**********                                                    S01117S01435
     C********** FORMAT    BEGSR                                    S01117S01435
     C**********                                                    S01117S01435
     C***For*outgoing payments i.e. using otpay (*in60=1)           S01117S01435
     C**********                                                    S01117S01435
     C********** *IN60     IFEQ '1'                                 S01117S01435
     C**********                                                    S01117S01435
     C***For*destination.                                           S01117S01435
     C**********                                                    S01117S01435
     C**********           MOVE DST1      SDST1                     S01117S01435
     C********** DSTT      IFEQ 'G'                                 S01117S01435
     C**********           MOVELSDST1     DSTN   12                 S01117S01435
     C**********           MOVE *BLANKS   SDST1                     S01117S01435
     C**********           MOVELDSTN      SDST1                     S01117S01435
     C**********           END                                      S01117S01435
     C**********                                                    S01117S01435
     C***For*ordering customer.                                     S01117S01435
     C**********                                                    S01117S01435
     C**********           MOVE ORC1      SORC1                     S01117S01435
     C********** ORCT      IFEQ 'P'                                 S01117S01435
     C**********           MOVELSORC1     ORCN   12                 S01117S01435
     C**********           MOVE *BLANKS   SORC1                     S01117S01435
     C**********           MOVELORCN      SORC1                     S01117S01435
     C**********           END                                      S01117S01435
     C**********                                                    S01117S01435
     C**********           END                                      S01117S01435
     C**********                                                    S01117S01435
     C***For*incoming payments i.e. using inpay (*in60=0)           S01117S01435
     C**********                                                    S01117S01435
     C********** *IN60     IFEQ '0'                                 S01117S01435
     C**********                                                    S01117S01435
     C***For*sender                                                 S01117S01435
     C**********                                                    S01117S01435
     C**********           MOVE SND1      SSND1                     S01117S01435
     C********** SNTP      IFEQ 'G'                                 S01117S01435
     C**********           MOVELSSND1     SNDN   15                 S01117S01435
     C**********           MOVE *BLANKS   SSND1                     S01117S01435
     C**********           MOVELSNDN      SSND1                     S01117S01435
     C**********           END                                      S01117S01435
     C**********                                                    S01117S01435
     C***For*beneficiary customer                                   S01117S01435
     C**********                                                    S01117S01435
     C**********           MOVE BNC1      SBNC1                     S01117S01435
     C********** BNCT      IFEQ 'P'                                 S01117S01435
     C**********           MOVELSBNC1     BNCN   12                 S01117S01435
     C**********           MOVE *BLANKS   SBNC1                     S01117S01435
     C**********           MOVELBNCN      SBNC1                     S01117S01435
     C**********           END                                      S01117S01435
     C**********                                                    S01117S01435
     C**********           END                                      S01117S01435
     C**********           ENDSR                                    S01117S01435
     C**************************************************************S01117S01435
     C**END*OF*SUBROUTINE FORMAT                                    S01117S01435
     C**************************************************************S01117S01435
     C/EJECT
     C********************************************************************
     C* FILEUP SR.
     C* UPDATE FILE IF NOT BEEN CHANGED BY OTHER SCREEN
     C*
     C           FILEUP    BEGSR
     C                     SETON                     05
     C   60      PREF      CHAINOTPAYDDF             80
     C  N60      PREF      CHAININPAYDDF             80
     C/COPY WNCPYSRC,FT0060C016
     C  N60N80             MOVE CHTP      IPCHTP                          004120
     C* IF RECORD HAS BEEN UPDATED BY ANOTHER SCREEN
     C           *IN80     IFEQ '1'                        B001
     C           LCD       ORNE SCD
     C           LCHT      ORNE SCT
     C           TMST      ORNE STMST                                                         242863
     C                     SETON                     89    INTERFERED
     C*********************MOVE ' 068'    ERCD,Z           WITH           S01117
     C                     MOVE ' 001'    ERCD,Z           WITH           S01117
     C                     ADD  1         Z
     C   60                EXCPTROTPAY
     C  N60                EXCPTRINPAY
     C                     END                             E001
     C/COPY WNCPYSRC,FT0060C050
     C  N89                DO                              B001
     C/COPY WNCPYSRC,FT0060C100
     C           AUP1      IFEQ *BLANK                     B002
     C                     MOVE USRID     AUP1
     C* IF USER ONE AND NOT OVER THESHHOLD
     C           SMAM      IFLT BTHRH                      B003
      /COPY WNCPYSRC,HUT101_007                                                               HUT101
     C                     MOVE 'Y'       AUIN
     C                     MOVE 'Y'       @RETC                           S01117
     C                     END                             E003
     C                     ELSE                            X002
     C                     MOVE USRID     AUP2
     C                     MOVE 'Y'       AUIN
     C                     MOVE 'Y'       @RETC                           S01117
     C                     END                             E002
     C/COPY WNCPYSRC,FT0060C101
     C* CHANGE LAST CHANGE DATE AND TIME
     C                     Z-ADDRUND      LCD
     C                     TIME           LCHT
     C* UPDATE FILE
     C                     TIME           TIM              FOR COMIT
     C                     MOVE TIM       TRANS            FOR COMIT
      *
      /COPY QWINDSRC,FT0060VAL                                            S01241
      *
     C                     Z-ADDRUND      LCD                             033601
     C                     EXSR W#TIME                                                        242863
     C   60                UPDATOTPAYDDF
     C/COPY WNCPYSRC,FTH00492
      *                                                                                       242863
      ** Also need to update the timestamp for the extension file.                            242863
      *                                                                                       242863
     C           CFT014    IFEQ 'Y'                                                           242863
     C           CFT009    OREQ 'Y'                                                           242863
      *                                                                                       242863
     C           *LOVAL    SETLLOTPAYXL0                                                      243989
     C           PREF      CHAINOTPAYXL0             86                                       243989
      *                                                                                       242863
     C           *IN86     IFEQ '0'                                                           242863
     C                     MOVELTMST      OPTMST                                              242863
     C                     EXCPTOPPAYX                                                        242863
     C                     ENDIF                                                              242863
      *                                                                                       242863
     C                     ENDIF                                                              242863
      *                                                                                       CRE020
      ** If CRE020 is installed, call Settlement Advice Subroutine                            CRE020
      *                                                                                       CRE020
     C           CRE020    IFEQ 'Y'                                                           CRE020
     C           PSVAL2    ANDEQ'Y'                                                           CRE020
      *                                                                                       CRE020
     C                     EXSR SRADVC                                                        CRE020
      *                                                                                       CRE020
     C                     ENDIF                                                              CRE020
      *                                                                                       CRE020
     C/COPY WNCPYSRC,FT0060C110
      *                                                                   S01435
      * Update Incoming Message FT Transaction Status File record         S01435
      * if payment created from Incoming Electronic Message               S01435
      *                                                                   S01435
     C           *IN60     IFEQ '1'                                       S01435
     C           OPMSGR    IFNE 0                                         S01435
      *                                                                   S01435
     C                     MOVEL'OP'      ##OPIN                          S01435
      *                                                                   S01435
     C           AUIN      IFEQ 'Y'                                       S01435
     C                     MOVEL'MIN0032' W0FLAG                          S01435
     C                     MOVEL'MIN0194' W0LMSG                          S01435
      *                                                                   S01435
     C                     ELSE                                           S01435
     C                     MOVEL'MIN0030' W0FLAG                          S01435
     C                     MOVEL'MIN0195' W0LMSG                          S01435
     C                     END                                            S01435
      *                                                                   S01435
     C                     EXSR SRINFT                                    S01435
      *                                                                   S01435
     C                     END                                            S01435
     C                     END                                            S01435
      *
      ** If incoming payment, check whether O/P to be generated,
      **  and update INPAY accordingly
     C/COPY WNCPYSRC,FT0060C059
      *
     C           *IN60     IFEQ '0'
     C***********AUIN******ANDEQ'Y'                                 E23761E29860
     C***********AUP1******ANDNE*BLANKS                             E23761E29860
     C                     EXSR ADOTPY                     OTPAY
     C                     END
     C/COPY WNCPYSRC,FT0060C019
      **                                                                                      CSC022
      ** Execute commit if SAR CSC022 is not enrolled or                                      CSC022
      **   job is not currently running in batch mode                                         CSC022
      **                                                                                      CSC022
     C           CSC022    IFEQ 'N'                                                           CSC022
     C           CSC022    OREQ 'Y'                                                           CSC022
     C           WCRSKP    ANDEQ'N'                                                           CSC022
     C           COMBOU    COMIT
     C/COPY WNCPYSRC,FTH00428
     C                     ENDIF                                                              CSC022
     C/COPY WNCPYSRC,FT0060C038
      *                                                                                       CFT158
      ** Process return status if:                                                            CFT158
      ** a) CFT158 on and Front Office ID of auth OP/IN payment is non-blank.                 CFT158
      ** b) CSC011 on and Front Office ID of auth OP/IN payment not 'MD' + <PREF>.            CFT158
      *                                                                                       CFT158
      ** Construct CSC011 default payment ref 'MD'+<PREF>                                     CFT158
     C                     MOVEL*BLANKS   XFRNT                                               CFT158
     C                     MOVEL'MD'      XPRFX                                               CFT158
     C                     MOVELPREF      XTREF                                               CFT158
      *                                                                                       CFT158
     C           CFT158    IFEQ 'Y'                                                           CFT158
     C           AUIN      ANDEQ'Y'                                                           CFT158
     C           FRNT      ANDNE*BLANKS                                                       CFT158
      *                                                                                       CFT158
     C           CSC011    IFNE 'Y'                                                           CFT158
     C           CSC011    OREQ 'Y'                                                           CFT158
     C           FRNT      ANDNEXFRNT                                                         CFT158
      *                                                                                       CFT158
     C           PYTP      IFEQ 'OP'                                                          CFT158
     C           PYTP      OREQ 'IN'                                                          CFT158
     C                     EXSR CHKPST                                                        CFT158
     C           GENMSG    IFEQ 'Y'                                                           CFT158
     C                     EXSR SRSNDQ                                                        CFT158
     C                     ENDIF                                                              CFT158
     C                     ENDIF                                                              CFT158
      *                                                                                       CFT158
     C                     ENDIF                                                              CFT158
     C                     ENDIF                                                              CFT158
      *                                                                                       CFT158
     C                     END                             E001
     C                     ENDSR
     C********************************************************************
     C* END OF FILE UPDATE SUBROUTINE
     C********************************************************************
     C/EJECT
     C*****************************************************************
     C* ADOTPY SR.
     C* CHECK MASTER FILE FOR BIT 3 SET ON AND IF SO ADD AN OTPAY
     C* RECORD TO THE FILE
     C* ALSO UPDATE INPAYDD
     C*
     C           ADOTPY    BEGSR
     C*                                                                   S01117
     C***SAVE BOOKING BRANCH FIELD FROM INPAY TO STOP OVERWRITING         S01117
     C***IF ACNUMA READ IN ACNKEY                                         S01117
     C*                                                                   S01117
     C                     MOVE BRCA      IBRC    3                       S01117
      *                                                                   S01117
     C           ACBT      IFNE *BLANKS
      *
     C           ACBT      CASEQ'N'       TBLKEY
     C           ACBT      CASEQ'R'       ACNKEY
     C           ACBT      CASEQ'P'       FLDKEY
     C           ACBT      CASEQ'C'       FLDKEY
     C                     END
      *
     C           ACBT      IFNE 'S'
     C*
     C*********************MOVEL'A'       RCDT                            S01194
     C***********CLKEY*****KLIST                                          E23191
     C*********************KFLD           CNUM                            E23191
     C*********************KFLD           RCDT                            E23191
     C***********CNUM******CHAINCLINTCBF             80                   S01194
     C***80****************DO                                          ** S01194
     C************LOCK*****IN   DLDA                       ************   S01194
     C*********************Z-ADD11        DBASE            *DB ERR 11*    S01194
     C*********************MOVE 'CLINT'   DBFILE           ************   S01194
     C*********************MOVE '*'       @RETC                           S01194
     C*********************EXSR ZABT                                   ** S01194
     C*********************END                                            S01194
     C*                                                                   S01194
     C** Call to access pgm for Customer details                          S01194
     C*                                                                   S01194
     C                     MOVE *BLANKS   @CNUM  10                                          BUG4152
      *                                                                                      BUG4152
     C                     CALL 'AOCUSTR0'                                S01194
     C                     PARM '*DBERR ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C**********           PARM CNUMA     @CNUM   6                                   S01194 BUG4152
     C                     PARM CNUMA     @CNUM                                              BUG4152
     C                     PARM *BLANKS   @KYST   7                       S01194
     C           SDCUST    PARM SDCUST    DSSDY                           S01194
      *
      ** Save customer no. for outgoing payment
      ** and SWIFT Id in case needed in WOTPAY/SR                         E23191
      *
     C**********           MOVE CNUM      ABNUM   60                                          CSD027
     C                     MOVE CNUM      ABNUM   6                                           CSD027
     C*********************MOVE CSID      OTCSID 12                 E23191S01194
     C                     MOVE BBCSID    OTCSID 12                       S01194
      *
     C                     END
     C                     END
      *
     C* CHANGE LAST CHANGE DATE AND TIME
     C                     Z-ADDRUND      LCD
     C                     TIME           LCHT
     C                     MOVE IPCHTP    CHTP                            004120
     C*                                                                   S01117
     C***MOVE BOOKING BRANCH FROM READ OF INPAY BACK TO FILE FIELD        S01117
     C*                                                                   S01117
     C                     MOVE IBRC      BRCA                            S01117
     C                     EXSR W#TIME                                                        242863
     C/COPY WNCPYSRC,FT0060C024
      *
     C                     UPDATINPAYDDF
      *                                                                                       242863
      ** Also need to update the timestamp for the extension file.                            242863
      *                                                                                       242863
     C           CFT014    IFEQ 'Y'                                                           242863
     C           CFT009    OREQ 'Y'                                                           242863
      *                                                                                       242863
     C           *LOVAL    SETLLINPAYXL2                                                      242863
     C           PREF      CHAININPAYXL2             86                                       242863
      *                                                                                       242863
     C           *IN86     IFEQ '0'                                                           242863
     C                     MOVELTMST      INTMST                                              242863
     C                     EXCPTINPAYX                                                        242863
     C                     ENDIF                                                              242863
      *                                                                                       242863
     C                     ENDIF                                                              242863
     C/COPY WNCPYSRC,FT0060C025
      *                                                                   S01435
      * Update Incoming Message FT Transaction Status File record         S01435
      * if payment created from Incoming Electronic Message               S01435
      *                                                                   S01435
     C           INMSGR    IFNE 0                                         S01435
      *                                                                   S01435
     C                     MOVEL'IN'      ##OPIN  2                       S01435
      *                                                                   S01435
     C           AUIN      IFEQ 'Y'                                       S01435
     C                     MOVEL'MIN0032' W0FLAG  7                       S01435
     C                     MOVEL'MIN0054' W0LMSG  7                       S01435
      *                                                                   S01435
     C                     ELSE                                           S01435
     C                     MOVEL'MIN0030' W0FLAG                          S01435
     C                     MOVEL'MIN0055' W0LMSG                          S01435
     C                     END                                            S01435
      *                                                                   S01435
     C                     EXSR SRINFT                                    S01435
      *                                                                   S01435
     C                     END                                            S01435
     C/COPY WNCPYSRC,FT0060CADV                                           S01408
     C*
     C* GENERATE OUTWARD IF GENERATE INDICATOR FROM INPAY IS 'YES'
     C*
     C           OPIN      IFEQ 'Y'
     C**                                                                  E29860
     C** ONLY GENERATE OUTGOING PAYMENT IF INCOMING FULLY AUTHORISED      E29860
     C**                                                                  E29860
     C           AUIN      ANDEQ'Y'                                       E29860
     C/COPY WNCPYSRC,FT0060C093
     C**                                                                  E29860
     C                     EXSR WOTPAY                     WRITE AN OTPAY
      *                                                                                       CRE020
      ** If CRE020 is installed, call Settlement Advice Subroutine                            CRE020
      *                                                                                       CRE020
     C           CRE020    IFEQ 'Y'                                                           CRE020
      *                                                                                       CRE020
      ** Initialize and Load Data                                                             CRE020
      *                                                                                       CRE020
     C           PSVAL1    IFEQ 'Y'                                                           CRE020
     C           OPIN      ANDEQ'N'                                                           CRE020
     C           PSVAL2    OREQ 'Y'                                                           CRE020
     C           OPIN      ANDEQ'Y'                                                           CRE020
      *                                                                                       CRE020
     C                     EXSR SRADVC                                                        CRE020
      *                                                                                       CRE020
     C                     ENDIF                                                              CRE020
      *                                                                                       CRE020
     C                     ENDIF                                                              CRE020
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0060CCP1                                           S01408
     C*                                                                   S01408
     C                     END
     C*
     C                     ENDSR
     C****************************************************************
     C* END OF ADOTPY SR.
     C****************************************************************
     C*
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0060CCP2                                           S01408
     C*                                                                   S01408
     C/EJECT
     C****************************************************************
     C* OBTAIN CLIENT NUMBER SUBROUTINES
     C*
     C           TBLKEY    BEGSR
     C                     MOVELACBK      WSKY1   2
     C*********************MOVE WSKY1     WSKEY   5                       S01194
     C*********************MOVELPCCY      WSKEY                           S01194
     C*********************MOVE *BLANKS   KEY                             S01194
     C*********************MOVEL'70'      KEY                             S01194
     C*********************MOVE WSKEY     KEY                             S01194
     C***********KEY*******CHAINTABLETLF             80                   S01194
     C**N80******RECI******COMP 'D'                  8080                 S01194
     C***80****************DO                                             S01194
     C************LOCK*****IN   DLDA                       ***********    S01194
     C*********************Z-ADD9         DBASE            *DB ERR 09*    S01194
     C*********************MOVE 'TABTL'   DBFILE           ***********    S01194
     C*********************MOVE '*'       @RETC                           S01194
     C*********************EXSR ZABT                                      S01194
     C*********************END                                            S01194
     C*                                                                   S01194
     C** Call to access pgm for nostro details                            S01194
     C*                                                                   S01194
     C                     CALL 'AONOSTR0'                                S01194
     C                     PARM '*DBERR ' @RTCD                           S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM *BLANKS   @CUST   6                       S01194
     C                     PARM PCCY      @CCY    3                       S01194
     C**********           PARM *BLANKS   @ACCD   4                                    S01194 CGL029
     C                     PARM *BLANKS   @ACCD  10                                           CGL029
     C                     PARM *BLANKS   @ACSN   2                       S01194
     C                     PARM WSKY1     @NONB   2                       S01194
     C                     PARM *BLANKS   @BRCD   3                       S01194
     C                     PARM *BLANKS   @CSSN  10                       S01194
     C                     PARM *BLANKS   @PNOI   1                       S01194
     C           SDNOST    PARM SDNOST    DSFDY                           S01194
     C*                                                                   S01194
     C** Execute Subroutine to move fields to old field names             S01194
     C*                                                                   S01194
     C                     EXSR AONOST                                    S01194
     C*                                                                   S01194
     C                     ENDSR
     C           ACNKEY    BEGSR
     C                     MOVELACBK      ACNO
     C           ACNO      CHAINACNUMAF              80
     C   80                DO
     C           *LOCK     IN   DLDA                       ***********
     C                     Z-ADD10        DBASE            *DB ERR 10*
     C                     MOVE 'ACNUM'   DBFILE           ***********
     C                     MOVE '*'       @RETC
     C                     EXSR ZABT
     C                     END
     C*
     C                     ENDSR
     C***************************************************************
     C* END OF OBTAIN CLIENT NUMBER SUBROUTINE
     C***************************************************************
     C*
     C***************************************************************
     C* FLDKEY SR.
     C* SET UP CUSTOMER NO. FOR ACCOUNT WITH BANK
     C*
     C           FLDKEY    BEGSR
     C                     MOVELACBK      CNUM
     C                     ENDSR
     C/EJECT
     C***************************************************************
     C* WOTPAY SR.
     C* ADD AN OTPAY RECORD TO THE FILE
     C*
     C           WOTPAY    BEGSR
     C*
     C/COPY WNCPYSRC,FTH00073
     C                     MOVE IPREF     OXPREF                          E25232
     C                     MOVE IPREF     RLPR                                              BUG22904
     C/COPY WNCPYSRC,FTH00074
     C                     MOVE 'D'       RECI
     C                     MOVE 'P'       P
     C*
     C                     MOVE RUND      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZYEAR     YY
     C                     MOVE ZMTH      MM
     C                     MOVE ZDAY      DD
     C/COPY WNCPYSRC,FT0060C017
     C*
     C           CFT151    IFEQ 'N'                                                           CFT151
     C           *LOCK     IN   OTPAYD
     C*****                Z-ADDOSQNM     PRNUM                                               CFT151
     C*****                ADD  1         OSQNM                                               CFT151
     C                     MOVELWOTSQ     PRNUM                                               CFT151
     C                     ADD  1         WOTSQ                                               CFT151
     C                     OUT  OTPAYD
     C                     ELSE                                                               CFT151
     C                     CALL 'FT000328'                                                    CFT151
     C                     PARM           PRTCD                                               CFT151
     C                     PARM 'OT'      W@OTIN  2                                           CFT151
     C                     PARM 'A'       WCALC   1                                           CFT151
     C                     PARM 'Y'       WUPD    1                                           CFT151
     C                     PARM           PRNUM                                               CFT151
     C                     PARM           WNEWSQ  4                                           CFT151
     C                     ENDIF                                                              CFT151
     C/COPY WNCPYSRC,FT0060C018
     C*
     C                     MOVE 'OP'      PYTP
     C                     Z-ADD0         STTP
     C/COPY WNCPYSRC,FTH00075
     C                     MOVE IPREF     PREF
     C/COPY WNCPYSRC,FTH00076
     C                     EXSR W#TIME                                                        242863
     C                     MOVE *BLANKS   PYST
      *
     C                     MOVE *BLANKS   DST1
     C                     MOVE *BLANKS   DST2
     C                     MOVE *BLANKS   DST3
     C                     MOVE *BLANKS   DST4
      *
     C                     MOVE *BLANKS   ACB1
     C                     MOVE *BLANKS   ACB2
     C                     MOVE *BLANKS   ACB3
     C                     MOVE *BLANKS   ACB4
     C                     MOVE *BLANKS   ACB5
      *                                                                                     BUG22826
      ** Copy extended narratives to OPAY debit narratives                                  BUG22826
      *                                                                                     BUG22826
     C           CER031    IFEQ 'Y'                                                         BUG22826
     C                     MOVELIEXT1     OPEXT1                                            BUG22826
     C                     MOVELIEXT2     OPEXT2                                            BUG22826
     C                     MOVELIEXT3     OPEXT3                                            BUG22826
     C                     MOVELIEXT4     OPEXT4                                            BUG22826
     C                     MOVELIEXT5     OPEXT5                                            BUG22826
     C                     MOVELIEXT6     OPEXT6                                            BUG22826
     C                     ENDIF                                                            BUG22826
      *                                                                   055293
      * DESTINATION                                                       055293
      *                                                                   055293
      * Destination: if Intermediary Bank is blank, use 'A/c with         055293
      * Institution' details, otherwise use intermediary bank details     055293
      *                                                                   055293
     C/COPY WNCPYSRC,FT0060C061
     C           INBT      IFEQ *BLANK
     C/COPY WNCPYSRC,FT0060C062
      *
      * If Account with Institution on screen is a Nostro or Retail       055293
      * account then use the screen fields to fill the Destination.       055293
      * Thus, the field 57 (Account With Institution) that was obtained   055293
      * from the Incoming Swift msg is not used for the Outgoing pay't.   055293
      *                                                                   055293
      * If 'Account with Institution' is nostro convert to full nostro    055293
      *
     C           ACBT      IFEQ 'N'
     C                     MOVELACBK      FLD2    2
     C                     MOVELPCCY      FLD5    5
     C                     MOVE FLD2      FLD5
     C                     MOVELFLD5      DST1
     C                     MOVE 'F'       DSTT
     C                     MOVE DST1      SDST1                           S01117
     C                     GOTO ACB01
     C                     END
      *                                                                   055293
      * If Retail, then move in first 10 characters                       055293
      *                                                                   055293
     C           ACBT      IFEQ 'R'                                       055293
     C                     MOVE ACBT      DSTT                            055293
     C                     MOVELACBK      FLD10  10                       055293
     C                     MOVELFLD10     DST1                            055293
     C                     GOTO ACB01                                     055293
     C                     END                                            055293
      *                                                                   055293
      * If Account with Institution on screen is NOT a Nostro or Retail   055293
      * AND field 57 is held on the Incoming Payment, use it for the      055293
      * Destination                                                       055293
      *                                                                   055293
     C           INACBT    IFNE *BLANKS                                   055293
      *                                                                   055293
     C           INACBT    IFEQ 'S'                                       055293
     C                     MOVEL'S'       DSTT                            055293
     C                     ELSE                                           055293
     C                     MOVEL'A'       DSTT                            055293
     C                     END                                            055293
      *                                                                   055293
     C                     MOVELINACB1    DST1                            055293
     C                     MOVELINACB2    DST2                            055293
     C                     MOVELINACB3    DST3                            055293
     C                     MOVELINACB4    DST4                            055293
     C                     GOTO ACB01                                     055293
      *                                                                   055293
     C                     END                                            055293
      *                                                                   055293
      * If field 57 is NOT held on the Incoming Payment then use the      055293
      * Account With Institution screen field to determine Destination    055293
      *                                                                   055293
      * If Partial Account convert to a/c identifier
      *
     C           ACBT      IFEQ 'P'
     C                     MOVELACBK1     DEST1
     C                     MOVE PCCY      DEST2
     C                     MOVELACBK3     DEST3
     C                     MOVELACBK4     DEST4
     C*                                                                   S01117
     C** Set up branch field on end of dest. from A/C with bank           S01117
     C*                                                                   S01117
     C                     MOVE ACBB      DEST5                           S01117
     C                     MOVE DST1      SDST1                           S01117
     C                     MOVE 'G'       DSTT
     C                     GOTO ACB01
     C                     END
     C*
     C***********ACBT******IFEQ 'R'                                       055293
     C*********************MOVE ACBT      DSTT                            055293
     C*********************MOVELACBK      FLD10  10                       055293
     C*********************MOVELFLD10     DST1                            055293
     C*********************MOVE DST1      SDST1                     S01117055293
     C*********************GOTO ACB01                                     055293
     C*********************END                                            055293
      *
     C           ACBT      IFEQ 'C'
     C                     MOVE ACBT      DSTT
     C                     MOVELACBK      FLD06   6
     C                     MOVELFLD06     DST1
     C                     MOVE DST1      SDST1                           S01117
     C                     GOTO ACB01
     C                     END
      *
     C           ACBT      IFEQ 'S'
     C                     MOVE ACBT      DSTT
     C**********           MOVELACBK      FLD12  12                                           CGL029
     C                     MOVELACBK      FLD12  18                                           CGL029
     C                     MOVELFLD12     DST1
     C                     MOVE DST1      SDST1                           S01117
     C                     GOTO ACB01
     C                     END
      *
     C           ACB01     TAG
     C/COPY WNCPYSRC,FT0060C063
     C*                                                                   E29867
     C** BLANKOUT ACBT TO AVOID WRITING TO OTPAYDD                        E29867
     C*                                                                   E29867
     C                     MOVE *BLANKS   ACBT                            E29867
      *
     C                     ELSE                            Bank details
     C/COPY WNCPYSRC,FT0060C064
      *
      * Intermediary Bank Entered
      *
     C           INBT      IFEQ 'S'
     C                     MOVELINB1      DST1
     C                     MOVE 'S'       DSTT
     C                     ELSE
     C                     MOVE INBT      DSTT
     C                     MOVE INB1      DST1
     C                     MOVE DST1      SDST1                           S01194
     C                     MOVE INB2      DST2
     C                     MOVE INB3      DST3
     C                     MOVE INB4      DST4
     C                     END
     C/COPY WNCPYSRC,FT0060C065
      *                                                                   E32472
      ************************************************************* E23191E32472
      ****If*'Account*with*bank'*is*a*nostro*convert*to*a*SWIFT*Id,*or3191E32472
      ****a*full*name*and*address*from*CLINTCC.*This*is*because*    E23191E32472
      ****outgoing*payments*maintenance*only*allows*a/c*with*bank*toE23191E32472
      ****be*a*SWIFT*Id*or*full*name*and*address.*                  E23191E32472
      *                                                                   055293
      *   ACCOUNT WITH BANK (only filled if Intermediary Bank exists)     055293
      *                                                                   055293
      **  If 'Account with bank' is a nostro, retail or partial account   E32472
      **  convert to a SWIFT Id, or a full name and address. This is      E32472
      **  because outgoing payments maintenance only allows a/c with      E32472
      **  bank to be a SWIFT Id or full name and address.                 E32472
      *                                                                   055293
      *   Only do this for a partial account if the Incoming Payment      055293
      *   does not have a field 57 'Account with Institution' address     055293
      *   from the Swift message.                                         055293
      *                                                                   E23191
      *   N.B If Intermediary Bank is blank then ACBT was also set to     E23191
      *       blank when the Destination field was filled.                E23191
      *                                                                   E23191
     C           ACBT      IFEQ 'N'                        B001           E23191
     C           ACBT      OREQ 'R'                                       E32472
     C           ACBT      OREQ 'P'                                       E32472
     C           INACBT    ANDEQ*BLANKS                                   055293
      *                                                                   E23191
      ** If SWIFT Id for nostro then put it in, else put in full name     E23191
      ** and address.                                                     E23191
      *                                                                   E23191
     C           OTCSID    IFNE *BLANKS                    B002           E23191
     C                     MOVELOTCSID    ACB1                            E23191
     C                     MOVE 'S'       ACBT                            E23191
     C*                                                                   E23191
     C** ELSE PUT IN FULL NAME AND ADDRESS                                E23191
     C*                                                                   E23191
     C                     ELSE                            X002           E23191
     C*********************MOVEL'B'       RCDT                      E23191S01194
     C***********CNUM******CHAINCLINTCCF             80             E23191S01194
     C***80****************DO                              B003     E23191S01194
     C************LOCK*****IN   DLDA                       ************191S01194
     C*********************Z-ADD20        DBASE            *DB ERR 20* 191S01194
     C*********************MOVE 'CLINT'   DBFILE           ************191S01194
     C*********************MOVE '*'       @RETC                     E23191S01194
     C*********************EXSR ZABT                             ** E23191S01194
     C*********************END                             E003     E23191S01194
     C*********************                                         E23191S01194
     C*********************MOVELCNA1      ACB1                      E23191S01194
     C*********************MOVE CNA2      ACB2                      E23191S01194
     C*********************MOVE CNA3      ACB3                      E23191S01194
     C*********************MOVE CNA4      ACB4                      E23191S01194
     C*                                                                   S01194
     C                     MOVE *BLANKS   @CNUM                                              BUG4152
      *                                                                                      BUG4152
     C                     CALL 'AOCUSTR0'                                S01194
     C                     PARM '*DBERR ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C**********           PARM CNUMA     @CNUM   6                                   S01194 BUG4152
     C                     PARM CNUMA     @CNUM                                              BUG4152
     C                     PARM *BLANKS   @KYST   7                       S01194
     C           SDCUST    PARM SDCUST    DSSDY                           S01194
     C*                                                                   S01194
     C                     MOVELBBCNA1    ACB1                            S01194
     C                     MOVE BBCNA2    ACB2                            S01194
     C                     MOVE BBCNA3    ACB3                            S01194
     C                     MOVE BBCNA4    ACB4                            S01194
     C                     MOVE 'A'       ACBT                            E23191
     C***********          MOVELACBK      ACB1                            E23191
     C                     END                             E002           E23191
      *                                                                   055293
     C                     ELSE                                           055293
      *                                                                   055293
      * If Account with Institution on screen is NOT a Nostro or          055293
      * Retail or it is a partial account but field 57 exists then        055293
      * fill the Account With Bank using field 57 details                 055293
      *                                                                   055293
     C           INACBT    IFNE *BLANKS                                   055293
      *                                                                   055293
     C           INACBT    IFEQ 'S'                                       055293
     C                     MOVEL'S'       ACBT                            055293
     C                     ELSE                                           055293
     C                     MOVEL'A'       ACBT                            055293
     C                     END                                            055293
      *                                                                   055293
     C                     MOVELINACB1    ACB1                            055293
     C                     MOVELINACB2    ACB2                            055293
     C                     MOVELINACB3    ACB3                            055293
     C                     MOVELINACB4    ACB4                            055293
     C                     MOVELINACB5    ACB5                            055293
     C*                                                                   E23191
     C                     END                                            E23191
     C*                                                                   E23191
     C                     END                                            E23191
     C*
     C                     END
     C/COPY WNCPYSRC,FT0060C094
     C*
     C*             *************************************
     C*
     C                     MOVE *BLANK    SNCT
     C***********          Z-ADD0         SNCO                                                CSD027
     C                     MOVE *BLANKS   SNCO                                                CSD027
     C                     Z-ADD1         RATE
     C                     Z-ADD1         RATED
     C                     MOVE 'N'       OVRD
     C                     Z-ADDPYAM      SMAM
      *
      **  Deduct charges from pay amount so that generated outgoing
      **   payment will match incoming payment posted amount
      *
     C***********CDRO      IFEQ 0                                                             CSD027
     C           CDRO      IFEQ *BLANKS                                                       CSD027
     C           ADDC      ANDEQ'D'
     C                     SUB  TRCM      SMAM
     C                     SUB  TXCH      SMAM
     C                     SUB  CQCH      SMAM
     C                     SUB  ADCH      SMAM
     C                     SUB  TLCH      SMAM
     C                     SUB  MSCH      SMAM
     C           CFT009    IFEQ 'Y'                                       CFT009
     C                     SUB  MSC01     SMAM                            CFT009
     C                     SUB  MSC02     SMAM                            CFT009
     C                     SUB  MSC03     SMAM                            CFT009
     C                     SUB  MSC04     SMAM                            CFT009
     C                     SUB  MSC05     SMAM                            CFT009
     C                     ENDIF                                          CFT009
     C                     END
      *                                                                   CFT014
      ** Sum up the following Incoming Payment Charges.                   CFT014
      *                                                                   CFT014
     C                     Z-ADDTRCM      WCHGS  130                      CFT014
     C           S01494    IFEQ 'Y'                                       CFT014
     C                     ADD  INCHCM    WCHGS                           CFT014
     C                     ENDIF                                          CFT014
     C                     ADD  TXCH      WCHGS                           CFT014
     C                     ADD  CQCH      WCHGS                           CFT014
     C                     ADD  ADCH      WCHGS                           CFT014
     C                     ADD  TLCH      WCHGS                           CFT014
     C                     ADD  MSCH      WCHGS                           CFT014
      *                                                                   CFT009
      * We are creating an OUTGOING payment from an INCOMING payment.     CFT009
      *  Therefore the charges must be from the INCOMING paument file.    CFT009
      *                                                                   CFT009
     C           CFT009    IFEQ 'Y'                                       CFT009
     C                     ADD  MSC01     WCHGS                           CFT009
     C                     ADD  MSC02     WCHGS                           CFT009
     C                     ADD  MSC03     WCHGS                           CFT009
     C                     ADD  MSC04     WCHGS                           CFT009
     C                     ADD  MSC05     WCHGS                           CFT009
     C                     ENDIF                                          CFT009
     C           S01499    IFEQ 'Y'                                       CFT014
     C                     ADD  INVATT    WCHGS                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Determine Charges Currency.                                      CFT014
      *                                                                   CFT014
     C                     SELEC                                          CFT014
      *                                                                   CFT014
     C***********CDRO      WHNE *ZERO                                     CFT014              CSD027
     C           CDRO      WHNE *BLANKS                                                       CSD027
      *                                                                                       CFT120
      **  If Charges to the DR of Currency, use instead of Base                               CFT120
      *                                                                                       CFT120
     C                     MOVELBJCYCD    WCCCY   3                       CFT014
     C           CDRC      IFNE *BLANKS                                                       CFT120
     C           CFT120    ANDEQ'Y'                                                           CFT120
     C                     MOVELCDRC      WCCCY                                               CFT120
     C                     ENDIF                                                              CFT120
      *                                                                   CFT014
     C           ADDC      WHEQ 'A'                                       CFT014
     C                     MOVELSMCY      WCCCY                           CFT014
      *                                                                   CFT014
     C           SND1      IFEQ 'CASHIER'                                 CFT014
     C           PCCY      ANDEQBJCYCD                                    CFT014
     C                     MOVELPCCY      WCCCY                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     OTHER                                          CFT014
     C                     MOVELPCCY      WCCCY                           CFT014
      *                                                                   CFT014
     C                     ENDSL                                          CFT014
      *
     C                     MOVE SMCY      WSMCYX  3                       CFT014
     C                     MOVE PCCY      SMCY
     C                     Z-ADDPVDT      SLDT
     C                     Z-ADDPVDTD1    SLDTD1
     C                     Z-ADDPVDTD2    SLDTD2
     C                     Z-ADDPVDTD3    SLDTD3
     C*
     C** Setup DAF pay amount, depending on number of decimal places in
     C**  receive currency on incoming payment
     C*
     C           RCDP      ADD  4         N       10
     C           SMAM      DIV  POWER,N   SMAMD
     C*
     C* CALCULATE BASE CURRENCY EQUIV
     C*
     C           RCDP      SUB  BCDP      N       10
     C                     ADD  4         N
     C*
     C           RMDIN     IFEQ 0                          B001
     C           RSPOT     MULT POWER,N   WK159     H
     C           SMAM      DIV  WK159     SBCQ      H
     C                     ELSE                            X001
     C           RSPOT     DIV  POWER,N   WK159  159H
     C           SMAM      MULT WK159     SBCQ      H
     C                     END                             E001
     C*
     C                     Z-ADD0         PYAM
     C                     Z-ADD0         PYAMD
     C                     Z-ADD0         PBCQ
     C                     MOVE 'D'       ADDC
     C                     MOVE 'N'       RPAY
     C                     MOVE *BLANK    PAYF
     C                     Z-ADD0         DYIM
     C                     Z-ADD0         FDAT
     C                     Z-ADD0         FDATD1
     C                     Z-ADD0         FDATD2
     C                     Z-ADD0         FDATD3
     C*
     C           ACB1      IFEQ *BLANKS                                   E32886
     C                     MOVE *BLANKS   ACBT                            E32886
     C                     END                                            E32886
     C*                                                                   E32886
     C*********************Z-ADD2         SWPC                            E32870
     C                     MOVE *BLANKS   SNMT
     C                     Z-ADD0         STMT
     C                     MOVE *BLANKS   RCRT
     C                     MOVE *BLANKS   RCO1
     C                     MOVE *BLANKS   RCO2
     C                     MOVE *BLANKS   RCO3
     C                     MOVE *BLANKS   RCO4
     C                     MOVE *BLANKS   RCO5
     C                     MOVE *BLANKS   BBI1
     C                     MOVE *BLANKS   ORBB                            E29862
      *                                                                   055293
      *  ORDERING BANK                                                    055293
      *                                                                   055293
      *  Initialise Ordering Bank mapping fields                          055293
      *                                                                   055293
     C                     MOVEL*BLANKS   OPORBT                          055293
     C                     MOVEL*BLANKS   OPORB1                          055293
     C                     MOVEL*BLANKS   OPORB2                          055293
     C                     MOVEL*BLANKS   OPORB3                          055293
     C                     MOVEL*BLANKS   OPORB4                          055293
     C                     MOVEL*BLANKS   OPORB5                          055293
      *                                                                   055293
      *  Access FT suspense account in case it is needed later on         055293
      *                                                                   055293
      *  Obtain branch internal customer number for branch                055293
      *                                                                   055293
     C**********           CALL 'AOBRCHR0'                                             055293 CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM *BLANKS   @RTCD   7                       055293
     C                     PARM '*KEY   ' @OPTN   7                       055293
     C                     PARM BRCA      @BRKEY  3                       055293
     C********** SDBRCH    PARM SDBRCH    DSFDY                                        055293 CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
      *                                                                   055293
     C           @RTCD     IFNE *BLANKS                                   055293
     C           *LOCK     IN   DLDA                       ***********    055293
     C                     Z-ADD11        DBASE            *DB ERR 11*    055293
     C                     MOVEL'SDBRCHPD'DBFILE           ***********    055293
     C                     MOVELBRCA      DBKEY                           055293
     C                     MOVE '*'       @RETC                           055293
     C                     EXSR ZABT                                      055293
     C                     END                                            055293
      *                                                                   055293
      *  Move Suspense account to default account data structure          055293
      *                                                                   055293
     C                     MOVE A8BICN    OBCNUM                          055293
     C                     MOVE BTIOSA    OBACOD                          055293
     C                     Z-ADD1         OBACSQ                          055293
     C/COPY WNCPYSRC,FT0060C095
     C*
      *  If Ordering Bank is blank, fill fields with Sender details       040903
      *                                                                   040903
     C           ORBT      IFEQ *BLANK
     C*
      * If Sender is a Midas Account then check that currency is          040903
      * correct, if not do not use. Also start with no-valid info.        040903
      *                                                                   040903
     C**********           Z-ADD0         ORBK                                         040903 CSD027
     C                     MOVE *BLANKS   ORBK                                                CSD027
     C                     MOVEL*BLANKS   ORBT                            040903
      *                                                                   040903
      *  Full Nostro details entered                                      040903
      *                                                                   040903
     C           SNTP      IFEQ 'F'
     C*********************MOVE 'N'       ORBT                            040903
     C                     MOVELSND1      FLD5    5
     C                     MOVE FLD5      FLD2    2
      *                                                                   040903
      *  Check Currency                                                   040903
      *                                                                   040903
     C                     MOVELSND1      @CCY    3                       040903
     C           @CCY      IFEQ PCCY                                      040903
     C                     MOVELFLD2      ORBK
     C                     MOVE 'N'       ORBT                            040903
     C                     MOVEL@DFT,1    OPORB1                          055293
     C                     END                                            040903
      *                                                                   040903
     C                     ELSE
      *                                                                   040903
     C***********SNTP**    IFEQ 'G'                                E29862 040903
     C******************   MOVELSNP1      ORBK                     E29862 040903
     C******************   MOVE SNPG      ORBK                     E29862 040903
     C******************   MOVE SNP4      ORBB                     E29862 040903
     C******************   MOVE 'P'       ORBT                     E29862 040903
     C******************   ELSE                                    E29862 040903
     C***********SNTP***   IFEQ 'R'                                E29862 040903
     C******************   MOVELSND1      ORBK                     E29862 040903
     C******************   MOVE 'R'       ORBT                     E29862 040903
     C******************   ELSE                                    E29862 040903
     C******************   MOVE *BLANKS   ORBT                     E29862 040903
     C******************   MOVEL*BLANKS   ORBK                     E29862 040903
     C******************   END                                     E29862 040903
     C******************   END                                     E29862 040903
     C******************   END                                     E29862 040903
     C*******************                                          E29862 040903
     C*******************  MOVE SNTP      ORBT                            E29862
     C*******************  MOVELSND1      ORBK                            E29862
     C*******************  END                                            E29862
     C*******************                                                 040903
     C***IF*INCOMING*PAYMENT*CONTAINED*AN*ORDERING*BANK,*MOVE*IT***       040903
     C***ACROSS*TO*THE*OUTGOING*PAYMENT*ORDERING*BANK*FIELD.*******       040903
     C*******************                                                 040903
     C*******************  ELSE                                           040903
     C*******************  MOVELORB1      ORBK                            040903
     C*******************  END                                            040903
      *                                                                   040903
      *  Full General Ledger Account                                      040903
      *                                                                   040903
     C           SNTP      IFEQ 'G'                                       040903
     C                     MOVELSND1      FGLNO                           040903
      *                                                                   040903
      *  Check Currency if Ok format partial account information          040903
      *                                                                   040903
     C           CCY       IFEQ PCCY                                      040903
     C**********           Z-ADDCNUM      ORNUM                                        040903 CSD027
     C                     MOVE CNUM      ORNUM                                               CSD027
     C                     Z-ADDACOD      ORCOD                           040903
     C                     Z-ADDACSQ      ORSEQ                           040903
     C                     MOVELORBKS     ORBK                            040903
     C                     MOVELBRCAF     ORBB                            040903
     C                     MOVE 'P'       ORBT                            040903
     C                     MOVEL@DFT,1    OPORB1                          055293
     C                     END                                            040903
      *                                                                   040903
     C                     ELSE                                           040903
      *                                                                   040903
      *  Retail Account                                                   040903
      *                                                                   040903
     C           SNTP      IFEQ 'R'                                       040903
     C                     MOVELSND1      ACNO                            040903
     C           ACNO      CHAINACNUMAF              80                   040903
      *                                                                   040903
      *  Check Currency if Ok format partial account information          040903
      *                                                                   040903
     C           CCY       IFEQ PCCY                                      040903
     C           *IN80     ANDEQ'0'                                       040903
     C                     MOVE 'R'       ORBT                            040903
     C                     MOVELSND1      ORBK                            040903
     C                     MOVEL@DFT,1    OPORB1                          055293
     C                     END                                            040903
      *                                                                   040903
     C                     END                                            040903
      *                                                                   040903
     C                     END                                            040903
      *                                                                   040903
     C                     END                                            040903
      *                                                                   040903
     C                     ELSE                                           040903
      *                                                                   040903
      ***Do*not*fill*Ordering*Bank*if*not*a*Midas*Account.         040903 055293
      *********************                                        040903 055293
     C*********************Z-ADD0         ORBK                     040903 055293
     C******************** MOVEL*BLANKS   ORBT                     040903 055293
      *                                                                   055293
      * If Ordering bank is entered then move Ordering fields to          055293
      * lines 1 - 5 of the outgoing payment mapping Ordering Bnk fields   055293
      * and fill Ordering Bank with default suspense a/c                  055293
      *                                                                   055293
     C                     MOVELORBT      OPORBT                          055293
     C                     MOVELORB1      OPORB1                          055293
     C                     MOVELORB2      OPORB2                          055293
     C                     MOVELORB3      OPORB3                          055293
     C                     MOVELORB4      OPORB4                          055293
     C                     MOVELORB5      OPORB5                          055293
      *                                                                   055293
     C**********           Z-ADD0         ORBK                                         055293 CSD027
     C**********           Z-ADDOBFTAC    ORBK                                         055293 CSD027
     C                     MOVE *BLANKS   ORBK                                                CSD027
     C                     MOVE OBFTAC    ORBK                                                CSD027
     C                     MOVEL'P'       ORBT                            055293
     C                     MOVELBRCA      ORBB                            055293
     C                     END                                            055293
     C/COPY WNCPYSRC,FT0060C096
      *                                                                   055293
      *                                                                   055293
      *  MAP SWIFT MESSAGE FIELDS                                         055293
      *                                                                   055293
      *  Test to see if ORBT has been set. If not, move Sender            055293
      *  information into extension fields converting if necessary        055293
      *  and use the FT branch internal customers suspense account        055293
      *                                                                   055293
      *  N.B. ORBT will still be blank if the Ordering Bank was not       055293
      *       entered and the Senders Correspondent was either a C, A     055293
      *       or S  OR  F, G or R and pay ccy is not equal to settle.     055293
      *                                                                   055293
     C           ORBT      IFEQ *BLANKS                                   055293
      *                                                                   055293
     C**********           Z-ADDOBFTAC    ORBK                                         055293 CSD027
     C                     MOVE OBFTAC    ORBK                                                CSD027
     C                     MOVEL'P'       ORBT                            055293
     C                     MOVELBRCA      ORBB                            058679
      *                                                                   055293
      *  If Sender is an account then extract S.W.I.F.T. address          055293
      *  or if not present the address.                                   055293
      *                                                                   055293
     C           SNTP      IFEQ 'G'                                       055293
     C           SNTP      OREQ 'F'                                       055293
     C           SNTP      OREQ 'R'                                       055293
     C           SNTP      OREQ 'C'                                       055293
      *                                                                   055293
      *  Find Customer information for S.W.I.F.T./Address                 055293
      *                                                                   055293
     C           SNTP      IFEQ 'G'                                       055293
     C           SNTP      OREQ 'C'                                       055293
     C                     MOVELSND1      CNUM                            055293
     C                     END                                            055293
      *                                                                   055293
     C           SNTP      IFEQ 'R'                                       055293
     C                     MOVELSND1      ACNO                            055293
     C           ACNO      CHAINACNUMAF              80                   055293
      *                                                                   055293
     C           *IN80     IFEQ '1'                                       055293
     C           RECI      ORNE 'D'                                       055293
     C           *LOCK     IN   DLDA                       ***********    055293
     C                     Z-ADD12        DBASE            *DB ERR 12*    055293
     C                     MOVE 'ACNUM'   DBFILE           ***********    055293
     C                     MOVE '*'       @RETC                           055293
     C                     EXSR ZABT                                      055293
     C                     END                                            055293
      *                                                                   055293
     C                     END                                            055293
      *                                                                   055293
      * If sender is Nostro, call to access pgm for nostro details        055293
      *                                                                   055293
     C           SNTP      IFEQ 'F'                                       055293
     C***********          MOVELSND1      WSKY1                     055293058679
     C           3         SUBSTSND1:1    WSKY0   3                       058679
     C           2         SUBSTSND1:4    WSKY1                           058679
     C           5         SUBSTSND1:1    WSKEY   5                       058679
     C*                                                                   055293
     C                     CALL 'AONOSTR0'                                055293
     C                     PARM *BLANKS   @RTCD                           055293
     C                     PARM '*KEY   ' @OPTN                           055293
     C                     PARM *BLANKS   @CUST   6                       055293
     C***********          PARM PCCY      @CCY    3                 055293058679
     C                     PARM WSKY0     @CCY    3                       058679
     C**********           PARM *BLANKS   @ACCD   4                                    055293 CGL029
     C                     PARM *BLANKS   @ACCD                                               CGL029
     C                     PARM *BLANKS   @ACSN   2                       055293
     C                     PARM WSKY1     @NONB   2                       055293
     C                     PARM *BLANKS   @BRCD   3                       055293
     C                     PARM *BLANKS   @CSSN  10                       055293
     C                     PARM *BLANKS   @PNOI   1                       055293
     C           SDNOST    PARM SDNOST    DSFDY                           055293
      *                                                                   055293
     C           @RTCD     IFNE *BLANKS                                   055293
     C           *LOCK     IN   DLDA                       ***********    055293
     C                     Z-ADD13        DBASE            *DB ERR 13*    055293
     C                     MOVEL'SDNOSTPD'DBFILE           ***********    055293
     C                     MOVE 'FT0060'  DBPGM                           058679
     C***********          MOVELWSKY1     DBKEY                     055293058679
     C                     MOVELWSKEY     DBKEY                           058679
     C                     MOVE '*'       @RETC                           055293
     C                     EXSR ZABT                                      055293
     C                     END                                            055293
      *                                                                   055293
      *  Move commonly used fields to old field names                     055293
      *                                                                   055293
     C                     EXSR AONOST                                    055293
      *                                                                   055293
     C                     END                                            055293
      *                                                                   055293
      * Call to access pgm for Customer details                           055293
      *                                                                   055293
     C                     MOVE *BLANKS   @CNUM                                              BUG4152
      *                                                                                      BUG4152
     C                     CALL 'AOCUSTR0'                                055293
     C                     PARM *BLANKS   @RTCD   7                       055293
     C                     PARM '*KEY   ' @OPTN   7                       055293
     C**********           PARM CNUMA     @CNUM   6                                   055293 BUG4152
     C                     PARM CNUMA     @CNUM                                              BUG4152
     C                     PARM *BLANKS   @KYST   7                       055293
     C           SDCUST    PARM SDCUST    DSSDY                           055293
      *                                                                   055293
     C           @RTCD     IFNE *BLANKS                                   055293
     C           *LOCK     IN   DLDA                       ***********    055293
     C                     Z-ADD14        DBASE            *DB ERR 14*    055293
     C                     MOVEL'SDCUSTPD'DBFILE           ***********    055293
     C                     MOVELCNUMA     DBKEY                           055293
     C                     MOVE '*'       @RETC                           055293
     C                     EXSR ZABT                                      055293
     C                     END                                            055293
      *                                                                   055293
      *  If S.W.I.F.T. use SWIFT ID, else look up address                 055293
      *                                                                   055293
     C           BBCSID    IFEQ *BLANKS                                   055293
     C                     MOVE 'A'       OPORBT                          055293
     C                     MOVELBBCNA1    OPORB1                          055293
     C                     MOVELBBCNA2    OPORB2                          055293
     C                     MOVELBBCNA3    OPORB3                          055293
     C                     MOVELBBCNA4    OPORB4                          055293
     C                     MOVEL*BLANKS   OPORB5                          055293
     C                     ELSE                                           055293
     C                     MOVEL'S'       OPORBT                          055293
     C                     MOVELBBCSID    OPORB1                          055293
     C                     END                                            055293
      *                                                                   055293
     C                     ELSE                                           055293
      *                                                                   055293
      *  If a S.W.I.F.T. address or normal address map this               055293
      *                                                                   055293
     C           SNTP      IFEQ 'A'                                       055293
     C           SNTP      OREQ 'S'                                       055293
     C                     MOVELSNTP      OPORBT                          055293
     C                     MOVELSND1      OPORB1                          055293
     C                     MOVELSND2      OPORB2                          055293
     C                     MOVELSND3      OPORB3                          055293
     C                     MOVELSND4      OPORB4                          055293
     C                     MOVEL*BLANKS   OPORB5                          055293
     C                     END                                            055293
      *                                                                   055293
     C                     END                                            055293
      *                                                                   055293
     C                     END                                            055293
      *                                                                   055293
      *  Initialise Bank To bank Information fields                       055293
      *                                                                   055293
     C                     MOVE *BLANKS   BBI1
     C                     MOVE *BLANKS   BBI2
     C                     MOVE *BLANKS   BBI3
     C                     MOVE *BLANKS   BBI4
     C                     MOVE *BLANKS   BBI5
     C                     MOVE *BLANKS   BBI6
     C/COPY WNCPYSRC,FT0060C097
      *                                                                   S01435
      * If MT200, MT201, MT202, MT203 or MT205 type of message move       061236
      * 'MT202' key word into Ordering Customer field 1 and blank out     061236
      * fields 2/3/4.                                                     061236
      *                                                                   061236
     C           INMTPY    IFEQ '200'                                     061236
     C           INMTPY    OREQ '201'                                     061236
     C           INMTPY    OREQ '202'                                     061236
     C           INMTPY    OREQ '203'                                     061236
     C           INMTPY    OREQ '205'                                     061236
     C           ORCT      IFEQ *BLANKS                                   061236
     C                     MOVEL*BLANKS   ORC1                            061236
     C                     MOVEL*BLANKS   ORC2                            061236
     C                     MOVEL*BLANKS   ORC3                            061236
     C                     MOVEL*BLANKS   ORC4                            061236
     C                     MOVEL*BLANKS   ORC5                                                CFT032
     C                     MOVEL'MT202'   ORC1                            061236
     C*                                                                   106410
      ** ORCT shouldn't be blank if ORC1 has data                         106410
     C*                                                                   106410
     C                     MOVE 'A'       ORCT                            106410
     C*                                                                   106410
     C                     END                                            061236
     C                     END                                            061236
     C/COPY WNCPYSRC,FT0060C098
      *
      ** Beneficiary: if type R or P, convert to cust. no.
      **              otherwise, transfer straight across.
      *
     C           BNCT      IFEQ 'R'
     C                     MOVELBNC1      ACNO
     C           ACNO      CHAINACNUMAF              80
     C   80                DO
     C           *LOCK     IN   DLDA                       ***********
     C                     Z-ADD18        DBASE            *DB ERR 18*
     C                     MOVE 'ACNUM'   DBFILE           ***********
     C                     MOVE '*'       @RETC
     C                     EXSR ZABT
     C                     END
     C                     END
      *
     C           BNCT      IFEQ 'P'
     C                     MOVELBNC1      CNUM
     C                     END
      *
      *
     C           BNCT      IFEQ 'R'
     C           BNCT      OREQ 'P'
     C                     MOVE *BLANKS   BNC1
     C                     MOVELCNUM      BNC1
     C                     MOVE 'C'       BNCT
     C                     END
     C/COPY WNCPYSRC,FT0060C039
      *
     C                     Z-ADD0         DNBC
     C/COPY WNCPYSRC,FT0060C040
     C                     MOVE *BLANK    TRCT
     C                     Z-ADD0         TRCM
     C                     Z-ADD0         TRCMD
     C                     Z-ADD0         TXCH
     C                     Z-ADD0         TXCHD
     C                     Z-ADD0         CQCH
     C                     Z-ADD0         CQCHD
     C                     Z-ADD0         CSTA
     C                     Z-ADD0         CSTAD
     C                     Z-ADD0         SPCH
     C                     Z-ADD0         SPCHD
     C                     Z-ADD0         MSCH
     C                     Z-ADD0         MSCHD
     C                     MOVE *BLANK    CDRT
     C***********          Z-ADD0         CDRO                                                CSD027
     C                     MOVE *BLANKS   CDRO                                                CSD027
     C                     MOVE *BLANKS   CDBR                            S01117
     C           CFT120    IFEQ 'Y'                                                           CFT120
     C                     MOVE *BLANKS   CDRC                                                CFT120
     C                     ENDIF                                                              CFT120
     C                     TIME           LCHT
     C                     Z-ADDRUND      LCD
     C                     MOVE 'I'       CHTP
     C                     MOVE *BLANKS   AUP1
     C                     MOVE *BLANKS   AUP2
     C                     MOVE *BLANKS   AUIN
     C                     MOVE *BLANKS   IACG
     C                     MOVE *BLANKS   SACG
     C                     MOVE *BLANKS   PACG
     C                     MOVE *BLANKS   SMSG
     C                     MOVE *BLANKS   PMSG
     C                     Z-ADDRUND      OEDT
     C                     MOVE RUND      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZDATE     OEDTD1
     C                     Z-ADD0         NPDT
     C                     Z-ADD0         NPDTD1
     C                     Z-ADD0         NPDTD2
     C                     Z-ADD0         NPDTD3
     C                     Z-ADD0         PRBD
     C                     Z-ADD0         DUMA1
     C                     Z-ADD0         DUMA2
     C                     Z-ADD0         DUMA3
     C                     Z-ADD0         DUMA4
     C                     Z-ADD0         DUMA5
     C                     Z-ADD0         DUMA6
     C                     MOVE *BLANKS   FAIN
     C                     MOVE *BLANKS   ADIN
     C                     MOVE *BLANKS   CQIN
     C                     MOVE *BLANK    PRIN
     C                     MOVE *BLANKS   MT100
     C                     MOVE *BLANKS   MT202
     C*********************MOVE *BLANKS   MT400                           E32481
     C*********************MOVE *BLANKS   MT200                           E32481
     C                     MOVE *BLANKS   TXIN
     C                     MOVE *BLANKS   BAIN
     C                     MOVE *BLANKS   ISIN
     C                     MOVE *BLANKS   MPYI
     C                     MOVE *BLANKS   INBT
     C                     MOVE *BLANKS   INB1
     C                     MOVE *BLANKS   INB2
     C                     MOVE *BLANKS   INB3
     C                     MOVE *BLANKS   INB4
     C                     MOVE *BLANKS   INB5
     C                     Z-ADD0         CHAP
     C                     MOVE 'N'       LVL1
     C                     MOVE 'N'       LVL2
     C*                                                                   S01117
     C****RESET BOOKING BRANCH FIELD FROM INPAY **********                S01117
     C*                                                                   S01117
     C                     MOVE IBRC      BRCA                            S01117
      *                                                                   S01435
      * Transfer msg unique reference & part number                       S01435
      *                                                                   S01435
     C           INMSGR    IFNE 0                                         S01435
     C                     Z-ADDINMSGR    OPMSGR                          S01435
     C                     Z-ADDINKPRT    OPKPRT                          S01435
     C                     END                                            S01435
     C*                                                                   S01117
     C                     Z-ADDRUND      LCD                             033601
      *                                                                   CEU006
     C/COPY WNCPYSRC,FT0060C026
      *                                                                   CFT014
      ** Save Instructed Ccy and Amnt of Incoming Payment.                CFT014
      *                                                                   CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
     C                     MOVE NDCY      WNDCY   3                       CFT014
     C                     Z-ADDNDAM      WNDAM  130                      CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      * Initialise Notified & Pay Currencies & amounts to blanks          CEU006
      *                                                                   CEU006
     C           CEU006    IFEQ 'Y'                                       CEU006
     C                     MOVE *BLANKS   NDCY                            CEU006
     C***********          MOVE *BLANKS   PDCY                     CEU006 CFT014
     C                     Z-ADD*ZEROS    NDAM                            CEU006
     C***********          Z-ADD*ZEROS    PDAM                     CEU006 CFT014
     C                     ENDIF                                          CEU006
      *                                                                   CFT014
     C           CEU006    IFEQ 'Y'                                       CFT014
     C           CFT014    OREQ 'Y'                                       CFT014
     C                     MOVE *BLANKS   PDCY                            CFT014
     C                     Z-ADD*ZEROS    PDAM                            CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
      *                                                                   CFT014
     C                     MOVE RECI      OPRECI                          CFT014
     C                     MOVE PREF      OPPREF                          CFT014
     C                     MOVE *BLANK    OPBJPR                          CFT014
     C                     MOVE 'N'       OPAUTO                          CFT014
     C                     MOVE *BLANK    OPSTPI                          CFT014
     C                     MOVE *BLANKS   OPBANO                          CFT014
     C                     MOVE *BLANKS   OPRUSR                          CFT014
     C                     MOVE *BLANKS   OPWSID                          CFT014
     C                     MOVE *BLANKS   OPRDAT                          CFT014
     C                     MOVE STMT      OPSETM                          CFT014
     C                     Z-ADD*ZEROS    OPOEXR                          CFT014
     C                     MOVE *BLANKS   OPTRIT                          CFT014
     C                     MOVE *BLANKS   OPTRI1                          CFT014
     C                     MOVE *BLANKS   OPTRI2                          CFT014
     C                     MOVE *BLANKS   OPTRI3                          CFT014
     C                     MOVE *BLANKS   OPTRI4                          CFT014
     C                     MOVE *BLANKS   OPTRI5                          CFT014
     C                     Z-ADD*ZEROS    OPRCNW                          CFT014
     C                     MOVE *BLANKS   OPRCCN                          CFT014
     C                     MOVE *BLANKS   OPRCUS                          CFT014
     C                     Z-ADD0         OPSCLE                          CFT014
      *                                                                   CFT014
      ** Perform mapping of Incoming Payment fields to Outgoing           CFT014
      ** Payment fields.                                                  CFT014
      *                                                                   CFT014
     C           INMTPY    IFEQ '103'                                     CFT014
      *                                                                   CFT014
      ** Map Instructed Ccy and Instructed Amt if source of Incoming      CFT014
      ** Payment is an MT103.                                             CFT014
      *                                                                   CFT014
     C                     MOVE WNDCY     PDCY                            CFT014
     C                     Z-ADDWNDAM     PDAM                            CFT014
      *                                                                   CFT014
      ** Map Original Rate if source of Incoming Payment is an MT103.     CFT014
      *                                                                   CFT014
     C                     Z-ADDINOEXR    OPOEXR                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Bank Operation Code                                              CFT014
      *                                                                   CFT014
     C                     MOVE INBOCD    OPBOCD                          CFT014
      *                                                                   CFT014
      ** Transaction Type Code                                            CFT014
      *                                                                   CFT014
     C                     MOVE INTTCD    OPTTCD                          CFT014
      *                                                                   CFT014
      ** Instruction Code                                                 CFT014
      *                                                                   CFT014
     C                     MOVE INICD1    OPICD1                          CFT014
     C                     MOVE INICD2    OPICD2                          CFT014
     C                     MOVE INICD3    OPICD3                          CFT014
     C                     MOVE INICD4    OPICD4                          CFT014
     C                     MOVE INICD5    OPICD5                          CFT014
      *                                                                   CFT014
      ** Regulatory Reporting                                             CFT014
      *                                                                   CFT014
     C                     MOVE INRRP1    OPRRP1                          CFT014
     C                     MOVE INRRP2    OPRRP2                          CFT014
     C                     MOVE INRRP3    OPRRP3                          CFT014
      *                                                                   CFT014
      ** Receiver's Charges Remitted                                      CFT014
      *                                                                   CFT014
     C           WCCCY     IFNE WSMCYX                                    CFT014
      *                                                                   CFT014
     C                     CLEARP#0010                                    CFT014
     C                     MOVELWCCCY     P#FRCY                          CFT014
     C                     Z-ADDWCHGS     P#FRAM                          CFT014
     C                     MOVELWSMCYX    P#TOCY                          CFT014
     C                     Z-ADD*ZEROS    P#TOAM                          CFT014
     C                     CALL 'FT0010'                                  CFT014
     C                     PARM           P#0010                          CFT014
      *                                                                   CFT014
     C           P#RTCD    IFEQ '*ERROR*'                                 CFT014
     C                     Z-ADD077       W0ERNB                          CFT014
     C                     MOVEL'*CALL   'W0KEY                           CFT014
     C                     MOVEL'FT0010'  W0FILE                          CFT014
     C                     EXSR SRERR                                     CFT014
     C                     ELSE                                           CFT014
     C           INRCRM    SUB  P#TOAM    WRCRM  110                      CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
     C           INRCRM    SUB  WCHGS     WRCRM                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           WRCRM     IFLT *ZEROS                                    CFT014
     C                     Z-ADD*ZEROS    WRCRM                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     Z-ADD*ZEROS    OPRCRM                          CFT014
     C                     Z-ADD*ZEROS    OPRBCQ                          CFT014
     C                     Z-ADD*ZEROS    OPRCSC                          CFT014
     C                     Z-ADD*ZEROS    OPRCSQ                          CFT014
      *                                                                   CFT014
     C           WRCRM     IFGT *ZEROS                                    CFT014
      *                                                                   CFT014
     C           WSMCYX    IFNE PCCY                                      CFT014
      *                                                                   CFT014
     C                     CLEARP#0010                                    CFT014
     C                     MOVELWSMCYX    P#FRCY                          CFT014
     C                     Z-ADDWRCRM     P#FRAM                          CFT014
     C                     MOVELPCCY      P#TOCY                          CFT014
     C                     Z-ADD*ZEROS    P#TOAM                          CFT014
     C                     CALL 'FT0010'                                  CFT014
     C                     PARM           P#0010                          CFT014
      *                                                                   CFT014
     C           P#RTCD    IFEQ '*ERROR*'                                 CFT014
     C                     Z-ADD078       W0ERNB                          CFT014
     C                     MOVEL'*CALL   'W0KEY                           CFT014
     C                     MOVEL'FT0010'  W0FILE                          CFT014
     C                     EXSR SRERR                                     CFT014
     C                     ELSE                                           CFT014
     C                     Z-ADDP#TOAM    OPRCRM                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
     C                     Z-ADDWRCRM     OPRCRM                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Calculate Receiver's Charges Base Currency Equivalent.           CFT014
      *                                                                   CFT014
     C                     CLEARP#0010                                    CFT014
     C                     MOVELPCCY      P#FRCY                          CFT014
     C                     Z-ADDOPRCRM    P#FRAM                          CFT014
     C                     MOVELBJCYCD    P#TOCY                          CFT014
     C                     Z-ADD0         P#TOAM                          CFT014
     C                     CALL 'FT0010'                                  CFT014
     C                     PARM           P#0010                          CFT014
      *                                                                   CFT014
     C           P#RTCD    IFEQ '*ERROR*'                                 CFT014
     C                     Z-ADD079       W0ERNB                          CFT014
     C                     MOVEL'*CALL   'W0KEY                           CFT014
     C                     MOVEL'FT0010'  W0FILE                          CFT014
     C                     EXSR SRERR                                     CFT014
     C                     ELSE                                           CFT014
     C                     Z-ADDP#TOAM    OPRBCQ                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Receiver's Charges Remitted in Settlement Ccy                    CFT014
      *                                                                   CFT014
     C                     Z-ADDOPRCRM    OPRCSC                          CFT014
      *                                                                   CFT014
      ** Base Currency Equivalent of Receiver's Charges Remitted in       CFT014
      ** Settlement Currency                                              CFT014
      *                                                                   CFT014
     C                     Z-ADDOPRBCQ    OPRCSQ                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Sender's Charges Deducted                                        CFT014
      *                                                                   CFT014
     C                     MOVE INSCY1    OPSCC1                          CFT014
     C                     MOVE INSCH1    OPSCH1                          CFT014
     C                     MOVE INSCY2    OPSCC2                          CFT014
     C                     MOVE INSCH2    OPSCH2                          CFT014
     C                     MOVE INSCY3    OPSCC3                          CFT014
     C                     MOVE INSCH3    OPSCH3                          CFT014
     C                     MOVE INSCY4    OPSCC4                          CFT014
     C                     MOVE INSCH4    OPSCH4                          CFT014
     C                     MOVE INSCY5    OPSCC5                          CFT014
     C                     MOVE INSCH5    OPSCH5                          CFT014
      *                                                                   CFT014
     C                     Z-ADD*ZEROS    WSCHG  110                      CFT014
     C           DTCH      IFEQ 'BEN'                                     CFT014
      *                                                                   CFT014
     C           TXCH      ADD  CQCH      WCHGS                           CFT014
     C                     ADD  CSTA      WCHGS                           CFT014
     C                     ADD  SPCH      WCHGS                           CFT014
     C                     ADD  MSCH      WCHGS                           CFT014
     C                     ADD  TRCM      WCHGS                           CFT014
     C           S01494    IFEQ 'Y'                                       CFT014
     C                     ADD  OPCHCM    WCHGS                           CFT014
     C                     ENDIF                                          CFT014
     C           S01499    IFEQ 'Y'                                       CFT014
     C                     ADD  OPVATT    WCHGS                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           WCHGS     IFNE *ZEROS                                    CFT014
      *                                                                   CFT014
     C                     SELEC                                          CFT014
     C           CDRT      WHNE *BLANKS                                   CFT014
     C                     MOVELBJCYCD    WCCCY                           CFT014
     C           ADDC      WHEQ 'A'                                       CFT014
     C                     MOVELSMCY      WCCCY                           CFT014
     C                     OTHER                                          CFT014
     C                     MOVELPCCY      WCCCY                           CFT014
     C                     ENDSL                                          CFT014
      *                                                                   CFT014
     C           WCCCY     IFNE PCCY                                      CFT014
      *                                                                   CFT014
     C                     CLEARP#0010                                    CFT014
     C                     MOVELWCCCY     P#FRCY                          CFT014
     C                     Z-ADDWCHGS     P#FRAM                          CFT014
     C                     MOVELPCCY      P#TOCY                          CFT014
     C                     Z-ADD*ZEROS    P#TOAM                          CFT014
     C                     CALL 'FT0010'                                  CFT014
     C                     PARM           P#0010                          CFT014
      *                                                                   CFT014
     C           P#RTCD    IFEQ '*ERROR*'                                 CFT014
     C                     Z-ADD080       W0ERNB                          CFT014
     C                     MOVEL'*CALL   'W0KEY                           CFT014
     C                     MOVEL'FT0010'  W0FILE                          CFT014
     C                     EXSR SRERR                                     CFT014
     C                     ELSE                                           CFT014
     C                     Z-ADDP#TOAM    WSCHG                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
     C                     Z-ADDWCHGS     WSCHG                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     SELEC                                          CFT014
      *                                                                   CFT014
     C           OPSCC1    WHEQ *BLANKS                                   CFT014
     C                     MOVE PCCY      OPSCC1                          CFT014
     C                     Z-ADDWSCHG     OPSCH1                          CFT014
     C                     Z-ADD1         OPSCLE                          CFT014
      *                                                                   CFT014
     C           OPSCC2    WHEQ *BLANKS                                   CFT014
     C                     MOVE PCCY      OPSCC2                          CFT014
     C                     Z-ADDWSCHG     OPSCH2                          CFT014
     C                     Z-ADD2         OPSCLE                          CFT014
      *                                                                   CFT014
     C           OPSCC3    WHEQ *BLANKS                                   CFT014
     C                     MOVE PCCY      OPSCC3                          CFT014
     C                     Z-ADDWSCHG     OPSCH3                          CFT014
     C                     Z-ADD3         OPSCLE                          CFT014
      *                                                                   CFT014
     C           OPSCC4    WHEQ *BLANKS                                   CFT014
     C                     MOVE PCCY      OPSCC4                          CFT014
     C                     Z-ADDWSCHG     OPSCH4                          CFT014
     C                     Z-ADD4         OPSCLE                          CFT014
      *                                                                   CFT014
     C                     OTHER                                          CFT014
     C                     MOVE PCCY      OPSCC5                          CFT014
     C                     Z-ADDWSCHG     OPSCH5                          CFT014
     C                     Z-ADD5         OPSCLE                          CFT014
      *                                                                   CFT014
     C                     ENDSL                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                                    BUG12944A
     C                     SELEC                                                           BUG12944A
      *                                                                                       CFT120
     C           SCDRO     WHNE *BLANKS                                                       CFT120
     C           CFT120    ANDEQ'Y'                                                           CFT120
     C           OPCHGC    ANDEQ*BLANKS                                                       CFT120
     C                     MOVELBJCYCD    OPCHGC                                              CFT120
     C           BTCHCY    WHEQ 'F'                                                           CFT120
     C           CFT120    ANDEQ'Y'                                                           CFT120
     C           OPCHGC    ANDEQ*BLANKS                                                       CFT120
     C                     MOVELFCHCCY    OPCHGC                                              CFT120
     C           BTCHCY    WHEQ 'C'                                                        BUG12944A
     C           ADDC      IFEQ 'A'                                                        BUG12944A
     C                     MOVELSMCY      OPCHGC                                           BUG12944A
     C                     ELSE                                                            BUG12944A
     C                     MOVELPCCY      OPCHGC                                           BUG12944A
     C                     ENDIF                                                           BUG12944A
     C           BTCHCY    WHEQ 'L'                                                        BUG12944A
     C                     MOVELBJLCCY    OPCHGC                                           BUG12944A
     C                     OTHER                                                           BUG12944A
     C                     MOVELBJCYCD    OPCHGC                                           BUG12944A
     C                     ENDSL                                                           BUG12944A
      *                                                                   CFT014
      ** Update OPAY details based on IPAY details when Outward payment                       CSW209
      ** generation flag is 'Y' in an IPAY transaction                                        CSW209
      *                                                                                       CSW209
     C           CSW209    IFEQ 'Y'                                                           CSW209
      *                                                                                       CSW209
     C                     MOVELINNWRK    OPNWRK                                              CSW209
     C                     MOVELINMTPE    OPMTPY                                              CSW209
     C                     MOVELINVALF    OPVALF                                              CSW209
      *                                                                                       CSW209
     C           INVALF    IFEQ 'COV'                                                         CSW209
     C                     MOVE INVALF    OPOMVF                                              CSW209
     C                     ELSE                                                               CSW209
     C                     MOVE *BLANKS   OPOMVF                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C                     MOVE *BLANKS   OPOCVF                                              CSW209
      *                                                                                       CSW209
      ** Ordering Customer (Cover) 1 - 5                                                      CSW209
      *                                                                                       CSW209
     C                     MOVELINCOCT    OPCOCT                                              CSW209
     C                     MOVELINCOC1    OPCOC1                                              CSW209
     C                     MOVELINCOC2    OPCOC2                                              CSW209
     C                     MOVELINCOC3    OPCOC3                                              CSW209
     C                     MOVELINCOC4    OPCOC4                                              CSW209
     C                     MOVELINCOC5    OPCOC5                                              CSW209
      *                                                                                       CSW209
      ** Ordering Institution (Cover)                                                         CSW209
      *                                                                                       CSW209
     C                     MOVELINCOBT    OPCOBT                                              CSW209
     C                     MOVELINCOB1    OPCOB1                                              CSW209
     C                     MOVELINCOB2    OPCOB2                                              CSW209
     C                     MOVELINCOB3    OPCOB3                                              CSW209
     C                     MOVELINCOB4    OPCOB4                                              CSW209
     C                     MOVELINCOB5    OPCOB5                                              CSW209
      *                                                                                       CSW209
      ** Intermediary Institution (Cover)                                                     CSW209
      *                                                                                       CSW209
     C                     MOVELINCIBT    OPCIBT                                              CSW209
     C                     MOVELINCIB1    OPCIB1                                              CSW209
     C                     MOVELINCIB2    OPCIB2                                              CSW209
     C                     MOVELINCIB3    OPCIB3                                              CSW209
     C                     MOVELINCIB4    OPCIB4                                              CSW209
     C                     MOVELINCIB5    OPCIB5                                              CSW209
      *                                                                                       CSW209
      ** Account with Institution (Cover)                                                     CSW209
      *                                                                                       CSW209
     C                     MOVELINCABT    OPCABT                                              CSW209
     C                     MOVELINCAB1    OPCAB1                                              CSW209
     C                     MOVELINCAB2    OPCAB2                                              CSW209
     C                     MOVELINCAB3    OPCAB3                                              CSW209
     C                     MOVELINCAB4    OPCAB4                                              CSW209
     C                     MOVELINCAB5    OPCAB5                                              CSW209
      *                                                                                       CSW209
      ** Beneficiary  Customer (Cover)                                                        CSW209
      *                                                                                       CSW209
     C                     MOVELINCBCT    OPCBCT                                              CSW209
     C                     MOVELINCBC1    OPCBC1                                              CSW209
     C                     MOVELINCBC2    OPCBC2                                              CSW209
     C                     MOVELINCBC3    OPCBC3                                              CSW209
     C                     MOVELINCBC4    OPCBC4                                              CSW209
     C                     MOVELINCBC5    OPCBC5                                              CSW209
      *                                                                                       CSW209
     C                     MOVELINCICY    OPCICY                                              CSW209
      *                                                                                       CSW209
     C                     Z-ADDINCIAM    OPCIAM                                              CSW209
      *                                                                                       CSW209
      ** Sender to Receiver Information (Cover A)                                             CSW209
      *                                                                                       CSW209
     C                     MOVE *BLANKS   OPOCB1                                              CSW209
     C                     MOVE *BLANKS   OPOCB2                                              CSW209
     C                     MOVE *BLANKS   OPOCB3                                              CSW209
     C                     MOVE *BLANKS   OPOCB4                                              CSW209
     C                     MOVE *BLANKS   OPOCB5                                              CSW209
     C                     MOVE *BLANKS   OPOCB6                                              CSW209
      *                                                                                       CSW209
      ** Sender to Receiver Information (Cover B)                                             CSW209
      *                                                                                       CSW209
     C                     MOVELINCBB1    OPCBB1                                              CSW209
     C                     MOVELINCBB2    OPCBB2                                              CSW209
     C                     MOVELINCBB3    OPCBB3                                              CSW209
     C                     MOVELINCBB4    OPCBB4                                              CSW209
     C                     MOVELINCBB5    OPCBB5                                              CSW209
     C                     MOVELINCBB6    OPCBB6                                              CSW209
      *                                                                                       CSW209
      ** Remittance Information (Cover)                                                       CSW209
      *                                                                                       CSW209
     C                     MOVELINCDP1    OPCDP1                                              CSW209
     C                     MOVELINCDP2    OPCDP2                                              CSW209
     C                     MOVELINCDP3    OPCDP3                                              CSW209
     C                     MOVELINCDP4    OPCDP4                                              CSW209
      *                                                                                       CSW209
     C                     CALL 'ZAGENTS'                                                     CSW209
     C                     PARM           OPTMST                                              CSW209
      *                                                                                       CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C           PREF      CHAINOTPAYXL0             80                   CFT014
      *                                                                   CFT014
     C           *IN80     IFEQ *OFF                                      CFT014
     C                     Z-ADD081       W0ERNB                          CFT014
     C                     MOVELPREF      W0KEY                           CFT014
     C                     MOVEL'OTPAYXL0'W0FILE                          CFT014
     C                     EXSR SRERR                                     CFT014
     C                     ELSE                                           CFT014
     C                     MOVE TMST      OPTMST                                            BUG12865
     C                     WRITEOTPAYXDF               80                 CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT009
     C           CFT009    IFEQ 'Y'                                       CFT009
     C                     MOVELFXSPSC    FXSRSC                          CFT009
     C                     MOVELINPDOF    OTPDOF                          CFT009
     C                     MOVELTLCODE    TLXCDE                          CFT009
     C                     MOVELCHCHCD    CHQCHC                          CFT009
     C                     MOVEL*BLANKS   CACHCD                          CFT009
     C                     MOVEL*BLANKS   SSTCCD                          CFT009
     C                     MOVEL*BLANKS   SPRCCD                          CFT009
     C                     MOVELMISCH     MSCHC                           CFT009
     C                     MOVELMSCH1     MSCHC1                          CFT009
     C                     MOVELMSCH2     MSCHC2                          CFT009
     C                     MOVELMSCH3     MSCHC3                          CFT009
     C                     MOVELMSCH4     MSCHC4                          CFT009
     C                     MOVELMSCH5     MSCHC5                          CFT009
     C                     MOVELTFCCCO    TFCCCD                          CFT009
     C                     MOVELFXCHEC    FXCACC                          CFT009
     C                     MOVEL*BLANKS   VTSWSC                          CFT009
     C                     MOVELVTMIC1    VMIC1                           CFT009
     C                     MOVELVTMIC2    VMIC2                           CFT009
     C                     MOVELVTMIC3    VMIC3                           CFT009
     C                     MOVELVTMIC4    VMIC4                           CFT009
     C                     MOVELVTMIC5    VMIC5                           CFT009
     C                     Z-ADDMSC01     MISC01                          CFT009
     C                     Z-ADDMSC02     MISC02                          CFT009
     C                     Z-ADDMSC03     MISC03                          CFT009
     C                     Z-ADDMSC04     MISC04                          CFT009
     C                     Z-ADDMSC05     MISC05                          CFT009
     C                     Z-ADD0         SWSCHG                          CFT009
     C                     Z-ADD0         DATNED                          CFT009
     C                     Z-ADD0         DATNAO                          CFT009
     C                     MOVEL*BLANKS   CUNFLA                          CFT009
     C                     MOVEL*BLANKS   OPCHRT                          CFT009
     C                     MOVEL*BLANKS   OPCHGC                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      *                                                                   CEU006
     C                     WRITEOTPAYDDF               80
      *                                                                                     MD054059
      ** Create a record in OTPAYDQD                                                        MD054059
      *                                                                                     MD054059
     C           PREF      CHAINOTPAYQL0             80                                     MD054059
     C           *IN80     IFEQ '1'                                                         MD054059
     C                     MOVE PREF      OTPREF                                            MD054059
     C                     MOVE BRCA      OTBRCA                                            MD054059
     C                     MOVE FRNT      OTFRID                                            MD054059
     C                     MOVE *BLANKS   OTTAX                                             MD054059
     C                     Z-ADD*ZERO     OTSTAF                                            MD054059
     C                     Z-ADD*ZERO     OTCDTE                                            MD054059
     C                     WRITEOTPAYQD0                                                    MD054059
     C                     ENDIF                                                            MD054059
      *                                                                   S01435
      * Update Incoming Message FT Transaction Status File record         S01435
      * if incoming payment created from Incoming Electronic Message      S01435
      *                                                                   S01435
     C           OPMSGR    IFNE 0                                         S01435
      *                                                                   S01435
     C                     MOVEL'OP'      ##OPIN                          S01435
      *                                                                   S01435
     C                     MOVEL'MIN0030' W0FLAG                          S01435
     C                     MOVEL'MIN0189' W0LMSG                          S01435
      *                                                                   S01435
     C                     EXSR SRINFT                                    S01435
      *                                                                   S01435
     C                     END                                            S01435
     C*  UPDATE TRAILER
     C*
     C  N80                DO
     C           1         CHAINOTPAYZZF             80
     C*
     C  N80                DO
     C                     Z-ADDHRWN      ZZTOTI
     C                     Z-ADDHRDC      ZZTOTD
     C                     ADD  1         NORE1
     C           SMAM      DIV  1000      ZZAMT
     C                     EXSR GLZADD
     C                     Z-ADDZZTOTI    HRWN
     C                     Z-ADDZZTOTD    HRDC
     C                     Z-ADDRUND      LCD                             033601
     C*
     C                     UPDATOTPAYZZF
     C*
     C* UPDATE POSITIONS
     C                     END
     C*
     C                     END
     C*
     C                     ENDSR
     C**************************************************************
     C* END OF WOTPAY
      *****************************************************************                       CRE020
      *                                                               *                       CRE020
      *  SRADVC - Update Retail Advice Index File                     *                       CRE020
      *                                                               *                       CRE020
      *****************************************************************                       CRE020
      *                                                                                       CRE020
     C           SRADVC    BEGSR                                                              CRE020
      *                                                                                       CRE020
     C                     OPEN READVCL1                                                      CRE020
     C           *HIVAL    SETLLREADVCL1                                                      CRE020
      *                                                                                       CRE020
     C                     MOVE *BLANKS   RREFNO                                              CRE020
     C                     MOVE *BLANKS   RSEQNO                                              CRE020
     C                     MOVELPREF      RREFNO                                              CRE020
     C                     MOVE 'N'       RSAPIN                                              CRE020
     C                     MOVE PYTP      RTRTYP                                              CRE020
     C                     MOVE 'I'       RCHTYP                                              CRE020
     C                     MOVE 'Y'       RAUTHI                                              CRE020
      *                                                                                       CRE020
      ** Write three records - Debit, Credit and Charges                                      CRE020
      *                                                                                       CRE020
     C                     DO   3         WIDX    10                                          CRE020
     C                     MOVE DCC,WIDX  RSEQNO                                              CRE020
     C                     WRITEREADVCD0                                                      CRE020
     C                     ENDDO                                                              CRE020
      *                                                                                       CRE020
     C                     CLOSEREADVCL1                                                      CRE020
      *                                                                                       CRE020
     C                     ENDSR                                                              CRE020
      *****************************************************************                       CRE020
     C/EJECT                                                                                  CRE020
     C**************************************************************
     C/EJECT
     C* ZABT SR.
     C* COMMON ABORT SUBROUTINE FOR NEW FILE ACCESS ERRORS
     C*
     C           ZABT      BEGSR
     C                     OUT  DLDA
     C                     SETON                     U7U8LR
     C                     DUMP
      *                                                                   042167
      *  Allocate dataarea to blanks                                      042167
      *                                                                   042167
     C                     EXSR DALLOC                                    042167
      *                                                                   042167
     C                     RETRN
     C                     ENDSR
     C/EJECT
     C********************************************************************
     C* DSPTWO SR.
     C* DISPLAYS ENQUIRY SCREEN TWO
     C* CAN GO ON OR BACK
     C*
     C           DSPTWO    BEGSR
     C* DO LOOP UNTIL F3 OR F12
     C           *IN01     DOUEQ'1'                        B001
     C           *IN02     OREQ '1'
     C* DISPLAY SCREEN TWO
     C** To move the time to 'time' on display file                       S01194
     C                     TIME           TIME                            S01194
      *                                                                   059192
      * Initialise no update indicator to allow update                    059192
      *                                                                   059192
     C                     MOVEL*BLANKS   FTNOUP                          059192
      *                                                                   059192
      * Display message subfile                                           059192
      *                                                                   059192
     C**********           MOVEL'1'       *IN56                                       059192 247142A
     C/COPY WNCPYSRC,FT0060C086
      *                                                                                       CFT049
      ** Give Warning if FT Account with Bank is not SWIFT BIC                                CFT049
      *                                                                                       CFT049
     C           CFT049    IFEQ 'Y'                                                           CFT049
     C                     MOVELACB1      WCHK    4                                           CFT049
      *                                                                                       CFT049
     C           *IN60     IFEQ *ON                                                           CFT049
     C           ACBT      ANDNE'S'                                                           CFT049
     C           WCHK      ANDNE'//FW'                                                        CFT049
     C                     MOVEL'FTM0060' FTMSID                                              CFT049
     C                     EXSR FTSNMS                                                        CFT049
     C                     ENDIF                                                              CFT049
     C                     ENDIF                                                              CFT049
      *                                                                                       CFT049
     C**********           WRITE#MSGCTL                                               059192 247142A
      *                                                                   059192
     C***60*****           EXFMTFT0060F4                                                     247142A
     C**N60*****           EXFMTFT0060F7                                                     247142A
     C           *IN60     IFEQ '1'                                                          247142A
     C                     WRITEFT0060F4                                                     247142A
     C                     ELSE                                                              247142A
     C                     WRITEFT0060F7                                                     247142A
     C                     ENDIF                                                             247142A
     C                     MOVEL'1'       *IN56                                              247142A
     C                     WRITE#MSGCTL                                                      247142A
     C           *IN60     IFEQ '1'                                                          247142A
     C                     READ FT0060F4                 80                                  247142A
     C                     ELSE                                                              247142A
     C                     READ FT0060F7                 80                                  247142A
     C                     ENDIF                                                             247142A
     C           *IN05     IFEQ '1'                                                          247142A
     C                     MOVE '0'       *IN05                                              247142A
     C                     MOVE '1'       *IN02                                              247142A
     C                     ELSE                                                             BUG23383
     C                     MOVE '0'       *IN02                                             BUG23383
     C                     ENDIF                                                             247142A
      *                                                                   059192
      * Clear message subfile                                             059192
      *                                                                   059192
     C                     CALL 'Y2CLMSC'                                 059192
     C                     PARM ##PGM     FTPGMQ                          059192
     C                     PARM '*SAME'   FTPGRL                          059192
     C/COPY WNCPYSRC,FT0060C087
      *                                                                   059192
      * Reset message sent flag                                           059192
      *                                                                   059192
     C                     MOVEL'N'       FTMSGS                          059192
     C                     MOVEL*BLANKS   FTWARN                          059192
      *                                                                   059192
     C* DO LOOP
     C**N01N02**           DO                              B002                               257603
     C           *IN01     DOWEQ*OFF                                                          257603
     C           *IN02     ANDEQ*OFF                                                          257603
     C* DISPLAY SCREEN THREE
     C           SCREN3    TAG                                            059192
     C** To move the time to 'time' on display file                       S01194
     C                     TIME           TIME                            S01194
      *                                                                   059192
      * Initialise no update indicator to allow update                    059192
      *                                                                   059192
     C                     MOVEL*BLANKS   FTNOUP                          059192
      *                                                                   059192
     C/COPY WNCPYSRC,FT0060C057
      * Display message subfile                                           059192
      *                                                                   059192
     C**********           MOVEL'1'       *IN56                                       059192 247142A
     C**********           WRITE#MSGCTL                                               059192 247142A
      *                                                                   059192
     C***60*****           EXFMTFT0060F5                                                     247142A
     C**N60*****           EXFMTFT0060F8                                                     247142A
     C           *IN60     IFEQ '1'                                                          247142A
     C                     WRITEFT0060F5                                                     247142A
     C                     ELSE                                                              247142A
     C                     WRITEFT0060F8                                                     247142A
     C                     ENDIF                                                             247142A
     C                     MOVEL'1'       *IN56                                              247142A
     C                     WRITE#MSGCTL                                                      247142A
     C           *IN60     IFEQ '1'                                                          247142A
     C                     READ FT0060F5                 80                                  247142A
     C                     ELSE                                                              247142A
     C                     READ FT0060F8                 80                                  247142A
     C                     ENDIF                                                             247142A
     C           *IN05     IFEQ '1'                                                          247142A
     C                     MOVE '0'       *IN05                                              247142A
     C                     MOVE '1'       *IN02                                              247142A
     C                     ENDIF                                                             247142A
      *                                                                   059192
      * Clear message subfile                                             059192
      *                                                                   059192
     C                     CALL 'Y2CLMSC'                                 059192
     C                     PARM ##PGM     FTPGMQ                          059192
     C                     PARM '*SAME'   FTPGRL                          059192
     C/COPY WNCPYSRC,FT0060C088
      *                                                                   059192
      * Reset message sent flag                                           059192
      *                                                                   059192
     C                     MOVEL'N'       FTMSGS                          059192
     C                     MOVEL*BLANKS   FTWARN                          059192
      *                                                                   059192
      ** Loop on screen 4 until F3 or F12 is pressed.                     CFT014
      *                                                                   CFT014
     C           *IN01     DOWEQ*OFF                                      CFT014
     C           *IN02     ANDEQ*OFF                                      CFT014
      *                                                                   CFT014
      ** Display screen four.                                             CFT014
      *                                                                   CFT014
     C           SCREN4    TAG                                            CFT014
      *                                                                   CFT014
     C           SCDRO     IFNE *BLANKS                                                       CFT145
     C           WWODCN    IFNE WWCDCN                                                        CFT145
     C           *IN60     IFEQ *ON                                                           CFT145
     C                     MOVEL'FTX0023' FTMSID                                              CFT145
     C                     ELSE                                                               CFT145
     C                     MOVEL'FTX0024' FTMSID                                              CFT145
     C                     ENDIF                                                              CFT145
     C                     MOVEL'FTUSRMSG'FTMSGF                                              CFT145
     C                     EXSR FTSNMS                                                        CFT145
     C                     ENDIF                                                              CFT145
     C                     ENDIF                                                              CFT145
      ** Move the time to 'time' on display file.                         CFT014
      *                                                                   CFT014
     C                     TIME           TIME                            CFT014
      *                                                                   CFT014
      ** Initialise no update indicator to allow update.                  CFT014
      *                                                                   CFT014
     C                     MOVEL*BLANKS   FTNOUP                          CFT014
      *                                                                   CFT014
      ** Display message subfile.                                         CFT014
      *                                                                   CFT014
     C**********           MOVEL'1'       *IN56                                       CFT014 247142A
     C**********           WRITE#MSGCTL                                               CFT014 247142A
      *                                                                   CFT014
     C           *IN60     IFEQ *ON                                       CFT014
     C**********           EXFMTFT0060F9                                              CFT014 247142A
     C                     WRITEFT0060F9                                                     247142A
     C                     ELSE                                           CFT014
     C**********           EXFMTFT0060FA                                              CFT014 247142A
     C                     WRITEFT0060FA                                                     247142A
     C                     ENDIF                                          CFT014
     C                     MOVEL'1'       *IN56                                              247142A
     C                     WRITE#MSGCTL                                                      247142A
     C           *IN60     IFEQ *ON                                                          247142A
     C                     READ FT0060F9                 80                                  247142A
     C                     ELSE                                                              247142A
     C                     READ FT0060FA                 80                                  247142A
     C                     ENDIF                                                             247142A
     C           *IN05     IFEQ '1'                                                          247142A
     C                     MOVE '0'       *IN05                                              247142A
     C                     MOVE '1'       *IN02                                              247142A
     C                     ENDIF                                                             247142A
      *                                                                   CFT014
      ** Clear message subfile.                                           CFT014
      *                                                                   CFT014
     C                     CALL 'Y2CLMSC'                                 CFT014
     C                     PARM ##PGM     FTPGMQ                          CFT014
     C                     PARM '*SAME'   FTPGRL                          CFT014
      *                                                                   CFT014
      ** Reset message sent flag.                                         CFT014
      *                                                                   CFT014
     C                     MOVEL'N'       FTMSGS                          CFT014
     C                     MOVEL*BLANKS   FTWARN                          CFT014
      *                                                                   CFT014
      ***********                                                         059192
     C***CALL*WINDOW*PROGRAM*IF*REQUIRED*                          S01241 059192
     C***********BGL5ST****IFEQ 'Y'                                S01177 S01251
     C***********BGWDPR    IFEQ 'Y'                                S01251 059192
      *****/copy*to move data into the data structure fields passedS01241 059192
      ******as*a*parameter to the window controller                S01241 059192
      *COPY*QWINDSRC,FT0060MOV1                                    S01241 059192
      ***********                                                  S01241 059192
     C***********          MOVEL'E'       #ACTN   1                S01241 059192
     C***********          MOVE *BLANKS   RTNCDE  7                S01241 059192
     C***********          MOVE *BLANKS   ##CMD   2                S01241 059192
     C***********          MOVEL'FT0060'  ##PGM  10                S01241 059192
     C***********          CALL 'WN0010'                           S01241 059192
     C***********          PARM           ##PGM                    S01241 059192
     C***********          PARM           ##CMD                    S01241 059192
     C***********          PARM           #ACTN                    S01241 059192
     C***********          PARM           DATA                     S01241 059192
     C**********           PARM           RTNCDE                   S01241 S01252
     C***********          PARM *BLANKS   RTNCDE                   S01252 059192
     C***********          PARM           SPARE 256                S01252 059192
     C***********          END                                     S01241 059192
      *                                                                   059192
      *  Call SRWIND only enter pressed                                   059192
      *                                                                   059192
     C/COPY WNCPYSRC,FT0060C089
     C           *IN01     IFEQ '0'                                       059192
     C           *IN02     ANDEQ'0'                                       059192
     C           ULX043    IFEQ 'Y'                                                           CER001
     C                     MOVE PREF      PREFX                                               CER001
     C                     CALL 'FT0060A'                                                     CER001
     C                     PARM           ACTION  1                                           CER001
     C                     PARM           PDATA                                               CER001
     C                     PARM           #RTRN   7                                           CER001
     C                     PARM           SPARE 256                                           CER001
      *                                                                                       CER001
      ** F3 has been pressed                                                                  CER001
      *                                                                                       CER001
     C           #RTRN     IFEQ 'Y2U9999'                                                     CER001
     C                     MOVE *ON       *INLR                                               CER001
     C                     MOVE '1'       @RETC                                               CER001
      *                                                                                       CER001
      ** Allocate data area to blanks                                                         CER001
      *                                                                                       CER001
     C                     EXSR DALLOC                                                        CER001
     C                     RETRN                                                              CER001
     C                     ELSE                                                               CER001
      *                                                                                       CER001
      ** F12 has been pressed                                                                 CER001
      *                                                                                       CER001
     C           #RTRN     IFEQ 'USR0790'                                                     CER001
     C                     MOVE '1'       *IN02                                               CER001
     C                     MOVEL'Y'       FTNOUP                                              CER001
     C                     ENDIF                                                              CER001
     C                     ENDIF                                                              CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
     C/COPY WNCPYSRC,FT0060C047
     C                     EXSR SRWIND                                    059192
      *                                                                   059192
      *  If no update if not blank redisplay record                       059192
      *                                                                   059192
     C           FTNOUP    IFNE *BLANKS                                   059192
     C           *IN01     ANDEQ'0'                                       059192
     C***********          GOTO SCREN3                             059192 CFT014
      *                                                                                       CER030
     C           CGL013    IFEQ 'Y'                                                           CER030
     C           CER030    OREQ 'Y'                                                           CER030
     C           CER031    OREQ 'Y'                                                           CER030
      *                                                                                       CER030
     C                     GOTO SCREN5                                                        CER030
      *                                                                                       CER030
     C                     ELSE                                                               CER030
      *                                                                                       CER030
     C                     GOTO SCREN4                                                        CER030
      *                                                                                       CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CSW209
     C           CSW209    IFEQ 'Y'                                                           CSW209
      *                                                                                       CSW209
     C                     GOTO COVSCR                                                        CSW209
      *                                                                                       CSW209
     C                     ELSE                                                               CSW209
      *                                                                                       CSW209
     C                     GOTO SCREN4                                    CFT014
      *                                                                                       CSW209
     C                     ENDIF                                                              CSW209
     C*                                                                                       CSW209
     C                     END                                            059192
     C                     END                                            059192
     C/COPY WNCPYSRC,FT0060C090
      *                                                                   059192
      ** Screen 5 display untill F3 or F12 pressed                                            CER030
      *                                                                                       CER030
     C           CGL013    IFEQ 'Y'                                                           CER030
     C           CER030    OREQ 'Y'                                                           CER030
     C           CER031    OREQ 'Y'                                                           CER030
      *                                                                                       CER030
     C           *IN01     DOWEQ*OFF                                                          CER030
     C           *IN02     ANDEQ*OFF                                                          CER030
      *                                                                                       CER030
     C           SCREN5    TAG                                                                CER030
      *                                                                                       CER030
      ** Move the time to 'time' on display file.                                             CER030
      *                                                                                       CER030
     C                     TIME           TIME                                                CER030
      *                                                                                       CER030
      ** Initialise no update indicator to allow update.                                      CER030
      *                                                                                       CER030
     C                     MOVEL*BLANKS   FTNOUP                                              CER030
      *                                                                                       CER030
     C                     EXFMTFT0060FB                                                      CER030
      *                                                                                       CER030
     C           *IN05     IFEQ *ON                                                           CER030
      *                                                                                       CER030
     C                     MOVE *OFF      *IN05                                               CER030
     C                     MOVE *ON       *IN02                                               CER030
      *                                                                                       CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     CALL 'Y2CLMSC'                                                     CER030
     C                     PARM ##PGM     FTPGMQ                                              CER030
     C                     PARM '*SAME'   FTPGRL                                              CER030
      *                                                                                       CER030
     C                     MOVEL'N'       FTMSGS                                              CER030
     C                     MOVEL*BLANKS   FTWARN                                              CER030
      *                                                                                       CER030
     C           *IN01     IFEQ *OFF                                                          CER030
     C           *IN02     ANDEQ*OFF                                                          CER030
      *                                                                                       CER030
     C                     GOTO SCOVSR                                                      AR694651
      *                                                                                     AR694651
     C  N02                SETON                     01                                       CER030
     C                     SETON                     70                                       CER030
      *                                                                                       CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
      ** F12 is pressed                                                                       CER030
      *                                                                                       CER030
     C           *IN02     IFEQ *ON                                                           CER030
     C                     MOVE *ON       *IN03                                               CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     ENDDO                                                              CER030
      *                                                                                       CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
      ** Display Screen 5 until F3 or F12 has been pressed.                                   CSW209
      *                                                                                       CSW209
     C           SCOVSR    TAG                                                              AR694651
      *                                                                                     AR694651
     C           CSW209    IFEQ 'Y'                                                           CSW209
      *                                                                                       CSW209
     C           *IN01     DOWEQ*OFF                                                          CSW209
     C           *IN02     ANDEQ*OFF                                                          CSW209
      *                                                                                       CSW209
     C           COVSCR    TAG                                                                CSW209
      *                                                                                       CSW209
      ** Move the time to 'time' on display file.                                             CSW209
      *                                                                                       CSW209
     C                     TIME           TIME                                                CSW209
      *                                                                                       CSW209
      ** Initialise no update indicator to allow update.                                      CSW209
      *                                                                                       CSW209
     C                     MOVEL*BLANKS   FTNOUP                                              CSW209
      *                                                                                       CSW209
     C           *IN60     IFEQ *ON                                                           CSW209
     C                     EXFMTFT0060FC                                                      CSW209
     C                     ELSE                                                               CSW209
     C                     EXFMTFT0060FE                                                      CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C           *IN05     IFEQ *ON                                                           CSW209
      *                                                                                       CSW209
     C                     MOVE *OFF      *IN05                                               CSW209
     C                     MOVE *ON       *IN02                                               CSW209
      *                                                                                       CSW209
     C                     ELSE                                                               CSW209
      *                                                                                       CSW209
     C                     MOVE *OFF      *IN02                                               CSW209
      *                                                                                       CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C                     CALL 'Y2CLMSC'                                                     CSW209
     C                     PARM ##PGM     FTPGMQ                                              CSW209
     C                     PARM '*SAME'   FTPGRL                                              CSW209
      *                                                                                       CSW209
     C                     MOVEL'N'       FTMSGS                                              CSW209
     C                     MOVEL*BLANKS   FTWARN                                              CSW209
      *                                                                                       CSW209
     C           *IN01     IFEQ *OFF                                                          CSW209
     C           *IN02     ANDEQ*OFF                                                          CSW209
      *                                                                                       CSW209
     C  N02                SETON                     01                                       CSW209
     C                     SETON                     70                                       CSW209
      *                                                                                       CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
      ** F12 is pressed                                                                       CSW209
      *                                                                                       CSW209
     C           *IN02     IFEQ *ON                                                           CSW209
     C                     SETOF                     02                                       CSW209
     C           CGL013    IFEQ 'Y'                                                         AR694651
     C           CER030    OREQ 'Y'                                                         AR694651
     C           CER031    OREQ 'Y'                                                         AR694651
     C                     GOTO SCREN5                                                      AR694651
     C                     ELSE                                                             AR694651
     C                     GOTO SCREN4                                                        CSW209
     C                     ENDIF                                                            AR694651
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C           *IN01     IFEQ *ON                                                           CSW209
      *                                                                                       CSW209
      ** Instructed Amount (Cover)                                                            CSW209
      *                                                                                       CSW209
     C                     MOVE *BLANKS   ZFIELD                                              CSW209
     C                     MOVE *BLANKS   INCAMT                                              CSW209
     C                     MOVE *BLANKS   OPCAMT                                              CSW209
     C                     MOVE *BLANKS   CURRCY  3                                           CSW209
     C           *IN60     IFEQ *ON                                                           CSW209
      *                                                                                       CSW209
     C           OPCIAM    IFNE *ZEROS                                                        CSW209
     C                     MOVE OPCIAM    ZFIELD                                              CSW209
     C                     MOVELOPCICY    CURRCY                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C                     ELSE                                                               CSW209
      *                                                                                       CSW209
     C           INCIAM    IFNE *ZEROS                                                        CSW209
     C                     MOVE INCIAM    ZFIELD                                              CSW209
     C                     MOVELINCICY    CURRCY                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C           ZFIELD    IFNE *BLANKS                                                       CSW209
      *                                                                                       CSW209
      ** Get Input Currency decimal places.                                                   CSW209
      *                                                                                       CSW209
     C                     CALL 'AOCURRR0'                                                    CSW209
     C                     PARM *BLANK    PRTCD                                               CSW209
     C                     PARM '*KEY   ' POPTN                                               CSW209
     C                     PARM CURRCY    PCURR   3                                           CSW209
     C           SDCURR    PARM SDCURR    DSSDY                                               CSW209
      *                                                                                       CSW209
     C           PRTCD     IFNE *BLANKS                                                       CSW209
     C                     MOVEL'FT0060 ' DBPGM                                               CSW209
     C                     MOVEL'SDCURRPD'DBFILE                                              CSW209
     C                     MOVEL'*VERIFY' DBKEY                                               CSW209
     C                     Z-ADD09        DBASE                                               CSW209
     C                     OUT  DLDA                                                          CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
      ** Format amount for screen output                                                      CSW209
      *                                                                                       CSW209
     C                     Z-ADDA6NBDP    PFMDEC  10                                          CSW209
     C                     Z-ADDPFMDEC    ZADEC                                               CSW209
     C                     EXSR ZEDIT                                                         CSW209
      *                                                                                       CSW209
     C           *IN60     IFEQ *ON                                                           CSW209
     C                     MOVE ZFIELD    OPCAMT                                              CSW209
     C                     ELSE                                                               CSW209
     C                     MOVE ZFIELD    INCAMT                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C           *IN60     IFEQ *ON                                                           CSW209
     C                     EXFMTFT0060FD                                                      CSW209
     C                     ELSE                                                               CSW209
     C                     EXFMTFT0060FF                                                      CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C           *IN05     IFEQ *ON                                                           CSW209
      *                                                                                       CSW209
     C                     MOVE *OFF      *IN05                                               CSW209
     C                     MOVE *ON       *IN02                                               CSW209
      *                                                                                       CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
      ** Re-test if last keypressed is Enter                                                  CSW209
      *                                                                                       CSW209
     C           *IN01     IFEQ *OFF                                                          CSW209
     C           *IN02     ANDEQ*OFF                                                          CSW209
      *                                                                                       CSW209
     C  N02                SETON                     01                                       CSW209
     C                     SETON                     70                                       CSW209
      *                                                                                       CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C           *IN02     IFEQ *ON                                                           CSW209
     C                     GOTO COVSCR                                                        CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C                     ENDDO                                                              CSW209
      *                                                                                       CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C*
     C** SETON INDICATOR TO SHOW THAT ALL PAYMENT DETAILS HAVE BEEN
     C** DISPLAYED
     C*
     C           *IN01     IFEQ '0'                                       059192
     C           *IN02     ANDEQ'0'                                       059192
     C  N02                SETON                     01
     C                     SETON                     70
     C                     END                                            059192
     C*
      *                                                                                       CER030
     C           CGL013    IFEQ 'Y'                                                           CER030
     C           CER030    OREQ 'Y'                                                           CER030
     C           CER031    OREQ 'Y'                                                           CER030
     C           *IN02     IFEQ *ON                                                           CER030
     C           *IN03     ANDEQ*ON                                                           CER030
      *                                                                                       CER030
     C                     MOVE *OFF      *IN02                                               CER030
     C                     MOVE *OFF      *IN03                                               CER030
     C                     ENDIF                                                              CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
      ** If F12 is pressed from screen 4, go back to screen 3.            CFT014
      *                                                                   CFT014
     C           *IN02     IFEQ *ON                                       CFT014
     C                     MOVE *ON       *IN03                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDDO                                          CFT014
      *                                                                   CFT014
     C           *IN02     IFEQ *ON                                       CFT014
     C           *IN03     ANDEQ*ON                                       CFT014
     C                     MOVE *OFF      *IN02                           CFT014
     C                     MOVE *OFF      *IN03                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C* IF F12 MUST GET OUT INNER LOOP BUT NOT OUTER LOOP
     C   02                SETON                     03
     C                     END                             E002
     C   02 03             SETOF                     0203
     C                     END                             E001
     C   02                SETOF                     02                                       257603
     C                     ENDSR
     C********************************************************************
     C* END OF SCREEN TWO DISPLAY
     C********************************************************************
     C/EJECT                                                              059192
      *****************************************************************   059192
      *                                                               *   059192
      *  SRWIND   : Control Window Processing                         *   059192
      *                                                               *   059192
      *  CALLED BY: DSPTWO - Display second level screens             *   059192
      *                                                               *   059192
      *  CALLS    : *NONE                                             *   059192
      *                                                               *   059192
      *****************************************************************   059192
     CSR         SRWIND    BEGSR                                          059192
      *                                                                   059192
      *  Set up subroutine stack name                                     059192
      *                                                                   059192
     C                     ADD  1         S       30                      059192
     C                     MOVEL'SRWIND'  @STK,S                          059192
      *                                                                   059192
      * If window processing call WN0010                                  059192
      *                                                                   059192
     C           BGWDPR    IFEQ 'Y'                                       059192
      *                                                                   059192
      *    /copy to move data into the data structure fields passed       059192
      *     as a parameter to the window controller                       059192
      *                                                                   059192
      /COPY WNCPYSRC,FT0060MOV1                                           059192
     C                     MOVE PREF      PREFX                                               CER001
     C                     SELEC                                          059192
     C           *IN60     WHEQ '0'                                       059192
      *                                                                   059192
      *     Incoming Payments                                             059192
      *                                                                   059192
      /COPY WNCPYSRC,FT0060MOV2                                           059192
     C           *IN60     WHEQ '1'                                       059192
      *                                                                   059192
      *     Outgoing Payments                                             059192
      *                                                                   059192
      /COPY WNCPYSRC,FT0060MOV3                                           059192
     C                     ENDSL                                          059192
      *                                                                   059192
     C                     CALL 'WN0010'                                  059192
     C/COPY WNCPYSRC,FT0060C048
     C                     PARM 'FT0060'  O#PGM  10                       059192
     C/COPY WNCPYSRC,FT0060C049
     C                     PARM *BLANKS   O#CMD   2                       059192
     C                     PARM 'E'       O#ACTN  1                       059192
     C                     PARM           DATA                            059192
     C           R#RTN     PARM *BLANKS   O#RTN   7                       059192
     C                     PARM           SPARE 256                       059192
      *                                                                   059192
      *   /copy to move data back from the data structure fields passed   059192
      *    as a parameter to the window controller and control user       059192
      *    defined processing.                                            059192
      *                                                                   059192
      /COPY WNCPYSRC,FT0060MOV4                                           059192
      *                                                                   059192
     C           *LIKE     DEFN O#RTN     R#RTN                           059192
     C           R#RTN     CABEQ*BLANKS   EXWIND                          059192
      *                                                                   059192
      *  Check return code and send message on action                     059192
      *  - set no update as some action has been specified.               059192
      *                                                                   059192
     C                     MOVEL'Y'       FTNOUP                          059192
      **                                                                                      CSC022
      ** Execute rollback if SAR CSC022 is not enrolled or                                    CSC022
      **   job is not currently running in batch mode                                         CSC022
      **                                                                                      CSC022
     C           CSC022    IFEQ 'N'                                                           CSC022
     C                     ROLBK                                          059192
     C                     ELSE                                                               CSC022
     C           WCRSKP    IFEQ 'N'                                                           CSC022
     C                     ROLBK                                                              CSC022
     C                     ELSE                                                               CSC022
     C                     SETON                     U7U8                                     CSC022
     C                     ENDIF                                                              CSC022
     C                     ENDIF                                                              CSC022
      *                                                                   059192
     C                     SELEC                                          059192
      *                                                                   059192
      * *Return code is *User QUIT requested                              059192
      *                                                                   059192
     C           R#RTN     WHEQ 'Y2U9999'                                 059192
     C                     MOVEL'FTW0001' FTMSID                          059192
     C                     MOVEL'FTUSRMSG'FTMSGF                          059192
     C                     EXSR FTSNMS                                    059192
     C                     MOVEL'1'       *IN01                           059192
      *                                                                   059192
      * *Return code is WN Window Error                                   059192
      *                                                                   059192
     C           R#RTN     WHEQ 'USR0563'                                 059192
     C                     MOVEL'USR0563' FTMSID                          059192
     C                     MOVEL'SDUSRMSG'FTMSGF                          059192
     C                     EXSR FTSNMS                                    059192
     C                     MOVEL'1'       *IN01                           059192
      *                                                                   059192
      * *Return code is *DBF update error                                 059192
      *                                                                   059192
     C           R#RTN     WHEQ 'USR0567'                                 059192
     C                     MOVEL'USR0567' FTMSID                          059192
     C                     MOVEL'SDUSRMSG'FTMSGF                          059192
     C                     EXSR FTSNMS                                    059192
     C                     MOVEL'1'       *IN01                           059192
      *                                                                   059192
      * *Return code is *Previous Screen                                  059192
      *                                                                   059192
     C           R#RTN     WHEQ 'USR0790'                                 059192
     C                     MOVEL'FTW0002' FTMSID                          059192
     C                     MOVEL'FTUSRMSG'FTMSGF                          059192
     C                     EXSR FTSNMS                                    059192
     C                     ENDSL                                          059192
     C/COPY WNCPYSRC,FT0060C042
      *                                                                   059192
     C                     END                                            059192
      *                                                                   059192
      *  Unwind subroutine stack name                                     059192
      *                                                                   059192
     C           EXWIND    TAG                                            059192
     C                     MOVEA*BLANKS   @STK,S                          059192
     C                     SUB  1         S                               059192
      *                                                                   059192
     CSR                   ENDSR                                          059192
     C/EJECT                                                              059192
      *****************************************************************   059192
      *                                                               *   059192
      *  FTSNMS   : Send message to program's message queue           *   059192
      *                                                               *   059192
      *  CALLED BY: ALL OVER                                          *   059192
      *                                                               *   059192
      *  CALLS    : *NONE                                             *   059192
      *                                                               *   059192
      *****************************************************************   059192
     CSR         FTSNMS    BEGSR                                          059192
      *                                                                   059192
      * If no program send to FT0090                                      059192
      *                                                                   059192
     C           FTPGMQ    IFEQ *BLANK                                    059192
     C                     MOVEL##PGM     FTPGMQ                          059192
     C                     END                                            059192
      *                                                                   059192
      * If level to send is blanks default to *SAME                       059192
      *                                                                   059192
     C           FTPGRL    IFEQ *BLANK                                    059192
     C                     MOVEL'*SAME'   FTPGRL                          059192
     C                     END                                            059192
      *                                                                   059192
      * If no message file specified, use default                         059192
      *                                                                   059192
     C           FTMSGF    IFEQ *BLANK                                    059192
     C                     MOVEL'FTUSRMSG'FTMSGF                          059192
     C                     END                                            059192
      *                                                                   059192
     C                     CALL 'AOCREPT'                                 059192
     C                     PARM           FTMSID  7                       059192
     C                     PARM           FTMSGF 10                       059192
     C                     PARM           FTMSFL 10                       059192
     C                     PARM           FTMSDT256                       059192
     C                     PARM           FTPGRL  5                       059192
     C                     PARM           FTPGMQ 10                       059192
     C                     PARM           FTMSGQ 10                       059192
     C                     PARM           FTMSGT  7                       059192
      *                                                                   059192
     C                     MOVEL'Y'       FTMSGS  1                       059192
     C                     MOVELFTWARN    FTWARN  1                       059192
      *                                                                   059192
      * Clear all fields for default mechanism next time                  059192
      *                                                                   059192
     C                     MOVEL*BLANK    FTMSID                          059192
     C                     MOVEL*BLANK    FTMSGF                          059192
     C                     MOVEL*BLANK    FTMSFL                          059192
     C                     MOVEL*BLANK    FTMSDT                          059192
     C                     MOVEL*BLANK    FTPGRL                          059192
     C                     MOVEL*BLANK    FTPGMQ                          059192
     C                     MOVEL*BLANK    FTMSGQ                          059192
     C                     MOVEL*BLANK    FTMSGT                          059192
      *================================================================   059192
     CSR         FTEXIT    ENDSR                                          059192
      *****************************************************************   S01435
      *                                                               *   S01435
      *  SRINFT   : Update Incoming Message FT Transaction Status     *   S01435
      *             File record                                       *   S01435
      *  CALLS    : SRERR   - report error and close down program     *   S01435
      *                                                               *   S01435
      *                                                               *   S01435
      *  CALLED BY: ADOTPY  - update Inpaydd                          *   S01435
      *             FILEUP  - update Otpaydd                          *   S01435
      *                                                               *   S01435
      *                                                               *   S01435
      *****************************************************************   S01435
     CSR         SRINFT    BEGSR                                          S01435
      *                                                                   S01435
      *  Set up subroutine stack name                                     S01435
      *                                                                   S01435
     C                     ADD  1         S                               S01435
     C                     MOVEL'SRINFT'  @STK,S                          S01435
      *                                                                   S01435
      *  Fill record format data structure with available data            S01435
      *                                                                   S01435
     C                     CLEARINFT                                      S01435
      *                                                                   S01435
      * If ##OPIN equal 'OP' Outgoing payment processed, if equal 'IN'    S01435
      * than Incoming payment                                             S01435
      *                                                                   S01435
     C           ##OPIN    IFEQ 'OP'                                      S01435
     C                     Z-ADDOPMSGR    FTMSGR           Unique Ref.    S01435
     C                     Z-ADDOPKPRT    FTKPRT           Part No.       S01435
     C                     MOVELW0FLAG    FTOTFG           Outgoing Flag  S01435
     C                     MOVELPREF      FTOPRF           Outg. Pay. Ref S01435
     C                     MOVEL'*FT OUT 'W2ACT                           S01435
     C                     ELSE                                           S01435
     C           ##OPIN    IFEQ 'IN'                                      S01435
     C                     Z-ADDINMSGR    FTMSGR           Unique Ref.    S01435
     C                     Z-ADDINKPRT    FTKPRT           Part No.       S01435
     C                     MOVELW0FLAG    FTINFG           Incoming Flag  S01435
     C                     MOVELPREF      FTIPRF           Incom. Pay. RefS01435
     C                     MOVEL'*FT INC 'W2ACT                           S01435
     C                     END                                            S01435
     C                     END                                            S01435
      *                                                                   S01435
     C                     MOVELBRCA      FTBRCA           Branch Code    S01435
     C                     MOVEL*BLANKS   FTFRGL           Funds From     S01435
     C                     MOVEL*BLANKS   FTTOGL           Funds To       S01435
      *                                                                   S01435
     C                     MOVELW0LMSG    W2LMSG           Log file Msg IDS01435
     C                     MOVEL*BLANKS   W2NWRK           Network        S01435
      *                                                                   S01435
      *  N.B. Audit Stamp details are determined in called program        S01435
      *                                                                   S01435
      *                                                                   S01435
      *  Set up data to be passed using the rcd format data structure     S01435
      *                                                                   S01435
     C                     CALL 'ME1050'               90                 S01435
     C                     PARM           W2ACT   8                       S01435
     C                     PARM ##PGM     W2CPGM 10                       S01435
     C                     PARM           W2NWRK  6                       S01435
     C                     PARM           W2LMSG  7                       S01435
     C                     PARM           INFT                            S01435
     C                     PARM *BLANKS   W2RTN   7                       S01435
      *                                                                   S01435
      *  If return with an error (LR seton in called program) then        S01435
      *  process for database error.                                      S01435
      *                                                                   S01435
     C           *IN90     IFEQ '1'                                       S01435
     C           W2RTN     OREQ '*ERROR*'                                 S01435
     C                     MOVEL'ME1050  'W0FILE           ***************S01435
     C                     MOVEL'*CALL'   W0KEY            * DB ERROR 20 *S01435
     C                     Z-ADD20        W0ERNB           ***************S01435
     C                     EXSR SRERR                                     S01435
     C                     END                                            S01435
      *                                                                   S01435
      *  Unwind subroutine stack name                                     S01435
      *                                                                   S01435
     C           EXLOG     TAG                                            S01435
     C                     MOVEA*BLANKS   @STK,S                          S01435
     C                     SUB  1         S                               S01435
      *                                                                   S01435
     CSR                   ENDSR                                          S01435
     C/EJECT                                                              S01435
      *****************************************************************   S01435
      *                                                               *   S01435
      *  SRERR    : Report error and close down program               *   S01435
      *                                                               *   S01435
      *  CALLED BY: SRINFT- Update Incoming Message FT Transaction    *   S01435
      *                     Status File record                        *   S01435
      *                                                               *   S01435
      *  CALLS    : *NONE                                             *   S01435
      *                                                               *   S01435
      *****************************************************************   S01435
     CSR         SRERR     BEGSR                                          S01435
      *                                                                   S01435
      *  Define work variables                                            S01435
      *                                                                   S01435
     C           *LIKE     DEFN @BKEY     W0KEY                           S01435
     C           *LIKE     DEFN @BERNB    W0ERNB                          S01435
     C           *LIKE     DEFN @BFILE    W0FILE                          S01435
     C           *LIKE     DEFN @BNARR    W0NARR                          S01435
      *                                                                   S01435
      *  Dump program                                                     S01435
      *                                                                   S01435
     C                     DUMP                                           S01435
      **                                                                                      CSC022
      ** Execute rollback if SAR CSC022 is not enrolled or                                    CSC022
      **   job is not currently running in batch mode                                         CSC022
      **                                                                                      CSC022
     C           CSC022    IFEQ 'N'                                                           CSC022
     C           CSC022    OREQ 'Y'                                                           CSC022
     C           WCRSKP    ANDEQ'N'                                                           CSC022
     C                     ROLBK                                          S01435
     C                     ENDIF                                                              CSC022
      *                                                                   S01435
      *  Send message to MOPERQ                                           S01435
      *                                                                   S01435
     C                     MOVEL*BLANKS   DBDTA                           S01435
     C                     MOVEL'FT0060  '@BPGM                           S01435
     C           S         IFGT 1                                         S01435
     C           S         ANDLT21                                        S01435
     C                     MOVEL@STK,S    @BSTK                           S01435
     C                     ELSE                                           S01435
     C                     MOVEL'*Nostkin'@BSTK                           S01435
     C                     END                                            S01435
     C                     MOVELW0KEY     @BKEY                           S01435
     C                     Z-ADDW0ERNB    @BERNB                          S01435
     C                     MOVELW0FILE    @BFILE                          S01435
     C                     MOVELPREF      @BPREF                          S01435
     C           W0NARR    IFEQ *BLANKS                                   S01435
     C                     MOVELERR@,1    @BNARR                          S01435
     C                     ELSE                                           S01435
     C                     MOVELW0NARR    @BNARR                          S01435
     C                     END                                            S01435
      *                                                                   S01435
     C                     CALL 'AOCREPT'              9090               S01435
     C                     PARM 'MEM5000' #MSGID  7                       S01435
     C                     PARM 'MIDAS  ' #MSGF  10                       S01435
     C                     PARM *BLANKS   #MSGFL 10                       S01435
     C                     PARM DBDTA     #MSGDT256                       S01435
     C                     PARM '*PRV'    #MSGR   5                       S01435
     C                     PARM '*'       #PRGM  10                       S01435
     C                     PARM 'MOPERQ ' #MSGQ  10                       S01435
     C                     PARM '*INFO  ' #MSGT   7                       S01435
      *                                                                   S01435
      *  Close down program                                               S01435
      *                                                                   S01435
     C           *LOCK     IN   DLDA                                      S01435
     C                     MOVE 'FT0060  'DBPGM                           S01435
     C                     MOVELW0FILE    DBFILE                          S01435
     C                     Z-ADDW0ERNB    DBASE                           S01435
     C                     MOVELW0KEY     DBKEY                           S01435
     C                     OUT  DLDA                                      S01435
     C                     SETON                     U7U8LR               S01435
      *                                                                   S01435
      *  Allocate dataarea to blanks                                      S01435
      *                                                                   S01435
     C                     EXSR DALLOC                                    S01435
      *                                                                   S01435
     C                     RETRN                                          S01435
     C                     MOVEL*BLANKS   R#RTN                           S01435
      *                                                                   S01435
     CSR         EXERR     ENDSR                                          S01435
     C/EJECT
     C********************************************************************
     C**                                                                  S01199
     C**HELP SR.                                                          S01199
     C**CALLS HELP  PROGRAM                                               S01199
     C**                                                                  S01199
     C**         HELP      BEGSR                                          S01199
     C**                   MOVEAERCD      HERCD 160                       S01199
     C**                   MOVEL'FT0000'  HBPGM   6                       S01199
     C**                   CALL 'MHELP'                                   S01199
     C**                   PARM           HBPGM                           S01199
     C**                   PARM           HERCD                           S01199
     C**                   SETOF                     01                   S01199
     C**                   ENDSR                                          S01199
     C********************************************************************
     C* END OF HELP SUBROUTINE
     C********************************************************************
     C/EJECT                                                              S01194
     C********************************************************************S01194
     C* AOBANK SR.                                                        S01194
     C* MOVES COMMONLY USED FIELDS TO OLD FIELD NAMES                     S01194
     C*                                                                   S01194
     C           AOBANK    BEGSR                                          S01194
     C                     MOVE BJLCCY    LOCY    3                       S01194
     C                     MOVE BJCYCD    BCCY    3                       S01194
     C                     Z-ADDBJRDNB    RUND    50                      S01194
     C                     MOVE BJMRDT    SRUNA   7                       S01194
     C                     ENDSR                                          S01194
     C********************************************************************S01194
     C* END OF AOBANK SUBROUTINE                                          S01194
     C********************************************************************S01194
     C/EJECT                                                              S01194
     C********************************************************************S01194
     C* AOCURR SR.                                                        S01194
     C* MOVES COMMONLY USED FIELDS TO OLD FIELD NAMES                     S01194
     C*                                                                   S01194
     C           AOCURR    BEGSR                                          S01194
     C                     Z-ADDA6NBDP    CDP     10                      S01194
     C                     Z-ADDA6SPRT    SPOT   138                      S01194
     C*                                                                   S01194
     C** Due to change in files ; a6mdin now can be M (multiply) or D     S01194
     C** (divide) on sdcurrpd previously mdin was 1 (multiply) or 0       S01194
     C** (divide) on  tabtg10                                             S01194
     C           A6MDIN    IFEQ 'M'                                       S01194
     C                     Z-ADD1         MDIN                            S01194
     C                     ELSE                                           S01194
     C                     Z-ADD0         MDIN                            S01194
     C                     END                                            S01194
     C                     ENDSR                                          S01194
     C********************************************************************S01194
     C* END OF AOCURR SUBROUTINE                                          S01194
     C********************************************************************S01194
     C/EJECT                                                              S01194
     C********************************************************************S01194
     C*                                                                   S01194
     C* MOVES COMMONLY USED FIELDS TO OLD FIELD NAMES                     S01194
     C*                                                                   S01194
     C           AONOST    BEGSR                                          S01194
     C                     MOVE A7CUST    CNUMA                           S01194
     C                     MOVE A7ACCD    ACOD                            S01194
     C                     Z-ADDA7ACSN    ACSQ                            S01194
     C                     MOVE A7BRCD    BRCA                            S01194
     C                     ENDSR                                          S01194
     C********************************************************************S01194
     C* END OF AOBANK SUBROUTINE                                          S01194
     C********************************************************************S01194
     C/EJECT                                                              S01194
     C********************************************************************S01117
     C* BBAUTH SR.                                                        S01117
     C* CALL TO ZVACTBU(USER/BRANCH/ACTIONCODE VALIDATION)                S01117
     C*                                                                   S01117
     C           BBAUTH    BEGSR                                          S01117
     C/COPY WNCPYSRC,FT0060C091
     C                     CALL 'ZVACTBU'                                 S01117
     C                     PARM 'X'       ZACTN   1                       S01117
     C                     PARM BRCA      ZBRCA   3                       S01117
     C                     PARM 0         ZRETC   10                      S01117
     C/COPY WNCPYSRC,FT0060C092
     C*                                                                   S01117
     C           ZRETC     IFEQ 1                                         S01117
     C                     SETON                     2089                 S01117
     C                     MOVE ' 303'    ERCD,Z                          S01117
     C                     ADD  1         Z                               S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C           ZRETC     IFEQ 2                                         106483
     C                     MOVE '1'       *IN45                           106483
     C                     END                                            106483
     C                     ENDSR                                          S01117
     C********************************************************************S01117
     C* END OF SUBROUTINE BBAUTH                                          S01117
     C********************************************************************S01117
     C/EJECT                                                              S01117
     C********************************************************************S01117
     C* OBAUTH SR.                                                        S01117
     C* CALL TO ZVOBU(USER/ORIGINATING BRANCH VALIDATION)                 S01117
     C*                                                                   S01117
     C           OBAUTH    BEGSR                                          S01117
     C                     CALL 'ZVOBU'                                   S01117
     C                     PARM ORBR      ZORBR   3                       S01117
     C                     PARM 0         ZRETC2  10                      S01117
     C*                                                                   S01117
     C           ZRETC2    IFEQ 1                                         S01117
     C                     SETON                     2089                 S01117
     C                     MOVE ' 305'    ERCD,Z                          S01117
     C                     ADD  1         Z                               S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C           ZRETC2    IFEQ 2                                         S01117
     C                     SETON                     2089                 S01117
     C                     MOVE ' 306'    ERCD,Z                          S01117
     C                     ADD  1         Z                               S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     ENDSR                                          S01117
     C********************************************************************S01117
     C* END OF SUBROUTINE OBAUTH                                          S01117
     C********************************************************************S01117
     C/EJECT                                                              S01194
      *****************************************************************                       241810
      * CHKWIP SR.                                                    *                       241810
      * Subroutine to check if the payment is has a record appearing  *                       241810
      * on the WIP Listview, if it does then you should not be able   *                       241810
      * to authorise this payment.                                    *                       241810
      *                                                               *                       241810
      *****************************************************************                       241810
      *                                                                                       241810
     C           CHKWIP    BEGSR                                                              241810
      **********                                                                     241810 BUG18708
      ***Get*zone from SDBRCHPD                                                      241810 BUG18708
      **********                                                                     241810 BUG18708
     C**********           CALL 'AOBRCHR1'                                           241810 BUG18708
     C**********           PARM *BLANKS   @RTCD   7                                  241810 BUG18708
     C**********           PARM '*KEY   ' @OPTN   7                                  241810 BUG18708
     C**********           PARM BRCA      @BRKEY  3                                  241810 BUG18708
     C********** SDBRCH    PARM SDBRCH    DSSDY                                      241810 BUG18708
      *                                                                                     BUG18708
      ** Get zone from GZSDBRCHPD                                                           BUG18708
      *                                                                                     BUG18708
     C                     CALL GPBRCH                                                      BUG18708
     C                     PARM *BLANKS   I#RTCD  7                                         BUG18708
     C                     PARM           I#ERMS  50                                        BUG18708
     C                     PARM BRCA      I#BRCD  3                                         BUG18708
     C                     PARM           SDBRCH                                            BUG18708
      *                                                                                       241810
     C********** @RTCD     IFNE *BLANKS                                              241810 BUG18708
     C           I#RTCD    IFNE *BLANKS                                              241810 BUG18708
     C           *LOCK     IN   DLDA                                                          241810
     C                     Z-ADD11        DBASE                                               241810
     C**********           MOVEL'SDBRCHPD'DBFILE                                     241810 BUG18708
     C                     MOVEL'GZSDBRCH'DBFILE                                     241810 BUG18708
     C                     MOVELBRCA      DBKEY                                               241810
     C                     MOVE '*'       @RETC                                               241810
     C                     EXSR ZABT                                                          241810
     C                     END                                                                241810
      *                                                                                       241810
      ** Setup Key for chain to GPFTWIPL                                                      241810
      *                                                                                       241810
     C                     MOVELA8ZONE    WIPZON                                              241810
     C                     MOVELPREF      WIPREF                                              241810
     C*                                                                                       241810
     C           KWIP      CHAINT@MSWIP             N58                                       241810
      *                                                                                       241810
      ** Record exists on WIP so not allowed to authorise this payment                        241810
      *                                                                                       241810
     C           *IN58     IFEQ *OFF                                                          241810
     C                     SETON                     2089                                     241810
     C                     MOVE ' 501'    ERCD,Z                                              241810
     C                     ADD  1         Z                                                   241810
     C                     ENDIF                                                              241810
      *                                                                                       241810
     C                     ENDSR                                                              241810
     C*****************************************************************                       241810
     C* END OF SUBROUTINE CHKWIP                                                              241810
     C*****************************************************************                       241810
     C/EJECT                                                                                  241810
     C********************************************************************S01194
     C           FLDQRY    BEGSR                                          S01194
      *----------------------------------------------------------------   S01194
      * Subroutine to resolve entry of ? for standing data fields.        S01194
      * Performed after function key validation and prior to field        S01194
      * validation                                                        S01194
      *                                                                   S01194
      * Indicators used:                                                  S01194
      *  52       on then redisplay screen                                S01194
      *  53       used in LOKUP, on if ? found                            S01194
      *----------------------------------------------------------------   S01194
     C                     SETOF                     5253                 S01194
      *                                                                   S01194
      * check currency for entry of ? (SYCY)                              S01194
     C                     MOVEA*BLANKS   FLDQ                            S01194
     C                     MOVEASYCY      FLDQ                            S01194
     C           '?'       LOKUPFLDQ                     53               S01194
      *                                                                   S01194
      * if ? found seton redisplay ind and call access program            S01194
     C           *IN53     IFEQ '1'                                       S01194
     C                     SETON                     52                   S01194
     C                     CALL 'AOCURRR0'                                S01194
     C                     PARM *BLANKS   @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM '?'       @CYCD   3                       S01194
     C***********SDCURR    PARM SDCURR    DSFDY                           S01194              CSD006
     C           SDCURR    PARM SDCURR    DSSDY                                               CSD006
      *                                                                   S01194
      * if selection made move value to screen field                      S01194
     C           @RTCD     IFEQ *BLANKS                                   S01194
     C                     MOVE A6CYCD    SYCY                            S01194
     C                     ELSE                                           S01194
     C                     MOVE *BLANKS   SYCY                            S01194
     C                     END                                            S01194
      *                                                                   S01194
     C                     SETOF                     53                   S01194
     C                     END                                            S01194
      *                                                                   S01194
      * check currency for entry of ? (RCCY)                              S01194
     C                     MOVEA*BLANKS   FLDQ                            S01194
     C                     MOVEARCCY      FLDQ                            S01194
     C           '?'       LOKUPFLDQ                     53               S01194
      *                                                                   S01194
      * if ? found seton redisplay ind and call access program            S01194
     C           *IN53     IFEQ '1'                                       S01194
     C                     SETON                     52                   S01194
     C                     CALL 'AOCURRR0'                                S01194
     C                     PARM *BLANKS   @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM '?'       @CYCD   3                       S01194
     C***********SDCURR    PARM SDCURR    DSFDY                           S01194              CSD006
     C           SDCURR    PARM SDCURR    DSSDY                                               CSD006
      *                                                                   S01194
      * if selection made move value to screen field                      S01194
     C           @RTCD     IFEQ *BLANKS                                   S01194
     C                     MOVE A6CYCD    RCCY                            S01194
     C                     ELSE                                           S01194
     C                     MOVE *BLANKS   RCCY                            S01194
     C                     END                                            S01194
      *                                                                   S01194
     C                     SETOF                     53                   S01194
     C                     END                                            S01194
      *                                                                   S01194
     C                     ENDSR                                          S01194
     C********************************************************************S01194
     C* END OF SUBROUTINE FLDQRY                                          S01194
     C********************************************************************S01194
     C/EJECT
     C********************************************************************
     C* EDIT SR.
     C* EDIT VALUE FIELDS FOR LEADINGS ZEROS AND DECIMAL POINT
     C*
     C           EDIT      BEGSR
     C* FIND WHERE DECIMAL POINT SHOULD BE
     C           13        SUB  CDP       DP      30
     C                     Z-ADD14        X       30
     C                     Z-ADD13        Y       30
     C* IF NO DECIMAL PLACES RIGHT JUSTIFY FIELD
     C           CDP       IFEQ 0                          B001
     C                     Z-ADD0         Y
     C                     MOVEADIG1,1    DIG2,2
     C                     END                             E001
     C* LOOP TO MOVE DIGITS TO EDITED FIELD
     C           Y         DOWGT0                          B001
     C           Y         IFEQ DP                         B002
     C                     MOVE '.'       DIG2,X
     C                     SUB  1         X
     C                     END                             E002
     C                     MOVE DIG1,Y    DIG2,X
     C                     SUB  1         X
     C                     SUB  1         Y
     C                     END                             E001
     C                     Z-ADD1         X
     C* LOOP TO SUPPRESS LEADING ZEROS
     C           X         DOUEQDP                         B001
     C           DIG2,X    IFEQ ' '                        B002
     C           DIG2,X    OREQ '0'
     C                     MOVE ' '       DIG2,X
     C                     ADD  1         X
     C                     ELSE                            X002
     C                     Z-ADDDP        X
     C                     END                             E002
     C                     END                             E001
     C                     ENDSR
     C********************************************************************
     C* END OF EDIT SUBROUTINE
     C********************************************************************
     C/COPY WNCPYSRC,FT0060C004
     C/EJECT
     C********************************************************************042167
     C* SUBROUTINE TO DEALLOCATE DATAAREA                                 042167
     C*                                                                   042167
     C           DALLOC    BEGSR                           *** DALLOC ****042167
      *                                                                   042167
      * Call CL program to de-allocate                                    042167
      *                                                                   042167
     C                     MOVE *BLANKS   @RTCDE                          042167
     C                     MOVE 'FT'      @MODLE                          042167
     C                     MOVE *BLANKS   @TREF                           042167
     C                     MOVE *BLANKS   @RTINF                          042167
     C                     CALL 'AOC8000'                                 042167
     C                     PARM           @RTCDE                          042167
     C                     PARM           @MODLE                          042167
     C                     PARM           @TREF                           042167
     C                     PARM           @RTINF                          042167
      *                                                                   042167
     C                     ENDSR                                          042167
      *                                                                   042167
     C*                                                                   042167
     C/EJECT
     C********************************************************************
     C**
     C**   ZALIGN SR. TO VALIDATE AND RIGHT-ALIGN NUMERIC FIELDS.
     C**
     C           ZALIGN    BEGSR                           *** ZALIGN ***
     C**
     C                     SETOF                     929399
     C**
     C**   SAVE INPUT FIELD IN ARRAY, ZA1.
     C                     MOVEAZFIELD    ZA1
     C**
     C**   CALCULATION TO DEFINE NUMBER STRUCTURE CONTROL FIELDS.
     C                     Z-ADDZADIG     ZADIG   20
     C                     Z-ADDZADEC     ZADEC   10
     C**
     C**   CALCULATIONS TO DEFINE/CLEAR FIELDS.
     C                     MOVE ' '       ZA2
     C                     MOVEAZA2       ZFIELD 16
     C                     Z-ADD0         ZX      20
     C                     Z-ADD0         ZY      20
     C**
     C**   ENSURE REQUIRED STRUCTURE OF FIELD IS VALID.
     C           ZADIG     ADD  ZADEC     ZZ      20
     C           ZZ        COMP 15                   99
     C   99                GOTO ZAEND
     C**
     C**   LOOP TO FIND DECIMAL POINT, BLANKS AND CHARACTERS.
     C           ZATAG1    TAG                             ** ZATAG1 TAG *
     C           ZX        ADD  1         ZX
     C**
     C**   CHECK FOR DECIMAL POINT. ERROR IF SECOND DECIMAL POINT.
     C           ZA1,ZX    COMP '.'                      90
     C   90 93             SETON                     99
     C   99                GOTO ZAEND
     C**
     C**
     C**   CHECK FOR 'M' CONSTANT. ERROR IF NOT LAST CHARACTER ENTERED
     C           ZA1,ZX    COMP 'M'                      96
     C   96                DO
     C           ZX        COMP 15                   99  99
     C   99                GOTO ZAEND
     C           ZX        ADD  1         ZX
     C           ZA1,ZX    COMP ' '                  9999
     C   99                GOTO ZAEND
     C           ZX        SUB  1         ZX
     C           ZX        COMP 9                    99
     C   99                GOTO ZAEND
     C                     END
     C**
     C**   CHECK FOR 'T' CONSTANT. ERROR IF NOT LAST CHARACTER ENTERED
     C           ZA1,ZX    COMP 'T'                      97
     C   97                DO
     C           ZX        COMP 15                   99  99
     C   99                GOTO ZAEND
     C           ZX        ADD  1         ZX
     C           ZA1,ZX    COMP ' '                  9999
     C   99                GOTO ZAEND
     C           ZX        SUB  1         ZX
     C           ZX        COMP 12                   99
     C   99                GOTO ZAEND
     C                     END
     C**
     C**   CLEAR ALPHAMERIC CONSTANT FROM ZA1
     C   96
     COR 97                MOVE ' '       ZA1,ZX
     C**
     C**   CHECK FOR BLANKS. BYPASS FOR FIRST BLANK AFTER A DIGIT.
     C           ZA1,ZX    COMP ' '                      91
     C   91 92             GOTO ZATAG2
     C**
     C**   CHECK FOR NUMERIC, IF NOT '.' OR ' '.
     C  N90N91   ZA1,ZX    COMP '0'                    99
     C  N90N91N99ZA1,ZX    COMP '9'                  99
     C   99                GOTO ZAEND                      NOT NUMERIC
     C**
     C**   STORE DIGITS IN ARRAY AND HOW MANY.
     C**   ZY, TOTAL OF DIGITS IN THE INPUT FIELD.
     C**   ZZ, TOTAL OF DIGITS TO THE LEFT OF DECIMAL POINT.
     C  N90N91   ZY        ADD  1         ZY         92
     C  N90N91             MOVE ZA1,ZX    ZA2,ZY
     C   90                Z-ADDZY        ZZ         93  93
     C**
     C           ZX        COMP 16                     94  CHECK IF ALL
     C   94                GOTO ZATAG1
     C**
     C           ZATAG2    TAG                             ** ZATAG2 TAG *
     C**
     C**   IF 'M' SPECIFIED, MULTIPLY ZA1 BY 1 MILLION
     C   96      ZZ        ADD  6         ZZ
     C**
     C**   IF 'T' SPECIFIED, MULTIPLY ZA1 BY 1 THOUSAND
     C   97      ZZ        ADD  3         ZZ
     C**
     C**   FILL IN ZEROS IN ANY BLANKS LEFT OF DECIMAL POINT
     C   96 93
     COR 97 93   ZZ        DOWGTZY
     C           ZY        ADD  1         ZY
     C                     MOVE '0'       ZA2,ZY
     C                     END
     C**
     C**   IF CONSTANT SPECIFIED WITH NO DECIMAL POINT ZEROISE BLANKS
     C   96N93             DO   6
     C           ZY        ADD  1         ZY
     C                     MOVE '0'       ZA2,ZY
     C                     END
     C**
     C   97N93             DO   3
     C           ZY        ADD  1         ZY
     C                     MOVE '0'       ZA2,ZY
     C                     END
     C**
     C**   IF NO DECIMAL POINT FOUND, SET TOTAL FIELD ZZ.
     C  N93                Z-ADDZY        ZZ
     C**
     C**   CHECK FOR EMBEDDED BLANKS.
     C   91 92             MOVEAZA1,ZX    ZFIELD
     C   91 92   ZFIELD    COMP ' '                  9999
     C   99                GOTO ZAEND                      EMBEDDED BLANK
     C**
     C**   ENSURE THAT NUMBER OF DIGITS ENTERED EITHER SIDE
     C**   OF DECIMAL POINT ARE NOT MORE THAN ALLOWED.
     C           ZZ        COMP ZADIG                99
     C           ZY        SUB  ZZ        ZX
     C  N99      ZADEC     SUB  ZX        ZX           9995
     C   99                GOTO ZAEND
     C   95                GOTO ZATAG4                     NO TRAILING
     C**                                                   BLANKS.
     C**   FILL THE TRAILING BLANKS WITH ZEROS.
     C           ZY        ADD  ZX        ZZ
     C           ZATAG3    TAG                             ** ZATAG3 TAG *
     C           ZY        ADD  1         ZY
     C                     MOVE '0'       ZA2,ZY
     C           ZY        COMP ZZ                     94
     C   94                GOTO ZATAG3
     C**
     C**   RIGHT-ALIGN THE VALUE BY MOVING BACK TO ARRAY, ZA1.
     C           ZATAG4    TAG                             ** ZATAG4 TAG *
     C                     MOVE '0'       ZA1
     C                     Z-ADD16        ZX
     C           ZATAG5    TAG                             ** ZATAG5 TAG *
     C           ZY        COMP 0                        94
     C   94                GOTO ZATAG6
     C                     MOVE ZA2,ZY    ZA1,ZX
     C           ZY        SUB  1         ZY
     C           ZX        SUB  1         ZX
     C                     GOTO ZATAG5
     C           ZATAG6    TAG                             ** ZATAG6 TAG *
     C**
     C**   MOVE VALIDATED AND RIGHT-ALIGNED NUMBER BACK INTO ZFIELD.
     C                     MOVEAZA1       ZFIELD
     C**
     C                     SETOF                     9697
     C**
     C           ZAEND     ENDSR                           * ZAEND ENDSR *
     C**
     C**
     C********************************************************************
3807 C**
3808 C**   ZDATE2 SR. TO CONVERT A DAY NUMBER TO DATE FORMATS.
3809 C**
3810 C**   THE YEAR 2000, BEING DIVISIBLE BY 400, IS A LEAP YEAR.
3811 C**
3812 C           ZDATE2    BEGSR                           *** ZDATE2 ***
3813 C**
3814 C**   CLEAR DATE FIELDS.
3815 C                     Z-ADD0         ZDATE   60
3816 C                     MOVEL'       ' ZADATE  7
3817 C**
3818 C**   CALCULATION TO DEFINE INPUT DAY NUMBER.
3819 C                     Z-ADDZDAYNO    ZDAYNO  50
3820 C**
3821 C**   DETERMINE YEAR NUMBER.
3822 C**
3823 C**   ADJUST DAY NUMBER IN CASE LAST DAY OF YEAR.
3824 C           ZDAYNO    SUB  1         ZDAYN1  50   99
3825 C   99                GOTO ZDEND2
3826 C**
3827 C**   CALCULATE NUMBER OF 4 YEAR SPANS SINCE 31/12/1971.
3828 C           ZDAYN1    DIV  1461      ZLYR    20
3829 C                     MVR            ZDAYN1           SAVE REMAINING
3830 C**                                                   DAYS
3831 C**   CALCULATE NUMBER OF REMAINING YEARS.
3832 C                     Z-ADD1         ZWRK2   20
3833 C           ZDTAG1    TAG                             ** ZDTAG1 TAG *
3834 C           ZDAYN1    COMP ZYDY,ZWRK2             90
3835 C  N90      ZWRK2     ADD  1         ZWRK2
3836 C  N90                GOTO ZDTAG1
3837 C           ZWRK2     SUB  1         ZWRK2          91LEAP YR, 91 ON
3838 C**
3839 C**   DECREMENT DAY NO. BY DAYS IN REMAINING YEARS.
3840 C  N91      ZDAYN1    SUB  ZYDY,ZWRK2ZDAYN1
3841 C**
3842 C**   CALCULATE ACTUAL YEAR NUMBER.
3843 C           ZLYR      MULT 4         ZWRK3   30
3844 C           ZWRK3     ADD  72        ZWRK3            BASE IS 1972
3845 C                     Z-ADDZWRK3     ZYEAR   20
3846 C           ZYEAR     ADD  ZWRK2     ZYEAR            YEAR
3847 C**
3848 C**   DETERMINE MONTH NUMBER.
3849 C**
3850 C**   ADJUST DAY NO. IN CASE LAST DAY OF LEAP YEAR FEBRUARY.
3851 C                     SETOF                     9293
3852 C   91      ZDAYN1    COMP 59                     9293
3853 C   91N92   ZDAYN1    SUB  1         ZDAYN1
3854 C**
3855 C**   CALCULATE MONTH NUMBER.
3856 C                     Z-ADD2         ZWRK2
3857 C           ZDTAG2    TAG                             ** ZDTAG2 TAG *
3858 C           ZDAYN1    COMP ZMDY,ZWRK2             94
3859 C  N94      ZWRK2     ADD  1         ZWRK2
3860 C  N94                GOTO ZDTAG2
3861 C           ZWRK2     SUB  1         ZWRK2
3862 C**
3863 C                     Z-ADDZWRK2     ZMTH    20       MONTH
3864 C**
3865 C**   DETERMINE DAY OF MONTH.
3866 C**
3867 C**   ADD BACK LAST DAY OF YEAR ADJUSTMENT.
3868 C           ZDAYN1    ADD  1         ZDAYN1
3869 C**
3870 C**   CALCULATE DAY OF MONTH.
3871 C           ZDAYN1    SUB  ZMDY,ZWRK2ZDAY    20       DAY
3872 C**
3873 C**   ADD BACK LEAP YEAR 29TH FEBUARY ADJUSTMENT, IF REQUIRED.
3874 C   93      ZDAY      ADD  1         ZDAY
3875 C**
3876 C**   FORMAT DATE, DDMMYY OR MMDDYY.
3877 C  N98                MOVELZDAY      ZWRK4   40
3878 C   98                MOVE ZDAY      ZWRK4
3879 C  N98                MOVE ZMTH      ZWRK4
3880 C   98                MOVELZMTH      ZWRK4
3881 C                     MOVELZWRK4     ZDATE
3882 C                     MOVE ZYEAR     ZDATE
3883 C**
3884 C**   FORMAT ALPHA DATE, DDMMMYY.
3885 C           ZDAY      COMP 10                     95
3886 C                     MOVELZDAY      ZWRK5   5
3887 C   95                MOVEL' '       ZWRK5
3888 C                     MOVE ZMNM,ZMTH ZWRK5
3889 C                     MOVELZWRK5     ZADATE
3890 C                     MOVE ZYEAR     ZADATE
3891 C**
3892 C           ZDEND2    ENDSR                           * ZDEND2 ENDSR*
3893 C********************************************************************
     C/EJECT
     C********************************************************************
     C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
     C*   IND '99' IS SET BY AN OVERFLOW ERROR
     C*
     C           GLZADD    BEGSR                           *** GLZADD ****
     C*
     C                     Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT
     C   91                GOTO ZZAEND                     AMT = 0.BYPASS
     C*
     C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
     C                     Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
     C                     MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD
     C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
     C*
     C                     EXSR GLZSUM
     C           ZZAEND    ENDSR                           ** ZZAEND TAG *
     C*
     C********************************************************************
     C/EJECT
     C********************************************************************
     C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
     C*                        GLZADD, GLZSUB, GLZCMP.
     C*          PARAMETERS PASSED -
     C*                     I/P ZZAMTI ZZAMTD
     C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
     C*
     C           GLZSUM    BEGSR                           *** GLZSUM ****
     C*
     C                     Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
     C                     Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
     C                     SETOF                     919293
     C                     SETOF                     949599
     C*
     C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
     C           ZZAMTI    COMP 0                      9293
     C   93      ZZAMTD    COMP 0                      9293
     C   93                GOTO ZZSEND                     ZERO BYPASS
     C*
     C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
     C           ZZTOTI    COMP 0                      9193
     C   93      ZZTOTD    COMP 0                      9193
     C*
     C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
     C   93                Z-ADDZZAMTI    ZZTOTI
     C   93                Z-ADDZZAMTD    ZZTOTD
     C   93                GOTO ZZSEND                     ZERO BYPASS
     C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
     C   91N92
     CORN91 92             GOTO ZZOFPS
     C*
     C           ZZAMTD    ADD  ZZTOTD    ZZWK2   40
     C           ZZWK2     COMP 999                  93    '93' = CARRY
     C  N93      ZZWK2     COMP -999                   93    INTO INTEGER.
     C*
     C   93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
     C      93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
     C   93      ZZTOTI    ADD  ZZWK3     ZZWK3
     C  N93      ZZTOTI    ADD  ZZAMTI    ZZWK3
     C*
     C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
     C  N92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
     C   92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
     C  N99                Z-ADDZZWK2     ZZTOTD
     C  N99                Z-ADDZZWK3     ZZTOTI
     C*
     C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
     C   99                Z-ADD0         ZZAMT  153
     C                     GOTO ZZSEND
     C*
     C* THE 'SIGNS' ARE DIFFERENT
     C           ZZOFPS    TAG                             ** ZZOFPS TAG**
     C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
     C*
     C   92                Z-SUBZZAMTI    ZZAMTI 150
     C   92                Z-SUBZZAMTD    ZZAMTD  30
     C*
     C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
     C*
     C   91                Z-SUBZZTOTI    ZZTOTI
     C   91                Z-SUBZZTOTD    ZZTOTD
     C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
     C*
     C           ZZTOTI    COMP ZZAMTI               93  95
     C   95      ZZTOTD    COMP ZZAMTD               93  95
     C*
     C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
     C   95                Z-ADD0         ZZTOTI
     C   95                Z-ADD0         ZZTOTD
     C   95                GOTO ZZSEND
     C*
     C* IF ZZTOT GT. ZZAMT.
     C   93      ZZAMTD    COMP ZZTOTD               94
     C   93 94   ZZTOTI    SUB  1         ZZTOTI
     C   93 94   ZZTOTD    ADD  1000      ZZWK2
     C   93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
     C   93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
     C   93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
     C*
     C*
     C* IF ZZAMT GT. ZZTOT.
     C  N93      ZZTOTD    COMP ZZAMTD               94
     C  N93 94   ZZAMTI    SUB  1         ZZWK3  150
     C  N93 94   ZZAMTD    ADD  1000      ZZWK2
     C  N93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
     C  N93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
     C  N93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
     C  N93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
     C*
     C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
     C                     SETOF                     94
     C   93 91
     CORN93 92             SETON                     94
     C   94                Z-SUBZZTOTI    ZZTOTI
     C   94                Z-SUBZZTOTD    ZZTOTD
     C**
     C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
     C   92                Z-SUBZZAMTI    ZZAMTI
     C   92                Z-SUBZZAMTD    ZZAMTD
     C           ZZSEND    TAG                             ** ZZSEND TAG *
     C**
     C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
     C                     SETOF                     96
     C           ZZTOTD    COMP 0                        91
     C   91      ZZTOTI    COMP 0                      96
     C   96                MOVE '.000-'   ZZNEGD  5
     C                     ENDSR                             ** ENDSR **
     C********************************************************************
     C/COPY WNCPYSRC,FT0060C055
      *                                                               *   CFT003
     C           SRBAUT    BEGSR                                          CFT003
      *                                                                   CFT003
      * Check if installed                                                CFT003
      *                                                                   CFT003
     C           CFT003    IFEQ *BLANKS                                   CFT003
     C                     CALL 'AOSARDR0'                                CFT003
     C                     PARM *BLANKS   @RTCD   7                       CFT003
     C                     PARM '*VERIFY' @OPTN   7                       CFT003
     C                     PARM 'CFT003'  @SARD   6                       CFT003
     C           SCSARD    PARM SCSARD    DSFDY                           CFT003
      *                                                                   CFT003
      * If found set flag                                                 CFT003
      *                                                                   CFT003
     C           @RTCD     IFEQ *BLANKS                                   CFT003
     C                     MOVEL'CFT003'  CFT003  6                       CFT003
     C                     ELSE                                           CFT003
     C                     MOVEL'*NRF  '  CFT003  6                       CFT003
     C**********           GOTO EXBAUT                                    CFT003             BUG3727
     C                     ENDIF                                          CFT003
      *                                                                   CFT003
     C                     ENDIF                                          CFT003
      **                                                                                      CSC022
      ** Initialize CSC022 and Skip Commit/Rollback flags                                     CSC022
      **                                                                                      CSC022
     C                     MOVE 'N'       CSC022  1                                           CSC022
     C                     MOVE 'N'       WCRSKP  1                                           CSC022
      **                                                                                      CSC022
      ** Access SAR details file to determine if CSC022 switchable feature                    CSC022
      ** is switched on                                                                       CSC022
      **                                                                                      CSC022
     C                     CALL 'AOSARDR0'                                                    CSC022
     C                     PARM *BLANKS   @RTCD                                               CSC022
     C                     PARM '*VERIFY '@OPTN                                               CSC022
     C                     PARM 'CSC022'  @SARD                                               CSC022
     C           SCSARD    PARM SCSARD    DSFDY                                               CSC022
      **                                                                                      CSC022
     C           @RTCD     IFEQ *BLANKS                                                       CSC022
     C                     MOVE 'Y'       CSC022                                              CSC022
      **                                                                                      CSC022
      ** Get Jobs currently running i batch mode using SCCMRJOB dataarea                      CSC022
      **                                                                                      CSC022
     C           *NAMVAR   DEFN SCCMTJOB  SCCMT                                               CSC022
     C                     IN   SCCMT                                                         CSC022
      **                                                                                      CSC022
     C           WCMTNO    IFGT 0                                                             CSC022
      ** Move committed jobs to arrary for checking                                           CSC022
     C                     MOVEAWCJOBS    WCMT                                                CSC022
      ** Verify if job running exists in array                                                CSC022
     C********** WID       LOKUPWCMT                     50                            CSC022 251933
     C********** *IN50     IFEQ *ON                                                    CSC022 251933
     C           WID       LOKUPWCMT                     62                                   251933
     C           *IN62     IFEQ *ON                                                           251933
     C                     MOVE 'Y'       WCRSKP                                              CSC022
     C                     ENDIF                                                              CSC022
     C                     ENDIF                                                              CSC022
      **                                                                                      CSC022
     C                     ELSE                                                               CSC022
      ** Execute *PSSR if CSC022 is not found or Database error                               CSC022
     C           @RTCD     IFNE '*NRF'                                                        CSC022
     C                     MOVEL'CSC022'  W0KEY                                               CSC022
     C                     MOVEL'SCSARDPD'W0FILE                                              CSC022
     C                     Z-ADD013       W0ERNB                                              CSC022
     C                     EXSR SRERR                                                         CSC022
     C                     ENDIF                                                              CSC022
      **                                                                                      CSC022
     C                     ENDIF                                                              CSC022
      **                                                                                      CSC022
      ** If CFT003 is switched off then goto end of subroutine.                              BUG3727
     C           CFT003    IFEQ '*NRF  '                                                     BUG3727
     C                     GOTO EXBAUT                                                       BUG3727
     C                     ENDIF                                                             BUG3727
     C/COPY WNCPYSRC,FT0060C066
      *                                                                   CFT003
      * Set up Account depending on transaction being verified            CFT003
      *                                                                   CFT003
     C                     MOVEL*BLANKS   @ACNT                           CFT003
     C                     MOVEL*BLANKS   @BRCA                           CFT003
      *                                                                   CFT003
     C           *IN60     IFEQ *ON                                       CFT003
      *                                                                   CFT003
      * Outgoing Payments                                                 CFT003
      *                                                                   CFT003
     C***********ORCT      IFNE 'C'                                 CFT003166281
     C***********ORCT      ANDNE'A'                                 CFT003166281
     C***********          MOVELORC1      @ACNT     P               CFT003166281
     C***********          ELSE                                     CFT003166281
     C*********************SELEC                                          CFT003
     C***********ORBT      WHNE *BLANKS                                   CFT003
     C********** ORBK      IFNE *ZEROS                                                 166281 CSD027
     C           ORBK      IFNE *BLANKS                                                       CSD027
     C**********           MOVELORBK      ##012A 12 P                                  CFT003 CGL029
     C                     MOVELORBK      ##012A 18 P                                         CGL029
     C                     SELEC                                          CFT003
     C           ORBT      WHEQ 'N'                                       CFT003
     C           2         SUBST##012A:1  @ACNT     P                     CFT003
     C           ORBT      WHEQ 'R'                                       CFT003
     C           10        SUBST##012A:1  @ACNT     P                     CFT003
     C                     OTHER                                          CFT003
     C                     MOVELORBK      @ACNT                           CFT003
     C*                                                                   CFT003
     C** Multi branching                                                  CFT003
     C*****      *IN50     IFEQ '1'                                CFT003 245478
     C           BGMBIN    IFEQ 'Y'                                       245478
     C                     MOVELORBB      @BRCA                           CFT003
     C                     ELSE                                           CFT003
     C** Simple branching                                                 CFT003
     C                     MOVELBJSBRC    @BRCA                           CFT003
     C                     END                                            CFT003
     C                     ENDSL                                          CFT003
     C*********************MOVELORBB      @BRCA                     CFT003CFT003
     C*********************OTHER                                          CFT003
     C*********************MOVELORC1      @ACNT                           CFT003
     C***********3         SUBSTORC1:13   @BRCA                           CFT003
     C*********************ENDSL                                          CFT003
     C                     ELSE                                           166281
     C           ORCT      IFNE 'C'                                       166281
     C           ORCT      ANDNE'A'                                       166281
     C                     MOVELORC1      @ACNT     P                     166281
      **********                                                                  BUG15042 BUG15042A
     C********** ORCT      IFEQ 'I'                                               BUG15042 BUG15042A
     C**********           MOVELORC1      W#SLSH  1                               BUG15042 BUG15042A
      **********                                                                  BUG15042 BUG15042A
     C********** W#SLSH    IFEQ '/'                                               BUG15042 BUG15042A
     C**********           SUBSTORC1:2    PIBAN                                   BUG15042 BUG15042A
     C**********           ELSE                                                   BUG15042 BUG15042A
     C**********           MOVELORC1      PIBAN                                   BUG15042 BUG15042A
     C**********           ENDIF                                                  BUG15042 BUG15042A
      **********                                                                  BUG15042 BUG15042A
      ***Call*AOIBANR4*using*PIBAN*and*store*retrieved*account*details*           BUG15042 BUG15042A
      ***in*DS/WACCN.**************************************************           BUG15042 BUG15042A
      **********                                                                  BUG15042 BUG15042A
     C**********           MOVE *BLANKS   DSSDY                                   BUG15042 BUG15042A
     C**********           CALL 'AOIBANR4'                                        BUG15042 BUG15042A
     C**********           PARM           PRTCD   7                               BUG15042 BUG15042A
     C**********           PARM '*KEY   ' POPTN   7                               BUG15042 BUG15042A
     C**********           PARM           PIBAN  34                               BUG15042 BUG15042A
     C********** WACCN     PARM           DSSDY                                   BUG15042 BUG15042A
      **********                                                                  BUG15042 BUG15042A
     C********** PRTCD     IFNE *BLANKS                                           BUG15042 BUG15042A
     C**********           Z-ADD084       W0ERNB                                  BUG15042 BUG15042A
     C**********           MOVELPIBAN     W0KEY                                   BUG15042 BUG15042A
     C**********           MOVEL'ACCNTL6 'W0FILE                                  BUG15042
     C**********           EXSR SRERR                                             BUG15042
      **********                                                                  BUG15042
     C**********           ELSE                                                   BUG15042
     C**********           MOVE WCNUM     FCNUM                                   BUG15042 BUG15042A
     C**********           MOVE WCCY      FCCY                                    BUG15042 BUG15042A
     C**********           MOVE WACOD     FACOD                                   BUG15042 BUG15042A
     C**********           MOVE WACSQ     FACSQ                                   BUG15042 BUG15042A
     C**********           MOVELWACNT     @ACNT                                   BUG15042 BUG15042A
     C**********           MOVELWBRCA     @BRCA                                   BUG15042 BUG15042A
     C**********           ENDIF                                                  BUG15042 BUG15042A
      **********                                                                  BUG15042 BUG15042A
     C**********           ELSE                                                   BUG15042 BUG15042A
     C**********           MOVELORC1      @ACNT     P                                166281 BUG15225
     C**********           ENDIF                                                  BUG15042 BUG15042A
      *                                                                                       CFT032
     C**********           MOVELORC1      PIBAN                                      CFT032 BUG15225
     C********** 1         SUBSTORC1:1    SLSH    1                                  CFT032 BUG15225
      *                                                                                       CFT032
     C********** SLSH      IFEQ '/'                                                  CFT032 BUG15225
     C**********           MOVEL*BLANKS   PIBAN                                      CFT032 BUG15225
     C********** 34        SUBSTORC1:2    PIBAN                                      CFT032 BUG15225
     C**********           ENDIF                                                     CFT032 BUG15225
      *                                                                                       CFT032
     C********** ORCT      IFEQ 'I'                                                  CFT032 BUG15225
     C                     MOVELORC1      W#SLSH  1                                        BUG15042A
     C                     SELEC                                                            BUG15225
      *                                                                                     BUG15225
      ** Ordering customer is an IBAN                                                       BUG15225
      *                                                                                     BUG15225
     C           ORCT      WHEQ 'I'                                                         BUG15225
      *                                                                                    BUG15042A
     C           W#SLSH    IFEQ '/'                                                        BUG15042A
     C                     SUBSTORC1:2    PIBAN                                            BUG15042A
     C                     ELSE                                                            BUG15042A
     C                     MOVELORC1      PIBAN                                            BUG15042A
     C                     ENDIF                                                           BUG15042A
      *                                                                                    BUG15042A
     C                     MOVE *BLANKS   DSSDY                                               CFT032
     C                     CALL 'AOIBANR4'                                                    CFT032
     C                     PARM           PRTCD                                               CFT032
     C                     PARM '*KEY   ' POPTN                                               CFT032
     C                     PARM           PIBAN                                               CFT032
     C           WACCN     PARM           DSSDY                                               CFT032
      *                                                                                       CFT032
     C           PRTCD     IFNE *BLANKS                                                       CFT032
     C                     Z-ADD082       W0ERNB                                              CFT032
     C                     MOVELPIBAN     W0KEY                                               CFT032
     C                     MOVEL'ACCNTL6 'W0FILE                                              CFT032
     C                     EXSR SRERR                                                         CFT032
     C                     ELSE                                                               CFT032
     C                     MOVE WCNUM     FCNUM                                            BUG15042A
     C                     MOVE WCCY      FCCY                                             BUG15042A
     C                     MOVE WACOD     FACOD                                            BUG15042A
     C                     MOVE WACSQ     FACSQ                                            BUG15042A
     C                     MOVELWACNT     @ACNT     P                                         CFT032
     C                     MOVELWBRCA     @BRCA                                            BUG15042A
     C                     ENDIF                                                              CFT032
      *                                                                                     BUG15225
      ** Partial account with '/' prefix                                                    BUG15225
      *                                                                                     BUG15225
     C           ORCT      WHEQ 'P'                                                         BUG15225
     C           W#SLSH    ANDEQ'/'                                                         BUG15225
     C                     SUBSTORC1:2    @ACNT     P                                       BUG15225
      *                                                                                     BUG15225
     C                     OTHER                                                            BUG15225
     C                     MOVELORC1      @ACNT     P                                       BUG15225
     C                     ENDSL                                                            BUG15225
     C**********           ENDIF                                                     CFT032 BUG15225
      *                                                                                       CFT032
     C                     ENDIF                                          166281
     C                     END                                            CFT003
     C                     ELSE                                           CFT003
      *                                                                   CFT003
      * Incoming Payments                                                 CFT003
      *                                                                   CFT003
     C*********************SELEC                                    CFT003CFT003
     C***********SNTP      IFNE 'C'                                 CFT003166281
     C***********SNTP      ANDNE'A'                                 CFT003166281
     C***********          MOVELSND1      @ACNT     P               CFT003166281
     C***********                                                   CFT003166281
     C***If*account*type*is*'G',*where*the*entry*is*18*long*account*CFT003166281
     C***of*which*the*last*3*characters*is*the*branch,extract*it*forCFT003166281
     C***insufficient*fund*checking.********************************CFT003166281
     C***********                                                   CFT003166281
     C***********SNTP      IFEQ 'G'                                 CFT003166281
     C***********3         SUBSTSND1:16   @BRCA     P               CFT003166281
     C***********          ENDIF                                    CFT003166281
     C***********          ELSE                                     CFT003166281
     C***********RCRT      WHNE *BLANKS                             CFT003CFT003
     C***********RCCO      IFNE *ZEROS                             166281 CFT014
     C***********          MOVELRCCO      ##012A 12 P              CFT003 CFT014
     C***********          SELEC                                   CFT003 CFT014
     C***********ORBT      WHEQ 'N'                                 CFT003CFT003
     C***********RCRT      WHEQ 'N'                                CFT003 CFT014
     C***********2         SUBST##012A:1  @ACNT     P              CFT003 CFT014
     C***********ORBT      WHEQ 'R'                                 CFT003CFT003
     C***********RCRT      WHEQ 'R'                                CFT003 CFT014
     C***********10        SUBST##012A:1  @ACNT     P              CFT003 CFT014
     C***********          OTHER                                   CFT003 CFT014
     C***********          MOVELRCCO      @ACNT                    CFT003 CFT014
     C***********          ENDSL                                   CFT003 CFT014
     C*********************OTHER                                    CFT003CFT003
     C*********************MOVELSND1      @ACNT                     CFT003CFT003
     C***********3         SUBSTSND1:16   @BRCA                     CFT003CFT003
     C*********************ENDSL                                    CFT003CFT003
      *                                                                   CFT014
      ** CFT014 is on and 3rd Reimbursement Institution is present.       CFT014
      *                                                                   CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
     C           INTRIT    ANDNE*BLANKS                                   CFT014
      *                                                                   CFT014
     C                     SELEC                                          CFT014
      *                                                                   CFT014
      ** 3rd Reimbursement Institution is IBAN.                           CFT014
      *                                                                   CFT014
     C           INTRIT    WHEQ 'I'                                       CFT014
     C           CFT004    ANDEQ'Y'                                       CFT014
     C                     MOVE INTRIB    PIBAN                           CFT014
      *                                                                   CFT014
      ** Call AOIBANR4 using PIBAN and store retrieved account details    CFT014
      ** in DS/WACCN.                                                     CFT014
      *                                                                   CFT014
     C                     MOVE *BLANKS   DSSDY                           CFT014
     C                     CALL 'AOIBANR4'                                CFT014
     C                     PARM           PRTCD   7                       CFT014
     C                     PARM '*KEY   ' POPTN   7                       CFT014
     C                     PARM           PIBAN  34                       CFT014
     C           WACCN     PARM           DSSDY                           CFT014
      *                                                                   CFT014
     C           PRTCD     IFNE *BLANKS                                   CFT014
     C                     Z-ADD082       W0ERNB                          CFT014
     C                     MOVELPIBAN     W0KEY                           CFT014
     C                     MOVEL'ACCNTL6 'W0FILE                          CFT014
     C                     EXSR SRERR                                     CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
     C                     MOVE WCNUM     FCNUM                           CFT014
     C                     MOVE WCCY      FCCY                            CFT014
     C                     MOVE WACOD     FACOD                           CFT014
     C                     MOVE WACSQ     FACSQ                           CFT014
     C                     MOVELWACNT     @ACNT                           CFT014
     C                     MOVELWBRCA     @BRCA                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** 3rd Reimbursement Institution is a GL account.                   CFT014
      *                                                                   CFT014
     C           INTRIT    WHEQ 'G'                                       CFT014
      *                                                                   CFT014
      ** Move pos. 1-15 of INTRIB to @ACNT.                               CFT014
      *                                                                   CFT014
     C                     MOVE INTRIB    WINTRB                          CFT014
     C                     MOVELTPACNT    @ACNT                           CFT014
      *                                                                   CFT014
      ** Move pos. 16-18 of INTRIB to @BRCA.                              CFT014
      *                                                                   CFT014
     C                     MOVELTPBRCA    @BRCA                           CFT014
      *                                                                   CFT014
     C                     OTHER                                          CFT014
      *                                                                   CFT014
      ** 3rd Reimbursement Institution is a Nostro or                     CFT014
      ** a Retail account.                                                CFT014
      *                                                                   CFT014
     C                     MOVELINTRIB    @ACNT                           CFT014
      *                                                                   CFT014
     C                     ENDSL                                          CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
      ** Receiver's Correspondent is present.                             CFT014
      *                                                                   CFT014
     C           INRCRT    IFNE *BLANKS                                   CFT014
      *                                                                   CFT014
     C                     SELEC                                          CFT014
      *                                                                   CFT014
      ** Receiver's Correspondent is IBAN.                                CFT014
      *                                                                   CFT014
     C           INRCRT    WHEQ 'I'                                       CFT014
     C           CFT004    ANDEQ'Y'                                       CFT014
     C                     MOVE INRCO1    PIBAN                           CFT014
      *                                                                   CFT014
      ** Call AOIBANR4 using PIBAN and store retrieved account details    CFT014
      ** in DS/WACCN.                                                     CFT014
      *                                                                   CFT014
     C                     MOVE *BLANKS   DSSDY                           CFT014
     C                     CALL 'AOIBANR4'                                CFT014
     C                     PARM           PRTCD                           CFT014
     C                     PARM '*KEY   ' POPTN                           CFT014
     C                     PARM           PIBAN                           CFT014
     C           WACCN     PARM           DSSDY                           CFT014
      *                                                                   CFT014
     C           PRTCD     IFNE *BLANKS                                   CFT014
     C                     Z-ADD083       W0ERNB                          CFT014
     C                     MOVELPIBAN     W0KEY                           CFT014
     C                     MOVEL'ACCNTL6 'W0FILE                          CFT014
     C                     EXSR SRERR                                     CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
     C                     MOVE WCNUM     FCNUM                           CFT014
     C                     MOVE WCCY      FCCY                            CFT014
     C                     MOVE WACOD     FACOD                           CFT014
     C                     MOVE WACSQ     FACSQ                           CFT014
     C                     MOVELWACNT     @ACNT                           CFT014
     C                     MOVELWBRCA     @BRCA                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Receiver's Correspondent is a GL account.                        CFT014
      *                                                                   CFT014
     C           INRCRT    WHEQ 'G'                                       CFT014
      *                                                                   CFT014
      ** Move pos. 1-15 of INRCO1 to @ACNT.                               CFT014
      *                                                                   CFT014
     C                     MOVELINRCO1    WINTRB                          CFT014
     C                     MOVELTPACNT    @ACNT                           CFT014
      *                                                                   CFT014
      ** Move pos. 16-18 of INRCO1 to @BRCA.                              CFT014
      *                                                                   CFT014
     C                     MOVELTPBRCA    @BRCA                           CFT014
      *                                                                   CFT014
     C                     OTHER                                          CFT014
      *                                                                   CFT014
      ** Receiver's Correspondent is a Nostro or a Retail account.        CFT014
      *                                                                   CFT014
     C                     MOVELINRCO1    @ACNT                           CFT014
      *                                                                   CFT014
     C                     ENDSL                                          CFT014
      *                                                                   CFT014
     C                     ELSE                                           166281
      *                                                                   CFT014
     C           SNTP      IFNE 'C'                                       166281
     C           SNTP      ANDNE'A'                                       166281
     C                     MOVELSND1      @ACNT     P                     166281
     C*                                                                   166281
     C** If account type is 'G', where the entry is 18 long account       166281
     C** of which the last 3 characters is the branch, extract it for     166281
     C** insufficient fund checking.                                      166281
     C*                                                                   166281
     C           SNTP      IFEQ 'G'                                       166281
     C********** 3         SUBSTSND1:16   @BRCA     P                                166281 BUG25971
     C           3         SUBSTSND1:22   @BRCA     P                                       BUG25971
     C                     ENDIF                                          166281
     C                     ENDIF                                          166281
     C                     ENDIF                                          CFT003
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT003
      *                                                                   CFT003
      * Call validation object                                            CFT003
      *                                                                   CFT003
     C/COPY WNCPYSRC,FT0060C067
     C                     CALL 'FT0805'                                  CFT003
     C**********           PARM           @ACNT  15                                    CFT003 CGL029
     C                     PARM           @ACNT  21                                           CGL029
     C                     PARM SMCY      @CCY    3                       CFT003
     C                     PARM           @BRCA   3                       CFT003
     C                     PARM SMAM      @SMAM  130                      CFT003
     C                     PARM SLDT      @SLDT   50                      CFT003
     C                     PARM *BLANKS   @RCD    1                       CFT003
     C                     PARM *BLANKS   @ORETB  5                                           216511
      *                                                                   CFT003
      * Check results and send messages                                   CFT003
      *                                                                   CFT003
     C/COPY WNCPYSRC,FT0060C051
     C           @RCD      IFEQ 'E'                                                         BUG15042
     C                     MOVEL'FT0805'  W0FILE           ************                     BUG15042
     C                     MOVEL'*CALL'   W0KEY            * DBERR 90 *                     BUG15042
     C                     Z-ADD90        W0ERNB           ************                     BUG15042
     C                     EXSR SRERR                                                       BUG15042
     C                     ENDIF                                                            BUG15042
      *                                                                                     BUG15042
     C********** @RCD      IFNE 'N'                                                    CFT003 205523
     C           @RCD      IFEQ 'Y'                                                           205523
     C/COPY WNCPYSRC,FT0060C052
     C                     MOVEL'BAW0001' FTMSID                          CFT003
     C                     MOVEL'FTUSRMSG'FTMSGF                          CFT003
     C                     EXSR FTSNMS                                    CFT003
     C                     ENDIF                                          CFT003
      *                                                                                       207477
      ** If error in FT0805, terminate program instead of ignoring it.                        207477
      *                                                                                       207477
     C           @RCD      IFEQ 'E'                                                           207477
     C           *LOCK     IN   DLDA                                                          207477
     C                     MOVEL'FT0060'  DBPGM                                               207477
     C                     MOVEL'FT0805'  DBFILE           ***************                    207477
     C                     Z-ADD45        DBASE            * DB ERROR 45 *                    207477
     C                     MOVEL'*CALL'   DBKEY            ***************                    207477
     C                     MOVE '*'       @RETC                                               207477
     C                     OUT  DLDA                                                          207477
     C                     SETON                     U7U8LR                                   207477
     C                     DUMP                                                               207477
     C                     RETRN                                                              207477
     C                     ENDIF                                                              207477
      *                                                                                       207477
     C/COPY WNCPYSRC,FT0060C053
      *                                                                                       216511
      ** Validate Block Debit/Credit Indicator of Destination                                 216511
      ** or Sender's Correspondent.                                                           216511
      *                                                                                       216511
     C                     MOVEL*BLANKS   OERROR  1                                           216511
     C           *IN60     IFEQ '1'                                                           216511
     C                     MOVEL'THREE'   OTHREE  5                                           216511
     C                     MOVEL'TWO  '   OTWO    5                                           216511
     C                     MOVEL*BLANKS   @ACNT                                               216511
      *                                                                                       216511
      *                                                                                       216511
     C                     SELEC                                                              216511
     C           SNCT      WHEQ 'N'                                                           216511
     C                     MOVELSNCO      OMTWO   2                                           216511
     C                     MOVELOMTWO     @ACNT                                               216511
     C           SNCT      WHEQ 'R'                                                           216511
     C                     MOVELSNCO      @ACNT                                               216511
     C           DSTT      WHEQ 'F'                                                           216511
     C           DSTT      OREQ 'R'                                                           216511
     C                     MOVELDST1      @ACNT                                               216511
     C           DSTT      WHEQ 'G'                                                           216511
     C                     MOVELDST1      @ACNT                                               216511
     C********** 3         SUBSTDST1:16   @BRCA                                      216511 BUG25971
     C           3         SUBSTDST1:22   @BRCA                                             BUG25971
     C                     OTHER                                                              216511
     C                     GOTO ENDDES                                                        216511
     C                     ENDSL                                                              216511
      *                                                                                       216511
     C                     CALL 'FT0805'                                                      216511
     C                     PARM           @ACNT                                               216511
     C                     PARM PCCY      @CCY                                                216511
     C                     PARM           @BRCA                                               216511
     C                     PARM *ZERO     @SMAM                                               216511
     C                     PARM *ZERO     @SLDT                                               216511
     C                     PARM *BLANKS   @RCD                                                216511
     C                     PARM OTHREE    @ORETB                                              216511
      *                                                                                       216511
      * Check results and send messages                                                       216511
      *                                                                                       216511
     C           @ORETB    IFNE *BLANKS                                                       216511
     C                     MOVEL'FTM0019' FTMSID                                              216511
     C                     MOVEL'FTUSRMSG'FTMSGF                                              216511
     C                     MOVEL'Y'       OERROR                                              216511
     C                     EXSR FTSNMS                                                        216511
     C                     ENDIF                                                              216511
     C           ENDDES    TAG                                                                216511
      *                                                                                       216511
      ** Validate Block Debit/Credit Indicator of Ordering Customer                           216511
      ** or Ordering Bank.                                                                    216511
      ** or Ordering Bank.                                                                    216511
      *                                                                                       216511
     C                     MOVEL*BLANKS   @ACNT                                               216511
     C                     SELEC                                                              216511
     C           ORBT      WHEQ 'N'                                                           216511
     C                     MOVELORBK      OMTWO                                               216511
     C                     MOVELOMTWO     @ACNT                                               216511
     C           ORBT      WHEQ 'R'                                                           216511
     C                     MOVELORBK      WORBK  10                                           216511
     C                     MOVELWORBK     @ACNT                                               216511
     C           ORBT      WHEQ 'P'                                                           216511
     C                     MOVELORBK      @ACNT                                               216511
     C           ORBB      IFNE *BLANKS                                                       216511
     C                     MOVELORBB      @BRCA                                               216511
     C                     ENDIF                                                              216511
     C           ORCT      WHEQ 'P'                                                           216511
     C           ORCT      OREQ 'R'                                                           216511
     C                     MOVELORC1      @ACNT                                               216511
      *                                                                                     BUG21206
      ** Don't include the slash in Account validation                                      BUG21206
     C           W#SLSH    IFEQ '/'                                                         BUG21206
     C**********           MOVE ORC1      @ACNT                                    BUG21206 BUG21265
     C                     SUBSTORC1:2    @ACNT                                             BUG21265
     C                     ENDIF                                                            BUG21206
      *                                                                                     BUG21206
     C                     OTHER                                                              216511
     C                     GOTO ENDORD                                                        216511
     C                     ENDSL                                                              216511
      *                                                                                       216511
     C                     CALL 'FT0805'                                                      216511
     C                     PARM           @ACNT                                               216511
     C                     PARM SMCY      @CCY                                                216511
     C                     PARM           @BRCA                                               216511
     C                     PARM *ZERO     @SMAM                                               216511
     C                     PARM *ZERO     @SLDT                                               216511
     C                     PARM *BLANKS   @RCD                                                216511
     C                     PARM OTWO      @ORETB                                              216511
      *                                                                                       216511
      * Check results and send messages                                                       216511
      *                                                                                       216511
     C           @ORETB    IFNE *BLANKS                                                       216511
     C                     MOVEL'FTM0014' FTMSID                                              216511
     C                     MOVEL'FTUSRMSG'FTMSGF                                              216511
     C                     MOVEL'Y'       OERROR                                              216511
     C                     EXSR FTSNMS                                                        216511
     C                     ENDIF                                                              216511
     C           ENDORD    TAG                                                                216511
      *                                                                                       216511
     C                     ENDIF                                                              216511
     C           *IN60     IFEQ '0'                                                          247142A
     C                     MOVEL'THREE'   OTHREE                                             247142A
     C                     MOVEL*BLANKS   @ACNT                                              247142A
     C                     SELEC                                                             247142A
     C           BNCT      WHEQ 'N'                                                          247142A
     C                     MOVELBNC1      OMTWO                                              247142A
     C                     MOVELOMTWO     @ACNT                                              247142A
     C           BNCT      WHEQ 'R'                                                          247142A
     C           BNCT      OREQ 'F'                                                          247142A
     C                     MOVELBNC1      @ACNT                                              247142A
     C           BNCT      WHEQ 'G'                                                          247142A
     C                     MOVELBNC1      @ACNT                                              247142A
     C********** 3         SUBSTBNC1:16   @BRCA                                     247142A BUG25971
     C           3         SUBSTBNC1:22   @BRCA                                             BUG25971
     C                     OTHER                                                             247142A
     C                     GOTO ENDBEN                                                       247142A
     C                     ENDSL                                                             247142A
      *                                                                                      247142A
     C                     CALL 'FT0805'                                                     247142A
     C                     PARM           @ACNT                                              247142A
     C                     PARM PCCY      @CCY                                               247142A
     C                     PARM           @BRCA                                              247142A
     C                     PARM *ZERO     @SMAM                                              247142A
     C                     PARM *ZERO     @SLDT                                              247142A
     C                     PARM *BLANKS   @RCD                                               247142A
     C                     PARM OTHREE    @ORETB                                             247142A
      *                                                                                      247142A
      * Check results and send messages                                                      247142A
      *                                                                                      247142A
     C           @ORETB    IFNE *BLANKS                                                      247142A
     C                     MOVEL'FTM0019' FTMSID                                             247142A
     C                     MOVEL'FTUSRMSG'FTMSGF                                             247142A
     C                     MOVEL'Y'       OERROR                                             247142A
     C                     EXSR FTSNMS                                                       247142A
     C                     ENDIF                                                             247142A
     C                     ENDIF                                                             247142A
     C           ENDBEN    TAG                                                               247142A
      *                                                                   CFT003
      * Payment back-valued                                               CFT003
      *                                                                   CFT003
     C           PVDT      IFLT BJRDNB                                    CFT003
     C                     MOVEL'BAW0002' FTMSID                          CFT003
     C                     MOVEL'FTUSRMSG'FTMSGF                          CFT003
     C                     EXSR FTSNMS                                    CFT003
     C                     ENDIF                                          CFT003
      *                                                                   CFT003
      * Payment back-valued                                               CFT003
      *                                                                   CFT003
     C           PVDT      IFLT BJRDNB                                    CFT003
     C           @RCD      ORNE 'N'                                       CFT003
     C           @RCD      ANDNE*BLANKS                                                     BUG26108
     C                     EXSR SRSPFC                                    CFT003
     C                     ENDIF                                          CFT003
      *                                                                   CFT003
     C           EXBAUT    ENDSR                                          CFT003
     C/EJECT                                                              CFT003
      *****************************************************************   CFT003
      *                                                               *   CFT003
      *  SRSPFC - Check that user may authorisation payment           *   CFT003
      *                                                               *   CFT003
      *****************************************************************   CFT003
      *                                                               *   CFT003
     C           SRSPFC    BEGSR                                          CFT003
      *                                                                   CFT003
      * Set up data for check                                             CFT003
      *                                                                   CFT003
     C                     CLEARW0DATA                                    CFT003
     C                     MOVELBRCA      B#BRCA                          CFT003
     C                     MOVEL'O'       O#ACTD                          CFT003
     C                     MOVEL'ME1190'  O#CPGM                          CFT003
      *                                                                   CFT003
      * Check all valid actions                                           CFT003
      *                                                                   CFT003
     C                     CALL 'ME1190'               9090               CFT003
     C                     PARM *BLANKS   P0RTN   7                       CFT003
     C                     PARM '*ACTCODE'W0ACT   8                       CFT003
     C                     PARM           W0DATA                          CFT003
      *                                                                   CFT003
      * Option ended in error                                             CFT003
      *                                                                   CFT003
     C           *IN90     IFEQ '1'                                       CFT003
     C                     MOVE 'Y'       USERR                           CFT003
     C                     MOVEL'MIN0019' FTMSID                          CFT003
     C                     MOVEL'MEMSG'   FTMSGF                          CFT003
     C                     EXSR FTSNMS                                    CFT003
     C                     END                                            CFT003
      *                                                                   CFT003
      * Invalid action                                                    CFT003
      *                                                                   CFT003
     C           P0RTN     IFNE *BLANKS                                   CFT003
     C                     MOVEL'BAE0001' FTMSID                          CFT003
     C                     MOVEL'FTUSRMSG'FTMSGF                          CFT003
     C                     EXSR FTSNMS                                    CFT003
     C                     MOVE 'Y'       USERR                           CFT003
     C                     END                                            CFT003
      *                                                                   CFT003
     C           EXSPFC    ENDSR                                          CFT003
     C/COPY WNCPYSRC,FTH00225
      *****************************************************************   CFT003
     C/EJECT                                                                                  CRE008
      *****************************************************************                       CRE008
      *                                                               *                       CRE008
      *  SRODLC - Overdraft limit check on the account                *                       CRE008
      *                                                               *                       CRE008
      *****************************************************************                       CRE008
     C           SRODLC    BEGSR                                                              CRE008
      *                                                                                       CRE008
     C           *IN60     IFEQ *ON                                                           CRE008
     C           ORCT      IFEQ 'R'                                                           CRE008
     C                     MOVELORC1      ACNO                                                CRE008
     C                     ENDIF                                                              CRE008
     C                     ELSE                                                               CRE008
     C           SNTP      IFEQ 'R'                                                           CRE008
     C                     MOVELSND1      ACNO                                                CRE008
     C                     ENDIF                                                              CRE008
     C                     ENDIF                                                              CRE008
      *                                                                                       CRE008
      ** Retrieve the account ID from LF/ACNUMA                                               CRE008
      *                                                                                       CRE008
     C           ACNO      CHAINACNUMAF              80                                       CRE008
      *                                                                                       CRE008
     C                     MOVEL'RE10'    WPGM    8                                           CRE008
     C                     MOVE '1901'    WPGM                                                CRE008
      *                                                                                       CRE008
     C                     CALL WPGM                                                          CRE008
      *                                                                                       CRE008
      ** Input parameters                                                                     CRE008
      *                                                                                       CRE008
     C                     PARM *BLANKS   PRCODE  7                                           CRE008
     C                     PARM BRCA      PIBRCH  3                                           CRE008
     C**********           PARM CNUM      PICUST  60                                   CRE008 CSD027
     C                     PARM CNUM      PICUST  6                                           CSD027
     C                     PARM CCY       PICURR  3                                           CRE008
     C**********           PARM ACOD      PIACOD  40                                   CRE008 CGL029
     C                     PARM ACOD      PIACOD 100                                          CGL029
     C                     PARM ACSQ      PIACSQ  20                                          CRE008
     C                     PARM           PSETAM 150                                          CRE008
      *                                                                                       CRE008
      ** Output parameters                                                                    CRE008
      *                                                                                       CRE008
     C                     PARM           POBRCH  3                                           CRE008
     C**********           PARM           POCUST  60                                   CRE008 CSD027
     C                     PARM           POCUST  6                                           CSD027
     C                     PARM           POCURR  3                                           CRE008
     C**********           PARM           POACOD  40                                   CRE008 CGL029
     C                     PARM           POACOD 100                                          CGL029
     C                     PARM           POACSQ  20                                          CRE008
     C                     PARM           PORETN 100                                          CRE008
      *                                                                                       CRE008
     C           PRCODE    IFEQ '*ODLMTX'                                                     CRE008
     C                     MOVEL'FTA0131' FTMSID                                              CRE008
     C                     MOVEL'FTUSRMSG'FTMSGF                                              CRE008
     C                     MOVE POBRCH    WBRCDE                                              CRE008
     C                     MOVE '-'       WDASH1                                              CRE008
     C                     MOVE POCUST    WCUSTN                                              CRE008
     C                     MOVE '-'       WDASH2                                              CRE008
     C                     MOVE POCURR    WCURR                                               CRE008
     C                     MOVE '-'       WDASH3                                              CRE008
     C                     MOVE POACOD    WACODE                                              CRE008
     C                     MOVE '-'       WDASH4                                              CRE008
     C                     MOVE POACSQ    WACSEQ                                              CRE008
     C                     MOVE '/'       WSLSH                                               CRE008
     C                     MOVE PORETN    WRETN                                               CRE008
      *                                                                                       CRE008
     C           PORETN    IFEQ *ZERO                                                         CRE008
     C                     MOVELWMDTA1    FTMSDT                                              CRE008
     C                     ELSE                                                               CRE008
     C                     MOVELWMDTA2    FTMSDT                                              CRE008
     C                     ENDIF                                                              CRE008
     C                     EXSR FTSNMS                                                        CRE008
     C                     ENDIF                                                              CRE008
      *                                                                                       CRE008
     C                     ENDSR                                                              CRE008
      *****************************************************************                       CRE008
      *                                                                                       242863
     C           W#TIME    BEGSR                                                              242863
      *                                                                                       242863
     C                     Z-ADD16        QUSBPR                                              242863
     C                     Z-ADD0         QUSBAV                                              242863
     C                     MOVE *BLANKS   INFORM 10                                           242863
     C                     MOVEL'*CURRENT'INFORM                                              242863
     C                     MOVE *BLANKS   INVARI  1                                           242863
     C                     MOVE *BLANKS   OUTFOR 10                                           242863
     C                     MOVEL'*YYMD'   OUTFOR 10                                           242863
      *                                                                                       242863
      ** Use the API to get a 17-byte date/time value (down to the                            242863
      ** microsecond).                                                                        242863
      *                                                                                       242863
     C                     CALL 'QWCCVTDT'                                                    242863
     C                     PARM           INFORM                                              242863
     C                     PARM           INVARI                                              242863
     C                     PARM           OUTFOR                                              242863
     C                     PARM           OUTDAT                                              242863
     C                     PARM           QUSEC                                               242863
      *                                                                                       242863
      ** The OutDate field returned from the API and TimeStamp fields                         242863
      ** returned from this procedure have been broken down by data                           242863
      ** structures.  Copy the data from one to the other and exit.                           242863
      *                                                                                       242863
     C                     MOVE '-'       TMST1                                               242863
     C                     MOVE '-'       TMST2                                               242863
     C                     MOVE '-'       TMST3                                               242863
     C                     MOVE '.'       TMST4                                               242863
     C                     MOVE '.'       TMST5                                               242863
     C                     MOVE '.'       TMST6                                               242863
     C                     MOVE '000'     RETMC                                               242863
     C                     MOVELAPIYR     RETYR                                               242863
     C                     MOVELAPIMH     RETMH                                               242863
     C                     MOVELAPIDY     RETDY                                               242863
     C                     MOVELAPIHR     RETHR                                               242863
     C                     MOVELAPIMN     RETMN                                               242863
     C                     MOVELAPISC     RETSC                                               242863
     C                     MOVELAPIML     RETML                                               242863
      *                                                                                       242863
     C                     MOVELSTAMP     TMST                                                242863
      *                                                                                       242863
     C                     ENDSR                                                              242863
      *                                                                                       242863
      *****************************************************************                       242863
      /EJECT                                                                                  CFT158
      *****************************************************************                       CFT158
      *  SUBR/CHKPST - Determine if subtype is defined to receive                             CFT158
      *                return status                                                          CFT158
      *****************************************************************                       CFT158
     C           CHKPST    BEGSR                                                              CFT158
      *                                                                                       CFT158
      ** Default 'Generate Message' flag to N (do not sent msg).                              CFT158
     C                     MOVEL'N'       GENMSG  1                                           CFT158
      *                                                                                       CFT158
      ** Check if subtype is defined in subtype array then set                                CFT158
      ** flag accordingly.                                                                    CFT158
     C           PYTP      IFEQ 'OP'                                                          CFT158
     C           WSVAL1    IFNE *BLANKS                                                       CFT158
     C           PYST      LOKUPOPST                     89                                   CFT158
     C   89                MOVE 'Y'       GENMSG                                              CFT158
     C                     ELSE                                                               CFT158
     C                     MOVE 'Y'       GENMSG                                              CFT158
     C                     ENDIF                                                              CFT158
     C                     ENDIF                                                              CFT158
      *                                                                                       CFT158
     C           PYTP      IFEQ 'IN'                                                          CFT158
     C           WSVAL2    IFNE *BLANKS                                                       CFT158
     C           PYST      LOKUPIPST                     89                                   CFT158
     C   89                MOVE 'Y'       GENMSG                                              CFT158
     C                     ELSE                                                               CFT158
     C                     MOVE 'Y'       GENMSG                                              CFT158
     C                     ENDIF                                                              CFT158
     C                     ENDIF                                                              CFT158
      *                                                                                       CFT158
     C                     ENDSR                                                              CFT158
      *****************************************************************                       CFT158
      /EJECT                                                                                  CFT158
      *****************************************************************                       CFT158
      *  SUBR/SRSNDQ - Send out return status to MQ Queue                                     CFT158
      *****************************************************************                       CFT158
     C           SRSNDQ    BEGSR                                                              CFT158
      *                                                                                       CFT158
      ** Pass PROCESSED status to program sending status update.                              CFT158
     C                     MOVELFRNT      PFRNT  20                                           CFT158
     C                     MOVELWKPROC    PTRAN  20                                           CFT158
     C                     MOVELPREF      PPREF  16                                           CFT158
      *                                                                                       CFT158
     C                     CALL 'FT000988'                                                    CFT158
     C                     PARM           PFRNT                                               CFT158
     C                     PARM           PTRAN                                               CFT158
     C                     PARM           PPREF                                               CFT158
      *                                                                                       CFT158
     C                     ENDSR                                                              CFT158
      *****************************************************************                       CFT158
      /EJECT                                                                                  CFT158
     C/COPY WNCPYSRC,FT0060C056
     C/COPY ZSRSRC,ZEDITZ2                                                CFT009
     O/EJECT
     O********************************************************************
     O* EXCEPT FORMATS TO RELEASE RECORDS
     OINPAYDDFE                RINPAY
     OOTPAYDDFE                ROTPAY
     O@IPYXL2 E                INPAYX                                                         242863
     O                         INTMST                                                         242863
     OOTPAYXDFE                OPPAYX                                                         242863
     O                         OPTMST                                                         242863
     O/COPY WNCPYSRC,FT0060O001
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
**   POWER - ARRAY OF POWERS OF 10 FOR CURRENCY CONVERSIONS
0000001
0000010
0000100
0001000
0010000
0100000
1000000
**   @DFT - Default Text                                                  055293
**** FUNDS FROM ****
**  Error text                                                            S01435
Error occurred on call to program - see dumps for further details
**  DESC
Miscellaneous Charge 1                                                    CFT009
Miscellaneous Charge 2                                                    CFT009
Miscellaneous Charge 3                                                    CFT009
Miscellaneous Charge 4                                                    CFT009
Miscellaneous Charge 5                                                    CFT009
**  STMP                                                                                      CER049
Stamp Tax 1                                                                                   CER049
Stamp Tax 2                                                                                   CER049
Stamp Tax 3                                                                                   CER049
Stamp Tax 4                                                                                   CER049
Stamp Tax 5                                                                                   CER049
** DCC - Debit/Credit/Charges Text                                                            CRE020
001                                                                                           CRE020
002                                                                                           CRE020
003                                                                                           CRE020
