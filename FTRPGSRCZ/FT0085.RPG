     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas FT Cheques To Be Paid Maint. Level 2')
      *****************************************************************
      *                                                               *
      *  Midas   FUNDS TRANSFER MODULE                                *
      *                                                               *
      *  FT0085 - CHEQUES TO BE PAID LEVEL 2                          *
      *                                                               *
      *  (c) Misys International Banking Systems Ltd. 2001            *
      *     1988, 1990                                                *
      *                                                               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *  Last Amend No. CDL049             Date 07Jul06               *
      *  Prev Amend No. CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CSW037A            Date 02May05               *
      *                 BUG6198            Date 04Apr05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CLE025             Date 20Oct03               *
      *                 CGL029             Date 01Sep03               *
      *                 CSD015             Date 14Oct02               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.05 -----------------------------------------------*
      *                 CFT009             Date 30May00               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 136230              DATE 10MAY99              *
      *                 CEU006              DATE 29MAY98              *
      *                 096486              DATE 03APR97              *
      *                 051131              DATE 09JUN93              *
      *                 056597              DATE 09JUN93              *
      *                 038125              DATE 07MAY93              *
      *                 042167(PSS206)      DATE 19MAR93              *
      *                 E36921              DATE 10MAR92              *   E29970
      *                 E29970              DATE 05JUL91              *   E29970
      *                 E29854              DATE 13DEC90              *   E29854
      *                 S01117              DATE 30JUL90              *   S01117
      *                 S01194              DATE 30JUL90              *   S01194
      *                 S01199              DATE 17AUG89              *   S01199
      *                                                               *
      *****************************************************************
      *                                                               *
      *  CDL049 - Addition of a Reference Rate field (recompile)      *
      *  CSD031 - Enhanced Centralised Static Data                    *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  BUG6198- Cannot save new Details for CUSD (Recompile)        *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CLE025 - Credit Lines                                        *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  CSD015 - Midas Compliance Watch - Watch List Checking        *
      * CFT009 - Addition of fields for FT fees and charges present.  *
      *          Recompile                                            *
      * 136230 - :57: can only be entered if :53: & :54: are present. *
      *          If Account with bank is entered Senders Correspondent*
      *          and Receiver's Correspondent must be entered.        *
      * CEU006 - EMU Funds Transfer Enhancements (Recompile Only)     *
      * 096486 - Previous Fix. 065890.                                *
      *          Skip the SPF Action validation if program is         *
      *          triggered from GL4442 program.                       *
      * 051131 - Tag to GEMS. Consolidated under 042167               *
      * 056597 - Array index error at statement 58400 when action     *
      *          code 'D' taken from initial screen.                  *
      * 038125 - Account With Bank field is treated as a Swift address*
      *          even if it is over 12 characters, as long as it is   *
      *          on only one line.                                    *
      * 042167 - Include CL program to check for record locking       *
      * E36921 - UPDATE USER FLAGS CORRECTLY ON FILES                 *
      * E29970 - COMMAND 7 PROCESSING                                 *   E29970
      * E29854 - ACCOUNT WITH BANK AND RECEIVERS CORRESPONDENT TYPE   *   E29854
      *          VALUES SET TO "A" EVEN IF NOTHING IN ADDRESS FIELDS  *   E29854
      * S01117 - RELEASE 10 MULTIBRANCHING CHANGES                    *   S01199
      * S01194 - STANDING DATA CHANGES                                *   S01199
      * S01199 -  HELP SYSTEM.                                     *   S01199
      *                                                               *
      *                                                               *
      *****************************************************************
     F/EJECT
      ********************************************************************
      *
      *     FUNCTION OF INDICATORS
      *     ----------------------
      *
      *   01     F3 EXIT PROGRAM
      *   02     F12 GO FROM DETAIL SCREEN 3 TO 2
      *   05     F12 REDISPLAY INITIAL SCREEN
      *   10     ? FOUND ON LOOKUP OPERATION                              S01194
      ****25     HELP  (CALL MHELP)                                       S01199
      *   30     ERROR WAS FOUND ON ONE OF THE SCREENS
      *   31     DETAILS OF AMOUNTS FIELDS INVALID
      *   32     DETAILS OF CHARGES FIELDS INVALID
      *   33     BANK TO BANK INFORMATION FIELDS INVALID
      *   35     MODE IS ENQUIRY
      *   40     PROTECT INITIAL SCREEN FIELDS
      *   41     PROTECT ALL FIELDS IN DETAIL SCREENS 2 AND 3 FOR
      *          ENQUIRY PURPOSES
      *   49     INVALID REMMITING BANK REFERENCE
      *   50     INVALID ACTION CODE
      *   51     PAYMENT REFERENCE IS BLANK
      *   52     RECORD ABSENT ON CQPAC
      *   53     CHEQUE HAS ALREADY MATURED FOR AMMENDMENT OR INSERTION
      *   54     MODE IS INSERTION THOUGH LEVEL 2 IND IS 'Y'
      *   55     AUTHORISATION CODE IS 'Y' WHEN MODE IS INSERT OR AMEND
      *   56     SWIFT ADDRESS IS LESS THAN OR GREATER THAN 12 CHARS.
      *          FOR RECEIVERS CORR.
      *   57     SWIFT ADDRESS IS INVALID FOR RECEIVERS CORR.
      *   58     INVALID ADDRESS FOR RECEIVERS CORR.
      *   59     SWIFT ADDRESS IS LESS THAN OR GREATER THAN 12 CHARS.
      *          FOR A/C WITH BANK OR ENTRY PROHIBITED
      *   60     SWIFT ADDRESS IS INVALID FOR A/C WITH BANK.
      *   61     INVALID ADDRESS FOR A/C WITH BANK.
      *   62     RECORD NOT FOUND JUST BEFORE UPDATE
      *   63     RECEIVERS CORRESPONDENT FIELDS INVALID
      *   64     ACCOUNT WITH BANK FIELDS INVALID
      *   70     Linked to FT0080.
      *   75     LOKUP VALID SWIFT CHARACTERS
      *   80     Linked to FT0080.
      *
      ********************************************************************
     F/EJECT
      ********************************************************************
     FFT0085DFCF  E                    WORKSTN
     FCQPAC   UF  E           K        DISK         KINFSR INFSR
     F                                              KCOMIT
     F            CQPADDDF                          KIGNORE
     F*******TABFP   IF  E           K        DISK         KINFSR INFSR   S01194
     F************TABTG10F                          KIGNORE               S01194
     F************TABTG20F                          KIGNORE               S01194
     F************TABLETLF                          KIGNORE               S01194
     F************TABTB20F                          KIGNORE               S01194
     F************TABLET5F                          KIGNORE               S01194
     F************TABLETJF                          KIGNORE               S01194
     F************TABLETPF                          KIGNORE               S01194
     FSDCUSTL7IF  E           K        DISK                               S01194
     F**********CLSWT   IF  E           K        DISK                     S01194
     F************CLINTCBF                          KRENAMECLSWTCBF       S01194
     F**********CLINT   IF  E           K        DISK                     S01194
     F************CLINTC1F                          KIGNORE               S01194
     F************SNAME   IF  E           K        DISK                   S01194
     F************CLINTCBF                          KRENAMESNAMECBF       S01194
     F*
     FSDCWHTL1IF  E           K        DISK                                                   CSD015
     FCQPADDL1IF  E           K        DISK                                                   CSD015
     F            CQPADDDF                          KRENAMECQPADWF                            CSD015
     F********************************************************************
     E                    CPY@    1   1 80
     E/EJECT
     E********************************************************************
     E                    ERC        18  4               ERROR CODE OUTPUT
     E                    DRC        35  1               RECV01 ARRAY
     E                    DAC        35  1               A/C WITH BANK 01
     E                    SW         12  1               SWIFT ADDRESS
     E***********         NUMB   10  10  1 0             NUMERIC          S01194
     E***********         NU          6  1 0             NUMERIC CNUM     S01194
     E                    SWCH   47  47  1               SWFT SET
     E                    TST        35  1               WORK ARR
     E                    #FLD        1 35               WORK ARR
     E*                                                                   S01194
     E*  ARRAY TO INHIBIT ENTRY OF '?'                                    S01194
     E                    QUERY      35  1                                S01194
      *                                                                                       CSD015
      ** Array for XML tags                                                                   CSD015
     E                    XTAG    1  12 40                                                    CSD015
     E********************************************************************
      *                                                                                       CSD015
      ** Rename of CQPADDD Details to avoid overwriting                                       CSD015
      *                                                                                       CSD015
     ICQPADWF                                                                                 CSD015
     I              RECI                            WCRECI                                    CSD015
     I              PREF                            WCPREF                                    CSD015
     I              CQSQ                            WCCQSQ                                    CSD015
     I              DRPT                            WCDRPT                                    CSD015
     I              DRPY                            WCDRPY                                    CSD015
     I              CQAM                            WCCQAM                                    CSD015
     I              CQAMD                           WCCAMD                                    CSD015
     I              DRCY                            WCDRCY                                    CSD015
     I              RATE                            WCRATE                                    CSD015
     I              OVRD                            WCOVRD                                    CSD015
     I              DRVD                            WCDRVD                                    CSD015
     I              DRVDD1                          WCDDD1                                    CSD015
     I              DRVDD2                          WCDDD2                                    CSD015
     I              DRVDD3                          WCDDD3                                    CSD015
     I              DNBC                            WCDNBC                                    CSD015
     I              TRCT                            WCTRCT                                    CSD015
     I              TRCM                            WCTRCM                                    CSD015
     I              TRCMD                           WCTCMD                                    CSD015
     I              CSTA                            WCCSTA                                    CSD015
     I              CSTAD                           WCCTAD                                    CSD015
     I              COLL                            WCCOLL                                    CSD015
     I              COLLD                           WCCOLD                                    CSD015
     I              CDRT                            WCCDRT                                    CSD015
     I              CDRO                            WCCDRO                                    CSD015
     I              LCHT                            WCLCHT                                    CSD015
     I              LCD                             WCLCD                                     CSD015
     I              CHTP                            WCCHTP                                    CSD015
     I              OEDT                            WCOEDT                                    CSD015
     I              OEDTD1                          WCOED1                                    CSD015
     I              OEDTD2                          WCOED2                                    CSD015
     I              OEDTD3                          WCOED3                                    CSD015
     I              IACG                            WCIACG                                    CSD015
     I              PACG                            WCPACG                                    CSD015
     I              DRAG                            WCDRAG                                    CSD015
     I              DMSG                            WCDMSG                                    CSD015
     I              ADIN                            WCADIN                                    CSD015
     I              MDIN                            WCMDIN                                    CSD015
     I              SBCQ                            WCSBCQ                                    CSD015
     I              TRCH                            WCTRCH                                    CSD015
     I              COLH                            WCCOLH                                    CSD015
     I              CSTH                            WCCSTH                                    CSD015
     I              INUSR1                          WCIUS1                                    CSD015
     I              INUSR2                          WCIUS2                                    CSD015
     I              BRCA                            WCBRCA                                    CSD015
     I              ORBR                            WCORBR                                    CSD015
     I              DRBR                            WCDRBR                                    CSD015
     I              CDBR                            WCCDBR                                    CSD015
     I              BOKC                            WCBOKC                                    CSD015
     I              PRFC                            WCPRFC                                    CSD015
     I              PDDRAM                          WCPRAM                                    CSD015
     I              PDVAT1                          WCPVA1                                    CSD015
     I              PDVAT2                          WCPVA2                                    CSD015
     I              PDVAT3                          WCPVA3                                    CSD015
     I              PDVAT4                          WCPVA4                                    CSD015
     I              PDCHCM                          WCPCHM                                    CSD015
     I              PDVATT                          WCPVAT                                    CSD015
     I              PDCHCH                          WCPCHC                                    CSD015
     I              PDVATH                          WCPDVH                                    CSD015
     I              PDVATR                          WCPDVR                                    CSD015
     I              FXMP                            WCFXMP                                    CSD015
     I              FXMD                            WCFXMD                                    CSD015
     I              MBSI                            WCMBSI                                    CSD015
     I              MSIG                            WCMSIG                                    CSD015
     I              MAMT                            WCMAMT                                    CSD015
     I              NDCY                            WCNDCY                                    CSD015
     I              NDAM                            WCNDAM                                    CSD015
     I              TFCMCC                          WCCMCC                                    CSD015
     I              FCHCCC                          WCCHCC                                    CSD015
     I              CSTACD                          WCTACD                                    CSD015
     I              COLCGC                          WCLCGC                                    CSD015
     I              APVTCC                          WCVTCC                                    CSD015
     I              CPCHRT                          WCCHRT                                    CSD015
     I              CPCHGC                          WCCHGC                                    CSD015
      *                                                                                       CSD015
     I*  DATA STRUCTURE FOR COMPILATION  - COPYRIGHT INSERTION
     ICPYR@#      DS
     I                                        1  80 CPY@
     I                                        1  20 CPY@##
     I/EJECT
     I********************************************************************
     IPSDS       SDS
     I                                      244 253 WSID
     I                                      254 263 USRID
     I*
     IDLDA        DS                            256
     I***********                           134 138 DBFILE                S01194
     I***********                           139 167 DBKEY                 S01194
     I***********                           168 175 DBPGM                 S01194
     I***********                           176 1770DBASE                 S01194
     I                                      134 141 DBFILE                S01194
     I                                      142 170 DBKEY                 S01194
     I                                      171 180 DBPGM                 S01194
     I                                      181 1830DBASE                 S01194
     I*
     I*    COMMITTMENT CONTROL TEXT - FOR DETAIL
     ICMTXTD      DS
     I                                        1   50TIMEXD
     I                                        6   7 MDIDD
     I                                        8  15 PGMND
     I                                       16  18 WSIDD
     I                                       19  240TIMED
     I                                       25  25 ACTDD
     I                                       26  35 USRIDD
     I*
     I                                       51  52 STID
     I                                       53  53 SACTD
     I                                       54  68 SPREF
     I                                       69 103 DRC01
     I                                       69  78 RFST10                S01117
     I                                       79 103 RLST25                S01117
     I                                      104 243 DR2TO5                S01117
     I                                      104 138 DRC02
     I                                      139 173 DRC03
     I                                      174 208 DRC04
     I                                      209 243 DRC05
     I                                      244 278 DACB1
     I                                      244 253 DFST10                S01117
     I                                      254 278 DLST25                S01117
     I                                      279 418 DA2TO5                S01117
     I                                      279 313 DACB2
     I                                      314 348 DACB3
     I                                      349 383 DACB4
     I                                      384 418 DACB5
     I                                      419 453 DDAA1
     I                                      454 488 DDAA2
     I                                      489 523 DDAA3
     I                                      524 558 DDAA4
     I                                      559 593 DDAA5
     I                                      594 628 DDAA6
     I                                      629 663 DDCH1
     I                                      664 698 DDCH2
     I                                      699 733 DDCH3
     I                                      734 768 DDCH4
     I                                      769 803 DDCH5
     I                                      804 838 DDCH6
     I                                      839 854 DRBKR
     I                                      855 889 DBB11
     I                                      890 924 DBB12
     I                                      925 959 DBB13
     I                                      960 994 DBB14
     I                                      9951029 DBB15
     I                                     10301064 DBB16
     I*
     I            DS
     I* DS TO REDEFINE ERROR CODES ARRAY ERC
     I*
     I                                        1  78 ERRCDE
     I                                        1  72 ERC
     I*
     I            DS
     I* DS TO DEFINE STORED FIELDS FOR COMPARE (CMPS)
     I*
     I                                        1  12 CMPS
     I                                        1   60SLCHT
     I                                        7  110SLCD
     I                                       12  12 SLVIN
     I*
     I            DS
     I* DS TO DEFINE JUST BEFORE UPDATE OR INSERT FIELDS FOR COMPARE
     I* CMP1
     I                                        1  12 CMP1
     I                                        1   60SLCHT1
     I                                        7  110SLCD1
     I                                       12  12 SLVIN1
     I            DS
     I* DS TO REDEFINE ARRAY DRC FOR POSITIONS 12-35.
     I*
     I                                        1  35 DRC
     I                                        9  11 DRC911
     I                                       12  35 DRCR
     I            DS
     I* DS TO REDEFINE ARRAY DAC FOR POSITIONS 12-35.
     I*
     I                                        1  35 DAC
     I                                        9  11 DAC911
     I                                       12  35 DACR
     I*
     I** Redefine SWIFT array as field for SETLL.
     ICLSWTK      DS
     I                                        1  12 SW
     I*
     I            DS
     I                                        1  35 SWFT
     I                                        2  13 SWFT12
     I*
     ICLTKEY      DS
     I* DS TO SET UP LF/CLINT KEY TO REPORT CHAIN FAIL
     I*
     I**********                              1   60KCNUM                                     CSD027
     I**********                              7   7 KKEY                                      CSD027
     I*
     I            DS
     I*     DATA STRUCTURE REDEFINING ADDRESS  FIELDS
     I*
     I                                        1 210 ADDRSS
     I                                        1  35 ADCHK1
     I                                       36  70 ADCHK2
     I                                       71 105 ADCHK3
     I                                      106 140 ADCHK4
     I                                      141 175 ADCHK5
     I                                      176 210 ADCHK6
     I*
     ISDBANK    E DSSDBANKPD                                              S01194
     ISDMMOD    E DSSDMMODPD                                              S01194
     ISDFTFR    E DSSDFTFRPD                                              S01194
     ISDGELR    E DSSDGELRPD                                              S01194
     ISDCUST    E DSSDCUSTPD                                              S01194
      *                                                                                       CSD015
     ISDCUS2    E DSSDCUSTPD                                                                  CSD015
     I              BBCUST                          WLCUST                                    CSD015
     I              BBCSSN                          WLCSSN                                    CSD015
     I              BBCNA1                          WLCNA1                                    CSD015
     I              BBCNA2                          WLCNA2                                    CSD015
     I              BBCNA3                          WLCNA3                                    CSD015
     I              BBCNA4                          WLCNA4                                    CSD015
     I              BBCRTN                          WLCRTN                                    CSD015
     I              BBPAIN                          WLPAIN                                    CSD015
     I              BBCRNM                          WLCRNM                                    CSD015
     I              BBDRCS                          WLDRCS                                    CSD015
     I              BBLCCD                          WLLCCD                                    CSD015
     I              BBACOC                          WLACOC                                    CSD015
     I              BBCNCZ                          WLCNCZ                                    CSD015
     I              BBCOLC                          WLCOLC                                    CSD015
     I              BBSSDT                          WLSSDT                                    CSD015
     I              BBDOIC                          WLDOIC                                    CSD015
     I              BBPCNB                          WLPCNB                                    CSD015
     I              BBCASC                          WLCASC                                    CSD015
     I              BBBRCD                          WLBRCD                                    CSD015
     I              BBBNBI                          WLBNBI                                    CSD015
     I              BBLINC                          WLLINC                                    CSD015
     I              BBLICD                          WLLICD                                    CSD015
     I              BBCTNB                          WLCTNB                                    CSD015
     I              BBREID                          WLREID                                    CSD015
     I              BBBSIN                          WLBSIN                                    CSD015
     I              BBCSTY                          WLCSTY                                    CSD015
     I              BBTAIN                          WLTAIN                                    CSD015
     I              BBCSID                          WLCSID                                    CSD015
     I              BBSTAD                          WLSTAD                                    CSD015
     I              BBTXA1                          WLTXA1                                    CSD015
     I              BBTXA2                          WLTXA2                                    CSD015
     I              BBTXA3                          WLTXA3                                    CSD015
     I              BBTXA4                          WLTXA4                                    CSD015
     I              BBTXA5                          WLTXA5                                    CSD015
     I              BBCHID                          WLCHID                                    CSD015
     I              BBCHSC                          WLCHSC                                    CSD015
     I              BBCABA                          WLCABA                                    CSD015
     I              BBBFIC                          WLBFIC                                    CSD015
     I              BBBLCD                          WLBLCD                                    CSD015
     I              BBFWCD                          WLFWCD                                    CSD015
     I              BBLCD                           WLLCD                                     CSD015
     I              BBTYLC                          WLTYLC                                    CSD015
     I              BBLALD                          WLLALD                                    CSD015
     I              BBLDHD                          WLLDHD                                    CSD015
     I              BBLRLD                          WLLRLD                                    CSD015
     I              BBDTDL                          WLDTDL                                    CSD015
     I              BBLETI                          WLLETI                                    CSD015
     I              BBCMTI                          WLCMTI                                    CSD015
     I              BBGSFM                          WLGSFM                                    CSD015
     I              BBSTFG                          WLSTFG                                    CSD015
     I              BBRWCD                          WLRWCD                                    CSD015
     I              BBNG01                          WLNG01                                    CSD015
     I              BBNG02                          WLNG02                                    CSD015
     I              BBNG03                          WLNG03                                    CSD015
     I              BBNG04                          WLNG04                                    CSD015
     I              BBNG05                          WLNG05                                    CSD015
     I              BBNG06                          WLNG06                                    CSD015
     I              BBNG07                          WLNG07                                    CSD015
     I              BBNG08                          WLNG08                                    CSD015
     I              BBNG09                          WLNG09                                    CSD015
     I              BBNG10                          WLNG10                                    CSD015
     I              BBNG11                          WLNG11                                    CSD015
     I              BBNG12                          WLNG12                                    CSD015
     I              BBNG13                          WLNG13                                    CSD015
     I              BBNG14                          WLNG14                                    CSD015
     I              BBNG15                          WLNG15                                    CSD015
     I              BBDS01                          WLDS01                                    CSD015
     I              BBDS02                          WLDS02                                    CSD015
     I              BBDS03                          WLDS03                                    CSD015
     I              BBDS04                          WLDS04                                    CSD015
     I              BBDS05                          WLDS05                                    CSD015
     I              BBDS06                          WLDS06                                    CSD015
     I              BBDS07                          WLDS07                                    CSD015
     I              BBDS08                          WLDS08                                    CSD015
     I              BBDS09                          WLDS09                                    CSD015
     I              BBDS10                          WLDS10                                    CSD015
     I              BBDS11                          WLDS11                                    CSD015
     I              BBDS12                          WLDS12                                    CSD015
     I              BBDS13                          WLDS13                                    CSD015
     I              BBDS14                          WLDS14                                    CSD015
     I              BBDS15                          WLDS15                                    CSD015
     I              BBDNW1                          WLDNW1                                    CSD015
     I              BBDNW2                          WLDNW2                                    CSD015
     I              BBDNW3                          WLDNW3                                    CSD015
     I              BBDNW4                          WLDNW4                                    CSD015
     I              BBDNW5                          WLDNW5                                    CSD015
     I              BBDNW6                          WLDNW6                                    CSD015
     I              BBDNW7                          WLDNW7                                    CSD015
     I              BBDNW8                          WLDNW8                                    CSD015
     I              BBDNW9                          WLDNW9                                    CSD015
     I              BBCGRP                          WLCGRP                                    CSD015
     I              BBCDEL                          WLCDEL                                    CSD015
     I              BBABA2                          WLABA2                                    CSD015
     I              BBOGID                          WLOGID                                    CSD015
     I              BBSSDL                          WLSSDL                                    CSD015
     I              BBORED                          WLORED                                    CSD015
     I              BBMCAC                          WLMCAC                                    CSD015
     I              BBCRPC                          WLCRPC                                    CSD015
     I              BBPSWC                          WLPSWC                                    CSD015
     I              BBMGTP                          WLMGTP                                    CSD015
     I              BBNET                           WLNET                                     CSD015
     I              BBNTGP                          WLNTGP                                    CSD015
     I              BBNTCP                          WLNTCP                                    CSD015
     I              BBNTND                          WLNTND                                    CSD015
     I              BBNTMM                          WLNTMM                                    CSD015
     I              BBTICS                          WLTICS                                    CSD015
     I              BBSWFI                          WLSWFI                                    CSD015
     I              BBDINC                          WLDINC                                    CSD015
     I              BBCOMG                          WLCOMG                                    CSD015
     I              BBCHRG                          WLCHRG                                    CSD015
     I              BBAGNT                          WLAGNT                                    CSD015
     I              BBAGNP                          WLAGNP                                    CSD015
     I              BBTRAS                          WLTRAS                                    CSD015
     I              BBNAR1                          WLNAR1                                    CSD015
     I              BBNAR2                          WLNAR2                                    CSD015
     I              BBNAR3                          WLNAR3                                    CSD015
     I              BBNAR4                          WLNAR4                                    CSD015
     I              BBDFAC                          WLDFAC                                    CSD015
     I              BBDFAS                          WLDFAS                                    CSD015
     I              BBFRNT                          WLFRNT                                    CSD015
     I              BBAFRT                          WLAFRT                                    CSD015
     I              BBREPA                          WLREPA                                    CSD015
     I              BBTMST                          WLTMST                                    CSD015
     I              BBPRBA                          WLPRBA                                    CSD015
     I              BBCLSS                          WLCLSS                                    CSD015
     I              BBEFDT                          WLEFDT                                    CSD015
     I              BBCLST                          WLCLST                                    CSD015
     I              BBCLDT                          WLCLDT                                    CSD015
     I              BBCORP                          WLCORP                                    CSD015
     I              BBCBEI                          WLCBEI                                    CSD015
     I              BBRI01                          WLRI01                                    CSD015
     I              BBRI02                          WLRI02                                    CSD015
     I              BBRI03                          WLRI03                                    CSD015
     I              BBRI04                          WLRI04                                    CSD015
     I              BBRI05                          WLRI05                                    CSD015
     I              BBFUND                          WLFUND                                    CSD015
     I              QQDFAC                          QQDFA1                                    CGL029
     I              BBFCMF                          WLFCMF                                    CLE025
     I              BBINOF                          WLINOF                                    CLE025
     I              BBMSTF                          WLMSTF                                    CLE025
     I              BBIOPC                          WLIOPC                                    CLE025
     I              BBCSI2                          WLCSI2                                    CSW036
     I              BBFNAC                          WLFNAC                                    CSW037
     I              BBDEAC                          WLDEAC                                    CSD025
     I              BBDEDT                          WLDEDT                                    CSD025
     I              BBIUSR                          WLIUSR                                    CSD031
     I              BBAUSR                          WLAUSR                                    CSD031
     I              BBXUSR                          WLXUSR                                    CSD031
     I              BBAACC                          WLAACC                                    CSD031
     I              BBEACC                          WLEACC                                    CSD031
     I              BBGPDT                          WLGPDT                                    CSD031
     I*                                                                   S01194
     IDSFDY     E DSDSFDY                                                 S01194
     IDSSDY     E DSDSSDY                                                 S01194
     I*                                                                   S01194
     ISCSARD    E DSSCSARDPD                                                                  CSD015
      ** Switchable features description                                                      CSD015
      *                                                                                       CSD015
     ISC24X7    E DSSC24X7                                                                    CSD015
      ** 24X7 status data area                                                                CSD015
      *                                                                                       CSD015
     ISDSTAT    E DSSDSTAT                                                                    CSD015
      ** SD data area                                                                         CSD015
      *                                                                                       CSD015
     ISDWLCC    E DSSDWLCCPD                                                                  CSD015
      ** DS For Midas Functions for Watch List Checking Details File                          CSD015
      *                                                                                       CSD015
     ISDWLTD    E DSSDWLTOPD                                                                  CSD015
      ** DS For Watch List Transaction Details File                                           CSD015
      *                                                                                       CSD015
     ISDCWCD    E DSSDCWCDPD                                                                  CSD015
      ** DS For Watch List Configuration Data File                                            CSD015
      *                                                                                       CSD015
     IPSTRNG      DS                           9999                                           CSD015
      *                                                                                       CSD015
      *****************************************************************                       CSD015
      *                                                                                       CSD015
     C                     MOVEACPY@      BIS@   80
     C********************************************************************
     C/EJECT
     C********************************************************************
     C* KLISTS
     C*
     C* KEY FOR CHAINING TO LF/CQPAC
     C           CQPACK    KLIST
     C                     KFLD           PREFKY 15
     C                     KFLD           CQSQKY  20
     C**KEY*FOR*CHAINING TO LF/CLINT                                                          CSD027
     C********** KCUSNO    KLIST                                                              CSD027
     C**********           KFLD           KCNUM   60                                          CSD027
     C**********           KFLD           KKEY    1                                           CSD027
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C           *ENTRY    PLIST
     C           SACTD     PARM           PACTCD
     C           SPREF     PARM           PPREF
     C                     PARM           PCMD    1        FUNCTION
     C                     PARM           WLINK   1
     C           *LIKE     DEFN SACTD     PACTCD
     C           *LIKE     DEFN SPREF     PPREF
     C* *LIKE DEFN
     C           *LIKE     DEFN DBFILE    WDBFIL
     C           *LIKE     DEFN DBKEY     WDBKEY
     C           *LIKE     DEFN DBASE     WDBASE
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C* ROUTINES USED
     C*
     C* INIT         : INITIAL PROCESS
     C* MAIN         : DRIVER ROUTINE
     C* TERM         : TERMINATION
     C* SCR1IN       : INITIALISE DISPLAY FIELDS FOR SCREEN 1
     C* MOVERR       : MOVEMENT OF ERROR CODES
     C* VALSC1       : VALIDATE SCREEN 1
     C* MRTOSC       : MOVEMENT OF FIELDS FROM RECORD AREA TO DISPLAY
     C*                AREA
     C* BLKSCF       : BLANK ALL DISPLAY FIELDS FOR SCREEN 2 AND 3
     C* VALSC2       : VALIDATE SCREEN 2
     C* UPDFIL       : UPDATE FILE CQPAC
     C* SRTYPE       : MOVEMENT IF ADDRESS OR SWIFT
     C* MSTORC       : MOVEMENT OF FIELDS FROM DISPLAY AREA TO RECORD
     C*                AREA
     C* CMTCTL       : COMMIT CONTROL
     C* INFSR        : FILE INFORMATION SUB ROUTINE FOR ANY DATABASE
     C*                FILE HANDLING ERRORS
     C* SWIFT        : VALIDATES SWIFT ADDRESS
     C* ADCHK        : VALIDATES ADDRESS FIELDS
     C* SWSET        : CHECKS FOR NON SWIFT CHARACTERS IN ADDRESS FIELDS
     C*
     C* CALLED PROGRAMS
     C*
     C* MHELP        : HELP FUNCTION
     C*
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C* PROCESS
     C*                                                                   096486
     C**  Restore back correct action code if triggered through A/C       096486
     C**  Movements (GL4442).                                             096486
     C*                                                                   096486
     C                     MOVE *BLANK    @GL442  1                       096486
     C           SACTD     IFEQ 'G'                                       096486
     C                     MOVE 'Y'       @GL442                          096486
     C                     MOVE 'E'       SACTD                           096486
     C                     ENDIF                                          096486
     C*
     C                     EXSR INIT
     C*
     C           *INU7     IFEQ '0'
     C                     EXSR MAIN
     C                     END
     C*
     C                     EXSR TERM
     C*
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C* INIT : THIS SR DOES ALL THE INITAL PROCESSING
     C*
     C*****************************************************************
     C*
     C           INIT      BEGSR
     C*
     C* ALLOW CMD7 ON SCREENS IF SWITCH U5  PASSED ON FROM FT0145         E29970
     C           *INU5     IFEQ '1'                                       E29970
     C                     SETON                     11                   E29970
     C                     END                                            E29970
     C*********************MOVEL'01'      TABKEY 12                       S01194
     C*********************MOVE '10'      TABKEY                          S01194
     C*
     C*+READING*TABTB10*TO*RETREIVE*RUN*DATE*(MIDAS)************          S01194
     C*
     C***********TABKEY****CHAINTABFP                60                   S01194
     C*
     C************IN60*****IFEQ '0'                                       S01194
     C***********RECI******ANDNE'D'                                       S01194
     C*********************SETON                     60                   S01194
     C*********************END                                            S01194
     C*
     C************IN60*****IFEQ '1'                                       S01194
     C*********************SETON                     U7U8                 S01194
     C*********************MOVEL'TABFP'   WDBFIL             ************ S01194
     C*********************Z-ADD1         WDBASE             * DBERR 01 * S01194
     C*********************MOVELTABKEY    WDBKEY             ************ S01194
     C*********************GOTO ENDINT                                    S01194
     C*********************END                               ** E01       S01194
     C*
     C*
     C***Get*Control*record*2*-********************                       S01194
     C*********************MOVE '11'      TABKEY                          S01194
     C***********TABKEY****CHAINTABTB11F             60                   S01194
     C*
     C************IN60*****IFEQ '1'                                       S01194
     C***********RECI******ORNE 'D'                                       S01194
     C*********************SETON                     U7U8                 S01194
     C*********************MOVEL'TABFP'   WDBFIL             ************ S01194
     C*********************Z-ADD26        WDBASE             * DBERR 26 * S01194
     C*********************MOVELTABKEY    WDBKEY             ************ S01194
     C*********************GOTO ENDINT                                    S01194
     C*********************END                                            S01194
     C*
     C** CALL 'AOBANKR0' TO RETREIVE  RUNDATE                             S01194
     C*                                                                   S01194
     C                     CALL 'AOBANKR0'                                S01194
     C                     PARM '*DBERR ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
     C*                                                                   S01194
     C** SETUP RUNDATE                                                    S01194
     C*                                                                   S01194
     C                     MOVE BJMRDT    SRUNA                           S01194
     C*                                                                   S01194
     C** EXTRACT MULTIBRANCH INDICATOR                                    S01194
     C*                                                                   S01194
     C                     CALL 'AOMMODR0'                                S01194
     C                     PARM '*DBERR ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDMMOD    PARM SDMMOD    DSFDY                           S01194
     C*                                                                   S01194
     C** EXTRACT GENERAL LEDGER DETAILS                                   S01194
     C*                                                                   S01194
     C**********           CALL 'AOGELRR0'                                S01194              CGL029
     C                     CALL 'AOGELRR1'                                                    CGL029
     C                     PARM '*DBERR ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C********** SDGELR    PARM SDGELR    DSFDY                           S01194              CGL029
     C           SDGELR    PARM SDGELR    DSSDY                                               CGL029
     C*                                                                   S01194
     C** EXTRACT FUNDS TRANSFER DETAILS                                   S01194
     C*                                                                   S01194
     C                     CALL 'AOFTFRR0'                                S01194
     C                     PARM '*DBERR ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDFTFR    PARM SDFTFR    DSFDY                           S01194
     C*                                                                   S01194
     C*   Set  70  Used on DSPF to enable F12 on detail 1
     C*             if program linked with FT0050.
     C           WLINK     COMP 'Y'                      70=
     C*
     C                     TIME           STIME   60
     C                     MOVE 'FT'      MDIDD
     C                     MOVEL'FT0085'  PGMND
     C                     MOVE USRID     USRIDD
     C                     MOVE WSID      WSIDD
     C**********           MOVE USRID     INUSR2 10                       E36921
     C*
     C** IF PPREF HAS SOMETHING IN IT THEN IT IS LINKED FROM FT0080
     C           PPREF     IFNE *BLANKS
     C                     MOVE '1'       *IN80
     C                     END
      *                                                                                       CSD015
      ** Access SAR details file to determine if Midas 24X7 (CSC011)                          CSD015
      ** is installed                                                                         CSD015
      *                                                                                       CSD015
     C                     MOVE *BLANKS   CSC011  1                                           CSD015
     C                     CALL 'AOSARDR0'                                                    CSD015
     C                     PARM *BLANKS   PRTCD   7                                           CSD015
     C                     PARM '*VERIFY' POPTN   7                                           CSD015
     C                     PARM 'CSC011'  PSARD   6                                           CSD015
     C           SCSARD    PARM SCSARD    DSFDY                                               CSD015
      *                                                                                       CSD015
     C           PRTCD     IFNE *BLANKS                                                       CSD015
     C           PRTCD     ANDNE'*NRF   '                                                     CSD015
     C                     MOVEL'SCSARDPD'WDBFIL                                              CSD015
     C                     MOVEL'*VERIFY' WDBKEY                                              CSD015
     C                     Z-ADD1         WDBASE                                              CSD015
     C                     MOVE *ON       *INU7                                               CSD015
     C                     EXSR TERM                                                          CSD015
     C                     ENDIF                                                              CSD015
     C           PRTCD     IFEQ *BLANKS                                                       CSD015
     C                     MOVE 'Y'       CSC011                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      ** Access SAR details file to determine if Concord Interface                            CSD015
      ** Development (CCF001) is installed                                                    CSD015
      *                                                                                       CSD015
     C                     MOVE *BLANKS   CCF001  1                                           CSD015
     C                     CALL 'AOSARDR0'                                                    CSD015
     C                     PARM *BLANKS   PRTCD                                               CSD015
     C                     PARM '*VERIFY' POPTN                                               CSD015
     C                     PARM 'CCF001'  PSARD                                               CSD015
     C           SCSARD    PARM SCSARD    DSFDY                                               CSD015
      *                                                                                       CSD015
     C           PRTCD     IFNE *BLANKS                                                       CSD015
     C           PRTCD     ANDNE'*NRF   '                                                     CSD015
     C                     MOVEL'SCSARDPD'WDBFIL                                              CSD015
     C                     MOVEL'*VERIFY' WDBKEY                                              CSD015
     C                     Z-ADD2         WDBASE                                              CSD015
     C                     MOVE *ON       *INU7                                               CSD015
     C                     EXSR TERM                                                          CSD015
     C                     ENDIF                                                              CSD015
     C           PRTCD     IFEQ *BLANKS                                                       CSD015
     C                     MOVE 'Y'       CCF001                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      ** Access SAR details file to determine if Compliance Watch                             CSD015
      ** (CSD015) is installed                                                                CSD015
      *                                                                                       CSD015
     C                     MOVE *BLANKS   CSD015  1                                           CSD015
     C                     CALL 'AOSARDR0'                                                    CSD015
     C                     PARM *BLANKS   PRTCD                                               CSD015
     C                     PARM '*VERIFY' POPTN                                               CSD015
     C                     PARM 'CSD015'  PSARD                                               CSD015
     C           SCSARD    PARM SCSARD    DSFDY                                               CSD015
      *                                                                                       CSD015
     C           PRTCD     IFNE *BLANKS                                                       CSD015
     C           PRTCD     ANDNE'*NRF   '                                                     CSD015
     C                     MOVEL'SCSARDPD'WDBFIL                                              CSD015
     C                     MOVEL'*VERIFY' WDBKEY                                              CSD015
     C                     Z-ADD3         WDBASE                                              CSD015
     C                     MOVE *ON       *INU7                                               CSD015
     C                     EXSR TERM                                                          CSD015
     C                     ENDIF                                                              CSD015
     C           PRTCD     IFEQ *BLANKS                                                       CSD015
     C                     MOVE 'Y'       CSD015                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           CSD015    IFEQ 'Y'                                                           CSD015
      *                                                                                       CSD015
      ** If CSD015 is on, check if this function is being                                     CSD015
      ** monitored by compliance watch.                                                       CSD015
      *                                                                                       CSD015
     C                     CALL 'AOWLCCR0'                                                    CSD015
     C                     PARM *BLANKS   PRTCD                                               CSD015
     C                     PARM '*KEY   ' POPTN                                               CSD015
     C                     PARM 'CHEQPAID'PFUNC   8                                           CSD015
     C           SDWLCC    PARM SDWLCC    DSFDY                                               CSD015
      *                                                                                       CSD015
     C           PRTCD     IFNE *BLANKS                                                       CSD015
     C           PRTCD     ANDNE'*NRF   '                                                     CSD015
     C                     MOVEL'SDWLCCPD'WDBFIL                                              CSD015
     C                     MOVEL'*VERIFY' WDBKEY                                              CSD015
     C                     Z-ADD4         WDBASE                                              CSD015
     C                     MOVE *ON       *INU7                                               CSD015
     C                     EXSR TERM                                                          CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      ** Call access program AOCWCDR0 for Private Customer                                    CSD015
      ** Industry Code                                                                        CSD015
      *                                                                                       CSD015
     C                     CALL 'AOCWCDR0'                                                    CSD015
     C                     PARM *BLANKS   PRTCD                                               CSD015
     C                     PARM '*FIRST ' POPTN                                               CSD015
     C           SDCWCD    PARM SDCWCD    DSFDY                                               CSD015
      *                                                                                       CSD015
     C           PRTCD     IFNE *BLANKS                                                       CSD015
     C                     MOVEL'SDCWCDPD'WDBFIL                                              CSD015
     C                     MOVEL'*FIRST'  WDBKEY                                              CSD015
     C                     Z-ADD5         WDBASE                                              CSD015
     C                     MOVE *ON       *INU7                                               CSD015
     C                     EXSR TERM                                                          CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      ** Retrieve Details of SC24X7 and SDSTAT                                                CSD015
      *                                                                                       CSD015
     C           *NAMVAR   DEFN           SC24X7                                              CSD015
     C           *NAMVAR   DEFN           SDSTAT                                              CSD015
     C                     IN   SC24X7                                                        CSD015
     C                     IN   SDSTAT                                                        CSD015
      *                                                                                       CSD015
     C           KLCWHT    KLIST                                                              CSD015
     C                     KFLD           KFUNCC  8                                           CSD015
     C                     KFLD           KIDENT 40                                           CSD015
     C                     KFLD           KBRNCH  3                                           CSD015
     C*
     C           ENDINT    ENDSR
     C*
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C* MAIN : DRIVER ROUTINE
     C*
     C* CALLS ROUTINES: SCR1IN
     C*                 MOVERR
     C*                 VALSC1
     C*                 MRTOSC
     C*                 BLKSCF
     C*                 VALSC2
     C*                 UPDFIL
     C*****************************************************************
     C*
     C           MAIN      BEGSR
     C*
     C** If program 'linked' with FT0080 skip display of initial screen.
     C***********FTLJ******IFEQ 'Y'                        B001           S01194
     C           BTLVJN    IFEQ 'Y'                        B001           S01194
     C           PPREF     ANDNE*BLANK
     C           WLINK     OREQ 'Y'                        B001
     C           PPREF     ANDNE*BLANK
     C                     GOTO JOIN
     C                     END                             E001
     C*
     C           SCRN1     TAG
      *                                                                   042167
      * Call CL program to de-allocate                                    042167
      *                                                                   042167
     C                     MOVE *BLANKS   @RTCDE                          042167
     C                     MOVE 'FT'      @MODLE                          042167
     C                     MOVE *BLANKS   @TREF                           042167
     C                     MOVE *BLANKS   @RTINF                          042167
     C                     CALL 'AOC8000'                                 042167
     C                     PARM           @RTCDE                          042167
     C                     PARM           @MODLE                          042167
     C                     PARM           @TREF                           042167
     C                     PARM           @RTINF                          042167
     C*
     C                     TIME           TIME                            S01117
     C                     WRITEFT0085F1
     C           SCRN11    TAG
     C                     READ FT0085F1                 65
     C**                                                                  S01199
     C**HELP FUNCTION                                                     S01199
     C**                                                                  S01199
     C**         *IN25     IFEQ '1'                                       S01199
     C**                   MOVELERRCDE    HERCD 160                       S01199
     C**                   MOVEL'FT0000'  HBPGM   8                       S01199
     C**                   CALL 'MHELP'                                   S01199
     C**                   PARM           HBPGM                           S01199
     C**                   PARM           HERCD                           S01199
     C**                   GOTO SCRN11                                    S01199
     C**                   END                                            S01199
     C**                                                                  S01199
     C** Entry point if program 'linked' with FT0080.
     C           JOIN      TAG
     C*
     C*
     C* SETTING OF ERROR INDICATORS FOR SCREEN 1
     C* AND BLANKING ERROR CODES AND MESSAGES
     C                     SETOF                     505152
     C                     SETOF                     535455
     C                     SETOF                     3035
     C                     MOVE *BLANKS   ERRCDE
     C                     Z-ADD0         X       20       ARRAY INDEX
     C*
     C* F3 CHECK
     C*
     C           *IN01     IFEQ '1'
     C* If F12 (only enabled if linked) then exit.
     C           *IN02     OREQ '1'
     C           *IN07     OREQ '1'                                       E29970
     C                     GOTO ENDMN
     C                     END
     C*
     C* F12 CHECK
     C*
     C           *IN05     IFEQ '1'
     C*
     C** If program 'linked' with FT0080 exit on F12
     C           *IN80     IFEQ '1'
     C                     GOTO ENDMN
     C                     END
     C*
     C                     EXSR SCR1IN
     C                     GOTO SCRN1
     C                     END
     C*
     C* VALIDATING FOR A VALID ACTION CODE
     C*
     C           SACTD     IFNE 'A'
     C           SACTD     ANDNE'I'
     C           SACTD     ANDNE'E'
     C*********************MOVE ' 001'    CODE    4                       S01117
     C                     MOVE ' 002'    CODE    4                       S01117
     C                     EXSR MOVERR
     C                     SETON                     3050
     C                     END
     C*
     C* VALIDATING PAYMENT REFERENCE
     C*
     C           SPREF     IFEQ *BLANKS
     C*********************MOVE ' 069'    CODE                            S01117
     C                     MOVE ' 003'    CODE                            S01117
     C                     EXSR MOVERR
     C                     SETON                     3051
     C                     GOTO SCRN1
     C                     END
     C*
     C* READING HEADER RECORD FOR CQPAC
     C*
     C                     MOVE SPREF     PREFKY
     C                     Z-ADD0         CQSQKY
     C*
     C           CQPACK    CHAINCQPAC                52
     C*
     C* RECORD NOT FOUND ON CQPAC
     C*
     C           *IN52     IFEQ '1'
     C*********************MOVE ' 331'    CODE                            S01117
     C                     MOVE ' 007'    CODE                            S01117
     C                     EXSR MOVERR
     C                     SETON                     30
     C                     GOTO SCRN1
     C                     END
     C*
     C* WRITING BACK THE RECORD TO RELEASE IT
     C*
     C                     EXCPTCQPACE
     C*                                                                   S01117
     C** PERFORM SPF PROCESSING -                                         S01117
     C*                                                                   S01117
     C** FOR SINGLE BRANCH ENVIRONMENT, CHECK THAT USER HAS               S01117
     C** AUTHORITY TO ACTION CODE/PROGRAM                                 S01117
     C*                                                                   S01117
     C           BGMBIN    IFNE 'Y'                                       S01117
     C           @GL442    IFNE 'Y'                                       096486
     C                     CALL 'ZVACTU'                                  S01117
     C                     PARM SACTD     ZACTN   1                       S01117
     C                     PARM           ERR     10                      S01117
     C*                                                                   S01117
     C* IF USER DOES NOT HAVE AUTHORITY, SET UP ERROR CODE                S01117
     C*                                                                   S01117
     C           ERR       IFEQ 1                                         S01117
     C***********          ADD  1         X                         S01117056597
     C***********          MOVE '302'     ERC,X                     S01117056597
     C                     MOVE ' 302'    CODE                            056597
     C                     EXSR MOVERR                                    056597
     C                     SETON                     3050                 S01117
     C                     END                                            S01117
     C                     END                                            096486
     C*                                                                   S01117
     C* OTHERWISE, IN MULTIBRANCHING ENVIRONMENT,                         S01117
     C* CHECK USER IS AUTHORISED TO PERFORM ACTION CODE ON BOOKING BRANCH S01117
     C*                                                                   S01117
     C                     ELSE                                           S01117
     C           @GL442    IFNE 'Y'                                       096486
     C                     CALL 'ZVACTBU'                                 S01117
     C                     PARM SACTD     ZACTN   1                       S01117
     C                     PARM BRCA      ZBR     3                       S01117
     C                     PARM           ERR     10                      S01117
     C*                                                                   S01117
     C** USER NOT AUTHORISED TO ANY ACTION CODES FOR THIS ITEM AND BRANCH S01117
     C*                                                                   S01117
     C           ERR       IFEQ 1                                         S01117
     C***********          ADD  1         X                         S01117056597
     C***********          MOVE '303'     ERC,X                     S01117056597
     C                     MOVE ' 303'    CODE                            056597
     C                     EXSR MOVERR                                    056597
     C                     SETON                     3050                 S01117
     C                     ELSE                                           S01117
     C*                                                                   S01117
     C** USER NOT AUTHORISED TO ACTION CODE FOR THIS PARTICULAR ITEM      S01117
     C** AND BRANCH                                                       S01117
     C*                                                                   S01117
     C           ERR       IFEQ 2                                         S01117
     C***********          ADD  1         X                         S01117056597
     C***********          MOVE '304'     ERC,X                     S01117056597
     C                     MOVE ' 304'    CODE                            056597
     C                     EXSR MOVERR                                    056597
     C                     SETON                     3050                 S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C                     END                                            096486
     C*                                                                   S01117
     C*                                                                   S01117
     C** IF ORIGINATING BRANCH USER VALIDATION REQUIRED                   S01117
     C** CHECK USER HAS AUTHORITY TO ORIGINATING BRANCH                   S01117
     C*                                                                   S01117
     C           BKOBUV    IFEQ 'Y'                                       S01117
     C                     CALL 'ZVOBU'                                   S01117
     C                     PARM ORBR      ZOBRX   3                       S01117
     C                     PARM           ERR     10                      S01117
     C*                                                                   S01117
     C** USER IS NOT AUTHORISED TO ANY ORIGINATING BRANCHES               S01117
     C*                                                                   S01117
     C           ERR       IFEQ 1                                         S01117
     C***********          ADD  1         X                         S01117056597
     C***********          MOVE '305'     ERC,X                     S01117056597
     C                     MOVE ' 305'    CODE                            056597
     C                     EXSR MOVERR                                    056597
     C                     SETON                     3050                 S01117
     C                     ELSE                                           S01117
     C*                                                                   S01117
     C** USER IS NOT AUTHORISED TO THIS PARTICULAR ORIGINATING BRANCH     S01117
     C*                                                                   S01117
     C           ERR       IFEQ 2                                         S01117
     C***********          ADD  1         X                         S01117056597
     C***********          MOVE '306'     ERC,X                     S01117056597
     C                     MOVE ' 306'    CODE                            056597
     C                     EXSR MOVERR                                    056597
     C                     SETON                     3050                 S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C* END, BKOBUV IFEQ 'Y'                                              S01117
     C                     END                                            S01117
     C* END IF MULTIBRANCHING ENVIRONMENT (BGMBIN IFNE 'Y')               S01117
     C                     END                                            S01117
     C*
     C* STORING TIME,DATE AND TYPE DSCHK
     C*
     C                     Z-ADDLCHT      SLCHT
     C                     Z-ADDLCD       SLCD
     C                     MOVE LVIN      SLVIN
     C*
     C* VALIDATING SCREEN 1
     C*
     C                     EXSR VALSC1
     C*
     C           *IN30     IFEQ '1'
     C                     GOTO SCRN1
     C                     END
      *                                                                   042167
     C           *IN80     IFEQ '0'                                       042167
     C           SACTD     ANDNE'E'                                       042167
      *                                                                   042167
      * Call CL program to check for other users                          042167
      *                                                                   042167
     C                     MOVE *BLANKS   @RTCDE  7                       042167
     C                     MOVE 'FT'      @MODLE  2                       042167
     C                     MOVE SPREF     @TREF  15                       042167
     C                     MOVE *BLANKS   @RTINF 80                       042167
     C                     CALL 'AOC8000'                                 042167
     C                     PARM           @RTCDE                          042167
     C                     PARM           @MODLE                          042167
     C                     PARM           @TREF                           042167
     C                     PARM           @RTINF                          042167
      *                                                                   042167
      *  If 'IN USE' then redisplay subfile with error message            042167
      *                                                                   042167
     C           @RTCDE    IFEQ '*IN USE'                                 042167
      *        Load error message for record lock                         042167
      *                                                                   042167
     C                     MOVE ' 600'    CODE                            042167
     C                     EXSR MOVERR                                    042167
     C                     SETON                     30                   042167
     C                     GOTO SCRN1                                     042167
     C                     END                                            042167
     C                     END                                            042167
     C*
     C* IF ACTION CODE (SACTD) IS 'A' OR E' THEN THE FIELDS ARE
     C* MOVED FROM RECORD AREA ELSE BLANK SCREEN 2 FIELDS
     C*
     C           SACTD     IFEQ 'A'
     C           SACTD     OREQ 'E'
     C                     EXSR MRTOSC
     C                     ELSE
     C                     EXSR BLKSCF
     C                     END
     C*
     C           SACTD     IFEQ 'E'
     C                     SETON                     4135
     C                     ELSE
     C                     SETOF                     4135
     C                     END
     C*
     C                     SETON                     40
     C*
     C                     MOVE *BLANKS   STATUS
     C*
     C           SACTD     IFEQ 'E'
     C           RECI      IFEQ 'M'
     C                     SETON                     35
     C                     MOVEL'MATURED' STATUS
     C                     ELSE
     C           RECI      IFEQ 'C'
     C                     MOVEL'DELETED' STATUS
     C                     SETON                     35
     C                     ELSE
     C           RECI      IFEQ 'D'
     C           AUIN      ANDEQ'Y'
     C                     MOVEL'AUTHORIS'STATUS
     C                     MOVE 'ED'      STATUS
     C                     SETON                     35
     C                     END
     C                     END
     C                     END
     C                     END
     C*
     C           SCRN2     TAG
     C*
     C* DISPLAYING SCREEN 2
     C*
     C                     TIME           TIME                            S01117
     C                     WRITEFT0085F2
     C*
     C           SCRN22    TAG
     C                     READ FT0085F2                 65
     C**                                                                  S01199
     C**HELP FUNCTION                                                     S01199
     C**                                                                  S01199
     C**         *IN25     IFEQ '1'                                       S01199
     C**                   MOVELERRCDE    HERCD 160                       S01199
     C**                   MOVEL'FT0000'  HBPGM   8                       S01199
     C**                   CALL 'MHELP'                                   S01199
     C**                   PARM           HBPGM                           S01199
     C**                   PARM           HERCD                           S01199
     C**                   GOTO SCRN22                                    S01199
     C**                   END                                            S01199
     C**                                                                  S01199
     C* SETOF ERROR INDICATORS FOR SCREEN 2
     C*
     C                     SETOF                     565758
     C                     SETOF                     596061
     C                     SETOF                     306249
     C                     SETOF                     313233
     C                     SETOF                     6364
     C                     MOVEA'0000'    *IN,26
     C                     MOVE *BLANKS   ERRCDE
     C                     Z-ADD0         X       20       ARRAY INDEX
     C*
     C* F3 CHECK
     C*
     C           *IN01     IFEQ '1'
     C           *IN07     OREQ '1'                                       E29970
     C*
     C** If program 'linked' with FT0080 exit on F12
     C           *IN02     OREQ '1'
     C           WLINK     ANDEQ'Y'
     C*
     C                     GOTO ENDMN
     C                     END
     C*
     C* F12 CHECK
     C*
     C           *IN05     IFEQ '1'
     C*
     C** If program 'linked' with FT0080 exit on F12
     C           *IN80     IFEQ '1'
     C                     GOTO ENDMN
     C                     END
     C*
     C                     EXSR SCR1IN
     C                     EXSR BLKSCF
     C                     GOTO SCRN1
     C                     END
     C*
     C           SACTD     IFEQ 'E'
     C                     GOTO SCRN3
     C                     END
     C*
     C                     MOVEADRC01     DRC
     C                     MOVEADACB1     DAC
     C*
     C* VALIDATING SCREEN 2
     C*
     C                     EXSR VALSC2
     C*
     C           *IN30     IFEQ '1'
     C                     GOTO SCRN2
     C                     END
     C*
     C           SCRN3     TAG
     C*
     C* DISPLAYING SCREEN 3
     C*
     C                     TIME           TIME                            S01117
     C                     WRITEFT0085F3
     C*
     C           SCRN33    TAG
     C                     READ FT0085F3                 65
     C**                                                                  S01199
     C**HELP FUNCTION                                                     S01199
     C**                                                                  S01199
     C**         *IN25     IFEQ '1'                                       S01199
     C**                   MOVELERRCDE    HERCD 160                       S01199
     C**                   MOVEL'FT0000'  HBPGM   8                       S01199
     C**                   CALL 'MHELP'                                   S01199
     C**                   PARM           HBPGM                           S01199
     C**                   PARM           HERCD                           S01199
     C**                   GOTO SCRN33                                    S01199
     C**                   END                                            S01199
     C**                                                                  S01199
     C                     SETOF                     3033
     C                     MOVE *BLANKS   ERRCDE
     C                     Z-ADD0         X       20       ARRAY INDEX
     C*
     C* F3 CHECK
     C*
     C           *IN01     IFEQ '1'
     C           *IN07     OREQ '1'                                       E29970
     C                     GOTO ENDMN
     C                     END
     C*
     C* F12 CHECK
     C*
     C           *IN05     IFEQ '1'
     C*
     C** If program 'linked' with FT0080 exit on F12
     C           *IN80     IFEQ '1'
     C                     GOTO ENDMN
     C                     END
     C*
     C                     EXSR SCR1IN
     C                     EXSR BLKSCF
     C                     GOTO SCRN1
     C                     END
     C*
     C* F12 CHECK
     C*
     C           *IN02     IFEQ '1'
     C                     GOTO SCRN2
     C                     END
     C*
     C* VALIDATE BANK TO BANK INFORMATION IF ENTERED
     C           DBB11     IFNE *BLANKS
     C           DBB12     ORNE *BLANKS
     C           DBB13     ORNE *BLANKS
     C           DBB14     ORNE *BLANKS
     C           DBB15     ORNE *BLANKS
     C           DBB16     ORNE *BLANKS
     C*
     C                     SETOF                     919293
     C                     SETOF                     94
     C* PREVENT FIRST CHECK IN ADCHK SUBROUTINE
     C                     SETON                     95
     C*
     C                     MOVE *BLANKS   ADDRSS
     C*
     C                     MOVELDBB11     ADCHK1
     C                     MOVELDBB12     ADCHK2
     C                     MOVELDBB13     ADCHK3
     C                     MOVELDBB14     ADCHK4
     C                     MOVELDBB15     ADCHK5
     C                     MOVELDBB16     ADCHK6
     C*
     C                     EXSR ADCHK
     C*
     C** DEPENDING ON THE INDICATORS, HIGHLIGHT THE FIELD IN ERROR
     C** ERROR AND PRODUCE THE ERROR MESSAGE
     C*
     C           *IN92     IFEQ '1'
     C                     SETON                     3330
     C*********************MOVE ' 481'    CODE                            S01117
     C                     MOVE ' 027'    CODE                            S01117
     C                     EXSR MOVERR
     C                     END
     C*
     C           *IN93     IFEQ '1'
     C                     SETON                     3330
     C                     END
     C*
     C                     END
     C*
     C           *IN30     IFEQ '1'
     C                     GOTO SCRN3
     C                     END
     C*
     C* UPDATING FILE IF ACTION CODE WAS NOT 'E'
     C*
     C           SACTD     IFNE 'E'
     C                     EXSR UPDFIL
     C                     END
     C*
     C* INITIALISING ALL DISPLAY FIELDS ONLY IF RECORD WAS NOT
     C* UPDATED BY ANOTHER WORKSTATION IN THE MEANWHILE
     C*
     C           *IN62     IFEQ '0'
     C                     EXSR SCR1IN
     C                     EXSR BLKSCF
     C                     SETOF                     30
     C                     ELSE
     C                     SETOF                     4041
     C                     SETON                     30
     C                     END
     C*
     C** If program 'linked' with FT0080 return after enter on last screen
     C           *IN80     IFEQ '0'
     C                     GOTO SCRN1
     C                     END
     C*
     C           ENDMN     ENDSR
     C*
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C* MRTOSC: MOVING FIELDS FROM RECORD AREA TO SCREEN FIELDS
     C*
     C* CALLED BY : MAIN
     C*****************************************************************
     C*
     C           MRTOSC    BEGSR
     C*
     C                     MOVE *BLANKS   STATUS
     C           RECI      IFEQ 'M'                        ** B01
     C                     MOVEL'MATURED' STATUS
     C                     ELSE                            ** X01
     C           RECI      IFEQ 'C'                        ** B02
     C                     MOVEL'DELETED' STATUS
     C                     ELSE                            ** X02
     C           AUIN      IFEQ 'Y'                        ** B03
     C                     MOVEL'AUTHORIS'STATUS
     C                     MOVE 'ED'      STATUS
     C                     END                             ** E03
     C                     END                             ** E02
     C                     END                             ** E01
     C*
     C                     MOVE RCO1      DRC01
     C                     MOVE RCO2      DRC02
     C                     MOVE RCO3      DRC03
     C                     MOVE RCO4      DRC04
     C                     MOVE RCO5      DRC05
      *                                                                                       CSD015
      ** Save Previous values of Receiver's Correspondent                                     CSD015
      *                                                                                       CSD015
     C                     MOVE RCO1      PRCO1  35                                           CSD015
     C                     MOVE RCO2      PRCO2  35                                           CSD015
     C                     MOVE RCO3      PRCO3  35                                           CSD015
     C                     MOVE RCO4      PRCO4  35                                           CSD015
     C                     MOVE RCO5      PRCO5  35                                           CSD015
     C*
     C                     MOVE ACB1      DACB1
     C                     MOVE ACB2      DACB2
     C                     MOVE ACB3      DACB3
     C                     MOVE ACB4      DACB4
     C                     MOVE ACB5      DACB5
      *                                                                                       CSD015
      ** Save Previous values of account with bank                                            CSD015
      *                                                                                       CSD015
     C                     MOVE ACB1      PACB1  35                                           CSD015
     C                     MOVE ACB2      PACB2  35                                           CSD015
     C                     MOVE ACB3      PACB3  35                                           CSD015
     C                     MOVE ACB4      PACB4  35                                           CSD015
     C                     MOVE ACB5      PACB5  35                                           CSD015
     C*
     C                     MOVE DAA1      DDAA1
     C                     MOVE DAA2      DDAA2
     C                     MOVE DAA3      DDAA3
     C                     MOVE DAA4      DDAA4
     C                     MOVE DAA5      DDAA5
     C                     MOVE DAA6      DDAA6
     C*
     C                     MOVE DCH1      DDCH1
     C                     MOVE DCH2      DDCH2
     C                     MOVE DCH3      DDCH3
     C                     MOVE DCH4      DDCH4
     C                     MOVE DCH5      DDCH5
     C                     MOVE DCH6      DDCH6
     C*
     C                     MOVE RBKR      DRBKR
     C*
     C                     MOVE BBI1      DBB11
     C                     MOVE BBI2      DBB12
     C                     MOVE BBI3      DBB13
     C                     MOVE BBI4      DBB14
     C                     MOVE BBI5      DBB15
     C                     MOVE BBI6      DBB16
     C*
     C                     ENDSR
     C*
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C* BLKSCF: BLANKING ALL SCREEN FIELDS AS THE MODE IS INSERT
     C*
     C* CALLED BY : MAIN
     C*****************************************************************
     C*
     C           BLKSCF    BEGSR
     C*
     C                     MOVE *BLANKS   DRC01
     C                     MOVE *BLANKS   DRC02
     C                     MOVE *BLANKS   DRC03
     C                     MOVE *BLANKS   DRC04
     C                     MOVE *BLANKS   DRC05
     C*
     C                     MOVE *BLANKS   DACB1
     C                     MOVE *BLANKS   DACB2
     C                     MOVE *BLANKS   DACB3
     C                     MOVE *BLANKS   DACB4
     C                     MOVE *BLANKS   DACB5
     C*
     C                     MOVE *BLANKS   DDAA1
     C                     MOVE *BLANKS   DDAA2
     C                     MOVE *BLANKS   DDAA3
     C                     MOVE *BLANKS   DDAA4
     C                     MOVE *BLANKS   DDAA5
     C                     MOVE *BLANKS   DDAA6
     C*
     C                     MOVE *BLANKS   DDCH1
     C                     MOVE *BLANKS   DDCH2
     C                     MOVE *BLANKS   DDCH3
     C                     MOVE *BLANKS   DDCH4
     C                     MOVE *BLANKS   DDCH5
     C                     MOVE *BLANKS   DDCH6
     C*
     C                     MOVE *BLANKS   DRBKR
     C*
     C                     MOVE *BLANKS   DBB11
     C                     MOVE *BLANKS   DBB12
     C                     MOVE *BLANKS   DBB13
     C                     MOVE *BLANKS   DBB14
     C                     MOVE *BLANKS   DBB15
     C                     MOVE *BLANKS   DBB16
     C*
     C                     ENDSR
     C*
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C* SCR1IN: INITIALISE SCREEN 1 FIELDS
     C*
     C* CALLED BY : MAIN
     C*****************************************************************
     C*
     C           SCR1IN    BEGSR
     C*
     C                     MOVE *BLANKS   SACTD
     C                     MOVE *BLANKS   SPREF
     C*
     C* SETOF PROTECT INDICATORS
     C                     SETOF                     4041
     C*
     C                     ENDSR
     C*
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C* VALSC1: VALIDATING SCREEN 1 FIELDS
     C*
     C* CALLED BY : MAIN
     C* CALLS ROUTINE: MOVERR
     C*****************************************************************
     C*
     C           VALSC1    BEGSR
     C*
     C* VALIDATING IF ACTION CODE IS 'I' THEN LEVEL 2 INPUT IND.
     C* CANNOT BE 'Y'
     C*
     C           SACTD     IFEQ 'I'
     C           LVIN      ANDEQ'Y'
     C*********************MOVE ' 289'    CODE    4                       S01117
     C                     MOVE ' 004'    CODE    4                       S01117
     C                     EXSR MOVERR
     C                     SETON                     3054
     C                     END
     C* VALIDATING IF ACTION CODE IS 'A' THEN LEVEL 2 INPUT IND.
     C* MUST BE 'Y'
     C*
     C           SACTD     IFEQ 'A'
     C           LVIN      ANDNE'Y'
     C*********************MOVE ' 407'    CODE    4                       S01117
     C                     MOVE ' 008'    CODE    4                       S01117
     C                     EXSR MOVERR
     C                     SETON                     30
     C                     END
     C*
     C* VALIDATING FOR MATURITY IF ACTION CODE IS 'I' OR 'A'
     C*
     C           SACTD     IFEQ 'A'
     C           SACTD     OREQ 'I'
     C           RECI      IFEQ 'C'
     C           RECI      OREQ 'M'
     C*********************MOVE ' 290'    CODE    4                       S01117
     C                     MOVE ' 005'    CODE    4                       S01117
     C                     EXSR MOVERR
     C                     SETON                     3053
     C                     END
     C                     END
     C*
     C* VALIDATING FOR AUTHORITY IF ACTION CODE IS 'I' OR 'A'
     C*
     C           SACTD     IFEQ 'A'
     C           SACTD     OREQ 'I'
     C           AUIN      IFEQ 'Y'
     C*********************MOVE ' 291'    CODE    4                       S01117
     C                     MOVE ' 006'    CODE    4                       S01117
     C                     EXSR MOVERR
     C                     SETON                     3055
     C                     END
     C                     END
     C*
     C                     ENDSR
     C*
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C* MOVERR: MOVING ERROR CODES
     C*
     C**CALLED*BY*:*MAIN***
     C* CALLED BY : MAIN     ADCHK
     C*             VALSC1
     C*             VALSC2
     C*****************************************************************
     C*
     C           MOVERR    BEGSR
     C*
     C                     Z-ADD1         X
     C*
     C           X         DOWLE18
     C*
     C           X         IFEQ 18
     C                     MOVE CODE      ERC,X
     C                     END
     C*
     C           ERC,X     IFEQ *BLANK
     C                     MOVE CODE      ERC,X
     C                     Z-ADD19        X
     C                     END
     C*
     C                     ADD  1         X
     C*
     C                     END
     C*
     C                     ENDSR
     C*
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C* VALSC2: VALIDATING SCREEN 2 FIELDS
     C*
     C* CALLED BY : MAIN
     C* CALLS ROUTINES: MOVERR  SWIFT
     C*****************************************************************
     C*
     C           VALSC2    BEGSR
     C*
     C* SETTING TYPE OF RECCEIVER'S CORRESPONDENCE AND TYPE OF
     C* ACCOUNT WITH BANK SWITCHES TO ZER0
     C                     MOVE '0'       RSWT    1
     C                     MOVE '0'       ASWT    1
     C* VALIDATE REMMITTING BANK COMPULSORY
     C           DRBKR     IFEQ *BLANK
     C*********************MOVE ' 402'    CODE                            S01117
     C                     MOVE ' 026'    CODE                            S01117
     C                     EXSR MOVERR
     C                     SETON                     3049
     C                     END
     C* VALIDATING RECEIVERS CORRESPONDENCE IS OPTIONAL
     C*
     C           DRC01     IFEQ *BLANK
     C           DRC02     ANDEQ*BLANK
     C           DRC03     ANDEQ*BLANK
     C           DRC04     ANDEQ*BLANK
     C           DRC05     ANDEQ*BLANK
     C                     MOVE '2'       RSWT                            E29854
     C                     GOTO ENDTG1
     C                     END
     C*                                                                   S01194
     C** LOOKUP FOR ? IN DRC01 - IF ? FOUND, THEN FIELD IS IN ERROR       S01194
     C*                                                                   S01194
     C                     SETOF                     10                   S01194
     C                     MOVEA*BLANKS   QUERY                           S01194
     C                     MOVEADRC01     QUERY                           S01194
     C           '?'       LOKUPQUERY                    10               S01194
     C*                                                                   S01194
     C           *IN10     IFEQ '1'                                       S01194
     C                     SETON                     5830                 S01194
     C                     MOVE ' 016'    CODE                            S01194
     C                     EXSR MOVERR                                    S01194
     C                     GOTO ENDTG1                                    S01194
     C                     END                                            S01194
     C*
     C* VALIDATING RECEIVERS CORRESPONDENT FOR VALID CUSTOMER NUMBER      S01194
     C* OR FOR VALID CUSTOMER SHORTNAME BY CALLING 'AOCUSTR0'             S01194
     C*                                                                   S01194
     C** IF THERE ARE ONLY CHARACTERS WITHIN FIRST 10 CHARACTERS          S01194
     C** VALIDATE IT AS CUSTOMER NUMBER/SHORTNAME                         S01194
     C** OTHERWISE VALIDATE IT AS A SWIFT ADDRESS                         S01194
     C*                                                                   S01194
     C           RLST25    IFNE *BLANK                                    S01194
     C           DR2TO5    ORNE *BLANK                                    S01194
     C                     GOTO SWVAL1                                    S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C** CALL ACCESS PROGRAM TO RETRIEVE CUSTOMER DETAILS                 S01194
     C*                                                                   S01194
     C                     CALL 'AOCUSTR0'                                S01194
     C                     PARM *BLANKS   @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM RFST10    @KEY1  10                       S01194
     C                     PARM *BLANK    @KYST   7                       S01194
     C           SDCUST    PARM SDCUST    DSSDY                           S01194
     C*                                                                   S01194
     C           @RTCD     IFEQ *BLANK                                    S01194
     C           BBCSID    IFNE *BLANK                                    S01194
     C                     MOVELBBCSID    DRC01                           S01194
     C                     MOVE '1'       RSWT                            S01194
     C                     ELSE                                           S01194
     C                     MOVELBBCNA1    DRC01                           S01194
     C                     MOVELBBCNA2    DRC02                           S01194
     C                     MOVELBBCNA3    DRC03                           S01194
     C                     MOVELBBCNA4    DRC04                           S01194
     C                     MOVE *BLANKS   DRC05                           S01194
     C                     END                                            S01194
     C                     GOTO ENDTG1                                    S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C*********************MOVE *BLANKS   CNUM                            S01194
     C*********************MOVE *BLANKS   LINE29 29                       S01194
     C*********************MOVELDRC01     CNUM                            S01194
     C*********************MOVE DRC01     LINE29                          S01194
     C*********************                                               S01194
     C*********************Z-ADD*ZEROS    NU                              S01194
     C*********************Z-ADDCNUM      NU                              S01194
     C***********1*********DO   6         Y       10                      S01194
     C***********NU,Y******LOKUPNUMB                     77               S01194
     C************IN77*****CABEQ'0'       NEXT                            S01194
     C*********************END                                            S01194
     C*********************                                               S01194
     C***********LINE29****IFEQ *BLANK                                    S01194
     C***********DRC02*****ANDEQ*BLANKS                                   S01194
     C***********DRC03     ANDEQ*BLANKS                                   S01194
     C***********DRC04*****ANDEQ*BLANKS                                   S01194
     C***********DRC05*****ANDEQ*BLANKS                                   S01194
     C*********************MOVELCNUM      KCNUM                           S01194
     C*********************MOVE 'A'       KKEY                            S01194
     C*********************                                               S01194
     C***********KCUSNO****CHAINCLINT                12                   S01194
     C************IN12*****IFEQ '1'                                    )))S01194
     C*********************GOTO NEXT                                      S01194
     C*********************ELSE                                           S01194
     C*********************                                               S01194
     C***********CSID******IFNE *BLANKS                                   S01194
     C*********************MOVELCSID      DRC01                           S01194
     C*********************MOVE *BLANKS   DRC02                           S01194
     C*********************MOVE *BLANKS   DRC03                           S01194
     C*********************MOVE *BLANKS   DRC04                           S01194
     C*********************MOVE *BLANKS   DRC05                           S01194
     C*********************                                               S01194
     C*********************ELSE                                           S01194
     C*********************                                               S01194
     C*********************MOVELCNUM      KCNUM                           S01194
     C*********************MOVE 'B'       KKEY                            S01194
     C*********************                                               S01194
     C***********KCUSNO****CHAINCLINT                13                   S01194
     C*********************                                               S01194
     C************IN13*****IFEQ '0'                                       S01194
     C*********************MOVELCNA1      DRC01                           S01194
     C*********************MOVELCNA2      DRC02                           S01194
     C*********************MOVELCNA3      DRC03                           S01194
     C*********************MOVELCNA4      DRC04                           S01194
     C*********************MOVE *BLANKS   DRC05                           S01194
     C*********************END                                            S01194
     C*********************                                               S01194
     C*********************END                                         )))S01194
     C*********************                                               S01194
     C*********************END                                         )))S01194
     C*********************                                               S01194
     C************IN12*****IFEQ '0'                                       S01194
     C*********************GOTO ENDTG1                                    S01194
     C*********************END                                            S01194
     C*********************                                               S01194
     C*********************END                                         )))S01194
     C*********************                                               S01194
     C**VALIDATING*RECEIVERS*CORRESPONDENT*FOR*CUSTOMER*SHORTNAME*******  S01194
     C***********NEXT******TAG                                            S01194
     C*********************MOVE *BLANKS   SHNEX  10                       S01194
     C*********************MOVE *BLANKS   LINE25 25                       S01194
     C*********************MOVE *BLANKS   CNUM                            S01194
     C*********************MOVE *BLANKS   CSID                            S01194
     C*********************MOVE *BLANKS   CNA1                            S01194
     C*********************MOVE *BLANKS   CNA2                            S01194
     C*********************MOVE *BLANKS   CNA3                            S01194
     C*********************MOVE *BLANKS   CNA4                            S01194
     C*********************MOVELDRC01     SHNEX                           S01194
     C*********************MOVE DRC01     LINE25                          S01194
     C***********LINE25****IFEQ *BLANK                                    S01194
     C***********DRC02*****ANDEQ*BLANKS                                   S01194
     C***********DRC03*****ANDEQ*BLANKS                                   S01194
     C***********DRC04*****ANDEQ*BLANKS                                   S01194
     C***********DRC05*****ANDEQ*BLANKS                                   S01194
     C*********************                                               S01194
     C***********SHNEX*****CHAINSNAME                14                   S01194
     C************IN14*****IFEQ '1'                                    )))S01194
     C*********************GOTO SWVAL1                                    S01194
     C*********************END                                            S01194
     C*********************                                               S01194
     C*********************MOVELCNUM      KCNUM                           S01194
     C*********************MOVE 'A'       KKEY                            S01194
     C*********************                                               S01194
     C***********KCUSNO****CHAINCLINT                15                   S01194
     C*********************                                               S01194
     C***********CSID******IFNE *BLANKS                                   S01194
     C*********************MOVELCSID      DRC01                           S01194
     C*********************MOVE *BLANKS   DRC02                           S01194
     C*********************MOVE *BLANKS   DRC03                           S01194
     C*********************MOVE *BLANKS   DRC04                           S01194
     C*********************MOVE *BLANKS   DRC05                           S01194
     C*********************                                               S01194
     C*********************ELSE                                           S01194
     C*********************                                               S01194
     C*********************MOVE CNUM      KCNUM                           S01194
     C*********************MOVE 'B'       KKEY                            S01194
     C*********************                                               S01194
     C***********KCUSNO****CHAINCLINT                16                   S01194
     C*********************                                               S01194
     C************IN16*****IFEQ '0'                                       S01194
     C*********************MOVELCNA1      DRC01                           S01194
     C*********************MOVELCNA2      DRC02                           S01194
     C*********************MOVELCNA3      DRC03                           S01194
     C*********************MOVELCNA4      DRC04                           S01194
     C*********************MOVE *BLANKS   DRC05                           S01194
     C*********************END                                            S01194
     C*********************                                               S01194
     C*********************END                                         )))S01194
     C*********************                                               S01194
     C************IN14*****IFEQ '0'                                       S01194
     C*********************GOTO ENDTG1                                    S01194
     C*********************END                                            S01194
     C*********************                                               S01194
     C*********************END                                         )))S01194
     C*
     C* VALIDATING RECEIVERS CORRESPONDENT FOR VALID SWIFT ADDRESS
     C*
     C           SWVAL1    TAG
     C**   IF SWIFT, CHECK THAT IT DOES NOT EXCEED 12 CHARACTERS
     C*
     C                     MOVE *BLANKS   WKFL23 23
     C           DRC01     IFNE *BLANKS
     C           DRC02     ANDEQ*BLANKS
     C           DRC03     ANDEQ*BLANKS
     C           DRC04     ANDEQ*BLANKS
     C           DRC05     ANDEQ*BLANKS
     C*
     C                     MOVE DRC01     WKFL23
     C*
     C** IF MORE THAN TWELVE CHARACTERS, VALIDATE AS AN ADDRESS
     C*
     C           WKFL23    IFEQ *BLANKS
     C*
     C**   CHECK THAT CONTAINS ONLY VALID SWIFT CHARACTERS.
     C**   I.E.  A-Z OR 0-9 OR BLANK.
     C*
     C                     MOVE *BLANKS   SW
     C                     MOVEADRC01     SW
     C*
     C                     EXSR SWIFT
     C*
     C**         SWIFT ADDRESS NOT ON FILE
     C*
     C           *IN71     IFEQ '0'
     C           *IN75     ANDEQ'1'
     C                     SETON                     26
     C                     END
     C*
     C**         INVALID SWIFT CHARACTERS
     C*
     C           *IN75     IFEQ '0'
     C*********************MOVE '293'     CODE                            S01117
     C                     MOVE '009'     CODE                            S01117
     C                     EXSR MOVERR
     C                     SETON                     3057
     C                     END
     C*
     C           *IN57     IFEQ '0'
     C                     MOVE '1'       RSWT
     C                     END
     C                     END
     C                     END
     C*
     C* IF MORE THAN ONE FIELD ENTERED OR IF FIRST FIELD NOT SWIFT,
     C* OR FIRST CHARACTER ON FIRST LINE '/', VALIDATE AS ADDRESS
     C*
     C                     MOVELDRC01     RECTAG  1
     C*
     C           RECTAG    IFEQ '/'
     C           WKFL23    ORNE *BLANKS
     C           DRC02     ORNE *BLANK
     C           DRC03     ORNE *BLANK
     C           DRC04     ORNE *BLANK
     C           DRC05     ORNE *BLANK
     C*
     C                     SETOF                     919293
     C                     SETOF                     949563
     C*
     C                     MOVE *BLANKS   ADDRSS
     C*
     C                     MOVELDRC01     ADCHK1
     C                     MOVELDRC02     ADCHK2
     C                     MOVELDRC03     ADCHK3
     C                     MOVELDRC04     ADCHK4
     C                     MOVELDRC05     ADCHK5
     C                     MOVE *BLANKS   ADCHK6
     C*
     C                     EXSR ADCHK
     C*
     C** DEPENDING ON THE INDICATORS, HIGHLIGHT THE FIELD IN ERROR
     C** ERROR AND PRODUCE THE ERROR MESSAGE
     C*
     C           *IN91     IFEQ '1'
     C                     SETON                     5630
     C*********************MOVE ' 475'    CODE                            S01117
     C                     MOVE ' 018'    CODE                            S01117
     C                     EXSR MOVERR
     C                     END
     C*
     C           *IN92     IFEQ '1'
     C                     SETON                     566330
     C*********************MOVE ' 474'    CODE                            S01117
     C                     MOVE ' 017'    CODE                            S01117
     C                     EXSR MOVERR
     C                     END
     C*
     C           *IN93     IFEQ '1'
     C                     SETON                     566330
     C                     END
     C*
     C                     END
     C*
     C           ENDTG1    TAG
     C*                                                                   S01194
     C** LOOKUP FOR ? IN DACB1 (FIRST FIELD OF A/C WITH BANK)             S01194
     C*                                                                   S01194
     C********** SNCO      IFEQ 0                                                      136230 CSD027
     C           SNCO      IFEQ *BLANK                                                        CSD027
     C           DACB1     ANDNE*BLANK                                    136230
     C           DRC01     OREQ *BLANK                                    136230
     C           DACB1     ANDNE*BLANK                                    136230
     C                     SETON                     6130                 136230
     C                     MOVE ' 028'    CODE                            136230
     C                     EXSR MOVERR                                    136230
     C                     GOTO ENDTG2                                    136230
     C                     END                                            136230
      *
     C                     SETOF                     10                   S01194
     C                     MOVEA*BLANKS   QUERY                           S01194
     C                     MOVEADACB1     QUERY                           S01194
     C           '?'       LOKUPQUERY                    10               S01194
     C*                                                                   S01194
     C           *IN10     IFEQ '1'                                       S01194
     C                     SETON                     6130                 S01194
     C                     MOVE ' 021'    CODE                            S01194
     C                     EXSR MOVERR                                    S01194
     C                     GOTO ENDTG2                                    S01194
     C                     END                                            S01194
     C*
     C* A/C WITH BANK PROHIBITED IF SETTLEMENT TYPE IS 12 OR 13
     C*
     C           STMT      IFEQ 12
     C           STMT      OREQ 13
     C           DACB1     IFNE *BLANKS
     C           DACB2     ORNE *BLANKS
     C           DACB3     ORNE *BLANKS
     C           DACB4     ORNE *BLANKS
     C           DACB5     ORNE *BLANKS
     C*********************MOVE ' 343'    CODE                            S01117
     C                     MOVE ' 020'    CODE                            S01117
     C                     EXSR MOVERR
     C                     SETON                     3059
     C                     GOTO ENDTG2
     C                     END
     C                     END
     C*
     C           STMT      IFEQ 12
     C           STMT      OREQ 13
     C           DACB1     IFEQ *BLANKS
     C           DACB2     OREQ *BLANKS
     C           DACB3     OREQ *BLANKS
     C           DACB4     OREQ *BLANKS
     C           DACB5     OREQ *BLANKS
     C                     MOVE '2'       ASWT                            E29854
     C                     GOTO ENDTG2
     C                     END
     C                     END
     C*
     C           *IN59     IFEQ '0'
     C*
     C* VALIDATING ACCOUNT WITH BANK FOR VALID CUSTOMER NUMBER
     C* AND CUSTOMER SHORTNAME FROM CALL TO 'AOCUSTR0'                    S01194
     C*                                                                   S01194
     C** IF THERE ARE ONLY CHARACTERS WITHIN FIRST 10 CHARACTERS          S01194
     C** VALIDATE IT AS CUSTOMER NUMBER/SHORTNAME                         S01194
     C** OTHERWISE VALIDATE IT AS A SWIFT ADDRESS                         S01194
     C*                                                                   S01194
     C           DLST25    IFNE *BLANK                                    S01194
     C           DA2TO5    ORNE *BLANK                                    S01194
     C                     GOTO SWVAL2                                    S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C** CALL ACCESS PROGRAM TO OBTAIN CUSTOMER DETAILS                   S01194
     C*                                                                   S01194
     C                     CALL 'AOCUSTR0'                                S01194
     C                     PARM *BLANKS   @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM DFST10    @KEY1  10                       S01194
     C                     PARM *BLANK    @KYST   7                       S01194
     C           SDCUST    PARM SDCUST    DSSDY                           S01194
     C*                                                                   S01194
     C           @RTCD     IFEQ *BLANK                                    S01194
     C*                                                                   S01194
     C           BBCSID    IFNE *BLANK                                    S01194
     C                     MOVELBBCSID    DACB1                           S01194
     C                     MOVE '1'       ASWT                            S01194
     C                     ELSE                                           S01194
     C                     MOVELBBCNA1    DACB1                           S01194
     C                     MOVELBBCNA2    DACB2                           S01194
     C                     MOVELBBCNA3    DACB3                           S01194
     C                     MOVELBBCNA4    DACB4                           S01194
     C                     MOVE *BLANKS   DACB5                           S01194
     C                     END                                            S01194
     C                     GOTO ENDTG2                                    S01194
     C*                                                                   S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C*********************MOVE *BLANKS   CNUM                            S01194
     C*********************MOVE *BLANKS   CSID                            S01194
     C*********************MOVE *BLANKS   CNA1                            S01194
     C*********************MOVE *BLANKS   CNA2                            S01194
     C*********************MOVE *BLANKS   CNA3                            S01194
     C*********************MOVE *BLANKS   CNA4                            S01194
     C*********************MOVE *BLANKS   MINE29 29                       S01194
     C*********************MOVELDACB1     CNUM                            S01194
     C*********************MOVE DACB1     MINE29                          S01194
     C*********************                                               S01194
     C*********************Z-ADD*ZEROS    NU                              S01194
     C*********************Z-ADDCNUM      NU                              S01194
     C***********1*********DO   6         Y       10                      S01194
     C***********NU,Y******LOKUPNUMB                     77               S01194
     C************IN77*****CABEQ'0'       NEXT2                           S01194
     C*********************END                                            S01194
     C*********************                                               S01194
     C***********MINE29****IFEQ *BLANK                                    S01194
     C***********DACB2*****ANDEQ*BLANKS                                   S01194
     C***********DACB3*****ANDEQ*BLANKS                                   S01194
     C***********DACB4*****ANDEQ*BLANKS                                   S01194
     C***********DACB5*****ANDEQ*BLANKS                                   S01194
     C*********************MOVELCNUM      KCNUM                           S01194
     C*********************MOVE 'A'       KKEY                            S01194
     C*********************                                               S01194
     C***********KCUSNO****CHAINCLINT                17                   S01194
     C************IN17*****IFEQ '1'                                       S01194
     C*********************GOTO NEXT2                                     S01194
     C*********************ELSE                                           S01194
     C*********************                                               S01194
     C***********CSID******IFNE *BLANKS                                   S01194
     C*********************MOVELCSID      DACB1                           S01194
     C*********************MOVE *BLANKS   DACB2                           S01194
     C*********************MOVE *BLANKS   DACB3                           S01194
     C*********************MOVE *BLANKS   DACB4                           S01194
     C*********************MOVE *BLANKS   DACB5                           S01194
     C*********************                                               S01194
     C*********************ELSE                                           S01194
     C*********************                                               S01194
     C*********************MOVE CNUM      KCNUM                           S01194
     C*********************MOVE 'B'       KKEY                            S01194
     C*********************                                               S01194
     C***********KCUSNO****CHAINCLINT                18                   S01194
     C*********************                                               S01194
     C************IN18*****IFEQ '0'                                       S01194
     C*********************MOVELCNA1      DACB1                           S01194
     C*********************MOVELCNA2      DACB2                           S01194
     C*********************MOVELCNA3      DACB3                           S01194
     C*********************MOVELCNA4      DACB4                           S01194
     C*********************MOVE *BLANKS   DACB5                           S01194
     C*********************END                                            S01194
     C*********************END                                         )))S01194
     C*********************END                                         )))S01194
     C*********************                                               S01194
     C************IN17*****IFEQ '0'                                       S01194
     C*********************GOTO ENDTG2                                    S01194
     C*********************END                                            S01194
     C*********************                                               S01194
     C*********************END                                         )))S01194
     C*********************                                               S01194
     C**VALIDATING*ACCOUNT*WITH*BANK*FOR*CUSTOMER*SHORTNAME********       S01194
     C***********NEXT2*****TAG                                            S01194
     C*********************                                               S01194
     C*********************MOVE *BLANKS   SHNEX  10                       S01194
     C*********************MOVE *BLANKS   MINE25 25                       S01194
     C*********************MOVE *BLANKS   CNUM                            S01194
     C*********************MOVE *BLANKS   CSID                            S01194
     C*********************MOVE *BLANKS   CNA1                            S01194
     C*********************MOVE *BLANKS   CNA2                            S01194
     C*********************MOVE *BLANKS   CNA3                            S01194
     C*********************MOVE *BLANKS   CNA4                            S01194
     C*********************MOVELDACB1     SHNEX                           S01194
     C*********************MOVE DACB1     MINE25                          S01194
     C***********MINE25****IFEQ *BLANK                                    S01194
     C***********DACB2*****ANDEQ*BLANKS                                   S01194
     C***********DACB3*****ANDEQ*BLANKS                                   S01194
     C***********DACB4*****ANDEQ*BLANKS                                   S01194
     C***********DACB5*****ANDEQ*BLANKS                                   S01194
     C*********************                                               S01194
     C***********SHNEX*****CHAINSNAME                19                   S01194
     C************IN19*****IFEQ '1'                                       S01194
     C*********************GOTO SWVAL2                                    S01194
     C*********************END                                            S01194
     C*********************                                               S01194
     C*********************MOVELCNUM      KCNUM                           S01194
     C*********************MOVE 'A'       KKEY                            S01194
     C*********************                                               S01194
     C***********KCUSNO****CHAINCLINT                20                   S01194
     C*********************                                               S01194
     C***********CSID******IFNE *BLANKS                                   S01194
     C*********************MOVELCSID      DACB1                           S01194
     C*********************MOVE *BLANKS   DACB2                           S01194
     C*********************MOVE *BLANKS   DACB3                           S01194
     C*********************MOVE *BLANKS   DACB4                           S01194
     C*********************MOVE *BLANKS   DACB5                           S01194
     C*********************                                               S01194
     C*********************ELSE                                           S01194
     C*********************                                               S01194
     C*********************MOVE CNUM      KCNUM                           S01194
     C*********************MOVE 'B'       KKEY                            S01194
     C*********************                                               S01194
     C***********KCUSNO****CHAINCLINT                21                   S01194
     C*********************                                               S01194
     C************IN21*****IFEQ '0'                                       S01194
     C*********************MOVELCNA1      DACB1                           S01194
     C*********************MOVELCNA2      DACB2                           S01194
     C*********************MOVELCNA3      DACB3                           S01194
     C*********************MOVELCNA4      DACB4                           S01194
     C*********************MOVE *BLANKS   DACB5                           S01194
     C*********************END                                         )))S01194
     C*********************                                               S01194
     C*********************END                                         )))S01194
     C*********************                                               S01194
     C************IN19*****IFEQ '0'                                       S01194
     C*********************GOTO ENDTG2                                    S01194
     C*********************END                                            S01194
     C*********************                                               S01194
     C*********************END                                            S01194
     C*
     C* VALIDATING ACCOUNT WITH BANK FOR VALID SWIFT ADDRESS
     C*
     C           SWVAL2    TAG
     C*
     C* VALIDATE ACCOUNT WITH BANK VALID SWIFT
     C*
     C           DACB1     IFNE *BLANKS
     C           DACB2     ANDEQ*BLANKS
     C           DACB3     ANDEQ*BLANKS
     C           DACB4     ANDEQ*BLANKS
     C           DACB5     ANDEQ*BLANKS
     C*                    MOVE DACB1     WKFL23
     C                     MOVE *BLANKS   WKFL23
     C                     MOVE DACB1     WKFL23
     C*
     C** IF MORE THAN TWELVE CHARACTERS, VALIDATE AS AN ADDRESS
     C*
     C                     MOVELDACB1     SWADX  12
     C*
     C           WKFL23    IFEQ *BLANKS
     C*
     C**   CHECK THAT CONTAINS ONLY VALID SWIFT CHARACTERS.
     C**   I.E.  A-Z OR 0-9 OR BLANK.
     C*
     C                     MOVE *BLANKS   SW
     C                     MOVEADACB1     SW
     C*
     C                     EXSR SWIFT
     C*
     C**         SWIFT ADDRESS NOT ON FILE
     C*
     C           *IN71     IFEQ '0'
     C           *IN75     ANDEQ'1'
     C*********************MOVE '0'       ASWT
     C                     SETON                     28
     C                     END
     C*
     C**         INVALID SWIFT CHARACTERS
     C*
     C           *IN75     IFEQ '0'
     C*********************MOVE '171'     CODE                            S01117
     C                     MOVE '019'     CODE                            S01117
     C                     EXSR MOVERR
     C                     SETON                     3060
     C                     END
     C*
     C*********************END                                            038125
     C*
     C           *IN60     IFEQ '0'
     C                     MOVE '1'       ASWT
     C                     END
     C*                                                                   038125
     C                     END                                            038125
     C*
     C                     END
     C*                                                                   E29854
     C* IF ACCOUNT WITH BANK BLANK AT THIS POINT SET TYPE FOR = BLANK     E29854
     C*                                                                   E29854
     C           DACB1     IFEQ *BLANK                                    E29854
     C           DACB2     ANDEQ*BLANK                                    E29854
     C           DACB3     ANDEQ*BLANK                                    E29854
     C           DACB4     ANDEQ*BLANK                                    E29854
     C           DACB5     ANDEQ*BLANK                                    E29854
     C                     MOVE '2'       ASWT                            E29854
     C                     END                                            E29854
     C*
     C* IF MORE THAN ONE FIELD ENTERED OR NOT SWIFT FORMAT
     C* OR FIRST CHARACTER '/', VALIDATE AS AN ADDRESS
     C*
     C                     MOVELDACB1     ACCTAG  1
     C*
     C           ACCTAG    IFEQ '/'
     C           WKFL23    ORNE *BLANKS
     C           DACB2     ORNE *BLANK
     C           DACB3     ORNE *BLANK
     C           DACB4     ORNE *BLANK
     C           DACB5     ORNE *BLANK
     C*
     C                     SETOF                     919293
     C                     SETOF                     949564
     C*
     C                     MOVE *BLANKS   ADDRSS
     C*
     C                     MOVELDACB1     ADCHK1
     C                     MOVELDACB2     ADCHK2
     C                     MOVELDACB3     ADCHK3
     C                     MOVELDACB4     ADCHK4
     C                     MOVELDACB5     ADCHK5
     C                     MOVE *BLANKS   ADCHK6
     C*
     C                     EXSR ADCHK
     C*
     C** DEPENDING ON THE INDICATORS, HIGHLIGHT THE FIELD IN ERROR
     C** ERROR AND PRODUCE THE ERROR MESSAGE
     C*
     C           *IN91     IFEQ '1'
     C                     SETON                     5930
     C*********************MOVE ' 477'    CODE                            S01117
     C                     MOVE ' 023'    CODE                            S01117
     C                     EXSR MOVERR
     C                     END
     C*
     C           *IN92     IFEQ '1'
     C                     SETON                     596430
     C*********************MOVE ' 476'    CODE                            S01117
     C                     MOVE ' 022'    CODE                            S01117
     C                     EXSR MOVERR
     C                     END
     C*
     C           *IN93     IFEQ '1'
     C                     SETON                     596430
     C                     END
     C*
     C                     END
     C                     END
     C*
     C           ENDTG2    TAG
     C* VALIDATE DETAILS OF AMOUNTS ADDED
     C           DDAA1     IFNE *BLANKS
     C           DDAA2     ORNE *BLANKS
     C           DDAA3     ORNE *BLANKS
     C           DDAA4     ORNE *BLANKS
     C           DDAA5     ORNE *BLANKS
     C           DDAA6     ORNE *BLANKS
     C*
     C                     SETOF                     919293
     C                     SETOF                     94
     C* PREVENT FIRST CHECK IN ADCHK SUBROUTINE
     C                     SETON                     95
     C*
     C                     MOVE *BLANKS   ADDRSS
     C*
     C                     MOVELDDAA1     ADCHK1
     C                     MOVELDDAA2     ADCHK2
     C                     MOVELDDAA3     ADCHK3
     C                     MOVELDDAA4     ADCHK4
     C                     MOVELDDAA5     ADCHK5
     C                     MOVELDDAA6     ADCHK6
     C*
     C                     EXSR ADCHK
     C*
     C** DEPENDING ON THE INDICATORS, HIGHLIGHT THE FIELD IN ERROR
     C** ERROR AND PRODUCE THE ERROR MESSAGE
     C*
     C           *IN92     IFEQ '1'
     C                     SETON                     3130
     C*********************MOVE ' 492'    CODE                            S01117
     C                     MOVE ' 025'    CODE                            S01117
     C                     EXSR MOVERR
     C                     END
     C*
     C           *IN93     IFEQ '1'
     C                     SETON                     3130
     C                     END
     C*
     C                     END
     C*
     C* VALIDATE DETAILS OF CHARGES
     C           DDCH1     IFNE *BLANKS
     C           DDCH2     ORNE *BLANKS
     C           DDCH3     ORNE *BLANKS
     C           DDCH4     ORNE *BLANKS
     C           DDCH5     ORNE *BLANKS
     C           DDCH6     ORNE *BLANKS
     C*
     C                     SETOF                     919293
     C                     SETOF                     94
     C* PREVENT FIRST CHECK IN ADCHK SUBROUTINE
     C                     SETON                     95
     C*
     C                     MOVE *BLANKS   ADDRSS
     C*
     C                     MOVELDDCH1     ADCHK1
     C                     MOVELDDCH2     ADCHK2
     C                     MOVELDDCH3     ADCHK3
     C                     MOVELDDCH4     ADCHK4
     C                     MOVELDDCH5     ADCHK5
     C                     MOVELDDCH6     ADCHK6
     C*
     C                     EXSR ADCHK
     C*
     C** DEPENDING ON THE INDICATORS, HIGHLIGHT THE FIELD IN ERROR
     C** ERROR AND PRODUCE THE ERROR MESSAGE
     C*
     C           *IN92     IFEQ '1'
     C                     SETON                     3230
     C*********************MOVE ' 493'    CODE                            S01117
     C                     MOVE ' 024'    CODE                            S01117
     C                     EXSR MOVERR
     C                     END
     C*
     C           *IN93     IFEQ '1'
     C                     SETON                     3230
     C                     END
     C*
     C                     END
     C*
     C** CHECK FOR SWIFT ADDRESS WARNING MESSAGES. IF ENTER IS PRESSED
     C** TWICE, AND THE FIELDS ENTERED HAVE NOT CHANGED, ALLOW INPUT.
     C** (ONLY SHOW WARNING MESSAGES IF REST OF INPUT IS OK)
     C*
     C           *IN30     IFEQ '0'
     C* REC CORR
     C           *IN26     IFEQ '1'
     C* IF NOT FIRST TIME THROUGH WITH THIS SCREEN FIELD, ALLOW ENTRY
     C           DRC01     IFEQ RECORS
     C                     SETOF                     2756
     C                     ELSE
     C                     MOVELDRC01     RECORS 35
     C*********************MOVE ' W03'    CODE                            S01117
     C                     MOVE ' W01'    CODE                            S01117
     C                     EXSR MOVERR
     C                     SETON                     2756
     C                     END
     C                     END
     C* ACC W BK
     C           *IN28     IFEQ '1'
     C* IF NOT FIRST TIME THROUGH WITH THIS SCREEN FIELD, ALLOW ENTRY
     C           DACB1     IFEQ ACCWBK
     C                     SETOF                     2959
     C                     ELSE
     C                     MOVELDACB1     ACCWBK 35
     C*********************MOVE ' W04'    CODE                            S01117
     C                     MOVE ' W02'    CODE                            S01117
     C                     EXSR MOVERR
     C                     SETON                     2959
     C                     END
     C                     END
     C*
     C                     END
     C*
     C** IF ANY WARNING ERRORS, DISPLAY THEM ON SCREEN
     C*
     C           *IN27     IFEQ '1'
     C           *IN29     OREQ '1'
     C                     SETON                     30
     C                     END
     C*
     C                     ENDSR
     C*
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C* UPDFIL: UPDATING FILE
     C*
     C* CALLED BY : MAIN
     C* CALLS ROUTINE: CMTCTL
     C*                MSTORC
     C*                SRTYPE
     C*****************************************************************
     C*
     C           UPDFIL    BEGSR
     C*
     C           CQPACK    CHAINCQPAC                62
     C*
     C* MOVING TIME,DATE AND LEVEL 2 INDICATOR FOR CHECKING
     C*
     C           *IN62     IFEQ '0'
     C                     Z-ADDLCHT      SLCHT1
     C                     Z-ADDLCD       SLCD1
     C                     MOVE LVIN      SLVIN1
     C                     END
     C*
     C* IF ACTION CODE WAS 'A' OR 'I' AND THE RECORD NOW DOES NOT EXIST
     C* THEN IT HAS BEEN DELETED BY ANOTHER WORKSTATION
     C*
     C           *IN62     IFEQ '1'
     C           SACTD     ANDEQ'A'
     C           SACTD     OREQ 'I'
     C           *IN62     ANDEQ'1'
     C*********************MOVE '068'     ERC,1                           S01117
     C                     MOVE '001'     ERC,1                           S01117
     C                     GOTO ENDUPD
     C                     END
     C*
     C* IF ACT.CODE WAS 'I' OR'A' AND THE RECORD WAS FOUND THEN COMPARE
     C* LAST CHANGE TIME,DATE AND LEVEL 2 INDICATOR WITH STORED
     C**CONTENTS.*IF*NO*CHANGE*THEN*UPDATE*ELSE*ERROR*'068'*              S01117
     C* CONTENTS. IF NO CHANGE THEN UPDATE ELSE ERROR '001'               S01117
     C*
     C           *IN62     IFEQ '0'
     C           SACTD     ANDEQ'I'
     C           SACTD     OREQ 'A'
     C           *IN62     ANDEQ'0'
     C           CMP1      IFNE CMPS
     C                     SETON                     62
     C*********************MOVE '068'     ERC,1                           S01117
     C                     MOVE '001'     ERC,1                           S01117
     C                     EXCPTCQPACE
     C                     GOTO ENDUPD
     C                     END
     C                     END
     C*
     C* RESET AUTH. USERS/INDICATOR IN CASE PARTIAL AUTH. HAS OCCURED
     C*
     C                     MOVE *BLANKS   AUP1
     C                     MOVE *BLANKS   AUP2
     C                     MOVE *BLANKS   AUIN
     C* IF ACTION CODE WAS 'I' AND LEVEL 2 IND IS 'Y' THEN INSERT
     C*
     C           *IN62     IFEQ '0'
     C           SACTD     ANDEQ'I'
     C           LVIN      ANDEQ' '
     C                     MOVE 'I'       CHTP
     C                     EXSR MSTORC
     C                     EXSR SRTYPE
     C                     TIME           STIME2  60
     C*
     C**********           MOVE USRID     INUSR1 10                       E36921
     C                     MOVE USRID     INUSR2 10                       E36921
      *                                                                                       CSD015
     C           W1EWLC    IFEQ 'Y'                                                           CSD015
      *                                                                                       CSD015
     C           CSC011    IFNE 'Y'                                                           CSD015
     C           LIBR      OREQ S1MAIN                                                        CSD015
      *                                                                                       CSD015
      ** Determine if transaction has Unconfirmed Flag = 'Y'                                  CSD015
      *                                                                                       CSD015
     C                     MOVEL'CQPACDD' KFUNCC                                              CSD015
     C                     MOVELPREF      KIDENT                                              CSD015
     C                     MOVELBRCA      KBRNCH                                              CSD015
      *                                                                                       CSD015
     C           KLCWHT    CHAINSDCWHTL1             03                                       CSD015
      *                                                                                       CSD015
     C           *IN03     IFEQ *OFF                                                          CSD015
     C           W3UNCF    ANDEQ'Y'                                                           CSD015
      *                                                                                       CSD015
      ** If transaction has Unconfirmed Flag = 'Y', include                                   CSD015
      ** all watch list fields for recheck.                                                   CSD015
      *                                                                                       CSD015
     C                     MOVE *BLANKS   POUT1                                               CSD015
     C                     MOVE *BLANKS   POUT2                                               CSD015
     C                     MOVE *BLANKS   PSTRNG                                              CSD015
      *                                                                                       CSD015
      ** Remitting Bank                                                                       CSD015
      *                                                                                       CSD015
     C           RBK1      IFNE *BLANKS                                                       CSD015
     C                     EXSR SRCLRP                                                        CSD015
     C                     MOVELRBK1      PINP1                                               CSD015
     C                     MOVELRBK2      PINP2                                               CSD015
     C                     MOVELRBK3      PINP3                                               CSD015
     C                     MOVELRBK4      PINP4                                               CSD015
     C                     EXSR SRCONV                                                        CSD015
     C           POUT2     IFEQ '*FREE'                                                       CSD015
     C           POUT2     OREQ '*CPART'                                                      CSD015
     C                     MOVEL'Y'       WRBFF   1                                           CSD015
     C                     ELSE                                                               CSD015
     C                     MOVEL'N'       WRBFF                                               CSD015
     C                     MOVELPOUT2     WRBCP   6                                           CSD015
     C                     ENDIF                                                              CSD015
     C                     Z-ADD1         WX                                                  CSD015
     C                     Z-ADD2         WY                                                  CSD015
     C                     EXSR SRFMT                                                         CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      ** Sender's Correspondence                                                              CSD015
      *                                                                                       CSD015
     C********** SNCO      IFNE *ZEROS                                                 CSD015 CSD027
     C           SNCO      IFNE *BLANK                                                        CSD027
     C                     EXSR SRCLRP                                                        CSD015
     C           SNCT      IFEQ 'N'                                                           CSD015
     C                     MOVELSNCO      FLD2    2                                           CSD015
     C                     MOVELFLD2      PINP1                                               CSD015
     C                     ELSE                                                               CSD015
     C                     MOVELSNCO      PINP1                                               CSD015
     C                     ENDIF                                                              CSD015
     C                     MOVELPCCY      PCYCD                                               CSD015
     C                     EXSR SRCONV                                                        CSD015
     C                     MOVELPOUT2     WSCCP   6                                           CSD015
     C                     Z-ADD3         WX                                                  CSD015
     C                     Z-ADD4         WY                                                  CSD015
     C                     EXSR SRFMT                                                         CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      ** Receiver's Correspondent                                                             CSD015
      *                                                                                       CSD015
     C           RCO1      IFNE *BLANKS                                                       CSD015
     C                     EXSR SRCLRP                                                        CSD015
     C                     MOVELRCO1      PINP1                                               CSD015
     C                     MOVELRCO2      PINP2                                               CSD015
     C                     MOVELRCO3      PINP3                                               CSD015
     C                     MOVELRCO4      PINP4                                               CSD015
     C                     MOVELRCO5      PINP5                                               CSD015
     C                     EXSR SRCONV                                                        CSD015
     C                     Z-ADD5         WX                                                  CSD015
     C                     Z-ADD6         WY                                                  CSD015
     C                     EXSR SRFMT                                                         CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      ** Account with Bank                                                                    CSD015
      *                                                                                       CSD015
     C           ACB1      IFNE *BLANKS                                                       CSD015
     C                     EXSR SRCLRP                                                        CSD015
     C                     MOVELACB1      PINP1                                               CSD015
     C                     MOVELACB2      PINP2                                               CSD015
     C                     MOVELACB3      PINP3                                               CSD015
     C                     MOVELACB4      PINP4                                               CSD015
     C                     MOVELACB5      PINP5                                               CSD015
     C                     EXSR SRCONV                                                        CSD015
     C                     Z-ADD7         WX                                                  CSD015
     C                     Z-ADD8         WY                                                  CSD015
     C                     EXSR SRFMT                                                         CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PSTRNG    IFNE *BLANKS                                                       CSD015
     C                     EXSR SRWTCH                                                        CSD015
     C                     EXSR SRENGN                                                        CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      ** Include checking of previously inserted detail transactions                          CSD015
      *                                                                                       CSD015
     C           PREF      SETLLCQPADDL1                 04                                   CSD015
     C           PREF      READECQPADDL1                 04                                   CSD015
     C           *IN04     DOWEQ*OFF                                                          CSD015
      *                                                                                       CSD015
     C                     MOVE *BLANKS   POUT1                                               CSD015
     C                     MOVE *BLANKS   POUT2                                               CSD015
     C                     MOVE *BLANKS   PSTRNG                                              CSD015
      *                                                                                       CSD015
      ** Debit Party                                                                          CSD015
      *                                                                                       CSD015
     C***********WCDRPY    IFNE *ZEROS                                                 CSD015 CSD027
     C           WCDRPY    IFNE *BLANKS                                                       CSD027
     C                     EXSR SRCLRP                                                        CSD015
     C           WCDRPT    IFEQ 'N'                                                           CSD015
     C                     MOVELWCDRPY    FLD2                                                CSD015
     C                     MOVELFLD2      PINP1                                               CSD015
     C                     ELSE                                                               CSD015
     C                     MOVELWCDRPY    PINP1                                               CSD015
     C                     ENDIF                                                              CSD015
     C                     MOVELWCDRCY    PCYCD                                               CSD015
     C                     EXSR SRCONV                                                        CSD015
     C                     Z-ADD9         WX                                                  CSD015
     C                     Z-ADD10        WY                                                  CSD015
     C                     EXSR SRFMT                                                         CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      ** Charges to the Debit of account                                                      CSD015
      *                                                                                       CSD015
     C***********WCCDRO    IFNE *ZEROS                                                 CSD015 CSD027
     C           WCCDRO    IFNE *BLANKS                                                       CSD027
     C                     EXSR SRCLRP                                                        CSD015
     C           WCCDRT    IFEQ 'N'                                                           CSD015
     C                     MOVELWCCDRO    FLD2                                                CSD015
     C                     MOVELFLD2      PINP1                                               CSD015
     C                     ELSE                                                               CSD015
     C                     MOVELWCCDRO    PINP1                                               CSD015
     C                     ENDIF                                                              CSD015
     C                     MOVELBJCYCD    PCYCD                                               CSD015
     C                     EXSR SRCONV                                                        CSD015
     C                     Z-ADD11        WX                                                  CSD015
     C                     Z-ADD12        WY                                                  CSD015
     C                     EXSR SRFMT                                                         CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PSTRNG    IFNE *BLANKS                                                       CSD015
     C                     EXSR SRENGN                                                        CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PREF      READECQPADDL1                 04                                   CSD015
     C                     ENDDO                                                              CSD015
      *                                                                                       CSD015
     C                     ELSE                                                               CSD015
      *                                                                                       CSD015
      ** Proceed to insert the second level header                                            CSD015
      *                                                                                       CSD015
     C                     MOVE *BLANKS   POUT1                                               CSD015
     C                     MOVE *BLANKS   POUT2                                               CSD015
      *                                                                                       CSD015
      ** Get Details of Counterparties                                                        CSD015
      *                                                                                       CSD015
     C           RBK1      IFNE *BLANKS                                                       CSD015
     C                     EXSR SRCLRP                                                        CSD015
     C                     MOVELRBK1      PINP1                                               CSD015
     C                     MOVELRBK2      PINP2                                               CSD015
     C                     MOVELRBK3      PINP3                                               CSD015
     C                     MOVELRBK4      PINP4                                               CSD015
     C                     EXSR SRCONV                                                        CSD015
     C           POUT2     IFEQ '*FREE'                                                       CSD015
     C           POUT2     OREQ '*CPART'                                                      CSD015
     C                     MOVEL'Y'       WRBFF   1                                           CSD015
     C                     ELSE                                                               CSD015
     C                     MOVEL'N'       WRBFF                                               CSD015
     C                     MOVELPOUT2     WRBCP   6                                           CSD015
     C                     ENDIF                                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      ** Sender's Correspondence                                                              CSD015
      *                                                                                       CSD015
     C********** SNCO      IFNE *ZEROS                                                 CSD015 CSD027
     C           SNCO      IFNE *BLANK                                                        CSD027
     C                     EXSR SRCLRP                                                        CSD015
     C           SNCT      IFEQ 'N'                                                           CSD015
     C                     MOVELSNCO      FLD2    2                                           CSD015
     C                     MOVELFLD2      PINP1                                               CSD015
     C                     ELSE                                                               CSD015
     C                     MOVELSNCO      PINP1                                               CSD015
     C                     ENDIF                                                              CSD015
     C                     MOVELPCCY      PCYCD                                               CSD015
     C                     EXSR SRCONV                                                        CSD015
     C                     MOVELPOUT2     WSCCP   6                                           CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      ** Format 2nd Parameter                                                                 CSD015
      *                                                                                       CSD015
     C                     MOVE *BLANKS   POUT1                                               CSD015
     C                     MOVE *BLANKS   POUT2                                               CSD015
     C                     MOVE *BLANKS   PSTRNG                                              CSD015
      *                                                                                       CSD015
     C           RCO1      IFNE *BLANKS                                                       CSD015
     C                     EXSR SRCLRP                                                        CSD015
     C                     MOVELRCO1      PINP1                                               CSD015
     C                     MOVELRCO2      PINP2                                               CSD015
     C                     MOVELRCO3      PINP3                                               CSD015
     C                     MOVELRCO4      PINP4                                               CSD015
     C                     MOVELRCO5      PINP5                                               CSD015
     C                     EXSR SRCONV                                                        CSD015
     C                     Z-ADD5         WX      20                                          CSD015
     C                     Z-ADD6         WY      20                                          CSD015
     C                     EXSR SRFMT                                                         CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           ACB1      IFNE *BLANKS                                                       CSD015
     C                     EXSR SRCLRP                                                        CSD015
     C                     MOVELACB1      PINP1                                               CSD015
     C                     MOVELACB2      PINP2                                               CSD015
     C                     MOVELACB3      PINP3                                               CSD015
     C                     MOVELACB4      PINP4                                               CSD015
     C                     MOVELACB5      PINP5                                               CSD015
     C                     EXSR SRCONV                                                        CSD015
     C                     Z-ADD7         WX      20                                          CSD015
     C                     Z-ADD8         WY      20                                          CSD015
     C                     EXSR SRFMT                                                         CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PSTRNG    IFNE *BLANKS                                                       CSD015
     C                     EXSR SRWTCH                                                        CSD015
     C                     EXSR SRENGN                                                        CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C                     ENDIF                                                              CSD015
     C                     ENDIF                                                              CSD015
     C                     ENDIF                                                              CSD015
     C*
     C                     UPDATCQPACDDF
     C                     EXSR CMTCTL
     C                     GOTO ENDUPD
     C                     END
     C*
     C* UPDATING FILE
     C*
     C                     MOVE 'A'       CHTP
     C                     EXSR MSTORC
     C                     EXSR SRTYPE
     C                     TIME           STIME2  60
     C*
     C**********           MOVE USRID     INUSR1 10                       E36921
     C                     MOVE USRID     INUSR2                          E36921
      *                                                                                       CSD015
     C           W1EWLC    IFEQ 'Y'                                                           CSD015
      *                                                                                       CSD015
     C           CSC011    IFNE 'Y'                                                           CSD015
     C           LIBR      OREQ S1MAIN                                                        CSD015
      *                                                                                       CSD015
      ** Determine if transaction has Unconfirmed Flag = 'Y'                                  CSD015
      *                                                                                       CSD015
     C                     MOVEL'CQPACDD' KFUNCC                                              CSD015
     C                     MOVELPREF      KIDENT                                              CSD015
     C                     MOVELBRCA      KBRNCH                                              CSD015
      *                                                                                       CSD015
     C           KLCWHT    CHAINSDCWHTL1             03                                       CSD015
      *                                                                                       CSD015
     C           *IN03     IFEQ *OFF                                                          CSD015
     C           W3UNCF    ANDEQ'Y'                                                           CSD015
      *                                                                                       CSD015
      ** If transaction has Unconfirmed Flag = 'Y', include                                   CSD015
      ** all watch list fields for recheck.                                                   CSD015
      *                                                                                       CSD015
     C                     MOVE *BLANKS   POUT1                                               CSD015
     C                     MOVE *BLANKS   POUT2                                               CSD015
     C                     MOVE *BLANKS   PSTRNG                                              CSD015
      *                                                                                       CSD015
      ** Remitting Bank                                                                       CSD015
      *                                                                                       CSD015
     C           RBK1      IFNE *BLANKS                                                       CSD015
     C                     EXSR SRCLRP                                                        CSD015
     C                     MOVELRBK1      PINP1                                               CSD015
     C                     MOVELRBK2      PINP2                                               CSD015
     C                     MOVELRBK3      PINP3                                               CSD015
     C                     MOVELRBK4      PINP4                                               CSD015
     C                     EXSR SRCONV                                                        CSD015
     C           POUT2     IFEQ '*FREE'                                                       CSD015
     C           POUT2     OREQ '*CPART'                                                      CSD015
     C                     MOVEL'Y'       WRBFF   1                                           CSD015
     C                     ELSE                                                               CSD015
     C                     MOVEL'N'       WRBFF                                               CSD015
     C                     MOVELPOUT2     WRBCP   6                                           CSD015
     C                     ENDIF                                                              CSD015
     C                     Z-ADD1         WX                                                  CSD015
     C                     Z-ADD2         WY                                                  CSD015
     C                     EXSR SRFMT                                                         CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      ** Sender's Correspondence                                                              CSD015
      *                                                                                       CSD015
     C********** SNCO      IFNE *ZEROS                                                 CSD015 CSD027
     C           SNCO      IFNE *BLANK                                                        CSD027
     C                     EXSR SRCLRP                                                        CSD015
     C           SNCT      IFEQ 'N'                                                           CSD015
     C                     MOVELSNCO      FLD2    2                                           CSD015
     C                     MOVELFLD2      PINP1                                               CSD015
     C                     ELSE                                                               CSD015
     C                     MOVELSNCO      PINP1                                               CSD015
     C                     ENDIF                                                              CSD015
     C                     MOVELPCCY      PCYCD                                               CSD015
     C                     EXSR SRCONV                                                        CSD015
     C                     MOVELPOUT2     WSCCP   6                                           CSD015
     C                     Z-ADD3         WX                                                  CSD015
     C                     Z-ADD4         WY                                                  CSD015
     C                     EXSR SRFMT                                                         CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      ** Receiver's Correspondent                                                             CSD015
      *                                                                                       CSD015
     C           RCO1      IFNE *BLANKS                                                       CSD015
     C                     EXSR SRCLRP                                                        CSD015
     C                     MOVELRCO1      PINP1                                               CSD015
     C                     MOVELRCO2      PINP2                                               CSD015
     C                     MOVELRCO3      PINP3                                               CSD015
     C                     MOVELRCO4      PINP4                                               CSD015
     C                     MOVELRCO5      PINP5                                               CSD015
     C                     EXSR SRCONV                                                        CSD015
     C                     Z-ADD5         WX                                                  CSD015
     C                     Z-ADD6         WY                                                  CSD015
     C                     EXSR SRFMT                                                         CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      ** Account with Bank                                                                    CSD015
      *                                                                                       CSD015
     C           ACB1      IFNE *BLANKS                                                       CSD015
     C                     EXSR SRCLRP                                                        CSD015
     C                     MOVELACB1      PINP1                                               CSD015
     C                     MOVELACB2      PINP2                                               CSD015
     C                     MOVELACB3      PINP3                                               CSD015
     C                     MOVELACB4      PINP4                                               CSD015
     C                     MOVELACB5      PINP5                                               CSD015
     C                     EXSR SRCONV                                                        CSD015
     C                     Z-ADD7         WX                                                  CSD015
     C                     Z-ADD8         WY                                                  CSD015
     C                     EXSR SRFMT                                                         CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PSTRNG    IFNE *BLANKS                                                       CSD015
     C                     EXSR SRWTCH                                                        CSD015
     C                     EXSR SRENGN                                                        CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      ** Include checking of previously inserted detail transactions                          CSD015
      *                                                                                       CSD015
     C           PREF      SETLLCQPADDL1                 04                                   CSD015
     C           PREF      READECQPADDL1                 04                                   CSD015
     C           *IN04     DOWEQ*OFF                                                          CSD015
      *                                                                                       CSD015
     C                     MOVE *BLANKS   POUT1                                               CSD015
     C                     MOVE *BLANKS   POUT2                                               CSD015
     C                     MOVE *BLANKS   PSTRNG                                              CSD015
      *                                                                                       CSD015
      ** Debit Party                                                                          CSD015
      *                                                                                       CSD015
     C***********WCDRPY    IFNE *ZEROS                                                 CSD015 CSD027
     C           WCDRPY    IFNE *BLANKS                                                       CSD027
     C                     EXSR SRCLRP                                                        CSD015
     C           WCDRPT    IFEQ 'N'                                                           CSD015
     C                     MOVELWCDRPY    FLD2                                                CSD015
     C                     MOVELFLD2      PINP1                                               CSD015
     C                     ELSE                                                               CSD015
     C                     MOVELWCDRPY    PINP1                                               CSD015
     C                     ENDIF                                                              CSD015
     C                     MOVELWCDRCY    PCYCD                                               CSD015
     C                     EXSR SRCONV                                                        CSD015
     C                     Z-ADD9         WX                                                  CSD015
     C                     Z-ADD10        WY                                                  CSD015
     C                     EXSR SRFMT                                                         CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      ** Charges to the Debit of account                                                      CSD015
      *                                                                                       CSD015
     C***********WCCDRO    IFNE *ZEROS                                                 CSD015 CSD027
     C           WCCDRO    IFNE *BLANKS                                                       CSD027
     C                     EXSR SRCLRP                                                        CSD015
     C           WCCDRT    IFEQ 'N'                                                           CSD015
     C                     MOVELWCCDRO    FLD2                                                CSD015
     C                     MOVELFLD2      PINP1                                               CSD015
     C                     ELSE                                                               CSD015
     C                     MOVELWCCDRO    PINP1                                               CSD015
     C                     ENDIF                                                              CSD015
     C                     MOVELBJCYCD    PCYCD                                               CSD015
     C                     EXSR SRCONV                                                        CSD015
     C                     Z-ADD11        WX                                                  CSD015
     C                     Z-ADD12        WY                                                  CSD015
     C                     EXSR SRFMT                                                         CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PSTRNG    IFNE *BLANKS                                                       CSD015
     C                     EXSR SRENGN                                                        CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PREF      READECQPADDL1                 04                                   CSD015
     C                     ENDDO                                                              CSD015
      *                                                                                       CSD015
     C                     ELSE                                                               CSD015
      *                                                                                       CSD015
      ** Only check those amended watch list fields                                           CSD015
      *                                                                                       CSD015
     C                     MOVE *BLANKS   POUT1                                               CSD015
     C                     MOVE *BLANKS   POUT2                                               CSD015
      *                                                                                       CSD015
      ** Get Details of Counterparties                                                        CSD015
      *                                                                                       CSD015
     C           RBK1      IFNE *BLANKS                                                       CSD015
     C                     EXSR SRCLRP                                                        CSD015
     C                     MOVELRBK1      PINP1                                               CSD015
     C                     MOVELRBK2      PINP2                                               CSD015
     C                     MOVELRBK3      PINP3                                               CSD015
     C                     MOVELRBK4      PINP4                                               CSD015
     C                     EXSR SRCONV                                                        CSD015
     C           POUT2     IFEQ '*FREE'                                                       CSD015
     C           POUT2     OREQ '*CPART'                                                      CSD015
     C                     MOVEL'Y'       WRBFF   1                                           CSD015
     C                     ELSE                                                               CSD015
     C                     MOVEL'N'       WRBFF                                               CSD015
     C                     MOVELPOUT2     WRBCP   6                                           CSD015
     C                     ENDIF                                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      ** Sender's Correspondence                                                              CSD015
      *                                                                                       CSD015
     C********** SNCO      IFNE *ZEROS                                                 CSD015 CSD027
     C           SNCO      IFNE *BLANK                                                        CSD027
     C                     EXSR SRCLRP                                                        CSD015
     C           SNCT      IFEQ 'N'                                                           CSD015
     C                     MOVELSNCO      FLD2    2                                           CSD015
     C                     MOVELFLD2      PINP1                                               CSD015
     C                     ELSE                                                               CSD015
     C                     MOVELSNCO      PINP1                                               CSD015
     C                     ENDIF                                                              CSD015
     C                     MOVELPCCY      PCYCD                                               CSD015
     C                     EXSR SRCONV                                                        CSD015
     C                     MOVELPOUT2     WSCCP   6                                           CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      ** Format 2nd Parameter                                                                 CSD015
      *                                                                                       CSD015
     C                     MOVE *BLANKS   POUT1                                               CSD015
     C                     MOVE *BLANKS   POUT2                                               CSD015
     C                     MOVE *BLANKS   PSTRNG                                              CSD015
      *                                                                                       CSD015
     C           RCO1      IFNE PRCO1                                                         CSD015
     C           RCO1      ANDNE*BLANKS                                                       CSD015
     C           RCO2      ORNE PRCO2                                                         CSD015
     C           RCO2      ANDNE*BLANKS                                                       CSD015
     C           RCO3      ORNE PRCO3                                                         CSD015
     C           RCO3      ANDNE*BLANKS                                                       CSD015
     C           RCO4      ORNE PRCO4                                                         CSD015
     C           RCO4      ANDNE*BLANKS                                                       CSD015
     C           RCO5      ORNE PRCO5                                                         CSD015
     C           RCO5      ANDNE*BLANKS                                                       CSD015
     C                     EXSR SRCLRP                                                        CSD015
     C                     MOVELRCO1      PINP1                                               CSD015
     C                     MOVELRCO2      PINP2                                               CSD015
     C                     MOVELRCO3      PINP3                                               CSD015
     C                     MOVELRCO4      PINP4                                               CSD015
     C                     MOVELRCO5      PINP5                                               CSD015
     C                     EXSR SRCONV                                                        CSD015
     C                     Z-ADD5         WX                                                  CSD015
     C                     Z-ADD6         WY                                                  CSD015
     C                     EXSR SRFMT                                                         CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           ACB1      IFNE PACB1                                                         CSD015
     C           ACB1      ANDNE*BLANKS                                                       CSD015
     C           ACB2      ORNE PACB2                                                         CSD015
     C           ACB2      ANDNE*BLANKS                                                       CSD015
     C           ACB3      ORNE PACB3                                                         CSD015
     C           ACB3      ANDNE*BLANKS                                                       CSD015
     C           ACB4      ORNE PACB4                                                         CSD015
     C           ACB4      ANDNE*BLANKS                                                       CSD015
     C           ACB5      ORNE PACB5                                                         CSD015
     C           ACB5      ANDNE*BLANKS                                                       CSD015
     C                     EXSR SRCLRP                                                        CSD015
     C                     MOVELACB1      PINP1                                               CSD015
     C                     MOVELACB2      PINP2                                               CSD015
     C                     MOVELACB3      PINP3                                               CSD015
     C                     MOVELACB4      PINP4                                               CSD015
     C                     MOVELACB5      PINP5                                               CSD015
     C                     EXSR SRCONV                                                        CSD015
     C                     Z-ADD7         WX                                                  CSD015
     C                     Z-ADD8         WY                                                  CSD015
     C                     EXSR SRFMT                                                         CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PSTRNG    IFNE *BLANKS                                                       CSD015
     C                     EXSR SRWTCH                                                        CSD015
     C                     EXSR SRENGN                                                        CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C                     ENDIF                                                              CSD015
     C                     ENDIF                                                              CSD015
     C                     ENDIF                                                              CSD015
     C*
     C                     UPDATCQPACDDF
     C                     EXSR CMTCTL
     C*
     C           ENDUPD    ENDSR
     C*
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C* SRTYPE       : MOVEMENT IF ADDRESS OR SWIFT
     C*
     C* CALLED BY    : UPDFIL
     C*****************************************************************
     C*
     C           SRTYPE    BEGSR
     C*
     C           RSWT      IFEQ '1'                        ** B002
     C                     MOVE 'S'       RCRT
     C                     ELSE                            ** X002
     C           RSWT      IFEQ '0'                        ** B003        E29854
     C                     MOVE 'A'       RCRT
     C                     ELSE                            ** X003        E29854
     C                     MOVE ' '       RCRT                            E29854
     C                     END                             ** E003        E29854
     C                     END                             ** E002
     C*
     C           ASWT      IFEQ '1'                        ** B002
     C                     MOVE 'S'       ACBT
     C                     ELSE                            ** X002
     C           ASWT      IFEQ '0'                        ** B003        E29854
     C                     MOVE 'A'       ACBT
     C                     ELSE                            ** X003        E29854
     C                     MOVE ' '       ACBT                            E29854
     C                     END                             ** E003        E29854
     C                     END                             ** E002
     C*
     C                     ENDSR
     C*
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C* MSTORC: MOVING FIELDS FROM SCREEN AREA TO RECORD AREA
     C*
     C* CALLED BY : UPDFIL
     C*****************************************************************
     C*
     C           MSTORC    BEGSR
     C*
     C                     MOVE DRC01     RCO1
     C                     MOVE DRC02     RCO2
     C                     MOVE DRC03     RCO3
     C                     MOVE DRC04     RCO4
     C                     MOVE DRC05     RCO5
     C*
     C                     MOVE DACB1     ACB1
     C                     MOVE DACB2     ACB2
     C                     MOVE DACB3     ACB3
     C                     MOVE DACB4     ACB4
     C                     MOVE DACB5     ACB5
     C*
     C                     MOVE DDAA1     DAA1
     C                     MOVE DDAA2     DAA2
     C                     MOVE DDAA3     DAA3
     C                     MOVE DDAA4     DAA4
     C                     MOVE DDAA5     DAA5
     C                     MOVE DDAA6     DAA6
     C*
     C                     MOVE DDCH1     DCH1
     C                     MOVE DDCH2     DCH2
     C                     MOVE DDCH3     DCH3
     C                     MOVE DDCH4     DCH4
     C                     MOVE DDCH5     DCH5
     C                     MOVE DDCH6     DCH6
     C*
     C                     MOVE DRBKR     RBKR
     C*
     C                     MOVE DBB11     BBI1
     C                     MOVE DBB12     BBI2
     C                     MOVE DBB13     BBI3
     C                     MOVE DBB14     BBI4
     C                     MOVE DBB15     BBI5
     C                     MOVE DBB16     BBI6
     C*
     C                     Z-ADDSTIME     LCHT
     C*********************Z-ADDRUND      LCD                             S01194
     C                     Z-ADDBJRDNB    LCD                             S01194
     C                     MOVE 'Y'       LVIN
     C*
     C                     ENDSR
     C*
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C* CMTCTL: COMMIT CONTROL ROUTINE
     C*
     C* CALLED BY : UPDFIL
     C*****************************************************************
     C*
     C           CMTCTL    BEGSR
     C*
     C                     MOVE STIME2    TIMEXD
     C                     MOVE SACTD     ACTDD
     C*
     C           CMTXTD    COMIT
     C*
     C                     ENDSR
     C*
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C* TERM  : TERMINATION ROUTINE
     C*
     C* CALLS ROUTINE : INFSR
     C*****************************************************************
     C*
     C           TERM      BEGSR
     C*
     C           *INU7     IFEQ '1'
     C                     EXSR INFSR
     C                     END
     C*
     C**  Setup return parameter (FK) if linked to FT0080.
     C      01             MOVE '1'       PCMD
     C      02             MOVE '2'       PCMD
     C      05             MOVE '5'       PCMD
     C      07             MOVE '7'       PCMD                            E29970
      *                                                                   042167
      * Call CL program to de-allocate - if not called from FT0080        042167
      *                                                                   042167
     C           *IN80     IFEQ '0'                                       042167
     C                     MOVE *BLANKS   @RTCDE                          042167
     C                     MOVE 'FT'      @MODLE                          042167
     C                     MOVE *BLANKS   @TREF                           042167
     C                     MOVE *BLANKS   @RTINF                          042167
     C                     CALL 'AOC8000'                                 042167
     C                     PARM           @RTCDE                          042167
     C                     PARM           @MODLE                          042167
     C                     PARM           @TREF                           042167
     C                     PARM           @RTINF                          042167
     C                     END                                            042167
     C*
     C                     SETON                     LR
     C                     RETRN
     C*
     C                     ENDSR
     C*
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C* INFSR : FILE INFORMATION SUBROUTINE
     C*
     C* CALLED BY : TERM
     C*             USED BY CPF IN CASE OF FILE STATUS ERRORS
     C*****************************************************************
     C*
     C           INFSR     BEGSR
     C*
     C           *NAMVAR   DEFN LDA       DLDA
     C           *LOCK     IN   DLDA
     C                     MOVEL'FT0085'  DBPGM
     C                     MOVELWDBFIL    DBFILE
     C                     MOVELWDBKEY    DBKEY
     C                     MOVELWDBASE    DBASE
     C                     OUT  DLDA
     C                     DUMP
     C*
     C                     ENDSR
     C*
     C*****************************************************************
    C/EJECT
     C*****************************************************************
     C*
     C*  ADCHK SUBROUTINE - TO VALIDATE ADDRESS FIELDS
     C*
     C*****************************************************************
     C*
     C           ADCHK     BEGSR
     C*
     C* IF IT IS AN ADDRESS, THERE MUST BE MORE THAN ONE LINE AND
     C* THE FIRST CHARACTER SHOULD BE A '/'
     C* (BUT ONLY DO THE CHECK IF NOT A NARRATIVE. I.E. *IN95 = 0)
     C*
     C           *IN95     IFEQ '0'
     C                     MOVE 'N'       TGFLG   1
     C                     MOVELADCHK1    ADDTG1  1
     C           ADDTG1    IFEQ '/'
     C           ADCHK2    ANDEQ*BLANKS
     C                     MOVE 'Y'       TGFLG
     C                     END
     C           ADDTG1    IFNE '/'
     C           ADCHK5    ANDNE*BLANKS
     C                     MOVE 'Y'       TGFLG
     C                     END
     C           TGFLG     IFEQ 'Y'
     C                     SETON                     91
     C                     END
     C                     END
     C*
     C* THERE SHOULD BE NO EMBEDDED SPACES
     C*
     C           ADCHK1    IFEQ *BLANK
     C           ADCHK2    ANDNE*BLANK
     C*
     C           ADCHK1    OREQ *BLANK
     C           ADCHK3    ANDNE*BLANK
     C*
     C           ADCHK1    OREQ *BLANK
     C           ADCHK4    ANDNE*BLANK
     C*
     C           ADCHK1    OREQ *BLANK
     C           ADCHK5    ANDNE*BLANK
     C*
     C           ADCHK1    OREQ *BLANK
     C           ADCHK6    ANDNE*BLANK
     C*
     C           ADCHK2    OREQ *BLANK
     C           ADCHK3    ANDNE*BLANK
     C*
     C           ADCHK2    OREQ *BLANK
     C           ADCHK4    ANDNE*BLANK
     C*
     C           ADCHK2    OREQ *BLANK
     C           ADCHK5    ANDNE*BLANK
     C*
     C           ADCHK2    OREQ *BLANK
     C           ADCHK6    ANDNE*BLANK
     C*
     C           ADCHK3    OREQ *BLANK
     C           ADCHK4    ANDNE*BLANK
     C*
     C           ADCHK3    OREQ *BLANK
     C           ADCHK5    ANDNE*BLANK
     C*
     C           ADCHK3    OREQ *BLANK
     C           ADCHK6    ANDNE*BLANK
     C*
     C           ADCHK4    OREQ *BLANK
     C           ADCHK5    ANDNE*BLANK
     C*
     C           ADCHK4    OREQ *BLANK
     C           ADCHK6    ANDNE*BLANK
     C*
     C           ADCHK5    OREQ *BLANK
     C           ADCHK6    ANDNE*BLANK
     C*
     C                     SETON                     92
     C*
     C                     END
     C*
     C** CHECK FOR NON-VALID SWIFT CHARACTERS
     C*
     C           ADCHK1    IFNE *BLANKS
     C                     MOVEA*BLANKS   #FLD
     C                     MOVE ADCHK1    #FLD
     C                     EXSR SWSET
     C           *IN94     IFEQ '0'
     C*********************MOVE ' 500'    CODE                            S01117
     C                     MOVE ' 010'    CODE                            S01117
     C                     EXSR MOVERR
     C                     SETON                     93
     C                     END
     C                     END
     C**
     C           ADCHK2    IFNE *BLANKS
     C                     MOVEA*BLANKS   #FLD
     C                     MOVE ADCHK2    #FLD
     C                     EXSR SWSET
     C           *IN94     IFEQ '0'
     C*********************MOVE ' 501'    CODE                            S01117
     C                     MOVE ' 011'    CODE                            S01117
     C                     EXSR MOVERR
     C                     SETON                     93
     C                     END
     C                     END
     C**
     C           ADCHK3    IFNE *BLANKS
     C                     MOVEA*BLANKS   #FLD
     C                     MOVE ADCHK3    #FLD
     C                     EXSR SWSET
     C           *IN94     IFEQ '0'
     C*********************MOVE ' 502'    CODE                            S01117
     C                     MOVE ' 012'    CODE                            S01117
     C                     EXSR MOVERR
     C                     SETON                     93
     C                     END
     C                     END
     C**
     C           ADCHK4    IFNE *BLANKS
     C                     MOVEA*BLANKS   #FLD
     C                     MOVE ADCHK4    #FLD
     C                     EXSR SWSET
     C           *IN94     IFEQ '0'
     C*********************MOVE ' 503'    CODE                            S01117
     C                     MOVE ' 013'    CODE                            S01117
     C                     EXSR MOVERR
     C                     SETON                     93
     C                     END
     C                     END
     C**
     C           ADCHK5    IFNE *BLANKS
     C                     MOVEA*BLANKS   #FLD
     C                     MOVE ADCHK5    #FLD
     C                     EXSR SWSET
     C           *IN94     IFEQ '0'
     C                     SETON                     93
     C*********************MOVE ' 504'    CODE                            S01117
     C                     MOVE ' 014'    CODE                            S01117
     C                     EXSR MOVERR
     C                     END
     C                     END
     C**
     C           ADCHK6    IFNE *BLANKS
     C                     MOVEA*BLANKS   #FLD
     C                     MOVE ADCHK6    #FLD
     C                     EXSR SWSET
     C           *IN94     IFEQ '0'
     C                     SETON                     93
     C*********************MOVE ' 505'    CODE                            S01117
     C                     MOVE ' 015'    CODE                            S01117
     C                     EXSR MOVERR
     C                     END
     C                     END
     C**
     C                     ENDSR
     C*
     C*****************************************************************
    C/EJECT
     C*****************************************************************
     C* SUBROUTINE SWSET CHECK FOR VALID SWIFT CHARACTER USED
     C*   IND '94' IS SET BY AN INVALID CHARACTER IN SWCH
     C*
     C           SWSET     BEGSR                           *** SWSET ****
     C*
     C                     Z-ADD1         Q       20
     C                     MOVE '1'       *IN94
     C*
     C                     MOVEA*BLANK    TST
     C*
     C           #FLD,1    IFNE *BLANK                     B002
     C                     MOVEA#FLD      TST
     C                     Z-ADD1         Q
     C*
     C           Q         DOWLE35                         B003
     C*
     C           TST,Q     IFNE ' '                        B004
     C           TST,Q     LOKUPSWCH                     94
     C*
     C           *IN94     IFEQ '0'                        B005
     C                     GOTO ENDLP
     C                     END                             E005
     C                     END                             E004
     C                     ADD  1         Q
     C                     END                             E003
     C                     END                             E002
     C           ENDLP     TAG
     C*
     C                     ENDSR
     C*
     C********************************************************************
    C/EJECT
    C********************************************************************
    C*
     C**   SUB-ROUTINE TO CHECK FOR VALID SWIFT CHARACTERS.
     C*
     C           SWIFT     BEGSR
     C*          -----
     C                     SETOF                     7571
     C                     Z-ADD1         X       20
     C*
     C*          TEST POSITIONS 1-8
     C*
     C           X         DOUEQ9
     C           *IN75     ORNE '1'
     C           SW,X      LOKUPSWCH                     75
     C  N75                GOTO EXITSW
     C                     ADD  1         X
     C                     END
     C*
     C*          TEST POSITIONS 10-12
     C*
     C           *IN75     IFEQ '1'
     C                     Z-ADD10        X
     C           X         DOUEQ13
     C           *IN75     ORNE '1'
     C           SW,X      LOKUPSWCH                     75
     C  N75                GOTO EXITSW
     C                     ADD  1         X
     C                     END
     C                     END
     C*
     C** First 12 characters should be key for CLSWT.
     C***********CLSWTK****SETLLCLSWT                    71               S01117
     C           CLSWTK    SETLLSDCUSTL7                 71               S01117
     C*
     C           EXITSW    ENDSR
      ********************************************************************                    CSD015
      /EJECT                                                                                  CSD015
      ********************************************************************                    CSD015
      *                                                                                       CSD015
     C           SRWTCH    BEGSR                                                              CSD015
      *                                                                                       CSD015
     C                     MOVE *BLANKS   SDWLTD                                              CSD015
      *                                                                                       CSD015
      ** Setup Counterparty Details                                                           CSD015
      *                                                                                       CSD015
     C                     EXSR SRCPTP                                                        CSD015
      *                                                                                       CSD015
      ** Setup 1st parameter for compliance engine program                                    CSD015
      *                                                                                       CSD015
     C                     MOVEL'FTCHQP'  W4ITEM                                              CSD015
     C                     MOVELPREF      W4IDEN                                              CSD015
     C                     MOVELBRCA      W4BRCH                                              CSD015
     C                     MOVELLIBR      W4SYSM                                              CSD015
     C                     MOVEL'CQPACDD' W4FUNT                                              CSD015
     C                     MOVELPKEY1     W4CNUM                                              CSD015
     C                     MOVELWCTYP     W4CTYP                                              CSD015
     C                     MOVELWRNRT     W4CUST                                              CSD015
     C                     Z-ADDOEDT      W4DDAT                                              CSD015
     C                     Z-ADDPVDT      W4VDAT                                              CSD015
     C                     Z-ADD0         W4MDAT                                              CSD015
     C                     MOVELPCCY      W4DEN1                                              CSD015
     C                     MOVEL*BLANKS   W4DEN2                                              CSD015
     C                     Z-ADDTOTR      W4AMT1                                              CSD015
     C                     Z-ADD0         W4AMT2                                              CSD015
      *                                                                                       CSD015
     C                     ENDSR                                                              CSD015
      ********************************************************************                    CSD015
      /EJECT                                                                                  CSD015
      ********************************************************************                    CSD015
      *                                                                                       CSD015
     C           SRENGN    BEGSR                                                              CSD015
      *                                                                                       CSD015
      ** Send transaction details to Compliance Watch                                         CSD015
      *                                                                                       CSD015
     C                     CALL 'SDWLCLOP'                                                    CSD015
     C                     PARM           SDWLTD                                              CSD015
     C                     PARM           PSTRNG                                              CSD015
      *                                                                                       CSD015
     C                     ENDSR                                                              CSD015
      ********************************************************************                    CSD015
      /EJECT                                                                                  CSD015
      ********************************************************************                    CSD015
      *                                                                                       CSD015
     C           SRCONV    BEGSR                                                              CSD015
      *                                                                                       CSD015
      ** Convert Watch Fields to Customer Name and Address                                    CSD015
      *                                                                                       CSD015
     C                     CALL 'SDCWLFMT'                                                    CSD015
     C                     PARM           PRTCD                                               CSD015
     C                     PARM           PINP1  35                                           CSD015
     C                     PARM           PINP2  35                                           CSD015
     C                     PARM           PINP3  35                                           CSD015
     C                     PARM           PINP4  35                                           CSD015
     C                     PARM           PINP5  35                                           CSD015
     C                     PARM           PINP6  35                                           CSD015
     C                     PARM           PCYCD   3                                           CSD015
     C                     PARM           POUT1 216                                           CSD015
     C                     PARM           POUT2   6                                           CSD015
      *                                                                                       CSD015
     C                     ENDSR                                                              CSD015
      ********************************************************************                    CSD015
      /EJECT                                                                                  CSD015
      ********************************************************************                    CSD015
      *                                                                                       CSD015
     C           SRFMT     BEGSR                                                              CSD015
      *                                                                                       CSD015
      ** Format Watch Fields in XML Format                                                    CSD015
      *                                                                                       CSD015
     C           PSTRNG    CAT  XTAG,WX:0 PSTRNG                                              CSD015
     C           PSTRNG    CAT  POUT1:0   PSTRNG                                              CSD015
     C           PSTRNG    CAT  XTAG,WY:0 PSTRNG                                              CSD015
      *                                                                                       CSD015
     C                     ENDSR                                                              CSD015
      ********************************************************************                    CSD015
      /EJECT                                                                                  CSD015
      ********************************************************************                    CSD015
      *                                                                                       CSD015
     C           SRCLRP    BEGSR                                                              CSD015
      *                                                                                       CSD015
      ** Reset parameters for SDCWLFMT                                                        CSD015
      *                                                                                       CSD015
     C                     MOVE *BLANKS   PINP1                                               CSD015
     C                     MOVE *BLANKS   PINP2                                               CSD015
     C                     MOVE *BLANKS   PINP3                                               CSD015
     C                     MOVE *BLANKS   PINP4                                               CSD015
     C                     MOVE *BLANKS   PINP5                                               CSD015
     C                     MOVE *BLANKS   PINP5                                               CSD015
     C                     MOVE *BLANKS   PCYCD                                               CSD015
      *                                                                                       CSD015
     C                     ENDSR                                                              CSD015
      ********************************************************************                    CSD015
      /EJECT                                                                                  CSD015
      ********************************************************************                    CSD015
      *                                                                                       CSD015
     C           SRCPTP    BEGSR                                                              CSD015
      *                                                                                       CSD015
      ** Determine Counterparty type                                                          CSD015
      *                                                                                       CSD015
     C                     MOVE *BLANKS   PKEY1                                               CSD015
      *                                                                                       CSD015
      ** If Remitting Bank is not free text, use it as counterparty,                          CSD015
      ** else use sender's correspondent.                                                     CSD015
      *                                                                                       CSD015
     C           WRBFF     IFEQ 'N'                                                           CSD015
     C                     MOVELWRBCP     PKEY1                                               CSD015
     C                     ELSE                                                               CSD015
     C                     MOVELWSCCP     PKEY1                                               CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C                     CALL 'AOCUSTR0'                                                    CSD015
     C                     PARM *BLANK    PRTCD                                               CSD015
     C                     PARM '*KEY   ' POPTN                                               CSD015
     C                     PARM           PKEY1  10                                           CSD015
     C                     PARM *BLANKS   PKYST   7                                           CSD015
     C           SDCUS2    PARM SDCUS2    DSSDY                                               CSD015
      *                                                                                       CSD015
     C           PRTCD     IFNE *BLANKS                                                       CSD015
     C           PRTCD     ANDNE'*NRF   '                                                     CSD015
     C                     MOVEL'SDCUSTPD'WDBFIL                                              CSD015
     C                     MOVELPKEY1     WDBKEY                                              CSD015
     C                     Z-ADD6         WDBASE                                              CSD015
     C                     MOVE *ON       *INU7                                               CSD015
     C                     EXSR TERM                                                          CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C                     MOVE *BLANKS   WCTYP   1                                           CSD015
     C                     MOVE *BLANKS   WCRNM  20                                           CSD015
     C                     MOVE *BLANKS   WRNRT  30                                           CSD015
      *                                                                                       CSD015
     C           PRTCD     IFEQ *BLANKS                                                       CSD015
      *                                                                                       CSD015
     C                     MOVELWLCRNM    WCRNM                                               CSD015
     C           WLCRNM    CAT  WLCRTN    WRNRT                                               CSD015
      *                                                                                       CSD015
     C           CCF001    IFEQ 'Y'                                                           CSD015
      *                                                                                       CSD015
     C           WLCRPC    IFEQ 'Y'                                                           CSD015
     C                     MOVE 'C'       WCTYP                                               CSD015
     C                     ELSE                                                               CSD015
     C                     MOVE 'I'       WCTYP                                               CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C                     ELSE                                                               CSD015
      *                                                                                       CSD015
     C           WLLICD    IFNE *BLANKS                                                       CSD015
     C           WLLICD    ANDNEW1IND1                                                        CSD015
     C           WLLICD    ANDNEW1IND2                                                        CSD015
     C           WLLICD    ANDNEW1IND3                                                        CSD015
     C           WLLICD    ANDNEW1IND4                                                        CSD015
     C           WLLICD    ANDNEW1IND5                                                        CSD015
     C                     MOVE 'C'       WCTYP                                               CSD015
     C                     ELSE                                                               CSD015
     C                     MOVE 'I'       WCTYP                                               CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C                     ENDIF                                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C                     ENDSR                                                              CSD015
      ********************************************************************                    CSD015
    C*
    C********************************************************************
     O/EJECT
     O*****************************************************************
     OCQPACDDFE                CQPACE
     O*
     O*****************************************************************
     O/EJECT
** CPY@   **      OBJECT COPYRIGHT
(c) Misys International Banking Systems Ltd. 2001
**   SWCH  - ARRAY OF VALID SWIFT CHARACTER
ABCDEFGHIJKLMNOPQRSTUVWXYZ 1234567890/-?:().,'+
**  XTAG                                                                                      CSD015
<Remitting Bank>                                                                              CSD015
</Remitting Bank>                                                                             CSD015
<Sender's Correspondence>                                                                     CSD015
</Sender's Correspondence>                                                                    CSD015
<Receiver's Correspondence>                                                                   CSD015
</Receiver's Correspondence>                                                                  CSD015
<Account With Bank>                                                                           CSD015
</Account With Bank>                                                                          CSD015
<Debit Party>                                                                                 CSD015
</Debit Party>                                                                                CSD015
<Charges To The Debit Of Account>                                                             CDS015
</Charges To The Debit Of Account>                                                            CSD015
