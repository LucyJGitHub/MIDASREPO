     H        1
     F*****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas FT Regular payments gen. non input cycle')       *
     F*****************************************************************
     F*                                                               *
     F*  Midas - Funds Transfer Module                                *
     F*                                                               *
     F*  RPG/FT0205 - Regular Payments Generation (Non-Input Cycle)   *
     F*                                                               *
      *  (c) Finastra International Limited 2001                      *
      *                                                               *
      *  Last Amend No. CSD100             Date 17Aug17               *  
      *  Prev Amend No. CSD103             Date 10Aug20               *
      *                 AR1036310          Date 05Dec12               *
      *                 MD055733           Date 03Jul20               *
      *                 MD050139           Date 23Mar18               *
      *                 MD046248           Date 27Oct17               *
      *                 CGL184             Date 07Dec16               *
      *                 AR808679           Date 13Mar15               *
      *                 CFT151             Date 20Mar14               *
      *                 AR1082745          Date 04Apr13               *
      *                 AR1096476          Date 18Mar12               *
      *                 CFT120             Date 28Sep12               *
      *                 AR787620           Date 10Jun11               *
      *                 CER059             Date 19Jul10               *
      *                 BUG23056           Date 23Feb09               *
      *                 BUG22580           Date 02Feb09               *
      *                 CER048             Date 19May08               *
      *                 CER047             Date 19May08               *
      *                 CER030             Date 09Jul08               *
      *                 CER043             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      *                 CSW209             Date 01Apr09               *
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 BUG14166           Date 22Jun07               *
      *                 CSW207             Date 08Jun07               *
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CFT032             Date 11Sep06               *
      *                 CSD031             Date 10Apr06               *
      *                 BUG433             Date 05Dec05               *
      *                 CDL049             Date 07Jul06               *
      *                 CSD027             Date 09Dec05               *
      *                 CSW037A            Date 02May05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CLE025             Date 20Oct03               *
      *                 CGL029             Date 01Sep03               *
      *                 CSW203             Date 26May03               *
      * Midas Release 4.01 -------------------------------------------*
      *                 CPK015             Date 17Jun02               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.05 -----------------------------------------------*
      *                 CFT009             Date 03Aug00               *
      * Midas DBA 3.04 -----------------------------------------------*
      *                 CFT014             Date 25May00               *
      * Midas DBA 3.03 -----------------------------------------------*
      * Midas DBA 3.02 -----------------------------------------------*
      *                 169210             Date 19Oct99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 148229             DATE 13Dec98               *
     F*                 S01408             DATE 26Jun98               *
     F*                 CEU006             Date 30Apr98               *
     F*                 S01408             DATE 07OCT96               *
     F*                 S01408             DATE 30APR96               *
     F*                 082482             DATE 11APR95               *
     F*                 S01499             DATE 06JUN94               *
     F*                 S01494             DATE 25MAY94               *
     F*                 070030             DATE 27APR94               *
     F*                 073153             DATE 22APR94               *
     F*                 073154             DATE 07APR94               *
     F*                 069203             DATE 07APR94               *
     F*                 S01483             DATE 16JAN94               *
     F*                 046303             DATE 16JAN94               *
     F*                 S01435             DATE 15NOV93               *
     F*                 062394             DATE 24OCT93               *
     F*                 S01408             DATE 01OCT93               *
     F*                 S01435             DATE 08SEP93               *
     F*                 S01414             DATE 29MAR93               *
     F*                 050921             DATE 14APR92               *
     F*                 050982             DATE 20MAY90               *
     F*                 E38323             DATE 30JUL92               *
     F*                 E32481             DATE 17JUN91               *
     F*                 E32873             DATE 01MAY91               *
     F*                 S01117             DATE 11/10/90              *
     F*                 S01194             DATE 11/10/90              *
     F*                 S01195             DATE 11/10/90              *
     F*                 E22509             DATE 03AUG90               *
     F*                                                               *
     F*---------------------------------------------------------------*
      *                                                               *
      *  CSD100 - Patronymic and Gender fields for Non-Account holder * 
      *           (Recompile)                                         *  
      *  CSD103 - LIBOR Deregulation - Common Layer/Standing Data     *
      *           (Recompile)                                         *
      *  AR1036310 - It is not possible to enter Instructed currency  *
      *              for a Regular Payment. If Instructed Ccy is equal*
      *              to Settle Ccy, Original Rate will be set to the  *
      *              transaction rate. If Instructed Ccy is equal to  *
      *              Pay Ccy, Original Rate will be set to 1.         *
      *              (Child: AR1036311)                               *
      *  MD055733 - COB: Multiple UTCHOBJEX calls in LEC06A           *
      *             components.                                       *
      *           - Redeliver of MD050139.                            *
      *  MD050139- AOSARDR0 called every time causing performance     *
      *            issue. Recompile due to changes in /COPY           *
      *            ZFREQ/ZFRQ*.                                       *
      *  MD046248 - Finastra Rebranding                               *
      *  CGL184 - New Frequencies for Account Statements (Recompile)  *
      *  AR808679 - Formalized fix to suppress database error on      *
      *             writing a duplicate record when CFT009 is off.    *
      *             (Child: AR808680)                                 *
      *           - Applied for MD-5794                               *
      *  CFT151 - FT IN/OP Alphanumeric sequence                      *
      *  AR1082745 - Mandatory field tags of MT103 is missing in the  *
      *              generated MT103 of Regular payment transactions  *
      *  AR1096476 - Could not find record where OTPREFPayment is a   *
      *              primary key                                      *
      *  CFT120 - FT IN/OP - Charges to DR of Account Currency        *
      *  AR787620 - Hooks Incorporation                               *
      *             WNCPYSRC,FTH00077                                 *
      *             WNCPYSRC,FTH00078                                 *
      *             WNCPYSRC,FTH00079                                 *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  BUG23056 - Populating the current timestamp string for write *
      *  BUG22580 - Fields incorrectly labeled and lengths            *
      *           (Recompile)                                         *
      *  CER048 - German Features - Taxes (Recompile)                 *
      *  CER047 - German Features LF037-00 Reporting §24c KWG         *
      *           (Recompile)                                         *
      *  CER030 - Multicash German Feature                            *
      *  CER043 - German Features LF041-00 New Fields and Defaulting  *
      *           (Recompile)                                         *
      *  CSW209 - SWIFT 2009 Changes                                  *
      *  BUG14166 - Incorrect length for P1ODMT (Recompile)           *
      *  CSW207 - SWIFT 2007 Changes                                  *
      *  CFT032 - Account line in field 50X in MT103                  *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  BUG433 - Recompiled due to change in FTPCHGPD                *
      *  CDL049 - Addition of a Reference Rate field (recompile)      *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CGL029 - Increase Account Code to 10 digits (Recompile)      *
      *  CSW203 - SWIFT 2003 Standards Update                         *
      *  CPK015 - Release 4.01 Packaging:                             *
      *           - A default timestamp string is required for WRITE. *
      *  CFT009 - FT Fees and Charge Development                      *
      *  CFT014 - Straight-through Processing Phase 2 MT103           *
      *           Messages Generation for FT.                         *
      *  169210 - Duplicate hook renamed from FT0205C020, FT0205C021  *
     A*           to FT0205CABS, FT0205CABT                           *
     F*  148229 - Changes to /COPY FT0010I001 (Recompile only)        *
     F*  S01408 - Core Hook Requests repectfully and regrettably      *
     F*           rejected because of changes by CEU006:              *
     F*                   FT0205C018                                  *
     F*                   FT0205C019                                  *
     F*                   FT0205C020                                  *
     F*                   FT0205C021                                  *
     F*  CEU006 - EMU FT Payments and Settlement.                     *
     F*  S01408 - Addition of core hook FT0205CCP3                    *
     F*  S01408 - Addition of core hook FT0205CCP2                    *
     F*           Addition of core hook FT0205CCP1                    *
     F*           Addition of core hook FT0205FFP1                    *
     F*  082482 - Outgoing Payments were being generated a day early. *
     F*           They should be output if the control date is *LE    *
     F*           to today rather than next working day. Functional   *
     F*           spec says payments are produced on the day they are *
     F*           due.                                                *
     F*  S01499 - BLI V.A.T. Processing                               *
     F*         - Linked to Reg. Pay Reference must be blank for a    *
     F*           regular payment record and replace call to ABSFI101 *
     F*           by a call to AOVATR0  (TEMP15)                      *
     F*  S01494 - BLI Funds Transfer Enhancements                     *
     F*  070030 - Change S01483 to also look at the next working      *
     F*           day in pay currency, if this is a holiday generate. *
     F*           Correct positioning of code for ##CDTE setup.       *
     F*  073153 - Correct formatting of Entered currency              *
     F*  073154 - Correct formatting of FDAT and NPDT for report      *
     F*           See 069203                                          *
     F*  069203 - Correct formatting of FDAT and NPDT                 *
     F*  S01483 - Add switchable feature                              *
     F*           Generate payments against DNWD - 1                  *
     F*  046303 - /COPY source subr. ZFWDT amended to prevent array   *
     F*           error if no holiday record found - fixed by S01434. *
     F*           Program recompiled.                                 *
     F*  S01435 - Standardisation of Output                           *
     F*  062394 - Use frequency calculation program FT0310            *
     F*  S01408 - Core hook FT0205CCBU added                          *
     F*  S01435 - Incoming Message Management.                        *
     F*  S01414 - Book Code and Profit Centre Incorporation.          *
     F*  050921 - Problem with multiply divide indicator              *
     F*  050982 - Miscellaneous Charges                               *
     F*  E38323 - Recompiled due to a change in copy source ZFWDT     *
     F*           subroutine                                          *
     F*  E32481 - REMOVAL OF REDUNDANT FLAGS                          *
     F*  E32873 - RECI, LCD, AND CHTP MAY BE CORRUPT WHEN             *
     F*           WRITING RECORD TO OTPAY                             *
     F*  S01117 - MULTI BRANCHING INCORPORATION , RCF PROCESSING      *
     F*  S01194 - STANDING DATA CHANGES                               *
     F*  S01195 - HOLIDAYS PROCESSING                                 *
     F*  E22509 - REGULAR PAYMENTS ARE GENERATED                      *
     F*           A  NUMBER OF TELEX NOTICE DAYS                      *
     F*           BEFORE  THE  ACTUAL VALUE DATE.                     *
     F*                                                               *
     F*****************************************************************
     F* ID F  C  H  L    FUNCTION OF INDICATORS
     F*
     F*    19         THERE HAS BEEN OUTPUT                               S01117
     F*    20         RGPAY END OF FILE INDICATOR
     F*               **********
     F*    21         READ FAIL - RGPAY
     F*    22         WRITE FAIL - OTPAYDDF
     F*    23         CHAIN FAIL - OTPAYDDF
     F*    25         UPDATE FAIL - OTPAYDDF
     F*    26         CHAIN FAIL - OTPAYZZ
     F*    27         UPDATE FAIL - OTPAYZZ
     F*    28         MULTI BRANCHING INDICATOR                           S01117
     F*    29         ORIGINATING BRANCH USED INDICATOR                   S01117
      *    32         CFT014 is on                                        CFT014
     F*    32         WRITE FAIL - OTPAYXPD                               CFT009
      *    69         CFT009 is on                                        CFT009
     F*               **********
     F*    70         Profit Centres In Use Flag                          S01414
     F*                                                                   S01414
     F*    71         Overflow Indicator for FT0205P1                                         CSW209
     F*    72         CSW209 is on                                                            CSW209
     F*                                                                                       CSW209
     F*    90 - 99    INDICATORS FOR STANDARD SUBROUTINES
     F*    U7,U8      DATABASE ERROR INDICATORS
     F*
     F*****************************************************************
     F/EJECT
     F*****************************************************************
     F***ABSFI101IF  E                    DISK                     S01494 S01499
     FACNUMA  IF  E           K        DISK                               S01195
     FOTPAY   UF  E           K        DISK                      A
     FOTPAYZZ UF  E                    DISK
     FOTPAYXPDO   E           K        DISK                               CFT009
     F            OTPAYXDF                          KRENAMEOTPYX2DF       CFT009
     FFTPCHGL0IF  E           K        DISK                               CFT009
     F*RGPAY***IF**E***********K********DISK                              S01117
     FRGPAYBB IF  E           K        DISK                               S01117
     F            OTPAYDDF                          KRENAMERGPAYDDF
     FTABFP   IF  E           K        DISK
     F            TABTB20F                          KIGNORE
     F            TABTG20F                          KIGNORE
     F            TABLETLF                          KIGNORE
     F            TABLETPF                          KIGNORE
     F            TABLET5F                          KIGNORE
     F            TABLETHF                          KIGNORE
     FTABTG30 IT  F      40           EDISK                               E22509
      *                                                                   CFT014
      ** Outgoing Payments Details Extension retrieval index              CFT014
      *                                                                   CFT014
     FOTPAYXL2IF  E           K        DISK                               CFT014
      *                                                                   CFT014
      ** Outgoing Payments Details Extension update index                 CFT014
      *                                                                   CFT014
     FOTPAYXL0UF  E           K        DISK                      A        CFT014
     F*                                                                   S01408
     FOTPAYQL0O   E           K        DISK                      A                         AR1096476
     F*                                                                                    AR1096476
     F/COPY WNCPYSRC,FT0205FFP1                                           S01408
     F*                                                                   S01408
     F*FT0205P2O***E********************PRINTER                           S01117
     F*FT0205P1O***E********************PRINTER                           S01117
     FFT0205AUO   E                    PRINTER      KINFDS SPOOLU         S01117
     F*FT0205P1O***E********************PRINTER      KINFDS SPOOL1     UC              S01117 CSW209
     FFT0205P1O   E             71     PRINTER      KINFDS SPOOL1     UC                      CSW209
     F*
     F********************************************************************
     E**********          STAMP   1   1 26                                           CPK015 BUG23056
      ** Array containing dummy timestamp                                                     CPK015
     E                    CPY@    1   1 80
     E                    WA1        15  1               UGFRMT SR.ARRAY
     E                    WA2        20  1               UGFRMT SR.ARRAY
     E                    ZYDY    4   4  4 0             ZDATE1/2 SR.ARRAY
     E                    ZMDY   13  13  3 0             ZDATE1/2 SR.ARRAY
     E                    ZMNM   12  12  3               ZDATE2 SR. ARRAY
     E********************ZHC        50  3               ZFREQB SR.ARRAY  062394
     E********************ZFMD   12  12  2               ZFREQB SR.ARRAY  062394
     E********************HCCYA      25  3                                S01195
     E                    POWER   1   7  7 3             POWERS TABLE
     E    TABTG30         CY      1 150  3   CYD    37   POWERS TABLE     E22509
     E                    CYCD      150  5 0             POWERS TABLE     E22509
     E/COPY WNCPYSRC,FT0205E001
      /COPY ZSRSRC,ZSEDITZ1
     E/COPY ZSRSRC,ZEDITZ1                                                CFT009
     **/COPY*ZSRSRC,ZSEDITZ2****                                          S01117
      /COPY ZSRSRC,ZHOLE                                                  S01195
     */COPY WNCPYSRC,FT0205*001
     I*  RENAME FIELDS IN RGPAY FOR OUTPUT TO OTPAY                       E32873
     IRGPAYDDF                                                            E32873
     I              RECI                            RGRECI                E32873
     E********************************************************************
     I*                                                                   S01117
     I** Rename of ACCNTAB branch field to avoid corrupting               S01117
     I** booking branch from OTPAYDD                                      S01117
     I*                                                                   S01414
     I* Rename of ACNUMA Profit Centre to avoid overwriting               S01414
     I*                                                                   S01117
     IACCNTABF                                                            S01117
     I              BRCA                            BRCH                  S01117
     I              PRFC                            ACPRFC                S01414
     I*                                                                   S01117
     IOTPAYDDF                                                                                CPK015
     I              TMST                            OUTMST                                    CPK015
     I** Data structure for data base errors in SDNOSTPD                  S01117
     I*                                                                   S01117
     I            DS                                                      S01117
     I**********                              1  17 WRK17                              S01117 CGL029
     I                                        1  23 WRK17                                     CGL029
     I                                        1   6 @CUST                 S01117
     I                                        7   9 @CYCD                 S01117
     I**********                             10  13 @ACCD                              S01117 CGL029
     I**********                             14  15 @ACSN                              S01117 CGL029
     I**********                             16  17 @NONB                              S01117 CGL029
     I                                       10  19 @ACCD                                     CGL029
     I                                       20  21 @ACSN                                     CGL029
     I                                       22  23 @NONB                                     CGL029
     I*                                                                   S01117
     I*  DATA STRUCTURE FOR COMPILATION  - COPYRIGHT INSERTION
     ICPYR@#      DS
     I                                        1  80 CPY@
     I                                        1  20 CPY@##
     I/EJECT
     I********************************************************************
     I            DS
     I***************************************                             S01195
     I***DATA*STRUCTURE*FOR*'TABLETJ'*TO*IDENTIFY*HOLIDAY*CCY*ARRAY*      S01195
     I***************************************                             S01195
     I***************************************15  89 HCCY                  S01195
     I***************************************15  89 HCCYA                 S01195
     I*
     I** DATA AREA OTPAYDA - ASSIGNS NEXT REFERENCE SEQUENCE
     I*
     ISEQDAD      DS                              4
     I                                        1   40SEQDA
     I            DS
     I                                        1  15 IPREF
     I                                        1   1 P
     I                                        2  110WFLD10
     I                                       12  15 WFLD4
     I/COPY WNCPYSRC,FTH00077
     I            DS                                                      CFT151
     I                                        1  15 IPREFT                CFT151
     I                                        1   1 PT                    CFT151
     I                                        2   70WFLD6N                CFT151
     I                                        8  11 WFLD4A                CFT151
     I                                       12  15 WFLD4T                CFT151
     I*                                                                   CFT151
     I*
     I** DATA AREA LDA - USED IN THE EVENT OF DATABASE ERRORS
     I*
     IDLDA        DS                            256
     I**************************************134 138 DBFILE                S01194
     I**************************************139 167 DBKEY                 S01194
     I**************************************168 175 DBPGM                 S01194
     I**************************************176 177 DBASE                 S01194
     I                                      134 141 DBFILE                S01194
     I                                      142 170 DBKEY                 S01194
     I                                      171 180 DBPGM                 S01194
     I                                      181 1830DBASE                 S01194
     I*                                                                   E22509
     I** CURRENCY DETAILS FROM TABTG10                                    E22509
     I*                                                                   E22509
     ICYDDS       DS                                                      E22509
     I                                        1   10CDP                   E22509
     I                                    P   2   88SPOT                  E22509
     I                                        9   90MDIN                  E22509
     I                                    P  10  168ERLC                  E22509
     I                                       17  170TNOT                  E22509
     I                                       18  31 CCNUM                 E22509
     I                                       32  35 TEAC                  E22509
     I                                       36  370SSNO                  E22509
     I*                                                                   E22509
     I**********  DS                                                S01195S01435
     I**********                                                    S01195S01435
     I***Data*structure to split full account number for destinat   S01195S01435
     I****used*in holiday processing                                S01195S01435
     I**********                              1  35 DST1            S01195S01435
     I**********                              1   6 @DCUS           S01195S01435
     I**********                              7   9 @DCCY           S01195S01435
     I**********                             10  13 @DCOD           S01195S01435
     I**********                             14  15 @DSEQ           S01195S01435
     I**********                             16  18 @DBRC           S01195S01435
     I**********                                                    S01195S01435
     I            DS                                                      S01195
     I*                                                                   S01195
     I** Data structure to split partial account number for ordering      S01195
     I*   bank used in holiday processing                                 S01195
     I**********                              1  120ORBK                               S01195 CGL029
     I**********                              1  180ORBK                               CGL029 CSD027
     I                                        1  18 ORBK                                      CSD027
     I                                        1   6 @BCUS                 S01195
     I**********                              7  10 @BCOD                              S01195 CGL029
     I**********                             11  12 @BSEQ                              S01195 CGL029
     I                                        7  16 @BCOD                                     CGL029
     I                                       17  18 @BSEQ                                     CGL029
     I**********                                                    S01195S01435
     I**********  DS                                                S01195S01435
     I**********                                                    S01195S01435
     I***Data*structure to split partial account number for orderingS01195S01435
     I****customer used in holiday processing                       S01195S01435
     I**********                              1  35 ORC1            S01195S01435
     I**********                              1   6 @CCUS           S01195S01435
     I**********                              7  10 @CCOD           S01195S01435
     I**********                             11  12 @CSEQ           S01195S01435
     I**********                             13  15 @CBRC           S01195S01435
      **********                                                    S01435S01435
      ********** Standardise to FT0515 for reporting                S01435S01435
      **********                                                          S01435
      *                                                                   S01435
      ** Program data structure                                           S01435
     IDSPGM     ESDSY2PGDSP                                               S01435
      *                                                                   S01435
      *****************************************************************   S01435
      *  Data Structures for addresses.                                   S01435
      *                                                                   S01435
      ** OUT data structures (printout)                                   S01435
      *                                                                   S01435
      ** Receivers correspondent                                          S01435
     IP1RCDS      DS                                                      S01435
     I                                        1  35 P1RCO1                S01435
     I                                       36  70 P1RCO2                S01435
     I                                       71 105 P1RCO3                S01435
     I                                      106 140 P1RCO4                S01435
     I                                      141 175 P1RCO5                S01435
      *                                                                   S01435
      ** Ordering Customer                                                S01435
     IP1ORDS      DS                                                      S01435
     I                                        1  35 P1ORC1                S01435
     I                                       36  70 P1ORC2                S01435
     I                                       71 105 P1ORC3                S01435
     I                                      106 140 P1ORC4                S01435
     I                                      141 175 P1ORC5                S01435
      *                                                                   S01435
      ** Receiving Bank                                                   S01435
     IP1DSDS      DS                                                      S01435
     I                                        1  35 P1DST1                S01435
     I                                       36  70 P1DST2                S01435
     I                                       71 105 P1DST3                S01435
     I                                      106 140 P1DST4                S01435
     I                                      141 175 P1DST5                S01435
      *                                                                   S01435
      ** Account with Bank                                                S01435
     IP1ACDS      DS                                                      S01435
     I                                        1  35 P1ACB1                S01435
     I                                       36  70 P1ACB2                S01435
     I                                       71 105 P1ACB3                S01435
     I                                      106 140 P1ACB4                S01435
     I                                      141 175 P1ACB5                S01435
      *                                                                   S01435
      ** Beneficiary Customer                                             S01435
     IP1BNDS      DS                                                      S01435
     I                                        1  35 P1BNC1                S01435
     I                                       36  70 P1BNC2                S01435
     I                                       71 105 P1BNC3                S01435
     I                                      106 140 P1BNC4                S01435
     I                                      141 175 P1BNC5                S01435
      *                                                                   S01435
      ** Senders correspondent                                            S01435
     IP1SNDS      DS                                                      S01435
     I                                        1  35 P1SNC1                S01435
     I                                       36  70 P1SNC2                S01435
     I                                       71 105 P1SNC3                S01435
     I                                      106 140 P1SNC4                S01435
     I                                      141 175 P1SNC5                S01435
      *                                                                   S01435
      ** Ordering Bank                                                    S01435
     IP1OBDS      DS                                                      S01435
     I                                        1  35 P1ORB1                S01435
     I                                       36  70 P1ORB2                S01435
     I                                       71 105 P1ORB3                S01435
     I                                      106 140 P1ORB4                S01435
     I                                      141 175 P1ORB5                S01435
      *                                                                   S01435
      ** Intermediary Bank                                                S01435
     IP1INDS      DS                                                      S01435
     I                                        1  35 P1INB1                S01435
     I                                       36  70 P1INB2                S01435
     I                                       71 105 P1INB3                S01435
     I                                      106 140 P1INB4                S01435
     I                                      141 175 P1INB5                S01435
      *                                                                   CFT014
      ** 3rd Reimbursement                                                CFT014
     IP1TRIB      DS                                                      CFT014
     I                                        1  35 P1TRI1                CFT014
     I                                       36  70 P1TRI2                CFT014
     I                                       71 105 P1TRI3                CFT014
     I                                      106 140 P1TRI4                CFT014
     I                                      141 175 P1TRI5                CFT014
      *                                                                   S01435
      *                                                                   S01435
      ** IN data structures (file)                                        S01435
      *                                                                   S01435
      ** Receivers correspondent                                          S01435
     IRCINDS      DS                                                      S01435
     I                                        1  35 RCO1                  S01435
     I                                       36  70 RCO2                  S01435
     I                                       71 105 RCO3                  S01435
     I                                      106 140 RCO4                  S01435
     I                                      141 175 RCO5                  S01435
      *                                                                   S01435
      ** Ordering Customer                                                S01435
     IORINDS      DS                            175                       S01435
     I                                        1  35 ORC1                  S01435
     I                                        1   6 @CCUS                 S01435
     I**********                              7  10 @CCOD                              S01435 CGL029
     I**********                             11  12 @CSEQ                              S01435 CGL029
     I**********                             13  15 @CBRC                              S01435 CGL029
     I                                        7  16 @CCOD                                     CGL029
     I                                       17  18 @CSEQ                                     CGL029
     I                                       19  21 @CBRC                                     CGL029
     I                                       36  70 ORC2                  S01435
     I                                       71 105 ORC3                  S01435
     I                                      106 140 ORC4                  S01435
     I                                      141 175 ORC5                                      CFT032
      *                                                                   S01435
      ** Receiving Bank                                                   S01435
     IDSINDS      DS                            175                       S01435
     I                                        1  35 DST1                  S01435
     I                                        1   6 @DCUS                 S01435
     I                                        7   9 @DCCY                 S01435
     I**********                             10  13 @DCOD                              S01435 CGL029
     I**********                             14  15 @DSEQ                              S01435 CGL029
     I**********                             16  18 @DBRC                              S01435 CGL029
     I                                       10  19 @DCOD                                     CGL029
     I                                       20  21 @DSEQ                                     CGL029
     I                                       22  24 @DBRC                                     CGL029
     I                                       36  70 DST2                  S01435
     I                                       71 105 DST3                  S01435
     I                                      106 140 DST4                  S01435
      *                                                                   S01435
      ** Account with Bank                                                S01435
     IACINDS      DS                                                      S01435
     I                                        1  35 ACB1                  S01435
     I                                       36  70 ACB2                  S01435
     I                                       71 105 ACB3                  S01435
     I                                      106 140 ACB4                  S01435
     I                                      141 175 ACB5                  S01435
      *                                                                   S01435
      ** Beneficiary Customer                                             S01435
     IBNINDS      DS                                                      S01435
     I                                        1  35 BNC1                  S01435
     I                                       36  70 BNC2                  S01435
     I                                       71 105 BNC3                  S01435
     I                                      106 140 BNC4                  S01435
     I                                      141 175 BNC5                  S01435
      *                                                                   S01435
      ** Intermediary Bank                                                S01435
     IININDS      DS                                                      S01435
     I                                        1  35 INB1                  S01435
     I                                       36  70 INB2                  S01435
     I                                       71 105 INB3                  S01435
     I                                      106 140 INB4                  S01435
     I                                      141 175 INB5                  S01435
      *                                                                   CFT014
      ** 3rd Reimbursement                                                CFT014
     ITRINDS      DS                                                      CFT014
     I                                        1  35 OPTRI1                CFT014
     I                                       36  70 OPTRI2                CFT014
     I                                       71 105 OPTRI3                CFT014
     I                                      106 140 OPTRI4                CFT014
     I                                      141 175 OPTRI5                CFT014
      *                                                                   S01435
      ** Split name into components.                                      S01435
     IXNAMDS      DS                            175                       S01435
     I**********                              1  12 XACCT                              S01435 CGL029
     I**********                             13  15 XBRCA                              S01435 CGL029
     I                                        1  18 XACCT                                     CGL029
     I                                       19  21 XBRCA                                     CGL029
      *                                                                   S01435
      **            address lines 2 - 5.                                  S01435
     I                                       36 175 XADDS                 S01435
      *                                                                   S01435
      ** to define XTYPE.                                                 S01435
     IXTYPE       DS                              1                       S01435
      *                                                                   S01435
      *****************************************************************   S01435
     I*                                                                   S01117
     I** INFDS for P1 file .                                              S01117
     I*                                                                   S01117
     ISPOOL1      DS                                                      S01117
     I                                       83  90 SFIL1                 S01117
     I                                    B 123 1240SFNUM1                S01117
     I*                                                                   S01117
     I** INFDS for AU file                                                S01117
     I*                                                                   S01117
     ISPOOLU      DS                                                      S01117
     I                                       83  90 SFILU                 S01117
     I                                    B 123 1240SFNUMU                S01117
     I/COPY ZSRSRC,ZSEDITZ2                                               S01117
     I/COPY ZSRSRC,ZHOLI                                                  S01195
     I*                                                                   S01117
     IDSFDY     E DSDSFDY                                                 S01117
     IDSSDY     E DSDSSDY                                                 S01117
     I*                                                                   S01117
     ISDNOST    E DSSDNOSTPD                                              S01117
     I**                                Nostro location code              S01195
     I                                       29  31 NLOC                  S01195
     ISDGELR    E DSSDGELRPD                                              S01117
     I              QQACCD                          ACCDQQ                                    CGL029
     ISDBRCH    E DSSDBRCHPD                                              S01117
     ISDFTFR    E DSSDFTFRPD                                              S01435
      *                                                                   S01435
      * Funds Transfer Details *                                          S01435
      *                                                                   S01435
     ISDCUST    E DSSDCUSTPD                                              S01435
     I              QQDFAC                          DFACQQ                                    CGL029
      *                                                                   S01435
      * Customer Details       *                                          S01435
      *                                                                   S01435
     ISDCURR    E DSSDCURRPD                                              CFT014
      ** Currency Details                                                 CFT014
      *                                                                   CFT014
     ISCSARD    E DSSCSARDPD                                              S01483
      *                                                                   S01483
      * Sar Text details *                                                S01483
      *                                                                   S01483
     I/COPY WNCPYSRC,FT0205I001
      /EJECT                                                              S01435
     IW8FT        DS                            128                       S01435
      *                                                                   S01435
      * Address data structure                                            S01435
      *                                                                   S01435
      * Currency                                                          S01435
     I                                        1   3 W8CCY                 S01435
      * Settlement Type                                                   S01435
     I                                        4   5 W8STMT                S01435
      * Mandatory Text - convert BIC identifiers                          S01435
     I                                        6   6 W8MTXT                S01435
      * Message Tag                                                       S01435
     I                                        7  11 W8MTAG                S01435
      * Construct of data in field                                        S01435
     I                                       12  12 W8TYPE                S01435
      * Number of Lines available                                         S01435
     I                                       13  140W8NLIN                S01435
      * Network and Message Type                                          S01435
     I                                       15  20 W8NWRK                S01435
     I                                       21  23 W8MTPY                S01435
      * Calling Program                                                   S01435
     I                                       24  33 W8CPGM                S01435
      * Action *PRINT/*ENQ/*MSG GEN                                       S01435
     I                                       34  41 W8ACT                 S01435
      * Critical reporting - Database error if 'Y'                        S01435
      * If no BIC directory and BIC entered no error                      S01435
     I                                       42  42 W8CRIT                S01435
      * Force Midas Address - where possible                              S01435
     I                                       43  43 W8MADD                S01435
      * If Retail get first address from account                          S01435
     I                                       44  44 W8RTAD                S01435
      * Alternative Address                                               S01435
     I                                       45  45 W8ALTN                S01435
      * Address type selected in W0MSG                                    S01435
     I                                       46  46 W8ADTP                S01435
      *                                                                   S01435
     IDSMTR       DS                                                      S01435
      *                                                                   S01435
      *  Define fields for message transalation                           S01435
      *                                                                   S01435
     I                                        1 132 #MSDTA                S01435
     I                                       15  30 #MPREF                S01435
     I                                    P   1   20#MPART                S01435
     I                                      133 264 #MSTX1                S01435
     I#MSTX2      DS                                                      S01435
     I                                        1 256 #MSTXA                S01435
     I                                      257 512 #MSTXB                S01435
     IVATDS       DS                                                      S01499
     I*                                                                   S01499
     I** Calling parameter to AOVATR0                                     S01499
     I*                                                                   S01499
     I                                        1   3 I#BRCA                S01499
     I                                        4   9 I#CUST                S01499
     I                                    P  10  124O#VATR                S01499
     I*
     I********************************************************************
      *   Data Structure for input/output parameters                      CEU006
     C/COPY FTCPYSRC,FT0010I001                                           CEU006
     I/EJECT
      *                                                                   CFT009
      ** First data structure to pass data between FT0205 and             CFT009
      ** FT000980                                                         CFT009
      *                                                                   CFT009
     ITRNDET      DS                           3000                       CFT009
      *                                                                   CFT009
      ** Second data structure to pass data between FT0205 and            CFT009
      ** FT000980                                                         CFT009
      *                                                                   CFT009
     ITRNEXT      DS                           3000                       CFT009
      *                                                                   CFT009
      ** Data structure to pass OTPAY data to FT000980                    CFT009
      *                                                                   CFT009
     IOTPYDS    E DSOTPAY                                                 CFT009
     I              DST1                            XDST1                 CFT009
     I              DST2                            XDST2                 CFT009
     I              DST3                            XDST3                 CFT009
     I              DST4                            XDST4                 CFT009
     I              ORBK                            XORBK                 CFT009
     I              ORC1                            XORC1                 CFT009
     I              ORC2                            XORC2                 CFT009
     I              ORC3                            XORC3                 CFT009
     I              ORC4                            XORC4                 CFT009
     I              ORC5                            XORC5                                     CFT032
     I              MDIN                            XMDIN                 CFT009
     I              RCO1                            XRCO1                 CFT009
     I              RCO2                            XRCO2                 CFT009
     I              RCO3                            XRCO3                 CFT009
     I              RCO4                            XRCO4                 CFT009
     I              RCO5                            XRCO5                 CFT009
     I              ACB1                            XACB1                 CFT009
     I              ACB2                            XACB2                 CFT009
     I              ACB3                            XACB3                 CFT009
     I              ACB4                            XACB4                 CFT009
     I              ACB5                            XACB5                 CFT009
     I              BNC1                            XBNC1                 CFT009
     I              BNC2                            XBNC2                 CFT009
     I              BNC3                            XBNC3                 CFT009
     I              BNC4                            XBNC4                 CFT009
     I              BNC5                            XBNC5                 CFT009
     I              LCD                             XLCD                  CFT009
     I              INB1                            XINB1                 CFT009
     I              INB2                            XINB2                 CFT009
     I              INB3                            XINB3                 CFT009
     I              INB4                            XINB4                 CFT009
     I              INB5                            XINB5                 CFT009
      *                                                                   CFT009
      ** Data structure to pass OTPAY data to FT000980                    CFT009
      *                                                                   CFT009
     IOTPXDS    E DSOTPAYXPD                                              CFT009
     I              OPTRI1                          XOPTR1                CFT009
     I              OPTRI2                          XOPTR2                CFT009
     I              OPTRI3                          XOPTR3                CFT009
     I              OPTRI4                          XOPTR4                CFT009
     I              OPTRI5                          XOPTR5                CFT009
     I              OPNWRK                          XPNWRK                                    CSW209
     I              OPMTPY                          XPMTPY                                    CSW209
     I              OPVALF                          XPVALF                                    CSW209
     I              OPOCB1                          XPOCB1                                    CSW209
     I              OPOCB2                          XPOCB2                                    CSW209
     I              OPOCB3                          XPOCB3                                    CSW209
     I              OPOCB4                          XPOCB4                                    CSW209
     I              OPOCB5                          XPOCB5                                    CSW209
     I              OPOCB6                          XPOCB6                                    CSW209
      *                                                                   CFT009
      ** Data structure for SDBANK access object                          CFT009
      *                                                                   CFT009
     ISDBANK    E DSSDBANKPD                                              CFT009
      *                                                                   CFT009
      **  Data Structure for Additional Cust Details Access Program                           CSW207
     ISDNAHO    E DSSDNAHOPD                                                                  CSW207
      *                                                                                       CSW207
     IWACCDS    E DSACCNTAB                                                                   CFT032
     I              RECI                            ZRECI                                     CFT032
     I              BRCA                            ZBRCA                                     CFT032
     I              PRFC                            ZPRFC                                     CFT032
     I              LCD                             ZLCD                                      CFT032
     I              CHTP                            ZCHTP                                     CFT032
     I              FRNT                            ZFRNT                                     CFT032
     I              REPA                            ZREPA                                     CFT032
     I              TMST                            ZTMST                                     CFT032
      *                                                                                       CFT032
     ISDCNST    E DSSDCNSTPD                                                                  CFT032
      *                                                                                       CFT032
     IMEBICD    E DSMEBICDPD                                                                  CFT032
      *                                                                                       CFT032
     C                     MOVEACPY@      BIS@   80
     C********************************************************************
     C*
     C************  INITIAL  PROCESSING  *********************************
     C*
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0205CCP1                                           S01408
     C*                                                                   S01408
     C*                                                                   S01117
     C** CALL ZSFILE TO LOG SPOOL FILE DETAILS FOR AUDIT REPORT           S01117
     C*                                                                   S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           RSEQ    5                       S01117
     C                     PARM *BLANKS   RENT    3                       S01117
     C                     PARM SFILU     SFILP  10                       S01117
     C                     PARM SFNUMU    SPLNO   60                      S01117
     C                     PARM *BLANKS   ZERR    1                       S01117
     C*                                                                   S01117
     C           ZERR      IFNE *BLANKS                                   S01117
     C                     SETON                     U7U8LR               S01117
     C           *LOCK     IN   DLDA                                      S01117
     C                     MOVEL'FT0205'  DBPGM                           S01117
     C                     MOVEL'FT205AU' DBKEY            ***************S01117
     C                     MOVEL'ZSFILE'  DBFILE           * DB ERROR 19 *S01117
     C                     MOVEL'019'     DBASE            ***************S01117
     C                     OUT  DLDA                                      S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C** ACCESS TABTB10 (I.C.D.R.1) ON TABFP FOR : TITL,RUND AND DATF
     C*
     C*
     C**   SET UP KEY FOR INSTALLATION CONTROL RECORD 1
     C                     MOVEL'01      'ZTABKY 12
     C                     MOVE '  10'    ZTABKY
     C*
     C           ZTABKY    CHAINTABFP                99    ON NOT THERE
     C  N99      RECI      COMP 'D'                  9999  ON, IS DELETED
     C*
     C**   CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.
     C  N99      DATF      COMP 'M'                      98MMDDYY, 98 ON
     C*
     C*
     C           *IN99     IFEQ '1'
     C           *NAMVAR   DEFN LDA       DLDA
     C           *LOCK     IN   DLDA
     C                     MOVEL'FT0205'  DBPGM
     C                     MOVELZTABKY    DBKEY            ***************
     C                     MOVE 'TABLE'   DBFILE           * DB ERROR 01 *
     C*********************MOVE '01'      DBASE            ***************S01194
     C                     MOVE '001'     DBASE                           S01194
     C                     OUT  DLDA
     C                     SETON                     U7U8LR
     C                     GOTO TAG03
     C                     END
     C*
     C**   OBTAIN THE VARIOUS RUN DATE FORMATS
     C*
     C                     MOVE RUND      WEDT    60
     C                     MOVE RUND      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZDATE     WEDTD1  60
     C                     MOVE ZADATE    PDATE
     C                     MOVE ZDATE     WDATE1
     C                     EXSR DAFDT
     C                     MOVE WDATE2    WEDTD2  20
     C                     MOVE WDATE3    WEDTD3  60
      *                                                                   S01483
      *  Access SAR details file to see if S01483 is installed.           S01483
      *                                                                   S01483
     C                     CALL 'AOSARDR0'                                S01483
     C                     PARM *BLANKS   P@RTCD  7                       S01483
     C                     PARM '*VERIFY' P@OPTN  7                       S01483
     C                     PARM 'S01483'  @SARD   6                       S01483
     C           SCSARD    PARM *BLANKS   DSFDY                           S01483
     C*                                                            S01483 070030
     C***Report*those*with*pay*dates*less*than*Next*Working*Day****S01483 070030
     C***********                                                  S01483 070030
     C***********P@RTCD    IFEQ *BLANKS                            S01483 070030
     C***********          MOVEL'S01483'  S01483  6                S01483 070030
     C***********DNWD      SUB  1         ##CDTE  50               S01483 070030
     C***********          END                                     S01483 070030
     C***********                                                         S01494
     C*
     C** ACCESS TABTB11 (I.C.D.R.2) ON TABFP FOR : DNWD & MBIN            S01117
     C*
     C**   SET UP KEY FOR INSTALLATION CONTROL RECORD 2
     C*
     C                     MOVE '  11'    ZTABKY
     C*
     C           ZTABKY    CHAINTABFP                99    ON NOT THERE
     C  N99      RECI      COMP 'D'                  9999  ON, IS DELETED
     C*
     C           *IN99     IFEQ '1'
     C           *LOCK     IN   DLDA
     C                     MOVEL'FT0205'  DBPGM
     C                     MOVELZTABKY    DBKEY            ***************
     C                     MOVE 'TABLE'   DBFILE           * DB ERROR 02 *
     C*********************MOVE '02'      DBASE            ***************S01194
     C                     MOVE '002'     DBASE                           S01194
     C                     OUT  DLDA
     C                     SETON                     U7U8LR
     C                     GOTO TAG03
     C                     END
     C*
     C** SETUP CONTROL DATE (CDAT)
     C** USE TODAY'S DATE RATHER THAN NEXT WORKING DAY TO CALCULATE IT.   082482
     C*
     C********   DNWD      SUB  1         CQDT    50                      E22509
     C*                                                                   070030
     C** Report those with pay dates less than Next Working Day           070030
     C*                                                                   070030
     C           P@RTCD    IFEQ *BLANKS                                   070030
     C                     MOVEL'S01483'  S01483  6                       070030
     C           DNWD      SUB  1         ##CDTE  50                      070030
     C                     END                                            070030
     C*                                                                   070030
     C********             Z-ADDDNWD      ZDAYNO                   E22509 082482
     C                     Z-ADDRUND      ZDAYNO                          082482
     C                     Z-ADD1         X       30                      E22509
     C           CY,X      DOWNE'   '                                     E22509
     C                     MOVE CY,X      ZCCY                            E22509
     C                     MOVE CYD,X     CYDDS                           E22509
      *                                                                   070030
      *  Set days forward to zero if S01483                               070030
      *                                                                   070030
     C           S01483    IFEQ 'S01483'                                  070030
     C                     Z-ADD0         ZNRDYS                          070030
     C                     ELSE                                           070030
     C                     Z-ADDTNOT      ZNRDYS                          E22509
     C                     END                                            070030
     C*********************EXSR ZTXDAY                              E22509S01195
     C                     EXSR ZFWDT                                     S01195
      *                                                                   070030
      *  If next working not a holiday use rundate as control date        070030
      *  otherwise use next working day in currency - 1.                  070030
      *                                                                   070030
     C                     SELEC                                          070030
      *                                                                   070030
      * S01483 not installed                                              070030
      *                                                                   070030
     C           S01483    WHNE 'S01483'                                  070030
     C                     Z-ADDZDYNBR    CYCD,X                          E22509
      *                                                                   070030
     C           S01483    WHEQ 'S01483'                                  070030
     C           ZDYNBR    ANDEQDNWD                                      070030
     C                     Z-ADDRUND      CYCD,X                          070030
      *                                                                   070030
     C                     OTHER                                          070030
     C           ZDYNBR    SUB  1         CYCD,X                          070030
     C                     ENDSL                                          070030
      *                                                                   070030
     C                     ADD  1         X                               E22509
     C                     END                                            E22509
     C*                                                                   S01414
     C* Move the conditional IF so that AOGELRR0 is always called.        S01414
     C*                                                                   S01117
     C****If*multi*branched set on 28 to display branch fields      S01117S01414
     C***********                                                   S01117S01414
     C***********MBIN      IFEQ 'Y'                                 S01117S01414
     C***********          SETON                     28             S01117S01414
     C*                                                                   S01194
     C**  Access SDGELRPD for originating branch used flag                S01194
     C**                  and Profit Centres In Use Flag                  S01414
     C*                                                                   S01194
     C**********           CALL 'AOGELRR0'                                S01194              CGL029
     C                     CALL 'AOGELRR1'                                                    CGL029
     C                     PARM '*MSG  '  @RTCD   7                       S01194
     C                     PARM '*FIRST'  @OPTN   7                       S01194
     C********** SDGELR    PARM SDGELR    DSFDY                           S01194              CGL029
     C           SDGELR    PARM SDGELR    DSSDY                                               CGL029
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
     C           *LOCK     IN   DLDA                                      S01194
     C                     MOVEL'FT0205'  DBPGM                           S01194
     C                     MOVEL@OPTN     DBKEY            ***************S01194
     C                     MOVE 'SDGELRPD'DBFILE           * DB ERROR 21 *S01194
     C                     MOVE '021'     DBASE            ***************S01194
     C                     OUT  DLDA                                      S01194
     C                     SETON                     U7U8LR               S01194
     C                     GOTO TAG03                                     S01194
     C                     END                                            S01194
     C*                                                             S01117S01414
     C**  If multi branched set on 28 to display branch fields      S01117S01414
     C*                                                             S01117S01414
     C           MBIN      IFEQ 'Y'                                 S01117S01414
     C                     SETON                     28             S01117S01414
     C*                                                                   S01194
     C**  If Originating Branch Used flag is on,set on                    S01194
     C**  indicator 29 (stops display of orig. branch field)              S01194
     C*                                                                   S01194
     C           BKOBRU    IFEQ 'Y'                                       S01194
     C                     SETON                     29                   S01194
     C                     END                                            S01194
     C                     END                                            S01117
      *                                                                   S01414
      *  Check if Profit Centres are used and set screen attributes       S01414
      *                                                                   S01414
     C           BKPRCU    IFEQ 'Y'                                       S01414
     C                     MOVE '1'       *IN70                           S01414
     C                     END                                            S01414
      *                                                                   S01435
      ** Read SDFTFRPD                                                    S01435
      *                                                                   S01435
     C                     CALL 'AOFTFRR0'             90                 S01435
     C                     PARM *BLANKS   @RTCD   7        B:Return code  S01435
     C                     PARM '*FIRST ' @OPTN   7        I:Option       S01435
     C           SDFTFR    PARM SDFTFR    DSFDY                           S01435
      *                                                                   S01435
      *  If return with an error (LR seton in called program) then        S01435
      *  process for database error.                                      S01435
      *                                                                   S01435
     C           *IN90     IFEQ '1'                                       S01435
     C           @RTCD     OREQ '*ERROR*'                                 S01435
     C           *LOCK     IN   DLDA                                      S01435
     C                     MOVEL'FT0205'  DBPGM                           S01435
     C                     MOVEL@OPTN     DBKEY            ***************S01435
     C                     MOVE 'SDFTFRPD'DBFILE           * DB ERROR 50 *S01435
     C                     MOVE '050'     DBASE            ***************S01435
     C                     OUT  DLDA                                      S01435
     C                     SETON                     U7U8LR               S01435
     C                     GOTO TAG03                                     S01435
     C                     END                                            S01435
      *                                                                   S01435
      * Get message text for Account with Bank field                      S01435
      *                                                                   S01435
     C                     CALL 'MEC1150'              9090               S01435
     C                     PARM 'FTM2350 '#MSGID  7                       S01435
     C                     PARM 'FTUSRMSG'#MSGF  10                       S01435
     C                     PARM           #MSDTA                          S01435
     C                     PARM *BLANKS   #MSTX1                          S01435
     C                     PARM *BLANKS   #MSTX2                          S01435
      *                                                                   S01435
     C                     MOVEL#MSTX1    #IMSG  35                       S01435
     C*
     C** ACCESS CURRENCIES RECORD FOR NO. OF D.P.ON BASE CCY
     C*
     C                     MOVEL*BLANKS   ZTABKY
     C                     MOVEL'20'      ZTABKY
     C                     MOVELBCCY      KEY04   4
     C                     MOVE '1'       KEY04
     C                     MOVE KEY04     ZTABKY
     C           ZTABKY    CHAINTABFP                99
     C  N99      RECI      COMP 'D'                  9999  ON, IS DELETED
     C*
     C           *IN99     IFEQ '1'
     C           *LOCK     IN   DLDA
     C                     MOVEL'FT0205'  DBPGM
     C                     MOVELZTABKY    DBKEY            ***************
     C                     MOVE 'TABLE'   DBFILE           * DB ERROR 03 *
     C*********************MOVEL'03'      DBASE            ***************S01194
     C                     MOVEL'003'     DBASE                           S01194
     C                     OUT  DLDA
     C                     SETON                     U7U8LR
     C                     GOTO TAG03
     C                     END
     C*
     C** STORE NUMBER OF DECIMAL PLACES FOR BASE CURRENCY
     C*
     C                     Z-ADDCDP       WBCDP   10
      *                                                                   S01435
      ** Access Currencies record for No. of D.P.on Local Ccy             S01435
      *                                                                   S01435
     C                     MOVEL*BLANKS   ZTABKY                          S01435
     C                     MOVEL'20'      ZTABKY                          S01435
     C                     MOVELLOCY      KEY04   4                       S01435
     C                     MOVE '1'       KEY04                           S01435
     C                     MOVE KEY04     ZTABKY                          S01435
     C           ZTABKY    CHAINTABFP                99                   S01435
     C  N99      RECI      COMP 'D'                  9999  ON, IS DELETED S01435
     C*                                                                   S01435
     C           *IN99     IFEQ '1'                                       S01435
     C           *LOCK     IN   DLDA                                      S01435
     C                     MOVEL'FT0205'  DBPGM                           S01435
     C                     MOVELZTABKY    DBKEY            ***************S01435
     C                     MOVE 'TABLE'   DBFILE           * DB ERROR 03 *S01435
     C                     MOVEL'051'     DBASE                           S01194
     C                     OUT  DLDA                                      S01435
     C                     SETON                     U7U8LR               S01435
     C                     GOTO TAG03                                     S01435
     C                     END                                            S01435
      *                                                                   S01435
      ** Store number of decimal places for Local Currency                S01435
      *                                                                   S01435
     C                     Z-ADDCDP       WLCDP   10                      S01435
     C*
     C** INITIALISE AND DEFINE WORK FIELDS
     C*
     C                     Z-ADD*ZEROS    WNORR1  50
     C                     Z-ADD*ZEROS    WHRWN1 150
     C                     Z-ADD*ZEROS    WHRDC1  30
     C*
     C                     Z-ADD*ZEROS    WNORR2  50
     C                     Z-ADD*ZEROS    WHRWN2 150
     C                     Z-ADD*ZEROS    WHRDC2  30
     C**********           MOVE *BLANK    BLNK10 10                                           CGL029
     C**********           MOVE *BLANK    BLNK2   2                                           CGL029
     C                     MOVE *BLANK    BLNK10 16                                           CGL029
     C                     MOVE *BLANK    BLNK2   8                                           CGL029
     C*
     C                     Z-ADD1         PPAGE
      *                                                                   CFT009
      ** Initialise numeric fields in OTPAYXPD                            CFT009
      *                                                                   CFT009
     C                     Z-ADD*ZEROS    OPOEXR                          CFT009
     C                     Z-ADD*ZEROS    OPSCH1                          CFT009
     C                     Z-ADD*ZEROS    OPSCH2                          CFT009
     C                     Z-ADD*ZEROS    OPSCH3                          CFT009
     C                     Z-ADD*ZEROS    OPSCH4                          CFT009
     C                     Z-ADD*ZEROS    OPSCH5                          CFT009
     C                     Z-ADD*ZEROS    OPRCRM                          CFT009
     C                     Z-ADD*ZEROS    OPRBCQ                          CFT009
     C                     Z-ADD*ZEROS    OPRCSC                          CFT009
     C                     Z-ADD*ZEROS    OPRCSQ                          CFT009
     C                     Z-ADD*ZEROS    MISC01                          CFT009
     C                     Z-ADD*ZEROS    MISC02                          CFT009
     C                     Z-ADD*ZEROS    MISC03                          CFT009
     C                     Z-ADD*ZEROS    MISC04                          CFT009
     C                     Z-ADD*ZEROS    MISC05                          CFT009
     C                     Z-ADD*ZEROS    SWSCHG                          CFT009
     C                     Z-ADD*ZEROS    DATNED                          CFT009
     C                     Z-ADD*ZEROS    DATNAO                          CFT009
     C                     Z-ADD*ZEROS    OPCHRT                          CFT009
     C                     Z-ADD*ZEROS    MISCC1                          CFT009
     C                     Z-ADD*ZEROS    MISCC2                          CFT009
     C                     Z-ADD*ZEROS    MISCC3                          CFT009
     C                     Z-ADD*ZEROS    MISCC4                          CFT009
     C                     Z-ADD*ZEROS    MISCC5                          CFT009
     C                     Z-ADD*ZEROS    SWSCCC                          CFT009
     C*                                                                   S01494
     C** Access SAR details file to determine if S01494 is switched ON    S01494
     C*                                                                   S01494
     C                     MOVE '0'       *IN30                           S01494
     C                     CALL 'AOSARDR0'                                S01494
     C                     PARM *BLANKS   @RTCD   7                       S01494
     C                     PARM '*VERIFY' @OPTN   7                       S01494
     C                     PARM 'S01494'  @SARD   6                       S01494
     C           SCSARD    PARM SCSARD    DSFDY                           S01494
     C*                                                                   S01494
     C** If core feature is switched ON, set a variable field to          S01494
     C** condition the rest of the processing                             S01494
     C*                                                                   S01494
     C           @RTCD     IFEQ *BLANKS                                   S01494
     C                     MOVE '1'       *IN30                           S01494
     C                     ELSE                                           S01494
     C*                                                                   S01494
     C** else, database error (return code other than *NRF)               S01494
     C*                                                                   S01494
     C           @RTCD     IFNE '*NRF   '                                 S01494
     C           *LOCK     IN   DLDA                                      S01494
     C                     MOVEL'FT0205'  DBPGM                           S01499
     C                     MOVE 'SCSARDPD'DBFILE           ************   S01494
     C                     MOVEL'*VERIFY' DBKEY            * DBERR 30 *   S01494
     C                     MOVE '030'     DBASE            ************   S01494
     C                     OUT  DLDA                                      S01494
     C                     SETON                     U7U8LR               S01494
     C                     GOTO TAG03                                     S01494
     C                     END                                            S01494
     C                     END                                            S01494
     C*                                                                   S01499
     C** Access SAR details file to determine if S01499 is switched ON    S01499
     C*                                                                   S01499
     C                     MOVE '0'       *IN31                           S01499
     C                     CALL 'AOSARDR0'                                S01499
     C                     PARM *BLANKS   @RTCD   7                       S01499
     C                     PARM '*VERIFY' @OPTN   7                       S01499
     C                     PARM 'S01499'  @SARD   6                       S01499
     C           SCSARD    PARM SCSARD    DSFDY                           S01499
     C*                                                                   S01499
     C** If core feature is switched ON, set a variable field to          S01499
     C** condition the rest of the processing                             S01499
     C*                                                                   S01499
     C           @RTCD     IFEQ *BLANKS                                   S01499
     C                     MOVE '1'       *IN31                           S01499
     C                     ELSE                                           S01499
     C*                                                                   S01499
     C** else, database error (return code other than *NRF)               S01499
     C*                                                                   S01499
     C           @RTCD     IFNE '*NRF   '                                 S01499
     C           *LOCK     IN   DLDA                                      S01499
     C                     MOVEL'FT0205'  DBPGM                           S01499
     C                     MOVE 'SCSARDPD'DBFILE           ************   S01499
     C                     MOVEL'*VERIFY' DBKEY            * DBERR 31 *   S01499
     C                     MOVE '031'     DBASE            ************   S01499
     C                     OUT  DLDA                                      S01499
     C                     SETON                     U7U8LR               S01499
     C                     GOTO TAG03                                     S01499
     C                     END                                            S01499
     C                     END                                            S01499
      *                                                                   CFT014
      ** Access SAR details file to determine if CFT014 is switched ON.   CFT014
      *                                                                   CFT014
     C                     CALL 'AOSARDR0'                                CFT014
     C                     PARM *BLANKS   @RTCD                           CFT014
     C                     PARM '*VERIFY' @OPTN                           CFT014
     C                     PARM 'CFT014'  @SARD                           CFT014
     C           SCSARD    PARM SCSARD    DSFDY                           CFT014
      *                                                                   CFT014
      ** If core feature is switched ON, set a variable field to          CFT014
      ** condition the rest of the processing.                            CFT014
      *                                                                   CFT014
     C                     MOVE *OFF      *IN32                           CFT014
     C           @RTCD     IFEQ *BLANKS                                   CFT014
     C                     MOVE 'Y'       CFT014  1                       CFT014
     C                     MOVE *ON       *IN32                           CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
      ** Else, database error (return code other than *NRF).              CFT014
      *                                                                   CFT014
     C           @RTCD     IFNE '*NRF   '                                 CFT014
     C           *LOCK     IN   DLDA                                      CFT014
     C                     MOVE '033'     DBASE                           CFT014
     C                     MOVEL'CFT014'  DBKEY                           CFT014
     C                     MOVEL'SCSARDPD'DBFILE                          CFT014
     C                     MOVEL'FT0205'  DBPGM                           CFT014
     C                     OUT  DLDA                                      CFT014
     C                     SETON                     U7U8LR               CFT014
     C                     GOTO TAG03                                     CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      *                                                                   CFT009
      ** Access SAR details file to determine if CFT009 is switched ON    CFT009
      *                                                                   CFT009
     C                     CALL 'AOSARDR0'                                CFT009
     C                     PARM *BLANKS   @RTCD   7                       CFT009
     C                     PARM '*VERIFY' @OPTN   7                       CFT009
     C                     PARM 'CFT009'  @SARD   6                       CFT009
     C           SCSARD    PARM SCSARD    DSFDY                           CFT009
      *                                                                   CFT009
      ** If core feature is switched ON, set a variable field to          CFT009
      ** condition the rest of the processing                             CFT009
      *                                                                   CFT009
     C           @RTCD     IFEQ *BLANKS                                   CFT009
     C                     MOVE 'Y'       CFT009  1                       CFT009
     C                     SETON                     69                   CFT009
     C                     ELSE                                           CFT009
      *                                                                   CFT009
      ** else, database error (return code other than *NRF)               CFT009
      *                                                                   CFT009
     C                     MOVE ' '       CFT009                          CFT009
     C                     SETOF                     69                   CFT009
     C           @RTCD     IFNE '*NRF   '                                 CFT009
     C           *LOCK     IN   DLDA                                      CFT009
     C                     MOVEL'FT0205'  DBPGM                           CFT009
     C                     MOVE 'SCSARDPD'DBFILE           ************   CFT009
     C                     MOVEL'*VERIFY' DBKEY            * DBERR 32 *   CFT009
     C                     MOVE '032'     DBASE            ************   CFT009
     C                     OUT  DLDA                                      CFT009
     C                     SETON                     U7U8LR               CFT009
     C                     GOTO TAG03                                     CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Access SAR details file to determine if CFT010 is switched ON    CFT009
      *                                                                   CFT009
     C                     CALL 'AOSARDR0'                                CFT009
     C                     PARM *BLANKS   @RTCD   7                       CFT009
     C                     PARM '*VERIFY' @OPTN   7                       CFT009
     C                     PARM 'CFT010'  @SARD   6                       CFT009
     C           SCSARD    PARM SCSARD    DSFDY                           CFT009
      *                                                                   CFT009
      ** If core feature is switched ON, set a variable field to          CFT009
      ** condition the rest of the processing                             CFT009
      *                                                                   CFT009
     C           @RTCD     IFEQ *BLANKS                                   CFT009
     C                     MOVE 'Y'       CFT010  1                       CFT009
     C                     ELSE                                           CFT009
      *                                                                   CFT009
      ** else, database error (return code other than *NRF)               CFT009
      *                                                                   CFT009
     C                     MOVE ' '       CFT010                          CFT009
     C           @RTCD     IFNE '*NRF   '                                 CFT009
     C           *LOCK     IN   DLDA                                      CFT009
     C                     MOVEL'FT0205'  DBPGM                           CFT009
     C                     MOVE 'SCSARDPD'DBFILE           ************   CFT009
     C                     MOVEL'*VERIFY' DBKEY            * DBERR 33 *   CFT009
     C                     MOVE '033'     DBASE            ************   CFT009
     C                     OUT  DLDA                                      CFT009
     C                     SETON                     U7U8LR               CFT009
     C                     GOTO TAG03                                     CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                                       CFT151
      ** Access SAR details file to determine if CFT151 is switched ON                        CFT151
      *                                                                                       CFT151
     C                     CALL 'AOSARDR0'                                                    CFT151
     C                     PARM *BLANKS   @RTCD   7                                           CFT151
     C                     PARM '*VERIFY' @OPTN   7                                           CFT151
     C                     PARM 'CFT151'  @SARD   6                                           CFT151
     C           SCSARD    PARM SCSARD    DSFDY                                               CFT151
      *                                                                                       CFT151
      ** If core feature is switched ON, set a variable field to                              CFT151
      ** condition the rest of the processing                                                 CFT151
      *                                                                                       CFT151
     C           @RTCD     IFEQ *BLANKS                                                       CFT151
     C                     MOVE 'Y'       CFT151  1                                           CFT151
     C                     ELSE                                                               CFT151
      *                                                                                       CFT151
      ** else, database error (return code other than *NRF)                                   CFT151
      *                                                                                       CFT151
     C                     MOVE 'N'       CFT151                                              CFT151
     C           @RTCD     IFNE '*NRF   '                                                     CFT151
     C           *LOCK     IN   DLDA                                                          CFT151
     C                     MOVEL'FT0205'  DBPGM                                               CFT151
     C                     MOVE 'SCSARDPD'DBFILE           ************                       CFT151
     C                     MOVEL'*VERIFY' DBKEY            * DBERR 33 *                       CFT151
     C                     MOVE '033'     DBASE            ************                       CFT151
     C                     OUT  DLDA                                                          CFT151
     C                     SETON                     U7U8LR                                   CFT151
     C                     GOTO TAG03                                                         CFT151
     C                     ENDIF                                                              CFT151
     C                     ENDIF                                                              CFT151
      *                                                                   CFT009
      ** Check if SWIFT Changes 2003 (CSW203) is installed                                    CSW203
      *                                                                                       CSW203
     C                     CALL 'SWIF2003'                                                    CSW203
     C                     PARM *BLANKS   PRTCD   7                                           CSW203
      *                                                                                       CSW203
     C           PRTCD     IFEQ 'CSW2003'                                                     CSW203
     C                     MOVE 'Y'       CSW203  1                                           CSW203
     C                     MOVE *ON       *IN33                                               CSW203
     C                     ELSE                                                               CSW203
     C                     MOVE 'N'       CSW203                                              CSW203
     C                     MOVE *OFF      *IN33                                               CSW203
     C                     ENDIF                                                              CSW203
      *                                                                                       CSW203
      ** Check if SWIFT Changes 2007 (CSW207) is installed                                    CSW207
      *                                                                                       CSW207
     C                     CALL 'SWIF2007'                                                    CSW207
     C                     PARM *BLANKS   PRTCD   7                                           CSW207
      *                                                                                       CSW207
     C           PRTCD     IFEQ 'CSW2007'                                                     CSW207
     C                     MOVE 'Y'       CSW207  1                                           CSW207
     C                     ELSE                                                               CSW207
     C                     MOVE 'N'       CSW207                                              CSW207
     C                     ENDIF                                                              CSW207
      *                                                                                       CSW207
      *                                                                                       CSW209
      ** Check if SWIFT Changes 2009 (CSW209) is installed.                                   CSW209
      *                                                                                       CSW209
     C                     CALL 'SWIF2009'                                                    CSW209
     C                     PARM *BLANKS   PRTCD                                               CSW209
      *                                                                                       CSW209
     C           PRTCD     IFEQ 'CSW2009'                                                     CSW209
     C                     MOVE 'Y'       CSW209  1                                           CSW209
     C                     SETON                     72                                       CSW209
     C                     ELSE                                                               CSW209
     C                     MOVE 'N'       CSW209                                              CSW209
     C                     SETOF                     72                                       CSW209
     C                     ENDIF                                                              CSW209
     C/COPY WNCPYSRC,FT0205C018
     C*                                                                   S01499
     C           *IN31     IFEQ '1'                                       S01499
     C*                                                                   S01499
     C***********1         CHAINABSFI1F1             24                   S01499
     C                     CALL 'AOVATR0'              2424               S01499
     C                     PARM '*MSG   ' P@RTCD  7        B:Return code  S01499
     C                     PARM '*FIRST ' P@OPTN  7        I:Option       S01499
     C                     PARM           VATDS                           S01499
     C*                                                                   S01499
     C** If return with an error (LR seton in called program) then        S01499
     C** process for database error.                                      S01499
     C*                                                                   S01499
     C           *IN24     IFEQ '1'                                       S01499
     C           P@RTCD    OREQ '*ERROR*'                                 S01499
     C           *LOCK     IN   DLDA                                      S01499
     C                     MOVEL'FT0205'  DBPGM                           S01499
     C                     MOVEL'ABSFI101'DBKEY            ************   S01499
     C                     MOVE 'TABLE'   DBFILE           * DBERR 24 *   S01499
     C                     MOVE '024'     DBASE            ************   S01499
     C                     OUT  DLDA                                      S01499
     C                     SETON                     U7U8LR               S01499
     C                     GOTO TAG03                                     S01499
     C                     END                                            S01499
     C                     END                                            S01499
      *                                                                                       CER030
      ** Check if 'CER031' is switched 'ON'                                                   CER030
      *                                                                                       CER030
     C                     CALL 'AOSARDR0'                                                    CER030
     C                     PARM *BLANKS   PRTCD                                               CER030
     C                     PARM '*VERIFY' POPTN                                               CER030
     C                     PARM 'CER031'  PSARD   6                                           CER030
     C           SCSARD    PARM SCSARD    DSFDY                                               CER030
      *                                                                                       CER030
     C           PRTCD     IFEQ *BLANKS                                                       CER030
     C                     MOVE 'Y'       CER031  1                                           CER030
     C                     MOVE *ON       *IN41                                               CER030
     C                     ELSE                                                               CER030
      *                                                                                       CER030
      ** else, database error (return code other than *NRF)                                   CER030
      *                                                                                       CER030
     C           PRTCD     IFNE '*NRF   '                                                     CER030
      *                                                                                       CER030
     C           *LOCK     IN   DLDA                                                          CER030
     C                     MOVEL'FT0205'  DBPGM                                               CER030
     C                     MOVE 'SCSARDPD'DBFILE                                              CER030
     C                     MOVEL'*VERIFY' DBKEY                                               CER030
     C                     MOVE '998'     DBASE                                               CER030
     C                     OUT  DLDA                                                          CER030
     C                     SETON                     U7U8LR                                   CER030
     C                     GOTO TAG03                                                         CER030
     C                     ELSE                                                               CER030
      *                                                                                       CER030
     C                     MOVE 'N'       CER031                                              CER030
     C                     MOVE *OFF      *IN41                                               CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
      ** Check if 'CFT003' is switched 'ON'                                                   CER030
      *                                                                                       CER030
     C                     CALL 'AOSARDR0'                                                    CER030
     C                     PARM *BLANKS   PRTCD                                               CER030
     C                     PARM '*VERIFY' POPTN                                               CER030
     C                     PARM 'CFT003'  PSARD   6                                           CER030
     C           SCSARD    PARM SCSARD    DSFDY                                               CER030
     C           PRTCD     IFEQ *BLANKS                                                       CER030
     C                     MOVE 'Y'       CFT003  1                                           CER030
     C                     MOVE *ON       *IN42                                               CER030
     C                     ELSE                                                               CER030
      *                                                                                       CER030
      ** else, database error (return code other than *NRF)                                   CER030
      *                                                                                       CER030
     C           PRTCD     IFNE '*NRF   '                                                     CER030
      *                                                                                       CER030
     C           *LOCK     IN   DLDA                                                          CER030
     C                     MOVEL'FT0205'  DBPGM                                               CER030
     C                     MOVE 'SCSARDPD'DBFILE                                              CER030
     C                     MOVEL'*VERIFY' DBKEY                                               CER030
     C                     MOVE '999'     DBASE                                               CER030
     C                     OUT  DLDA                                                          CER030
     C                     SETON                     U7U8LR                                   CER030
     C                     GOTO TAG03                                                         CER030
      *                                                                                       CER030
     C                     ELSE                                                               CER030
     C                     MOVE 'N'       CFT003                                              CER030
     C                     MOVE *OFF      *IN42                                               CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
      *                                                                                       CFT120
      ** Check if 'CFT120' is switched 'ON'                                                   CFT120
      *                                                                                       CFT120
     C                     CALL 'AOSARDR0'                                                    CFT120
     C                     PARM *BLANKS   PRTCD                                               CFT120
     C                     PARM '*VERIFY' POPTN                                               CFT120
     C                     PARM 'CFT120'  PSARD                                               CFT120
     C           SCSARD    PARM SCSARD    DSFDY                                               CFT120
     C           PRTCD     IFEQ *BLANKS                                                       CFT120
     C                     MOVE 'Y'       CFT120  1                                           CFT120
     C                     MOVE *ON       *IN59                                               CFT120
     C                     ELSE                                                               CFT120
      *                                                                                       CFT120
      ** else, database error (return code other than *NRF)                                   CFT120
      *                                                                                       CFT120
     C           PRTCD     IFNE '*NRF   '                                                     CFT120
      *                                                                                       CFT120
     C           *LOCK     IN   DLDA                                                          CFT120
     C                     MOVEL'CFT120'  DBPGM                                               CFT120
     C                     MOVE 'SCSARDPD'DBFILE                                              CFT120
     C                     MOVEL'*VERIFY' DBKEY                                               CFT120
     C                     MOVE '1000'    DBASE                                               CFT120
     C                     OUT  DLDA                                                          CFT120
     C                     SETON                     U7U8LR                                   CFT120
     C                     GOTO TAG03                                                         CFT120
      *                                                                                       CFT120
     C                     ELSE                                                               CFT120
     C                     MOVE 'N'       CFT120                                              CFT120
     C                     MOVE *OFF      *IN59                                               CFT120
     C                     ENDIF                                                              CFT120
      *                                                                                       CFT120
     C                     ENDIF                                                              CFT120
     C*                                                                   S01194
     C********************************************************************
     C/EJECT
     C********************************************************************
     C*
     C************  MAIN  PROCESSING  ************************************
     C*
     C*
     C           TAG01     TAG                             ***TAG01 TAG***
     C*
     C*********************READ RGPAY                  2120               S01117
     C                     READ RGPAYBB                2120               S01117
     C*
     C           *IN21     IFEQ '1'                        READ FAIL
     C           *LOCK     IN   DLDA
     C                     MOVEL'FT0205'  DBPGM
     C                     MOVEL'READ OPE'KEY15  15
     C                     MOVE 'RATION ' KEY15            ***************
     C                     MOVEL'FAILED'  KEY06   6        * DB ERROR 04 *
     C                     MOVELKEY15     KEY21  21        ***************
     C                     MOVE KEY06     KEY21
     C                     MOVELKEY21     DBKEY
     C*********************MOVE 'RGPAY'   DBFILE                          S01194
     C*********************MOVE '04'      DBASE                           S01194
     C                     MOVE 'RGPAYBB' DBFILE                          S01194
     C                     MOVE '004'     DBASE                           S01194
     C                     OUT  DLDA
     C                     SETON                     U7U8LR
     C                     GOTO TAG03
     C                     END
      *                                                                   CFT009
      ** Chain to extension file if CFT009 is turned on, to pick up       CFT009
      ** extra info.                                                      CFT009
      *                                                                   CFT009
     C           *IN20     IFEQ *OFF                                      CFT009
     C           CFT009    ANDEQ'Y'                                       CFT009
      *                                                                   CFT009
      ** Save RATED from RP record for later use.                         CFT009
      *                                                                   CFT009
     C                     Z-ADDRATED     SAVRTD 138                      CFT009
      *                                                                   CFT009
     C           PREF      CHAINOTPAYXL2             99                   CFT009
      *                                                                   CFT009
      ** Error if record not found.                                       CFT009
      *                                                                   CFT009
     C           *IN99     IFEQ *ON                                       CFT009
     C           *LOCK     IN   DLDA                                      CFT009
     C                     MOVE '053'     DBASE                           CFT009
     C                     MOVELWPREF     DBKEY                           CFT009
     C                     MOVEL'OTPAYXL2'DBFILE                          CFT009
     C                     MOVEL'FT0205'  DBPGM                           CFT009
     C                     OUT  DLDA                                      CFT009
     C                     SETON                     U7U8LR               CFT009
     C                     GOTO TAG03                                     CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
     C*
     C**   IF END OF FILE END PROGRAM
     C*
     C           *IN20     IFEQ '1'
     C                     SETON                     LR
     C                     GOTO TAG03
     C                     END
     C*
     C**   KEEP TOTAL OF RECORDS READ AND A HASH TOTAL OF 'SMAM'
     C*
     C                     ADD  1         WNORR1
     C*
     C           SMAM      DIV  1000      ZZAMT
     C                     Z-ADDWHRWN1    ZZTOTI
     C                     Z-ADDWHRDC1    ZZTOTD
     C*
     C                     EXSR GLZADD
     C*
     C                     Z-ADDZZTOTI    WHRWN1
     C                     Z-ADDZZTOTD    WHRDC1
     C*
     C**   SAVE CRITICAL FIELD VALUES
     C*
     C                     MOVE PREF      WPREF  15
     C                     MOVE NPDT      WNPD    60
     C                     MOVE FDAT      WFDAT   60
     C                     MOVE PAYF      WPAYF   1
     C                     MOVE DYIM      WDYIM   20
     C                     MOVE SMCY      WSMCY   3
     C                     MOVE PCCY      WRCCY   3
     C                     MOVE SMAM      WSMAM  150
     C                     MOVE PYAM      WPYAM  150
     C                     MOVE RATE      WRATE  138
     C*
     C**   If next payment date less than or equal to control date ...    S01117
     C*                                                                   S01117
     C                     Z-ADD1         X                               E22509
     C           WRCCY     LOKUPCY,X                     36               E22509
     C*                                                                   E22509
     C***********WNPD******IFLE CQDT                                S01117E22509
     C           WNPD      IFLE CYCD,X                                    E22509
     C***********S01483    ANDNE'S01483'                           S01483 070030
     C           S01483    OREQ 'S01483'                                  S01483
     C           WNPD      ANDLE##CDTE                                    S01483
     C*                                                                   S01117
     C**   Check branch code is valid...if so,output branch name          S01117
     C*                                                                   S01117
     C           *IN28     IFEQ '1'                                       S01117
     C*                                                                   S01117
     C**  Set up booking branch name                                      S01117
     C*                                                                   S01117
     C                     MOVE BRCA      BRANCH  3                       S01117
     C                     EXSR BRNAM                                     S01117
     C                     MOVE A8BRNM    BRNM                            S01117
     C*                                                                   S01117
     C**  Set up originating branch name                                  S01117
     C*                                                                   S01117
     C           *IN29     IFEQ '1'                                       S01117
     C                     MOVE ORBR      BRANCH                          S01117
     C                     EXSR BRNAM                                     S01117
     C                     MOVE A8BRNM    BRNO                            S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C**  Obtain ZLOC for holidays processing & call ZSFILE               S01117
     C*                                                                   S01117
     C                     EXSR GETLOC                                    S01195
     C                     EXSR RCFRT                      Call ZSFILE    S01117
     C                     END                                            S01117
     C*
     C           TAG02     TAG                             ***TAG02 TAG***
     C                     Z-ADD1         X                               E22509
     C           WRCCY     LOKUPCY,X                     36               E22509
     C*
     C**   COMPARE NEXT PAYMENT DATE WITH THE CONTROL DATE
     C*
     C********** WNPD      IFLE CQDT                       ***BEG IF 01***E22509
     C           WNPD      IFLE CYCD,X                                    E22509
     C***********S01483    ANDNE'S01483'                           S01478 070030
     C           S01483    OREQ 'S01483'                                  S01478
     C           WNPD      ANDLE##CDTE                                    S01478
     C*
     C**     WRITE A NEW RECORD TO 'OTPAYDD'
     C*
     C/COPY WNCPYSRC,FTH00321
     C                     EXSR CDATE
     C*
     C           *IN22     IFEQ '1'                        WRITE FAILED
     C           *IN99     OREQ '1'                        CHAIN FAIL
     C                     GOTO TAG03
     C/COPY WNCPYSRC,FT0205C025
     C                     END
     C*
     C/COPY WNCPYSRC,FT0205C026
     C*
     C**     PRINT A RECORD ON THE PRINTER FILE
     C*
     C                     EXSR PRTP1
     C*
     C           *IN99     IFEQ '1'
     C                     GOTO TAG03
     C                     END
     C*
     C**   COMPARE NEXT PAYMENT DATE WITH THE FINAL PAYMENT DATE
     C*
     C           WNPD      IFEQ WFDAT                      ***BEG IF 02***
     C*
     C**   UPDATE REGULAR PAYMENTS RECORD
     C*
     C                     EXSR OUUDT
     C*
     C           *IN23     IFEQ '1'                        CHAIN FAIL
     C           *IN25     OREQ '1'                        UPDATE FAILED
     C                     GOTO TAG03
     C                     END
     C*
     C*
     C**   UPDATE THE TRAILER 'OTPAYZZ'
     C*
     C                     EXSR UTRLR
     C*
     C           *IN26     IFEQ '1'                        NO TRAILER
     C           *IN27     OREQ '1'                        UPDATE FAILED
     C                     GOTO TAG03
     C                     END
     C*
     C**   READ ANOTHER RECORD
     C*
     C                     GOTO TAG01
     C*
     C                     END                             ***END IF 02***
     C*
     C**   SETUP THE NEXT PAYMENT DATE
     C*
     C                     MOVE WNPD      ZDAYNO
     C                     MOVE WSMCY     ZCCY
     C***********          MOVE WPAYF     ZFREQ                           062394
     C***********          MOVE WDYIM     ZMDAY                           062394
     C                     MOVE WPAYF     ZFREQ   1                       062394
     C                     MOVE WDYIM     ZMDAY   20                      062394
     C                     MOVE *BLANKS   ZLOC                            S01195
     C*
     C*********************EXSR ZFREQB                                    062394
      *                                                                   062394
      * Call FT0310 to calculate new date                                 062394
      *                                                                   062394
     C                     CALL 'FT0310'               9090               062394
     C                     PARM *BLANKS   ZZERR@  7                       062394
     C                     PARM '*NEWDATE'W0ACT   8                       062394
     C                     PARM ZFREQ     W0FREQ  1                       062394
     C           ZDAYNO    PARM ZDAYNO    W0RDNB  50                      062394
     C                     PARM ZMDAY     W0MDAY  20                      062394
     C                     PARM ZCCY      W0CCY   3                       062394
     C                     PARM ZLOC      W0LOC   3                       062394
      *                                                                   062394
      *  If error on call                                                 062394
      *                                                                   062394
     C           ZZERR@    IFNE *BLANKS                                   062394
     C           *IN90     OREQ '1'                                       062394
     C           *LOCK     IN   DLDA                                      062394
     C                     MOVEL'FT0205'  DBPGM                           062394
     C                     MOVEL'*CALL'   DBKEY                           062394
     C                     MOVE 'FT0310 ' DBFILE                          062394
     C                     MOVE '801'     DBASE                           062394
     C                     OUT  DLDA                                      062394
     C                     SETON                     U7U8LR               062394
     C                     GOTO TAG03                                     062394
     C                     END                                            062394
     C*
     C**   IF THE 'NEW' NEXT PAYMENT DATE IS LESS THAN OR EQUAL TO THE
     C**   'OLD'  NEXT PAYMENT DATE - ERROR
     C*
     C           ZDAYNO    IFLE WNPD
     C           *LOCK     IN   DLDA
     C*********************MOVEL'FT0200'  DBPGM                           S01194
     C                     MOVEL'FT0205'  DBPGM                           S01194
     C                     MOVEL'NEXT PAY'KEY16  16
     C                     MOVE 'MENT DAT'KEY16            ***************
     C                     MOVEL'E IN ERR'KEY10  10        * DB ERROR 16 *
     C                     MOVE 'OR'      KEY10            ***************
     C                     MOVELKEY16     KEY26  26
     C                     MOVE KEY10     KEY26
     C                     MOVELKEY26     DBKEY
     C*********************MOVE 'RGPAY'   DBFILE                          S01194
     C*********************MOVE '16'      DBASE                           S01194
     C                     MOVE 'RGPAYBB' DBFILE                          S01194
     C                     MOVE '016'     DBASE                           S01194
     C                     OUT  DLDA
     C                     SETON                     U7U8LR
     C                     GOTO TAG03
     C                     END
     C*
     C           ZDAYNO    IFGT WFDAT
     C                     Z-ADDWFDAT     WNPD
     C                     ELSE
     C                     Z-ADDZDAYNO    WNPD
     C                     END
     C*
     C**   DETERMINE IF RECORDS HAVE TO BE WRITTEN/PRINTED AS BEFORE
     C**   WITH THE 'NEW' NEXT PAYMENT DATE
     C*
     C                     GOTO TAG02
     C*
     C                     END                             ***END IF 01***
     C*
     C**   IF RECORDS WERE WRITTEN WHERE THE NEXT PAYMENT DATE WAS LESS
     C**   THAN THE FINAL DATE - UPDATE THE REGULAR PAYMENT RECORD WITH
     C**   THE LATEST 'NEXT PAYMENT DATE'
     C*
     C           WNORR2    IFGE 1                          ***BEG IF 03***
     C*
     C**     UPDATE REGULAR PAYMENTS RECORD
     C*
     C                     EXSR RPUDT
     C*
     C           *IN23     IFEQ '1'                        CHAIN FAIL
     C           *IN25     OREQ '1'                        UPDATE FAILED
     C                     GOTO TAG03
     C                     END
     C*
     C*
     C**   UPDATE THE TRAILER 'OTPAYZZ'
     C*
     C                     EXSR UTRLR
     C*
     C           *IN26     IFEQ '1'                        NO TRAILER
     C           *IN27     OREQ '1'                        UPDATE FAILED
     C                     GOTO TAG03
     C                     END
     C*
     C*
     C                     END                             ***END IF 03***
     C*
     C**  READ ANOTHER RECORD
     C*
     C                     GOTO TAG01
     C*
     C           TAG03     TAG                             ***TAG03 TAG***
     C*
     C** FINAL PROCESSING: PRINT RUN CONTROLS REPORT
     C*
     C                     EXSR PRTP2
     C*
     C********************************************************************S01195
     C/EJECT                                                              S01195
     C********************************************************************S01195
     C           GETLOC    BEGSR                                          S01195
     C*                                                                   S01195
     C**  Subroutine to obtain ZLOC,for holidays processing.....          S01195
     C*                                                                   S01195
     C                     SETOF                     40                   S01195
     C*                                                                   S01195
     C**  Check senders correspondent type and set up fields              S01195
     C**  for access of SDNOSTPD                                          S01195
     C*                                                                   S01195
     C           SNCT      IFEQ 'N'                                       S01195
     C           SNCT      OREQ 'R'                                       S01195
     C*                                                                   S01195
     C           SNCT      IFEQ 'N'                                       S01195
     C***********          MOVE SNCO      @NONB                     S01195050921
     C                     MOVELSNCO      @NONB                           050921
     C                     MOVE PCCY      @CYCD                           S01195
     C                     MOVE *BLANKS   @CUST                           S01195
     C                     MOVE *BLANKS   @ACCD                           S01195
     C                     MOVE *BLANKS   @ACSN                           S01195
     C                     MOVE *BLANKS   @BRCC                           S01195
     C                     EXSR NOSTRO                                    S01195
     C           *IN40     IFEQ '0'                                       S01195
     C                     EXSR ERROR                                     S01195
     C                     END                                            S01195
     C                     END                                            S01195
     C*                                                                   S01195
     C           SNCT      IFEQ 'R'                                       S01195
     C                     MOVELSNCO      ACNO                            S01195
     C                     EXSR RETAIL                                    S01195
     C                     END                                            S01195
     C*                                                                   S01195
     C                     ELSE                                           S01195
     C*                                                                   S01195
     C**  Check destination type....and set up fields for SDNOSTPD        S01195
     C*                                                                   S01195
     C           DSTT      IFEQ 'F'                                       S01195
     C                     MOVELDST1      @CYCD                           S01195
     C                     MOVELDST1      WNONB   5                       S01195
     C                     MOVE WNONB     @NONB                           S01195
     C                     MOVE *BLANKS   @CUST                           S01195
     C                     MOVE *BLANKS   @ACCD                           S01195
     C                     MOVE *BLANKS   @ACSN                           S01195
     C                     MOVE *BLANKS   @BRCC                           S01195
     C                     EXSR NOSTRO                                    S01195
     C           *IN40     IFEQ '0'                                       S01195
     C                     EXSR ERROR                                     S01195
     C                     END                                            S01195
     C                     END                                            S01195
     C*                                                                   S01195
     C           DSTT      IFEQ 'R'                                       S01195
     C                     MOVELDST1      ACNO                            S01195
     C                     EXSR RETAIL                                    S01195
     C                     END                                            S01195
     C*                                                                   S01195
     C           DSTT      IFEQ 'G'                                       S01195
     C                     MOVE @DCUS     @CUST                           S01195
     C                     MOVE @DCCY     @CYCD                           S01195
     C                     MOVE @DCOD     @ACCD                           S01195
     C                     MOVE @DSEQ     @ACSN                           S01195
     C                     MOVE @DBRC     @BRCC                           S01195
     C                     MOVE *BLANKS   @NONB                           S01195
     C                     EXSR NOSTRO                                    S01195
     C                     END                                            S01195
     C*                                                                   S01195
     C                     END                                            S01195
     C*                                                                   S01195
     C           *IN40     IFEQ '1'                                       S01195
     C                     SETOF                     40                   S01195
     C                     MOVE NLOC      ZLOC                            S01195
     C                     MOVE PCCY      ZCCY                            S01195
     C                     ELSE                                           S01195
     C                     MOVE SLOC      ZLOC                            S01195
     C                     MOVE LOCY      ZCCY                            S01195
     C                     END                                            S01195
     C*                                                                   S01195
     C/COPY WNCPYSRC,FT0205C004
     C                     ENDSR                                          S01195
     C*                                                                   S01195
     C********************************************************************S01117
     C/EJECT                                                              S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C**  Subroutine to set up parameters for,and to call ZSFILE          S01117
     C*                                                                   S01117
     C           RCFRT     BEGSR                                          S01117
     C*                                                                   S01117
     C           STBRCA    IFEQ *BLANKS                                   S01117
     C           STBRCA    ORNE BRCA                                      S01117
     C*                                                                   S01117
     C* WRITE END OF REPORT FOR BRANCH                                    S01117
     C*                                                                   S01117
     C           *IN19     IFEQ '1'                                       S01117
     C                     WRITEP1EOR                                     S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C**  Set up entity for call to ZSFILE                                S01117
     C*                                                                   S01117
     C                     MOVE BRCA      ZSENT                           S01117
     C*                                                                   S01117
     C                     CLOSEFT0205P1                                  S01117
     C                     OPEN FT0205P1                                  S01117
     C                     Z-ADD1         PPAGE                           S01117
     C*                                                                   S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           @RSEQ   5                       S01117
     C                     PARM           ZSENT   3                       S01117
     C                     PARM SFIL1     SFILP  10                       S01117
     C                     PARM SFNUM1    SPLNO   60                      S01117
     C                     PARM *BLANKS   ZERR    1                       S01117
     C*                                                                   S01117
     C           ZERR      IFNE *BLANKS                                   S01117
     C                     SETON                     U7U8LR               S01117
     C           *LOCK     IN   DLDA                                      S01194
     C                     MOVEL'FT0205'  DBPGM                           S01194
     C                     MOVEL'FT205P1' DBKEY            ***************S01194
     C                     MOVE 'ZSFILE'  DBFILE           * DB ERROR 20 *S01194
     C                     MOVEL'020'     DBASE            ***************S01194
     C                     OUT  DLDA                                      S01194
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C**  Move new branch value to store value                            S01117
     C*                                                                   S01117
     C                     MOVE BRCA      STBRCA  3                       S01117
     C*                                                                   S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     ENDSR                                          S01117
     C********************************************************************
     C/EJECT
     C********************************************************************
     C*                                                                   S01117
     C           BRNAM     BEGSR                                          S01117
     C*                                                                   S01117
     C**********           CALL 'AOBRCHR0'                                S01117              CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C                     PARM BRANCH    @BRCD   3                       S01117
     C********** SDBRCH    PARM SDBRCH    DSFDY                           S01117              CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C*                                                                   S01117
     C           @RTCD     IFNE *BLANKS                                   S01117
     C           *LOCK     IN   DLDA                                      S01117
     C                     MOVEL'FT0205'  DBPGM                           S01117
     C                     MOVELBRANCH    DBKEY            ***************S01117
     C                     MOVE 'SDBRCHPD'DBFILE           * DB ERROR 19 *S01117
     C                     MOVE '019'     DBASE            ***************S01117
     C                     OUT  DLDA                                      S01117
     C                     SETON                     U7U8LR               S01117
     C                     GOTO TAG03                                     S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     ENDSR                                          S01117
     C*                                                                   S01117
     C********************************************************************S01117
     C/EJECT                                                              S01117
     C********************************************************************S01117
     C*
     C** CDATE SR.TO WRITE A NEW RECORD TO 'OTPAYDD'
     C*
     C           CDATE     BEGSR
     C*
     C**   OBTAIN THE NEXT PAYMENT SEQUENCE NUMBER
     C*
     C/COPY WNCPYSRC,FTH00078
     C           CFT151    IFEQ 'N'                                                           CFT151
     C           *NAMVAR   DEFN OTPAYDA   SEQDAD
     C           *LOCK     IN   SEQDAD
     C                     Z-ADDSEQDA     WNPSQ   40
     C                     ADD  1         SEQDA
     C                     OUT  SEQDAD
     C                     ELSE                                                               CFT151
     C                     CALL 'FT000328'                                                    CFT151
     C                     PARM           PRTCD                                               CFT151
     C                     PARM 'OT'      W@OTIN  2                                           CFT151
     C                     PARM 'A'       WCALC   1                                           CFT151
     C                     PARM 'Y'       WUPD    1                                           CFT151
     C                     PARM           WNPSQT  4                                           CFT151
     C                     PARM           WNEWSQ  4                                           CFT151
     C                     ENDIF                                                              CFT151
     C/COPY WNCPYSRC,FT0205C019
     C*
     C**   SET UP THE NEW PAYMENT REFERENCE
     C*
     C                     MOVEL*BLANKS   PREF
     C                     MOVELWEDTD3    WFLD10 100
     C                     MOVE WNPSQ     WFLD10
     C                     MOVEL'OP'      WFLD4   4
     C                     MOVE STMT      WFLD4
     C                     MOVE 'P'       P
     C/COPY WNCPYSRC,FTH00079
     C           CFT151    IFEQ 'N'                                                           CFT151
     C                     MOVE IPREF     PREF
     C                     ELSE                                                               CFT151
     C                     MOVE IPREF     IPREFT                                              CFT151
     C                     MOVELWEDTD3    WFLD6N                                              CFT151
     C                     MOVE WNPSQT    WFLD4A                                              CFT151
     C                     MOVE IPREFT    PREF                                                CFT151
     C                     END                                                                CFT151
     C/COPY WNCPYSRC,FT0205C010
     C***********                                                         CEU006
     C*****GOTO*SETUP*SR.*TO*SETUP*NEW*AMOUNT*AND*RATE*FIELDS*************CEU006
     C***********                                                         CEU006
     C***********          EXSR SETUP                                     CEU006
     C***********                                                         CEU006
     C************IN99     IFEQ '1'                                       CEU006
     C***********          GOTO FINS01                                    CEU006
     C***********          END                                            CEU006
     C***********                                                         CEU006
     C*****CALCULATE*DAF*AMOUNT*FOR*SETTLE*CCY****************************CEU006
     C***********                                                         CEU006
     C***********          Z-ADD*ZEROS    SMAMD                           CEU006
     C***********SMAM      DIV  WSDIV     SMAMD     H                     CEU006
     C***********                                                         CEU006
     C***********                                                         CEU006
     C*****CALCULATE*DAF*AMOUNT*FOR*PAY*CCY*******************************CEU006
     C***********                                                         CEU006
     C***********          Z-ADD*ZEROS    PYAMD                           CEU006
     C***********PYAM      DIV  WPDIV     PYAMD     H                     CEU006
     C***********                                                         CEU006
     C***********                                                         CEU006
     C*****SET*UP*THE*DAF*RATE*FIELD**************************************CEU006
     C***********                                                         CEU006
     C***********MDIN      IFEQ 1                                         CEU006
     C***********          Z-ADDRATE      RATED                           CEU006
     C***********          ELSE                                           CEU006
     C***********          Z-ADD*ZEROS    RATED                           CEU006
     C***********1         DIV  RATE      RATED     H                     CEU006
     C***********          END                                            CEU006
     C*
     C**   SET UP PAY VALUE DATE
     C*
     C*********************MOVE PCCY      ZCCY                            S01195
     C*********************MOVE SMCY      LOCY    3                       S01195
     C                     Z-ADDPRBD      ZNRDYS
     C                     Z-ADDWNPD      ZDAYNO
     C*
     C*********************EXSR ZTXDAY                                    S01195
     C                     EXSR ZFWDT                                     S01195
     C*
     C                     Z-ADDZDYNBR    PVDT
     C                     Z-ADDPVDT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZDATE     PVDTD1
     C                     MOVE ZADATE    P1PYDT           PRINT FILE FLD
     C                     MOVE PVDTD1    WDATE1
     C                     EXSR DAFDT
     C                     MOVE WDATE2    PVDTD2
     C                     MOVE WDATE3    PVDTD3
     C*
     C*
     C**   SET UP THE REMAINING FIELDS
     C*
     C                     MOVE 'OP'      PYTP
     C                     MOVE *BLANK    RPAY
     C                     MOVE *BLANK    PAYF
     C                     MOVE *ZEROS    DYIM
     C                     MOVE *ZEROS    FDAT
     C                     MOVE *ZEROS    FDATD1
     C                     MOVE *ZEROS    FDATD2
     C                     MOVE *ZEROS    FDATD3
     C                     TIME           LCHT
     C                     MOVE RUND      LCD
     C                     MOVE 'I'       CHTP
     C                     MOVE *BLANKS   AUP1
     C                     MOVE *BLANKS   AUP2
     C                     MOVE *BLANK    AUIN
     C                     MOVE *BLANK    PRIN
     C                     MOVE *BLANK    MT100
     C                     MOVE *BLANK    MT202
     C*********************MOVE *BLANK    MT400                           E32481
     C*********************MOVE *BLANK    MT200                           E32481
     C                     MOVE *BLANK    TXIN
     C                     MOVE *BLANK    BAIN
     C                     MOVE *BLANK    ISIN
     C                     MOVE *BLANK    MPYI
     C*
     C                     MOVE WNPD      SLDT
     C*                                                                   S01494
     C** Set up Linked to Reg Payment Reference                           S01494
     C*                                                                   S01494
     C                     MOVE WPREF     OPRPRF                          S01494
      *                                                                   062394
      * If frequency is + or - find first working day in local            062394
      * currency                                                          062394
      *                                                                   062394
     C           WPAYF     IFEQ '+'                                       062394
     C                     Z-ADD0         ZNRDYS                          062394
     C                     Z-ADDSLDT      ZDAYNO                          062394
     C                     EXSR ZFWDT                                     062394
     C                     Z-ADDZDYNBR    SLDT                            062394
     C                     END                                            062394
      *                                                                   062394
     C           WPAYF     IFEQ '-'                                       062394
     C                     Z-ADD0         ZNRDYS                          062394
     C                     Z-ADDSLDT      ZDAYNO                          062394
     C           ZDYNBR    DOULESLDT                                      062394
     C                     EXSR ZFWDT                                     062394
     C                     SUB  1         ZDAYNO                          062394
     C                     END                                            062394
     C                     Z-ADDZDYNBR    SLDT                            062394
     C                     END                                            062394
      *                                                                   062394
     C                     Z-ADDSLDT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZDATE     SLDTD1
     C                     MOVE ZADATE    P1SLDT           PRINT FILE FLD
     C                     MOVE SLDTD1    WDATE1
     C                     EXSR DAFDT
     C                     MOVE WDATE2    SLDTD2
     C                     MOVE WDATE3    SLDTD3
     C*
     C                     MOVE WEDT      OEDT
     C                     MOVE WEDTD1    OEDTD1
     C                     MOVE WEDTD2    OEDTD2
     C                     MOVE WEDTD3    OEDTD3
     C*
     C*
     C                     MOVE *ZEROS    NPDT
     C                     MOVE *ZEROS    NPDTD1
     C                     MOVE *ZEROS    NPDTD2
     C                     MOVE *ZEROS    NPDTD3
     C*                                                                   E32873
     C                     MOVE RGRECI    RECI                            E32873
     C*                                                                   S01408
     C**   GOTO SETUP SR. TO SETUP NEW AMOUNT AND RATE FIELDS             CEU006
      *                                                                   CEU006
     C                     EXSR SETUP                                     CEU006
      *                                                                   CEU006
     C           *IN99     IFEQ '1'                                       CEU006
     C                     GOTO FINS01                                    CEU006
     C                     END                                            CEU006
     C*                                                                   CEU006
     C*  ACCESS CURRENCY RECORD 1 FOR : CDP,SPOT & MDIN FOR SETTLE CCY    CEU006
     C*                                                                   CEU006
     C                     MOVEL*BLANKS   ZTABKY                          CEU006
     C                     MOVEL'20'      ZTABKY                          CEU006
     C                     MOVELWSMCY     KEY04                           CEU006
     C                     MOVE '1'       KEY04                           CEU006
     C                     MOVE KEY04     ZTABKY                          CEU006
     C           ZTABKY    CHAINTABFP                99                   CEU006
     C  N99      RECI      COMP 'D'                  9999                 CEU006
     C*                                                                   CEU006
     C*  CHECK IF DATABASE ERROR OCCURRED                                 CEU006
     C*                                                                   CEU006
     C           *IN99     IFEQ '1'                                       CEU006
     C           *LOCK     IN   DLDA                                      CEU006
     C                     MOVEL'FT0205'  DBPGM                           CEU006
     C                     MOVEL'TABLE'   DBFILE           ***************CEU006
     C                     MOVELZTABKY    DBKEY            * DB ERROR 11 *CEU006
     C                     MOVEL'011'     DBASE            ***************CEU006
     C                     OUT  DLDA                                      CEU006
     C                     SETON                     U7U8LR               CEU006
     C                     GOTO FINS01                                    CEU006
     C                     END                                            CEU006
     C*    SAVE THE REQUIRED FIELDS                                       CEU006
     C*                                                                   CEU006
     C                     Z-ADDCDP       WSCDP   10                      CEU006
     C                     Z-ADDSPOT      WSSPOT 138                      CEU006
     C                     MOVE MDIN      WSMDIN  10                      CEU006
     C*                                                                   CEU006
     C*    SET UP DIVISOR FOR SETTLE AMOUNT DEPENDING ON D.P. FOR SET CCY CEU006
     C*                                                                   CEU006
     C           WSCDP     IFEQ *ZERO                                     CEU006
     C                     Z-ADD1         WSDIV   40                      CEU006
     C                     ELSE                                           CEU006
     C           WSCDP     IFEQ 1                                         CEU006
     C                     Z-ADD10        WSDIV                           CEU006
     C                     ELSE                                           CEU006
     C           WSCDP     IFEQ 2                                         CEU006
     C                     Z-ADD100       WSDIV                           CEU006
     C                     ELSE                                           CEU006
     C                     Z-ADD1000      WSDIV                           CEU006
     C                     END                                            CEU006
     C                     END                                            CEU006
     C                     END                                            CEU006
     C*                                                                   CEU006
     C*  ACCESS CURRENCY RECORD 1 FOR : CDP,SPOT & MDIN FOR PAY  CCY      CEU006
     C*                                                                   CEU006
     C                     MOVEL*BLANKS   ZTABKY                          CEU006
     C                     MOVEL'20'      ZTABKY                          CEU006
     C                     MOVELWRCCY     KEY04                           CEU006
     C                     MOVE '1'       KEY04                           CEU006
     C                     MOVE KEY04     ZTABKY                          CEU006
     C           ZTABKY    CHAINTABFP                99                   CEU006
     C  N99      RECI      COMP 'D'                  9999                 CEU006
     C*                                                                   CEU006
     C*  CHECK IF DATABASE ERROR OCCURRED                                 CEU006
     C*                                                                   CEU006
     C           *IN99     IFEQ '1'                                       CEU006
     C           *LOCK     IN   DLDA                                      CEU006
     C                     MOVEL'FT0205'  DBPGM            ***************CEU006
     C                     MOVEL'TABLE'   DBFILE           * DB ERROR 13 *CEU006
     C                     MOVELZTABKY    DBKEY            ***************CEU006
     C                     MOVEL'013'     DBASE                           CEU006
     C                     OUT  DLDA                                      CEU006
     C                     SETON                     U7U8LR               CEU006
     C                     GOTO FINS01                                    CEU006
     C                     END                                            CEU006
     C*  SAVE THE REQUIRED FIELDS                                         CEU006
     C*                                                                   CEU006
     C                     Z-ADDCDP       WPCDP   10                      CEU006
     C                     Z-ADDSPOT      WPSPOT 138                      CEU006
     C                     MOVE MDIN      WPMDIN  10                      CEU006
     C*                                                                   CEU006
     C*    SET UP DIV FOR PAY AMNT DEPENDING ON D.P. FOR PAY CCY          CEU006
     C*                                                                   CEU006
     C           WPCDP     IFEQ *ZERO                                     CEU006
     C                     Z-ADD1         WPDIV   40                      CEU006
     C                     ELSE                                           CEU006
     C           WPCDP     IFEQ 1                                         CEU006
     C                     Z-ADD10        WPDIV                           CEU006
     C                     ELSE                                           CEU006
     C           WPCDP     IFEQ 2                                         CEU006
     C                     Z-ADD100       WPDIV                           CEU006
     C                     ELSE                                           CEU006
     C                     Z-ADD1000      WPDIV                           CEU006
     C                     END                                            CEU006
     C                     END                                            CEU006
     C                     END                                            CEU006
     C*                                                                   CEU006
     C*    CALCULATE DAF AMOUNT FOR SETTLE CCY                            CEU006
     C*                                                                   CEU006
     C                     Z-ADD*ZEROS    SMAMD                           CEU006
     C           SMAM      DIV  WSDIV     SMAMD     H                     CEU006
     C*                                                                   CEU006
     C*    CALCULATE DAF AMOUNT FOR PAY CCY                               CEU006
     C*                                                                   CEU006
     C                     Z-ADD*ZEROS    PYAMD                           CEU006
     C           PYAM      DIV  WPDIV     PYAMD     H                     CEU006
     C*                                                                   CEU006
     C*    SET UP THE DAF RATE FIELD                                      CEU006
     C*                                                                   CEU006
     C           CFT009    IFNE 'Y'                                       CFT009
     C           MDIN      IFEQ 1                                         CEU006
     C                     Z-ADDRATE      RATED                           CEU006
     C                     ELSE                                           CEU006
     C                     Z-ADD*ZEROS    RATED                           CEU006
     C           1         DIV  RATE      RATED     H                     CEU006
     C                     END                                            CEU006
     C                     ELSE                                           CFT009
     C           MDIN      IFEQ 1                                         CFT009
     C           SAVRTD    ANDGE1                                         CFT009
     C                     Z-ADDRATE      RATED                           CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD*ZEROS    RATED                           CFT009
     C           1         DIV  RATE      RATED                           CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
     C*                                                                   CEU006
     C* CALCULATE BASE CCY EQUIVALENT                                     CEU006
     C           WSCDP     SUB  WBCDP     N       10                      CEU006
     C                     ADD  4         N                               CEU006
     C           WSMDIN    IFEQ 0                                         CEU006
     C           WSSPOT    MULT POWER,N   WK159  159H                     CEU006
     C           SMAM      DIV  WK159     SBCQ      H                     CEU006
     C                     ELSE                                           CEU006
     C           WSSPOT    DIV  POWER,N   WK159     H                     CEU006
     C           SMAM      MULT WK159     SBCQ      H                     CEU006
     C                     END                                            CEU006
     C*                                                                   CEU006
     C* CALCULATE BASE CCY EQUIVALENT                                     CEU006
     C           WPCDP     SUB  WBCDP     N       10                      CEU006
     C                     ADD  4         N                               CEU006
     C           WPMDIN    IFEQ 0                                         CEU006
     C           WPSPOT    MULT POWER,N   WK159     H                     CEU006
     C           PYAM      DIV  WK159     PBCQ      H                     CEU006
     C                     ELSE                                           CEU006
     C           WPSPOT    DIV  POWER,N   WK159     H                     CEU006
     C           PYAM      MULT WK159     PBCQ      H                     CEU006
     C                     END                                            CEU006
     C* THIS IS TO MAKE BASE CCY EQUIVALENT EQUAL                         CEU006
     C           PCCY      IFEQ BCCY                                      CEU006
     C                     Z-ADDPBCQ      SBCQ                            CEU006
     C                     ELSE                                           CEU006
     C                     Z-ADDSBCQ      PBCQ                            CEU006
     C                     END                                            CEU006
      *                                                                   CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
      *                                                                   CFT014
     C                     EXSR SRWEXT                                    CFT014
      *                                                                   CFT014
     C           *IN22     IFEQ '1'                                       CFT014
     C                     GOTO FINS01                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
     C*                                                                   CEU006
     C*================================================================   CEU006
     C** Core hook for externalisation.                                   S01408
     C/COPY WNCPYSRC,FT0205CCBU                                           S01408
      *                                                                   CFT009
      ** IF CFT009 is turned on...                                        CFT009
      *                                                                   CFT009
     C           CFT009    IFEQ 'Y'                                       CFT009
      *                                                                   CFT009
      ** Populate fields which have been renamed before call to           CFT009
      ** FT000980.                                                        CFT009
      *                                                                   CFT009
     C                     MOVELDST1      XDST1                           CFT009
     C                     MOVELDST2      XDST2                           CFT009
     C                     MOVELDST3      XDST3                           CFT009
     C                     MOVELDST4      XDST4                           CFT009
     C                     MOVELORBK      XORBK                           CFT009
     C                     MOVELORC1      XORC1                           CFT009
     C                     MOVELORC2      XORC2                           CFT009
     C                     MOVELORC3      XORC3                           CFT009
     C                     MOVELORC4      XORC4                           CFT009
     C                     MOVELORC5      XORC5                                               CFT032
     C                     MOVELMDIN      XMDIN                           CFT009
     C                     MOVELRCO1      XRCO1                           CFT009
     C                     MOVELRCO2      XRCO2                           CFT009
     C                     MOVELRCO3      XRCO3                           CFT009
     C                     MOVELRCO4      XRCO4                           CFT009
     C                     MOVELRCO5      XRCO5                           CFT009
     C                     MOVELACB1      XACB1                           CFT009
     C                     MOVELACB2      XACB2                           CFT009
     C                     MOVELACB3      XACB3                           CFT009
     C                     MOVELACB4      XACB4                           CFT009
     C                     MOVELACB5      XACB5                           CFT009
     C                     MOVELBNC1      XBNC1                           CFT009
     C                     MOVELBNC2      XBNC2                           CFT009
     C                     MOVELBNC3      XBNC3                           CFT009
     C                     MOVELBNC4      XBNC4                           CFT009
     C                     MOVELBNC5      XBNC5                           CFT009
     C                     MOVELLCD       XLCD                            CFT009
     C                     MOVELINB1      XINB1                           CFT009
     C                     MOVELINB2      XINB2                           CFT009
     C                     MOVELINB3      XINB3                           CFT009
     C                     MOVELINB4      XINB4                           CFT009
     C                     MOVELINB5      XINB5                           CFT009
      *                                                                   CFT009
      ** Charges currency code depends on FT standing data settings       CFT009
      ** and needs to be set up before call to FT000980                   CFT009
      *                                                                   CFT009
     C                     SELEC                                          CFT009
      *                                                                   CFT009
      ** Fixed charge currency                                            CFT009
      *                                                                   CFT009
     C           BTCHCY    WHEQ 'F'                                       CFT009
     C                     MOVE FCHCCY    OPCHGC                          CFT009
      *                                                                   CFT009
      ** Base currency  - get data from SDBANKPD                          CFT009
      *                                                                   CFT009
     C           BTCHCY    WHEQ 'B'                                       CFT009
      *                                                                   CFT009
      ** Get bank details                                                 CFT009
      *                                                                   CFT009
     C                     CALL 'AOBANKR0'                                CFT009
     C                     PARM '*MSG   ' @RTCD                           CFT009
     C                     PARM '*FIRST ' @OPTN                           CFT009
     C           SDBANK    PARM SDBANK    DSFDY                           CFT009
      *                                                                   CFT009
     C           @RTCD     IFNE *BLANK                                    CFT009
      *                                                                   CFT009
     C           *LOCK     IN   DLDA                                      CFT009
     C                     MOVEL'FT0205'  DBPGM                           CFT009
     C                     MOVE 'SCBANKPD'DBFILE           ************   CFT009
     C                     MOVEL'*FIRST  'DBKEY            * DBERR 40 *   CFT009
     C                     MOVE '040'     DBASE            ************   CFT009
     C                     OUT  DLDA                                      CFT009
     C                     SETON                     U7U8LR               CFT009
     C                     GOTO TAG03                                     CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     MOVE BJCYCD    OPCHGC                          CFT009
      *                                                                   CFT009
      ** Local currency  - get data from SDBANKPD                         CFT009
      *                                                                   CFT009
     C           BTCHCY    WHEQ 'L'                                       CFT009
      *                                                                   CFT009
      ** Get bank details                                                 CFT009
      *                                                                   CFT009
     C                     CALL 'AOBANKR0'                                CFT009
     C                     PARM '*MSG   ' @RTCD                           CFT009
     C                     PARM '*FIRST ' @OPTN                           CFT009
     C           SDBANK    PARM SDBANK    DSFDY                           CFT009
      *                                                                   CFT009
     C           @RTCD     IFNE *BLANK                                    CFT009
      *                                                                   CFT009
     C           *LOCK     IN   DLDA                                      CFT009
     C                     MOVEL'FT0205'  DBPGM                           CFT009
     C                     MOVE 'SCBANKPD'DBFILE           ************   CFT009
     C                     MOVEL'*FIRST  'DBKEY            * DBERR 41 *   CFT009
     C                     MOVE '041'     DBASE            ************   CFT009
     C                     OUT  DLDA                                      CFT009
     C                     SETON                     U7U8LR               CFT009
     C                     GOTO TAG03                                     CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     MOVE BJLCCY    OPCHGC                          CFT009
      *                                                                   CFT009
      ** Charges currency - depends on add/deduct flag. If add, use       CFT009
      ** settlement ccy, otherwise use pay currency.                      CFT009
      *                                                                   CFT009
     C           BTCHCY    WHEQ 'C'                                       CFT009
     C           ADDC      IFEQ 'A'                                       CFT009
     C                     MOVE SMCY      OPCHGC                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVE PCCY      OPCHGC                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDSL                                          CFT009
      *                                                                   CFT009
      ** Also set up other known fields for OTPAYXPD file before call     CFT009
      ** to FT000980                                                      CFT009
      *                                                                   CFT009
      ** Record ID                                                        CFT009
     C                     MOVEL'D'       OPRECI                          CFT009
      ** Payment ref                                                      CFT009
     C                     MOVELPREF      OPPREF                          CFT009
      *                                                                   CFT009
      ** Date notification entered (= run date)                           CFT009
      *                                                                   CFT009
     C                     Z-ADDRUND      DATNED                          CFT009
      *                                                                   CFT009
      ** Date notification authorised                                     CFT009
      *                                                                   CFT009
     C                     Z-ADD0         DATNAO                          CFT009
      *                                                                   CFT009
      ** Customer notification flag                                       CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   CUNFLA                          CFT009
      *                                                                   CFT009
      ** Cross rate between payment currency and charge currency.         CFT009
      ** Sub ZXRATE uses two rates with multiply/divide indicators,       CFT009
      ** which need to be obtained first.                                 CFT009
      *                                                                   CFT009
      ** Get payment rate and indicator from SDCURRPD.                    CFT009
      *                                                                   CFT009
     C                     SELEC                                          CFT009
     C***********CDRO      WHNE *ZEROS                                                 CFT009 CSD027
     C           CDRO      WHNE *BLANKS                                                       CSD027
     C                     MOVELBCCY      CURCY                           CFT009
     C           OPCDRC    IFNE *BLANKS                                                       CFT120
     C           CFT120    ANDEQ'Y'                                                           CFT120
     C                     MOVE OPCDRC    CURCY                                               CFT120
     C                     ENDIF                                                              CFT120
      *                                                                                       CFT120
     C           ADDC      WHEQ 'A'                                       CFT009
     C                     MOVELSMCY      CURCY                           CFT009
     C                     OTHER                                          CFT009
     C                     MOVELPCCY      CURCY                           CFT009
     C                     ENDSL                                          CFT009
      *                                                                   CFT009
      *                                                                   CFT009
     C                     CALL 'AOCURRR0'                                CFT009
     C                     PARM *BLANKS   RTNCDE 10                       CFT009
     C                     PARM '*KEY   ' OPTN    7                       CFT009
     C                     PARM           CURCY   3                       CFT009
     C                     PARM           SDCURR                          CFT009
      *                                                                   CFT009
     C           RTNCDE    IFNE *BLANKS                                   CFT009
     C           *LOCK     IN   DLDA                                      CFT009
     C                     MOVEL'FT0205'  DBPGM            ************   CFT009
     C                     MOVELCURCY     DBKEY            * DBERR 42 *   CFT009
     C                     MOVE 'SDCURRPD'DBFILE           ************   CFT009
     C                     MOVE '042'     DBASE                           CFT009
     C                     OUT  DLDA                                      CFT009
     C                     SETON                     U7U8LR               CFT009
     C                     GOTO FINS01                                    CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Set up payment currency rate and multiply/divide indicator       CFT009
      *                                                                   CFT009
     C                     Z-ADDA6SPRT    ZRATE1 138                      CFT009
     C                     MOVELA6MDIN    ZMDI1   1                       CFT009
     C           *LIKE     DEFN A6NBDP    LEVCDP                          CFT009
     C                     Z-ADDA6NBDP    LEVCDP                          CFT009
      *                                                                   CFT009
      ** Get charges rate and indicator from SDCURRPD.                    CFT009
      *                                                                   CFT009
     C                     CALL 'AOCURRR0'                                CFT009
     C                     PARM *BLANKS   RTNCDE                          CFT009
     C                     PARM '*KEY   ' OPTN                            CFT009
     C                     PARM           OPCHGC                          CFT009
     C                     PARM           SDCURR                          CFT009
      *                                                                   CFT009
     C           RTNCDE    IFNE *BLANKS                                   CFT009
     C           *LOCK     IN   DLDA                                      CFT009
     C                     MOVEL'FT0205'  DBPGM            ************   CFT009
     C                     MOVELOPCHGC    DBKEY            * DBERR 43 *   CFT009
     C                     MOVE 'SDCURRPD'DBFILE           ************   CFT009
     C                     MOVE '043'     DBASE                           CFT009
     C                     OUT  DLDA                                      CFT009
     C                     SETON                     U7U8LR               CFT009
     C                     GOTO FINS01                                    CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Set up payment currency rate and multiply/divide indicator       CFT009
      *                                                                   CFT009
     C                     Z-ADDA6SPRT    ZRATE2 138                      CFT009
     C                     MOVELA6MDIN    ZMDI2   1                       CFT009
      *                                                                   CFT009
      ** Obtain cross rate, using ZXRATE subroutine, and place in         CFT009
      ** output field                                                     CFT009
      *                                                                   CFT009
     C                     EXSR ZXRATE                                    CFT009
     C           CHTRCY    IFEQ 'Y'                                       CFT009
     C                     Z-ADDRATE      OPCHRT                          CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADDZRATEX    OPCHRT                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Set up data structured to pass data between FT0205 and           CFT009
      ** FT000980                                                         CFT009
      *                                                                   CFT009
     C                     MOVELOTPYDS    TRNDET    P                     CFT009
     C                     MOVELOTPXDS    TRNEXT    P                     CFT009
      *                                                                   CFT009
      ** Also move in renamed fields                                      CFT009
      *                                                                   CFT009
     C                     MOVELOPTRI1    XOPTR1    P                     CFT009
     C                     MOVELOPTRI2    XOPTR2    P                     CFT009
     C                     MOVELOPTRI3    XOPTR3    P                     CFT009
     C                     MOVELOPTRI4    XOPTR4    P                     CFT009
     C                     MOVELOPTRI5    XOPTR5    P                     CFT009
      *                                                                   CFT009
      ** Use FT000980 to get default charges for both OTPAYDD and         CFT009
      ** OTPAYXPD, before records written out.                            CFT009
      *                                                                   CFT009
     C                     CALL 'FT000980'                                CFT009
     C                     PARM           RTNCDE 10                       CFT009
     C                     PARM           TRNDET                          CFT009
     C                     PARM           TRNEXT                          CFT009
      ** Outgoing payment, so parm is 'OP'                                CFT009
     C                     PARM 'OP'      TTYP    2                       CFT009
      ** Manual processing, so parm is 'M'                                CFT009
     C                     PARM 'M'       PRCMTH  1                       CFT009
      ** Other parms not used for manual proc, so can be passed blank     CFT009
     C                     PARM *BLANKS   PRM1    3                       CFT009
     C                     PARM *BLANKS   PRM2    3                       CFT009
      *                                                                   CFT009
      ** Move data back into data structures, to allow write to           CFT009
      ** file (renamed data not required, as already set up)              CFT009
      *                                                                   CFT009
     C                     MOVELTRNDET    OTPYDS                          CFT009
     C                     MOVELTRNEXT    OTPXDS                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** If CFT009 is on, set up PYAMD now to prevent rate problems.      CFT009
      *                                                                   CFT009
     C           CFT009    IFEQ 'Y'                                       CFT009
     C                     Z-ADD*ZEROS    PYAMD                           CFT009
     C           PYAM      DIV  WPDIV     PYAMD     H                     CFT009
      *                                                                   CFT009
      * Recalculate levied charge amounts                                 CFT009
      *                                                                   CFT009
      * Transfer Commission                                               CFT009
     C                     Z-ADDTRCM      DUMA1                           CFT009
     C                     Z-ADDTRCM      INPCHG                          CFT009
     C                     EXSR FT0985                                    CFT009
     C                     Z-ADDLEVCHG    TRCM                            CFT009
     C                     MOVE LEVFMT    P2TREA                          CFT009
      * Telex                                                             CFT009
     C                     Z-ADDTXCH      DUMA2                           CFT009
     C                     Z-ADDTXCH      INPCHG                          CFT009
     C                     EXSR FT0985                                    CFT009
     C                     Z-ADDLEVCHG    TXCH                            CFT009
     C                     MOVE LEVFMT    P2TXEA                          CFT009
      * Cheque                                                            CFT009
     C                     Z-ADDCQCH      DUMA3                           CFT009
     C                     Z-ADDCQCH      INPCHG                          CFT009
     C                     EXSR FT0985                                    CFT009
     C                     Z-ADDLEVCHG    CQCH                            CFT009
     C                     MOVE LEVFMT    P2CQEA                          CFT009
      * Costs                                                             CFT009
     C                     Z-ADDCSTA      DUMA4                           CFT009
     C                     Z-ADDCSTA      INPCHG                          CFT009
     C                     EXSR FT0985                                    CFT009
     C                     Z-ADDLEVCHG    CSTA                            CFT009
     C                     MOVE LEVFMT    P2CSEA                          CFT009
      * Swift Priority 5                                                  CFT009
     C                     Z-ADDSPCH      DUMA5                           CFT009
     C                     Z-ADDSPCH      INPCHG                          CFT009
     C                     EXSR FT0985                                    CFT009
     C                     Z-ADDLEVCHG    SPCH                            CFT009
     C                     MOVE LEVFMT    P2SPEA                          CFT009
      * Miscellaneous Charge                                              CFT009
     C                     Z-ADDMSCH      DUMA6                           CFT009
     C                     Z-ADDMSCH      INPCHG                          CFT009
     C                     EXSR FT0985                                    CFT009
     C                     Z-ADDLEVCHG    MSCH                            CFT009
     C                     MOVE LEVFMT    P2MSEA                          CFT009
      * FX (OPCHCM / DUM7)                                                CFT009
     C                     Z-ADDOPCHCM    INPCHG                          CFT009
     C                     EXSR FT0985                                    CFT009
     C                     MOVE LEVFMT    P2CHEA                          CFT009
      * Misc Charge 1                                                     CFT009
     C                     Z-ADDMISCC1    INPCHG                          CFT009
     C                     EXSR FT0985                                    CFT009
     C                     Z-ADDLEVCHG    MISC01                          CFT009
     C                     MOVE LEVFMT    P2M1EA                          CFT009
      * Misc Charge 2                                                     CFT009
     C                     Z-ADDMISCC2    INPCHG                          CFT009
     C                     EXSR FT0985                                    CFT009
     C                     Z-ADDLEVCHG    MISC02                          CFT009
     C                     MOVE LEVFMT    P2M2EA                          CFT009
      * Misc Charge 3                                                     CFT009
     C                     Z-ADDMISCC3    INPCHG                          CFT009
     C                     EXSR FT0985                                    CFT009
     C                     Z-ADDLEVCHG    MISC03                          CFT009
     C                     MOVE LEVFMT    P2M3EA                          CFT009
      * Misc Charge 4                                                     CFT009
     C                     Z-ADDMISCC4    INPCHG                          CFT009
     C                     EXSR FT0985                                    CFT009
     C                     Z-ADDLEVCHG    MISC04                          CFT009
     C                     MOVE LEVFMT    P2M4EA                          CFT009
      * Misc Charge 5                                                     CFT009
     C                     Z-ADDMISCC5    INPCHG                          CFT009
     C                     EXSR FT0985                                    CFT009
     C                     Z-ADDLEVCHG    MISC05                          CFT009
     C                     MOVE LEVFMT    P2M5EA                          CFT009
      * Swift Standard Charge                                             CFT009
     C                     Z-ADDSWSCCC    INPCHG                          CFT009
     C                     EXSR FT0985                                    CFT009
     C                     Z-ADDLEVCHG    SWSCHG                          CFT009
     C                     MOVE LEVFMT    P2SWSA                          CFT009
      *                                                                   CFT009
      ** IF CFT010 is turned on, do V.A.T. calcs to include new           CFT009
      ** miscellaneous charges and avoid rounding errors.                 CFT009
      *                                                                   CFT009
     C           CFT010    IFEQ 'Y'                                       CFT009
      *                                                                   CFT009
     C                     Z-ADD0         OPVATT                          CFT009
     C                     Z-ADD0         TOTV   150                      CFT009
      *                                                                   CFT009
      * Transfer Commission                                               CFT009
      *                                                                   CFT009
     C                     MOVE TFCCCD    CHGCOD  5                       CFT009
     C                     EXSR VTFLAG                                    CFT009
     C                     MOVE VATLIN    OPVAT1                          CFT009
     C           FLAGVT    IFEQ 'Y'                                       CFT009
     C                     MOVE FLAGVT    OPVAT1                          CFT009
     C                     ADD  TRCM      TOTV                            CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      * Telex                                                             CFT009
      *                                                                   CFT009
     C                     MOVE TLXCDE    CHGCOD  5                       CFT009
     C                     EXSR VTFLAG                                    CFT009
     C                     MOVE VATLIN    OPVAT2                          CFT009
     C           FLAGVT    IFEQ 'Y'                                       CFT009
     C                     MOVE FLAGVT    OPVAT2                          CFT009
     C                     ADD  TXCH      TOTV                            CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      * Cheque                                                            CFT009
      *                                                                   CFT009
     C                     MOVE CHQCHC    CHGCOD  5                       CFT009
     C                     EXSR VTFLAG                                    CFT009
     C                     MOVE VATLIN    OPVAT3                          CFT009
     C           FLAGVT    IFEQ 'Y'                                       CFT009
     C                     MOVE FLAGVT    OPVAT3                          CFT009
     C                     ADD  CQCH      TOTV                            CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      * Costs Abroad                                                      CFT009
      *                                                                   CFT009
     C                     MOVE CACHCD    CHGCOD  5                       CFT009
     C                     EXSR VTFLAG                                    CFT009
     C                     MOVE VATLIN    OPVAT4                          CFT009
     C           FLAGVT    IFEQ 'Y'                                       CFT009
     C                     MOVE FLAGVT    OPVAT4                          CFT009
     C                     ADD  CSTA      TOTV                            CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      * Sqift Priority                                                    CFT009
      *                                                                   CFT009
     C                     MOVE SPRCCD    CHGCOD  5                       CFT009
     C                     EXSR VTFLAG                                    CFT009
     C                     MOVE VATLIN    OPVAT5                          CFT009
     C           FLAGVT    IFEQ 'Y'                                       CFT009
     C                     MOVE FLAGVT    OPVAT5                          CFT009
     C                     ADD  SPCH      TOTV                            CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      * Miscellaneous Charge                                              CFT009
      *                                                                   CFT009
     C                     MOVE MSCHC     CHGCOD  5                       CFT009
     C                     EXSR VTFLAG                                    CFT009
     C                     MOVE VATLIN    OPVAT6                          CFT009
     C           FLAGVT    IFEQ 'Y'                                       CFT009
     C                     MOVE FLAGVT    OPVAT6                          CFT009
     C                     ADD  MSCH      TOTV                            CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      * FX Change                                                         CFT009
      *                                                                   CFT009
     C                     MOVE FXCACC    CHGCOD  5                       CFT009
     C                     EXSR VTFLAG                                    CFT009
     C                     MOVE VATLIN    OPVAT7                          CFT009
     C           FLAGVT    IFEQ 'Y'                                       CFT009
     C                     MOVE FLAGVT    OPVAT7                          CFT009
     C                     ADD  SPCH      TOTV                            CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      * Swift Standard                                                    CFT009
      *                                                                   CFT009
     C                     MOVE SSTCCD    CHGCOD  5                       CFT009
     C                     EXSR VTFLAG                                    CFT009
     C                     MOVE VATLIN    P2SWSF                          CFT009
     C           FLAGVT    IFEQ 'Y'                                       CFT009
     C                     MOVE FLAGVT    VTSWSC                          CFT009
     C                     ADD  SWSCCC    TOTV                            CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      * Misc Charge 1                                                     CFT009
      *                                                                   CFT009
     C                     MOVE MSCHC1    CHGCOD  5                       CFT009
     C                     EXSR VTFLAG                                    CFT009
     C                     MOVE VATLIN    P2M1VF                          CFT009
     C           FLAGVT    IFEQ 'Y'                                       CFT009
     C                     MOVE FLAGVT    VMIC1                           CFT009
     C                     ADD  MISC01    TOTV                            CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      * Misc Charge 2                                                     CFT009
      *                                                                   CFT009
     C                     MOVE MSCHC2    CHGCOD  5                       CFT009
     C                     EXSR VTFLAG                                    CFT009
     C                     MOVE VATLIN    P2M2VF                          CFT009
     C           FLAGVT    IFEQ 'Y'                                       CFT009
     C                     MOVE FLAGVT    VMIC2                           CFT009
     C                     ADD  MISC02    TOTV                            CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      * Misc Charge 3                                                     CFT009
      *                                                                   CFT009
     C                     MOVE MSCHC3    CHGCOD  5                       CFT009
     C                     EXSR VTFLAG                                    CFT009
     C                     MOVE VATLIN    P2M3VF                          CFT009
     C           FLAGVT    IFEQ 'Y'                                       CFT009
     C                     MOVE FLAGVT    VMIC3                           CFT009
     C                     ADD  MISC03    TOTV                            CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      * Misc Charge 4                                                     CFT009
      *                                                                   CFT009
     C                     MOVE MSCHC4    CHGCOD  5                       CFT009
     C                     EXSR VTFLAG                                    CFT009
     C                     MOVE VATLIN    P2M4VF                          CFT009
     C           FLAGVT    IFEQ 'Y'                                       CFT009
     C                     MOVE FLAGVT    VMIC4                           CFT009
     C                     ADD  MISC04    TOTV                            CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      * Misc Charge 5                                                     CFT009
      *                                                                   CFT009
     C                     MOVE MSCHC5    CHGCOD  5                       CFT009
     C                     EXSR VTFLAG                                    CFT009
     C                     MOVE VATLIN    P2M5VF                          CFT009
     C           FLAGVT    IFEQ 'Y'                                       CFT009
     C                     MOVE FLAGVT    VMIC5                           CFT009
     C                     ADD  MISC05    TOTV                            CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C           TOTV      MULT O#VATR    OPVATT 110H                     CFT009
      *                                                                   CFT009
     C                     Z-ADDOPVATT    OPDUM8                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Total charges in charge currency.                                CFT009
      *                                                                   CFT009
     C                     Z-ADD0         TCHGC  160                      CFT009
      *                                                                   CFT009
     C                     ADD  DUMA1     TCHGC                           CFT009
     C                     ADD  DUMA2     TCHGC                           CFT009
     C                     ADD  DUMA3     TCHGC                           CFT009
     C                     ADD  DUMA4     TCHGC                           CFT009
     C                     ADD  DUMA5     TCHGC                           CFT009
     C                     ADD  DUMA6     TCHGC                           CFT009
     C                     ADD  OPDUM7    TCHGC                           CFT009
     C                     ADD  MISCC1    TCHGC                           CFT009
     C                     ADD  MISCC2    TCHGC                           CFT009
     C                     ADD  MISCC3    TCHGC                           CFT009
     C                     ADD  MISCC4    TCHGC                           CFT009
     C                     ADD  MISCC5    TCHGC                           CFT009
     C                     ADD  SWSCCC    TCHGC                           CFT009
      *                                                                   CFT009
      * Total VAT charge                                                  CFT009
     C                     ADD  OPVATT    TCHGC                           CFT009
      *                                                                   CFT009
      * FORMAT TOTAL                                                      CFT009
     C                     MOVE TCHGC     WFDIN                           CFT009
     C                     Z-ADDLEVCDP    WDEC                            CFT009
     C           13        SUB  LEVCDP    WDIG                            CFT009
     C                     EXSR UGFRMT                                    CFT009
     C                     MOVE WFDOUT    P2TOTT                          CFT009
      *                                                                   CFT009
      *  NOW CALCULATE SENDERS CHARGES                                    CFT009
     C                     EXSR CSNDCH                                    CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                                    AR1082745
      ** Default original payment currency and amount to                                   AR1082745
      ** pay delivery currency and amount                                                  AR1082745
      *                                                                                    AR1082745
     C           PDCY      IFEQ *BLANKS                                                    AR1082745
     C           PDAM      ANDEQ*ZEROS                                                     AR1082745
     C                     MOVE PCCY      PDCY                                             AR1082745
     C                     MOVE PYAM      PDAM                                             AR1082745
     C                     ENDIF                                                           AR1082745
     C*
     C**********           MOVEASTAMP,1   OUTMST           Default Timestamp         CPK015 BUG23056
      *                                                                                     BUG23056
      ** To populate the current timestamp value                                            BUG23056
      *                                                                                     BUG23056
     C                     CALL 'ZAGENTS'                                                   BUG23056
     C                     PARM           TMSTMP 26                                         BUG23056
     C                     MOVE TMSTMP    OUTMST                                            BUG23056
      *                                                                                     BUG23056
     C                     WRITEOTPAYDDF               22  WRITE FAIL
     C*
     C           *IN22     IFEQ '1'
     C           *LOCK     IN   DLDA
     C                     MOVEL'FT0205'  DBPGM            ***************
     C                     MOVELWPREF     DBKEY            * DB ERROR 15 *
     C                     MOVE 'OTPAY'   DBFILE           ***************
     C*********************MOVE '15'      DBASE                           S01194
     C                     MOVE '015'     DBASE                           S01194
     C                     OUT  DLDA
     C                     SETON                     U7U8LR
     C                     GOTO FINS01
     C                     END
      *                                                                   CFT009
      ** Write out new record to OTPAYXPD                                 CFT009
      *                                                                   CFT009
     C           CFT009    IFEQ 'Y'                                                         AR808679
     C**********           MOVEASTAMP,1   OPTMST           Default Timestamp         CPK015 BUG23056
      *                                                                                     BUG23056
      ** To populate the current timestamp value                                            BUG23056
      *                                                                                     BUG23056
     C                     CALL 'ZAGENTS'                                                   BUG23056
     C                     PARM           TMSTMP 26                                         BUG23056
     C                     MOVE TMSTMP    OPTMST                                            BUG23056
      *                                                                                     BUG23056
     C                     WRITEOTPYX2DF               32  WRITE FAIL     CFT009
      *                                                                   CFT009
     C           *IN32     IFEQ '1'                                       CFT009
     C           *LOCK     IN   DLDA                                      CFT009
     C                     MOVEL'FT0205'  DBPGM            ***************CFT009
     C                     MOVELWPREF     DBKEY            * DB ERROR 34 *CFT009
     C                     MOVE 'OTPAYXPD'DBFILE           ***************CFT009
     C                     MOVE '034'     DBASE                           CFT009
     C                     OUT  DLDA                                      CFT009
     C                     SETON                     U7U8LR               CFT009
     C                     GOTO FINS01                                    CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C**********           ENDIF                                          CFT009
     C                     ENDIF                                                            AR808679
      *                                                                   CFT009
      ** Write a new record to OTPAYDQD                                                    AR1096476
      *                                                                                    AR1096476
     C                     MOVE PREF      OTPREF                                           AR1096476
     C                     MOVE BRCA      OTBRCA                                           AR1096476
     C                     WRITEOTPAYQD0               35                                  AR1096476
      *                                                                                    AR1096476
     C           *IN35     IFEQ *ON                                                        AR1096476
     C           *LOCK     IN   DLDA                                                       AR1096476
     C                     MOVEL'FT0205'  DBPGM                                            AR1096476
     C                     MOVELWPREF     DBKEY                                            AR1096476
     C                     MOVE 'OTPAYDQD'DBFILE                                           AR1096476
     C                     MOVE '035'     DBASE                                            AR1096476
     C                     OUT  DLDA                                                       AR1096476
     C                     MOVE *ON       *INU7                                            AR1096476
     C                     MOVE *ON       *INU8                                            AR1096476
     C                     MOVE *ON       *INLR                                            AR1096476
     C                     GOTO FINS01                                                     AR1096476
     C                     ENDIF                                                           AR1096476
      *                                                                                    AR1096476
     C/COPY WNCPYSRC,FT0205C005
     C*
     C**   KEEP TOTAL OF RECORDS WRITTEN AND A HASH TOTAL OF 'SMAM'
     C*
     C                     ADD  1         WNORR2
     C*
     C           SMAM      DIV  1000      ZZAMT
     C                     Z-ADDWHRWN2    ZZTOTI
     C                     Z-ADDWHRDC2    ZZTOTD
     C*
     C                     EXSR GLZADD
     C*
     C                     Z-ADDZZTOTI    WHRWN2
     C                     Z-ADDZZTOTD    WHRDC2
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0205CCP2                                           S01408
     C*                                                                   S01408
     C           FINS01    ENDSR
     C*
     C********************************************************************
      /EJECT                                                              CFT014
      *****************************************************************   CFT014
      *                                                               *   CFT014
      *  SRWEXT - Write corresponding record to OTPAYXPD              *   CFT014
      *                                                               *   CFT014
      *  Called By: CDATE                                             *   CFT014
      *  Calls    : SRFT10                                            *   CFT014
      *                                                               *   CFT014
      *****************************************************************   CFT014
     C           SRWEXT    BEGSR                                          CFT014
      *                                                                   CFT014
      ** Retrieve extension reord of Regular Payment.                     CFT014
      *                                                                   CFT014
     C           WPREF     CHAINOTPAYXL2             99                   CFT014
      *                                                                   CFT014
      ** Error if record not found.                                       CFT014
      *                                                                   CFT014
     C           *IN99     IFEQ *ON                                       CFT014
     C           *LOCK     IN   DLDA                                      CFT014
     C                     MOVE '037'     DBASE                           CFT014
     C                     MOVELWPREF     DBKEY                           CFT014
     C                     MOVEL'OTPAYXL2'DBFILE                          CFT014
     C                     MOVEL'FT0205'  DBPGM                           CFT014
     C                     OUT  DLDA                                      CFT014
     C                     SETON                     U7U8LR               CFT014
     C                     GOTO WXTEND                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Check if extension record for new OP already exists.             CFT014
      *                                                                   CFT014
     C           PREF      CHAINOTPAYXL2             99                   CFT014
      *                                                                   CFT014
      ** Error if record found.                                           CFT014
      *                                                                   CFT014
     C           *IN99     IFEQ *OFF                                      CFT014
     C           *LOCK     IN   DLDA                                      CFT014
     C                     MOVE '038'     DBASE                           CFT014
     C                     MOVELPREF      DBKEY                           CFT014
     C                     MOVEL'OTPAYXL2'DBFILE                          CFT014
     C                     MOVEL'FT0205'  DBPGM                           CFT014
     C                     OUT  DLDA                                      CFT014
     C                     SETON                     U7U8LR               CFT014
     C                     GOTO WXTEND                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Setup OTPAYXL0 fields for the new OP record.                     CFT014
      *                                                                   CFT014
     C                     MOVE RECI      OPRECI                          CFT014
     C                     MOVE PREF      OPPREF                          CFT014
     C                     MOVE *BLANK    OPBJPR                          CFT014
     C                     MOVE 'N'       OPAUTO                          CFT014
     C                     MOVE *BLANK    OPSTPI                          CFT014
     C                     MOVE *BLANKS   OPBANO                          CFT014
     C                     MOVE *BLANKS   OPRUSR                          CFT014
     C                     MOVE *BLANKS   OPWSID                          CFT014
     C                     MOVE *BLANKS   OPRDAT                          CFT014
     C                     MOVE STMT      OPSETM                          CFT014
     C                     MOVE 'CRED'    OPBOCD                                           AR1082745
      *                                                                   CFT014
     C                     EXSR CSNDCH                              CFT014CFT009
      ***Set*the*last*Sender's Charges Deducted to the sum          CFT014CFT009
      ***of*all*Charges*in Pay Ccy.                                 CFT014CFT009
      ***********                                                   CFT014CFT009
     C***********DTCH      IFEQ 'BEN'                               CFT014CFT009
      ***********                                                   CFT014CFT009
     C***********          SELEC                                    CFT014CFT009
      ***********                                                   CFT014CFT009
     C***********WWCCY1    WHEQ PCCY                                CFT014CFT009
     C***********DUMA1     ADD  DUMA2     WSCHG  110                CFT014CFT009
     C***********          ADD  DUMA3     WSCHG                     CFT014CFT009
     C***********          ADD  DUMA4     WSCHG                     CFT014CFT009
     C***********          ADD  DUMA5     WSCHG                     CFT014CFT009
     C***********          ADD  DUMA6     WSCHG                     CFT014CFT009
     C************IN30     IFEQ *ON                                 CFT014CFT009
     C***********          ADD  OPDUM7    WSCHG                     CFT014CFT009
     C***********          ENDIF                                    CFT014CFT009
     C************IN31     IFEQ *ON                                 CFT014CFT009
     C***********          ADD  OPDUM8    WSCHG                     CFT014CFT009
     C***********          ENDIF                                    CFT014CFT009
      ***********                                                   CFT014CFT009
     C***********WWCCY2    WHEQ PCCY                                CFT014CFT009
     C***********TRCM      ADD  TXCH      WSCHG                     CFT014CFT009
     C***********          ADD  CQCH      WSCHG                     CFT014CFT009
     C***********          ADD  CSTA      WSCHG                     CFT014CFT009
     C***********          ADD  SPCH      WSCHG                     CFT014CFT009
     C***********          ADD  MSCH      WSCHG                     CFT014CFT009
     C************IN30     IFEQ *ON                                 CFT014CFT009
     C***********          ADD  OPCHCM    WSCHG                     CFT014CFT009
     C***********          ENDIF                                    CFT014CFT009
     C************IN31     IFEQ *ON                                 CFT014CFT009
     C***********          ADD  OPVATT    WSCHG                     CFT014CFT009
     C***********          ENDIF                                    CFT014CFT009
      ***********                                                   CFT014CFT009
     C***********          OTHER                                    CFT014CFT009
     C***********TRCM      ADD  TXCH      WWSCH  110                CFT014CFT009
     C***********          ADD  CQCH      WWSCH                     CFT014CFT009
     C***********          ADD  CSTA      WWSCH                     CFT014CFT009
     C***********          ADD  SPCH      WWSCH                     CFT014CFT009
     C***********          ADD  MSCH      WWSCH                     CFT014CFT009
     C************IN30     IFEQ *ON                                 CFT014CFT009
     C***********          ADD  OPCHCM    WWSCH                     CFT014CFT009
     C***********          ENDIF                                    CFT014CFT009
     C************IN31     IFEQ *ON                                 CFT014CFT009
     C***********          ADD  OPVATT    WWSCH                     CFT014CFT009
     C***********          ENDIF                                    CFT014CFT009
     C***********          CLEARP#0010                              CFT014CFT009
     C***********          MOVELWWCCY2    P#FRCY                    CFT014CFT009
     C***********          Z-ADDWWSCH     P#FRAM                    CFT014CFT009
     C***********          MOVELPCCY      P#TOCY                    CFT014CFT009
     C***********          Z-ADD*ZEROS    P#TOAM                    CFT014CFT009
     C***********          EXSR SRFT10                              CFT014CFT009
     C***********          Z-ADDP#TOAM    WSCHG                     CFT014CFT009
      ***********                                                   CFT014CFT009
     C***********          ENDSL                                    CFT014CFT009
      ***********                                                   CFT014CFT009
     C***********          SELEC                                    CFT014CFT009
     C***********OPSCC1    WHEQ *BLANKS                             CFT014CFT009
     C***********          MOVE PCCY      OPSCC1                    CFT014CFT009
     C***********          Z-ADDWSCHG     OPSCH1                    CFT014CFT009
     C***********          Z-ADD1         OPSCLE                    CFT014CFT009
     C***********OPSCC2    WHEQ *BLANKS                             CFT014CFT009
     C***********          MOVE PCCY      OPSCC2                    CFT014CFT009
     C***********          Z-ADDWSCHG     OPSCH2                    CFT014CFT009
     C***********          Z-ADD2         OPSCLE                    CFT014CFT009
     C***********OPSCC3    WHEQ *BLANKS                             CFT014CFT009
     C***********          MOVE PCCY      OPSCC3                    CFT014CFT009
     C***********          Z-ADDWSCHG     OPSCH3                    CFT014CFT009
     C***********          Z-ADD3         OPSCLE                    CFT014CFT009
     C***********OPSCC4    WHEQ *BLANKS                             CFT014CFT009
     C***********          MOVE PCCY      OPSCC4                    CFT014CFT009
     C***********          Z-ADDWSCHG     OPSCH4                    CFT014CFT009
     C***********          Z-ADD4         OPSCLE                    CFT014CFT009
     C***********          OTHER                                    CFT014CFT009
     C***********          MOVE PCCY      OPSCC5                    CFT014CFT009
     C***********          Z-ADDWSCHG     OPSCH5                    CFT014CFT009
     C***********          Z-ADD5         OPSCLE                    CFT014CFT009
     C***********          ENDSL                                    CFT014CFT009
      *                                                             CFT014CFT009
     C***********          ENDIF                                    CFT014CFT009
      *                                                                   CFT014
     C                     Z-ADDWORGRT    OPOEXR                                           AR1036310
      *                                                                                    AR1036310
     C                     MOVE FRNT      OPFRNT                          CFT014
     C                     MOVE REPA      OPREPA                          CFT014
      *                                                                                       CSW209
      **  Set other Cover fields to blanks/zeros                                              CSW209
      *                                                                                       CSW209
     C           CSW209    IFEQ 'Y'                                                           CSW209
     C                     MOVEL*BLANKS   OPOMVF                                              CSW209
     C                     MOVEL*BLANKS   OPOCVF                                              CSW209
     C                     MOVEL*BLANKS   OPCOCT                                              CSW209
     C                     MOVEL*BLANKS   OPCOC1                                              CSW209
     C                     MOVEL*BLANKS   OPCOC2                                              CSW209
     C                     MOVEL*BLANKS   OPCOC3                                              CSW209
     C                     MOVEL*BLANKS   OPCOC4                                              CSW209
     C                     MOVEL*BLANKS   OPCOC5                                              CSW209
     C                     MOVEL*BLANKS   OPCOBT                                              CSW209
     C                     MOVEL*BLANKS   OPCOB1                                              CSW209
     C                     MOVEL*BLANKS   OPCOB2                                              CSW209
     C                     MOVEL*BLANKS   OPCOB3                                              CSW209
     C                     MOVEL*BLANKS   OPCOB4                                              CSW209
     C                     MOVEL*BLANKS   OPCOB5                                              CSW209
     C                     MOVEL*BLANKS   OPCIBT                                              CSW209
     C                     MOVEL*BLANKS   OPCIB1                                              CSW209
     C                     MOVEL*BLANKS   OPCIB2                                              CSW209
     C                     MOVEL*BLANKS   OPCIB3                                              CSW209
     C                     MOVEL*BLANKS   OPCIB4                                              CSW209
     C                     MOVEL*BLANKS   OPCIB5                                              CSW209
     C                     MOVEL*BLANKS   OPCABT                                              CSW209
     C                     MOVEL*BLANKS   OPCAB1                                              CSW209
     C                     MOVEL*BLANKS   OPCAB2                                              CSW209
     C                     MOVEL*BLANKS   OPCAB3                                              CSW209
     C                     MOVEL*BLANKS   OPCAB4                                              CSW209
     C                     MOVEL*BLANKS   OPCAB5                                              CSW209
     C                     MOVEL*BLANKS   OPCBCT                                              CSW209
     C                     MOVEL*BLANKS   OPCBC1                                              CSW209
     C                     MOVEL*BLANKS   OPCBC2                                              CSW209
     C                     MOVEL*BLANKS   OPCBC3                                              CSW209
     C                     MOVEL*BLANKS   OPCBC4                                              CSW209
     C                     MOVEL*BLANKS   OPCBC5                                              CSW209
     C                     MOVEL*BLANKS   OPCDP1                                              CSW209
     C                     MOVEL*BLANKS   OPCDP2                                              CSW209
     C                     MOVEL*BLANKS   OPCDP3                                              CSW209
     C                     MOVEL*BLANKS   OPCDP4                                              CSW209
     C                     MOVEL*BLANKS   OPCBB1                                              CSW209
     C                     MOVEL*BLANKS   OPCBB2                                              CSW209
     C                     MOVEL*BLANKS   OPCBB3                                              CSW209
     C                     MOVEL*BLANKS   OPCBB4                                              CSW209
     C                     MOVEL*BLANKS   OPCBB5                                              CSW209
     C                     MOVEL*BLANKS   OPCBB6                                              CSW209
     C                     MOVEL*BLANKS   OPCICY                                              CSW209
     C                     Z-ADD0         OPCIAM                                              CSW209
     C                     ELSE                                                               CSW209
     C                     MOVEL*BLANKS   OPNWRK                                              CSW209
     C                     MOVEL*BLANKS   OPMTPY                                              CSW209
     C                     MOVEL*BLANKS   OPVALF                                              CSW209
     C                     MOVEL*BLANKS   OPOCB1                                              CSW209
     C                     MOVEL*BLANKS   OPOCB2                                              CSW209
     C                     MOVEL*BLANKS   OPOCB3                                              CSW209
     C                     MOVEL*BLANKS   OPOCB4                                              CSW209
     C                     MOVEL*BLANKS   OPOCB5                                              CSW209
     C                     MOVEL*BLANKS   OPOCB6                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                   CFT014
      ** Write extension details of the new OP to OTPAYXPD.               CFT014
      *                                                                   CFT014
      ** Suppress write if CFT009 is on, as the write will be done        CFT009
      ** later on in the CDATE subroutine.                                CFT009
      *                                                                   CFT009
     C           CFT009    IFNE 'Y'                                       CFT009
     C**********           MOVEASTAMP,1   OPTMST           Default Timestamp         CPK015 BUG23056
      *                                                                                     BUG23056
      ** To populate the current timestamp value                                            BUG23056
      *                                                                                     BUG23056
     C                     CALL 'ZAGENTS'                                                   BUG23056
     C                     PARM           TMSTMP 26                                         BUG23056
     C                     MOVE TMSTMP    OPTMST                                            BUG23056
      *                                                                                     BUG23056
     C                     WRITEOTPAYXDF               22                 CFT014
      *                                                                   CFT014
     C           *IN22     IFEQ '1'                                       CFT014
     C           *LOCK     IN   DLDA                                      CFT014
     C                     MOVE '039'     DBASE                           CFT014
     C                     MOVELOPPREF    DBKEY                           CFT014
     C                     MOVEL'OTPAYXL0'DBFILE                          CFT014
     C                     MOVEL'FT0205'  DBPGM                           CFT014
     C                     OUT  DLDA                                      CFT014
     C                     SETON                     U7U8LR               CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT014
     C           WXTEND    ENDSR                                          CFT014
      *****************************************************************   CFT014
     C/EJECT
     C********************************************************************
     C*
     C** OUUDT SR.TO UPDATE THE REGULAR PAYMENTS RECORD ON 'OTPAYDD' ON
     C** MATURITY DATE
     C*
     C           OUUDT     BEGSR
     C*
     C           WPREF     CHAINOTPAY                23
     C           *IN23     IFEQ '1'
     C           *LOCK     IN   DLDA
     C                     MOVEL'FT0205'  DBPGM            ***************
     C                     MOVELWPREF     DBKEY            * DB ERROR 05 *
     C                     MOVE 'OTPAY'   DBFILE           ***************
     C*********************MOVE '05'      DBASE                           S01194
     C                     MOVE '005'     DBASE                           S01194
     C                     OUT  DLDA
     C                     SETON                     U7U8LR
     C                     GOTO FINS02
     C                     END
     C*
     C*
     C                     MOVE 'M'       RECI
     C                     MOVE *ZEROS    NPDT
     C                     MOVE *ZEROS    NPDTD1
     C                     MOVE *ZEROS    NPDTD2
     C                     MOVE *ZEROS    NPDTD3
     C***********                                                  S01494 S01499
     C***Set*up*Linked*to*Reg*Payment*Reference********************S01494 S01499
     C***********                                                  S01494 S01499
     C***********          MOVE WPREF     OPRPRF                   S01494 S01499
     C*
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0205CCP3                                           S01408
     C*                                                                   S01408
     C                     UPDATOTPAYDDF               25  UPDATE FAIL
     C*
     C           *IN25     IFEQ '1'
     C           *LOCK     IN   DLDA
     C                     MOVEL'FT0205'  DBPGM            ***************
     C                     MOVELWPREF     DBKEY            * DB ERROR 06 *
     C                     MOVE 'OTPAY'   DBFILE           ***************
     C*********************MOVE '06'      DBASE                           S01194
     C                     MOVE '006'     DBASE                           S01194
     C                     OUT  DLDA
     C                     SETON                     U7U8LR
     C                     GOTO FINS02
     C                     END
      *                                                                   CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
      *                                                                   CFT014
      ** Update Record Id of extension record.                            CFT014
      *                                                                   CFT014
     C           WPREF     CHAINOTPAYXL0             23                   CFT014
     C           *IN23     IFEQ '1'                                       CFT014
     C           *LOCK     IN   DLDA                                      CFT014
     C                     MOVE '034'     DBASE                           CFT014
     C                     MOVELWPREF     DBKEY                           CFT014
     C                     MOVEL'OTPAYXL0'DBFILE                          CFT014
     C                     MOVEL'FT0205'  DBPGM                           CFT014
     C                     OUT  DLDA                                      CFT014
     C                     SETON                     U7U8LR               CFT014
     C                     GOTO FINS02                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     MOVE 'M'       OPRECI                          CFT014
     C                     UPDATOTPAYXDF               25                 CFT014
      *                                                                   CFT014
     C           *IN25     IFEQ '1'                                       CFT014
     C           *LOCK     IN   DLDA                                      CFT014
     C                     MOVE '035'     DBASE                           CFT014
     C                     MOVELWPREF     DBKEY                           CFT014
     C                     MOVEL'OTPAYXL0'DBFILE                          CFT014
     C                     MOVEL'FT0205'  DBPGM                           CFT014
     C                     OUT  DLDA                                      CFT014
     C                     SETON                     U7U8LR               CFT014
     C                     GOTO FINS02                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
     C*
     C*
     C/COPY WNCPYSRC,FT0205C006
     C           FINS02    ENDSR
     C*
     C********************************************************************
     C/EJECT
     C********************************************************************
     C*
     C** UTRLR SR.TO UPDATE THE TRAILER 'OTPAYZZ'
     C*
     C           UTRLR     BEGSR
     C*
     C           1         CHAINOTPAYZZ              26
     C*
     C           *IN26     IFEQ '1'
     C           *LOCK     IN   DLDA
     C                     MOVEL'FT0205'  DBPGM
     C                     MOVEL'MISSING' KEY15            ***************
     C                     MOVE ' TRAILER'KEY15            * DB ERROR 07 *
     C                     MOVELKEY15     DBKEY            ***************
     C                     MOVE 'OTPAY'   DBFILE
     C*********************MOVE '07'      DBASE                           S01194
     C                     MOVE '007'     DBASE                           S01194
     C                     OUT  DLDA
     C                     SETON                     U7U8LR
     C                     GOTO FINS03
     C                     END
     C*
     C                     ADD  WNORR2    NORE1
     C                     Z-ADDHRWN      ZZTOTI
     C                     Z-ADDHRDC      ZZTOTD
     C                     Z-ADDWHRWN2    ZZAMTI
     C                     Z-ADDWHRDC2    ZZAMTD
     C                     EXSR GLZSUM
     C                     Z-ADDZZTOTI    HRWN
     C                     Z-ADDZZTOTD    HRDC
     C*
     C                     UPDATOTPAYZZF               27  UPDATE FAIL
     C*
     C           *IN27     IFEQ '1'
     C           *LOCK     IN   DLDA
     C                     MOVEL'FT0205'  DBPGM
     C                     MOVEL'UPDATE ' KEY14  14
     C                     MOVE 'FAIL ON' KEY14            ***************
     C                     MOVELKEY14     KEY22  22        * DB ERROR 08 *
     C                     MOVE ' TRAILER'KEY22            ***************
     C                     MOVELKEY22     DBKEY
     C                     MOVE 'OTPAY'   DBFILE
     C*********************MOVE '08'      DBASE                           S01194
     C                     MOVE '008'     DBASE                           S01194
     C                     OUT  DLDA
     C                     SETON                     U7U8LR
     C                     GOTO FINS03
     C                     END
     C*
     C**   RESET RECORD COUNT AND HASH TOTAL FIELDS
     C*
     C                     MOVE *ZEROS    WNORR2
     C                     MOVE *ZEROS    WHRWN2
     C                     MOVE *ZEROS    WHRDC2
     C*
     C*
     C           FINS03    ENDSR
     C*
     C********************************************************************
     C/EJECT
     C********************************************************************
     C*
     C** RPUDT SR.TO UPDATE THE REGULAR PAYMENTS RECORD ON 'OTPAYDD' WHEN
     C** THE LAST 'NEXT PAYMENT DATE' IS LESS THAN THE MATURITY DATE
     C*
     C           RPUDT     BEGSR
     C*
     C           WPREF     CHAINOTPAY                23
     C           *IN23     IFEQ '1'
     C           *LOCK     IN   DLDA
     C                     MOVEL'FT0205'  DBPGM            ***************
     C                     MOVELWPREF     DBKEY            * DB ERROR 09 *
     C                     MOVE 'OTPAY'   DBFILE           ***************
     C*********************MOVE '09'      DBASE                           S01194
     C                     MOVE '009'     DBASE                           S01194
     C                     OUT  DLDA
     C                     SETON                     U7U8LR
     C                     GOTO FINS04
     C                     END
     C*
     C*
     C                     MOVE WNPD      NPDT
     C                     MOVE NPDT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZDATE     NPDTD1
     C                     MOVE NPDTD1    WDATE1
     C                     EXSR DAFDT
     C                     MOVE WDATE2    NPDTD2
     C                     MOVE WDATE3    NPDTD3
     C***********                                                  S01494 S01499
     C***Set*up*Linked to Reg Payment Reference                    S01494 S01499
     C***********                                                  S01494 S01499
     C***********          MOVE WPREF     OPRPRF                   S01494 S01499
     C*
     C                     UPDATOTPAYDDF               25  UPDATE FAIL
     C*
     C           *IN25     IFEQ '1'
     C           *LOCK     IN   DLDA
     C                     MOVEL'FT0205'  DBPGM            ***************
     C                     MOVELWPREF     DBKEY            * DB ERROR 10 *
     C                     MOVE 'OTPAY'   DBFILE           ***************
     C*********************MOVE '10'      DBASE                           S01194
     C                     MOVE '010'     DBASE                           S01194
     C                     OUT  DLDA
     C                     SETON                     U7U8LR
     C                     END
     C/COPY WNCPYSRC,FT0205C007
     C*
     C           FINS04    ENDSR
     C*
     C********************************************************************
     C/EJECT
     C********************************************************************
     C*
     C** PRTP1 SR.TO SETUP FIELDS FOR OUTPUT TO THE PRINTER FILE FT0205P1
     C** AND TO WRITE A RECORD TO THE PRINTER FILE
     C*
     C           PRTP1     BEGSR
     C*                                                                   S01117
     C************                                                        S01435
     C************         MOVE DST1      PDST1                     S01117S01435
     C************         MOVE ORC1      PORC1                     S01117S01435
     C************                                                  S01117S01435
     C***If*single branched and full account in receiving bank do n S01117S01435
     C***move*branch to printer field                               S01117S01435
     C************                                                  S01117S01435
     C***********MBIN      IFEQ 'N'                                 S01117S01435
     C************                                                  S01117S01435
     C***********DSTT      IFEQ 'G'                                 S01117S01435
     C************         MOVELDST1      WDEST  15                 S01117S01435
     C************         MOVE *BLANKS   PDST1                     S01117S01435
     C************         MOVELWDEST     PDST1                     S01117S01435
     C************         END                                      S01117S01435
     C************                                                  S01117S01435
     C***If*partial account in ordering customer do not move branch S01117S01435
     C***printer*file field                                         S01117S01435
     C************                                                  S01117S01435
     C***********ORCT      IFEQ 'P'                                 S01117S01435
     C************         MOVELORC1      WORC   12                 S01117S01435
     C************         MOVE *BLANKS   PORC1                     S01117S01435
     C************         MOVELWORC      PORC1                     S01117S01435
     C************         END                                      S01117S01435
     C************                                                  S01117S01435
     C************         END                                      S01117S01435
     C************                                                        S01435
     C************                                                        S01435
     C***FORMAT*SETTLE AMOUNT                                             S01435
     C************                                                        S01435
     C************         MOVEL*BLANKS   WFDIN  15                       S01435
     C************         MOVE SMAM      WFDIN                           S01435
     C************         Z-ADDWSCDP     WDEC    10                      S01435
     C***********13        SUB  WSCDP     WDIG    20                      S01435
     C************         EXSR UGFRMT                                    S01435
     C************         MOVE WFDOUT    P1SMAM                          S01435
     C************                                                        S01435
     C***FORMAT*PAY AMOUNT                                                S01435
     C************                                                        S01435
     C************         MOVEL*BLANKS   WFDIN                           S01435
     C************         MOVE PYAM      WFDIN                           S01435
     C************         Z-ADDWPCDP     WDEC                            S01435
     C***********13        SUB  WPCDP     WDIG                            S01435
     C************         EXSR UGFRMT                                    S01435
     C************         MOVE WFDOUT    P1PYAM                          S01435
     C************                                                        S01435
     C***FORMAT*OTHER AMOUNTS & CURRENCIES                                S01435
     C***IF*CHARGES TO DEBIT A/C FIELD IS NON-ZERO USE BASE CURRENCY;     S01435
     C***OTHERWISE IF PAY PLUS CHARGES INDICATOR IS 'Y' USE SETTLE CCY;   S01435
     C***OTHERWISE USE PAY CURRENCY                                       S01435
     C************                                                        S01435
     C***********CDRO      IFNE *ZERO                                     S01435
     C************         MOVELBCCY      WCCY    3                       S01435
     C************         Z-ADDWBCDP     WDEC                            S01435
     C************         ELSE                                           S01435
     C***********ADDC      IFEQ 'A'                                       S01435
     C************         MOVELWSMCY     WCCY                            S01435
     C************         Z-ADDWSCDP     WDEC                            S01435
     C************         ELSE                                           S01435
     C************         MOVELWRCCY     WCCY                            S01435
     C************         Z-ADDWPCDP     WDEC                            S01435
     C************         END                                            S01435
     C************         END                                            S01435
     C************                                                        S01435
     C***********11        SUB  WDEC      WDIG                            S01435
     C************                                                        S01435
     C***SETUP*CURRENCY NAMES                                             S01435
     C************                                                        S01435
     C************         MOVELWCCY      P1TRCY                          S01435
     C************         MOVELWCCY      P1TXCY                          S01435
     C************         MOVELWCCY      P1CQCY                          S01435
     C************         MOVELWCCY      P1SPCY                          S01435
     C************         MOVELWCCY      P1CSCY                          S01435
     C************         MOVELWCCY      P1MSCY                          S01435
     C************                                                        S01435
     C***FORMAT*TRANSFER COMMISSION AMOUNT                                S01435
     C************                                                        S01435
     C************         MOVEL*BLANKS   WFDIN                           S01435
     C************         MOVE TRCM      WFDIN                           S01435
     C************         EXSR UGFRMT                                    S01435
     C************         MOVE WFDOUT    P1TRCM                          S01435
     C************                                                        S01435
     C***FORMAT*TELEX CHARGE AMOUNT                                       S01435
     C************                                                        S01435
     C************         MOVEL*BLANKS   WFDIN                           S01435
     C************         MOVE TXCH      WFDIN                           S01435
     C************         EXSR UGFRMT                                    S01435
     C************         MOVE WFDOUT    P1TXCH                          S01435
     C************                                                        S01435
     C***FORMAT*CHEQUE CHARGE AMOUNT                                      S01435
     C************                                                        S01435
     C************         MOVEL*BLANKS   WFDIN                           S01435
     C************         MOVE CQCH      WFDIN                           S01435
     C************         EXSR UGFRMT                                    S01435
     C************         MOVE WFDOUT    P1CQCH                          S01435
     C************                                                        S01435
     C***FORMAT*SWIFT PR CHARGE AMOUNT                                    S01435
     C************                                                        S01435
     C************         MOVEL*BLANKS   WFDIN                           S01435
     C************         MOVE SPCH      WFDIN                           S01435
     C************         EXSR UGFRMT                                    S01435
     C************         MOVE WFDOUT    P1SPCH                          S01435
     C************                                                        S01435
     C***FORMAT*COSTS ABROAD CHARGE AMOUNT                                S01435
     C************                                                        S01435
     C************         MOVEL*BLANKS   WFDIN                           S01435
     C************         MOVE CSTA      WFDIN                           S01435
     C************         EXSR UGFRMT                                    S01435
     C************         MOVE WFDOUT    P1CSTA                          S01435
     C************                                                        S01435
     C***FORMAT*MISCELLANEOUS CHARGE AMOUNT                               S01435
     C************                                                        S01435
     C************         MOVEL*BLANKS   WFDIN                           S01435
     C************         MOVE MSCH      WFDIN                           S01435
     C************         EXSR UGFRMT                                    S01435
     C************         MOVE WFDOUT    P1MSCH                          S01435
     C************                                                        S01435
     C***FORMAT*FINAL DATE FIELD (WFDAT)  USING  ZDATE2                   S01435
     C************                                                        S01435
     C************         MOVE *BLANK    P1FDAT                          S01435
     C************                                                        S01435
     C***MOVE*BLANKS INTO THE 'NEXT DATE' FIELD                           S01435
     C************                                                        S01435
     C************         MOVE *BLANKS   P1NPDT                          S01435
     C************                                                        S01435
     C***SETUP*THE 'RATE' FIELD                                           S01435
     C************                                                        S01435
     C************         Z-ADDRATE      P1RATE                          S01435
     C************         MOVE SNCT      PRMTYP  1        ( SNCO )       S01435
     C************         MOVE *ZEROS    PRMFLD 12                       S01435
     C************         MOVELSNCO      PRMFLD                          S01435
     C************         EXSR CHOPF                                     S01435
     C************         MOVELPRMFLD    P1SNCO                          S01435
     C************                                                        S01435
     C************         MOVE ORBT      PRMTYP  1        ( ORBK )       S01435
     C************         MOVE *ZEROS    PRMFLD 12                       S01435
     C************         MOVELORBK      PRMFLD                          S01435
     C************         EXSR CHOPF                                     S01435
     C************         MOVELPRMFLD    P1ORBK                          S01435
     C***********MBIN      IFEQ 'Y'                                 S01117S01435
     C***********ORBT      IFEQ 'P'                                 S01117S01435
     C************         MOVELORBB      P1ORBB                    S01117S01435
     C************         ELSE                                     S01117S01435
     C************         MOVE *BLANKS   P1ORBB                    S01117S01435
     C************         END                                      S01117S01435
     C************         END                                      S01117S01435
     C************                                                        S01435
     C************         MOVE CDRT      PRMTYP  1        ( CDRO )       S01435
     C************         MOVE *ZEROS    PRMFLD 12                       S01435
     C************         MOVELCDRO      PRMFLD                          S01435
     C************         EXSR CHOPF                                     S01435
     C************         MOVELPRMFLD    P1CDRO                          S01435
     C***********MBIN      IFEQ 'Y'                                 S01117S01435
     C***********CDRT      IFEQ 'P'                                 S01117S01435
     C************         MOVELCDBR      P1CDBR                    S01117S01435
     C************         ELSE                                     S01117S01435
     C************         MOVE *BLANKS   P1CDBR                    S01117S01435
     C************         END                                      S01117S01435
     C************         END                                      S01117S01435
     C************                                                  S01117S01435
     C***FORMAT*SWIFT PRIORITY CODE                                 S01117S01435
     C***********SWPC      IFEQ 1                                   S01117S01435
     C************         MOVE 'U'       P1SWPC                    S01117S01435
     C************         ELSE                                     S01117S01435
     C***********SWPC      IFEQ 2                                   S01117S01435
     C************         MOVE 'N'       P1SWPC                    S01117S01435
     C************         END                                      S01117S01435
     C************         END                                      S01117S01435
      *                                                                   S01435
      * Set Up Ordering Institution Details                               S01435
      *                                                                   S01435
     C                     MOVEL*BLANKS   P1OBDS                          S01435
     C                     MOVEL*BLANKS   P1ORBK                          S01435
     C           OPORB1    IFNE *BLANKS                                   S01435
      *                                                                   S01435
      * If SWIFT type A translate else leave as on message                S01435
      *                                                                   S01435
     C                     MOVEL#IMSG     P1ORBK                          S01435
     C           OPORBT    IFNE 'S'                                       S01435
     C                     MOVELOPORB1    P1ORB1                          S01435
     C                     MOVELOPORB2    P1ORB2                          S01435
     C                     MOVELOPORB3    P1ORB3                          S01435
     C                     MOVELOPORB4    P1ORB4                          S01435
     C                     MOVELOPORB5    P1ORB5                          S01435
     C                     ELSE                                           S01435
     C                     MOVEL'ORBT'    XCALL                           S01435
     C                     MOVELOPORBT    XTYPE                           S01435
     C                     MOVEL*BLANKS   XNAMDS                          S01435
     C                     MOVELOPORB1    ##001   1                       S01435
     C           ##001     IFEQ '/'                                       S01435
     C                     MOVELOPORB2    XNAMDS                          S01435
     C                     ELSE                                           S01435
     C                     MOVELOPORB1    XNAMDS                          S01435
     C                     END                                            S01435
     C                     EXSR GETADD                                    S01435
     C                     MOVELXNAMDS    P1OBDS                          S01435
     C                     END                                            S01435
     C                     END                                            S01435
      *                                                                   S01435
      * Translate input account with bank                                 S01435
      *                                                                   S01435
     C           ORBT      IFNE *BLANKS                                   S01435
     C                     MOVEL'ORBT'    XCALL                           S01435
     C                     MOVELORBT      XTYPE                           S01435
     C                     MOVELSMCY      XCCY                            S01435
     C                     MOVEL*BLANKS   XNAMDS                          S01435
     C                     MOVELORBK      XNAMDS                          S01435
     C                     MOVELORBB      XBRCA                           S01435
     C                     EXSR GETADD                                    S01435
     C           OPORB1    IFEQ *BLANKS                                   S01435
     C                     MOVELXADDS     P1OBDS                          S01435
     C                     END                                            S01435
     C                     MOVELXNAMDS    P1ORBK                          S01435
     C                     END                                            S01435
      *                                                                   S01435
      ** Sender's Correspondent                                           S01435
      *                                                                   S01435
     C                     MOVEL'SNCT'    XCALL                           S01435
     C                     MOVELSNCT      XTYPE                           S01435
     C                     MOVELPCCY      XCCY                            S01435
     C                     MOVEL*BLANKS   XNAMDS                          S01435
     C                     MOVELSNCO      XNAMDS                          S01435
     C                     EXSR GETADD                                    S01435
     C                     MOVELXNAMDS    P1SNCO                          S01435
     C                     MOVELXADDS     P1SNDS                          S01435
      *                                                                   S01435
      ** INTERMEDIARY BANK                                                S01435
      *                                                                   S01435
     C                     MOVEL'INBT'    XCALL   4                       S01435
     C                     MOVELINBT      XTYPE                           S01435
     C                     MOVELININDS    XNAMDS                          S01435
     C                     EXSR GETADD                                    S01435
     C                     MOVELXNAMDS    P1INDS                          S01435
      *                                                                   S01435
      ** RECEIVER'S CORRESPONDENT                                         S01435
      *                                                                   S01435
     C                     MOVE 'RCRT'    XCALL   4                       S01435
     C                     MOVELRCRT      XTYPE                           S01435
     C                     MOVELRCINDS    XNAMDS                          S01435
     C                     EXSR GETADD                                    S01435
     C                     MOVELXNAMDS    P1RCDS                          S01435
      *                                                                   S01435
      ** ORDERING CUSTOMER                                                S01435
      *                                                                   S01435
     C                     MOVE 'ORCT'    XCALL   4                       S01435
     C                     MOVELORCT      XTYPE                           S01435
     C                     MOVELSMCY      XCCY                            S01435
     C                     MOVELORINDS    XNAMDS                          S01435
     C                     EXSR GETADD                                    S01435
     C                     MOVELXNAMDS    P1ORDS                          S01435
     C/COPY WNCPYSRC,FT0205C022
      *                                                                   S01435
      ** Destination                                                      S01435
      *                                                                   S01435
     C                     MOVE 'DSTT'    XCALL   4                       S01435
     C                     MOVELDSTT      XTYPE                           S01435
     C                     MOVELDSINDS    XNAMDS                          S01435
     C/COPY WNCPYSRC,FT0205C008
     C                     EXSR GETADD                                    S01435
     C/COPY WNCPYSRC,FT0205C009
     C                     MOVELXNAMDS    P1DSDS                          S01435
      *                                                                   S01435
      ** ACCOUNT WITH BANK                                                S01435
      *                                                                   S01435
     C                     MOVE 'ACBT'    XCALL   4                       S01435
     C                     MOVELACBT      XTYPE                           S01435
     C                     MOVELACINDS    XNAMDS                          S01435
     C                     EXSR GETADD                                    S01435
     C                     MOVELXNAMDS    P1ACDS                          S01435
     C/COPY WNCPYSRC,FT0205C023
      *                                                                   S01435
      ** BENEFICIARY CUSTOMER                                             S01435
      *                                                                   S01435
     C                     MOVE 'BNCT'    XCALL   4                       S01435
     C                     MOVELBNCT      XTYPE                           S01435
     C                     MOVELBNINDS    XNAMDS                          S01435
     C                     EXSR GETADD                                    S01435
     C                     MOVELXNAMDS    P1BNDS                          S01435
     C/COPY WNCPYSRC,FT0205C024
      *                                                                   S01435
     C                     MOVE *BLANKS   XCALL   4                       S01435
     C*                                                                   S01435
     C** FORMAT SETTLE & PAY AMOUNTS                                      S01435
     C*                                                                   S01435
     C** CALL UATBCN TO ACCESS CURRENCY RECORD FOR SETTLE CURRENCY        S01435
      *                                                                   S01435
     C                     MOVEL*BLANKS   ZTABKY                          S01435
     C                     MOVEL'20'      ZTABKY                          S01435
     C                     MOVELSMCY      KEY04                           S01435
     C                     MOVE '1'       KEY04                           S01435
     C                     MOVE KEY04     ZTABKY                          S01435
     C           ZTABKY    CHAINTABFP                99                   S01435
     C  N99      RECI      COMP 'D'                  9999  ON, IS DELETED S01435
     C*                                                                   S01435
     C** CHECK IF DATABASE ERROR OCCURRED                                 S01435
     C*                                                                   S01435
     C           *IN99     IFEQ '1'                                       S01435
     C           *LOCK     IN   DLDA                                      S01435
     C                     MOVEL'FT0205'  DBPGM                           S01435
     C                     MOVELZTABKY    DBKEY            ***************S01435
     C                     MOVE 'TABLE   'DBFILE           * DB ERROR 54 *S01435
     C                     MOVE '055'     DBASE            ***************S01435
     C                     OUT  DLDA                                      S01435
     C                     SETON                     U7U8LR               S01435
     C                     RETRN                                          S01435
     C                     END                                            S01435
     C*                                                                   S01435
     C** STORE NUMBER OF DECIMAL PLACES FOR SETTLE CURRENCY               S01435
     C*                                                                   S01435
     C                     Z-ADDCDP       SVSCDP  10                      S01435
     C*                                                                   S01435
     C** FORMAT SETTLE AMOUNT                                             S01435
     C*                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN  15                       S01435
     C                     MOVE SMAM      WFDIN                           S01435
     C                     Z-ADDSVSCDP    WDEC    10                      S01435
     C           13        SUB  SVSCDP    WDIG    20                      S01435
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P1SMAM                          S01435
     C*                                                                   S01435
     C** CALL UATBCN TO ACCESS CURRENCY RECORD FOR PAY CURRENCY           S01435
      *                                                                   S01435
     C                     MOVEL*BLANKS   ZTABKY                          S01435
     C                     MOVEL'20'      ZTABKY                          S01435
     C                     MOVELPCCY      KEY04                           S01435
     C                     MOVE '1'       KEY04                           S01435
     C                     MOVE KEY04     ZTABKY                          S01435
     C           ZTABKY    CHAINTABFP                99                   S01435
     C  N99      RECI      COMP 'D'                  9999  ON, IS DELETED S01435
     C*                                                                   S01435
     C** CHECK IF DATABASE ERROR OCCURRED                                 S01435
     C*                                                                   S01435
     C           *IN99     IFEQ '1'                                       S01435
     C           *LOCK     IN   DLDA                                      S01435
     C                     MOVEL'FT0205'  DBPGM                           S01435
     C                     MOVELZTABKY    DBKEY            ***************S01435
     C                     MOVE 'TABLE   'DBFILE           * DB ERROR 56 *S01435
     C                     MOVE '056'     DBASE            ***************S01435
     C                     OUT  DLDA                                      S01435
     C                     SETON                     U7U8LR               S01435
     C                     RETRN                                          S01435
     C                     END                                            S01435
     C*                                                                   S01435
     C** STORE NUMBER OF DECIMAL PLACES FOR PAY CURRENCY                  S01435
     C*                                                                   S01435
     C                     Z-ADDCDP       SVPCDP  10                      S01435
     C*                                                                   S01435
     C** FORMAT PAY AMOUNT                                                S01435
     C*                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN                           S01435
     C                     MOVE PYAM      WFDIN                           S01435
     C                     Z-ADDSVPCDP    WDEC                            S01435
     C           13        SUB  SVPCDP    WDIG                            S01435
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P1PYAM                          S01435
     C           CFT120    IFEQ 'Y'                                                           CFT120
      *                                                                                       CFT120
      ** Access Currency Record for Charges to the DR of Currency                             CFT120
      *                                                                                       CFT120
     C           OPCDRC    IFNE *BLANKS                                                       CFT120
     C                     MOVEL*BLANKS   ZTABKY                                              CFT120
     C                     MOVEL'20'      ZTABKY                                              CFT120
     C                     MOVELOPCDRC    KEY04                                               CFT120
     C                     MOVE '1'       KEY04                                               CFT120
     C                     MOVE KEY04     ZTABKY                                              CFT120
     C           ZTABKY    CHAINTABFP                99                                       CFT120
     C  N99      RECI      COMP 'D'                  9999                                     CFT120
      *                                                                                       CFT120
      ** Check if database error occured                                                      CFT120
      *                                                                                       CFT120
     C           *IN99     IFEQ '1'                                                           CFT120
     C           *LOCK     IN   DLDA                                                          CFT120
     C                     MOVEL'FT0205'  DBPGM                                               CFT120
     C                     MOVELZTABKY    DBKEY                                               CFT120
     C                     MOVE 'TABLE   'DBFILE                                              CFT120
     C                     MOVE '062'     DBASE                                               CFT120
     C                     OUT  DLDA                                                          CFT120
     C                     SETON                     U7U8LR                                   CFT120
     C                     RETRN                                                              CFT120
     C                     ELSE                                                               CFT120
      *                                                                                       CFT120
      ** Store Number of Decimal Places for OPCDRC Currency                                   CFT120
      *                                                                                       CFT120
     C                     Z-ADDCDP       SVCCDP  10                                          CFT120
     C                     ENDIF                                                              CFT120
     C                     ENDIF                                                              CFT120
     C                     ENDIF                                                              CFT120
     C*                                                                   S01435
     C** FORMAT OTHER AMOUNTS & CURRENCIES                                S01435
     C** IF CHARGES TO DEBIT A/C FIELD IS NON-ZERO USE BASE CURRENCY;     S01435
     C** OTHERWISE IF PAY PLUS CHARGES INDICATOR IS 'Y' USE SETTLE CCY;   S01435
     C** OTHERWISE USE PAY CURRENCY                                       S01435
     C*                                                                   S01435
     C***********CDRO      IFNE *ZERO                                                  S01435 CSD027
     C           CDRO      IFNE *BLANKS                                                       CSD027
      *                                                                                       CFT120
     C                     MOVELBCCY      WCCY    3                       S01435
     C                     Z-ADDWBCDP     WDEC                            S01435
     C           OPCDRC    IFNE *BLANKS                                                       CFT120
     C           CFT120    ANDEQ'Y'                                                           CFT120
     C                     MOVELOPCDRC    WCCY                                                CFT120
     C                     Z-ADDSVCCDP    WDEC                                                CFT120
     C                     ENDIF                                                              CFT120
      *                                                                                       CFT120
     C/COPY WNCPYSRC,FT0205C011
     C                     ELSE                                           S01435
     C           ADDC      IFEQ 'A'                                       S01435
     C                     MOVELSMCY      WCCY                            S01435
     C                     Z-ADDSVSCDP    WDEC                            S01435
     C                     ELSE                                           S01435
     C                     MOVELPCCY      WCCY                            S01435
     C                     Z-ADDSVPCDP    WDEC                            S01435
     C                     END                                            S01435
     C                     END                                            S01435
     C*                                                                   S01435
     C           11        SUB  WDEC      WDIG                            S01435
     C*                                                                   S01435
     C** SETUP CURRENCY NAMES                                             S01435
     C*                                                                   S01435
     C                     MOVELWCCY      P1TRCY                          S01435
     C                     MOVELWCCY      P1TXCY                          S01435
     C                     MOVELWCCY      P1CQCY                          S01435
     C                     MOVELWCCY      P1SPCY                          S01435
     C                     MOVELWCCY      P1CSCY                          S01435
     C                     MOVELWCCY      P1MSCY                          S01435
     C*                                                                   S01494
     C           *IN30     IFEQ '1'                                       S01494
     C                     MOVELWCCY      P1CHCY                          S01494
     C                     END                                            S01494
     C*                                                                   S01499
     C           *IN31     IFEQ '1'                                       S01499
     C*                                                                   S01499
     C                     MOVELWCCY      P1VTCY                          S01499
     C*                                                                   S01499
     C** Set up VAT flags for report                                      S01499
     C*                                                                   S01499
     C                     MOVE OPVAT1    P1TRVF                          S01499
     C                     MOVE OPVAT2    P1TXVF                          S01499
     C                     MOVE OPVAT3    P1CQVF                          S01499
     C                     MOVE OPVAT4    P1CSVF                          S01499
     C                     MOVE OPVAT5    P1SPVF                          S01499
     C                     MOVE OPVAT6    P1MSVF                          S01499
     C           *IN30     IFEQ '1'                                       S01499
     C                     MOVE OPVAT7    P1CHVF                          S01499
     C                     END                                            S01499
     C*                                                                   S01499
     C                     END                                            S01499
     C*                                                                   S01435
     C** FORMAT TRANSFER COMMISSION AMOUNT                                S01435
     C*                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN                           S01435
     C                     MOVE TRCM      WFDIN                           S01435
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P1TRCM                          S01435
     C*                                                                   S01435
     C** FORMAT TELEX CHARGE AMOUNT                                       S01435
     C*                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN                           S01435
     C                     MOVE TXCH      WFDIN                           S01435
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P1TXCH                          S01435
     C*                                                                   S01435
     C** FORMAT CHEQUE CHARGE AMOUNT                                      S01435
     C*                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN                           S01435
     C                     MOVE CQCH      WFDIN                           S01435
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P1CQCH                          S01435
     C*                                                                   S01435
     C** FORMAT SWIFT PR CHARGE AMOUNT                                    S01435
     C*                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN                           S01435
     C                     MOVE SPCH      WFDIN                           S01435
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P1SPCH                          S01435
     C*                                                                   S01435
     C** FORMAT COSTS ABROAD CHARGE AMOUNT                                S01435
     C*                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN                           S01435
     C                     MOVE CSTA      WFDIN                           S01435
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P1CSTA                          S01435
     C*                                                                   S01435
     C** FORMAT MISCELLANEOUS CHARGE AMOUNT                               S01435
     C*                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN                           S01435
     C                     MOVE MSCH      WFDIN                           S01435
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P1MSCH                          S01435
     C*                                                                   S01494
     C**  Format change commission charge amount                          S01494
     C*                                                                   S01494
     C           *IN30     IFEQ '1'                                       S01494
     C                     MOVE *BLANKS   WFDIN                           S01494
     C                     MOVE OPCHCM    WFDIN                           S01494
     C                     EXSR UGFRMT                                    S01494
     C                     MOVE WFDOUT    P1CHCM                          S01494
     C                     END                                            S01494
     C*                                                                   S01499
     C** Format VAT amount                                                S01499
     C*                                                                   S01499
     C           *IN31     IFEQ '1'                                       S01499
     C                     MOVE *BLANKS   WFDIN                           S01499
     C                     MOVE OPVATT    WFDIN                           S01499
     C                     EXSR UGFRMT                                    S01499
     C                     MOVE WFDOUT    P1VATT                          S01499
     C                     END                                            S01499
     C*                                                                   S01435
     C** FORMAT DATE FIELDS USING SYSTEM ROUTINE ZDATE2                   S01435
     C*                                                                   S01435
     C** SETTLE VALUE DATE                                                S01435
     C*                                                                   S01435
     C                     Z-ADDSLDT      ZDAYNO                          S01435
     C                     EXSR ZDATE2                                    S01435
     C                     MOVELZADATE    P1SLDT                          S01435
     C*                                                                   S01435
     C** PAY VALUE DATE                                                   S01435
     C*                                                                   S01435
     C                     Z-ADDPVDT      ZDAYNO                          S01435
     C                     EXSR ZDATE2                                    S01435
     C                     MOVELZADATE    P1PYDT                          S01435
     C*                                                                   S01435
     C** FINAL DATE                                                       S01435
     C*                                                                   S01435
     C***********          Z-ADDFDAT      ZDAYNO                   S01435 069203
     C***********          EXSR ZDATE2                             S01435 069203
     C***********          MOVELZADATE    P1FDAT                   S01435 069203
     C                     MOVEL*BLANKS   P1FDAT                          069203
     C*                                                                   S01435
     C***********          Z-ADDNPDT      ZDAYNO                   S01435 069203
     C***********          EXSR ZDATE2                             S01435 069203
     C***********          MOVELZADATE    P1NPDT                   S01435 069203
     C                     MOVEL*BLANKS   P1NPDT                          069203
      *                                                                   S01435
     C** SETUP REMAINING REPORT FIELDS                                    S01435
     C*                                                                   S01435
     C                     MOVELPREF      P1PREF                          S01435
     C                     MOVELPYTP      P1PYTP                          S01435
     C                     MOVELPYST      P1PYST                          S01435
     C                     MOVELSMCY      P1SMCY                          S01435
     C                     Z-ADDRATE      P1RATE                          S01435
     C                     MOVELPCCY      P1PCCY                          S01435
     C                     MOVELBBI1      P1BBI1                          S01435
     C                     MOVELBBI2      P1BBI2                          S01435
     C                     MOVELBBI3      P1BBI3                          S01435
     C                     MOVELBBI4      P1BBI4                          S01435
     C                     MOVELBBI5      P1BBI5                          S01435
     C                     MOVELBBI6      P1BBI6                          S01435
     C                     MOVELDTP1      P1DTP1                          S01435
     C                     MOVELDTP2      P1DTP2                          S01435
     C                     MOVELDTP3      P1DTP3                          S01435
     C                     MOVELDTP4      P1DTP4                          S01435
     C                     MOVELSTMT      P1STTP                          S01435
     C*C*PY*WNCPY*RC*FT0205C020                                           169210
     C/COPY WNCPYSRC,FT0205CABS                                           169210
     C           DNBC      IFEQ *ZERO                                     S01435
     C*C*PY*WNCPY*RC*FT0205C021                                           169210
     C/COPY WNCPYSRC,FT0205CABT                                           169210
     C                     MOVE *BLANKS   P1DNBC                          S01435
     C                     ELSE                                           S01435
     C                     MOVELDNBC      P1DNBC                          S01435
     C                     END                                            S01435
     C                     MOVELSNMT      P1SNMT                          S01435
     C                     MOVELADDC      P1ADDC                          S01435
     C                     MOVELRPAY      P1RPAY                          S01435
     C                     MOVELPAYF      P1PAYF                          S01435
     C                     MOVELDYIM      P1DYIM                          S01435
     C                     MOVELDTCH      P1DTCH                          S01435
     C                     MOVELTRCT      P1TRCT                          S01435
     C           SWPC      IFEQ 1                          B001           S01435
     C                     MOVE 'U'       P1SWPC                          S01435
     C                     ELSE                            X001           S01435
     C           SWPC      IFEQ 2                          B002           S01435
     C                     MOVE 'N'       P1SWPC                          S01435
     C                     END                             E002           S01435
     C                     END                             E001           S01435
     C*                                                                   S01435
     C** OUPUT OVERRIDE IF 'Y'                                            S01435
     C*                                                                   S01435
     C                     MOVE *BLANKS   P1OVRD                          S01435
     C           OVRD      IFEQ 'Y'                                       S01435
     C                     MOVE 'YES'     P1OVRD                          S01435
     C                     ELSE                                           S01435
     C                     MOVE 'NO '     P1OVRD                          S01435
     C                     END                                            S01435
      *                                                                   S01435
     C                     MOVE RLPR      P1RLPR                          S01435
     C           CHAP      IFEQ *ZERO                                     S01435
     C                     MOVE *BLANKS   P1CHAP                          S01435
     C                     ELSE                                           S01435
     C                     MOVELCHAP      P1CHAP                          S01435
     C                     END                                            S01435
     C*                                                                   S01435
     C** MT100 customer                                                   S01435
     C*                                                                   S01435
     C           ODMT      IFEQ *BLANK                     B001           S01435
     C           ODMT      OREQ *ZERO                                     S01435
     C                     MOVE *BLANK    P1ODMT                          S01435
     C                     MOVE *BLANK    P1ODMC                          S01435
     C                     ELSE                            X001           S01435
     C                     MOVELODMT      @CSNM                           S01435
      *                                                                   S01435
     C                     CALL 'AOCUSTR0'             9999               S01435
     C                     PARM *BLANKS   @RTCD   7                       S01435
     C                     PARM '*KEY   ' @OPTN   7                       S01435
     C                     PARM           @CSNM  10                       S01435
     C                     PARM *BLANKS   @KYST   7                       S01435
     C           SDCUST    PARM *BLANKS   DSSDY                           S01435
      *                                                                   S01435
     C           *IN99     IFEQ '1'                        B002           S01435
     C           *LOCK     IN   DLDA                                      S01435
     C                     MOVEL'FT0205'  DBPGM                           S01435
     C                     MOVEL@CSNM     DBKEY            ***************S01435
     C                     MOVE 'SDCUSTPD'DBFILE           * DB ERROR 58 *S01435
     C                     MOVE '058'     DBASE            ***************S01435
     C                     OUT  DLDA                                      S01435
     C                     SETON                     U7U8LR               S01435
     C                     RETRN                                          S01435
     C                     END                             E002           S01435
     C*                                                                   S01435
     C                     MOVELODMT      P1ODMT                          S01435
     C                     MOVELBBCNA1    P1ODMC                          S01435
      *                                                                                       CFT032
     C           ODMTT     IFEQ 'F'                                                           CFT032
     C                     MOVELDST1      @CYCD                                               CFT032
     C                     MOVELDST1      WNONB   5                                           CFT032
     C                     MOVE WNONB     @NONB                                               CFT032
     C                     MOVE *BLANKS   @CUST                                               CFT032
     C                     MOVE *BLANKS   @ACCD                                               CFT032
     C                     MOVE *BLANKS   @ACSN                                               CFT032
     C                     MOVE *BLANKS   @BRCC                                               CFT032
     C                     EXSR NOSTRO                                                        CFT032
     C                     MOVEL@CSSN     @CSNM                                               CFT032
     C           *IN40     IFEQ '0'                                                           CFT032
     C                     EXSR ERROR                                                         CFT032
     C                     ENDIF                                                              CFT032
     C                     ENDIF                                                              CFT032
      *                                                                                       CFT032
     C           ODMTT     IFEQ 'I'                                                           CFT032
     C                     MOVE DST1      PIBAN  34                                           CFT032
     C                     CALL 'AOIBANR4'                                                    CFT032
     C                     PARM *BLANKS   PRTCD                                               CFT032
     C                     PARM '*KEY   ' POPTN                                               CFT032
     C                     PARM           PIBAN                                               CFT032
     C           WACCDS    PARM *BLANKS   DSSDY                                               CFT032
     C                     MOVELCNUM      @CSNM                                               CFT032
     C           PRTCD     IFNE *BLANKS                                                       CFT032
     C           *LOCK     IN   DLDA                                                          CFT032
     C                     MOVEL'FT0205'  DBPGM                                               CFT032
     C                     MOVEL'*CALL   'DBKEY                                               CFT032
     C                     MOVEL'ACCNTAB' DBFILE                                              CFT032
     C                     MOVE '061'     DBASE                                               CFT032
     C                     OUT  DLDA                                                          CFT032
     C                     SETON                     U7U8LR                                   CFT032
     C                     GOTO TAG03                                                         CFT032
     C                     ENDIF                                                              CFT032
     C                     ENDIF                                                              CFT032
      *                                                                                       CFT032
     C           ODMTT     IFEQ 'G'                                                           CFT032
     C                     CALL 'AOACNTV0'                                                    CFT032
     C                     PARM *BLANKS   PRTCD   7                                           CFT032
     C                     PARM           POPTN   7                                           CFT032
     C                     PARM           PACID  10                                           CFT032
     C                     PARM           PCUCD   3                                           CFT032
     C                     PARM           PACCD  10                                           CFT032
     C                     PARM           PACSQ   2                                           CFT032
     C                     PARM           PTYPE   7                                           CFT032
     C                     PARM           PNOSN   2                                           CFT032
     C           WACCDS    PARM *BLANKS   DSSDY                                               CFT032
     C                     MOVELCNUM      @CSNM                                               CFT032
     C           PRTCD     IFNE *BLANKS                                                       CFT032
     C           *LOCK     IN   DLDA                                                          CFT032
     C                     MOVEL'FT0205'  DBPGM                                               CFT032
     C                     MOVEL'*CALL   'DBKEY                                               CFT032
     C                     MOVEL'ACCNTAB' DBFILE                                              CFT032
     C                     MOVE '063'     DBASE                                               CFT032
     C                     OUT  DLDA                                                          CFT032
     C                     SETON                     U7U8LR                                   CFT032
     C                     GOTO TAG03                                                         CFT032
     C                     ENDIF                                                              CFT032
     C                     ENDIF                                                              CFT032
      *                                                                                       CFT032
     C           ODMTT     IFEQ 'S'                                                           CFT032
     C                     MOVELDST1      ADSLSH  1                                           CFT032
     C           ADSLSH    IFNE '/'                                                           CFT032
     C                     MOVELDST1      W9BICC                                              CFT032
     C           3         SUBSTDST1:9    W9BICB                                              CFT032
     C                     ELSE                                                               CFT032
     C                     MOVELDST2      W9BICC                                              CFT032
     C           3         SUBSTDST2:9    W9BICB                                              CFT032
     C                     ENDIF                                                              CFT032
      *                                                                                       CFT032
     C                     CALL 'ME1400'                                                      CFT032
     C                     PARM *BLANKS   W9RTN   7                                           CFT032
     C                     PARM           W9BICC  8                                           CFT032
     C                     PARM           W9BICB  3                                           CFT032
     C                     PARM           SDCUST                                              CFT032
     C                     PARM           SDCNST                                              CFT032
     C                     PARM           MEBICD                                              CFT032
     C                     PARM *BLANKS   W9CUST  1                                           CFT032
     C                     PARM *BLANKS   W9CNST  1                                           CFT032
     C                     PARM *BLANKS   W9BICD  1                                           CFT032
      *                                                                                       CFT032
      ** If customer number not found                                                         CFT032
      *                                                                                       CFT032
     C           W9CUST    IFNE 'Y'                                                           CFT032
     C                     MOVELBDINS1    P1ODMC                                              CFT032
     C                     MOVELODMT      P1ODMT                                              CFT032
     C                     ENDIF                                                              CFT032
     C                     ENDIF                                                              CFT032
      *                                                                                       CFT032
      ** Non Account Holder Reference                                                         CSW207
      *                                                                                       CSW207
     C           ODMTT     IFEQ 'O'                                                           CSW207
     C           CSW207    ANDEQ'Y'                                                           CSW207
     C                     CALL 'AONAHOR0'                                                    CSW207
     C                     PARM *BLANKS   @RTCD   7                                           CSW207
     C                     PARM '*KEY   ' @OPTN   7                                           CSW207
     C                     PARM ODMT      @NAHO  10                                           CSW207
     C           SDNAHO    PARM SDNAHO    DSSDY                                               CSW207
     C           @RTCD     IFNE *BLANKS                                                       CSW207
     C           *LOCK     IN   DLDA                                                          CSW207
     C                     MOVEL'FT0205'  DBPGM                                               CSW207
     C                     MOVELODMT      DBKEY                                               CSW207
     C                     MOVE 'SDNAHOPD'DBFILE                                              CSW207
     C                     MOVE '064'     DBASE                                               CSW207
     C                     OUT  DLDA                                                          CSW207
     C                     SETON                     U7U8LR                                   CSW207
     C                     RETRN                                                              CSW207
     C                     ELSE                                                               CSW207
     C                     MOVELODMT      P1ODMT                                              CSW207
     C                     MOVELNHCNA1    P1ODMC                                              CSW207
     C                     ENDIF                                                              CSW207
     C                     ENDIF                                                              CSW207
      *                                                                                       CSW207
     C           ODMTT     IFEQ 'C'                                                           CFT032
     C                     MOVELODMT      P1ODMT                                              CFT032
     C                     MOVELBBCNA1    P1ODMC                                              CFT032
     C                     ENDIF                                                              CFT032
      *                                                                                       CFT032
     C                     CALL 'AOCUSTR0'             9999                                   CFT032
     C                     PARM *BLANKS   @RTCD                                               CFT032
     C                     PARM '*KEY   ' @OPTN                                               CFT032
     C                     PARM           @CSNM                                               CFT032
     C                     PARM *BLANKS   @KYST                                               CFT032
     C           SDCUST    PARM *BLANKS   DSSDY                                               CFT032
      *                                                                                       CFT032
     C           *IN99     IFEQ '1'                                                           CFT032
     C           *LOCK     IN   DLDA                                                          CFT032
     C                     MOVEL'FT0205'  DBPGM                                               CFT032
     C                     MOVEL@CSNM     DBKEY                                               CFT032
     C                     MOVE 'SDCUSTPD'DBFILE                                              CFT032
     C                     MOVE '063'     DBASE                                               CFT032
     C                     OUT  DLDA                                                          CFT032
     C                     SETON                     U7U8LR                                   CFT032
     C                     RETRN                                                              CFT032
     C                     ENDIF                                                              CFT032
      *                                                                                       CFT032
     C                     END                             E001           S01435
     C*                                                                   S01435
      *                                                                   S01435
      * Format Entered Currency                                           S01435
      *                                                                   S01435
     C                     SELEC                                          S01435
      *                                                                   S01435
     C***********CDRO      WHNE *ZERO                                                  S01435 CSD027
     C           CDRO      WHNE *BLANKS                                                       CSD027
     C           BTCHCY    OREQ 'B'                                       073153
     C           CFT120    ANDNE'Y'                                                           CFT120
     C                     MOVELBCCY      WCCY                            S01435
     C                     Z-ADDWBCDP     WDEC                            S01435
     C           OPCDRC    IFNE *BLANKS                                                       CFT120
     C           CFT120    ANDEQ'Y'                                                           CFT120
     C                     MOVELOPCDRC    WCCY                                                CFT120
     C                     Z-ADDSVCCDP    WDEC                                                CFT120
     C                     ENDIF                                                              CFT120
      *                                                                                       CFT120
     C           BTCHCY    WHEQ 'B'                                                           CFT120
     C           CFT120    ANDEQ'Y'                                                           CFT120
     C                     MOVELBCCY      WCCY                                                CFT120
     C                     Z-ADDWBCDP     WDEC                                                CFT120
      *                                                                                       CFT120
     C/COPY WNCPYSRC,FT0205C012
      *                                                                   S01435
     C           BTCHCY    WHEQ 'L'                                       S01435
     C                     MOVELLOCY      WCCY                            S01435
     C                     Z-ADDWLCDP     WDEC                            S01435
      *                                                                   S01435
     C           BTCHCY    WHEQ 'C'                                       S01435
     C           ADDC      ANDEQ'A'                                       S01435
     C                     MOVELSMCY      WCCY                            S01435
     C                     Z-ADDSVSCDP    WDEC                            S01435
      *                                                                   S01435
     C                     OTHER                                          S01435
     C                     MOVELPCCY      WCCY                            S01435
     C                     Z-ADDSVPCDP    WDEC                            S01435
     C                     ENDSL                                          S01435
      ** If CFT009 is turned on, the output field should contain the      CFT009
      ** settlement currency. Otherwise it should contain the original    CFT009
      ** value.                                                           CFT009
      *                                                                   CFT009
     C           CFT009    IFEQ 'Y'                                       CFT009
     C           CFT120    ANDEQ'N'                                                           CFT120
      *                                                                   CFT009
     C                     MOVELSMCY      P1TREC                          CFT009
     C                     MOVELSMCY      P1TXEC                          CFT009
     C                     MOVELSMCY      P1CQEC                          CFT009
     C                     MOVELSMCY      P1CSEC                          CFT009
     C                     MOVELSMCY      P1SPEC                          CFT009
     C                     MOVELSMCY      P1MSEC                          CFT009
      *                                                                   CFT009
      ** Decimal places should also be from settlement ccy                CFT009
      *                                                                   CFT009
     C                     Z-ADDSVSCDP    WDEC                            CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
      *                                                                   CFT009
      *                                                                   S01435
     C                     MOVELWCCY      P1TREC                          S01435
     C                     MOVELWCCY      P1TXEC                          S01435
     C                     MOVELWCCY      P1CQEC                          S01435
     C                     MOVELWCCY      P1CSEC                          S01435
     C                     MOVELWCCY      P1SPEC                          S01435
     C                     MOVELWCCY      P1MSEC                          S01435
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** If CFT009 is turned on, also set up extra charges currencies,    CFT009
      ** and the other charge currency field.                             CFT009
      *                                                                   CFT009
     C           CFT009    IFEQ 'Y'                                       CFT009
      *                                                                   CFT009
     C                     MOVELSMCY      P2M1EC                          CFT009
     C                     MOVELSMCY      P2M2EC                          CFT009
     C                     MOVELSMCY      P2M3EC                          CFT009
     C                     MOVELSMCY      P2M4EC                          CFT009
     C                     MOVELSMCY      P2M5EC                          CFT009
     C                     MOVELSMCY      P2VTEC                          CFT009
     C                     MOVELSMCY      P2SWCY                          CFT009
      *                                                                   CFT009
      ** Set charges currency                                             CFT009
      *                                                                   CFT009
     C                     MOVELOPCHGC    P2TXCC                          CFT009
     C                     MOVELOPCHGC    P2TCCC                          CFT009
     C                     MOVELOPCHGC    P2CCCC                          CFT009
     C                     MOVELOPCHGC    P2SPCC                          CFT009
     C                     MOVELOPCHGC    P2CSCC                          CFT009
     C                     MOVELOPCHGC    P2MSCC                          CFT009
     C                     MOVELOPCHGC    P2M1CC                          CFT009
     C                     MOVELOPCHGC    P2M2CC                          CFT009
     C                     MOVELOPCHGC    P2M3CC                          CFT009
     C                     MOVELOPCHGC    P2M4CC                          CFT009
     C                     MOVELOPCHGC    P2M5CC                          CFT009
     C                     MOVELOPCHGC    P2CHCC                          CFT009
     C                     MOVELOPCHGC    P2VTCC                          CFT009
     C                     MOVELOPCHGC    P2SWSD                          CFT009
      *                                                                   CFT009
      ** Get decimals for charges currency                                CFT009
      *                                                                   CFT009
     C                     CALL 'AOCURRR0'                                CFT009
     C                     PARM *BLANKS   @RTCD                           CFT009
     C                     PARM '*KEY   ' @OPTN                           CFT009
     C                     PARM           OPCHGC                          CFT009
     C           SDCURR    PARM SDCURR    DSSDY                           CFT009
      *                                                                   CFT009
      ** Check for database error.                                        CFT009
      *                                                                   CFT009
     C           @RTCD     IFNE *BLANKS                                   CFT009
     C           *LOCK     IN   DLDA                                      CFT009
     C                     MOVEL'FT0205'  DBPGM                           CFT009
     C                     MOVE 'SDCURRPD'DBFILE           ************   CFT009
     C                     MOVELOPCHGC    DBKEY            * DBERR 60 *   CFT009
     C                     MOVE '060'     DBASE            ************   CFT009
     C                     OUT  DLDA                                      CFT009
     C                     SETON                     U7U8LR               CFT009
     C                     GOTO TAG03                                     CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Save decimal positions                                           CFT009
      *                                                                   CFT009
     C           *LIKE     DEFN A6NBDP    SVCHGD                          CFT009
     C                     Z-ADDA6NBDP    SVCHGD                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                                       CFT120
      ** If CFT120 is *On, set up extra charges currencies,                                   CFT120
      ** and other charge currency field with Charges to DR of CCY                            CFT120
      *                                                                                       CFT120
     C           CFT120    IFEQ 'Y'                                                           CFT120
     C                     MOVELWCCY      P2M1EC                                              CFT120
     C                     MOVELWCCY      P2M2EC                                              CFT120
     C                     MOVELWCCY      P2M3EC                                              CFT120
     C                     MOVELWCCY      P2M4EC                                              CFT120
     C                     MOVELWCCY      P2M5EC                                              CFT120
     C                     MOVELWCCY      P2VTEC                                              CFT120
     C                     MOVELWCCY      P2SWCY                                              CFT120
     C                     ENDIF                                                              CFT120
      *                                                                   CFT009
     C*                                                                   S01494
     C** F/X change commission                                            S01494
     C*                                                                   S01494
     C           *IN30     IFEQ '1'                                       S01494
     C                     MOVELWCCY      P1CHEC                          S01494
     C                     END                                            S01494
     C*                                                                   S01499
     C** V.A.T.                                                           S01499
     C*                                                                   S01499
     C           *IN31     IFEQ '1'                                       S01499
      *                                                                   CFT009
      ** If CFT009 is turned on, use settlement ccy in this field,        CFT009
      ** otherwise use original value.                                    CFT009
      *                                                                   CFT009
     C           CFT009    IFEQ 'Y'                                       CFT009
     C                     MOVELSMCY      P1CHEC                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVELWCCY      P1VTEC                          S01499
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     END                                            S01499
      *                                                                   S01435
      *  Format Entered Amounts                                           S01435
      *                                                                   S01435
     C           11        SUB  WDEC      WDIG                            S01435
      *                                                                   S01435
      ** Format Transfer Commission Amount                                S01435
      *                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN                           S01435
      *                                                                   CFT009
      * If CFT009 not on, use original calcs                              CFT009
      *                                                                   CFT009
     C           CFT009    IFNE 'Y'                                       CFT009
      *                                                                   CFT009
      ** Format Transfer Commission Amount                                CFT009
      *                                                                   CFT009
     C                     MOVEL*BLANKS   WFDIN                           CFT009
     C                     MOVE DUMA1     WFDIN                           S01435
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P1TREA                          S01435
      *                                                                   S01435
      ** Format Telex Charge Amount                                       S01435
      *                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN                           S01435
     C                     MOVE DUMA2     WFDIN                           S01435
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P1TXEA                          S01435
      *                                                                   S01435
      ** Format Cheque Charge Amount                                      S01435
      *                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN                           S01435
     C                     MOVE DUMA3     WFDIN                           S01435
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P1CQEA                          S01435
     C*                                                                   S01435
     C** Format Telephone Charge Amount                                   S01435
     C*                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN                           S01435
     C                     MOVE DUMA4     WFDIN                           S01435
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P1CSEA                          S01435
     C*                                                                   S01435
     C** Format Advice Charge Amount                                      S01435
     C*                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN                           S01435
     C                     MOVE DUMA5     WFDIN                           S01435
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P1SPEA                          S01435
     C*                                                                   S01435
     C** Format Miscellaneous Charge Amount                               S01435
     C*                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN                           S01435
     C                     MOVE DUMA6     WFDIN                           S01435
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P1MSEA                          S01435
     C*                                                                   S01494
     C**  Format change commission charge amount                          S01494
     C*                                                                   S01494
     C           *IN30     IFEQ '1'                                       S01494
     C                     MOVE *BLANKS   WFDIN                           S01494
     C                     MOVE OPDUM7    WFDIN                           S01494
     C                     EXSR UGFRMT                                    S01494
     C                     MOVE WFDOUT    P1CHCE                          S01494
     C                     END                                            S01494
     C*                                                                   S01499
     C** Format VAT amount                                                S01499
     C*                                                                   S01499
     C           *IN31     IFEQ '1'                                       S01499
     C                     MOVE *BLANKS   WFDIN                           S01499
     C                     MOVE OPDUM8    WFDIN                           S01499
     C                     EXSR UGFRMT                                    S01499
     C                     MOVE WFDOUT    P1VATE                          S01499
     C                     END                                            S01499
      *                                                                   CFT009
     C                     ELSE                                           CFT009
      *                                                                   CFT009
      ** If CFT009 is turned on, format amount in charges ccy             CFT009
      *                                                                   CFT009
      * Transfer Commission          P2TCCA                               CFT009
     C           *LIKE     DEFN DUMA1     WRKCHG                          CFT009
     C                     Z-ADDDUMA1     WRKCHG                          CFT009
     C                     MOVE WRKCHG    ZFIELD    P                     CFT009
     C                     Z-ADDSVCHGD    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P2TCCA    P                     CFT009
      *                                                                   CFT009
      * Telex Charge                 P2TXCA                               CFT009
     C                     Z-ADDDUMA2     WRKCHG                          CFT009
     C                     MOVE WRKCHG    ZFIELD    P                     CFT009
     C                     Z-ADDSVCHGD    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P2TXCA    P                     CFT009
      *                                                                   CFT009
      *                                                                   CFT009
      * Cheque Charge                P2CCCA                               CFT009
     C                     Z-ADDDUMA3     WRKCHG                          CFT009
     C                     MOVE WRKCHG    ZFIELD    P                     CFT009
     C                     Z-ADDSVCHGD    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P2CCCA    P                     CFT009
      *                                                                   CFT009
      * Costs Abroad                 P2CSCA                               CFT009
     C                     Z-ADDDUMA4     WRKCHG                          CFT009
     C                     MOVE WRKCHG    ZFIELD    P                     CFT009
     C                     Z-ADDSVCHGD    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P2CSCA    P                     CFT009
      *                                                                   CFT009
      * Swift Priority               P2SPCA                               CFT009
     C                     Z-ADDDUMA5     WRKCHG                          CFT009
     C                     MOVE WRKCHG    ZFIELD    P                     CFT009
     C                     Z-ADDSVCHGD    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P2SPCA    P                     CFT009
      *                                                                   CFT009
      * Miscellaneous Charge         P2MSCA                               CFT009
     C                     Z-ADDDUMA6     WRKCHG                          CFT009
     C                     MOVE WRKCHG    ZFIELD    P                     CFT009
     C                     Z-ADDSVCHGD    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P2MSCA    P                     CFT009
      *                                                                   CFT009
      * FX Change                    P2CHCA                               CFT009
     C                     Z-ADDOPDUM7    WRKCHG                          CFT009
     C                     MOVE WRKCHG    ZFIELD    P                     CFT009
     C                     Z-ADDSVCHGD    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P2CHCA    P                     CFT009
      *                                                                   CFT009
      * Miscellaneous Charge 1       P2M1CA                               CFT009
     C                     Z-ADDMISCC1    WRKCHG                          CFT009
     C                     MOVE WRKCHG    ZFIELD    P                     CFT009
     C                     Z-ADDSVCHGD    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P2M1CA    P                     CFT009
      *                                                                   CFT009
      * Miscellaneous Charge 2       P2M2CA                               CFT009
     C                     Z-ADDMISCC2    WRKCHG                          CFT009
     C                     MOVE WRKCHG    ZFIELD    P                     CFT009
     C                     Z-ADDSVCHGD    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P2M2CA    P                     CFT009
      *                                                                   CFT009
      * Miscellaneous Charge 3       P2M3CA                               CFT009
     C                     Z-ADDMISCC3    WRKCHG                          CFT009
     C                     MOVE WRKCHG    ZFIELD    P                     CFT009
     C                     Z-ADDSVCHGD    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P2M3CA    P                     CFT009
      *                                                                   CFT009
      * Miscellaneous Charge 4       P2M4CA                               CFT009
     C                     Z-ADDMISCC4    WRKCHG                          CFT009
     C                     MOVE WRKCHG    ZFIELD    P                     CFT009
     C                     Z-ADDSVCHGD    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P2M4CA    P                     CFT009
      *                                                                   CFT009
      * Miscellaneous Charge 5       P2M5CA                               CFT009
     C                     Z-ADDMISCC5    WRKCHG                          CFT009
     C                     MOVE WRKCHG    ZFIELD    P                     CFT009
     C                     Z-ADDSVCHGD    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P2M5CA    P                     CFT009
      *                                                                   CFT009
      * Swift Standard Charge        P2SWSB                               CFT009
     C                     Z-ADDSWSCCC    WRKCHG                          CFT009
     C                     MOVE WRKCHG    ZFIELD    P                     CFT009
     C                     Z-ADDSVCHGD    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P2SWSB    P                     CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   S01435
      * Edit charges to the debit of field                                S01435
      *                                                                   S01435
     C                     MOVE CDRT      PRMTYP  1        ( CDRO )       S01435
     C**********           MOVE *ZEROS    PRMFLD 12                                     S01435CGL029
     C**********           MOVE *ZEROS    PRMFLD 18                                    CGL029 CSD027
     C                     MOVE *BLANKS   PRMFLD 18                                           CSD027
     C                     MOVELCDRO      PRMFLD                          S01435
     C           MBIN      IFEQ 'Y'                                       S01435
     C           CDRT      IFEQ 'P'                                       S01435
     C                     MOVELCDBR      P1CDBR                          S01435
     C                     ELSE                                           S01435
     C                     MOVE *BLANKS   P1CDBR                          S01435
     C                     END                                            S01435
     C                     END                                            S01435
     C                     EXSR CHOPF                                     S01435
     C                     MOVELPRMFLD    P1CDRO                          S01435
      *                                                                                       CFT120
     C           CFT120    IFEQ 'Y'                                                           CFT120
     C           OPCDRC    IFNE *BLANKS                                                       CFT120
     C                     MOVELOPCDRC    P1CDRC                                              CFT120
     C                     ELSE                                                               CFT120
     C                     MOVE *BLANKS   P1CDRC                                              CFT120
     C                     ENDIF                                                              CFT120
     C                     ENDIF                                                              CFT120
      *                                                                                       CFT120
     C/COPY WNCPYSRC,FT0205C013
      *********                                                           S01435
      *                                                                   CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
      *                                                                   CFT014
     C                     MOVELOPBOCD    P1BOCD                          CFT014
     C                     MOVELOPTTCD    P1TTCD                          CFT014
     C                     MOVELOPICD1    P1ICD1                          CFT014
     C                     MOVELOPICD2    P1ICD2                          CFT014
     C                     MOVELOPICD3    P1ICD3                          CFT014
     C                     MOVELOPICD4    P1ICD4                          CFT014
     C                     MOVELOPICD5    P1ICD5                          CFT014
     C                     MOVELOPRRP1    P1RRP1                          CFT014
     C                     MOVELOPRRP2    P1RRP2                          CFT014
     C                     MOVELOPRRP3    P1RRP3                          CFT014
      *                                                                   CFT014
      ** Format Third Reimbursement.                                      CFT014
      *                                                                   CFT014
     C                     MOVE 'TRIT'    XCALL                           CFT014
     C                     MOVELOPTRIT    XTYPE                           CFT014
     C                     MOVELTRINDS    XNAMDS                          CFT014
     C                     EXSR GETADD                                    CFT014
     C                     MOVELXNAMDS    P1TRIB                          CFT014
      *                                                                   CFT014
      ** Format Receiver's Charges.                                       CFT014
      *                                                                   CFT014
     C           OPRCRM    IFEQ 0                                         CFT014
     C                     MOVE *BLANKS   P1RCRM                          CFT014
     C                     MOVE *BLANKS   P1RCRY                          CFT014
     C                     ELSE                                           CFT014
     C                     MOVELPCCY      P@CCY                           CFT014
     C                     EXSR SRCURR                                    CFT014
     C           *IN99     IFEQ *ON                                       CFT014
     C                     GOTO FINS05                                    CFT014
     C                     ENDIF                                          CFT014
     C                     Z-ADDA6NBDP    WDEC                            CFT014
     C           11        SUB  WDEC      WDIG                            CFT014
     C                     MOVEL*BLANKS   WFDIN                           CFT014
     C                     MOVE OPRCRM    WFDIN                           CFT014
     C                     EXSR UGFRMT                                    CFT014
     C                     MOVE WFDOUT    P1RCRM                          CFT014
     C                     MOVE PCCY      P1RCRY                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Format Sender's Charges.                                         CFT014
      *                                                                   CFT014
     C           OPSCC1    IFEQ *BLANK                                    CFT014
     C                     MOVE *BLANKS   P1SCH1                          CFT014
     C                     MOVE *BLANKS   P1SCY1                          CFT014
     C                     ELSE                                           CFT014
     C                     MOVELOPSCC1    P@CCY                           CFT014
     C                     EXSR SRCURR                                    CFT014
     C           *IN99     IFEQ *ON                                       CFT014
     C                     GOTO FINS05                                    CFT014
     C                     ENDIF                                          CFT014
     C                     Z-ADDA6NBDP    WDEC                            CFT014
     C           11        SUB  WDEC      WDIG                            CFT014
     C                     MOVEL*BLANKS   WFDIN                           CFT014
     C                     MOVE OPSCH1    WFDIN                           CFT014
     C                     EXSR UGFRMT                                    CFT014
     C                     MOVE WFDOUT    P1SCH1                          CFT014
     C                     MOVE OPSCC1    P1SCY1                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           OPSCC2    IFEQ *BLANK                                    CFT014
     C                     MOVE *BLANKS   P1SCH2                          CFT014
     C                     MOVE *BLANKS   P1SCY2                          CFT014
     C                     ELSE                                           CFT014
     C                     MOVELOPSCC2    P@CCY                           CFT014
     C                     EXSR SRCURR                                    CFT014
     C           *IN99     IFEQ *ON                                       CFT014
     C                     GOTO FINS05                                    CFT014
     C                     ENDIF                                          CFT014
     C                     Z-ADDA6NBDP    WDEC                            CFT014
     C           11        SUB  WDEC      WDIG                            CFT014
     C                     MOVEL*BLANKS   WFDIN                           CFT014
     C                     MOVE OPSCH2    WFDIN                           CFT014
     C                     EXSR UGFRMT                                    CFT014
     C                     MOVE WFDOUT    P1SCH2                          CFT014
     C                     MOVE OPSCC2    P1SCY2                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           OPSCC3    IFEQ *BLANK                                    CFT014
     C                     MOVE *BLANKS   P1SCH3                          CFT014
     C                     MOVE *BLANKS   P1SCY3                          CFT014
     C                     ELSE                                           CFT014
     C                     MOVELOPSCC3    P@CCY                           CFT014
     C                     EXSR SRCURR                                    CFT014
     C           *IN99     IFEQ *ON                                       CFT014
     C                     GOTO FINS05                                    CFT014
     C                     ENDIF                                          CFT014
     C                     Z-ADDA6NBDP    WDEC                            CFT014
     C           11        SUB  WDEC      WDIG                            CFT014
     C                     MOVEL*BLANKS   WFDIN                           CFT014
     C                     MOVE OPSCH3    WFDIN                           CFT014
     C                     EXSR UGFRMT                                    CFT014
     C                     MOVE WFDOUT    P1SCH3                          CFT014
     C                     MOVE OPSCC3    P1SCY3                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           OPSCC4    IFEQ *BLANK                                    CFT014
     C                     MOVE *BLANKS   P1SCH4                          CFT014
     C                     MOVE *BLANKS   P1SCY4                          CFT014
     C                     ELSE                                           CFT014
     C                     MOVELOPSCC4    P@CCY                           CFT014
     C                     EXSR SRCURR                                    CFT014
     C           *IN99     IFEQ *ON                                       CFT014
     C                     GOTO FINS05                                    CFT014
     C                     ENDIF                                          CFT014
     C                     Z-ADDA6NBDP    WDEC                            CFT014
     C           11        SUB  WDEC      WDIG                            CFT014
     C                     MOVEL*BLANKS   WFDIN                           CFT014
     C                     MOVE OPSCH4    WFDIN                           CFT014
     C                     EXSR UGFRMT                                    CFT014
     C                     MOVE WFDOUT    P1SCH4                          CFT014
     C                     MOVE OPSCC4    P1SCY4                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           OPSCC5    IFEQ *BLANK                                    CFT014
     C                     MOVE *BLANKS   P1SCH5                          CFT014
     C                     MOVE *BLANKS   P1SCY5                          CFT014
     C                     ELSE                                           CFT014
     C                     MOVELOPSCC5    P@CCY                           CFT014
     C                     EXSR SRCURR                                    CFT014
     C           *IN99     IFEQ *ON                                       CFT014
     C                     GOTO FINS05                                    CFT014
     C                     ENDIF                                          CFT014
     C                     Z-ADDA6NBDP    WDEC                            CFT014
     C           11        SUB  WDEC      WDIG                            CFT014
     C                     MOVEL*BLANKS   WFDIN                           CFT014
     C                     MOVE OPSCH5    WFDIN                           CFT014
     C                     EXSR UGFRMT                                    CFT014
     C                     MOVE WFDOUT    P1SCH5                          CFT014
     C                     MOVE OPSCC5    P1SCY5                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                                       CSW209
     C           CSW209    IFEQ 'Y'                                                           CSW209
     C                     MOVELOPNWRK    P1NWRK                                              CSW209
     C                     MOVELOPMTPY    P1MTPY                                              CSW209
     C                     MOVELOPVALF    P1VALF                                              CSW209
     C                     MOVELOPOCB1    P1OCB1                                              CSW209
     C                     MOVELOPOCB2    P1OCB2                                              CSW209
     C                     MOVELOPOCB3    P1OCB3                                              CSW209
     C                     MOVELOPOCB4    P1OCB4                                              CSW209
     C                     MOVELOPOCB5    P1OCB5                                              CSW209
     C                     MOVELOPOCB6    P1OCB6                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
     C*
     C** WRITE A DETAIL RECORD TO THE PRINTER FILE
      *                                                                   CFT009
      ** If CFT009 is turned off, print out as normal. Otherwise          CFT009
      ** print out the alternative formats, showing the new charges.      CFT009
      *                                                                   CFT009
     C           CFT009    IFNE 'Y'                                       CFT009
     C                     WRITEP1DETL
     C                     ELSE                                           CFT009
      *                                                                   CFT009
      ** Set up charge codes for the various fields                       CFT009
      *                                                                   CFT009
      ** Telex charge                                                     CFT009
      *                                                                   CFT009
     C                     MOVELTLXCDE    P2TXCD                          CFT009
      *                                                                   CFT009
      ** Transfer commission                                              CFT009
      *                                                                   CFT009
     C                     MOVELTFCCCD    P2TRCD                          CFT009
      *                                                                   CFT009
      ** Cheque charge                                                    CFT009
      *                                                                   CFT009
     C                     MOVELCHQCHC    P2CQCD                          CFT009
      *                                                                   CFT009
      ** Swift priority charge                                            CFT009
      *                                                                   CFT009
     C                     MOVELSPRCCD    P2SPCD                          CFT009
      *                                                                   CFT009
      ** Costs abroad charge code                                         CFT009
      *                                                                   CFT009
     C                     MOVELCACHCD    P2CSCD                          CFT009
      *                                                                   CFT009
      ** Misc charge code                                                 CFT009
      *                                                                   CFT009
     C                     MOVELMSCHC     P2MSCD                          CFT009
      *                                                                   CFT009
      ** Misc. charges 1 - 5                                              CFT009
      *                                                                   CFT009
     C                     MOVELMSCHC1    P2M1CD                          CFT009
     C                     MOVELMSCHC2    P2M2CD                          CFT009
     C                     MOVELMSCHC3    P2M3CD                          CFT009
     C                     MOVELMSCHC4    P2M4CD                          CFT009
     C                     MOVELMSCHC5    P2M5CD                          CFT009
      *                                                                   CFT009
      ** FX/Change comm if turned on                                      CFT009
      *                                                                   CFT009
     C           *IN30     IFEQ '1'                                       CFT009
     C                     MOVELFXCACC    P2CHCD                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVE *BLANKS   P2CHCD                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Swift standard charge                                            CFT009
      *                                                                   CFT009
     C                     MOVELSSTCCD    P2SWSC                          CFT009
      *                                                                   CFT009
      ** Calculate the total for the charge amounts                       CFT009
      *                                                                   CFT009
      ** Transfer commission                                              CFT009
     C                     Z-ADDTRCM      CHGTOT 150                      CFT009
      ** Telex charge                                                     CFT009
     C                     ADD  TXCH      CHGTOT                          CFT009
      ** Cheque charge total                                              CFT009
     C                     ADD  CQCH      CHGTOT                          CFT009
      ** Costs abroad total                                               CFT009
     C                     ADD  CSTA      CHGTOT                          CFT009
      ** Swift priority charge total                                      CFT009
     C                     ADD  SPCH      CHGTOT                          CFT009
      ** Miscellaneous charge total                                       CFT009
     C                     ADD  MSCH      CHGTOT                          CFT009
      ** FX/Change Commission total if S01494 is active                   CFT009
     C           *IN30     IFEQ '1'                                       CFT009
     C                     ADD  OPCHCM    CHGTOT                          CFT009
     C                     ENDIF                                          CFT009
      ** Misc charge one total                                            CFT009
     C                     ADD  MISC01    CHGTOT                          CFT009
      ** Misc charge two total                                            CFT009
     C                     ADD  MISC02    CHGTOT                          CFT009
      ** Misc charge three total                                          CFT009
     C                     ADD  MISC03    CHGTOT                          CFT009
      ** Misc charge four total                                           CFT009
     C                     ADD  MISC04    CHGTOT                          CFT009
      ** Misc charge five total                                           CFT009
     C                     ADD  MISC05    CHGTOT                          CFT009
      ** Swift standard charge total                                      CFT009
     C                     ADD  SWSCHG    CHGTOT                          CFT009
      *                                                                   CFT009
      *  ADD VAT TO TOTAL                                                 CFT009
     C                     ADD  OPDUM8    CHGTOT                          CFT009
      *                                                                   CFT009
      ** Format all running total amounts                                 CFT009
      *                                                                   CFT009
      ** Charges running total                                            CFT009
     C                     MOVE *BLANKS   WFDIN                           CFT009
     C                     MOVE CHGTOT    WFDIN                           CFT009
      *                                                                   CFT009
      ** Decimal places should also be from settlement ccy                CFT009
      *                                                                   CFT009
     C                     Z-ADDSVSCDP    WDEC                            CFT009
     C                     EXSR UGFRMT                                    CFT009
     C                     MOVE WFDOUT    P2TOTC                          CFT009
      *                                                                   CFT009
      ** V.A.T. running total, if V.A.T. feature turned on.               CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   WFDIN                           CFT009
     C                     MOVE OPDUM8    WFDIN                           CFT009
     C                     EXSR UGFRMT                                    CFT009
     C                     MOVE WFDOUT    P2VATC                          CFT009
      *                                                                   CFT009
      ** Decimal places should also be from settlement ccy                CFT009
     C                     Z-ADDSVSCDP    WDEC                            CFT009
     C                     EXSR UGFRMT                                    CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   WFDIN                           CFT009
     C                     MOVE OPVATT    WFDIN                           CFT009
     C                     EXSR UGFRMT                                    CFT009
     C                     MOVE WFDOUT    P2VATT                          CFT009
      *                                                                   CFT009
      ** Total charges running total, if V.A.T. feature turned on.        CFT009
      *                                                                   CFT009
     C                     WRITEP1DET2                                    CFT009
      *                                                                   CFT009
      ** Add one to page number, and write out new charges info.          CFT009
      *                                                                   CFT009
     C                     ADD  1         PPAGE                           CFT009
     C                     WRITEP1CHGS                                    CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C           CER031    IFEQ 'Y'                                                           CER030
      *                                                                                       CER030
     C                     MOVE OPEXT1    PEXT1                                               CER030
     C                     MOVE OPEXT2    PEXT2                                               CER030
     C                     MOVE OPEXT3    PEXT3                                               CER030
     C                     MOVE OPEXT4    PEXT4                                               CER030
     C                     MOVE OPEXT5    PEXT5                                               CER030
     C                     MOVE OPEXT6    PEXT6                                               CER030
      *                                                                                       CER030
     C           CFT003    IFEQ 'Y'                                                           CER030
     C                     MOVE OPEXC1    PEXC1                                               CER030
     C                     MOVE OPEXC2    PEXC2                                               CER030
     C                     MOVE OPEXC3    PEXC3                                               CER030
     C                     MOVE OPEXC4    PEXC4                                               CER030
     C                     MOVE OPEXC5    PEXC5                                               CER030
     C                     MOVE OPEXC6    PEXC6                                               CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     ADD  1         PPAGE                                               CER030
     C                     WRITEP2EXTNAR                                                      CER030
      *                                                                                       CER030
     C                     ENDIF                                                              CER030
     C*
     C                     MOVE '1'       *IN19                           S01117
     C*
     C** INCREASE PAGE NUMBER BY 1
     C*
     C                     ADD  1         PPAGE
     C*
     C           FINS05    ENDSR
     C*
     C********************************************************************
      /EJECT                                                              S01435
      *****************************************************************   S01435
      **                                                                  S01435
      **    Get name for Type.                                            S01435
      **                                                                  S01435
      **    CALLED FROM:  anywhere                                        S01435
      **    CALLS:                                                        S01435
      **                                                                  S01435
      **                                                                  S01435
     C           GETADD    BEGSR                                          S01435
      *                                                                   S01435
      *                                                                   S01435
      *  Set up general parameters                                        S01435
      *                                                                   S01435
     C           *LIKE     DEFN BCCY      XCCY                            S01435
      *                                                                   S01435
     C                     CLEARW8FT                                      S01435
     C                     MOVEL*BLANKS   W8STMT                          S01435
     C                     MOVELXCCY      W8CCY                           S01435
     C                     MOVEL##PGM     W8CPGM                          S01435
     C                     MOVEL'*PRINT'  W8ACT                           S01435
     C                     Z-ADD5         W8NLIN                          S01435
      *                                                                   S01435
      *  Set up parameters                                                S01435
      *                                                                   S01435
     C                     MOVELXTYPE     W8TYPE                          S01435
     C                     MOVEL*BLANKS   W8LINS                          S01435
     C                     MOVELXNAMDS    W8LINS                          S01435
      *                                                                   S01435
      * Call expansion program                                            S01435
      *                                                                   S01435
     C                     CALL 'FT0315'               8989               S01435
     C                     PARM           W8RTN   7                       S01435
     C                     PARM           W8FT                            S01435
     C                     PARM           W8LINS256                       S01435
     C                     PARM           W8RPT 256                       S01435
     C                     PARM           W8MSG 256                       S01435
     C                     PARM           W8SCR 256                       S01435
      *                                                                   S01435
      ** Check if database error occurred                                 S01435
      *                                                                   S01435
     C           *IN89     IFEQ '1'                                       S01435
     C           W8RTN     ORNE *BLANKS                                   S01435
     C           *LOCK     IN   DLDA                                      S01435
     C                     MOVEL'FT0205'  DBPGM                           S01435
     C                     MOVEL'*CALL'   DBKEY            ***************S01435
     C                     MOVE 'FT0315  'DBFILE           * DB ERROR 57 *S01435
     C                     MOVE '057'     DBASE            ***************S01435
     C                     OUT  DLDA                                      S01435
     C                     SETON                     U7U8LR               S01435
     C                     RETRN                                          S01435
     C                     END                                            S01435
      *                                                                   S01435
     C                     MOVELW8RPT     XNAMDS                          S01435
      *                                                                   S01435
     C                     ENDSR                                          S01435
     C/EJECT
     C********************************************************************
     C*
     C** PRTP2 SR.TO WRITE A RECORD TO FT0205P2 AT 'LR' TIME OR IF A
     C** DATABASE ERROR OCCURRED                             ~~
     C*
     C           PRTP2     BEGSR
     C*
     C           *INLR     IFEQ '1'
     C/COPY WNCPYSRC,FT0205C017
     C*
     C                     Z-ADD1         PPAGE                           S01117
     C*********************WRITEP2HEAD                                    S01117
     C                     WRITEAUHEAD                                    S01117
     C*
     C*********************WRITEP2CNTL                                    S01117
     C                     WRITEAUCNTL                                    S01117
     C*
     C           *INU7     IFEQ '1'
     C*
     C*********************MOVELDBASE     P2DBAS                          S01117
     C*********************MOVELDBFILE    P2DBFL                          S01117
     C*********************MOVELDBKEY     P2DBKY                          S01117
     C                     MOVELDBASE     AUDBAS                          S01117
     C                     MOVELDBFILE    AUDBFL                          S01117
     C                     MOVELDBKEY     AUDBKY                          S01117
     C*
     C*********************WRITEP2DBER                                    S01117
     C                     WRITEAUDBER                                    S01117
     C*
     C                     DUMP
     C*
     C                     ELSE
     C*
     C*********************WRITEP2EOR                                     S01117
     C                     WRITEAUEOR                                     S01117
     C           *IN19     IFEQ '1'                                       S01117
     C                     WRITEP1EOR                                     S01117
     C                     END                                            S01117
     C*
     C                     END
     C*
     C                     END
     C*
     C                     ENDSR
     C*
     C********************************************************************
     C/EJECT
     C********************************************************************
     C*
     C** SETUP SR. TO CALCULATE THE NEW PAY AMOUNT,RECEIVE AMOUNT,RATE AND
     C** MULT/DIV IND PRIOR TO WRITING A NEW RECORD TO 'OTPAYDD'
     C*
     C           SETUP     BEGSR
     C***********                                                         CEU006
     C***********                                                         CEU006
     C***ACCESS*CURRENCY*RECORD*1*FOR*:*CDP,SPOT*&*MDIN*FOR*SETTLE*CCY****CEU006
     C***********                                                         CEU006
     C***********          MOVEL*BLANKS   ZTABKY                          CEU006
     C***********          MOVEL'20'      ZTABKY                          CEU006
     C***********          MOVELWSMCY     KEY04                           CEU006
     C***********          MOVE '1'       KEY04                           CEU006
     C***********          MOVE KEY04     ZTABKY                          CEU006
     C***********ZTABKY    CHAINTABFP                99                   CEU006
     C**N99******RECI      COMP 'D'                  9999                 CEU006
     C***********                                                         CEU006
     C***CHECK*IF*DATABASE*ERROR*OCCURRED*********************************CEU006
     C***********                                                         CEU006
     C************IN99     IFEQ '1'                                       CEU006
     C************LOCK     IN   DLDA                                      CEU006
     C***********          MOVEL'FT0205'  DBPGM                           CEU006
     C***********          MOVEL'TABLE'   DBFILE           ***************CEU006
     C***********          MOVELZTABKY    DBKEY            * DB ERROR 11 *CEU006
     C*********************MOVEL'11'      DBASE            ***************S01194
     C***********          MOVEL'011'     DBASE                     S01194CEU006
     C***********          OUT  DLDA                                      CEU006
     C***********          SETON                     U7U8LR               CEU006
     C***********          GOTO FINS06                                    CEU006
     C***********          END                                            CEU006
     C***********                                                         CEU006
     C*****SAVE*THE*REQUIRED*FIELDS***************************************CEU006
     C***********                                                         CEU006
     C***********          Z-ADDCDP       WSCDP   10                      CEU006
     C***********          Z-ADDSPOT      WSSPOT 138                      CEU006
     C***********          MOVE MDIN      WSMDIN  10                      CEU006
     C***********                                                         CEU006
     C*****SET*UP*DIVISOR*FOR*SETTLE*AMOUNT*DEPENDING*ON*D.P.*FOR*SETTLE*CCEU006
     C***********                                                         CEU006
     C***********WSCDP     IFEQ *ZERO                                     CEU006
     C***********          Z-ADD1         WSDIV   40                      CEU006
     C***********          ELSE                                           CEU006
     C***********WSCDP     IFEQ 1                                         CEU006
     C***********          Z-ADD10        WSDIV                           CEU006
     C***********          ELSE                                           CEU006
     C***********WSCDP     IFEQ 2                                         CEU006
     C***********          Z-ADD100       WSDIV                           CEU006
     C***********          ELSE                                           CEU006
     C***********          Z-ADD1000      WSDIV                           CEU006
     C***********          END                                            CEU006
     C***********          END                                            CEU006
     C***********          END                                            CEU006
     C***********                                                         CEU006
     C***********                                                         CEU006
     C***ACCESS*CURRENCY*RECORD*2*FOR*:*BSPR*&*BSSG*FOR*SETTLE*CCY********CEU006
     C***********                                                         CEU006
     C***********          MOVEL*BLANKS   ZTABKY                          CEU006
     C***********          MOVEL'20'      ZTABKY                          CEU006
     C***********          MOVELWSMCY     KEY04                           CEU006
     C***********          MOVE '4'       KEY04                           CEU006
     C***********          MOVE KEY04     ZTABKY                          CEU006
     C*C*PY*WNCPY*RC*FT0205C018                                     CEU006S01408
     C***********ZTABKY    CHAINTABFP                99                   CEU006
     C**N99******RECI      COMP 'D'                  9999                 CEU006
     C*C*PY*WNCPY*RC*FT0205C019                                     CEU006S01408
     C***********                                                         CEU006
     C***CHECK*IF*DATABASE*ERROR*OCCURRED*********************************CEU006
     C***********                                                         CEU006
     C************IN99     IFEQ '1'                                       CEU006
     C************LOCK     IN   DLDA                                      CEU006
     C***********          MOVEL'FT0205'  DBPGM                           CEU006
     C***********          MOVEL'TABLE'   DBFILE           ***************CEU006
     C***********          MOVELZTABKY    DBKEY            * DB ERROR 12 *CEU006
     C*********************MOVEL'12'      DBASE            ***************S01194
     C***********          MOVEL'012'     DBASE                     S01194CEU006
     C***********          OUT  DLDA                                      CEU006
     C***********          SETON                     U7U8LR               CEU006
     C***********          GOTO FINS06                                    CEU006
     C***********          END                                            CEU006
     C**CHANGE*SPOT*RATE*BY*BUY*SPREAD************************************CEU006
     C***********BSSG      IFEQ '+'                        B001           CEU006
     C***********SPOT      ADD  BSPR      PBRAT  138                      CEU006
     C***********          ELSE                            X001           CEU006
     C***********SPOT      SUB  BSPR      PBRAT                           CEU006
     C***********          END                             E001           CEU006
     C**CHANGE*SPOT*RATE*BY*SELL*SPREAD***********************************CEU006
     C***********SSSG      IFEQ '+'                        B001           CEU006
     C***********SPOT      ADD  SSPR      PSRAT  138                      CEU006
     C***********          ELSE                            X001           CEU006
     C***********SPOT      SUB  SSPR      PSRAT                           CEU006
     C***********          END                             E001           CEU006
     C***********                                                         CEU006
     C***********                                                         CEU006
     C***ACCESS*CURRENCY*RECORD*1*FOR*:*CDP,SPOT*&*MDIN*FOR*PAY**CCY******CEU006
     C***********                                                         CEU006
     C***********          MOVEL*BLANKS   ZTABKY                          CEU006
     C***********          MOVEL'20'      ZTABKY                          CEU006
     C***********          MOVELWRCCY     KEY04                           CEU006
     C***********          MOVE '1'       KEY04                           CEU006
     C***********          MOVE KEY04     ZTABKY                          CEU006
     C***********ZTABKY    CHAINTABFP                99                   CEU006
     C**N99******RECI      COMP 'D'                  9999                 CEU006
     C***********                                                         CEU006
     C***CHECK*IF*DATABASE*ERROR*OCCURRED*********************************CEU006
     C***********                                                         CEU006
     C************IN99     IFEQ '1'                                       CEU006
     C************LOCK     IN   DLDA                                      CEU006
     C***********          MOVEL'FT0205'  DBPGM            ***************CEU006
     C***********          MOVEL'TABLE'   DBFILE           * DB ERROR 13 *CEU006
     C***********          MOVELZTABKY    DBKEY            ***************CEU006
     C*********************MOVEL'13'      DBASE                           S01194
     C***********          MOVEL'013'     DBASE                     S01194CEU006
     C***********          OUT  DLDA                                      CEU006
     C***********          SETON                     U7U8LR               CEU006
     C***********          GOTO FINS06                                    CEU006
     C***********          END                                            CEU006
     C***********                                                         CEU006
     C***SAVE*THE*REQUIRED*FIELDS*****************************************CEU006
     C***********                                                         CEU006
     C***********          Z-ADDCDP       WPCDP   10                      CEU006
     C***********          Z-ADDSPOT      WPSPOT 138                      CEU006
     C***********          MOVE MDIN      WPMDIN  10                      CEU006
     C***********                                                         CEU006
     C*****SET*UP*DIV*FOR*PAY*AMNT*DEPENDING*ON*D.P.*FOR*PAY*CCY**********CEU006
     C***********                                                         CEU006
     C***********WPCDP     IFEQ *ZERO                                     CEU006
     C***********          Z-ADD1         WPDIV   40                      CEU006
     C***********          ELSE                                           CEU006
     C***********WPCDP     IFEQ 1                                         CEU006
     C***********          Z-ADD10        WPDIV                           CEU006
     C***********          ELSE                                           CEU006
     C***********WPCDP     IFEQ 2                                         CEU006
     C***********          Z-ADD100       WPDIV                           CEU006
     C***********          ELSE                                           CEU006
     C***********          Z-ADD1000      WPDIV                           CEU006
     C***********          END                                            CEU006
     C***********          END                                            CEU006
     C***********          END                                            CEU006
     C***********                                                         CEU006
     C***********                                                         CEU006
     C***ACCESS*CURRENCY*RECORD*2*FOR*:*SSPR*&*SSSG*FOR*PAY*CCY***********CEU006
     C***********                                                         CEU006
     C***********          MOVEL*BLANKS   ZTABKY                          CEU006
     C***********          MOVEL'20'      ZTABKY                          CEU006
     C***********          MOVELWRCCY     KEY04                           CEU006
     C***********          MOVE '4'       KEY04                           CEU006
     C***********          MOVE KEY04     ZTABKY                          CEU006
     C*C*PY*WNCPY*RC*FT0205C021                                     CEU006S01408
     C***********ZTABKY    CHAINTABFP                99                   CEU006
     C**N99******RECI      COMP 'D'                  9999                 CEU006
     C*C*PY*WNCPY*RC*FT0205C020                                     CEU006S01408
     C***********                                                         CEU006
     C***CHECK*IF*DATABASE*ERROR*OCCURRED*********************************CEU006
     C***********                                                         CEU006
     C************IN99     IFEQ '1'                                       CEU006
     C************LOCK     IN   DLDA                                      CEU006
     C***********          MOVEL'FT0205'  DBPGM                           CEU006
     C***********          MOVEL'TABLE'   DBFILE           ***************CEU006
     C***********          MOVELZTABKY    DBKEY            * DB ERROR 14 *CEU006
     C*********************MOVEL'14'      DBASE            ***************S01194
     C***********          MOVEL'014'     DBASE                     S01194CEU006
     C***********          OUT  DLDA                                      CEU006
     C***********          SETON                     U7U8LR               CEU006
     C***********          GOTO FINS06                                    CEU006
     C***********          END                                            CEU006
     C**CHANGE*SPOT*RATE*BY*SELL*SPREAD***********************************CEU006
     C***********SSSG      IFEQ '+'                        B001           CEU006
     C***********SPOT      ADD  SSPR      RSRAT  138                      CEU006
     C***********          ELSE                            X001           CEU006
     C***********SPOT      SUB  SSPR      RSRAT                           CEU006
     C***********          END                             E001           CEU006
     C**CHANGE*SPOT RATE BY BUY SPREAD                                    CEU006
     C***********BSSG      IFEQ '+'                        B001           CEU006
     C***********SPOT      ADD  BSPR      RBRAT  138                      CEU006
     C***********          ELSE                            X001           CEU006
     C***********SPOT      SUB  BSPR      RBRAT                           CEU006
     C***********          END                             E001           CEU006
     C**SETUP*TO*AND*FROM*RATES*******************************************CEU006
     C***********FAIN      IFEQ 'R'                        B001           CEU006
     C***********          MOVE SMCY      TCCY    3                       CEU006
     C***********          MOVE PCCY      FCCY    3                       CEU006
     C***********          Z-ADDPBRAT     TSRAT  138                      CEU006
     C***********          Z-ADDWSMDIN    TMDIN   10                      CEU006
     C***********          Z-ADDWSCDP     TCDP    10                      CEU006
     C***********          Z-ADDRSRAT     FBRAT  138                      CEU006
     C***********          Z-ADDWPMDIN    FMDIN   10                      CEU006
     C***********          Z-ADDRSRAT     FSRAT  138                      CEU006
     C***********          Z-ADDWPCDP     FCDP    10                      CEU006
     C***********          ELSE                            X001           CEU006
     C***********          MOVE SMCY      FCCY                            CEU006
     C***********          MOVE PCCY      TCCY                            CEU006
     C***********          Z-ADDPBRAT     FBRAT  138                      CEU006
     C***********          Z-ADDWSMDIN    FMDIN                           CEU006
     C***********          Z-ADDWSCDP     FCDP    10                      CEU006
     C***********          Z-ADDPBRAT     FSRAT  138                      CEU006
     C***********          Z-ADDRSRAT     TSRAT  138                      CEU006
     C***********          Z-ADDWPMDIN    TMDIN                           CEU006
     C***********          Z-ADDWPCDP     TCDP    10                      CEU006
     C***********          END                             E001           CEU006
     C**IF*CURRENCIES*EQUAL*RATE*IS*1.0***********************************CEU006
     C***********FCCY      IFEQ TCCY                       B001           CEU006
     C***********          Z-ADD1         DRATE  138                      CEU006
     C***********          Z-ADD0         DMDIN   10                      CEU006
     C***********          ELSE                            X001           CEU006
     C**IF*FROM*CURRENCY*IS*BASE*RATE*IS*TO*CURRENCY**********************CEU006
     C***********FCCY      IFEQ BCCY                       B002           CEU006
     C***********          Z-ADDTSRAT     DRATE                           CEU006
     C********** 1 ********SUB  TMDIN     DMDIN                           050921
     C***********          Z-ADDTMDIN     DMDIN                     050921CEU006
     C***********          ELSE                            X002           CEU006
     C**IF*TO*CURRENCY*IS*BASE*RATE*IS*FROM*CURRENCY**********************CEU006
     C***********TCCY      IFEQ BCCY                       B003           CEU006
     C***********          Z-ADDFSRAT     DRATE                           CEU006
     C***********          Z-ADDFMDIN     DMDIN                           CEU006
     C***********          ELSE                            X003           CEU006
     C**IF*NEITHER*CURRENCY*IS*BASE***************************************CEU006
     C**IF*BOTH*DIVIDE*CURRENCIES*****************************************CEU006
     C***********FMDIN     IFEQ 0                          B004           CEU006
     C***********TMDIN     IFEQ 0                          B005           CEU006
     C**RATE*IS*TO*SELL*RATE*DIVIDE*BY*FROM*BUY*RATE**********************CEU006
     C***********TSRAT     DIV  FBRAT     DRATE     H                     CEU006
     C***********          Z-ADD1         DMDIN                           CEU006
     C***********DRATE     IFLT 1                          B006           CEU006
     C***********FBRAT     DIV  TSRAT     DRATE     H                     CEU006
     C***********          Z-ADD0         DMDIN                           CEU006
     C***********          END                             E006           CEU006
     C***********          ELSE                            X005           CEU006
     C***********FBRAT     MULT TSRAT     DRATE     H                     CEU006
     C***********          Z-ADD0         DMDIN                           CEU006
     C***********DRATE     IFLT 1                          B006           CEU006
     C***********1         DIV  DRATE     DRATE     H                     CEU006
     C***********          Z-ADD1         DMDIN                           CEU006
     C***********          END                             E006           CEU006
     C***********          END                             E005           CEU006
     C***********          ELSE                            X004           CEU006
     C***********TMDIN     IFEQ 0                          B005           CEU006
     C***********TSRAT     MULT FBRAT     DRATE     H                     CEU006
     C***********          Z-ADD1         DMDIN                           CEU006
     C***********DRATE     IFLT 1                          B006           CEU006
     C***********1         DIV  DRATE     DRATE     H                     CEU006
     C***********          Z-ADD0         DMDIN                           CEU006
     C***********          END                             E006           CEU006
     C***********          ELSE                            X005           CEU006
     C***********FBRAT     DIV  TSRAT     DRATE     H                     CEU006
     C***********          Z-ADD1         DMDIN                           CEU006
     C***********DRATE     IFLT 1                          B006           CEU006
     C***********TSRAT     DIV  FBRAT     DRATE     H                     CEU006
     C***********          Z-ADD0         DMDIN                           CEU006
     C***********          END                             E006           CEU006
     C***********          END                             E005           CEU006
     C***********          END                             E004           CEU006
     C***********FAIN      IFEQ 'R'                        B004           CEU006
     C***********1         SUB  DMDIN     DMDIN                           CEU006
     C***********          END                             E004           CEU006
     C***********          END                             E003           CEU006
     C***********          END                             E002           CEU006
     C***********          END                             E001           CEU006
     C* UNENTERED VALUE CALCULATION
     C*
     C/COPY WNCPYSRC,FT0205C001
     C**IF*ONE*CURRENCY*IS*BASE*******************************************CEU006
     C***********SMCY      IFEQ BCCY                       B001           CEU006
     C***********PCCY      OREQ BCCY                                      CEU006
     C***********FCDP      SUB  TCDP      N       10                      CEU006
     C***********          ADD  4         N                               CEU006
     C***********FAIN      IFEQ 'R'                        B002           CEU006
     C***********          Z-ADDPYAM      FAMNT  130                      CEU006
     C***********          ELSE                            X002           CEU006
     C***********          Z-ADDSMAM      FAMNT                           CEU006
     C***********          END                             E002           CEU006
     C***********TCCY      IFEQ BCCY                       B002           CEU006
     C***********DMDIN     IFEQ 0                          B003           CEU006
     C***********DRATE     MULT POWER,N   WK159     H                     CEU006
     C***********FAMNT     DIV  WK159     TAMNT  130H                     CEU006
     C***********          ELSE                            X003           CEU006
     C***********DRATE     DIV  POWER,N   WK159  159H                     CEU006
     C***********FAMNT     MULT WK159     TAMNT  130H                     CEU006
     C***********          END                             E003           CEU006
     C***********          ELSE                            X002           CEU006
     C***********DMDIN     IFEQ 1                          B003           CEU006
     C***********DRATE     MULT POWER,N   WK159     H                     CEU006
     C***********FAMNT     DIV  WK159     TAMNT  130H                     CEU006
     C***********          ELSE                            X003           CEU006
     C***********DRATE     DIV  POWER,N   WK159  159H                     CEU006
     C***********FAMNT     MULT WK159     TAMNT  130H                     CEU006
     C***********          END                             E003           CEU006
     C***********          END                             E002           CEU006
     C***********FAIN      IFEQ 'R'                        B002           CEU006
     C***********          Z-ADDTAMNT     SMAM                            CEU006
     C***********          ELSE                            X002           CEU006
     C***********          Z-ADDTAMNT     PYAM                            CEU006
     C***********          END                             E002           CEU006
     C***********          ELSE                            X001           CEU006
     C***********FAIN      IFEQ 'R'                        B002           CEU006
     C***********WPCDP     SUB  WSCDP     N       10                      CEU006
     C***********          ADD  4         N                               CEU006
     C***********DMDIN     IFEQ 0                          B003           CEU006
     C***********DRATE     DIV  POWER,N   WK159  159H                     CEU006
     C***********PYAM      MULT WK159     SMAM      H                     CEU006
     C***********          ELSE                            X003           CEU006
     C***********DRATE     MULT POWER,N   WK159     H                     CEU006
     C***********PYAM      DIV  WK159     SMAM      H                     CEU006
     C***********          END                             E003           CEU006
     C***********          ELSE                            X002           CEU006
     C***********WSCDP     SUB  WPCDP     N       10                      CEU006
     C***********          ADD  4         N                               CEU006
     C***********DMDIN     IFEQ 1                          B003           CEU006
     C***********DRATE     DIV  POWER,N   WK159  159H                     CEU006
     C***********SMAM      MULT WK159     PYAM      H                     CEU006
     C***********          ELSE                            X003           CEU006
     C***********DRATE     MULT POWER,N   WK159     H                     CEU006
     C***********SMAM      DIV  WK159     PYAM      H                     CEU006
     C***********          END                             E003           CEU006
     C***********          END                             E002           CEU006
     C***********          END                             E001           CEU006
      ***********                                                         CEU006
      * CEU006 : Calculate new pay / settle amounts using new             CEU006
      * routine FT0010.  This replaces the previous method of             CEU006
      * calculating amounts.                                              CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVELSMCY      P#DBCY                          CEU006
     C                     MOVELPCCY      P#CRCY                          CEU006
     C                     Z-ADDSLDT      P#DBDT                          CEU006
     C                     Z-ADDPVDT      P#CRDT                          CEU006
     C                     MOVEL'Y'       P#SDIN                          CEU006
      *                                                                   CEU006
     C           FAIN      IFEQ 'P'                                       CEU006
     C                     Z-ADDSMAM      P#DBAM                          CEU006
     C                     ELSE                                           CEU006
     C                     Z-ADDPYAM      P#CRAM                          CEU006
     C                     ENDIF                                          CEU006
      *                                                                   CEU006
     C                     EXSR SRFT10                                    CEU006
      *                                                                   CEU006
     C           FAIN      IFEQ 'P'                                       CEU006
     C                     Z-ADDP#CRAM    PYAM                            CEU006
     C                     ELSE                                           CEU006
     C                     Z-ADDP#DBAM    SMAM                            CEU006
     C                     ENDIF                                          CEU006
      *                                                                   CEU006
     C/COPY WNCPYSRC,FT0205C002
     C***********          Z-ADDDRATE     RATE                            CEU006
     C***********          MOVE DMDIN     MDIN                            CEU006
      *                                                                   CFT009
      ** If CFT009 is off, or spread set code use is blanks, use          CFT009
      ** original processing.                                             CFT009
      *                                                                   CFT009
     C           CFT009    IFNE 'Y'                                       CFT009
     C           FXSRSC    OREQ *BLANKS                                   CFT009
     C                     Z-ADDP#RATE    RATE                            CEU006
     C                     Z-ADDP#MDIN    MDIN                            CEU006
     C                     ELSE                                           CFT009
      *                                                                   CFT009
      ** This bit messes up RATE. Instead, use ZXRATE routine             CFT009
      ** if CFT009 is turned on, as per FT000982.                         CFT009
      *                                                                   CFT009
     C                     CALL 'FT000982'                                CFT009
      ** Return Code (10A)                                                CFT009
     C                     PARM *BLANKS   RETCDE 10                       CFT009
      ** FX Spread Code (5A)                                              CFT009
     C                     PARM FXSRSC    SPDCDX  5                       CFT009
      ** Payment Currency (3A)                                            CFT009
     C                     PARM PCCY      PAYCCY  3                       CFT009
      ** Settlement Currency (3A)                                         CFT009
     C                     PARM SMCY      SETCCY  3                       CFT009
      ** Calculated Exchange Rate (Returned)                              CFT009
     C                     PARM *ZEROS    EXRATE 138                      CFT009
      ** Manual or STP 1A                                                 CFT009
     C                     PARM 'M'       PSTP    1                       CFT009
      *                                                                   CFT009
      ** If *NOCALC returned, use existing value.                         CFT009
      *                                                                   CFT009
     C           RETCDE    IFNE '*NOCALC'                                 CFT009
     C                     Z-ADDEXRATE    RATE                            CFT009
     C                     ENDIF                                          CFT009
     C                     Z-ADDP#MDIN    MDIN                            CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                                    AR1036310
     C           PDCY      IFEQ SMCY                                                       AR1036310
     C                     Z-ADDRATE      WORGRT 138                                       AR1036310
     C                     ELSE                                                            AR1036310
     C           PDCY      IFEQ PCCY                                                       AR1036310
     C                     Z-ADD1         WORGRT                                           AR1036310
     C                     ENDIF                                                           AR1036310
     C                     ENDIF                                                           AR1036310
     C*
     C** THE CHARGES NOW NEED TO BE RECALCLATED IN CASE THE RATE HAS
     C** CHANGED SINCE THE REGULAR PAYMENT WAS SET UP. IF THE RATE HAS
     C** NOT CHANGED, THE ROUTINE STILL NEEDS TO BE CARRIED OUT, SINCE
     C** THE CHARGES NEED TO BE CONVERTED TO THE 'DUMMY' AMOUNTS ON
     C** FILE (DUMA1,ETC) WHICH WILL BE DISPLAYED ON AMEND/ENQUIRE/AUTH
     C*
     C/COPY WNCPYSRC,FT0205C015
     C                     EXSR CHGCAL
     C/COPY WNCPYSRC,FT0205C016
     C*
     C* Remove following processing as charge amounts calculated via      CEU006
     C* new FT0010 routine                                                CEU006
     C**CALCULATE*BASE*CCY*EQUIVALENT*************************************CEU006
     C***********WSCDP     SUB  WBCDP     N       10                      CEU006
     C***********          ADD  4         N                               CEU006
     C***********WSMDIN    IFEQ 0                                         CEU006
     C***********WSSPOT    MULT POWER,N   WK159     H                     CEU006
     C***********SMAM      DIV  WK159     SBCQ      H                     CEU006
     C***********          ELSE                                           CEU006
     C***********WSSPOT    DIV  POWER,N   WK159     H                     CEU006
     C***********SMAM      MULT WK159     SBCQ      H                     CEU006
     C***********          END                                            CEU006
     C***********                                                         CEU006
     C**CALCULATE*BASE*CCY*EQUIVALENT*************************************CEU006
     C***********WPCDP     SUB  WBCDP     N       10                      CEU006
     C***********          ADD  4         N                               CEU006
     C***********WPMDIN    IFEQ 0                                         CEU006
     C***********WPSPOT    MULT POWER,N   WK159     H                     CEU006
     C***********PYAM      DIV  WK159     PBCQ      H                     CEU006
     C***********          ELSE                                           CEU006
     C***********WPSPOT    DIV  POWER,N   WK159     H                     CEU006
     C***********PYAM      MULT WK159     PBCQ      H                     CEU006
     C***********          END                                            CEU006
     C**THIS*IS*TO*MAKE*BASE*CCY*EQUIVALENT*EQUAL*************************CEU006
     C***********PCCY      IFEQ BCCY                                      CEU006
     C***********          Z-ADDPBCQ      SBCQ                            CEU006
     C***********          ELSE                                           CEU006
     C***********          Z-ADDSBCQ      PBCQ                            CEU006
     C***********          END                                            CEU006
     C           FINS06    ENDSR
     C*
     C********************************************************************
     C/EJECT
     C********************************************************************
     C*
     C*  CHGCAL - S.R. TO RECALCULATE THE CHARGES IF THE ORIGINAL
     C*           RATE HAS CHANGED.
     C*
     C********************************************************************
     C*
     C           CHGCAL    BEGSR
     C*
     C** CONVERT THE CHARGE AMOUNTS TO THE 'LEFT-HAND' AMOUNTS, WHICH
     C** ARE IN FACT THE AMOUNTS THAT WERE INPUT IN THE FIRST PLACE.
     C** THE FOLLOWING PROCESSING IS UNASHAMEDLY PLAGIARISED FROM
     C** THE TRANSACTION INPUT PROGRAM DEALING WITH CHARGES (FT0045).
     C*
     C* CHARGE AMOUNTS ARE NOW CONVERTED FROM FILE ('DUMMY' AMOUNTS)
     C* TO CHARGE FIELDS (ALSO ON FILE) WHICH WILL BE THE RIGHT-HAND
     C* VALUES OUTPUT ON THE SCREEN. THE CCY IS BASE/LOCAL/CHARGE,
     C* DEPENDING ON THE FTCC INDICATOR.
     C*
     C* IF CHARGES TO THE DEBIT OF IS NOT 0 FROM FILE,USE BASE CURRENCY
     C*
     C***********CDRO      IFNE *ZEROS                     ** B001                            CSD027
     C           CDRO      IFNE *BLANKS                    ** B001                            CSD027
     C                     MOVE BCCY      SCCCY   3
     C           OPCDRC    IFNE *BLANKS                                                       CFT120
     C           CFT120    ANDEQ'Y'                                                           CFT120
     C                     MOVE OPCDRC    SCCCY   3                                           CFT120
     C                     ENDIF                                                              CFT120
      *                                                                                       CFT120
     C/COPY WNCPYSRC,FT0205C014
     C*
     C                     ELSE                            ** X001
     C*
     C* IF CHARGES TO THE DEBIT OF IS 0 FROM FILE,USE PAY OR SETTLE
     C* FROM ADD/DEDUCT INDICATOR
     C*
     C           ADDC      IFEQ 'A'                        ** B002
     C                     MOVE SMCY      SCCCY
     C                     ELSE                            ** X002
     C                     MOVE PCCY      SCCCY
     C                     END                             ** E002
     C*
     C                     END                             ** E001
     C*
     C* ACCESS DETAILS OF FILE CHARGE CCY FOR CHARGE CALCULATIONS
     C*
     C                     MOVEL'20      'ZTABKY
     C                     MOVE '1'       KEY04
     C                     MOVELSCCCY     KEY04
     C                     MOVE KEY04     ZTABKY
     C           ZTABKY    CHAINTABTG10F             99
     C*
     C** CHECK IF DATABASE ERROR OCCURRED
     C*
     C           *IN99     IFEQ '1'                        ** B001
     C           *LOCK     IN   DLDA
     C*********************MOVEL'FT0200'  DBPGM                           S01194
     C                     MOVEL'FT0205'  DBPGM                           S01194
     C                     MOVEL'TABTG10' DBFILE           ***************
     C                     MOVELZTABKY    DBKEY            * DB ERROR 16 *
     C*********************MOVEL'16'      DBASE            ***************S01194
     C                     MOVEL'016'     DBASE                           S01194
     C                     OUT  DLDA
     C                     SETON                     U7U8LR
     C                     GOTO FINS07
     C                     END                             **E001
     C                     Z-ADDCDP       CCDP    10
     C                     Z-ADDMDIN      CMDIN   10
     C                     Z-ADDSPOT      CSPOT  138
     C*
     C                     Z-ADDCCDP      ZDECS
     C                     MOVE ' '       ZECODE
     C*
     C* IF FTCC IS SET TO 'C' FOR CHARGE CURRENCY
     C*
     C           FTCC      IFEQ 'C'                        ** B001
     C*
     C* OR,IF FTCC IS SET TO 'B' FOR BASE CURRENCY,AND FILE
     C* CHARGE CCY IS BASE
     C*
     C           FTCC      OREQ 'B'
     C           SCCCY     ANDEQBCCY
     C*
     C* OR,IF FTCC IS SET TO 'L' FOR LOCAL CURRENCY,AND LOCAL IS THE
     C* SAME CCY AS BASE,AND FILE CCY IS BASE
     C*
     C           FTCC      OREQ 'L'
     C           BCCY      ANDEQLOCY
     C           SCCCY     ANDEQBCCY
     C*
     C* OR,IF FTCC IS SET TO 'L' FOR LOCAL CURRENCY,AND CHARGE CURRENCY
     C* IS THE SAME AS LOCAL CCY
     C*
     C           FTCC      OREQ 'L'
     C           SCCCY     ANDEQLOCY
     C*
     C* TRANSFER COMMISSION
     C                     Z-ADDTRCM      DUMA1
     C* TELEX CHARGE
     C                     Z-ADDTXCH      DUMA2
     C* CHEQUE CHARGE
     C                     Z-ADDCQCH      DUMA3
     C* COSTS ABROAD
     C                     Z-ADDCSTA      DUMA4
     C* SWIFT PRIORITY CHARGE
     C                     Z-ADDSPCH      DUMA5
     C* MISCELLANEOUS CHARGE
     C                     Z-ADDMSCH      DUMA6
     C*                                                                   S01494
     C** For change commission                                            S01494
     C*                                                                   S01494
     C           *IN30     IFEQ '1'                                       S01494
     C                     Z-ADDOPCHCM    OPDUM7                          S01494
     C                     END                                            S01494
      *                                                                   CFT009
      ** If CFT010 is turned off (VAT on new charges) do original         CFT009
      ** processing.                                                      CFT009
      *                                                                   CFT009
     C           CFT010    IFNE 'Y'                                       CFT009
     C*                                                                   S01499
     C** If VAT applicable                                                S01499
     C*                                                                   S01499
     C           *IN31     IFEQ '1'                                       S01499
     C*                                                                   S01499
     C                     Z-ADD0         OPVATT                          S01499
     C*                                                                   S01499
     C           OPVAT1    IFEQ 'Y'                                       S01499
     C***********TXCH      MULT XTVA      VAT    110H              S01499 S01499
     C           TXCH      MULT O#VATR    VAT    110H                     S01499
     C                     ADD  VAT       OPVATT                          S01499
     C                     END                                            S01499
     C*                                                                   S01499
     C           OPVAT2    IFEQ 'Y'                                       S01499
     C***********CQCH      MULT XTVA      VAT    110H              S01499 S01499
     C           CQCH      MULT O#VATR    VAT    110H                     S01499
     C                     ADD  VAT       OPVATT                          S01499
     C                     END                                            S01499
     C*                                                                   S01499
     C           OPVAT3    IFEQ 'Y'                                       S01499
     C***********CSTA      MULT XTVA      VAT    110H              S01499 S01499
     C           CSTA      MULT O#VATR    VAT    110H                     S01499
     C                     ADD  VAT       OPVATT                          S01499
     C                     END                                            S01499
     C*                                                                   S01499
     C           OPVAT4    IFEQ 'Y'                                       S01499
     C***********SPCH      MULT XTVA      VAT    110H              S01499 S01499
     C           SPCH      MULT O#VATR    VAT    110H                     S01499
     C                     ADD  VAT       OPVATT                          S01499
     C                     END                                            S01499
     C*                                                                   S01499
     C           OPVAT5    IFEQ 'Y'                                       S01499
     C***********MSCH      MULT XTVA      VAT    110H              S01499 S01499
     C           MSCH      MULT O#VATR    VAT    110H                     S01499
     C                     ADD  VAT       OPVATT                          S01499
     C                     END                                            S01499
     C*                                                                   S01499
     C           OPVAT6    IFEQ 'Y'                                       S01499
     C***********TRCM      MULT XTVA      VAT    110H              S01499 S01499
     C           TRCM      MULT O#VATR    VAT    110H                     S01499
     C                     ADD  VAT       OPVATT                          S01499
     C                     END                                            S01499
     C*                                                                   S01499
     C           OPVAT7    IFEQ 'Y'                                       S01499
     C***********OPCHCM    MULT XTVA      VAT    110H              S01499 S01499
     C           OPCHCM    MULT O#VATR    VAT    110H                     S01499
     C                     ADD  VAT       OPVATT                          S01499
     C                     END                                            S01499
     C*                                                                   S01499
     C                     Z-ADDOPVATT    OPDUM8                          S01499
     C                     END                                            S01499
     C*                                                                   S01499
     C* CURRENCY
     C                     MOVE SCCCY     SECCY   3
     C*
     C* IF NONE ABOVE APPLY THEN FILE CCY WILL NEED TO BE CONVERTED
     C*
     C                     ELSE                            ** X001
     C*
     C*
     C* FOR EITHER FTCC EQUAL TO BASE OR LOCAL(B OR L)CHARGE CURRENCY
     C* WILL NEED TO BE CONVERTED TO CHARGE CCY
     C* N IS DIFFERENCE BETWEEN DECIMALS FOR BASE AND DECIMALS FOR FILE
     C* CURRENCY - FOLLOWING CALCS FIND TRUE RATE(RSPOT)TO CONVERT BASE
     C* CCY TO BASE
     C*
     C***********WBCDP     SUB  CCDP      N       10                      CEU006
     C***********CMDIN     IFEQ 1                          ** B002        CEU006
     C***********N         IFGT 0                          ** B003        CEU006
     C***********CSPOT     MULT POWER,N   RSPOT  159                      CEU006
     C***********          ELSE                            ** X003        CEU006
     C***********N         IFLT 0                          ** B004        CEU006
     C***********          Z-SUBN         N                               CEU006
     C***********CSPOT     DIV  POWER,N   RSPOT                           CEU006
     C***********          ELSE                            ** X004        CEU006
     C***********          Z-ADDCSPOT     RSPOT                           CEU006
     C***********          END                             ** E004        CEU006
     C***********          END                             ** E003        CEU006
     C***********          END                             ** E002        CEU006
     C***********CMDIN     IFEQ 0                          ** B002        CEU006
     C***********N         IFGT 0                          ** B003        CEU006
     C***********CSPOT     DIV  POWER,N   RSPOT                           CEU006
     C***********          ELSE                            ** X003        CEU006
     C***********N         IFLT 0                          ** B004        CEU006
     C***********          Z-SUBN         N                               CEU006
     C***********CSPOT     MULT POWER,N   RSPOT                           CEU006
     C***********          ELSE                            ** X004        CEU006
     C***********          Z-ADDCSPOT     RSPOT                           CEU006
     C***********          END                             ** E004        CEU006
     C***********          END                             ** E003        CEU006
     C***********          END                             ** E002        CEU006
     C*                                                                   S01499
     C** If VAT applicable                                                S01499
     C*                                                                   S01499
     C           *IN31     IFEQ '1'                                       S01499
     C*                                                                   S01499
     C                     Z-ADD0         OPVATT                          S01499
     C*                                                                   S01499
     C           OPVAT1    IFEQ 'Y'                                       S01499
     C***********DUMA2     MULT XTVA      VAT    110H              S01499 S01499
     C           DUMA2     MULT O#VATR    VAT    110H                     S01499
     C                     ADD  VAT       OPVATT                          S01499
     C                     END                                            S01499
     C*                                                                   S01499
     C           OPVAT2    IFEQ 'Y'                                       S01499
     C***********DUMA3     MULT XTVA      VAT    110H              S01499 S01499
     C           DUMA3     MULT O#VATR    VAT    110H                     S01499
     C                     ADD  VAT       OPVATT                          S01499
     C                     END                                            S01499
     C*                                                                   S01499
     C           OPVAT3    IFEQ 'Y'                                       S01499
     C***********DUMA4     MULT XTVA      VAT    110H              S01499 S01499
     C           DUMA4     MULT O#VATR    VAT    110H                     S01499
     C                     ADD  VAT       OPVATT                          S01499
     C                     END                                            S01499
     C*                                                                   S01499
     C           OPVAT4    IFEQ 'Y'                                       S01499
     C***********DUMA5     MULT XTVA      VAT    110H              S01499 S01499
     C           DUMA5     MULT O#VATR    VAT    110H                     S01499
     C                     ADD  VAT       OPVATT                          S01499
     C                     END                                            S01499
     C*                                                                   S01499
     C           OPVAT5    IFEQ 'Y'                                       S01499
     C***********DUMA6     MULT XTVA      VAT    110H              S01499 S01499
     C           DUMA6     MULT O#VATR    VAT    110H                     S01499
     C                     ADD  VAT       OPVATT                          S01499
     C                     END                                            S01499
     C*                                                                   S01499
     C           OPVAT6    IFEQ 'Y'                                       S01499
     C***********DUMA1     MULT XTVA      VAT    110H              S01499 S01499
     C           DUMA1     MULT O#VATR    VAT    110H                     S01499
     C                     ADD  VAT       OPVATT                          S01499
     C                     END                                            S01499
     C*                                                                   S01499
     C           OPVAT7    IFEQ 'Y'                                       S01499
     C***********OPDUM7    MULT XTVA      VAT    110H              S01499 S01499
     C           OPDUM7    MULT O#VATR    VAT    110H                     S01499
     C                     ADD  VAT       OPVATT                          S01499
     C                     END                                            S01499
     C*                                                                   S01499
     C                     Z-ADDOPVATT    OPDUM8                          S01499
     C                     END                                            S01499
     C*
     C**NOW*USE*RATE*TO*CALCULATE*VALUE*FOR*AMENDMENT*IN*CHARGE*CCY*******CEU006
     C***********                                                         CEU006
     C***********CMDIN     IFEQ 0                          ** B002        CEU006
     C**TRANSFER*COMMISSION                                               CEU006
     C***********DUMA1     MULT RSPOT     TRCMF  110H                     CEU006
     C**TELEX*CHARGE                                                      CEU006
     C***********DUMA2     MULT RSPOT     TXCHF  110H                     CEU006
     C**CHEQUE*CHARGE                                                     CEU006
     C***********DUMA3     MULT RSPOT     CQCHF  110H                     CEU006
     C**COSTS*ABROAD                                                      CEU006
     C***********DUMA4     MULT RSPOT     CSTAF  110H                     CEU006
     C**SWIFT*PRIORITY CHARGE                                             CEU006
     C***********DUMA5     MULT RSPOT     SPCHF  110H                     CEU006
     C**MISCELLANEOUS CHARGE                                              CEU006
     C***********DUMA6     MULT RSPOT     MSCHF  110H                     CEU006
     C***********                                                   S01494CEU006
     C***Change*commission                                          S01494CEU006
     C***********                                                   S01494CEU006
     C************IN30     IFEQ '1'                                 S01494CEU006
     C***********OPDUM7    MULT RSPOT     CHCMF  110H               S01494CEU006
     C***********          END                                      S01494CEU006
     C***********                                                   S01499CEU006
     C***VAT*****                                                   S01499CEU006
     C***********                                                   S01499CEU006
     C************IN31     IFEQ '1'                                 S01499CEU006
     C***********OPDUM8    MULT RSPOT     VATTF  110H               S01499CEU006
     C***********          END                                      S01499CEU006
     C***********                                                   S04199CEU006
     C***********          END                             ** E002        CEU006
     C***********                                                         CEU006
     C***********CMDIN     IFEQ 1                          ** B002        CEU006
     C**TRANSFER*COMMISSION                                               CEU006
     C***********DUMA1     DIV  RSPOT     TRCMF  110H                     CEU006
     C**TELEX*CHARGE                                                      CEU006
     C***********DUMA2     DIV  RSPOT     TXCHF  110H                     CEU006
     C**CHEQUE*CHARGE                                                     CEU006
     C***********DUMA3     DIV  RSPOT     CQCHF  110H                     CEU006
     C**COSTS*ABROAD                                                      CEU006
     C***********DUMA4     DIV  RSPOT     CSTAF  110H                     CEU006
     C**SWIFT*PRIORITY CHARGE                                             CEU006
     C***********DUMA5     DIV  RSPOT     SPCHF  110H                     CEU006
     C**MISCELLANEOUS CHARGE                                              CEU006
     C***********DUMA6     DIV  RSPOT     MSCHF  110H                     CEU006
     C***********                                                   S01494CEU006
     C***Change*commission                                          S01494CEU006
     C***********                                                   S01494CEU006
     C************IN30     IFEQ '1'                                 S01494CEU006
     C***********OPDUM7    DIV  RSPOT     CHCMF  110H               S01494CEU006
     C***********          END                                      S01494CEU006
     C***********                                                   S01494CEU006
     C***VAT*****                                                   S01494CEU006
     C***********                                                   S01494CEU006
     C************IN31     IFEQ '1'                                 S01499CEU006
     C***********OPDUM8    DIV  RSPOT     VATTF  110H               S01499CEU006
     C***********          END                                      S01499CEU006
     C***********                                                   S01494CEU006
     C***********          END                             ** E002        CEU006
     C***********                                                         CEU006
     C**IF*FTCC*IS BASE,AND FILE CCY IS NOT BASE                          CEU006
     C***********                                                         CEU006
     C***********FTCC      IFEQ 'B'                        ** B002        CEU006
     C***********SCCCY     ANDNEBCCY                                      CEU006
     C***********                                                         CEU006
     C**OR,IF*FTCC IS LOCAL,BUT LOCAL CCY IS SAME AS BASE,AND FILE CCY    CEU006
     C**IS*NOT*BASE                                                       CEU006
     C***********                                                         CEU006
     C***********FTCC      OREQ 'L'                                       CEU006
     C***********SCCCY     ANDNEBCCY                                      CEU006
     C***********BCCY      ANDEQLOCY                                      CEU006
     C***********                                                         CEU006
     C**CURRENCY*FOR DUMMY AMOUNTS                                        CEU006
     C***********                                                         CEU006
     C***********          MOVE BCCY      SECCY                           CEU006
     C***********                                                         CEU006
     C**CONVERSION FOR STORING DUMMY AMOUNTS                              CEU006
     C***********                                                         CEU006
     C***********          Z-ADDWBCDP     ZDECS                           CEU006
     C***********          MOVE ' '       ZECODE                          CEU006
     C**TRANSFER*COMMISSION                                               CEU006
     C***********          Z-ADDTRCMF     TRCM                            CEU006
     C**TELEX*COMMISSION                                                  CEU006
     C***********          Z-ADDTXCHF     TXCH                            CEU006
     C**CHEQUE*CHARGE                                                     CEU006
     C***********          Z-ADDCQCHF     CQCH                            CEU006
     C**COSTS*ABROAD                                                      CEU006
     C***********          Z-ADDCSTAF     CSTA                            CEU006
     C**SWIFT*PRIORITY CHARGE                                             CEU006
     C***********          Z-ADDSPCHF     SPCH                            CEU006
     C**MISCELLANEOUS CHARGE                                              CEU006
     C*********************Z-ADDMSCHE     MSCH                      050982CEU006
     C***********          Z-ADDMSCHF     MSCH                      050982CEU006
     C***********                                                   S01499CEU006
     C***Change*commission                                          S01499CEU006
     C***********                                                   S01499CEU006
     C************IN30     IFEQ '1'                                 S01499CEU006
     C***********          Z-ADDCHCMF     OPCHCM                    S01499CEU006
     C***********          END                                      S01499CEU006
     C***********                                                   S01499CEU006
     C***VAT*****                                                   S01499CEU006
     C***********                                                   S01499CEU006
     C************IN31     IFEQ '1'                                 S01499CEU006
     C***********          Z-ADDVATTF     OPVATT                    S01499CEU006
     C***********          END                                      S01499CEU006
     C***********                                                         CEU006
     C**IF*FTCC*IS LOCAL,GET DETAILS FOR LOCY,AND CONVERT AMOUNTS FROM    CEU006
     C**BASE*TO*LOCAL FOR DUMMY AMOUNTS (LEFT SIDE ON SCREEN)             CEU006
     C***********                                                         CEU006
     C***********          ELSE                            ** X002        CEU006
     C***********                                                         CEU006
     C***********FTCC      IFEQ 'L'                        ** B003        CEU006
     C***********                                                         CEU006
     C**CURRENCY*                                                         CEU006
     C***********                                                         CEU006
     C***********          MOVE LOCY      SECCY                           CEU006
     C***********                                                         CEU006
     C***********          MOVEL'20      'ZTABKY                          CEU006
     C***********          MOVE '1'       KEY04                           CEU006
     C***********          MOVELSECCY     KEY04                           CEU006
     C***********          MOVE KEY04     ZTABKY                          CEU006
     C***********ZTABKY    CHAINTABTG10F             99                   CEU006
     C***********                                                         CEU006
     C***********                                                         CEU006
     C***CHECK*IF DATABASE ERROR OCCURRED                                 CEU006
     C***********                                                         CEU006
     C************IN99     IFEQ '1'                        ** B004        CEU006
     C************LOCK     IN   DLDA                                      CEU006
     C***********          MOVEL'FT0205'  DBPGM                           CEU006
     C***********          MOVEL'TABTG10' DBFILE           ***************CEU006
     C***********          MOVELZTABKY    DBKEY            * DB ERROR 17 *CEU006
     C***********          MOVEL'017'     DBASE            ***************CEU006
     C***********          OUT  DLDA                                      CEU006
     C***********          SETON                     U7U8LR               CEU006
     C***********          GOTO FINS07                                    CEU006
     C***********          END                             ** E004        CEU006
     C***********          Z-ADDCDP       LCDP    10                      CEU006
     C***********          Z-ADDMDIN      LMDIN   10                      CEU006
     C***********          Z-ADDSPOT      LSPOT  138                      CEU006
     C***********                                                         CEU006
     C**M*IS*DIFFERENCE BETWEEN DECIMALS FOR BASE AND DECIMALS FOR        CEU006
     C**LOCAL*CURRENCY - FOLLOWING CALCS FIND TRUE RATE(LSPOT)TO          CEU006
     C**CONVERT*LOCAL CCY TO BASE                                         CEU006
     C***********                                                         CEU006
     C***********LCDP      SUB  WBCDP     M       10                      CEU006
     C***********LMDIN     IFEQ 1                          ** B004        CEU006
     C***********M         IFGT 0                          ** B005        CEU006
     C***********LSPOT     DIV  POWER,N   TSPOT  159                      CEU006
     C***********          ELSE                            ** X005        CEU006
     C***********M         IFLT 0                          ** B006        CEU006
     C***********          Z-SUBM         M                               CEU006
     C***********LSPOT     MULT POWER,N   TSPOT                           CEU006
     C***********          ELSE                            ** X006        CEU006
     C***********          Z-ADDLSPOT     TSPOT                           CEU006
     C***********          END                             ** E006        CEU006
     C***********          END                             ** E005        CEU006
     C***********          END                             ** E004        CEU006
     C***********LMDIN     IFEQ 0                          ** B004        CEU006
     C***********M         IFGT 0                          ** B005        CEU006
     C***********LSPOT     MULT POWER,N   TSPOT                           CEU006
     C***********          ELSE                            ** X005        CEU006
     C***********M         IFLT 0                          ** B006        CEU006
     C***********          Z-SUBM         M                               CEU006
     C***********LSPOT     DIV  POWER,N   TSPOT                           CEU006
     C***********          ELSE                            ** X006        CEU006
     C***********          Z-ADDLSPOT     TSPOT                           CEU006
     C***********          END                             ** E006        CEU006
     C***********          END                             ** E005        CEU006
     C***********          END                             ** E004        CEU006
     C***********                                                   S01499CEU006
     C***If*VAT*applicable                                          S01499CEU006
     C***********                                                   S01499CEU006
     C************IN31     IFEQ '1'                                 S01499CEU006
     C***********                                                   S01499CEU006
     C***********          Z-ADD0         OPVATT                    S01499CEU006
     C***********                                                   S01494CEU006
     C***********OPVAT1    IFEQ 'Y'                                 S01499CEU006
     C***********DUMA2     MULT XTVA      VAT    110H              S01499 S01499
     C***********DUMA2     MULT O#VATR    VAT    110H               S01499CEU006
     C***********          ADD  VAT       OPVATT                    S01499CEU006
     C***********          END                                      S01499CEU006
     C***********                                                   S01499CEU006
     C***********OPVAT2    IFEQ 'Y'                                 S01499CEU006
     C***********DUMA3     MULT XTVA      VAT    110H              S01499 S01499
     C***********DUMA3     MULT O#VATR    VAT    110H               S01499CEU006
     C***********          ADD  VAT       OPVATT                    S01499CEU006
     C***********          END                                      S01499CEU006
     C***********                                                   S01499CEU006
     C***********OPVAT3    IFEQ 'Y'                                 S01499CEU006
     C***********DUMA4     MULT XTVA      VAT    110H              S01499 S01499
     C***********DUMA4     MULT O#VATR    VAT    110H               S01499CEU006
     C***********          ADD  VAT       OPVATT                    S01499CEU006
     C***********          END                                      S01499CEU006
     C***********                                                   S01499CEU006
     C***********OPVAT4    IFEQ 'Y'                                 S01499CEU006
     C***********DUMA5     MULT XTVA      VAT    110H              S01499 S01499
     C***********DUMA5     MULT O#VATR    VAT    110H               S01499CEU006
     C***********          ADD  VAT       OPVATT                    S01499CEU006
     C***********          END                                      S01499CEU006
     C***********                                                   S01499CEU006
     C***********OPVAT6    IFEQ 'Y'                                 S01499CEU006
     C***********DUMA6     MULT XTVA      VAT    110H              S01499 S01499
     C***********DUMA6     MULT O#VATR    VAT    110H               S01499CEU006
     C***********          ADD  VAT       OPVATT                    S01499CEU006
     C***********          END                                      S01499CEU006
     C***********                                                   S01499CEU006
     C***********OPVAT6    IFEQ 'Y'                                 S01499CEU006
     C***********DUMA1     MULT XTVA      VAT    110H              S01499 S01499
     C***********DUMA1     MULT O#VATR    VAT    110H               S01499CEU006
     C***********          ADD  VAT       OPVATT                    S01499CEU006
     C***********          END                                      S01499CEU006
     C***********                                                   S01499CEU006
     C***********OPVAT7    IFEQ 'Y'                                 S01499CEU006
     C***********OPDUM7    MULT XTVA      VAT    110H              S01499 S01499
     C***********OPDUM7    MULT O#VATR    VAT    110H               S01499CEU006
     C***********          ADD  VAT       OPVATT                    S01499CEU006
     C***********          END                                      S01499CEU006
     C***********                                                   S01499CEU006
     C***********          Z-ADDOPVATT    OPDUM8                    S01499CEU006
     C***********          END                                      S01499CEU006
     C***********                                                   S01499CEU006
     C**NOW*USE*RATE TO CALCULATE VALUE FOR LOCAL CCY IN BASE       S01499CEU006
     C***********                                                   S01499CEU006
     C***********LMDIN     IFEQ 0                          ** B004        CEU006
     C**TRANSFER*COMMISSION                                               CEU006
     C***********DUMA1     DIV  TSPOT     TRCME  110H                     CEU006
     C**TELEX*CHARGE                                                      CEU006
     C***********DUMA2     DIV  TSPOT     TXCHE  110H                     CEU006
     C**CHEQUE*CHARGE                                                     CEU006
     C***********DUMA3     DIV  TSPOT     CQCHE  110H                     CEU006
     C**COSTS*ABROAD                                                      CEU006
     C***********DUMA4     DIV  TSPOT     CSTAE  110H                     CEU006
     C**SWIFT*PRIORITY CHARGE                                             CEU006
     C***********DUMA5     DIV  TSPOT     SPCHE  110H                     CEU006
     C**MISCELLANEOUS CHARGE                                              CEU006
     C***********DUMA6     DIV  TSPOT     MSCHE  110H                     CEU006
     C***********                                                   S01494CEU006
     C***Change*commission                                          S01494CEU006
     C***********                                                   S01494CEU006
     C************IN30     IFEQ '1'                                 S01494CEU006
     C***********OPDUM7    DIV  TSPOT     CHCME  110H               S01494CEU006
     C***********          END                                      S01494CEU006
     C***********                                                   S01499CEU006
     C***VAT*****                                                   S01499CEU006
     C***********                                                   S01499CEU006
     C************IN31     IFEQ '1'                                 S01499CEU006
     C***********OPDUM8    DIV  TSPOT     VATTE  110H               S01499CEU006
     C***********          END                                      S01499CEU006
     C***********                                                   S01499CEU006
     C***********          END                             ** E004        CEU006
     C***********                                                         CEU006
     C***********LMDIN     IFEQ 1                          ** B004        CEU006
     C**TRANSFER*COMMISSION                                               CEU006
     C***********DUMA1     MULT TSPOT     TRCME  110H                     CEU006
     C**TELEX*CHARGE                                                      CEU006
     C***********DUMA2     MULT TSPOT     TXCHE  110H                     CEU006
     C**CHEQUE*CHARGE                                                     CEU006
     C***********DUMA3     MULT TSPOT     CQCHE  110H                     CEU006
     C**COSTS*ABROAD                                                      CEU006
     C***********DUMA4     MULT TSPOT     CSTAE  110H                     CEU006
     C**SWIFT*PRIORITY CHARGE                                             CEU006
     C***********DUMA5     MULT TSPOT     SPCHE  110H                     CEU006
     C**MISCELLANEOUS CHARGE                                              CEU006
     C***********DUMA6     MULT TSPOT     MSCHE  110H                     CEU006
     C***********                                                   S01494CEU006
     C***Change*commission                                          S01494CEU006
     C***********                                                   S01494CEU006
     C************IN30     IFEQ '1'                                 S01494CEU006
     C***********OPDUM7    MULT TSPOT     CHCME  110H               S01494CEU006
     C***********          END                                      S01494CEU006
     C***********                                                   S01499CEU006
     C***VAT*****                                                   S01499CEU006
     C***********                                                   S01499CEU006
     C************IN31     IFEQ '1'                                 S01499CEU006
     C***********OPDUM8    MULT TSPOT     VATTE  110H               S01499CEU006
     C***********          END                                      S01499CEU006
     C***********                                                   S01499CEU006
     C***********          END                             ** E004        CEU006
     C***********                                                         CEU006
     C**STORE*AMOUNTS                                                     CEU006
     C***********                                                         CEU006
     C***********          Z-ADDLCDP      ZDECS                           CEU006
     C***********          MOVE ' '       ZECODE                          CEU006
     C***********                                                         CEU006
     C**NOW*CONVERT AMOUNTS FROM BASE CCY TO CHARGE CCY FOR FILE          CEU006
     C***********                                                         CEU006
     C***********CMDIN     IFEQ 0                          ** B002        CEU006
     C**TRANSFER*COMMISSION                                               CEU006
     C***********TRCME     MULT RSPOT     TRCM   110H                     CEU006
     C**TELEX*CHARGE                                                      CEU006
     C***********TXCHE     MULT RSPOT     TXCH   110H                     CEU006
     C**CHEQUE*CHARGE                                                     CEU006
     C***********CQCHE     MULT RSPOT     CQCH   110H                     CEU006
     C**COSTS*ABROAD                                                      CEU006
     C***********CSTAE     MULT RSPOT     CSTA   110H                     CEU006
     C**SWIFT*PRIORITY CHARGE                                             CEU006
     C***********SPCHE     MULT RSPOT     SPCH   110H                     CEU006
     C**MISCELLANEOUS CHARGE                                              CEU006
     C***********MSCHE     MULT RSPOT     MSCH   110H                     CEU006
     C************                                                  S01494CEU006
     C***Change*commission                                          S01494CEU006
     C***********                                                   S01494CEU006
     C************IN30     IFEQ '1'                                 S01494CEU006
     C***********CHCME     MULT RSPOT     OPCHCM 110H               S01494CEU006
     C***********          END                                      S01494CEU006
     C***********                                                   S01499CEU006
     C***VAT*****                                                   S01499CEU006
     C***********                                                   S01499CEU006
     C************IN31     IFEQ '1'                                 S01499CEU006
     C***********VATTE     MULT RSPOT     OPVATT 110H               S01499CEU006
     C***********          END                                      S01499CEU006
     C***********                                                   S01499CEU006
     C***********          END                             ** E002        CEU006
     C***********                                                         CEU006
     C***********CMDIN     IFEQ 1                          ** B002        CEU006
     C**TRANSFER*COMMISSION                                               CEU006
     C***********TRCME     DIV  RSPOT     TRCM   110H                     CEU006
     C**TELEX*CHARGE                                                      CEU006
     C***********TXCHE     DIV  RSPOT     TXCH   110H                     CEU006
     C**CHEQUE*CHARGE                                                     CEU006
     C***********CQCHE     DIV  RSPOT     CQCH   110H                     CEU006
     C**COSTS*ABROAD                                                      CEU006
     C***********CSTAE     DIV  RSPOT     CSTA   110H                     CEU006
     C**SWIFT*PRIORITY CHARGE                                             CEU006
     C***********SPCHE     DIV  RSPOT     SPCH   110H                     CEU006
     C**MISCELLANEOUS CHARGE                                              CEU006
     C***********MSCHE     DIV  RSPOT     MSCH                            CEU006
     C***********                                                   S01494CEU006
     C***Change*commission                                          S01494CEU006
     C***********                                                   S01494CEU006
     C************IN30     IFEQ '1'                                 S01494CEU006
     C***********CHCME     DIV  RSPOT     OPCHCM 110H               S01494CEU006
     C***********          END                                      S01494CEU006
     C***********                                                   S01499CEU006
     C***VAT*****                                                   S01499CEU006
     C***********                                                   S01499CEU006
     C************IN31     IFEQ '1'                                 S01499CEU006
     C***********VATTE     DIV  RSPOT     OPVATT 110H               S01499CEU006
     C***********          END                                      S01499CEU006
     C***********                                                   S01499CEU006
     C***********          END                             ** E002        CEU006
     C***********                                                         CEU006
     C***********          END                             ** E003        CEU006
     C***********          END                             ** E002        CEU006
     C***********          END                             ** E001        CEU006
      * CEU006 NEW CODE HERE                                              CEU006
      *                                                                   CEU006
      * GET CHARGE AMOUNTS                                                CEU006
      *                                                                   CEU006
     C                     CLEARP#0010                                    CEU006
      *                                                                   CEU006
     C                     SELEC                                          CEU006
     C***********CDRO      WHNE *ZEROS                                                 CEU006 CSD027
     C           CDRO      WHNE *BLANKS                                                       CSD027
     C           BTCHCY    OREQ 'B'                                       CEU006
     C           CFT120    ANDNE'Y'                                                           CFT120
     C                     MOVE BCCY      P#FRCY                          CEU006
     C           OPCDRC    IFNE *BLANKS                                                       CFT120
     C           CFT120    ANDEQ'Y'                                                           CFT120
     C                     MOVELOPCDRC    P#FRCY                                              CFT120
     C                     ENDIF                                                              CFT120
      *                                                                                       CFT120
     C           BTCHCY    WHEQ 'B'                                                           CFT120
     C           CFT120    ANDEQ'Y'                                                           CFT120
     C                     MOVE BCCY      P#FRCY                                              CFT120
     C           BTCHCY    WHEQ 'L'                                       CEU006
     C                     MOVE LOCY      P#FRCY                          CEU006
     C           BTCHCY    WHEQ 'C'                                       CEU006
     C           ADDC      ANDEQ'A'                                       CEU006
     C                     MOVELSMCY      P#FRCY                          CEU006
     C                     OTHER                                          CEU006
     C                     MOVELPCCY      P#FRCY                          CEU006
     C                     ENDSL                                          CEU006
      *                                                                   CEU006
     C                     SELEC                                          CEU006
     C***********CDRO      WHNE *ZEROS                                                 CEU006 CSD027
     C           CDRO      WHNE *BLANKS                                                       CSD027
     C                     MOVE BCCY      P#TOCY                          CEU006
     C           OPCDRC    IFNE *BLANKS                                                       CFT120
     C           CFT120    ANDEQ'Y'                                                           CFT120
     C                     MOVE OPCDRC    P#TOCY                                              CFT120
     C                     ENDIF                                                              CFT120
      *                                                                                       CFT120
     C           ADDC      WHEQ 'A'                                       CEU006
     C                     MOVE SMCY      P#TOCY                          CEU006
     C                     OTHER                                          CEU006
     C                     MOVE PCCY      P#TOCY                          CEU006
     C                     ENDSL                                          CEU006
      *                                                                   CFT014
      ** Save Charges Currencies.                                         CFT014
      *                                                                   CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
     C                     MOVE P#FRCY    WWCCY1  3                       CFT014
     C                     MOVE P#TOCY    WWCCY2  3                       CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CEU006
     C           ADDC      IFEQ 'A'                                       CEU006
     C                     Z-ADDSLDT      P#FRDT                          CEU006
     C                     Z-ADDSLDT      P#TODT                          CEU006
     C                     ELSE                                           CEU006
     C                     Z-ADDPVDT      P#FRDT                          CEU006
     C                     Z-ADDPVDT      P#TODT                          CEU006
     C                     ENDIF                                          CEU006
      *                                                                   CEU006
     C                     Z-ADDDUMA1     P#FRAM                          CEU006
     C                     Z-ADD*ZERO     P#TOAM                          CEU006
     C                     EXSR SRFT10                                    CEU006
     C                     Z-ADDP#TOAM    TRCM                            CEU006
      *                                                                   CEU006
      * No need to clear and reset ft0010 parameters. The rate is         CEU006
      * determined on the first call and used in the subsequent calls.    CEU006
     C                     Z-ADDDUMA2     P#FRAM                          CEU006
     C                     Z-ADD*ZERO     P#TOAM                          CEU006
     C                     EXSR SRFT10                                    CEU006
     C                     Z-ADDP#TOAM    TXCH                            CEU006
      *                                                                   CEU006
     C                     Z-ADDDUMA3     P#FRAM                          CEU006
     C                     Z-ADD*ZERO     P#TOAM                          CEU006
     C                     EXSR SRFT10                                    CEU006
     C                     Z-ADDP#TOAM    CQCH                            CEU006
      *                                                                   CEU006
     C                     Z-ADDDUMA4     P#FRAM                          CEU006
     C                     Z-ADD*ZERO     P#TOAM                          CEU006
     C                     EXSR SRFT10                                    CEU006
     C                     Z-ADDP#TOAM    CSTA                            CEU006
      *                                                                   CEU006
     C                     Z-ADDDUMA5     P#FRAM                          CEU006
     C                     Z-ADD*ZERO     P#TOAM                          CEU006
     C                     EXSR SRFT10                                    CEU006
     C                     Z-ADDP#TOAM    SPCH                            CEU006
      *                                                                   CEU006
     C                     Z-ADDDUMA6     P#FRAM                          CEU006
     C                     Z-ADD*ZERO     P#TOAM                          CEU006
     C                     EXSR SRFT10                                    CEU006
     C                     Z-ADDP#TOAM    MSCH                            CEU006
      *                                                                   CEU006
     C                     Z-ADDOPDUM7    P#FRAM                          CEU006
     C                     Z-ADD*ZERO     P#TOAM                          CEU006
     C                     EXSR SRFT10                                    CEU006
     C                     Z-ADDP#TOAM    OPCHCM                          CEU006
      *                                                                   CEU006
     C                     Z-ADDOPDUM8    P#FRAM                          CEU006
     C                     Z-ADD*ZERO     P#TOAM                          CEU006
     C                     EXSR SRFT10                                    CEU006
     C                     Z-ADDP#TOAM    OPVATT                          CEU006
     C                     ENDIF                                          CEU006
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      *
     C           FINS07    ENDSR
     C*
     C********************************************************************
     C********************************************************************
     C/EJECT
     C           CHOPF     BEGSR
     C*          ******    *****
     C*
     C*****************************************************************
     C*                 CHOP FIELD PROCESSING                         *
     C*                                                               *
     C*  FUNCTION : TO EDIT  SNCO, ORBK, CDRO  FOR OUTPUT.            *
     C*             IF PRMFLD IS ZERO THEN OUTPUT BLANKS.             *
     C*             IF PRMTYP IS 'N',OUTPUT FIRST TWO CHARS.          *
     C*             IF PRMTYP ID 'R',OUTPUT FIRST TEN CHARS.          *
     C*                                                               *
     C*  CALLS :    NONE                                              *
     C*                                                               *
     C*  CALLED BY: DEBIT                                             *
     C*             CREDIT                                            *
     C*****************************************************************
     C*
     C           PRMFLD    IFEQ *ZEROS
     C                     MOVE *BLANKS   PRMFLD
     C                     ELSE
     C*
     C           PRMTYP    IFEQ 'N'
     C                     MOVE BLNK10    PRMFLD
     C                     ELSE
     C*
     C           PRMTYP    IFEQ 'R'
     C                     MOVE BLNK2     PRMFLD
     C*
     C                     END
     C                     END
     C                     END
     C*
     C*                    *****
     C                     ENDSR
     C*                    *****
     C/EJECT
     C********************************************************************
     C*
     C** UGFRMT SR.TO FORMAT A NUMERIC FIELD FOR OUTPUT TO A REPORT
     C*
     C           UGFRMT    BEGSR
     C*
     C                     MOVEAWFDIN     WA1,1
     C*
     C** REPLACE LEADING ZEROES (IF LEFT OF DECIMAL POINT) WITH SPACES
     C*
     C                     SETOF                     89
     C           15        SUB  WDIG      I       30        -START
     C                     SUB  WDEC      I                  POS.
     C*
     C           14        SUB  WDEC      I1      30
     C*
     C           *IN89     DOUEQ'1'
     C                     ADD  1         I
     C           I         IFGT 15                          -CHECK FOR
     C                     SETON                     89      ARRAY END
     C                     ELSE
     C           WA1,I     IFNE '0'                         -CHECK FOR
     C                     SETON                     89      NON-ZERO
     C                     ELSE                              DIGIT.
     C           I         IFLE I1
     C                     MOVEL' '       WA1,I
     C                     END
     C                     END
     C                     END
     C                     END
     C*
     C** MOVE DIGITS TO RIGHT OF DECIMAL POINT(IF ANY) TO OUTPUT ARRAY
     C** & INSERT A DECIMAL POINT
     C*
     C                     MOVEL*BLANKS   WA2
     C*
     C           16        SUB  WDEC      I
     C           21        SUB  WDEC      I1
     C*
     C           I         IFLE 15
     C                     MOVEAWA1,I     WA2,I1
     C                     SUB  1         I1
     C                     MOVEL'.'       WA2,I1
     C                     END
     C*
     C** INSERT A COMMA AFTER EVERY 3 DIGITS TO LEFT OF DECIMAL POINT
     C*
     C                     SUB  1         I
     C                     SUB  1         I1
     C                     Z-ADD*ZERO     I2      30
     C*
     C           WA1,I     DOUEQ' '
     C           I         OREQ *ZERO
     C*
     C           I2        IFEQ 3
     C                     MOVEL','       WA2,I1
     C                     SUB  1         I1
     C                     Z-ADD*ZERO     I2
     C                     END
     C*
     C                     MOVE WA1,I     WA2,I1
     C                     SUB  1         I
     C                     SUB  1         I1
     C                     ADD  1         I2
     C                     END
     C*
     C                     MOVEAWA2,1     WFDOUT 20
     C*
     C           UGEND     ENDSR
     C*
     C********************************************************************
     C/EJECT
     C********************************************************************
     C*
     C** DAFDT SR.TO OBTAIN DAF DATE FORMATS 'CC' & 'YYMMDD'
     C*
     C           DAFDT     BEGSR
     C*
     C                     MOVE WDATE1    WDATE2  20
     C                     MOVELWDATE1    WDATE4  40
     C                     MOVEL*ZEROS    WDATE1  60
     C           *IN98     IFEQ '1'
     C                     MOVE WDATE4    WDATE3  60
     C                     MOVELWDATE2    WDATE3
     C                     ELSE
     C                     MOVE WDATE4    WDATE5  20
     C                     MOVELWDATE4    WDATE6  20
     C                     MOVELWDATE5    WDATE4
     C                     MOVE WDATE6    WDATE4
     C                     MOVE WDATE4    WDATE3
     C                     MOVELWDATE2    WDATE3
     C                     END
     C*
     C           WDATE2    IFGT 71
     C                     MOVE '19'      WDATE2
     C                     ELSE
     C                     MOVE '20'      WDATE2
     C                     END
     C*
     C                     ENDSR
     C*
     C********************************************************************S01195
     C/EJECT                                                              S01195
     C********************************************************************S01195
     C*                                                                   S01195
     C** Subroutine to read nostros file SDNOSTPD                         S01195
     C*                                                                   S01195
     C           NOSTRO    BEGSR                                          S01195
     C*                                                                   S01195
     C                     CALL 'AONOSTR0'                                S01195
     C                     PARM '*MSG   ' @RTCD   7                       S01195
     C                     PARM '*KEY   ' @OPTN   7                       S01195
     C                     PARM           @CUST   6                       S01195
     C                     PARM           @CYCD   3                       S01195
     C**********           PARM           @ACCD   4                                    S01195 CGL029
     C                     PARM           @ACCD                                               CGL029
     C                     PARM           @ACSN   2                       S01195
     C                     PARM           @NONB   2                       S01195
     C                     PARM           @BRCC   3                       S01195
     C                     PARM *BLANKS   @CSSN  10                       S01195
     C                     PARM *BLANKS   @PNOI   1                       S01195
     C           SDNOST    PARM SDNOST    DSFDY                           S01195
     C*                                                                   S01195
     C           @RTCD     IFNE *BLANKS                                   S01195
     C           @RTCD     IFEQ '*NRF   '                                 S01195
     C                     SETOF                     40                   S01195
     C                     ELSE                                           S01195
     C                     EXSR ERROR                                     S01195
     C                     END                                            S01195
     C*                                                                   S01195
     C**  Else,if record found...                                         S01195
     C*                                                                   S01195
     C                     ELSE                                           S01195
     C                     SETON                     40                   S01195
     C                     END                                            S01195
     C*                                                                   S01195
     C                     ENDSR                                          S01195
     C*                                                                   S01195
     C********************************************************************S01195
     C/EJECT                                                              S01195
     C********************************************************************S01195
     C*                                                                   S01195
     C** Subroutine to handle database error for SDNOSTPD file.           S01195
     C*                                                                   S01195
     C           ERROR     BEGSR                                          S01195
     C*                                                                   S01195
     C           *LOCK     IN   DLDA                                      S01195
     C                     MOVEL'FT0205'  DBPGM                           S01195
     C                     MOVELWRK17     DBKEY            ***************S01195
     C                     MOVE 'SDNOSTPD'DBFILE           * DB ERROR 22 *S01195
     C                     MOVE '022'     DBASE            ***************S01195
     C                     OUT  DLDA                                      S01195
     C                     SETON                     U7U8LR               S01195
     C                     GOTO TAG03                                     S01195
     C*                                                                   S01195
     C                     ENDSR                                          S01195
     C********************************************************************S01195
     C/EJECT                                                              S01195
     C********************************************************************S01195
     C*                                                                   S01195
     C** Subroutine to read ACNUMA for retail number                      S01195
     C*                                                                   S01195
     C           RETAIL    BEGSR                                          S01195
     C*                                                                   S01195
     C           ACNO      CHAINACNUMA               88                   S01195
     C           *IN88     IFEQ '0'                                       S01195
     C           RECI      COMP 'D'                  8888                 S01195
     C                     END                                            S01195
     C           *IN88     IFEQ '1'                        B002           S01194
     C           *LOCK     IN   DLDA                                      S01194
     C                     MOVE 'FT0205  'DBPGM                           S01194
     C                     MOVEL'ACNUMA'  DBFILE           ***************S01194
     C                     Z-ADD018       DBASE            * DB ERROR 18 *S01194
     C                     MOVELACNO      DBKEY            ***************S01194
     C                     OUT  DLDA                                      S01194
     C                     SETON                     U7U8LR               S01194
     C                     GOTO TAG03                                     S01194
     C                     END                             E002           S01194
     C*                                                                   S01195
     C           *IN88     IFEQ '0'                                       S01195
     C                     MOVE CNUM      @CUST                           S01195
     C                     MOVE CCY       @CYCD                           S01195
     C                     MOVE ACOD      @ACCD                           S01195
     C                     MOVE ACSQ      @ACSN                           S01195
     C                     MOVE BRCH      @BRCC                           S01195
     C                     MOVE *BLANKS   @NONB                           S01195
     C                     EXSR NOSTRO                     Read SDNOSTPD  S01195
     C                     END                                            S01195
     C*                                                                   S01195
     C                     ENDSR                                          S01195
     C********************************************************************CEU006
     C/EJECT                                                              CEU006
     C********************************************************************CEU006
      * Calls new CEU006 routine to calculate pay or settle amount,       CEU006
      * and charge amounts.                                               CEU006
     C           SRFT10    BEGSR                                          CEU006
      *                                                                   CEU006
     C                     CALL 'FT0010'                                  CEU006
     C                     PARM           P#0010                          CEU006
      *                                                                   CEU006
     C           P#RTCD    IFEQ '*ERROR*'                                 CEU006
     C           *LOCK     IN   DLDA                                      CEU006
     C                     MOVEL'FT0205'  DBPGM                           CEU006
     C                     MOVELP#0010    DBKEY                           CEU006
     C                     MOVEL'FT0010'  DBFILE                          CEU006
     C                     MOVE '052'     DBASE                           CEU006
     C                     OUT  DLDA                                      CEU006
     C                     SETON                     U7U8LR               CEU006
     C                     RETRN                                          CEU006
     C                     ENDIF                                          CEU006
      *                                                                   CEU006
     C                     ENDSR                                          CEU006
     C********************************************************************
      /EJECT                                                              CFT014
      *****************************************************************   CFT014
      *                                                               *   CFT014
      *  SRCURR - Access Currency details                             *   CFT014
      *                                                               *   CFT014
      *  Called By: PRTP1                                             *   CFT014
      *  Calls    : AOCURRR0                                          *   CFT014
      *                                                               *   CFT014
      *****************************************************************   CFT014
     C           SRCURR    BEGSR                                          CFT014
      *                                                                   CFT014
     C                     CALL 'AOCURRR0'                                CFT014
     C                     PARM *BLANKS   P@RTCD                          CFT014
     C                     PARM '*KEY   ' P@OPTN                          CFT014
     C                     PARM           P@CCY   3                       CFT014
     C           SDCURR    PARM SDCURR    DSSDY                           CFT014
      *                                                                   CFT014
     C           P@RTCD    IFNE *BLANKS                                   CFT014
     C           *LOCK     IN   DLDA                                      CFT014
     C                     MOVE '036'     DBASE                           CFT014
     C                     MOVELP@CCY     DBKEY                           CFT014
     C                     MOVE 'SDCURRPD'DBFILE                          CFT014
     C                     MOVEL'FT0205'  DBPGM                           CFT014
     C                     OUT  DLDA                                      CFT014
     C                     MOVE *ON       *INU7                           CFT014
     C                     MOVE *ON       *INU8                           CFT014
     C                     MOVE *ON       *INLR                           CFT014
     C                     MOVE *ON       *IN99                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDSR                                          CFT014
      *****************************************************************   CFT014
     C/EJECT
4931 C********************************************************************
4932 C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
4933 C*   IND '99' IS SET BY AN OVERFLOW ERROR
4934 C*
4935 CSR         GLZADD    BEGSR                           *** GLZADD ****
4936 C*
4937 CSR                   Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT
4938 CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS
4939 C*
4940 C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
4941 CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
4942 CSR                   MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD
4943 C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
4944 C*
4945 CSR                   EXSR GLZSUM
4946 CSR         ZZAEND    ENDSR                           ** ZZAEND TAG *
4947 C*
     C********************************************************************
     C/EJECT
     C********************************************************************
4949 C* SUBROUTINE TO SUBTRACT AN AMOUNT (ZZAMT) FROM THE TOTAL
4950 C*                                                   (ZZTOTI,ZZTOTD)
4951 C*  IND '99' IS SET BY AN OVERFLOW ERROR
4952 CSR         GLZSUB    BEGSR                           *** GLZSUB ****
4953 C* PROCESSING. JUST REVERSE THE 'SIGN' AND ADD
4954 CSR                   Z-SUBZZAMT     ZZAMT  153       REVERSE 'SIGN'
4955 CSR                   EXSR GLZADD                       AND 'ADD'
4956 CSR                   Z-SUBZZAMT     ZZAMT            RESTORE 'SIGN'
4957 CSR                   ENDSR
4947 C*
     C********************************************************************
     C/EJECT
     C********************************************************************
4959 C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
4960 C*                        GLZADD, GLZSUB, GLZCMP.
4961 C*          PARAMETERS PASSED -
4962 C*                     I/P ZZAMTI ZZAMTD
4963 C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
4964 C*
4965 CSR         GLZSUM    BEGSR                           *** GLZSUM ****
4966 C*
4967 CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
4968 CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
4969 CSR                   SETOF                     919293
4970 CSR                   SETOF                     949599
4971 C*
4972 C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
4973 CSR         ZZAMTI    COMP 0                      9293
4974 CSR 93      ZZAMTD    COMP 0                      9293
4975 CSR 93                GOTO ZZSEND                     ZERO BYPASS
4976 C*
4977 C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
4978 CSR         ZZTOTI    COMP 0                      9193
4979 CSR 93      ZZTOTD    COMP 0                      9193
4980 C*
4981 C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
4982 CSR 93                Z-ADDZZAMTI    ZZTOTI
4983 CSR 93                Z-ADDZZAMTD    ZZTOTD
4984 CSR 93                GOTO ZZSEND                     ZERO BYPASS
4985 C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
4986 CSR 91N92
4987 CORN91 92             GOTO ZZOFPS
4988 C*
4989 CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40
4990 CSR         ZZWK2     COMP 999                  93    '93' = CARRY
4991 CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.
4992 C*
4993 CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
4994 CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
4995 CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3
4996 CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3
4997 C*
4998 C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
4999 CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
5000 CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
5001 CSRN99                Z-ADDZZWK2     ZZTOTD
5002 CSRN99                Z-ADDZZWK3     ZZTOTI
5003 C*
5004 C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
5005 CSR 99                Z-ADD0         ZZAMT  153
5006 CSR                   GOTO ZZSEND
5007 C*
5008 C* THE 'SIGNS' ARE DIFFERENT
5009 CSR         ZZOFPS    TAG                             ** ZZOFPS TAG**
5010 C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
5011 C*
5012 CSR 92                Z-SUBZZAMTI    ZZAMTI 150
5013 CSR 92                Z-SUBZZAMTD    ZZAMTD  30
5014 C*
5015 C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
5016 C*
5017 CSR 91                Z-SUBZZTOTI    ZZTOTI
5018 CSR 91                Z-SUBZZTOTD    ZZTOTD
5019 C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
5020 C*
5021 CSR         ZZTOTI    COMP ZZAMTI               93  95
5022 CSR 95      ZZTOTD    COMP ZZAMTD               93  95
5023 C*
5024 C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
5025 CSR 95                Z-ADD0         ZZTOTI
5026 CSR 95                Z-ADD0         ZZTOTD
5027 CSR 95                GOTO ZZSEND
5028 C*
5029 C* IF ZZTOT GT. ZZAMT.
5030 CSR 93      ZZAMTD    COMP ZZTOTD               94
5031 CSR 93 94   ZZTOTI    SUB  1         ZZTOTI
5032 CSR 93 94   ZZTOTD    ADD  1000      ZZWK2
5033 CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
5034 CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
5035 CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
5036 C*
5037 C*
5038 C* IF ZZAMT GT. ZZTOT.
5039 CSRN93      ZZTOTD    COMP ZZAMTD               94
5040 CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150
5041 CSRN93 94   ZZAMTD    ADD  1000      ZZWK2
5042 CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
5043 CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
5044 CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
5045 CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
5046 C*
5047 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
5048 CSR                   SETOF                     94
5049 CSR 93 91
5050 CORN93 92             SETON                     94
5051 CSR 94                Z-SUBZZTOTI    ZZTOTI
5052 CSR 94                Z-SUBZZTOTD    ZZTOTD
5053 C**
5054 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
5055 CSR 92                Z-SUBZZAMTI    ZZAMTI
5056 CSR 92                Z-SUBZZAMTD    ZZAMTD
5057 CSR         ZZSEND    TAG                             ** ZZSEND TAG *
5058 C**
5059 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
5060 CSR                   SETOF                     96
5061 CSR         ZZTOTD    COMP 0                        91
5062 CSR 91      ZZTOTI    COMP 0                      96
5063 CSR 96                MOVE '.000-'   ZZNEGD  5
5064 CSR                   ENDSR                             ** ENDSR **
5065 C********************************************************************
4632 C/EJECT
4631 C********************************************************************
4632 C**
4633 C**   ZDATE1 SR. TO VALIDATE DATES SUBMITTED AND
4634 C**              CONVERT TO A NUMBER OF DAYS.
4635 C**
4636 C**   THE YEAR 2000, BEING DIVISIBLE BY 400, IS A LEAP YEAR.
4637 C**
4638 C           ZDATE1    BEGSR                           *** ZDATE1 ***
4639 C**
4640 C**   CLEAR DAY NUMBER.
4641 C                     Z-ADD0         ZDAYNO  50
4642 C**
4643 C**   CALCULATION TO DEFINE INPUT DATE FIELD.
4644 C                     Z-ADDZDATE     ZDATE   60
4645 C**
4646 C**   GET INDIVIDUAL DAY, MONTH AND YEAR FIELDS.
4647 C                     MOVE ZDATE     ZYEAR   20
4648 C  N98                MOVELZDATE     ZDAY    20
4649 C   98                MOVELZDATE     ZMTH    20
4650 C                     MOVE ZDATE     ZWRK4   40
4651 C  N98                MOVELZWRK4     ZMTH
4652 C   98                MOVELZWRK4     ZDAY
4653 C**
4654 C**   ENSURE MONTH IS VALID.
4655 C           ZMTH      COMP 0                      9999
4656 C  N99      ZMTH      COMP 12                   99
4657 C   99                GOTO ZDEND1                     BYPASS IF ERROR
4658 C**
4659 C**   CHECK FOR 30 DAY MONTHS.
4660 C           ZMTH      COMP 4                        90IF 90 ON, 30
4661 C  N90      ZMTH      COMP 6                        90DAY MONTH.
4662 C  N90      ZMTH      COMP 9                        90
4663 C  N90      ZMTH      COMP 11                       90
4664 C**
4665 C**   ENSURE DAY IS VALID.
4666 C           ZDAY      COMP 0                      9999
4667 C   90N99   ZDAY      COMP 30                   99
4668 C  N90N99   ZDAY      COMP 31                   99
4669 C   99                GOTO ZDEND1                     BYPASS IF ERROR
4670 C**
4671 C**   CHECK FOR LEAP YEAR AND FEBRUARY.
4672 C           ZYEAR     ADD  28        ZYEAR
4673 C           ZYEAR     DIV  4         ZLYR    20
4674 C                     MVR            ZLY     10     91LEAP YR, 91 ON
4675 C           ZMTH      COMP 2                    93  92FEB., 92 ON
4676 C**                                                   PAST FEB, 93 ON
4677 C**   IF FEBUARY FURTHER VALIDATE DAY.
4678 C  N91 92   ZDAY      COMP 28                   99
4679 C   91 92   ZDAY      COMP 29                   99
4680 C   99                GOTO ZDEND1                     BYPASS IF ERROR
4681 C**
4682 C**   DETERMINE NUMBER OF DAYS FROM 31/12/1971.     NO.OF 4 YR. SPANS
4683 C           ZLYR      MULT 1461      ZDAYNO           X DAYS IN SPAN.
4684 C  N91      ZDAYNO    ADD  ZYDY,ZLY  ZDAYNO           SINCE LAST L.YR
4685 C   91 93   ZDAYNO    ADD  1         ZDAYNO           L.YR.,PAST FEB.
4686 C           ZDAYNO    ADD  ZMDY,ZMTH ZDAYNO           DAYS THIS YEAR
4687 C           ZDAYNO    ADD  ZDAY      ZDAYNO           DAYS THIS MONTH
4688 C**
4689 C           ZDEND1    ENDSR                           * ZDEND1 ENDSR*
4690 C**
4691 C**
4692 C********************************************************************
3807 C/EJECT
3806 C********************************************************************
3807 C**
3808 C**   ZDATE2 SR. TO CONVERT A DAY NUMBER TO DATE FORMATS.
3809 C**
3810 C**   THE YEAR 2000, BEING DIVISIBLE BY 400, IS A LEAP YEAR.
3811 C**
3812 C           ZDATE2    BEGSR                           *** ZDATE2 ***
3813 C**
3814 C**   CLEAR DATE FIELDS.
3815 C                     Z-ADD0         ZDATE   60
3816 C                     MOVEL'       ' ZADATE  7
3817 C**
3818 C**   CALCULATION TO DEFINE INPUT DAY NUMBER.
3819 C                     Z-ADDZDAYNO    ZDAYNO  50
3820 C**
3821 C**   DETERMINE YEAR NUMBER.
3822 C**
3823 C**   ADJUST DAY NUMBER IN CASE LAST DAY OF YEAR.
3824 C           ZDAYNO    SUB  1         ZDAYN1  50   99
3825 C   99                GOTO ZDEND2
3826 C**
3827 C**   CALCULATE NUMBER OF 4 YEAR SPANS SINCE 31/12/1971.
3828 C           ZDAYN1    DIV  1461      ZLYR    20
3829 C                     MVR            ZDAYN1           SAVE REMAINING
3830 C**                                                   DAYS
3831 C**   CALCULATE NUMBER OF REMAINING YEARS.
3832 C                     Z-ADD1         ZWRK2   20
3833 C           ZDTAG1    TAG                             ** ZDTAG1 TAG *
3834 C           ZDAYN1    COMP ZYDY,ZWRK2             90
3835 C  N90      ZWRK2     ADD  1         ZWRK2
3836 C  N90                GOTO ZDTAG1
3837 C           ZWRK2     SUB  1         ZWRK2          91LEAP YR, 91 ON
3838 C**
3839 C**   DECREMENT DAY NO. BY DAYS IN REMAINING YEARS.
3840 C  N91      ZDAYN1    SUB  ZYDY,ZWRK2ZDAYN1
3841 C**
3842 C**   CALCULATE ACTUAL YEAR NUMBER.
3843 C           ZLYR      MULT 4         ZWRK3   30
3844 C           ZWRK3     ADD  72        ZWRK3            BASE IS 1972
3845 C                     Z-ADDZWRK3     ZYEAR   20
3846 C           ZYEAR     ADD  ZWRK2     ZYEAR            YEAR
3847 C**
3848 C**   DETERMINE MONTH NUMBER.
3849 C**
3850 C**   ADJUST DAY NO. IN CASE LAST DAY OF LEAP YEAR FEBRUARY.
3851 C                     SETOF                     9293
3852 C   91      ZDAYN1    COMP 59                     9293
3853 C   91N92   ZDAYN1    SUB  1         ZDAYN1
3854 C**
3855 C**   CALCULATE MONTH NUMBER.
3856 C                     Z-ADD2         ZWRK2
3857 C           ZDTAG2    TAG                             ** ZDTAG2 TAG *
3858 C           ZDAYN1    COMP ZMDY,ZWRK2             94
3859 C  N94      ZWRK2     ADD  1         ZWRK2
3860 C  N94                GOTO ZDTAG2
3861 C           ZWRK2     SUB  1         ZWRK2
3862 C**
3863 C                     Z-ADDZWRK2     ZMTH    20       MONTH
3864 C**
3865 C**   DETERMINE DAY OF MONTH.
3866 C**
3867 C**   ADD BACK LAST DAY OF YEAR ADJUSTMENT.
3868 C           ZDAYN1    ADD  1         ZDAYN1
3869 C**
3870 C**   CALCULATE DAY OF MONTH.
3871 C           ZDAYN1    SUB  ZMDY,ZWRK2ZDAY    20       DAY
3872 C**
3873 C**   ADD BACK LEAP YEAR 29TH FEBUARY ADJUSTMENT, IF REQUIRED.
3874 C   93      ZDAY      ADD  1         ZDAY
3875 C**
3876 C**   FORMAT DATE, DDMMYY OR MMDDYY.
3877 C  N98                MOVELZDAY      ZWRK4   40
3878 C   98                MOVE ZDAY      ZWRK4
3879 C  N98                MOVE ZMTH      ZWRK4
3880 C   98                MOVELZMTH      ZWRK4
3881 C                     MOVELZWRK4     ZDATE
3882 C                     MOVE ZYEAR     ZDATE
3883 C**
3884 C**   FORMAT ALPHA DATE, DDMMMYY.
3885 C           ZDAY      COMP 10                     95
3886 C                     MOVELZDAY      ZWRK5   5
3887 C   95                MOVEL' '       ZWRK5
3888 C                     MOVE ZMNM,ZMTH ZWRK5
3889 C                     MOVELZWRK5     ZADATE
3890 C                     MOVE ZYEAR     ZADATE
3891 C**
3892 C           ZDEND2    ENDSR                           * ZDEND2 ENDSR*
3893 C********************************************************************
      *****************************************************************   CFT009
     C           FT0985    BEGSR                                          CFT009
     C                     CALL 'FT000985'                                CFT009
     C                     PARM           RET985 10                       CFT009
     C                     PARM           INPCHG 130                      CFT009
     C                     PARM           PCCY                            CFT009
     C                     PARM           SMCY                            CFT009
     C                     PARM           OPCHGC                          CFT009
     C                     PARM           CURCY                           CFT009
     C                     PARM           OPCHRT                          CFT009
     C                     PARM           LEVCHG 130                      CFT009
     C                     PARM           LEVFMT 16                       CFT009
     C                     ENDSR                                          CFT009
      *****************************************************************   CFT009
     C           VTFLAG    BEGSR                                          CFT009
      *                                                                   CFT009
     C                     MOVEL'N'       FLAGVT  1                       CFT009
      *                                                                   CFT009
     C           CHGCOD    IFNE *BLANKS                                   CFT009
      *                                                                   CFT009
     C           CHGCOD    CHAINFTPCHGL0             34                   CFT009
      *                                                                   CFT009
      ** If charge code not found, database error                         CFT009
      *                                                                   CFT009
     C           *IN34     IFEQ *ON                                       CFT009
     C           *LOCK     IN   DLDA                                      CFT009
     C                     MOVEL'FT0205'  DBPGM            ***************CFT009
     C                     MOVELCHGCOD    DBKEY            * DB ERROR 35 *CFT009
     C                     MOVE 'FTPCHGL0'DBFILE           ***************CFT009
     C                     MOVE '035'     DBASE                           CFT009
     C                     OUT  DLDA                                      CFT009
     C                     SETON                     U7U8LR               CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Valid values are 'Y' or ' ' on file, but if blank print 'N'      CFT009
      *                                                                   CFT009
     C           VATLIN    IFEQ *BLANK                                    CFT009
     C                     MOVEL'N'       FLAGVT  1                       CFT009
     C                     ELSE                                           CFT009
     C                     MOVELVATLIN    FLAGVT                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDSR                                          CFT009
      *****************************************************************   CFT009
     C           CSNDCH    BEGSR                                          CFT009
      *                                                                   CFT009
      *                                                                   CFT009
      ** SET THE LAST SENDER'S CHARGES DEDUCTED TO THE SUM                CFT009
      ** OF ALL CHARGES IN PAY CCY.                                       CFT009
     C                     SELEC                                          CFT009
     C***********CDRO      WHNE *ZEROS                                                 CFT009 CSD027
     C           CDRO      WHNE *BLANKS                                                       CSD027
     C           BTCHCY    OREQ 'B'                                       CFT009
     C           CFT120    ANDNE'Y'                                                           CFT120
     C                     MOVE BCCY      P#FRCY                          CFT009
     C           OPCDRC    IFNE *BLANKS                                                       CFT120
     C           CFT120    ANDEQ'Y'                                                           CFT120
     C                     MOVE OPCDRC    P#FRCY                                              CFT120
     C                     ENDIF                                                              CFT120
     C           BTCHCY    WHEQ 'B'                                                           CFT120
     C           CFT120    ANDEQ'Y'                                                           CFT120
     C                     MOVE BCCY      P#FRCY                                              CFT120
     C           BTCHCY    WHEQ 'L'                                       CFT009
     C                     MOVE LOCY      P#FRCY                          CFT009
     C           BTCHCY    WHEQ 'C'                                       CFT009
     C           ADDC      ANDEQ'A'                                       CFT009
     C                     MOVELSMCY      P#FRCY                          CFT009
     C                     OTHER                                          CFT009
     C                     MOVELPCCY      P#FRCY                          CFT009
     C                     ENDSL                                          CFT009
     C                     SELEC                                          CFT009
     C***********CDRO      WHNE *ZEROS                                                 CFT009 CSD027
     C           CDRO      WHNE *BLANKS                                                       CSD027
     C                     MOVE BCCY      P#TOCY                          CFT009
     C           OPCDRC    IFNE *BLANKS                                                       CFT120
     C           CFT120    ANDEQ'Y'                                                           CFT120
     C                     MOVE OPCDRC    P#TOCY                                              CFT120
     C                     ENDIF                                                              CFT120
      *                                                                                       CFT120
     C           ADDC      WHEQ 'A'                                       CFT009
     C                     MOVE SMCY      P#TOCY                          CFT009
     C                     OTHER                                          CFT009
     C                     MOVE PCCY      P#TOCY                          CFT009
     C                     ENDSL                                          CFT009
      *                                                                   CFT009
     C                     MOVE P#FRCY    WWCCY1  3                       CFT009
     C                     MOVE P#TOCY    WWCCY2  3                       CFT009
      *                                                                   CFT009
     C           DTCH      IFEQ 'BEN'                                     CFT009
      *                                                                   CFT009
     C                     SELEC                                          CFT009
      *                                                                   CFT009
     C           WWCCY1    WHEQ PCCY                                      CFT009
     C           DUMA1     ADD  DUMA2     WSCHG  110                      CFT009
     C                     ADD  DUMA3     WSCHG                           CFT009
     C                     ADD  DUMA4     WSCHG                           CFT009
     C                     ADD  DUMA5     WSCHG                           CFT009
     C                     ADD  DUMA6     WSCHG                           CFT009
     C           *IN30     IFEQ *ON                                       CFT009
     C                     ADD  OPDUM7    WSCHG                           CFT009
     C                     ENDIF                                          CFT009
     C           *IN31     IFEQ *ON                                       CFT009
     C                     ADD  OPDUM8    WSCHG                           CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C           WWCCY2    WHEQ PCCY                                      CFT009
     C           TRCM      ADD  TXCH      WSCHG                           CFT009
     C                     ADD  CQCH      WSCHG                           CFT009
     C                     ADD  CSTA      WSCHG                           CFT009
     C                     ADD  SPCH      WSCHG                           CFT009
     C                     ADD  MSCH      WSCHG                           CFT009
     C           *IN30     IFEQ *ON                                       CFT009
     C                     ADD  OPCHCM    WSCHG                           CFT009
     C                     ENDIF                                          CFT009
     C           *IN31     IFEQ *ON                                       CFT009
     C                     ADD  OPVATT    WSCHG                           CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     OTHER                                          CFT009
     C           TRCM      ADD  TXCH      WWSCH  110                      CFT009
     C                     ADD  CQCH      WWSCH                           CFT009
     C                     ADD  CSTA      WWSCH                           CFT009
     C                     ADD  SPCH      WWSCH                           CFT009
     C                     ADD  MSCH      WWSCH                           CFT009
     C           *IN30     IFEQ *ON                                       CFT009
     C                     ADD  OPCHCM    WWSCH                           CFT009
     C                     ENDIF                                          CFT009
     C           *IN31     IFEQ *ON                                       CFT009
     C                     ADD  OPVATT    WWSCH                           CFT009
     C                     ENDIF                                          CFT009
     C                     CLEARP#0010                                    CFT009
     C                     MOVELWWCCY2    P#FRCY                          CFT009
     C                     Z-ADDWWSCH     P#FRAM                          CFT009
     C                     MOVELPCCY      P#TOCY                          CFT009
     C                     Z-ADD*ZEROS    P#TOAM                          CFT009
     C                     EXSR SRFT10                                    CFT009
     C                     Z-ADDP#TOAM    WSCHG                           CFT009
      *                                                                   CFT009
     C                     ENDSL                                          CFT009
      *                                                                   CFT009
     C                     SELEC                                          CFT009
     C           OPSCC1    WHEQ *BLANKS                                   CFT009
     C                     MOVE PCCY      OPSCC1                          CFT009
     C                     Z-ADDWSCHG     OPSCH1                          CFT009
     C                     Z-ADD1         OPSCLE                          CFT009
     C           OPSCC2    WHEQ *BLANKS                                   CFT009
     C                     MOVE PCCY      OPSCC2                          CFT009
     C                     Z-ADDWSCHG     OPSCH2                          CFT009
     C                     Z-ADD2         OPSCLE                          CFT009
     C           OPSCC3    WHEQ *BLANKS                                   CFT009
     C                     MOVE PCCY      OPSCC3                          CFT009
     C                     Z-ADDWSCHG     OPSCH3                          CFT009
     C                     Z-ADD3         OPSCLE                          CFT009
     C           OPSCC4    WHEQ *BLANKS                                   CFT009
     C                     MOVE PCCY      OPSCC4                          CFT009
     C                     Z-ADDWSCHG     OPSCH4                          CFT009
     C                     Z-ADD4         OPSCLE                          CFT009
     C                     OTHER                                          CFT009
     C                     MOVE PCCY      OPSCC5                          CFT009
     C                     Z-ADDWSCHG     OPSCH5                          CFT009
     C                     Z-ADD5         OPSCLE                          CFT009
     C                     ENDSL                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDSR                                          CFT009
      *                                                                   CFT009
      *****************************************************************   CFT009
2586 C/EJECT
2585 C********************************************************************
2586 C*********************                                               S01195
2587 C*****ZFREQB-SR.*TO*INCREMENT*A*DAY*NUMBER*DATE*BY*A*                S01195
2588 C***************PERIOD*VALUE*DETERMINED*BY*A*CODE.*                  S01195
2589 C*********************                                               S01195
2590 C***********ZFREQB****BEGSR                           *** ZFREQB *** S01195
2591 C*********************                                               S01195
     C*****=====================================                          S01195
     C*****THIS*IS*NOT*A*STANDARD*SR*DO*NOT*COPY*                         S01195
     C*****=====================================                          S01195
     C*********************                                               S01195
2592 C*****CALCULATIONS*TO*DEFINE/CLEAR*FIELDS.*                          S01195
2593 C*********************MOVE ZFREQ     ZFREQ   1                       S01195
2594 C*********************Z-ADDZDAYNO    ZDAYNO  50                      S01195
2595 C*********************Z-ADDZMDAY     ZMDAY   20                      S01195
2596 C*********************MOVE ZCCY      ZCCY    3                       S01195
2597 C*********************                                               S01195
     C**LUX19**************                                               S01195
     C***********ZBEGIN****TAG                                            S01195
     C**LUX19**************                                               S01195
2598 C*********************MOVE '   '     ZHC                             S01195
2599 C*********************MOVE ' '       ZTABKY 12                       S01195
2600 C*********************                                               S01195
2601 C*************FIELDS*USED*FOR*PERIOD*CODES*M,T,Q,X,Y*                S01195
2602 C*********************                                               S01195
2603 C*********************MOVE '  '      ZINDE   2                       S01195
2604 C*********************Z-ADD0         ZINTO   20                      S01195
2605 C*********************                                               S01195
2606 C*****CONVERT*DAY*NUMBER*TO*DATE.*                                   S01195
2607 C*********************EXSR ZDATE2                                    S01195
2608 C*********************SETOF                     90                   S01195
2609 C*********************                                               S01195
2610 C*****CHECK*FOR*AND*INCREMENT*FOR*CODE*D-DAILY-WORKING*DAY.*         S01195
2611 C***********ZFREQ*****COMP 'D'                      91               S01195
2612 C***91******ZDAYNO****ADD  1         ZDAYNO                          S01195
2613 C***91****************GOTO ZFHCHK                                    S01195
2614 C*********************                                               S01195
2615 C*****CHECK*FOR*AND*INCREMENT*FOR*CODE*W-WEEKLY.*                    S01195
2616 C***********ZFREQ*****COMP 'W'                      91               S01195
2617 C***91******ZDAYNO****ADD  7         ZDAYNO                          S01195
2618 C***91****************GOTO ZFEND                                     S01195
2619 C*********************                                               S01195
2620 C*****CHECK*FOR*AND*INCREMENT*FOR*CODE*F-FORTNIGHTLY.*               S01195
2621 C***********ZFREQ*****COMP 'F'                      91               S01195
2622 C***91******ZDAYNO****ADD  14        ZDAYNO                          S01195
2623 C***91****************GOTO ZFEND                                     S01195
2624 C*********************                                               S01195
2625 C*****CHECK*FOR*AND*INCREMENT*FOR*CODE*S-SEMI-MONTHLY.*              S01195
2626 C***********ZFREQ*****COMP 'S'                      91               S01195
2627 C***91******ZDAY******COMP 15                   939292               S01195
2628 C***91*92*************Z-ADD31        ZDAY                            S01195
2629 C***91*93*************Z-ADD15        ZDAY                            S01195
2630 C***91*93***ZMTH******ADD  1         ZMTH                            S01195
2631 C***91****************GOTO ZFDATE                                    S01195
2632 C*********************                                               S01195
2633 C*****CHECK*FOR*AND*INCREMENT*FOR*CODE*M-MONTHLY.*                   S01195
2634 C***********ZFREQ*****COMP 'M'                      91               S01195
2635 C***91****************MOVE 'IN'      ZINDE                           S01195
2636 C***91****************Z-ADDZMDAY     ZDAY                            S01195
2637 C***91******ZMTH******ADD  1         ZMTH                            S01195
2638 C***91****************GOTO ZFDATE                                    S01195
2639 C*********************                                               S01195
2640 C*****CHECK*FOR*AND*INCREMENT*FOR*CODE*R-SIX*DAYS*BEFORE*END*OF*MONTHS01195
2641 C***********ZFREQ*****COMP 'R'                      91               S01195
2642 C***91****************Z-ADD31        ZDAY                            S01195
2643 C***91******ZMTH******ADD  1         ZMTH                            S01195
2644 C***91****************GOTO ZFDATE                                    S01195
2645 C*********************                                               S01195
2646 C*****CHECK*FOR*AND*INCREMENT*FOR*CODE*T-BIMONTHLY.*                 S01195
2647 C***********ZFREQ*****COMP 'T'                      91               S01195
2648 C***91****************MOVE 'IN'      ZINDE                           S01195
2649 C***91****************Z-ADDZMDAY     ZDAY                            S01195
2650 C***91******ZMTH******ADD  2         ZMTH                            S01195
2651 C***91****************GOTO ZFDATE                                    S01195
2652 C*********************                                               S01195
2653 C*****CHECK*FOR*AND*INCREMENT*FOR*CODE*Q-QUARTERLY.*                 S01195
2654 C***********ZFREQ*****COMP 'Q'                      91               S01195
2655 C***91****************MOVE 'IN'      ZINDE                           S01195
2656 C***91****************Z-ADDZMDAY     ZDAY                            S01195
2657 C***91******ZMTH******ADD  3         ZMTH                            S01195
2658 C***91****************GOTO ZFDATE                                    S01195
2659 C*********************                                               S01195
2660 C*****CHECK*FOR*AND*INCREMENT*FOR*CODE*X-SIX*MONTHLY.*               S01195
2661 C***********ZFREQ*****COMP 'X'                      91               S01195
2662 C***91****************MOVE 'IN'      ZINDE                           S01195
2663 C***91****************Z-ADDZMDAY     ZDAY                            S01195
2664 C***91******ZMTH******ADD  6         ZMTH                            S01195
2665 C***91****************GOTO ZFDATE                                    S01195
2666 C*********************                                               S01195
2667 C*****CHECK*FOR*AND*INCREMENT*FOR*CODE*Y-YEARLY.*                    S01195
2668 C***********ZFREQ*****COMP 'Y'                      91               S01195
2669 C***91****************MOVE 'IN'      ZINDE                           S01195
2663 C***91****************Z-ADDZMDAY     ZDAY                            S01195
2670 C***91******ZYEAR*****ADD  1         ZYEAR                           S01195
2671 C***91****************GOTO ZFDATE                                    S01195
2672 C*********************                                               S01195
2673 C*****CHECK*FOR*AND*INCREMENT*FOR*CODE*L-LAST*CALENDAR*DAY*OF*MONTH.*S01195
2674 C***********ZFREQ*****COMP 'L'                      91               S01195
2675 C***91****************Z-ADD31        ZDAY                            S01195
2676 C***91******ZMTH******ADD  1         ZMTH                            S01195
2677 C***91****************GOTO ZFDATE                                    S01195
2678 C*********************                                               S01195
2679 C*****CHECK*FOR*AND*INCREMENT*FOR*CODE*B-LAST*WORKING*DAY*OF*MONTH.* S01195
2680 C***********ZFREQ*****COMP 'B'                      91               S01195
2681 C***91****************Z-ADD31        ZDAY                            S01195
2682 C***91******ZMTH******ADD  1         ZMTH                            S01195
2683 C***91****************GOTO ZFDATE                                    S01195
2684 C*********************                                               S01195
2685 C*****CHECK*FOR*AND*INCREMENT*FOR*CODE*A-MONTHLY*ACCRUAL/PROFIT*DATE.S01195
2686 C***********ZFREQ*****COMP 'A'                      91               S01195
2687 C*********************MOVEL'01    '  ZTABKY                          S01195
2687 C***91****************MOVEL'01    '  ZTABKY                          S01195
2688 C***91****************MOVE '    11'  ZTABKY                          S01195
2689 C***91******ZTABKY****CHAINTABFP                99    ON NOT THERE   S01195
2690 C**N99******RECI******COMP '*'                      99               S01195
     C**LUX19**************                                               S01195
     C***91N99***APDA******IFLE ZDAYNO                                    S01195
2691 C***91N99*************Z-ADDAPDA      ZDAYNO                          S01195
     C*********************MOVE APFQ      ZFREQ                           S01195
     C*********************Z-ADDFDAY      ZMDAY                           S01195
     C*********************GOTO ZBEGIN                     ** ZBEGIN TAG**S01195
     C*********************END                                            S01195
     C**LUX19**************                                               S01195
2692 C*********************                                               S01195
2693 C*****BYPASS*IF*ZFREQ*IS*'A'*OR*ANY*OTHER*VALUE*                     S01195
2694 C*********************GOTO ZFEND                                     S01195
2695 C*********************                                               S01195
2696 C*********************                                               S01195
2697 C*****REFORMAT*DATE*AND*ENSURE*VALID.*                               S01195
2698 C***********ZFDATE****TAG                             ** ZFDATE TAG* S01195
2699 C*********************                                               S01195
2700 C*****VALIDATE*MONTH.*                                               S01195
2701 C***********ZMTH******COMP 12                   91                   S01195
2702 C***91******ZMTH******SUB  12        ZMTH                            S01195
2703 C***91******ZYEAR*****ADD  1         ZYEAR                           S01195
2704 C*********************                                               S01195
2705 C*****CHECK*FOR*LEAP*YEAR.*                                          S01195
2706 C***********ZYEAR*****DIV  4         ZLYR    20                      S01195
2707 C*********************MVR            ZLY     10     92LEAP YEAR-92 ONS01195
2708 C*********************                                               S01195
2709 C*****VALIDATE*DAY*NUMBER.*                                          S01195
2710 C*********************MOVE ZFMD,ZMTH ZWRK2   20                      S01195
2711 C***********ZMTH******COMP 2                        93               S01195
2712 C***92*93*************Z-ADD29        ZWRK2                           S01195
2713 C*********************                                               S01195
2714 C***********ZDAY******COMP ZWRK2                94                   S01195
2715 C***94****************Z-ADDZWRK2     ZDAY                            S01195
2716 C*********************                                               S01195
2717 C*****CHECK*IF*CODE*R,*TO*SUBTRACT*6*DAYS.*                          S01195
2718 C***********ZFREQ*****COMP 'R'                      91               S01195
2719 C***91******ZDAY******SUB  6         ZDAY                            S01195
2720 C*********************                                               S01195
2721 C*****REFORMAT*DATE,*DDMMYY*OR*MMDDYY,*AND*CONVERT*TO*DAY*NUMBER.*   S01195
2722 C*********************MOVELZDAY      ZWRK4   40                      S01195
2723 C*********************MOVE ZMTH      ZWRK4                           S01195
2724 C***98****************MOVELZMTH      ZWRK4                           S01195
2725 C***98****************MOVE ZDAY      ZWRK4                           S01195
2726 C*********************MOVELZWRK4     ZDATE                           S01195
2727 C*********************MOVE ZYEAR     ZDATE                           S01195
2728 C*********************EXSR ZDATE1                                    S01195
2729 C*********************                                               S01195
2730 C*****CHECK*IF*CODE*B,*OR*M,T,Q,X,Y*TO*BE*CHECKED*FOR*HOLIDAY.*      S01195
2731 C***********ZFREQ*****COMP 'B'                      91               S01195
2732 C***********ZINDE*****COMP 'IN'                     92               S01195
2733 C***92N99*************                                               S01195
2734 C*R*91N99*************GOTO ZFHCHK                                    S01195
2735 C*********************                                               S01195
2736 C*********************GOTO ZFEND                                     S01195
2737 C*********************                                               S01195
2738 C*****CHECK*IF*DAY*NUMBER*IS*A*HOLIDAY.*                             S01195
2739 C*********************                                               S01195
2740 C***********ZFHCHK****TAG                             ** ZFHCHK TAG *S01195
2741 C*********************SETOF                     94                   S01195
2742 C***********ZFREQ*****COMP 'D'                      91               S01195
2743 C***********ZFREQ*****COMP 'B'                      92               S01195
2744 C***91****************                                               S01195
2745 C*R*92****************GOTO ZSETK                                     S01195
2746 C*********************                                               S01195
2747 C****FOR*CODES*M,T,Q,X,Y,*CHECK*ZINDE*-*'IN'*TO*INCREMENT,*          S01195
2748 C*************************************-*'DE'*TO*DECREMENT*           S01195
2749 C*********************                                               S01195
2750 C***********ZINDE*****COMP 'IN'                     90               S01195
2751 C***********ZINDE*****COMP 'IN'                     91               S01195
2752 C***********ZINDE*****COMP 'DE'                     92               S01195
2753 C*********************                                               S01195
2754 C*****SET*KEY*FOR*FIRST*HOLIDAY*RECORD.*                             S01195
2755 C***********ZSETK*****TAG                             ** ZSETK TAG **S01195
2756 C*********************MOVEL'22    '  ZTABKY                          S01195
2757 C*********************MOVELZDAYNO    ZWRK6   6                       S01195
2758 C*********************MOVE 1         ZWRK6                           S01195
2759 C*********************MOVE ZWRK6     ZTABKY                          S01195
2760 C*********************                                               S01195
2761 C*****GET*HOLIDAY*RECORD.*                                           S01195
2762 C***********ZFHCHN****TAG                             ** ZFHCHN TAG* S01195
2763 C***********ZTABKY****CHAINTABFP                93    ON NOT THERE   S01195
2764 C**N93******RECI******COMP '*'                      93               S01195
     C**N94****************MOVE '   '     ZHC                             S01195
2765 C*********************                                               S01195
2766 C*****STORE*CURRENCIES*IF*RECORD*FOUND.*                             S01195
2767 C**N94N93*************MOVEAHCCY      ZHC,1                           S01195
2768 C***94N93*************MOVEAHCCY      ZHC,26                          S01195
2769 C*********************                                               S01195
2770 C*****GET*SECOND*RECORD,*IF*NOT*ALREADY*DONE.*                       S01195
2771 C*********************MOVE ZTABKY    ZWRK1N  10                      S01195
2772 C***********ZWRK1N****COMP 1                        94               S01195
2773 C*********************MOVE '2'       ZTABKY                          S01195
2774 C***94N93*************GOTO ZFHCHN                                    S01195
2775 C*********************                                               S01195
2776 C*****BYPASS*TO*END*IF*NO*FIRST*RECORD*FOUND.*                       S01195
2777 C***93*94*************GOTO ZFEND                                     S01195
2778 C*********************                                               S01195
2779 C*****DETERMINE*HOLIDAY*RECORD*TYPE.*                                S01195
2780 C***********INEX******COMP 'E'                      95               S01195
2781 C***********INEX******COMP 'I'                      96               S01195
2782 C*********************                                               S01195
2783 C*****CHECK*IF*CURRENCY*ON*HOLIDAY.*                                 S01195
2784 C***********ZCCY******LOKUPZHC                      97               S01195
2785 C*********************                                               S01195
2786 C*****BYPASS*IF*NOT*HOLIDAY*FOR*CURRENCY.*                           S01195
2787 C***95*97*************                                EXCLUDE FOUND  S01195
2788 C*R*96N97*************GOTO ZFEND                      INCL. NOT FOUNDS01195
2789 C*********************                                               S01195
2790 C*********************                                               S01195
2791 C***92****************GOTO ZDECR                                     S01195
2792 C*********************                                               S01195
2793 C*****INCREMENT*OR*DECREMENT*DAY*NUMBER*AS*REQUIRED.*                S01195
2794 C***91******ZDAYNO****ADD  1         ZDAYNO                          S01195
2795 C*********************                                               S01195
2796 C*****ONLY*FOR*PERIOD*CODE*=*M,T,Q,X*OR*Y,*IF*INCREMENTATION*        S01195
2797 C*****TAKES*THE*OUTPUT*DATE*INTO*THE*FOLLOWING*MONTH,*RETURN*TO*     S01195
2798 C*****THE*INPUT*DATE*AND*DECREMENT*-*92*ON.*                         S01195
2799 C*********************                                               S01195
2800 C***90*91***ZINTO*****ADD  1         ZINTO                           S01195
2801 C***90*91***ZINTO*****ADD  ZDAY      ZINTOT  20                      S01195
2802 C***90*91*************MOVE ZINTOT    ZINTOA  2                       S01195
     C**TO*ALLOW*29*FEB*ON*LEAP*YEARS*TO*PASS*                            S01195
     C*********************SETOF                     93                   S01195
     C***90*91***ZYEAR*****DIV  4         ZLYR                            S01195
     C***90*91*************MVR            ZLY            92               S01195
     C***90*91*92ZMTH******COMP 2                        93               S01195
     C***93******ZINTOA****COMP '29'                 92                   S01195
     C***90*91N93ZINTOA****COMP ZFMD,ZMTH            92                   S01195
2803 C***90*91***ZINTOA****COMP ZFMD,ZMTH            92                   S01195
2804 C***90*91*92ZDAYNO****SUB  ZINTO     ZDAYNO                          S01195
2805 C***90*91*92**********MOVE 'DE'      ZINDE                           S01195
2806 C*********************                                               S01195
2807 C***********ZDECR*****TAG                             ** ZDECR TAG **S01195
2808 C***92*95N97**********                                EXCL. NOT FOUNDS01195
2809 C*R*92*96*97ZDAYNO****SUB  1         ZDAYNO           INCLUDE FOUND  S01195
2810 C*********************GOTO ZFHCHK                                    S01195
2811 C*********************                                               S01195
2812 C*********************                                               S01195
2813 C***********ZFEND*****ENDSR                           * ZFEND ENDSR *S01195
2814 C*********************                                               S01195
     C********************************************************************
     C/EJECT
     C********************************************************************
4551 C*********************                                               S01195
4552 C*****ZTXDAY*SR.*TO*CALCULATE*ANY*NUMBER*OF*DAYS*FORWARD*THAT*ARE*   S01195
4553 C****************WORKING*DAYS*IN*BOTH*THE*LOCAL*CURRENCY*AND*ANY*    S01195
4554 C****************SPECIFIED*CURRENCY.*                                S01195
4555 C*********************                                               S01195
4556 C*********THIS*SR.*CAN*BE*USED*WHEN*THE*INPUT*CYCLE*IS*RUNNING*AS*   S01195
4557 C*********HOLIDAY*RECORDS*ARE*ACCESSED*BY*CHAIN.*THEREFORE*NEWLY*    S01195
4558 C*********ADDED*RECORDS*IN*THE*OVERFLOW*AREA*CAN*ALSO*BE*ACCESSED.*  S01195
4559 C*********************                                               S01195
4560 C***********ZTXDAY****BEGSR                           *** ZTXDAY *** S01195
4561 C*********************                                               S01195
4562 C*****CALCULATIONS*TO*DEFINE*INPUT*FIELDS.*                          S01195
4563 C*********************Z-ADDZDAYNO    ZDAYNO  50       STARTING DATE  S01195
4564 C*********************MOVE ZCCY      ZCCY    3        DATE CURRENCY  S01195
4565 C*********************Z-ADDZNRDYS    ZNRDYS  20       NBR OF WORKING S01195
4566 C*****LOCY*DEFINED*ON*TABLE,TB-11;**AND*SHOULD*ALREADY*HAVE*         S01195
4567 C*****BEEN*INPUT.*****                                               S01195
4568 C*********************                                DAYS FORWARD   S01195
4569 C*****CLEAR*COUNT*OF*NBR*OF*DAYS*ADDED,*&*DEFINE*ZDYNBR.*            S01195
4570 C*********************Z-ADD0         ZDCNT   20                      S01195
4571 C*********************Z-ADDZDAYNO    ZDYNBR  50                      S01195
4551 C******SEE*MANUAL*ON*SYSTEM*SUBROUTINES*                             S01195
4551 C******IF*ZNRDYS*IS*INPUT*AS*ZERO*IT*WILL*NOW*BE*TREATED*AS*ZERO.*   S01195
4551 C******FIRST*CHECK*FOR*ZERO*NOTICE*DAYS*                             S01195
4551 C***********ZNRDYS****COMP 0                        95       T1973   S01195
4551 C***95****************GOTO ZTXEND                                    S01195
4572 C*********************                                               S01195
4573 C*****LOOP*TO*INCREMENT*DAY*NUMBER*AND*CHECK*FOR*HOLIDAY.*           S01195
4574 C***********ZTLOP1****TAG                             ** ZTLOP1 TAG *S01195
4575 C*********************                                               S01195
4576 C*********************SETOF                     9596                 S01195
4577 C***********ZDYNBR****ADD  1         ZDYNBR                          S01195
4578 C*********************                                               S01195
4579 C*****SET*KEY*FOR*FIRST*HOLIDAY*RECORD.*                             S01195
4580 C*********************MOVEL'22    '  ZDHKEY 12                       S01195
4581 C*********************MOVELZDYNBR    ZWRK6   6                       S01195
4582 C*********************MOVE '1'       ZWRK6                           S01195
4583 C*********************MOVE ZWRK6     ZDHKEY                          S01195
4584 C*********************                                               S01195
4585 C*****CHAIN*FOR*HOLIDAY*RECORD,*RECORD*1*OR*2*                       S01195
4586 C***********ZTHCHN****TAG                             ** ZTHCHN TAG *S01195
4587 C*********************                                               S01195
4588 C***********ZDHKEY****CHAINTABFP                90    ON NOT THERE   S01195
4589 C**N90******RECI******COMP 'D'                  9090  DELETED        S01195
4590 C*********************                                               S01195
4591 C*****NO*RECORD*1*FOUND,*IS*NOT*A*HOLIDAY*                           S01195
4592 C***90N95*************GOTO ZTOAGN                                    S01195
4593 C*********************                                               S01195
4594 C*****NO*RECORD*2*FOUND*                                             S01195
4595 C***90*95*96**********GOTO ZTLOP1                     EXC. NOT FOUND S01195
4596 C***90*95N96**********GOTO ZTOAGN                     INC. NOT FOUND S01195
4597 C*********************                                               S01195
4598 C*****DETERMINE*TYPE*FOUND,*INCLUDE*OR*EXCLUDE*                      S01195
4599 C***********INEX******COMP 'E'                  92  91               S01195
4600 C*********************                                               S01195
4601 C*****CHECK*IF*DAY*IS*HOLIDAY*FOR*CURRENCY.*                         S01195
4602 C***********ZCCY******LOKUPHCCYA                    93               S01195
4603 C**N93******LOCY******LOKUPHCCYA                    93               S01195
4604 C***91*93*************GOTO ZTOAGN                     EXCLUDE FOUND  S01195
4605 C***92*93*************GOTO ZTLOP1                     INCLUDE FOUND  S01195
4606 C*********************                                               S01195
4607 C*****IF*EXCLUDE*OR*INCLUDE*NOT*FOUND*CHECK*                         S01195
4608 C*****FOR*SECOND*HOLIDAY*RECORD,*IF*REQUIRED.*                       S01195
4609 C***********'***'*****LOKUPHCCYA                    94ON IF NO RCD.2 S01195
4610 C*********************MOVE ZDHKEY    ZWRK1   1                       S01195
4611 C***********ZWRK1*****COMP '1'                      95               S01195
4612 C***91*95*************SETON                     96                   S01195
4613 C***95N94*************MOVE '2'       ZDHKEY                          S01195
4614 C***95N94*************GOTO ZTHCHN                     GET SECOND REC S01195
4615 C*********************                                               S01195
4616 C***91****************GOTO ZTLOP1                     EXC. NOT FOUND S01195
4617 C***92****************GOTO ZTOAGN                     INC. NOT FOUND S01195
4618 C*********************                                               S01195
4619 C*****INCREMENT*COUNT*AND*CHECK*IF*REQUIRED*NUMBER*OF*DAYS*          S01195
4620 C*****HAVE*BEEN*ADDED.*IF*NOT,*GO*THROUGH*LOOP1*AGAIN.*              S01195
4621 C***********ZTOAGN****TAG                             ** ZTOAGN TAG *S01195
4622 C*********************                                               S01195
4623 C***********ZDCNT*****ADD  1         ZDCNT                           S01195
4624 C***********ZDCNT*****COMP ZNRDYS                 97                 S01195
4625 C***97****************GOTO ZTLOP1                                    S01195
4626 C*********************                                               S01195
4627 C***********ZTXEND****ENDSR                            *** ZTXEND ***S01195
4628 C*********************                                               S01195
4629 C*********************                                               S01195
4630 C********************************************************************
2814 C/EJECT
     C/COPY WNCPYSRC,FT0205C003
      /COPY ZSRSRC,ZSEDITZ3
      /COPY ZSRSRC,ZACCH                                                  S01195
********/COPY ZSRSRC,ZCHKH                                          S01195062394
      /COPY ZSRSRC,ZFWDT                                                  S01195
*******/COPY ZSRSRC,ZFREQBZ2                                        S01195062394
      /COPY ZSRSRC,ZXRATEZ1                                               CFT009
     C/COPY ZSRSRC,ZEDITZ2                                                CFT009
      /EJECT
     O**   ZFMD  -  NUMBER OF DAYS IN THE MONTH                           062394
     O**312831303130313130313031                                          062394
      *                                                                                     BUG23056
      ** The Following Array Data has been Physically Deleted                               BUG23056
      *                                                                                     BUG23056
      ** STAMP - Dummy timestamp                                                     CPK015 BUG23056
      **0001-01-01-00.00.00.000000                                                   CPK015 BUG23056
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
**   ZYDY - YEARS IN DAYS CUMULATIVE IN FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
**   POWER - ARRAY OF POWERS OF 10 FOR CURRENCY CONVERSIONS
0000001
0000010
0000100
0001000
0010000
0100000
1000000
